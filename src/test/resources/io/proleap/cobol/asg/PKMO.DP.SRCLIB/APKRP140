000100*-----------------------*                                         00010005
000200 IDENTIFICATION DIVISION.                                         00020005
000300*-----------------------*                                         00030005
000400 PROGRAM-ID.     APKRP140.                                        00040005
000500 AUTHOR.         DAVE COLOMBO  COMPUWARE.                         00050005
000600 DATE-WRITTEN.   JANUARY 1999.                                    00060005
000700 DATE-COMPILED.                                                   00070005
000800*---------------------------------------------------------------* 00080005
000900*    ADJUSTMENT JOURNAL MONTH-TO-DATE REPORT.                   * 00090005
001000*    COBOL 2 WITH SQL                                           * 00100005
001100*                                                               * 00110005
001200* THE PURPOSE OF THIS PROGRAM IS TO CREATE THE ADJUSTMENT       * 00120005
001300* JOURNAL REPORT. THE REPORT WILL BE IN DIVISION, DEPARTMENT    * 00130005
001400* AND MAJOR CLASS SEQUENCE, WITH TOTALS FOR CURRENT PERIOD AND  * 00140005
001500* MONTH-TO-DATE AT EACH CONTROL BREAK ON ANY OF THESE FIELDS.   * 00150005
001600* THE CURRENT PERIOD TOTALS WILL BE SUBTOTALED BY TRANSACTION   * 00160005
001700* TYPE.                                                         * 00170005
001800*                                                               * 00180005
001900* THE REPORT CAN BE RUN ON A WEEKLY OR MONTHLY BASIS, INDICATED * 00190005
002000* BY A CONTROL CARD. WHEN RUN ON A WEEKLY BASIS, ONLY THE       * 00200005
002100* PERIOD WILL BE REPORTED IN DETAIL. WHEN RUN ON A MONTHLY      * 00210005
002200* BASIS, ALL TRANSACTIONS WILL BE REPORTED IN DETAIL.           * 00220005
002300*---------------------------------------------------------------* 00230005
002400*                                                               * 00240005
002500* DB2 TABLES:                                                   * 00250005
002600*  1. AP-PAYMENT CONTROL TABLE             (TAPCNTL)            * 00260005
002700*  2. MERCHANDISE AREA TABLE               (TMDSEAR)            * 00270005
002800*  3. RESPONSIBLITY AREA TABLE             (TRSPBAR)            * 00280005
002810*  4. AP TRANCODE TABLE                    (TTRNCDE)            * 00281005
002820*                                                               * 00282005
002830* INPUT:                                                        * 00283005
002840*                                                               * 00284005
002850*  1. ADJUSTMENT JOURNAL EXTRACT DATA      (APRD046)            * 00285005
002860*  2. CONTROL CARD                                              * 00286005
002870*                                                               * 00287005
002880* OUTPUT:                                                       * 00288005
002890*                                                               * 00289005
002900*  1. ADJUSTMENT JOURNAL REPORT                                 * 00290005
003000*                                                               * 00300005
003100*---------------------------------------------------------------* 00310005
003200* CHANGE LOG:                                                   * 00320005
003300* 01/19/99   INITIAL VERSION.                                   * 00330005
003400*                                                               * 00340005
003500* 09/02/1999 INCLUDING THE TRANSACTION CODE NUMBER NEXT TO THE  * 00350005
003600*        TRANSACTION DESCRIPTION                                * 00360005
003700*        BY: JILL JUEL                              WR 05998    * 00370005
003800*                                                               * 00380005
003900* 10/11/1999 CHANGE DATE-INVALID TO WARNING-ERROR IN DATE       * 00390005
004000*        ROUTINE CHECKING                                       * 00400005
004100*        BY: L SCHALLHORN                           WR 06041    * 00410005
004200*                                                               * 00420005
004300* 10/13/1999 PAGE BREAK FOR DEPARTMENT TOTALS.                  * 00430005
004400*        BY: CAROLYN GIFFORD                        WR 05998    * 00440005
004500*                                                               * 00450005
004600* 01/11/2000 ADDED CC-FROM-DATE AND CC-THRU-DATE TO THE CONTROL * 00460005
004610*        CARD TO BE ABLE TO CHANGE THE REPORT DATE WHEN WE NEED * 00461005
004620*        TO RERUN.                                              * 00462005
004630*        BY: JILL JUEL                                          * 00463005
004640*                                                               * 00464005
004650* 11/11/2000 ADDED THE MOVE SPACES TO PV-HLD-DEPT-NBR AND       * 00465005
004660*        PV-HLD-MAJ-CL-NBR IN PARAGRAPH C100- BECAUSE THE CLASS * 00466005
004670*        DESCRIPTION WAS NOT CORRECTLY POPULATED.               * 00467005
004680*        BY: ROBIN BERNOSKI                         WR#: 20704  * 00468005
004690*                                                               * 00469005
004691* 05/16/2002                                                    * 00469105
004692*   CHANGE MADE:  NI-SKU CHANGES.  RECOMPILE FROM PRODUCTION    * 00469205
004693*   TO INCORPORATE CHANGES TO COPYBOOK APRD046.                 * 00469305
004694* MADE BY:  KEVIN CATLIN                   WR/IR #: 21278       * 00469405
004695*                                                               * 00469505
004696* 02/25/2005                                                    * 00469605
004697*   CHANGE MADE:  ADDED TRANCODE TABLE AND LOGIC TO FETCH ALL   * 00469705
004698*   THE MERCHANDISE TRANCODES IN SEQUENCE AND LOAD THEM INTO    * 00469805
004699*   AN ARRAY WITH A SEQUENCE NUMBER.  THIS SEQUENCE NUMBER WILL * 00469905
004700*   BECOME THE SUBSCRIPT FOR ALL OF THE TRANCODE TOTAL TABLES.  * 00470005
004701*   ALSO ADDED THE TRANCODE TO EACH OF THE 'TOTAL' TABLES TO    * 00470105
004702*   USE FOR PRINTING ON THE REPORT.  THESE CHANGES ARE TO FIX   * 00470205
004703*   A PROBLEM WHERE USING THE TRANCODE AS A SUBSCRIPT NO LONGER * 00470305
004704*   WORKS CORRECTLY ONCE TRANCODES STARTED HAVING ALPHA VALUES. * 00470405
004705* MADE BY:  NANCY EILBES                   WR/IR #: P000740708  * 00470505
004706*                                                               * 00470605
004707* 03/08/2005                                                    * 00470705
004708*   CHANGE MADE:  IN PARAGRAPH S200, ADDED BATCH PROCESS DATE   * 00470805
004709*   TO THE SELECT LIST FOR TAPCNTL.  THIS CORRECTS A PROBLEM    * 00470905
004710*   WHERE THE TRANCODE CURSOR WAS GETTING AN INVALID DATE/TIME  * 00471005
004711*   FOR A MONTHLY RUN, BECAUSE THE BATCH DATE WAS NOT BEING     * 00471105
004712*   SELECTED WHEN CONTROL CARD INDICATED MONTHLY.               * 00471205
004713* MADE BY:  NANCY EILBES                   WR/IR #: P000742986  * 00471305
004714*                                                               * 00471405
004715* 05/01/2007                                                    * 00471505
004716*   CHANGE MADE:  IN PARAGRAPH S100, ADDED WITH TEST AFTER TO   * 00471605
004717*   THE PERFORM VARYING, SO THAT THE FIRST TRNCDE WOULD BE      * 00471705
004718*   PICKED UP AND PROCESSED CORRECTLY.                          * 00471805
004719* MADE BY:  GREG WISIALOWSKI               WR/IR #: P001014386  * 00471905
004720*                                                               * 00472005
004721* 05/07/2007                                                    * 00472105
004722*   CHANGE MADE:  IN PARAGRAPH S100, CORRECTED CURSOR SELECT    * 00472205
004723*   FROM PREV-WK TO CURR-WK                                     * 00472305
004724* MADE BY:  GREG WISIALOWSKI               WR/IR #: P001016967  * 00472405
004725*                                                               * 00472505
004726* 03/10/2008                                                    * 00472605
004727*   CHANGE MADE:  EXPANDED TRANCODE TABLE FROM 99 TO 999 TO     * 00472705
004728*   ACCOMODATE NEW TRANCODES                                    * 00472805
004729* MADE BY:  GREG WISIALOWSKI           WR/IR #: INC000000288673*  00472905
004730*                                                               * 00473005
004731* 03/10/2008                                                    * 00473105
004732*   CHANGE MADE:  CORRECTED TABLE LIMIT OCCURS                  * 00473205
004733* MADE BY:  GREG WISIALOWSKI           WR/IR #: INC000000290710*  00473305
004734*                                                               * 00473405
004735* 03/10/2008                                                    * 00473506
004736*   CHANGE MADE:  EXPANDED CLASS, DEPT, DM AND TOTAL TABLES     * 00473606
004737*   FROM 99 TO 999 OCCURENCES.                                  * 00473706
004738* MADE BY:  NANCY EILBES               WR/IR #: INC000000290710 * 00473806
004739*                                                               * 00473906
004740*---------------------------------------------------------------* 00474005
004741                                                                  00474105
004742 ENVIRONMENT DIVISION.                                            00474205
004743 CONFIGURATION SECTION.                                           00474305
004744 SOURCE-COMPUTER.    IBM-3090.                                    00474405
004745 OBJECT-COMPUTER.    IBM-3090.                                    00474505
004746                                                                  00474605
004747 INPUT-OUTPUT SECTION.                                            00474705
004748 FILE-CONTROL.                                                    00474805
004749                                                                  00474905
004750     SELECT ADJ-EXTRACT-FILE     ASSIGN TO UT-S-INP01.            00475005
004751     SELECT REPORT-FILE          ASSIGN TO UT-S-RPT01.            00475105
004752                                                                  00475205
004753                                                                  00475305
004754 DATA DIVISION.                                                   00475405
004755 FILE SECTION.                                                    00475505
004756                                                                  00475605
004757 FD  ADJ-EXTRACT-FILE                                             00475705
004758     RECORDING MODE IS F                                          00475805
004759     LABEL RECORDS ARE STANDARD                                   00475905
004760     BLOCK CONTAINS 0 RECORDS                                     00476005
004761     DATA RECORD IS ADJ-EXTRACT-REC.                              00476105
004762 01  ADJ-EXTRACT-REC             PIC  X(250).                     00476205
004763                                                                  00476305
004764 FD  REPORT-FILE                                                  00476405
004765     RECORDING MODE IS F                                          00476505
004770     LABEL RECORDS ARE STANDARD                                   00477005
004780     BLOCK CONTAINS 0 RECORDS                                     00478005
004790     DATA RECORD IS REPORT-REC.                                   00479005
004800 01  REPORT-REC                  PIC  X(150).                     00480005
004900                                                                  00490005
005000                                                                  00500005
005100 WORKING-STORAGE SECTION.                                         00510005
005200                                                                  00520005
005300 01  PROGRAM-CONSTANTS.                                           00530005
005400     05  PC-PROGRAM-NAME         PIC  X(08)     VALUE 'APKRP140'. 00540005
005500     05  PC-SUB-LITERALS.                                         00550005
005600         10  TBL-SUB             PIC S9999      VALUE ZEROES.     00560005
005700         10  PC-TBL-MAX          PIC S9999      VALUE +999.       00570005
005800     05  PC-FOR-CLASS            PIC  X(11)     VALUE             00580005
005900         ' FOR CLASS:'.                                           00590005
006000     05  PC-FOR-DEPT             PIC  X(11)     VALUE             00600005
006100         ' FOR DEPT: '.                                           00610005
006200     05  PC-FOR-DMA              PIC  X(11)     VALUE             00620005
006300         ' FOR DMM:  '.                                           00630005
006400     05  PC-TOTAL-CUR-PERIOD     PIC  X(25)     VALUE             00640005
006500         'TOTAL FOR CURRENT PERIOD '.                             00650005
006600     05  PC-TOTAL-MTD            PIC  X(25)     VALUE             00660005
006700         'TOTAL MONTH-TO-DATE      '.                             00670005
006800                                                                  00680005
006900 01  PV-PROCESS-COUNTERS.                                         00690005
007000     05  PV-POS                  PIC 9(02)      VALUE ZEROS.      00700005
007100     05  PV-RETRY-COUNTER        PIC S9(4) COMP VALUE ZEROS.      00710005
007200     05  PV-READ-COUNT           PIC  9(08)     VALUE ZEROES.     00720005
007300     05  PV-TRCODE-COUNT         PIC S999       VALUE ZEROES.     00730005
007400                                                                  00740005
007500 01  PV-REPORT-CONTROLS.                                          00750005
007600     05  PV-REPORT-REC           PIC  X(150)    VALUE SPACES.     00760005
007700     05  PV-LINE-SKIP            PIC S999       VALUE ZEROES.     00770005
007800     05  PV-LINES-PER-PAGE       PIC S999       VALUE +0.         00780005
007900     05  PC-LINES-PER-PAGE-MAX   PIC S999       VALUE +60.        00790005
008000     05  PV-PAGE-COUNT           PIC S9(05)     VALUE ZEROES.     00800005
008100                                                                  00810005
008200 01  PROGRAM-SWITCHES.                                            00820005
008300     05  PS-ADJ-EOF-SW           PIC  X         VALUE 'N'.        00830005
008400         88  PS-ADJ-NOT-EOF                     VALUE 'N'.        00840005
008500         88  PS-ADJ-EOF                         VALUE 'Y'.        00850005
008600     05  PS-TRNCDE-CSR-SW        PIC  X         VALUE 'N'.        00860005
008700         88  PV-TRNCDE-CSR-NOT-AT-END           VALUE 'N'.        00870005
008800         88  PV-TRNCDE-CSR-AT-END               VALUE 'Y'.        00880005
008900     05  PS-NEED-VNDR-HEADNG-SW  PIC  X         VALUE 'N'.        00890005
009000         88  PS-NEED-VNDR-HEADNG                VALUE 'Y'.        00900005
009100         88  PS-HAVE-VNDR-HEADNG                VALUE 'N'.        00910005
009200     05  PS-CL-TOTALS-SW         PIC  X         VALUE 'N'.        00920005
009300         88  PS-CL-TOTALS                       VALUE 'Y'.        00930005
009400         88  PS-CL-NO-TOTALS                    VALUE 'N'.        00940005
009500     05  PS-DP-TOTALS-SW         PIC  X         VALUE 'N'.        00950005
009600         88  PS-DP-TOTALS                       VALUE 'Y'.        00960005
009700         88  PS-DP-NO-TOTALS                    VALUE 'N'.        00970005
009800     05  PS-DN-TOTALS-SW         PIC  X         VALUE 'N'.        00980005
009900         88  PS-DM-TOTALS                       VALUE 'Y'.        00990005
010000         88  PS-DM-NO-TOTALS                    VALUE 'N'.        01000005
010100     05  PS-TL-TOTALS-SW         PIC  X         VALUE 'N'.        01010005
010200         88  PS-TL-TOTALS                       VALUE 'Y'.        01020005
010300         88  PS-TL-NO-TOTALS                    VALUE 'N'.        01030005
010400     05  PS-TOTALS-SW            PIC  X         VALUE 'N'.        01040005
010500         88  PS-TOTALS                          VALUE 'Y'.        01050005
010600         88  PS-NO-TOTALS                       VALUE 'N'.        01060005
010700     05  PS-DMA-SW               PIC  X         VALUE 'N'.        01070005
010800         88  PS-DMA-TOTALS                      VALUE 'Y'.        01080005
010900         88  PS-NO-DMA-TOTALS                   VALUE 'N'.        01090005
011000     05  PS-DEPT-SW              PIC  X         VALUE 'N'.        01100005
011100         88  PS-DEPT-TOTALS                     VALUE 'Y'.        01110005
011200         88  PS-NO-DEPT-TOTALS                  VALUE 'N'.        01120005
011300                                                                  01130005
011400 01  PROGRAM-VARIABLES.                                           01140005
011500     05  PV-CURRENT-DATE.                                         01150005
011600         10  PV-CURRENT-YEAR     PIC  9(02)     VALUE ZEROS.      01160005
011700         10  PV-CURRENT-MONTH    PIC  9(02)     VALUE ZEROS.      01170005
011800         10  PV-CURRENT-DAY      PIC  9(02)     VALUE ZEROS.      01180005
011900     05  PV-CURRENT-TIME.                                         01190005
012000         10  PV-CURRENT-HOUR     PIC  9(02)     VALUE ZEROES.     01200005
012100         10  PV-CURRENT-MINUTE   PIC  9(02)     VALUE ZEROES.     01210005
012200         10  FILLER              PIC  9(02)     VALUE ZEROES.     01220005
012300                                                                  01230005
012400* USED FOR AJUSTMENT PROCESSING                                   01240005
012500     05  PV-HLD-FWK-NBR          PIC  X(02)     VALUE SPACES.     01250005
012600     05  PV-HLD-DMA-NBR          PIC  X(02)     VALUE SPACES.     01260005
012700     05  PV-HLD-DEPT-NBR         PIC  X(03)     VALUE SPACES.     01270005
012800     05  PV-HLD-MAJ-CL-NBR       PIC  X(02)     VALUE SPACES.     01280005
012900     05  PV-HLD-VND-NBR          PIC  X(09)     VALUE SPACES.     01290005
013000                                                                  01300005
013100 01 PV-HLD-AMOUNTS               COMP-3.                          01310005
013200    15  PV-HLD-RETL-AMT          PIC S9(11)V99  VALUE ZEROS.      01320005
013300    15  PV-HLD-GRO-AMT           PIC S9(11)V99  VALUE ZEROS.      01330005
013400    15  PV-HLD-FRGT-AMT          PIC S9(11)V99  VALUE ZEROS.      01340005
013500    15  PV-HLD-MISC-AMT          PIC S9(11)V99  VALUE ZEROS.      01350005
013600    15  PV-HLD-NET-AMT           PIC S9(11)V99  VALUE ZEROS.      01360005
013700    15  PV-HLD-DISC-AMT          PIC S9(11)V99  VALUE ZEROS.      01370005
013800                                                                  01380005
013900 01  PV-TRANCODE-TABLE.                                           01390005
014000     05  PV-TRANCODE  OCCURS 999 TIMES INDEXED BY TRN-IDX.        01400005
014100         10  PV-TR-TRANCODE          PIC X(2)     VALUE SPACES.   01410005
014200         10  PV-TR-SUBSCRIPT         PIC S999     VALUE ZEROES.   01420005
014300                                                                  01430005
014400 01  PV-CLASS-TABLE.                                              01440005
014500     05  PV-CLASS-OCCURS             OCCURS 999 TIMES.            01450005
014600         10  PV-CL-TRANCODE          PIC X(2)      VALUE SPACES.  01460005
014700         10  PV-CL-DESC              PIC X(18)     VALUE SPACES.  01470005
014800         10  PV-CLASS-TRNCDE-AMTS    COMP-3.                      01480005
014900             15  PV-CL-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   01490005
015000             15  PV-CL-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   01500005
015100             15  PV-CL-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   01510005
015110             15  PV-CL-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01511005
015120             15  PV-CL-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   01512005
015130             15  PV-CL-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01513005
015140     05  PV-CLASS-CUR-PERIOD         COMP-3.                      01514005
015150         10  PV-CL-CUR-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   01515005
015160         10  PV-CL-CUR-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   01516005
015170         10  PV-CL-CUR-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   01517005
015180         10  PV-CL-CUR-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01518005
015190         10  PV-CL-CUR-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   01519005
015200         10  PV-CL-CUR-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01520005
015300     05  PV-CLASS-MTD                COMP-3.                      01530005
015400         10  PV-CL-MTD-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   01540005
015500         10  PV-CL-MTD-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   01550005
015600         10  PV-CL-MTD-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   01560005
015700         10  PV-CL-MTD-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01570005
015800         10  PV-CL-MTD-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   01580005
015900         10  PV-CL-MTD-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01590005
016000                                                                  01600005
016100 01  PV-DEPT-TABLE.                                               01610005
016200     05  PV-DEPT-OCCURS              OCCURS 999 TIMES.            01620005
016300         10  PV-DP-TRANCODE          PIC X(2)      VALUE SPACES.  01630005
016400         10  PV-DP-DESC              PIC X(18)     VALUE SPACES.  01640005
016500         10  PV-DEPT-TRNCDE-AMTS     COMP-3.                      01650005
016600             15  PV-DP-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   01660005
016700             15  PV-DP-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   01670005
016800             15  PV-DP-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   01680005
016900             15  PV-DP-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01690005
017000             15  PV-DP-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   01700005
017100             15  PV-DP-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01710005
017200     05  PV-DEPT-CUR-PERIOD          COMP-3.                      01720005
017300         10  PV-DP-CUR-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   01730005
017400         10  PV-DP-CUR-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   01740005
017500         10  PV-DP-CUR-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   01750005
017600         10  PV-DP-CUR-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01760005
017700         10  PV-DP-CUR-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   01770005
017800         10  PV-DP-CUR-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01780005
017900     05  PV-DEPT-MTD                 COMP-3.                      01790005
018000         10  PV-DP-MTD-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   01800005
018100         10  PV-DP-MTD-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   01810005
018200         10  PV-DP-MTD-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   01820005
018300         10  PV-DP-MTD-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01830005
018400         10  PV-DP-MTD-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   01840005
018500         10  PV-DP-MTD-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01850005
018600                                                                  01860005
018700 01  PV-DMA-TABLE.                                                01870005
018800     05  PV-DMA-OCCURS               OCCURS 999 TIMES.            01880005
018900         10  PV-DM-TRANCODE          PIC X(2)      VALUE SPACES.  01890005
019000         10  PV-DM-DESC              PIC X(18)     VALUE SPACES.  01900005
019100         10  PV-DMA-TRNCDE-AMTS      COMP-3.                      01910005
019200             15  PV-DM-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   01920005
019300             15  PV-DM-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   01930005
019400             15  PV-DM-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   01940005
019500             15  PV-DM-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01950005
019600             15  PV-DM-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   01960005
019700             15  PV-DM-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   01970005
019800     05  PV-DMA-CUR-PERIOD           COMP-3.                      01980005
019900         10  PV-DM-CUR-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   01990005
020000         10  PV-DM-CUR-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02000005
020100         10  PV-DM-CUR-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02010005
020200         10  PV-DM-CUR-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02020005
020300         10  PV-DM-CUR-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02030005
020400         10  PV-DM-CUR-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02040005
020500     05  PV-DMA-MTD                  COMP-3.                      02050005
020600         10  PV-DM-MTD-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02060005
020700         10  PV-DM-MTD-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02070005
020800         10  PV-DM-MTD-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02080005
020900         10  PV-DM-MTD-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02090005
021000         10  PV-DM-MTD-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02100005
021100         10  PV-DM-MTD-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02110005
021200                                                                  02120005
021300 01  PV-TOTALS-TABLE.                                             02130005
021400     05  PV-TOTALS-OCCURS            OCCURS 999 TIMES.            02140005
021500         10  PV-TL-TRANCODE          PIC X(2)      VALUE SPACES.  02150005
021600         10  PV-TL-DESC              PIC X(18)     VALUE SPACES.  02160005
021700         10  PV-TOTALS-TRNCDE-AMTS   COMP-3.                      02170005
021800             15  PV-TL-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02180005
021900             15  PV-TL-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02190005
022000             15  PV-TL-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02200005
022100             15  PV-TL-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02210005
022200             15  PV-TL-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02220005
022300             15  PV-TL-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02230005
022400     05  PV-TOTALS-CUR-PERIOD        COMP-3.                      02240005
022500         10  PV-TL-CUR-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02250005
022600         10  PV-TL-CUR-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02260005
022700         10  PV-TL-CUR-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02270005
022800         10  PV-TL-CUR-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02280005
022900         10  PV-TL-CUR-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02290005
023000         10  PV-TL-CUR-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02300005
023100     05  PV-TOTALS-MTD               COMP-3.                      02310005
023200         10  PV-TL-MTD-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02320005
023300         10  PV-TL-MTD-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02330005
023400         10  PV-TL-MTD-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02340005
023500         10  PV-TL-MTD-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02350005
023600         10  PV-TL-MTD-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02360005
023700         10  PV-TL-MTD-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02370005
023800                                                                  02380005
023900*----------------------------------------------------------------*02390005
024000*  INPUT RECORD LAYOUT                                            02400005
024100*----------------------------------------------------------------*02410005
024200 01  CONTROL-CARD-DATE.                                           02420005
024300     05  CC-PROCESSING-PERIOD    PIC  X(01).                      02430005
024400         88  CC-PROCESS-WEEK                 VALUE 'W'.           02440005
024500         88  CC-PROCESS-MONTH                VALUE 'M'.           02450005
024600     05  FILLER                  PIC  X(05).                      02460005
024700     05  CC-FROM-DATE            PIC  X(08).                      02470005
024800     05  FILLER                  PIC  X(02).                      02480005
024900     05  CC-THRU-DATE            PIC  X(08).                      02490005
025000     05  FILLER                  PIC  X(56).                      02500005
025100                                                                  02510005
025200*----------------------------------------------------------------*02520005
025300*  INPUT RECORD LAYOUT                                            02530005
025400*----------------------------------------------------------------*02540005
025500     COPY APRD046.                                                02550005
025600                                                                  02560005
025700*----------------------------------------------------------------*02570005
025800* WORKING STORAGE NAME FORMATTING ROUTINE                         02580005
025900*----------------------------------------------------------------*02590005
026000     COPY DPWS024.                                                02600005
026100                                                                  02610005
026200*----------------------------------------------------------------*02620005
026300* WORKING STORAGE FOR DATE ROUTINE                                02630005
026400*----------------------------------------------------------------*02640005
026500     COPY DPWS500.                                                02650005
026600                                                                  02660005
026700*----------------------------------------------------------------*02670005
026800*  STANDARD HEADER LAYOUT                                         02680005
026900*----------------------------------------------------------------*02690005
027000     COPY DPWS150O.                                               02700005
027100                                                                  02710005
027200*----------------------------------------------------------------*02720005
027300*  REPORT LAYOUT                                                  02730005
027400*----------------------------------------------------------------*02740005
027500                                                                  02750005
027600 01  H2-HEADER2.                                                  02760005
027700     05  FILLER                  PIC  X(61)     VALUE SPACES.     02770005
027800     05  H2-TITLE                PIC  X(30)     VALUE             02780005
027900         'MERCHANDISE ADJUSTMENT JOURNAL'.                        02790005
028000     05  FILLER                  PIC  X(59)     VALUE SPACES.     02800005
028100                                                                  02810005
028200 01  H3-HEADER3.                                                  02820005
028300     05  FILLER                  PIC  X(65)     VALUE SPACES.     02830005
028400     05  H3-FROM-DATE            PIC  X(08)     VALUE SPACES.     02840005
028500     05  FILLER                  PIC  X(06)     VALUE ' THRU '.   02850005
028600     05  H3-THRU-DATE            PIC  X(08)     VALUE SPACES.     02860005
028700     05  FILLER                  PIC  X(63)     VALUE SPACES.     02870005
028800                                                                  02880005
028900 01 H4-HEADER4.                                                   02890005
029000     05  FILLER                  PIC  X(06)     VALUE 'DMM:  '.   02900005
029100     05  FILLER                  PIC  X(02)     VALUE SPACES.     02910005
029200     05  H4-DMA-NBR              PIC  X(02)     VALUE SPACES.     02920005
029300     05  FILLER                  PIC  X(02)     VALUE SPACES.     02930005
029400     05  H4-DMA-NAME             PIC  X(45)     VALUE SPACES.     02940005
029500     05  FILLER                  PIC  X(93)     VALUE SPACES.     02950005
029600                                                                  02960005
029700 01 H5-HEADER5.                                                   02970005
029800     05  FILLER                  PIC  X(06)     VALUE 'DEPT: '.   02980005
029900     05  FILLER                  PIC  X(01)     VALUE SPACES.     02990005
030000     05  H5-DEPT-NBR             PIC  X(03)     VALUE SPACES.     03000005
030100     05  FILLER                  PIC  X(02)     VALUE SPACES.     03010005
030200     05  H5-DEPT-DESC            PIC  X(40)     VALUE SPACES.     03020005
030300     05  FILLER                  PIC  X(98)     VALUE SPACES.     03030005
030400                                                                  03040005
030500 01 H6-HEADER6.                                                   03050005
030600     05  FILLER                  PIC  X(06)     VALUE 'CLASS:'.   03060005
030700     05  FILLER                  PIC  X(02)     VALUE SPACES.     03070005
030800     05  H6-MAJ-CL-NBR           PIC  X(02)     VALUE SPACES.     03080005
030900     05  FILLER                  PIC  X(02)     VALUE SPACES.     03090005
031000     05  H6-CL-DESC              PIC  X(45)     VALUE SPACES.     03100005
031100     05  FILLER                  PIC  X(93)     VALUE SPACES.     03110005
031200                                                                  03120005
031300 01 H7-HEADER7.                                                   03130005
031400     05  FILLER                  PIC  X(06)     VALUE 'BUYER:'.   03140005
031500     05  FILLER                  PIC  X(01)     VALUE SPACES.     03150005
031600     05  H7-BYR-NBR              PIC  X(03)     VALUE SPACES.     03160005
031700     05  FILLER                  PIC  X(02)     VALUE SPACES.     03170005
031800     05  H7-BYR-NAME             PIC  X(45)     VALUE SPACES.     03180005
031900     05  FILLER                  PIC  X(93)     VALUE SPACES.     03190005
032000                                                                  03200005
032100 01  H8-HEADER8.                                                  03210005
032200     05  FILLER                  PIC  X(09)     VALUE 'PO NUMBER'.03220005
032300     05  FILLER                  PIC  X(03)     VALUE SPACES.     03230005
032400     05  FILLER                  PIC  X(15)     VALUE             03240005
032500         'DOCUMENT NUMBER'.                                       03250005
032600     05  FILLER                  PIC  X(02)     VALUE SPACES.     03260005
032700     05  FILLER                  PIC  X(07)     VALUE 'ENTERED'.  03270005
032800     05  FILLER                  PIC  X(02)     VALUE SPACES.     03280005
032900     05  FILLER                  PIC  X(10)     VALUE             03290005
033000         'TRANS TYPE'.                                            03300005
033100     05  FILLER                  PIC  X(14)     VALUE SPACES.     03310005
033200     05  FILLER                  PIC  X(10)     VALUE             03320005
033300         'GROSS COST'.                                            03330005
033400     05  FILLER                  PIC  X(07)     VALUE SPACES.     03340005
033500     05  FILLER                  PIC  X(07)     VALUE 'FREIGHT'.  03350005
033600     05  FILLER                  PIC  X(06)     VALUE SPACES.     03360005
033700     05  FILLER                  PIC  X(08)     VALUE 'DISCOUNT'. 03370005
033800     05  FILLER                  PIC  X(06)     VALUE SPACES.     03380005
033900     05  FILLER                  PIC  X(09)     VALUE 'MISC COST'.03390005
034000     05  FILLER                  PIC  X(09)     VALUE SPACES.     03400005
034100     05  FILLER                  PIC  X(08)     VALUE 'NET COST'. 03410005
034200     05  FILLER                  PIC  X(11)     VALUE SPACES.     03420005
034300     05  FILLER                  PIC  X(06)     VALUE 'RETAIL'.   03430005
034400     05  FILLER                  PIC  X(01)     VALUE SPACES.     03440005
034500                                                                  03450005
034600 01  D1-DETAIL1.                                                  03460005
034700     05  FILLER                  PIC  X(08)     VALUE 'VENDOR: '. 03470005
034800     05  D1-VND-NME              PIC  X(30)     VALUE SPACES.     03480005
034900     05  FILLER                  PIC  X(01)     VALUE SPACES.     03490005
035000     05  D1-VND-NBR              PIC  X(09)     VALUE SPACES.     03500005
035100     05  FILLER                  PIC  X(07)     VALUE SPACES.     03510005
035200     05  FILLER                  PIC  X(95)     VALUE SPACES.     03520005
035300                                                                  03530005
035400 01 D2-DETAIL2.                                                   03540005
035500     05  D2-PO-NBR               PIC  ZZZ999999.                  03550005
035600     05  FILLER                  PIC  X(03)     VALUE SPACES.     03560005
035700     05  D2-DOC-NBR              PIC  X(16)     VALUE SPACES.     03570005
035800     05  FILLER                  PIC  X(01)     VALUE SPACES.     03580005
035900     05  D2-ENTERED-DTE.                                          03590005
036000         10  D2-ENTR-DTE-MM      PIC  X(02)     VALUE SPACES.     03600005
036100         10  FILLER              PIC  X(01)     VALUE '/'.        03610005
036200         10  D2-ENTR-DTE-DD      PIC  X(02)     VALUE SPACES.     03620005
036300         10  FILLER              PIC  X(01)     VALUE '/'.        03630005
036400         10  D2-ENTR-DTE-YY      PIC  X(02)     VALUE SPACES.     03640005
036500     05  FILLER                  PIC  X(01)     VALUE SPACES.     03650005
036600*    05  D2-TRN-SHRT-DESC        PIC  X(18)     VALUE SPACES.     03660005
036700*    05  FILLER                  PIC  X(03)     VALUE SPACES.     03670005
036800     05  D2-TRN-CDE              PIC  X(02)     VALUE SPACES.     03680005
036900     05  FILLER                  PIC  X(01)     VALUE SPACES.     03690005
037000     05  D2-TRN-SHRT-DESC        PIC  X(17)     VALUE SPACES.     03700005
037100     05  FILLER                  PIC  X(01)     VALUE SPACES.     03710005
037200     05  D2-GRO-AMT              PIC  ZZZZZZZZZZ.ZZ               03720005
037300                                                VALUE ZEROES.     03730005
037400     05  D2-GRO-NEG-IND-R        PIC  X(01)     VALUE SPACES.     03740005
037500     05  FILLER                  PIC  X(02)     VALUE SPACES.     03750005
037600     05  D2-FRGT-AMT             PIC  ZZZZZZZZ.ZZ                 03760005
037700                                                VALUE ZEROES.     03770005
037800     05  D2-FRGT-NEG-IND-R       PIC  X(01)     VALUE SPACES.     03780005
037900     05  FILLER                  PIC  X(02)     VALUE SPACES.     03790005
038000     05  D2-DISC-AMT             PIC  ZZZZZZZZ.ZZ                 03800005
038100                                                VALUE ZEROS.      03810005
038200     05  D2-DISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     03820005
038300     05  FILLER                  PIC  X(03)     VALUE SPACES.     03830005
038400     05  D2-MISC-AMT             PIC  ZZZZZZZZ.ZZ                 03840005
038500                                                VALUE ZEROS.      03850005
038600     05  D2-MISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     03860005
038700     05  FILLER                  PIC  X(03)     VALUE SPACES.     03870005
038800     05  D2-NET-AMT              PIC  ZZZZZZZZZZ.ZZ               03880005
038900                                                VALUE ZEROS.      03890005
039000     05  D2-NET-NEG-IND-R        PIC  X(01)     VALUE SPACES.     03900005
039100     05  FILLER                  PIC  X(03)     VALUE SPACES.     03910005
039200     05  D2-RETL-AMT             PIC  ZZZZZZZZZZ.ZZ               03920005
039300                                                VALUE ZEROS.      03930005
039400     05  D2-RETL-NEG-IND-R       PIC  X(01)     VALUE SPACES.     03940005
039500                                                                  03950005
039600                                                                  03960005
039700*     TOTAL LINES.                                                03970005
039800 01 T1-HEADER1.                                                   03980005
039900     05  FILLER                  PIC  X(18)     VALUE             03990005
040000         'TRANSACTION TOTALS'.                                    04000005
040100     05  T1-TEXT                 PIC  X(11)     VALUE SPACES.     04010005
040200     05  FILLER                  PIC  X(01)     VALUE SPACES.     04020005
040300     05  T1-DESC                 PIC  X(03)     VALUE SPACES.     04030005
040400     05  FILLER                  PIC  X(116)    VALUE SPACES.     04040005
040500                                                                  04050005
040600 01 T2-DETAIL2.                                                   04060005
040700*    05  FILLER                  PIC  X(32)     VALUE SPACES.     04070005
040800     05  FILLER                  PIC  X(29)     VALUE SPACES.     04080005
040900     05  T2-TRN-CDE              PIC  X(02)     VALUE SPACES.     04090005
041000     05  FILLER                  PIC  X(01)     VALUE SPACES.     04100005
041100     05  T2-TRANS-TYP            PIC  X(18)     VALUE SPACES.     04110005
041200     05  FILLER                  PIC  X(09)     VALUE SPACES.     04120005
041300     05  T2-GRO-AMT              PIC  ZZZZZZZZZZ.ZZ               04130005
041400                                                VALUE ZEROES.     04140005
041500     05  T2-GRO-NEG-IND-R        PIC  X(01)     VALUE SPACES.     04150005
041600     05  FILLER                  PIC  X(02)     VALUE SPACES.     04160005
041700     05  T2-FRGT-AMT             PIC  ZZZZZZZZ.ZZ                 04170005
041800                                                VALUE ZEROES.     04180005
041900     05  T2-FRGT-NEG-IND-R       PIC  X(01)     VALUE SPACES.     04190005
042000     05  FILLER                  PIC  X(02)     VALUE SPACES.     04200005
042100     05  T2-DISC-AMT             PIC  ZZZZZZZZ.ZZ                 04210005
042200                                                VALUE ZEROS.      04220005
042300     05  T2-DISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     04230005
042400     05  FILLER                  PIC  X(03)     VALUE SPACES.     04240005
042500     05  T2-MISC-AMT             PIC  ZZZZZZZZ.ZZ                 04250005
042600                                                VALUE ZEROS.      04260005
042700     05  T2-MISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     04270005
042800     05  FILLER                  PIC  X(03)     VALUE SPACES.     04280005
042900     05  T2-NET-AMT              PIC  ZZZZZZZZZZ.ZZ               04290005
043000                                                VALUE ZEROS.      04300005
043100     05  T2-NET-NEG-IND-R        PIC  X(01)     VALUE SPACES.     04310005
043200     05  FILLER                  PIC  X(03)     VALUE SPACES.     04320005
043300     05  T2-RETL-AMT             PIC  ZZZZZZZZZZ.ZZ               04330005
043400                                                VALUE ZEROS.      04340005
043500     05  T2-RETL-NEG-IND-R       PIC  X(01)     VALUE SPACES.     04350005
043600                                                                  04360005
043700 01 T3-DETAIL3.                                                   04370005
043800     05  FILLER                  PIC  X(24)     VALUE SPACES.     04380005
043900     05  T3-TEXT                 PIC  X(25)     VALUE SPACES.     04390005
044000     05  FILLER                  PIC  X(10)     VALUE SPACES.     04400005
044100     05  T3-GRO-AMT              PIC  ZZZZZZZZZZ.ZZ               04410005
044200                                                VALUE ZEROES.     04420005
044300     05  T3-GRO-NEG-IND-R        PIC  X(01)     VALUE SPACES.     04430005
044400     05  FILLER                  PIC  X(02)     VALUE SPACES.     04440005
044500     05  T3-FRGT-AMT             PIC  ZZZZZZZZ.ZZ                 04450005
044600                                                VALUE ZEROES.     04460005
044700     05  T3-FRGT-NEG-IND-R       PIC  X(01)     VALUE SPACES.     04470005
044800     05  FILLER                  PIC  X(02)     VALUE SPACES.     04480005
044900     05  T3-DISC-AMT             PIC  ZZZZZZZZ.ZZ                 04490005
045000                                                VALUE ZEROS.      04500005
045100     05  T3-DISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     04510005
045200     05  FILLER                  PIC  X(03)     VALUE SPACES.     04520005
045300     05  T3-MISC-AMT             PIC  ZZZZZZZZ.ZZ                 04530005
045400                                                VALUE ZEROS.      04540005
045500     05  T3-MISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     04550005
045600     05  FILLER                  PIC  X(03)     VALUE SPACES.     04560005
045700     05  T3-NET-AMT              PIC  ZZZZZZZZZZ.ZZ               04570005
045800                                                VALUE ZEROS.      04580005
045900     05  T3-NET-NEG-IND-R        PIC  X(01)     VALUE SPACES.     04590005
046000     05  FILLER                  PIC  X(03)     VALUE SPACES.     04600005
046100     05  T3-RETL-AMT             PIC  ZZZZZZZZZZ.ZZ               04610005
046200                                                VALUE ZEROS.      04620005
046300     05  T3-RETL-NEG-IND-R       PIC  X(01)     VALUE SPACES.     04630005
046400                                                                  04640005
046500 01 PC-DASH-LINE.                                                 04650005
046600     05  FILLER                  PIC  X(58)     VALUE SPACES.     04660005
046700     05  FILLER                  PIC  X(92)     VALUE ALL '_'.    04670005
046800                                                                  04680005
046900                                                                  04690005
047000 01  END-OF-REPORT.                                               04700005
047100     05  FILLER                  PIC  X(56)     VALUE SPACES.     04710005
047200     05  FILLER                  PIC  X(37)     VALUE             04720005
047300         '**********  END OF REPORT  **********'.                 04730005
047400     05  FILLER                  PIC  X(57)     VALUE SPACES.     04740005
047500                                                                  04750005
047600*----------------------------------------------------------------*04760005
047700*    SQL COMMUNICATIONS AREA DCLGEN                               04770005
047800*----------------------------------------------------------------*04780005
047900     EXEC SQL                                                     04790005
048000         INCLUDE SQLCA                                            04800005
048100     END-EXEC.                                                    04810005
048200                                                                  04820005
048300*----------------------------------------------------------------*04830005
048400*    AP PAYMENT CONTROL TABLE                                     04840005
048500*----------------------------------------------------------------*04850005
048600     EXEC SQL                                                     04860005
048700         INCLUDE TAPCNTL                                          04870005
048800     END-EXEC.                                                    04880005
048900                                                                  04890005
049000*----------------------------------------------------------------*04900005
049100*    MERCHANDISE AREA TABLE                                       04910005
049200*----------------------------------------------------------------*04920005
049300     EXEC SQL                                                     04930005
049400         INCLUDE TMDSEAR                                          04940005
049500     END-EXEC.                                                    04950005
049600                                                                  04960005
049700*----------------------------------------------------------------*04970005
049800*    RESPONSIBLITY AREA TABLE                                     04980005
049900*----------------------------------------------------------------*04990005
050000     EXEC SQL                                                     05000005
050100         INCLUDE TRSPBAR                                          05010005
050200     END-EXEC.                                                    05020005
050300                                                                  05030005
050400*----------------------------------------------------------------*05040005
050500*    AP TRANCODE TABLE                                            05050005
050600*----------------------------------------------------------------*05060005
050700     EXEC SQL                                                     05070005
050800         INCLUDE TTRNCDE                                          05080005
050900     END-EXEC.                                                    05090005
051000                                                                  05100005
051100*----------------------------------------------------------------*05110005
051200* TRANCODE_CSR GETS ALL MERCHANDISE LEDGER TRANCODES             *05120005
051300*----------------------------------------------------------------*05130005
051400     EXEC SQL                                                     05140005
051500       DECLARE TRANCODE_CSR CURSOR FOR                            05150005
051600        SELECT AP_TRN_CDE                                         05160005
051700          FROM TTRNCDE                                            05170005
051710         WHERE ML_PSTG_IND  = 'Y'                                 05171005
051720           AND TRN_TYP_CDE = 'MDS'                                05172005
051730           AND :APCNTL-BTCH-PRC-DTE BETWEEN EFF_STRT_DTE          05173005
051740                                        AND EFF_END_DTE           05174005
051750      ORDER BY AP_TRN_CDE                                         05175005
051760     END-EXEC.                                                    05176005
051770*----------------------------------------------------------------*05177005
051780*  ABEND DATA AREAS                                               05178005
051790*----------------------------------------------------------------*05179005
051800 01  ABEND-CODE                  PIC S9(4)      VALUE ZEROES      05180005
051810                                 COMP           SYNC.             05181005
051820                                                                  05182005
051830     88  AC-ANY-ERROR                           VALUE +4001       05183005
051840                                                THRU  +4019.      05184005
051850     88  AC-INVALID-KEY-WRITE                   VALUE +4001.      05185005
051860     88  AC-INVALID-KEY-READ                    VALUE +4002.      05186005
051870     88  AC-INVALID-CONTROL-CARD                VALUE +4003.      05187005
051880     88  AC-TABLE-OVERFLOW                      VALUE +4004.      05188005
051890     88  AC-OPEN-FILE-ERROR                     VALUE +4005.      05189005
051900     88  AC-CLOSE-FILE-ERROR                    VALUE +4006.      05190005
052000     88  AC-SEQUENCE-ERROR                      VALUE +4007.      05200005
052100     88  AC-INVALID-DATA                        VALUE +4008.      05210005
052200     88  AC-INVALID-KEYPUNCH                    VALUE +4009.      05220005
052300     88  AC-INTERNAL-SORT-ERROR                 VALUE +4012.      05230005
052400     88  AC-DB2-ERROR                           VALUE +4013.      05240005
052500     88  AC-DPWS500-DATE-ERROR                  VALUE +4019.      05250005
052600                                                                  05260005
052700                                                                  05270005
052800 01  ABEND-AREAS.                                                 05280005
052900     05  AA-ABEND-LIT            PIC  X(40)     VALUE             05290005
053000             '*****       ABEND'.                                 05300005
053100     05  AA-PROGRAM-LIT          PIC  X(40)     VALUE             05310005
053200             '*****   PROGRAM: APKRP140'.                         05320005
053300     05  AA-PARAGRAPH-LIT.                                        05330005
053400         10  FILLER              PIC  X(17)     VALUE             05340005
053500             '***** PARAGRAPH: '.                                 05350005
053600         10  AA-PARAGRAPH-NAME   PIC  X(35)     VALUE SPACES.     05360005
053700     05  AA-MESSAGE-LINE-1.                                       05370005
053800         10  FILLER              PIC  X(06)     VALUE '*****'.    05380005
053900         10  AA-MESSAGE-1        PIC  X(80)     VALUE SPACES.     05390005
054000     05  AA-MESSAGE-LINE-2.                                       05400005
054100         10  FILLER              PIC  X(06)     VALUE '*****'.    05410005
054200         10  AA-MESSAGE-2        PIC  X(80)     VALUE SPACES.     05420005
054300     05  AA-DB2-ERROR-LIT        PIC  X(40)     VALUE             05430005
054400             '*****    DB2 ERROR'.                                05440005
054500     05  AA-DB2-OPERATION-LIT.                                    05450005
054600         10  FILLER              PIC  X(17)     VALUE             05460005
054700             '***** OPERATION: '.                                 05470005
054800         10  AA-DB2-OPERATION.                                    05480005
054900             15  AA-DB2-OP-1     PIC  X(25)     VALUE SPACES.     05490005
055000             15  AA-DB2-OP-2     PIC  X(25)     VALUE SPACES.     05500005
055100     05  AA-DB2-TABLE-1          PIC  X(08)     VALUE SPACES.     05510005
055200     05  AA-DB2-TABLE-2          PIC  X(08)     VALUE SPACES.     05520005
055300     05  AA-DB2-TABLE-3          PIC  X(08)     VALUE SPACES.     05530005
055400                                                                  05540005
055500*----------------------------------------------------------------*05550005
055600*  SQLCA FORMATTED MESSAGE AREA                                   05560005
055700*----------------------------------------------------------------*05570005
055800     COPY DPWS004.                                                05580005
055900                                                                  05590005
056000 01  FILLER                      PIC  X(25)     VALUE             05600005
056100     '** END OF APKRP140 W/S **'.                                 05610005
056200                                                                  05620005
056300 PROCEDURE DIVISION.                                              05630005
056400 A100-MAIN.                                                       05640005
056500                                                                  05650005
056600     PERFORM B100-INITIALIZE.                                     05660005
056700                                                                  05670005
056800     PERFORM B200-PROCESS-ADJ-EXTRACT-FILE                        05680005
056900         UNTIL PS-ADJ-EOF.                                        05690005
057000                                                                  05700005
057100     PERFORM B300-END-OF-PROGRAM.                                 05710005
057200                                                                  05720005
057300     GOBACK.                                                      05730005
057400                                                                  05740005
057500                                                                  05750005
057600 B100-INITIALIZE.                                                 05760005
057700*----------------------------------------------------------------*05770005
057800*    INITIALIZATION PROCESSING                                   *05780005
057900*                                                                *05790005
058000*    - INTIALIZE LAYOUTS.                                        *05800005
058100*    - OPEN FILES.                                               *05810005
058200*    - FORMAT PAGE HEADINGS.                                     *05820005
058300*    - READ INPUT FILE.                                          *05830005
058400*    - PROCESS HEADER RECORD DATA.                               *05840005
058500*    - LOAD TRANCODE TABLE.                                      *05850005
058600*----------------------------------------------------------------*05860005
058700                                                                  05870005
058800     DISPLAY '***********************************'.               05880005
058900     DISPLAY '**  APKRP140  (PROCESSING MSGS)  **'.               05890005
059000                                                                  05900005
059100     OPEN INPUT  ADJ-EXTRACT-FILE                                 05910005
059200          OUTPUT REPORT-FILE.                                     05920005
059300                                                                  05930005
059400     INITIALIZE DCLTAPCNTL                                        05940005
059500                DCLTMDSEAR                                        05950005
059600                DCLTRSPBAR                                        05960005
059700                DCLTTRNCDE                                        05970005
059800                PV-DMA-TABLE                                      05980005
059900                PV-DEPT-TABLE                                     05990005
060000                PV-CLASS-TABLE                                    06000005
060100                PV-TOTALS-TABLE.                                  06010005
060200                                                                  06020005
060300*    EDIT AND PROCESS CONTROL CARD                                06030005
060400     ACCEPT CONTROL-CARD-DATE.                                    06040005
060500     IF CC-PROCESS-WEEK OR CC-PROCESS-MONTH                       06050005
060600         NEXT SENTENCE                                            06060005
060700     ELSE                                                         06070005
060800         MOVE 'B100-INITIALIZE'  TO AA-PARAGRAPH-NAME             06080005
060900         MOVE 'INVALID PROCESSING PERIOD'                         06090005
061000                                 TO AA-MESSAGE-1                  06100005
061100         MOVE SPACES             TO AA-MESSAGE-2                  06110005
061200         SET AC-INVALID-CONTROL-CARD TO TRUE                      06120005
061300         PERFORM Z998-ABEND                                       06130005
061400     END-IF.                                                      06140005
061500                                                                  06150005
061600*    DISPLAY CONTROL CARD INFO                                    06160005
061700     DISPLAY '** CONTROL CARD = ' CONTROL-CARD-DATE.              06170005
061800                                                                  06180005
061900     IF CC-PROCESS-WEEK                                           06190005
062000         PERFORM B110-RETRIEVE-WEEK-INFO                          06200005
062100     ELSE                                                         06210005
062200         PERFORM B120-RETRIEVE-MONTH-INFO                         06220005
062300     END-IF.                                                      06230005
062400                                                                  06240005
062500     IF CC-PROCESS-WEEK                                           06250005
062600         DISPLAY '** POSTING WK # =    ' APCNTL-CURR-PSTG-FWK-NBR 06260005
062700         DISPLAY '** POSTING WK DATE = ' APCNTL-BTCH-PRC-DTE      06270005
062800     ELSE                                                         06280005
062900         DISPLAY '** POSTING YR # = ' APCNTL-PREV-PSTG-FYR-NBR    06290005
063000         DISPLAY '** POSTING MN # = ' APCNTL-PREV-PSTG-FMN-NBR    06300005
063100     END-IF.                                                      06310005
063200                                                                  06320005
063300     IF CC-FROM-DATE = SPACES AND                                 06330005
063400        CC-THRU-DATE = SPACES                                     06340005
063500         CONTINUE                                                 06350005
063600     ELSE                                                         06360005
063700         MOVE CC-FROM-DATE TO H3-FROM-DATE                        06370005
063800         MOVE CC-THRU-DATE TO H3-THRU-DATE                        06380005
063900         DISPLAY '!! TAPCNTL DATE OVERRIDDEN !! '                 06390005
064000         DISPLAY '!! FROM DATE ' H3-FROM-DATE                     06400005
064100         DISPLAY '!! THRU DATE ' H3-THRU-DATE                     06410005
064200     END-IF.                                                      06420005
064300                                                                  06430005
064400*    FORMAT HEADING DATA                                          06440005
064500     ACCEPT PV-CURRENT-DATE FROM DATE.                            06450005
064600     MOVE PV-CURRENT-MONTH       TO DP150O-RUN-MONTH.             06460005
064700     MOVE PV-CURRENT-DAY         TO DP150O-RUN-DAY.               06470005
064800     MOVE PV-CURRENT-YEAR        TO DP150O-RUN-YEAR.              06480005
064900                                                                  06490005
064910     ACCEPT PV-CURRENT-TIME FROM TIME.                            06491005
064920     MOVE PV-CURRENT-HOUR        TO DP150O-RUN-HOUR.              06492005
064930     MOVE PV-CURRENT-MINUTE      TO DP150O-RUN-MINUTE.            06493005
064940     MOVE PC-PROGRAM-NAME        TO DP150O-PROGRAM-NAME.          06494005
064950     MOVE 1                      TO DP150O-REPORT-NUMBER.         06495005
064960                                                                  06496005
064970     PERFORM W100-WRITE-HEADINGS.                                 06497005
064980                                                                  06498005
064990*    PERFORM INITIAL READ OF INPUT FILE                           06499005
065000     PERFORM R100-READ-INPUT.                                     06500005
065100     IF PS-ADJ-EOF                                                06510005
065200         DISPLAY ' NO RECORDS TO PROCESS. EMPTY INPUT DATASET'    06520005
065300     END-IF.                                                      06530005
065400                                                                  06540005
065500*    PROCESS HEADER RECORD DATA                                   06550005
065600     IF PS-ADJ-NOT-EOF                                            06560005
065700         PERFORM C100-PROCESS-HEADER                              06570005
065800         PERFORM W200-WRITE-DETAIL-HEADINGS                       06580005
065900         PERFORM Y100-OPEN-TRANCODE-CURSOR                        06590005
066000         PERFORM S700-FETCH-TRANCODE                              06600005
066100         PERFORM VARYING TRN-IDX FROM 1 BY 1                      06610005
066200           UNTIL PV-TRNCDE-CSR-AT-END                             06620005
066300              OR TRN-IDX > 999                                    06630005
066400            IF TRN-IDX > 999                                      06640005
066500               MOVE 'B100-INITIALIZE' TO AA-PARAGRAPH-NAME        06650005
066600               MOVE 'TRANCODE TABLE EXCEEDS 999 ENTRIES'          06660005
066700                                      TO AA-MESSAGE-1             06670005
066800               SET AC-TABLE-OVERFLOW  TO TRUE                     06680005
066810               PERFORM Z998-ABEND                                 06681005
066820            ELSE                                                  06682005
066830               MOVE TRNCDE-AP-TRN-CDE TO PV-TR-TRANCODE(TRN-IDX)  06683005
066840               ADD +1 TO PV-TRCODE-COUNT                          06684005
066850               MOVE PV-TRCODE-COUNT  TO PV-TR-SUBSCRIPT(TRN-IDX)  06685005
066851               PERFORM S700-FETCH-TRANCODE                        06685105
066852            END-IF                                                06685205
066853         END-PERFORM                                              06685305
066854         PERFORM Y200-CLOSE-TRNCODE-CURSOR                        06685405
066855     END-IF.                                                      06685505
066856                                                                  06685605
066857                                                                  06685705
066858 B110-RETRIEVE-WEEK-INFO.                                         06685805
066859                                                                  06685905
066860     PERFORM S100-GET-CURRENT-PSTG-PERIOD.                        06686005
066870     MOVE APCNTL-CURR-PSTG-FWK-NBR     TO PV-HLD-FWK-NBR.         06687005
066880                                                                  06688005
066890     INITIALIZE DPG51                                             06689005
066900                DPG52                                             06690005
067000                DPG53                                             06700005
067100                DPG54                                             06710005
067200                DPG55                                             06720005
067300                DPG56.                                            06730005
067400                                                                  06740005
067500     SET DPG51-FISCAL-454-CALENDAR     TO TRUE.                   06750005
067600     SET DPG52-LK-DTE-ISO-FMT          TO TRUE.                   06760005
067700     MOVE APCNTL-BTCH-PRC-DTE          TO DPG52-DB2-ISO-DATE-FMT. 06770005
067800                                                                  06780005
067900     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    06790005
068000                                             DPG54 DPG55 DPG56.   06800005
068100                                                                  06810005
068200     IF DPG54-SEVERE-ERROR OR DPG54-WARNING-ERROR                 06820005
068300         MOVE 'B110-RETRIEVE-WEEK-INFO'                           06830005
068400                                       TO AA-PARAGRAPH-NAME       06840005
068500         MOVE DPG54-ERROR-MESSAGE                                 06850005
068600                                       TO AA-MESSAGE-1            06860005
068700         MOVE DPG52-DB2-ISO-DATE-FMT   TO AA-MESSAGE-2            06870005
068800         SET AC-DPWS500-DATE-ERROR     TO TRUE                    06880005
068900         PERFORM Z998-ABEND                                       06890005
069000     END-IF.                                                      06900005
069100                                                                  06910005
069200     MOVE DPG55-1ST-WKDY-GREG-FMT      TO H3-FROM-DATE.           06920005
069300     MOVE DPG55-LAST-WKDY-GREG-FMT     TO H3-THRU-DATE.           06930005
069400                                                                  06940005
069500                                                                  06950005
069600 B120-RETRIEVE-MONTH-INFO.                                        06960005
069700                                                                  06970005
069800     PERFORM S200-GET-PREVIOUS-PSTG-PERIOD.                       06980005
069900                                                                  06990005
070000     INITIALIZE DPG51                                             07000005
070100                DPG52                                             07010005
070200                DPG53                                             07020005
070300                DPG54                                             07030005
070400                DPG55                                             07040005
070500                DPG56.                                            07050005
070600                                                                  07060005
070700     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       07070005
070800     SET DPG52-LK-DTE-FISC-PRD-CC  TO TRUE.                       07080005
070900     MOVE APCNTL-PREV-PSTG-FYR-NBR                                07090005
071000                                 TO DPG52-FISCAL-CC-PRD-YR.       07100005
071100     MOVE APCNTL-PREV-PSTG-FMN-NBR                                07110005
071200                                 TO DPG52-FISCAL-CC-PRD-PP.       07120005
071300                                                                  07130005
071400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    07140005
071500                                             DPG54 DPG55 DPG56.   07150005
071600                                                                  07160005
071700     IF DPG54-SEVERE-ERROR OR DPG54-WARNING-ERROR                 07170005
071800         MOVE 'B120-RETRIEVE-MONTH-INFO'                          07180005
071900                                 TO AA-PARAGRAPH-NAME             07190005
072000         MOVE DPG54-ERROR-MESSAGE                                 07200005
072100                                 TO AA-MESSAGE-1                  07210005
072200         MOVE SPACES             TO AA-MESSAGE-2                  07220005
072300         SET AC-DPWS500-DATE-ERROR TO TRUE                        07230005
072400         PERFORM Z998-ABEND                                       07240005
072500     END-IF.                                                      07250005
072600                                                                  07260005
072700     MOVE DPG56-FIRST-FP-GREG-FMT      TO H3-FROM-DATE.           07270005
072800     MOVE DPG56-LAST-FP-GREG-FMT       TO H3-THRU-DATE.           07280005
072900                                                                  07290005
073000                                                                  07300005
073100*----------------------------------------------------------------*07310005
073200*    PROCESS ADJUSTMENT EXTRACT FILE.                            *07320005
073300*                                                                *07330005
073400*    - CHECK FOR CONTROL BREAKS.                                 *07340005
073500*    - PROCESS AND ACCUMULATE DETAIL DATA.                       *07350005
073600*    - READ THE ADJUSTMENT EXTRACT FILE.                         *07360005
073700*----------------------------------------------------------------*07370005
073800 B200-PROCESS-ADJ-EXTRACT-FILE.                                   07380005
073900                                                                  07390005
074000     IF AP046-DMA-NBR NOT = PV-HLD-DMA-NBR                        07400005
074100         PERFORM D100-MAJOR-CLASS-BREAK                           07410005
074200         PERFORM D200-DEPT-BREAK                                  07420005
074300         PERFORM D300-DMA-BREAK                                   07430005
074400         PERFORM C100-PROCESS-HEADER                              07440005
074500         PERFORM W100-WRITE-HEADINGS                              07450005
074600         PERFORM W200-WRITE-DETAIL-HEADINGS                       07460005
074700     END-IF.                                                      07470005
074800                                                                  07480005
074900                                                                  07490005
075000     IF AP046-DEPT-NBR NOT = PV-HLD-DEPT-NBR                      07500005
075100         PERFORM D100-MAJOR-CLASS-BREAK                           07510005
075200         PERFORM D200-DEPT-BREAK                                  07520005
075300         PERFORM C100-PROCESS-HEADER                              07530005
075400         PERFORM W100-WRITE-HEADINGS                              07540005
075500         PERFORM W200-WRITE-DETAIL-HEADINGS                       07550005
075600     END-IF.                                                      07560005
075700                                                                  07570005
075800     IF AP046-MAJ-CL-NBR NOT = PV-HLD-MAJ-CL-NBR                  07580005
075900         PERFORM D100-MAJOR-CLASS-BREAK                           07590005
076000         PERFORM C100-PROCESS-HEADER                              07600005
076100         PERFORM W100-WRITE-HEADINGS                              07610005
076200         PERFORM W200-WRITE-DETAIL-HEADINGS                       07620005
076300     END-IF.                                                      07630005
076400                                                                  07640005
076500     IF AP046-VND-NBR NOT = PV-HLD-VND-NBR                        07650005
076600         MOVE AP046-ENT-NME-DESC     TO D1-VND-NME                07660005
076700         MOVE AP046-VND-NBR          TO D1-VND-NBR                07670005
076800                                        PV-HLD-VND-NBR            07680005
076900         SET PS-NEED-VNDR-HEADNG     TO TRUE                      07690005
077000     END-IF.                                                      07700005
077100                                                                  07710005
077200*    PROCESS THE DETAIL RECORD                                    07720005
077300     IF (CC-PROCESS-WEEK AND AP046-PSTG-FWK-NBR = PV-HLD-FWK-NBR) 07730005
077400       OR CC-PROCESS-MONTH                                        07740005
077500         PERFORM L500-FORMAT-DETAIL                               07750005
077600         PERFORM P100-ACCUMULATE-TRN-TOTALS                       07760005
077700         PERFORM P200-ACCUMULATE-CUR-TOTALS                       07770005
077800     END-IF.                                                      07780005
077900                                                                  07790005
078000     PERFORM P300-ACCUMULATE-MTD-TOTALS                           07800005
078100                                                                  07810005
078200*    READ THE ADJUSTMENT EXTRACT FILE                             07820005
078300     PERFORM R100-READ-INPUT.                                     07830005
078400                                                                  07840005
078500                                                                  07850005
078600 B300-END-OF-PROGRAM.                                             07860005
078700*----------------------------------------------------------------*07870005
078800*    END OF PROGRAM                                              *07880005
078900*                                                                *07890005
079000*    - PROCESS THE FINAL REPORT TOTALS.                          *07900005
079100*    - CLOSE THE FILES.                                          *07910005
079200*----------------------------------------------------------------*07920005
079300                                                                  07930005
079400     IF PV-READ-COUNT > ZEROES                                    07940005
079500         PERFORM D100-MAJOR-CLASS-BREAK                           07950005
079600         PERFORM D200-DEPT-BREAK                                  07960005
079700         PERFORM D300-DMA-BREAK                                   07970005
079800         PERFORM D400-GRAND-TOTALS                                07980005
079900     END-IF.                                                      07990005
080000                                                                  08000005
080100     WRITE REPORT-REC FROM END-OF-REPORT AFTER 2.                 08010005
080200                                                                  08020005
080300     DISPLAY '** END OF APKRP140 PROCESSING **'.                  08030005
080400     DISPLAY '** TOTAL RECORDS READ    = ' PV-READ-COUNT.         08040005
080500     DISPLAY ' ' .                                                08050005
080600                                                                  08060005
080700     CLOSE ADJ-EXTRACT-FILE                                       08070005
080800           REPORT-FILE.                                           08080005
080900                                                                  08090005
081000                                                                  08100005
081100 C100-PROCESS-HEADER.                                             08110005
081200*----------------------------------------------------------------*08120005
081300*    PROCESS HEADER RECORD.                                      *08130005
081400*                                                                *08140005
081500*    - SET UP SAVED FIELDS.                                      *08150005
081600*    - GET DB2 DATA FOR REPORT.                                  *08160005
081700*----------------------------------------------------------------*08170005
081800                                                                  08180005
081900*    - GET DB2 DATA FOR REPORT                                    08190005
082000     IF AP046-DMA-NBR NOT = PV-HLD-DMA-NBR                        08200005
082100         MOVE AP046-DMA-NBR                TO MDSEAR-DMA-NBR      08210005
082200         PERFORM S300-GET-DMA-NAME                                08220005
082300         MOVE 45                           TO DP024-FLNAME-LENGTH 08230005
082400         MOVE RSPBAR-WORKER-FIR-NAME       TO DP024-FNAME         08240005
082500         MOVE RSPBAR-WORKER-LAST-NAME      TO DP024-LNAME         08250005
082600         PERFORM DP024-0000-FORMAT-NAME                           08260005
082700         MOVE AP046-DMA-NBR                TO H4-DMA-NBR          08270005
082800         MOVE DP024-FLNAME                 TO H4-DMA-NAME         08280005
082900         MOVE SPACES                       TO PV-HLD-DEPT-NBR     08290005
083000         MOVE SPACES                       TO PV-HLD-MAJ-CL-NBR   08300005
083100     END-IF.                                                      08310005
083200                                                                  08320005
083300     IF AP046-DEPT-NBR NOT = PV-HLD-DEPT-NBR                      08330005
083400         MOVE AP046-DEPT-NBR               TO MDSEAR-DEPT-NBR     08340005
083500         PERFORM S400-GET-DEPT-NAME                               08350005
083600         PERFORM S600-GET-BUYER-NAME                              08360005
083601         MOVE 45                           TO DP024-FLNAME-LENGTH 08360105
083602         MOVE RSPBAR-WORKER-FIR-NAME       TO DP024-FNAME         08360205
083603         MOVE RSPBAR-WORKER-LAST-NAME      TO DP024-LNAME         08360305
083604         PERFORM DP024-0000-FORMAT-NAME                           08360405
083605         MOVE AP046-DEPT-NBR               TO H5-DEPT-NBR         08360505
083606         MOVE MDSEAR-DESC                  TO H5-DEPT-DESC        08360605
083607         MOVE MDSEAR-BYR-NBR               TO H7-BYR-NBR          08360705
083608         MOVE DP024-FLNAME                 TO H7-BYR-NAME         08360805
083609         MOVE SPACES                       TO PV-HLD-MAJ-CL-NBR   08360905
083610     END-IF.                                                      08361005
083620                                                                  08362005
083630     IF AP046-MAJ-CL-NBR NOT = PV-HLD-MAJ-CL-NBR                  08363005
083640         MOVE AP046-DEPT-NBR               TO MDSEAR-DEPT-NBR     08364005
083650         MOVE AP046-MAJ-CL-NBR             TO MDSEAR-MAJ-CL-NBR   08365005
083660         PERFORM S500-GET-MAJOR-CLASS-DESC                        08366005
083670         MOVE AP046-MAJ-CL-NBR             TO H6-MAJ-CL-NBR       08367005
083680         MOVE MDSEAR-DESC                  TO H6-CL-DESC          08368005
083690     END-IF.                                                      08369005
083700                                                                  08370005
083800     MOVE AP046-DMA-NBR                    TO PV-HLD-DMA-NBR.     08380005
083900     MOVE AP046-DEPT-NBR                   TO PV-HLD-DEPT-NBR.    08390005
084000     MOVE AP046-MAJ-CL-NBR                 TO PV-HLD-MAJ-CL-NBR.  08400005
084100                                                                  08410005
084200                                                                  08420005
084300 D100-MAJOR-CLASS-BREAK.                                          08430005
084400                                                                  08440005
084500     MOVE PC-FOR-CLASS                     TO T1-TEXT.            08450005
084600     MOVE PV-HLD-MAJ-CL-NBR                TO T1-DESC.            08460005
084700                                                                  08470005
084800     IF (PV-LINES-PER-PAGE + 8) > PC-LINES-PER-PAGE-MAX           08480005
084900         PERFORM W100-WRITE-HEADINGS                              08490005
085000         PERFORM W200-WRITE-DETAIL-HEADINGS                       08500005
085100         MOVE +2                           TO PV-LINE-SKIP        08510005
085200     ELSE                                                         08520005
085300         MOVE +3                           TO PV-LINE-SKIP        08530005
085400     END-IF.                                                      08540005
085500                                                                  08550005
085600     MOVE  T1-HEADER1                      TO PV-REPORT-REC.      08560005
085700     PERFORM W300-PRINT-DETAIL.                                   08570005
085800                                                                  08580005
085900     MOVE SPACES                           TO PV-REPORT-REC.      08590005
086000     MOVE +1                               TO PV-LINE-SKIP.       08600005
086100     PERFORM W300-PRINT-DETAIL.                                   08610005
086200                                                                  08620005
086300     IF CC-PROCESS-WEEK                                           08630005
086400         IF PS-CL-TOTALS                                          08640005
086500             PERFORM F100-PRINT-CLASS-TRAN-CODES                  08650005
086600             PERFORM G100-PRINT-CLASS-CUR-TOTALS                  08660005
086700             PERFORM H100-PRINT-CLASS-MTD-TOTALS                  08670005
086800         ELSE                                                     08680005
086900             PERFORM H100-PRINT-CLASS-MTD-TOTALS                  08690005
087000         END-IF                                                   08700005
087100     ELSE                                                         08710005
087200         PERFORM F100-PRINT-CLASS-TRAN-CODES                      08720005
087300         PERFORM G100-PRINT-CLASS-CUR-TOTALS                      08730005
087400     END-IF.                                                      08740005
087500                                                                  08750005
087600     SET PS-CL-NO-TOTALS                                          08760005
087700         PS-NEED-VNDR-HEADNG               TO TRUE.               08770005
087800     INITIALIZE PV-CLASS-TABLE.                                   08780005
087900                                                                  08790005
088000                                                                  08800005
088100 D200-DEPT-BREAK.                                                 08810005
088200                                                                  08820005
088300     SET PS-DEPT-TOTALS                    TO TRUE.               08830005
088400                                                                  08840005
088500     MOVE PC-FOR-DEPT                      TO T1-TEXT.            08850005
088600     MOVE PV-HLD-DEPT-NBR                  TO T1-DESC.            08860005
088700     PERFORM W100-WRITE-HEADINGS.                                 08870005
088800     PERFORM W200-WRITE-DETAIL-HEADINGS.                          08880005
088900     MOVE +2                               TO PV-LINE-SKIP.       08890005
089000                                                                  08900005
089100     MOVE  T1-HEADER1                      TO PV-REPORT-REC.      08910005
089200     PERFORM W300-PRINT-DETAIL.                                   08920005
089300                                                                  08930005
089400     MOVE SPACES                           TO PV-REPORT-REC.      08940005
089500     MOVE +1                               TO PV-LINE-SKIP.       08950005
089600     PERFORM W300-PRINT-DETAIL.                                   08960005
089700                                                                  08970005
089800     IF CC-PROCESS-WEEK                                           08980005
089900         IF PS-DP-TOTALS                                          08990005
090000             PERFORM F200-PRINT-DEPT-TRAN-CODES                   09000005
090100             PERFORM G200-PRINT-DEPT-CUR-TOTALS                   09010005
090200             PERFORM H200-PRINT-DEPT-MTD-TOTALS                   09020005
090300         ELSE                                                     09030005
090400             PERFORM H200-PRINT-DEPT-MTD-TOTALS                   09040005
090500         END-IF                                                   09050005
090600     ELSE                                                         09060005
090700         PERFORM F200-PRINT-DEPT-TRAN-CODES                       09070005
090800         PERFORM G200-PRINT-DEPT-CUR-TOTALS                       09080005
090900     END-IF.                                                      09090005
091000                                                                  09100005
091100     SET PS-DP-NO-TOTALS                                          09110005
091200         PS-NO-DEPT-TOTALS                                        09120005
091300         PS-NEED-VNDR-HEADNG               TO TRUE.               09130005
091400     INITIALIZE PV-DEPT-TABLE.                                    09140005
091500                                                                  09150005
091600                                                                  09160005
091700 D300-DMA-BREAK.                                                  09170005
091800                                                                  09180005
091900     SET PS-DMA-TOTALS                     TO TRUE.               09190005
092000                                                                  09200005
092100     PERFORM W100-WRITE-HEADINGS.                                 09210005
092200     PERFORM W200-WRITE-DETAIL-HEADINGS.                          09220005
092300                                                                  09230005
092400     MOVE PC-FOR-DMA                       TO T1-TEXT.            09240005
092500     MOVE PV-HLD-DMA-NBR                   TO T1-DESC.            09250005
092600     MOVE  T1-HEADER1                      TO PV-REPORT-REC.      09260005
092700     MOVE +2                               TO PV-LINE-SKIP.       09270005
092800     PERFORM W300-PRINT-DETAIL.                                   09280005
092900     MOVE SPACES                           TO PV-REPORT-REC.      09290005
093000     MOVE +1                               TO PV-LINE-SKIP.       09300005
093100     PERFORM W300-PRINT-DETAIL.                                   09310005
093200                                                                  09320005
093300     IF CC-PROCESS-WEEK                                           09330005
093400         IF PS-DM-TOTALS                                          09340005
093500             PERFORM F300-PRINT-DMA-TRAN-CODES                    09350005
093600             PERFORM G300-PRINT-DMA-CUR-TOTALS                    09360005
093700             PERFORM H300-PRINT-DMA-MTD-TOTALS                    09370005
093800         ELSE                                                     09380005
093900             PERFORM H300-PRINT-DMA-MTD-TOTALS                    09390005
094000         END-IF                                                   09400005
094100     ELSE                                                         09410005
094200         PERFORM F300-PRINT-DMA-TRAN-CODES                        09420005
094300         PERFORM G300-PRINT-DMA-CUR-TOTALS                        09430005
094400     END-IF.                                                      09440005
094500                                                                  09450005
094600     SET PS-DM-NO-TOTALS                                          09460005
094700         PS-NO-DMA-TOTALS                                         09470005
094800         PS-NEED-VNDR-HEADNG               TO TRUE.               09480005
094900     INITIALIZE PV-DMA-TABLE.                                     09490005
095000                                                                  09500005
095100                                                                  09510005
095200 D400-GRAND-TOTALS.                                               09520005
095300                                                                  09530005
095400     SET PS-TOTALS                         TO TRUE.               09540005
095500                                                                  09550005
095600     PERFORM W100-WRITE-HEADINGS.                                 09560005
095700     PERFORM W200-WRITE-DETAIL-HEADINGS.                          09570005
095800                                                                  09580005
095900     MOVE SPACES                           TO T1-TEXT             09590005
096000                                              T1-DESC.            09600005
096100     MOVE  T1-HEADER1                      TO PV-REPORT-REC.      09610005
096200     MOVE +2                               TO PV-LINE-SKIP.       09620005
096300     PERFORM W300-PRINT-DETAIL.                                   09630005
096400     MOVE SPACES                           TO PV-REPORT-REC.      09640005
096500     MOVE +1                               TO PV-LINE-SKIP.       09650005
096600     PERFORM W300-PRINT-DETAIL.                                   09660005
096700                                                                  09670005
096800     IF CC-PROCESS-WEEK                                           09680005
096900         IF PS-TL-TOTALS                                          09690005
097000             PERFORM F400-PRINT-TOTALS-TRAN-CODES                 09700005
097100             PERFORM G400-PRINT-TOTALS-CUR-TOTALS                 09710005
097200             PERFORM H400-PRINT-TOTALS-MTD-TOTALS                 09720005
097300         ELSE                                                     09730005
097400             PERFORM H400-PRINT-TOTALS-MTD-TOTALS                 09740005
097500         END-IF                                                   09750005
097600     ELSE                                                         09760005
097700         PERFORM F400-PRINT-TOTALS-TRAN-CODES                     09770005
097800         PERFORM G400-PRINT-TOTALS-CUR-TOTALS                     09780005
097900     END-IF.                                                      09790005
098000                                                                  09800005
098100     SET PS-TL-NO-TOTALS                                          09810005
098200         PS-NO-TOTALS                                             09820005
098300         PS-NEED-VNDR-HEADNG               TO TRUE.               09830005
098400     INITIALIZE PV-TOTALS-TABLE.                                  09840005
098500                                                                  09850005
098600                                                                  09860005
098700 F100-PRINT-CLASS-TRAN-CODES.                                     09870005
098800                                                                  09880005
098900     PERFORM                                                      09890005
099000       VARYING TBL-SUB FROM 1 BY 1                                09900005
099100       UNTIL   TBL-SUB > PC-TBL-MAX                               09910005
099200*        DISPLAY 'TBL-SUB ' TBL-SUB                               09920005
099300*               ' CL-DESC ' PV-CL-DESC                            09930005
099400         IF PV-CL-RETL-AMT    (TBL-SUB)   = ZEROS                 09940005
099500           AND PV-CL-GRO-AMT  (TBL-SUB)   = ZEROS                 09950005
099600           AND PV-CL-FRGT-AMT (TBL-SUB)   = ZEROS                 09960005
099700           AND PV-CL-MISC-AMT (TBL-SUB)   = ZEROS                 09970005
099800           AND PV-CL-NET-AMT  (TBL-SUB)   = ZEROS                 09980005
099900           AND PV-CL-DISC-AMT (TBL-SUB)   = ZEROS                 09990005
100000             CONTINUE                                             10000005
100100         ELSE                                                     10010005
100200             MOVE PV-CLASS-TRNCDE-AMTS (TBL-SUB)                  10020005
100300                                           TO PV-HLD-AMOUNTS      10030005
100400             MOVE PV-CL-TRANCODE (TBL-SUB) TO T2-TRN-CDE          10040005
100500             MOVE PV-CL-DESC     (TBL-SUB) TO T2-TRANS-TYP        10050005
100600             PERFORM L100-FORMAT-TRANSACTION-TOTALS               10060005
100700         END-IF                                                   10070005
100800     END-PERFORM.                                                 10080005
100900                                                                  10090005
101000     MOVE  PC-DASH-LINE                    TO PV-REPORT-REC.      10100005
101100     MOVE +1                               TO PV-LINE-SKIP.       10110005
101200     PERFORM W300-PRINT-DETAIL.                                   10120005
101300                                                                  10130005
101400                                                                  10140005
101500 F200-PRINT-DEPT-TRAN-CODES.                                      10150005
101600                                                                  10160005
101700     PERFORM                                                      10170005
101800       VARYING TBL-SUB FROM 1 BY 1                                10180005
101900       UNTIL   TBL-SUB > PC-TBL-MAX                               10190005
102000         IF PV-DP-RETL-AMT    (TBL-SUB)   = ZEROS                 10200005
102100           AND PV-DP-GRO-AMT  (TBL-SUB)   = ZEROS                 10210005
102200           AND PV-DP-FRGT-AMT (TBL-SUB)   = ZEROS                 10220005
102300           AND PV-DP-MISC-AMT (TBL-SUB)   = ZEROS                 10230005
102400           AND PV-DP-NET-AMT  (TBL-SUB)   = ZEROS                 10240005
102500           AND PV-DP-DISC-AMT (TBL-SUB)   = ZEROS                 10250005
102600             CONTINUE                                             10260005
102700         ELSE                                                     10270005
102800             MOVE PV-DEPT-TRNCDE-AMTS (TBL-SUB)                   10280005
102900                                           TO PV-HLD-AMOUNTS      10290005
103000             MOVE PV-DP-TRANCODE (TBL-SUB) TO T2-TRN-CDE          10300005
103100             MOVE PV-DP-DESC     (TBL-SUB) TO T2-TRANS-TYP        10310005
103200             PERFORM L100-FORMAT-TRANSACTION-TOTALS               10320005
103300         END-IF                                                   10330005
103400     END-PERFORM.                                                 10340005
103500                                                                  10350005
103600     MOVE  PC-DASH-LINE                    TO PV-REPORT-REC.      10360005
103700     MOVE +1                               TO PV-LINE-SKIP.       10370005
103800     PERFORM W300-PRINT-DETAIL.                                   10380005
103900                                                                  10390005
104000                                                                  10400005
104100 F300-PRINT-DMA-TRAN-CODES.                                       10410005
104200                                                                  10420005
104300     PERFORM                                                      10430005
104400       VARYING TBL-SUB FROM 1 BY 1                                10440005
104500       UNTIL   TBL-SUB > PC-TBL-MAX                               10450005
104600         IF PV-DM-RETL-AMT    (TBL-SUB)   = ZEROS                 10460005
104700           AND PV-DM-GRO-AMT  (TBL-SUB)   = ZEROS                 10470005
104800           AND PV-DM-FRGT-AMT (TBL-SUB)   = ZEROS                 10480005
104900           AND PV-DM-MISC-AMT (TBL-SUB)   = ZEROS                 10490005
105000           AND PV-DM-NET-AMT  (TBL-SUB)   = ZEROS                 10500005
105100           AND PV-DM-DISC-AMT (TBL-SUB)   = ZEROS                 10510005
105200             CONTINUE                                             10520005
105300         ELSE                                                     10530005
105400             MOVE PV-DMA-TRNCDE-AMTS (TBL-SUB)                    10540005
105500                                           TO PV-HLD-AMOUNTS      10550005
105600             MOVE PV-DM-TRANCODE (TBL-SUB) TO T2-TRN-CDE          10560005
105700             MOVE PV-DM-DESC     (TBL-SUB) TO T2-TRANS-TYP        10570005
105800             PERFORM L100-FORMAT-TRANSACTION-TOTALS               10580005
105900         END-IF                                                   10590005
106000     END-PERFORM.                                                 10600005
106100                                                                  10610005
106200     MOVE  PC-DASH-LINE                    TO PV-REPORT-REC.      10620005
106300     MOVE +1                               TO PV-LINE-SKIP.       10630005
106400     PERFORM W300-PRINT-DETAIL.                                   10640005
106500                                                                  10650005
106600                                                                  10660005
106700 F400-PRINT-TOTALS-TRAN-CODES.                                    10670005
106800                                                                  10680005
106900     PERFORM                                                      10690005
107000       VARYING TBL-SUB FROM 1 BY 1                                10700005
107100       UNTIL   TBL-SUB > PC-TBL-MAX                               10710005
107200         IF PV-TL-RETL-AMT    (TBL-SUB)   = ZEROS                 10720005
107300           AND PV-TL-GRO-AMT  (TBL-SUB)   = ZEROS                 10730005
107400           AND PV-TL-FRGT-AMT (TBL-SUB)   = ZEROS                 10740005
107500           AND PV-TL-MISC-AMT (TBL-SUB)   = ZEROS                 10750005
107600           AND PV-TL-NET-AMT  (TBL-SUB)   = ZEROS                 10760005
107700           AND PV-TL-DISC-AMT (TBL-SUB)   = ZEROS                 10770005
107800             CONTINUE                                             10780005
107900         ELSE                                                     10790005
108000             MOVE PV-TOTALS-TRNCDE-AMTS (TBL-SUB)                 10800005
108100                                           TO PV-HLD-AMOUNTS      10810005
108200             MOVE PV-TL-TRANCODE (TBL-SUB) TO T2-TRN-CDE          10820005
108300             MOVE PV-TL-DESC     (TBL-SUB) TO T2-TRANS-TYP        10830005
108400             PERFORM L100-FORMAT-TRANSACTION-TOTALS               10840005
108500         END-IF                                                   10850005
108600     END-PERFORM.                                                 10860005
108700                                                                  10870005
108800     MOVE  PC-DASH-LINE                    TO PV-REPORT-REC.      10880005
108900     MOVE +1                               TO PV-LINE-SKIP.       10890005
109000     PERFORM W300-PRINT-DETAIL.                                   10900005
109100                                                                  10910005
109200                                                                  10920005
109300 G100-PRINT-CLASS-CUR-TOTALS.                                     10930005
109400                                                                  10940005
109500     MOVE PC-TOTAL-CUR-PERIOD              TO T3-TEXT.            10950005
109600     MOVE PV-CLASS-CUR-PERIOD              TO PV-HLD-AMOUNTS.     10960005
109700     PERFORM L200-FORMAT-TOTALS.                                  10970005
109800                                                                  10980005
109900                                                                  10990005
110000 G200-PRINT-DEPT-CUR-TOTALS.                                      11000005
110100                                                                  11010005
110200     MOVE PC-TOTAL-CUR-PERIOD              TO T3-TEXT.            11020005
110300     MOVE PV-DEPT-CUR-PERIOD               TO PV-HLD-AMOUNTS.     11030005
110400     PERFORM L200-FORMAT-TOTALS.                                  11040005
110500                                                                  11050005
110600                                                                  11060005
110700 G300-PRINT-DMA-CUR-TOTALS.                                       11070005
110800                                                                  11080005
110900     MOVE PC-TOTAL-CUR-PERIOD              TO T3-TEXT.            11090005
111000     MOVE PV-DMA-CUR-PERIOD                TO PV-HLD-AMOUNTS.     11100005
111100     PERFORM L200-FORMAT-TOTALS.                                  11110005
111200                                                                  11120005
111300                                                                  11130005
111400 G400-PRINT-TOTALS-CUR-TOTALS.                                    11140005
111500                                                                  11150005
111600     MOVE PC-TOTAL-CUR-PERIOD              TO T3-TEXT.            11160005
111700     MOVE PV-TOTALS-CUR-PERIOD             TO PV-HLD-AMOUNTS.     11170005
111800     PERFORM L200-FORMAT-TOTALS.                                  11180005
111900                                                                  11190005
112000                                                                  11200005
112100 H100-PRINT-CLASS-MTD-TOTALS.                                     11210005
112200                                                                  11220005
112300     MOVE PC-TOTAL-MTD                     TO T3-TEXT.            11230005
112400     MOVE PV-CLASS-MTD                     TO PV-HLD-AMOUNTS.     11240005
112500     PERFORM L200-FORMAT-TOTALS.                                  11250005
112600                                                                  11260005
112700                                                                  11270005
112800 H200-PRINT-DEPT-MTD-TOTALS.                                      11280005
112900                                                                  11290005
113000     MOVE PC-TOTAL-MTD                     TO T3-TEXT.            11300005
113100     MOVE PV-DEPT-MTD                      TO PV-HLD-AMOUNTS.     11310005
113200     PERFORM L200-FORMAT-TOTALS.                                  11320005
113300                                                                  11330005
113400                                                                  11340005
113500 H300-PRINT-DMA-MTD-TOTALS.                                       11350005
113600                                                                  11360005
113700     MOVE PC-TOTAL-MTD                     TO T3-TEXT.            11370005
113800     MOVE PV-DMA-MTD                       TO PV-HLD-AMOUNTS.     11380005
113900     PERFORM L200-FORMAT-TOTALS.                                  11390005
114000                                                                  11400005
114100                                                                  11410005
114200 H400-PRINT-TOTALS-MTD-TOTALS.                                    11420005
114300                                                                  11430005
114400     MOVE PC-TOTAL-MTD                     TO T3-TEXT.            11440005
114500     MOVE PV-TOTALS-MTD                    TO PV-HLD-AMOUNTS.     11450005
114600     PERFORM L200-FORMAT-TOTALS.                                  11460005
114700                                                                  11470005
114800                                                                  11480005
114900 L100-FORMAT-TRANSACTION-TOTALS.                                  11490005
115000                                                                  11500005
115100     MOVE PV-HLD-RETL-AMT         TO T2-RETL-AMT.                 11510005
115200     IF PV-HLD-RETL-AMT < ZEROS                                   11520005
115300         MOVE ZEROS               TO PV-POS                       11530005
115400         INSPECT T2-RETL-AMT TALLYING PV-POS FOR LEADING SPACE    11540005
115500         MOVE '('                 TO T2-RETL-AMT (PV-POS:1)       11550005
115600         MOVE ')'                 TO T2-RETL-NEG-IND-R            11560005
115700     ELSE                                                         11570005
115800         MOVE SPACES              TO T2-RETL-NEG-IND-R            11580005
115900     END-IF.                                                      11590005
116000                                                                  11600005
116100     MOVE PV-HLD-GRO-AMT          TO T2-GRO-AMT.                  11610005
116200     IF PV-HLD-GRO-AMT < ZEROS                                    11620005
116300         MOVE ZEROS               TO PV-POS                       11630005
116400         INSPECT T2-GRO-AMT TALLYING PV-POS FOR LEADING SPACE     11640005
116500         MOVE '('                 TO T2-GRO-AMT (PV-POS:1)        11650005
116600         MOVE ')'                 TO T2-GRO-NEG-IND-R             11660005
116700     ELSE                                                         11670005
116800         MOVE SPACES              TO T2-GRO-NEG-IND-R             11680005
116900     END-IF.                                                      11690005
117000                                                                  11700005
117100     MOVE PV-HLD-FRGT-AMT         TO T2-FRGT-AMT.                 11710005
117200     IF PV-HLD-FRGT-AMT < ZEROS                                   11720005
117300         MOVE ZEROS               TO PV-POS                       11730005
117400         INSPECT T2-FRGT-AMT TALLYING PV-POS FOR LEADING SPACE    11740005
117500         MOVE '('                 TO T2-FRGT-AMT (PV-POS:1)       11750005
117600         MOVE ')'                 TO T2-FRGT-NEG-IND-R            11760005
117700     ELSE                                                         11770005
117800         MOVE SPACES              TO T2-FRGT-NEG-IND-R            11780005
117900     END-IF.                                                      11790005
118000                                                                  11800005
118100     MOVE PV-HLD-MISC-AMT         TO T2-MISC-AMT.                 11810005
118200     IF PV-HLD-MISC-AMT < ZEROS                                   11820005
118300         MOVE ZEROS               TO PV-POS                       11830005
118400         INSPECT T2-MISC-AMT TALLYING PV-POS FOR LEADING SPACE    11840005
118500         MOVE '('                 TO T2-MISC-AMT (PV-POS:1)       11850005
118600         MOVE ')'                 TO T2-MISC-NEG-IND-R            11860005
118700     ELSE                                                         11870005
118800         MOVE SPACES              TO T2-MISC-NEG-IND-R            11880005
118900     END-IF.                                                      11890005
119000                                                                  11900005
119100     MOVE PV-HLD-NET-AMT          TO T2-NET-AMT.                  11910005
119200     IF PV-HLD-NET-AMT < ZEROS                                    11920005
119300         MOVE ZEROS               TO PV-POS                       11930005
119400         INSPECT T2-NET-AMT TALLYING PV-POS FOR LEADING SPACE     11940005
119500         MOVE '('                 TO T2-NET-AMT (PV-POS:1)        11950005
119600         MOVE ')'                 TO T2-NET-NEG-IND-R             11960005
119700     ELSE                                                         11970005
119800         MOVE SPACES              TO T2-NET-NEG-IND-R             11980005
119900     END-IF.                                                      11990005
120000                                                                  12000005
120100     MOVE PV-HLD-DISC-AMT         TO T2-DISC-AMT.                 12010005
120200     IF PV-HLD-DISC-AMT < ZEROS                                   12020005
120300         MOVE ZEROS               TO PV-POS                       12030005
120400         INSPECT T2-DISC-AMT TALLYING PV-POS FOR LEADING SPACE    12040005
120500         MOVE '('                 TO T2-DISC-AMT (PV-POS:1)       12050005
120600         MOVE ')'                 TO T2-DISC-NEG-IND-R            12060005
120700     ELSE                                                         12070005
120800         MOVE SPACES              TO T2-DISC-NEG-IND-R            12080005
120900     END-IF.                                                      12090005
121000                                                                  12100005
121100     IF (PV-LINES-PER-PAGE + 4) > PC-LINES-PER-PAGE-MAX           12110005
121200         PERFORM W100-WRITE-HEADINGS                              12120005
121300         PERFORM W200-WRITE-DETAIL-HEADINGS                       12130005
121400         MOVE  T1-HEADER1         TO PV-REPORT-REC                12140005
121500         MOVE +2                  TO PV-LINE-SKIP                 12150005
121600         PERFORM W300-PRINT-DETAIL                                12160005
121700         MOVE SPACES              TO PV-REPORT-REC                12170005
121800         MOVE +1                  TO PV-LINE-SKIP                 12180005
121900         PERFORM W300-PRINT-DETAIL                                12190005
122000     END-IF.                                                      12200005
122100                                                                  12210005
122200     MOVE  T2-DETAIL2             TO PV-REPORT-REC.               12220005
122300     MOVE +1                      TO PV-LINE-SKIP.                12230005
122400     PERFORM W300-PRINT-DETAIL.                                   12240005
122500                                                                  12250005
122600                                                                  12260005
122700 L200-FORMAT-TOTALS.                                              12270005
122800                                                                  12280005
122900     MOVE PV-HLD-RETL-AMT              TO T3-RETL-AMT.            12290005
123000     IF PV-HLD-RETL-AMT < ZEROS                                   12300005
123100         MOVE ZEROS                    TO PV-POS                  12310005
123200         INSPECT T3-RETL-AMT TALLYING PV-POS FOR LEADING SPACE    12320005
123300         MOVE '('                      TO T3-RETL-AMT (PV-POS:1)  12330005
123400         MOVE ')'                      TO T3-RETL-NEG-IND-R       12340005
123500     ELSE                                                         12350005
123600         MOVE SPACES                   TO T3-RETL-NEG-IND-R       12360005
123700     END-IF.                                                      12370005
123800                                                                  12380005
123900     MOVE PV-HLD-GRO-AMT               TO T3-GRO-AMT.             12390005
124000     IF PV-HLD-GRO-AMT < ZEROS                                    12400005
124100         MOVE ZEROS                    TO PV-POS                  12410005
124200         INSPECT T3-GRO-AMT TALLYING PV-POS FOR LEADING SPACE     12420005
124300         MOVE '('                      TO T3-GRO-AMT (PV-POS:1)   12430005
124400         MOVE ')'                      TO T3-GRO-NEG-IND-R        12440005
124500     ELSE                                                         12450005
124600         MOVE SPACES                   TO T3-GRO-NEG-IND-R        12460005
124700     END-IF.                                                      12470005
124800                                                                  12480005
124900     MOVE PV-HLD-FRGT-AMT              TO T3-FRGT-AMT.            12490005
125000     IF PV-HLD-FRGT-AMT < ZEROS                                   12500005
125100         MOVE ZEROS                    TO PV-POS                  12510005
125200         INSPECT T3-FRGT-AMT TALLYING PV-POS FOR LEADING SPACE    12520005
125300         MOVE '('                      TO T3-FRGT-AMT (PV-POS:1)  12530005
125400         MOVE ')'                      TO T3-FRGT-NEG-IND-R       12540005
125500     ELSE                                                         12550005
125600         MOVE SPACES                   TO T3-FRGT-NEG-IND-R       12560005
125700     END-IF.                                                      12570005
125800                                                                  12580005
125900     MOVE PV-HLD-MISC-AMT              TO T3-MISC-AMT.            12590005
126000     IF PV-HLD-MISC-AMT < ZEROS                                   12600005
126100         MOVE ZEROS                    TO PV-POS                  12610005
126200         INSPECT T3-MISC-AMT TALLYING PV-POS FOR LEADING SPACE    12620005
126300         MOVE '('                      TO T3-MISC-AMT (PV-POS:1)  12630005
126400         MOVE ')'                      TO T3-MISC-NEG-IND-R       12640005
126500     ELSE                                                         12650005
126600         MOVE SPACES                   TO T3-MISC-NEG-IND-R       12660005
126700     END-IF.                                                      12670005
126800                                                                  12680005
126900     MOVE PV-HLD-NET-AMT               TO T3-NET-AMT.             12690005
127000     IF PV-HLD-NET-AMT < ZEROS                                    12700005
127100         MOVE ZEROS                    TO PV-POS                  12710005
127200         INSPECT T3-NET-AMT TALLYING PV-POS FOR LEADING SPACE     12720005
127300         MOVE '('                      TO T3-NET-AMT (PV-POS:1)   12730005
127400         MOVE ')'                      TO T3-NET-NEG-IND-R        12740005
127500     ELSE                                                         12750005
127600         MOVE SPACES                   TO T3-NET-NEG-IND-R        12760005
127700     END-IF.                                                      12770005
127800                                                                  12780005
127900     MOVE PV-HLD-DISC-AMT              TO T3-DISC-AMT.            12790005
128000     IF PV-HLD-DISC-AMT < ZEROS                                   12800005
128100         MOVE ZEROS                    TO PV-POS                  12810005
128200         INSPECT T3-DISC-AMT TALLYING PV-POS FOR LEADING SPACE    12820005
128300         MOVE '('                      TO T3-DISC-AMT (PV-POS:1)  12830005
128400         MOVE ')'                      TO T3-DISC-NEG-IND-R       12840005
128500     ELSE                                                         12850005
128600         MOVE SPACES                   TO T3-DISC-NEG-IND-R       12860005
128700     END-IF.                                                      12870005
128800                                                                  12880005
128900     MOVE  T3-DETAIL3                  TO PV-REPORT-REC.          12890005
129000     MOVE +1                           TO PV-LINE-SKIP.           12900005
129100     PERFORM W300-PRINT-DETAIL.                                   12910005
129200                                                                  12920005
129300                                                                  12930005
129400 L500-FORMAT-DETAIL.                                              12940005
129500                                                                  12950005
129600     MOVE AP046-PO-NBR                 TO D2-PO-NBR.              12960005
129700     MOVE AP046-DOC-NBR                TO D2-DOC-NBR.             12970005
129800     MOVE AP046-INV-CUTOFF-MM          TO D2-ENTR-DTE-MM.         12980005
129900     MOVE AP046-INV-CUTOFF-DD          TO D2-ENTR-DTE-DD.         12990005
130000     MOVE AP046-INV-CUTOFF-YY          TO D2-ENTR-DTE-YY.         13000005
130100     MOVE AP046-AP-TRN-CDE             TO D2-TRN-CDE.             13010005
130200     MOVE AP046-TRN-SHRT-DESC          TO D2-TRN-SHRT-DESC.       13020005
130300                                                                  13030005
130400     MOVE AP046-RETL-AMT               TO D2-RETL-AMT.            13040005
130500     IF AP046-RETL-AMT < ZEROS                                    13050005
130600         MOVE ZEROS                    TO PV-POS                  13060005
130700         INSPECT D2-RETL-AMT TALLYING PV-POS FOR LEADING SPACE    13070005
130800         MOVE '('                      TO D2-RETL-AMT (PV-POS:1)  13080005
130900         MOVE ')'                      TO D2-RETL-NEG-IND-R       13090005
131000     ELSE                                                         13100005
131100         MOVE SPACES                   TO D2-RETL-NEG-IND-R       13110005
131200     END-IF.                                                      13120005
131300                                                                  13130005
131400     MOVE AP046-GRO-COST-AMT           TO D2-GRO-AMT.             13140005
131500     IF AP046-GRO-COST-AMT < ZEROS                                13150005
131600         MOVE ZEROS                    TO PV-POS                  13160005
131700         INSPECT D2-GRO-AMT TALLYING PV-POS FOR LEADING SPACE     13170005
131800         MOVE '('                      TO D2-GRO-AMT (PV-POS:1)   13180005
131900         MOVE ')'                      TO D2-GRO-NEG-IND-R        13190005
132000     ELSE                                                         13200005
132100         MOVE SPACES                   TO D2-GRO-NEG-IND-R        13210005
132200     END-IF.                                                      13220005
132300                                                                  13230005
132400     MOVE AP046-FRGT-AMT               TO D2-FRGT-AMT.            13240005
132500     IF AP046-FRGT-AMT < ZEROS                                    13250005
132600         MOVE ZEROS                    TO PV-POS                  13260005
132700         INSPECT D2-FRGT-AMT TALLYING PV-POS FOR LEADING SPACE    13270005
132800         MOVE '('                      TO D2-FRGT-AMT (PV-POS:1)  13280005
132900         MOVE ')'                      TO D2-FRGT-NEG-IND-R       13290005
133000     ELSE                                                         13300005
133100         MOVE SPACES                   TO D2-FRGT-NEG-IND-R       13310005
133200     END-IF.                                                      13320005
133300                                                                  13330005
133400     MOVE AP046-MISC-CHRG-AMT          TO D2-MISC-AMT.            13340005
133500     IF AP046-MISC-CHRG-AMT < ZEROS                               13350005
133600         MOVE ZEROS                    TO PV-POS                  13360005
133700         INSPECT D2-MISC-AMT TALLYING PV-POS FOR LEADING SPACE    13370005
133800         MOVE '('                      TO D2-MISC-AMT (PV-POS:1)  13380005
133900         MOVE ')'                      TO D2-MISC-NEG-IND-R       13390005
134000     ELSE                                                         13400005
134100         MOVE SPACES                   TO D2-MISC-NEG-IND-R       13410005
134200     END-IF.                                                      13420005
134300                                                                  13430005
134400     MOVE AP046-NET-COST-AMT          TO D2-NET-AMT.              13440005
134500     IF AP046-NET-COST-AMT < ZEROS                                13450005
134600         MOVE ZEROS                    TO PV-POS                  13460005
134700         INSPECT D2-NET-AMT TALLYING PV-POS FOR LEADING SPACE     13470005
134800         MOVE '('                      TO D2-NET-AMT (PV-POS:1)   13480005
134900         MOVE ')'                      TO D2-NET-NEG-IND-R        13490005
135000     ELSE                                                         13500005
135100         MOVE SPACES                   TO D2-NET-NEG-IND-R        13510005
135200     END-IF.                                                      13520005
135300                                                                  13530005
135400     MOVE AP046-DISC-AMT               TO D2-DISC-AMT.            13540005
135500     IF AP046-DISC-AMT  < ZEROS                                   13550005
135600         MOVE ZEROS                    TO PV-POS                  13560005
135700         INSPECT D2-DISC-AMT TALLYING PV-POS FOR LEADING SPACE    13570005
135800         MOVE '('                      TO D2-DISC-AMT (PV-POS:1)  13580005
135900         MOVE ')'                      TO D2-DISC-NEG-IND-R       13590005
136000     ELSE                                                         13600005
136100         MOVE SPACES                   TO D2-DISC-NEG-IND-R       13610005
136200     END-IF.                                                      13620005
136300                                                                  13630005
136400     IF PS-NEED-VNDR-HEADNG                                       13640005
136500         IF (PV-LINES-PER-PAGE + 2) > PC-LINES-PER-PAGE-MAX       13650005
136600             PERFORM W100-WRITE-HEADINGS                          13660005
136700             PERFORM W200-WRITE-DETAIL-HEADINGS                   13670005
136800         END-IF                                                   13680005
136900         MOVE  D1-DETAIL1            TO PV-REPORT-REC             13690005
137000         MOVE +2                     TO PV-LINE-SKIP              13700005
137100         PERFORM W300-PRINT-DETAIL                                13710005
137200         SET PS-HAVE-VNDR-HEADNG     TO TRUE                      13720005
137300     END-IF.                                                      13730005
137400                                                                  13740005
137500     IF (PV-LINES-PER-PAGE + 1) > PC-LINES-PER-PAGE-MAX           13750005
137600         PERFORM W100-WRITE-HEADINGS                              13760005
137700         PERFORM W200-WRITE-DETAIL-HEADINGS                       13770005
137800         MOVE  D1-DETAIL1              TO PV-REPORT-REC           13780005
137900         MOVE +2                       TO PV-LINE-SKIP            13790005
138000         PERFORM W300-PRINT-DETAIL                                13800005
138100     END-IF.                                                      13810005
138200     MOVE  D2-DETAIL2                  TO PV-REPORT-REC.          13820005
138300     MOVE +1                           TO PV-LINE-SKIP.           13830005
138400     PERFORM W300-PRINT-DETAIL.                                   13840005
138500                                                                  13850005
138600                                                                  13860005
138700 P100-ACCUMULATE-TRN-TOTALS.                                      13870005
138800                                                                  13880005
138900     SET PS-CL-TOTALS                                             13890005
139000         PS-DP-TOTALS                                             13900005
139100         PS-DM-TOTALS                                             13910005
139200         PS-TL-TOTALS              TO TRUE.                       13920005
139300                                                                  13930005
139400*****SET TRN-IDX TO 1                                             13940005
139500                                                                  13950005
139600     PERFORM WITH TEST AFTER VARYING TRN-IDX FROM 1 BY 1          13960005
139700       UNTIL AP046-AP-TRN-CDE = PV-TR-TRANCODE (TRN-IDX)          13970005
139800          OR PV-TR-TRANCODE (TRN-IDX) = SPACES                    13980005
139900          OR TRN-IDX > 999                                        13990005
140000       IF PV-TR-TRANCODE (TRN-IDX) = SPACES                       14000005
140100       OR TRN-IDX > 999                                           14010005
140200          MOVE 'P100-ACCUMULATE-TRN-TOTALS'                       14020005
140300                                      TO AA-PARAGRAPH-NAME        14030005
140400          MOVE 'TRANCODE NOT FOUND IN TABLE'                      14040005
140500                                      TO AA-MESSAGE-1             14050005
140600          DISPLAY 'TRANCODE = ' AP046-AP-TRN-CDE                  14060005
140700          SET AC-INVALID-DATA    TO TRUE                          14070005
140800          PERFORM Z998-ABEND                                      14080005
140900       ELSE                                                       14090005
141000          MOVE PV-TR-SUBSCRIPT (TRN-IDX) TO TBL-SUB               14100005
141100       END-IF                                                     14110005
141200     END-PERFORM.                                                 14120005
141300                                                                  14130005
141400*****IF AP046-AP-TRN-CDE = PV-TR-TRANCODE (TRN-IDX)               14140005
141500*****     MOVE PV-TR-SUBSCRIPT (TRN-IDX) TO TBL-SUB.              14150005
141600                                                                  14160005
141700**** MOVE AP046-AP-TRN-CDE         TO TBL-SUB.                    14170005
141800     IF PV-CL-DESC (TBL-SUB) = SPACES                             14180005
141900         MOVE AP046-AP-TRN-CDE     TO PV-CL-TRANCODE (TBL-SUB)    14190005
142000                                      PV-DP-TRANCODE (TBL-SUB)    14200005
142100                                      PV-DM-TRANCODE (TBL-SUB)    14210005
142200                                      PV-TL-TRANCODE (TBL-SUB)    14220005
142300                                                                  14230005
142400         MOVE AP046-TRN-SHRT-DESC  TO PV-CL-DESC (TBL-SUB)        14240005
142500                                      PV-DP-DESC (TBL-SUB)        14250005
142600                                      PV-DM-DESC (TBL-SUB)        14260005
142700                                      PV-TL-DESC (TBL-SUB)        14270005
142800     END-IF.                                                      14280005
142900                                                                  14290005
143000     ADD AP046-RETL-AMT            TO PV-CL-RETL-AMT (TBL-SUB)    14300005
143100                                      PV-DP-RETL-AMT (TBL-SUB)    14310005
143200                                      PV-DM-RETL-AMT (TBL-SUB)    14320005
143300                                      PV-TL-RETL-AMT (TBL-SUB).   14330005
143400                                                                  14340005
143500     ADD AP046-GRO-COST-AMT        TO PV-CL-GRO-AMT (TBL-SUB)     14350005
143600                                      PV-DP-GRO-AMT (TBL-SUB)     14360005
143700                                      PV-DM-GRO-AMT (TBL-SUB)     14370005
143800                                      PV-TL-GRO-AMT (TBL-SUB).    14380005
143900                                                                  14390005
144000     ADD AP046-FRGT-AMT            TO PV-CL-FRGT-AMT (TBL-SUB)    14400005
144100                                      PV-DP-FRGT-AMT (TBL-SUB)    14410005
144200                                      PV-DM-FRGT-AMT (TBL-SUB)    14420005
144300                                      PV-TL-FRGT-AMT (TBL-SUB).   14430005
144400                                                                  14440005
144500     ADD AP046-MISC-CHRG-AMT       TO PV-CL-MISC-AMT (TBL-SUB)    14450005
144600                                      PV-DP-MISC-AMT (TBL-SUB)    14460005
144700                                      PV-DM-MISC-AMT (TBL-SUB)    14470005
144800                                      PV-TL-MISC-AMT (TBL-SUB).   14480005
144900                                                                  14490005
145000     ADD AP046-NET-COST-AMT         TO PV-CL-NET-AMT (TBL-SUB)    14500005
145100                                       PV-DP-NET-AMT (TBL-SUB)    14510005
145200                                       PV-DM-NET-AMT (TBL-SUB)    14520005
145300                                       PV-TL-NET-AMT (TBL-SUB).   14530005
145400                                                                  14540005
145500     ADD AP046-DISC-AMT             TO PV-CL-DISC-AMT (TBL-SUB)   14550005
145600                                       PV-DP-DISC-AMT (TBL-SUB)   14560005
145700                                       PV-DM-DISC-AMT (TBL-SUB)   14570005
145800                                       PV-TL-DISC-AMT (TBL-SUB).  14580005
145900                                                                  14590005
146000                                                                  14600005
146100 P200-ACCUMULATE-CUR-TOTALS.                                      14610005
146200                                                                  14620005
146300     ADD AP046-RETL-AMT            TO PV-CL-CUR-RETL-AMT          14630005
146400                                      PV-DP-CUR-RETL-AMT          14640005
146500                                      PV-DM-CUR-RETL-AMT          14650005
146600                                      PV-TL-CUR-RETL-AMT.         14660005
146700                                                                  14670005
146800     ADD AP046-GRO-COST-AMT        TO PV-CL-CUR-GRO-AMT           14680005
146900                                      PV-DP-CUR-GRO-AMT           14690005
147000                                      PV-DM-CUR-GRO-AMT           14700005
147100                                      PV-TL-CUR-GRO-AMT.          14710005
147200                                                                  14720005
147300     ADD AP046-FRGT-AMT            TO PV-CL-CUR-FRGT-AMT          14730005
147400                                      PV-DP-CUR-FRGT-AMT          14740005
147500                                      PV-DM-CUR-FRGT-AMT          14750005
147600                                      PV-TL-CUR-FRGT-AMT.         14760005
147700                                                                  14770005
147800     ADD AP046-MISC-CHRG-AMT       TO PV-CL-CUR-MISC-AMT          14780005
147900                                      PV-DP-CUR-MISC-AMT          14790005
148000                                      PV-DM-CUR-MISC-AMT          14800005
148100                                      PV-TL-CUR-MISC-AMT.         14810005
148200                                                                  14820005
148300     ADD AP046-NET-COST-AMT         TO PV-CL-CUR-NET-AMT          14830005
148400                                       PV-DP-CUR-NET-AMT          14840005
148500                                       PV-DM-CUR-NET-AMT          14850005
148600                                       PV-TL-CUR-NET-AMT.         14860005
148700                                                                  14870005
148800     ADD AP046-DISC-AMT             TO PV-CL-CUR-DISC-AMT         14880005
148900                                       PV-DP-CUR-DISC-AMT         14890005
149000                                       PV-DM-CUR-DISC-AMT         14900005
149100                                       PV-TL-CUR-DISC-AMT.        14910005
149200                                                                  14920005
149300                                                                  14930005
149400 P300-ACCUMULATE-MTD-TOTALS.                                      14940005
149500                                                                  14950005
149600     ADD AP046-RETL-AMT            TO PV-CL-MTD-RETL-AMT          14960005
149700                                      PV-DP-MTD-RETL-AMT          14970005
149800                                      PV-DM-MTD-RETL-AMT          14980005
149900                                      PV-TL-MTD-RETL-AMT.         14990005
150000                                                                  15000005
150100     ADD AP046-GRO-COST-AMT        TO PV-CL-MTD-GRO-AMT           15010005
150200                                      PV-DP-MTD-GRO-AMT           15020005
150300                                      PV-DM-MTD-GRO-AMT           15030005
150400                                      PV-TL-MTD-GRO-AMT.          15040005
150500                                                                  15050005
150600     ADD AP046-FRGT-AMT            TO PV-CL-MTD-FRGT-AMT          15060005
150700                                      PV-DP-MTD-FRGT-AMT          15070005
150800                                      PV-DM-MTD-FRGT-AMT          15080005
150900                                      PV-TL-MTD-FRGT-AMT.         15090005
151000                                                                  15100005
151100     ADD AP046-MISC-CHRG-AMT       TO PV-CL-MTD-MISC-AMT          15110005
151200                                      PV-DP-MTD-MISC-AMT          15120005
151300                                      PV-DM-MTD-MISC-AMT          15130005
151400                                      PV-TL-MTD-MISC-AMT.         15140005
151500                                                                  15150005
151600     ADD AP046-NET-COST-AMT         TO PV-CL-MTD-NET-AMT          15160005
151700                                       PV-DP-MTD-NET-AMT          15170005
151800                                       PV-DM-MTD-NET-AMT          15180005
151900                                       PV-TL-MTD-NET-AMT.         15190005
152000                                                                  15200005
152100     ADD AP046-DISC-AMT             TO PV-CL-MTD-DISC-AMT         15210005
152200                                       PV-DP-MTD-DISC-AMT         15220005
152300                                       PV-DM-MTD-DISC-AMT         15230005
152400                                       PV-TL-MTD-DISC-AMT.        15240005
152500                                                                  15250005
152600                                                                  15260005
152700 R100-READ-INPUT.                                                 15270005
152800*----------------------------------------------------------------*15280005
152900*    READ ADJUSTMENT EXTRACT FILE.                               *15290005
153000*----------------------------------------------------------------*15300005
153100                                                                  15310005
153200     READ ADJ-EXTRACT-FILE INTO AP046-EXTRACT-FILE                15320005
153300         AT END                                                   15330005
153400             SET PS-ADJ-EOF TO TRUE.                              15340005
153500                                                                  15350005
153600     IF PS-ADJ-NOT-EOF                                            15360005
153700         ADD 1                   TO PV-READ-COUNT                 15370005
153800     END-IF.                                                      15380005
153900                                                                  15390005
154000                                                                  15400005
154100 S100-GET-CURRENT-PSTG-PERIOD.                                    15410005
154200*----------------------------------------------------------------*15420005
154300*   RETRIEVES THE CURRENT POSTING PERIOD.                        *15430005
154400*----------------------------------------------------------------*15440005
154500                                                                  15450005
154600     PERFORM WITH TEST AFTER                                      15460005
154700             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 15470005
154800             UNTIL   PV-RETRY-COUNTER > 3  OR                     15480005
154900                     SQLCODE = ZERO OR                            15490005
155000                     SQLCODE = +100                               15500005
155100                                                                  15510005
155200         EXEC SQL                                                 15520005
155300             SELECT  BTCH_PRC_DTE                                 15530005
155400                    ,CURR_PSTG_FWK_NBR                            15540005
155500               INTO :APCNTL-BTCH-PRC-DTE                          15550005
155600                   ,:APCNTL-CURR-PSTG-FWK-NBR                     15560005
155700               FROM  TAPCNTL                                      15570005
155800         END-EXEC                                                 15580005
155900                                                                  15590005
156000         EVALUATE TRUE                                            15600005
156100           WHEN SQLCODE = ZERO                                    15610005
156200             CONTINUE                                             15620005
156300           WHEN SQLWARN0 NOT = SPACES                             15630005
156400           WHEN SQLCODE NOT  = ZERO                               15640005
156500             MOVE 'S100-GET-CURRENT-PSTG-PERIOD'                  15650005
156600                                 TO AA-PARAGRAPH-NAME             15660005
156700             MOVE 'UNSUCCESSFUL SELECT'                           15670005
156800                                 TO AA-DB2-OPERATION              15680005
156900             MOVE 'TAPCNTL'      TO AA-DB2-TABLE-1                15690005
157000             MOVE SPACES         TO AA-DB2-TABLE-2                15700005
157100                                    AA-DB2-TABLE-3                15710005
157200             PERFORM Z999-DB2-ABEND                               15720005
157300         END-EVALUATE                                             15730005
157400     END-PERFORM.                                                 15740005
157500                                                                  15750005
157600     IF PV-RETRY-COUNTER > 3                                      15760005
157700         MOVE 'S100-GET-CURRENT-PSTG-PERIOD'                      15770005
157800                                 TO AA-PARAGRAPH-NAME             15780005
157900         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    15790005
158000                                 TO AA-DB2-OPERATION              15800005
158100         MOVE 'TAPCNTL'          TO AA-DB2-TABLE-1                15810005
158200         MOVE SPACES             TO AA-DB2-TABLE-2                15820005
158300                                    AA-DB2-TABLE-3                15830005
158400         PERFORM Z999-DB2-ABEND                                   15840005
158500     END-IF.                                                      15850005
158600                                                                  15860005
158700                                                                  15870005
158800 S200-GET-PREVIOUS-PSTG-PERIOD.                                   15880005
158900*----------------------------------------------------------------*15890005
159000*   RETRIEVES THE PREVIOUS POSTING PERIOD.                       *15900005
159100*----------------------------------------------------------------*15910005
159200                                                                  15920005
159300     PERFORM WITH TEST AFTER                                      15930005
159400             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 15940005
159500             UNTIL   PV-RETRY-COUNTER > 3  OR                     15950005
159600                     SQLCODE = ZERO OR                            15960005
159700                     SQLCODE = +100                               15970005
159800                                                                  15980005
159900         EXEC SQL                                                 15990005
160000             SELECT BTCH_PRC_DTE                                  16000005
160100                  , PREV_PSTG_FYR_NBR                             16010005
160200                  , PREV_PSTG_FMN_NBR                             16020005
160300               INTO :APCNTL-BTCH-PRC-DTE                          16030005
160400                  , :APCNTL-PREV-PSTG-FYR-NBR                     16040005
160500                  , :APCNTL-PREV-PSTG-FMN-NBR                     16050005
160600               FROM TAPCNTL                                       16060005
160700         END-EXEC                                                 16070005
160800                                                                  16080005
160900         EVALUATE TRUE                                            16090005
161000           WHEN SQLCODE = ZERO                                    16100005
161100             CONTINUE                                             16110005
161200           WHEN SQLWARN0 NOT = SPACES                             16120005
161300           WHEN SQLCODE NOT  = ZERO                               16130005
161400             MOVE 'S200-GET-PREVIOUS-PSTG-PERIOD'                 16140005
161500                                 TO AA-PARAGRAPH-NAME             16150005
161600             MOVE 'UNSUCCESSFUL SELECT'                           16160005
161700                                 TO AA-DB2-OPERATION              16170005
161800             MOVE 'TAPCNTL'      TO AA-DB2-TABLE-1                16180005
161900             MOVE SPACES         TO AA-DB2-TABLE-2                16190005
162000                                    AA-DB2-TABLE-3                16200005
162100             PERFORM Z999-DB2-ABEND                               16210005
162200         END-EVALUATE                                             16220005
162300     END-PERFORM.                                                 16230005
162400                                                                  16240005
162500     IF PV-RETRY-COUNTER > 3                                      16250005
162600         MOVE 'S200-GET-PREVIOUS-PSTG-PERIOD'                     16260005
162700                                 TO AA-PARAGRAPH-NAME             16270005
162800         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    16280005
162900                                 TO AA-DB2-OPERATION              16290005
163000         MOVE 'TAPCNTL'          TO AA-DB2-TABLE-1                16300005
163100         MOVE SPACES             TO AA-DB2-TABLE-2                16310005
163200                                    AA-DB2-TABLE-3                16320005
163300         PERFORM Z999-DB2-ABEND                                   16330005
163400     END-IF.                                                      16340005
163500                                                                  16350005
163600                                                                  16360005
163700 S300-GET-DMA-NAME.                                               16370005
163800*----------------------------------------------------------------*16380005
163900*   RETRIEVES THE DMA NAME.                                      *16390005
164000*----------------------------------------------------------------*16400005
164100                                                                  16410005
164200     PERFORM WITH TEST AFTER                                      16420005
164300             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 16430005
164400             UNTIL   PV-RETRY-COUNTER > 3  OR                     16440005
164500                     SQLCODE = ZERO OR                            16450005
164600                     SQLCODE = +100                               16460005
164700                                                                  16470005
164800         EXEC SQL                                                 16480005
164900             SELECT  B.WORKER_LAST_NAME                           16490005
165000                    ,B.WORKER_FIR_NAME                            16500005
165100               INTO  :RSPBAR-WORKER-LAST-NAME                     16510005
165200                    ,:RSPBAR-WORKER-FIR-NAME                      16520005
165300               FROM  TMDSEAR A                                    16530005
165400                    ,TRSPBAR B                                    16540005
165500              WHERE  A.MDSEAR_DKEY        = B.MDSEAR_DKEY         16550005
165600                AND  A.OPERCO_NBR         = '03'                  16560005
165700                AND  A.DMA_NBR            = :MDSEAR-DMA-NBR       16570005
165800                AND  B.RSPLVL_CDE         = 'DMM'                 16580005
165900                AND  A.MDSELV_CDE         = 'DMA'                 16590005
166000                AND  CURRENT DATE BETWEEN A.STRT_DTE AND A.END_DTE16600005
166100                AND  CURRENT DATE BETWEEN B.WORKER_STRT_DTE       16610005
166200                                      AND B.WORKER_END_DTE        16620005
166300         END-EXEC                                                 16630005
166400                                                                  16640005
166500         EVALUATE TRUE                                            16650005
166600           WHEN SQLCODE = ZERO                                    16660005
166700             CONTINUE                                             16670005
166800           WHEN SQLWARN0 NOT = SPACES                             16680005
166900           WHEN SQLCODE NOT  = ZERO                               16690005
167000             MOVE 'S300-GET-DMA-NAME'                             16700005
167100                                 TO AA-PARAGRAPH-NAME             16710005
167200             MOVE 'UNSUCCESSFUL SELECT'                           16720005
167300                                 TO AA-DB2-OPERATION              16730005
167400             MOVE 'DMA NBR'      TO AA-MESSAGE-1                  16740005
167500             MOVE MDSEAR-DMA-NBR TO AA-MESSAGE-2                  16750005
167600             MOVE 'TMDSEAR'      TO AA-DB2-TABLE-1                16760005
167700             MOVE 'TRSPBAR'      TO AA-DB2-TABLE-2                16770005
167800             MOVE SPACES         TO AA-DB2-TABLE-3                16780005
167900             PERFORM Z999-DB2-ABEND                               16790005
168000         END-EVALUATE                                             16800005
168100     END-PERFORM.                                                 16810005
168200                                                                  16820005
168300     IF PV-RETRY-COUNTER > 3                                      16830005
168400         MOVE 'S300-GET-DMA-NAME'                                 16840005
168500                                 TO AA-PARAGRAPH-NAME             16850005
168600         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    16860005
168700                                 TO AA-DB2-OPERATION              16870005
168800         MOVE 'TMDSEAR'          TO AA-DB2-TABLE-1                16880005
168900         MOVE 'TRSPBAR'          TO AA-DB2-TABLE-2                16890005
169000         MOVE SPACES             TO AA-DB2-TABLE-3                16900005
169100         PERFORM Z999-DB2-ABEND                                   16910005
169200     END-IF.                                                      16920005
169300                                                                  16930005
169400                                                                  16940005
169500 S400-GET-DEPT-NAME.                                              16950005
169600*----------------------------------------------------------------*16960005
169700*   RETRIEVES THE DEPARTMENT NAME.                               *16970005
169800*----------------------------------------------------------------*16980005
169900                                                                  16990005
170000     PERFORM WITH TEST AFTER                                      17000005
170100             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 17010005
170200             UNTIL   PV-RETRY-COUNTER > 3  OR                     17020005
170300                     SQLCODE = ZERO OR                            17030005
170400                     SQLCODE = +100                               17040005
170500                                                                  17050005
170600         EXEC SQL                                                 17060005
170700             SELECT  MDSEAR_DESC                                  17070005
170800               INTO :MDSEAR-DESC                                  17080005
170900               FROM  TMDSEAR                                      17090005
171000              WHERE  OPERCO_NBR           = '03'                  17100005
171100                AND  DEPT_NBR             = :MDSEAR-DEPT-NBR      17110005
171200                AND  MDSELV_CDE           = 'DPT'                 17120005
171300                AND  CURRENT DATE   BETWEEN STRT_DTE              17130005
171400                                        AND END_DTE               17140005
171500         END-EXEC                                                 17150005
171600                                                                  17160005
171700         EVALUATE TRUE                                            17170005
171800           WHEN SQLCODE = ZERO                                    17180005
171900             CONTINUE                                             17190005
172000           WHEN SQLWARN0 NOT = SPACES                             17200005
172100           WHEN SQLCODE NOT  = ZERO                               17210005
172200             MOVE 'S400-GET-DEPT-NAME'                            17220005
172300                                 TO AA-PARAGRAPH-NAME             17230005
172400             MOVE 'UNSUCCESSFUL SELECT'                           17240005
172500                                 TO AA-DB2-OPERATION              17250005
172600             MOVE 'DEPT NBR'     TO AA-MESSAGE-1                  17260005
172700             MOVE MDSEAR-DEPT-NBR                                 17270005
172800                                 TO AA-MESSAGE-2                  17280005
172900             MOVE 'TMDSEAR'      TO AA-DB2-TABLE-1                17290005
173000             MOVE SPACES         TO AA-DB2-TABLE-2                17300005
173100                                    AA-DB2-TABLE-3                17310005
173200             PERFORM Z999-DB2-ABEND                               17320005
173300         END-EVALUATE                                             17330005
173400     END-PERFORM.                                                 17340005
173500                                                                  17350005
173600     IF PV-RETRY-COUNTER > 3                                      17360005
173700         MOVE 'S400-GET-DEPT-NAME'                                17370005
173800                                 TO AA-PARAGRAPH-NAME             17380005
173900         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    17390005
174000                                 TO AA-DB2-OPERATION              17400005
174100         MOVE 'TMDSEAR'          TO AA-DB2-TABLE-1                17410005
174200         MOVE SPACES             TO AA-DB2-TABLE-2                17420005
174300                                    AA-DB2-TABLE-3                17430005
174400         PERFORM Z999-DB2-ABEND                                   17440005
174500     END-IF.                                                      17450005
174600                                                                  17460005
174700                                                                  17470005
174800 S500-GET-MAJOR-CLASS-DESC.                                       17480005
174900*----------------------------------------------------------------*17490005
175000*   RETRIEVES THE MAJOR CLASS DESCRIPTION                        *17500005
175100*----------------------------------------------------------------*17510005
175200                                                                  17520005
175300     PERFORM WITH TEST AFTER                                      17530005
175400             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 17540005
175500             UNTIL   PV-RETRY-COUNTER > 3  OR                     17550005
175600                     SQLCODE = ZERO OR                            17560005
175700                     SQLCODE = +100                               17570005
175800                                                                  17580005
175900         EXEC SQL                                                 17590005
176000             SELECT  MDSEAR_DESC                                  17600005
176100               INTO :MDSEAR-DESC                                  17610005
176200               FROM  TMDSEAR                                      17620005
176300              WHERE  OPERCO_NBR           = '03'                  17630005
176400                AND  DEPT_NBR             = :MDSEAR-DEPT-NBR      17640005
176500                AND  MAJ_CL_NBR           = :MDSEAR-MAJ-CL-NBR    17650005
176600                AND  MDSELV_CDE           = 'MCL'                 17660005
176700                AND  CURRENT DATE   BETWEEN STRT_DTE              17670005
176800                                        AND END_DTE               17680005
176900         END-EXEC                                                 17690005
177000                                                                  17700005
177100         EVALUATE TRUE                                            17710005
177200           WHEN SQLCODE = ZERO                                    17720005
177300             CONTINUE                                             17730005
177400           WHEN SQLWARN0 NOT = SPACES                             17740005
177500           WHEN SQLCODE NOT  = ZERO                               17750005
177600             MOVE 'S500-GET-MAJOR-CLASS-DESC'                     17760005
177700                                 TO AA-PARAGRAPH-NAME             17770005
177800             MOVE 'UNSUCCESSFUL SELECT'                           17780005
177900                                 TO AA-DB2-OPERATION              17790005
178000             MOVE 'MAJOR CLASS'  TO AA-MESSAGE-1                  17800005
178100             MOVE MDSEAR-MAJ-CL-NBR                               17810005
178200                                 TO AA-MESSAGE-2                  17820005
178300             DISPLAY 'DEPT NBR = '     MDSEAR-DEPT-NBR            17830005
178400             DISPLAY 'CLASS NBR = '     MDSEAR-MAJ-CL-NBR         17840005
178500             MOVE 'TMDSEAR'      TO AA-DB2-TABLE-1                17850005
178600             MOVE SPACES         TO AA-DB2-TABLE-2                17860005
178700                                    AA-DB2-TABLE-3                17870005
178800             PERFORM Z999-DB2-ABEND                               17880005
178900         END-EVALUATE                                             17890005
179000     END-PERFORM.                                                 17900005
179100                                                                  17910005
179200     IF PV-RETRY-COUNTER > 3                                      17920005
179300         MOVE 'S500-GET-MAJOR-CLASS-DESC'                         17930005
179400                                 TO AA-PARAGRAPH-NAME             17940005
179500         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    17950005
179600                                 TO AA-DB2-OPERATION              17960005
179700         MOVE 'TMDSEAR'          TO AA-DB2-TABLE-1                17970005
179800         MOVE SPACES             TO AA-DB2-TABLE-2                17980005
179900                                    AA-DB2-TABLE-3                17990005
180000         PERFORM Z999-DB2-ABEND                                   18000005
180100     END-IF.                                                      18010005
180200                                                                  18020005
180300                                                                  18030005
180400 S600-GET-BUYER-NAME.                                             18040005
180500*----------------------------------------------------------------*18050005
180600*   RETRIEVES THE BUYER NUMBER AND NAME                          *18060005
180700*----------------------------------------------------------------*18070005
180800                                                                  18080005
180900     PERFORM WITH TEST AFTER                                      18090005
181000             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 18100005
181100             UNTIL   PV-RETRY-COUNTER > 3  OR                     18110005
181200                     SQLCODE = ZERO OR                            18120005
181300                     SQLCODE = +100                               18130005
181400                                                                  18140005
181500         EXEC SQL                                                 18150005
181600             SELECT  B.WORKER_LAST_NAME                           18160005
181700                    ,B.WORKER_FIR_NAME                            18170005
181800                    ,A.BYR_NBR                                    18180005
181900               INTO  :RSPBAR-WORKER-LAST-NAME                     18190005
182000                    ,:RSPBAR-WORKER-FIR-NAME                      18200005
182100                    ,:MDSEAR-BYR-NBR                              18210005
182200               FROM  TMDSEAR A                                    18220005
182300                    ,TRSPBAR B                                    18230005
182400              WHERE  A.MDSEAR_DKEY        = B.MDSEAR_DKEY         18240005
182500                AND  A.OPERCO_NBR         = '03'                  18250005
182600                AND  A.DEPT_NBR           = :MDSEAR-DEPT-NBR      18260005
182700                AND  B.RSPLVL_CDE         = 'BYR'                 18270005
182800                AND  A.MDSELV_CDE         = 'DPT'                 18280005
182900                AND  CURRENT DATE BETWEEN A.STRT_DTE AND A.END_DTE18290005
183000                AND  CURRENT DATE BETWEEN B.WORKER_STRT_DTE       18300005
183100                                      AND B.WORKER_END_DTE        18310005
183200         END-EXEC                                                 18320005
183300                                                                  18330005
183400         EVALUATE TRUE                                            18340005
183500           WHEN SQLCODE = ZERO                                    18350005
183600             CONTINUE                                             18360005
183700           WHEN SQLWARN0 NOT = SPACES                             18370005
183800           WHEN SQLCODE NOT  = ZERO                               18380005
183900             MOVE 'S600-GET-BUYER-NAME'                           18390005
184000                                 TO AA-PARAGRAPH-NAME             18400005
184100             MOVE 'UNSUCCESSFUL SELECT'                           18410005
184200                                 TO AA-DB2-OPERATION              18420005
184300             MOVE 'DEPT NBR   '  TO AA-MESSAGE-1                  18430005
184400             MOVE MDSEAR-DEPT-NBR                                 18440005
184500                                 TO AA-MESSAGE-2                  18450005
184600             MOVE 'TMDSEAR'      TO AA-DB2-TABLE-1                18460005
184700             MOVE 'TRSPBAR'      TO AA-DB2-TABLE-2                18470005
184800             MOVE SPACES         TO AA-DB2-TABLE-3                18480005
184900             PERFORM Z999-DB2-ABEND                               18490005
185000         END-EVALUATE                                             18500005
185100     END-PERFORM.                                                 18510005
185200                                                                  18520005
185300     IF PV-RETRY-COUNTER > 3                                      18530005
185400         MOVE 'S600-GET-BUYER-NAME'                               18540005
185500                                 TO AA-PARAGRAPH-NAME             18550005
185600         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    18560005
185700                                 TO AA-DB2-OPERATION              18570005
185800         MOVE 'TMDSEAR'          TO AA-DB2-TABLE-1                18580005
185900         MOVE 'TRSPBAR'          TO AA-DB2-TABLE-2                18590005
186000         MOVE SPACES             TO AA-DB2-TABLE-3                18600005
186100         PERFORM Z999-DB2-ABEND                                   18610005
186200     END-IF.                                                      18620005
186300                                                                  18630005
186400 S700-FETCH-TRANCODE.                                             18640005
186500*----------------------------------------------------------------*18650005
186510*   FETCHES FROM THE TRANCODE CURSOR.                            *18651005
186520*----------------------------------------------------------------*18652005
186530                                                                  18653005
186540     EXEC SQL                                                     18654005
186550       FETCH TRANCODE_CSR                                         18655005
186560        INTO :TRNCDE-AP-TRN-CDE                                   18656005
186570     END-EXEC.                                                    18657005
186580                                                                  18658005
186590     EVALUATE TRUE                                                18659005
186600       WHEN SQLCODE = ZERO                                        18660005
186610         CONTINUE                                                 18661005
186611       WHEN SQLCODE = +100                                        18661105
186612         SET PV-TRNCDE-CSR-AT-END TO TRUE                         18661205
186613       WHEN SQLWARN0 NOT = SPACES                                 18661305
186614       WHEN SQLCODE NOT  = ZERO                                   18661405
186615         MOVE 'S700-FETCH-TRANCODE'                               18661505
186616                             TO AA-PARAGRAPH-NAME                 18661605
186617         MOVE 'UNSUCCESSFUL FETCH '                               18661705
186618                             TO AA-DB2-OPERATION                  18661805
186619         MOVE 'TTRNCDE'      TO AA-DB2-TABLE-1                    18661905
186620         PERFORM Z999-DB2-ABEND                                   18662005
186621     END-EVALUATE.                                                18662105
186622                                                                  18662205
186623 W100-WRITE-HEADINGS.                                             18662305
186624*----------------------------------------------------------------*18662405
186625*    WRITE PAGE HEADING LINES.                                   *18662505
186626*----------------------------------------------------------------*18662605
186627                                                                  18662705
186628     ADD +1                      TO PV-PAGE-COUNT.                18662805
186629     MOVE PV-PAGE-COUNT          TO DP150O-PAGE-NUMBER.           18662905
186630                                                                  18663005
186640* HEADING LINE 1 (STANDARD)                                       18664005
186650     WRITE REPORT-REC FROM DP150O-STANDRD-HEADER-150-COLS         18665005
186660       AFTER ADVANCING PAGE.                                      18666005
186670                                                                  18667005
186680     WRITE REPORT-REC FROM H2-HEADER2                             18668005
186690       AFTER ADVANCING +1 LINES.                                  18669005
186700                                                                  18670005
186800     WRITE REPORT-REC FROM H3-HEADER3                             18680005
186900       AFTER ADVANCING +1 LINES.                                  18690005
187000                                                                  18700005
187100     MOVE +3                     TO PV-LINES-PER-PAGE.            18710005
187200                                                                  18720005
187300                                                                  18730005
187400 W200-WRITE-DETAIL-HEADINGS.                                      18740005
187500*----------------------------------------------------------------*18750005
187600*    WRITE DETAIL HEADINGS                                       *18760005
187700*    - PRINT ALL DETAIL HEADERS UNLESS ONE OF THE FOLLOWING      *18770005
187800*      CONDITIONS IS TRUE                                        *18780005
187900*    - WHEN PRINTING FINAL TOTALS DO NOT SHOW DETAIL HEADERS     *18790005
188000*    - WHEN PRINTING DMA TOTALS SHOW DMA HEADER                  *18800005
188100*    - WHEN PRINTING DEPT TOTALS SHOW DMA & DEPT HEADER          *18810005
188200*    - WHEN PRINTING CLASS TOTALS SHOW DMA, DEPT, CLASS, BUYER   *18820005
188300*      DETAIL HEADERS                                            *18830005
188400*----------------------------------------------------------------*18840005
188500                                                                  18850005
188600     IF NOT PS-TOTALS                                             18860005
188700         WRITE REPORT-REC FROM H4-HEADER4                         18870005
188800           AFTER ADVANCING +1 LINES                               18880005
188900         ADD +1                  TO PV-LINES-PER-PAGE             18890005
189000         IF NOT PS-DMA-TOTALS                                     18900005
189100             WRITE REPORT-REC FROM H5-HEADER5                     18910005
189200               AFTER ADVANCING +1 LINES                           18920005
189300             ADD +1              TO PV-LINES-PER-PAGE             18930005
189400             IF NOT PS-DEPT-TOTALS                                18940005
189500                 WRITE REPORT-REC FROM H6-HEADER6                 18950005
189600                   AFTER ADVANCING +1 LINES                       18960005
189700                 WRITE REPORT-REC FROM H7-HEADER7                 18970005
189800                   AFTER ADVANCING +1 LINES                       18980005
189900                 ADD +2          TO PV-LINES-PER-PAGE             18990005
190000             END-IF                                               19000005
190100         END-IF                                                   19010005
190200     END-IF.                                                      19020005
190300                                                                  19030005
190400     WRITE REPORT-REC FROM H8-HEADER8                             19040005
190500       AFTER ADVANCING +2 LINES.                                  19050005
190600                                                                  19060005
190700     ADD +2                      TO PV-LINES-PER-PAGE.            19070005
190800                                                                  19080005
190900                                                                  19090005
191000 W300-PRINT-DETAIL.                                               19100005
191100*----------------------------------------------------------------*19110005
191200*    PRINTS DETAIL LINES.                                        *19120005
191300*----------------------------------------------------------------*19130005
191400                                                                  19140005
191500     IF PV-LINES-PER-PAGE > PC-LINES-PER-PAGE-MAX                 19150005
191600         PERFORM W100-WRITE-HEADINGS                              19160005
191700         PERFORM W200-WRITE-DETAIL-HEADINGS                       19170005
191800     END-IF.                                                      19180005
191900                                                                  19190005
192000     WRITE REPORT-REC FROM PV-REPORT-REC                          19200005
192100       AFTER ADVANCING PV-LINE-SKIP LINES.                        19210005
192200                                                                  19220005
192300     INITIALIZE REPORT-REC.                                       19230005
192400                                                                  19240005
192500     ADD PV-LINE-SKIP            TO PV-LINES-PER-PAGE.            19250005
192600                                                                  19260005
192700                                                                  19270005
192800                                                                  19280005
192900 Y100-OPEN-TRANCODE-CURSOR.                                       19290005
193000*----------------------------------------------------------------*19300005
193100*   OPENS THE TRANCODE CURSOR.                                   *19310005
193200*----------------------------------------------------------------*19320005
193300                                                                  19330005
193400     EXEC SQL                                                     19340005
193500       OPEN TRANCODE_CSR                                          19350005
193600     END-EXEC.                                                    19360005
193700                                                                  19370005
193800     EVALUATE TRUE                                                19380005
193900       WHEN SQLCODE = ZERO                                        19390005
194000         CONTINUE                                                 19400005
194100       WHEN SQLWARN0 NOT = SPACES                                 19410005
194200       WHEN SQLCODE NOT  = ZERO                                   19420005
194210         MOVE 'Y100-OPEN-TRANCODE-CURSOR'                         19421005
194220                             TO AA-PARAGRAPH-NAME                 19422005
194221         MOVE 'UNSUCCESSFUL OPEN  '                               19422105
194222                             TO AA-DB2-OPERATION                  19422205
194223         MOVE 'TTRNCDE'      TO AA-DB2-TABLE-1                    19422305
194224         PERFORM Z999-DB2-ABEND                                   19422405
194225     END-EVALUATE.                                                19422505
194226                                                                  19422605
194227                                                                  19422705
194228 Y200-CLOSE-TRNCODE-CURSOR.                                       19422805
194229*----------------------------------------------------------------*19422905
194230*   CLOSE THE TRANCODE CURSOR.                                   *19423005
194231*----------------------------------------------------------------*19423105
194232                                                                  19423205
194233     EXEC SQL                                                     19423305
194234       CLOSE TRANCODE_CSR                                         19423405
194235     END-EXEC.                                                    19423505
194236                                                                  19423605
194237     EVALUATE TRUE                                                19423705
194238       WHEN SQLCODE = ZERO                                        19423805
194239         CONTINUE                                                 19423905
194240       WHEN SQLWARN0 NOT = SPACES                                 19424005
194241       WHEN SQLCODE NOT  = ZERO                                   19424105
194242         MOVE 'Y100-CLOSE-TRANCODE-CURSOR'                        19424205
194243                             TO AA-PARAGRAPH-NAME                 19424305
194244         MOVE 'UNSUCCESSFUL CLOSE  '                              19424405
194245                             TO AA-DB2-OPERATION                  19424505
194246         MOVE 'TTRNCDE'      TO AA-DB2-TABLE-1                    19424605
194247         PERFORM Z999-DB2-ABEND                                   19424705
194248     END-EVALUATE.                                                19424805
194249                                                                  19424905
194250 Z998-ABEND.                                                      19425005
194260*----------------------------------------------------------------*19426005
194270*    ABEND ROUTINE                                               *19427005
194280*----------------------------------------------------------------*19428005
194290                                                                  19429005
194300     DISPLAY AA-ABEND-LIT.                                        19430005
194400     DISPLAY AA-PROGRAM-LIT.                                      19440005
194500     DISPLAY AA-PARAGRAPH-LIT.                                    19450005
194600     DISPLAY AA-MESSAGE-LINE-1.                                   19460005
194700     DISPLAY AA-MESSAGE-LINE-2.                                   19470005
194800                                                                  19480005
194900     CALL 'ILBOABN0' USING ABEND-CODE.                            19490005
195000                                                                  19500005
195100                                                                  19510005
195200 Z999-DB2-ABEND.                                                  19520005
195300*----------------------------------------------------------------*19530005
195400*    DB2 ABEND ROUTINE                                           *19540005
195500*----------------------------------------------------------------*19550005
195600                                                                  19560005
195700     DISPLAY AA-ABEND-LIT.                                        19570005
195800     DISPLAY AA-DB2-ERROR-LIT.                                    19580005
195900     DISPLAY AA-PROGRAM-LIT.                                      19590005
196000     DISPLAY AA-PARAGRAPH-LIT.                                    19600005
196100     DISPLAY AA-DB2-OPERATION-LIT.                                19610005
196200     DISPLAY AA-MESSAGE-LINE-1.                                   19620005
196300     DISPLAY AA-MESSAGE-LINE-2.                                   19630005
196400     DISPLAY AA-DB2-TABLE-1.                                      19640005
196500     DISPLAY AA-DB2-TABLE-2.                                      19650005
196600     DISPLAY AA-DB2-TABLE-3.                                      19660005
196700     SET AC-DB2-ERROR TO TRUE.                                    19670005
196800                                                                  19680005
196900     COPY DPPD004.                                                19690005
197000                                                                  19700005
197100     CALL 'ILBOABN0' USING ABEND-CODE.                            19710005
197200                                                                  19720005
197300*----------------------------------------------------------------*19730005
197400*    NAME FORMATTING ROUTINE                                     *19740005
197500*----------------------------------------------------------------*19750005
197600     COPY DPPD024.                                                19760005
197700                                                                  19770005
