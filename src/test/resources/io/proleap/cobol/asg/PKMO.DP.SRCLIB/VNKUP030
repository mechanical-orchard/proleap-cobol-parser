000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    VNKUP030.                                         00020008
000300 AUTHOR.        COGNIZANT.                                        00030008
000400 DATE-WRITTEN.  JUNE 2018.                                        00040008
000500***************************************************************** 00050000
000600*    COBOL II WITH DB2                                          * 00060000
000700***************************************************************** 00070000
000800*  THIS PROGRAM READS A FILE OF VENDOR ID WITH WARE HOUSE       * 00080008
000900*  SHIPPING ADDRESS DATA AND INSERTS THE DATA IN TBUSLOC TABLE. * 00090008
001000*  THE RELATED ENT-ID FROM THE INPUT WILL BE VALIDATED USING    * 00100008
001100*  TEXTENT TABLE.                                               * 00110008
001200*                                                               * 00120000
001220***************************************************************** 00122000
001230* INPUT:                                                        * 00123000
001240*  1. FILE OF VENDOR ID WITH WARE HOUSE SHIPPING ADDRESS DATA   * 00124008
001250*                                                               * 00125000
001251* OUTPUT:                                                       * 00125100
001252*  1. ERROR MESSAGES IF ANY INPUT VENDOR NUMBER IS INVALID      * 00125208
001253*                                                               * 00125300
001260* DB2 TABLES:                                                   * 00126000
001270*  1. EXTERNAL ENTITY TABLE               (DCLGEN TEXTENT)      * 00127009
001280*  2. TBUSLOC TABLE                       (DCLGEN TBUSLOC)      * 00128009
001600***************************************************************** 00160000
001700* CHANGES MADE:                                                 * 00170000
001800* 06/20/2018 - INITIAL VERSION                                  * 00180009
001900*                                                               * 00190000
002000***************************************************************** 00200000
002100 ENVIRONMENT DIVISION.                                            00210000
002200                                                                  00220000
002300 CONFIGURATION SECTION.                                           00230000
002400 SOURCE-COMPUTER. IBM-3090.                                       00240000
002500 OBJECT-COMPUTER. IBM-3090.                                       00250000
002600                                                                  00260000
002700 INPUT-OUTPUT SECTION.                                            00270000
002800 FILE-CONTROL.                                                    00280000
002900     SELECT VENDOR-WHSE-ADRS-FILE ASSIGN TO INP01.                00290010
002910     SELECT VENDOR-MSG-FILE ASSIGN TO OUT01.                      00291000
003000                                                                  00300000
003100 DATA DIVISION.                                                   00310000
003200                                                                  00320000
003300 FILE SECTION.                                                    00330000
003400                                                                  00340000
003500 FD  VENDOR-WHSE-ADRS-FILE                                        00350010
003600     RECORDING MODE F                                             00360000
003700     LABEL RECORDS ARE STANDARD                                   00370000
003800     DATA RECORD IS VENDOR-WHSE-ADRS-RECORD.                      00380010
003900 01  VENDOR-WHSE-ADRS-RECORD     PIC X(700).                      00390041
003910                                                                  00391000
003920 FD  VENDOR-MSG-FILE                                              00392000
003930     RECORDING MODE F                                             00393000
003940     LABEL RECORDS ARE STANDARD                                   00394000
003950     DATA RECORD IS VENDOR-MSG-RECORD.                            00395000
003960 01  VENDOR-MSG-RECORD           PIC X(80).                       00396014
004000                                                                  00400000
004100 WORKING-STORAGE SECTION.                                         00410000
004200                                                                  00420000
004300 01  PROGRAM-CONSTANTS.                                           00430000
004400     05  PC-PROGRAM-NAME         PIC  X(08)  VALUE 'VNKUP030'.    00440008
004500                                                                  00450000
004600 01  PROGRAM-VARIABLES.                                           00460000
004700     05  PV-MAX-TBUSLOC-SEQ-NBR      PIC S9(04)   VALUE +0 COMP.  00481016
004700     05  PV-NEXT-TBUSLOC-SEQ-NBR     PIC S9(04)   VALUE +0 COMP.  00482016
004700     05  PV-MAX-TENTREP-SEQ-NBR      PIC S9(04)   VALUE +0 COMP.  00482148
004700     05  PV-NEXT-TENTREP-SEQ-NBR     PIC S9(04)   VALUE +0 COMP.  00482248
           05  PV-DUN-NBR                  PIC X(09)    VALUE SPACES.   00483047
           05  PV-SAVE-DUN-NBR             PIC X(09)    VALUE SPACES.   00484047
004900     05  INPUT-COUNT                 PIC 9(09)    VALUE 0.        00490130
004900     05  EXISTS-COUNT                PIC 9(09)    VALUE 0.        00490232
004910     05  OUTPUT-COUNT                PIC 9(09)    VALUE 0.        00491000
004920     05  INSERT-COUNT                PIC 9(09)    VALUE 0.        00492000
004920     05  PV-INSERT-COUNT1            PIC 9(09)    VALUE 0.        00493048
005001     05  PV-INPUT-RECORD             PIC X(700)   VALUE SPACES.   00500141
005100                                                                  00510000
005200 01  PROGRAM-SWITCHES.                                            00520000
006800     05  PS-FOUND-ENT-ID-SW          PIC X(01)    VALUE 'N'.      00680000
006900         88 NOTFOUND-ENT-ID                       VALUE 'N'.      00690000
007000         88 FOUND-ENT-ID                          VALUE 'Y'.      00700000
006800     05  PS-END-OF-INPUT-SW          PIC X(01)    VALUE 'N'.      00710012
006900         88 NOTEND-OF-INPUT                       VALUE 'N'.      00720012
007000         88 END-OF-INPUT                          VALUE 'Y'.      00730012
006800     05  PS-VENDOR-NODE-EXISTS-SW    PIC X(01)    VALUE 'N'.      00740043
006900         88 VENDOR-NODE-NOT-EXISTS                VALUE 'N'.      00750043
007000         88 VENDOR-NODE-EXISTS                    VALUE 'Y'.      00760043
009400                                                                  00940000
009500 01  ERROR-MESSAGES.                                              00950000
009600     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                00960000
009700             '*****   PROGRAM: VNKUP030'.                         00970008
009800     05  AA-PARAGRAPH-LIT.                                        00980000
009900         10  FILLER              PIC  X(17)  VALUE                00990000
010000             '***** PARAGRAPH: '.                                 01000000
010100         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        01010000
010200     05  AA-MESSAGE-LINE.                                         01020000
010300         10  FILLER              PIC  X(06)  VALUE '*****'.       01030000
010400         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        01040000
010500     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                01050000
010600             '*****    DB2 ERROR'.                                01060000
010700     05  AA-DB2-OPERATION-LIT.                                    01070000
010800         10  FILLER              PIC  X(17)  VALUE                01080000
010900             '***** OPERATION: '.                                 01090000
011000         10  AA-DB2-OPERATION.                                    01100000
011100             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        01110000
011200             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        01120000
011300     05  AA-DB2-TABLE-1          PIC  X(18)  VALUE SPACES.        01130000
011400     05  AA-DB2-TABLE-2          PIC  X(18)  VALUE SPACES.        01140000
011500     05  AA-DB2-TABLE-3          PIC  X(18)  VALUE SPACES.        01150000
011600                                                                  01160000
011700 01  ABEND-CODE                    PIC S9(4)  COMP SYNC           01170000
011800                                              VALUE ZEROS.        01180000
011900     88 AP-DB2-ERROR               VALUE +4013.                   01190000
012000                                                                  01200000
009800 01  PV-IN-RECORD.                                                01211030
009900     05  PIR-VENDOR-NAME              PIC X(250) VALUE SPACES.    01220041
013500     05  PIR-VENDOR-NUMBER            PIC 9(09)  VALUE ZEROES.    01230011
013500     05  PIR-VENDOR-NODE              PIC X(20)  VALUE ZEROES.    01241039
012900     05  PIR-WAREHS-ADDRS-STREET      PIC X(40)  VALUE SPACES.    01250017
012900     05  PIR-WAREHS-ADDRS-LINE2       PIC X(40)  VALUE SPACES.    01251041
012900     05  PIR-WAREHS-ADDRS-LINE3       PIC X(40)  VALUE SPACES.    01252041
013500     05  PIR-WAREHS-ADDRS-CITY        PIC X(30)  VALUE SPACES.    01260017
013300     05  PIR-WAREHS-ADDRS-STATE       PIC X(02)  VALUE SPACES.    01270041
013300     05  PIR-WAREHS-ADDRS-ZIP         PIC X(12)  VALUE SPACES.    01280017
013300     05  PIR-ATTENTN-TO-TEXT          PIC X(40)  VALUE SPACES.    01290041
013300     05  PIR-ROOM-NO                  PIC X(10)  VALUE SPACES.    01291041
013300     05  PIR-COMMENT1                 PIC X(60)  VALUE SPACES.    01292041
013300     05  PIR-COMMENT2                 PIC X(60)  VALUE SPACES.    01293041
013300     05  PIR-STATUS                   PIC X(01)  VALUE SPACES.    01294041
013300     05  PIR-ST-PROV-CODE             PIC X(06)  VALUE SPACES.    01295041
013300     05  PIR-COUNTRY-CODE             PIC X(03)  VALUE SPACES.    01296041
013700                                                                  01300011
013800 01  PV-OUT-RECORD.                                               01310011
013900     05  POR-VENDOR-NUMBER            PIC 9(09)  VALUE ZEROES.    01320011
014000     05  FILLER                       PIC X(01)  VALUE SPACES.    01330011
014300     05  POR-MESSAGE-O                PIC X(70)  VALUE SPACES.    01340011
014500                                                                  01380011
015516*----------------------------------------------------------------*01551623
015517*  SQLCA FORMATTED MESSAGE AREA                                  *01551723
015518*----------------------------------------------------------------*01551823
015519*                                                                 01551923
015520     COPY DPWS004.                                                01552023
015521*                                                                 01552111
015590*---------------------------------------------------------------  01559000
015600*     SQL COMMUNICATIONS AREA DCLGEN                              01560000
015700*---------------------------------------------------------------  01570000
015800     EXEC SQL                                                     01580000
015900         INCLUDE SQLCA                                            01590000
016000     END-EXEC.                                                    01600000
016100     EJECT                                                        01610000
016200                                                                  01620000
016300*---------------------------------------------------------------  01630000
016400*     TEXTENT DCLGEN                                              01640000
016500*---------------------------------------------------------------  01650000
016600     EXEC SQL                                                     01660000
016700         INCLUDE TEXTENT                                          01670000
016800     END-EXEC.                                                    01680000
016900     EJECT                                                        01690000
017000                                                                  01700000
016300*---------------------------------------------------------------  01701051
016400*     TENTREP DCLGEN                                              01702051
016500*---------------------------------------------------------------  01703051
016600     EXEC SQL                                                     01704051
016700         INCLUDE TENTREP                                          01705051
016800     END-EXEC.                                                    01706051
016900     EJECT                                                        01707051
017000                                                                  01708051
017100*---------------------------------------------------------------  01710000
017200*     TBUSLOC TABLE                                               01720011
017300*---------------------------------------------------------------  01730000
017400     EXEC SQL                                                     01740000
017500         INCLUDE TBUSLOC                                          01750011
017600     END-EXEC.                                                    01760000
017700     EJECT                                                        01770000
018240                                                                  01824000
030700 PROCEDURE DIVISION.                                              03070000
030800                                                                  03080000
030900 A100-MAINLINE-ROUTINE.                                           03090000
031000                                                                  03100000
031100     PERFORM B100-INITIALIZATION.                                 03110000
031200                                                                  03120000
031300     PERFORM 1000-READ-UNSTRING-RTN                               03130012
031400       UNTIL END-OF-INPUT.                                        03140025
031500                                                                  03150000
031600     PERFORM B300-END-OF-JOB.                                     03160000
031700     GOBACK.                                                      03170000
031800                                                                  03180000
031900*--------------------------------------------------------------*  03190000
032000*    INITIALIZATION PROCESSING                                 *  03200000
032100*--------------------------------------------------------------*  03210000
032200 B100-INITIALIZATION.                                             03220000
032210                                                                  03221000
032220     OPEN INPUT  VENDOR-WHSE-ADRS-FILE                            03222010
032230          OUTPUT VENDOR-MSG-FILE.                                 03223000
032300                                                                  03230000
032400     INITIALIZE DCLTBUSLOC                                        03240011
032800                DCLTEXTENT.                                       03280000
033000                                                                  03300000
034030     PERFORM R100-READ-VEND-WHSEADRS-FILE.                        03403011
034040                                                                  03404000
034100 EJECT                                                            03410000
034200*---------------------------------------------------------------* 03420000
034400*  FOR EACH RECORD READ, VALIDATE THE ENT-ID, THE RELATED ENT-ID  03440000
034500*  AND THE RELATIONSHIP CODE VALUE.  IF ALL ARE VALID, CHECK IF   03450000
034510*  THE RELATIONSHIP ENTRY ALREADY EXISTS.  IF IT DOES NOT, INSERT 03451000
034520*  THE ROW. IF THE ROW IS INSERTED SUCCESSFULLY AND THE ENT-ID    03452000
034530*  INDICATES THAT THE VENDOR IS IN RMS, FORMAT AND WRITE AN OUTPUT03453000
034540*  RECORD TO BRIDGE THE RELATIONSHIP TO RMS.                      03454000
034600*----------------------------------------------------------------*03460000
034700 1000-READ-UNSTRING-RTN.                                          03470012
034800                                                                  03480000
035000     INITIALIZE PV-IN-RECORD.                                     03500013
035100                                                                  03510013
           IF NOTEND-OF-INPUT                                           03520035
              IF PV-INPUT-RECORD (1:11) = 'Vendor Name'                 03540047
                 SUBTRACT 1 FROM INPUT-COUNT                            03570035
                 PERFORM R100-READ-VEND-WHSEADRS-FILE                   03580035
              END-IF                                                    03590035
              IF NOTEND-OF-INPUT                                        03600035
049900          UNSTRING PV-INPUT-RECORD                                04990035
050000            DELIMITED BY ','                                      05000035
050100             INTO PIR-VENDOR-NAME                                 05010013
050210                  PIR-VENDOR-NUMBER                               05021013
050220                  PIR-VENDOR-NODE                                 05022013
050230                  PIR-WAREHS-ADDRS-STREET                         05023017
050240                  PIR-WAREHS-ADDRS-LINE2                          05024041
050250                  PIR-WAREHS-ADDRS-LINE3                          05025041
050260                  PIR-WAREHS-ADDRS-CITY                           05026041
                        PIR-WAREHS-ADDRS-STATE                          05026141
                        PIR-WAREHS-ADDRS-ZIP                            05026241
                        PIR-ATTENTN-TO-TEXT                             05026341
                        PIR-ROOM-NO                                     05026441
                        PIR-COMMENT1                                    05026541
                        PIR-COMMENT2                                    05026641
                        PIR-STATUS                                      05026741
                        PIR-ST-PROV-CODE                                05026841
                        PIR-COUNTRY-CODE                                05026941
050270          END-UNSTRING                                            05027035
                                                                        05027113
050280          PERFORM 2000-PROCESS-INPUT                              05028035
050310                                                                  05031000
050311          PERFORM R100-READ-VEND-WHSEADRS-FILE                    05031135
              END-IF                                                    05031235
050312     END-IF.                                                      05031335
050320 EJECT                                                            05032000
050400*---------------------------------------------------------------* 05040000
050500*  2000-PROCESS-INPUT                                             05050013
050600*---------------------------------------------------------------* 05060000
050700 2000-PROCESS-INPUT.                                              05070013
                                                                        05070113
           MOVE PIR-VENDOR-NUMBER TO PV-DUN-NBR                         05070247
                                                                        05070313
           IF PV-DUN-NBR = PV-SAVE-DUN-NBR                              05070447
                                                                        05070514
              CONTINUE                                                  05070614
                                                                        05070714
           ELSE                                                         05070814
                                                                        05070914
              MOVE PV-DUN-NBR     TO PV-SAVE-DUN-NBR                    05071047
              PERFORM S100-VALIDATE-ENT-ID                              05071114
                                                                        05071214
           END-IF.                                                      05071314
                                                                        05071415
           IF FOUND-ENT-ID                                              05071515
              IF PIR-WAREHS-ADDRS-ZIP(1:5) IS NUMERIC                   05071641
                                                                        05071743
                 MOVE 'N' TO PS-VENDOR-NODE-EXISTS-SW                   05071843
                                                                        05071943
                 PERFORM 6070-CHECK-VENDOR-NODE-EXISTS                  05072043
                                                                        05072143
                 IF VENDOR-NODE-EXISTS                                  05072243
                                                                        05072343
                    MOVE PV-DUN-NBR    TO POR-VENDOR-NUMBER             05072447
                    MOVE SPACES        TO POR-MESSAGE-O                 05072544
                    STRING 'VENDOR NODE '                               05072643
                    PIR-VENDOR-NODE ' IS ALREADY EXISTS '               05072743
                    DELIMITED BY SIZE INTO  POR-MESSAGE-O               05072843
                    PERFORM W100-WRITE-VENDOR-MSG-RECORD                05072943
                    ADD +1             TO EXISTS-COUNT                  05073043
                                                                        05073143
                 ELSE                                                   05073243
                    IF PIR-STATUS  = 'A' OR 'I'                         05073346
                       PERFORM 6010-MAX-TBUSLOC                         05073446
                       PERFORM 6030-MAX-TENTREP                         05073548
                       PERFORM 2500-LOAD-TBUSLOC-HOST-VAR               05073646
                       PERFORM 6020-INSERT-TBUSLOC                      05073746
                       PERFORM 6040-INSERT-TENTREP                      05073848
                                                                        05073943
                    ELSE                                                05074046
                       MOVE PV-DUN-NBR    TO POR-VENDOR-NUMBER          05074147
                       MOVE SPACES        TO POR-MESSAGE-O              05074246
                       MOVE 'ADDRESS STATUS SHOULD BE EITHER A OR I'    05074346
                                          TO  POR-MESSAGE-O             05074546
                       PERFORM W100-WRITE-VENDOR-MSG-RECORD             05074646
                                                                        05074746
                    END-IF                                              05074846
                 END-IF                                                 05074943
              ELSE                                                      05075041
                                                                        05075141
                 MOVE PV-DUN-NBR    TO POR-VENDOR-NUMBER                05075247
                 MOVE SPACES        TO POR-MESSAGE-O                    05075344
                 STRING 'ZIPCODE ' PIR-WAREHS-ADDRS-ZIP(1:5)            05075442
                 ' IS NOT NUMERIC '                                     05075542
                 DELIMITED BY SIZE INTO  POR-MESSAGE-O                  05075642
                 PERFORM W100-WRITE-VENDOR-MSG-RECORD                   05075741
                                                                        05075841
              END-IF                                                    05075941
                                                                        05076015
           ELSE                                                         05076115
                                                                        05076215
              MOVE PV-DUN-NBR    TO POR-VENDOR-NUMBER                   05076347
              MOVE 'INPUT VENDOR NUMBER IS INVALID ' TO POR-MESSAGE-O   05076415
                                                                        05076515
              PERFORM W100-WRITE-VENDOR-MSG-RECORD                      05076615
                                                                        05076715
           END-IF.                                                      05076815
050400*---------------------------------------------------------------* 05076914
050500*  B300-END-OF-JOB.                                               05077014
050600*---------------------------------------------------------------* 05077114
050700 B300-END-OF-JOB.                                                 05078014
050800                                                                  05080000
050900     CLOSE VENDOR-WHSE-ADRS-FILE                                  05090010
050910           VENDOR-MSG-FILE.                                       05091000
051000                                                                  05100000
051300     DISPLAY 'INPUT RECORDS READ..............' INPUT-COUNT.      05130000
051310     DISPLAY 'VENDOR WHSE ADDRESS  INSERTED...' INSERT-COUNT.     05131034
051310     DISPLAY 'TENTREP ADDRESS  INSERTED...'  PV-INSERT-COUNT1.    05131148
051320     DISPLAY 'MESSAGE RECORDS WRITTEN.........' OUTPUT-COUNT.     05132000
051401     DISPLAY 'DUPLICATE WHSE ADDRESS BYPASSED.' EXISTS-COUNT.     05140134
051500 EJECT                                                            05150000
051600*---------------------------------------------------------------* 05160000
051700*  MOVES THE INPUT TO HOST VARIABLES OF TBUSLOC                   05170016
051800*---------------------------------------------------------------* 05180000
051900 2500-LOAD-TBUSLOC-HOST-VAR.                                      05190016
052000                                                                  05200000
           MOVE EXTENT-ENT-ID           TO BUSLOC-ENT-ID                05210047
                                           ENTREP-ENT-ID                05211048
           MOVE SPACES                  TO ENTREP-FIRST-NAME            05212048
                                           ENTREP-LAST-NAME             05213048
                                           ENTREP-TITLE-NAME            05214048
                                           ENTREP-TEL1-NBR              05215048
                                           ENTREP-TEL1-EXT-NBR          05216048
                                           ENTREP-TEL2-NBR              05217048
                                           ENTREP-TEL2-EXT-NBR          05218048
                                           ENTREP-FAX-NBR               05219048
                                           ENTREP-EMAIL-ADDR-ID         05219148
                                           ENTREP-TEL-1-CNTRY-CDE       05219248
                                           ENTREP-TEL-2-CNTRY-CDE       05219348
           MOVE PV-NEXT-TBUSLOC-SEQ-NBR TO BUSLOC-SEQ-NBR               05220048
                                           ENTREP-ENT-BUS-LOC-ID        05220149
           MOVE PV-NEXT-TENTREP-SEQ-NBR TO ENTREP-SEQ-NBR               05221050
           MOVE PIR-WAREHS-ADDRS-STREET TO BUSLOC-ADDRESS-LINE1-DESC    05230048
           MOVE PIR-WAREHS-ADDRS-LINE2  TO BUSLOC-ADDRESS-LINE2-DESC    05240048
           MOVE PIR-WAREHS-ADDRS-LINE3  TO BUSLOC-ADDRESS-LINE3-DESC    05250048
           MOVE PIR-VENDOR-NODE         TO BUSLOC-ADDRESS-LINE4-DESC    05260048
           MOVE PIR-WAREHS-ADDRS-CITY   TO BUSLOC-CITY-NAME             05280048
           MOVE PIR-WAREHS-ADDRS-STATE  TO BUSLOC-STATE-CDE             05290048
           MOVE PIR-WAREHS-ADDRS-ZIP    TO BUSLOC-ZIP-CDE               05300048
           MOVE PIR-STATUS              TO BUSLOC-COMMENT3-TXT          05301048
           MOVE 17                      TO BUSLOC-FUNCTION-ID           05303048
                                           ENTREP-FUNCTION-ID           05303148
           MOVE 'VNKUP030'              TO BUSLOC-LAST-UPDATE-ID        05304048
                                           ENTREP-LAST-UPDATE-ID        05304148
           MOVE PIR-VENDOR-NAME (1:40)  TO BUSLOC-EXTD-VND-NM           05305048
           MOVE 'N'                     TO BUSLOC-PRIM-ADDR-IND         05306048
           MOVE PIR-ROOM-NO             TO BUSLOC-ROOM-NBR              05310048
           MOVE PIR-ATTENTN-TO-TEXT     TO BUSLOC-ATTENTION-TO-TXT      05311048
           MOVE PIR-COMMENT1            TO BUSLOC-COMMENT1-TXT          05320048
           MOVE PIR-COMMENT2            TO BUSLOC-COMMENT2-TXT          05321048
           MOVE PIR-ST-PROV-CODE        TO BUSLOC-ST-PROV-CDE           05326048
           MOVE PIR-COUNTRY-CODE        TO BUSLOC-CNTRY-CDE             05327048
           MOVE SPACES                  TO BUSLOC-ALT-1099-VND-NM       05329048
053300     .                                                            05330048
053600 EJECT                                                            05360048
087500*---------------------------------------------------------------* 08752048
087600*  READ A RECORD FROM THE RELATED ENTITIES INPUT FILE.            08760048
087700*---------------------------------------------------------------* 08770048
087800 R100-READ-VEND-WHSEADRS-FILE.                                    08780048
087900                                                                  08790048
087901     READ VENDOR-WHSE-ADRS-FILE INTO PV-INPUT-RECORD              08790148
087902       AT END SET END-OF-INPUT  TO TRUE.                          08790248
087904                                                                  08790448
087905     IF NOTEND-OF-INPUT                                           08790548
087906         ADD 1 TO INPUT-COUNT                                     08790648
087907     END-IF.                                                      08790748
087908                                                                  08790848
087910 EJECT                                                            08791048
087920                                                                  08792048
087930*---------------------------------------------------------------* 08793048
087940*  VALIDATE THE ENTITY ID                                         08794048
087950*---------------------------------------------------------------* 08795048
087960 S100-VALIDATE-ENT-ID.                                            08796048
087970                                                                  08797048
088000     EXEC SQL                                                     08800048
088100         SELECT ENT_ID                                            08842048
088200          INTO :EXTENT-ENT-ID                                     08843048
088400          FROM TEXTENT                                            08844048
088410         WHERE DUN_NBR = :PV-DUN-NBR                              08845048
088500     END-EXEC.                                                    08850048
088510                                                                  08851048
088600     EVALUATE TRUE                                                08860048
088700         WHEN SQLCODE = ZEROES                                    08870048
088800             SET FOUND-ENT-ID TO TRUE                             08880048
088900         WHEN SQLCODE = +100                                      08890048
089000             SET NOTFOUND-ENT-ID TO TRUE                          08900048
089100         WHEN OTHER                                               08910048
089200             MOVE 'S100-VALIDATE-ENT-ID'   TO AA-PARAGRAPH-NAME   08920048
089400             MOVE 'SELECT '                TO AA-DB2-OPERATION    08940048
089600             MOVE 'TEXTENT'                TO AA-DB2-TABLE-1      08960048
                   DISPLAY 'DUN_NBR :'  PV-DUN-NBR                      08970048
089900             PERFORM Z900-DB2-ERROR-ROUTINE                       08990048
090000     END-EVALUATE.                                                09000048
090100 EJECT                                                            09010048
090110*---------------------------------------------------------------* 09011048
090120*  FIND THE MAX OF SEQUNCE NUMBER FROM TBUSLOC TABLE              09012048
090130*---------------------------------------------------------------* 09013048
090140 6010-MAX-TBUSLOC.                                                09014048
090150                                                                  09015048
090160     EXEC SQL                                                     09016048
090162          SELECT MAX(SEQ_NBR)                                     09016248
090163            INTO :PV-MAX-TBUSLOC-SEQ-NBR                          09016348
090164            FROM TBUSLOC                                          09016448
090165           WHERE ENT_ID = :EXTENT-ENT-ID                          09016548
090166     END-EXEC.                                                    09016648
090196                                                                  09019648
090197     EVALUATE TRUE                                                09019748
090198         WHEN SQLCODE = +0                                        09019848
090199              COMPUTE PV-NEXT-TBUSLOC-SEQ-NBR =                   09019948
090200                      PV-MAX-TBUSLOC-SEQ-NBR + 1                  09020048
090201         WHEN SQLCODE = -305                                      09020148
                    MOVE +1         TO PV-NEXT-TBUSLOC-SEQ-NBR          09020248
090202         WHEN OTHER                                               09020348
090203             MOVE '6010-MAX-TBUSLOC'       TO AA-PARAGRAPH-NAME   09020448
090204             MOVE 'SELECT '                TO AA-DB2-OPERATION    09020548
090205             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-1      09020648
090206             PERFORM Z900-DB2-ERROR-ROUTINE                       09020748
090207     END-EVALUATE.                                                09020848
090208 EJECT                                                            09020948
097120*---------------------------------------------------------------* 09712048
097200*  INSERTS A ROW TO THE TBUSLOC TABLE                             09720048
097300*---------------------------------------------------------------* 09730048
097400 6020-INSERT-TBUSLOC.                                             09740048
097500                                                                  09750048
097600     EXEC SQL                                                     09760048
097700         INSERT  INTO TBUSLOC                                     09770048
097800               ( ENT_ID                                           09780048
097900                ,SEQ_NBR                                          09790048
098000                ,ADDRESS_LINE1_DESC                               09800048
098100                ,ADDRESS_LINE2_DESC                               09810048
098200                ,ADDRESS_LINE3_DESC                               09820048
098300                ,ADDRESS_LINE4_DESC                               09830048
098400                ,ATTENTION_TO_TXT                                 09840048
098410                ,CITY_NAME                                        09841048
098420                ,STATE_CDE                                        09842048
098430                ,ZIP_CDE                                          09843048
098440                ,ROOM_NBR                                         09844048
098450                ,COMMENT1_TXT                                     09845048
098460                ,COMMENT2_TXT                                     09846048
098470                ,COMMENT3_TXT                                     09847048
098480                ,FUNCTION_ID                                      09848048
098490                ,LAST_UPDATE_TMST                                 09849048
                      ,LAST_UPDATE_ID                                   09849148
                      ,ST_PROV_CDE                                      09849248
                      ,CNTRY_CDE                                        09849348
                      ,EXTD_VND_NM                                      09849448
                      ,ALT_1099_VND_NM                                  09849548
098491                ,PRIM_ADDR_IND)                                   09849648
              VALUES  (                                                 09849748
                       :BUSLOC-ENT-ID                                   09849848
                      ,:BUSLOC-SEQ-NBR                                  09849948
                      ,:BUSLOC-ADDRESS-LINE1-DESC                       09850048
                      ,:BUSLOC-ADDRESS-LINE2-DESC                       09850148
                      ,:BUSLOC-ADDRESS-LINE3-DESC                       09850248
                      ,:BUSLOC-ADDRESS-LINE4-DESC                       09850348
                      ,:BUSLOC-ATTENTION-TO-TXT                         09850448
                      ,:BUSLOC-CITY-NAME                                09850548
                      ,:BUSLOC-STATE-CDE                                09850648
                      ,:BUSLOC-ZIP-CDE                                  09850748
                      ,:BUSLOC-ROOM-NBR                                 09850848
                      ,:BUSLOC-COMMENT1-TXT                             09850948
                      ,:BUSLOC-COMMENT2-TXT                             09851048
                      ,:BUSLOC-COMMENT3-TXT                             09851148
                      ,:BUSLOC-FUNCTION-ID                              09851248
                      , CURRENT TIMESTAMP                               09851348
                      ,:BUSLOC-LAST-UPDATE-ID                           09851448
                      ,:BUSLOC-ST-PROV-CDE                              09851548
                      ,:BUSLOC-CNTRY-CDE                                09851648
                      ,:BUSLOC-EXTD-VND-NM                              09851748
                      ,:BUSLOC-ALT-1099-VND-NM                          09851848
                      ,:BUSLOC-PRIM-ADDR-IND                            09851948
                     )                                                  09852048
098500     END-EXEC.                                                    09853048
098600                                                                  09860048
098700     EVALUATE TRUE                                                09870048
098800         WHEN SQLCODE = ZEROES                                    09880048
098900              ADD +1 TO INSERT-COUNT                              09890048
099200         WHEN SQLCODE = -803                                      09920048
                    MOVE PV-DUN-NBR    TO POR-VENDOR-NUMBER             09920148
                    STRING 'DIRECT SHIPPING ADDRESS FOR WARE HOUSE '    09920248
                    PIR-VENDOR-NODE ' IS ALREADY EXISTS '               09920348
                    DELIMITED BY SIZE INTO  POR-MESSAGE-O               09920448
                    PERFORM W100-WRITE-VENDOR-MSG-RECORD                09920548
                    ADD +1             TO EXISTS-COUNT                  09920648
099200         WHEN OTHER                                               09921048
099300             MOVE '6020-INSERT-TBUSLOC'    TO AA-PARAGRAPH-NAME   09930048
099400             MOVE 'INSERT'                 TO AA-DB2-OPERATION    09940048
099600             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-1      09960048
099700             PERFORM Z900-DB2-ERROR-ROUTINE                       09970048
099800     END-EVALUATE.                                                09980048
099900 EJECT                                                            09990048
090110*---------------------------------------------------------------* 10000048
090120*  FIND THE MAX OF SEQUNCE NUMBER FROM TENTREP TABLE              10010048
090130*---------------------------------------------------------------* 10020048
090140 6030-MAX-TENTREP.                                                10030048
090150                                                                  10040048
090160     EXEC SQL                                                     10050048
090162          SELECT MAX(SEQ_NBR)                                     10060048
090163            INTO :PV-MAX-TENTREP-SEQ-NBR                          10070048
090164            FROM TENTREP                                          10080048
090165           WHERE ENT_ID = :EXTENT-ENT-ID                          10090048
090166     END-EXEC.                                                    10091048
090196                                                                  10092048
090197     EVALUATE TRUE                                                10093048
090198         WHEN SQLCODE = +0                                        10094048
090199              COMPUTE PV-NEXT-TENTREP-SEQ-NBR =                   10094148
090200                      PV-MAX-TENTREP-SEQ-NBR + 1                  10094248
090201         WHEN SQLCODE = -305                                      10094348
                    MOVE +1         TO PV-NEXT-TENTREP-SEQ-NBR          10094448
090202         WHEN OTHER                                               10094548
090203             MOVE '6030-MAX-TENTREP'       TO AA-PARAGRAPH-NAME   10094648
090204             MOVE 'SELECT '                TO AA-DB2-OPERATION    10094748
090205             MOVE 'TENTREP'                TO AA-DB2-TABLE-1      10094848
090206             PERFORM Z900-DB2-ERROR-ROUTINE                       10094948
090207     END-EVALUATE.                                                10095048
090208 EJECT                                                            10095148
097120*---------------------------------------------------------------* 10095248
097200*  INSERTS A ROW TO THE TENTREP TABLE                             10095348
097300*---------------------------------------------------------------* 10095448
097400 6040-INSERT-TENTREP.                                             10095548
097500                                                                  10095648
416100         EXEC SQL                                                 10095748
416200             INSERT  INTO TENTREP                                 10095848
416300                   ( ENT_ID                                       10095948
416400                    ,SEQ_NBR                                      10096048
416500                    ,FIRST_NAME                                   10097048
416600                    ,LAST_NAME                                    10098048
416700                    ,TITLE_NAME                                   10099048
416800                    ,TEL1_NBR                                     10100048
416900                    ,TEL1_EXT_NBR                                 10100148
417000                    ,TEL2_NBR                                     10100248
417100                    ,TEL2_EXT_NBR                                 10100348
417200                    ,FAX_NBR                                      10100448
417300                    ,ENT_BUS_LOC_ID                               10100548
417400                    ,FUNCTION_ID                                  10100648
417500                    ,LAST_UPDATE_TMST                             10100748
417600                    ,LAST_UPDATE_ID                               10100848
417700                    ,EMAIL_ADDR_ID                                10100948
417800                    ,TEL_1_CNTRY_CDE                              10101048
417900                    ,TEL_2_CNTRY_CDE)                             10101148
418000            VALUES  (:ENTREP-ENT-ID                               10101248
418100                    ,:ENTREP-SEQ-NBR                              10101348
418200                    ,:ENTREP-FIRST-NAME                           10101448
418300                    ,:ENTREP-LAST-NAME                            10101548
418400                    ,:ENTREP-TITLE-NAME                           10101648
418500                    ,:ENTREP-TEL1-NBR                             10101748
418600                    ,:ENTREP-TEL1-EXT-NBR                         10101848
418700                    ,:ENTREP-TEL2-NBR                             10101948
418800                    ,:ENTREP-TEL2-EXT-NBR                         10102048
418900                    ,:ENTREP-FAX-NBR                              10102148
419000                    ,:ENTREP-ENT-BUS-LOC-ID                       10102248
419100                    ,:ENTREP-FUNCTION-ID                          10102348
419200                    , CURRENT TIMESTAMP                           10102448
419300                    ,:ENTREP-LAST-UPDATE-ID                       10102548
419400                    ,:ENTREP-EMAIL-ADDR-ID                        10102648
419500                    ,:ENTREP-TEL-1-CNTRY-CDE                      10102748
419600                    ,:ENTREP-TEL-2-CNTRY-CDE)                     10102848
419700         END-EXEC                                                 10102948
098600                                                                  10103048
098700     EVALUATE TRUE                                                10103148
098800         WHEN SQLCODE = ZEROES                                    10103248
098900              ADD +1 TO PV-INSERT-COUNT1                          10103348
099200         WHEN SQLCODE = -803                                      10103448
                    MOVE PV-DUN-NBR    TO POR-VENDOR-NUMBER             10103548
                    STRING 'DIRECT SHIPPING ADDRESS FOR WARE HOUSE '    10103648
                    PIR-VENDOR-NODE ' IS ALREADY EXISTS IN TENTREP'     10103748
                    DELIMITED BY SIZE INTO  POR-MESSAGE-O               10103848
                    PERFORM W100-WRITE-VENDOR-MSG-RECORD                10103948
                    ADD +1             TO EXISTS-COUNT                  10104048
099200         WHEN OTHER                                               10104148
099300             MOVE '6020-INSERT-TENTREP'    TO AA-PARAGRAPH-NAME   10104248
099400             MOVE 'INSERT'                 TO AA-DB2-OPERATION    10104348
099600             MOVE 'TENTREP'                TO AA-DB2-TABLE-1      10104448
099700             PERFORM Z900-DB2-ERROR-ROUTINE                       10104548
099800     END-EVALUATE.                                                10104648
099900 EJECT                                                            10104748
090110*---------------------------------------------------------------* 10104848
090120*  CHECK THE INPUT VENDOR NODE ALREADY EXISTS                     10104948
090130*---------------------------------------------------------------* 10105048
090140 6070-CHECK-VENDOR-NODE-EXISTS.                                   10105148
090150                                                                  10105248
090160     EXEC SQL                                                     10105348
090162          SELECT ADDRESS_LINE4_DESC                               10105448
090163            INTO :BUSLOC-ADDRESS-LINE4-DESC                       10105548
090164            FROM TBUSLOC                                          10105648
090165           WHERE ADDRESS_LINE4_DESC = :PIR-VENDOR-NODE            10105748
090166     END-EXEC.                                                    10105848
090196                                                                  10105948
090197     EVALUATE TRUE                                                10106048
090198         WHEN SQLCODE = +0 OR -811                                10106148
090199              SET VENDOR-NODE-EXISTS     TO TRUE                  10106248
090201         WHEN SQLCODE = +100                                      10106348
                    SET VENDOR-NODE-NOT-EXISTS TO TRUE                  10106448
090202         WHEN OTHER                                               10106548
090203             MOVE '6070-CHECK-VENDOR-NODE-EXISTS'                 10106648
090203                                           TO AA-PARAGRAPH-NAME   10106748
090204             MOVE 'SELECT '                TO AA-DB2-OPERATION    10106848
090205             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-1      10106948
090206             PERFORM Z900-DB2-ERROR-ROUTINE                       10107048
090207     END-EVALUATE.                                                10107148
090208 EJECT                                                            10107248
100900*----------------------------------------------------------------*10107348
101000*  W100-WRITE-VENDOR-MSG-RECORD                                  *10108048
101100*----------------------------------------------------------------*10110048
101200                                                                  10120048
101300 W100-WRITE-VENDOR-MSG-RECORD.                                    10130048
101400                                                                  10140048
101500     WRITE VENDOR-MSG-RECORD FROM PV-OUT-RECORD.                  10150048
101600                                                                  10160048
           ADD +1           TO OUTPUT-COUNT                             10170048
119600     .                                                            11960048
119700*--------------------------------------------------------------*  11970048
119800*     DB2 ERROR ROUTINE                                        *  11980048
119900*--------------------------------------------------------------*  11990048
120000 Z900-DB2-ERROR-ROUTINE.                                          12000048
120100                                                                  12010048
120200     DISPLAY '*** DB2 ERROR '.                                    12020048
120300     DISPLAY AA-DB2-ERROR-LIT.                                    12030048
120400     DISPLAY AA-PROGRAM-LIT.                                      12040048
120500     DISPLAY AA-PARAGRAPH-LIT.                                    12050048
120600     DISPLAY AA-DB2-OPERATION-LIT.                                12060048
120700     DISPLAY AA-DB2-TABLE-1.                                      12070048
120800     DISPLAY AA-DB2-TABLE-2.                                      12080048
120900     DISPLAY AA-DB2-TABLE-3.                                      12090048
121000     SET AP-DB2-ERROR TO TRUE.                                    12100048
121100                                                                  12110048
121200     COPY DPPD004.                                                12120048
121300     CALL 'ILBOABN0' USING ABEND-CODE.                            12130048
