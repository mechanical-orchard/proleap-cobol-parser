000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.             SUKRF530.                                00050001
000600 AUTHOR.                 GERMAN BANDA.                            00060001
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070001
000800 DATE-WRITTEN.           JUNE, 2000.                              00080058
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100*----------------------------------------------------------------*00110001
001200* THIS PROGRAM WILL DISPLAY ERROR WARNING MESSAGES ON THE (LASER  00120003
001300* RADIO TERMINAL).                                                00130001
001400*----------------------------------------------------------------*00140059
000597* 09/26/14    CHERI PARMLEY  CHG0094517     TKID: TKMAF76        *00141099
000598*             CHANGED PO# FROM 7 DIGITS TO 8 DIGITS              *00142099
001600******************************************************************00160059
001700 ENVIRONMENT DIVISION.                                            00170059
001800******************************************************************00180059
001900                                                                  00190059
002000******************************************************************00200059
002100 DATA DIVISION.                                                   00210059
002200******************************************************************00220059
002300                                                                  00230059
002400******************************************************************00240059
002500 WORKING-STORAGE SECTION.                                         00250059
002600******************************************************************00260059
002700*                                                                 00270059
002800 01  CA-COMMAREA.                                                 00280059
002900*----------------------------------------------------------------*00290059
003000*  COMMAREA LAYOUT FOR THE CARTON CHECK-IN RF SCREEN              00300059
003100*----------------------------------------------------------------*00310059
003200     COPY SUWS001.                                                00320063
003300                                                                  00330059
003400*----------------------------------------------------------------*00340059
003500*  DB2 KEYS                                                      *00350059
003600*----------------------------------------------------------------*00360059
003700 01  DK-DB2-KEYS.                                                 00370059
003800     05  DK-CURR-OPER-UNT-ID             PIC  S9(4) COMP.         00380059
003900     05  DK-FCLTY-ID                     PIC  S9(4) VALUE +1      00390059
004000                                                    COMP.         00400059
004100                                                                  00410059
004200*----------------------------------------------------------------*00420059
004300*  PROGRAM CONSTANTS                                             *00430059
004400*----------------------------------------------------------------*00440059
004500 01  PC-PROGRAM-CONSTANTS.                                        00450059
004600     05  PC-TRANID                       PIC  X(04)  VALUE 'S530'.00460059
004610     05  PC-SU-LBL-PRT-TRANS             PIC  X(04)  VALUE 'S527'.00461086
004700     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00470059
004800                                                     COMP SYNC.   00480059
004900     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   00490059
005000                                                     COMP SYNC.   00500059
005100***  05  PC-COMMAREA-LENGTH              PIC S9(04)  VALUE +300   00510059
005200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00520059
005300                                                     COMP SYNC.   00530059
005400     05  PC-RECEIVE-LENGTH               PIC S9(04)  VALUE +1     00540059
005500                                                     COMP SYNC.   00550059
005600                                                                  00560059
005700     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'SUKRF530'.   00570059
005800     05  PC-SU-MENU-PGM             PIC X(08) VALUE 'SUKRF500'.   00580059
005900     05  PC-TRAILER-START-PGM       PIC X(08) VALUE 'SUKRF501'.   00590059
006000     05  PC-SHIPPING-UNIT-PGM       PIC X(08) VALUE 'SUKRF502'.   00600059
006100     05  PC-TRIP-START-SCREEN       PIC X(08) VALUE 'SUKRF529'.   00610059
006200     05  PC-MULTI-LINE              PIC X(04) VALUE 'MULT'.       00620080
007300                                                                  00730001
007400*----------------------------------------------------------------*00740001
007500*   ERROR MESSAGES                                                00750001
007600*----------------------------------------------------------------*00760001
007700     05  PC-DB2-DATABASE-ERROR-MSG  PIC X(19)                     00770001
007800                                    VALUE  'DB2 ACCESS ERROR   '. 00780001
007900     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19)                     00790001
008000                                    VALUE  'UNRECOGNIZED PF KEY'. 00800001
008001     05  PC-PRESS-ENTER-TO-CONTINUE PIC X(19)                     00800159
008002                                    VALUE  'PRESS ENTER TO CONT'. 00800201
008100     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19)                     00810001
008200                                    VALUE  'ENTER THROUGH MENU '. 00820001
008300     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19)                     00830001
008400                                    VALUE  'TRANS NOT AVAILABLE'. 00840001
008500     05  PC-PLS-ENT-FLD-MSG         PIC X(19)                     00850001
008600                                    VALUE  'PLEASE ENTER FIELD '. 00860001
008700     05  PC-MUST-BE-NUM-MSG         PIC X(19)                     00870001
008800                                    VALUE  'MUST BE NUMERIC    '. 00880001
008900     05  PC-MUST-BE-GT-0-MSG        PIC X(19)                     00890001
009000                                    VALUE  'MUST BE > ZERO     '. 00900001
009100     05  PC-MUST-BE-PBS-MSG         PIC X(19)                     00910001
009200                                    VALUE  'RCVR NOT PK-BY-STR '. 00920001
009300     05  PC-STR-NOT-XCRIBED-MSG     PIC X(19)                     00930001
009400                                    VALUE  'STR NOT TRANSCRIBED'. 00940001
009500     05  PC-CICS-ERR-MSG            PIC X(19)                     00950001
009600                                    VALUE  'CICS ACCESS ERROR  '. 00960001
010100     05  PC-NOT-AVAILABLE           PIC X(19)                     01010001
010200                                    VALUE 'T - NOT AVAILABLE  '.  01020001
010201******************************************************************01020116
010202********** CASEPACK SPLIT ERROR MESSAGES *************************01020216
010203******************************************************************01020316
010210     05  PC-NO-CSEPK-SPLIT-I        PIC X(19)                     01021008
010220                                    VALUE 'UCC128 DATA IGNORED'.  01022008
010221     05  PC-NO-CSEPK-SPLIT-NA       PIC X(19)                     01022108
010222                                    VALUE 'UCC128 NOT AVAILABL'.  01022208
010223     05  PC-NO-CSEPK-SPLIT-NA-2     PIC X(19)                     01022308
010224                                    VALUE 'AT CSEPK SPLIT TIME'.  01022408
010225     05  PC-NO-CSEPK-SPLIT-1        PIC X(19)                     01022508
010226                                    VALUE 'CASEPACK SPLIT HAS '.  01022608
010230     05  PC-NO-CSEPK-SPLIT-2        PIC X(19)                     01023001
010240                                    VALUE 'NOT BEEN PERFORMED '.  01024001
010250     05  PC-NO-CSEPK-SPLIT-3        PIC X(19)                     01025001
010260                                    VALUE 'NO LABELS WILL BE  '.  01026001
010270     05  PC-NO-CSEPK-SPLIT-4        PIC X(19)                     01027001
010271                                    VALUE 'PRINTED            '.  01027114
010272******************************************************************01027216
010273********** NO LABEL DATA ERROR MESSAGES ************************* 01027316
010274******************************************************************01027416
010276     05  PC-NO-LABEL-DATA-1         PIC X(19)                     01027613
010277                                    VALUE 'NO LABEL INFORMATIN'.  01027716
010278     05  PC-NO-LABEL-DATA-2         PIC X(19)                     01027813
010279                                    VALUE 'WAS FOUND,  CONTACT'.  01027916
010280     05  PC-NO-LABEL-DATA-3         PIC X(19)                     01028013
010290                                    VALUE 'SUPERVISOR         '.  01029013
010291******************************************************************01029117
010292********** UNABLE TO ASSIGN LABEL MESSAGE *********************** 01029217
010293******************************************************************01029317
010294     05  PC-NO-ASSIGN-MSG-1         PIC X(19)                     01029417
010295                                    VALUE 'UNABLE TO ASSIGN   '.  01029517
010296     05  PC-NO-ASSIGN-MSG-2         PIC X(19)                     01029617
010297                                    VALUE 'LABEL FOR CTN,     '.  01029717
010298     05  PC-NO-ASSIGN-MSG-3         PIC X(19)                     01029817
010299                                    VALUE 'PLEASE RE-SCAN CTN '.  01029917
010300******************************************************************01030017
010301********* 4 X 4 LABELS  MUST BE USED **************************** 01030117
010302********* FOR CENTRAL STOCK LABELS   **************************** 01030217
010303******************************************************************01030317
010304     05  PC-CENTRAL-STOCK-MSG-1     PIC X(19)                     01030417
010305                                    VALUE 'ALLOC FOR CENTRAL  '.  01030517
010306     05  PC-CENTRAL-STOCK-MSG-2     PIC X(19)                     01030617
010307                                    VALUE 'STOCK,             '.  01030717
010308     05  PC-CENTRAL-STOCK-MSG-3     PIC X(19)                     01030817
010309                                    VALUE 'MUST REPRINT WITH  '.  01030917
010310     05  PC-CENTRAL-STOCK-MSG-4     PIC X(19)                     01031017
010311                                    VALUE '4 X 4 LABEL STOCK  '.  01031117
010320                                                                  01032017
010321******************************************************************01032159
010322********* DUPLICATE CARTON SCAN MSG  **************************** 01032217
010323******************************************************************01032317
010324     05  PC-DUP-CTN-1               PIC X(19)                     01032417
010325                                    VALUE 'DUPLICATE CARTON,  '.  01032517
010326     05  PC-DUP-CTN-2               PIC X(19)                     01032617
010327                                    VALUE 'NO LABEL WILL BE   '.  01032717
010328     05  PC-DUP-CTN-3               PIC X(19)                     01032817
010329                                    VALUE 'PRINTED            '.  01032917
010330******************************************************************01033017
010331********* PRE-PACK ORDER MESSAGE     **************************** 01033117
010332******************************************************************01033217
010333     05  PC-PREPK-ORD-1             PIC X(19)                     01033317
010334                                    VALUE 'PRE-PACK ORDER, NO '.  01033417
010335     05  PC-PREPK-ORD-2             PIC X(19)                     01033517
010336                                    VALUE 'LABELS WILL BE PRTD'.  01033617
010337     05  PC-PREPK-ORD-3             PIC X(19)                     01033717
010338                                    VALUE 'USE PHYSICAL STACK '.  01033817
010339     05  PC-PREPK-ORD-4             PIC X(19)                     01033917
010340                                    VALUE 'OF LABELS          '.  01034017
010341******************************************************************01034117
010342********* PACK BY STORE RCVR, BUT CART DATA IS BULK TYPE ******** 01034217
010343******************************************************************01034317
010344     05  PC-PBS-RCVR-1              PIC X(19)                     01034417
010345                                    VALUE 'RCVR IS PACK-BY-STR'.  01034517
010346     05  PC-PBS-RCVR-2              PIC X(19)                     01034617
010347                                    VALUE 'CARTON DATA ASSIGND'.  01034717
010348     05  PC-PBS-RCVR-3              PIC X(19)                     01034817
010349                                    VALUE 'TO A DC OPER UNT ID'.  01034917
010350                                                                  01035017
010351******************************************************************01035117
010352********* CARTON NOT ATTACHED TO A RECIEVER NUMBER ************** 01035217
010353******************************************************************01035317
010354     05  PC-NO-RCVR-1               PIC X(19)                     01035459
010355                                    VALUE 'CARTON NOT ATTACHED'.  01035517
010356     05  PC-NO-RCVR-2               PIC X(19)                     01035617
010357                                    VALUE 'TO A RCVR SEQ NMBR '.  01035717
010358                                                                  01035817
010359******************************************************************01035917
010360********* COMTEC INNER PACK ERROR MESSAGE          ************** 01036017
010370******************************************************************01037017
010371     05  PC-COMTEC-INPK-1           PIC X(19)                     01037159
010372                                    VALUE 'UNABLE TO USE      '.  01037217
010373     05  PC-COMTEC-INPK-2           PIC X(19)                     01037317
010374                                    VALUE 'COMTEC FOR INNER PK'.  01037417
010375     05  PC-COMTEC-INPK-3           PIC X(19)                     01037517
010376                                    VALUE 'LABELS, REPRINT    '.  01037617
010377     05  PC-COMTEC-INPK-4           PIC X(19)                     01037717
010378                                    VALUE 'USING 4X4 LBL STOCK'.  01037817
010379                                                                  01037917
010380******************************************************************01038017
010381********* DEPARTED/DELETED STATUS ERROR MESSAGE    ************** 01038117
010382******************************************************************01038217
010383     05  PC-DEP-OR-DEL-STATUS-1     PIC X(19)                     01038359
010384                                    VALUE '   TRIP ENTERED    '.  01038417
010385     05  PC-DEP-OR-DEL-STATUS-2     PIC X(19)                     01038559
010386                                    VALUE ' IS IN A DEPARTED  '.  01038617
010387     05  PC-DEP-OR-DEL-STATUS-3     PIC X(19)                     01038759
010388                                    VALUE ' IS IN A DELETED   '.  01038817
010389     05  PC-DEP-OR-DEL-STATUS-4     PIC X(19)                     01038959
010390                                    VALUE '    STATUS         '.  01039017
010391                                                                  01039117
010392******************************************************************01039217
010393********* CARTON ID SCANNED HAS BEEN PREV INACTIVATED *********** 01039317
010394******************************************************************01039417
010395     05  PC-INACTIVE-CRTN-STAT-1    PIC X(19)                     01039559
010396                                    VALUE ' CARTON ID SCANNED '.  01039659
010397     05  PC-INACTIVE-CRTN-STAT-2    PIC X(19)                     01039759
010398                                    VALUE 'HAS BEEN PREVIOUSLY'.  01039817
010399     05  PC-INACTIVE-CRTN-STAT-3    PIC X(19)                     01039959
010400                                    VALUE '  INACTIVATED      '.  01040059
010410*----------------------------------------------------------------*01041001
010420******************************************************************01042059
010430********* CARTON CREATED DURING CHECK-IN NO ASN       *********** 01043059
010440******************************************************************01044059
010450     05  PC-CARTON-CREATED-RCV-1    PIC X(19)                     01045059
010460                                    VALUE 'CARTON CREATED IN  '.  01046060
010470     05  PC-CARTON-CREATED-RCV-2    PIC X(19)                     01047059
010480                                    VALUE 'CHECK-IN (NO ASN)  '.  01048060
010490     05  PC-CARTON-CREATED-RCV-3    PIC X(19)                     01049059
010491                                    VALUE 'CANNOT CREATE SML  '.  01049160
010492     05  PC-CARTON-CREATED-RCV-4    PIC X(19)                     01049259
010493                                    VALUE 'CONTACT SUPERVISOR '.  01049362
010494******************************************************************01049463
010495********* VERIFY LOGGED ON TO CORRECT TRAILER         *********** 01049563
010496******************************************************************01049663
010497     05  PC-VRFY-CORRECT-TRAILER-1  PIC X(19)                     01049763
010498                                    VALUE 'ARE YOU LOGGED INTO'.  01049867
010499     05  PC-VRFY-CORRECT-TRAILER-2  PIC X(19)                     01049963
010500                                    VALUE 'CORRECT TRAILER ?  '.  01050067
010501     05  PC-VRFY-CORRECT-TRAILER-4  PIC X(19)                     01050163
010502                                    VALUE 'F2 - YES           '.  01050296
010503     05  PC-VRFY-CORRECT-TRAILER-5  PIC X(19)                     01050363
010504                                    VALUE 'F3 - NO            '.  01050496
010505******************************************************************01050571
010506********* CARTON AT WRONG FACILITY                    *********** 01050671
010507******************************************************************01050771
010508     05  PC-CRTN-WRONG-FACILITY-1   PIC X(19)                     01050871
010509                                    VALUE 'CARTON AT WRONG    '.  01050971
010510******************************************************************01051090
010511** LABOR ASSIGNMENT HAS EXPIRED - NEED TO LOG BACK INTO TRAILER **01051190
010512******************************************************************01051290
010513     05  PC-LABOR-ASGMT-EXPIRED-1   PIC X(19)                     01051390
010514                                    VALUE 'LABOR ASGMT EXPIRED'.  01051490
010515     05  PC-LABOR-ASGMT-EXPIRED-2   PIC X(19)                     01051590
010516                                    VALUE ' LACK OF ACTIVITY  '.  01051690
010517     05  PC-LABOR-ASGMT-EXPIRED-3   PIC X(19)                     01051790
010518                                    VALUE ' LABELS WILL PRINT '.  01051890
010519     05  PC-LABOR-ASGMT-EXPIRED-4   PIC X(19)                     01051990
010520                                    VALUE ' YOU ARE REQUIRED  '.  01052090
010521     05  PC-LABOR-ASGMT-EXPIRED-5   PIC X(19)                     01052190
010522                                    VALUE 'TO LOG INTO TRAILER'.  01052290
010523******************************************************************01052399
010524     05  PC-DEPART-DIFF-DC-1        PIC X(19)                     01052499
010525                                    VALUE ' DEPARTED TRAILER  '.  01052599
010526     05  PC-DEPART-DIFF-DC-2        PIC X(19)                     01052699
010527                                    VALUE '  NOT FOR YOUR DC  '.  01052799
010528     05  PC-DEPART-DIFF-DC-3        PIC X(19)                     01052899
010529                                    VALUE '    CANNOT USE     '.  01052999
010530     05  PC-DEPART-DIFF-DC-4        PIC X(19)                     01053099
010531                                    VALUE ' VALIDATE TRIP ID  '.  01053199
010532     05  PC-DEPART-DIFF-DC-5        PIC X(19)                     01053299
010533                                    VALUE 'CONTACT SUPERVISOR '.  01053399
010534******************************************************************01053492
010535     05  PC-DEPART-MAX-DAYS-1       PIC X(19)                     01053599
010536                                    VALUE ' DEPARTED TRAILER  '.  01053699
010537     05  PC-DEPART-MAX-DAYS-2       PIC X(19)                     01053799
010538                                    VALUE 'DEPART DATE GREATER'.  01053899
010539     05  PC-DEPART-MAX-DAYS-3       PIC X(19)                     01053999
010540                                    VALUE 'THAN ALLOWABLE DAYS'.  01054099
010541     05  PC-DEPART-MAX-DAYS-4       PIC X(19)                     01054199
010542                                    VALUE 'CANNOT USE TRIP ID '.  01054299
010543     05  PC-DEPART-MAX-DAYS-5       PIC X(19)                     01054399
010544                                    VALUE 'CONTACT SUPERVISOR '.  01054499
010545******************************************************************01054599
010546     05  PC-LABELS-SUBMITTED-1      PIC X(19)                     01054692
010547                                    VALUE 'LABELS HAVE BEEN   '.  01054792
010548     05  PC-LABELS-SUBMITTED-2      PIC X(19)                     01054892
010549                                    VALUE 'SUBMITTED          '.  01054992
010550     05  PC-LABELS-SUBMITTED-3      PIC X(19)                     01055094
010551                                    VALUE 'F3-CONT IGNORE     '.  01055194
010552*----------------------------------------------------------------*01055294
010560* PROGRAM SWITCHES                                               *01056094
010600*----------------------------------------------------------------*01060001
010700 01  PS-PROGRAM-SWITCHES.                                         01070001
010800     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01080001
010900         88  PS-VALID-INPUT                          VALUE 'Y'.   01090001
011000         88  PS-INVALID-INPUT                        VALUE 'N'.   01100001
011100     05  PS-TRIP-SW                      PIC  X(01)  VALUE ' '.   01110001
011200         88  PS-VALID-TRIP-ID                        VALUE 'Y'.   01120001
011300         88  PS-INVALID-TRIP-ID                      VALUE 'N'.   01130001
011400                                                                  01140001
011500*----------------------------------------------------------------*01150001
011600* PROGRAM VARIABLES                                              *01160001
011700*----------------------------------------------------------------*01170001
011800 01  PV-PROGRAM-VARIABLES.                                        01180001
011900     05  PV-CICS-MSG-AREA.                                        01190001
012000         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 01200001
012100         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 01210001
012200         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 01220001
012300         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 01230001
012400         10  PV-CICS-MSG-AREA5           PIC  X(80)  VALUE SPACE. 01240001
012500         10  PV-CICS-MSG-AREA6           PIC  X(80)  VALUE SPACE. 01250001
012800     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01280001
012900     05  PV-RECEIVE-DATA                 PIC  X(01)  VALUE SPACE. 01290001
013000     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  01300001
013100                                                     COMP SYNC.   01310001
013200     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01320001
013300     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZEROS  01330001
013400                                                     COMP SYNC.   01340001
013500     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZEROS  01350001
013600                                                     COMP SYNC.   01360001
013700     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZEROS  01370001
013800                                                     COMP SYNC.   01380001
013900     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    01390001
014000                                                     COMP SYNC.   01400001
014100*                                                                 01410001
014200     05  PV-PROGRAM-DATA.                                         01420001
014300         10  PV-MANIFEST.                                         01430001
014400             15  PV-MANIFEST-N           PIC  9(11).              01440001
014500         10  PV-OPER-UNIT                PIC S9(09)  VALUE ZEROS. 01450001
014501*                                                                 01450105
014505     05  PV-PO-RCVR-NBR.                                          01450515
      *CLP 09/26/2014                                                   01450699
014506         10  PV-PO-NBR                  PIC  9(08).               01450799
014507         10  FILLER                     PIC  X(01) VALUE '-'.     01450805
014508         10  PV-RCV-SEQ-NBR             PIC  9(03).               01450905
014509*                                                                 01451080
014510         10  PV-PO-LINE-N                  PIC 9(09).             01451180
014511         10  PV-PO-LINE-X REDEFINES PV-PO-LINE-N.                 01451280
014512             15 FILLER                     PIC X(05).             01451380
014513             15 PV-PO-LINE-OUT             PIC X(04).             01451480
014514                                                                  01451580
014515     05  PV-SCAC-TRLR-DISPLAY.                                    01451663
014516         10  PV-DISP-SCAC               PIC  X(04).               01451765
014517         10  FILLER                     PIC  X(01) VALUE '/'.     01451863
014518         10  PV-DISP-TRLR               PIC  X(10).               01451966
014519     05  PV-CRTN-OPER-UNIT              PIC  S9(4).               01452075
014520     05  PV-WRONG-FACILITY-MESSAGE.                               01452172
014521         10 PV-FACILITY-MESSAGE         PIC  X(8)                 01452274
014530                                           VALUE 'FACILITY'.      01453072
014531         10 FILLER                      PIC  X(04).               01453176
014540         10 PV-CRTN-OPER-ID             PIC  X(04).               01454076
014550         10 FILLER                      PIC  X(03).               01455074
014600*                                                                 01460072
014700*----------------------------------------------------------------*01470001
014800*  GENERATED DSECT FOR THE SUKM530 MAPSET                         01480002
014900*----------------------------------------------------------------*01490001
015000     COPY SUKM530.                                                01500001
015100                                                                  01510001
015200*----------------------------------------------------------------*01520001
015300*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 01530001
015400*----------------------------------------------------------------*01540001
015500     COPY DPWS010I.                                               01550063
015600                                                                  01560001
015700*----------------------------------------------------------------*01570001
015800*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01580001
015900*----------------------------------------------------------------*01590001
016000     COPY DPWS013.                                                01600063
016100                                                                  01610001
016200*----------------------------------------------------------------*01620001
016300*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01630001
016400*----------------------------------------------------------------*01640001
016500     COPY DPWS015.                                                01650063
016600                                                                  01660001
017200*----------------------------------------------------------------*01720001
017300*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01730001
017400*----------------------------------------------------------------*01740001
017500     COPY DFHAID.                                                 01750001
017600                                                                  01760001
017700*---------------------------------------------------------------* 01770001
017800*    DB2 AREA FOR THE TRIP STATUS TABLE                         * 01780001
017900*---------------------------------------------------------------* 01790001
018000     EXEC SQL                                                     01800001
018100          INCLUDE TTRIPST                                         01810001
018200     END-EXEC.                                                    01820001
018300                                                                  01830001
018400*---------------------------------------------------------------* 01840063
018500*    DB2 AREA FOR THE MESSAGE TABLE                             * 01850063
018600*---------------------------------------------------------------* 01860063
018700     EXEC SQL                                                     01870063
018800          INCLUDE TLBVRMG                                         01880063
018900     END-EXEC.                                                    01890063
019000                                                                  01900063
019010*---------------------------------------------------------------* 01901073
019020*    DB2 AREA FOR THE SHIPPING UNIT TABLE                       * 01902073
019030*---------------------------------------------------------------* 01903073
019040     EXEC SQL                                                     01904073
019050          INCLUDE TSHPUNT                                         01905073
019060     END-EXEC.                                                    01906073
019070                                                                  01907073
019100*---------------------------------------------------------------* 01910001
019200*  COMMUNICATIONS AREA FOR DB2                                    01920001
019300*---------------------------------------------------------------* 01930001
019400     EXEC SQL                                                     01940001
019500         INCLUDE SQLCA                                            01950001
019600     END-EXEC.                                                    01960001
019700                                                                  01970001
019800***************************************************************** 01980001
019900 LINKAGE SECTION.                                                 01990001
020000******************************************************************02000001
020100*01  DFHCOMMAREA                   PIC  X(300).                   02010001
020200 01  DFHCOMMAREA.                                                 02020059
020300     05  FILLER                       OCCURS 1 TO 4072 TIMES      02030059
020400                                      DEPENDING ON EIBCALEN.      02040059
020500         10  FILLER                   PIC X.                      02050059
020501                                                                  02050159
020502                                                                  02050201
020503******************************************************************02050301
020504 PROCEDURE DIVISION.                                              02050401
020505******************************************************************02050501
020600 0000-PROGRAM-MAINLINE.                                           02060001
020700                                                                  02070001
020801     INITIALIZE CA-COMMAREA                                       02080159
020802     MOVE DFHCOMMAREA TO CA-COMMAREA.                             02080201
020900                                                                  02090001
021000     EXEC CICS                                                    02100001
021100         ASSIGN USERID (SU001-USER-ID)                            02110001
021200                RESP   (PV-CICS-RESPONSE)                         02120001
021400     END-EXEC.                                                    02140001
021500                                                                  02150001
021600     EVALUATE TRUE                                                02160001
021700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02170001
021800             CONTINUE                                             02180001
021900         WHEN OTHER                                               02190001
022000            MOVE '0000-PROGRAM-MAINLINE' TO DP013-PARAGRAPH       02200001
022100            MOVE 'UNABLE TO ASSIGN USER-ID'                       02210001
022200              TO DP013-MESSAGE-TEXT (1)                           02220001
022300            SET DP013-LOGIC-ABEND        TO TRUE                  02230001
022400            SET DP013-NO-ROLLBACK        TO TRUE                  02240001
022500            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                02250001
022600     END-EVALUATE.                                                02260001
022700                                                                  02270001
023100     EVALUATE TRUE                                                02310001
023200         WHEN EIBCALEN = ZERO                                     02320001
023300             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    02330001
023400             PERFORM 8300-RETURN                                  02340001
023500                                                                  02350001
025500         WHEN SU001-INITIALIZE-SCREEN                             02550003
025510         WHEN EIBAID = DFHCLEAR                                   02551003
025600              SET SU001-PROCESS-SCREEN TO TRUE                    02560001
025700              PERFORM 1000-INITIALIZE                             02570001
025800              PERFORM 8000-SEND-MAP                               02580001
025900              PERFORM 8200-RETURN-TRANID                          02590001
026000                                                                  02600001
026200         WHEN EIBAID = DFHPF2                                     02620063
026300              IF  SU001-FREE-ASTRY-TRIP-MESS                      02630063
026400                  PERFORM 3650-UPDATE-MESSAGE-TABLE               02640063
026802                  MOVE PC-SHIPPING-UNIT-PGM                       02680202
026803                                        TO PV-TRANSFER-PROGRAM    02680301
026804                  PERFORM 4000-XCTL-LRT-MENU                      02680488
026805              ELSE                                                02680563
026806                  MOVE SPACES                     TO AMSGLN01O    02680663
026809                  MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLN01O    02680963
026811                  PERFORM 8100-SEND-DATA-ONLY                     02681163
026812                  PERFORM 8200-RETURN-TRANID                      02681263
026813              END-IF                                              02681359
026814                                                                  02681459
027400                                                                  02740001
027410         WHEN EIBAID = DFHENTER                                   02741063
027420         WHEN EIBAID = DFHPF3                                     02742063
027430            EVALUATE TRUE                                         02743086
027431              WHEN SU001-STAT-WARNG-MESSGE-DEP                    02743186
027440              WHEN SU001-STAT-WARNG-MESSGE-DEL                    02744086
027441              WHEN SU001-DEPARTED-DIFF-DC                         02744199
027442              WHEN SU001-DEPARTED-AFTER-DAYS                      02744299
027443                  MOVE PC-TRIP-START-SCREEN                       02744399
027444                                        TO PV-TRANSFER-PROGRAM    02744499
027450              WHEN SU001-FREE-ASTRY-TRIP-MESS                     02745086
027451                 IF EIBAID = DFHENTER                             02745188
027454                    PERFORM 8100-SEND-DATA-ONLY                   02745488
027455                    PERFORM 8200-RETURN-TRANID                    02745588
027456                 ELSE                                             02745688
027460                    IF SU001-ROWS-INSERTED > 0                    02746088
027461                       MOVE  SU001-BATCH-NUMBER                   02746188
027462                                        TO SU001-BATCH-NO-USE     02746288
027463                       MOVE  SU001-PRINTER-ID                     02746388
027464                                        TO SU001-PRINTER-ID-USE   02746488
027465                       PERFORM 5000-START-LABEL-PRINT             02746588
027469                       MOVE  ZEROES     TO  SU001-ROWS-INSERTED   02746988
027471                       MOVE PC-LABELS-SUBMITTED-1                 02747192
027472                                                  TO AMSGLN01O    02747292
027473                       MOVE PC-LABELS-SUBMITTED-2                 02747392
027474                                                  TO AMSGLN02O    02747492
027475                       MOVE SPACE                 TO AMSGLN04O    02747593
027476                       MOVE PC-LABELS-SUBMITTED-3                 02747694
027477                                                  TO AMSGLN05O    02747794
027478                       PERFORM 8100-SEND-DATA-ONLY                02747892
027479                       PERFORM 8200-RETURN-TRANID                 02747992
027480                    END-IF                                        02748092
027481                    MOVE PC-TRIP-START-SCREEN                     02748192
027482                                         TO PV-TRANSFER-PROGRAM   02748288
027483                 END-IF                                           02748388
027484              WHEN SU001-ASGMT-CLOSED-RETURN                      02748491
027485                 IF SU001-ROWS-INSERTED > 0                       02748591
027486                    MOVE  SU001-BATCH-NUMBER                      02748691
027487                                     TO SU001-BATCH-NO-USE        02748791
027488                    MOVE  SU001-PRINTER-ID                        02748891
027489                                     TO SU001-PRINTER-ID-USE      02748991
027490                    PERFORM 5000-START-LABEL-PRINT                02749091
027491                    MOVE  ZEROES     TO  SU001-ROWS-INSERTED      02749191
027492                 END-IF                                           02749291
027493                 MOVE PC-TRIP-START-SCREEN                        02749391
027494                                      TO PV-TRANSFER-PROGRAM      02749491
027495              WHEN OTHER                                          02749586
027496                  MOVE PC-SHIPPING-UNIT-PGM                       02749663
027497                                        TO PV-TRANSFER-PROGRAM    02749763
027498            END-EVALUATE                                          02749886
027499                                                                  02749963
027500            PERFORM 4000-XCTL-LRT-MENU                            02750086
027501                                                                  02750163
027510         WHEN OTHER                                               02751001
027600              MOVE SPACES    TO  AMSGLN01O                        02760059
027700                                 AMSGLN02O                        02770059
027800                                 AMSGLN03O                        02780059
027801                                 AMSGLN04O                        02780159
027802              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLN01O        02780203
027803              MOVE PC-PRESS-ENTER-TO-CONTINUE TO AMSGLN02O        02780303
027804              PERFORM 8100-SEND-DATA-ONLY                         02780401
027805              PERFORM 8200-RETURN-TRANID                          02780501
027900     END-EVALUATE.                                                02790001
028000                                                                  02800001
028100     GOBACK.                                                      02810001
028200*                                                                 02820001
028300*                                                                 02830001
028400 1000-INITIALIZE.                                                 02840001
028500                                                                  02850002
028600     MOVE SU001-PO                  TO  PV-PO-NBR                 02860012
030004                                                                  03000404
030005     MOVE SU001-RCVR-SEQ-NBR        TO  PV-RCV-SEQ-NBR            03000512
030007                                                                  03000711
030008     MOVE PV-PO-RCVR-NBR            TO  APORCVRO.                 03000815
030009                                                                  03000980
030010     IF SU001-MULTI-LINE                                          03001080
030011        MOVE PC-MULTI-LINE       TO PV-PO-LINE-OUT                03001180
030012     ELSE                                                         03001280
030013        MOVE SU001-PO-LINE-NBR   TO PV-PO-LINE-N                  03001381
030015     END-IF                                                       03001580
030016     MOVE PV-PO-LINE-OUT         TO APOLNEO.                      03001680
030017                                                                  03001780
030018     MOVE SU001-CARTON              TO  ACTNO.                    03001859
030019                                                                  03001959
030020     EVALUATE TRUE                                                03002011
030021       WHEN SU001-UCC128-IGNORED                                  03002111
030022         MOVE PC-NO-CSEPK-SPLIT-I       TO  AMSGLN01O             03002211
030023                                                                  03002311
030024         MOVE PC-NO-CSEPK-SPLIT-NA-2    TO  AMSGLN02O             03002411
030025                                                                  03002511
030026*        MOVE PC-NO-CSEPK-SPLIT-3       TO  AMSGLN03O             03002670
030027                                                                  03002711
030028*        MOVE PC-NO-CSEPK-SPLIT-4       TO  AMSGLN04O             03002870
030029                                                                  03002911
030030       WHEN SU001-UCC128-NOT-AVAILABLE                            03003011
030031         MOVE PC-NO-CSEPK-SPLIT-NA      TO  AMSGLN01O             03003111
030032                                                                  03003211
030033         MOVE PC-NO-CSEPK-SPLIT-NA-2    TO  AMSGLN02O             03003311
030034                                                                  03003411
030035*        MOVE PC-NO-CSEPK-SPLIT-3       TO  AMSGLN03O             03003570
030036                                                                  03003611
030037*        MOVE PC-NO-CSEPK-SPLIT-4       TO  AMSGLN04O             03003770
030038                                                                  03003813
030039       WHEN SU001-UCC128-NO-LABEL-DATA                            03003913
030040         MOVE PC-NO-LABEL-DATA-1        TO  AMSGLN01O             03004013
030041                                                                  03004113
030042         MOVE PC-NO-LABEL-DATA-2        TO  AMSGLN02O             03004213
030043                                                                  03004313
030044         MOVE PC-NO-LABEL-DATA-3        TO  AMSGLN03O             03004413
030045                                                                  03004516
030046       WHEN SU001-UCC128-UNABLE-TO-ASSIGN                         03004617
030047         MOVE PC-NO-ASSIGN-MSG-1        TO  AMSGLN01O             03004717
030048                                                                  03004817
030049         MOVE PC-NO-ASSIGN-MSG-2        TO  AMSGLN02O             03004917
030050                                                                  03005017
030051         MOVE PC-NO-ASSIGN-MSG-3        TO  AMSGLN03O             03005117
030052                                                                  03005217
030053       WHEN SU001-UCC128-CENTRAL-STOCK                            03005317
030054         MOVE PC-CENTRAL-STOCK-MSG-1    TO  AMSGLN01O             03005417
030055                                                                  03005517
030056         MOVE PC-CENTRAL-STOCK-MSG-2    TO  AMSGLN02O             03005617
030057                                                                  03005717
030058         MOVE PC-CENTRAL-STOCK-MSG-3    TO  AMSGLN03O             03005817
030059                                                                  03005917
030060         MOVE PC-CENTRAL-STOCK-MSG-4    TO  AMSGLN04O             03006017
030061                                                                  03006117
030062       WHEN SU001-UCC128-DUP-CTN                                  03006259
030063         MOVE PC-DUP-CTN-1              TO  AMSGLN01O             03006317
030064                                                                  03006417
030065         MOVE PC-DUP-CTN-2              TO  AMSGLN02O             03006517
030066                                                                  03006617
030067         MOVE PC-DUP-CTN-3              TO  AMSGLN03O             03006717
030068                                                                  03006817
030069       WHEN SU001-UCC128-PREPK-ORD                                03006917
030070         MOVE PC-PREPK-ORD-1            TO  AMSGLN01O             03007017
030071                                                                  03007117
030072         MOVE PC-PREPK-ORD-2            TO  AMSGLN02O             03007217
030073                                                                  03007317
030074         MOVE PC-PREPK-ORD-3            TO  AMSGLN03O             03007417
030075                                                                  03007517
030076         MOVE PC-PREPK-ORD-4            TO  AMSGLN04O             03007617
030077                                                                  03007717
030078       WHEN SU001-UCC128-PBS-RCVR                                 03007817
030079         MOVE PC-PBS-RCVR-1             TO  AMSGLN01O             03007917
030080                                                                  03008017
030081         MOVE PC-PBS-RCVR-2             TO  AMSGLN02O             03008117
030082                                                                  03008217
030083         MOVE PC-PBS-RCVR-3             TO  AMSGLN03O             03008317
030084                                                                  03008417
030085       WHEN SU001-UCC128-NO-RCVR                                  03008559
030086         MOVE PC-NO-RCVR-1              TO  AMSGLN01O             03008617
030087                                                                  03008717
030088         MOVE PC-NO-RCVR-2              TO  AMSGLN02O             03008817
030089                                                                  03008917
030090       WHEN SU001-UCC128-COMTEC-INPK                              03009059
030091         MOVE PC-COMTEC-INPK-1          TO  AMSGLN01O             03009117
030092                                                                  03009217
030093         MOVE PC-COMTEC-INPK-2          TO  AMSGLN02O             03009317
030094                                                                  03009417
030095         MOVE PC-COMTEC-INPK-3          TO  AMSGLN03O             03009517
030096                                                                  03009617
030097         MOVE PC-COMTEC-INPK-4          TO  AMSGLN04O             03009717
030098                                                                  03009817
030099       WHEN SU001-STAT-WARNG-MESSGE-DEP                           03009959
030100         MOVE DP015-PRO-DRK-MDT     TO       APORCVRA             03010059
030101                                             ACTNA                03010159
030110                                             APOLNEA              03011059
030200                                             APOHDGA              03020059
030300                                             ALNEHDGA             03030059
030301                                                                  03030159
030302         MOVE PC-DEP-OR-DEL-STATUS-1    TO  AMSGLN01O             03030217
030303                                                                  03030317
030304         MOVE PC-DEP-OR-DEL-STATUS-2    TO  AMSGLN02O             03030417
030305                                                                  03030517
030306         MOVE PC-DEP-OR-DEL-STATUS-4    TO  AMSGLN03O             03030617
030307                                                                  03030759
030308         MOVE PC-PRESS-ENTER-TO-CONTINUE TO  AMSGLN05O            03030859
030309                                                                  03030959
030310       WHEN SU001-STAT-WARNG-MESSGE-DEL                           03031059
030320         MOVE DP015-PRO-DRK-MDT     TO       APORCVRA             03032059
030330                                             ACTNA                03033059
030340                                             APOLNEA              03034059
030350                                             APOHDGA              03035059
030360                                             ALNEHDGA             03036059
030361                                                                  03036159
030362         MOVE PC-DEP-OR-DEL-STATUS-1    TO  AMSGLN01O             03036217
030363                                                                  03036317
030364         MOVE PC-DEP-OR-DEL-STATUS-3    TO  AMSGLN02O             03036417
030365                                                                  03036517
030366         MOVE PC-DEP-OR-DEL-STATUS-4    TO  AMSGLN03O             03036617
030367                                                                  03036759
030368         MOVE PC-PRESS-ENTER-TO-CONTINUE TO  AMSGLN05O            03036859
030369                                                                  03036917
030370       WHEN SU001-INACTV-CRTN-MESSAGE                             03037017
030380         MOVE DP015-PRO-DRK-MDT     TO       APORCVRA             03038059
030390                                             APOLNEA              03039059
030400                                             APOHDGA              03040059
030401                                             ALNEHDGA             03040159
030402         MOVE PC-INACTIVE-CRTN-STAT-1   TO  AMSGLN01O             03040217
030403                                                                  03040317
030404         MOVE PC-INACTIVE-CRTN-STAT-2   TO  AMSGLN02O             03040417
030405                                                                  03040517
030406         MOVE PC-INACTIVE-CRTN-STAT-3   TO  AMSGLN03O             03040617
030407                                                                  03040717
030408       WHEN SU001-CREATE-SOURCE-RECV                              03040859
030409         MOVE PC-CARTON-CREATED-RCV-1   TO  AMSGLN01O             03040959
030410                                                                  03041017
030411         MOVE PC-CARTON-CREATED-RCV-2   TO  AMSGLN02O             03041159
030412                                                                  03041217
030413         MOVE PC-CARTON-CREATED-RCV-3   TO  AMSGLN03O             03041359
030414                                                                  03041417
030415         MOVE PC-CARTON-CREATED-RCV-4   TO  AMSGLN04O             03041559
030416       WHEN SU001-FREE-ASTRY-TRIP-MESS                            03041663
030417         IF SU001-WRONG-FCLTY                                     03041772
030418           PERFORM 3700-SELECT-CARTON-OPER                        03041872
030419           MOVE PV-CRTN-OPER-UNIT TO PV-CRTN-OPER-ID              03041976
030421                                                                  03042172
030422           MOVE PC-CRTN-WRONG-FACILITY-1  TO  AMSGLN01O           03042272
030423           MOVE PV-WRONG-FACILITY-MESSAGE TO  AMSGLN02O           03042372
030427         ELSE                                                     03042772
030428           MOVE PC-VRFY-CORRECT-TRAILER-1 TO  AMSGLN01O           03042872
030429                                                                  03042972
030430           MOVE PC-VRFY-CORRECT-TRAILER-2 TO  AMSGLN02O           03043072
030431                                                                  03043172
030432         END-IF                                                   03043272
030433           MOVE SU001-OWNER-SCAC-ID        TO PV-DISP-SCAC        03043372
030434           MOVE SU001-VEH-NBR              TO PV-DISP-TRLR        03043472
030435           MOVE PV-SCAC-TRLR-DISPLAY       TO AMSGLN03O           03043572
030436           MOVE PC-VRFY-CORRECT-TRAILER-4 TO  AMSGLN04O           03043672
030437           MOVE PC-VRFY-CORRECT-TRAILER-5 TO  AMSGLN05O           03043772
030438       WHEN SU001-ASGMT-CLOSED-RETURN                             03043891
030456           MOVE PC-LABOR-ASGMT-EXPIRED-1 TO AMSGLN01O             03045691
030458           MOVE PC-LABOR-ASGMT-EXPIRED-2 TO AMSGLN02O             03045891
030460           MOVE PC-LABOR-ASGMT-EXPIRED-3 TO AMSGLN03O             03046091
030462           MOVE PC-LABOR-ASGMT-EXPIRED-4 TO AMSGLN04O             03046291
030464           MOVE PC-LABOR-ASGMT-EXPIRED-5 TO AMSGLN05O             03046491
030465       WHEN SU001-DEPARTED-DIFF-DC                                03046599
030466         MOVE DP015-PRO-DRK-MDT     TO       APORCVRA             03046699
030467                                             ACTNA                03046799
030468                                             APOLNEA              03046899
030469                                             APOHDGA              03046999
030470                                             ALNEHDGA             03047099
030471                                                                  03047199
030472           MOVE PC-DEPART-DIFF-DC-1      TO AMSGLN01O             03047299
030473           MOVE PC-DEPART-DIFF-DC-2      TO AMSGLN02O             03047399
030474           MOVE PC-DEPART-DIFF-DC-3      TO AMSGLN03O             03047499
030475           MOVE PC-DEPART-DIFF-DC-4      TO AMSGLN04O             03047599
030476           MOVE PC-DEPART-DIFF-DC-5      TO AMSGLN05O             03047699
030477       WHEN SU001-DEPARTED-AFTER-DAYS                             03047799
030478         MOVE DP015-PRO-DRK-MDT     TO       APORCVRA             03047899
030479                                             ACTNA                03047999
030480                                             APOLNEA              03048099
030481                                             APOHDGA              03048199
030482                                             ALNEHDGA             03048299
030483                                                                  03048399
030484           MOVE PC-DEPART-MAX-DAYS-1     TO AMSGLN01O             03048499
030485           MOVE PC-DEPART-MAX-DAYS-2     TO AMSGLN02O             03048599
030486           MOVE PC-DEPART-MAX-DAYS-3     TO AMSGLN03O             03048699
030487           MOVE PC-DEPART-MAX-DAYS-4     TO AMSGLN04O             03048799
030488           MOVE PC-DEPART-MAX-DAYS-5     TO AMSGLN05O             03048899
030489       WHEN OTHER                                                 03048991
030490         MOVE PC-NO-CSEPK-SPLIT-1       TO  AMSGLN01O             03049091
030491                                                                  03049191
030492         MOVE PC-NO-CSEPK-SPLIT-2       TO  AMSGLN02O             03049291
030493                                                                  03049391
030494         MOVE PC-PRESS-ENTER-TO-CONTINUE TO  AMSGLN04O            03049491
030495                                                                  03049591
030496       END-EVALUATE.                                              03049691
030497                                                                  03049791
030498*                                                                 03049891
030499*                                                                 03049991
030500 2000-PROCESS-SCREEN-FIELDS.                                      03050091
030510                                                                  03051091
030600     PERFORM 2100-RECEIVE-MAP.                                    03060001
030700*                                                                 03070001
030800*                                                                 03080001
030900 2100-RECEIVE-MAP.                                                03090001
031000                                                                  03100001
031100     EXEC CICS                                                    03110001
031200         RECEIVE MAP    ('SU530A')                                03120002
031300                 MAPSET ('SUKM530')                               03130002
031400                 RESP   (PV-CICS-RESPONSE)                        03140001
031500     END-EXEC.                                                    03150001
031600                                                                  03160001
031700     EVALUATE TRUE                                                03170001
031800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03180001
031900             CONTINUE                                             03190005
032000         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                03200001
032100             CONTINUE                                             03210007
032200         WHEN OTHER                                               03220001
032300            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       03230006
032400            MOVE 'UNABLE TO RECEIVE MAP' TO DP013-MESSAGE-TEXT (1)03240001
032500            SET DP013-LOGIC-ABEND        TO TRUE                  03250001
032600            SET DP013-NO-ROLLBACK        TO TRUE                  03260001
032700            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                03270001
032800     END-EVALUATE.                                                03280001
032900*                                                                 03290001
033000**********************************************************        03300063
033100 3650-UPDATE-MESSAGE-TABLE.                                       03310063
033200**********************************************************        03320063
033210       MOVE SU001-PO           TO LBVRMG-PO-NBR                   03321063
033220       MOVE SU001-RCVR-SEQ-NBR TO LBVRMG-RCVR-SEQ-NBR             03322063
033250       MOVE SU001-USER-ID      TO LBVRMG-WRKR-USR-ID              03325063
033260       MOVE SU001-MANIFEST     TO LBVRMG-TRIP-ID                  03326063
033270       MOVE SU001-SESSION-ID   TO LBVRMG-CICS-SESS-ID             03327063
033290       MOVE 'T'                TO LBVRMG-ERR-MSG-CDE              03329063
033300     EXEC SQL                                                     03330063
033400         INSERT INTO TLBVRMG                                      03340063
033500               ( PO_NBR                                           03350063
033600                ,RCVR_SEQ_NBR                                     03360063
033700                ,PO_LNE_NBR                                       03370084
033800                ,PREPK_ID                                         03380085
033900                ,WRKR_USR_ID                                      03390063
034000                ,TRIP_ID                                          03400063
034100                ,CICS_SESS_ID                                     03410063
034200                ,CRE_TMST                                         03420063
034300                ,ERR_MSG_CDE)                                     03430063
034400         VALUES (:LBVRMG-PO-NBR                                   03440063
034500               , :LBVRMG-RCVR-SEQ-NBR                             03450063
034600               , :LBVRMG-PO-LNE-NBR                               03460084
034700               , :LBVRMG-PREPK-ID                                 03470085
034800               , :LBVRMG-WRKR-USR-ID                              03480063
034900               , :LBVRMG-TRIP-ID                                  03490063
035000               , :LBVRMG-CICS-SESS-ID                             03500063
035100               , CURRENT TIMESTAMP                                03510063
035200               , :LBVRMG-ERR-MSG-CDE)                             03520063
035300     END-EXEC.                                                    03530063
035400                                                                  03540063
035500         EVALUATE TRUE                                            03550063
035600             WHEN SQLCODE = ZERO                                  03560063
035610                CONTINUE                                          03561063
035800             WHEN SQLCODE = +100                                  03580063
035900             WHEN SQLWARN0 NOT = SPACES                           03590063
036000             WHEN SQLCODE < ZERO                                  03600063
036100             WHEN SQLCODE > ZERO                                  03610063
036200                 MOVE '3650-UPDATE-MESSAGE-TABLE'                 03620063
036300                                   TO DP013-PARAGRAPH             03630063
036400                 MOVE 'UPDATE TABLE       - '                     03640063
036500                                   TO DP013-MESSAGE-TEXT (1)      03650063
036600                 MOVE SQLCA        TO DP013-SQLCA                 03660063
036700                 MOVE 'TLBVRMG '   TO DP013-DB2-TABLE-NAME (1)    03670063
036800                 SET DP013-DB2-ABEND                              03680063
036900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           03690063
037000                 SET DP013-ROLLBACK                               03700063
037100                                   TO TRUE                        03710063
037200                 PERFORM DP014-0000-PROCESS-ABEND                 03720063
037300         END-EVALUATE.                                            03730063
037400                                                                  03740063
037500 EJECT                                                            03750063
037600**********************************************************        03760072
037700 3700-SELECT-CARTON-OPER.                                         03770072
037800**********************************************************        03780072
037810                                                                  03781072
037820     MOVE SU001-CARTON   TO SHPUNT-SHIPT-UNT-ID.                  03782072
037900     EXEC SQL                                                     03790072
038000         SELECT ORGN_OPER_UNT_ID                                  03800073
038400         INTO   :SHPUNT-ORGN-OPER-UNT-ID                          03840072
038800         FROM   TSHPUNT                                           03880072
038900         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             03890072
039000     END-EXEC.                                                    03900072
041200                                                                  04120072
041300       EVALUATE TRUE                                              04130072
041400           WHEN SQLCODE = ZERO                                    04140072
041500              MOVE SHPUNT-ORGN-OPER-UNT-ID TO PV-CRTN-OPER-UNIT   04150072
041600           WHEN SQLCODE = +100                                    04160072
041610               CONTINUE                                           04161072
041700           WHEN SQLWARN0 NOT = SPACES                             04170072
041800           WHEN SQLCODE < ZERO                                    04180072
041900           WHEN SQLCODE > ZERO                                    04190072
042000               MOVE '3700-SELECT-CARTON-OPER  '                   04200072
042100                                 TO DP013-PARAGRAPH               04210072
042200               MOVE 'SELECT CARTON OPER - '                       04220072
042300                                 TO DP013-MESSAGE-TEXT (1)        04230072
042400               MOVE SQLCA        TO DP013-SQLCA                   04240072
042500               MOVE 'TSHPUNT '   TO DP013-DB2-TABLE-NAME (1)      04250072
042600               SET DP013-DB2-ABEND                                04260072
042700                   DP013-XCTL-DISPLAY-RESTART TO TRUE             04270072
042800               SET DP013-ROLLBACK                                 04280072
042900                                 TO TRUE                          04290072
043000               PERFORM DP014-0000-PROCESS-ABEND                   04300072
043100       END-EVALUATE.                                              04310072
043200                                                                  04320072
043300 EJECT                                                            04330072
045600*                                                                 04560001
045700 4000-XCTL-LRT-MENU.                                              04570001
045800     SET SU001-INITIALIZE-SCREEN     TO TRUE.                     04580001
045900     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM.          04590001
046000                                                                  04600001
046100*LMM                                                              04610059
046101     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           04610159
046102     EXEC CICS                                                    04610201
046200         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    04620001
046300               COMMAREA  (CA-COMMAREA)                            04630001
046400***            LENGTH    (PC-COMMAREA-LENGTH)                     04640001
046410               LENGTH    (PV-COMMAREA-LENGTH)                     04641059
046500               RESP      (PV-CICS-RESPONSE)                       04650001
046600     END-EXEC.                                                    04660001
046700                                                                  04670001
046800     EVALUATE TRUE                                                04680001
046900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04690001
047000             CONTINUE                                             04700001
047100         WHEN OTHER                                               04710001
047200             MOVE '4000-XCTL-TO-LRT-MENU'                         04720001
047300                 TO DP013-PARAGRAPH                               04730001
047400             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   04740001
047500                 TO DP013-MESSAGE-TEXT (1)                        04750001
047600             MOVE PV-TRANSFER-PROGRAM                             04760001
047700                 TO DP013-MESSAGE-TEXT (2)                        04770001
047800             SET DP013-CICS-ABEND  TO TRUE                        04780001
047900             SET DP013-NO-ROLLBACK TO TRUE                        04790001
048000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               04800001
048100             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLN01O           04810006
048200             SET SU001-PROCESS-SCREEN TO TRUE                     04820001
048300             PERFORM 8000-SEND-MAP                                04830001
048400             PERFORM 8200-RETURN-TRANID                           04840001
048500     END-EVALUATE.                                                04850001
048600*                                                                 04860001
048700 5000-START-LABEL-PRINT.                                          04870086
048800                                                                  04880086
048900     SET  SU001-LBL-PRT-AT-SCAN TO TRUE.                          04890086
049000                                                                  04900086
049100     EXEC CICS                                                    04910086
049200          START TRANSID (PC-SU-LBL-PRT-TRANS)                     04920086
049300               FROM (SU001-COMMON-DATA)                           04930086
049400     END-EXEC.                                                    04940086
050700*                                                                 05070001
050800 8000-SEND-MAP.                                                   05080001
050900                                                                  05090001
051000     EXEC CICS                                                    05100001
051100         SEND MAP       ('SU530A')                                05110002
051200              MAPSET    ('SUKM530')                               05120002
051300              ERASE                                               05130001
051400              CURSOR                                              05140001
051500              RESP      (PV-CICS-RESPONSE)                        05150001
051600     END-EXEC.                                                    05160001
051700                                                                  05170001
051800     EVALUATE TRUE                                                05180001
051900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05190001
052000             CONTINUE                                             05200001
052100         WHEN OTHER                                               05210001
052200             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         05220001
052300             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  05230001
052400             SET DP013-CICS-ABEND      TO TRUE                    05240001
052500             SET DP013-NO-ROLLBACK     TO TRUE                    05250001
052600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               05260001
052700     END-EVALUATE.                                                05270001
052800*                                                                 05280001
052900*                                                                 05290001
053000 8100-SEND-DATA-ONLY.                                             05300001
053100                                                                  05310001
053200     EXEC CICS                                                    05320001
053300         SEND MAP       ('SU530A')                                05330006
053400              MAPSET    ('SUKM530')                               05340006
053500              CURSOR                                              05350001
053600              DATAONLY                                            05360001
053700              RESP      (PV-CICS-RESPONSE)                        05370001
053800     END-EXEC.                                                    05380001
053900                                                                  05390001
054000     EVALUATE TRUE                                                05400001
054100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05410001
054200             CONTINUE                                             05420001
054300         WHEN OTHER                                               05430001
054400             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        05440001
054500             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 05450001
054600             SET DP013-CICS-ABEND       TO TRUE                   05460001
054700             SET DP013-NO-ROLLBACK      TO TRUE                   05470001
054800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               05480001
054900     END-EVALUATE.                                                05490001
055000*                                                                 05500001
055100*                                                                 05510001
055200 8200-RETURN-TRANID.                                              05520001
055300                                                                  05530001
055400*LMM                                                              05540059
055401     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           05540159
055402     EXEC CICS                                                    05540201
055500         RETURN TRANSID  (PC-TRANID)                              05550001
055600                COMMAREA (CA-COMMAREA)                            05560001
055700***             LENGTH   (PC-COMMAREA-LENGTH)                     05570001
055710                LENGTH   (PV-COMMAREA-LENGTH)                     05571059
055800                RESP     (PV-CICS-RESPONSE)                       05580001
055900     END-EXEC.                                                    05590001
056000                                                                  05600001
056100     EVALUATE TRUE                                                05610001
056200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05620001
056300             CONTINUE                                             05630001
056400         WHEN OTHER                                               05640001
056500             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        05650001
056600             MOVE 'UNABLE TO RETURN TO TRANID'                    05660001
056700                 TO DP013-MESSAGE-TEXT (1)                        05670001
056800             SET DP013-CICS-ABEND       TO TRUE                   05680001
056900             SET DP013-NO-ROLLBACK      TO TRUE                   05690001
057000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               05700001
057100     END-EVALUATE.                                                05710001
057200*                                                                 05720001
057300*                                                                 05730001
057400 8300-RETURN.                                                     05740001
057500                                                                  05750001
057600     EXEC CICS                                                    05760001
057700         SEND FROM (PV-MESSAGE-AREA)                              05770001
057800              LENGTH (19)                                         05780001
057900              ERASE                                               05790001
058000     END-EXEC.                                                    05800001
058100                                                                  05810001
058200     EXEC CICS                                                    05820001
058300         RETURN                                                   05830001
058400     END-EXEC.                                                    05840001
058500*                                                                 05850001
058600*                                                                 05860001
058700 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  05870001
058800                                                                  05880001
058900     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              05890001
059000     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             05900001
059100     INITIALIZE DP013-SRC-TASK-NUMBER                             05910001
059200                DP013-STACK.                                      05920001
059300     SET DP013-LINK-RETURN TO TRUE.                               05930001
059400                                                                  05940001
059500     EXEC CICS                                                    05950001
059600         LINK                                                     05960001
059700             PROGRAM   (DP013-NAME)                               05970001
059800             COMMAREA  (DP013-PARAMETERS)                         05980001
059900             LENGTH    (DP013-LENGTH)                             05990001
060000     END-EXEC.                                                    06000001
060200*                                                                 06020001
061000*----------------------------------------------------------------*06100001
061100*    ABEND PROCESSOR MODULE                                      *06110001
061200*----------------------------------------------------------------*06120001
061400     COPY DPPD014.                                                06140063
061500*                                                                 06150001
