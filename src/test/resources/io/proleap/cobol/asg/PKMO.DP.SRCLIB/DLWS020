000100**************************************************************    00010000
000200*    ******                IMPORTANT                 ******  *    00020000
000300*   THIS IS THE COMMUNICATION AREA TO BE USED BY A CALLING   *    00030000
000400*   PROGRAM THAT WILL USE ROUTINE DLKUT024 TO ACCESS         *    00040000
000500*   THE NEXT SEQUENCE NUMBER TO BE ASSIGNED TO AN            *    00050000
000600*   ASSIGNMENT FOR THE DLX LABOR SYSTEM.                     *    00060000
000700*                                                            *    00070000
001100*   TO INVOKE THIS PROGRAM FROM BATCH:                       *    00110000
001700*     CALL DL020-USER-PGM USING DL020-USER-COMMAREA          *    00170000
001800*    ******                IMPORTANT                 ******  *    00180000
001900*                                                            *    00190000
002000*     INITIALIZE DL020-USER-COMMAREA BEFORE CALLING DLKUT024 *    00200000
002100*                                                            *    00210000
002200*     DL020-ACCESS-METHODD IS REQUIRED.                      *    00220000
002300*                                                            *    00230000
002400*     THE APPROPRIATE DL020-KEYS FIELDS ARE REQUIRED.        *    00240000
002500*     MUST ALSO SUPPLY THE NUMBER OF SEQUENCE NUMBERS        *    00250000
002600*     NEED IN THE DL020-NBR-OF-NBRS-NEED-QTY FIELD.          *    00260000
002700*                                                            *    00270000
002800*     REGARDING DL020-OUTPUT-FIELDS:                         *    00280000
002900*       DL020-ASGMT-FOUND-CODE IS ALWAYS RETURNED.           *    00290000
003000*       DL020-NEXT-SEQ-NBR IS ALWAYS RETURNED (WILL          *    00300000
003100*       CONTAIN ZEROS IF NO NUMBER WAS RETRIEVED)            *    00310000
003200*       DL020-SEQ-START-NBR AND DL020-SEQ-END-NBR            *    00320000
003300*       FIELDS ARE ALWAYS RETURNED (BOTH NUMBERS WILL        *    00330000
003400*       CONTAIN ZEROS IF NO NUMBERS WERE RETRIEVED).         *    00340000
003500*                                                            *    00350000
003600*     NOTE: IF FIELD(S) ARE ADDED TO THIS COPYBOOK           *    00360000
003700*           DECREMENT THE FILLER NEAR THE END OF THIS        *    00370000
003800*           COPYBOOK SO THE TOTAL LENGTH REMAINS THE SAME    *    00380000
003900*           AT LENGTH OF 550                                 *    00390000
004000**************************************************************    00400000
004100 01  DL020-ASGMT-COMMAREA.                                        00410000
004200     05  DL020-ACCESS-METHOD          PIC  X(04).                 00420000
004300         88  DL020-BY-ASGMT-KEY           VALUE 'AKEY'.           00430000
004400     05  DL020-FILLER                 PIC  X(20).                 00440000
004500     05  DL020-KEYS.                                              00450000
004600         10  DL020-KEY-START-DTE.                                 00460000
004700             15  DL020-KEY-SDTE-YYYY  PIC  X(04).                 00470000
004800             15  DL020-FILLER         PIC  X(01).                 00480000
004900             15  DL020-KEY-SDTE-MM    PIC  X(02).                 00490000
005000             15  DL020-FILLER         PIC  X(01).                 00500000
005100             15  DL020-KEY-SDTE-DD    PIC  X(02).                 00510000
005200         10  DL020-KEY-NBR-TXT        PIC  X(10).                 00520000
005300         10  DL020-KEY-NBR-SEQ-NBR    PIC S9(09)     COMP.        00530000
005400         10  DL020-FILLER             PIC  X(50).                 00540000
005500     05  DL020-NBR-OF-NBRS-NEED-QTY   PIC S9(09)     COMP.        00550000
005600         88  DL020-NBRS-NEED-QTY-EMPTY    VALUE ZEROS.            00560000
005700     05  DL020-COMMIT-CDE             PIC  X(01).                 00570000
005800         88  DL020-COMMIT-UPDATE          VALUE 'C'.              00580000
005900         88  DL020-DO-NOT-COMMIT-UPDATE   VALUE 'N'.              00590000
006000     05  DL020-NEXT-ASGMT-PRCS-CDE    PIC  X(01).                 00600000
006100         88  DL020-FIND-NEXT-ASGMT        VALUE 'Y'.              00610000
006200         88  DL020-DO-NOT-FIND-NEXT-ASGMT VALUE 'N'.              00620000
006300     05  DL020-RETURN-CODE            PIC  X(02).                 00630000
006400         88  DL020-SUCCESSFUL             VALUES ZERO.            00640000
006500         88  DL020-SQL-ERROR              VALUE '01'.             00650000
006600         88  DL020-ASGMT-CLOSED-RETURN    VALUE '02'.             00660000
006700         88  DL020-NBR-NEED-QTY-0         VALUE '03'.             00670000
006800         88  DL020-KEY-FIELDS-MISSING     VALUE '04'.             00680000
006900         88  DL020-COMMIT-CODE-INVALID    VALUE '05'.             00690000
007000         88  DL020-FIND-ASGMT-INVALID     VALUE '06'.             00700000
007100         88  DL020-CALLED-MODULE-FAILURE  VALUE '98'.             00710000
007200         88  DL020-INVALID-ACCESS         VALUE '99'.             00720000
007300     05  DL020-RETURN-SQLCODES.                                   00730000
007400         10  DL020-ASGMT-SQLCODE      PIC  S9(9).                 00740000
007500             88  DL020-SQL-NOT-FOUND      VALUE  +100.            00750000
007600             88  DL020-SQL-CONTENTION     VALUES -904 -911 -913.  00760000
007700         10  DL020-FILLER             PIC  X(32).                 00770000
007800* THE FOLLOWING FIELD SHOULD CONTAIN THE ORIGINAL CALLING         00780000
007900* PROGRAM ASSOCIATED TO THE PROCESSING TO BE DONE.                00790000
008000     05  DL020-ORIG-CALLING-PGM-NM    PIC  X(08).                 00800000
008100     05  DL020-FILLER                 PIC  X(17).                 00810000
008200* THE FOLLOWING ARE TO CONTAIN PARAGRAPH NUMBERS ASSOCIATED TO    00820000
008300* THE ABOVE SQL RETURN CODES.                                     00830000
008400     05  DL020-SQL-ERROR-PARA         PIC  X(05).                 00840000
008500     05  DL020-CALL-MOD-FAIL-NM       PIC  X(08).                 00850000
008600     05  DL020-CALL-MOD-FAIL-ERR-CDE  PIC  X(02).                 00860000
008700     05  DL020-FILLER                 PIC  X(10).                 00870000
008800                                                                  00880000
008900     05  DL020-OUTPUT-FIELDS.                                     00890000
009000         10  DL020-ASGMT-FOUND-CODE   PIC  X(1).                  00900000
009100             88  DL020-ASGMT-NOT-FOUND    VALUE 'N'.              00910000
009200             88  DL020-ASGMT-CLOSED       VALUE 'C'.              00920000
009300             88  DL020-ASGMT-FOUND        VALUE 'F'.              00930000
009400             88  DL020-ASGMT-NEXT-USED    VALUE 'U'.              00940000
009500         10  DL020-SEQ-START-NBR      PIC  S9(09)    COMP.        00950000
009600             88  DL020-NO-SEQ-NBR         VALUE ZEROS.            00960000
009700         10  DL020-SEQ-END-NBR        PIC  S9(09)    COMP.        00970000
009800         10  DL020-NXT-START-DTE.                                 00980000
009900             15  DL020-NXT-SDTE-YYYY  PIC  X(04).                 00990000
010000             15  DL020-FILLER         PIC  X(01).                 01000000
010100             15  DL020-NXT-SDTE-MM    PIC  X(02).                 01010000
010200             15  DL020-FILLER         PIC  X(01).                 01020000
010300             15  DL020-NXT-SDTE-DD    PIC  X(02).                 01030000
010400         10  DL020-NXT-NBR-TXT        PIC  X(10).                 01040000
010500         10  DL020-NXT-NBR-SEQ-NBR    PIC S9(09)     COMP.        01050000
010600         10  DL020-FILLER             PIC  X(50).                 01060000
010700                                                                  01070000
010800     05  DL020-FILLER                 PIC X(132).                 01080000
010900     05  DL020-SQLCA                  PIC X(138).                 01090000
011000 01  DL020-COMMAREA                   PIC X(01).                  01100000
011100 01  DL020-USER-PGM                   PIC X(08) VALUE 'DLKUP024'. 01110001
