000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000400 PROGRAM-ID.             RCKRP029.                                00040001
000500 AUTHOR.                 JOE LAROSA.                              00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060001
000700 DATE-WRITTEN.           MARCH, 2000                              00070005
000800 DATE-COMPILED.                                                   00080001
000900***************************************************************** 00090001
001100*  DAILY CARTON COUNT TO VERIFIED UNIT QUANTITY VARIANCE REPORT * 00110001
001200*                                                               * 00120001
001700***************************************************************** 00170001
001600 ENVIRONMENT DIVISION.                                            00160001
001800 CONFIGURATION SECTION.                                           00180001
001900                                                                  00190001
002000 SOURCE-COMPUTER.        IBM-3090.                                00200001
002100 OBJECT-COMPUTER.        IBM-3090.                                00210001
002200                                                                  00220001
002300***************************************************************** 00230001
002400 INPUT-OUTPUT SECTION.                                            00240001
002600 FILE-CONTROL.                                                    00260001
002500                                                                  00250001
002800     SELECT INPUT-EXTRACT-FILE                                    00280001
002900         ASSIGN TO INP01.                                         00290001
003000                                                                  00300001
003100     SELECT OUTPUT-REPORT                                         00310001
003200         ASSIGN TO RPT01.                                         00320001
003300                                                                  00330001
003400***************************************************************** 00340001
003500 DATA DIVISION.                                                   00350001
003600***************************************************************** 00360001
003700 FILE SECTION.                                                    00370001
003800                                                                  00380001
003900 FD  INPUT-EXTRACT-FILE                                           00390001
004000     LABEL RECORDS ARE STANDARD                                   00400001
004100     RECORDING MODE IS F                                          00410001
004200     BLOCK CONTAINS 0 RECORDS                                     00420001
004300     RECORD CONTAINS 170 CHARACTERS.                              00430012
004400 01  EXTRACT-REC                     PIC X(170).                  00440012
004500                                                                  00450001
004600 FD  OUTPUT-REPORT                                                00460001
004700     RECORDING MODE IS F                                          00470001
004800     BLOCK CONTAINS 0  RECORDS.                                   00480001
004900 01  OUTPUT-REC                      PIC X(132).                  00490001
005000                                                                  00500001
005100***************************************************************** 00510001
005200 WORKING-STORAGE SECTION.                                         00520001
005300                                                                  00530001
005400 01  PROGRAM-SWITCHES.                                            00540001
005500     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00550001
005600         88  PS-END-OF-INPUT                   VALUE 'Y'.         00560001
005700         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00570001
005800     05  PS-END-OF-CURSOR-SW         PIC X(01) VALUE 'N'.         00580001
005900         88  PS-END-OF-CURSOR                  VALUE 'Y'.         00590001
006000         88  PS-NOT-END-OF-CURSOR              VALUE 'N'.         00600001
006100                                                                  00610001
006200 01  PC-PROGRAM-CONSTANTS.                                        00620001
006300     05  PC-RCKRP029                 PIC X(08) VALUE              00630001
006400                                               'RCKRP029'.        00640001
006500     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00650001
006600     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00660001
006700                                               COMP-3.            00670001
006800                                                                  00680001
006900 01  PV-PROGRAM-VARIABLES.                                        00690001
007000     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       00700001
007100     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        00710001
007200     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00720001
007300                                               COMP-3.            00730001
007400     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00740001
007500                                               COMP-3.            00750001
007600     05  PV-REC-IN-QTY               PIC 9(07).                   00760001
007700     05  PV-REC-OUT-QTY              PIC 9(07).                   00770001
007800     05  PV-VAR-PCT                  PIC S9(9)V9(8) VALUE +0.     00780016
007900     05  PV-STORE-DESC               PIC X(15).                   00790005
008000     05  DK-OPER-UNT-ID              PIC S9(4) COMP.              00840013
008100     05  PV-DC-PERCENT               PIC S9(2)V COMP-3 VALUE +0.  00850016
008200     05  PV-COMPARE-FIELDS.                                       00860002
008300         10  PV-CURR-DC              PIC 9(04) VALUE ZEROES.      00870001
008400         10  PV-VRFD-DATE.                                        00880011
008500             15  PV-VRFD-DATE-CCYY   PIC X(04) VALUE SPACES.      00890016
008600             15  PV-VRFD-DATE-H1     PIC X(01) VALUE '-'.         00900016
008700             15  PV-VRFD-DATE-MM     PIC X(02) VALUE SPACES.      00910016
008800             15  PV-VRFD-DATE-H2     PIC X(01) VALUE '-'.         00920016
008900             15  PV-VRFD-DATE-DD     PIC X(02) VALUE SPACES.      00930016
009000         10  PV-CURR-VEND            PIC X(30) VALUE SPACES.      00940001
009100         10  PV-CURR-AP              PIC X(01) VALUE SPACES.      00950001
009200         10  PV-CURR-PO-NBR          PIC S9(9) VALUE ZEROES.      00960001
009300         10  PV-CURR-REC-SEQ-NBR     PIC S9(9) VALUE ZEROES.      00970001
009400                                                                  00980001
009500     05  PV-ACCUMULATORS.                                         00990001
009600         10  PV-ACCUM-EXPTD-UNTS-DC  PIC 9(09) VALUE ZEROES.      01000001
009700         10  PV-ACCUM-VRFD-UNTS-DC   PIC 9(09) VALUE ZEROES.      01010001
009800         10  PV-ACCUM-VAR-AMT-DC     PIC S9(9) VALUE ZEROES.      01020019
009900         10  PV-ACCUM-PO-COUNT-DC    PIC 9(09) VALUE ZEROES.      01030001
010000                                                                  01040001
010100     05  PV-FORMAT-FIELDS.                                        01050002
010200         10  PV-FORMAT-3             PIC ZZ9.                     01060003
010300         10  PV-FORMAT-4             PIC ZZZ9.                    01070003
010400         10  PV-FORMAT-6             PIC ZZZ,ZZ9.                 01080002
010500         10  PV-FORMAT-6S            PIC ZZZ,ZZ9-.                01081018
010600         10  PV-FORMAT-7             PIC ZZZZZZ9.                 01090002
010700         10  PV-FORMAT-PO-RCVR.                                   01100002
010800             15  PV-FORMAT-PO        PIC 9(08).                   01110002
010900             15  PV-FORMAT-HYPHEN    PIC X(01) VALUE '-'.         01120002
011000             15  PV-FORMAT-RCVR      PIC 9(03).                   01130002
011100         10  PV-FORMAT-TIMESTAMP.                                 01140010
011200             15  PV-FORMAT-TS-DATE   PIC X(10).                   01150010
011300             15  PV-FORMAT-TS-TIME   PIC X(16).                   01160010
011400                                                                  01170001
011500     05  PV-TODAYS-DATE.                                          01180001
011600         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01190001
011700         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01200001
011800         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01210001
011900     05  PV-TODAYS-DATE-YYYY.                                     01220001
012000         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          01230001
012100         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZERO.        01240001
012200                                                                  01250001
012300     05  PV-TODAYS-TIME.                                          01260001
012400         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01270001
012500         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01280001
012600         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01290001
012700         10  FILLER                  PIC 9(02) VALUE ZERO.        01300001
012800                                                                  01310001
012900 01  PV-ABEND-FIELDS.                                             01320005
013000     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           01330005
013100                                               COMP SYNC.         01340005
013200     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'RCKRP029'.  01350005
013300     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      01360005
013400     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      01370005
013500     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      01380005
013600     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      01390005
013700     05  PV-DB2-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      01400005
013800     05  PV-DB2-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      01410005
013900     05  PV-DB2-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      01420005
014000     05  PV-DB2-TABLE-NAME           PIC X(08) VALUE SPACES.      01430005
014100                                                                  01440005
014200******************************************************************01450001
014300*  RECORD LAYOUT FOR INPUT FILE                                   01460001
014400******************************************************************01470009
014500     COPY RCRD051.                                                01480009
014600/                                                                 01480120
014700*    DOMAIN LOCATION MODULE                                       01480220
014800     COPY XLWS071.                                                01481020
014900                                                                  01490001
015000******************************************************************01500001
015100*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01510001
015200******************************************************************01520002
015300     COPY DPWS132.                                                01530001
015400                                                                  01540001
015500 01  WS-BATCH-PROC-DATE.                                          01550001
015600     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      01560001
015700     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      01570001
015800     05  FILLER                      PIC X(01) VALUE SPACES.      01580001
015900     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      01590001
016000     05  FILLER                      PIC X(01) VALUE SPACES.      01600001
016100     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      01610001
016200*                                                                 01620001
016300 01  HEADING-LINES.                                               01630001
016400     05  HEADING-LINE-1.                                          01640001
016500         10  FILLER                  PIC X(40) VALUE SPACES.      01650001
016600         10  FILLER                  PIC X(45) VALUE              01660001
016700             'DAILY CARTON COUNT TO VERIFIED UNIT QUANTITY '.     01670001
016800         10  FILLER                  PIC X(08) VALUE              01680001
016900                                               'VARIANCE'.        01690001
017000         10  FILLER                  PIC X(39) VALUE SPACES.      01700001
017100                                                                  01710001
017200     05  HEADING-LINE-2.                                          01720002
017300         10  FILLER                  PIC X(01) VALUE SPACES.      01730002
017400         10  FILLER                  PIC X(17) VALUE              01740002
017500                                     'DC ...........:  '.         01750002
017600         10  HL2-DC-NBR              PIC Z(04) VALUE ZEROES.      01760002
017700         10  FILLER                  PIC X(02) VALUE SPACES.      01770002
017800         10  HL2-DC-DESC             PIC X(15) VALUE SPACES.      01780002
017900         10  FILLER                  PIC X(06) VALUE SPACES.      01790002
018000         10  FILLER                  PIC X(14) VALUE              01800002
018100                                     'VERIFY DATE:  '.            01810002
018200         10  HL2-DATE-MM             PIC X(02) VALUE SPACES.      01820002
018300         10  FILLER                  PIC X(01) VALUE '/'.         01830002
018400         10  HL2-DATE-DD             PIC X(02) VALUE SPACES.      01840002
018500         10  FILLER                  PIC X(01) VALUE '/'.         01850002
018600         10  HL2-DATE-CCYY           PIC X(04) VALUE SPACES.      01860002
018700         10  FILLER                  PIC X(63) VALUE SPACES.      01870002
018800                                                                  01880002
018900     05  HEADING-LINE-3.                                          01890002
019000         10  FILLER                  PIC X(01) VALUE SPACES.      01900002
019100         10  FILLER                  PIC X(17) VALUE              01910002
019200                                     'DAILY VARIANCE:  '.         01920002
019300         10  HL3-DC-VAR              PIC ZZ9   VALUE ZEROES.      01930002
019400         10  FILLER                  PIC X(01) VALUE '%'.         01940002
019500         10  FILLER                  PIC X(110) VALUE SPACES.     01950002
019600                                                                  01960001
019700     05  HEADING-LINE-4.                                          01970001
019800         10  FILLER                  PIC X(01) VALUE SPACES.      01980001
019900         10  FILLER                  PIC X(25) VALUE              01990002
020000                                     'VENDOR NAME              '. 02000002
020100         10  FILLER                  PIC X(01) VALUE SPACES.      02010002
020200         10  FILLER                  PIC X(09) VALUE              02020002
020300                                     '   A/P   '.                 02030002
020400         10  FILLER                  PIC X(02) VALUE SPACES.      02040002
020500         10  FILLER                  PIC X(12) VALUE              02050002
020600                                     '   PO/RCVR  '.              02060002
020700         10  FILLER                  PIC X(01) VALUE SPACES.      02070002
020800         10  FILLER                  PIC X(04) VALUE 'DEPT'.      02080002
020900         10  FILLER                  PIC X(01) VALUE SPACES.      02090002
021000         10  FILLER                  PIC X(06) VALUE ' PROC '.    02100002
021100         10  FILLER                  PIC X(02) VALUE SPACES.      02110002
021200         10  FILLER                  PIC X(05) VALUE 'SHIFT'.     02120002
021300         10  FILLER                  PIC X(01) VALUE SPACES.      02130002
021400         10  FILLER                  PIC X(07) VALUE 'EXPECTD'.   02140002
021500         10  FILLER                  PIC X(01) VALUE SPACES.      02150002
021600         10  FILLER                  PIC X(07) VALUE '   ADJ '.   02160002
021700         10  FILLER                  PIC X(01) VALUE SPACES.      02170002
021800         10  FILLER                  PIC X(07) VALUE 'EXPECTD'.   02180002
021900         10  FILLER                  PIC X(02) VALUE SPACES.      02190002
022000         10  FILLER                  PIC X(07) VALUE ' VERIFD'.   02200002
022100         10  FILLER                  PIC X(01) VALUE SPACES.      02210002
022200         10  FILLER                  PIC X(04) VALUE 'UNIT'.      02220002
022300         10  FILLER                  PIC X(02) VALUE SPACES.      02230002
022400         10  FILLER                  PIC X(07) VALUE ' DOLLAR'.   02240002
022500         10  FILLER                  PIC X(02) VALUE SPACES.      02250002
022600         10  FILLER                  PIC X(05) VALUE 'STYLE'.     02260002
022700         10  FILLER                  PIC X(02) VALUE SPACES.      02270002
022600         10  FILLER                  PIC X(06) VALUE 'VERIFY'.    02260002
022700         10  FILLER                  PIC X(01) VALUE SPACES.      02270002
022800                                                                  02280001
022900     05  HEADING-LINE-5.                                          02290002
023000         10  FILLER                  PIC X(01) VALUE SPACES.      02300002
023100         10  FILLER                  PIC X(25) VALUE SPACES.      02310002
023200         10  FILLER                  PIC X(01) VALUE SPACES.      02320002
023300         10  FILLER                  PIC X(09) VALUE              02330002
023400                                               ' VEND NBR'.       02340002
023500         10  FILLER                  PIC X(02) VALUE SPACES.      02350002
023600         10  FILLER                  PIC X(12) VALUE SPACES.      02360002
023700         10  FILLER                  PIC X(01) VALUE SPACES.      02370002
023800         10  FILLER                  PIC X(04) VALUE 'NBR '.      02380002
023900         10  FILLER                  PIC X(01) VALUE SPACES.      02390002
024000         10  FILLER                  PIC X(06) VALUE ' AREA '.    02400002
024100         10  FILLER                  PIC X(02) VALUE SPACES.      02410002
024200         10  FILLER                  PIC X(05) VALUE SPACES.      02420002
024300         10  FILLER                  PIC X(01) VALUE SPACES.      02430002
024400         10  FILLER                  PIC X(07) VALUE '  CTNS '.   02440002
024500         10  FILLER                  PIC X(01) VALUE SPACES.      02450002
024600         10  FILLER                  PIC X(07) VALUE '  CTNS '.   02460002
024700         10  FILLER                  PIC X(01) VALUE SPACES.      02470002
024800         10  FILLER                  PIC X(07) VALUE ' UNITS '.   02480002
024900         10  FILLER                  PIC X(02) VALUE SPACES.      02490002
025000         10  FILLER                  PIC X(07) VALUE ' UNITS '.   02500002
025100         10  FILLER                  PIC X(01) VALUE SPACES.      02510002
025200         10  FILLER                  PIC X(04) VALUE 'VAR '.      02520002
025300         10  FILLER                  PIC X(02) VALUE SPACES.      02530002
025400         10  FILLER                  PIC X(07) VALUE '  VAR  '.   02540002
025500         10  FILLER                  PIC X(02) VALUE SPACES.      02550002
025600         10  FILLER                  PIC X(05) VALUE ' SUB '.     02560002
025700         10  FILLER                  PIC X(02) VALUE SPACES.      02570002
025600         10  FILLER                  PIC X(07) VALUE 'USER ID'.   02560002
025800                                                                  02580002
025900     05  HEADING-LINE-6.                                          02590002
026000         10  FILLER                  PIC X(01) VALUE SPACES.      02600002
026100         10  FILLER                  PIC X(25) VALUE ALL '-'.     02610002
026200         10  FILLER                  PIC X(01) VALUE SPACES.      02620002
026300         10  FILLER                  PIC X(09) VALUE ALL '-'.     02630002
026400         10  FILLER                  PIC X(02) VALUE SPACES.      02640002
026500         10  FILLER                  PIC X(12) VALUE ALL '-'.     02650002
026600         10  FILLER                  PIC X(01) VALUE SPACES.      02660002
026700         10  FILLER                  PIC X(04) VALUE ALL '-'.     02670002
026800         10  FILLER                  PIC X(01) VALUE SPACES.      02680002
026900         10  FILLER                  PIC X(06) VALUE ALL '-'.     02690002
027000         10  FILLER                  PIC X(02) VALUE SPACES.      02700002
027100         10  FILLER                  PIC X(05) VALUE ALL '-'.     02710002
027200         10  FILLER                  PIC X(01) VALUE SPACES.      02720002
027300         10  FILLER                  PIC X(07) VALUE ALL '-'.     02730002
027400         10  FILLER                  PIC X(01) VALUE SPACES.      02740002
027500         10  FILLER                  PIC X(07) VALUE ALL '-'.     02750002
027600         10  FILLER                  PIC X(01) VALUE SPACES.      02760002
027700         10  FILLER                  PIC X(07) VALUE ALL '-'.     02770002
027800         10  FILLER                  PIC X(02) VALUE SPACES.      02780002
027900         10  FILLER                  PIC X(07) VALUE ALL '-'.     02790002
028000         10  FILLER                  PIC X(01) VALUE SPACES.      02800002
028100         10  FILLER                  PIC X(04) VALUE ALL '-'.     02810002
028200         10  FILLER                  PIC X(02) VALUE SPACES.      02820002
028300         10  FILLER                  PIC X(07) VALUE ALL '-'.     02830002
028400         10  FILLER                  PIC X(02) VALUE SPACES.      02840002
028500         10  FILLER                  PIC X(05) VALUE ALL '-'.     02850002
028600         10  FILLER                  PIC X(01) VALUE SPACES.      02860002
028500         10  FILLER                  PIC X(08) VALUE ALL '-'.     02850002
028600         10  FILLER                  PIC X(01) VALUE SPACES.      02860002
028700                                                                  02870002
028800 01  DETAIL-LINES.                                                02880001
028900     05  DETAIL-LINE-1.                                           02890001
029000         10  FILLER                  PIC X(01) VALUE SPACES.      02900002
029100         10  DL1-VEND-NAME           PIC X(25) VALUE SPACES.      02910002
029200         10  FILLER                  PIC X(01) VALUE SPACES.      02920002
029300         10  DL1-VEND-NBR            PIC Z(8)9 VALUE ZEROES.      02930002
029400         10  FILLER                  PIC X(02) VALUE SPACES.      02940002
029500         10  DL1-PO-RCVR             PIC X(12) VALUE SPACES.      02950002
029600         10  FILLER                  PIC X(02) VALUE SPACES.      02960002
029700         10  DL1-DEPT                PIC X(03) VALUE SPACES.      02970002
029800         10  FILLER                  PIC X(01) VALUE SPACES.      02980002
029900         10  DL1-PROC-AREA           PIC X(06) VALUE SPACES.      02990002
030000         10  FILLER                  PIC X(04) VALUE SPACES.      03000002
030100         10  DL1-SHIFT               PIC X(01) VALUE SPACES.      03010002
030200         10  FILLER                  PIC X(03) VALUE SPACES.      03020002
030300         10  DL1-EXPCTD-CTNS         PIC X(07) VALUE SPACES.      03030002
030400         10  FILLER                  PIC X(01) VALUE SPACES.      03040002
030500         10  DL1-ADJSTD-CTNS         PIC X(07) VALUE SPACES.      03050005
030600         10  FILLER                  PIC X(01) VALUE SPACES.      03060002
030700         10  DL1-EXPCTD-UNTS         PIC X(07) VALUE SPACES.      03070002
030800         10  FILLER                  PIC X(02) VALUE SPACES.      03080002
030900         10  DL1-VERIFD-UNTS         PIC X(07) VALUE SPACES.      03090002
031000         10  FILLER                  PIC X(01) VALUE SPACES.      03100002
031100         10  DL1-UNIT-VAR            PIC ZZ9   VALUE ZEROES.      03110002
031200         10  FILLER                  PIC X(01) VALUE '%'.         03120002
031300         10  FILLER                  PIC X(02) VALUE SPACES.      03130002
031400         10  DL1-DOLLAR-VAR          PIC X(08) VALUE SPACES.      03140018
031500         10  FILLER                  PIC X(03) VALUE SPACES.      03150018
031600         10  DL1-STYLE-SUB           PIC X(01) VALUE SPACES.      03160002
031700         10  FILLER                  PIC X(04) VALUE SPACES.      03170002
031600         10  DL1-VRFD-USR-ID         PIC X(08) VALUE SPACES.      03160002
031700         10  FILLER                  PIC X(02) VALUE SPACES.      03170002
031800                                                                  03180001
031900 01  TOTAL-LINES.                                                 03190001
032000     05  TOTAL-LINE-1.                                            03200001
032100         10  FILLER                  PIC X(08) VALUE SPACES.      03210002
032200         10  FILLER                  PIC X(22) VALUE              03220002
032300             'TOTAL PO/RCVRS FOR DC '.                            03230002
032400         10  TL1-DC                  PIC Z(04) VALUE ZEROES.      03240002
032500         10  FILLER                  PIC X(02) VALUE ': '.        03250001
032600         10  TL1-PO-COUNT            PIC X(07).                   03260002
032700         10  FILLER                  PIC X(28) VALUE SPACES.      03270002
032800         10  FILLER                  PIC X(14) VALUE              03280002
032900                                     'TOTALS FOR DC:'.            03290002
033000         10  FILLER                  PIC X(01) VALUE SPACES.      03300002
033100         10  TL1-EXPCTD-UNTS         PIC X(07) VALUE SPACES.      03310002
033200         10  FILLER                  PIC X(02) VALUE SPACES.      03320002
033300         10  TL1-VERIFD-UNTS         PIC X(07) VALUE SPACES.      03330002
033400         10  FILLER                  PIC X(01) VALUE SPACES.      03340002
033500         10  TL1-UNIT-VAR            PIC X(03) VALUE SPACES.      03350003
033600         10  FILLER                  PIC X(01) VALUE '%'.         03360002
033700         10  FILLER                  PIC X(02) VALUE SPACES.      03370002
033800         10  TL1-DOLLAR-VAR          PIC X(08) VALUE SPACES.      03380019
033900         10  FILLER                  PIC X(08) VALUE SPACES.      03390019
034000                                                                  03400001
034100 01  MISCELLANEOUS-LINES.                                         03410001
034200     05  BLANK-LINE.                                              03420001
034300         10  FILLER                  PIC X(132) VALUE SPACES.     03430001
034400                                                                  03440001
034500     05  END-OF-REPORT-LINE.                                      03450001
034600         10  FILLER                  PIC X(44) VALUE SPACES.      03460001
034700         10  FILLER                  PIC X(45) VALUE              03470001
034800             '*******   E N D   O F   R E P O R T   *******'.     03480001
034900         10  FILLER                  PIC X(43) VALUE SPACES.      03490001
035000                                                                  03500001
035100     05  NO-MISDIRECT-DATA-LINE.                                  03510001
035200         10  FILLER                  PIC X(01) VALUE SPACES.      03520001
035300         10  FILLER                  PIC X(23) VALUE              03530001
035400                                     '** NO DATA TO REPORT **'.   03540001
035500         10  FILLER                  PIC X(108) VALUE SPACES.     03550001
035600                                                                  03560001
035700     05  NO-DATA-TO-REPORT-LINE.                                  03570001
035800         10  FILLER                  PIC X(40) VALUE SPACES.      03580001
035900         10  FILLER                  PIC  X(52)    VALUE          03590001
036000         '*******  N O   D A T A   T O   R E P O R T   *******'.  03600001
036100         10  FILLER                  PIC  X(40)    VALUE SPACES.  03610001
036200                                                                  03620001
036300******************************************************************03630001
036400*  USED FOR DB2 ERROR MESSAGE BUILDING                            03640001
036500******************************************************************03650001
036600     COPY DPWS004.                                                03660020
036700                                                                  03670001
036800******************************************************************03680001
036900*   DB2 SQL COMMUNICATION AREA                                    03690001
037000******************************************************************03700001
037100     EXEC SQL                                                     03710001
037200          INCLUDE SQLCA                                           03720001
037300     END-EXEC.                                                    03730001
037400                                                                  03740001
037500******************************************************************03820005
037600*  DCLGEN FOR THE COMPANY CONTROL TABLE                           03830005
037700******************************************************************03840005
037800     EXEC SQL                                                     03850005
037900          INCLUDE TCOCNTL                                         03860005
038000     END-EXEC.                                                    03870005
038100                                                                  03880005
038200/*****************************************************************03890005
038300******************************************************************03900001
038400 PROCEDURE DIVISION.                                              03910001
038500     DISPLAY '**** START OF RCKRP029 ****'.                       03920002
038600                                                                  03930001
038700*OPEN FILES.                                                      03940001
038800     OPEN INPUT  INPUT-EXTRACT-FILE                               03950001
038900          OUTPUT OUTPUT-REPORT.                                   03960001
039000                                                                  03970001
039100*READ FIRST INPUT RECORD.                                         03980001
039200     SET PS-NOT-END-OF-INPUT TO TRUE.                             03990001
039300     MOVE 0 TO PV-REC-IN-QTY.                                     04000001
039400     PERFORM 0100-READ-EXTRACT.                                   04010001
039500                                                                  04020001
039600*SET/PRINT REPORT HEADINGS.                                       04030001
039700     IF NOT PS-END-OF-INPUT                                       04040001
039800         MOVE RC051-CURR-OPER-UNT-ID      TO PV-CURR-DC           04050011
039900         MOVE RC051-VERIFIED-TIMESTAMP    TO PV-VRFD-DATE         04060011
040000         PERFORM 0500-FETCH-DC-NAME                               04070005
040100         PERFORM 0600-FETCH-DC-PERCENT                            04080015
040200         MOVE 1 TO PV-REC-IN-QTY                                  04090011
040300     END-IF.                                                      04100001
040400     DISPLAY '  ** 1000-INITIALIZATION **'.                       04110001
040500     PERFORM 1000-INITIALIZATION.                                 04120001
040600     DISPLAY '  ** 1000-INITIALIZATION DONE **'.                  04130001
040700                                                                  04140001
040800*PROCESS INPUT FILE.                                              04150001
040900     IF PS-END-OF-INPUT                                           04160001
041000         PERFORM 1300-NO-DETAIL-LINE                              04170001
041100     ELSE                                                         04180001
041200         PERFORM 2000-PROCESS-EXTRACT                             04190001
041300           UNTIL PS-END-OF-INPUT                                  04200001
041400         PERFORM 2200-PRINT-DC-TOTAL                              04210003
041500     END-IF.                                                      04220001
041600                                                                  04230001
041700     DISPLAY '**** RECORDS READ    ==> ' PV-REC-IN-QTY.           04240001
041800     DISPLAY '**** RECORDS WRITTEN ==> ' PV-REC-OUT-QTY.          04250001
041900                                                                  04260001
042000*WRITE END-OF-REPORT LINE.                                        04270001
042100     PERFORM 1400-END-OF-RPT-LINE.                                04280001
042200                                                                  04290001
042300*CLOSE FILES.                                                     04300001
042400     CLOSE INPUT-EXTRACT-FILE                                     04310001
042500           OUTPUT-REPORT.                                         04320001
042600                                                                  04330001
042700     GOBACK.                                                      04340001
042800                                                                  04350001
042900******************************************************************04360001
043000*  READ NEXT INPUT FILE RECORD.                                  *04370001
043100******************************************************************04380001
043200 0100-READ-EXTRACT.                                               04390001
043300                                                                  04400001
043400     READ INPUT-EXTRACT-FILE INTO RC051-RECORD                    04410009
043500       AT END                                                     04420001
043600           SET PS-END-OF-INPUT TO TRUE.                           04430001
043700                                                                  04440001
043800 0500-FETCH-DC-NAME.                                              04480005
043900                                                                  04490005
044000     MOVE PV-CURR-DC                  TO XL071-LOCATION-NUMBER    04500005
044100     PERFORM 8500-CALL-XLKUT071.                                  07591120
044200                                                                  04580005
044300     EVALUATE TRUE                                                        
044400         WHEN XL071-NO-ERRORS                                             
044500             MOVE XL071-LOC-NM        TO PV-STORE-DESC            04610005
044600         WHEN XL071-LOC-NOT-FOUND                                         
044700         WHEN XL071-DC-ASGMT-NOT-FND                                      
044800             MOVE '*NAME NOT FOUND'   TO PV-STORE-DESC            04640005
044900     END-EVALUATE.                                                        
045000                                                                  04720005
045100******************************************************************04730013
045200*  READ THE COMPANY CONTROL TABLE (TCOCNTL) FOR DC PERCENTAGE    *04740013
045300******************************************************************04750015
045400 0600-FETCH-DC-PERCENT.                                           04760013
045500                                                                  04770013
045600     MOVE PV-CURR-DC TO DK-OPER-UNT-ID.                           04780013
045700     MOVE ZEROES     TO PV-DC-PERCENT.                            04790013
045800                                                                  04800013
045900     EXEC SQL                                                     04810013
046000         SELECT UNT_VRFN_VARN_PCT                                 04820013
046100           INTO :COCNTL-UNT-VRFN-VARN-PCT                         04830013
046200           FROM TCOCNTL                                           04840013
046300          WHERE OPER_UNT_ID = :DK-OPER-UNT-ID                     04850013
046400     END-EXEC.                                                    04860013
046500                                                                  04870013
046600     EVALUATE TRUE                                                04880013
046700       WHEN SQLCODE = ZERO                                        04890013
046800           MOVE COCNTL-UNT-VRFN-VARN-PCT TO PV-DC-PERCENT         04900013
046900                                                                  04910013
047000       WHEN OTHER                                                 04920013
047100           MOVE '0600-FETCH-DC-PERCENT'  TO PV-ABEND-PARAGRAPH    04930013
047200           MOVE 'GET DC PERCENT' TO PV-DB2-OPERATION-MESSAGE-1    04940013
047300           MOVE 'TCOCNTL'        TO PV-DB2-TABLE-NAME             04950013
047400           PERFORM 9900-DB2-ABEND                                 04960013
047500     END-EVALUATE.                                                04970013
047600                                                                  04980013
047700******************************************************************04990013
047800*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *05000001
047900******************************************************************05010001
048000 1000-INITIALIZATION.                                             05020001
048100                                                                  05030001
048200     ACCEPT PV-TODAYS-DATE FROM DATE.                             05040001
048300     MOVE PV-TODAYS-DATE-MM    TO DP132-RUN-MONTH.                05050001
048400     MOVE PV-TODAYS-DATE-DD    TO DP132-RUN-DAY.                  05060001
048500     MOVE PV-TODAYS-DATE-YY    TO PV-TODAYS-DATE-Y2.              05070001
048600     MOVE PV-TODAYS-DATE-YYYY  TO DP132-RUN-YEAR.                 05080001
048700                                                                  05090001
048800     ACCEPT PV-TODAYS-TIME FROM TIME.                             05100001
048900     MOVE PV-TODAYS-TIME-HH    TO DP132-RUN-HOUR.                 05110001
049000     MOVE PV-TODAYS-TIME-MM    TO DP132-RUN-MINUTE.               05120001
049100                                                                  05130001
049200     MOVE PC-RCKRP029          TO DP132-PROGRAM-NAME.             05140002
049300     MOVE PC-REPORT-NBR        TO DP132-REPORT-NUMBER.            05150001
049400                                                                  05160001
049500     MOVE +0                   TO PV-REC-OUT-QTY.                 05170001
049600                                                                  05180001
049700     MOVE +0                   TO PV-PAGE-COUNT                   05190001
049800                                  PV-ACCUM-EXPTD-UNTS-DC          05200002
049900                                  PV-ACCUM-VRFD-UNTS-DC           05210002
050000                                  PV-ACCUM-VAR-AMT-DC             05220002
050100                                  PV-ACCUM-PO-COUNT-DC.           05230002
050200                                                                  05240001
050300     PERFORM 1200-PRINT-HEADINGS.                                 05250001
050400                                                                  05260001
050500******************************************************************05270001
050600*  PRINT THE REPORT HEADINGS.                                    *05280001
050700******************************************************************05290001
050800 1200-PRINT-HEADINGS.                                             05300001
050900                                                                  05310001
051000     ADD +1 TO PV-PAGE-COUNT.                                     05320002
051100     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     05330001
051200                                                                  05340001
051300     WRITE OUTPUT-REC                                             05350001
051400       FROM DP132-STANDRD-HEADER-132-COLS                         05360001
051500         AFTER ADVANCING PAGE.                                    05370001
051600                                                                  05380001
051700     MOVE +1 TO PV-LINE-COUNT.                                    05390001
051800                                                                  05400001
051900     WRITE OUTPUT-REC                                             05410001
052000       FROM HEADING-LINE-1                                        05420001
052100         AFTER ADVANCING 2 LINES.                                 05430001
052200                                                                  05440001
052300     MOVE PV-CURR-DC         TO HL2-DC-NBR.                       05450005
052400     MOVE PV-STORE-DESC      TO HL2-DC-DESC.                      05460005
052500     MOVE PV-VRFD-DATE-MM    TO HL2-DATE-MM.                      05470011
052600     MOVE PV-VRFD-DATE-DD    TO HL2-DATE-DD.                      05480011
052700     MOVE PV-VRFD-DATE-CCYY  TO HL2-DATE-CCYY.                    05490011
052800     WRITE OUTPUT-REC                                             05500001
052900       FROM HEADING-LINE-2                                        05510001
053000         AFTER ADVANCING 3 LINES.                                 05520002
053100                                                                  05530001
053200     MOVE PV-DC-PERCENT TO HL3-DC-VAR.                            05540014
053300     WRITE OUTPUT-REC                                             05550001
053400       FROM HEADING-LINE-3                                        05560001
053500         AFTER ADVANCING 1 LINES.                                 05570002
053600                                                                  05580001
053700     WRITE OUTPUT-REC                                             05590001
053800       FROM HEADING-LINE-4                                        05600001
053900         AFTER ADVANCING 2 LINES.                                 05610001
054000                                                                  05620001
054100     WRITE OUTPUT-REC                                             05630001
054200       FROM HEADING-LINE-5                                        05640002
054300         AFTER ADVANCING 1 LINES.                                 05650001
054400                                                                  05660001
054500     WRITE OUTPUT-REC                                             05670001
054600       FROM HEADING-LINE-6                                        05680002
054700         AFTER ADVANCING 1 LINES.                                 05690001
054800                                                                  05700001
054900     WRITE OUTPUT-REC                                             05710001
055000       FROM BLANK-LINE                                            05720002
055100         AFTER ADVANCING 1 LINES.                                 05730001
055200                                                                  05740001
055300     MOVE +12 TO PV-LINE-COUNT.                                   05750002
055400                                                                  05760001
055500******************************************************************05770001
055600*  PRINT A 'NO INPUT' REPORT LINE.                               *05780001
055700******************************************************************05790001
055800 1300-NO-DETAIL-LINE.                                             05800001
055900                                                                  05810001
056000     WRITE OUTPUT-REC                                             05820001
056100       FROM NO-DATA-TO-REPORT-LINE                                05830001
056200         AFTER ADVANCING 3 LINES.                                 05840001
056300                                                                  05850001
056400******************************************************************05860001
056500*  PRINT A 'END OF REPORT' REPORT LINE.                          *05870001
056600******************************************************************05880001
056700 1400-END-OF-RPT-LINE.                                            05890001
056800                                                                  05900001
056900*CHECK FOR OVERFLOW.                                              05910001
057000     ADD 3 TO PV-LINE-COUNT.                                      05920001
057100     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         05930001
057200         PERFORM 1200-PRINT-HEADINGS                              05940001
057300     END-IF.                                                      05950001
057400                                                                  05960001
057500*PRINT LINE.                                                      05970001
057600     WRITE OUTPUT-REC                                             05980001
057700       FROM END-OF-REPORT-LINE                                    05990001
057800         AFTER ADVANCING 3 LINES.                                 06000001
057900                                                                  06010001
058000******************************************************************06020001
058100*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR READING THE INPUT  *06030001
058200*  EXTRACT FILE (FORMAT RCRD051) AND WRITING THE 'DAILY CARTON   *06040009
058300*  COUNT TO VERIFIED UNIT QUANTITY VARIANCE' REPORT AS OUTPUT.   *06050003
058400******************************************************************06060009
058500 2000-PROCESS-EXTRACT.                                            06070001
058600                                                                  06080001
058700*CHECK FOR BREAKS.                                                06090001
058800     IF RC051-CURR-OPER-UNT-ID NOT = PV-CURR-DC                   06100009
058900         PERFORM 2200-PRINT-DC-TOTAL                              06110003
059000         MOVE 0 TO PV-PAGE-COUNT                                  06120001
059100                   PV-ACCUM-EXPTD-UNTS-DC                         06130005
059200                   PV-ACCUM-VRFD-UNTS-DC                          06140005
059300                   PV-ACCUM-VAR-AMT-DC                            06150005
059400                   PV-ACCUM-PO-COUNT-DC                           06160003
059500         MOVE RC051-CURR-OPER-UNT-ID      TO PV-CURR-DC           06170011
059600         MOVE RC051-VERIFIED-TIMESTAMP    TO PV-VRFD-DATE         06180011
059700         PERFORM 0500-FETCH-DC-NAME                               06190011
059800         PERFORM 0600-FETCH-DC-PERCENT                            06200015
059900         PERFORM 1200-PRINT-HEADINGS                              06210001
060000     END-IF.                                                      06220001
060100                                                                  06230001
060200*PRINT DETAIL LINE.                                               06240001
060300     PERFORM 2100-PRINT-DETAIL.                                   06250001
060400     ADD +1 TO PV-REC-OUT-QTY.                                    06260001
060500                                                                  06270001
060600*READ NEXT INPUT RECORD.                                          06280001
060700     PERFORM 0100-READ-EXTRACT.                                   06290001
060800     IF NOT PS-END-OF-INPUT                                       06300001
060900         ADD +1 TO PV-REC-IN-QTY                                  06310001
061000     END-IF.                                                      06320001
061100                                                                  06330001
061200******************************************************************06340001
061300*  FILL AND DETAIL REPORT LINE.                                  *06350001
061400******************************************************************06360009
061500 2100-PRINT-DETAIL.                                               06370001
061600                                                                  06380001
061700*FILL VENDOR NAME.                                                06390005
061800     MOVE RC051-VENDOR-NAME-DUNNS TO DL1-VEND-NAME.               06400011
061900                                                                  06410005
062000*FILL A/P VENDOR NUMBER.                                          06420005
062100     MOVE RC051-VENDOR-NO-DUNNS   TO DL1-VEND-NBR.                06430011
062200                                                                  06440005
062300*FILL PO/RECEIVER.                                                06450001
062400     MOVE RC051-PO                TO PV-FORMAT-PO.                06460011
062500     MOVE RC051-REC-SEQ-NBR       TO PV-FORMAT-RCVR.              06470011
062600     MOVE PV-FORMAT-PO-RCVR       TO DL1-PO-RCVR.                 06480011
062700                                                                  06490005
062800*FILL DEPT NUMBER.                                                06500005
062900     MOVE RC051-DEPT              TO DL1-DEPT.                    06510011
063000                                                                  06520005
063100*FILL PROC AREA.                                                  06530005
063200     MOVE RC051-PROCESSING-AREA   TO DL1-PROC-AREA.               06540011
063300                                                                  06550005
063400*FILL SHIFT.                                                      06560005
063500     MOVE RC051-DC-SHIFT          TO DL1-SHIFT.                   06570011
063600                                                                  06580005
063700*FILL EXPECTED CARTONS.                                           06590005
063800     MOVE RC051-EXPTD-CARTONS     TO PV-FORMAT-6.                 06600011
063900     MOVE PV-FORMAT-6             TO DL1-EXPCTD-CTNS.             06610011
064000                                                                  06620005
064100*FILL ADJUSTED CARTONS.                                           06630005
064200     MOVE RC051-ACTUAL-CARTONS    TO PV-FORMAT-6.                 06640011
064300     MOVE PV-FORMAT-6             TO DL1-ADJSTD-CTNS.             06650011
064400                                                                  06660005
064500*FILL EXPECTED UNITS.                                             06670005
064600     MOVE RC051-EXPTD-UNITS       TO PV-FORMAT-6.                 06680011
064700     MOVE PV-FORMAT-6             TO DL1-EXPCTD-UNTS.             06690011
064800                                                                  06700005
064900*FILL VERIFIED UNITS.                                             06710005
065000     MOVE RC051-ACTUAL-UNITS      TO PV-FORMAT-6.                 06720011
065100     MOVE PV-FORMAT-6             TO DL1-VERIFD-UNTS.             06730011
065200                                                                  06740005
065300*FILL UNIT VARIANCE.                                              06750005
065400     MOVE RC051-DLY-UNIT-VARIANCE-PCT                             06760009
065500                                  TO PV-FORMAT-3                  06770011
065600     MOVE PV-FORMAT-3             TO DL1-UNIT-VAR.                06780011
065700                                                                  06790005
065800*FILL DOLLAR VARIANCE.                                            06800005
065900     MOVE RC051-DOLLAR-VARIANCE   TO PV-FORMAT-6S.                06810017
066000     MOVE PV-FORMAT-6S            TO DL1-DOLLAR-VAR.              06820017
066100                                                                  06830001
066200*FILL STYLE SUB.                                                  06840005
066300     MOVE RC051-STYLE-SUB         TO DL1-STYLE-SUB.               06850011
066400                                                                  06860005
066200*FILL STYLE SUB.                                                  06840005
066300     MOVE RC051-VRFD-USR-ID       TO DL1-VRFD-USR-ID.             06850011
066400                                                                  06860005
066500*ACCUMULATE TOTALS.                                               06870005
066600     ADD +1                       TO PV-ACCUM-PO-COUNT-DC.        06880011
066700                                                                  06890011
066800     COMPUTE PV-ACCUM-EXPTD-UNTS-DC = PV-ACCUM-EXPTD-UNTS-DC      06900011
066900                                    + RC051-EXPTD-UNITS.          06910011
067000                                                                  06920011
067100     COMPUTE PV-ACCUM-VRFD-UNTS-DC  = PV-ACCUM-VRFD-UNTS-DC       06930011
067200                                    + RC051-ACTUAL-UNITS.         06940011
067300                                                                  06950011
067400     COMPUTE PV-ACCUM-VAR-AMT-DC    = PV-ACCUM-VAR-AMT-DC         06960011
067500                                    + RC051-DOLLAR-VARIANCE.      06970011
067600                                                                  06980001
067700*CHECK FOR OVERFLOW.                                              06990001
067800     ADD 1 TO PV-LINE-COUNT.                                      07000001
067900     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         07010001
068000         PERFORM 1200-PRINT-HEADINGS                              07020001
068100     END-IF.                                                      07030001
068200                                                                  07040001
068300*WRITE DETAIL LINE.                                               07050001
068400     WRITE OUTPUT-REC                                             07060001
068500       FROM DETAIL-LINE-1                                         07070001
068600         AFTER ADVANCING 1 LINES.                                 07080001
068700                                                                  07090001
068800******************************************************************07100002
068900*  PRINT TOTAL LINE AFTER LAST RECORD WRITTEN.                   *07110002
069000******************************************************************07120006
069100 2200-PRINT-DC-TOTAL.                                             07130003
069200                                                                  07140002
069300*CHECK FOR OVERFLOW.                                              07150002
069400     ADD 3 TO PV-LINE-COUNT.                                      07160002
069500     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         07170002
069600         PERFORM 1200-PRINT-HEADINGS                              07180002
069700     END-IF.                                                      07190002
069800                                                                  07200002
069900*FILL DC TOTALS.                                                  07210003
070000     MOVE PV-CURR-DC             TO TL1-DC.                       07220006
070100                                                                  07230002
070200     MOVE PV-ACCUM-PO-COUNT-DC   TO PV-FORMAT-7.                  07240006
070300     MOVE PV-FORMAT-7            TO TL1-PO-COUNT.                 07250006
070400                                                                  07260002
070500     MOVE PV-ACCUM-EXPTD-UNTS-DC TO PV-FORMAT-6.                  07270006
070600     MOVE PV-FORMAT-6            TO TL1-EXPCTD-UNTS.              07280006
070700                                                                  07290006
070800     MOVE PV-ACCUM-VRFD-UNTS-DC  TO PV-FORMAT-6.                  07300006
070900     MOVE PV-FORMAT-6            TO TL1-VERIFD-UNTS.              07310006
071000                                                                  07320006
071100     MOVE PV-ACCUM-VAR-AMT-DC    TO PV-FORMAT-6S.                 07330019
071200     MOVE PV-FORMAT-6S           TO TL1-DOLLAR-VAR.               07340019
071300                                                                  07350006
071400*CALCULATE VARIANCE PERCENTAGE.                                   07360006
071500     MOVE ZEROES                 TO PV-VAR-PCT.                   07370006
071600     IF PV-ACCUM-EXPTD-UNTS-DC NOT = +0                           07380006
071700         IF PV-ACCUM-VRFD-UNTS-DC = +0                            07390007
071800             MOVE 100            TO PV-VAR-PCT                    07400007
071900         ELSE                                                     07410007
072000             COMPUTE PV-VAR-PCT = ((PV-ACCUM-VRFD-UNTS-DC         07420008
072100                                  - PV-ACCUM-EXPTD-UNTS-DC)       07430008
072200                                  / PV-ACCUM-EXPTD-UNTS-DC)       07440008
072300                                  * 100                           07450008
072400         END-IF                                                   07460007
072500     ELSE                                                         07470007
072600         IF PV-ACCUM-VRFD-UNTS-DC NOT = +0                        07480007
072700             MOVE 100            TO PV-VAR-PCT                    07490007
072800         END-IF                                                   07500007
072900     END-IF.                                                      07510007
073000     MOVE PV-VAR-PCT             TO PV-FORMAT-3                   07520006
073100     MOVE PV-FORMAT-3            TO TL1-UNIT-VAR.                 07530006
073200                                                                  07540006
073300*WRITE TOTAL LINE.                                                07550002
073400     WRITE OUTPUT-REC                                             07560002
073500       FROM TOTAL-LINE-1                                          07570002
073600         AFTER ADVANCING 3 LINES.                                 07580002
073700/                                                                 07591020
073800 8500-CALL-XLKUT071.                                              07591120
073900     MOVE '8500-CALL-XLKUT071'        TO PV-ABEND-PARAGRAPH       07591220
074000                                                                  07591320
074100     CALL XL071-LOCATION-MODULE USING  XL071-COMMAREA-REC.        07591420
074200                                                                  07591520
074300     EVALUATE TRUE                                                07591620
074400         WHEN XL071-NO-ERRORS                                     07591720
074500         WHEN XL071-LOC-NOT-FOUND                                 07591920
074600         WHEN XL071-DC-ASGMT-NOT-FND                              07592020
074700             CONTINUE                                             07592120
074800         WHEN OTHER                                               07592220
074900             MOVE XL071-SQLCA         TO SQLCA                    07592320
075000             DISPLAY '** ABEND **         ** = ' 'XLKUT071'       07592420
075100             DISPLAY '** PROGRAM   ** = ' 'RCKRP029'              07592520
075200             DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH      07592620
075300             DISPLAY '** OPERATION ** = ' ' SELECT XLT_LOC'       07592720
075400             DISPLAY '** SQLCODE FROM MOD ** = ' SQLCODE          07592820
075500             DISPLAY '** TABLE IN ERROR   ** = ' XL071-DB2-TABLE  07592920
075600             DISPLAY '** XLKUT071 RETURN  ** = ' XL071-RETURN-CODE07593020
075700             PERFORM 9900-DB2-ABEND                               07593120
075800     END-EVALUATE.                                                07593220
075900/                                                                 07594020
076000******************************************************************07600001
076100*  ABEND ROUTINE                                                 *07610001
076200******************************************************************07620001
076300 9900-DB2-ABEND.                                                  07630001
076400                                                                  07640001
076500     MOVE SQLCODE TO PV-SQLCODE.                                  07650001
076600     DISPLAY '*** DB2 ERROR '.                                    07660001
076700     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       07670001
076800     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 07680001
076900     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               07690001
077000     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               07700001
077100     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       07710001
077200     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       07720001
077300     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             07730001
077400                                                                  07740001
077500     COPY DPPD004.                                                07750001
077600                                                                  07760001
077700     MOVE +4013 TO PV-ABEND-CODE.                                 07770001
077800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07780001
077900                                                                  07790001
078000******************************************************************07800001
078100******************************************************************07810001
