000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS588.                                         00040000
000500 AUTHOR.        LARRY SCHLEICHER.                                 00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  DEC, 2001.                                        00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------------*00090000
001000*    S588 - SYSTEM GENERATED AND MANUALLY CREATED AUDITS         *00100000
001100*           CRITERIA SPECIFICATION                               *00110000
001200*                                                                *00120000
001300*    THIS PROGRAM ALLOWS THE USER ENTER DATA TO BE USED BY       *00130000
001400*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00140000
001500*    DETAIL SCREEN.  THE PACKAGE INFO, THE OPER UNIT, AUDIT      *00150000
001600*    NUMBER OR THE CONTAINER ID ARE ENTERED.  THE ENTERED FIELDS *00160000
001700*    ARE VALIDATED.                                              *00170000
001800*----------------------------------------------------------------*00180000
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00182001
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00183001
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00184001
001130*                                                                 00184102
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00184202
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00184302
263968*---------------------------------------------------------------* 00185001
001900                                                                  00190000
002000                                                                  00200000
002100 ENVIRONMENT DIVISION.                                            00210000
002200                                                                  00220000
002300 DATA DIVISION.                                                   00230000
002400                                                                  00240000
002500 WORKING-STORAGE SECTION.                                         00250000
002600*                                                                 00260000
002700 01  PC-PROGRAM-CONSTANTS.                                        00270000
002800     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'SU588A  '. 00280000
002900     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'SUKM588 '. 00290000
003000     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'SUKCS588'. 00300000
003100     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE  'DPKUT500'. 00310000
003200     05  PC-DC                     PIC  X(02)  VALUE  'DC'.       00320000
003300     05  PC-A                      PIC  X(01)  VALUE  'A'.        00330000
003400     05  PC-N                      PIC  X(01)  VALUE  'N'.        00340000
003500     05  PC-MAX-DATE               PIC  X(10)  VALUE '9999-09-09'.00350000
003600     05  PC-ALL-DISTRIB-CNTRS      PIC  X(30)  VALUE              00360000
003700                   'ALL DISTRIBUTION CENTERS'.                    00370000
003800     05  PC-DFLT-AUD-TYPE          PIC  X(01)  VALUE 'B'.         00380000
003900     05  PC-DFLT-AUD-STAT          PIC  X(01)  VALUE 'A'.         00390000
004000******************************************************************00400000
004100* SYSTEM MESSAGES                                                *00410000
004200******************************************************************00420000
004300* 00005 - INVALID VALUE                                          *00430000
004400* 00007 - REQUIRED ENTRY                                         *00440000
004500* 00008 - MUST BE NUMERIC                                        *00450000
004600* 00009 - INVALID DATE                                           *00460000
004700* 00489 - CHECK DEPARTMENT  -  REQUESTED VENDOR NOT FOUND FOR THE*00470000
004800* 02221 - PULL CREATE -FROM DATE- MUST BE PRIOR TO THE -TO       *00480000
004900* 01202 - THE HIGHLIGHTED FIELDS ARE MUTUALLY EXCLUSIVE (ENTER   *00490000
005000* 02572 - INVALID VALUE - OPER UNIT ID MUST BE A DC LOCATION     *00500000
005100* 02844 - YOU DO NOT HAVE THE AUTHORITY TO UPDATE RANK           *00510000
005200* 02850 - INVALID VENDOR ID                                      *00520000
005300* 02863 - FROM DATE MUST BE BEFORE TO DATE                       *00530000
005400* 02916 - NOT A VALID FIELD FOR FUNCTION                         *00540000
005500* 02917 - MULTIPLE AUDITS EXISTS FOR CARTON ID USE LIST SCREEN   *00550000
005600******************************************************************00560000
005700     05  PC-TSYMSG-NUMBERS.                                       00570000
005800         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00580000
005900         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00590000
006000         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00600000
006100         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      00610000
006200         10  PC-TSYMSG-00489       PIC  9(05)  VALUE  00489.      00620000
006300         10  PC-TSYMSG-02221       PIC  9(05)  VALUE  02221.      00630000
006400         10  PC-TSYMSG-01202       PIC  9(05)  VALUE  01202.      00640000
006500         10  PC-TSYMSG-02572       PIC  9(05)  VALUE  02572.      00650000
006600         10  PC-TSYMSG-02844       PIC  9(05)  VALUE  02844.      00660000
006700         10  PC-TSYMSG-02850       PIC  9(05)  VALUE  02850.      00670000
006800         10  PC-TSYMSG-02863       PIC  9(05)  VALUE  02863.      00680000
006900         10  PC-TSYMSG-02916       PIC  9(05)  VALUE  02916.      00690000
007000         10  PC-TSYMSG-02917       PIC  9(05)  VALUE  02917.      00700000
007100         10  PC-TSYMSG-02918       PIC  9(05)  VALUE  02918.      00710000
007200*                                                                 00720000
007300/                                                                 00730000
007400 01  DK-DB2-KEYS.                                                 00740000
007500     05  DK-ENT-ID                    PIC S9(09) COMP VALUE +0.   00750000
007510     05  DK-AUD-CNTL-NBR              PIC S9(09) COMP.            00751000
007600     05  DK-DEPT-NBR                  PIC  X(03) VALUE SPACES.    00760000
007700     05  DK-OPER-UNIT                 PIC S9(04) COMP VALUE +0.   00770000
007800     05  DK-PO-NBR                    PIC S9(09) COMP VALUE +0.   00780000
007900     05  DK-CRTN-ID                   PIC S9(18)V COMP-3          00790000
008000                                                    VALUE ZEROES. 00800000
008100                                                                  00810000
008200*----------------------------------------------------------------*00820000
008300*   PROGRAM VARIABLES                                            *00830000
008400*----------------------------------------------------------------*00840000
008500 01  PV-PROGRAM-VARIABLES.                                        00850000
008600                                                                  00860000
008610     05  PV-DISP-AUDIT             PIC 9(09).                     00861000
008700     05  PV-FROM-DATE-HOLD.                                       00870000
008800         10  PV-FROM-YY            PIC  9(04)  VALUE ZEROES.      00880000
008900         10  PV-FROM-MM            PIC  9(02)  VALUE ZEROES.      00890000
009000         10  PV-FROM-DD            PIC  9(02)  VALUE ZEROES.      00900000
009100                                                                  00910000
009200     05  PV-TO-DATE-HOLD.                                         00920000
009300         10  PV-TO-YY              PIC  9(04)  VALUE ZEROES.      00930000
009400         10  PV-TO-MM              PIC  9(02)  VALUE ZEROES.      00940000
009500         10  PV-TO-DD              PIC  9(02)  VALUE ZEROES.      00950000
009600                                                                  00960000
009700     05  PV-SUB1                         PIC S9(4) COMP SYNC.     00970000
009800     05  PV-SUB2                         PIC S9(4) COMP SYNC.     00980000
009900                                                                  00990000
010000     05  PV-INPUT-FIELD                  PIC X(18).               01000000
010100     05  FILLER REDEFINES PV-INPUT-FIELD.                         01010000
010200         10  PV-INPUT-BYTES OCCURS 18 TIMES.                      01020000
010300             15  PV-IN-BYTE              PIC X(01).               01030000
010400                                                                  01040000
010500     05  PV-OUTPUT-FIELD                 PIC X(18).               01050000
010600     05  FILLER REDEFINES PV-OUTPUT-FIELD.                        01060000
010700         10  PV-OUTPUT-BYTE OCCURS 18 TIMES.                      01070000
010800             15  PV-OUT-BYTE             PIC X(01).               01080000
010900*----------------------------------------------------------------*01090000
011000*   SWITCHES                                                     *01100000
011100*----------------------------------------------------------------*01110000
011200 01  PS-PROGRAM-SWITCHES.                                         01120000
011211     05  PS-SYS-GEN-AUDIT-SW       PIC  X(01)  VALUE  ' '.        01121100
011220         88  PS-SYS-GEN-AUDIT                  VALUE  'Y'.        01122000
011240         88  PS-NOT-SYS-GEN-AUDIT              VALUE  'N'.        01124000
011510     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01151000
011520         88  PS-ERROR                          VALUE  'Y'.        01152000
011530         88  PS-NO-ERROR                       VALUE  'N'.        01153000
011600     05  PS-DATE-ERROR-SW          PIC  X(01)  VALUE  'N'.        01160000
011700         88  PS-DATE-ERROR                     VALUE  'Y'.        01170000
011800         88  PS-NO-DATE-ERROR                  VALUE  'N'.        01180000
011900     05  PS-NUM-ERROR-SW           PIC  X(01)  VALUE  'N'.        01190000
012000         88  PS-NUM-ERROR                      VALUE  'Y'.        01200000
012100         88  PS-NO-NUM-ERROR                   VALUE  'N'.        01210000
012200     05  PS-ENT-ID-FOUND-SW        PIC  X(01)  VALUE  'N'.        01220000
012300         88  PS-ENT-ID-FOUND                   VALUE  'Y'.        01230000
012400         88  PS-NO-ENT-ID-FOUND                VALUE  'N'.        01240000
012500     05  PS-PO-FOUND-SW            PIC  X(01)  VALUE  'N'.        01250000
012600         88  PS-PO-FOUND                       VALUE  'Y'.        01260000
012700         88  PS-NO-PO-FOUND                    VALUE  'N'.        01270000
012800     05  PS-DEPT-FOUND-SW          PIC  X(01)  VALUE  'N'.        01280000
012900         88  PS-DEPT-FOUND                     VALUE  'Y'.        01290000
013000         88  PS-NO-DEPT-FOUND                  VALUE  'N'.        01300000
013100     05  PS-ACCESS-SW              PIC  X(01)  VALUE  'N'.        01310000
013200         88  PS-ACCESS-ALLOWED                 VALUE  'Y'.        01320000
013300         88  PS-ACCESS-NOT-ALLOWED             VALUE  'N'.        01330000
013400     05  PS-OPER-UNIT-FOUND-SW     PIC  X(01)  VALUE  'N'.        01340000
013500         88  PS-OPER-UNIT-FOUND                VALUE  'Y'.        01350000
013600         88  PS-OPER-UNIT-NOT-FOUND            VALUE  'N'.        01360000
013700                                                                  01370000
013800 01  PM-PROGRAM-MESSAGES.                                         01380000
013900     05  PM-ABEND-INFO-A.                                         01390000
014000         10  FILLER                PIC X(15)   VALUE              01400000
014100                                   'DP020-SRC-AID: '.             01410000
014200         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01420000
014300         10  FILLER                PIC X(19)   VALUE              01430000
014400                                   '. DP020-FK-ACTION: '.         01440000
014500         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01450000
014600         10  FILLER                PIC X(22)   VALUE              01460000
014700                                   '. DP020-FK-DISPN-IND: '.      01470000
014800         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      01480000
014900         10  FILLER                PIC X(01)   VALUE '.'.         01490000
015000         10  FILLER                PIC X(19)   VALUE SPACE.       01500000
015100                                                                  01510000
015200                                                                  01520000
015300*----------------------------------------------------------------*01530000
015400*    MAP LAYOUT                                                  *01540000
015500*----------------------------------------------------------------*01550000
015600                                                                  01560000
015700     COPY SUKM588.                                                01570000
015800     EJECT                                                        01580000
015900*----------------------------------------------------------------*01590000
016000*    CALENDAR ROUTINE                                            *01600000
016100*----------------------------------------------------------------*01610000
016200     COPY DPWS500.                                                01620000
016300                                                                  01630000
016400*----------------------------------------------------------------*01640000
016500*    ATTRIBUTE SETTINGS COPYBOOK.                                *01650000
016600*----------------------------------------------------------------*01660000
016700                                                                  01670000
016800     COPY DPWS015.                                                01680000
016900                                                                  01690000
017000*----------------------------------------------------------------*01700000
017100*    FUNCTION KEYS COPYBOOK                                      *01710000
017200*----------------------------------------------------------------*01720000
017300                                                                  01730000
017400*----------------------------------------------------------------*01740000
017500**  SECURITY SUBROUTINE PARAMETERS                                01750000
017600*----------------------------------------------------------------*01760000
017700     COPY DPWS008.                                                01770000
017800                                                                  01780000
017900     COPY DPWS016.                                                01790000
018000 EJECT                                                            01800000
018100/                                                                 01810000
018110*----------------------------------------------------------------*01811000
018120*    DB2 DCLGEN FOR THE VENDOR PO AUDIT REQUEST TABLE             01812000
018130*    (SUT_PO_AUD_REQ)                                             01813000
018140*----------------------------------------------------------------*01814000
018150     EXEC SQL                                                     01815000
018160          INCLUDE SUT00015                                        01816000
018170     END-EXEC.                                                    01817000
018180                                                                  01818000
018200*    AUDIT MASTER                                                 01820000
018300     EXEC SQL                                                     01830000
018400          INCLUDE TSUNAUD                                         01840000
018500     END-EXEC.                                                    01850000
018600*----------------------------------------------------------------*01860000
018700*    DB2 DCLGEN FOR THE EXTERNAL ENTERPRISE TABLE                 01870000
018800*----------------------------------------------------------------*01880000
018900     EXEC SQL                                                     01890000
019000          INCLUDE TEXTENT                                         01900000
019100     END-EXEC.                                                    01910000
019200*----------------------------------------------------------------*01920000
019300*    DB2 DCLGEN FOR THE ENTERPRISE NAME TABLE                     01930000
019400*----------------------------------------------------------------*01940000
019500     EXEC SQL                                                     01950000
019600          INCLUDE TENTNME                                         01960000
019700     END-EXEC.                                                    01970000
019800                                                                  01980000
019900*---------------------------------------------------------------* 01990000
020000*  DCLGEN FOR THE DB2 DEPARTMENT TABLE                            02000000
020100*---------------------------------------------------------------* 02010000
020200     EXEC SQL                                                     02020000
020300         INCLUDE TVNDDPT                                          02030000
020400     END-EXEC.                                                    02040000
020500*----------------------------------------------------------------*02050000
020600*    DB2 DCLGEN FOR THE MERCHANDISE AREA TABLE                    02060000
020700*----------------------------------------------------------------*02070000
020800     EXEC SQL                                                     02080000
020900          INCLUDE TMDSEAR                                         02090000
021000     END-EXEC.                                                    02100000
021100                                                                  02110000
021900*---------------------------------------------------------------* 02190000
022000*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 02200000
022100*---------------------------------------------------------------* 02210000
022200     EXEC SQL                                                     02220000
022300          INCLUDE TPURCHS                                         02230000
022400     END-EXEC.                                                    02240000
022500                                                                  02250000
022600*---------------------------------------------------------------* 02260000
022700*    DB2 AREA FOR THE SHIP UNIT AUDIT TRAN TABLE                * 02270000
022800*---------------------------------------------------------------* 02280000
022900     EXEC SQL                                                     02290000
023000          INCLUDE TSUATRN                                         02300000
023100     END-EXEC.                                                    02310000
023200                                                                  02320000
022600*---------------------------------------------------------------* 02321000
022700*    DB2 AREA FOR THE LOCATION TABLE                              02322000
022800*---------------------------------------------------------------* 02323000
022900     EXEC SQL                                                     02324000
023000          INCLUDE XLT00010                                        02325000
023100     END-EXEC.                                                    02326000
023200                                                                  02327000
023300*----------------------------------------------------------------*02330000
023400*    DB2 SQL COMMUNICATION AREA                                   02340000
023500*----------------------------------------------------------------*02350000
023600     EXEC SQL                                                     02360000
023700          INCLUDE SQLCA                                           02370000
023800     END-EXEC.                                                    02380000
023900                                                                  02390000
024000******************************************************************02400000
024100** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02410000
024200** SUB-ROUTINE (DPKUT100).                                      **02420000
024300******************************************************************02430000
024400     COPY DPWS010I.                                               02440000
024500                                                                  02450000
024600******************************************************************02460000
024800** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **02480002
024900******************************************************************02490000
025000     COPY DPWS030.                                                02500000
025000     COPY DPWS930.                                                02501002
025100                                                                  02510000
025200***************************************************************** 02520000
025300*    STANDARD COMMAREA.                                           02530000
025400***************************************************************** 02540000
025500                                                                  02550000
025600     COPY DPWS020.                                                02560000
025700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02570000
025800                                                                  02580000
025900***************************************************************** 02590000
026000*    INTER-APPLICATION COMMAREA.                                  02600000
026100***************************************************************** 02610000
026200                                                                  02620000
026300         10  INTER-APPL-COMM-AREA PIC X(200).                     02630000
026400     COPY SUWS023.                                                02640000
026500***************************************************************** 02650000
026600*    SPECIFIC COMMMAREA FOR SUKCS588.                             02660000
026700***************************************************************** 02670000
026800         10  ASC-SPECIFIC-COMMAREA.                               02680000
026900             15  ASC-AUDIT-TYPE                  PIC  X(01).      02690000
027000             15  ASC-AUDIT-STATUS                PIC  X(01).      02700000
027100             15  ASC-OPER-UNIT-ID.                                02710000
027200                 20  ASC-OPER-UNIT-ID-N          PIC  9(04).      02720000
027300             15  ASC-FROM-DATE-MM.                                02730000
027400                 20  ASC-FROM-DATE-MM-N          PIC  9(02).      02740000
027500             15  ASC-FROM-DATE-DD.                                02750000
027600                 20  ASC-FROM-DATE-DD-N          PIC  9(02).      02760000
027700             15  ASC-FROM-DATE-YY.                                02770000
027800                 20  ASC-FROM-DATE-YY-N          PIC  9(04).      02780000
027900             15  ASC-TO-DATE-MM.                                  02790000
028000                 20  ASC-TO-DATE-MM-N            PIC  9(02).      02800000
028100             15  ASC-TO-DATE-DD.                                  02810000
028200                 20  ASC-TO-DATE-DD-N            PIC  9(02).      02820000
028300             15  ASC-TO-DATE-YY.                                  02830000
028400                 20  ASC-TO-DATE-YY-N            PIC  9(04).      02840000
028500             15  ASC-AUDIT-NUMBER.                                02850000
028600                 20  ASC-AUDIT-NUMBER-N          PIC  9(09).      02860000
028700             15  ASC-CARTON-ID                   PIC  X(18).      02870000
028800             15  ASC-CARTON-ID-N REDEFINES                        02880000
028900                 ASC-CARTON-ID                   PIC  9(18).      02890000
029000             15  ASC-CRTN-AUDIT.                                  02900000
029100                 20  ASC-CRTN-AUDIT-N            PIC  Z(09).      02910000
029200             15  FILLER                          PIC  X(2807).    02920000
029300     EJECT                                                        02930000
029400*----------------------------------------------------------------*02940000
029500*    ABEND PROCESSING COPYBOOK.                                  *02950000
029600*----------------------------------------------------------------*02960000
029700                                                                  02970000
029800     COPY DPWS013.                                                02980000
029900                                                                  02990000
030000                                                                  03000000
030100 EJECT                                                            03010000
030200 LINKAGE SECTION.                                                 03020000
030300                                                                  03030000
030400 01  DFHCOMMAREA.                                                 03040000
030500     05  FILLER                         OCCURS  1 TO 4072 TIMES   03050000
030600                                        DEPENDING ON EIBCALEN.    03060000
030700         10  FILLER                     PIC X.                    03070000
030800                                                                  03080000
030900                                                                  03090000
031000 PROCEDURE DIVISION.                                              03100000
031100***************************************************************** 03110000
031200** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03120000
031300** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03130000
031400** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03140000
031500**                                                             ** 03150000
031600** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03160000
031700** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03170000
031800***************************************************************** 03180000
031900 0000-MAIN-MODULE.                                                03190000
032000     INITIALIZE DP030-CICS-API-FIELDS.                            03200000
032100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03210000
032200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03220000
032300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03230000
032400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03240000
032500     MOVE LENGTH OF SU588AI        TO DP030-MAP-LENGTH (1).       03250000
032600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03260000
032700     PERFORM 0001-CALL-CICS-ARCH-API.                             03270000
032800*                                                                 03280000
032900     PERFORM 1000-CONTROL-PROCESSING                              03290000
033000*                                                                 03300000
033100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03310000
033200     PERFORM 0001-CALL-CICS-ARCH-API.                             03320000
033300                                                                  03330000
033400 0001-CALL-CICS-ARCH-API.                                         03340000
033500*    CALL 'DPKCS030' USING DFHEIBLK                               03350002
033500     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03351002
033600                           DFHCOMMAREA                            03360000
033700                           DP030-CICS-API-FIELDS                  03370000
033800                           DP020-STANDARD-COMMAREA                03380000
033900                           SU588AI.                               03390000
034000*                                                                 03400000
034100     IF  DP030-RC-CALL-SUCCESSFUL                                 03410000
034200         CONTINUE                                                 03420000
034300     ELSE                                                         03430000
034400         SET DP013-NO-ROLLBACK                                    03440000
034500             DP013-XCTL-DISPLAY-RESTART                           03450000
034600             DP013-CICS-ABEND      TO TRUE                        03460000
034700         MOVE 'BEFORE 0000-MAIN-MODULE'                           03470000
034800                                   TO DP013-PARAGRAPH             03480000
034900*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX03490002
035000*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      03500002
034900         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03501002
035000-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03502002
035100         MOVE DP030-RETURN-CODE                                   03510000
035200                                   TO DP013-MESSAGE-TEXT (3)      03520000
035300         PERFORM DP013-0000-PROCESS-ABEND                         03530000
035400     END-IF.                                                      03540000
035500 EJECT                                                            03550000
035600*----------------------------------------------------------------*03560000
035700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03570000
035800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03580000
035900*----------------------------------------------------------------*03590000
036000                                                                  03600000
036100 1000-CONTROL-PROCESSING.                                         03610000
036200                                                                  03620000
036300     EVALUATE TRUE                                                03630000
036400         WHEN DP020-NEXT-ACT-INITIAL                              03640000
036500             INITIALIZE ASC-SPECIFIC-COMMAREA                     03650000
036600             PERFORM 4000-BUILD-INITIAL-PANEL                     03660000
036700             PERFORM 3200-RESET-ATTRIBUTES                        03670000
036800                                                                  03680000
036900         WHEN DP020-NEXT-ACT-READ-MAP                             03690000
037000             PERFORM 2000-FKEY-PROCESSING                         03700000
037100                                                                  03710000
037200         WHEN DP020-NEXT-ACT-RETURN                               03720000
037300             INITIALIZE ASC-SPECIFIC-COMMAREA                     03730000
037400             PERFORM 4000-BUILD-INITIAL-PANEL                     03740000
037500             PERFORM 3200-RESET-ATTRIBUTES                        03750000
037600*LMM         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03760000
037700*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03770000
037800*            SET DP030-SET-CURSOR-APPL-1   TO TRUE                03780000
037900*            MOVE -1               TO AAUDTYPL                    03790000
038000                                                                  03800000
038100         WHEN OTHER                                               03810000
038200             SET DP013-LOGIC-ABEND                                03820000
038300                 DP013-NO-ROLLBACK TO TRUE                        03830000
038400             MOVE '1000-CONTROL-PROCESSING'                       03840000
038500                                   TO  DP013-PARAGRAPH            03850000
038600             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03860000
038700                                   TO  DP013-MESSAGE-TEXT(1)      03870000
038800             MOVE DP020-NEXT-APPL-ACTIVITY                        03880000
038900                                   TO DP013-MESSAGE-TEXT(2)       03890000
039000             PERFORM DP013-0000-PROCESS-ABEND                     03900000
039100     END-EVALUATE.                                                03910000
039200                                                                  03920000
039300*----------------------------------------------------------------*03930000
039400* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*03940000
039500* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*03950000
039600* EDITS.                                                         *03960000
039700*----------------------------------------------------------------*03970000
039800                                                                  03980000
039900 2000-FKEY-PROCESSING.                                            03990000
040000                                                                  04000000
040100     EVALUATE TRUE                                                04010000
040200                                                                  04020000
040300         WHEN DP020-SRC-AID = DP016-CLEAR                         04030000
040400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04040000
040500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04050000
040600                                                                  04060000
040700         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     04070000
040800             INITIALIZE ASC-SPECIFIC-COMMAREA                     04080000
040900             PERFORM 4000-BUILD-INITIAL-PANEL                     04090000
041000             PERFORM 3200-RESET-ATTRIBUTES                        04100000
041100                                                                  04110000
041200         WHEN OTHER                                               04120000
041300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04130000
041400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04140000
041500             IF  PS-NO-ERROR                                      04150000
041600                 PERFORM 2100-CHECK-FUNCTION-KEY                  04160000
041700                 IF  PS-NO-ERROR                                  04170000
041800                     SET DP030-CONTINUE-GO TO TRUE                04180000
041900                 ELSE                                             04190000
042000                     SET DP030-OVERRIDE-GO TO TRUE                04200000
042100                 END-IF                                           04210000
042200             ELSE                                                 04220000
042300                 SET DP030-OVERRIDE-GO TO TRUE                    04230000
042400             END-IF                                               04240000
042500     END-EVALUATE.                                                04250000
042600******************************************************************04260000
042700** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **04270000
042800** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **04280000
042900** FROM THE CICS ARCHITECTURE API.                              **04290000
043000******************************************************************04300000
043100 2100-CHECK-FUNCTION-KEY.                                         04310000
043200     EVALUATE TRUE                                                04320000
043300         WHEN DP020-SRC-AID = DP016-ENTER                         04330000
043310             MOVE -1                  TO AAUDTYPL                 04331000
043500                                                                  04350000
043600* F17 - AUDIT CARTON DETAIL LIST  (LOCAL-FUNC-01)                 04360000
043700*                                                                 04370000
043800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              04380000
043900             IF ASC-CARTON-ID        = SPACES OR ZEROS            04390000
044000                 INITIALIZE SU023-INTER-APPL-COMMAREA             04400000
044100                 SET PS-ERROR                                     04410000
044200                     DP020-MSG-FATAL  TO TRUE                     04420000
044300                 MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER         04430000
044400                 MOVE DP015-UNP-ALP-BRT-OFF                       04440000
044500                                      TO ACARTONA                 04450000
044600                 MOVE DP015-RED       TO ACARTONC                 04460000
044700                 MOVE DP015-REVERSE   TO ACARTONH                 04470000
044800                 MOVE -1              TO ACARTONL                 04480000
044900                 SET DP030-SET-CURSOR-APPL-1                      04490000
045000                                      TO TRUE                     04500000
045100                 SET DP030-OVERRIDE-GO TO TRUE                    04510000
045200             ELSE                                                 04520000
045300                 IF  ASC-CARTON-ID-N    > 0  AND                  04530000
045400                     ASC-CRTN-AUDIT-N  <= 0                       04540000
045500                     PERFORM 3150-GET-CRTN-AUDT                   04550000
045600                 END-IF                                           04560000
045610                 IF ASC-CRTN-AUDIT-N  > 0                         04561000
045611                     MOVE ASC-CRTN-AUDIT-N  TO DK-AUD-CNTL-NBR    04561100
045620                     PERFORM 3170-CHECK-IF-SYS-GENERATED          04562000
045630                 END-IF                                           04563000
045700                 PERFORM 2110-PREPARE-INTER-APPL-COMM             04570000
045800             END-IF                                               04580000
045900                                                                  04590000
046000                                                                  04600000
046100* F18 - SYSTEM AUDIT  (LOCAL-FUNC-02)                             04610000
046200*                                                                 04620000
046300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              04630000
046400             CONTINUE                                             04640000
046500                                                                  04650000
046600* F23 - AUDIT RESULT LIST  (LOCAL-FUNC-03)                        04660000
046700*                                                                 04670000
046800         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              04680000
046900             EVALUATE TRUE                                        04690000
047000                 WHEN ASC-AUDIT-TYPE   = SPACES AND               04700000
047100                      ASC-AUDIT-STATUS = SPACES                   04710000
047200                      SET  PS-ERROR                               04720000
047300                           DP020-MSG-FATAL TO TRUE                04730000
047400                      MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER    04740000
047500                      MOVE DP015-UNP-ALP-BRT-OFF                  04750000
047600                                            TO AAUDTYPA           04760000
047700                                               AAUDSTAA           04770000
047800                      MOVE DP015-RED        TO AAUDTYPC           04780000
047900                                               AAUDSTAC           04790000
048000                      MOVE DP015-REVERSE    TO AAUDTYPH           04800000
048100                                               AAUDSTAH           04810000
048200                      MOVE -1               TO AAUDTYPL           04820000
048300                                               AAUDSTAL           04830000
048400                      SET  DP030-SET-CURSOR-APPL-1 TO TRUE        04840000
048500                      SET  DP030-OVERRIDE-GO       TO TRUE        04850000
048600                                                                  04860000
048700                 WHEN ASC-AUDIT-TYPE = SPACES                     04870000
048800                      SET  PS-ERROR                               04880000
048900                           DP020-MSG-FATAL TO TRUE                04890000
049000                      MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER    04900000
049100                      MOVE DP015-UNP-ALP-BRT-OFF                  04910000
049200                                            TO AAUDTYPA           04920000
049300                      MOVE DP015-RED        TO AAUDTYPC           04930000
049400                      MOVE DP015-REVERSE    TO AAUDTYPH           04940000
049500                      MOVE -1               TO AAUDTYPL           04950000
049600                      SET  DP030-SET-CURSOR-APPL-1 TO TRUE        04960000
049700                      SET  DP030-OVERRIDE-GO       TO TRUE        04970000
049800                                                                  04980000
049900                 WHEN ASC-AUDIT-STATUS = SPACES                   04990000
050000                      SET  PS-ERROR                               05000000
050100                           DP020-MSG-FATAL TO TRUE                05010000
050200                      MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER    05020000
050300                      MOVE DP015-UNP-ALP-BRT-OFF                  05030000
050400                                            TO AAUDSTAA           05040000
050500                      MOVE DP015-RED        TO AAUDSTAC           05050000
050600                      MOVE DP015-REVERSE    TO AAUDSTAH           05060000
050700                      MOVE -1               TO AAUDSTAL           05070000
050800                      SET  DP030-SET-CURSOR-APPL-1 TO TRUE        05080000
050900                      SET  DP030-OVERRIDE-GO       TO TRUE        05090000
051000                                                                  05100000
051100                 WHEN ASC-OPER-UNIT-ID = SPACES AND               05110000
051200                      ASC-AUDIT-NUMBER = SPACES AND               05120000
051300                      ASC-CARTON-ID    = SPACES                   05130000
051400                      SET  PS-ERROR                               05140000
051500                           DP020-MSG-FATAL TO TRUE                05150000
051600                      MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER    05160000
051700                      MOVE DP015-UNP-ALP-BRT-OFF                  05170000
051800                                            TO AOPRUNTA           05180000
051900                      MOVE DP015-RED        TO AOPRUNTC           05190000
052000                      MOVE DP015-REVERSE    TO AOPRUNTH           05200000
052100                      MOVE -1               TO AOPRUNTL           05210000
052200                      SET  DP030-SET-CURSOR-APPL-1 TO TRUE        05220000
052300                      SET  DP030-OVERRIDE-GO       TO TRUE        05230000
052400                                                                  05240000
052500                 WHEN  ASC-AUDIT-NUMBER > SPACE  AND              05250000
052600                      (ASC-OPER-UNIT-ID > SPACE  OR               05260000
052700                       ASC-CARTON-ID    > SPACE)                  05270000
052800                       SET  PS-ERROR                              05280000
052900                            DP020-MSG-FATAL         TO TRUE       05290000
053000                       MOVE PC-TSYMSG-01202  TO DP020-MSG-NUMBER  05300000
053100                       MOVE -1               TO AAUDNBRL          05310000
053200                       MOVE DP015-RED        TO AAUDNBRC          05320000
053300                       IF  ASC-OPER-UNIT-ID  >  SPACE             05330000
053400                           MOVE -1           TO AOPRUNTL          05340000
053500                           MOVE DP015-RED    TO AOPRUNTC          05350000
053600                       END-IF                                     05360000
053700                       IF  ASC-CARTON-ID    >  SPACE              05370000
053800                           MOVE -1           TO ACARTONL          05380000
053900                           MOVE DP015-RED    TO ACARTONC          05390000
054000                       END-IF                                     05400000
054100                       SET  DP030-SET-CURSOR-APPL-1 TO TRUE       05410000
054200*                                                                 05420000
054300                 WHEN  ASC-OPER-UNIT-ID > SPACE  AND              05430000
054400                      (ASC-AUDIT-NUMBER > SPACE  OR               05440000
054500                       ASC-CARTON-ID    > SPACE)                  05450000
054600                       SET  PS-ERROR                              05460000
054700                            DP020-MSG-FATAL         TO TRUE       05470000
054800                       MOVE PC-TSYMSG-01202  TO DP020-MSG-NUMBER  05480000
054900                       MOVE -1               TO AOPRUNTL          05490000
055000                       MOVE DP015-RED        TO AOPRUNTC          05500000
055100                       IF  ASC-AUDIT-NUMBER > SPACE               05510000
055200                           MOVE -1           TO AAUDNBRL          05520000
055300                           MOVE DP015-RED    TO AAUDNBRC          05530000
055400                       END-IF                                     05540000
055500                       IF  ASC-CARTON-ID    >  SPACE              05550000
055600                           MOVE -1           TO ACARTONL          05560000
055700                           MOVE DP015-RED    TO ACARTONC          05570000
055800                       END-IF                                     05580000
055900                       SET  DP030-SET-CURSOR-APPL-1 TO TRUE       05590000
056000*                                                                 05600000
056100                 WHEN  ASC-CARTON-ID    > SPACE  AND              05610000
056200                      (ASC-OPER-UNIT-ID > SPACE  OR               05620000
056300                       ASC-AUDIT-NUMBER > SPACE)                  05630000
056400                       SET  PS-ERROR                              05640000
056500                            DP020-MSG-FATAL         TO TRUE       05650000
056600                       MOVE PC-TSYMSG-01202  TO DP020-MSG-NUMBER  05660000
056700                       MOVE -1               TO ACARTONL          05670000
056800                       MOVE DP015-RED        TO ACARTONC          05680000
056900                       IF  ASC-OPER-UNIT-ID  >  SPACE             05690000
057000                           MOVE -1           TO AOPRUNTL          05700000
057100                           MOVE DP015-RED    TO AOPRUNTC          05710000
057200                       END-IF                                     05720000
057300                       IF  ASC-AUDIT-NUMBER > SPACE               05730000
057400                           MOVE -1           TO AAUDNBRL          05740000
057500                           MOVE DP015-RED    TO AAUDNBRC          05750000
057600                       END-IF                                     05760000
057700                       SET  DP030-SET-CURSOR-APPL-1 TO TRUE       05770000
057800*                                                                 05780000
057900                                                                  05790000
058000                 WHEN OTHER                                       05800000
058010                   IF ASC-AUDIT-NUMBER-N > 0                      05801000
058020                       MOVE ASC-AUDIT-NUMBER-N TO DK-AUD-CNTL-NBR 05802000
058030                       PERFORM 3170-CHECK-IF-SYS-GENERATED        05803000
058040                   END-IF                                         05804000
058100                   PERFORM 2110-PREPARE-INTER-APPL-COMM           05810000
058700             END-EVALUATE                                         05870000
058800                                                                  05880000
058900         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              05890000
058910             IF ASC-AUDIT-NUMBER-N > 0                            05891000
058920                 MOVE ASC-AUDIT-NUMBER-N TO DK-AUD-CNTL-NBR       05892000
058930                 PERFORM 3170-CHECK-IF-SYS-GENERATED              05893000
058940             END-IF                                               05894000
059000             PERFORM 2110-PREPARE-INTER-APPL-COMM                 05900000
059100         WHEN OTHER                                               05910000
059200             SET DP013-NO-ROLLBACK                                05920000
059300                 DP013-XCTL-DISPLAY-RESTART                       05930000
059400                 DP013-CICS-ABEND  TO TRUE                        05940000
059500             MOVE '2100-CHECK-FUNCTION-KEY'                       05950000
059600                                   TO DP013-PARAGRAPH             05960000
059700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      05970000
059800                                   TO DP013-MESSAGE-TEXT (1)      05980000
059900             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 05990000
060000                                   TO DP013-MESSAGE-TEXT (2)      06000000
060100             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                06010000
060200             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 06020000
060300                                   TO PM-A-FK-ACTION              06030000
060400             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              06040000
060500                                   TO PM-A-FK-DISPN               06050000
060600             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      06060000
060700             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        06070000
060800                                   TO DP013-MESSAGE-TEXT (4)      06080000
060900             PERFORM DP013-0000-PROCESS-ABEND                     06090000
061000     END-EVALUATE.                                                06100000
061100                                                                  06110000
061200*----------------------------------------------------------------*06120000
061300* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     06130000
061400*----------------------------------------------------------------*06140000
061500 2105-RACF-ACCESS.                                                06150000
061600                                                                  06160000
061700      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  06170000
061800      SET DP008-ACCESS-TYPE-USE          TO TRUE                  06180000
061900                                                                  06190000
062000      EXEC CICS                                                   06200000
062100         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 06210000
062200              COMMAREA (DP008-SECURITY-COMMAREA)                  06220000
062300              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             06230000
062400      END-EXEC                                                    06240000
062500                                                                  06250000
062600      IF DP008-CALL-SUCCESSFUL                                    06260000
062700         IF DP008-ACCESS-ALLOWED                                  06270000
062800             SET PS-ACCESS-ALLOWED TO TRUE                        06280000
062900         ELSE                                                     06290000
063000             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    06300000
063100         END-IF                                                   06310000
063200     ELSE                                                         06320000
063300         MOVE '2105-RACF-ACCESS'                                  06330000
063400                               TO DP013-PARAGRAPH                 06340000
063500          MOVE 'UNABLE TO ACCESS CICS'                            06350000
063600                               TO DP013-MESSAGE-TEXT (1)          06360000
063700          MOVE SQLCA                 TO DP013-SQLCA               06370000
063800          SET DP013-DB2-ABEND                                     06380000
063900              DP013-XCTL-DISPLAY-RESTART                          06390000
064000                               TO TRUE                            06400000
064100          PERFORM DP013-0000-PROCESS-ABEND                        06410000
064200      END-IF.                                                     06420000
064300                                                                  06430000
064400******************************************************************06440000
064500** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **06450000
064600** INTER-APPLICATION COMMAREA.                                  **06460000
064700******************************************************************06470000
064800 2110-PREPARE-INTER-APPL-COMM.                                    06480000
064900     INITIALIZE SU023-INTER-APPL-COMMAREA.                        06490000
064920     IF PS-SYS-GEN-AUDIT                                          06492000
064930         SET SU023-SYSTEM   TO TRUE                               06493000
064931         MOVE SUT00015-AUD-STAT-CDE   TO SU023-PROCESS-STATUS     06493100
064932         IF ASC-OPER-UNIT-ID-N = 0 OR                             06493200
064933            ASC-OPER-UNIT-ID = SPACES                             06493300
064934             MOVE SUT00015-OPER-UNT-ID  TO SU023-OPER-UNIT-ID-N   06493400
064935         ELSE                                                     06493500
064936             MOVE ASC-OPER-UNIT-ID-N    TO SU023-OPER-UNIT-ID-N   06493600
064937         END-IF                                                   06493700
064940         MOVE SUT00015-PO-NBR           TO SU023-PO               06494000
064941         MOVE SUT00015-RCVR-SEQ-NBR     TO SU023-RECEIVER-SEQ     06494100
064942     ELSE                                                         06494200
064943         IF ASC-CRTN-AUDIT-N  > 0 OR                              06494300
064944            ASC-AUDIT-NUMBER-N > 0                                06494400
064945             IF ASC-CRTN-AUDIT-N  > 0                             06494500
064946                 MOVE ASC-CRTN-AUDIT-N  TO SUNAUD-AUD-CNTL-NBR    06494600
064947             ELSE                                                 06494700
064948                 MOVE ASC-AUDIT-NUMBER-N TO SUNAUD-AUD-CNTL-NBR   06494800
064949             END-IF                                               06494900
064950             PERFORM 7000-SELECT-TSUNAUD                          06495000
064951             EVALUATE TRUE                                        06495100
064952                WHEN SUNAUD-AUD-STAT-CDE = 'IP'                   06495200
064953                     SET SU023-IN-PROCESS  TO TRUE                06495300
064954                WHEN SUNAUD-AUD-STAT-CDE = 'PP'                   06495400
064955                     SET SU023-IN-PROCESS  TO TRUE                06495500
064956                WHEN SUNAUD-AUD-STAT-CDE = 'CM'                   06495600
064957                     MOVE 'R' TO SU023-PROCESS-STATUS             06495700
064958             END-EVALUATE                                         06495800
064959             IF ASC-OPER-UNIT-ID-N = 0 OR                         06495900
064960                ASC-OPER-UNIT-ID = SPACES                         06496000
064961                 MOVE SUNAUD-OPER-UNT-ID  TO SU023-OPER-UNIT-ID-N 06496100
064962             ELSE                                                 06496200
064963                 MOVE ASC-OPER-UNIT-ID-N  TO SU023-OPER-UNIT-ID-N 06496300
064964             END-IF                                               06496400
064965         END-IF                                                   06496500
064966         IF PS-NOT-SYS-GEN-AUDIT OR                               06496600
064967            ASC-AUDIT-TYPE = 'M'                                  06496700
064969             SET SU023-MANUAL   TO TRUE                           06496900
064970         ELSE                                                     06497000
064975             SET SU023-ALL      TO TRUE                           06497500
064980         END-IF                                                   06498000
064981         IF SU023-OPER-UNIT-ID-N = 0                              06498100
064982             IF ASC-OPER-UNIT-ID-N = 0 OR                         06498200
064983                ASC-OPER-UNIT-ID = SPACES                         06498300
064984                 MOVE 0                    TO SU023-OPER-UNIT-ID-N06498400
064985             ELSE                                                 06498500
064986                 MOVE ASC-OPER-UNIT-ID-N   TO SU023-OPER-UNIT-ID-N06498600
064987             END-IF                                               06498700
064988         END-IF                                                   06498800
064989         MOVE SUATRN-TRN-NBR            TO SU023-PO               06498900
064990         MOVE SUATRN-REC-SEQ-NBR        TO SU023-RECEIVER-SEQ     06499000
064991     END-IF.                                                      06499100
064992     IF SU023-PROCESS-STATUS = ' '                                06499200
064993         MOVE ASC-AUDIT-STATUS  TO SU023-PROCESS-STATUS           06499300
064994     END-IF.                                                      06499400
065000     MOVE ASC-AUDIT-TYPE        TO SU023-AUDIT-TYPE.              06500000
065100     MOVE ASC-AUDIT-STATUS      TO SU023-AUDIT-STATUS.            06510000
065300     MOVE ASC-FROM-DATE-MM-N    TO SU023-FROM-DATE-MM.            06530000
065400     MOVE ASC-FROM-DATE-DD-N    TO SU023-FROM-DATE-DD.            06540000
065500     MOVE ASC-FROM-DATE-YY-N    TO SU023-FROM-DATE-YY.            06550000
065600     MOVE ASC-TO-DATE-MM-N      TO SU023-TO-DATE-MM.              06560000
065700     MOVE ASC-TO-DATE-DD-N      TO SU023-TO-DATE-DD.              06570000
065800     MOVE ASC-TO-DATE-YY-N      TO SU023-TO-DATE-YY.              06580000
065900     MOVE ASC-AUDIT-NUMBER-N    TO SU023-AUDIT-NBR.               06590000
066000     MOVE ASC-CARTON-ID-N       TO SU023-CARTON-ID.               06600000
066100     MOVE ASC-CRTN-AUDIT-N      TO SU023-CRTN-AUDT.               06610000
066200 EJECT                                                            06620000
066300*----------------------------------------------------------------*06630000
066400* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*06640000
066500* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *06650000
066600* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *06660000
066700*----------------------------------------------------------------*06670000
066800                                                                  06680000
066900 2200-MOVE-SCREEN-TO-COMMAREA.                                    06690000
067000                                                                  06700000
067100     IF  AAUDTYPL > ZERO                                          06710000
067200         MOVE AAUDTYPI             TO ASC-AUDIT-TYPE              06720000
067300     ELSE                                                         06730000
067400         IF  AAUDTYPF = DP015-ERASE-EOF                           06740000
067500             MOVE SPACE            TO ASC-AUDIT-TYPE              06750000
067600         END-IF                                                   06760000
067700     END-IF.                                                      06770000
067800                                                                  06780000
067900     IF  AAUDSTAL > ZERO                                          06790000
068000         MOVE AAUDSTAI             TO ASC-AUDIT-STATUS            06800000
068100     ELSE                                                         06810000
068200         IF  AAUDSTAF = DP015-ERASE-EOF                           06820000
068300             MOVE SPACE            TO ASC-AUDIT-STATUS            06830000
068400         END-IF                                                   06840000
068500     END-IF.                                                      06850000
068600                                                                  06860000
068700     IF  AOPRUNTL > ZERO                                          06870000
068800         MOVE AOPRUNTI             TO ASC-OPER-UNIT-ID            06880000
068900     ELSE                                                         06890000
069000         IF  AOPRUNTF = DP015-ERASE-EOF                           06900000
069100             MOVE SPACE            TO ASC-OPER-UNIT-ID            06910000
069200                                      AOPRDSCO                    06920000
069300         ELSE                                                     06930000
069400             IF ASC-OPER-UNIT-ID = SPACES                         06940000
069500                 MOVE SPACE       TO  AOPRDSCO                    06950000
069600             END-IF                                               06960000
069700         END-IF                                                   06970000
069800     END-IF.                                                      06980000
069900                                                                  06990000
070000     IF  ADATFMML > ZERO                                          07000000
070100         MOVE ADATFMMI             TO ASC-FROM-DATE-MM            07010000
070200     ELSE                                                         07020000
070300         IF  ADATFMMF = DP015-ERASE-EOF                           07030000
070400             MOVE SPACE            TO ASC-FROM-DATE-MM            07040000
070500         END-IF                                                   07050000
070600     END-IF.                                                      07060000
070700                                                                  07070000
070800     IF  ADATFDDL > ZERO                                          07080000
070900         MOVE ADATFDDI             TO ASC-FROM-DATE-DD            07090000
071000     ELSE                                                         07100000
071100         IF  ADATFDDF = DP015-ERASE-EOF                           07110000
071200             MOVE SPACE            TO ASC-FROM-DATE-DD            07120000
071300         END-IF                                                   07130000
071400     END-IF.                                                      07140000
071500                                                                  07150000
071600     IF  ADATFYYL > ZERO                                          07160000
071700         MOVE ADATFYYI             TO ASC-FROM-DATE-YY            07170000
071800     ELSE                                                         07180000
071900         IF  ADATFYYF = DP015-ERASE-EOF                           07190000
072000             MOVE SPACE            TO ASC-FROM-DATE-YY            07200000
072100         END-IF                                                   07210000
072200     END-IF.                                                      07220000
072300                                                                  07230000
072400     IF  ADATTMML > ZERO                                          07240000
072500         MOVE ADATTMMI             TO ASC-TO-DATE-MM              07250000
072600     ELSE                                                         07260000
072700         IF  ADATTMMF = DP015-ERASE-EOF                           07270000
072800             MOVE SPACE            TO ASC-TO-DATE-MM              07280000
072900         END-IF                                                   07290000
073000     END-IF.                                                      07300000
073100                                                                  07310000
073200     IF  ADATTDDL > ZERO                                          07320000
073300         MOVE ADATTDDI             TO ASC-TO-DATE-DD              07330000
073400     ELSE                                                         07340000
073500         IF  ADATTDDF = DP015-ERASE-EOF                           07350000
073600             MOVE SPACE            TO ASC-TO-DATE-DD              07360000
073700         END-IF                                                   07370000
073800     END-IF.                                                      07380000
073900                                                                  07390000
074000     IF  ADATTYYL > ZERO                                          07400000
074100         MOVE ADATTYYI             TO ASC-TO-DATE-YY              07410000
074200     ELSE                                                         07420000
074300         IF  ADATTYYF = DP015-ERASE-EOF                           07430000
074400             MOVE SPACE            TO ASC-TO-DATE-YY              07440000
074500         END-IF                                                   07450000
074600     END-IF.                                                      07460000
074700                                                                  07470000
074800     IF  AAUDNBRL > ZERO                                          07480000
074900         MOVE AAUDNBRI             TO ASC-AUDIT-NUMBER            07490000
075000     ELSE                                                         07500000
075100         IF  AAUDNBRF = DP015-ERASE-EOF                           07510000
075200             MOVE SPACE            TO ASC-AUDIT-NUMBER            07520000
075300         END-IF                                                   07530000
075400     END-IF.                                                      07540000
075500                                                                  07550000
075600     IF  ACARTONL > ZERO                                          07560000
075700         MOVE ACARTONI             TO ASC-CARTON-ID               07570000
075800     ELSE                                                         07580000
075900         IF  ACARTONF = DP015-ERASE-EOF                           07590000
076000             MOVE SPACE            TO ASC-CARTON-ID               07600000
076100         END-IF                                                   07610000
076200     END-IF.                                                      07620000
076300                                                                  07630000
076400     IF  ACRTAUDL > ZERO                                          07640000
076500         MOVE ACRTAUDI             TO ASC-CRTN-AUDIT              07650000
076600     ELSE                                                         07660000
076700         IF  ACRTAUDF = DP015-ERASE-EOF                           07670000
076800             MOVE SPACE            TO ASC-CRTN-AUDIT              07680000
076900         END-IF                                                   07690000
077000     END-IF.                                                      07700000
077100                                                                  07710000
077200                                                                  07720000
077300*----------------------------------------------------------------*07730000
077400* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *07740000
077500* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *07750000
077600* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*07760000
077700* IN THE DESTINATION PROGRAM, NOT HERE.                          *07770000
077800*----------------------------------------------------------------*07780000
077900                                                                  07790000
078000 3000-EDIT-DATA-IN-COMMAREA.                                      07800000
078100                                                                  07810000
078200     PERFORM 3200-RESET-ATTRIBUTES.                               07820000
078300                                                                  07830000
078400     IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR               07840000
078500         DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  OR               07850000
078600         DP020-SRC-AID = DP016-ENTER                              07860000
078700         IF ASC-CARTON-ID > SPACES                                07870000
078800            PERFORM 3005-EDIT-CARTON-ID                           07880000
078900         ELSE                                                     07880100
078700             IF ASC-OPER-UNIT-ID   > SPACES OR                    07881000
078700                ASC-OPER-UNIT-ID-N > ZEROES                       07881100
122100                 MOVE ASC-OPER-UNIT-ID TO DP010I-UNEDITED-FIELD   07881200
122200                 MOVE LENGTH OF ASC-OPER-UNIT-ID                  07881300
122300                                       TO DP010I-MAXIMUM-DIGITS   07881400
122400                 MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS 07881500
122500                 SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE          07881600
263968                 CALL DP010I-NUMERIC-EDIT-ROUTINE                 07881801
263968                      USING DP010I-NUMERIC-EDIT-AREA              07881901
122700                 IF  DP010I-ERROR-DETECTED                        07882000
122800                     SET PS-ERROR                                 07882100
122900                         DP020-MSG-FATAL   TO TRUE                07882200
123000                     MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER    07882300
123100                     MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA      07882400
123300                     MOVE DP015-RED        TO AOPRUNTC            07882500
123400                     MOVE DP015-REVERSE    TO AOPRUNTH            07882600
123500                     MOVE -1               TO AOPRUNTL            07882700
123600                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          07882800
123700                 ELSE                                             07882900
123800                     MOVE DP010I-NUMERIC-FIELD                    07883000
123900                                             TO ASC-OPER-UNIT-ID-N07883100
124000                                                DK-OPER-UNIT      07883200
124100                     MOVE ASC-OPER-UNIT-ID TO AOPRUNTO            07883300
124300                     PERFORM 3100-VALIDATE-OPER-UNIT              07883400
124400                     IF PS-OPER-UNIT-NOT-FOUND                    07883500
124500                         SET PS-ERROR                             07883600
124600                             DP020-MSG-FATAL   TO TRUE            07883700
124700                         MOVE PC-TSYMSG-02572  TO DP020-MSG-NUMBER07883800
124800                         MOVE DP015-UNP-ALP-BRT-OFF TO AOPRUNTA   07883900
125000                         MOVE DP015-RED        TO AOPRUNTC        07884000
125100                         MOVE DP015-REVERSE    TO AOPRUNTH        07884100
125200                         MOVE -1               TO AOPRUNTL        07884200
125300                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      07885000
125400                     ELSE                                         07886000
125500                          MOVE XLT00010-LOC-NM     TO AOPRDSCO    07887000
125600                     END-IF                                       07888000
125600                 END-IF                                           07889000
078900             END-IF                                               07890000
078900         END-IF                                                   07891000
079000     END-IF.                                                      07900000
079100                                                                  07910000
079200     IF (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR               07920000
079300         DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)) AND              07930000
079400         ASC-CRTN-AUDIT   > SPACE                                 07940000
079500         MOVE ASC-CRTN-AUDIT       TO DP010I-UNEDITED-FIELD       07950000
079600         MOVE LENGTH OF ASC-AUDIT-NUMBER TO DP010I-MAXIMUM-DIGITS 07960000
079700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     07970000
079800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07980000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07991001
263968              USING DP010I-NUMERIC-EDIT-AREA                      07992001
080000         IF  DP010I-ERROR-DETECTED                                08000000
080100             SET PS-ERROR                                         08010000
080200                 DP020-MSG-FATAL   TO TRUE                        08020000
080300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08030000
080400             MOVE DP015-UNP-ALP-BRT-OFF                           08040000
080500                                   TO ACRTAUDA                    08050000
080600             MOVE DP015-RED        TO ACRTAUDC                    08060000
080700             MOVE DP015-REVERSE    TO ACRTAUDH                    08070000
080800             MOVE -1               TO ACRTAUDL                    08080000
080900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08090000
081000         ELSE                                                     08100000
081100             MOVE DP010I-NUMERIC-FIELD                            08110000
081200                                   TO ASC-CRTN-AUDIT-N            08120000
081300             MOVE ASC-CRTN-AUDIT   TO ACRTAUDO                    08130000
081400         END-IF                                                   08140000
081500     END-IF.                                                      08150000
081600                                                                  08160000
081700     IF  ASC-CARTON-ID-N    > 0  AND                              08170000
081800         ASC-CRTN-AUDIT-N  <= 0                                   08180000
081900         PERFORM 3150-GET-CRTN-AUDT                               08190000
082000     END-IF.                                                      08200000
082100                                                                  08210000
082200                                                                  08220000
082300     IF DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)  AND               08230000
082400                  ASC-AUDIT-NUMBER = SPACE                        08240000
082500             SET PS-ERROR                                         08250000
082600                 DP020-MSG-FATAL   TO TRUE                        08260000
082700             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            08270000
082800             MOVE DP015-UNP-ALP-BRT-OFF                           08280000
082900                                   TO AAUDNBRA                    08290000
083000             MOVE DP015-RED        TO AAUDNBRC                    08300000
083100             MOVE DP015-REVERSE    TO AAUDNBRH                    08310000
083200             MOVE -1               TO AAUDNBRL                    08320000
083300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08330000
083400                                                                  08340000
083500     ELSE                                                         08350000
083600                                                                  08360000
083700     IF  (DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) OR               08370000
083800         DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)) AND              08380000
083900         ASC-AUDIT-NUMBER > SPACE                                 08390000
084000         MOVE ASC-AUDIT-NUMBER     TO DP010I-UNEDITED-FIELD       08400000
084100         MOVE LENGTH OF ASC-AUDIT-NUMBER TO DP010I-MAXIMUM-DIGITS 08410000
084200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08420000
084300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08430000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08441001
263968              USING DP010I-NUMERIC-EDIT-AREA                      08442001
084500         IF  DP010I-ERROR-DETECTED                                08450000
084600             SET PS-ERROR                                         08460000
084700                 DP020-MSG-FATAL   TO TRUE                        08470000
084800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08480000
084900             MOVE DP015-UNP-ALP-BRT-OFF                           08490000
085000                                   TO AAUDNBRA                    08500000
085100             MOVE DP015-RED        TO AAUDNBRC                    08510000
085200             MOVE DP015-REVERSE    TO AAUDNBRH                    08520000
085300             MOVE -1               TO AAUDNBRL                    08530000
085400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08540000
085500         ELSE                                                     08550000
085600             MOVE DP010I-NUMERIC-FIELD                            08560000
085700                                   TO ASC-AUDIT-NUMBER-N          08570000
085800                                      SUNAUD-AUD-CNTL-NBR         08580000
085900             MOVE ASC-AUDIT-NUMBER TO AAUDNBRO                    08590000
086000             PERFORM 7000-SELECT-TSUNAUD                          08600000
086100             IF SQLCODE = +100                                    08610000
086200                 SET PS-ERROR                                     08620000
086300                     DP020-MSG-FATAL   TO TRUE                    08630000
086400                 MOVE PC-TSYMSG-02918  TO DP020-MSG-NUMBER        08640000
086500                 MOVE DP015-UNP-ALP-BRT-OFF                       08650000
086600                                       TO AAUDNBRA                08660000
086700                 MOVE DP015-RED        TO AAUDNBRC                08670000
086800                 MOVE DP015-REVERSE    TO AAUDNBRH                08680000
086900                 MOVE -1               TO AAUDNBRL                08690000
087000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08700000
087100             END-IF                                               08710000
087200         END-IF                                                   08720000
087300     END-IF                                                       08730000
087500                                                                  08750000
087600     END-IF.                                                      08760000
087900                                                                  08790000
088000                                                                  08800000
088100     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              08810000
088200         ASC-TO-DATE-YY > SPACE                                   08820000
088300         MOVE ASC-TO-DATE-YY TO DP010I-UNEDITED-FIELD             08830000
088400         MOVE LENGTH OF ASC-TO-DATE-YY                            08840000
088500                                   TO DP010I-MAXIMUM-DIGITS       08850000
088600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08860000
088700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08870000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08881001
263968              USING DP010I-NUMERIC-EDIT-AREA                      08882001
088900         IF  DP010I-ERROR-DETECTED                                08890000
089000             SET PS-ERROR                                         08900000
089100                 PS-NUM-ERROR                                     08910000
089200                 DP020-MSG-FATAL   TO TRUE                        08920000
089300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08930000
089400             MOVE DP015-UNP-ALP-BRT-OFF                           08940000
089500                                   TO ADATTYYA                    08950000
089600             MOVE DP015-RED        TO ADATTYYC                    08960000
089700             MOVE DP015-REVERSE    TO ADATTYYH                    08970000
089800             MOVE -1               TO ADATTYYL                    08980000
089900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08990000
090000         ELSE                                                     09000000
090100             MOVE DP010I-NUMERIC-FIELD                            09010000
090200                                   TO ASC-TO-DATE-YY-N            09020000
090300             MOVE ASC-TO-DATE-YY TO ADATTYYO                      09030000
090400         END-IF                                                   09040000
090500     END-IF.                                                      09050000
090600                                                                  09060000
090700     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              09070000
090800         ASC-TO-DATE-DD > SPACE                                   09080000
090900         MOVE ASC-TO-DATE-DD TO DP010I-UNEDITED-FIELD             09090000
091000         MOVE LENGTH OF ASC-TO-DATE-DD                            09100000
091100                                   TO DP010I-MAXIMUM-DIGITS       09110000
091200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09120000
091300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09130000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09141001
263968              USING DP010I-NUMERIC-EDIT-AREA                      09142001
091500         IF  DP010I-ERROR-DETECTED                                09150000
091600             SET PS-ERROR                                         09160000
091700                 PS-NUM-ERROR                                     09170000
091800                 DP020-MSG-FATAL   TO TRUE                        09180000
091900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09190000
092000             MOVE DP015-UNP-ALP-BRT-OFF                           09200000
092100                                   TO ADATTDDA                    09210000
092200             MOVE DP015-RED        TO ADATTDDC                    09220000
092300             MOVE DP015-REVERSE    TO ADATTDDH                    09230000
092400             MOVE -1               TO ADATTDDL                    09240000
092500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09250000
092600         ELSE                                                     09260000
092700             MOVE DP010I-NUMERIC-FIELD                            09270000
092800                                   TO ASC-TO-DATE-DD-N            09280000
092900             MOVE ASC-TO-DATE-DD TO ADATTDDO                      09290000
093000         END-IF                                                   09300000
093100     END-IF.                                                      09310000
093200                                                                  09320000
093300     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              09330000
093400         ASC-TO-DATE-MM > SPACE                                   09340000
093500         MOVE ASC-TO-DATE-MM TO DP010I-UNEDITED-FIELD             09350000
093600         MOVE LENGTH OF ASC-TO-DATE-MM                            09360000
093700                                   TO DP010I-MAXIMUM-DIGITS       09370000
093800         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09380000
093900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09390000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09401001
263968              USING DP010I-NUMERIC-EDIT-AREA                      09402001
094100         IF  DP010I-ERROR-DETECTED                                09410000
094200             SET PS-ERROR                                         09420000
094300                 PS-NUM-ERROR                                     09430000
094400                 DP020-MSG-FATAL   TO TRUE                        09440000
094500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09450000
094600             MOVE DP015-UNP-ALP-BRT-OFF                           09460000
094700                                   TO ADATTMMA                    09470000
094800             MOVE DP015-RED        TO ADATTMMC                    09480000
094900             MOVE DP015-REVERSE    TO ADATTMMH                    09490000
095000             MOVE -1               TO ADATTMML                    09500000
095100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09510000
095200         ELSE                                                     09520000
095300             MOVE DP010I-NUMERIC-FIELD                            09530000
095400                                   TO ASC-TO-DATE-MM-N            09540000
095500             MOVE ASC-TO-DATE-MM TO ADATTMMO                      09550000
095600         END-IF                                                   09560000
095700     END-IF.                                                      09570000
095800                                                                  09580000
095900     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              09590000
096000         ASC-FROM-DATE-YY > SPACE                                 09600000
096100         MOVE ASC-FROM-DATE-YY TO            DP010I-UNEDITED-FIELD09610000
096200         MOVE LENGTH OF ASC-FROM-DATE-YY                          09620000
096300                                   TO DP010I-MAXIMUM-DIGITS       09630000
096400         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09640000
096500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09650000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09661001
263968              USING DP010I-NUMERIC-EDIT-AREA                      09662001
096700         IF  DP010I-ERROR-DETECTED                                09670000
096800             SET PS-ERROR                                         09680000
096900                 PS-NUM-ERROR                                     09690000
097000                 DP020-MSG-FATAL   TO TRUE                        09700000
097100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09710000
097200             MOVE DP015-UNP-ALP-BRT-OFF                           09720000
097300                                   TO ADATFYYA                    09730000
097400             MOVE DP015-RED        TO ADATFYYC                    09740000
097500             MOVE DP015-REVERSE    TO ADATFYYH                    09750000
097600             MOVE -1               TO ADATFYYL                    09760000
097700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09770000
097800         ELSE                                                     09780000
097900             MOVE DP010I-NUMERIC-FIELD                            09790000
098000                               TO ASC-FROM-DATE-YY-N              09800000
098100             MOVE ASC-FROM-DATE-YY TO ADATFYYO                    09810000
098200         END-IF                                                   09820000
098300     END-IF.                                                      09830000
098400                                                                  09840000
098500     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              09850000
098600         ASC-FROM-DATE-DD > SPACE                                 09860000
098700         MOVE ASC-FROM-DATE-DD TO            DP010I-UNEDITED-FIELD09870000
098800         MOVE LENGTH OF ASC-FROM-DATE-DD                          09880000
098900                                   TO DP010I-MAXIMUM-DIGITS       09890000
099000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09900000
099100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09910000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09921001
263968              USING DP010I-NUMERIC-EDIT-AREA                      09922001
099300         IF  DP010I-ERROR-DETECTED                                09930000
099400             SET PS-ERROR                                         09940000
099500                 PS-NUM-ERROR                                     09950000
099600                 DP020-MSG-FATAL   TO TRUE                        09960000
099700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09970000
099800             MOVE DP015-UNP-ALP-BRT-OFF                           09980000
099900                                   TO ADATFDDA                    09990000
100000             MOVE DP015-RED        TO ADATFDDC                    10000000
100100             MOVE DP015-REVERSE    TO ADATFDDH                    10010000
100200             MOVE -1               TO ADATFDDL                    10020000
100300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10030000
100400         ELSE                                                     10040000
100500             MOVE DP010I-NUMERIC-FIELD                            10050000
100600                                 TO ASC-FROM-DATE-DD-N            10060000
100700             MOVE ASC-FROM-DATE-DD TO ADATFDDO                    10070000
100800         END-IF                                                   10080000
100900     END-IF.                                                      10090000
101000                                                                  10100000
101100     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              10110000
101200         ASC-FROM-DATE-MM > SPACE                                 10120000
101300         MOVE ASC-FROM-DATE-MM TO            DP010I-UNEDITED-FIELD10130000
101400         MOVE LENGTH OF ASC-FROM-DATE-MM                          10140000
101500                                   TO DP010I-MAXIMUM-DIGITS       10150000
101600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     10160000
101700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  10170000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10181001
263968              USING DP010I-NUMERIC-EDIT-AREA                      10182001
101900         IF  DP010I-ERROR-DETECTED                                10190000
102000             SET PS-ERROR                                         10200000
102100                 PS-NUM-ERROR                                     10210000
102200                 DP020-MSG-FATAL   TO TRUE                        10220000
102300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            10230000
102400             MOVE DP015-UNP-ALP-BRT-OFF                           10240000
102500                                   TO ADATFMMA                    10250000
102600             MOVE DP015-RED        TO ADATFMMC                    10260000
102700             MOVE DP015-REVERSE    TO ADATFMMH                    10270000
102800             MOVE -1               TO ADATFMML                    10280000
102900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10290000
103000         ELSE                                                     10300000
103100             MOVE DP010I-NUMERIC-FIELD                            10310000
103200                               TO ASC-FROM-DATE-MM-N              10320000
103300             MOVE ASC-FROM-DATE-MM TO ADATFMMO                    10330000
103400         END-IF                                                   10340000
103500     END-IF.                                                      10350000
103600                                                                  10360000
103700     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              10370000
103800         ASC-FROM-DATE-MM = SPACE AND                             10380000
103900        (ASC-FROM-DATE-DD > SPACE OR                              10390000
104000         ASC-FROM-DATE-YY > SPACE)                                10400000
104100         SET PS-ERROR                                             10410000
104200             DP020-MSG-FATAL   TO TRUE                            10420000
104300         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                10430000
104400         MOVE DP015-UNP-ALP-BRT-OFF                               10440000
104500                               TO ADATFMMA                        10450000
104600         MOVE DP015-RED        TO ADATFMMC                        10460000
104700         MOVE DP015-REVERSE    TO ADATFMMH                        10470000
104800         MOVE -1               TO ADATFMML                        10480000
104900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10490000
105000     END-IF.                                                      10500000
105100                                                                  10510000
105200     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              10520000
105300         ASC-FROM-DATE-DD = SPACE AND                             10530000
105400        (ASC-FROM-DATE-MM > SPACE OR                              10540000
105500         ASC-FROM-DATE-YY > SPACE)                                10550000
105600         SET PS-ERROR                                             10560000
105700             DP020-MSG-FATAL   TO TRUE                            10570000
105800         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                10580000
105900         MOVE DP015-UNP-ALP-BRT-OFF                               10590000
106000                               TO ADATFDDA                        10600000
106100         MOVE DP015-RED        TO ADATFDDC                        10610000
106200         MOVE DP015-REVERSE    TO ADATFDDH                        10620000
106300         MOVE -1               TO ADATFDDL                        10630000
106400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10640000
106500     END-IF.                                                      10650000
106600                                                                  10660000
106700     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              10670000
106800         ASC-FROM-DATE-YY = SPACE AND                             10680000
106900        (ASC-FROM-DATE-DD > SPACE OR                              10690000
107000         ASC-FROM-DATE-MM > SPACE)                                10700000
107100         SET PS-ERROR                                             10710000
107200             DP020-MSG-FATAL   TO TRUE                            10720000
107300         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                10730000
107400         MOVE DP015-UNP-ALP-BRT-OFF                               10740000
107500                               TO ADATFYYA                        10750000
107600         MOVE DP015-RED        TO ADATFYYC                        10760000
107700         MOVE DP015-REVERSE    TO ADATFYYH                        10770000
107800         MOVE -1               TO ADATFYYL                        10780000
107900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10790000
108000     END-IF.                                                      10800000
108100                                                                  10810000
108200     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              10820000
108300         ASC-TO-DATE-MM = SPACE AND                               10830000
108400        (ASC-TO-DATE-DD > SPACE OR                                10840000
108500         ASC-TO-DATE-YY > SPACE)                                  10850000
108600         SET PS-ERROR                                             10860000
108700             DP020-MSG-FATAL   TO TRUE                            10870000
108800         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                10880000
108900         MOVE DP015-UNP-ALP-BRT-OFF                               10890000
109000                               TO ADATTMMA                        10900000
109100         MOVE DP015-RED        TO ADATTMMC                        10910000
109200         MOVE DP015-REVERSE    TO ADATTMMH                        10920000
109300         MOVE -1               TO ADATTMML                        10930000
109400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10940000
109500     END-IF.                                                      10950000
109600                                                                  10960000
109700     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              10970000
109800         ASC-TO-DATE-DD = SPACE AND                               10980000
109900        (ASC-TO-DATE-MM > SPACE OR                                10990000
110000         ASC-TO-DATE-YY > SPACE)                                  11000000
110100         SET PS-ERROR                                             11010000
110200             DP020-MSG-FATAL   TO TRUE                            11020000
110300         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                11030000
110400         MOVE DP015-UNP-ALP-BRT-OFF                               11040000
110500                               TO ADATTDDA                        11050000
110600         MOVE DP015-RED        TO ADATTDDC                        11060000
110700         MOVE DP015-REVERSE    TO ADATTDDH                        11070000
110800         MOVE -1               TO ADATTDDL                        11080000
110900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11090000
111000     END-IF.                                                      11100000
111100                                                                  11110000
111200     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              11120000
111300         ASC-TO-DATE-YY = SPACE AND                               11130000
111400        (ASC-TO-DATE-DD > SPACE OR                                11140000
111500         ASC-TO-DATE-MM > SPACE)                                  11150000
111600         SET PS-ERROR                                             11160000
111700             DP020-MSG-FATAL   TO TRUE                            11170000
111800         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                11180000
111900         MOVE DP015-UNP-ALP-BRT-OFF                               11190000
112000                               TO ADATTYYA                        11200000
112100         MOVE DP015-RED        TO ADATTYYC                        11210000
112200         MOVE DP015-REVERSE    TO ADATTYYH                        11220000
112300         MOVE -1               TO ADATTYYL                        11230000
112400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11240000
112500     END-IF.                                                      11250000
112600                                                                  11260000
112700     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              11270000
112800        (ASC-FROM-DATE-MM > SPACE AND                             11280000
112900         ASC-FROM-DATE-DD > SPACE AND                             11290000
113000         ASC-FROM-DATE-YY > SPACE) AND                            11300000
113100        (ASC-TO-DATE-YY = SPACE AND                               11310000
113200         ASC-TO-DATE-DD = SPACE AND                               11320000
113300         ASC-TO-DATE-MM = SPACE)                                  11330000
113400         SET PS-ERROR                                             11340000
113500             DP020-MSG-FATAL   TO TRUE                            11350000
113600         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                11360000
113700         MOVE DP015-UNP-ALP-BRT-OFF                               11370000
113800                               TO ADATTMMA                        11380000
113900         MOVE DP015-RED        TO ADATTMMC                        11390000
114000         MOVE DP015-REVERSE    TO ADATTMMH                        11400000
114100         MOVE DP015-UNP-ALP-BRT-OFF                               11410000
114200                               TO ADATTDDA                        11420000
114300         MOVE DP015-RED        TO ADATTDDC                        11430000
114400         MOVE DP015-REVERSE    TO ADATTDDH                        11440000
114500         MOVE DP015-UNP-ALP-BRT-OFF                               11450000
114600                               TO ADATTYYA                        11460000
114700         MOVE DP015-RED        TO ADATTYYC                        11470000
114800         MOVE DP015-REVERSE    TO ADATTYYH                        11480000
114900         MOVE -1               TO ADATTMML                        11490000
115000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11500000
115100     END-IF.                                                      11510000
115200                                                                  11520000
115300     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              11530000
115400        (ASC-TO-DATE-MM > SPACE AND                               11540000
115500         ASC-TO-DATE-DD > SPACE AND                               11550000
115600         ASC-TO-DATE-YY > SPACE) AND                              11560000
115700        (ASC-FROM-DATE-YY = SPACE AND                             11570000
115800         ASC-FROM-DATE-DD = SPACE AND                             11580000
115900         ASC-FROM-DATE-MM = SPACE)                                11590000
116000         SET PS-ERROR                                             11600000
116100             DP020-MSG-FATAL   TO TRUE                            11610000
116200         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                11620000
116300         MOVE DP015-UNP-ALP-BRT-OFF                               11630000
116400                               TO ADATFMMA                        11640000
116500         MOVE DP015-RED        TO ADATFMMC                        11650000
116600         MOVE DP015-REVERSE    TO ADATFMMH                        11660000
116700         MOVE DP015-UNP-ALP-BRT-OFF                               11670000
116800                               TO ADATFDDA                        11680000
116900         MOVE DP015-RED        TO ADATFDDC                        11690000
117000         MOVE DP015-REVERSE    TO ADATFDDH                        11700000
117100         MOVE DP015-UNP-ALP-BRT-OFF                               11710000
117200                               TO ADATFYYA                        11720000
117300         MOVE DP015-RED        TO ADATFYYC                        11730000
117400         MOVE DP015-REVERSE    TO ADATFYYH                        11740000
117500         MOVE -1               TO ADATFMML                        11750000
117600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11760000
117700     END-IF.                                                      11770000
117800                                                                  11780000
117900     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              11790000
118000         ASC-FROM-DATE-MM > SPACE AND                             11800000
118100         ASC-FROM-DATE-DD > SPACE AND                             11810000
118200         ASC-FROM-DATE-YY > SPACE AND                             11820000
118300         ASC-TO-DATE-MM > SPACE AND                               11830000
118400         ASC-TO-DATE-DD > SPACE AND                               11840000
118500         ASC-TO-DATE-YY > SPACE                                   11850000
118600         MOVE ASC-FROM-DATE-MM         TO  PV-FROM-MM             11860000
118700         MOVE ASC-FROM-DATE-DD         TO  PV-FROM-DD             11870000
118800         MOVE ASC-FROM-DATE-YY         TO  PV-FROM-YY             11880000
118900         MOVE ASC-TO-DATE-MM           TO  PV-TO-MM               11890000
119000         MOVE ASC-TO-DATE-DD           TO  PV-TO-DD               11900000
119100         MOVE ASC-TO-DATE-YY           TO  PV-TO-YY               11910000
119200         SET PS-NO-DATE-ERROR TO TRUE                             11920000
119300         PERFORM 3140-VALIDATE-FROM-TO                            11930000
119400         IF PS-DATE-ERROR                                         11940000
119500             MOVE DP015-UNP-ALP-BRT-OFF  TO ADATFMMA              11950000
119600                                            ADATFDDA              11960000
119700                                            ADATFYYA              11970000
119800                                            ADATTMMA              11980000
119900                                            ADATTDDA              11990000
120000                                            ADATTYYA              12000000
120100             MOVE DP015-RED              TO ADATFMMC              12010000
120200                                            ADATFDDC              12020000
120300                                            ADATFYYC              12030000
120400                                            ADATTMMC              12040000
120500                                            ADATTDDC              12050000
120600                                            ADATTYYC              12060000
120700             MOVE DP015-REVERSE          TO ADATFMMH              12070000
120800                                            ADATFDDH              12080000
120900                                            ADATFYYH              12090000
121000                                            ADATTMMH              12100000
121100                                            ADATTDDH              12110000
121200                                            ADATTYYH              12120000
121300             MOVE -1                     TO ADATFMML              12130000
121400         END-IF                                                   12140000
121500     END-IF.                                                      12150000
121600                                                                  12160000
121700     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              12170000
121800         ASC-OPER-UNIT-ID NOT EQUAL SPACE                         12180000
121900         IF  ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND                12190000
122000             ASC-OPER-UNIT-ID NOT EQUAL ' ALL'                    12200000
122100             MOVE ASC-OPER-UNIT-ID TO DP010I-UNEDITED-FIELD       12210000
122200             MOVE LENGTH OF ASC-OPER-UNIT-ID                      12220000
122300                                       TO DP010I-MAXIMUM-DIGITS   12230000
122400             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 12240000
122500             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              12250000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12261001
263968                  USING DP010I-NUMERIC-EDIT-AREA                  12262001
122700             IF  DP010I-ERROR-DETECTED                            12270000
122800                 SET PS-ERROR                                     12280000
122900                     DP020-MSG-FATAL   TO TRUE                    12290000
123000                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        12300000
123100                 MOVE DP015-UNP-ALP-BRT-OFF                       12310000
123200                                       TO AOPRUNTA                12320000
123300                 MOVE DP015-RED        TO AOPRUNTC                12330000
123400                 MOVE DP015-REVERSE    TO AOPRUNTH                12340000
123500                 MOVE -1               TO AOPRUNTL                12350000
123600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12360000
123700             ELSE                                                 12370000
123800                 MOVE DP010I-NUMERIC-FIELD                        12380000
123900                                       TO ASC-OPER-UNIT-ID-N      12390000
124000                                          DK-OPER-UNIT            12400000
124100                 MOVE ASC-OPER-UNIT-ID TO AOPRUNTO                12410000
124200                 SET PS-OPER-UNIT-NOT-FOUND TO TRUE               12420000
124300                 PERFORM 3100-VALIDATE-OPER-UNIT                  12430000
124400                 IF PS-OPER-UNIT-NOT-FOUND                        12440000
124500                     SET PS-ERROR                                 12450000
124600                         DP020-MSG-FATAL   TO TRUE                12460000
124700                     MOVE PC-TSYMSG-02572  TO DP020-MSG-NUMBER    12470000
124800                     MOVE DP015-UNP-ALP-BRT-OFF                   12480000
124900                                           TO AOPRUNTA            12490000
125000                     MOVE DP015-RED        TO AOPRUNTC            12500000
125100                     MOVE DP015-REVERSE    TO AOPRUNTH            12510000
125200                     MOVE -1               TO AOPRUNTL            12520000
125300                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          12530000
125400                 ELSE                                             12540000
125500                     MOVE XLT00010-LOC-NM     TO AOPRDSCO         12550000
125600                 END-IF                                           12560000
125700             END-IF                                               12570000
125800         ELSE                                                     12580000
125900             MOVE PC-ALL-DISTRIB-CNTRS TO AOPRDSCO                12590000
126000         END-IF                                                   12600000
126100     END-IF.                                                      12610000
126200                                                                  12620000
126300     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              12630000
126400         ASC-AUDIT-STATUS > SPACE                                 12640000
126500         IF ASC-AUDIT-STATUS = 'O' OR                             12650000
126600            ASC-AUDIT-STATUS = 'C' OR                             12660000
126700            ASC-AUDIT-STATUS = 'A'                                12670000
126800             CONTINUE                                             12680000
126900         ELSE                                                     12690000
127000             SET PS-ERROR                                         12700000
127100                 DP020-MSG-FATAL   TO TRUE                        12710000
127200             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            12720000
127300             MOVE DP015-UNP-ALP-BRT-OFF                           12730000
127400                                   TO AAUDSTAA                    12740000
127500             MOVE DP015-RED        TO AAUDSTAC                    12750000
127600             MOVE DP015-REVERSE    TO AAUDSTAH                    12760000
127700             MOVE -1               TO AAUDSTAL                    12770000
127800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12780000
127900         END-IF                                                   12790000
128000     END-IF.                                                      12800000
128100                                                                  12810000
128200     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  AND              12820000
128300         ASC-AUDIT-TYPE > SPACE                                   12830000
128400         IF ASC-AUDIT-TYPE = 'M' OR                               12840000
128500            ASC-AUDIT-TYPE = 'B'                                  12850000
128600             CONTINUE                                             12860000
128700         ELSE                                                     12870000
128800             SET PS-ERROR                                         12880000
128900                 DP020-MSG-FATAL   TO TRUE                        12890000
129000             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            12900000
129100             MOVE DP015-UNP-ALP-BRT-OFF                           12910000
129200                                   TO AAUDTYPA                    12920000
129300             MOVE DP015-RED        TO AAUDTYPC                    12930000
129400             MOVE DP015-REVERSE    TO AAUDTYPH                    12940000
129500             MOVE -1               TO AAUDTYPL                    12950000
129600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12960000
129700         END-IF                                                   12970000
129800     END-IF.                                                      12980000
129900                                                                  12990000
130000*                                                                 13000000
130100*                                                                 13010000
130200     IF  PS-NO-ERROR                                              13020000
130300         SET DP030-SET-CURSOR-APPL-1                              13030000
130400                                   TO TRUE                        13040000
130500     END-IF.                                                      13050000
130600                                                                  13060000
130700 3005-EDIT-CARTON-ID.                                             13070000
130800                                                                  13080000
130900     MOVE ASC-CARTON-ID       TO PV-INPUT-FIELD.                  13090000
131000     MOVE SPACES              TO PV-OUTPUT-FIELD.                 13100000
131100     MOVE +18                 TO PV-SUB2.                         13110000
131200                                                                  13120000
131300     PERFORM                                                      13130000
131400       VARYING PV-SUB1 FROM 18 BY -1                              13140000
131500         UNTIL PV-SUB1 = ZERO OR PS-ERROR                         13150000
131600                                                                  13160000
131700         IF PV-IN-BYTE (PV-SUB1) > SPACES                         13170000
131800             IF PV-IN-BYTE (PV-SUB1) NUMERIC                      13180000
131900                 MOVE PV-IN-BYTE (PV-SUB1)                        13190000
132000                   TO PV-OUT-BYTE (PV-SUB2)                       13200000
132100                 SUBTRACT 1 FROM PV-SUB2                          13210000
132200             ELSE                                                 13220000
132300                 SET PS-ERROR                                     13230000
132400                     DP020-MSG-FATAL         TO TRUE              13240000
132500                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  13250000
132600                 MOVE DP015-UNP-ALP-BRT-OFF  TO ACARTONA          13260000
132700                 MOVE DP015-RED              TO ACARTONC          13270000
132800                 MOVE DP015-REVERSE          TO ACARTONH          13280000
132900                 MOVE -1                     TO ACARTONL          13290000
133000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13300000
133100              END-IF                                              13310000
133200         END-IF                                                   13320000
133300                                                                  13330000
133400     END-PERFORM.                                                 13340000
133500                                                                  13350000
133600     IF PS-NO-ERROR                                               13360000
133700         INSPECT PV-OUTPUT-FIELD                                  13370000
133800           REPLACING ALL SPACES BY ZEROES                         13380000
133900                                                                  13390000
134000*LMM     MOVE PV-OUTPUT-FIELD TO ASC-CARTON-ID                    13400000
134100         MOVE ASC-CARTON-ID   TO ACARTONO                         13410000
134200     END-IF.                                                      13420000
134300                                                                  13430000
134400*----------------------------------------------------------------*13440000
134500* CHECK IF OPER UNIT IS VALID                                    *13450000
134600*----------------------------------------------------------------*13460000
134700 3100-VALIDATE-OPER-UNIT.                                         13470000
134800                                                                  13480000
134900     EXEC SQL                                                     13490000
135000        SELECT                                                    13500000
135100             LOC_NM                                               13510000
135200          INTO                                                    13520000
135300             :XLT00010-LOC-NM                                     13530000
135400          FROM  XLT_LOC                                           13540000
135500        WHERE  LOC_TYP_CDE    = :PC-DC                            13550000
135600          AND  LOC_NBR        = :DK-OPER-UNIT                     13560000
135700***       AND  E_BUS_IND      = :PC-N                             13570000
135800          AND  OPN_DTE        < CURRENT DATE + 1 DAY              13580000
135800          AND  CLO_DTE        = :PC-MAX-DATE                      13590000
136300     END-EXEC.                                                    13630000
136400                                                                  13640000
136500     EVALUATE TRUE                                                13650000
136600         WHEN SQLCODE = ZERO                                      13660000
136700             SET PS-OPER-UNIT-FOUND TO TRUE                       13670000
136800         WHEN SQLCODE = +100                                      13680000
136900             SET PS-OPER-UNIT-NOT-FOUND TO TRUE                   13690000
137000                                                                  13700000
137100         WHEN SQLWARN0 NOT = SPACES                               13710000
137200         WHEN SQLCODE < +0                                        13720000
137300         WHEN SQLCODE > ZERO                                      13730000
137400             MOVE '3100-VALIDATE-OPER-UNIT'                       13740000
137500                             TO DP013-PARAGRAPH                   13750000
137600             MOVE 'SELECT OPER UNIT'                              13760000
137700                             TO DP013-MESSAGE-TEXT (1)            13770000
137800             MOVE SQLCA      TO DP013-SQLCA                       13780000
137900             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)          13790000
138000             SET DP013-DB2-ABEND                                  13800000
138100                             TO TRUE                              13810000
138200             SET DP013-XCTL-DISPLAY-RESTART                       13820000
138300                             TO TRUE                              13830000
138400             PERFORM DP013-0000-PROCESS-ABEND                     13840000
138500     END-EVALUATE.                                                13850000
138600                                                                  13860000
138700*-----------------------------------------------------------------13870000
138800*  VALIDATE CREATE FROM AND TO DATES                              13880000
138900*-----------------------------------------------------------------13890000
139000 3140-VALIDATE-FROM-TO.                                           13900000
139100                                                                  13910000
139200     IF  PV-TO-DATE-HOLD  >=  PV-FROM-DATE-HOLD                   13920000
139300         CONTINUE                                                 13930000
139400     ELSE                                                         13940000
139500         IF PS-NUM-ERROR                                          13950000
139600             CONTINUE                                             13960000
139700         ELSE                                                     13970000
139800             SET PS-ERROR                                         13980000
139900                 PS-DATE-ERROR                                    13990000
140000                 DP020-MSG-FATAL         TO TRUE                  14000000
140100             MOVE PC-TSYMSG-02221        TO DP020-MSG-NUMBER      14010000
140200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14020000
140300         END-IF                                                   14030000
140400     END-IF.                                                      14040000
140500                                                                  14050000
140600     IF  PS-NO-ERROR                                              14060000
140700         INITIALIZE DPG51 DPG52 DPG53                             14070000
140800                    DPG54 DPG55 DPG56                             14080000
140900         SET  DPG51-ACTUAL-CALENDAR-ONLY                          14090000
141000              DPG51-DO-NOT-INCR-DECR-DATE                         14100000
141100                                    TO TRUE                       14110000
141200*            'CCYYMMDD'                                           14120000
141300         SET  DPG52-LK-DTE-ISO                                    14130000
141400                                    TO TRUE                       14140000
141500         MOVE PV-FROM-DATE-HOLD     TO DPG52-LK-DATE-INPUT        14150000
141600         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          14160000
141700                                       DPG54 DPG55 DPG56          14170000
141800         IF (DPG54-DATE-INVALID  OR                               14180000
141900             DPG54-SEVERE-ERROR)                                  14190000
142000             SET PS-ERROR                                         14200000
142100                 PS-DATE-ERROR                                    14210000
142200                 DP020-MSG-FATAL       TO TRUE                    14220000
142300             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        14230000
142400             SET DP030-SET-CURSOR-APPL-1                          14240000
142500                                       TO TRUE                    14250000
142600         END-IF                                                   14260000
142700                                                                  14270000
142800         INITIALIZE DPG51 DPG52 DPG53                             14280000
142900                    DPG54 DPG55 DPG56                             14290000
143000         SET  DPG51-ACTUAL-CALENDAR-ONLY                          14300000
143100              DPG51-DO-NOT-INCR-DECR-DATE                         14310000
143200                                    TO TRUE                       14320000
143300*            'CCYYMMDD'                                           14330000
143400             SET  DPG52-LK-DTE-ISO                                14340000
143500                                    TO TRUE                       14350000
143600         MOVE PV-TO-DATE-HOLD       TO DPG52-LK-DATE-INPUT        14360000
143700         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          14370000
143800                                       DPG54 DPG55 DPG56          14380000
143900         IF (DPG54-DATE-INVALID                                   14390000
144000         OR  DPG54-SEVERE-ERROR)                                  14400000
144100             SET PS-ERROR                                         14410000
144200                 PS-DATE-ERROR                                    14420000
144300                 DP020-MSG-FATAL       TO TRUE                    14430000
144400             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        14440000
144500             SET DP030-SET-CURSOR-APPL-1                          14450000
144600                                       TO TRUE                    14460000
144700         END-IF                                                   14470000
144800     END-IF.                                                      14480000
144900                                                                  14490000
145000                                                                  14500000
145100******************************************************************14510000
145200** GET CARTON ID AUDIT NUMBER - IF MULTIPLE ROWS RETURNED       **14520000
145300** ERROR.                                                       **14530000
145400******************************************************************14540000
145500 3150-GET-CRTN-AUDT.                                              14550000
145600                                                                  14560000
145700     MOVE ASC-CARTON-ID-N  TO  DK-CRTN-ID.                        14570000
145800                                                                  14580000
145900     EXEC SQL                                                     14590000
146000        SELECT DISTINCT                                           14600000
146100             AUD_CNTL_NBR                                         14610000
146110          ,  TRN_NBR                                              14611000
146120          ,  REC_SEQ_NBR                                          14612000
146200          INTO                                                    14620000
146300             :SUATRN-AUD-CNTL-NBR                                 14630000
146310          ,  :SUATRN-TRN-NBR                                      14631000
146320          ,  :SUATRN-REC-SEQ-NBR                                  14632000
146400          FROM  TSUATRN                                           14640000
146500        WHERE  SHIPT_UNT_ID   = :DK-CRTN-ID                       14650000
146600     END-EXEC.                                                    14660000
146700                                                                  14670000
146800     EVALUATE TRUE                                                14680000
146900         WHEN SQLCODE = ZERO                                      14690000
147000              MOVE  SUATRN-AUD-CNTL-NBR  TO  ASC-CRTN-AUDIT-N     14700000
147010                                             DK-AUD-CNTL-NBR      14701000
147100              MOVE  ASC-CRTN-AUDIT       TO  ACRTAUDO             14710000
147120              PERFORM 3170-CHECK-IF-SYS-GENERATED                 14712000
147200                                                                  14720000
147300         WHEN SQLCODE = +100                                      14730000
147400              CONTINUE                                            14740000
147500                                                                  14750000
147600         WHEN SQLCODE = -811                                      14760000
147700                                                                  14770000
147800              IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)          14780000
147900                  SET  PS-ERROR                                   14790000
148000                       DP020-MSG-FATAL         TO TRUE            14800000
148100                  MOVE PC-TSYMSG-02917 TO DP020-MSG-NUMBER        14810000
148200                  MOVE -1                      TO ACARTONL        14820000
148300                  MOVE DP015-RED               TO ACARTONC        14830000
148400                  SET  DP030-SET-CURSOR-APPL-1 TO TRUE            14840000
148500              END-IF                                              14850000
148600                                                                  14860000
148700         WHEN SQLWARN0 NOT = SPACES                               14870000
148800         WHEN SQLCODE < +0                                        14880000
148900         WHEN SQLCODE > ZERO                                      14890000
149000             MOVE '3150-GET-CRTN-AUDT'                            14900000
149100                             TO DP013-PARAGRAPH                   14910000
149200             MOVE 'GET AUDIT NBR FOR CRTN ID'                     14920000
149300                             TO DP013-MESSAGE-TEXT (1)            14930000
149400             MOVE SQLCA      TO DP013-SQLCA                       14940000
149500             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME (1)          14950000
149600             SET DP013-DB2-ABEND                                  14960000
149700                             TO TRUE                              14970000
149800             SET DP013-XCTL-DISPLAY-RESTART                       14980000
149900                             TO TRUE                              14990000
150000             PERFORM DP013-0000-PROCESS-ABEND                     15000000
150100     END-EVALUATE.                                                15010000
150200                                                                  15020000
150201******************************************************************15020100
150202** DETERMINE IF THE AUDIT IS A SYSTEM GENERATED AUDIT           **15020200
150204******************************************************************15020400
150205 3170-CHECK-IF-SYS-GENERATED.                                     15020500
150206                                                                  15020600
150210     EXEC SQL                                                     15021000
150250        SELECT  AUD_STAT_CDE                                      15025000
150251            ,   OPER_UNT_ID                                       15025100
150252            ,   PO_NBR                                            15025200
150253            ,   RCVR_SEQ_NBR                                      15025300
150260          INTO  :SUT00015-AUD-STAT-CDE                            15026000
150270            ,   :SUT00015-OPER-UNT-ID                             15027000
150280            ,   :SUT00015-PO-NBR                                  15028000
150290            ,   :SUT00015-RCVR-SEQ-NBR                            15029000
150301          FROM  SUT_PO_AUD_REQ                                    15030100
150309          WHERE AUD_CNTL_NBR       = :DK-AUD-CNTL-NBR             15030900
150310     END-EXEC.                                                    15031000
150311                                                                  15031100
150312     EVALUATE TRUE                                                15031200
150313         WHEN SQLCODE = ZERO                                      15031300
150314              SET PS-SYS-GEN-AUDIT           TO TRUE              15031400
150318                                                                  15031800
150319         WHEN SQLCODE = +100                                      15031900
150320              SET PS-NOT-SYS-GEN-AUDIT           TO TRUE          15032000
150322                                                                  15032200
150333                                                                  15033300
150334         WHEN SQLWARN0 NOT = SPACES                               15033400
150335         WHEN SQLCODE < +0                                        15033500
150336         WHEN SQLCODE > ZERO                                      15033600
150337             MOVE '3170-CHECK-IF-SYS-GENERATED'                   15033700
150338                             TO DP013-PARAGRAPH                   15033800
150339             MOVE 'CHECK IF AUDIT IS SYSTEM GEN'                  15033900
150340                             TO DP013-MESSAGE-TEXT (1)            15034000
150341             MOVE SQLCA      TO DP013-SQLCA                       15034100
150342             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME (1)          15034200
150343             MOVE DK-AUD-CNTL-NBR  TO PV-DISP-AUDIT               15034300
150344             STRING 'AUDIT NBR = '                                15034400
150345                    PV-DISP-AUDIT                                 15034500
150346                         DELIMITED BY SIZE                        15034600
150347                         INTO DP013-MESSAGE-TEXT (2)              15034700
150348             SET DP013-DB2-ABEND                                  15034800
150349                             TO TRUE                              15034900
150350             SET DP013-XCTL-DISPLAY-RESTART                       15035000
150351                             TO TRUE                              15035100
150352             PERFORM DP013-0000-PROCESS-ABEND                     15035200
150353     END-EVALUATE.                                                15035300
150354                                                                  15035400
150360                                                                  15036000
150400                                                                  15040000
150500******************************************************************15050000
150600** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **15060000
150700** MAP.                                                         **15070000
150800******************************************************************15080000
150900 3200-RESET-ATTRIBUTES.                                           15090000
151000     MOVE DP015-UNP-ALP-NOR-MDT    TO AAUDTYPA                    15100000
151100                                      AAUDSTAA.                   15110000
151200     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPRUNTA                    15120000
151300                                      ADATFMMA                    15130000
151400                                      ADATFDDA                    15140000
151500                                      ADATFYYA                    15150000
151600                                      ADATTMMA                    15160000
151700                                      ADATTDDA                    15170000
151800                                      ADATTYYA                    15180000
151900                                      AAUDNBRA                    15190000
152000                                      ACARTONA                    15200000
152100                                      ACRTAUDA.                   15210000
152200     MOVE DP015-GREEN              TO AAUDTYPC                    15220000
152300                                      AAUDSTAC                    15230000
152400                                      AOPRUNTC                    15240000
152500                                      ADATFMMC                    15250000
152600                                      ADATFDDC                    15260000
152700                                      ADATFYYC                    15270000
152800                                      ADATTMMC                    15280000
152900                                      ADATTDDC                    15290000
153000                                      ADATTYYC                    15300000
153100                                      AAUDNBRC                    15310000
153200                                      ACARTONC                    15320000
153300                                      ACRTAUDC.                   15330000
153400     MOVE DP015-UNDERLINE          TO AAUDTYPH                    15340000
153500                                      AAUDSTAH                    15350000
153600                                      AOPRUNTH                    15360000
153700                                      ADATFMMH                    15370000
153800                                      ADATFDDH                    15380000
153900                                      ADATFYYH                    15390000
154000                                      ADATTMMH                    15400000
154100                                      ADATTDDH                    15410000
154200                                      ADATTYYH                    15420000
154300                                      AAUDNBRH                    15430000
154400                                      ACARTONH                    15440000
154500                                      ACRTAUDH.                   15450000
154600*                                                                 15460000
154700*----------------------------------------------------------------*15470000
154800*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *15480000
154900*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *15490000
155000*  IT HERE.                                                      *15500000
155100*----------------------------------------------------------------*15510000
155200 4000-BUILD-INITIAL-PANEL.                                        15520000
155300     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        15530000
155400     MOVE -1                       TO AAUDTYPL.                   15540000
155500                                                                  15550000
155600     MOVE SPACES                   TO ASC-OPER-UNIT-ID            15560000
155700                                      ASC-FROM-DATE-MM            15570000
155800                                      ASC-FROM-DATE-DD            15580000
155900                                      ASC-FROM-DATE-YY            15590000
156000                                      ASC-TO-DATE-MM              15600000
156100                                      ASC-TO-DATE-DD              15610000
156200                                      ASC-TO-DATE-YY              15620000
156300                                      ASC-AUDIT-NUMBER            15630000
156400                                      ASC-CARTON-ID.              15640000
156500                                                                  15650000
156600     MOVE PC-DFLT-AUD-TYPE         TO AAUDTYPO                    15660000
156700                                      ASC-AUDIT-TYPE.             15670000
156800     MOVE PC-DFLT-AUD-STAT         TO AAUDSTAO                    15680000
156900                                      ASC-AUDIT-STATUS.           15690000
157000*                                                                 15700000
157100*----------------------------------------------------------------*15710000
157200*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *15720000
157300*----------------------------------------------------------------*15730000
157400 4400-MOVE-COMMAREA-TO-SCREEN.                                    15740000
157500     MOVE ASC-AUDIT-TYPE                TO AAUDTYPO.              15750000
157600     MOVE ASC-AUDIT-STATUS              TO AAUDSTAO.              15760000
157700     MOVE ASC-OPER-UNIT-ID              TO AOPRUNTO.              15770000
157800     MOVE ASC-FROM-DATE-MM              TO ADATFMMO.              15780000
157900     MOVE ASC-FROM-DATE-DD              TO ADATFDDO.              15790000
158000     MOVE ASC-FROM-DATE-YY              TO ADATFYYO.              15800000
158100     MOVE ASC-TO-DATE-MM                TO ADATTMMO.              15810000
158200     MOVE ASC-TO-DATE-DD                TO ADATTDDO.              15820000
158300     MOVE ASC-TO-DATE-YY                TO ADATTYYO.              15830000
158400     MOVE ASC-AUDIT-NUMBER              TO AAUDNBRO.              15840000
158500     MOVE ASC-CARTON-ID                 TO ACARTONO.              15850000
158600 EJECT                                                            15860000
158700*----------------------------------------------------------------*15870000
158800*    ABEND PROCESSOR MODULE                                      *15880000
158900*----------------------------------------------------------------*15890000
159000/                                                                 15900000
159100 7000-SELECT-TSUNAUD.                                             15910000
159200                                                                  15920000
159300     EXEC SQL                                                     15930000
159400        SELECT AUD_CNTL_NBR                                       15940000
159410           ,   AUD_STAT_CDE                                       15941000
159420           ,   OPER_UNT_ID                                        15942000
159500         INTO :SUNAUD-AUD-CNTL-NBR                                15950000
159510           ,  :SUNAUD-AUD-STAT-CDE                                15951000
159520           ,  :SUNAUD-OPER-UNT-ID                                 15952000
159600         FROM TSUNAUD                                             15960000
159700        WHERE AUD_CNTL_NBR     = :SUNAUD-AUD-CNTL-NBR             15970000
159800     END-EXEC.                                                    15980000
159900                                                                  15990000
160000     EVALUATE TRUE                                                16000000
160100         WHEN SQLCODE = +0                                        16010000
160200         WHEN SQLCODE = +100                                      16020000
160300             CONTINUE                                             16030000
160400                                                                  16040000
160500         WHEN SQLWARN0 NOT = SPACE                                16050000
160600         WHEN SQLCODE < +0                                        16060000
160700         WHEN SQLCODE > +0                                        16070000
160800             MOVE '7000-SELECT-TSUNAUD'                           16080000
160900                             TO DP013-PARAGRAPH                   16090000
161000             MOVE 'VALIDATE THE AUDIT NUMBER'                     16100000
161100                             TO DP013-MESSAGE-TEXT (1)            16110000
161200             MOVE SQLCA      TO DP013-SQLCA                       16120000
161300             MOVE 'TSUNAUD'  TO DP013-DB2-TABLE-NAME (1)          16130000
161400             SET DP013-DB2-ABEND                                  16140000
161500                             TO TRUE                              16150000
161600             SET DP013-XCTL-DISPLAY-RESTART                       16160000
161700                             TO TRUE                              16170000
161800             PERFORM DP013-0000-PROCESS-ABEND                     16180000
161900     END-EVALUATE.                                                16190000
162000                                                                  16200000
162100                                                                  16210000
162200     COPY DPPD013.                                                16220000
