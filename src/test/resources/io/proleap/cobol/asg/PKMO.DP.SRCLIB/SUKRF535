000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.             SUKRF535.                                00050001
000600 AUTHOR.                 LARRY SCHLEICHER.                        00060001
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070001
000800 DATE-WRITTEN.           DEC, 2000.                               00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100*----------------------------------------------------------------*00110001
001200* THIS PROGRAM IS STARTED BY THE SUKRF534 PROGRAM.  IT IS USED    00120001
001300* TO DISPLAY INFORMATION ON PREVIOUS AUDITS THAT HAVE FAILED.     00130001
001400* THE AUDIT NUMBER IS PROVIDED TO THE SUKCS594 PROGRAM, AND       00140001
001500* SUMMARY INFORMATION ABOUT THE AUDIT IS RETURNED.  THIS          00150001
001600* INFORMATION IS THEN DISPLAYED ON THE SCREEN.  F3 IS USED TO     00160001
001700* RETURN TO THE SUKRF534 PROGRAM.                                 00170001
001800                                                                  00180001
001900*----------------------------------------------------------------*00190001
002000                                                                  00200001
002100******************************************************************00210001
002200 ENVIRONMENT DIVISION.                                            00220001
002300******************************************************************00230001
002400                                                                  00240001
002500******************************************************************00250001
002600 DATA DIVISION.                                                   00260001
002700******************************************************************00270001
002800                                                                  00280001
002900******************************************************************00290001
003000 WORKING-STORAGE SECTION.                                         00300001
003100******************************************************************00310001
003200*                                                                 00320001
003300 01  CA-COMMAREA.                                                 00330001
003400                                                                  00340001
003500  03  CA-AUDIT-COMMAREA.                                          00350001
003600                                                                  00360001
003700*----------------------------------------------------------------*00370001
003800* COMMAREA USED WHEN LINKING FROM A CALLING PROGRAM               00380001
003900*----------------------------------------------------------------*00390001
004000     COPY SUWS006.                                                00400001
004100                                                                  00410001
004200  03  CA-PGM-COMMAREA.                                            00420001
004300         05  CA-PGM-TRANSACTION-STATUS   PIC  X(01)  VALUE SPACE. 00430001
004400             88  CA-PGM-INITIALIZE-SCREEN       VALUE 'S'.        00440001
004500             88  CA-PGM-PROCESS-SCREEN          VALUE 'R'.        00450001
004600         05  CA-PGM-AUDIT-CNTL-NBR       PIC S9(09) COMP.         00460001
004700         05  CA-PGM-LAST-PROGRAM         PIC  X(08)  VALUE SPACE. 00470001
004800                                                                  00480001
004900 01  CA-CHECK-IN-COMMAREA.                                        00490001
005000                                                                  00500001
005100*----------------------------------------------------------------*00510001
005200* COMMAREA USED WHEN LINKING FROM A CALLING PROGRAM               00520001
005300*----------------------------------------------------------------*00530001
005400     COPY SUWS001.                                                00540001
005500                                                                  00550001
005600 01  CA-SUMMARY-COMMAREA.                                         00560001
005700*----------------------------------------------------------------*00570001
005800* COMMAREA USED TO PAS DATA TO AND FROM SUKCS594                  00580001
005900*----------------------------------------------------------------*00590001
006000     COPY SUWS026.                                                00600001
006100                                                                  00610001
006200                                                                  00620001
006300*----------------------------------------------------------------*00630001
006400*  DB2 KEYS                                                      *00640001
006500*----------------------------------------------------------------*00650001
006600 01  DK-DB2-KEYS.                                                 00660001
006700     05  DK-OPER-UNT-ID                  PIC  S9(4) COMP.         00670001
006800     05  DK-FCLTY-ID                     PIC  S9(4) VALUE +1      00680001
006900                                                    COMP.         00690001
007000     05  DK-AUDIT-CNTL-NBR               PIC S9(09) COMP.         00700001
007100     05  DK-PO-NBR                       PIC S9(09) COMP.         00710001
007200     05  DK-PO-LINE-NBR                  PIC S9(09) COMP.         00720001
007300     05  DK-PREPK-ID                     PIC S9(04) COMP.         00730001
007400                                                                  00740001
007500*----------------------------------------------------------------*00750001
007600*  PROGRAM CONSTANTS                                             *00760001
007700*----------------------------------------------------------------*00770001
007800 01  PC-PROGRAM-CONSTANTS.                                        00780001
007900     05  PC-TRANID                  PIC  X(04)  VALUE 'S535'.     00790001
008000     05  PC-F                       PIC X(01) VALUE 'F'.          00800001
008100     05  PC-M                       PIC X(01) VALUE 'M'.          00810001
008200     05  PC-I                       PIC X(01) VALUE 'I'.          00820001
008300     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'SUKRF535'.   00830001
008400     05  PC-OPEN-CARTON-SCREEN      PIC X(08) VALUE 'SUKRF511'.   00840001
008500     05  PC-SUKCS594                PIC X(08) VALUE 'SUKCS594'.   00850001
008600     05  PC-SU-AUDIT-DEF-PRMPT-PGM  PIC X(08) VALUE 'SUKRF534'.   00860001
008700     05  PC-PICK-ERRORS             PIC X(17) VALUE               00870005
008700         'PICK ERRORS FOUND'.                                     00880005
008800     05  PC-PACK-ERRORS             PIC X(17) VALUE               00890005
008800         'PACK ERRORS FOUND'.                                     00900005
008900     05  PC-TCKT-ERRORS             PIC X(17) VALUE               00910005
008900         'TCKT ERRORS FOUND'.                                     00920005
RFAUDT     05  PC-RFID-ERRORS             PIC X(17) VALUE               00930005
RFAUDT         'RFID ERRORS FOUND'.                                     00940005
RFAUDT     05  PC-RFID-LVL-ERRORS         PIC X(17) VALUE               00950005
RFAUDT         'RFID LEVEL ERRORS'.                                     00960005
009000                                                                  00970001
009100*----------------------------------------------------------------*00980001
009200*   ERROR MESSAGES                                                00990001
009300*----------------------------------------------------------------*01000001
009400     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19)                     01010001
009500                                    VALUE  'UNRECOGNIZED PF KEY'. 01020001
009600     05  PC-NO-FAILED-AUDITS        PIC X(19)                     01030001
009700                                    VALUE  'NO FAILED AUDITS   '. 01040001
009800     05  PC-CARTON-LEVEL-ERROR-MSG  PIC X(19)                     01050001
009900                                    VALUE  'CARTON LEVEL ERRORS'. 01060001
010000     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19)                     01070001
010100                                    VALUE  'ENTER THROUGH MENU '. 01080001
010200     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19)                     01090001
010300                                    VALUE  'TRANS NOT AVAILABLE'. 01100001
010400     05  PC-AUDIT-OF-Y-OR-N         PIC X(19)                     01110001
010500                                    VALUE 'AUDIT MUST = Y OR N'.  01120001
010600     05  PC-DB2-FATAL-ERROR-MSG     PIC  X(19)                    01130001
010700                                    VALUE 'DB2 ERR/HELP DESK  '.  01140001
010800                                                                  01150001
010900*----------------------------------------------------------------*01160001
011000* PROGRAM SWITCHES                                               *01170001
011100*----------------------------------------------------------------*01180001
011200 01  PS-PROGRAM-SWITCHES.                                         01190001
011300     05  PS-MULTIPLE-FAILS-IND           PIC  X(01)  VALUE 'N'.   01200009
011400         88  PS-MULTIPLE-FAILS                       VALUE 'Y'.   01210009
011500         88  PS-NO-MULTIPLE-FAILS                    VALUE 'N'.   01220009
011600         88  PS-NO-FAILED-AUDITS                     VALUE 'F'.   01230009
011700     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01240001
011800         88  PS-VALID-INPUT                          VALUE 'Y'.   01250001
011900         88  PS-INVALID-INPUT                        VALUE 'N'.   01260001
012000     05  PS-AUDIT-SW                     PIC  X(01)  VALUE ' '.   01270001
012100         88  PS-VALID-AUDIT-NBR                      VALUE 'Y'.   01280001
012200         88  PS-INVALID-AUDIT-NBR                    VALUE 'N'.   01290001
RFAUDT     05  PS-MULTIPLE-RFID-FAILS-IND      PIC  X(01)  VALUE 'N'.   01300011
RFAUDT         88  PS-MULTIPLE-RFID-FAILS                  VALUE 'Y'.   01310011
RFAUDT         88  PS-NO-MULTIPLE-RFID-FAILS               VALUE 'N'.   01320011
RFAUDT         88  PS-NO-FAILED-RFID-AUDITS                VALUE 'F'.   01330011
012300                                                                  01340001
012400*----------------------------------------------------------------*01350001
012500* PROGRAM VARIABLES                                              *01360001
012600*----------------------------------------------------------------*01370001
012700 01  PV-PROGRAM-VARIABLES.                                        01380001
012800     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01390001
012900                                                     COMP SYNC.   01400001
013000     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01410001
013100     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  01420001
013200                                                     COMP SYNC.   01430001
013300     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 01440001
013400     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01450001
013500     05  PV-DISPLAY-CARTON               PIC  9(18) VALUE ZEROES. 01460001
013600     05  PV-DISPLAY-AUDIT-CNTL-NBR       PIC  9(09) VALUE ZEROES. 01470001
013700     05  PV-PROGRAM-DATA.                                         01480001
013800         10  PV-AUDIT-IND                PIC X(01).               01490001
013900         10  PV-PROMPT-IND               PIC X(01).               01500001
014000     05  PV-OPER-UNIT-ID-X.                                       01510001
014100         10  PV-OPER-UNIT-ID             PIC 9(04).               01520001
014200     05  PV-DISPLAY-PO-NBR               PIC S9(09).              01530001
014300     05  PV-DISPLAY-PREPK-ID             PIC S9(04).              01540001
014400     05  PV-DISPLAY-PO-LINE-NBR          PIC S9(09).              01550001
014500     05  PV-LIMIT-DAYS                   PIC S9(09) COMP.         01560001
014600*----------------------------------------------------------------*01570001
014700*  GENERATED DSECT FOR THE SUKM535 MAPSET                         01580001
014800*----------------------------------------------------------------*01590001
014900     COPY SUKM535.                                                01600001
015000                                                                  01610001
015100*----------------------------------------------------------------*01620001
015200*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 01630001
015300*----------------------------------------------------------------*01640001
015400     COPY DPWS010I.                                               01650003
015500                                                                  01660001
015600*----------------------------------------------------------------*01670001
015700*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01680001
015800*----------------------------------------------------------------*01690001
015900     COPY DPWS013.                                                01700003
016000                                                                  01710001
016100*----------------------------------------------------------------*01720001
016200*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01730001
016300*----------------------------------------------------------------*01740001
016400     COPY DPWS015.                                                01750003
016500                                                                  01760001
016510*----------------------------------------------------------------*01770001
016520* HELP SCREEN COMMAREA                                            01780001
016530     COPY PCWS192.                                                01790001
016540*----------------------------------------------------------------*01800001
016550* HELP SCREEN WORK AREA                                           01810001
016560     COPY PCWS188.                                                01820001
016570                                                                  01830001
017100*----------------------------------------------------------------*01840001
017200*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01850001
017300*----------------------------------------------------------------*01860001
017400     COPY DFHAID.                                                 01870001
017500                                                                  01880001
017600*---------------------------------------------------------------* 01890001
017700*    DB2 AREA FOR THE PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)   * 01900001
017800*---------------------------------------------------------------* 01910001
017900     EXEC SQL                                                     01920001
018000         INCLUDE SUT00015                                         01930001
018100     END-EXEC.                                                    01940001
018200*---------------------------------------------------------------* 01950001
018300*    DB2 AREA FOR THE PO AUDIT PARM TABLE (SUT_PO_AUD_PARM)     * 01960001
018400*---------------------------------------------------------------* 01970001
018500     EXEC SQL                                                     01980001
018600         INCLUDE SUT00017                                         01990001
018700     END-EXEC.                                                    02000001
018800*---------------------------------------------------------------* 02010001
018900*  COMMUNICATIONS AREA FOR DB2                                    02020001
019000*---------------------------------------------------------------* 02030001
019100     EXEC SQL                                                     02040001
019200         INCLUDE SQLCA                                            02050001
019300     END-EXEC.                                                    02060001
019400                                                                  02070001
019700******************************************************************02080005
019600 LINKAGE SECTION.                                                 02090001
019700******************************************************************02100001
019800 01  DFHCOMMAREA.                                                 02110001
019900     05  FILLER                       OCCURS 1 TO 4072 TIMES      02120001
020000                                      DEPENDING ON EIBCALEN.      02130001
020100         10  FILLER                   PIC X.                      02140001
020200                                                                  02150001
020300******************************************************************02160001
020400 PROCEDURE DIVISION.                                              02170001
020500******************************************************************02180001
020600 0000-PROGRAM-MAINLINE.                                           02190001
020700                                                                  02200001
020800     INITIALIZE CA-PGM-COMMAREA.                                  02210001
020900     IF EIBTRNID = 'S535'                                         02220001
021000         MOVE DFHCOMMAREA            TO CA-COMMAREA               02230001
021100         SET CA-PGM-PROCESS-SCREEN    TO TRUE                     02240001
021200     ELSE                                                         02250001
021300         IF EIBTRNID = 'S534'                                     02260001
021400             MOVE DFHCOMMAREA            TO CA-CHECK-IN-COMMAREA  02270001
021500             MOVE CA-CHECK-IN-COMMAREA   TO SU006-HOST-SAVE-AREA  02280001
021600             SET CA-PGM-INITIALIZE-SCREEN TO TRUE                 02290001
021700             MOVE SU001-AUDIT-CNTL-NBR   TO CA-PGM-AUDIT-CNTL-NBR 02300001
021800             MOVE SU001-LAST-PROGRAM     TO CA-PGM-LAST-PROGRAM   02310001
021900         ELSE                                                     02320001
021910             IF EIBTRNID = 'Z278'                                 02330001
021920                 MOVE DFHCOMMAREA          TO PC192-COMMAREA      02340001
021930                 MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA         02350001
021940                 SET CA-PGM-PROCESS-SCREEN TO TRUE                02360001
021950                 PERFORM 1000-INITIALIZE                          02370001
021960                 PERFORM 8000-SEND-MAP                            02380001
021970                 PERFORM 8200-RETURN-TRANID                       02390001
021980             ELSE                                                 02400001
022000                 MOVE DFHCOMMAREA        TO CA-AUDIT-COMMAREA     02410001
022100                 SET CA-PGM-INITIALIZE-SCREEN TO TRUE             02420001
022200                 MOVE SU006-AUDIT-CNTL-NBR                        02430001
022210                                         TO CA-PGM-AUDIT-CNTL-NBR 02440001
022300                 MOVE SU006-LAST-PROGRAM TO CA-PGM-LAST-PROGRAM   02450001
022400             END-IF                                               02460001
022410         END-IF                                                   02470001
022500     END-IF.                                                      02480001
022600                                                                  02490001
022700     EVALUATE TRUE                                                02500001
022800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02510001
022900             CONTINUE                                             02520001
023000         WHEN OTHER                                               02530001
023100            MOVE '0000-PROGRAM-MAINLINE' TO DP013-PARAGRAPH       02540001
023200            MOVE 'UNABLE TO ASSIGN USER-ID'                       02550001
023300              TO DP013-MESSAGE-TEXT (1)                           02560001
023400            SET DP013-LOGIC-ABEND        TO TRUE                  02570001
023500            SET DP013-NO-ROLLBACK        TO TRUE                  02580001
023600            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                02590001
023700     END-EVALUATE.                                                02600001
023900                                                                  02610001
024000     EVALUATE TRUE                                                02620001
024100         WHEN EIBCALEN = ZERO                                     02630001
024200             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    02640001
024300             PERFORM 8300-RETURN                                  02650001
024400                                                                  02660001
024500         WHEN CA-PGM-INITIALIZE-SCREEN                            02670001
024600         WHEN EIBAID = DFHCLEAR                                   02680001
024700             PERFORM 1000-INITIALIZE                              02690001
024800             PERFORM 8000-SEND-MAP                                02700001
024900             PERFORM 8200-RETURN-TRANID                           02710001
025000                                                                  02720001
025100         WHEN EIBAID = DFHENTER                                   02730001
025200             PERFORM 8100-SEND-DATA-ONLY                          02740001
025300             PERFORM 8200-RETURN-TRANID                           02750001
025400                                                                  02760001
025500         WHEN EIBAID = DFHPF3                                     02770001
025600             PERFORM 2000-RETURN-TO-PREV-PROG                     02780001
025700                                                                  02790001
025710         WHEN EIBAID = DFHPF1                                     02800001
025720              PERFORM 1400-HELP-SCREEN                            02810001
025730                                                                  02820001
025800         WHEN OTHER                                               02830001
025900             MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO           02840001
026000             PERFORM 8100-SEND-DATA-ONLY                          02850001
026100             PERFORM 8200-RETURN-TRANID                           02860001
026200     END-EVALUATE.                                                02870001
026300                                                                  02880001
026400     GOBACK.                                                      02890001
026500                                                                  02900001
019700******************************************************************02910005
026700 1000-INITIALIZE.                                                 02920001
026800                                                                  02930005
026900     MOVE CA-PGM-AUDIT-CNTL-NBR   TO SU026-AUDIT-NUMBER.          02940001
027000     SET SU026-COMPLETE TO TRUE.                                  02950001
047500                                                                  02960007
RFAUDT     MOVE CA-PGM-AUDIT-CNTL-NBR   TO DK-AUDIT-CNTL-NBR.           02970009
027100     PERFORM 7100-SELECT-LIMIT-DATE.                              02980001
027100                                                                  02990007
027200     MOVE SUT00015-PO-NBR         TO DK-PO-NBR.                   03000005
027300     MOVE SUT00015-PO-LNE-NBR     TO DK-PO-LINE-NBR.              03010005
027400     MOVE SUT00015-PO-PREPK-ID    TO DK-PREPK-ID.                 03020005
027500     PERFORM 7200-SELECT-FAILED.                                  03030001
047500                                                                  03040009
RFAUDT     SET PS-NO-FAILED-RFID-AUDITS TO TRUE.                        03050013
RFAUDT     IF SU006-QC-AND-RFID-AUD                                     03060013
RFAUDT        MOVE SU006-RFID-AUDIT-CNTL-NBR                            03070013
RFAUDT                                  TO DK-AUDIT-CNTL-NBR            03080013
RFAUDT        PERFORM 7100-SELECT-LIMIT-DATE                            03090013
RFAUDT                                                                  03100010
RFAUDT        MOVE SUT00015-PO-NBR      TO DK-PO-NBR                    03110013
RFAUDT        MOVE SUT00015-PO-LNE-NBR  TO DK-PO-LINE-NBR               03120013
RFAUDT        MOVE SUT00015-PO-PREPK-ID TO DK-PREPK-ID                  03130013
RFAUDT        PERFORM 7250-SELECT-RFID-FAILED                           03140013
RFAUDT     END-IF.                                                      03150013
027500                                                                  03160013
027600     IF  PS-NO-FAILED-AUDITS                                      03170013
RFAUDT     AND PS-NO-FAILED-RFID-AUDITS                                 03180010
027700         PERFORM 2000-RETURN-TO-PREV-PROG                         03190001
027800     END-IF.                                                      03200001
027800                                                                  03210005
027900     MOVE PS-MULTIPLE-FAILS-IND   TO SU026-MULTIPLE-FAILURE-IND.  03220013
028000     MOVE SUT00015-OPER-UNT-ID    TO SU026-OPER-UNIT-ID.          03230001
028100     PERFORM 7000-LINK-SUKCS594.                                  03240015
028200     MOVE SU026-OPER-UNIT-ID      TO PV-OPER-UNIT-ID.             03250001
028300     MOVE PV-OPER-UNIT-ID-X       TO ADCNBRO.                     03260001
028400     IF (SU006-QC-AUD-ONLY                                        03270015
RFAUDT     OR  SU006-QC-AND-RFID-AUD)                                   03280015
028400     AND PS-MULTIPLE-FAILS                                        03290015
028700         MOVE 'MULT'              TO AMULTDCO                     03300015
028600     ELSE                                                         03310015
028700         MOVE SPACES              TO AMULTDCO                     03320015
028800     END-IF.                                                      03330001
028800                                                                  03340005
028900     IF SU026-PO-STR-ERROR                                        03350001
029000         MOVE PC-CARTON-LEVEL-ERROR-MSG                           03360001
029100                                  TO ACRTERRO                     03370001
029200     END-IF.                                                      03380001
028800                                                                  03390005
029300     MOVE SPACES                  TO AFAIL1O                      03400005
029400                                     AFAIL2O                      03410005
029500                                     AFAIL3O                      03420005
RFAUDT                                     AFAIL4O                      03430005
RFAUDT                                     AFAIL5O.                     03440005
029600                                                                  03450005
029600     IF SU026-PICK-ERRORS > 0                                     03460001
029700         MOVE PC-PICK-ERRORS      TO AFAIL1O                      03470001
029800         IF SU026-PACK-ERRORS > 0                                 03480001
029900             MOVE PC-PACK-ERRORS  TO AFAIL2O                      03490005
030000             IF SU026-TICKET-ERRORS > 0                           03500001
030100                 MOVE PC-TCKT-ERRORS      TO AFAIL3O              03510001
030200             END-IF                                               03520001
030300         ELSE                                                     03530001
030400             IF SU026-TICKET-ERRORS > 0                           03540001
030500                 MOVE PC-TCKT-ERRORS      TO AFAIL2O              03550001
030600             END-IF                                               03560001
030700         END-IF                                                   03570001
030800     ELSE                                                         03580001
030900         IF SU026-PACK-ERRORS > 0                                 03590001
031000             MOVE PC-PACK-ERRORS      TO AFAIL1O                  03600001
031100             IF SU026-TICKET-ERRORS > 0                           03610001
031200                 MOVE PC-TCKT-ERRORS      TO AFAIL2O              03620001
031300             END-IF                                               03630001
031400         ELSE                                                     03640001
031500             IF SU026-TICKET-ERRORS > 0                           03650001
031600                 MOVE PC-TCKT-ERRORS      TO AFAIL1O              03660001
031700             END-IF                                               03670001
031800         END-IF                                                   03680001
031900     END-IF.                                                      03690015
027800                                                                  03700015
RFAUDT     IF SU006-QC-AND-RFID-AUD                                     03710015
027800       INITIALIZE SU026-CARTON-AUDIT-RECORD                       03720016
RFAUDT       MOVE SU006-RFID-AUDIT-CNTL-NBR                             03730015
026900                                    TO SU026-AUDIT-NUMBER         03740015
027000       SET SU026-COMPLETE TO TRUE                                 03750015
027900       MOVE PS-MULTIPLE-RFID-FAILS-IND                            03760015
027900                                    TO SU026-MULTIPLE-FAILURE-IND 03770015
028000       MOVE SUT00015-OPER-UNT-ID    TO SU026-OPER-UNIT-ID         03780015
028100       PERFORM 7000-LINK-SUKCS594                                 03790015
RFAUDT     END-IF.                                                      03800015
031900                                                                  03810015
RFAUDT     IF PS-MULTIPLE-RFID-FAILS                                    03820012
RFAUDT     OR SU026-RFID-ERRORS > 0                                     03830015
RFAUDT        MOVE PC-RFID-LVL-ERRORS       TO AFAIL4O                  03840005
RFAUDT        MOVE PC-RFID-ERRORS           TO AFAIL5O                  03850005
RFAUDT     END-IF.                                                      03860005
032000                                                                  03870001
019700******************************************************************03880005
032010 1400-HELP-SCREEN.                                                03890001
032010                                                                  03900005
032020     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      03910001
032030     MOVE 'SUKRF535'                  TO PC192-PROGRAM-NAME       03920001
032040     COPY PCPD188.                                                03930001
032050     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      03940001
032060     PERFORM 4200-XCTL-TO-HELP.                                   03950001
032070                                                                  03960001
019700******************************************************************03970005
032100 2000-RETURN-TO-PREV-PROG.                                        03980001
032070                                                                  03990005
032200     MOVE CA-PGM-LAST-PROGRAM      TO PV-TRANSFER-PROGRAM.        04000005
032300     IF CA-PGM-LAST-PROGRAM = PC-SU-AUDIT-DEF-PRMPT-PGM           04010001
032400         PERFORM 4000-XCTL-LRT-MENU                               04020001
032500     ELSE                                                         04030001
032600         PERFORM 4100-XCTL-AUDIT                                  04040001
032700     END-IF.                                                      04050001
032800                                                                  04060001
019700******************************************************************04070005
032900 4000-XCTL-LRT-MENU.                                              04080001
033000                                                                  04090001
033100     MOVE SU006-HOST-SAVE-AREA     TO CA-CHECK-IN-COMMAREA.       04100005
033300     SET SU001-INITIALIZE-SCREEN   TO TRUE.                       04110005
033400     MOVE LENGTH OF CA-CHECK-IN-COMMAREA                          04120001
033500                                   TO PV-COMMAREA-LENGTH.         04130001
033600     EXEC CICS                                                    04140001
033700         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    04150001
033800               COMMAREA  (CA-CHECK-IN-COMMAREA)                   04160001
033900               LENGTH    (PV-COMMAREA-LENGTH)                     04170001
034000               RESP      (PV-CICS-RESPONSE)                       04180001
034100     END-EXEC.                                                    04190001
034200                                                                  04200001
034300     EVALUATE TRUE                                                04210001
034400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04220001
034500             CONTINUE                                             04230001
032070                                                                  04240005
034600         WHEN OTHER                                               04250001
034700             MOVE '4000-XCTL-TO-LRT-MENU'                         04260001
034800                 TO DP013-PARAGRAPH                               04270001
034900             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   04280001
035000                 TO DP013-MESSAGE-TEXT (1)                        04290001
035100             MOVE PV-TRANSFER-PROGRAM                             04300001
035200                 TO DP013-MESSAGE-TEXT (2)                        04310001
035300             SET DP013-CICS-ABEND  TO TRUE                        04320001
035400             SET DP013-NO-ROLLBACK TO TRUE                        04330001
035500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               04340001
035600             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             04350001
035700             SET CA-PGM-PROCESS-SCREEN TO TRUE                    04360001
035800             PERFORM 8000-SEND-MAP                                04370001
035900             PERFORM 8200-RETURN-TRANID                           04380001
036000     END-EVALUATE.                                                04390001
036100                                                                  04400005
019700******************************************************************04410005
036200 4100-XCTL-AUDIT.                                                 04420001
036300                                                                  04430001
036400     MOVE PC-CURRENT-PROGRAM-NAME  TO SU006-LAST-PROGRAM.         04440001
036500     MOVE LENGTH OF CA-AUDIT-COMMAREA                             04450001
036600                                   TO PV-COMMAREA-LENGTH.         04460001
036700     EXEC CICS                                                    04470001
036800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    04480001
036900               COMMAREA  (CA-AUDIT-COMMAREA)                      04490001
037000               LENGTH    (PV-COMMAREA-LENGTH)                     04500001
037100               RESP      (PV-CICS-RESPONSE)                       04510001
037200     END-EXEC.                                                    04520001
037400                                                                  04530001
037500     EVALUATE TRUE                                                04540001
037600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04550001
037700             CONTINUE                                             04560001
032070                                                                  04570005
037800         WHEN OTHER                                               04580001
037900             MOVE '4000-XCTL-TO-LRT-MENU'                         04590001
038000                 TO DP013-PARAGRAPH                               04600001
038100             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   04610001
038200                 TO DP013-MESSAGE-TEXT (1)                        04620001
038300             MOVE PV-TRANSFER-PROGRAM                             04630001
038400                 TO DP013-MESSAGE-TEXT (2)                        04640001
038500             SET DP013-CICS-ABEND  TO TRUE                        04650001
038600             SET DP013-NO-ROLLBACK TO TRUE                        04660001
038700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               04670001
038800             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             04680001
038900             SET CA-PGM-PROCESS-SCREEN TO TRUE                    04690001
039000             PERFORM 8000-SEND-MAP                                04700001
039100             PERFORM 8200-RETURN-TRANID                           04710001
039200     END-EVALUATE.                                                04720001
039210                                                                  04730005
019700******************************************************************04740005
039220 4200-XCTL-TO-HELP.                                               04750001
039230                                                                  04760001
039240     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      04770001
039250     SET  CA-PGM-INITIALIZE-SCREEN    TO TRUE.                    04780001
039260     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    04790001
039270                                                                  04800001
039280     EXEC CICS                                                    04810001
039290         XCTL                                                     04820001
039291             PROGRAM   (PV-TRANSFER-PROGRAM)                      04830001
039292             COMMAREA  (PC192-COMMAREA)                           04840001
039293             LENGTH    (PV-COMMAREA-LENGTH)                       04850001
039294             RESP      (PV-CICS-RESPONSE)                         04860001
039295     END-EXEC.                                                    04870001
039296                                                                  04880001
039297     EVALUATE TRUE                                                04890001
039298         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04900001
039299              CONTINUE                                            04910001
032070                                                                  04920005
039300         WHEN OTHER                                               04930001
039301             MOVE '4200-XCTL-TO-HELP '                            04940001
039302                 TO DP013-PARAGRAPH                               04950001
039303             MOVE 'SUKRF535 - UNABLE TO XCTL TO PROGRAM: '        04960001
039304                 TO DP013-MESSAGE-TEXT (1)                        04970001
039305             MOVE PV-TRANSFER-PROGRAM                             04980001
039306                 TO DP013-MESSAGE-TEXT (2)                        04990001
039307             SET DP013-CICS-ABEND  TO TRUE                        05000001
039308             SET DP013-ROLLBACK TO TRUE                           05010001
039309             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               05020002
039310             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             05030001
039311             SET CA-PGM-PROCESS-SCREEN TO TRUE                    05040001
039312             PERFORM 8000-SEND-MAP                                05050001
039313             PERFORM 8200-RETURN-TRANID                           05060001
039314     END-EVALUATE.                                                05070001
039320                                                                  05080005
019700******************************************************************05090005
039500*  LINK TO SUKCS583 TO DETERMINE IF THE CARTON NEEDS TO BE AUDITED05100001
019700******************************************************************05110005
039700 7000-LINK-SUKCS594.                                              05120001
039800                                                                  05130001
039900     MOVE LENGTH OF CA-SUMMARY-COMMAREA  TO PV-COMMAREA-LENGTH.   05140005
040100                                                                  05150001
040200     EXEC CICS                                                    05160001
040300         LINK PROGRAM  (PC-SUKCS594)                              05170001
040400              COMMAREA (CA-SUMMARY-COMMAREA)                      05180001
040500              LENGTH   (PV-COMMAREA-LENGTH)                       05190001
040600              RESP     (PV-CICS-RESPONSE)                         05200001
040700     END-EXEC.                                                    05210001
040800                                                                  05220001
040900     EVALUATE TRUE                                                05230001
041000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05240001
041100              IF  SU026-INVALID-REQUEST OR                        05250001
041200                  SU026-DB2-ERROR                                 05260001
041300                  STRING ' SUKRF535 - '        DELIMITED BY SIZE  05270001
041400                         '7000-LINK-SUKCS594 ' DELIMITED BY SIZE  05280001
041500                         ' RETURN MESSAGE - '  DELIMITED BY SIZE  05290001
041600                         SU026-AUDIT-VALIDATION-SW                05300001
041700                                               DELIMITED BY SIZE  05310001
041800                                          INTO PV-CICS-MSG-AREA   05320001
041900                  MOVE LENGTH OF PV-CICS-MSG-AREA                 05330001
042000                                            TO PV-COMMAREA-LENGTH 05340001
042100                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          05350001
042200                                                                  05360001
042300                                                                  05370001
042400                  MOVE '7000-LINK-SUKCS594'                       05380001
042500                                  TO DP013-PARAGRAPH              05390001
042600                  MOVE 'LINK TO SUKCS594               '          05400001
042700                                  TO DP013-MESSAGE-TEXT(1)        05410001
042800                  STRING 'MSG - '            DELIMITED BY SIZE    05420001
042900                         SU026-AUDIT-VALIDATION-SW                05430001
043000                                             DELIMITED BY SIZE    05440001
043100                                  INTO DP013-MESSAGE-TEXT (2)     05450001
043200                  MOVE 'CHECK CSSL FOR MORE DETAIL     '          05460001
043300                                    TO DP013-MESSAGE-TEXT (3)     05470001
043400                  MOVE SQLCA     TO DP013-SQLCA                   05480001
043500                  SET DP013-DB2-ABEND                             05490001
043600                                  TO TRUE                         05500001
043700                  SET DP013-ROLLBACK                              05510001
043800                                  TO TRUE                         05520001
043900                  SET DP013-XCTL-DISPLAY-RESTART                  05530001
044000                                  TO TRUE                         05540001
044100                  PERFORM DP014-0000-PROCESS-ABEND                05550001
044200              END-IF                                              05560001
032070                                                                  05570005
044300         WHEN OTHER                                               05580001
044400              STRING ' PCKCS707 (OTHER) -' DELIMITED BY SIZE      05590001
044500                     '7000-LINK-SUKCS594 ' DELIMITED BY SIZE      05600001
044600                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      05610001
044700                     SU026-AUDIT-VALIDATION-SW                    05620001
044800                                           DELIMITED BY SIZE      05630001
044900                                      INTO PV-CICS-MSG-AREA       05640001
045000              MOVE LENGTH OF PV-CICS-MSG-AREA                     05650001
045100                                        TO PV-COMMAREA-LENGTH     05660001
045200              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              05670001
045300                                                                  05680001
045400              MOVE '7000-LINK-SUKCS594'                           05690001
045500                              TO DP013-PARAGRAPH                  05700001
045600              MOVE 'LINK TO SUKCS594               '              05710001
045700                              TO DP013-MESSAGE-TEXT(1)            05720001
045800              STRING 'MSG - '            DELIMITED BY SIZE        05730001
045900                     SU026-AUDIT-VALIDATION-SW                    05740001
046000                                         DELIMITED BY SIZE        05750001
046100                              INTO DP013-MESSAGE-TEXT (2)         05760001
046200              MOVE 'CHECK CSSL FOR MORE DETAIL     '              05770001
046300                                TO DP013-MESSAGE-TEXT (3)         05780001
046400              MOVE SQLCA     TO DP013-SQLCA                       05790001
046500              SET DP013-DB2-ABEND                                 05800001
046600                              TO TRUE                             05810001
046700              SET DP013-ROLLBACK                                  05820001
046800                              TO TRUE                             05830001
046900              SET DP013-XCTL-DISPLAY-RESTART                      05840001
047000                              TO TRUE                             05850001
047100              PERFORM DP014-0000-PROCESS-ABEND                    05860001
047200     END-EVALUATE.                                                05870001
047300                                                                  05880001
019700******************************************************************05890005
047400 7100-SELECT-LIMIT-DATE.                                          05900001
047700                                                                  05910001
047800     EXEC SQL                                                     05920001
047900       SELECT PO_NBR                                              05930001
048000           ,  PO_LNE_NBR                                          05940001
048100           ,  PO_PREPK_ID                                         05950001
048200           ,  OPER_UNT_ID                                         05960001
048300           ,  DAYS(CURRENT DATE) - (B.CK_AFT_DAY_QTY + 1)         05970001
048400       INTO   :SUT00015-PO-NBR                                    05980001
048500           ,  :SUT00015-PO-LNE-NBR                                05990001
048600           ,  :SUT00015-PO-PREPK-ID                               06000001
048700           ,  :SUT00015-OPER-UNT-ID                               06010001
048800           ,  :PV-LIMIT-DAYS                                      06020001
048900       FROM   SUT_PO_AUD_REQ A                                    06030001
049000           ,  SUT_PO_AUD_PARM B                                   06040001
049100       WHERE  A.AUD_CNTL_NBR  = :DK-AUDIT-CNTL-NBR                06050001
049200         AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                    06060001
049300         AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                   06070001
049400         AND  A.EFF_BEG_TMST  = B.EFF_BEG_TMST                    06080001
049500     END-EXEC.                                                    06090001
049600                                                                  06100001
049700     EVALUATE TRUE                                                06110001
049800         WHEN SQLCODE = ZERO                                      06120001
049900             CONTINUE                                             06130001
032070                                                                  06140005
050000         WHEN SQLWARN0 NOT = SPACES                               06150001
050100         WHEN SQLCODE NOT EQUAL ZERO                              06160001
050200             MOVE '7100-SELECT-LIMIT-DATE'                        06170001
050300                             TO DP013-PARAGRAPH                   06180001
050400             MOVE 'RETRIEVE LIMIT DATE '                          06190001
050500                             TO DP013-MESSAGE-TEXT(1)             06200001
050600             MOVE DK-AUDIT-CNTL-NBR  TO PV-DISPLAY-AUDIT-CNTL-NBR 06210001
050700             MOVE PV-DISPLAY-AUDIT-CNTL-NBR                       06220014
050800                             TO DP013-MESSAGE-TEXT(2)             06230001
050900             MOVE SQLCA      TO DP013-SQLCA                       06240001
056000             MOVE 'SUT00015'       TO DP013-DB2-TABLE-NAME (1)    06250014
056000             MOVE 'SUT00016'       TO DP013-DB2-TABLE-NAME (2)    06260014
051200             SET DP013-DB2-ABEND   TO TRUE                        06270001
051300             SET DP013-NO-ROLLBACK TO TRUE                        06280001
051400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               06290001
051500             MOVE PC-DB2-FATAL-ERROR-MSG TO AMSGLNO               06300001
051600             PERFORM 8100-SEND-DATA-ONLY                          06310001
051700             PERFORM 8200-RETURN-TRANID                           06320001
051800     END-EVALUATE.                                                06330001
051900                                                                  06340001
019700******************************************************************06350005
052100 7200-SELECT-FAILED.                                              06360001
052200                                                                  06370001
052300     EXEC SQL                                                     06380001
052400          SELECT AUD_CNTL_NBR                                     06390001
052500          INTO   :SUT00015-AUD-CNTL-NBR                           06400001
052600          FROM   SUT_PO_AUD_REQ                                   06410001
052700          WHERE  PO_NBR         = :DK-PO-NBR                      06420001
052800            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 06430001
052900            AND  PO_PREPK_ID    = :DK-PREPK-ID                    06440001
053000            AND  AUD_STAT_CDE   = :PC-F                           06450001
053100            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  06460001
053200     END-EXEC.                                                    06470001
053300                                                                  06480001
053400     EVALUATE TRUE                                                06490001
053500         WHEN SQLCODE = ZERO                                      06500001
053600             SET PS-NO-MULTIPLE-FAILS TO TRUE                     06510001
053300                                                                  06520006
053700         WHEN SQLCODE = +100                                      06530001
053800             SET PS-NO-FAILED-AUDITS  TO TRUE                     06540001
032070                                                                  06550005
053900         WHEN SQLCODE = -811                                      06560001
054000             SET PS-MULTIPLE-FAILS    TO TRUE                     06570001
032070                                                                  06580005
054100         WHEN SQLWARN0 NOT = SPACES                               06590001
054200         WHEN SQLCODE < ZERO                                      06600001
054300         WHEN SQLCODE > ZERO                                      06610001
054400             MOVE '7200-SELECT-FAILED'                            06620001
054500                                   TO DP013-PARAGRAPH             06630009
054600             MOVE 'SELECT OF SUT_PO_AUD_REQ TBL'                  06640001
054700                                   TO DP013-MESSAGE-TEXT (1)      06650009
054800             MOVE DK-PO-NBR        TO PV-DISPLAY-PO-NBR           06660001
054900             STRING 'PO NBR: '         DELIMITED BY SIZE          06670001
055000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          06680001
055100                           INTO DP013-MESSAGE-TEXT(2)             06690001
055200             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          06700001
055300                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          06710001
055400                           INTO DP013-MESSAGE-TEXT(3)             06720001
055500             MOVE DK-PREPK-ID      TO PV-DISPLAY-PREPK-ID         06730001
055600             STRING 'PRE PACK ID: '    DELIMITED BY SIZE          06740001
055700                PV-DISPLAY-PREPK-ID    DELIMITED BY SIZE          06750001
055800                           INTO DP013-MESSAGE-TEXT(4)             06760001
055900             MOVE SQLCA            TO DP013-SQLCA                 06770001
056000             MOVE 'SUT00015'       TO DP013-DB2-TABLE-NAME (1)    06780001
056100             SET DP013-DB2-ABEND   TO TRUE                        06790001
056200             SET DP013-NO-ROLLBACK TO TRUE                        06800001
056300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               06810001
056400             MOVE PC-DB2-FATAL-ERROR-MSG TO AMSGLNO               06820001
056500             PERFORM 8100-SEND-DATA-ONLY                          06830001
056600             PERFORM 8200-RETURN-TRANID                           06840001
056700     END-EVALUATE.                                                06850001
056800                                                                  06860001
RFAUDT******************************************************************06870006
RFAUDT 7250-SELECT-RFID-FAILED.                                         06880006
RFAUDT                                                                  06890006
RFAUDT     EXEC SQL                                                     06900006
RFAUDT          SELECT AUD_CNTL_NBR                                     06910006
RFAUDT          INTO   :SUT00015-AUD-CNTL-NBR                           06920006
RFAUDT          FROM   SUT_PO_AUD_REQ                                   06930006
RFAUDT          WHERE  PO_NBR         = :DK-PO-NBR                      06940006
RFAUDT            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 06950006
RFAUDT            AND  PO_PREPK_ID    = :DK-PREPK-ID                    06960006
RFAUDT            AND  AUD_STAT_CDE   = :PC-F                           06970006
RFAUDT            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  06980006
RFAUDT     END-EXEC.                                                    06990006
RFAUDT                                                                  07000006
RFAUDT     EVALUATE TRUE                                                07010006
RFAUDT         WHEN SQLCODE = ZERO                                      07020006
RFAUDT             SET PS-NO-MULTIPLE-RFID-FAILS TO TRUE                07030010
RFAUDT                                                                  07040006
RFAUDT         WHEN SQLCODE = +100                                      07050006
RFAUDT             SET PS-NO-FAILED-RFID-AUDITS  TO TRUE                07060010
RFAUDT                                                                  07070006
RFAUDT         WHEN SQLCODE = -811                                      07080006
RFAUDT             SET PS-MULTIPLE-RFID-FAILS    TO TRUE                07090010
RFAUDT                                                                  07100006
RFAUDT         WHEN SQLWARN0 NOT = SPACES                               07110006
RFAUDT         WHEN SQLCODE < ZERO                                      07120006
RFAUDT         WHEN SQLCODE > ZERO                                      07130006
RFAUDT             MOVE '7250-SELECT-RFID-FAILED'                       07140006
RFAUDT                                   TO DP013-PARAGRAPH             07150006
RFAUDT             MOVE 'SELECT OF SUT_PO_AUD_REQ TBL'                  07160006
RFAUDT                                   TO DP013-MESSAGE-TEXT (1)      07170006
RFAUDT             MOVE DK-PO-NBR        TO PV-DISPLAY-PO-NBR           07180006
RFAUDT             STRING 'PO NBR: '         DELIMITED BY SIZE          07190006
RFAUDT                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          07200006
RFAUDT                           INTO DP013-MESSAGE-TEXT(2)             07210006
RFAUDT             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          07220006
RFAUDT                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          07230006
RFAUDT                           INTO DP013-MESSAGE-TEXT(3)             07240006
RFAUDT             MOVE DK-PREPK-ID      TO PV-DISPLAY-PREPK-ID         07250006
RFAUDT             STRING 'PRE PACK ID: '    DELIMITED BY SIZE          07260006
RFAUDT                PV-DISPLAY-PREPK-ID    DELIMITED BY SIZE          07270006
RFAUDT                           INTO DP013-MESSAGE-TEXT(4)             07280006
RFAUDT             MOVE SQLCA            TO DP013-SQLCA                 07290006
RFAUDT             MOVE 'SUT00015'       TO DP013-DB2-TABLE-NAME (1)    07300006
RFAUDT             SET DP013-DB2-ABEND   TO TRUE                        07310006
RFAUDT             SET DP013-NO-ROLLBACK TO TRUE                        07320006
RFAUDT             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               07330006
RFAUDT             MOVE PC-DB2-FATAL-ERROR-MSG TO AMSGLNO               07340006
RFAUDT             PERFORM 8100-SEND-DATA-ONLY                          07350006
RFAUDT             PERFORM 8200-RETURN-TRANID                           07360006
RFAUDT     END-EVALUATE.                                                07370006
056800                                                                  07380006
RFAUDT******************************************************************07390006
057000 8000-SEND-MAP.                                                   07400001
057100                                                                  07410001
057200     EXEC CICS                                                    07420001
057300         SEND MAP       ('SU535A')                                07430001
057400              MAPSET    ('SUKM535')                               07440001
057500              ERASE                                               07450001
057600              CURSOR                                              07460001
057700              RESP      (PV-CICS-RESPONSE)                        07470001
057800     END-EXEC.                                                    07480001
057900                                                                  07490001
058000     EVALUATE TRUE                                                07500001
058100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07510001
058200             CONTINUE                                             07520001
032070                                                                  07530005
058300         WHEN OTHER                                               07540001
058400             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         07550001
058500             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  07560001
058600             SET DP013-CICS-ABEND      TO TRUE                    07570001
058700             SET DP013-NO-ROLLBACK     TO TRUE                    07580001
058800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               07590001
058900     END-EVALUATE.                                                07600001
059000                                                                  07610005
019700******************************************************************07620005
059100 8100-SEND-DATA-ONLY.                                             07630001
059200                                                                  07640001
059300     EXEC CICS                                                    07650001
059400         SEND MAP       ('SU535A')                                07660001
059500              MAPSET    ('SUKM535')                               07670001
059600              CURSOR                                              07680001
059700              DATAONLY                                            07690001
059800              RESP      (PV-CICS-RESPONSE)                        07700001
059900     END-EXEC.                                                    07710001
060000                                                                  07720001
060100     EVALUATE TRUE                                                07730001
060200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07740001
060300             CONTINUE                                             07750001
032070                                                                  07760005
060400         WHEN OTHER                                               07770001
060500             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        07780001
060600             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 07790001
060700             SET DP013-CICS-ABEND       TO TRUE                   07800001
060800             SET DP013-NO-ROLLBACK      TO TRUE                   07810001
060900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               07820001
061000     END-EVALUATE.                                                07830001
061100                                                                  07840005
019700******************************************************************07850005
061200 8200-RETURN-TRANID.                                              07860001
061300                                                                  07870001
061400     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH.          07880005
032070                                                                  07890005
061500     EXEC CICS                                                    07900001
061600         RETURN TRANSID  (PC-TRANID)                              07910001
061700                COMMAREA (CA-COMMAREA)                            07920001
061800                LENGTH   (PV-COMMAREA-LENGTH)                     07930001
061900                RESP     (PV-CICS-RESPONSE)                       07940001
062000     END-EXEC.                                                    07950001
062100                                                                  07960001
062200     EVALUATE TRUE                                                07970001
062300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07980001
062400             CONTINUE                                             07990001
032070                                                                  08000005
062500         WHEN OTHER                                               08010001
062600             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        08020001
062700             MOVE 'UNABLE TO RETURN TO TRANID'                    08030001
062800                 TO DP013-MESSAGE-TEXT (1)                        08040001
062900             SET DP013-CICS-ABEND       TO TRUE                   08050001
063000             SET DP013-NO-ROLLBACK      TO TRUE                   08060001
063100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               08070001
063200     END-EVALUATE.                                                08080001
063300                                                                  08090005
019700******************************************************************08100005
063400 8300-RETURN.                                                     08110001
063500                                                                  08120001
063600     EXEC CICS                                                    08130001
063700         SEND FROM (PV-MESSAGE-AREA)                              08140001
063800              LENGTH (19)                                         08150001
063900              ERASE                                               08160001
064000     END-EXEC.                                                    08170001
064100                                                                  08180001
064200     EXEC CICS                                                    08190001
064300         RETURN                                                   08200001
064400     END-EXEC.                                                    08210001
064500                                                                  08220005
019700******************************************************************08230005
064600 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  08240001
064700                                                                  08250001
064800     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              08260001
064900     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             08270001
065000     INITIALIZE DP013-SRC-TASK-NUMBER                             08280001
065100                DP013-STACK.                                      08290001
065200     SET DP013-LINK-RETURN TO TRUE.                               08300001
065300                                                                  08310001
065400     EXEC CICS                                                    08320001
065500         LINK                                                     08330001
065600             PROGRAM   (DP013-NAME)                               08340001
065700             COMMAREA  (DP013-PARAMETERS)                         08350001
065800             LENGTH    (DP013-LENGTH)                             08360001
065900     END-EXEC.                                                    08370001
032070                                                                  08380005
066000*----------------------------------------------------------------*08390001
066100*    ABEND PROCESSOR MODULE                                      *08400001
066200*----------------------------------------------------------------*08410001
066300                                                                  08420001
066400     COPY DPPD014.                                                08430003
066500                                                                  08440001
