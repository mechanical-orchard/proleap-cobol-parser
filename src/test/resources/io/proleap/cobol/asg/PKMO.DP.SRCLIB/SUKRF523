000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRF523.                                00050000
000600 AUTHOR.                 MICHAEL WALTERS.                         00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            SEPTEMBER, 1997.                         00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM DISPLAYS THE UPC INFORMATION SCREEN WHICH WILL     00120000
001300* ALLOW THE USER TO COMPARE THE SYSTEM INFO WITH THE GOODS        00130000
001310*  CHANGED 11/18/13 BY SHOBHIT BAIJAL                             00131013
001320*   PR# 5148D  ADD LOGIC TO SUBMIT ONE OR MORE JOBS FOR REPORTS   00132014
001330*              DEPENDING ON THE AUDIT TYPE                        00133014
001340*              QC OR RF AUDIT - SUBMIT JOB WITH 1 AUDIT CONTROL # 00134014
001350*              COMBINED AUDIT - SUBMIT 2 JOBS WITH 1 AUDIT CONTROL00135014
001360*                               FOR EACH OF RFID AND QC AUDIT     00136014
001370*              MANUAL AUDIT   - SUBMIT JOB WITH 1 AUDIT CONTROL # 00137014
001400******************************************************************00140000
001410* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00141014
001420* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00142014
001430* MAKING THE CALL DYNAMIC VS STATIC.                              00143014
001450******************************************************************00145013
001500                                                                  00150000
001600******************************************************************00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800******************************************************************00180000
001900                                                                  00190000
002000******************************************************************00200000
002100 DATA DIVISION.                                                   00210000
002200******************************************************************00220000
002300                                                                  00230000
002400******************************************************************00240000
002500 WORKING-STORAGE SECTION.                                         00250000
002600******************************************************************00260000
002700 01  CA-COMMAREA.                                                 00270000
002800     COPY SUWS006.                                                00280000
002900* * * * * * * * * * * *  PLEASE NOTE * * * * * * * * * * * *      00290000
003000* THE COMMAREA FROM HERE....                                      00300000
003100    05  CA-PROGRAM-COMMAREA.                                      00310000
003200         10  CA-SELECTION-X              PIC  X(02)  VALUE SPACES.00320000
003300         10  CA-SELECTION  REDEFINES  CA-SELECTION-X              00330000
003400                                         PIC  9(02).              00340000
003500     05  CA-SELECTION-TABLE.                                      00350000
003600         10  CA-SELECTION-RECORD                                  00360000
003700             OCCURS 25 TIMES.                                     00370000
003800             15  CA-RPT-NUMBER           PIC X(03)  VALUE SPACES. 00380000
003900             15  CA-RPT-DESC             PIC X(16)  VALUE SPACES. 00390000
004000     05  CA-PRTR-CNTL-IND                PIC  X(01).              00400000
004100     05  CA-TRACK-NBR                    PIC  9(01).              00410000
004200     05  CA-SYSTEM-ID.                                            00420000
004300         10  FILLER              PIC  X(04)   VALUE SPACE.        00430000
004400         10  CA-REGION-IND       PIC  X(01).                      00440000
004500             88  CA-TEST-CICS                 VALUE 'T'.          00450000
004600             88  CA-QA-CICS                   VALUE 'Q'.          00460000
004700             88  CA-PROD-CICS                 VALUE 'P'.          00470000
004800             88  CA-LEARN-CICS                VALUE 'L'.          00480000
004900         10  FILLER              PIC X(03)    VALUE SPACES.       00490000
005000     05  CA-MAX-IDX              PIC S9(04)   VALUE ZERO          00500000
005100                                              COMP.               00510000
005200     05  CA-LAST-TOP-IDX         PIC S9(04)   VALUE ZERO          00520000
005300                                              COMP.               00530000
005400*                                                                 00540000
005500 01  DK-DB2-KEYS.                                                 00550000
005600     05  DK-PO-NBR                       PIC S9(09) COMP.         00560000
005700     05  DK-OPER-UNT-ID                  PIC S9(09) COMP.         00570000
005800     05  DK-DEST-NBR                     PIC S9(04) COMP.         00580000
005810                                                                  00581021
005820     05  DK-WST-RPT-NAME                 PIC X(050) VALUE SPACE.  00582021
005830     05  DK-WST-RPT-NBR                  PIC X(015) VALUE SPACE.  00583021
005840     05  DK-WST-JOB                      PIC X(008) VALUE SPACE.  00584021
005850     05  DK-WST-AC-IN                    PIC X(002) VALUE SPACE.  00585021
005860     05  DK-WST-PROG-NBR                 PIC X(008) VALUE SPACE.  00586021
005870     05  DK-WST-MENU-SEQ                 PIC  S9(9) COMP.         00587021
005900*                                                                 00590000
006000 01  PC-PROGRAM-CONSTANTS.                                        00600000
006100     05  PC-LEAVE-SYSTEM-LENGTH         PIC S9(04)   VALUE +160   00610000
006200                                                     COMP SYNC.   00620000
006300     05  PC-REPORT-PGM                   PIC  X(08)  VALUE        00630000
006400         'SUKRP002'.                                              00640000
006500     05  PC-01                           PIC  X(02)  VALUE '01'.  00650000
006600     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE 3      00660000
006700                                                     COMP.        00670000
006800     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00680000
006900         'SUKRF523'.                                              00690031
007000     05  PC-PRTR-VALIDATION-PGM          PIC  X(08)  VALUE        00700000
007100         'DPKCS060'.                                              00710000
007200     05  PC-CURRENT-TRANID               PIC  X(04)  VALUE 'S523'.00720000
007300     05  PC-AUDIT-SUMMARY-DESC           PIC X(16)   VALUE        00730000
007400         'AUDIT SUMMARY   '.                                      00740000
007500     05  PC-AUDIT-DETAIL-DESC            PIC X(16)   VALUE        00750000
007600         'AUDIT DETAIL    '.                                      00760000
007700     05  PC-CARTON-DETAIL-DESC           PIC X(16)   VALUE        00770000
007800         'CARTON DETAIL   '.                                      00780000
007900     05  PC-RECEIVER-LIST-DESC           PIC X(16)   VALUE        00790000
008000         'RECEIVER LIST   '.                                      00800000
008100     05  PC-INPROCESS-AUDIT-DESC         PIC X(16)   VALUE        00810000
008200         'INPROCESS AUDITS'.                                      00820000
008300     05  PC-OPEN-CARTON-DESC             PIC X(16)   VALUE        00830000
008400         'OPEN CARTON     '.                                      00840000
008500     05  PC-RCVR-OVER-SHORT-DESC         PIC X(16)   VALUE        00850000
008600         'RCVR OVER/SHORT '.                                      00860000
008700     05  PC-ASS-LOC-SCREEN               PIC X(08)   VALUE        00870000
008800         'SUKRF508'.                                              00880000
008900     05  PC-AUDIT-STATUS-SCREEN          PIC X(08)   VALUE        00890000
009000         'SUKRF510'.                                              00900000
009100     05  PC-AUDIT-CLOSE-SCREEN           PIC X(08)   VALUE        00910000
009200         'SUKRF516'.                                              00920000
009300     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               00930000
009400                                           'TRANS NOT AVAILABLE'. 00940000
009410     05  PC-PRINT-TO-FILE                PIC  X(04) VALUE 'FILE'. 00941025
009420     05  PC-PRINT-TO-FILE-ERR-MSG   PIC X(19) VALUE               00942021
009430                                           'PRT-TO-FILE INVALID'. 00943021
009440     05  PC-REPORT-TO-FILE-ERR-MSG  PIC X(19) VALUE               00944021
009450                                           'RPT-TO-FILE UNAVAIL'. 00945021
009453     05  PC-COMMA                   PIC X(01) VALUE ','.          00945368
009460                                                                  00946068
009600                                                                  00960000
009700 01  SE-SYSTEM-ERROR-MESSAGE.                                     00970000
009800     05  FILLER                  PIC X(43)    VALUE               00980000
009900         'A SYSTEM ERROR HAS OCCURRED - CONTACT DP - '.           00990000
010000     05  FILLER                  PIC X(31)    VALUE               01000000
010100         'PROGRAM SUKRF523     '.                                 01010000
010200     05  SE-CICS-RESPONSE        PIC 9(4)     VALUE ZERO.         01020000
010300     05  FILLER                  PIC X(2)     VALUE SPACES.       01030000
010400     05  FILLER                  PIC X(14)    VALUE               01040000
010500         'ATTEMPTING TO '.                                        01050000
010600     05  SE-ATTEMPTED-ACTION     PIC X(61)    VALUE SPACES.       01060000
010700                                                                  01070000
010800 01  PS-PROGRAM-SWITCHES.                                         01080000
010900     05  PS-ABEND-IND                   PIC X(01)    VALUE 'N'.   01090000
011000         88  PS-NO-ABEND-IN-PROGRESS                 VALUE 'N'.   01100000
011100         88  PS-ABEND-IN-PROGRESS                    VALUE 'Y'.   01110000
011200     05  PS-INTERNAL-READER-ENQ-DEQ-IND                           01120000
011300                                        PIC X(01)    VALUE 'D'.   01130000
011400         88  PS-INTERNAL-READER-ENQUEUED             VALUE 'E'.   01140000
011500         88  PS-INTERNAL-READER-DEQUEUED             VALUE 'D'.   01150000
011600     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   01160000
011700         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   01170000
011800         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   01180000
011900     05  PS-AUDIT-NBR-IND                PIC  X(01)  VALUE 'N'.   01190000
012000         88  PS-AUDIT-NBR-NOT-EXISTS                 VALUE 'N'.   01200000
012100         88  PS-AUDIT-NBR-EXISTS                     VALUE 'Y'.   01210000
012200     05  PS-DEST-TYPE-IND                PIC  X(01)  VALUE ' '.   01220000
012300         88  PS-DEST-IS-A-DC                         VALUE 'D'.   01230000
012400         88  PS-DEST-IS-A-STR                        VALUE 'S'.   01240000
012500     05  PS-EOC-PO-LINE-CURSOR-IND       PIC  X(01)  VALUE 'N'.   01250000
012600         88  PS-NOT-EOC-PO-LINE-CURSOR               VALUE 'N'.   01260000
012700         88  PS-EOC-PO-LINE-CURSOR                   VALUE 'Y'.   01270000
012800     05  PS-DONE-IND                     PIC  X(01)  VALUE 'N'.   01280000
012900         88  PS-NOT-DONE                             VALUE 'N'.   01290000
013000         88  PS-DONE                                 VALUE 'Y'.   01300000
013010     05  PS-PRINT-TO-FILE-SW             PIC  X(01)  VALUE 'N'.   01301022
013020         88  PS-PRINT-TO-FILE-NO                     VALUE 'N'.   01302022
013030         88  PS-PRINT-TO-FILE-YES                    VALUE 'Y'.   01303022
013040     05  PS-REPORT-TO-FILE-SW            PIC  X(01)  VALUE 'N'.   01304022
013050         88  PS-REPORT-TO-FILE-NO                    VALUE 'N'.   01305022
013060         88  PS-REPORT-TO-FILE-YES                   VALUE 'Y'.   01306022
013100                                                                  01310000
013200 01  PV-PROGRAM-VARIABLES.                                        01320000
013300     05  PV-DISPLAY-KEYS.                                         01330000
013400         10 FILLER                       PIC X(12)                01340000
013500            VALUE 'KEY VALUES: '.                                 01350000
013600         10 PV-DISP-AUD-CNTL-NBR         PIC 9(09).               01360000
013700         10 FILLER                       PIC X(04)                01370000
013800            VALUE ' -- '.                                         01380000
013900         10 PV-DISP-SHIPT-UNT-ID         PIC 9(18).               01390000
014000         10 FILLER                       PIC X(04)                01400000
014100            VALUE ' -- '.                                         01410000
014200         10 PV-DISP-UPC-NBR              PIC 9(15).               01420000
014300         10 FILLER                       PIC X(04)                01430000
014400            VALUE ' -- '.                                         01440000
014500         10 PV-DISP-SCN-TMST             PIC X(26).               01450000
014510                                                                  01451021
014600     05  PV-DISP-SKU-NUMBER.                                      01460000
014700         10  PV-DISP-SKU-DEPT            PIC  X(03).              01470000
014800         10  FILLER                      PIC  X      VALUE '-'.   01480000
014900         10  PV-DISP-SKU-CLASS           PIC  X(02).              01490000
015000         10  FILLER                      PIC  X      VALUE '-'.   01500000
015100         10  PV-DISP-SKU-SEQ             PIC  X(03).              01510000
015200     05  PV-CURRENT-TIMESTAMP            PIC  X(26)  VALUE SPACE. 01520000
015300     05  PV-DB2-COUNT                    PIC S9(09)  VALUE ZERO   01530000
015400                                                     COMP.        01540000
015500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE ZERO   01550000
015600                                                     COMP SYNC.   01560000
015700     05  PV-SYSID                        PIC  X(04)  VALUE SPACE. 01570000
015800     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01580000
015900     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  01590000
016000                                                     COMP SYNC.   01600000
016100     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01610000
016200     05  PV-OPER-UNT-ID                  PIC S9(04)  VALUE ZEROS  01620000
016300                                                     COMP.        01630000
016400     05  PV-FCLTY-ID                     PIC S9(04)  VALUE ZEROS  01640000
016500                                                     COMP.        01650000
016600     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   01660000
016700                                                     COMP.        01670000
016800     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   01680000
016900                                                     COMP.        01690000
016910                                                                  01691021
016911     05  PV-CURR-TMST                    PIC X(26) VALUE SPACES.  01691182
016912     05  PV-CURR-TMST-R  REDEFINES PV-CURR-TMST.                  01691282
016913         10  PV-CURR-TMST-YEAR           PIC X(04).               01691382
016914         10  FILLER                      PIC X.                   01691482
016915         10  PV-CURR-TMST-MONTH          PIC X(02).               01691582
016916         10  FILLER                      PIC X.                   01691682
016917         10  PV-CURR-TMST-DAY            PIC X(02).               01691782
016918         10  FILLER                      PIC X.                   01691882
016919         10  PV-CURR-TMST-HOUR           PIC X(02).               01691982
016920         10  FILLER                      PIC X.                   01692082
016921         10  PV-CURR-TMST-MINUTE         PIC X(02).               01692182
016922         10  FILLER                      PIC X.                   01692282
016923         10  PV-CURR-TMST-SECOND         PIC X(02).               01692382
016924         10  FILLER                      PIC X.                   01692482
016925         10  PV-CURR-TMST-MICROSECOND    PIC X(06).               01692582
016926                                                                  01692682
016927     05  PV-WORK-TMST.                                            01692782
016928         10  PV-WORK-TMST-YEAR           PIC X(04).               01692882
016929         10  PV-WORK-TMST-MONTH          PIC X(02).               01692982
016930         10  PV-WORK-TMST-DAY            PIC X(02).               01693082
016931         10  PV-WORK-TMST-HOUR           PIC X(02).               01693182
016932         10  PV-WORK-TMST-MINUTE         PIC X(02).               01693282
016933         10  PV-WORK-TMST-SECOND         PIC X(02).               01693382
016935                                                                  01693582
016936     05  PV-WST-SEQ                      PIC S9(9) COMP.          01693682
016937     05  PV-WST-RPT-NAME                 PIC  X(50) VALUE SPACE.  01693782
016938     05  PV-WST-RPT-NBR                  PIC  X(15) VALUE SPACE.  01693882
016939     05  PV-WST-JOB                      PIC  X(08) VALUE SPACE.  01693982
016940     05  PV-WST-AC-IN                    PIC  X(02) VALUE SPACE.  01694082
016941     05  PV-WST-PROG-NBR                 PIC  X(08) VALUE SPACE.  01694182
016942     05  PV-WST-MENU-SEQ                 PIC S9(10)V9(5) COMP-3.  01694282
016950                                                                  01695077
017000     05  PV-SEL-IDX                      PIC S9(04)  VALUE ZERO   01700000
017100                                                     COMP.        01710000
017200     05  PV-TOP-IDX                      PIC S9(04)  VALUE ZERO   01720000
017300                                                     COMP.        01730000
017400     05  PV-TEMP-IDX                     PIC S9(04)  VALUE ZERO   01740000
017500                                                     COMP.        01750000
017600     05  PV-SEL-NUMBER-VALUES.                                    01760000
017700         10  FILLER                      PIC X(03) VALUE ' 1.'.   01770000
017800         10  FILLER                      PIC X(03) VALUE ' 2.'.   01780000
017900         10  FILLER                      PIC X(03) VALUE ' 3.'.   01790000
018000         10  FILLER                      PIC X(03) VALUE ' 4.'.   01800000
018100         10  FILLER                      PIC X(03) VALUE ' 5.'.   01810000
018200         10  FILLER                      PIC X(03) VALUE ' 6.'.   01820000
018300         10  FILLER                      PIC X(03) VALUE ' 7.'.   01830000
018400         10  FILLER                      PIC X(03) VALUE ' 8.'.   01840000
018500         10  FILLER                      PIC X(03) VALUE ' 9.'.   01850000
018600         10  FILLER                      PIC X(03) VALUE '10.'.   01860000
018700         10  FILLER                      PIC X(03) VALUE '11.'.   01870000
018800         10  FILLER                      PIC X(03) VALUE '12.'.   01880000
018900         10  FILLER                      PIC X(03) VALUE '13.'.   01890000
019000         10  FILLER                      PIC X(03) VALUE '14.'.   01900000
019100         10  FILLER                      PIC X(03) VALUE '15.'.   01910000
019200         10  FILLER                      PIC X(03) VALUE '16.'.   01920000
019300         10  FILLER                      PIC X(03) VALUE '17.'.   01930000
019400         10  FILLER                      PIC X(03) VALUE '18.'.   01940000
019500         10  FILLER                      PIC X(03) VALUE '19.'.   01950000
019600         10  FILLER                      PIC X(03) VALUE '20.'.   01960000
019700         10  FILLER                      PIC X(03) VALUE '21.'.   01970000
019800         10  FILLER                      PIC X(03) VALUE '22.'.   01980000
019900         10  FILLER                      PIC X(03) VALUE '23.'.   01990000
020000         10  FILLER                      PIC X(03) VALUE '24.'.   02000000
020100         10  FILLER                      PIC X(03) VALUE '25.'.   02010000
020200     05  PV-SEL-NUMBER-TABLE REDEFINES PV-SEL-NUMBER-VALUES.      02020000
020300         10  FILLER                                               02030000
020400             OCCURS 25 TIMES.                                     02040000
020500             15  PV-SEL-NUMBER           PIC X(03).               02050000
020600                                                                  02060000
020700******************************************************************02070000
020800*  JCL LINES FOR REQUESTING THE VARIOUS REPORT                    02080000
020900******************************************************************02090000
021000                                                                  02100000
021010* //SUK905   JOB KOHLS,'AUDIT SUMMARY',MSGCLASS=P,CLASS=Q         02101014
021011* //SUK910   JOB KOHLS,'AUDIT DETAIL ',MSGCLASS=P,CLASS=Q         02101114
021020                                                                  02102014
021100 01  JL-JCL-LINE-AREA.                                            02110000
021200     05  JL-JCL-LINE-1           PIC X(80).                       02120000
021300     05  JL-JOB-LINE-PROD.                                        02130000
021400         10  FILLER              PIC X(02)    VALUE               02140000
021500             '//'.                                                02150000
021600         10  JL-JOB-NAME         PIC X(08).                       02160000
021700         10  FILLER              PIC X(11)    VALUE               02170000
021800             ' JOB KOHLS,'.                                       02180000
021900         10  FILLER              PIC X(1)     VALUE QUOTE.        02190000
022000         10  JL-JOB-DESC         PIC X(13).                       02200000
022100         10  FILLER              PIC X(1)     VALUE QUOTE.        02210000
022200         10  FILLER              PIC X(19)    VALUE               02220000
022300             ',MSGCLASS=P,CLASS=Q'.                               02230000
022400         10  FILLER              PIC X(25)    VALUE SPACES.       02240057
022410                                                                  02241014
022420* //TKMA###  JOB KOHLS,'AUDIT SUMMARY',MSGCLASS=X,CLASS=E         02242014
022421* //TKMA###  JOB KOHLS,'AUDIT DETAIL ',MSGCLASS=X,CLASS=E         02242114
022430                                                                  02243014
022500     05  JL-JOB-LINE-TEST.                                        02250000
022600         10  FILLER              PIC X(02)    VALUE               02260000
022700             '//'.                                                02270000
022800         10  JL-TEST-JOB-NAME    PIC X(07)    VALUE SPACES.       02280000
022900         10  FILLER              PIC X(01)    VALUE               02290000
023000             'Q'.                                                 02300000
023100         10  FILLER              PIC X(11)    VALUE               02310000
023200             ' JOB KOHLS,'.                                       02320000
023300         10  FILLER              PIC X(1)     VALUE QUOTE.        02330000
023400         10  JL-TEST-JOB-DESC    PIC X(13).                       02340000
023500         10  FILLER              PIC X(1)     VALUE QUOTE.        02350000
023600         10  FILLER              PIC X(19)    VALUE               02360000
023700             ',MSGCLASS=X,CLASS=E'.                               02370000
023800         10  FILLER              PIC X(08)    VALUE               02380000
023900             ',NOTIFY='.                                          02390000
024000         10  JL-TEST-NOTIFY      PIC X(07)    VALUE SPACES.       02400000
024100         10  FILLER              PIC X(10)    VALUE SPACES.       02410057
024110                                                                  02411014
024120* /*JOBPARM K=0                                                   02412014
024130                                                                  02413014
024200     05  JL-JCL-LINE-3.                                           02420000
024300         10  FILLER              PIC X(13)    VALUE               02430000
024400             '/*JOBPARM K=0'.                                     02440000
024500         10  FILLER              PIC X(67)    VALUE SPACES.       02450000
024510                                                                  02451014
024520* //JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR                         02452014
024530                                                                  02453014
024600     05  JL-JCL-LINE-4-PROD.                                      02460000
024700         10  FILLER              PIC X(39)    VALUE               02470000
024800             '//JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR'.           02480000
024900         10  FILLER              PIC X(41)    VALUE SPACES.       02490000
024910                                                                  02491014
024920* //JOBLIB   DD DSN=TKMA.LOADLIB,DISP=SHR                         02492014
024930                                                                  02493014
025000     05  JL-JCL-LINE-4-TEST.                                      02500000
025100         10  FILLER              PIC X(39)    VALUE               02510000
025200             '//JOBLIB   DD DSN=TKMA.LOADLIB,DISP=SHR'.           02520000
025300         10  FILLER              PIC X(41)    VALUE SPACES.       02530000
025310                                                                  02531014
025320* //JOBLIB   DD DSN=QKMO.LOADLIB,DISP=SHR                         02532014
025330                                                                  02533014
025400     05  JL-JCL-LINE-4-QA.                                        02540000
025500         10  FILLER              PIC X(39)    VALUE               02550000
025600             '//JOBLIB   DD DSN=QKMO.LOADLIB,DISP=SHR'.           02560000
025700         10  FILLER              PIC X(41)    VALUE SPACES.       02570000
025710                                                                  02571014
025720* //JOBLIB   DD DSN=LKMO.LOADLIB,DISP=SHR                         02572014
025730                                                                  02573014
025800     05  JL-JCL-LINE-4-LEARN.                                     02580000
025900         10  FILLER              PIC X(39)    VALUE               02590000
026000             '//JOBLIB   DD DSN=LKMO.LOADLIB,DISP=SHR'.           02600000
026100         10  FILLER              PIC X(41)    VALUE SPACES.       02610000
026110                                                                  02611014
026621* //PS010    EXEC SUK9051,                                        02662172
026622* //PS010    EXEC SUK9101,                                        02662272
026623* //PS010    EXEC SUK9151,                                        02662372
026624* //PS010    EXEC SUK9201,                                        02662472
026625* //PS010    EXEC SUK9251,                                        02662572
026626* //PS010    EXEC SUK9351,                                        02662672
026627* //PS010    EXEC SUK9301,                                        02662772
026628                                                                  02662872
026629     05  JL-JCL-LINE-12-PROD.                                     02662965
026630         10  FILLER              PIC X(16)    VALUE               02663065
026631             '//PS010    EXEC '.                                  02663165
026632         10  JL-PROD-PROC-NAME   PIC X(07).                       02663272
026633         10  JL-PROD-COMMA       PIC X(01)    VALUE SPACE.        02663365
026634         10  FILLER              PIC X(56)    VALUE SPACEs.       02663472
026677                                                                  02667767
026678     05  JL-JCL-LINE-12-LLE.                                      02667867
026679         10  FILLER              PIC X(16)    VALUE               02667967
026680             '//PS010    EXEC '.                                  02668067
026681         10  JL-LLE-PROC-NAME    PIC X(08).                       02668172
026682         10  JL-LLE-COMMA        PIC X(01)    VALUE SPACE.        02668267
026683         10  FILLER              PIC X(55)    VALUE SPACES.       02668374
026730                                                                  02673065
026731*     this is the symbolic used to create the mft report file     02673172
026732* //         rdt=ccyymmddyyss   rdt = run date                    02673284
026737*                                                                 02673772
026738     05  JL-JCL-LINE-13.                                          02673872
026739         10  FILLER              PIC X(15)    VALUE               02673977
026740             '//         RDT='.                                   02674081
026746         10  JL-CURR-TMST        PIC X(12).                       02674684
026747         10  FILLER              PIC X(01)    VALUE ','.          02674772
026748         10  FILLER              PIC X(52)    VALUE spaces.       02674884
026749                                                                  02674972
026750*     this is the symbolic used to create the mft report file     02675077
026751* //         DC=0810,                                             02675177
026752*                                                                 02675277
026753     05  JL-JCL-LINE-14.                                          02675377
026754         10  FILLER              PIC X(14)    VALUE               02675477
026755             '//         DC='.                                    02675577
026756         10  JL-FILE-OPER        PIC 9(04).                       02675677
026757         10  FILLER              PIC X(01)    VALUE ','.          02675777
026758         10  FILLER              PIC X(61)    VALUE spaces.       02675877
026759                                                                  02675977
026760*     this is the symbolic used to create the mft report file     02676072
026761* //         USERID=TK#####,                                      02676172
026762*                                                                 02676272
026763     05  JL-JCL-LINE-15.                                          02676377
026764         10  FILLER              PIC X(18)    VALUE               02676473
026765             '//         USERID='.                                02676572
026766         10  JL-FILE-USERID      PIC X(07).                       02676672
026767         10  FILLER              PIC X(01)    VALUE ','.          02676772
026768         10  FILLER              PIC X(54)    VALUE spaces.       02676873
026769                                                                  02676972
026770*     this is the symbolic used to create the mft report file     02677072
026771* //         AUDNBR=9999999999,                                   02677172
026772*                                                                 02677272
026773     05  JL-JCL-LINE-16.                                          02677377
026774         10  FILLER              PIC X(18)    VALUE               02677473
026775             '//         AUDNBR='.                                02677572
026776         10  JL-FILE-AUDIT-NBR   PIC 9(10).                       02677672
026777         10  FILLER              PIC X(01)    VALUE ','.          02677772
026778         10  FILLER              PIC X(51)    VALUE SPACES.       02677873
026779                                                                  02677972
026780*     this is the symbolic used to create the mft report file     02678072
026781* //         RPT=XXXXXXXXXXXXXXXXXXXX                             02678172
026782*                                                                 02678272
026783     05  JL-JCL-LINE-17.                                          02678377
026784         10  FILLER              PIC X(15)    VALUE               02678473
026785             '//         RPT='.                                   02678573
026786         10  JL-FILE-RPT         PIC X(20).                       02678672
026787         10  JL-FILE-RPT-R1 REDEFINES JL-FILE-RPT.                02678772
026788             15 JL-RPT-NAME-R1   PIC X(20).                       02678876
026789                88  JL-AUDIT-DTL     VALUE 'AUDITDETAIL         '.02678976
026790         10  JL-FILE-RPT-R2 REDEFINES JL-FILE-RPT.                02679072
026791             15 JL-RPT-NAME-R2   PIC X(20).                       02679176
026792                88  JL-AUDIT-SUM     VALUE 'AUDITSUMMARY        '.02679276
026793         10  JL-FILE-RPT-R3 REDEFINES JL-FILE-RPT.                02679372
026794             15 JL-RPT-NAME-R3   PIC X(20).                       02679476
026795                88  JL-CARTON-DTL    VALUE 'CARTONDETAIL        '.02679576
026796         10  JL-FILE-RPT-R4 REDEFINES JL-FILE-RPT.                02679672
026797             15 JL-RPT-NAME-R4   PIC X(20).                       02679776
026798                88  JL-RECEIVER-LIST VALUE 'RECEIVERLIST        '.02679876
026799         10  JL-FILE-RPT-R5 REDEFINES JL-FILE-RPT.                02679972
026800             15 JL-RPT-NAME-R5   PIC X(20).                       02680076
026801                88  JL-INPROCESS-AUD VALUE 'INPROCESSAUD        '.02680176
026802         10  JL-FILE-RPT-R6 REDEFINES JL-FILE-RPT.                02680272
026803             15 JL-RPT-NAME-R6   PIC X(20).                       02680376
026804                88  JL-CARTON-OPEN   VALUE 'CARTONOPEN          '.02680476
026806         10  JL-FILE-RPT-R7 REDEFINES JL-FILE-RPT.                02680672
026807             15 JL-RPT-NAME-R7   PIC X(20).                       02680776
026808                88  JL-OVER-SHORT    VALUE 'RCVR-OVERSHRT       '.02680876
026809             15  FILLER          PIC X(08).                       02680972
026812         10  FILLER              PIC X(51)    VALUE SPACES.       02681273
026813                                                                  02681372
026815                                                                  02681572
026865* //JOBOUT01 OUTPUT FORMS=STD,FCB=8S,CLASS=A,COPIES=1,DEST=U####  02686572
026866                                                                  02686672
026867     05  JL-JCL-LINE-18.                                          02686781
026870         10  FILLER              PIC  X(34)  VALUE                02687072
026900             '//JOBOUT01 OUTPUT FORMS=STD,FCB=8S'.                02690000
027000         10  FILLER              PIC  X(17)  VALUE                02700000
027100             ',CLASS=A,COPIES=1'.                                 02710000
027200         10  FILLER              PIC  X(06)  VALUE                02720000
027300             ',DEST='.                                            02730000
027400         10  JL-LINE-18-PRINTER  PIC  X(08)  VALUE SPACES.        02740081
027500         10  FILLER              PIC  X(16)  VALUE SPACE.         02750000
027600                                                                  02760014
027610* //JOBOUT01 OUTPUT CLASS=Z                                       02761087
027620                                                                  02762087
027630     05  JL-JCL-LINE-18B.                                         02763087
027640         10  FILLER              PIC  X(34)  VALUE                02764087
027650             '//JOBOUT01 OUTPUT CLASS=Z         '.                02765087
027692         10  FILLER              PIC  X(47)  VALUE SPACE.         02769287
027693                                                                  02769387
027700* //S010.SYSUT1 DD *                                              02770014
027710* //S175.SYSUT1 DD *                                              02771014
027720* //S140.SYSUT1 DD *                                              02772015
027800                                                                  02780014
028300     05  JL-SYSUT1-PARM-LINE.                                     02830000
028400         10  FILLER              PIC X(02)    VALUE               02840000
028500             '//'.                                                02850000
028600         10  JL-SYSUT1-STEP      PIC X(04)    VALUE SPACE.        02860000
028700         10  FILLER              PIC X(12)    VALUE               02870000
028800             '.SYSUT1 DD *'.                                      02880000
028900         10  FILLER              PIC X(61)    VALUE SPACES.       02890057
028910                                                                  02891014
028920* FOR SUK905 - S010 - SUCC014 - JL-SYSUT1-AUD-CNTL-LINE           02892014
028930* FOR SUK905 - S175 - SUCC015 - JL-SYSUT1-PRT-LINE                02893014
028931* FOR SUK910 - S010 - SUCC016 - JL-SYSUT1-AUD-CNTL-LINE           02893114
028932* FOR SUK910 - S140 - SUCC017 - JL-SYSUT1-PRT-LINE                02893214
028940                                                                  02894014
029000     05  JL-SYSUT1-PARM-VALUE    PIC X(80)    VALUE SPACES.       02900000
029010                                                                  02901014
029020* /*EOF                                                           02902014
029030                                                                  02903014
029100     05  JL-JCL-LINE-EOF.                                         02910000
029200         10  FILLER              PIC X(5)     VALUE '/*EOF'.      02920000
029300         10  FILLER              PIC X(75)    VALUE SPACES.       02930000
029400                                                                  02940000
029500 01  JL-SYSUT1-VALUES.                                            02950000
029600     05  JL-SYSUT1-AUD-CNTL-LINE.                                 02960000
029700         10  JL-SYSUT1-AUD-CNTL-NBR                               02970000
029800                                 PIC 9(09).                       02980000
029900         10  JL-SYSUT1-SHIP-UNT-NBR                               02990000
030000                                 PIC 9(18).                       03000000
030010                                                                  03001020
030011         10  JL-SYSTEM-MANUAL-AUDIT                               03001100
030012                                 PIC X(01)    VALUE SPACES.       03001200
030013             88  JL-SYSTEM-GENERATED-AUDIT    VALUE 'S'.          03001300
030014             88  JL-MANUAL-GENERATED-AUDIT    VALUE 'M'.          03001400
030015         10  JL-RFID-QC-AUDIT-IND                                 03001500
030016                                 PIC X(01)    VALUE SPACES.       03001600
030017             88  JL-RFID-AUDIT                VALUE 'R'.          03001700
030018             88  JL-QC-AUDIT                  VALUE 'S'.          03001800
030019         10  JL-RFID-QC-AUD-CMB-IND                               03001900
030020                                 PIC X(01)    VALUE SPACES.       03002000
030021             88  JL-RFID-AUD-ONLY             VALUE 'R'.          03002100
030022             88  JL-QC-AUD-ONLY               VALUE 'S'.          03002200
030023             88  JL-QC-AND-RFID-AUD           VALUE 'B'.          03002300
030100         10  FILLER              PIC X(50)    VALUE SPACES.       03010000
030110                                                                  03011020
030200     05  JL-SYSUT1-PRT-LINE.                                      03020000
030300         10  JL-SYSUT1-PRINTER   PIC X(08)    VALUE SPACES.       03030000
030400         10  JL-SYSUT1-PRTR-IND  PIC X(01)    VALUE SPACES.       03040000
030500         10  JL-SYSUT1-TRACK-NBR PIC  9(1)    VALUE 0.            03050000
030700         10  JL-SYSUT1-BRCDE-IND PIC X(01)    VALUE SPACES.       03070000
030800         10  JL-SYSUT1-CUT-IND   PIC X(01)    VALUE SPACES.       03080000
030801*                                                                 03080115
030810         10  JL-CNTL-CARD-OPER   PIC 9(04)    VALUE ZEROES.       03081015
030820         10  JL-CNTL-CARD-USERID PIC X(08)    VALUE SPACES.       03082015
030821         10  JL-CNTL-CARD-AUD-NBR                                 03082115
030822                                 PIC 9(09)    VALUE ZEROES.       03082215
030830*                                                                 03083015
030900         10  FILLER              PIC X(47)    VALUE SPACES.       03090015
031000                                                                  03100000
031100 01  TD-TRANSIENT-DATA-AREA.                                      03110000
031200     05  TD-QUEUE-NAME           PIC X(4)     VALUE 'IRTD'.       03120000
031300     05  TD-QUEUE-NAME-LENGTH    PIC S9(4)    VALUE +4            03130000
031400                                 COMP SYNC.                       03140000
031500     05  TD-JCL-LINE             PIC X(80)    VALUE SPACES.       03150000
031600     05  TD-JCL-LINE-LENGTH      PIC S9(4)    VALUE +80           03160000
031700                                 COMP SYNC.                       03170000
031800                                                                  03180000
031900                                                                  03190000
032000*                                                                 03200000
032100******************************************************************03210000
032200*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      03220000
032300******************************************************************03230000
032400     COPY DFHAID.                                                 03240000
032500                                                                  03250000
032600                                                                  03260000
032700******************************************************************03270000
032800*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                03280000
032900******************************************************************03290000
033000     COPY DPWS013.                                                03300000
033100                                                                  03310000
033200******************************************************************03320000
033300*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 03330000
033400*****************************************************************.03340000
033500     COPY DPWS010I.                                               03350000
033600                                                                  03360000
033700******************************************************************03370000
033800*  GENERATED DSECT FOR THE SUKM523 MAPSET                         03380000
033900******************************************************************03390000
034000     COPY SUKM523.                                                03400000
034100                                                                  03410000
034200******************************************************************03420000
034300*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   03430000
034400******************************************************************03440000
034500     COPY DPWS015.                                                03450000
034600                                                                  03460000
034700*----------------------------------------------------------------*03470000
034800* HELP SCREEN COMMAREA                                            03480000
034900     COPY PCWS192.                                                03490000
035000*----------------------------------------------------------------*03500000
035100* HELP SCREEN WORK AREA                                           03510000
035200     COPY PCWS188.                                                03520000
035300                                                                  03530000
035400******************************************************************03540000
035500*  COPY BOOK CONTAINING MESSAGES USED IN THE MESSAGE SCREEN       03550000
035600*  (SUKRF514)                                                     03560000
035700******************************************************************03570000
035800     COPY SUWS007.                                                03580000
035900                                                                  03590000
036000******************************************************************03600000
036100*  COPY BOOK CONTAINING ERROR/WARNING/INFORMATIONAL MESSAGES      03610000
036200*  TO BE DISPLAYED ON THE LRT                                     03620000
036300******************************************************************03630000
036400     COPY SUWS005.                                                03640000
036500                                                                  03650000
036600******************************************************************03660000
036700*  SENDING/RECEIVING AREA FOR THE                                 03670000
036800*  PRINTER VALIDATION ROUTING (DPKCS060)                          03680000
036900******************************************************************03690000
037000     COPY DPWS072.                                                03700000
037100                                                                  03710000
037200******************************************************************03720000
037300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE COMPANY CONTROL    03730000
037400*  TABLE (TCOCNTL)                                                03740000
037500******************************************************************03750000
037600     EXEC SQL                                                     03760000
037700         INCLUDE TCOCNTL                                          03770000
037800     END-EXEC.                                                    03780000
037900                                                                  03790000
038000******************************************************************03800000
038100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      03810000
038200*  AUDIT TABLE (TSUNAUD)                                          03820000
038300******************************************************************03830000
038400     EXEC SQL                                                     03840000
038500         INCLUDE TSUNAUD                                          03850000
038600     END-EXEC.                                                    03860000
038700                                                                  03870000
038800******************************************************************03880000
038900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      03890000
039000*  AUDIT TRANSATION TABLE (TSUATRN)                               03900000
039100******************************************************************03910000
039200     EXEC SQL                                                     03920000
039300         INCLUDE TSUATRN                                          03930000
039400     END-EXEC.                                                    03940000
039500                                                                  03950000
039600******************************************************************03960000
039700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     03970000
039800*  AGREEMENT TABLE (TPOAGMT)                                      03980000
039900******************************************************************03990000
040000     EXEC SQL                                                     04000000
040100         INCLUDE TPOAGMT                                          04010000
040200     END-EXEC.                                                    04020000
040300                                                                  04030000
040310******************************************************************04031021
040320*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 04032021
040330******************************************************************04033021
040340     EXEC SQL                                                     04034021
040350          INCLUDE TKRPRPM                                         04035021
040360     END-EXEC.                                                    04036021
040370                                                                  04037021
040380******************************************************************04038021
040390*    WST_INTGRTN_TYP                                              04039021
040391******************************************************************04039121
040392     EXEC SQL                                                     04039221
040393         INCLUDE WST00008                                         04039321
040394     END-EXEC.                                                    04039421
040395                                                                  04039521
040396******************************************************************04039621
040397*    WST_ATTR_DEFN                                                04039721
040398******************************************************************04039821
040399     EXEC SQL                                                     04039921
040400         INCLUDE WST00009                                         04040021
040401     END-EXEC.                                                    04040121
040402                                                                  04040221
040403******************************************************************04040321
040404*    WST_ATTR_ELEM                                                04040421
040405******************************************************************04040521
040406     EXEC SQL                                                     04040621
040407         INCLUDE WST00010                                         04040721
040408     END-EXEC.                                                    04040821
040409                                                                  04040921
040410******************************************************************04041000
040500*  COMMUNICATIONS AREA FOR DB2                                    04050000
040600******************************************************************04060000
040700     EXEC SQL                                                     04070000
040800         INCLUDE SQLCA                                            04080000
040900     END-EXEC.                                                    04090000
041000                                                                  04100000
041100******************************************************************04110000
041200 LINKAGE SECTION.                                                 04120000
041300******************************************************************04130000
041400 01  DFHCOMMAREA.                                                 04140000
041500     05  FILLER                         OCCURS  1 TO 4072 TIMES   04150000
041600                                        DEPENDING ON EIBCALEN.    04160000
041700         10  FILLER                     PIC X.                    04170000
041800                                                                  04180000
041900                                                                  04190000
042000******************************************************************04200000
042100 PROCEDURE DIVISION.                                              04210000
042200******************************************************************04220000
042300 0000-PROGRAM-MAINLINE.                                           04230000
042400     MOVE DFHCOMMAREA  TO  CA-COMMAREA.                           04240000
042500     MOVE LOW-VALUES   TO  SU523AI.                               04250000
042600                                                                  04260000
042700     EVALUATE TRUE                                                04270000
042800****************************************************************  04280000
042900* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        04290000
043000****************************************************************  04300000
043100         WHEN EIBTRNID = 'Z278'                                   04310000
043200             MOVE DFHCOMMAREA          TO PC192-COMMAREA          04320000
043300             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             04330000
043400             SET SU006-PROCESS-SCREEN  TO TRUE                    04340000
043500             PERFORM 1000-SETUP-SCREEN                            04350000
043600             PERFORM 8000-SEND-MAP                                04360000
043700             PERFORM 8200-RETURN-TRANID                           04370000
043800                                                                  04380000
043900         WHEN EIBCALEN = ZERO                                     04390000
044000         WHEN EIBAID = DFHCLEAR                                   04400000
044100         WHEN SU006-INITIALIZE-SCREEN                             04410000
044200             INITIALIZE CA-PROGRAM-COMMAREA                       04420000
044300             SET SU006-PROCESS-SCREEN TO TRUE                     04430000
044400             PERFORM 1000-SETUP-SCREEN                            04440000
044500                                                                  04450000
044600             PERFORM 8000-SEND-MAP                                04460000
044700             PERFORM 8200-RETURN-TRANID                           04470000
044800                                                                  04480000
044900         WHEN EIBAID = DFHENTER                                   04490000
045000             PERFORM 1200-RECEIVE-MAP                             04500000
045100             PERFORM 1300-EDIT-SELECTION                          04510000
045200                                                                  04520000
045300             PERFORM 2000-PROCESS-SCREEN                          04530000
045310             MOVE SPACES  TO  AMSGLNO                             04531033
045400             STRING 'REPORT '                                     04540000
045500                    CA-SELECTION-X                                04550000
045600                    ' PRINTED ' DELIMITED BY SIZE                 04560000
045700                                      INTO  AMSGLNO               04570000
045800             MOVE -1                 TO ASELECTL                  04580000
045900             MOVE SPACES             TO ASELECTO                  04590000
046000                                        CA-SELECTION-X            04600000
046100                                                                  04610000
046200                                                                  04620000
046300*        THE "F3" KEY WAS PRESSED -- CONTROL IS PASSED TO THE     04630000
046400*        SCREEN THAT CALLED IT                                    04640000
046500         WHEN EIBAID = DFHPF3                                     04650000
046600             MOVE SU006-LAST-PROGRAM    TO  PV-TRANSFER-PROGRAM   04660000
046700             MOVE PC-CURRENT-PROGRAM-NAME                         04670000
046800                                        TO  SU006-LAST-PROGRAM    04680000
046900             PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                04690000
047000                                                                  04700000
047100                                                                  04710000
047200*        THE "F7" KEY WAS PRESSED -- SCROLL BACKWARDS 5 ITEMS     04720000
047300         WHEN EIBAID = DFHPF7                                     04730000
047400             COMPUTE PV-TOP-IDX = CA-LAST-TOP-IDX - 5             04740000
047500             PERFORM 1005-MOVE-TO-SCREEN                          04750000
047600             MOVE -1                 TO ASELECTL                  04760000
047700                                                                  04770000
047800*        THE "F8" KEY WAS PRESSED -- SCROLL BACKWARDS 5 ITEMS     04780000
047900         WHEN EIBAID = DFHPF8                                     04790000
048000             COMPUTE PV-TOP-IDX = CA-LAST-TOP-IDX + 5             04800000
048100             PERFORM 1005-MOVE-TO-SCREEN                          04810000
048200             MOVE -1                 TO ASELECTL                  04820000
048300                                                                  04830000
048400         WHEN EIBAID = DFHPF1                                     04840000
048500              PERFORM 1400-HELP-SCREEN                            04850000
048600                                                                  04860000
048700         WHEN OTHER                                               04870000
048800             MOVE PM-UNRECOGNIZED-PF-KEY-MSG                      04880000
048900                                        TO  AMSGLNO               04890000
049000                                                                  04900000
049100     END-EVALUATE.                                                04910000
049200                                                                  04920000
049300     PERFORM 8100-SEND-DATA-ONLY.                                 04930000
049400     PERFORM 8200-RETURN-TRANID.                                  04940000
049500                                                                  04950000
049600     GOBACK.                                                      04960000
049700****************************************************************  04970000
049800* 1000-SETUP-SCREEN                                               04980000
049900*    SETUP THE LIST OF AUDIT NUMBER AND STATUS                    04990023
050000****************************************************************  05000000
050100 1000-SETUP-SCREEN.                                               05010000
050200                                                                  05020000
050300     MOVE +1 TO PV-SEL-IDX.                                       05030000
050400     INITIALIZE CA-SELECTION-TABLE.                               05040000
050500                                                                  05050000
050600*    GET DEFAULT PRINTER ID                                       05060000
050700     IF SU006-PRINTER-DEST = SPACES                               05070000
050800         PERFORM 1010-GET-DEFAULT-PRINTER                         05080000
050900     END-IF.                                                      05090000
051000                                                                  05100000
051100     MOVE SU006-PRINTER-DEST TO ADESTO.                           05110000
051200                                                                  05120000
051300                                                                  05130000
051400*    IF COMING FROM THE ASSOCIATE LOCATION SCREEN(SUKRF508), THE  05140000
051500*    "AUDIT SUMMARY REPORT" IS NOT AVAILABLE                      05150000
051600     IF SU006-LAST-PROGRAM = PC-ASS-LOC-SCREEN                    05160000
051700         CONTINUE                                                 05170000
051800     ELSE                                                         05180000
051900         MOVE PC-AUDIT-SUMMARY-DESC TO CA-RPT-DESC (PV-SEL-IDX)   05190000
052000         MOVE PV-SEL-NUMBER (PV-SEL-IDX)                          05200000
052100                                   TO  CA-RPT-NUMBER (PV-SEL-IDX) 05210000
052200         ADD +1 TO PV-SEL-IDX                                     05220000
052300     END-IF.                                                      05230000
052400                                                                  05240000
052500*    IF COMING FROM THE ASSOCIATE LOCATION SCREEN(SUKRF508), THE  05250000
052600*    "AUDIT DETAIL REPORT" IS NOT AVAILABLE                       05260000
052700     IF SU006-LAST-PROGRAM = PC-ASS-LOC-SCREEN                    05270000
052800         CONTINUE                                                 05280000
052900     ELSE                                                         05290000
053000         MOVE PC-AUDIT-DETAIL-DESC   TO  CA-RPT-DESC (PV-SEL-IDX) 05300000
053100         MOVE PV-SEL-NUMBER (PV-SEL-IDX)                          05310000
053200                                   TO  CA-RPT-NUMBER (PV-SEL-IDX) 05320000
053300         ADD +1 TO PV-SEL-IDX                                     05330000
053400     END-IF.                                                      05340000
053500                                                                  05350000
053600*    IF COMING FROM THE ASSOCIATE LOCATION SCREEN(SUKRF508), THE  05360000
053700*    AUDIT STATUS (SUKRF510) OR THE AUDIT CLOSE SCREEN (SUKRF516) 05370000
053800*    THE "CARTON DETAIL REPORT" IS NOT AVAILABLE                  05380000
053900     IF SU006-LAST-PROGRAM = PC-ASS-LOC-SCREEN                    05390000
054000     OR SU006-LAST-PROGRAM = PC-AUDIT-STATUS-SCREEN               05400000
054100     OR SU006-LAST-PROGRAM = PC-AUDIT-CLOSE-SCREEN                05410000
054200         CONTINUE                                                 05420000
054300     ELSE                                                         05430000
054400         MOVE PC-CARTON-DETAIL-DESC  TO  CA-RPT-DESC (PV-SEL-IDX) 05440000
054500         MOVE PV-SEL-NUMBER (PV-SEL-IDX)                          05450000
054600                                   TO  CA-RPT-NUMBER (PV-SEL-IDX) 05460000
054700         ADD +1 TO PV-SEL-IDX                                     05470000
054800     END-IF.                                                      05480000
054900                                                                  05490000
055000*    IF COMING FROM THE ASSOCIATE LOCATION SCREEN(SUKRF508), THE  05500000
055100*    "RECEIVER LIST REPORT" IS NOT AVAILABLE                      05510000
055200     IF SU006-LAST-PROGRAM = PC-ASS-LOC-SCREEN                    05520000
055300         CONTINUE                                                 05530000
055400     ELSE                                                         05540000
055500         MOVE PC-RECEIVER-LIST-DESC  TO  CA-RPT-DESC (PV-SEL-IDX) 05550000
055600         MOVE PV-SEL-NUMBER (PV-SEL-IDX)                          05560000
055700                                   TO  CA-RPT-NUMBER (PV-SEL-IDX) 05570000
055800         ADD +1 TO PV-SEL-IDX                                     05580000
055900     END-IF.                                                      05590000
056000                                                                  05600000
056100*    OPEN CARTON REPORT -- NOT FROM THE ASSOCIATE LOCATION SCREEN 05610000
056200     IF SU006-LAST-PROGRAM = PC-ASS-LOC-SCREEN                    05620000
056300        CONTINUE                                                  05630000
056400     ELSE                                                         05640000
056500        MOVE PC-OPEN-CARTON-DESC     TO  CA-RPT-DESC (PV-SEL-IDX) 05650000
056600        MOVE PV-SEL-NUMBER (PV-SEL-IDX)                           05660000
056700                              TO CA-RPT-NUMBER (PV-SEL-IDX)       05670000
056800        ADD +1 TO PV-SEL-IDX                                      05680000
056900     END-IF.                                                      05690000
057000                                                                  05700000
057100*    RECEIVER LEVEL OVER/SHORT REPORT IS ONLY ACCESSABLE FROM     05710000
057200*    THE AUDIT CLOSE AND AUDIT STATUS SCREEN                      05720000
057300     IF SU006-LAST-PROGRAM = PC-AUDIT-CLOSE-SCREEN                05730000
057400     OR SU006-LAST-PROGRAM = PC-AUDIT-STATUS-SCREEN               05740000
057500        MOVE PC-RCVR-OVER-SHORT-DESC TO  CA-RPT-DESC (PV-SEL-IDX) 05750000
057600        MOVE PV-SEL-NUMBER (PV-SEL-IDX)                           05760000
057700                              TO CA-RPT-NUMBER (PV-SEL-IDX)       05770000
057800        ADD +1 TO PV-SEL-IDX                                      05780000
057900     END-IF.                                                      05790000
058000                                                                  05800000
058100*    INPROCESS AUDITS REPORT                                      05810000
058200     MOVE PC-INPROCESS-AUDIT-DESC    TO  CA-RPT-DESC (PV-SEL-IDX).05820000
058300     MOVE PV-SEL-NUMBER (PV-SEL-IDX)                              05830000
058400                                   TO  CA-RPT-NUMBER (PV-SEL-IDX).05840000
058500                                                                  05850000
058600     COMPUTE CA-MAX-IDX = PV-SEL-IDX.                             05860000
058700                                                                  05870000
058800     IF CA-MAX-IDX > 5                                            05880000
058900         MOVE '  F7/F8'           TO AMOREO                       05890000
059000     ELSE                                                         05900000
059100         MOVE SPACES               TO AMOREO                      05910000
059200     END-IF.                                                      05920000
059300                                                                  05930000
059400     MOVE +1 TO PV-TOP-IDX.                                       05940000
059500     PERFORM 1005-MOVE-TO-SCREEN.                                 05950000
059600                                                                  05960000
059700     MOVE -1 TO ASELECTL.                                         05970000
059800                                                                  05980000
059900******************************************************************05990000
060000* 1005-MOVE-TO-SCREEN                                            *06000000
060100******************************************************************06010000
060200 1005-MOVE-TO-SCREEN.                                             06020000
060300                                                                  06030000
060400*    CHECK TO MAKE SURE THE REQUESTED TOP OF SCREEN IS WITHIN THE 06040000
060500*    THE PROPER RANGE - IF SO, START WITH THAT ITEM, OTHERWISE    06050000
060600*    START WITH THE LAST TOP ITEM                                 06060000
060700     IF PV-TOP-IDX IS > +0                                        06070000
060800     AND PV-TOP-IDX IS <= CA-MAX-IDX                              06080000
060900         MOVE PV-TOP-IDX  TO CA-LAST-TOP-IDX                      06090000
061000                             PV-TEMP-IDX                          06100000
061100     ELSE                                                         06110000
061200        MOVE CA-LAST-TOP-IDX                                      06120000
061300                     TO PV-TEMP-IDX                               06130000
061400     END-IF.                                                      06140000
061500                                                                  06150000
061600*    TAKE THE TABLE OF SELECTIONS, AND MOVE IT TO THE SCREEN      06160000
061700*    STARTING WITH THE LAST TOP OF SCREEN                         06170000
061800*    FIRST OPTION                                                 06180000
061900     MOVE CA-SELECTION-RECORD (PV-TEMP-IDX)                       06190000
062000                                      TO ASEL1O.                  06200000
062100     ADD +1                           TO PV-TEMP-IDX.             06210000
062200                                                                  06220000
062300*    SECOND OPTION                                                06230000
062400     MOVE CA-SELECTION-RECORD (PV-TEMP-IDX)                       06240000
062500                                      TO ASEL2O.                  06250000
062600     ADD +1                           TO PV-TEMP-IDX.             06260000
062700                                                                  06270000
062800*    THIRD OPTION                                                 06280000
062900     MOVE CA-SELECTION-RECORD (PV-TEMP-IDX)                       06290000
063000                                      TO ASEL3O.                  06300000
063100     ADD +1                           TO PV-TEMP-IDX.             06310000
063200                                                                  06320000
063300*    FOURTH OPTION                                                06330000
063400     MOVE CA-SELECTION-RECORD (PV-TEMP-IDX)                       06340000
063500                                      TO ASEL4O.                  06350000
063600     ADD +1                           TO PV-TEMP-IDX.             06360000
063700                                                                  06370000
063800*    FIFTH OPTION                                                 06380000
063900     MOVE CA-SELECTION-RECORD (PV-TEMP-IDX)                       06390000
064000                                      TO ASEL5O.                  06400000
064100     ADD +1                           TO PV-TEMP-IDX.             06410000
064200                                                                  06420000
064300                                                                  06430000
064400******************************************************************06440000
064500* 1010-GET-DEFAULT-PRINTER                                       *06450000
064600*    SELECT THE DEFAULT PRINTER FROM THE COMPANY CONTROL TABLE   *06460000
064700* THERE ARE DEFAULTS FOR EACH AUDITING PROCESS AREA & LOGISTICS  *06470000
064800* WITHIN EACH FACILITY.  SELECT OF ALL FOUR ID'S FOR THE GIVEN   *06480000
064900* OPER UNIT ID AND THEN DETERMINE WHICH TO DISPLAY.              *06490000
065000******************************************************************06500000
065100 1010-GET-DEFAULT-PRINTER.                                        06510000
065200                                                                  06520000
065300     MOVE SU006-OPER-UNT-ID     TO DK-OPER-UNT-ID.                06530000
065400                                                                  06540000
065500     EXEC SQL                                                     06550000
065600            SELECT                                                06560000
065700                    CA_RCVG_PRTR_ID                               06570000
065800                   ,CA_FLAT_PRTR_ID                               06580000
065900                   ,CA_SHIP_PRTR_ID                               06590000
066000            INTO                                                  06600000
066100                   :COCNTL-CA-RCVG-PRTR-ID                        06610000
066200                  ,:COCNTL-CA-FLAT-PRTR-ID                        06620000
066300                  ,:COCNTL-CA-SHIP-PRTR-ID                        06630000
066400            FROM                                                  06640000
066500                    TCOCNTL                                       06650000
066600            WHERE                                                 06660000
066700                  OPER_UNT_ID     = :DK-OPER-UNT-ID               06670000
066800              AND FCLTY_ID        = 1                             06680000
066900     END-EXEC.                                                    06690000
067000                                                                  06700000
067100     IF SQLCODE = ZERO                                            06710000
067200         EVALUATE TRUE                                            06720000
067300           WHEN  SU006-RECV-PRCS-AREA                             06730000
067400               MOVE COCNTL-CA-RCVG-PRTR-ID                        06740000
067500                                      TO SU006-PRINTER-DEST       06750000
067600           WHEN  SU006-FLAT-PRCS-AREA                             06760000
067700               MOVE COCNTL-CA-FLAT-PRTR-ID                        06770000
067800                                      TO SU006-PRINTER-DEST       06780000
067900           WHEN  SU006-SHIP-PRCS-AREA                             06790000
068000               MOVE COCNTL-CA-SHIP-PRTR-ID                        06800000
068100                                      TO SU006-PRINTER-DEST       06810000
068200         END-EVALUATE                                             06820000
068300     ELSE                                                         06830000
068400             MOVE '1010-GET-DEFAULT-PRINTER'                      06840000
068500                                         TO DP013-PARAGRAPH       06850000
068600             MOVE 'SELECT OF TCOCNTL'    TO DP013-MESSAGE-TEXT (1)06860000
068700             MOVE DK-OPER-UNT-ID         TO DP013-MESSAGE-TEXT (2)06870000
068800             MOVE SQLCA                  TO DP013-SQLCA           06880000
068900             MOVE 'TCOCNTL'            TO DP013-DB2-TABLE-NAME (1)06890000
069000             SET DP013-DB2-ABEND         TO TRUE                  06900000
069100             SET DP013-NO-ROLLBACK       TO TRUE                  06910000
069200             PERFORM 9999-WRITE-CICS-LOG-MSG                      06920000
069300                                                                  06930000
069400             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               06940000
069500             MOVE -1                     TO ASELECTL              06950000
069600             PERFORM 8100-SEND-DATA-ONLY                          06960000
069700             PERFORM 8200-RETURN-TRANID                           06970000
069800     END-IF.                                                      06980000
069900                                                                  06990000
070000                                                                  07000000
070100*                                                                 07010000
070200*                                                                 07020000
070300 1200-RECEIVE-MAP.                                                07030000
070400     EXEC CICS                                                    07040000
070500         RECEIVE                                                  07050000
070600             MAP     ('SU523A')                                   07060000
070700             MAPSET  ('SUKM523')                                  07070000
070800             RESP    (PV-CICS-RESPONSE)                           07080000
070900     END-EXEC.                                                    07090000
071000                                                                  07100000
071100     EVALUATE TRUE                                                07110000
071200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07120000
071300              PERFORM 1210-RECEIVE-SCREEN-FIELDS                  07130000
071400         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                07140000
071500              CONTINUE                                            07150000
071600         WHEN OTHER                                               07160000
071700              MOVE '1200-RECEIVE-MAP'                             07170000
071800                                     TO DP013-PARAGRAPH           07180000
071900              MOVE 'UNABLE TO RECEIVE MAP'                        07190000
072000                                     TO DP013-MESSAGE-TEXT (1)    07200000
072100              SET DP013-LOGIC-ABEND  TO TRUE                      07210000
072200              SET DP013-NO-ROLLBACK  TO TRUE                      07220000
072300              PERFORM 9999-WRITE-CICS-LOG-MSG                     07230000
072400     END-EVALUATE.                                                07240000
072500*                                                                 07250000
072600 1210-RECEIVE-SCREEN-FIELDS.                                      07260000
072700*                                                                 07270000
072800     IF  ASELECTL > ZERO                                          07280000
072900         MOVE ASELECTI               TO CA-SELECTION-X            07290000
073000     END-IF.                                                      07300000
073100*                                                                 07310000
073200     IF  ADESTL   > ZERO                                          07320000
073300         MOVE ADESTI                 TO SU006-PRINTER-DEST        07330000
073400     ELSE IF  ADESTF   = DP015-ERASE-EOF                          07340000
073500         MOVE SPACES                 TO SU006-PRINTER-DEST        07350000
073600                                        ADESTO                    07360000
073700     END-IF.                                                      07370000
073800*                                                                 07380000
073900**************************************************************    07390000
074000* EDIT ALL ENTERABLE FIELDS (OPERATING UNIT ID, AND SELECT)  *    07400000
074100**************************************************************    07410000
074200 1300-EDIT-SELECTION.                                             07420000
074300                                                                  07430000
074400*    CHECK TO MAKE SURE THE ENTERED SELECTION IS NUMERIC          07440000
074500     MOVE CA-SELECTION-X             TO DP010I-UNEDITED-FIELD.    07450000
074600     MOVE 2                          TO DP010I-MAXIMUM-DIGITS.    07460000
074700     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  07470000
074800     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07480000
074900                                                                  07490000
075010     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07501013
075020          USING DP010I-NUMERIC-EDIT-AREA.                         07502013
075100                                                                  07510000
075200     IF  DP010I-ERROR-DETECTED                                    07520000
075300         MOVE PM-NUMERIC-VALUE-REQUIRED-MSG                       07530000
075400                                     TO AMSGLNO                   07540000
075500         PERFORM 8100-SEND-DATA-ONLY                              07550000
075600         PERFORM 8200-RETURN-TRANID                               07560000
075700     ELSE                                                         07570000
075800         MOVE DP010I-NUMERIC-FIELD   TO CA-SELECTION              07580000
075900         IF CA-SELECTION > 25                                     07590000
076000         OR CA-RPT-NUMBER (CA-SELECTION) = SPACES                 07600000
076100             MOVE PM-INVALID-SELECTION-MSG                        07610000
076200                                     TO AMSGLNO                   07620000
076300             MOVE -1                 TO ASELECTL                  07630000
076400             PERFORM 8100-SEND-DATA-ONLY                          07640000
076500             PERFORM 8200-RETURN-TRANID                           07650000
076600     END-IF.                                                      07660000
076700                                                                  07670000
076800*    THE PRINTER DESTINATION MUST BE FILLED IN IF                 07680000
076900*    THE PRINT OPTION WAS SELECTED                                07690000
077000     IF SU006-PRINTER-DEST = SPACES                               07700000
077100         MOVE PM-PRINTER-ID-REQUIRED-MSG  TO  AMSGLNO             07710000
077200         MOVE -1                          TO  ADESTL              07720000
077300         PERFORM 8100-SEND-DATA-ONLY                              07730000
077400         PERFORM 8200-RETURN-TRANID                               07740000
077500     ELSE                                                         07750000
077510                                                                  07751023
077520         IF  SU006-PRINTER-DEST = PC-PRINT-TO-FILE                07752023
077530             SET PS-PRINT-TO-FILE-NO  TO TRUE                     07753023
077540             PERFORM 1320-VALIDATE-PRINT-TO-FILE                  07754023
077550                                                                  07755023
077560             IF  PS-PRINT-TO-FILE-YES                             07756023
077561                 MOVE SPACES              TO  CA-PRTR-CNTL-IND    07756123
077565                 MOVE ZEROES              TO  CA-TRACK-NBR        07756523
077566                 PERFORM 1330-CHECK-PRNTTOFILE                    07756623
077591             END-IF                                               07759123
077592                                                                  07759223
077593         ELSE                                                     07759323
077600             PERFORM 1310-VALIDATE-PRINTER                        07760023
077700             IF  DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'          07770023
077800                 MOVE DP072-PRTR-PRTR-CNTL-IND                    07780023
077900                                          TO  CA-PRTR-CNTL-IND    07790000
078100                 MOVE DP072-PRTR-AUTO-CUTTER-IND                  07810023
078200                                          TO  JL-SYSUT1-CUT-IND   07820000
078300                 MOVE DP072-PRTR-TRACK-NBR    TO  CA-TRACK-NBR    07830023
078400             ELSE                                                 07840023
078500                 MOVE PM-INVALID-PRINTER-ID-MSG                   07850023
078600                                              TO  AMSGLNO         07860023
078700                 MOVE -1                      TO  ADESTL          07870023
078800                 PERFORM 8100-SEND-DATA-ONLY                      07880023
078900                 PERFORM 8200-RETURN-TRANID                       07890023
079000             END-IF                                               07900023
079010         END-IF                                                   07901023
079100     END-IF.                                                      07910000
079200                                                                  07920000
079300                                                                  07930000
079400***************************************************************** 07940000
079500*   1310-VALIDATE-PRINTER                                       * 07950000
079600* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                     * 07960000
079700***************************************************************** 07970000
079800 1310-VALIDATE-PRINTER.                                           07980000
079900                                                                  07990000
080000     MOVE SU006-PRINTER-DEST         TO DP072-PRINTER-ID.         08000000
080100     MOVE PC-REPORT-PGM              TO DP072-RPT-PGM-NME.        08010000
080200     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     08020000
080300     MOVE SU006-DFLT-OPER-UNT-ID     TO DP072-ORIGIN-OPER-UNT-ID. 08030000
080400     MOVE SU006-OPER-UNT-ID          TO DP072-OPER-UNT-ID.        08040000
080500     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     08050000
080600                                        DP072-FCLTY-ID.           08060000
080700     SET DP072-VALIDATE              TO TRUE.                     08070000
080800                                                                  08080000
080900     EXEC CICS                                                    08090000
081000         LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                   08100000
081100              COMMAREA (DP072-COMM-AREA)                          08110000
081200              RESP     (PV-CICS-RESPONSE)                         08120000
081300     END-EXEC                                                     08130000
081400                                                                  08140000
081500     EVALUATE TRUE                                                08150000
081600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08160000
081700             CONTINUE                                             08170000
081800         WHEN OTHER                                               08180000
081900               MOVE '1310-VALIDATE-PRINTER'                       08190000
082000                                    TO DP013-PARAGRAPH            08200000
082100               MOVE PV-CICS-RESPONSE                              08210000
082200                                    TO DP013-MESSAGE-TEXT(1)      08220000
082300               SET DP013-LINK-RETURN                              08230000
082400                   DP013-CICS-ABEND                               08240000
082500                   DP013-NO-ROLLBACK TO TRUE                      08250000
082600               PERFORM DP014-0000-PROCESS-ABEND                   08260000
082700     END-EVALUATE.                                                08270000
082800                                                                  08280000
082810***************************************************************** 08281021
082820* CHECK TO SEE THAT DC IS SET UP TO SEND REPORT AS A .TXT       * 08282021
082830* INSTEAD OF PRINTING TO AN ACTUAL PRINTER.                     * 08283021
082840***************************************************************** 08284021
082850 1320-VALIDATE-PRINT-TO-FILE.                                     08285021
082860                                                                  08286021
082870     SET PS-PRINT-TO-FILE-NO  TO TRUE                             08287021
082880     MOVE  SU006-OPER-UNT-ID  TO  KRPRPM-LOC-ID                   08288021
082890                                                                  08289021
082891     EXEC SQL                                                     08289121
082892            SELECT  FUNC_TXT                                      08289221
082893              INTO :KRPRPM-FUNC-TXT                               08289321
082894              FROM  TKRPRPM                                       08289421
082895             WHERE  LOC_ID            = :KRPRPM-LOC-ID            08289521
082896               AND  INTFC_SYS_CDE     = 'KHL'                     08289621
082897               AND  SYS_PRC_FUNC_CDE  = 'PRTFIL'                  08289721
082898               AND  FUNC_PRC_STAT_CDE = 'AC'                      08289821
082899               AND  FUNC_BEG_TMST    <= CURRENT TIMESTAMP         08289921
082900               AND  FUNC_END_TMST    >= CURRENT TIMESTAMP         08290021
082901               AND  FUNC_TXT          = 'Y'                       08290121
082902     END-EXEC.                                                    08290221
082903                                                                  08290321
082904     IF  SQLCODE = ZERO                                           08290421
082905         SET PS-PRINT-TO-FILE-YES TO TRUE                         08290521
082906     ELSE                                                         08290621
082907     IF  SQLCODE = +100                                           08290721
082908         SET PS-PRINT-TO-FILE-NO  TO TRUE                         08290821
082909         MOVE PC-PRINT-TO-FILE-ERR-MSG TO AMSGLNO                 08290921
082911         MOVE -1                      TO  ADESTL                  08291123
082912         PERFORM 8100-SEND-DATA-ONLY                              08291223
082913         PERFORM 8200-RETURN-TRANID                               08291323
082917     ELSE                                                         08291721
082918         MOVE '1320-VALIDATE-PRINT-TO-FILE'                       08291821
082919                                TO DP013-PARAGRAPH                08291921
082920         MOVE PV-CICS-RESPONSE  TO DP013-MESSAGE-TEXT(1)          08292021
082921         SET DP013-LINK-RETURN                                    08292121
082922             DP013-CICS-ABEND                                     08292221
082923             DP013-NO-ROLLBACK TO TRUE                            08292321
082924         PERFORM DP014-0000-PROCESS-ABEND                         08292421
082925     END-IF.                                                      08292521
082926                                                                  08292621
082927                                                                  08292721
082928***************************************************************** 08292821
082929* CHECK TO SEE IF THE REPORT IS SET UP TO BE PRINTED AS A .TXT  * 08292921
082930* FILE INSTEAD OF BEING PHYSICALLY PRINT.                       * 08293021
082931***************************************************************** 08293121
082932 1330-CHECK-PRNTTOFILE.                                           08293221
082933                                                                  08293321
082943     SET  PS-REPORT-TO-FILE-NO TO TRUE.                           08294327
082944                                                                  08294427
082945     MOVE 'AC'                     TO  DK-WST-AC-IN               08294527
082946     MOVE PC-CURRENT-PROGRAM-NAME  TO  DK-WST-PROG-NBR            08294627
082947     MOVE 0                        TO  DK-WST-MENU-SEQ            08294727
082948                                                                  08294827
082949     EVALUATE CA-RPT-DESC (CA-SELECTION)                          08294927
082950         WHEN PC-AUDIT-SUMMARY-DESC                               08295027
082953              MOVE 'SUK905'           TO  DK-WST-JOB              08295327
082954              IF  (SU006-SYSTEM-GENERATED-AUDIT   AND             08295432
082955                   (SU006-BULK-CSPK-PKGNG-CDE  OR                 08295532
082956                    SU006-PREPK-ITYPE-PKGNG-CDE)                  08295632
082957                  ) OR                                            08295732
082958                  (SU006-MANUAL-GENERATED-AUDIT)                  08295832
082959                  MOVE 'AUDIT SUMMARY' TO  DK-WST-RPT-NAME        08295929
082960                  MOVE 'SUKRP010'      TO  DK-WST-RPT-NBR         08296029
082961              ELSE                                                08296128
082962                  MOVE 'AUDIT SUMMARY-PBS'                        08296229
082963                                       TO  DK-WST-RPT-NAME        08296329
082964                  MOVE 'SUKRP009'      TO  DK-WST-RPT-NBR         08296429
082965              END-IF                                              08296529
082970         WHEN PC-AUDIT-DETAIL-DESC                                08297027
082971              MOVE 'AUDIT DETAIL'     TO  DK-WST-RPT-NAME         08297127
082972              MOVE 'SUKRP011'         TO  DK-WST-RPT-NBR          08297227
082973              MOVE 'SUK910'           TO  DK-WST-JOB              08297327
082974         WHEN PC-CARTON-DETAIL-DESC                               08297427
082975              MOVE 'CARTON DETAIL'    TO  DK-WST-RPT-NAME         08297527
082976              MOVE 'SUKRP012'         TO  DK-WST-RPT-NBR          08297627
082977              MOVE 'SUK915'           TO  DK-WST-JOB              08297727
082978         WHEN PC-RECEIVER-LIST-DESC                               08297827
082979              MOVE 'RECEIVER LIST'    TO  DK-WST-RPT-NAME         08297927
082980              MOVE 'SUKRP013'         TO  DK-WST-RPT-NBR          08298027
082981              MOVE 'SUK920'           TO  DK-WST-JOB              08298127
082982         WHEN PC-INPROCESS-AUDIT-DESC                             08298227
082983              MOVE 'INPROCESS AUDIT'  TO  DK-WST-RPT-NAME         08298327
082984              MOVE 'SUKRP014'         TO  DK-WST-RPT-NBR          08298427
082985              MOVE 'SUK925'           TO  DK-WST-JOB              08298527
082986         WHEN PC-OPEN-CARTON-DESC                                 08298623
082987              MOVE 'OPEN CARTON'      TO  DK-WST-RPT-NAME         08298723
082988              MOVE 'SUKRP016'         TO  DK-WST-RPT-NBR          08298824
082989              MOVE 'SUK935'           TO  DK-WST-JOB              08298923
082990         WHEN PC-RCVR-OVER-SHORT-DESC                             08299023
082991              MOVE 'OVER SHORT'       TO  DK-WST-RPT-NAME         08299123
082992              MOVE 'SUKRP015'         TO  DK-WST-RPT-NBR          08299224
082993              MOVE 'SUK930'           TO  DK-WST-JOB              08299323
082994     END-EVALUATE.                                                08299423
082995                                                                  08299521
083005     EXEC SQL                                                     08300530
083006          SELECT C.ATTR_ELEM_SEQ_NBR                              08300630
083007               , C.ATTR_ELEM_TXT                                  08300730
083008               , D.ATTR_ELEM_TXT                                  08300830
083009               , E.ATTR_ELEM_TXT                                  08300930
083010               , F.ATTR_ELEM_TXT                                  08301030
083011               , G.ATTR_ELEM_TXT                                  08301130
083012               , H.ATTR_ELEM_NBR                                  08301230
083013            INTO :PV-WST-SEQ                                      08301330
083014               , :PV-WST-RPT-NAME                                 08301430
083015               , :PV-WST-RPT-NBR                                  08301530
083016               , :PV-WST-JOB                                      08301630
083017               , :PV-WST-AC-IN                                    08301730
083018               , :PV-WST-PROG-NBR                                 08301830
083019               , :PV-WST-MENU-SEQ                                 08301930
083020            FROM  WST_INTGRTN_TYP A                               08302030
083021               ,  WST_ATTR_DEFN   B                               08302130
083022               ,  WST_ATTR_ELEM   C                               08302230
083023               ,  WST_ATTR_ELEM   D                               08302330
083024               ,  WST_ATTR_ELEM   E                               08302430
083025               ,  WST_ATTR_ELEM   F                               08302530
083026               ,  WST_ATTR_ELEM   G                               08302630
083027               ,  WST_ATTR_ELEM   H                               08302730
083028           WHERE A.INTGRTN_TYP_CDE   = 'PRNTTOFILE'               08302830
083029             AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          08302930
083030             AND B.ATTR_DEFN_SEQ_NBR = 1                          08303030
083031             AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          08303130
083032             AND C.ATTR_DEFN_SEQ_NBR = 1                          08303230
083033             AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          08303330
083034             AND D.ATTR_DEFN_SEQ_NBR = 2                          08303430
083035             AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE          08303530
083036             AND E.ATTR_DEFN_SEQ_NBR = 3                          08303630
083037             AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE          08303730
083038             AND F.ATTR_DEFN_SEQ_NBR = 4                          08303830
083039             AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE          08303930
083040             AND G.ATTR_DEFN_SEQ_NBR = 5                          08304030
083041             AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE          08304130
083042             AND H.ATTR_DEFN_SEQ_NBR = 6                          08304230
083043             AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        08304330
083044             AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR        08304430
083045             AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR        08304530
083046             AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR        08304630
083047             AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR        08304730
083048             AND C.ATTR_ELEM_TXT     = :DK-WST-RPT-NAME           08304830
083049             AND D.ATTR_ELEM_TXT     = :DK-WST-RPT-NBR            08304930
083050             AND E.ATTR_ELEM_TXT     = :DK-WST-JOB                08305030
083051             AND F.ATTR_ELEM_TXT     = :DK-WST-AC-IN              08305130
083052             AND G.ATTR_ELEM_TXT     = :DK-WST-PROG-NBR           08305230
083053             AND H.ATTR_ELEM_NBR     = :DK-WST-MENU-SEQ           08305330
083054            WITH UR                                               08305430
083055     END-EXEC.                                                    08305530
083056                                                                  08305630
083057     IF  SQLCODE = ZERO                                           08305730
083058         SET PS-REPORT-TO-FILE-YES TO TRUE                        08305830
083060     ELSE                                                         08306030
083061     IF  SQLCODE = +100                                           08306130
083062         SET PS-REPORT-TO-FILE-NO  TO TRUE                        08306230
083063         MOVE PC-REPORT-TO-FILE-ERR-MSG  TO AMSGLNO               08306330
083064         MOVE -1                         TO ASELECTL              08306430
083065         PERFORM 8100-SEND-DATA-ONLY                              08306530
083066         PERFORM 8200-RETURN-TRANID                               08306630
083067     ELSE                                                         08306730
083068         MOVE '1330-CHECK-PRNTTOFILE'                             08306830
083069                                    TO DP013-PARAGRAPH            08306930
083070         MOVE PV-CICS-RESPONSE                                    08307030
083071                                    TO DP013-MESSAGE-TEXT(1)      08307130
083072         SET DP013-LINK-RETURN                                    08307230
083073             DP013-CICS-ABEND                                     08307330
083074             DP013-NO-ROLLBACK TO TRUE                            08307430
083075         PERFORM DP014-0000-PROCESS-ABEND                         08307530
083076     END-IF.                                                      08307630
083077                                                                  08307730
083078                                                                  08307830
083079                                                                  08307930
083080***************************************************************** 08308077
083081* get current time to put in the control card                   * 08308177
083082***************************************************************** 08308277
083083 1340-GET-CURRENT-TMST.                                           08308380
083084                                                                  08308477
083085     EXEC SQL                                                     08308577
083086          SELECT CURRENT TIMESTAMP                                08308680
083095            INTO :PV-CURR-TMST                                    08309579
083201            FROM SYSIBM.SYSDUMMY1                                 08320177
083202     END-EXEC.                                                    08320277
083203                                                                  08320377
083205     MOVE PV-CURR-TMST-YEAR        TO PV-WORK-TMST-YEAR.          08320578
083206     MOVE PV-CURR-TMST-MONTH       TO PV-WORK-TMST-MONTH.         08320678
083207     MOVE PV-CURR-TMST-DAY         TO PV-WORK-TMST-DAY.           08320778
083208     MOVE PV-CURR-TMST-HOUR        TO PV-WORK-TMST-HOUR.          08320878
083209     MOVE PV-CURR-TMST-MINUTE      TO PV-WORK-TMST-MINUTE.        08320978
083210     MOVE PV-CURR-TMST-SECOND      TO PV-WORK-TMST-SECOND.        08321078
083212                                                                  08321277
083213                                                                  08321377
083236***************************************************************** 08323677
083237*                                                               * 08323777
083238***************************************************************** 08323877
083239 1400-HELP-SCREEN.                                                08323977
083240     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      08324077
083241     MOVE 'SUKRF523'                  TO PC192-PROGRAM-NAME       08324177
083250     COPY PCPD188.                                                08325077
083300     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      08330000
083400     PERFORM 4200-XCTL-TO-HELP.                                   08340000
083500                                                                  08350000
083600                                                                  08360000
083700******************************************************************08370000
083800*2000-PROCESS-SCREEN                                             *08380000
083900* THIS PARAGRAPH WILL START A REPORT JOB DEPENDING ON THE        *08390000
084000* REPORT SELECTED.                                               *08400000
084100******************************************************************08410000
084200 2000-PROCESS-SCREEN.                                             08420000
084300                                                                  08430000
084400*    GET THE CICS REGION                                          08440000
084500     EXEC CICS ASSIGN                                             08450000
084600               APPLID(CA-SYSTEM-ID)                               08460000
084700     END-EXEC.                                                    08470000
084800                                                                  08480000
084900     EVALUATE CA-RPT-DESC (CA-SELECTION)                          08490000
085000         WHEN PC-AUDIT-SUMMARY-DESC                               08500000
085100              PERFORM 3100-RUN-AUDIT-SUMMARY-JOB                  08510000
085200         WHEN PC-AUDIT-DETAIL-DESC                                08520000
085300              PERFORM 3200-RUN-AUDIT-DETAIL-JOB                   08530000
085400         WHEN PC-CARTON-DETAIL-DESC                               08540000
085500              PERFORM 3300-RUN-CARTON-DETAIL-JOB                  08550000
085600         WHEN PC-RECEIVER-LIST-DESC                               08560000
085700              PERFORM 3400-RUN-RECEIVER-LIST-JOB                  08570000
085800         WHEN PC-INPROCESS-AUDIT-DESC                             08580000
085900              PERFORM 3500-RUN-INPROCESS-AUDIT-JOB                08590000
086000         WHEN PC-OPEN-CARTON-DESC                                 08600000
086100              PERFORM 3600-RUN-CARTON-OPEN-JOB                    08610000
086200         WHEN PC-RCVR-OVER-SHORT-DESC                             08620000
086300              PERFORM 3700-RUN-RCVR-OVRSHT-JOB                    08630000
086400     END-EVALUATE.                                                08640000
086500                                                                  08650000
086600                                                                  08660000
086700***************************************************************** 08670000
086800*                                                               * 08680000
086900***************************************************************** 08690000
087000 2100-XCTL-TO-SELECTED-PROGRAM.                                   08700000
087100     SET SU006-INITIALIZE-SCREEN   TO  TRUE.                      08710000
087200     MOVE LENGTH OF CA-COMMAREA    TO  PV-COMMAREA-LENGTH.        08720000
087300                                                                  08730000
087400     EXEC CICS                                                    08740000
087500         XCTL                                                     08750000
087600             PROGRAM   (PV-TRANSFER-PROGRAM)                      08760000
087700             COMMAREA  (CA-COMMAREA)                              08770000
087800             LENGTH    (PV-COMMAREA-LENGTH)                       08780000
087900             RESP      (PV-CICS-RESPONSE)                         08790000
088000     END-EXEC.                                                    08800000
088100                                                                  08810000
088200     EVALUATE TRUE                                                08820000
088300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08830000
088400              CONTINUE                                            08840000
088500         WHEN OTHER                                               08850000
088600              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                08860000
088700                                     TO DP013-PARAGRAPH           08870000
088800              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       08880000
088900                                     TO DP013-MESSAGE-TEXT (1)    08890000
089000              MOVE PV-TRANSFER-PROGRAM                            08900000
089100                                     TO DP013-MESSAGE-TEXT (2)    08910000
089200              SET DP013-CICS-ABEND   TO TRUE                      08920000
089300              SET DP013-NO-ROLLBACK  TO TRUE                      08930000
089400              PERFORM 9999-WRITE-CICS-LOG-MSG                     08940000
089500              MOVE PM-TRANS-NOT-AVAILABLE-MSG                     08950000
089600                                     TO AMSGLNO                   08960000
089700              SET SU006-PROCESS-SCREEN TO TRUE                    08970000
089800              PERFORM 8100-SEND-DATA-ONLY                         08980000
089900              PERFORM 8200-RETURN-TRANID                          08990000
090000     END-EVALUATE.                                                09000000
090100                                                                  09010000
090200                                                                  09020000
090300******************************************************************09030000
090400*3100-RUN-AUDIT-SUMMARY-JOB                                       09040000
090500*  SUBMIT THE BATCH JOB TO CREATE THE APPROPRIATE REPORT         *09050000
090600******************************************************************09060000
090700 3100-RUN-AUDIT-SUMMARY-JOB.                                      09070000
090800                                                                  09080000
090900*    SET-UP VARIABLES IN THE JOB CARD                             09090000
091000     IF CA-TEST-CICS                                              09100000
091100         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          09110000
091200                                        JL-TEST-NOTIFY            09120000
091300         MOVE 'SUK9051T'             TO JL-LLE-PROC-NAME          09130060
091400         MOVE 'AUDIT SUMMARY'        TO JL-TEST-JOB-DESC          09140000
091401                                                                  09140161
091410         IF  PS-PRINT-TO-FILE-YES  AND                            09141061
091420             PS-REPORT-TO-FILE-YES                                09142061
091432             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           09143274
091440             MOVE SU006-USERID         TO  JL-FILE-USERID         09144074
091450             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      09145074
091451             MOVE PC-COMMA             TO  JL-LLE-COMMA           09145168
091460             SET  JL-AUDIT-SUM         TO  TRUE                   09146074
091470         END-IF                                                   09147061
091480                                                                  09148061
091500     ELSE                                                         09150000
091600     IF CA-QA-CICS                                                09160000
091700         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          09170000
091800                                        JL-TEST-NOTIFY            09180000
091900         MOVE 'SUK9051Q'             TO JL-LLE-PROC-NAME          09190060
092000         MOVE 'AUDIT SUMMARY'        TO JL-TEST-JOB-DESC          09200000
092010                                                                  09201061
092020         IF  PS-PRINT-TO-FILE-YES  AND                            09202061
092030             PS-REPORT-TO-FILE-YES                                09203061
092040             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           09204074
092050             MOVE SU006-USERID         TO  JL-FILE-USERID         09205074
092060             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      09206074
092061             MOVE PC-COMMA             TO  JL-LLE-COMMA           09206168
092070             SET  JL-AUDIT-SUM        TO  TRUE                    09207074
092080         END-IF                                                   09208061
092090                                                                  09209061
092100     ELSE                                                         09210000
092200     IF CA-LEARN-CICS                                             09220000
092300         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          09230000
092400                                        JL-TEST-NOTIFY            09240000
092500         MOVE 'SUK9051L'             TO JL-LLE-PROC-NAME          09250060
092600         MOVE 'AUDIT SUMMARY'        TO JL-TEST-JOB-DESC          09260000
092610                                                                  09261061
092620         IF  PS-PRINT-TO-FILE-YES  AND                            09262061
092630             PS-REPORT-TO-FILE-YES                                09263061
092640             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           09264074
092650             MOVE SU006-USERID         TO  JL-FILE-USERID         09265074
092660             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      09266074
092670             SET  JL-AUDIT-SUM        TO  TRUE                    09267074
092671             MOVE PC-COMMA             TO  JL-LLE-COMMA           09267168
092680         END-IF                                                   09268061
092690                                                                  09269061
092700     ELSE                                                         09270000
092800         MOVE 'SUK905'               TO JL-JOB-NAME               09280000
092900         MOVE 'SUK9051'              TO JL-PROD-PROC-NAME         09290063
093000         MOVE 'AUDIT SUMMARY'        TO JL-JOB-DESC               09300000
093010                                                                  09301061
093020         IF  PS-PRINT-TO-FILE-YES  AND                            09302061
093030             PS-REPORT-TO-FILE-YES                                09303061
093040             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           09304074
093050             MOVE SU006-USERID         TO  JL-FILE-USERID         09305074
093060             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      09306074
093070             SET  JL-AUDIT-SUM         TO  TRUE                   09307074
093071             MOVE PC-COMMA             TO  JL-PROD-COMMA          09307168
093080         END-IF                                                   09308061
093090                                                                  09309061
093100     END-IF                                                       09310000
093200     END-IF                                                       09320000
093300     END-IF.                                                      09330000
093301     MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER         09330135
093302     MOVE SU006-USERID               TO JL-CNTL-CARD-USERID       09330235
093303     MOVE SU006-AUDIT-CNTL-NBR       TO JL-CNTL-CARD-AUD-NBR      09330335
093304                                                                  09330435
093400                                                                  09340000
093500*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER              09350000
093600     PERFORM 9000-SUBMIT-REQUEST-START.                           09360000
093700*                                                                 09370000
093800     MOVE 'S010'                     TO JL-SYSUT1-STEP.           09380000
093900     MOVE SU006-AUDIT-CNTL-NBR       TO JL-SYSUT1-AUD-CNTL-NBR.   09390000
094010     MOVE SU006-SYSTEM-MANUAL-AUDIT  TO JL-SYSTEM-MANUAL-AUDIT.   09401000
094020     MOVE SU006-RFID-QC-AUDIT-IND    TO JL-RFID-QC-AUDIT-IND.     09402000
094030     MOVE SU006-RFID-QC-AUD-CMB-IND  TO JL-RFID-QC-AUD-CMB-IND.   09403000
094050     MOVE JL-SYSUT1-AUD-CNTL-LINE    TO JL-SYSUT1-PARM-VALUE.     09405000
094100     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           09410000
094200*                                                                 09420000
094300     MOVE 'S175'                     TO JL-SYSUT1-STEP.           09430000
094400     MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER         09440000
094500     MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND        09450000
094600     MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR       09460000
094610*                                                                 09461015
094700     MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER         09470015
094710     MOVE SU006-USERID               TO JL-CNTL-CARD-USERID       09471015
094720     MOVE SU006-AUDIT-CNTL-NBR       TO JL-CNTL-CARD-AUD-NBR      09472015
094721*                                                                 09472115
094730     MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE.     09473015
094731*                                                                 09473116
094760*                                                                 09476016
094800     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           09480000
094900*                                                                 09490000
095000     PERFORM 9099-SUBMIT-REQUEST-STOP.                            09500000
095100                                                                  09510000
095110*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER FOR RFID     09511000
095111*    WHEN COMBINED AUDIT                                          09511100
095112     IF SU006-SYSTEM-GENERATED-AUDIT AND                          09511200
095113        SU006-QC-AND-RFID-AUD                                     09511300
095120        PERFORM 9000-SUBMIT-REQUEST-START                         09512000
095130*                                                                 09513000
095140        MOVE 'S010'                     TO JL-SYSUT1-STEP         09514000
095150        MOVE SU006-RFID-AUDIT-CNTL-NBR  TO JL-SYSUT1-AUD-CNTL-NBR 09515000
095151        MOVE SU006-SYSTEM-MANUAL-AUDIT  TO JL-SYSTEM-MANUAL-AUDIT 09515100
095152        SET  JL-RFID-AUDIT              TO TRUE                   09515200
095153        MOVE SU006-RFID-QC-AUD-CMB-IND  TO JL-RFID-QC-AUD-CMB-IND 09515300
095160        MOVE JL-SYSUT1-AUD-CNTL-LINE    TO JL-SYSUT1-PARM-VALUE   09516000
095170        PERFORM 9050-SUBMIT-SYMBOLIC-LINE                         09517000
095180*                                                                 09518000
095190        MOVE 'S175'                     TO JL-SYSUT1-STEP         09519000
095191        MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER      09519100
095192        MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND     09519200
095193        MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR    09519300
095194*                                                                 09519415
095195        MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER      09519515
095196        MOVE SU006-USERID               TO JL-CNTL-CARD-USERID    09519615
095197        MOVE SU006-RFID-AUDIT-CNTL-NBR  TO JL-CNTL-CARD-AUD-NBR   09519715
095198*                                                                 09519815
095199        MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE   09519900
095200*                                                                 09520016
095205        PERFORM 9050-SUBMIT-SYMBOLIC-LINE                         09520500
095206*                                                                 09520600
095207        PERFORM 9099-SUBMIT-REQUEST-STOP                          09520700
095208     END-IF.                                                      09520800
095210                                                                  09521000
095220                                                                  09522000
095300******************************************************************09530000
095400*3200-RUN-AUDIT-DETAIL-JOB                                        09540000
095500*  SUBMIT THE BATCH JOB TO CREATE THE APPROPRIATE REPORT         *09550000
095600******************************************************************09560000
095700 3200-RUN-AUDIT-DETAIL-JOB.                                       09570000
095800                                                                  09580000
095900*    SET-UP VARIABLES IN THE JOB CARD                             09590000
096000     IF CA-TEST-CICS                                              09600000
096100         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          09610000
096200                                        JL-TEST-NOTIFY            09620000
096300         MOVE 'SUK9101T'             TO JL-LLE-PROC-NAME          09630060
096400         MOVE 'AUDIT DETAIL '        TO JL-TEST-JOB-DESC          09640000
096410                                                                  09641061
096420         IF  PS-PRINT-TO-FILE-YES  AND                            09642061
096430             PS-REPORT-TO-FILE-YES                                09643061
096440             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           09644074
096450             MOVE SU006-USERID         TO  JL-FILE-USERID         09645074
096460             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      09646074
096470             SET  JL-AUDIT-DTL         TO  TRUE                   09647074
096471             MOVE PC-COMMA             TO  JL-LLE-COMMA           09647168
096480         END-IF                                                   09648061
096490                                                                  09649061
096500     ELSE                                                         09650000
096600     IF CA-QA-CICS                                                09660000
096700         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          09670000
096800                                        JL-TEST-NOTIFY            09680000
096900         MOVE 'SUK9101Q'             TO JL-LLE-PROC-NAME          09690060
097000         MOVE 'AUDIT DETAIL '        TO JL-TEST-JOB-DESC          09700000
097010                                                                  09701061
097020         IF  PS-PRINT-TO-FILE-YES  AND                            09702061
097030             PS-REPORT-TO-FILE-YES                                09703061
097040             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           09704074
097050             MOVE SU006-USERID         TO  JL-FILE-USERID         09705074
097060             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      09706074
097070             SET  JL-AUDIT-DTL        TO  TRUE                    09707074
097071             MOVE PC-COMMA             TO  JL-LLE-COMMA           09707168
097080         END-IF                                                   09708061
097090                                                                  09709061
097100     ELSE                                                         09710000
097200     IF CA-LEARN-CICS                                             09720000
097300         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          09730000
097400                                        JL-TEST-NOTIFY            09740000
097500         MOVE 'SUK9101L'             TO JL-LLE-PROC-NAME          09750060
097600         MOVE 'AUDIT DETAIL '        TO JL-TEST-JOB-DESC          09760000
097610                                                                  09761061
097620         IF  PS-PRINT-TO-FILE-YES  AND                            09762061
097630             PS-REPORT-TO-FILE-YES                                09763061
097640             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           09764074
097650             MOVE SU006-USERID         TO  JL-FILE-USERID         09765074
097660             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      09766074
097670             SET  JL-AUDIT-DTL        TO  TRUE                    09767074
097671             MOVE PC-COMMA             TO  JL-LLE-COMMA           09767168
097680         END-IF                                                   09768061
097690                                                                  09769061
097700     ELSE                                                         09770000
097800         MOVE 'SUK910'               TO JL-JOB-NAME               09780000
097900         MOVE 'SUK9101 '             TO JL-PROD-PROC-NAME         09790060
098000         MOVE 'AUDIT DETAIL '        TO JL-JOB-DESC               09800000
098010                                                                  09801061
098020         IF  PS-PRINT-TO-FILE-YES  AND                            09802061
098030             PS-REPORT-TO-FILE-YES                                09803061
098040             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           09804074
098050             MOVE SU006-USERID         TO  JL-FILE-USERID         09805074
098060             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      09806074
098080             SET  JL-AUDIT-DTL         TO  TRUE                   09808074
098084             MOVE PC-COMMA             TO  JL-PROD-COMMA          09808468
098090         END-IF                                                   09809061
098091                                                                  09809161
098100     END-IF                                                       09810000
098200     END-IF                                                       09820000
098300     END-IF.                                                      09830000
098400                                                                  09840000
098500*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER              09850000
098600     PERFORM 9000-SUBMIT-REQUEST-START.                           09860000
098700*                                                                 09870000
098800     MOVE 'S010'                     TO JL-SYSUT1-STEP.           09880000
098900     MOVE SU006-AUDIT-CNTL-NBR       TO JL-SYSUT1-AUD-CNTL-NBR.   09890000
098920     MOVE SU006-SYSTEM-MANUAL-AUDIT  TO JL-SYSTEM-MANUAL-AUDIT.   09892000
098930     MOVE SU006-RFID-QC-AUDIT-IND    TO JL-RFID-QC-AUDIT-IND.     09893000
098940     MOVE SU006-RFID-QC-AUD-CMB-IND  TO JL-RFID-QC-AUD-CMB-IND.   09894000
099000     MOVE JL-SYSUT1-AUD-CNTL-LINE    TO JL-SYSUT1-PARM-VALUE.     09900000
099100     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           09910000
099200*                                                                 09920000
099300     MOVE 'S140'                     TO JL-SYSUT1-STEP.           09930000
099400     MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER         09940000
099500     MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND        09950000
099600     MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR       09960000
099610*                                                                 09961015
099620     MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER         09962015
099630     MOVE SU006-USERID               TO JL-CNTL-CARD-USERID       09963015
099640     MOVE SU006-AUDIT-CNTL-NBR       TO JL-CNTL-CARD-AUD-NBR      09964015
099650*                                                                 09965015
099700     MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE.     09970000
099710*                                                                 09971016
099800     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           09980000
099900*                                                                 09990000
100000     PERFORM 9099-SUBMIT-REQUEST-STOP.                            10000000
100100                                                                  10010000
100110*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER FOR RFID     10011000
100111*    WHEN PART OF COMBINED AUDIT.                                 10011100
100112     IF SU006-SYSTEM-GENERATED-AUDIT AND                          10011200
100113        SU006-QC-AND-RFID-AUD                                     10011300
100120        PERFORM 9000-SUBMIT-REQUEST-START                         10012000
100130*                                                                 10013000
100140        MOVE 'S010'                     TO JL-SYSUT1-STEP         10014000
100150        MOVE SU006-RFID-AUDIT-CNTL-NBR  TO JL-SYSUT1-AUD-CNTL-NBR 10015000
100151        MOVE SU006-SYSTEM-MANUAL-AUDIT  TO JL-SYSTEM-MANUAL-AUDIT 10015100
100152        SET  JL-RFID-AUDIT              TO TRUE                   10015200
100153        MOVE SU006-RFID-QC-AUD-CMB-IND  TO JL-RFID-QC-AUD-CMB-IND 10015300
100160        MOVE JL-SYSUT1-AUD-CNTL-LINE    TO JL-SYSUT1-PARM-VALUE   10016000
100170        PERFORM 9050-SUBMIT-SYMBOLIC-LINE                         10017000
100180*                                                                 10018000
100190        MOVE 'S140'                     TO JL-SYSUT1-STEP         10019000
100191        MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER      10019100
100192        MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND     10019200
100193        MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR    10019300
100194*                                                                 10019415
100195        MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER      10019515
100196        MOVE SU006-USERID               TO JL-CNTL-CARD-USERID    10019615
100197        MOVE SU006-RFID-AUDIT-CNTL-NBR  TO JL-CNTL-CARD-AUD-NBR   10019715
100198*                                                                 10019815
100199        MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE   10019900
100200*                                                                 10020016
100205        PERFORM 9050-SUBMIT-SYMBOLIC-LINE                         10020500
100206*                                                                 10020600
100207        PERFORM 9099-SUBMIT-REQUEST-STOP                          10020700
100208     END-IF.                                                      10020800
100210                                                                  10021000
100220                                                                  10022000
100300******************************************************************10030000
100400*3300-RUN-CARTON-DETAIL-JOB                                       10040000
100500*  SUBMIT THE BATCH JOB TO CREATE THE APPROPRIATE REPORT         *10050000
100600******************************************************************10060000
100700 3300-RUN-CARTON-DETAIL-JOB.                                      10070000
100800                                                                  10080000
100900*                                                                 10090000
101000*    SET-UP VARIABLES IN THE JOB CARD                             10100000
101100     IF CA-TEST-CICS                                              10110000
101200         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          10120000
101300                                        JL-TEST-NOTIFY            10130000
101400         MOVE 'SUK9151T'             TO JL-LLE-PROC-NAME          10140060
101500         MOVE 'CARTON DETAIL'        TO JL-TEST-JOB-DESC          10150000
101510                                                                  10151063
101520         IF  PS-PRINT-TO-FILE-YES  AND                            10152063
101530             PS-REPORT-TO-FILE-YES                                10153063
101540             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           10154074
101550             MOVE SU006-USERID         TO  JL-FILE-USERID         10155074
101560             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      10156074
101570             SET  JL-CARTON-DTL        TO  TRUE                   10157074
101580             MOVE PC-COMMA             TO  JL-LLE-COMMA           10158068
101592         END-IF                                                   10159263
101593                                                                  10159363
101600     ELSE                                                         10160000
101700     IF CA-QA-CICS                                                10170000
101800         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          10180000
101900                                        JL-TEST-NOTIFY            10190000
102000         MOVE 'SUK9151Q'             TO JL-LLE-PROC-NAME          10200060
102100         MOVE 'CARTON DETAIL'        TO JL-TEST-JOB-DESC          10210000
102110                                                                  10211063
102120         IF  PS-PRINT-TO-FILE-YES  AND                            10212063
102130             PS-REPORT-TO-FILE-YES                                10213063
102140             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           10214074
102150             MOVE SU006-USERID         TO  JL-FILE-USERID         10215074
102160             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      10216074
102170             SET  JL-CARTON-DTL        TO  TRUE                   10217074
102180             MOVE PC-COMMA             TO  JL-LLE-COMMA           10218068
102192         END-IF                                                   10219263
102193                                                                  10219363
102200     ELSE                                                         10220000
102300     IF CA-LEARN-CICS                                             10230000
102400         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          10240000
102500                                        JL-TEST-NOTIFY            10250000
102600         MOVE 'SUK9151L'             TO JL-LLE-PROC-NAME          10260060
102700         MOVE 'CARTON DETAIL'        TO JL-TEST-JOB-DESC          10270000
102710                                                                  10271063
102720         IF  PS-PRINT-TO-FILE-YES  AND                            10272063
102730             PS-REPORT-TO-FILE-YES                                10273063
102740             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           10274074
102750             MOVE SU006-USERID         TO  JL-FILE-USERID         10275074
102760             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      10276074
102770             SET  JL-CARTON-DTL        TO  TRUE                   10277074
102780             MOVE PC-COMMA             TO  JL-LLE-COMMA           10278068
102792         END-IF                                                   10279263
102793                                                                  10279363
102800     ELSE                                                         10280000
102900         MOVE 'SUK915'               TO JL-JOB-NAME               10290000
103000         MOVE 'SUK9151 '             TO JL-PROD-PROC-NAME         10300060
103100         MOVE 'CARTON DETAIL'        TO JL-JOB-DESC               10310000
103110                                                                  10311063
103120         IF  PS-PRINT-TO-FILE-YES  AND                            10312063
103130             PS-REPORT-TO-FILE-YES                                10313063
103141             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           10314174
103150             MOVE SU006-USERID         TO  JL-FILE-USERID         10315074
103160             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      10316074
103170             SET  JL-CARTON-DTL         TO  TRUE                  10317074
103180             MOVE PC-COMMA             TO  JL-PROD-COMMA          10318068
103192         END-IF                                                   10319263
103193                                                                  10319363
103200     END-IF                                                       10320000
103300     END-IF                                                       10330000
103400     END-IF.                                                      10340000
103500                                                                  10350000
103600*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER              10360000
103700     PERFORM 9000-SUBMIT-REQUEST-START.                           10370000
103800*                                                                 10380000
103900     MOVE 'S010'                     TO JL-SYSUT1-STEP.           10390000
104000     MOVE SU006-AUDIT-CNTL-NBR       TO JL-SYSUT1-AUD-CNTL-NBR.   10400000
104100     MOVE SU006-SHIP-UNIT-NBR        TO JL-SYSUT1-SHIP-UNT-NBR.   10410000
104120     MOVE SU006-SYSTEM-MANUAL-AUDIT  TO JL-SYSTEM-MANUAL-AUDIT.   10412000
104130     MOVE SU006-RFID-QC-AUDIT-IND    TO JL-RFID-QC-AUDIT-IND.     10413000
104140     MOVE SU006-RFID-QC-AUD-CMB-IND  TO JL-RFID-QC-AUD-CMB-IND.   10414000
104200     MOVE JL-SYSUT1-AUD-CNTL-LINE    TO JL-SYSUT1-PARM-VALUE.     10420000
104300     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           10430000
104400*                                                                 10440000
104500     MOVE 'S090'                     TO JL-SYSUT1-STEP.           10450000
104600     MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER         10460000
104700     MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND        10470000
104800     MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR       10480000
104810*                                                                 10481015
104820     MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER         10482015
104830     MOVE SU006-USERID               TO JL-CNTL-CARD-USERID       10483015
104840     MOVE SU006-AUDIT-CNTL-NBR       TO JL-CNTL-CARD-AUD-NBR      10484015
104850*                                                                 10485015
104900     MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE.     10490000
104910*                                                                 10491016
105000     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           10500000
105100     PERFORM 9099-SUBMIT-REQUEST-STOP.                            10510000
105200                                                                  10520000
105210*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER FOR RFID     10521000
105211*    WHEN PART OF COMBINED AUDIT.                                 10521100
105212     IF SU006-SYSTEM-GENERATED-AUDIT AND                          10521200
105213        SU006-QC-AND-RFID-AUD                                     10521300
105220        PERFORM 9000-SUBMIT-REQUEST-START                         10522000
105230*                                                                 10523000
105240        MOVE 'S010'                     TO JL-SYSUT1-STEP         10524000
105250        MOVE SU006-RFID-AUDIT-CNTL-NBR  TO JL-SYSUT1-AUD-CNTL-NBR 10525000
105260        MOVE SU006-SHIP-UNIT-NBR        TO JL-SYSUT1-SHIP-UNT-NBR 10526000
105261        MOVE SU006-SYSTEM-MANUAL-AUDIT  TO JL-SYSTEM-MANUAL-AUDIT 10526100
105262        SET  JL-RFID-AUDIT              TO TRUE                   10526200
105263        MOVE SU006-RFID-QC-AUD-CMB-IND  TO JL-RFID-QC-AUD-CMB-IND 10526300
105270        MOVE JL-SYSUT1-AUD-CNTL-LINE    TO JL-SYSUT1-PARM-VALUE   10527000
105280        PERFORM 9050-SUBMIT-SYMBOLIC-LINE                         10528000
105290*                                                                 10529000
105291        MOVE 'S090'                     TO JL-SYSUT1-STEP         10529100
105292        MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER      10529200
105293        MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND     10529300
105294        MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR    10529400
105295*                                                                 10529515
105296        MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER      10529615
105297        MOVE SU006-USERID               TO JL-CNTL-CARD-USERID    10529715
105298        MOVE SU006-RFID-AUDIT-CNTL-NBR  TO JL-CNTL-CARD-AUD-NBR   10529815
105299*                                                                 10529915
105300        MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE   10530000
105301*                                                                 10530116
105306        PERFORM 9050-SUBMIT-SYMBOLIC-LINE                         10530600
105307        PERFORM 9099-SUBMIT-REQUEST-STOP                          10530700
105308     END-IF.                                                      10530800
105310                                                                  10531000
105320                                                                  10532000
105400******************************************************************10540000
105500*3400-RUN-RECEIVER-LIST-JOB                                       10550000
105600*  SUBMIT THE BATCH JOB TO CREATE THE APPROPRIATE REPORT         *10560000
105700******************************************************************10570000
105800 3400-RUN-RECEIVER-LIST-JOB.                                      10580000
105900                                                                  10590000
106000*    SET-UP VARIABLES IN THE JOB CARD                             10600000
106100     IF CA-TEST-CICS                                              10610000
106200         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          10620000
106300                                        JL-TEST-NOTIFY            10630000
106400         MOVE 'SUK9201T'             TO JL-LLE-PROC-NAME          10640060
106500         MOVE 'RECEIVER LIST'        TO JL-TEST-JOB-DESC          10650000
106510                                                                  10651064
106520         IF  PS-PRINT-TO-FILE-YES  AND                            10652064
106530             PS-REPORT-TO-FILE-YES                                10653064
106540             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           10654074
106550             MOVE SU006-USERID         TO  JL-FILE-USERID         10655074
106560             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      10656074
106570             SET  JL-RECEIVER-LIST TO      TRUE                   10657074
106580             MOVE PC-COMMA             TO  JL-LLE-COMMA           10658068
106592         END-IF                                                   10659264
106593                                                                  10659364
106600     ELSE                                                         10660000
106700     IF CA-QA-CICS                                                10670000
106800         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          10680000
106900                                        JL-TEST-NOTIFY            10690000
107000         MOVE 'SUK9201Q'             TO JL-LLE-PROC-NAME          10700060
107100         MOVE 'RECEIVER LIST'        TO JL-TEST-JOB-DESC          10710000
107110                                                                  10711064
107120         IF  PS-PRINT-TO-FILE-YES  AND                            10712064
107130             PS-REPORT-TO-FILE-YES                                10713064
107140             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           10714074
107150             MOVE SU006-USERID         TO  JL-FILE-USERID         10715074
107160             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      10716074
107170             SET  JL-RECEIVER-LIST TO      TRUE                   10717074
107180             MOVE PC-COMMA             TO  JL-LLE-COMMA           10718068
107192         END-IF                                                   10719264
107193                                                                  10719364
107200     ELSE                                                         10720000
107300     IF CA-LEARN-CICS                                             10730000
107400         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          10740000
107500                                        JL-TEST-NOTIFY            10750000
107600         MOVE 'SUK9201L'             TO JL-LLE-PROC-NAME          10760060
107700         MOVE 'RECEIVER LIST'        TO JL-TEST-JOB-DESC          10770000
107710                                                                  10771064
107720         IF  PS-PRINT-TO-FILE-YES  AND                            10772064
107730             PS-REPORT-TO-FILE-YES                                10773064
107740             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           10774074
107750             MOVE SU006-USERID         TO  JL-FILE-USERID         10775074
107760             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      10776074
107770             SET  JL-RECEIVER-LIST TO      TRUE                   10777074
107780             MOVE PC-COMMA             TO  JL-LLE-COMMA           10778068
107792         END-IF                                                   10779264
107793                                                                  10779364
107800     ELSE                                                         10780000
107900         MOVE 'SUK920'               TO JL-JOB-NAME               10790000
108000         MOVE 'SUK9201'              TO JL-PROD-PROC-NAME         10800064
108100         MOVE 'RECEIVER LIST'        TO JL-JOB-DESC               10810000
108110                                                                  10811064
108120         IF  PS-PRINT-TO-FILE-YES  AND                            10812064
108130             PS-REPORT-TO-FILE-YES                                10813064
108140             MOVE SU006-OPER-UNT-ID     TO JL-FILE-OPER           10814074
108150             MOVE SU006-USERID          TO JL-FILE-USERID         10815074
108160             MOVE SU006-AUDIT-CNTL-NBR  TO JL-FILE-AUDIT-NBR      10816074
108170             SET  JL-RECEIVER-LIST TO TRUE                        10817074
108180             MOVE PC-COMMA              TO JL-PROD-COMMA          10818068
108192         END-IF                                                   10819264
108193                                                                  10819364
108200     END-IF                                                       10820000
108300     END-IF                                                       10830000
108400     END-IF.                                                      10840000
108500                                                                  10850000
108600*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER              10860000
108700     PERFORM 9000-SUBMIT-REQUEST-START.                           10870000
108800*                                                                 10880000
108900     MOVE 'S010'                     TO JL-SYSUT1-STEP.           10890000
109000     MOVE SU006-AUDIT-CNTL-NBR       TO JL-SYSUT1-AUD-CNTL-NBR.   10900000
109020     MOVE SU006-SYSTEM-MANUAL-AUDIT  TO JL-SYSTEM-MANUAL-AUDIT.   10902000
109030     MOVE SU006-RFID-QC-AUDIT-IND    TO JL-RFID-QC-AUDIT-IND.     10903000
109040     MOVE SU006-RFID-QC-AUD-CMB-IND  TO JL-RFID-QC-AUD-CMB-IND.   10904000
109100     MOVE JL-SYSUT1-AUD-CNTL-LINE    TO JL-SYSUT1-PARM-VALUE.     10910000
109200     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           10920000
109300*                                                                 10930000
109400     MOVE 'S140'                     TO JL-SYSUT1-STEP.           10940000
109500     MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER         10950000
109600     MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND        10960000
109700     MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR       10970000
109710*                                                                 10971015
109720     MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER         10972015
109730     MOVE SU006-USERID               TO JL-CNTL-CARD-USERID       10973015
109740     MOVE SU006-AUDIT-CNTL-NBR       TO JL-CNTL-CARD-AUD-NBR      10974015
109750*                                                                 10975015
109800     MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE.     10980000
109810*                                                                 10981016
109900     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           10990000
110000*                                                                 11000000
110100     PERFORM 9099-SUBMIT-REQUEST-STOP.                            11010000
110200                                                                  11020000
110300                                                                  11030000
110310                                                                  11031000
110400******************************************************************11040000
110500*3500-RUN-INPROCESS-AUDIT-JOB                                     11050000
110600*  SUBMIT THE BATCH JOB TO CREATE THE APPROPRIATE REPORT         *11060000
110700******************************************************************11070000
110800 3500-RUN-INPROCESS-AUDIT-JOB.                                    11080000
110900                                                                  11090000
111000*    SET-UP VARIABLES IN THE JOB CARD                             11100000
111100     IF CA-TEST-CICS                                              11110000
111200         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          11120000
111300                                        JL-TEST-NOTIFY            11130000
111400         MOVE 'SUK9251T'             TO JL-LLE-PROC-NAME          11140060
111500         MOVE 'INPROCESS AUD'        TO JL-TEST-JOB-DESC          11150000
111510                                                                  11151064
111520         IF  PS-PRINT-TO-FILE-YES  AND                            11152064
111530             PS-REPORT-TO-FILE-YES                                11153064
111540             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           11154074
111550             MOVE SU006-USERID         TO  JL-FILE-USERID         11155074
111560             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      11156074
111570             SET  JL-INPROCESS-AUD TO      TRUE                   11157074
111580             MOVE PC-COMMA             TO  JL-LLE-COMMA           11158068
111592         END-IF                                                   11159264
111593                                                                  11159364
111600     ELSE                                                         11160000
111700     IF CA-QA-CICS                                                11170000
111800         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          11180000
111900                                        JL-TEST-NOTIFY            11190000
112000         MOVE 'SUK9251Q'             TO JL-LLE-PROC-NAME          11200060
112100         MOVE 'INPROCESS AUD'        TO JL-TEST-JOB-DESC          11210000
112110                                                                  11211064
112120         IF  PS-PRINT-TO-FILE-YES  AND                            11212064
112130             PS-REPORT-TO-FILE-YES                                11213064
112140             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           11214074
112150             MOVE SU006-USERID         TO  JL-FILE-USERID         11215074
112160             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      11216074
112170             SET  JL-INPROCESS-AUD TO      TRUE                   11217074
112180             MOVE PC-COMMA             TO  JL-LLE-COMMA           11218068
112192         END-IF                                                   11219264
112193                                                                  11219364
112200     ELSE                                                         11220000
112300     IF CA-LEARN-CICS                                             11230000
112400         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          11240000
112500                                        JL-TEST-NOTIFY            11250000
112600         MOVE 'SUK9251L'             TO JL-LLE-PROC-NAME          11260060
112700         MOVE 'INPROCESS AUD'        TO JL-TEST-JOB-DESC          11270000
112710                                                                  11271064
112720         IF  PS-PRINT-TO-FILE-YES  AND                            11272064
112730             PS-REPORT-TO-FILE-YES                                11273064
112740             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           11274074
112750             MOVE SU006-USERID         TO  JL-FILE-USERID         11275074
112760             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      11276074
112770             SET  JL-INPROCESS-AUD TO      TRUE                   11277074
112780             MOVE PC-COMMA             TO  JL-LLE-COMMA           11278068
112792         END-IF                                                   11279264
112793                                                                  11279364
112800     ELSE                                                         11280000
112900         MOVE 'SUK925'               TO JL-JOB-NAME               11290000
113000         MOVE 'SUK9251 '             TO JL-PROD-PROC-NAME         11300060
113100         MOVE 'INPROCESS AUD'        TO JL-JOB-DESC               11310000
113110                                                                  11311064
113120         IF  PS-PRINT-TO-FILE-YES  AND                            11312064
113130             PS-REPORT-TO-FILE-YES                                11313064
113140             MOVE SU006-OPER-UNT-ID    TO JL-FILE-OPER            11314074
113150             MOVE SU006-USERID         TO JL-FILE-USERID          11315074
113160             MOVE SU006-AUDIT-CNTL-NBR TO JL-FILE-AUDIT-NBR       11316074
113170             SET  JL-INPROCESS-AUD TO TRUE                        11317074
113180             MOVE PC-COMMA             TO JL-PROD-COMMA           11318068
113192         END-IF                                                   11319264
113193                                                                  11319364
113200     END-IF                                                       11320000
113300     END-IF                                                       11330000
113400     END-IF.                                                      11340000
113500                                                                  11350000
113600*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER              11360000
113700     PERFORM 9000-SUBMIT-REQUEST-START.                           11370000
113800*                                                                 11380000
113900     MOVE 'S080'                     TO JL-SYSUT1-STEP.           11390000
114000     MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER         11400000
114100     MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND        11410000
114101     MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR       11410115
114110*                                                                 11411015
114120     MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER         11412015
114130     MOVE SU006-USERID               TO JL-CNTL-CARD-USERID       11413015
114140     MOVE SU006-AUDIT-CNTL-NBR       TO JL-CNTL-CARD-AUD-NBR      11414015
114150*                                                                 11415015
114300     MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE.     11430000
114310*                                                                 11431016
114400     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           11440000
114500*                                                                 11450000
114600     PERFORM 9099-SUBMIT-REQUEST-STOP.                            11460000
114700******************************************************************11470000
114800*3600-RUN-CARTON-OPEN-JOB                                         11480000
114900*  SUBMIT THE BATCH JOB TO CREATE THE APPROPRIATE REPORT         *11490000
115000******************************************************************11500000
115100 3600-RUN-CARTON-OPEN-JOB.                                        11510000
115200                                                                  11520000
115300     IF CA-TEST-CICS                                              11530000
115400         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          11540000
115500                                        JL-TEST-NOTIFY            11550000
115600         MOVE 'SUK9351T'             TO JL-LLE-PROC-NAME          11560060
115700         MOVE 'CARTON OPEN'          TO JL-TEST-JOB-DESC          11570000
115710                                                                  11571065
115720         IF  PS-PRINT-TO-FILE-YES  AND                            11572065
115730             PS-REPORT-TO-FILE-YES                                11573065
115740             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           11574074
115750             MOVE SU006-USERID         TO  JL-FILE-USERID         11575074
115760             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      11576074
115770             SET  JL-CARTON-OPEN       TO  TRUE                   11577074
115780             MOVE PC-COMMA             TO  JL-LLE-COMMA           11578068
115792         END-IF                                                   11579265
115793                                                                  11579365
115800     ELSE                                                         11580000
115900     IF CA-QA-CICS                                                11590000
116000         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          11600000
116100                                        JL-TEST-NOTIFY            11610000
116200         MOVE 'SUK9351Q'             TO JL-LLE-PROC-NAME          11620060
116300         MOVE 'CARTON OPEN'          TO JL-TEST-JOB-DESC          11630000
116310                                                                  11631065
116320         IF  PS-PRINT-TO-FILE-YES  AND                            11632065
116330             PS-REPORT-TO-FILE-YES                                11633065
116340             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           11634074
116350             MOVE SU006-USERID         TO  JL-FILE-USERID         11635074
116360             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      11636074
116370             SET  JL-CARTON-OPEN       TO  TRUE                   11637074
116380             MOVE PC-COMMA             TO  JL-LLE-COMMA           11638068
116392         END-IF                                                   11639265
116393                                                                  11639365
116400     ELSE                                                         11640000
116500     IF CA-LEARN-CICS                                             11650000
116600         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          11660000
116700                                        JL-TEST-NOTIFY            11670000
116800         MOVE 'SUK9351L'             TO JL-LLE-PROC-NAME          11680060
116900         MOVE 'CARTON OPEN'          TO JL-TEST-JOB-DESC          11690000
116910                                                                  11691065
116920         IF  PS-PRINT-TO-FILE-YES  AND                            11692065
116930             PS-REPORT-TO-FILE-YES                                11693065
116940             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           11694074
116950             MOVE SU006-USERID         TO  JL-FILE-USERID         11695074
116960             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      11696074
116970             SET  JL-CARTON-OPEN       TO  TRUE                   11697074
116980             MOVE PC-COMMA             TO  JL-LLE-COMMA           11698068
116992         END-IF                                                   11699265
116993                                                                  11699365
117000     ELSE                                                         11700000
117100         MOVE 'SUK935'               TO JL-JOB-NAME               11710000
117200         MOVE 'SUK9351'              TO JL-PROD-PROC-NAME         11720065
117300         MOVE 'CARTON OPEN'          TO JL-JOB-DESC               11730000
117310                                                                  11731065
117320         IF  PS-PRINT-TO-FILE-YES  AND                            11732065
117330             PS-REPORT-TO-FILE-YES                                11733065
117340             MOVE SU006-OPER-UNT-ID    TO JL-FILE-OPER            11734074
117350             MOVE SU006-USERID         TO JL-FILE-USERID          11735074
117360             MOVE SU006-AUDIT-CNTL-NBR TO JL-FILE-AUDIT-NBR       11736074
117370             SET  JL-CARTON-OPEN       TO TRUE                    11737074
117380             MOVE PC-COMMA             TO JL-prod-COMMA           11738068
117392         END-IF                                                   11739265
117393                                                                  11739365
117400     END-IF                                                       11740000
117500     END-IF                                                       11750000
117600     END-IF.                                                      11760000
117700                                                                  11770000
117800*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER              11780000
117900     PERFORM 9000-SUBMIT-REQUEST-START.                           11790000
118000     MOVE 'S010'                     TO JL-SYSUT1-STEP.           11800000
118100     MOVE SU006-AUDIT-CNTL-NBR       TO JL-SYSUT1-AUD-CNTL-NBR.   11810000
118120     MOVE SU006-SYSTEM-MANUAL-AUDIT  TO JL-SYSTEM-MANUAL-AUDIT.   11812000
118130     MOVE SU006-RFID-QC-AUDIT-IND    TO JL-RFID-QC-AUDIT-IND.     11813000
118140     MOVE SU006-RFID-QC-AUD-CMB-IND  TO JL-RFID-QC-AUD-CMB-IND.   11814000
118200     MOVE JL-SYSUT1-AUD-CNTL-LINE    TO JL-SYSUT1-PARM-VALUE.     11820000
118300     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           11830000
118400*                                                                 11840000
118500     MOVE 'S020'                     TO JL-SYSUT1-STEP.           11850000
118600     MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER         11860000
118700     MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND        11870000
118800     MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR       11880000
118810*                                                                 11881015
118820     MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER         11882015
118830     MOVE SU006-USERID               TO JL-CNTL-CARD-USERID       11883015
118840     MOVE SU006-AUDIT-CNTL-NBR       TO JL-CNTL-CARD-AUD-NBR      11884015
118850*                                                                 11885015
118900     MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE.     11890000
118910*                                                                 11891016
119000     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           11900000
119100*                                                                 11910000
119200     PERFORM 9099-SUBMIT-REQUEST-STOP.                            11920000
119300                                                                  11930000
119310*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER FOR RFID     11931000
119311*    WHEN PART OF COMBINED AUDIT.                                 11931100
119312     IF SU006-SYSTEM-GENERATED-AUDIT AND                          11931200
119313        SU006-QC-AND-RFID-AUD                                     11931300
119320        PERFORM 9000-SUBMIT-REQUEST-START                         11932000
119330        MOVE 'S010'                     TO JL-SYSUT1-STEP         11933000
119340        MOVE SU006-RFID-AUDIT-CNTL-NBR  TO JL-SYSUT1-AUD-CNTL-NBR 11934000
119341        MOVE SU006-SYSTEM-MANUAL-AUDIT  TO JL-SYSTEM-MANUAL-AUDIT 11934100
119342        SET  JL-RFID-AUDIT              TO TRUE                   11934200
119343        MOVE SU006-RFID-QC-AUD-CMB-IND  TO JL-RFID-QC-AUD-CMB-IND 11934300
119350        MOVE JL-SYSUT1-AUD-CNTL-LINE    TO JL-SYSUT1-PARM-VALUE   11935000
119360        PERFORM 9050-SUBMIT-SYMBOLIC-LINE                         11936000
119370*                                                                 11937000
119380        MOVE 'S020'                     TO JL-SYSUT1-STEP         11938000
119390        MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER      11939000
119391        MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND     11939100
119392        MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR    11939200
119393*                                                                 11939315
119394        MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER      11939415
119395        MOVE SU006-USERID               TO JL-CNTL-CARD-USERID    11939515
119396        MOVE SU006-RFID-AUDIT-CNTL-NBR  TO JL-CNTL-CARD-AUD-NBR   11939615
119397*                                                                 11939715
119398        MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE   11939800
119399*                                                                 11939916
119404        PERFORM 9050-SUBMIT-SYMBOLIC-LINE                         11940400
119405*                                                                 11940500
119406        PERFORM 9099-SUBMIT-REQUEST-STOP                          11940600
119407     END-IF.                                                      11940700
119409                                                                  11940900
119410                                                                  11941000
119500******************************************************************11950000
119600*3700-RUN-RCVR-OVRSHT-JOB                                         11960000
119700*  SUBMIT THE BATCH JOB TO CREATE THE APPROPRIATE REPORT         *11970000
119800******************************************************************11980000
119900 3700-RUN-RCVR-OVRSHT-JOB.                                        11990000
120000                                                                  12000000
120100     IF CA-TEST-CICS                                              12010000
120200         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          12020000
120300                                        JL-TEST-NOTIFY            12030000
120400         MOVE 'SUK9301T'             TO JL-LLE-PROC-NAME          12040060
120500         MOVE 'RCVR OVER/SHORT'      TO JL-TEST-JOB-DESC          12050065
120510                                                                  12051065
120520         IF  PS-PRINT-TO-FILE-YES  AND                            12052065
120530             PS-REPORT-TO-FILE-YES                                12053065
120540             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           12054074
120550             MOVE SU006-USERID         TO  JL-FILE-USERID         12055074
120560             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      12056074
120570             SET  JL-OVER-SHORT        TO  TRUE                   12057074
120580             MOVE PC-COMMA             TO  JL-LLE-COMMA           12058068
120592         END-IF                                                   12059265
120593                                                                  12059365
120600     ELSE                                                         12060000
120700     IF CA-QA-CICS                                                12070000
120800         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          12080000
120900                                        JL-TEST-NOTIFY            12090000
121000         MOVE 'SUK9301Q'             TO JL-LLE-PROC-NAME          12100060
121100         MOVE 'RCVR OVER/SHORT'      TO JL-TEST-JOB-DESC          12110065
121110                                                                  12111065
121120         IF  PS-PRINT-TO-FILE-YES  AND                            12112065
121130             PS-REPORT-TO-FILE-YES                                12113065
121140             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           12114074
121150             MOVE SU006-USERID         TO  JL-FILE-USERID         12115074
121160             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      12116074
121170             SET  JL-OVER-SHORT        TO  TRUE                   12117074
121180             MOVE PC-COMMA             TO  JL-LLE-COMMA           12118068
121192         END-IF                                                   12119265
121193                                                                  12119365
121200     ELSE                                                         12120000
121300     IF CA-LEARN-CICS                                             12130000
121400         MOVE SU006-USERID           TO JL-TEST-JOB-NAME          12140000
121500                                        JL-TEST-NOTIFY            12150000
121600         MOVE 'SUK9301L'             TO JL-LLE-PROC-NAME          12160060
121700         MOVE 'RCVR OVER/SHORT'      TO JL-TEST-JOB-DESC          12170065
121710                                                                  12171065
121720         IF  PS-PRINT-TO-FILE-YES  AND                            12172065
121730             PS-REPORT-TO-FILE-YES                                12173065
121740             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           12174074
121750             MOVE SU006-USERID         TO  JL-FILE-USERID         12175074
121760             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      12176074
121770             SET  JL-OVER-SHORT        TO  TRUE                   12177074
121780             MOVE PC-COMMA             TO  JL-LLE-COMMA           12178068
121792         END-IF                                                   12179265
121793                                                                  12179365
121800     ELSE                                                         12180000
121900         MOVE 'SUK930'               TO JL-JOB-NAME               12190000
122000         MOVE 'SUK9301 '             TO JL-PROD-PROC-NAME         12200060
122100         MOVE 'RCVR OVER/SHORT'      TO JL-JOB-DESC               12210000
122110                                                                  12211065
122120         IF  PS-PRINT-TO-FILE-YES  AND                            12212065
122130             PS-REPORT-TO-FILE-YES                                12213065
122140             MOVE SU006-OPER-UNT-ID    TO  JL-FILE-OPER           12214074
122150             MOVE SU006-USERID         TO  JL-FILE-USERID         12215074
122160             MOVE SU006-AUDIT-CNTL-NBR TO  JL-FILE-AUDIT-NBR      12216074
122170             SET  JL-OVER-SHORT        TO  TRUE                   12217074
122180             MOVE PC-COMMA             TO  JL-PROD-COMMA          12218068
122192         END-IF                                                   12219265
122193                                                                  12219365
122200     END-IF                                                       12220000
122300     END-IF                                                       12230000
122400     END-IF.                                                      12240000
122500                                                                  12250000
122600*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER              12260000
122700     PERFORM 9000-SUBMIT-REQUEST-START.                           12270000
122800     MOVE 'S010'                     TO JL-SYSUT1-STEP.           12280000
122900     MOVE SU006-AUDIT-CNTL-NBR       TO JL-SYSUT1-AUD-CNTL-NBR.   12290000
122920     MOVE SU006-SYSTEM-MANUAL-AUDIT  TO JL-SYSTEM-MANUAL-AUDIT.   12292000
122930     MOVE SU006-RFID-QC-AUDIT-IND    TO JL-RFID-QC-AUDIT-IND.     12293000
122940     MOVE SU006-RFID-QC-AUD-CMB-IND  TO JL-RFID-QC-AUD-CMB-IND.   12294000
123000     MOVE JL-SYSUT1-AUD-CNTL-LINE    TO JL-SYSUT1-PARM-VALUE.     12300000
123100     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           12310000
123200*                                                                 12320000
123300     MOVE 'S080'                     TO JL-SYSUT1-STEP.           12330000
123400     MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER         12340000
123500     MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND        12350000
123600     MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR       12360000
123610*                                                                 12361015
123620     MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER         12362015
123630     MOVE SU006-USERID               TO JL-CNTL-CARD-USERID       12363015
123640     MOVE SU006-AUDIT-CNTL-NBR       TO JL-CNTL-CARD-AUD-NBR      12364015
123650*                                                                 12365015
123700     MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE.     12370000
123710*                                                                 12371016
123800     PERFORM 9050-SUBMIT-SYMBOLIC-LINE.                           12380000
123900*                                                                 12390000
124000     PERFORM 9099-SUBMIT-REQUEST-STOP.                            12400000
124100                                                                  12410000
124110*    SUBMIT JOB QUEUE REQUEST TO THE INTERNAL READER FOR RFID     12411000
124111*    WHEN PART OF COMBINED AUDIT.                                 12411100
124112     IF SU006-SYSTEM-GENERATED-AUDIT AND                          12411200
124113        SU006-QC-AND-RFID-AUD                                     12411300
124120        PERFORM 9000-SUBMIT-REQUEST-START                         12412000
124130        MOVE 'S010'                     TO JL-SYSUT1-STEP         12413000
124140        MOVE SU006-RFID-AUDIT-CNTL-NBR  TO JL-SYSUT1-AUD-CNTL-NBR 12414000
124141        MOVE SU006-SYSTEM-MANUAL-AUDIT  TO JL-SYSTEM-MANUAL-AUDIT 12414100
124142        SET  JL-RFID-AUDIT              TO TRUE                   12414200
124143        MOVE SU006-RFID-QC-AUD-CMB-IND  TO JL-RFID-QC-AUD-CMB-IND 12414300
124150        MOVE JL-SYSUT1-AUD-CNTL-LINE    TO JL-SYSUT1-PARM-VALUE   12415000
124160        PERFORM 9050-SUBMIT-SYMBOLIC-LINE                         12416000
124170*                                                                 12417000
124180        MOVE 'S080'                     TO JL-SYSUT1-STEP         12418000
124190        MOVE SU006-PRINTER-DEST         TO JL-SYSUT1-PRINTER      12419000
124191        MOVE CA-PRTR-CNTL-IND           TO JL-SYSUT1-PRTR-IND     12419100
124192        MOVE CA-TRACK-NBR               TO JL-SYSUT1-TRACK-NBR    12419200
124193*                                                                 12419315
124194        MOVE SU006-OPER-UNT-ID          TO JL-CNTL-CARD-OPER      12419415
124195        MOVE SU006-USERID               TO JL-CNTL-CARD-USERID    12419515
124196        MOVE SU006-RFID-AUDIT-CNTL-NBR  TO JL-CNTL-CARD-AUD-NBR   12419615
124197*                                                                 12419715
124198        MOVE JL-SYSUT1-PRT-LINE         TO JL-SYSUT1-PARM-VALUE   12419800
124199*                                                                 12419916
124204        PERFORM 9050-SUBMIT-SYMBOLIC-LINE                         12420400
124205*                                                                 12420500
124206        PERFORM 9099-SUBMIT-REQUEST-STOP                          12420600
124207     END-IF.                                                      12420700
124209                                                                  12420900
124210                                                                  12421000
124300 4200-XCTL-TO-HELP.                                               12430000
124400                                                                  12440000
124500     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      12450000
124600     SET  SU006-INITIALIZE-SCREEN     TO TRUE.                    12460000
124700     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    12470000
124800                                                                  12480000
124900     EXEC CICS                                                    12490000
125000         XCTL                                                     12500000
125100             PROGRAM   (PV-TRANSFER-PROGRAM)                      12510000
125200             COMMAREA  (PC192-COMMAREA)                           12520000
125300             LENGTH    (PV-COMMAREA-LENGTH)                       12530000
125400             RESP      (PV-CICS-RESPONSE)                         12540000
125500     END-EXEC.                                                    12550000
125600                                                                  12560000
125700     EVALUATE TRUE                                                12570000
125800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12580000
125900              CONTINUE                                            12590000
126000         WHEN OTHER                                               12600000
126100             MOVE '4200-XCTL-TO-HELP '                            12610000
126200                 TO DP013-PARAGRAPH                               12620000
126300             MOVE 'SUKRF523 - UNABLE TO XCTL TO PROGRAM: '        12630000
126400                 TO DP013-MESSAGE-TEXT (1)                        12640000
126500             MOVE PV-TRANSFER-PROGRAM                             12650000
126600                 TO DP013-MESSAGE-TEXT (2)                        12660000
126700             SET DP013-CICS-ABEND  TO TRUE                        12670000
126800             SET DP013-ROLLBACK TO TRUE                           12680000
126900             PERFORM 9999-WRITE-CICS-LOG-MSG                      12690000
127000             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             12700000
127100             SET SU006-PROCESS-SCREEN TO TRUE                     12710000
127200             PERFORM 8000-SEND-MAP                                12720000
127300             PERFORM 8200-RETURN-TRANID                           12730000
127400     END-EVALUATE.                                                12740000
127500*                                                                 12750000
127600******************************************************************12760000
127700*  8000-SEND-MAP                                                 *12770000
127800*  SEND THE REFRESHED MAP IMAGE TO THE SCREEN                    *12780000
127900******************************************************************12790000
128000 8000-SEND-MAP.                                                   12800000
128100                                                                  12810000
128200     MOVE -1 TO ASELECTL                                          12820000
128300     EXEC CICS                                                    12830000
128400         SEND                                                     12840000
128500             MAP     ('SU523A')                                   12850000
128600             MAPSET  ('SUKM523')                                  12860000
128700             ERASE                                                12870000
128800             CURSOR                                               12880000
128900             RESP    (PV-CICS-RESPONSE)                           12890000
129000     END-EXEC.                                                    12900000
129100                                                                  12910000
129200     EVALUATE TRUE                                                12920000
129300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12930000
129400             CONTINUE                                             12940000
129500         WHEN OTHER                                               12950000
129600             MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH            12960000
129700             MOVE 'UNABLE TO SEND MAP'                            12970000
129800                                    TO DP013-MESSAGE-TEXT (1)     12980000
129900             SET DP013-CICS-ABEND   TO TRUE                       12990000
130000             SET DP013-NO-ROLLBACK  TO TRUE                       13000000
130100             PERFORM 9999-WRITE-CICS-LOG-MSG                      13010000
130200     END-EVALUATE.                                                13020000
130300*                                                                 13030000
130400 8100-SEND-DATA-ONLY.                                             13040000
130500                                                                  13050000
130600     EXEC CICS                                                    13060000
130700         SEND                                                     13070000
130800             MAP       ('SU523A')                                 13080000
130900             MAPSET    ('SUKM523')                                13090000
131000             CURSOR                                               13100000
131100             DATAONLY                                             13110000
131200             RESP      (PV-CICS-RESPONSE)                         13120000
131300     END-EXEC.                                                    13130000
131400                                                                  13140000
131500     EVALUATE TRUE                                                13150000
131600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13160000
131700             CONTINUE                                             13170000
131800         WHEN OTHER                                               13180000
131900             MOVE '8100-SEND-DATA-ONLY'                           13190000
132000                                    TO DP013-PARAGRAPH            13200000
132100             MOVE 'UNABLE TO SEND DATA'                           13210000
132200                                    TO DP013-MESSAGE-TEXT (1)     13220000
132300             SET DP013-CICS-ABEND   TO TRUE                       13230000
132400             SET DP013-NO-ROLLBACK  TO TRUE                       13240000
132500             PERFORM 9999-WRITE-CICS-LOG-MSG                      13250000
132600     END-EVALUATE.                                                13260000
132700*                                                                 13270000
132800 8200-RETURN-TRANID.                                              13280000
132900     MOVE LENGTH OF CA-COMMAREA  TO  PV-COMMAREA-LENGTH.          13290000
133000                                                                  13300000
133100     EXEC CICS                                                    13310000
133200         RETURN                                                   13320000
133300             TRANSID   (PC-CURRENT-TRANID)                        13330000
133400             COMMAREA  (CA-COMMAREA)                              13340000
133500             LENGTH    (PV-COMMAREA-LENGTH)                       13350000
133600             RESP      (PV-CICS-RESPONSE)                         13360000
133700     END-EXEC.                                                    13370000
133800                                                                  13380000
133900     EVALUATE TRUE                                                13390000
134000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13400000
134100             CONTINUE                                             13410000
134200         WHEN OTHER                                               13420000
134300             MOVE '8200-RETURN-TRANID'                            13430000
134400                                    TO DP013-PARAGRAPH            13440000
134500             MOVE 'UNABLE TO RETURN TO TRANID'                    13450000
134600                                    TO DP013-MESSAGE-TEXT (1)     13460000
134700             SET DP013-CICS-ABEND   TO TRUE                       13470000
134800             SET DP013-NO-ROLLBACK  TO TRUE                       13480000
134900             PERFORM 9999-WRITE-CICS-LOG-MSG                      13490000
135000     END-EVALUATE.                                                13500000
135100                                                                  13510000
135200                                                                  13520000
135300**************************************************************    13530000
135400* QUEUE UP THE INTERNAL READER, SET-UP AND SEND THE JOB LINE *    13540000
135500* BY LINE UP TO THE SYMBOLIC INFO                            *    13550000
135600**************************************************************    13560000
135700 9000-SUBMIT-REQUEST-START.                                       13570000
135800*    FIRE-UP THE INTERNAL READER                                  13580000
135900     PERFORM 9500-ENQUEUE-INTERNAL-READER.                        13590000
136000                                                                  13600000
136100*    SET-UP JOB DEPENDING ON THE REGION                           13610000
136200     IF CA-PROD-CICS                                              13620000
136300                                                                  13630000
136400          MOVE JL-JOB-LINE-PROD     TO  JL-JCL-LINE-1             13640000
136500          MOVE JL-JCL-LINE-1        TO TD-JCL-LINE                13650000
136600          PERFORM 9100-WRITE-TD-LINE                              13660000
136700                                                                  13670000
136800*         JOBPARM LINE                                            13680000
136900          MOVE JL-JCL-LINE-3        TO TD-JCL-LINE                13690000
137000          PERFORM 9100-WRITE-TD-LINE                              13700000
137100                                                                  13710000
137200*         JOBOUT LINE                                             13720000
137300          MOVE SU006-PRINTER-DEST   TO JL-LINE-18-PRINTER         13730081
137301                                                                  13730187
137310          IF  PS-PRINT-TO-FILE-YES                                13731087
137400              MOVE JL-JCL-LINE-18B  TO TD-JCL-LINE                13740087
137401          ELSE                                                    13740187
137410              MOVE JL-JCL-LINE-18   TO TD-JCL-LINE                13741087
137420          END-IF                                                  13742087
137500          PERFORM 9100-WRITE-TD-LINE                              13750000
137600                                                                  13760000
137700*         JOBLIB LINE                                             13770000
137800          MOVE JL-JCL-LINE-4-PROD   TO TD-JCL-LINE                13780000
137900          PERFORM 9100-WRITE-TD-LINE                              13790000
137901                                                                  13790159
137910         IF  PS-PRINT-TO-FILE-YES  AND                            13791059
137920             PS-REPORT-TO-FILE-YES                                13792059
137930             MOVE ','        TO  JL-PROD-COMMA                    13793059
137940         ELSE                                                     13794059
137950             MOVE SPACE      TO  JL-PROD-COMMA                    13795059
137960         END-IF                                                   13796059
138000     ELSE                                                         13800000
138100          MOVE JL-JOB-LINE-TEST     TO  JL-JCL-LINE-1             13810000
138200          MOVE JL-JCL-LINE-1        TO TD-JCL-LINE                13820000
138300          PERFORM 9100-WRITE-TD-LINE                              13830000
138400                                                                  13840000
138500*         JOBOUT LINE                                             13850000
138600          MOVE SU006-PRINTER-DEST   TO JL-LINE-18-PRINTER         13860081
138610          IF  PS-PRINT-TO-FILE-YES                                13861088
138620              MOVE JL-JCL-LINE-18B  TO TD-JCL-LINE                13862088
138630          ELSE                                                    13863088
138640              MOVE JL-JCL-LINE-18   TO TD-JCL-LINE                13864088
138650          END-IF                                                  13865088
138800          PERFORM 9100-WRITE-TD-LINE                              13880000
138900                                                                  13890000
139000*         JOBLIB LINE                                             13900000
139100          IF CA-QA-CICS                                           13910000
139200             MOVE JL-JCL-LINE-4-QA     TO TD-JCL-LINE             13920000
139300          ELSE                                                    13930000
139400             IF CA-LEARN-CICS                                     13940000
139500                MOVE JL-JCL-LINE-4-LEARN  TO TD-JCL-LINE          13950000
139600             ELSE                                                 13960000
139700                MOVE JL-JCL-LINE-4-TEST   TO TD-JCL-LINE          13970000
139800             END-IF                                               13980000
139900          END-IF                                                  13990000
140000          PERFORM 9100-WRITE-TD-LINE                              14000000
140001                                                                  14000159
140010         IF  PS-PRINT-TO-FILE-YES  AND                            14001059
140020             PS-REPORT-TO-FILE-YES                                14002059
140030             MOVE ','        TO  JL-LLE-COMMA                     14003059
140040         ELSE                                                     14004059
140050             MOVE SPACE      TO  JL-LLE-COMMA                     14005059
140060         END-IF                                                   14006059
140100     END-IF.                                                      14010000
140200                                                                  14020000
140300*    EXEC PROC LINE                                               14030000
140310                                                                  14031035
140320     IF  CA-PROD-CICS                                             14032069
140400         MOVE JL-JCL-LINE-12-PROD TO TD-JCL-LINE                  14040069
140500         PERFORM 9100-WRITE-TD-LINE                               14050069
140510     ELSE                                                         14051069
140520         MOVE JL-JCL-LINE-12-LLE TO TD-JCL-LINE                   14052069
140530         PERFORM 9100-WRITE-TD-LINE                               14053069
140540     END-IF.                                                      14054075
140541                                                                  14054175
140550     IF  PS-PRINT-TO-FILE-YES  AND                                14055075
140560         PS-REPORT-TO-FILE-YES                                    14056075
140561         perform 1340-GET-CURRENT-TMST                            14056182
140562         MOVE PV-WORK-TMST   TO JL-CURR-TMST                      14056277
140563         MOVE JL-JCL-LINE-13 TO TD-JCL-LINE                       14056375
140564         PERFORM 9100-WRITE-TD-LINE                               14056475
140565         MOVE JL-JCL-LINE-14 TO TD-JCL-LINE                       14056575
140566         PERFORM 9100-WRITE-TD-LINE                               14056675
140567         MOVE JL-JCL-LINE-15 TO TD-JCL-LINE                       14056775
140568         PERFORM 9100-WRITE-TD-LINE                               14056875
140569         MOVE JL-JCL-LINE-16 TO TD-JCL-LINE                       14056975
140570         PERFORM 9100-WRITE-TD-LINE                               14057075
140571         MOVE JL-JCL-LINE-17 TO TD-JCL-LINE                       14057177
140580         PERFORM 9100-WRITE-TD-LINE                               14058077
140593     END-IF.                                                      14059375
140600                                                                  14060000
140700                                                                  14070000
140800**************************************************************    14080000
140900* SEND ONE SYMBOLIC LINE                                     *    14090000
141000**************************************************************    14100000
141100 9050-SUBMIT-SYMBOLIC-LINE.                                       14110000
141200*    SYMBOLIC REF LINE                                            14120000
141300     MOVE JL-SYSUT1-PARM-LINE   TO TD-JCL-LINE.                   14130000
141400     PERFORM 9100-WRITE-TD-LINE.                                  14140000
141500*    INSTREAM DATA LINE                                           14150000
141600     MOVE JL-SYSUT1-PARM-VALUE  TO TD-JCL-LINE.                   14160000
141700     PERFORM 9100-WRITE-TD-LINE.                                  14170000
141800                                                                  14180000
141900                                                                  14190000
142000**************************************************************    14200000
142100* SEND THE END OF PROC LINE, AND TURN OFF THE READER         *    14210000
142200**************************************************************    14220000
142300 9099-SUBMIT-REQUEST-STOP.                                        14230000
143100                                                                  14310000
143200*    END OF PROC LINE                                             14320000
143300     MOVE JL-JCL-LINE-EOF TO TD-JCL-LINE.                         14330000
143400     PERFORM 9100-WRITE-TD-LINE.                                  14340000
143500                                                                  14350000
143600*    SHUT IT OFF!!!!!                                             14360000
143700     PERFORM 9600-DEQUEUE-INTERNAL-READER.                        14370000
143800                                                                  14380000
143900                                                                  14390000
144000******************************************************************14400000
144100*  WRITE A JCL LINE TO THE TRANSIENT DATA QUEUE FOR THE INTERNAL *14410000
144200*  READER.  ON ANY ERROR, DEQUEUE THE INTERNAL READER, DELETE    *14420000
144300*  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST           *14430000
144400*  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST), *14440000
144500*  FORMAT AND DISPLAY AN ERROR MESSAGE                           *14450000
144600******************************************************************14460000
144700 9100-WRITE-TD-LINE.                                              14470000
144800     EXEC CICS                                                    14480000
144900         WRITEQ TD                                                14490000
145000             QUEUE(TD-QUEUE-NAME)                                 14500000
145100             FROM(TD-JCL-LINE)                                    14510000
145200             LENGTH(TD-JCL-LINE-LENGTH)                           14520000
145300             RESP(PV-CICS-RESPONSE)                               14530000
145400     END-EXEC.                                                    14540000
145500                                                                  14550000
145600     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    14560000
145700         SET PS-ABEND-IN-PROGRESS        TO TRUE                  14570000
145800                                                                  14580000
145900         STRING 'WRITE TO TRANSIENT DATA QUEUE '                  14590000
146000                                                DELIMITED BY SIZE 14600000
146100                TD-QUEUE-NAME                   DELIMITED BY SIZE 14610000
146200                ' (INTERNAL READER)'            DELIMITED BY SIZE 14620000
146300             INTO SE-ATTEMPTED-ACTION                             14630000
146400         MOVE PV-CICS-RESPONSE           TO SE-CICS-RESPONSE      14640000
146500                                                                  14650000
146600         MOVE SE-SYSTEM-ERROR-MESSAGE    TO DP013-MESSAGE-TABLE   14660000
146700         MOVE '9100-WRITE-TD-LINE'       TO DP013-PARAGRAPH       14670000
146800         SET DP013-CICS-ABEND            TO TRUE                  14680000
146900         SET DP013-ROLLBACK              TO TRUE                  14690000
147000         PERFORM 9999-WRITE-CICS-LOG-MSG                          14700000
147100         MOVE PM-NO-PRINT-MSG            TO AMSGLNO               14710000
147200         PERFORM 9600-DEQUEUE-INTERNAL-READER                     14720000
147300     END-IF.                                                      14730000
147400     EJECT                                                        14740000
147500******************************************************************14750000
147600*  ENQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     *14760000
147700*  THIS WILL PREVENT INTERLEAVING OF JCL SUBMITTED CONCURRENTLY  *14770000
147800*  BY MULTIPLE USERS.  IF THE QUEUE IS BUSY, THIS PROGRAM WILL   *14780000
147900*  WAIT TO ENQUEUE IT, BY NOT SPECIFICALLY HANDLING THE QBUSY    *14790000
148000*  CONDITION.  IF ANY OTHER ERRORS OCCUR, DELETE THE TEMPORARY   *14800000
148100*  STORAGE QUEUE (TO PREVENT OLD REQUEST INFORMATION FROM        *14810000
148200*  ACCIDENTALLY APPEARING ON A FUTURE REQUEST), FORMAT AND       *14820000
148300*  DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE CICS.          *14830000
148400******************************************************************14840000
148500                                                                  14850000
148600 9500-ENQUEUE-INTERNAL-READER.                                    14860000
148700     EXEC CICS                                                    14870000
148800         ENQ                                                      14880000
148900             RESOURCE(TD-QUEUE-NAME)                              14890000
149000             LENGTH(TD-QUEUE-NAME-LENGTH)                         14900000
149100             RESP(PV-CICS-RESPONSE)                               14910000
149200     END-EXEC.                                                    14920000
149300                                                                  14930000
149400     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    14940000
149500         SET PS-ABEND-IN-PROGRESS        TO TRUE                  14950000
149600         STRING 'ENQUEUE '               DELIMITED BY SIZE        14960000
149700                TD-QUEUE-NAME            DELIMITED BY SIZE        14970000
149800                ' (INTERNAL READER)'     DELIMITED BY SIZE        14980000
149900             INTO SE-ATTEMPTED-ACTION                             14990000
150000         MOVE PV-CICS-RESPONSE           TO SE-CICS-RESPONSE      15000000
150100         MOVE SE-SYSTEM-ERROR-MESSAGE    TO DP013-MESSAGE-TABLE   15010000
150200         MOVE '9500-ENQUEUE-INTERNAL-READER'                      15020000
150300                                         TO DP013-PARAGRAPH       15030000
150400         SET DP013-CICS-ABEND            TO TRUE                  15040000
150500         SET DP013-ROLLBACK              TO TRUE                  15050000
150600         PERFORM 9999-WRITE-CICS-LOG-MSG                          15060000
150700         MOVE PM-NO-PRINT-MSG            TO AMSGLNO               15070000
150800     END-IF.                                                      15080000
150900                                                                  15090000
151000     SET PS-INTERNAL-READER-ENQUEUED     TO TRUE.                 15100000
151100     EJECT                                                        15110000
151200******************************************************************15120000
151300*  DEQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     *15130000
151400*  THIS SHOULD BE DONE FOLLOWING A SUCCESSFUL REPORT REQUEST     *15140000
151500*  SUBMISSION, A CANCELLATION OF THE CURRENT REPORT REQUEST, OR  *15150000
151600*  ANY DETECTED ABENDS.  THIS WILL FREE UP THE INTERNAL READER   *15160000
151700*  FOR THE NEXT USER.  IF ANY ERRORS OCCUR, CHECK TO SEE IF      *15170000
151800*  ANY OTHER ABEND SITUATIONS HAVE ALREADY OCCURRED.  IF SO, DO  *15180000
151900*  NOT FORCE THE ABEND FOR THIS ERROR, AND ALLOW PROGRAM CONTROL *15190000
152000*  TO RETURN TO THE POINT WHERE THE FIRST ABEND OCCURRED, AND    *15200000
152100*  DISPLAY THE MESSAGE RELATING TO THAT ABEND.  IF NOT, DELETE   *15210000
152200*  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST           *15220000
152300*  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST), *15230000
152400*  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE     *15240000
152500*  CICS.                                                         *15250000
152600******************************************************************15260000
152700                                                                  15270000
152800 9600-DEQUEUE-INTERNAL-READER.                                    15280000
152900     SET PS-INTERNAL-READER-DEQUEUED     TO TRUE.                 15290000
153000                                                                  15300000
153100     EXEC CICS                                                    15310000
153200         DEQ                                                      15320000
153300             RESOURCE(TD-QUEUE-NAME)                              15330000
153400             LENGTH(TD-QUEUE-NAME-LENGTH)                         15340000
153500             RESP(PV-CICS-RESPONSE)                               15350000
153600     END-EXEC.                                                    15360000
153700                                                                  15370000
153800     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    15380000
153900         IF PS-NO-ABEND-IN-PROGRESS                               15390000
154000             SET PS-ABEND-IN-PROGRESS    TO TRUE                  15400000
154100             STRING 'DEQUEUE '            DELIMITED BY SIZE       15410000
154200                    TD-QUEUE-NAME         DELIMITED BY SIZE       15420000
154300                    ' (INTERNAL READER)'  DELIMITED BY SIZE       15430000
154400                 INTO SE-ATTEMPTED-ACTION                         15440000
154500             MOVE PV-CICS-RESPONSE       TO SE-CICS-RESPONSE      15450000
154600             MOVE SE-SYSTEM-ERROR-MESSAGE                         15460000
154700                                         TO DP013-MESSAGE-TABLE   15470000
154800             MOVE '9600-DEQUEUE-INTERNAL-READER'                  15480000
154900                                         TO DP013-PARAGRAPH       15490000
155000             SET DP013-CICS-ABEND        TO TRUE                  15500000
155100             SET DP013-ROLLBACK          TO TRUE                  15510000
155200             PERFORM 9999-WRITE-CICS-LOG-MSG                      15520000
155300             MOVE PM-NO-PRINT-MSG        TO AMSGLNO               15530000
155400         END-IF                                                   15540000
155500     END-IF.                                                      15550000
155600                                                                  15560000
155700*                                                                 15570000
155800 9999-WRITE-CICS-LOG-MSG.                                         15580000
155900     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            15590000
156000     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           15600000
156100     INITIALIZE DP013-SRC-TASK-NUMBER                             15610000
156200                DP013-STACK.                                      15620000
156300     SET DP013-LINK-RETURN           TO TRUE.                     15630000
156400                                                                  15640000
156500     EXEC CICS                                                    15650000
156600         LINK                                                     15660000
156700             PROGRAM   (DP013-NAME)                               15670000
156800             COMMAREA  (DP013-PARAMETERS)                         15680000
156900             LENGTH    (DP013-LENGTH)                             15690000
157000     END-EXEC.                                                    15700000
157100                                                                  15710000
157200*----------------------------------------------------------------*15720000
157300*    ABEND PROCESSOR MODULE                                      *15730000
157400*----------------------------------------------------------------*15740000
157500                                                                  15750000
157600     COPY DPPD014.                                                15760000
157700                                                                  15770000
