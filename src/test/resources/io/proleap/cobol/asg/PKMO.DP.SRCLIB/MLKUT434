       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    MLKUT434.                                         00020000
       AUTHOR.        SCOTT JACKSON.                                    00030000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
       DATE-WRITTEN.  05-26-99.                                         00050000
       DATE-COMPILED.                                                   00060000
      ******************************************************************00070000
      *                                                                 00080008
      * MLKUT434 - DESCRIPTION.............                             00090001
      *                                                                 00100000
      * THIS PROGRAM WILL COMPARE TWO DATA INTEGRITY EXTRACT FILES AND  00110000
      * CREATE A REPORT FILE OF THE DIFFERENCES.                        00120000
      *                                                                 00130000
      * ONE EXTRACT FILE WILL CONTAIN INFORMATION FROM TWKSHNK.         00140008
      * THE OTHER EXTRACT FILE WILL CONTAIN INFORMATION FROM TMNSCLS.   00150012
      * THE FILES WILL BE COMPARED ON SHRINK DOLLAR TOTALS BETWEEN THE  00160008
      * TWO TABLE AT THE FSCL MNTH END DATE, DEPT, SUBCLASS, STORE LEVEL00170008
      *                                                                 00180000
W26603******************************************************************00190024
W26603* CHG ID   DATE        DESCRIPTION                               *00200024
W26603* ------   ----------  ----------------------------------------- *00210024
W26603* 26603    03-17-2004  STORE EXPANSION.                          *00220024
W26603*                      INCREASED LRECL FOR INP02, INP03, OUT01   *00230025
W26603*                      BECAUSE OF CHANGES TO MLRD111, MLRD112,   *00240025
W26603*                      AND MLRD125.                              *00250025
W26603*                      - RONNA MCDONALD                          *00260024
      ******************************************************************00270008
      *                                                                 00280000
      *                                                                 00290008
       ENVIRONMENT DIVISION.                                            00300000
      *                                                                 00310000
       CONFIGURATION SECTION.                                           00320000
      *                                                                 00330000
       SOURCE-COMPUTER.        IBM-3090.                                00340000
       OBJECT-COMPUTER.        IBM-3090.                                00350000
      *                                                                 00360000
       INPUT-OUTPUT SECTION.                                            00370000
       FILE-CONTROL.                                                    00380000
                                                                        00390000
           SELECT COMPARE-TABLES-CTL-FILE                               00400000
               ASSIGN TO INP01.                                         00410000
                                                                        00420000
           SELECT TWKSHNK-INTEGRITY-EXTR-FILE                           00430001
               ASSIGN TO INP02.                                         00440000
                                                                        00450000
           SELECT TMNSCLS-INTEGRITY-EXTR-FILE                           00460001
               ASSIGN TO INP03.                                         00470000
                                                                        00480000
           SELECT DATA-INTEGRITY-DIFF-FILE                              00490000
               ASSIGN TO OUT01.                                         00500000
                                                                        00510000
      ******************************************************************00520000
       DATA DIVISION.                                                   00530000
      ******************************************************************00540000
                                                                        00550000
       FILE SECTION.                                                    00560000
                                                                        00570000
       FD  COMPARE-TABLES-CTL-FILE                                      00580000
           LABEL RECORDS ARE STANDARD                                   00590000
           RECORDING MODE IS F                                          00600000
           BLOCK CONTAINS 0 RECORDS.                                    00610000
       01  COMPARE-TABLES-CTL-REC      PIC X(80).                       00620000
                                                                        00630000
       FD  TWKSHNK-INTEGRITY-EXTR-FILE                                  00640001
           LABEL RECORDS ARE STANDARD                                   00650000
           RECORDING MODE IS F                                          00660000
           BLOCK CONTAINS 0 RECORDS.                                    00670000
W26603 01  TWKSHNK-INTEGRITY-EXTR-REC  PIC X(80).                       00680025
                                                                        00690000
       FD  TMNSCLS-INTEGRITY-EXTR-FILE                                  00700001
           LABEL RECORDS ARE STANDARD                                   00710000
           RECORDING MODE IS F                                          00720000
           BLOCK CONTAINS 0 RECORDS.                                    00730000
W26603 01  TMNSCLS-INTEGRITY-EXTR-REC  PIC X(120).                      00740025
                                                                        00750000
       FD  DATA-INTEGRITY-DIFF-FILE                                     00760000
           RECORDING MODE IS F                                          00770000
           LABEL RECORDS ARE STANDARD                                   00780000
           BLOCK CONTAINS 0 RECORDS.                                    00790000
                                                                        00800000
W26603 01  DATA-INTEGRITY-DIFF-REC     PIC X(80).                       00810025
                                                                        00820000
      *                                                                 00830000
      ******************************************************************00840000
       WORKING-STORAGE SECTION.                                         00850000
      ******************************************************************00860000
                                                                        00870000
       01  PS-PROGRAM-SWITCHES.                                         00880000
           05  PS-MORE-TWKSHNK-RECS-SW                                  00890001
                                       PIC X       VALUE 'Y'.           00900000
               88  PS-MORE-TWKSHNK-RECS            VALUE 'Y'.           00910001
               88  PS-NO-MORE-TWKSHNK-RECS         VALUE 'N'.           00920001
           05  PS-MORE-TMNSCLS-RECS-SW                                  00930001
                                       PIC X       VALUE 'Y'.           00940000
               88  PS-MORE-TMNSCLS-RECS            VALUE 'Y'.           00950001
               88  PS-NO-MORE-TMNSCLS-RECS         VALUE 'N'.           00960001
           05  PS-BYPASS-0-DOLLARS-SW  PIC X.                           00970000
               88  PS-BYPASS-0-DOLLARS             VALUE 'Y'.           00980000
               88  PS-NO-BYPASS-DOLLARS            VALUE 'N'.           00990000
                                                                        01000000
       01  PA-PROGRAM-ACCUMULATORS                 COMP-3.              01010000
           05  PA-TWKSHNK-READ         PIC S9(13)  VALUE ZERO.          01020001
           05  PA-TMNSCLS-READ         PIC S9(13)  VALUE ZERO.          01030001
           05  PA-KEY-MATCHES          PIC S9(13)  VALUE ZERO.          01040000
           05  PA-REPORT-RECS-WRITTEN  PIC S9(13)  VALUE ZERO.          01050000
                                                                        01060000
       01  CD-COUNTER-DISPLAY.                                          01070000
           05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.           01080000
                                                                        01090000
       01  PV-PROGRAM-VARIABLES.                                        01100000
           05  PV-TWKSHNK-KEY.                                          01110001
               10  PV-TWKSHNK-FSCL-MN-END-DTE     PIC X(10).            01120005
               10  PV-TWKSHNK-DEPT-NBR            PIC X(03).            01130005
               10  PV-TWKSHNK-SUB-CL-NBR          PIC X(02).            01140005
               10  PV-TWKSHNK-STR-NBR             PIC S9(4) COMP.       01150005
      *                                                                 01160003
           05  PV-TMNSCLS-KEY.                                          01170003
               10  PV-TMNSCLS-FSCL-MN-END-DTE     PIC X(10).            01180006
               10  PV-TMNSCLS-DEPT-NBR            PIC X(03).            01190006
               10  PV-TMNSCLS-SUB-CL-NBR          PIC X(02).            01200006
               10  PV-TMNSCLS-STR-NBR             PIC S9(4) COMP.       01210006
                                                                        01220000
           05  PV-SHRINK-DOLLARS.                                       01230006
               10  PV-TWKSHNK-RTL-AMT             PIC S9(11)V99 COMP-3. 01240006
               10  PV-TMNSCLS-RTL-AMT             PIC S9(11)V99 COMP-3. 01250006
               10  PV-DIFF-SHNK-RTL-AMT           PIC S9(11)V99 COMP-3. 01260006
                                                                        01270000
       01 ABEND-AREAS.                                                  01280000
           05 ABEND-CODE               PIC S9(04)  VALUE ZERO           01290000
                                                   COMP SYNC.           01300000
               88  AC-BAD-DATA                     VALUE +4003.         01310000
               88  AC-DB2-ERROR                    VALUE +4013.         01320000
           05  AA-ABEND-LIT            PIC X(40)   VALUE                01330000
                 '*****       ABEND'.                                   01340000
           05  AA-PROGRAM-LIT          PIC X(40)   VALUE                01350000
                   '*****   PROGRAM: MLKUT434'.                         01360001
           05  AA-PARAGRAPH-LIT.                                        01370000
               10  FILLER              PIC X(17)   VALUE                01380000
                   '***** PARAGRAPH: '.                                 01390000
               10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        01400000
           05  AA-MESSAGE-LINE.                                         01410000
               10  FILLER              PIC X(06)   VALUE '*****'.       01420000
               10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        01430000
           05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                01440000
                   '*****    DB2 ERROR'.                                01450000
           05  AA-DB2-OPERATION-LIT.                                    01460000
               10  FILLER              PIC X(17)   VALUE                01470000
                   '***** OPERATION: '.                                 01480000
               10  AA-DB2-OPERATION.                                    01490000
                   15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        01500000
                   15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        01510000
           05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        01520000
           05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        01530000
           05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        01540000
           05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        01550000
                                                                        01560000
       EJECT                                                            01570000
                                                                        01580000
      *** DATA INTEGRITY COMPARE TABLES CONTROL CARD                    01590000
       01  CC-CONTROL-CARD-REC.                                         01600000
           05  CC-TWKSHNK-TABLE        PIC X(7).                        01610001
           05  FILLER                  PIC X.                           01620000
           05  CC-TMNSCLS-TABLE        PIC X(7).                        01630001
           05  FILLER                  PIC X(65).                       01640000
                                                                        01650000
      * TWKSHNK EXTRACT FILE LAYOUT                                     01660002
           COPY MLRD125.                                                01670015
                                                                        01680000
      * TMNSCLS EXTRACT FILE LAYOUT                                     01690003
           COPY MLRD111.                                                01700002
                                                                        01710000
      *** DATA INTEGRITY DIFFERENCE REPORT FILE                         01720000
           COPY MLRD112.                                                01730000
                                                                        01740000
       EJECT                                                            01750000
                                                                        01760000
      ******************************************************************01770000
       PROCEDURE DIVISION.                                              01780000
      ******************************************************************01790000
                                                                        01800000
      ******************************************************************01810000
       0000-MAINLINE-MLKUT434.                                          01820001
      ******************************************************************01830000
      *                                                                 01840000
           PERFORM 1000-INITIALIZATION.                                 01850000
                                                                        01860000
           PERFORM 2000-MAIN-PROCESS.                                   01870000
                                                                        01880000
           PERFORM 8000-EOJ.                                            01890000
                                                                        01900000
           STOP RUN.                                                    01910000
                                                                        01920000
       EJECT                                                            01930000
                                                                        01940000
      ******************************************************************01950000
       1000-INITIALIZATION.                                             01960000
      ******************************************************************01970000
      *                                                                 01980000
           OPEN INPUT  COMPARE-TABLES-CTL-FILE                          01990000
                       TWKSHNK-INTEGRITY-EXTR-FILE                      02000001
                       TMNSCLS-INTEGRITY-EXTR-FILE.                     02010001
           OPEN OUTPUT DATA-INTEGRITY-DIFF-FILE.                        02020000
                                                                        02030000
           PERFORM 4000-READ-CONTROL-CARD.                              02040000
                                                                        02050000
           DISPLAY ' '.                                                 02060000
           DISPLAY '*** MLKUT434 INPUT CONTROL CARD VALUES ***'         02070001
           DISPLAY CC-CONTROL-CARD-REC.                                 02080000
                                                                        02090000
           INITIALIZE PA-PROGRAM-ACCUMULATORS.                          02100000
           INITIALIZE PV-PROGRAM-VARIABLES.                             02110000
                                                                        02120000
       EJECT                                                            02130000
                                                                        02140000
      ******************************************************************02150000
       2000-MAIN-PROCESS.                                               02160000
      ******************************************************************02170000
      *                                                                 02180000
           PERFORM 4100-READ-TWKSHNK-FILE.                              02190001
                                                                        02200000
           IF PS-NO-MORE-TWKSHNK-RECS                                   02210001
               MOVE '2000-MAIN-PROCESS'           TO AA-PARAGRAPH-NAME  02220006
               MOVE 'EMPTY TWKSHNK EXTRACT FILE'  TO AA-MESSAGE         02230006
               MOVE +4002                         TO ABEND-CODE         02240006
               PERFORM 9900-COMMON-ABEND-ROUTINE                        02250000
           END-IF.                                                      02260000
                                                                        02270000
           PERFORM 4200-READ-TMNSCLS-FILE.                              02280001
                                                                        02290000
           IF PS-NO-MORE-TMNSCLS-RECS                                   02300001
               MOVE '2000-MAIN-PROCESS'           TO AA-PARAGRAPH-NAME  02310006
               MOVE 'EMPTY TWKSCLS EXTRACT FILE'  TO AA-MESSAGE         02320006
               MOVE +4003                         TO ABEND-CODE         02330006
               PERFORM 9900-COMMON-ABEND-ROUTINE                        02340000
           END-IF.                                                      02350000
                                                                        02360000
           PERFORM                                                      02370000
             UNTIL PS-NO-MORE-TWKSHNK-RECS                              02380001
               AND PS-NO-MORE-TMNSCLS-RECS                              02390001
                   PERFORM 2100-COMPARE-FILES                           02400006
           END-PERFORM.                                                 02410000
                                                                        02420000
       EJECT                                                            02430000
                                                                        02440000
      ******************************************************************02450000
       2100-COMPARE-FILES.                                              02460000
      ******************************************************************02470000
      *                                                                 02480000
           PERFORM 3000-BUILD-FILE-KEYS.                                02490000
                                                                        02500000
           IF PV-TWKSHNK-KEY = PV-TMNSCLS-KEY                           02510001
               ADD 1                   TO PA-KEY-MATCHES                02520000
               PERFORM 5100-COMPARE-BOTH-FILE-AMTS                      02530000
               PERFORM 4100-READ-TWKSHNK-FILE                           02540001
               PERFORM 4200-READ-TMNSCLS-FILE                           02550001
           ELSE                                                         02560000
               IF PV-TWKSHNK-KEY < PV-TMNSCLS-KEY                       02570001
                   PERFORM 5200-PROCESS-ONLY-TWKSHNK                    02580001
                   PERFORM 4100-READ-TWKSHNK-FILE                       02590001
               ELSE                                                     02600000
                   PERFORM 5300-PROCESS-ONLY-TMNSCLS                    02610001
                   PERFORM 4200-READ-TMNSCLS-FILE                       02620001
               END-IF                                                   02630000
           END-IF.                                                      02640000
                                                                        02650000
       EJECT                                                            02660000
                                                                        02670000
      ******************************************************************02680000
       3000-BUILD-FILE-KEYS.                                            02690000
      ******************************************************************02700000
      *                                                                 02710000
           INITIALIZE PV-TWKSHNK-KEY                                    02720021
                      PV-TMNSCLS-KEY                                    02730021
                      PV-SHRINK-DOLLARS.                                02740021
                                                                        02750020
           IF ML125-DATA-INTEGRITY-EXTR-REC = HIGH-VALUES               02760020
               MOVE HIGH-VALUES        TO PV-TWKSHNK-KEY                02770020
           ELSE                                                         02780020
               MOVE ML125-FSCL-MN-END-DTE TO PV-TWKSHNK-FSCL-MN-END-DTE 02790020
               MOVE ML125-DEPT-NBR         TO PV-TWKSHNK-DEPT-NBR       02800020
               MOVE ML125-SUB-CL-NBR       TO PV-TWKSHNK-SUB-CL-NBR     02810020
               MOVE ML125-STR-NBR          TO PV-TWKSHNK-STR-NBR        02820020
               MOVE ML125-SHNK-RTL-AMT     TO PV-TWKSHNK-RTL-AMT        02830021
           END-IF.                                                      02840020
      *                                                                 02850020
           IF ML111-DATA-INTEGRITY-EXTR-REC = HIGH-VALUES               02860020
               MOVE HIGH-VALUES        TO PV-TMNSCLS-KEY                02870020
           ELSE                                                         02880020
               MOVE ML111-FSCL-MN-END-DTE  TO PV-TMNSCLS-FSCL-MN-END-DTE02890020
               MOVE ML111-DEPT-NBR         TO PV-TMNSCLS-DEPT-NBR       02900020
               MOVE ML111-SUB-CL-NBR       TO PV-TMNSCLS-SUB-CL-NBR     02910020
               MOVE ML111-STR-NBR          TO PV-TMNSCLS-STR-NBR        02920020
               MOVE ML111-SHNK-RTL-AMT     TO PV-TMNSCLS-RTL-AMT        02930021
           END-IF.                                                      02940020
      *                                                                 02950006
                                                                        02960006
                                                                        02970000
       EJECT                                                            02980000
                                                                        02990000
      ******************************************************************03000000
       4000-READ-CONTROL-CARD.                                          03010000
      ******************************************************************03020000
      *                                                                 03030000
           READ COMPARE-TABLES-CTL-FILE                                 03040000
             INTO CC-CONTROL-CARD-REC                                   03050000
               AT END                                                   03060000
                   MOVE '4000-READ-CONTROL-CARD'   TO AA-PARAGRAPH-NAME 03070006
                   MOVE 'CONTROL CARD IS MISSING'  TO AA-MESSAGE        03080006
                   MOVE +4001                      TO ABEND-CODE        03090006
                   PERFORM 9900-COMMON-ABEND-ROUTINE                    03100000
           END-READ.                                                    03110000
                                                                        03120000
       EJECT                                                            03130000
                                                                        03140000
      ******************************************************************03150000
       4100-READ-TWKSHNK-FILE.                                          03160001
      ******************************************************************03170000
      *                                                                 03180000
           IF PS-MORE-TWKSHNK-RECS                                      03190001
               READ TWKSHNK-INTEGRITY-EXTR-FILE                         03200001
                 INTO ML125-DATA-INTEGRITY-EXTR-REC                     03210002
                   AT END                                               03220000
                       SET PS-NO-MORE-TWKSHNK-RECS TO TRUE              03230002
                       MOVE HIGH-VALUES                                 03240022
                                       TO ML125-DATA-INTEGRITY-EXTR-REC 03250022
               END-READ                                                 03260022
           END-IF.                                                      03270000
                                                                        03280000
           IF PS-MORE-TWKSHNK-RECS                                      03290001
               ADD 1                   TO PA-TWKSHNK-READ               03300001
           END-IF.                                                      03310000
      *                                                                 03320003
      ******************************************************************03330000
       4200-READ-TMNSCLS-FILE.                                          03340001
      ******************************************************************03350000
      *                                                                 03360000
           IF PS-MORE-TMNSCLS-RECS                                      03370001
               READ TMNSCLS-INTEGRITY-EXTR-FILE                         03380001
                 INTO ML111-DATA-INTEGRITY-EXTR-REC                     03390002
                   AT END                                               03400000
                       SET PS-NO-MORE-TMNSCLS-RECS TO TRUE              03410002
                       MOVE HIGH-VALUES                                 03420022
                                       TO ML125-DATA-INTEGRITY-EXTR-REC 03430022
               END-READ                                                 03440022
           END-IF.                                                      03450000
                                                                        03460000
           IF PS-MORE-TMNSCLS-RECS                                      03470001
               ADD 1                   TO PA-TMNSCLS-READ               03480001
           END-IF.                                                      03490016
      *                                                                 03500003
      ******************************************************************03510000
       5100-COMPARE-BOTH-FILE-AMTS.                                     03520000
      ******************************************************************03530000
      *                                                                 03540000
           IF ML125-SHNK-RTL-AMT NOT EQUAL ML111-SHNK-RTL-AMT           03550006
      *    IF SHRINK $ ARE DIFFERENT - THIS IS AN ERROR                 03560005
               MOVE ML111-FSCL-MN-END-DTE TO ML112-FSCL-MN-END-DTE      03570005
               MOVE ML111-FSCL-MN-NBR     TO ML112-FSCL-MN-NBR          03580005
               MOVE ML111-DEPT-NBR        TO ML112-DEPT-NBR             03590005
               MOVE ML111-MAJ-CL-NBR      TO ML112-MAJ-CL-NBR           03600005
               MOVE ML111-SUB-CL-NBR      TO ML112-SUB-CL-NBR           03610005
               MOVE ML111-STR-NBR         TO ML112-STR-NBR              03620005
               MOVE ML125-SHNK-RTL-AMT    TO ML112-LOW-TBL-AMT          03630005
               MOVE ML111-SHNK-RTL-AMT    TO ML112-HIGH-TBL-AMT         03640005
               MOVE 13                    TO ML112-ERR-MSG-NBR          03650005
               WRITE DATA-INTEGRITY-DIFF-REC                            03660003
                   FROM ML112-DATA-INTEGRITY-DIFF-REC                   03670003
               ADD 1              TO PA-REPORT-RECS-WRITTEN             03680014
               DISPLAY 'SHRINK DIFFERENCES FOUND : ', ML111-DEPT-NBR,   03690015
                        ' ', ML111-SUB-CL-NBR, ' ', ML111-STR-NBR       03700015
               DISPLAY 'TWKSHNK SHRINK$ : ', ML125-SHNK-RTL-AMT, ' ',   03710015
                       'TMNSCLS SHRINK$ : ', ML111-SHNK-RTL-AMT         03720015
           END-IF.                                                      03730003
      *                                                                 03740003
      ******************************************************************03750000
       5200-PROCESS-ONLY-TWKSHNK.                                       03760001
      ******************************************************************03770000
           IF ML125-SHNK-RTL-AMT = 0                                    03780005
               SET PS-BYPASS-0-DOLLARS TO TRUE                          03790003
           ELSE                                                         03800003
               SET PS-NO-BYPASS-DOLLARS TO TRUE                         03810003
           END-IF.                                                      03820003
                                                                        03830000
           IF PS-BYPASS-0-DOLLARS                                       03840000
               CONTINUE                                                 03850000
           ELSE                                                         03860000
               PERFORM 5220-PROCESS-NO-HIGH-RECD-ERR                    03870000
           END-IF.                                                      03880000
                                                                        03890000
                                                                        03900000
      ******************************************************************03910000
       5220-PROCESS-NO-HIGH-RECD-ERR.                                   03920000
      ******************************************************************03930000
      *                                                                 03940000
           INITIALIZE ML112-DATA-INTEGRITY-DIFF-REC.                    03950005
      *                                                                 03960005
           MOVE ML125-FSCL-MN-END-DTE TO ML112-FSCL-MN-END-DTE.         03970005
           MOVE ML125-DEPT-NBR        TO ML112-DEPT-NBR.                03980005
           MOVE ML125-SUB-CL-NBR      TO ML112-SUB-CL-NBR.              03990005
           MOVE ML125-STR-NBR         TO ML112-STR-NBR.                 04000005
           MOVE 0                     TO ML112-LOW-TBL-AMT              04010005
                                         ML112-HIGH-TBL-AMT.            04020005
           MOVE 1                     TO ML112-ERR-MSG-NBR.             04030005
                                                                        04040000
           WRITE DATA-INTEGRITY-DIFF-REC                                04050000
               FROM ML112-DATA-INTEGRITY-DIFF-REC.                      04060000
                                                                        04070000
           ADD 1                      TO PA-REPORT-RECS-WRITTEN.        04080005
      *                                                                 04090005
      ******************************************************************04100000
       5300-PROCESS-ONLY-TMNSCLS.                                       04110001
      ******************************************************************04120000
           IF ML111-SHNK-RTL-AMT = 0                                    04130005
               SET PS-BYPASS-0-DOLLARS TO TRUE                          04140003
           ELSE                                                         04150003
               SET PS-NO-BYPASS-DOLLARS TO TRUE                         04160003
           END-IF.                                                      04170003
                                                                        04180003
           IF PS-BYPASS-0-DOLLARS                                       04190003
               CONTINUE                                                 04200003
           ELSE                                                         04210003
               PERFORM 5320-PROCESS-NO-LOW-RECD-ERR                     04220007
           END-IF.                                                      04230003
                                                                        04240003
      *                                                                 04250000
                                                                        04260000
      ******************************************************************04270000
       5320-PROCESS-NO-LOW-RECD-ERR.                                    04280000
      ******************************************************************04290000
      *                                                                 04300000
           INITIALIZE ML112-DATA-INTEGRITY-DIFF-REC.                    04310005
      *                                                                 04320005
           MOVE ML111-FSCL-MN-END-DTE TO ML112-FSCL-MN-END-DTE.         04330005
           MOVE ML111-FSCL-MN-NBR     TO ML112-FSCL-MN-NBR.             04340005
           MOVE ML111-DEPT-NBR        TO ML112-DEPT-NBR.                04350005
           MOVE ML111-MAJ-CL-NBR      TO ML112-MAJ-CL-NBR.              04360005
           MOVE ML111-SUB-CL-NBR      TO ML112-SUB-CL-NBR.              04370005
           MOVE ML111-STR-NBR         TO ML112-STR-NBR.                 04380005
           MOVE 0                     TO ML112-LOW-TBL-AMT              04390005
                                         ML112-HIGH-TBL-AMT.            04400005
           MOVE 2                     TO ML112-ERR-MSG-NBR.             04410005
                                                                        04420000
           WRITE DATA-INTEGRITY-DIFF-REC                                04430000
               FROM ML112-DATA-INTEGRITY-DIFF-REC.                      04440000
                                                                        04450000
           ADD 1                       TO PA-REPORT-RECS-WRITTEN.       04460000
                                                                        04470000
       EJECT                                                            04480000
                                                                        04490000
      ******************************************************************04500000
       8000-EOJ.                                                        04510000
      ******************************************************************04520000
      *                                                                 04530000
           DISPLAY ' '.                                                 04540000
           DISPLAY '  PROGRAM MLKUT434 PROCESSING SUMMARY'.             04550001
           DISPLAY '  -----------------------------------'.             04560000
           DISPLAY ' '.                                                 04570000
      *                                                                 04580000
           MOVE PA-TWKSHNK-READ        TO CD-COUNT-HOLD1.               04590001
           DISPLAY 'TWKSHNK EXTR RECORDS READ =       ' CD-COUNT-HOLD1. 04600005
      *                                                                 04610000
           MOVE PA-TMNSCLS-READ        TO CD-COUNT-HOLD1.               04620001
           DISPLAY 'TMNSCLS EXTR RECORDS READ =      ' CD-COUNT-HOLD1.  04630005
      *                                                                 04640000
           MOVE PA-KEY-MATCHES         TO CD-COUNT-HOLD1.               04650000
           DISPLAY 'KEY MATCHES =            ' CD-COUNT-HOLD1.          04660000
      *                                                                 04670000
           MOVE PA-REPORT-RECS-WRITTEN TO CD-COUNT-HOLD1.               04680000
           DISPLAY 'REPORT RECORDS WRITTEN = ' CD-COUNT-HOLD1.          04690000
      *                                                                 04700000
           DISPLAY ' '.                                                 04710000
                                                                        04720000
           CLOSE COMPARE-TABLES-CTL-FILE.                               04730000
           CLOSE TWKSHNK-INTEGRITY-EXTR-FILE.                           04740001
           CLOSE TMNSCLS-INTEGRITY-EXTR-FILE.                           04750001
           CLOSE DATA-INTEGRITY-DIFF-FILE.                              04760000
                                                                        04770000
       EJECT                                                            04780000
                                                                        04790000
      ******************************************************************04800000
       9900-COMMON-ABEND-ROUTINE.                                       04810000
      ******************************************************************04820000
      *                                                                 04830000
           DISPLAY AA-ABEND-LIT.                                        04840000
           DISPLAY AA-PROGRAM-LIT.                                      04850000
           DISPLAY AA-PARAGRAPH-LIT.                                    04860000
           DISPLAY AA-MESSAGE-LINE.                                     04870000
           DISPLAY ABEND-CODE.                                          04880000
                                                                        04890000
           CALL 'ILBOABN0' USING ABEND-CODE.                            04900000
                                                                        04910000
