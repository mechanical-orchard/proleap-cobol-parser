000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             ARKRP019.                                00020000
000300 AUTHOR.                 TODD MICHALEK.                           00030000
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
000500 DATE-WRITTEN.           APRIL 1995.                              00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*                                                                *00080000
000900*    ARKRP019 - KOHLS CREDIT ACTIVITIY                           *00090000
001000*                                                                *00100000
001100*    OUTPUT: - KOHLS CREDIT ACTIVITY DETAIL REPORT               *00110000
001200*            - KOHLS CREDIT ACTIVITY SUMMARY REPORT              *00120000
001300*            - A TAPE COPY OF THESE REPORTS TO BE SENT OUT FOR   *00130000
001400*              MICROFICHING                                      *00140000
001500*                                                                *00150000
001600*    THIS PROGRAM ACCEPTS A CONTROL CARD GIVING THE POINT OF     *00160000
001700*    SALE PROCESSING DATE THAT WILL BE DISPLAYED ON THE OUTPUT   *00170000
001800*    REPORTS.  IT THEN SEQUENTIALLY READS THE CREDIT POSTING     *00180000
001900*    FILE PRODUCING THE KOHLS CREDIT ACTIVITY DETAIL REPORT AND  *00190000
002000*    A SUMMARY TABLE.  THE TABLE IS THEN PRINTED OUT, PRODUCING  *00200000
002100*    THE KOHLS CREDIT ACTIVITY SUMMARY REPORT.  DURING THE       *00210000
002200*    PRINTING OF THESE REPORTS A TAPE COPY IS CREATED THAT WILL  *00220000
002300*    BE SENT OUT FOR MICROFICHING.                               *00230000
002400******************************************************************00240000
002500* 08/03/95 - TCM -  WR NO. 3430                                  *00250000
002600*    - ADD STORE NUMBER TO KOHLS CREDIT ACTIVITY DETAIL REPORT   *00260000
002700*    - ADD POS/MAINTENANCE SUBTOTALS TO KOHLS CREDIT ACTIVITY    *00270000
002800*      SUMMARY REPORT                                            *00280000
002900* 10/10/00 - LIHUA LIANG                                         *00290000
003000*    - WRITE SUMMARY INFO TO A FILE FOR CREDIT TEAMS.            *00300000
003010* 11/19/03 - BRIAN HASSLINGER                                    *00310000
003020*    - ADDED THE TRANSACTION QUANTITY TO THE SUMMARY FILE.       *00320000
003021*      TRANSACTION QUANTITY IS THE NUMBER OF RECORDS THAT        *00330000
003022*      WHERE USED TO COMPUTE THE TRANSACTION AMOUNT.             *00340000
003030*      CHANGED THE SUMMARY FILE SIZE TO 52.                      *00350000
003040*      ADDED A FOOTER TO THE SUMMARY FILE THAT HOLDS THE TOTAL   *00360000
003050*      AMOUNT OF RECORDS IN THE SUMMARY FILE.                    *00370000
003010* 03/22/2011 - ELENA MOZNAIM                                     *00380000
003020*    - ADDED LOGIC TO INCLUDE 'LATE VOID' TRANS INTO REPORT AND  *00390000
003030*      BALANCING FILE. CHANGES ARE MARKED AS EVM001.             *00400000
003040* 04/14/2011 - JAMES ALT                                         *00410000
003050*    - INCREASED SIZE OF CR-POSTING-RECORD FROM 117 TO 157 BYTES *00420000
003060*      TO MATCH SIZE OF ARRD021.                                 *00430000
003100******************************************************************00431099
P1043 * 06/15/2015 ACCENTURE                                           *00432099
P1043 *      CHG0118696                                                *00433099
P1043 *    - ADDED BIN NUMBER FIELD IN A REPORT LAYOUT TO HANDLE 12    *00434099
P1043 *      AS WELL AS 18 DIGIT ACCOUNT NUMBER.                       *00435099
P1043 *    - LOGIC HAS BEEN ADDED TO CHECK IF INPUT BIN NUMBER IS      *00436099
P1043 *      EQUAL TO SPACES THEN MOVE '639305' IN REPORT BIN NUMBER   *00437099
P1043 *      ELSE MOVE INPUT BIN NUMBER(AR021-BIN-NUMBER) AS IT IS TO  *00438099
P1043 *      THE REPORT BIN NUMBER.                                    *00439099
003100******************************************************************00439199
P10237* 06/05/2015 - COGNIZANT - CHG0104429                            *00440000
P10237*    - REMOVED THE CREATION OF FICHE FILE AND PREBBAL FILE       *00450000
P10237*    - CHANGES TO DE-TOKENIZE THE CARD NUMBER AND TO INTERNAL    *00451000
P10237*      SORT THE RECORDS IN ASCENDING ORDER OF ENTRY DATE AND     *00452000
P10237*      CLEAR CARD NUMBER TO DISPLAY CLEAR SORTED CARD# IN RPT.   *00453000
003100******************************************************************00460000
003200 ENVIRONMENT DIVISION.                                            00470000
003300 CONFIGURATION SECTION.                                           00480000
003400 SOURCE-COMPUTER.        IBM-3090.                                00490000
003500 OBJECT-COMPUTER.        IBM-3090.                                00500000
003600                                                                  00510000
003700 INPUT-OUTPUT SECTION.                                            00520000
003800                                                                  00530000
003900 FILE-CONTROL.                                                    00540000
004000                                                                  00550000
004100     SELECT CR-POSTING-FILE                                       00560000
004200         ASSIGN TO INP01.                                         00570000
004300                                                                  00580000
P10237     SELECT SORT-WORK-FILE                                        00581000
P10237         ASSIGN TO SORTWK01                                       00582000
P10237                   SORTWK02                                       00582100
P10237                   SORTWK03                                       00582200
P10237                   SORTWK04                                       00582300
P10237                   SORTWK05                                       00582400
P10237                   SORTWK06.                                      00582500
P10237                                                                  00583000
004700     SELECT CR-ACTIVITY-REPORT-FILE                               00590000
004800         ASSIGN TO RPT01.                                         00600000
004900                                                                  00610000
005300 DATA DIVISION.                                                   00620000
005400                                                                  00630000
005500 FILE SECTION.                                                    00640000
005600                                                                  00650000
005700 FD  CR-POSTING-FILE                                              00660000
005800     RECORDING MODE IS F                                          00670000
005900     BLOCK CONTAINS 0 RECORDS                                     00680000
006000     LABEL RECORDS ARE STANDARD.                                  00690000
006100                                                                  00700000
006200 01  CR-POSTING-RECORD           PIC X(157).                      00710000
006300                                                                  00720000
P10237 SD  SORT-WORK-FILE.                                              00721000
P10237 01  SORT-WORK-RECORD.                                            00732000
P10237     05  FILLER                          PIC  X(04).              00732100
P10237     05  SR-STORE-NO                     PIC  X(04).              00732200
P10237     05  FILLER                          PIC  X(14).              00732300
P10237     05  SR-POS-ID                       PIC  X(09).              00732400
P10237     05  SR-ENTRY-DATE                   PIC  X(08).              00732500
P10237     05  FILLER                          PIC  X(06).              00732600
P10237     05  SR-REF-NO                       PIC  X(04).              00733000
P10237     05  FILLER                          PIC  X(23).              00733199
P10237     05  SR-BINACCT-NBR.                                          00733399
P10237         10  SR-BIN-NUMBER               PIC  X(06).              00733499
P10237         10  SR-ACCOUNT-NUMBER-12.                                00733599
P10237             15  SR-ACCOUNT-NUMBER-10    PIC  X(10).              00733799
P10237             15  FILLER                  PIC  X(02).              00733899
P10237     05  FILLER                          PIC  X(67).              00734099
007100                                                                  00737099
007200 FD  CR-ACTIVITY-REPORT-FILE                                      00740000
007300     RECORDING MODE IS F                                          00750000
007400     BLOCK CONTAINS 0 RECORDS                                     00760000
007500     LABEL RECORDS ARE OMITTED.                                   00770000
007600                                                                  00780000
007700 01  CA-CR-ACTIVITY-REPORT-RECORD                                 00790000
007800                                 PIC X(132).                      00800000
007900                                                                  00810000
008600                                                                  00820000
008700 WORKING-STORAGE SECTION.                                         00830000
008800 01  ABEND-CODE                  PIC S9(04)   VALUE +0 COMP SYNC. 00840000
008900     88  ABEND-4001-WRITE-ERROR               VALUE +4001.        00850000
009000     88  ABEND-4002-READ-ERROR                VALUE +4002.        00860000
009100     88  ABEND-4003-CTRL-CARD-ERROR           VALUE +4003.        00870000
009200     88  ABEND-4004-TABLE-ERROR               VALUE +4004.        00880000
009300     88  ABEND-4005-OPEN-ERROR                VALUE +4005.        00890000
009400     88  ABEND-4006-CLOSE-ERROR               VALUE +4006.        00900000
009500     88  ABEND-4007-SEQUENCE-ERROR            VALUE +4007.        00910000
009600     88  ABEND-4008-DATA-ERROR                VALUE +4008.        00920000
009700     88  ABEND-4009-KEY-DATA-ERROR            VALUE +4009.        00930000
P10237     88  ABEND-4012-INTERNAL-SORT-ERROR       VALUE +4012.        00931000
009800     88  ABEND-4013-DB2-ERROR                 VALUE +4013.        00940000
009900     88  ABEND-4019-CAL-SUB-ERROR             VALUE +4019.        00950000
010000     88  ABEND-4444-FORCED-ABEND              VALUE +4444.        00960000
010100                                                                  00970000
010200 01  PS-PROGRAM-SWITCHES.                                         00980000
010300     05  PS-END-OF-CR-POSTING-IND                                 00990000
010400                                 PIC X(1)     VALUE 'N'.          01000000
010500         88  PS-END-OF-CR-POSTING-FILE        VALUE 'Y'.          01010000
P10237     05  PS-END-OF-SORTW-FILE-IND                                 01011000
P10237                                 PIC X(1)     VALUE 'N'.          01012000
P10237         88  PS-END-OF-SORTW-FILE             VALUE 'Y'.          01013000
010600     05  PS-PRINT-IND            PIC X(1)     VALUE 'Y'.          01020000
010700         88  PS-DO-NOT-PRINT                  VALUE 'N'.          01030000
010800         88  PS-PRINT                         VALUE 'Y'.          01040000
P10237     05  PS-ACCT-IND             PIC X(8)     VALUE SPACES.       01041099
P10237         88  PS-ACCT                          VALUE 'ACCT#'.      01042099
P10237         88  PS-BIN-ACCT                      VALUE 'BINACCT#'.   01043099
010900                                                                  01050000
011200 01  PC-PROGRAM-CONSTANTS.                                        01060000
011300     05  PC-CURRENT-PROGRAM-NAME PIC  X(08)   VALUE 'ARKRP019'.   01070000
011400     05  PC-1                    PIC S9(04)   VALUE +1 COMP.      01080000
011500     05  PC-2                    PIC S9(04)   VALUE +2 COMP.      01090000
011600     05  PC-3                    PIC S9(04)   VALUE +3 COMP.      01100000
011700     05  PC-63                   PIC S9(04)   VALUE +63 COMP.     01110000
011800     05  PC-DASH                 PIC  X(01)   VALUE '-'.          01120000
011900     05  PC-SLASH                PIC  X(01)   VALUE '/'.          01130000
012000     05  PC-PAGE-SIZE            PIC S9(4)    VALUE +62 COMP.     01140000
012100     05  PC-MAXIMUM-SUMMARY-LINES                                 01150000
EVM001                                 PIC S9(4)    VALUE +45.          01170000
012300     05  PC-ADVANCE-PAGE         PIC X(1)     VALUE '1'.          01180000
012400     05  PC-ADVANCE-1-LINE       PIC X(1)     VALUE ' '.          01190000
012500     05  PC-ADVANCE-2-LINES      PIC X(1)     VALUE '0'.          01200000
012600     05  PC-ADVANCE-3-LINES      PIC X(1)     VALUE '-'.          01210000
012700     05  PC-POS                  PIC X(21)    VALUE               01220000
012800         'POS:                 '.                                 01230000
012900     05  PC-POS-SUBTOTAL         PIC X(21)    VALUE               01240000
013000         'POS SUBTOTAL:        '.                                 01250000
013100     05  PC-MAINTENANCE          PIC X(21)    VALUE               01260000
013200         'MAINTENANCE:         '.                                 01270000
013300     05  PC-MAINTENANCE-SUBTOTAL PIC X(21)    VALUE               01280000
013400         'MAINTENANCE SUBTOTAL:'.                                 01290000
013500     05  PC-NON-POS-MNT-STR-SFX  PIC X(21)    VALUE               01300000
013600         'NON POS/MNT STR SFX: '.                                 01310000
013700     05  PC-TOT-BY-TRANS-TYPE    PIC X(21)    VALUE               01320000
013800         'TOTALS BY TRANS TYPE:'.                                 01330000
013900     05  PC-NET-TOTALS           PIC X(21)    VALUE               01340000
014000         'NET TOTALS:          '.                                 01350000
014100     05  PC-NET-DAILY-ACTIVITY   PIC X(34)    VALUE               01360000
014200         'NET DAILY ACTIVITY                '.                    01370000
014300                                                                  01380000
014400 01  PV-PROGRAM-VARIABLES.                                        01390000
014500     05  PV-PAGE-COUNT           PIC S9(5)    VALUE ZERO COMP-3.  01400000
014600     05  PV-LINE-COUNT           PIC S9(4)    VALUE +63 COMP.     01410000
014700     05  PV-ADVANCE-COUNT        PIC S9(4)    VALUE +1 COMP.      01420000
014800     05  PV-ADVANCE-LINES        PIC S9(4)    VALUE ZERO COMP.    01430000
014900     05  PV-CONTROL-CHARACTER    PIC X(1)     VALUE SPACES.       01440000
015000     05  PV-PARAGRAPH-NAME       PIC X(30)    VALUE SPACES.       01450000
015100     05  PV-OPERATION-MSG-1      PIC X(40)    VALUE SPACES.       01460000
015200     05  PV-OPERATION-MSG-2      PIC X(40)    VALUE SPACES.       01470000
015201     05  PV-FILE-REC-CNT         PIC 9(07)    VALUE ZEROS.        01480000
P10237     05  PV-SORT-RETURN          PIC 9(02)    VALUE ZEROS.        01481000
P10237     05  PV-RECORDS-INTO-SORT    PIC S9(09)   VALUE +0 COMP-3.    01482000
P10237     05  PV-RECORDS-OUT-OF-SORT  PIC S9(09)   VALUE +0 COMP-3.    01484000
P10237     05  PV-ACCT-LEN             PIC  9(09)   VALUE ZEROES.       01485099
P10237     05  PV-ACCT-NBR.                                             01487099
P10237         10  PV-ACCT-NBR-16      PIC  X(16)   VALUE SPACES.       01488099
P10237         10  PV-ACCT-TYPE        PIC  X(02)   VALUE SPACES.       01489099
015310                                                                  01490000
015400 01  CD-CURRENT-DATE.                                             01500000
015500     05  CD-CURRENT-YEAR         PIC 9(2)     VALUE ZERO.         01510000
015600     05  CD-CURRENT-MONTH        PIC 9(2)     VALUE ZERO.         01520000
015700     05  CD-CURRENT-DAY          PIC 9(2)     VALUE ZERO.         01530000
015800                                                                  01540000
015900 01  CT-CURRENT-TIME.                                             01550000
016000     05  CT-CURRENT-HOUR         PIC 9(2)     VALUE ZERO.         01560000
016100     05  CT-CURRENT-MINUTE       PIC 9(2)     VALUE ZERO.         01570000
016200     05  CT-CURRENT-SECOND       PIC 9(2)     VALUE ZERO.         01580000
016300     05  FILLER                  PIC 9(2)     VALUE ZERO.         01590000
016400                                                                  01600000
016500 01  CC-CONTROL-CARD.                                             01610000
016600     05  CC-CONTROL-CARD-DISPLAY.                                 01620000
016700         10  CC-POS-DATE         PIC 9(8).                        01630000
016800         10  FILLER              PIC X(72).                       01640000
016900                                                                  01650000
017400 01  ST-SUMMARY-TOTAL-TABLE.                                      01660000
EVM001     05  ST-SUMMARY-TOTAL-ENTRY  OCCURS 45 TIMES                  01680000
017600                                 INDEXED BY ST-SUMMARY-INDEX.     01690000
017700         10  ST-TRANSACTION-COUNT                                 01700000
017800                                 PIC S9(7).                       01710000
017900         10  ST-TOT-TRANSACTION-AMOUNT                            01720000
018000                                 PIC S9(9)V99.                    01730000
018100                                                                  01740000
018200 01  HL2-HEADING-LINE-2.                                          01750000
018300     05  FILLER                  PIC X(43)    VALUE SPACES.       01760000
018400     05  FILLER                  PIC X(35)    VALUE               01770000
018500         '  KOHLS CREDIT ACTIVITY DETAIL -   '.                   01780000
018600     05  HL2-POS-DATE            PIC 99/99/9999 VALUE ZERO.       01790000
018700     05  FILLER                  PIC X(44)    VALUE SPACES.       01800000
018800                                                                  01810000
018900 01  HL3-HEADING-LINE-3.                                          01820000
019000     05  FILLER                  PIC X(44)    VALUE               01830000
019100         'TRANSACTION      ACCOUNT   LEVEL OF  STORE  '.          01840000
019200     05  FILLER                  PIC X(44)    VALUE               01850000
019300         '  TERM    TRANS  TRANSACTION    TRANSACTION '.          01860000
019400     05  FILLER                  PIC X(44)    VALUE               01870000
019500         '   TRANSACTION                              '.          01880000
019600                                                                  01890000
019700 01  HL4-HEADING-LINE-4.                                          01900000
019800     05  FILLER                  PIC X(44)    VALUE               01910000
019900         '    DATE         NUMBER     ISSUE    NUMBER '.          01920000
020000     05  FILLER                  PIC X(44)    VALUE               01930000
020100         ' NUMBER   NUMBER     CODE          AMOUNT   '.          01940000
020200     05  FILLER                  PIC X(44)    VALUE               01950000
020300         '   DESCRIPTION                              '.          01960000
020400                                                                  01970000
020500 01  HL5-HEADING-LINE-5.                                          01980000
020600     05  FILLER                  PIC X(43)    VALUE SPACES.       01990000
020700     05  FILLER                  PIC X(35)    VALUE               02000000
020800         '  KOHLS CREDIT ACTIVITY SUMMARY -  '.                   02010000
020900     05  HL5-POS-DATE            PIC 99/99/9999 VALUE ZERO.       02020000
021000     05  FILLER                  PIC X(44)    VALUE SPACES.       02030000
021100                                                                  02040000
021200 01  HL6-HEADING-LINE-6.                                          02050000
021300     05  FILLER                  PIC X(44)    VALUE               02060000
021400         '                      TRANSACTION CODE    TR'.          02070000
021500     05  FILLER                  PIC X(44)    VALUE               02080000
021600         'ANSACTION TYPE               TRANSACTION COU'.          02090000
021700     05  FILLER                  PIC X(44)    VALUE               02100000
021800         'NT       TRANSACTION AMOUNT                 '.          02110000
021900                                                                  02120000
022000 01  DL-DETAIL-LINE.                                              02130000
022100     05  FILLER                  PIC X(02).                       02140000
022200     05  DL-TRANS-DT-MM          PIC 9(02).                       02150000
022300     05  DL-TRANS-DT-SLASH-1     PIC X(01).                       02160000
022400     05  DL-TRANS-DT-DD          PIC 9(02).                       02170000
022500     05  DL-TRANS-DT-SLASH-2     PIC X(01).                       02180000
022600     05  DL-TRANS-DT-YY          PIC 9(02).                       02190000
022700     05  FILLER                  PIC X(02).                       02200099
P1043      05  DL-BIN-NUMBER           PIC X(06) VALUE SPACES.          02201099
022800     05  DL-ACCOUNT-NUMBER-1-3   PIC X(03).                       02210000
022900     05  DL-ACCOUNT-NUMBER-DASH-1                                 02220000
023000                                 PIC X(01).                       02230000
023100     05  DL-ACCOUNT-NUMBER-4-7   PIC X(04).                       02240000
023200     05  DL-ACCOUNT-NUMBER-DASH-2                                 02250000
023300                                 PIC X(01).                       02260000
023400     05  DL-ACCOUNT-NUMBER-8-10  PIC X(03).                       02270000
023500     05  FILLER                  PIC X(02).                       02280099
023600     05  DL-CARD-LEVEL-OF-ISSUE  PIC X(02).                       02290000
023700     05  FILLER                  PIC X(04).                       02300099
023800     05  DL-STORE-NO             PIC X(04).                       02310000
023900     05  FILLER                  PIC X(04).                       02320000
024000     05  DL-TERM-NUMBER          PIC 9(04).                       02330000
024100     05  FILLER                  PIC X(05).                       02340000
024200     05  DL-TRANS-NUMBER         PIC 9(04).                       02350000
024300     05  FILLER                  PIC X(06).                       02360000
024400     05  DL-TRANSACTION-CODE     PIC X(04).                       02370000
024500     05  FILLER                  PIC X(05).                       02380000
024600     05  DL-TRANSACTION-AMOUNT   PIC Z,ZZZ,ZZ9.99-.               02390000
024700     05  FILLER                  PIC X(04).                       02400000
024800     05  DL-TRANSACTION-DESCRIPTION                               02410000
024900                                 PIC X(40).                       02420000
025000     05  FILLER                  PIC X(01).                       02430000
025100                                                                  02440000
025200 01  SL-SUMMARY-LINE.                                             02450000
025300     05  FILLER                  PIC X(07)    VALUE SPACES.       02460000
025400     05  SL-TRANS-STORE-SUFFIX-DESC                               02470000
025500                                 PIC X(21)    VALUE SPACES.       02480000
025600     05  FILLER                  PIC X(03)    VALUE SPACES.       02490000
025700     05  SL-TRANS-CODE           PIC X(04)    VALUE SPACES.       02500000
025800     05  FILLER                  PIC X(5)     VALUE SPACES.       02510000
025900     05  SL-TRANS-TYPE-DESCRIPTION                                02520000
026000                                 PIC X(34)    VALUE SPACES.       02530000
026100     05  FILLER                  PIC X(01)    VALUE SPACES.       02540000
026200     05  SL-TRANSACTION-COUNT    PIC Z,ZZZ,ZZ9                    02550000
026300                                              VALUE ZERO.         02560000
026400     05  FILLER                  PIC X(12)    VALUE SPACES.       02570000
026500     05  SL-TOT-TRANSACTION-AMOUNT                                02580000
026600                                 PIC ZZZ,ZZZ,ZZ9.99-              02590000
026700                                              VALUE ZERO.         02600000
026800******************************************************************02610000
026900*    ACCOUNTS RECEIVABLE - CREDIT - CONSTANTS                     02620000
027000******************************************************************02630000
027100     COPY ARWS004.                                                02640000
027200 SKIP1                                                            02650000
027300******************************************************************02701000
027400*    CREDIT POSTING FILE LAYOUT                                   02702000
027500******************************************************************02703000
027600     COPY ARRD021.                                                02704000
027700 SKIP1                                                            02705000
P10237******************************************************************02706000
P10237* LAYOUT THAT DEFINES THE PARAMETERS NEEDED TO INVOKE PROTEGRITY *02707000
P10237* MODULE                                                         *02708000
P10237******************************************************************02709000
P10237     COPY PTYCCSIP.                                               02709100
P10237 SKIP1                                                            02709200
P10237******************************************************************02709300
P10237* LAYOUT THAT DEFINES THE WORKING VARIABLES TO INVOKE PROTEGRITY *02709400
P10237* MODULE                                                         *02709500
P10237******************************************************************02709600
P10237     COPY DPWS031.                                                02709799
P10237 SKIP1                                                            02709800
027800******************************************************************02710000
027900*    DATE VALIDATION CALLING PARAMETER LIST                       02720000
028000******************************************************************02730000
028100     COPY DPWS500.                                                02740000
028200 SKIP1                                                            02750000
028300******************************************************************02760000
028400*    STANDARD REPORT HEADER FOR A 132 COLUMN REPORT               02770000
028500******************************************************************02780000
028600     COPY DPWS132O.                                               02790000
028700 EJECT                                                            02800000
028800 PROCEDURE DIVISION.                                              02810000
028900******************************************************************02820000
029000*    MAINLINE ROUTINE                                            *02830000
029100******************************************************************02840000
029200 0000-MAINLINE.                                                   02850000
029300     PERFORM 1000-INITIALIZE.                                     02860000
029400     PERFORM 2000-OPEN-FILES.                                     02870000
029500     PERFORM 3000-REPORT-INITIALIZE.                              02880000
029800     PERFORM 5000-PRINT-ACTIVITY-SUMMARY.                         02910000
029900     PERFORM 9000-CLOSE-FILES.                                    02920000
030000     STOP RUN.                                                    02930000
030100 SKIP1                                                            02940000
030200******************************************************************02950000
030300*    INITIALIZE ROUTINE                                          *02960000
030400******************************************************************02970000
030500 1000-INITIALIZE.                                                 02980000
030600     ACCEPT CC-CONTROL-CARD.                                      02990000
030700     DISPLAY PC-CURRENT-PROGRAM-NAME ' - CONTROL CARD - '         03000000
030800             CC-CONTROL-CARD-DISPLAY.                             03010000
030900                                                                  03020000
P10237     MOVE PC-CURRENT-PROGRAM-NAME  TO DP031-PROGRAM-NAME.         03021099
031000     ACCEPT DPG51-SYSTEM-DATE FROM DATE.                          03030000
031100     SET DPG51-ACTUAL-CALENDAR-ONLY                               03040000
031200                                 TO TRUE.                         03050000
031300     SET DPG51-DO-NOT-INCR-DECR-DATE                              03060000
031400                                 TO TRUE.                         03070000
031500     MOVE CC-POS-DATE            TO DPG52-LK-DATE-INPUT.          03080000
031600     SET DPG52-LK-DTE-GREG-CC    TO TRUE.                         03090000
031700     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    03100000
031800                                             DPG54 DPG55 DPG56.   03110000
031900     EVALUATE TRUE                                                03120000
032000         WHEN DPG54-SEVERE-ERROR                                  03130000
032100         WHEN DPG54-DATE-INVALID                                  03140000
032200             MOVE '1000-INITIALIZE'                               03150000
032300                                 TO PV-PARAGRAPH-NAME             03160000
032400             MOVE 'INVALID CONTROL POS DATE'                      03170000
032500                                 TO PV-OPERATION-MSG-1            03180000
032600             MOVE DPG54-ERROR-MESSAGE                             03190000
032700                                 TO PV-OPERATION-MSG-2            03200000
032800             SET ABEND-4003-CTRL-CARD-ERROR                       03210000
032900                                 TO TRUE                          03220000
033000             PERFORM 9999-ABEND                                   03230000
033100         WHEN OTHER                                               03240000
033200             MOVE CC-POS-DATE    TO HL2-POS-DATE                  03250000
033300                                    HL5-POS-DATE                  03260000
033400     END-EVALUATE.                                                03270000
033500 SKIP1                                                            03280000
033600******************************************************************03290000
033700*    OPEN FILES                                                  *03300000
033800******************************************************************03310000
033900 2000-OPEN-FILES.                                                 03320000
034000     OPEN INPUT  CR-POSTING-FILE                                  03330000
034100          OUTPUT CR-ACTIVITY-REPORT-FILE.                         03340000
034400******************************************************************03350000
034500*    REPORT INITIALIZATION FOR KOHLS CREDIT ACTIVITY DETAIL      *03360000
034600*    REPORT PROCESSING                                           *03370000
034700******************************************************************03380000
034800 3000-REPORT-INITIALIZE.                                          03390000
034900     ACCEPT CD-CURRENT-DATE FROM DATE.                            03400000
035000     MOVE CD-CURRENT-MONTH       TO DP132O-RUN-MONTH.             03410000
035100     MOVE CD-CURRENT-DAY         TO DP132O-RUN-DAY.               03420000
035200     MOVE CD-CURRENT-YEAR        TO DP132O-RUN-YEAR.              03430000
035300     ACCEPT CT-CURRENT-TIME FROM TIME.                            03440000
035400     MOVE CT-CURRENT-HOUR        TO DP132O-RUN-HOUR.              03450000
035500     MOVE CT-CURRENT-MINUTE      TO DP132O-RUN-MINUTE.            03460000
035600     MOVE PC-CURRENT-PROGRAM-NAME                                 03470000
035700                                 TO DP132O-PROGRAM-NAME.          03480000
035800     MOVE PC-1                   TO DP132O-REPORT-NUMBER.         03490000
036100                                                                  03490100
036200     INITIALIZE ST-SUMMARY-TOTAL-TABLE.                           03491000
P10237                                                                  03531000
P10237     PERFORM 3100-INTERNAL-SORT.                                  03532000
P10237 SKIP1                                                            03540000
P10237******************************************************************03541000
P10237* SORT THE RECORDS BY ENTRY DATE AND DETOKIZED CARD NUMBER.       03542000
P10237******************************************************************03544000
P10237 3100-INTERNAL-SORT.                                              03545000
P10237                                                                  03549800
P10237     SORT SORT-WORK-FILE                                          03549900
P10237         ON ASCENDING KEY SR-ENTRY-DATE                           03550000
P10237                          SR-ACCOUNT-NUMBER-10                    03550199
P10237         INPUT PROCEDURE IS 3110-RELEASE-RECORDS-TO-SORT          03550200
P10237         OUTPUT PROCEDURE IS 3120-RETURN-SORT-WORK-FILE.          03550300
P10237                                                                  03550400
P10237     MOVE SORT-RETURN TO PV-SORT-RETURN.                          03550500
P10237     IF PV-SORT-RETURN NOT = ZERO                                 03550600
P10237        MOVE '3000-REPORT-INITIALIZE'                             03550700
P10237                            TO PV-PARAGRAPH-NAME                  03550800
P10237        MOVE 'INTERNAL SORT ERROR'                                03550900
P10237                            TO PV-OPERATION-MSG-1                 03551000
P10237        MOVE PV-SORT-RETURN TO PV-OPERATION-MSG-2                 03551100
P10237        SET ABEND-4012-INTERNAL-SORT-ERROR                        03551200
P10237                            TO TRUE                               03551300
P10237        PERFORM 9999-ABEND                                        03551400
P10237     END-IF.                                                      03551500
P10237                                                                  03551600
P10237     DISPLAY 'SORT RECORDS  IN = '  PV-RECORDS-INTO-SORT.         03551700
P10237     DISPLAY 'SORT RECORDS OUT = '  PV-RECORDS-OUT-OF-SORT.       03551800
P10237                                                                  03551900
036300 SKIP1                                                            03552000
P10237******************************************************************03552100
P10237* PROCESS THE RECORDS TO SORT.                                   *03552200
P10237******************************************************************03552300
P10237 3110-RELEASE-RECORDS-TO-SORT SECTION.                            03552400
P10237                                                                  03552500
P10237     PERFORM 6000-READ-CR-POSTING-FILE                            03552600
P10237       UNTIL PS-END-OF-CR-POSTING-FILE.                           03552700
P10237                                                                  03552800
P10237 3100-EXIT SECTION.                                               03552900
P10237 SKIP1                                                            03553000
P10237******************************************************************03553100
P10237* RETURNS THE SORTED RECORDS                                     *03553200
P10237******************************************************************03553300
P10237 3120-RETURN-SORT-WORK-FILE SECTION.                              03553400
P10237                                                                  03553500
P10237     RETURN SORT-WORK-FILE AT END                                 03553600
P10237                  SET PS-END-OF-SORTW-FILE TO TRUE                03553700
P10237     END-RETURN.                                                  03553800
P10237                                                                  03553900
P10237     PERFORM UNTIL PS-END-OF-SORTW-FILE                           03554000
P10237        MOVE SORT-WORK-RECORD TO AR021-AR-POSTING-RECORD          03554100
P10237        PERFORM 4000-PRINT-ACTIVITY-DETAIL                        03554200
P10237        RETURN SORT-WORK-FILE AT END                              03554300
P10237                  SET PS-END-OF-SORTW-FILE TO TRUE                03554400
P10237        END-RETURN                                                03554500
P10237        ADD +1 TO PV-RECORDS-OUT-OF-SORT                          03554600
P10237     END-PERFORM.                                                 03554700
P10237                                                                  03554800
P10237 3120-EXIT SECTION.                                               03555800
P10237 SKIP1                                                            03555900
036400******************************************************************03556000
036500*    PRINT THE KOHLS CREDIT ACTIVITY DETAIL REPORT, A MICROFICHE *03560000
036600*    TAPE COPY OF THE REPORT, AND CREATE A SUMMARY TABLE         *03570000
036700******************************************************************03580000
036800 4000-PRINT-ACTIVITY-DETAIL.                                      03590000
036900     IF PV-LINE-COUNT > PC-PAGE-SIZE                              03600000
037000         PERFORM 8100-PRINT-TITLE-LINES-RPT-1                     03610000
037200     END-IF.                                                      03620000
037300                                                                  03630000
037400     INITIALIZE DL-DETAIL-LINE.                                   03640000
037600     EVALUATE TRUE                                                03660000
037700         WHEN AR021-SS-FROM-POS                                   03670000
037800             EVALUATE TRUE                                        03680000
037900                 WHEN AR021-TRANS-TYPE = AR004-TRANS-STORE-SLS-CD 03690000
038000                     ADD PC-1  TO ST-TRANSACTION-COUNT (1)        03700000
EVM001                                  ST-TRANSACTION-COUNT (15)       03710000
EVM001                                  ST-TRANSACTION-COUNT (32)       03720000
EVM001                                  ST-TRANSACTION-COUNT (45)       03730000
038400                     ADD AR021-AMOUNT                             03740000
038500                               TO ST-TOT-TRANSACTION-AMOUNT (1)   03750000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  03760000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (32)  03770000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  03780000
038900                     MOVE AR004-TRANS-STORE-SLS-DS                03790000
039000                               TO DL-TRANSACTION-DESCRIPTION      03800000
039100                 WHEN AR021-TRANS-TYPE = AR004-TRANS-STORE-RET-CD 03810000
039200                     ADD PC-1  TO ST-TRANSACTION-COUNT (2)        03820000
EVM001                                  ST-TRANSACTION-COUNT (15)       03830000
EVM001                                  ST-TRANSACTION-COUNT (33)       03840000
EVM001                                  ST-TRANSACTION-COUNT (45)       03850000
039600                     SUBTRACT AR021-AMOUNT                        03860000
039700                             FROM ST-TOT-TRANSACTION-AMOUNT (2)   03870000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  03880000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (33)  03890000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  03900000
040100                     MOVE AR004-TRANS-STORE-RET-DS                03910000
040200                               TO DL-TRANSACTION-DESCRIPTION      03920000
040300                 WHEN (AR021-TRANS-TYPE =                         03930000
040400                       AR004-TRANS-STORE-PAYMENT-CD)              03940000
040500                     ADD PC-1  TO ST-TRANSACTION-COUNT (3)        03950000
EVM001                                  ST-TRANSACTION-COUNT (15)       03960000
EVM001                                  ST-TRANSACTION-COUNT (34)       03970000
EVM001                                  ST-TRANSACTION-COUNT (45)       03980000
040900                     SUBTRACT AR021-AMOUNT                        03990000
041000                             FROM ST-TOT-TRANSACTION-AMOUNT (3)   04000000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  04010000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (34)  04020000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  04030000
041400                     MOVE AR004-TRANS-STORE-PAYMENT-DS            04040000
041500                               TO DL-TRANSACTION-DESCRIPTION      04050000
041600                 WHEN AR021-TRANS-TYPE = AR004-TRANS-DEBIT-ADJ-CD 04060000
041700                     ADD PC-1  TO ST-TRANSACTION-COUNT (4)        04070000
EVM001                                  ST-TRANSACTION-COUNT (15)       04080000
EVM001                                  ST-TRANSACTION-COUNT (35)       04090000
EVM001                                  ST-TRANSACTION-COUNT (45)       04100000
042100                     ADD AR021-AMOUNT                             04110000
042200                               TO ST-TOT-TRANSACTION-AMOUNT (4)   04120000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  04130000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (35)  04140000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  04150000
042600                     MOVE AR004-TRANS-DEBIT-ADJ-DS                04160000
042700                               TO DL-TRANSACTION-DESCRIPTION      04170000
042800                 WHEN (AR021-TRANS-TYPE =                         04180000
042900                       AR004-TRANS-SLS-AUD-RET-ADJ-CD)            04190000
043000                     ADD PC-1  TO ST-TRANSACTION-COUNT (5)        04200000
EVM001                                  ST-TRANSACTION-COUNT (15)       04210000
EVM001                                  ST-TRANSACTION-COUNT (36)       04220000
EVM001                                  ST-TRANSACTION-COUNT (45)       04230000
043400                     SUBTRACT AR021-AMOUNT                        04240000
043500                             FROM ST-TOT-TRANSACTION-AMOUNT (5)   04250000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  04260000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (36)  04270000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  04280000
043900                     MOVE AR004-TRANS-SLS-AUD-RET-ADJ-DS          04290000
044000                               TO DL-TRANSACTION-DESCRIPTION      04300000
044100                 WHEN (AR021-TRANS-TYPE =                         04310000
044200                       AR004-TRANS-SA-PAY-CR-ADJ-CD)              04320000
044300                     ADD PC-1  TO ST-TRANSACTION-COUNT (6)        04330000
EVM001                                  ST-TRANSACTION-COUNT (15)       04340000
EVM001                                  ST-TRANSACTION-COUNT (37)       04350000
EVM001                                  ST-TRANSACTION-COUNT (45)       04360000
044700                     SUBTRACT AR021-AMOUNT                        04370000
044800                             FROM ST-TOT-TRANSACTION-AMOUNT (6)   04380000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  04390000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (37)  04400000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  04410000
045200                     MOVE AR004-TRANS-SA-PAY-CR-ADJ-DS            04420000
045300                               TO DL-TRANSACTION-DESCRIPTION      04430000
045400                 WHEN AR021-TRANS-TYPE = AR004-TRANS-CREDIT-ADJ-CD04440000
045500                     ADD PC-1  TO ST-TRANSACTION-COUNT (7)        04450000
EVM001                                  ST-TRANSACTION-COUNT (15)       04460000
EVM001                                  ST-TRANSACTION-COUNT (38)       04470000
EVM001                                  ST-TRANSACTION-COUNT (45)       04480000
045900                     SUBTRACT AR021-AMOUNT                        04490000
046000                             FROM ST-TOT-TRANSACTION-AMOUNT (7)   04500000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  04510000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (38)  04520000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  04530000
046400                     MOVE AR004-TRANS-CREDIT-ADJ-DS               04540000
046500                               TO DL-TRANSACTION-DESCRIPTION      04550000
046600                 WHEN (AR021-TRANS-TYPE =                         04560000
046700                       AR004-TRANS-SLS-AUD-SLS-ADJ-CD)            04570000
046800                     ADD PC-1  TO ST-TRANSACTION-COUNT (8)        04580000
EVM001                                  ST-TRANSACTION-COUNT (15)       04590000
EVM001                                  ST-TRANSACTION-COUNT (39)       04600000
EVM001                                  ST-TRANSACTION-COUNT (45)       04610000
047200                     ADD AR021-AMOUNT                             04620000
047300                               TO ST-TOT-TRANSACTION-AMOUNT (8)   04630000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  04640000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (39)  04650000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  04660000
047700                     MOVE AR004-TRANS-SLS-AUD-SLS-ADJ-DS          04670000
047800                               TO DL-TRANSACTION-DESCRIPTION      04680000
047900                 WHEN (AR021-TRANS-TYPE =                         04690000
048000                       AR004-TRANS-EMPL-DISC-SLS-CD)              04700000
048100                     ADD PC-1  TO ST-TRANSACTION-COUNT (9)        04710000
EVM001                                  ST-TRANSACTION-COUNT (15)       04720000
EVM001                                  ST-TRANSACTION-COUNT (40)       04730000
EVM001                                  ST-TRANSACTION-COUNT (45)       04740000
048500                     SUBTRACT AR021-AMOUNT                        04750000
048600                             FROM ST-TOT-TRANSACTION-AMOUNT (9)   04760000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  04770000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (40)  04780000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  04790000
049000                     MOVE AR004-TRANS-EMPL-DISC-SLS-DS            04800000
049100                               TO DL-TRANSACTION-DESCRIPTION      04810000
049200                 WHEN (AR021-TRANS-TYPE =                         04820000
049300                       AR004-TRANS-SA-EMP-DIS-SL-CD)              04830000
049400                     ADD PC-1  TO ST-TRANSACTION-COUNT (10)       04840000
EVM001                                  ST-TRANSACTION-COUNT (15)       04850000
EVM001                                  ST-TRANSACTION-COUNT (41)       04860000
EVM001                                  ST-TRANSACTION-COUNT (45)       04870000
049800                     SUBTRACT AR021-AMOUNT                        04880000
049900                             FROM ST-TOT-TRANSACTION-AMOUNT (10)  04890000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  04900000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (41)  04910000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  04920000
050300                     MOVE AR004-TRANS-SA-EMP-DIS-SL-DS            04930000
050400                               TO DL-TRANSACTION-DESCRIPTION      04940000
050500                 WHEN (AR021-TRANS-TYPE =                         04950000
050600                       AR004-TRANS-EMPL-DISC-RET-CD)              04960000
050700                     ADD PC-1  TO ST-TRANSACTION-COUNT (11)       04970000
EVM001                                  ST-TRANSACTION-COUNT (15)       04980000
EVM001                                  ST-TRANSACTION-COUNT (42)       04990000
EVM001                                  ST-TRANSACTION-COUNT (45)       05000000
051100                     ADD AR021-AMOUNT                             05010000
051200                               TO ST-TOT-TRANSACTION-AMOUNT (11)  05020000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  05030000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (42)  05040000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  05050000
051600                     MOVE AR004-TRANS-EMPL-DISC-RET-DS            05060000
051700                               TO DL-TRANSACTION-DESCRIPTION      05070000
051800                 WHEN (AR021-TRANS-TYPE =                         05080000
051900                       AR004-TRANS-SA-EMP-DIS-RT-CD)              05090000
052000                     ADD PC-1  TO ST-TRANSACTION-COUNT (12)       05100000
EVM001                                  ST-TRANSACTION-COUNT (15)       05110000
EVM001                                  ST-TRANSACTION-COUNT (43)       05120000
EVM001                                  ST-TRANSACTION-COUNT (45)       05130000
052400                     ADD AR021-AMOUNT                             05140000
052500                               TO ST-TOT-TRANSACTION-AMOUNT (12)  05150000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (15)  05160000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (43)  05170000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  05180000
052900                     MOVE AR004-TRANS-SA-EMP-DIS-RT-DS            05190000
053000                               TO DL-TRANSACTION-DESCRIPTION      05200000
053100                 WHEN OTHER                                       05210000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (14)       05220000
053300                     ADD AR021-AMOUNT                             05230000
EVM001                               TO ST-TOT-TRANSACTION-AMOUNT (14)  05240000
053500                     MOVE SPACES                                  05250000
053600                               TO DL-TRANSACTION-DESCRIPTION      05260000
053700             END-EVALUATE                                         05270000
053800         WHEN AR021-SS-FROM-MAINTENANCE                           05280000
053900             EVALUATE TRUE                                        05290000
054000                 WHEN AR021-TRANS-TYPE = AR004-TRANS-STORE-SLS-CD 05300000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (16)       05310000
EVM001                                  ST-TRANSACTION-COUNT (30)       05320000
EVM001                                  ST-TRANSACTION-COUNT (32)       05330000
EVM001                                  ST-TRANSACTION-COUNT (45)       05340000
054500                     ADD AR021-AMOUNT                             05350000
EVM001                               TO ST-TOT-TRANSACTION-AMOUNT (16)  05360000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  05370000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (32)  05380000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  05390000
055000                     MOVE AR004-TRANS-STORE-SLS-DS                05400000
055100                               TO DL-TRANSACTION-DESCRIPTION      05410000
055200                 WHEN AR021-TRANS-TYPE = AR004-TRANS-STORE-RET-CD 05420000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (17)       05430000
EVM001                                  ST-TRANSACTION-COUNT (30)       05440000
EVM001                                  ST-TRANSACTION-COUNT (33)       05450000
EVM001                                  ST-TRANSACTION-COUNT (45)       05460000
055700                     SUBTRACT AR021-AMOUNT                        05470000
EVM001                             FROM ST-TOT-TRANSACTION-AMOUNT (17)  05480000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  05490000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (33)  05500000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  05510000
056200                     MOVE AR004-TRANS-STORE-RET-DS                05520000
056300                               TO DL-TRANSACTION-DESCRIPTION      05530000
056400                 WHEN (AR021-TRANS-TYPE =                         05540000
056500                       AR004-TRANS-STORE-PAYMENT-CD)              05550000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (18)       05560000
EVM001                                  ST-TRANSACTION-COUNT (30)       05570000
EVM001                                  ST-TRANSACTION-COUNT (34)       05580000
EVM001                                  ST-TRANSACTION-COUNT (45)       05590000
057000                     SUBTRACT AR021-AMOUNT                        05600000
EVM001                             FROM ST-TOT-TRANSACTION-AMOUNT (18)  05610000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  05620000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (34)  05630000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  05640000
057500                     MOVE AR004-TRANS-STORE-PAYMENT-DS            05650000
057600                               TO DL-TRANSACTION-DESCRIPTION      05660000
057700                 WHEN AR021-TRANS-TYPE = AR004-TRANS-DEBIT-ADJ-CD 05670000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (19)       05680000
EVM001                                  ST-TRANSACTION-COUNT (30)       05690000
EVM001                                  ST-TRANSACTION-COUNT (35)       05700000
EVM001                                  ST-TRANSACTION-COUNT (45)       05710000
058200                     ADD AR021-AMOUNT                             05720000
EVM001                               TO ST-TOT-TRANSACTION-AMOUNT (19)  05730000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  05740000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (35)  05750000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  05760000
058700                     MOVE AR004-TRANS-DEBIT-ADJ-DS                05770000
058800                               TO DL-TRANSACTION-DESCRIPTION      05780000
058900                 WHEN (AR021-TRANS-TYPE =                         05790000
059000                       AR004-TRANS-SLS-AUD-RET-ADJ-CD)            05800000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (20)       05810000
EVM001                                  ST-TRANSACTION-COUNT (30)       05820000
EVM001                                  ST-TRANSACTION-COUNT (36)       05830000
EVM001                                  ST-TRANSACTION-COUNT (45)       05840000
059500                     SUBTRACT AR021-AMOUNT                        05850000
EVM001                             FROM ST-TOT-TRANSACTION-AMOUNT (20)  05860000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  05870000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (36)  05880000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  05890000
060000                     MOVE AR004-TRANS-SLS-AUD-RET-ADJ-DS          05900000
060100                               TO DL-TRANSACTION-DESCRIPTION      05910000
060200                 WHEN (AR021-TRANS-TYPE =                         05920000
060300                       AR004-TRANS-SA-PAY-CR-ADJ-CD)              05930000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (21)       05940000
EVM001                                  ST-TRANSACTION-COUNT (30)       05950000
EVM001                                  ST-TRANSACTION-COUNT (37)       05960000
EVM001                                  ST-TRANSACTION-COUNT (45)       05970000
060800                     SUBTRACT AR021-AMOUNT                        05980000
EVM001                             FROM ST-TOT-TRANSACTION-AMOUNT (21)  05990000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  06000000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (37)  06010000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  06020000
061300                     MOVE AR004-TRANS-SA-PAY-CR-ADJ-DS            06030000
061400                               TO DL-TRANSACTION-DESCRIPTION      06040000
061500                 WHEN AR021-TRANS-TYPE = AR004-TRANS-CREDIT-ADJ-CD06050000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (22)       06060000
EVM001                                  ST-TRANSACTION-COUNT (30)       06070000
EVM001                                  ST-TRANSACTION-COUNT (38)       06080000
EVM001                                  ST-TRANSACTION-COUNT (45)       06090000
062000                     SUBTRACT AR021-AMOUNT                        06100000
EVM001                             FROM ST-TOT-TRANSACTION-AMOUNT (22)  06110000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  06120000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (38)  06130000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  06140000
062500                     MOVE AR004-TRANS-CREDIT-ADJ-DS               06150000
062600                               TO DL-TRANSACTION-DESCRIPTION      06160000
062700                 WHEN (AR021-TRANS-TYPE =                         06170000
062800                       AR004-TRANS-SLS-AUD-SLS-ADJ-CD)            06180000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (23)       06190000
EVM001                                  ST-TRANSACTION-COUNT (30)       06200000
EVM001                                  ST-TRANSACTION-COUNT (39)       06210000
EVM001                                  ST-TRANSACTION-COUNT (45)       06220000
063300                     ADD AR021-AMOUNT                             06230000
EVM001                               TO ST-TOT-TRANSACTION-AMOUNT (23)  06240000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  06250000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (39)  06260000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  06270000
063800                     MOVE AR004-TRANS-SLS-AUD-SLS-ADJ-DS          06280000
063900                               TO DL-TRANSACTION-DESCRIPTION      06290000
064000                 WHEN (AR021-TRANS-TYPE =                         06300000
064100                       AR004-TRANS-EMPL-DISC-SLS-CD)              06310000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (24)       06320000
EVM001                                  ST-TRANSACTION-COUNT (30)       06330000
EVM001                                  ST-TRANSACTION-COUNT (40)       06340000
EVM001                                  ST-TRANSACTION-COUNT (45)       06350000
064600                     SUBTRACT AR021-AMOUNT                        06360000
EVM001                             FROM ST-TOT-TRANSACTION-AMOUNT (24)  06370000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  06380000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (40)  06390000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  06400000
065100                     MOVE AR004-TRANS-EMPL-DISC-SLS-DS            06410000
065200                               TO DL-TRANSACTION-DESCRIPTION      06420000
065300                 WHEN (AR021-TRANS-TYPE =                         06430000
065400                       AR004-TRANS-SA-EMP-DIS-SL-CD)              06440000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (25)       06450000
EVM001                                  ST-TRANSACTION-COUNT (30)       06460000
EVM001                                  ST-TRANSACTION-COUNT (41)       06470000
EVM001                                  ST-TRANSACTION-COUNT (45)       06480000
065900                     SUBTRACT AR021-AMOUNT                        06490000
EVM001                             FROM ST-TOT-TRANSACTION-AMOUNT (25)  06500000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  06510000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (41)  06520000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  06530000
066400                     MOVE AR004-TRANS-SA-EMP-DIS-SL-DS            06540000
066500                               TO DL-TRANSACTION-DESCRIPTION      06550000
066600                 WHEN (AR021-TRANS-TYPE =                         06560000
066700                       AR004-TRANS-EMPL-DISC-RET-CD)              06570000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (26)       06580000
EVM001                                  ST-TRANSACTION-COUNT (30)       06590000
EVM001                                  ST-TRANSACTION-COUNT (42)       06600000
EVM001                                  ST-TRANSACTION-COUNT (45)       06610000
067200                     ADD AR021-AMOUNT                             06620000
EVM001                               TO ST-TOT-TRANSACTION-AMOUNT (26)  06630000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  06640000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (42)  06650000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  06660000
067700                     MOVE AR004-TRANS-EMPL-DISC-RET-DS            06670000
067800                               TO DL-TRANSACTION-DESCRIPTION      06680000
067900                 WHEN (AR021-TRANS-TYPE =                         06690000
068000                       AR004-TRANS-SA-EMP-DIS-RT-CD)              06700000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (27)       06710000
EVM001                                  ST-TRANSACTION-COUNT (30)       06720000
EVM001                                  ST-TRANSACTION-COUNT (43)       06730000
EVM001                                  ST-TRANSACTION-COUNT (45)       06740000
068500                     ADD AR021-AMOUNT                             06750000
EVM001                               TO ST-TOT-TRANSACTION-AMOUNT (27)  06760000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (30)  06770000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (43)  06780000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  06790000
069000                     MOVE AR004-TRANS-SA-EMP-DIS-RT-DS            06800000
069100                               TO DL-TRANSACTION-DESCRIPTION      06810000
EVM001                 WHEN (AR021-TRANS-TYPE =                         06820000
EVM001                       AR004-TRANS-LATE-VOID-CD)                  06830000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (13)       06840000
EVM001                                  ST-TRANSACTION-COUNT (28)       06850000
EVM001                                  ST-TRANSACTION-COUNT (44)       06860000
EVM001                                  ST-TRANSACTION-COUNT (45)       06870000
EVM001                     ADD AR021-AMOUNT                             06880000
EVM001                               TO ST-TOT-TRANSACTION-AMOUNT (13)  06890000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (28)  06900000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (44)  06910000
EVM001                                  ST-TOT-TRANSACTION-AMOUNT (45)  06920000
EVM001                     MOVE AR004-TRANS-LATE-VOID-DS                06930000
EVM001                               TO DL-TRANSACTION-DESCRIPTION      06940000
069200                 WHEN OTHER                                       06950000
EVM001                     ADD PC-1  TO ST-TRANSACTION-COUNT (29)       06960000
069400                     ADD AR021-AMOUNT                             06970000
EVM001                               TO ST-TOT-TRANSACTION-AMOUNT (29)  06980000
069600                     MOVE SPACES                                  06990000
069700                               TO DL-TRANSACTION-DESCRIPTION      07000000
069800             END-EVALUATE                                         07010000
069900         WHEN OTHER                                               07020000
070000             ADD PC-1          TO ST-TRANSACTION-COUNT (29)       07030000
070100             ADD AR021-AMOUNT  TO ST-TOT-TRANSACTION-AMOUNT (29)  07040000
070200             MOVE SPACES       TO DL-TRANSACTION-DESCRIPTION      07050000
070300     END-EVALUATE.                                                07060000
070400                                                                  07070000
070500     MOVE PC-SLASH               TO DL-TRANS-DT-SLASH-1           07080000
070600                                    DL-TRANS-DT-SLASH-2.          07090000
070700     MOVE AR021-ENTRY-MONTH      TO DL-TRANS-DT-MM.               07100000
070800     MOVE AR021-ENTRY-DAY        TO DL-TRANS-DT-DD.               07110000
070900     MOVE AR021-ENTRY-YY         TO DL-TRANS-DT-YY.               07120000
071000     MOVE PC-DASH                TO DL-ACCOUNT-NUMBER-DASH-1      07130000
071100                                    DL-ACCOUNT-NUMBER-DASH-2.     07140000
P1043      MOVE SPACES TO DL-BIN-NUMBER.                                07141099
P1043      IF  AR021-BIN-NUMBER  = SPACES                               07142099
P1043         MOVE '639305'            TO DL-BIN-NUMBER                 07143099
071200        MOVE AR021-ACCOUNT-NUMBER-1-3                             07144099
071300                                 TO DL-ACCOUNT-NUMBER-1-3         07145099
071400        MOVE AR021-ACCOUNT-NUMBER-4-7                             07146099
071500                                 TO DL-ACCOUNT-NUMBER-4-7         07147099
071600        MOVE AR021-ACCOUNT-NUMBER-8-10                            07148099
071700                                 TO DL-ACCOUNT-NUMBER-8-10        07149099
P1043      ELSE                                                         07149199
P1043         MOVE AR021-BIN-NUMBER   TO DL-BIN-NUMBER                  07149299
071200        MOVE AR021-ACCOUNT-NUMBER-1-3                             07149399
071300                                 TO DL-ACCOUNT-NUMBER-1-3         07149499
071400        MOVE AR021-ACCOUNT-NUMBER-4-7                             07149599
071500                                 TO DL-ACCOUNT-NUMBER-4-7         07149699
071600        MOVE AR021-ACCOUNT-NUMBER-8-10                            07149799
071700                                 TO DL-ACCOUNT-NUMBER-8-10        07149899
P1043      END-IF.                                                      07149999
071800     MOVE AR021-CARD-LEVEL-OF-ISSUE                               07210000
071900                                 TO DL-CARD-LEVEL-OF-ISSUE.       07220000
072000     MOVE AR021-STORE-NO         TO DL-STORE-NO.                  07230000
072100     MOVE AR021-POS-ID           TO DL-TERM-NUMBER.               07240000
072200     MOVE AR021-REF-NO           TO DL-TRANS-NUMBER.              07250000
072300     MOVE AR021-TRANS-TYPE       TO DL-TRANSACTION-CODE.          07260000
072400     MOVE AR021-AMOUNT           TO DL-TRANSACTION-AMOUNT.        07270000
072500                                                                  07280000
072600     WRITE CA-CR-ACTIVITY-REPORT-RECORD                           07290000
072700         FROM DL-DETAIL-LINE                                      07300000
072800         AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  07310000
072900                                                                  07320000
073400     ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT.                       07330000
073500     MOVE 1 TO PV-ADVANCE-COUNT.                                  07340000
073600     MOVE PC-ADVANCE-1-LINE TO PV-CONTROL-CHARACTER.              07350000
073700                                                                  07360000
073900 SKIP1                                                            07380000
074000******************************************************************07390000
074100*    PRINT THE KOHLS CREDIT ACTIVITY SUMMARY REPORT AND A        *07400000
074200*    MICROFICHE TAPE COPY OF THE REPORT                          *07410000
074300******************************************************************07420000
074400 5000-PRINT-ACTIVITY-SUMMARY.                                     07430000
074500     INITIALIZE                  PV-PAGE-COUNT.                   07440000
074600     MOVE PC-63                  TO PV-LINE-COUNT.                07450000
074700     MOVE PC-2                   TO DP132O-REPORT-NUMBER.         07460000
074800                                                                  07470000
074900     PERFORM VARYING ST-SUMMARY-INDEX FROM 1 BY 1                 07480000
075000         UNTIL ST-SUMMARY-INDEX > PC-MAXIMUM-SUMMARY-LINES        07490000
075100         INITIALIZE SL-SUMMARY-LINE                               07500000
075500         SET PS-PRINT            TO TRUE                          07510000
075600         EVALUATE TRUE                                            07520000
075700             WHEN ST-SUMMARY-INDEX = 1                            07530000
075800                 MOVE PC-3       TO PV-ADVANCE-LINES              07540000
076110                 MOVE PC-POS     TO SL-TRANS-STORE-SUFFIX-DESC    07550000
076300                 MOVE AR004-TRANS-STORE-SLS-CD                    07560000
076400                                 TO SL-TRANS-CODE                 07570000
076600                 MOVE AR004-TRANS-STORE-SLS-DS                    07580000
076700                                 TO SL-TRANS-TYPE-DESCRIPTION     07590000
077100             WHEN ST-SUMMARY-INDEX = 2                            07600000
077200                 MOVE PC-1       TO PV-ADVANCE-LINES              07610000
077500                 MOVE AR004-TRANS-STORE-RET-CD                    07620000
077600                                 TO SL-TRANS-CODE                 07630000
077800                 MOVE AR004-TRANS-STORE-RET-DS                    07640000
077900                                 TO SL-TRANS-TYPE-DESCRIPTION     07650000
078300             WHEN ST-SUMMARY-INDEX = 3                            07660000
078400                 MOVE PC-1       TO PV-ADVANCE-LINES              07670000
078700                 MOVE AR004-TRANS-STORE-PAYMENT-CD                07680000
078800                                 TO SL-TRANS-CODE                 07690000
079000                 MOVE AR004-TRANS-STORE-PAYMENT-DS                07700000
079100                                 TO SL-TRANS-TYPE-DESCRIPTION     07710000
079500             WHEN ST-SUMMARY-INDEX = 4                            07720000
079600                 MOVE PC-1       TO PV-ADVANCE-LINES              07730000
079900                 MOVE AR004-TRANS-DEBIT-ADJ-CD                    07740000
080000                                 TO SL-TRANS-CODE                 07750000
080100                 MOVE AR004-TRANS-DEBIT-ADJ-DS                    07760000
080200                                 TO SL-TRANS-TYPE-DESCRIPTION     07770000
080300             WHEN ST-SUMMARY-INDEX = 5                            07780000
080400                 MOVE PC-1       TO PV-ADVANCE-LINES              07790000
080700                 MOVE AR004-TRANS-SLS-AUD-RET-ADJ-CD              07800000
080800                                 TO SL-TRANS-CODE                 07810000
080900                 MOVE AR004-TRANS-SLS-AUD-RET-ADJ-DS              07820000
081000                                 TO SL-TRANS-TYPE-DESCRIPTION     07830000
081100             WHEN ST-SUMMARY-INDEX = 6                            07840000
081200                 MOVE PC-1       TO PV-ADVANCE-LINES              07850000
081500                 MOVE AR004-TRANS-SA-PAY-CR-ADJ-CD                07860000
081600                                 TO SL-TRANS-CODE                 07870000
081700                 MOVE AR004-TRANS-SA-PAY-CR-ADJ-DS                07880000
081800                                 TO SL-TRANS-TYPE-DESCRIPTION     07890000
081900             WHEN ST-SUMMARY-INDEX = 7                            07900000
082000                 MOVE PC-1       TO PV-ADVANCE-LINES              07910000
082300                 MOVE AR004-TRANS-CREDIT-ADJ-CD                   07920000
082400                                 TO SL-TRANS-CODE                 07930000
082500                 MOVE AR004-TRANS-CREDIT-ADJ-DS                   07940000
082600                                 TO SL-TRANS-TYPE-DESCRIPTION     07950000
082700             WHEN ST-SUMMARY-INDEX = 8                            07960000
082800                 MOVE PC-1       TO PV-ADVANCE-LINES              07970000
083100                 MOVE AR004-TRANS-SLS-AUD-SLS-ADJ-CD              07980000
083200                                 TO SL-TRANS-CODE                 07990000
083300                 MOVE AR004-TRANS-SLS-AUD-SLS-ADJ-DS              08000000
083400                                 TO SL-TRANS-TYPE-DESCRIPTION     08010000
083500             WHEN ST-SUMMARY-INDEX = 9                            08020000
083600                 MOVE PC-1       TO PV-ADVANCE-LINES              08030000
083900                 MOVE AR004-TRANS-EMPL-DISC-SLS-CD                08040000
084000                                 TO SL-TRANS-CODE                 08050000
084200                 MOVE AR004-TRANS-EMPL-DISC-SLS-DS                08060000
084300                                 TO SL-TRANS-TYPE-DESCRIPTION     08070000
084700             WHEN ST-SUMMARY-INDEX = 10                           08080000
084800                 MOVE PC-1       TO PV-ADVANCE-LINES              08090000
085100                 MOVE AR004-TRANS-SA-EMP-DIS-SL-CD                08100000
085200                                 TO SL-TRANS-CODE                 08110000
085300                 MOVE AR004-TRANS-SA-EMP-DIS-SL-DS                08120000
085400                                 TO SL-TRANS-TYPE-DESCRIPTION     08130000
085500             WHEN ST-SUMMARY-INDEX = 11                           08140000
085600                 MOVE PC-1       TO PV-ADVANCE-LINES              08150000
085900                 MOVE AR004-TRANS-EMPL-DISC-RET-CD                08160000
086000                                 TO SL-TRANS-CODE                 08170000
086200                 MOVE AR004-TRANS-EMPL-DISC-RET-DS                08180000
086300                                 TO SL-TRANS-TYPE-DESCRIPTION     08190000
086700             WHEN ST-SUMMARY-INDEX = 12                           08200000
086800                 MOVE PC-1       TO PV-ADVANCE-LINES              08210000
087100                 MOVE AR004-TRANS-SA-EMP-DIS-RT-CD                08220000
087200                                 TO SL-TRANS-CODE                 08230000
087300                 MOVE AR004-TRANS-SA-EMP-DIS-RT-DS                08240000
087400                                 TO SL-TRANS-TYPE-DESCRIPTION     08250000
EVM001             WHEN ST-SUMMARY-INDEX = 13                           08260000
EVM001                 MOVE PC-1       TO PV-ADVANCE-LINES              08270000
EVM001                 MOVE AR004-TRANS-LATE-VOID-CD                    08280000
EVM001                                 TO SL-TRANS-CODE                 08290000
EVM001                 MOVE AR004-TRANS-LATE-VOID-DS                    08300000
EVM001                                 TO SL-TRANS-TYPE-DESCRIPTION     08310000
EVM001                                                                  08320000
EVM001             WHEN ST-SUMMARY-INDEX = 14                           08330000
087600                 IF (ST-TRANSACTION-COUNT                         08340000
087700                         (ST-SUMMARY-INDEX) > 0 AND               08350000
087800                     ST-TOT-TRANSACTION-AMOUNT                    08360000
087900                         (ST-SUMMARY-INDEX) > 0)                  08370000
088000                     MOVE PC-1   TO PV-ADVANCE-LINES              08380000
088300                     MOVE SPACES TO SL-TRANS-CODE                 08390000
088400                     MOVE AR004-TRANS-OTHER-DS                    08400000
088500                                 TO SL-TRANS-TYPE-DESCRIPTION     08410000
088600                 ELSE                                             08420000
088700                     SET PS-DO-NOT-PRINT                          08430000
088800                                 TO TRUE                          08440000
088900                 END-IF                                           08450000
EVM001             WHEN ST-SUMMARY-INDEX = 15                           08460000
089100                 MOVE PC-2       TO PV-ADVANCE-LINES              08470000
089400                 MOVE PC-POS-SUBTOTAL                             08480000
089500                                 TO SL-TRANS-STORE-SUFFIX-DESC    08490000
089600                 MOVE SPACES     TO SL-TRANS-CODE                 08500000
089700                 MOVE SPACES     TO SL-TRANS-TYPE-DESCRIPTION     08510000
EVM001             WHEN ST-SUMMARY-INDEX = 16                           08520000
089900                 MOVE PC-2       TO PV-ADVANCE-LINES              08530000
090200                 MOVE PC-MAINTENANCE                              08540000
090310                                 TO SL-TRANS-STORE-SUFFIX-DESC    08550000
090500                 MOVE AR004-TRANS-STORE-SLS-CD                    08560000
090600                                 TO SL-TRANS-CODE                 08570000
090800                 MOVE AR004-TRANS-STORE-SLS-DS                    08580000
090900                                 TO SL-TRANS-TYPE-DESCRIPTION     08590000
EVM001             WHEN ST-SUMMARY-INDEX = 17                           08600000
091400                 MOVE PC-1       TO PV-ADVANCE-LINES              08610000
091700                 MOVE AR004-TRANS-STORE-RET-CD                    08620000
091800                                 TO SL-TRANS-CODE                 08630000
092000                 MOVE AR004-TRANS-STORE-RET-DS                    08640000
092100                                 TO SL-TRANS-TYPE-DESCRIPTION     08650000
EVM001             WHEN ST-SUMMARY-INDEX = 18                           08660000
092600                 MOVE PC-1       TO PV-ADVANCE-LINES              08670000
092900                 MOVE AR004-TRANS-STORE-PAYMENT-CD                08680000
093000                                 TO SL-TRANS-CODE                 08690000
093200                 MOVE AR004-TRANS-STORE-PAYMENT-DS                08700000
093300                                 TO SL-TRANS-TYPE-DESCRIPTION     08710000
EVM001             WHEN ST-SUMMARY-INDEX = 19                           08720000
093800                 MOVE PC-1       TO PV-ADVANCE-LINES              08730000
094100                 MOVE AR004-TRANS-DEBIT-ADJ-CD                    08740000
094200                                 TO SL-TRANS-CODE                 08750000
094400                 MOVE AR004-TRANS-DEBIT-ADJ-DS                    08760000
094500                                 TO SL-TRANS-TYPE-DESCRIPTION     08770000
EVM001             WHEN ST-SUMMARY-INDEX = 20                           08780000
095000                 MOVE PC-1       TO PV-ADVANCE-LINES              08790000
095300                 MOVE AR004-TRANS-SLS-AUD-RET-ADJ-CD              08800000
095400                                 TO SL-TRANS-CODE                 08810000
095600                 MOVE AR004-TRANS-SLS-AUD-RET-ADJ-DS              08820000
095700                                 TO SL-TRANS-TYPE-DESCRIPTION     08830000
EVM001             WHEN ST-SUMMARY-INDEX = 21                           08840000
096200                 MOVE PC-1       TO PV-ADVANCE-LINES              08850000
096500                 MOVE AR004-TRANS-SA-PAY-CR-ADJ-CD                08860000
096600                                 TO SL-TRANS-CODE                 08870000
096800                 MOVE AR004-TRANS-SA-PAY-CR-ADJ-DS                08880000
096900                                 TO SL-TRANS-TYPE-DESCRIPTION     08890000
EVM001             WHEN ST-SUMMARY-INDEX = 22                           08900000
097400                 MOVE PC-1       TO PV-ADVANCE-LINES              08910000
097700                 MOVE AR004-TRANS-CREDIT-ADJ-CD                   08920000
097800                                 TO SL-TRANS-CODE                 08930000
098000                 MOVE AR004-TRANS-CREDIT-ADJ-DS                   08940000
098100                                 TO SL-TRANS-TYPE-DESCRIPTION     08950000
EVM001             WHEN ST-SUMMARY-INDEX = 23                           08960000
098600                 MOVE PC-1       TO PV-ADVANCE-LINES              08970000
098900                 MOVE AR004-TRANS-SLS-AUD-SLS-ADJ-CD              08980000
099000                                 TO SL-TRANS-CODE                 08990000
099200                 MOVE AR004-TRANS-SLS-AUD-SLS-ADJ-DS              09000000
099300                                 TO SL-TRANS-TYPE-DESCRIPTION     09010000
EVM001             WHEN ST-SUMMARY-INDEX = 24                           09020000
099800                 MOVE PC-1       TO PV-ADVANCE-LINES              09030000
100100                 MOVE AR004-TRANS-EMPL-DISC-SLS-CD                09040000
100200                                 TO SL-TRANS-CODE                 09050000
100400                 MOVE AR004-TRANS-EMPL-DISC-SLS-DS                09060000
100500                                 TO SL-TRANS-TYPE-DESCRIPTION     09070000
EVM001             WHEN ST-SUMMARY-INDEX = 25                           09080000
101000                 MOVE PC-1       TO PV-ADVANCE-LINES              09090000
101300                 MOVE AR004-TRANS-SA-EMP-DIS-SL-CD                09100000
101400                                 TO SL-TRANS-CODE                 09110000
101600                 MOVE AR004-TRANS-SA-EMP-DIS-SL-DS                09120000
101700                                 TO SL-TRANS-TYPE-DESCRIPTION     09130000
EVM001             WHEN ST-SUMMARY-INDEX = 26                           09140000
102200                 MOVE PC-1       TO PV-ADVANCE-LINES              09150000
102500                 MOVE AR004-TRANS-EMPL-DISC-RET-CD                09160000
102600                                 TO SL-TRANS-CODE                 09170000
102800                 MOVE AR004-TRANS-EMPL-DISC-RET-DS                09180000
102900                                 TO SL-TRANS-TYPE-DESCRIPTION     09190000
EVM001             WHEN ST-SUMMARY-INDEX = 27                           09200000
103400                 MOVE PC-1       TO PV-ADVANCE-LINES              09210000
103700                 MOVE AR004-TRANS-SA-EMP-DIS-RT-CD                09220000
103800                                 TO SL-TRANS-CODE                 09230000
104000                 MOVE AR004-TRANS-SA-EMP-DIS-RT-DS                09240000
104100                                 TO SL-TRANS-TYPE-DESCRIPTION     09250000
EVM001             WHEN ST-SUMMARY-INDEX = 29                           09260000
104600                 IF (ST-TRANSACTION-COUNT                         09270000
104700                         (ST-SUMMARY-INDEX) > 0 AND               09280000
104800                     ST-TOT-TRANSACTION-AMOUNT                    09290000
104900                         (ST-SUMMARY-INDEX) > 0)                  09300000
105000                     MOVE PC-1   TO PV-ADVANCE-LINES              09310000
105300                     MOVE SPACES TO SL-TRANS-CODE                 09320000
105400                     MOVE AR004-TRANS-OTHER-DS                    09330000
105500                                 TO SL-TRANS-TYPE-DESCRIPTION     09340000
105600                 ELSE                                             09350000
105700                     SET PS-DO-NOT-PRINT                          09360000
105800                                 TO TRUE                          09370000
105900                 END-IF                                           09380000
EVM001             WHEN ST-SUMMARY-INDEX = 30                           09390000
106100                 MOVE PC-2       TO PV-ADVANCE-LINES              09400000
106400                 MOVE PC-MAINTENANCE-SUBTOTAL                     09410000
106500                                 TO SL-TRANS-STORE-SUFFIX-DESC    09420000
106600                 MOVE SPACES     TO SL-TRANS-CODE                 09430000
106700                 MOVE SPACES     TO SL-TRANS-TYPE-DESCRIPTION     09440000
EVM001             WHEN ST-SUMMARY-INDEX = 31                           09450000
106900                 IF (ST-TRANSACTION-COUNT                         09460000
107000                         (ST-SUMMARY-INDEX) > 0 AND               09470000
107100                     ST-TOT-TRANSACTION-AMOUNT                    09480000
107200                         (ST-SUMMARY-INDEX) > 0)                  09490000
107300                     MOVE PC-2   TO PV-ADVANCE-LINES              09500000
107600                     MOVE PC-NON-POS-MNT-STR-SFX                  09510000
107700                                 TO SL-TRANS-STORE-SUFFIX-DESC    09520000
107800                     MOVE SPACES TO SL-TRANS-CODE                 09530000
107900                                    SL-TRANS-TYPE-DESCRIPTION     09540000
108000                 ELSE                                             09550000
108100                     SET PS-DO-NOT-PRINT                          09560000
108200                                 TO TRUE                          09570000
108300                 END-IF                                           09580000
EVM001             WHEN ST-SUMMARY-INDEX = 32                           09590000
108500                 MOVE PC-3       TO PV-ADVANCE-LINES              09600000
108800                 MOVE PC-TOT-BY-TRANS-TYPE                        09610000
108900                                 TO SL-TRANS-STORE-SUFFIX-DESC    09620000
109000                 MOVE AR004-TRANS-STORE-SLS-CD                    09630000
109100                                 TO SL-TRANS-CODE                 09640000
109200                 MOVE AR004-TRANS-STORE-SLS-DS                    09650000
109300                                 TO SL-TRANS-TYPE-DESCRIPTION     09660000
EVM001             WHEN ST-SUMMARY-INDEX = 33                           09670000
109500                 MOVE PC-1       TO PV-ADVANCE-LINES              09680000
109800                 MOVE AR004-TRANS-STORE-RET-CD                    09690000
109900                                 TO SL-TRANS-CODE                 09700000
110000                 MOVE AR004-TRANS-STORE-RET-DS                    09710000
110100                                 TO SL-TRANS-TYPE-DESCRIPTION     09720000
EVM001             WHEN ST-SUMMARY-INDEX = 34                           09730000
110300                 MOVE PC-1       TO PV-ADVANCE-LINES              09740000
110600                 MOVE AR004-TRANS-STORE-PAYMENT-CD                09750000
110700                                 TO SL-TRANS-CODE                 09760000
110800                 MOVE AR004-TRANS-STORE-PAYMENT-DS                09770000
110900                                 TO SL-TRANS-TYPE-DESCRIPTION     09780000
EVM001             WHEN ST-SUMMARY-INDEX = 35                           09790000
111100                 MOVE PC-1       TO PV-ADVANCE-LINES              09800000
111400                 MOVE AR004-TRANS-DEBIT-ADJ-CD                    09810000
111500                                 TO SL-TRANS-CODE                 09820000
111600                 MOVE AR004-TRANS-DEBIT-ADJ-DS                    09830000
111700                                 TO SL-TRANS-TYPE-DESCRIPTION     09840000
EVM001             WHEN ST-SUMMARY-INDEX = 36                           09850000
111900                 MOVE PC-1       TO PV-ADVANCE-LINES              09860000
112200                 MOVE AR004-TRANS-SLS-AUD-RET-ADJ-CD              09870000
112300                                 TO SL-TRANS-CODE                 09880000
112400                 MOVE AR004-TRANS-SLS-AUD-RET-ADJ-DS              09890000
112500                                 TO SL-TRANS-TYPE-DESCRIPTION     09900000
EVM001             WHEN ST-SUMMARY-INDEX = 37                           09910000
112700                 MOVE PC-1       TO PV-ADVANCE-LINES              09920000
113000                 MOVE AR004-TRANS-SA-PAY-CR-ADJ-CD                09930000
113100                                 TO SL-TRANS-CODE                 09940000
113200                 MOVE AR004-TRANS-SA-PAY-CR-ADJ-DS                09950000
113300                                 TO SL-TRANS-TYPE-DESCRIPTION     09960000
EVM001             WHEN ST-SUMMARY-INDEX = 38                           09970000
113500                 MOVE PC-1       TO PV-ADVANCE-LINES              09980000
113800                 MOVE AR004-TRANS-CREDIT-ADJ-CD                   09990000
113900                                 TO SL-TRANS-CODE                 10000000
114000                 MOVE AR004-TRANS-CREDIT-ADJ-DS                   10010000
114100                                 TO SL-TRANS-TYPE-DESCRIPTION     10020000
EVM001             WHEN ST-SUMMARY-INDEX = 39                           10030000
114300                 MOVE PC-1       TO PV-ADVANCE-LINES              10040000
114600                 MOVE AR004-TRANS-SLS-AUD-SLS-ADJ-CD              10050000
114700                                 TO SL-TRANS-CODE                 10060000
114800                 MOVE AR004-TRANS-SLS-AUD-SLS-ADJ-DS              10070000
114900                                 TO SL-TRANS-TYPE-DESCRIPTION     10080000
EVM001             WHEN ST-SUMMARY-INDEX = 40                           10090000
115100                 MOVE PC-1       TO PV-ADVANCE-LINES              10100000
115200                 MOVE PC-ADVANCE-1-LINE                           10110000
115500                                 TO SL-TRANS-CODE                 10120000
115600                 MOVE AR004-TRANS-EMPL-DISC-SLS-DS                10130000
115700                                 TO SL-TRANS-TYPE-DESCRIPTION     10140000
EVM001             WHEN ST-SUMMARY-INDEX = 41                           10150000
115900                 MOVE PC-1       TO PV-ADVANCE-LINES              10160000
116200                 MOVE AR004-TRANS-SA-EMP-DIS-SL-CD                10170000
116300                                 TO SL-TRANS-CODE                 10180000
116400                 MOVE AR004-TRANS-SA-EMP-DIS-SL-DS                10190000
116500                                 TO SL-TRANS-TYPE-DESCRIPTION     10200000
EVM001             WHEN ST-SUMMARY-INDEX = 42                           10210000
116700                 MOVE PC-1       TO PV-ADVANCE-LINES              10220000
117000                 MOVE AR004-TRANS-EMPL-DISC-RET-CD                10230000
117100                                 TO SL-TRANS-CODE                 10240000
117200                 MOVE AR004-TRANS-EMPL-DISC-RET-DS                10250000
117300                                 TO SL-TRANS-TYPE-DESCRIPTION     10260000
EVM001             WHEN ST-SUMMARY-INDEX = 43                           10270000
117500                 MOVE PC-1       TO PV-ADVANCE-LINES              10280000
117800                 MOVE AR004-TRANS-SA-EMP-DIS-RT-CD                10290000
117900                                 TO SL-TRANS-CODE                 10300000
118000                 MOVE AR004-TRANS-SA-EMP-DIS-RT-DS                10310000
118100                                 TO SL-TRANS-TYPE-DESCRIPTION     10320000
118200             WHEN ST-SUMMARY-INDEX = 44                           10330000
EVM001                 MOVE PC-1       TO PV-ADVANCE-LINES              10340000
EVM001                 MOVE AR004-TRANS-LATE-VOID-CD                    10350000
EVM001                                 TO SL-TRANS-CODE                 10360000
EVM001                 MOVE AR004-TRANS-LATE-VOID-DS                    10370000
EVM001                                 TO SL-TRANS-TYPE-DESCRIPTION     10380000
EVM001             WHEN ST-SUMMARY-INDEX = 45                           10390000
118300                 MOVE PC-3       TO PV-ADVANCE-LINES              10400000
118600                 MOVE PC-NET-TOTALS                               10410000
118700                                 TO SL-TRANS-STORE-SUFFIX-DESC    10420000
118800                 MOVE SPACES     TO SL-TRANS-CODE                 10430000
118900                 MOVE PC-NET-DAILY-ACTIVITY                       10440000
119000                                 TO SL-TRANS-TYPE-DESCRIPTION     10450000
119100         END-EVALUATE                                             10460000
119200         MOVE ST-TRANSACTION-COUNT (ST-SUMMARY-INDEX)             10470000
119300                                 TO SL-TRANSACTION-COUNT          10480000
119400         MOVE ST-TOT-TRANSACTION-AMOUNT (ST-SUMMARY-INDEX)        10490000
119500                                 TO SL-TOT-TRANSACTION-AMOUNT     10500000
119600         IF PS-PRINT                                              10510000
119700             IF PV-LINE-COUNT > PC-PAGE-SIZE                      10520000
119800                 PERFORM 8300-PRINT-TITLE-LINES-RPT-2             10530000
120000             END-IF                                               10540000
120100             WRITE CA-CR-ACTIVITY-REPORT-RECORD                   10550000
120200                 FROM SL-SUMMARY-LINE                             10560000
120300                 AFTER ADVANCING PV-ADVANCE-LINES                 10570000
120400             ADD PV-ADVANCE-LINES                                 10580000
120500                                 TO PV-LINE-COUNT                 10590000
120900         END-IF                                                   10600000
121000     END-PERFORM.                                                 10610000
121001                                                                  10620000
121100 SKIP1                                                            10630000
P10237******************************************************************10744100
121300*    READ THE CREDIT POSTING FILE                                *10744200
121400******************************************************************10744300
121500 6000-READ-CR-POSTING-FILE.                                       10744400
121600     READ CR-POSTING-FILE                                         10745000
P10237         INTO SORT-WORK-RECORD                                    10746000
121800         AT END                                                   10747000
121900             SET PS-END-OF-CR-POSTING-FILE                        10748000
122000                                 TO TRUE                          10749000
P10237         NOT AT END                                               10749500
P10237             PERFORM 6100-PROCESS-RECORDS                         10749600
122100     END-READ.                                                    10749700
P10237                                                                  10749800
P10237 SKIP1                                                            10749900
P10237******************************************************************10750000
P10237* PROCESS THE RECORDS TO DETOKENIZE THE CARD NUMBER               10750100
P10237******************************************************************10750200
P10237 6100-PROCESS-RECORDS.                                            10750300
P10237                                                                  10750400
P10237     INITIALIZE PV-ACCT-LEN.                                      10750599
P10237                                                                  10750799
P10237     IF SR-BIN-NUMBER = SPACES                                    10750899
P10237        INSPECT FUNCTION REVERSE(SR-ACCOUNT-NUMBER-10)            10750999
P10237            TALLYING PV-ACCT-LEN FOR LEADING SPACES               10751099
P10237        COMPUTE PV-ACCT-LEN  = 10 - PV-ACCT-LEN                   10751199
P10237        IF SR-ACCOUNT-NUMBER-10 = SPACES OR PV-ACCT-LEN < 7       10751299
P10237           CONTINUE                                               10751399
P10237        ELSE                                                      10751499
P10237           SET PS-ACCT     TO TRUE                                10751599
P10237           PERFORM 6110-DETOKENIZE-ACCT                           10751699
P10237           MOVE DP031-CLEAR-TEXT TO SR-ACCOUNT-NUMBER-12          10751799
P10237        END-IF                                                    10751899
P10237     ELSE                                                         10751999
P10237**DETOKENIZING APPLE PAY CARD NUMBER                              10752099
P10237        MOVE SR-BIN-NUMBER        TO PV-ACCT-NBR-16(1:6)          10752199
P10237        MOVE SR-ACCOUNT-NUMBER-10 TO PV-ACCT-NBR-16(7:10)         10752299
P10237        INSPECT FUNCTION REVERSE(PV-ACCT-NBR-16)                  10752399
P10237            TALLYING PV-ACCT-LEN FOR LEADING SPACES               10752499
P10237        COMPUTE PV-ACCT-LEN = 16 - PV-ACCT-LEN                    10752599
P10237        IF PV-ACCT-LEN < 7                                        10752699
P10237           CONTINUE                                               10752799
P10237        ELSE                                                      10752899
P10237           SET PS-BIN-ACCT TO TRUE                                10752999
P10237           PERFORM 6110-DETOKENIZE-ACCT                           10753099
P10237           MOVE DP031-CLEAR-TEXT  TO SR-BINACCT-NBR               10753199
P10237        END-IF                                                    10753299
P10237     END-IF.                                                      10753399
P10237                                                                  10753499
P10237     RELEASE SORT-WORK-RECORD.                                    10753599
P10237     ADD +1 TO PV-RECORDS-INTO-SORT.                              10753699
P10237                                                                  10753799
P10237 SKIP1                                                            10753899
P10237******************************************************************10753999
P10237* CALLS THE PROTEGRITY MODULE TO DETOKENIZE THE CARD NUMBER.      10754099
P10237******************************************************************10754199
P10237 6110-DETOKENIZE-ACCT.                                            10754299
P10237                                                                  10754399
P10237     INITIALIZE DP031-PROTEG-PGM-PARAMETERS                       10754499
P10237                CSI-PARAMETERS.                                   10754599
P10237                                                                  10754699
P10237     EVALUATE TRUE                                                10754799
P10237         WHEN PS-ACCT                                             10754899
P10237           MOVE SR-ACCOUNT-NUMBER-12 TO DP031-CIPHER-TEXT         10754999
P10237           MOVE 12                   TO DP031-INPUT-LEN           10755099
P10237         WHEN PS-BIN-ACCT                                         10755199
P10237           MOVE SR-BINACCT-NBR       TO DP031-CIPHER-TEXT         10755299
P10237           MOVE 18                   TO DP031-INPUT-LEN           10755399
P10237     END-EVALUATE.                                                10755499
P10237                                                                  10755599
P10237     MOVE 'ACCOUNT-NUMBER'          TO DP031-FIELD.               10755699
P10237     SET CSI-DECRYPT-FUNCTION       TO TRUE.                      10755799
P10237     SET DP031-ACCTNBR              TO TRUE.                      10755899
P10237     PERFORM DP031-0000-PROTG-TOKEN-DETOKEN.                      10755999
P10237     IF CSI-RETURN-CODE NOT = ZERO                                10756099
P10237        DISPLAY 'STORE NBR      : '    SR-STORE-NO                10756199
P10237        DISPLAY 'REGISTER ID    : '    SR-POS-ID                  10756299
P10237        DISPLAY 'TRANS NBR      : '    SR-REF-NO                  10756399
P10237        DISPLAY 'ACCOUNT NBR    : '    SR-BINACCT-NBR             10756499
P10237        PERFORM DP031-9999-ABEND                                  10756599
P10237     END-IF.                                                      10756799
P10237                                                                  10756899
122200 SKIP1                                                            10756999
122300******************************************************************10757099
122400*    PRINT TITLE LINES - KOHLS CREDIT ACTIVITY DETAIL REPORT     *10760000
122500******************************************************************10770000
122600 8100-PRINT-TITLE-LINES-RPT-1.                                    10780000
122700     ADD 1                       TO PV-PAGE-COUNT.                10790000
122800     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           10800000
122900     WRITE CA-CR-ACTIVITY-REPORT-RECORD                           10810000
123000         FROM DP132O-STANDRD-HEADER-132-COLS                      10820000
123100         AFTER ADVANCING PAGE.                                    10830000
123200     WRITE CA-CR-ACTIVITY-REPORT-RECORD                           10840000
123300         FROM HL2-HEADING-LINE-2                                  10850000
123400         AFTER ADVANCING 2 LINE.                                  10860000
123500     WRITE CA-CR-ACTIVITY-REPORT-RECORD                           10870000
123600         FROM HL3-HEADING-LINE-3                                  10880000
123700         AFTER ADVANCING 2 LINES.                                 10890000
123800     WRITE CA-CR-ACTIVITY-REPORT-RECORD                           10900000
123900         FROM HL4-HEADING-LINE-4                                  10910000
124000         AFTER ADVANCING 1 LINE.                                  10920000
124100                                                                  10930000
124200     MOVE 6                      TO PV-LINE-COUNT.                10940000
124300     MOVE 2                      TO PV-ADVANCE-COUNT.             10950000
124400 SKIP1                                                            10960000
127000******************************************************************10970000
127100*    PRINT TITLE LINES - KOHLS CREDIT ACTIVITY SUMMARY REPORT    *10980000
127200******************************************************************10990000
127300 8300-PRINT-TITLE-LINES-RPT-2.                                    11000000
127400     ADD 1                       TO PV-PAGE-COUNT.                11010000
127500     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           11020000
127600     WRITE CA-CR-ACTIVITY-REPORT-RECORD                           11030000
127700         FROM DP132O-STANDRD-HEADER-132-COLS                      11040000
127800         AFTER ADVANCING PAGE.                                    11050000
127900     WRITE CA-CR-ACTIVITY-REPORT-RECORD                           11060000
128000         FROM HL5-HEADING-LINE-5                                  11070000
128100         AFTER ADVANCING 2 LINE.                                  11080000
128200     WRITE CA-CR-ACTIVITY-REPORT-RECORD                           11090000
128300         FROM HL6-HEADING-LINE-6                                  11100000
128400         AFTER ADVANCING 2 LINES.                                 11110000
128500                                                                  11120000
128600     MOVE 5                      TO PV-LINE-COUNT.                11130000
128700 SKIP1                                                            11140000
132200******************************************************************11150000
132300*    CLOSE FILES                                                 *11160000
132400******************************************************************11170000
132500 9000-CLOSE-FILES.                                                11180000
132600     CLOSE CR-POSTING-FILE                                        11190000
132800           CR-ACTIVITY-REPORT-FILE.                               11200000
133000 SKIP1                                                            11210000
133100******************************************************************11220000
133200*    9999-ABEND - PERFORMS A NON-SQL-ABEND                       *11230000
133300******************************************************************11240000
133400 9999-ABEND.                                                      11250000
133500     DISPLAY '** ABEND           **'.                             11260000
133600     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  11270000
133700     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        11280000
133800     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       11290000
133900     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       11300000
134000     CALL 'ILBOABN0' USING ABEND-CODE.                            11310000
P10237******************************************************************11320000
P10237* COPY MEMBER DPPD031 CONTAINS STATEMENTS NEEDED TO INVOKE        11330099
P10237* PROTEGRITY MODULE FOR PROTECTION / UNPROTECTION                 11340099
P10237******************************************************************11350000
P10237     COPY DPPD031.                                                11360099
P10237                                                                  11370000
