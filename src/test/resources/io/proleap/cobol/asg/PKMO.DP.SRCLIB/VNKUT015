000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    VNKUT015.                                         00020000
000300 AUTHOR.        MIKE BESKE.                                       00030000
000400 DATE-WRITTEN.  MARCH 2002.                                       00040000
000500***************************************************************** 00050000
000600*               COBOL WITH DB2                                  * 00060000
000700***************************************************************** 00070000
000800*     VENDOR DATA EXTRACT FOR BUSINESS CONTINUITY PROGRAM       * 00080000
000900***************************************************************** 00090000
001000*  PURPOSE: TO CREATE AN EXTRACT OF VENDOR DATA TO BE LOADED    * 00100000
001100*           INTO A SOFTWARE PACKAGE THAT WILL BE USED TO TRACK/ * 00110000
001200*           THIS EXTRACT WILL BUILD A FILE OF ALL ACTIVE VENDORS* 00120000
001300*           IN THE VENDOR DATABASE, WITH THE EXCEPTION OF       * 00130000
001400*           EMPLOYEES.  THE DATA BEING EXTRACTED IS INTENDED TO * 00140000
001500*           FACILITATE DECIDING WHICH VENDORS TO CONTACT AND HOW* 00150000
001600*           TO CONTACT THEM, SO IT INCLUDES ADDRESSES PHONE     * 00160000
001700*           NUMBERS, CONTACT PERSONS AND INFORMATION REGARDING  * 00170000
001800*           THE PRODUCTS OR SERVICES THAT THE VENDOR PROVIDES.  * 00180000
001900***************************************************************** 00190000
002000*                                                               * 00200000
002100*                                                               * 00210000
002200*                                                               * 00220000
002300*  DB2 TABLES:  TENTREP                                         * 00230000
002400*               TBUSLOC                                         * 00240000
002500*               TBUSFNC                                         * 00250000
002600*               TVNDDPT                                         * 00260000
002700*               TMDSEAR                                         * 00270000
002800*               TORGUNT                                         * 00280000
002900*                                                               * 00290000
003000*   INPUT: 1) VENDOR EXTEACT FILE                 (VNRD010)     * 00300000
003100*  OUTPUT: 1) VENDOR EXTRACT FILE                 (VNRD005)     * 00310000
003200*          2) EXCEPTION REPORT                                  * 00320000
003300*                                                               * 00330000
003400***************************************************************** 00340000
003500* MAINTENANCE LOG:                                              * 00350000
003600*                                                               * 00360000
003700* 03/05/2002                                                    * 00370000
003800*   CHANGE  MADE: INITIAL VERSION.                                00380000
003900* MADE BY: MIKE BESKE                      WR/PITS: WR24481     * 00390000
004000*                                                               * 00400000
004100* 03/31/2003                                                    * 00410000
004200*   CHANGE  MADE: ADDED FI_VOUCHER IN ORDER TO CHECK FOR ANY    * 00420000
004300*   VOUCHERS THAT HAVE BEEN CREATED IN THE LAST 3 YEARS FROM    * 00430000
004400*   THE RUNDATE WHEN THE PROGRAM IS RUN.                        * 00440000
004500* MADE BY: MIKE BESKE                      WR/PITS: WR24481     * 00450000
004600*                                                               * 00460000
004700*  DATE  04/12/2004                                              *00470000
004800*      CHANGE MADE: CHANGED SQL ACCESSING TMDSEAR TO INCLUDE     *00480000
004900*      A WHERE CONDITION 'AND CURRENT DATE BETWEEN STRT_DTE AND  *00490000
005000*      END_DTE'.  WITH THE ADDITION OF A THIRD GMM AND ALIGNING  *00500000
005100*      DEPTS ACCORDINGLY, THIS CONDITION IS NEEDED TO PREVENT    *00510000
005200*      MULTIPLE ROWS BEING RETURNED.                             *00520000
005300*      MADE BY: NANCY EILBES            WR/IR #: P000647632      *00530000
005400*                                                                *00540000
005500* DATE  12/02/2010                                                00550000
005600*     CHANGE MADE: MODIFIED SQL IN S400- BY ADDING A SUBSELECT    00560000
005700*     OF MAX(SEQ_NBR)ON TBUSLOC.  THIS CORRECTS A BUG WHERE EXP   00570000
005800*     VENDORS WERE NOT GETTING THEIR ADDRESSES EXTRACTED CORRECTLY00580000
005900*     IF THERE WAS MORE THAN ONE ADDRESS IN SPECFIC ADDRESS TYPE  00590000
006000*     CATEGORIES (IE, REMITTANCE).  REMOVED S450- PARAGRAPH BE-   00600000
006100*     CAUSE IT IS NO LONGER NEEDED.                               00610000
006200*     MADE BY: MIKE BESKE              WR/IR #: PKE000000006765   00620000
006300*                                                                 00630000
006400* DATE  01/04/2011                                                00640000
006500*     CHANGE MADE: MODIFIED CODE IN VARIOUS SECTIONS TO NOT USE   00650000
006600*     THE PS-ACTIVE-DEPTS-SW.  THE USE OF THIS WAS NOT PUTTING    00660000
006700*     ADDRESSES INTO THE OUTPUT FILE FOR A LARGE NUMBER OF        00670000
006800*     VENDORS.  LDRPS NEEDS TO HAVE ADDRESSES FOR THE VENDORS     00680000
006900*     TO BE EFFECTIVE.                                            00690000
007000*     MADE BY: MIKE BESKE              WR/IR #: PKE000000006765   00700000
007100*                                                                 00710000
007200* DATE  07/27/2011                                                00720000
007300*     CHANGE MADE:  MODIFIED CODE TO READ AN INPUT FILE OF        00730000
007400*     MERCHANDISE VENDORS AND 'RECENT ACTIVITY' EXPENSE           00740000
007500*     VENDORS.  REMOVED THE S900- PARAGRAPH TO CHECK FOR          00750000
007600*     ACTIVITY FOR UP TO THREE YEARS IN THE PAST FOR EXPENSE      00760000
007610*     VENDORS ASTHAT CALL MOVES TO VNKUT020 FOR THE               00770000
007800*     RE-PLATFORM.  THIS DATABASE CALL TO ORACLE HAS BEEN         00780000
007900*     MOVED TO A SEPARATE PROGRAM.  THIS PROGRAM HAS BEEN SPLIT   00790000
007910*     INTO VNKUT019 (GET VENDORS FROM LEGACY), VNKUT020 CALL      00791000
007920*     PEOPLESOFT FOR EXPENSE VENDORS) AND FINALLY VNKUT015.       00792000
008000*     MADE BY: ANIL BEDEKAR            WR/IR #: WR37038           00793000
008100***************************************************************** 00794000
008200 ENVIRONMENT DIVISION.                                            00795000
008300 CONFIGURATION SECTION.                                           00796000
008400 SOURCE-COMPUTER.        IBM-370.                                 00797000
008500 OBJECT-COMPUTER.        IBM-370.                                 00798000
008600                                                                  00799000
008700 INPUT-OUTPUT SECTION.                                            00800000
008800                                                                  00810000
008900 FILE-CONTROL.                                                    00820000
009000     SELECT VENDOR-INPUT-FILE        ASSIGN TO INP01.             00830000
009100     SELECT VENDOR-EXCPTION-FILE     ASSIGN TO OUT01.             00840000
009200     SELECT VENDOR-EXCEPTION-REPORT  ASSIGN TO RPT01.             00850000
009300                                                                  00860000
009400 DATA DIVISION.                                                   00870000
009500 FILE SECTION.                                                    00880000
009600                                                                  00890000
009700 FD  VENDOR-INPUT-FILE                                            00900000
009800     RECORDING MODE IS F                                          00910000
009900     LABEL RECORDS ARE STANDARD                                   00920000
010000     BLOCK CONTAINS 0 RECORDS                                     00930000
010100     RECORD CONTAINS 100 CHARACTERS                               00940000
010200     DATA RECORD IS VENDOR-EXTRACT-RECORD.                        00950000
010300                                                                  00960000
010400 01  VENDOR-EXTRACT-RECORD          PIC X(100).                   00970000
010500                                                                  00980000
010600 FD  VENDOR-EXCPTION-FILE                                         00990000
010700     RECORDING MODE IS F                                          01000000
010800     LABEL RECORDS ARE STANDARD                                   01010000
010900     BLOCK CONTAINS 0 RECORDS                                     01020000
011000     RECORD CONTAINS 784 CHARACTERS                               01030000
011100     DATA RECORD IS VENDOR-EXCEPTION-RECORD.                      01040000
011200                                                                  01050000
011300 01  VENDOR-EXCEPTION-RECORD          PIC X(784).                 01060000
011400                                                                  01070000
011500 FD  VENDOR-EXCEPTION-REPORT                                      01080000
011600     RECORDING MODE IS F                                          01090000
011700     LABEL RECORDS ARE STANDARD                                   01100000
011800     DATA RECORD IS VENDOR-EXCEPTION-RPT.                         01110000
011900                                                                  01120000
012000 01  VENDOR-EXCEPTION-RPT        PIC X(132).                      01130000
012100                                                                  01140000
012200 WORKING-STORAGE SECTION.                                         01150000
012300                                                                  01160000
012400 01  PROGRAM-SWITCHES.                                            01170000
012500     05  PS-END-OF-VENDOR-SW         PIC X(01)  VALUE 'Y'.        01180000
012600         88  MORE-VENDOR-FILE                   VALUE 'Y'.        01190000
012700         88  END-OF-VENDOR-FILE                 VALUE 'N'.        01200000
012800     05  PS-CONTINUE-PROCESSING-SW   PIC X(01)  VALUE 'Y'.        01210000
012900         88  PS-CONTINUE-PROCESSING             VALUE 'Y'.        01220000
013000         88  PS-DONT-CONTINUE-PROCESSING        VALUE 'N'.        01230000
013100     05  PS-RECENT-ACTIVITY-SW       PIC X(01)  VALUE 'N'.        01240000
013200         88  PS-RECENT-ACTIVITY                 VALUE 'Y'.        01250000
013300         88  PS-NO-RECENT-ACTIVITY              VALUE 'N'.        01260000
013400     05  PS-ACTIVE-DEPTS-SW          PIC X(01)  VALUE 'Y'.        01270000
013500         88  PS-ACT-DEPTS                       VALUE 'Y'.        01280000
013600         88  PS-NO-ACT-DEPTS                    VALUE 'N'.        01290000
013700     05  PS-ADDRESS-CONTENT-SW       PIC X(01)  VALUE 'Y'.        01300000
013800         88  PS-YES-ADDRESS-CONTENT             VALUE 'Y'.        01310000
013900         88  PS-NO-ADDRESS-CONTENT              VALUE 'N'.        01320000
014000     05  PS-CONTACT-CONTENT-SW       PIC X(01)  VALUE 'Y'.        01330000
014100         88  PS-YES-CONTACT-CONTENT             VALUE 'Y'.        01340000
014200         88  PS-NO-CONTACT-CONTENT              VALUE 'N'.        01350000
014300     05  PS-ADDRESS-FOUND-SW         PIC X(01)  VALUE ' '.        01360000
014400         88  PS-NULL-ADDRESS-FOUND              VALUE ' '.        01370000
014500         88  PS-ADDRESS-FOUND                   VALUE 'Y'.        01380000
014600         88  PS-NO-ADDRESS-FOUND                VALUE 'N'.        01390000
014700     05  PS-PRIM-CONTACT-FOUND-SW    PIC X(01)  VALUE ' '.        01400000
014800         88  PS-NULL-PRIM-CONTACT-FOUND         VALUE ' '.        01410000
014900         88  PS-PRIM-CONTACT-FOUND              VALUE 'Y'.        01420000
015000         88  PS-NO-PRIM-CONTACT-FOUND           VALUE 'N'.        01430000
015100     05  PS-ALT-CONTACT-FOUND-SW     PIC X(01)  VALUE ' '.        01440000
015200         88  PS-NULL-ALT-CONTACT-FOUND          VALUE ' '.        01450000
015300         88  PS-ALT-CONTACT-FOUND               VALUE 'Y'.        01460000
015400         88  PS-NO-ALT-CONTACT-FOUND            VALUE 'N'.        01470000
015500                                                                  01480000
015600 01  PROGRAM-VARIABLES.                                           01490000
015700     05  PV-FUNCTION-ID              PIC S9(4) COMP VALUE ZERO.   01500000
015800     05  MAX-LINES                   PIC S9(3) COMP-3 VALUE +67.  01510000
015900     05  PAGE-COUNT                  PIC S9(9) COMP-3 VALUE +0.   01520000
016000     05  LINE-COUNT                  PIC S9(3) COMP-3 VALUE +0.   01530000
016100     05  PV-SYSTEM-DATE              PIC X(08)  VALUE ZERO.       01540000
016200     05  FILLER REDEFINES PV-SYSTEM-DATE.                         01550000
016300         10  PV-SYSTEM-CCYY.                                      01560000
016400             15  PV-SYSTEM-CENTURY   PIC X(02).                   01570000
016500             15  PV-SYSTEM-YEAR      PIC X(02).                   01580000
016600         10  PV-SYSTEM-MONTH         PIC X(02).                   01590000
016700         10  PV-SYSTEM-DAY           PIC X(02).                   01600000
016800     05  PV-SYSTEM-TIME.                                          01610000
016900         10  PV-SYSTEM-HOUR          PIC 9(02)  VALUE ZERO.       01620000
017000         10  PV-SYSTEM-MINUTE        PIC 9(02)  VALUE ZERO.       01630000
017100         10  PV-SYSTEM-SECOND        PIC 9(02)  VALUE ZERO.       01640000
017200         10  FILLER                  PIC 9(02)  VALUE ZERO.       01650000
017300     05  PV-PROGRAM-NAME             PIC X(8)   VALUE 'VNKUT015'. 01660000
017400                                                                  01670000
017500 01  PROGRAM-COUNTERS.                                            01680000
017600     05  PV-COUNT-VENDOR-READ        PIC 9(09)  VALUE 0.          01690000
017700     05  PV-COUNT-MERCH-RECORD       PIC 9(09)  VALUE 0.          01700000
017800     05  PV-COUNT-SKIP-MERCH-RECORD  PIC 9(09)  VALUE 0.          01710000
017900     05  PV-COUNT-EXPEN-RECORD       PIC 9(09)  VALUE 0.          01720000
018000     05  PV-COUNT-SKIP-EXPEN-RECORD  PIC 9(09)  VALUE 0.          01730000
018100     05  PV-COUNT-EXCEPTION-RECORD   PIC 9(09)  VALUE 0.          01740000
018200     05  PV-COUNT-EXPVND-NO-ACT      PIC 9(09)  VALUE 0.          01750000
018300                                                                  01760000
018400 01  PC-PROGRAM-CONSTANTS.                                        01770000
018500     05  PC-CALLED-PROGRAM          PIC X(08)   VALUE 'APKUT915'. 01780000
018600                                                                  01790000
018700 01  PC-ADDRESS-EXCEPT-TEXT.                                      01800000
018800     05  FILLER                      PIC X(89) VALUE              01810000
018900        'NO ADDRESS INFORMATION WAS FOUND'.                       01820000
019000                                                                  01830000
019100 01  PC-CONTACT-EXCEPT-TEXT.                                      01840000
019200     05  FILLER                      PIC X(89) VALUE              01850000
019300        'NO TELEPHONE INFORMATION WAS FOUND'.                     01860000
019400                                                                  01870000
019500*----------------------------------------------------------------*01880000
019600*           KOHLS STANDARD 132 CHARACTER REPORT HEADER           *01890000
019700*----------------------------------------------------------------*01900000
019800     COPY DPWS132O.                                               01910000
019900                                                                  01920000
020000 01  BLANK-LINE                PIC X(132) VALUE SPACES.           01930000
020100                                                                  01940000
020200 01  SAVE-DETAIL-LINE          PIC X(132) VALUE SPACES.           01950000
020300                                                                  01960000
020400 01  HDR-TITLE-1.                                                 01970000
020500     05  FILLER                  PIC  X(45)     VALUE SPACE.      01980000
020600     05  FILLER                  PIC  X(43)     VALUE             01990000
020700        'VENDOR BUSINESS CONTINUITY EXCEPTION REPORT'.            02000000
020800     05  FILLER                  PIC  X(46)     VALUE SPACE.      02010000
020900                                                                  02020000
021000 01  HEADER-1.                                                    02030000
021100     05  FILLER                PIC X(11) VALUE 'VENDOR ID'.       02040000
021200     05  FILLER                PIC X(32) VALUE 'VENDOR NAME'.     02050000
021300     05  FILLER                PIC X(89) VALUE 'EXCEPTION REASON'.02060000
021400                                                                  02070000
021500 01  DETAIL-1.                                                    02080000
021600     05  DTL-VENDOR-ID         PIC X(09) VALUE SPACES.            02090000
021700     05  FILLER                PIC X(02) VALUE SPACES.            02100000
021800     05  DTL-VENDOR-NAME       PIC X(30) VALUE SPACES.            02110000
021900     05  FILLER                PIC X(02) VALUE SPACES.            02120000
022000     05  DTL-FUNCTION-NAME     PIC X(20) VALUE SPACES.            02130000
022100     05  FILLER                PIC X(02) VALUE SPACES.            02140000
022200     05  DTL-EXCEPTION-REASON  PIC X(89) VALUE SPACES.            02150000
022300                                                                  02160000
022400 01  TOTAL-LINE.                                                  02170000
022500     05  FILLER                PIC  X(29)     VALUE               02180000
022600         'TOTAL EXCEPTIONS ON REPORT = '.                         02190000
022700     05  TL-COUNT              PIC  ZZZ,ZZZ,ZZ9.                  02200000
022800     05  FILLER                PIC  X(100)    VALUE SPACES.       02210000
022900                                                                  02220000
023000                                                                  02230000
023100 01  END-OF-REPORT.                                               02240000
023200     05  FILLER                PIC X(51) VALUE SPACES.            02250000
023300     05  FILLER                PIC X(29) VALUE                    02260000
023400               '- - - - END OF REPORT - - - -'.                   02270000
023500     05  FILLER                PIC X(52) VALUE SPACE.             02280000
023600                                                                  02290000
023700 01  NO-DATA-TO-REPORT.                                           02300000
023800     05  FILLER                PIC X(54) VALUE SPACES.            02310000
023900     05  FILLER                PIC X(23) VALUE                    02320000
024000                     '-  NO DATA TO REPORT  -'.                   02330000
024100     05  FILLER                PIC X(55) VALUE SPACE.             02340000
024200                                                                  02350000
024300 01  ABEND-CODE                      PIC S9(04) VALUE 0 COMP SYNC.02360000
024400     88  AC-BAD-WRITE                           VALUE  +4001.     02370000
024500     88  AC-CONTROL-CARD-ERROR                  VALUE  +4003.     02380000
024600     88  AC-OPEN-ERROR                          VALUE  +4005.     02390000
024700     88  AC-CLOSE-ERROR                         VALUE  +4006.     02400000
024800     88  AC-BAD-DATA                            VALUE  +4008.     02410000
024900     88  AC-DB2-ERROR                           VALUE  +4013.     02420000
025000     88  AC-UNSUCCESSFUL-SELECT                 VALUE  +4015.     02430000
025100     88  AC-MAX-RETRIES-EXCEEDED                VALUE  +4016.     02440000
025200     88  AC-DATE-ERROR                          VALUE  +4019.     02450000
025300                                                                  02460000
025400 01  ABEND-AREAS.                                                 02470000
025500     05  AA-ABEND-LIT                PIC X(40)  VALUE             02480000
025600             '*****       ABEND'.                                 02490000
025700     05  AA-PROGRAM-LIT              PIC X(40)  VALUE             02500000
025800             '*****   PROGRAM: VNKUT015'.                         02510000
025900     05  AA-PARAGRAPH-LIT.                                        02520000
026000         10  FILLER                  PIC X(17)  VALUE             02530000
026100             '***** PARAGRAPH: '.                                 02540000
026200         10  AA-PARAGRAPH-NAME       PIC X(35)  VALUE SPACES.     02550000
026300     05  AA-MESSAGE-LINE.                                         02560000
026400         10  FILLER                  PIC X(06)  VALUE '*****'.    02570000
026500         10  AA-MESSAGE              PIC X(127) VALUE SPACES.     02580000
026600         10  FILLER REDEFINES AA-MESSAGE.                         02590000
026700             15 AA-MESSAGE-1         PIC X(45).                   02600000
026800             15 AA-MESSAGE-2         PIC X(45).                   02610000
026900             15 AA-MESSAGE-3         PIC X(37).                   02620000
027000     05  AA-DB2-ERROR-LIT            PIC X(40)  VALUE             02630000
027100             '*****    DB2 ERROR'.                                02640000
027200     05  AA-DB2-OPERATION-LIT.                                    02650000
027300         10  FILLER                  PIC X(17)  VALUE             02660000
027400             '***** OPERATION: '.                                 02670000
027500         10  AA-DB2-OPERATION.                                    02680000
027600             15  AA-DB2-OP-1         PIC X(25)  VALUE SPACES.     02690000
027700             15  AA-DB2-OP-2         PIC X(25)  VALUE SPACES.     02700000
027800     05  AA-DB2-TABLE-1              PIC X(18)  VALUE SPACES.     02710000
027900     05  AA-DB2-TABLE-2              PIC X(18)  VALUE SPACES.     02720000
028000     05  AA-DB2-TABLE-3              PIC X(18)  VALUE SPACES.     02730000
028100                                                                  02740000
028200*--------------------------------------------------------------*  02750000
028300*   THIS IS THE RECORD LAYOUT FOR THE VENDOR EXTRACT. OUTPUT   *  02760000
028400*--------------------------------------------------------------*  02770000
028500     COPY VNRD005.                                                02780000
028600                                                                  02790000
028700*--------------------------------------------------------------*  02800000
028800*   THIS IS THE RECORD LAYOUT FOR THE VENDOR EXTRACT.INPUT     *  02810000
028900*--------------------------------------------------------------*  02820000
029000     COPY VNRD010.                                                02830000
029100                                                                  02840000
029200*--------------------------------------------------------------*  02850000
029300*  DPWS004 CONTAINS THE FIELDS NECESSARY TO CALL THE SQLCA     *  02860000
029400*  MESSAGE MODULE 'DSNTIAR' AND DISPLAY THE FORMATTED RESULTS. *  02870000
029500*--------------------------------------------------------------*  02880000
029600     COPY DPWS004.                                                02890000
029700                                                                  02900000
029800*--------------------------------------------------------------*  02910000
029900*  EXTERNAL ENTITY REPRESENTATIVE TABLE                        *  02920000
030000*--------------------------------------------------------------*  02930000
030100     EXEC SQL                                                     02940000
030200          INCLUDE TENTREP                                         02950000
030300     END-EXEC.                                                    02960000
030400                                                                  02970000
030500*--------------------------------------------------------------*  02980000
030600*  EXTERNAL ENTITY BUSINESS LOCATION TABLE                     *  02990000
030700*--------------------------------------------------------------*  03000000
030800     EXEC SQL                                                     03010000
030900          INCLUDE TBUSLOC                                         03020000
031000     END-EXEC.                                                    03030000
031100                                                                  03040000
031200*--------------------------------------------------------------*  03050000
031300*  EXTERNAL ENTITY BUSINESS FUNCTION TABLE                     *  03060000
031400*--------------------------------------------------------------*  03070000
031500     EXEC SQL                                                     03080000
031600          INCLUDE TBUSFNC                                         03090000
031700     END-EXEC.                                                    03100000
031800                                                                  03110000
031900*--------------------------------------------------------------*  03120000
032000*  VENDOR/DEPARTMENT TABLE                                     *  03130000
032100*--------------------------------------------------------------*  03140000
032200     EXEC SQL                                                     03150000
032300          INCLUDE TVNDDPT                                         03160000
032400     END-EXEC.                                                    03170000
032500                                                                  03180000
032600*--------------------------------------------------------------*  03190000
032700*  MERCHANDISE AREA TABLE                                      *  03200000
032800*--------------------------------------------------------------*  03210000
032900     EXEC SQL                                                     03220000
033000          INCLUDE TMDSEAR                                         03230000
033100     END-EXEC.                                                    03240000
033200                                                                  03250000
033300*--------------------------------------------------------------*  03260000
033400*  LOGICAL ORGANIZATION UNIT TABLE                             *  03270000
033500*--------------------------------------------------------------*  03280000
033600     EXEC SQL                                                     03290000
033700          INCLUDE TORGUNT                                         03300000
033800     END-EXEC.                                                    03310000
033900                                                                  03320000
034000*--------------------------------------------------------------*  03330000
034100*  COMMUNICATIONS AREA2 FOR DB2                                *  03340000
034200*--------------------------------------------------------------*  03350000
034300     COPY SQLCA2.                                                 03360000
034400*--------------------------------------------------------------*  03370000
034500*     SQL COMMUNICATIONS AREA DCLGEN                           *  03380000
034600*--------------------------------------------------------------*  03390000
034700     EXEC SQL                                                     03400000
034800         INCLUDE SQLCA                                            03410000
034900     END-EXEC.                                                    03420000
035000                                                                  03430000
035100                                                                  03440000
035200 LINKAGE SECTION.                                                 03450000
035300************************                                          03460000
035400 PROCEDURE DIVISION.                                              03470000
035500************************                                          03480000
035600 A100-MAINLINE-ROUTINE.                                           03490000
035700                                                                  03500000
035800     PERFORM B100-INITIALIZATION.                                 03510000
035900                                                                  03520000
036000     PERFORM B200-PROCESS-VENDOR-FILE                             03530000
036100       UNTIL END-OF-VENDOR-FILE.                                  03540000
036200                                                                  03550000
036300     PERFORM B300-TERMINATION.                                    03560000
036400     GOBACK.                                                      03570000
036500                                                                  03580000
036600*--------------------------------------------------------------*  03590000
036700*  INITIALIZATION PROCESSING                                   *  03600000
036800*--------------------------------------------------------------*  03610000
036900 B100-INITIALIZATION.                                             03620000
037000                                                                  03630000
037100     DISPLAY ' '.                                                 03640000
037200     DISPLAY '**--------------- VNKUT015 --------------------**'. 03650000
037300     DISPLAY 'DATE ' FUNCTION CURRENT-DATE(1:8)                   03660000
037400           '  TIME ' FUNCTION CURRENT-DATE(9:6)                   03670000
037500                                                                  03680000
037600     OPEN INPUT  VENDOR-INPUT-FILE                                03690000
037700     OPEN OUTPUT VENDOR-EXCPTION-FILE.                            03700000
037800     OPEN OUTPUT VENDOR-EXCEPTION-REPORT.                         03710000
037900                                                                  03720000
038000      MOVE FUNCTION CURRENT-DATE TO PV-SYSTEM-DATE.               03730000
038100      MOVE PV-SYSTEM-MONTH        TO DP132O-RUN-MONTH.            03740000
038200      MOVE PV-SYSTEM-DAY          TO DP132O-RUN-DAY.              03750000
038300      MOVE PV-SYSTEM-YEAR         TO DP132O-RUN-YEAR.             03760000
038400      ACCEPT PV-SYSTEM-TIME FROM TIME.                            03770000
038500      MOVE PV-SYSTEM-HOUR         TO DP132O-RUN-HOUR.             03780000
038600      MOVE PV-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.           03790000
038700      MOVE PV-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.         03800000
038800      MOVE '1'                    TO DP132O-REPORT-NUMBER.        03810000
038900      PERFORM W400-WRITE-HEADINGS.                                03820000
039000                                                                  03830000
039100     INITIALIZE DCLTENTREP                                        03840000
039200                DCLTBUSLOC                                        03850000
039300                DCLTBUSFNC                                        03860000
039400                DCLTVNDDPT                                        03870000
039500                DCLTMDSEAR                                        03880000
039600                DCLTORGUNT                                        03890000
039700                AA-DB2-TABLE-1                                    03900000
039800                AA-DB2-TABLE-2                                    03910000
039900                AA-DB2-TABLE-3.                                   03920000
040000                                                                  03930000
040100                                                                  03940000
040200     PERFORM R100-READ-VENDOR-FILE.                               03950000
040300     IF END-OF-VENDOR-FILE                                        03960000
040400         DISPLAY '***  VNKUT015  ***'                             03970000
040500         DISPLAY 'NO VENDOR DATA TO PROCESS  '                    03980000
040600         DISPLAY ' '                                              03990000
040700     END-IF.                                                      04000000
040800                                                                  04010000
040900*--------------------------------------------------------------*  04020000
041000* PROCESS THE VENDOR CURSOR                                    *  04030000
041100*--------------------------------------------------------------*  04040000
041200 B200-PROCESS-VENDOR-FILE.                                        04050000
041300                                                                  04060000
041400     MOVE VN010-ENT-ID  TO VNDDPT-ENT-ID.                         04070000
041500     IF VN010-MDSE-VENDOR                                         04080000
041600        PERFORM C100-CREATE-MERCH-VEND-RECORD                     04090000
041700     ELSE                                                         04100000
041800        IF VN010-EXPEN-ACTIVE                                     04110000
041900           PERFORM C200-CREATE-EXPEN-VEND-RECORD                  04120000
042000        ELSE                                                      04130000
042100           ADD   1  TO PV-COUNT-EXPVND-NO-ACT                     04140000
042200        END-IF                                                    04150000
042300     END-IF.                                                      04160000
042400                                                                  04170000
042500     PERFORM R100-READ-VENDOR-FILE.                               04180000
042600                                                                  04190000
042700     PERFORM I100-RESET-SWITCHES.                                 04200000
042800                                                                  04210000
042900*--------------------------------------------------------------*  04220000
043000*  END OF PROGRAM PROCESSING                                   *  04230000
043100*--------------------------------------------------------------*  04240000
043200 B300-TERMINATION.                                                04250000
043300                                                                  04260000
043400     MOVE PV-COUNT-EXCEPTION-RECORD TO TL-COUNT.                  04270000
043500     WRITE VENDOR-EXCEPTION-RPT FROM TOTAL-LINE.                  04280000
043600     WRITE VENDOR-EXCEPTION-RPT FROM END-OF-REPORT.               04290000
043700                                                                  04300000
043800     DISPLAY '**********************************************'.    04310000
043900     DISPLAY '**         VNKUT015 RECORD COUNTS           **'.    04320000
044000     DISPLAY '**********************************************'.    04330000
044100     DISPLAY ' VENDOR RECS FETCHED:' PV-COUNT-VENDOR-READ.        04340000
044200     DISPLAY ' MERCH VEND WRITTEN :' PV-COUNT-MERCH-RECORD.       04350000
044300     DISPLAY ' MERCH VEND BYPASSED:' PV-COUNT-SKIP-MERCH-RECORD.  04360000
044400     DISPLAY ' EXPEN VEND WRITTEN :' PV-COUNT-EXPEN-RECORD.       04370000
044500     DISPLAY ' EXPEN VEND BYPASSED:' PV-COUNT-SKIP-EXPEN-RECORD.  04380000
044600     DISPLAY ' EXPEN VEND W/NO ACT:' PV-COUNT-EXPVND-NO-ACT.      04390000
044700     DISPLAY ' RECS ON EXCEPT RPT :' PV-COUNT-EXCEPTION-RECORD.   04400000
044800     DISPLAY '**********************************************'.    04410000
044900                                                                  04420000
045000                                                                  04430000
045100     CLOSE VENDOR-INPUT-FILE                                      04440000
045200           VENDOR-EXCPTION-FILE                                   04450000
045300           VENDOR-EXCEPTION-REPORT.                               04460000
045400                                                                  04470000
045500*--------------------------------------------------------------*  04480000
045600* CREATE MERCHANDISE VENDOR RECORD                             *  04490000
045700*--------------------------------------------------------------*  04500000
045800 C100-CREATE-MERCH-VEND-RECORD.                                   04510000
045900                                                                  04520000
046000     INITIALIZE VN005-VENDOR-EXTRACT-REC.                         04530000
046100                                                                  04540000
046200     MOVE VN010-DUN-NBR         TO VN005-DUN-NBR.                 04550000
046300     MOVE VN010-ENT-NAME-DESC   TO VN005-ENT-NAME-DESC.           04560000
046400     MOVE 'A'                   TO VN005-STATUS-CDE.              04570000
046500     SET VN005-MDSE-VENDOR      TO TRUE.                          04580000
046600     MOVE VN010-CFY-SLSRNK-NBR  TO VN005-CFY-SLSRNK-NBR.          04590000
046700     MOVE VN010-PFY-SLSRNK-NBR  TO VN005-PFY-SLSRNK-NBR.          04600000
046800     MOVE SPACE                 TO VN005-CAP-EXP-CDE.             04610000
046900                                                                  04620000
047000*  SET PARTNER TYPE CODE TO BROKER FOR COLBY INTERNATIONAL.       04630000
047100     IF VN010-DUN-NBR = '009206194'                               04640000
047200        SET VN005-BROKER        TO TRUE                           04650000
047300     ELSE                                                         04660000
047400        MOVE SPACE              TO VN005-PRTNR-TYP-CDE            04670000
047500     END-IF.                                                      04680000
047600                                                                  04690000
047700     PERFORM S100-SELECT-ACT-MERCH-DEPTS.                         04700000
047800                                                                  04710000
047900     IF PS-ACT-DEPTS                                              04720000
048000        MOVE 4 TO PV-FUNCTION-ID                                  04730000
048100        PERFORM S300-SELECT-MERCH-ADDRESS UNTIL PS-ADDRESS-FOUND  04740000
048200                                          OR PS-NO-ADDRESS-FOUND  04750000
048300        IF PS-ADDRESS-FOUND                                       04760000
048400           PERFORM M100-MOVE-ADDRESS-INFORMATION                  04770000
048500        ELSE                                                      04780000
048600           PERFORM W200-WRITE-ADDRESS-EXCEPTION                   04790000
048700        END-IF                                                    04800000
048800        MOVE 4 TO PV-FUNCTION-ID                                  04810000
048900        PERFORM S500-SELECT-MERCH-PRIM-CONTACT UNTIL              04820000
049000                                           PS-PRIM-CONTACT-FOUND  04830000
049100                                     OR PS-NO-PRIM-CONTACT-FOUND  04840000
049200        IF PS-PRIM-CONTACT-FOUND                                  04850000
049300           PERFORM M200-MOVE-PRIM-CONTACT-INFO                    04860000
049400           MOVE 1 TO PV-FUNCTION-ID                               04870000
049500           PERFORM S700-SELECT-MERCH-ALT-CONTACT UNTIL            04880000
049600                                            PS-ALT-CONTACT-FOUND  04890000
049700                                      OR PS-NO-ALT-CONTACT-FOUND  04900000
049800           IF PS-ALT-CONTACT-FOUND                                04910000
049900              PERFORM M300-MOVE-ALT-CONTACT-INFO                  04920000
050000           ELSE                                                   04930000
050100              MOVE 'NOT FOUND' TO VN005-ALT-FUNCTION-NAME         04940000
050200           END-IF                                                 04950000
050300        ELSE                                                      04960000
050400           PERFORM W300-WRITE-CONTACT-EXCEPTION                   04970000
050500        END-IF                                                    04980000
050600     END-IF.                                                      04990000
050700                                                                  05000000
050800     IF PS-ACT-DEPTS AND                                          05010000
050900        PS-PRIM-CONTACT-FOUND                                     05020000
051000        PERFORM W100-WRITE-VENDOR-EXTRACT                         05030000
051100        ADD 1 TO PV-COUNT-MERCH-RECORD                            05040000
051200     ELSE                                                         05050000
051300        PERFORM W100-WRITE-VENDOR-EXTRACT                         05060000
051400        ADD 1 TO PV-COUNT-MERCH-RECORD                            05070000
051500        ADD 1 TO PV-COUNT-SKIP-MERCH-RECORD                       05080000
051600     END-IF.                                                      05090000
051700                                                                  05100000
051800*--------------------------------------------------------------*  05110000
051900* CREATE EXPENSE VENDOR RECORD                                 *  05120000
052000*--------------------------------------------------------------*  05130000
052100 C200-CREATE-EXPEN-VEND-RECORD.                                   05140000
052200                                                                  05150000
052300     INITIALIZE VN005-VENDOR-EXTRACT-REC.                         05160000
052400                                                                  05170000
052500     MOVE VN010-DUN-NBR         TO VN005-DUN-NBR.                 05180000
052600     MOVE VN010-ENT-NAME-DESC   TO VN005-ENT-NAME-DESC.           05190000
052700     MOVE 'A'                   TO VN005-STATUS-CDE.              05200000
052800     SET VN005-EXP-VENDOR       TO TRUE.                          05210000
052900     MOVE ZERO                  TO VN005-CFY-SLSRNK-NBR           05220000
053000                                   VN005-PFY-SLSRNK-NBR.          05230000
053100     MOVE VN010-PRTNR-TYP-CDE   TO VN005-PRTNR-TYP-CDE.           05240000
053200     MOVE VN010-CAP-EXP-CDE     TO VN005-CAP-EXP-CDE.             05250000
053300                                                                  05260000
053400     IF VN005-CAP-EXP-CDE = 'N'                                   05270000
053500        SET VN005-DEPT-UNKNOWN                                    05280000
053600            VN005-DEPT-UNKNOWN-DESC                               05290000
053700            PS-CONTINUE-PROCESSING  TO TRUE                       05300000
053800     END-IF.                                                      05310000
053900                                                                  05320000
054000     IF VN005-VENDOR-IS-CAPEXP                                    05330000
054100        PERFORM S200-SELECT-ACT-EXPEN-DEPTS                       05340000
054200     END-IF.                                                      05350000
054300                                                                  05360000
054400     IF PS-CONTINUE-PROCESSING                                    05370000
054500        MOVE 2 TO PV-FUNCTION-ID                                  05380000
054600        PERFORM S400-SELECT-EXPEN-ADDRESS UNTIL                   05390000
054700                        PS-ADDRESS-FOUND OR PS-NO-ADDRESS-FOUND   05400000
054800        IF PS-ADDRESS-FOUND                                       05410000
054900           PERFORM M100-MOVE-ADDRESS-INFORMATION                  05420000
055000        ELSE                                                      05430000
055100           PERFORM W200-WRITE-ADDRESS-EXCEPTION                   05440000
055200        END-IF                                                    05450000
055300        MOVE 2 TO PV-FUNCTION-ID                                  05460000
055400        PERFORM S600-SELECT-EXPEN-PRIM-CONTACT UNTIL              05470000
055500              PS-PRIM-CONTACT-FOUND OR PS-NO-PRIM-CONTACT-FOUND   05480000
055600        IF PS-PRIM-CONTACT-FOUND                                  05490000
055700           PERFORM M200-MOVE-PRIM-CONTACT-INFO                    05500000
055800           MOVE 1 TO PV-FUNCTION-ID                               05510000
055900           PERFORM S800-SELECT-EXPEN-ALT-CONTACT UNTIL            05520000
056000                PS-ALT-CONTACT-FOUND OR PS-NO-ALT-CONTACT-FOUND   05530000
056100           IF PS-ALT-CONTACT-FOUND                                05540000
056200              PERFORM M300-MOVE-ALT-CONTACT-INFO                  05550000
056300           ELSE                                                   05560000
056400              MOVE 'NOT FOUND' TO VN005-ALT-FUNCTION-NAME         05570000
056500           END-IF                                                 05580000
056600        ELSE                                                      05590000
056700           PERFORM W300-WRITE-CONTACT-EXCEPTION                   05600000
056800        END-IF                                                    05610000
056900     END-IF.                                                      05620000
057000                                                                  05630000
057100     IF PS-CONTINUE-PROCESSING AND                                05640000
057200        PS-PRIM-CONTACT-FOUND                                     05650000
057300        PERFORM W100-WRITE-VENDOR-EXTRACT                         05660000
057400        ADD 1 TO PV-COUNT-EXPEN-RECORD                            05670000
057500     ELSE                                                         05680000
057600        PERFORM W100-WRITE-VENDOR-EXTRACT                         05690000
057700        ADD 1 TO PV-COUNT-EXPEN-RECORD                            05700000
057800        ADD 1 TO PV-COUNT-SKIP-EXPEN-RECORD                       05710000
057900     END-IF.                                                      05720000
058000                                                                  05730000
058100*----------------------------------------------------------------*05740000
058200*  RETRIEVES THE VENDOR FILE DATA                              *  05750000
058300*----------------------------------------------------------------*05760000
058400 R100-READ-VENDOR-FILE.                                           05770000
058500                                                                  05780000
058600     READ VENDOR-INPUT-FILE INTO VN010-VENDOR-EXTRACT-REC         05790000
058700       AT END                                                     05800000
058800         SET END-OF-VENDOR-FILE  TO TRUE                          05810000
058900                                                                  05820000
059000       NOT AT END                                                 05830000
059100             ADD 1               TO PV-COUNT-VENDOR-READ          05840000
059200     END-READ.                                                    05850000
059300                                                                  05860000
059400*--------------------------------------------------------------*  05870000
059500*  RESET ALL OF THE SWITCHES USED IN PROCESSING THE VENDOR     *  05880000
059600*  RECORDS                                                     *  05890000
059700*--------------------------------------------------------------*  05900000
059800 I100-RESET-SWITCHES.                                             05910000
059900                                                                  05920000
060000     SET PS-ACT-DEPTS                                             05930000
060100         PS-YES-ADDRESS-CONTENT                                   05940000
060200         PS-YES-CONTACT-CONTENT                                   05950000
060300         PS-NULL-ADDRESS-FOUND                                    05960000
060400         PS-NULL-PRIM-CONTACT-FOUND                               05970000
060500         PS-NULL-ALT-CONTACT-FOUND                                05980000
060600         PS-CONTINUE-PROCESSING     TO TRUE.                      05990000
060700                                                                  06000000
060800*--------------------------------------------------------------*  06010000
060900*  MOVE THE ADDRESS INFORMATION TO THE VENDOR EXTRACT RECORD   *  06020000
061000*--------------------------------------------------------------*  06030000
061100 M100-MOVE-ADDRESS-INFORMATION.                                   06040000
061200                                                                  06050000
061300     MOVE BUSFNC-FUNCTION-NAME      TO VN005-ADDR-FUNCTION-NAME.  06060000
061400     MOVE BUSLOC-ADDRESS-LINE1-DESC TO VN005-ADDRESS-LINE1-DESC.  06070000
061500     INSPECT VN005-ADDRESS-LINE1-DESC   REPLACING ALL ',' BY ' '. 06080000
061600     MOVE BUSLOC-ADDRESS-LINE2-DESC TO VN005-ADDRESS-LINE2-DESC.  06090000
061700     INSPECT VN005-ADDRESS-LINE2-DESC   REPLACING ALL ',' BY ' '. 06100000
061800     MOVE BUSLOC-ADDRESS-LINE3-DESC TO VN005-ADDRESS-LINE3-DESC.  06110000
061900     INSPECT VN005-ADDRESS-LINE3-DESC   REPLACING ALL ',' BY ' '. 06120000
062000     MOVE BUSLOC-ADDRESS-LINE4-DESC TO VN005-ADDRESS-LINE4-DESC.  06130000
062100     INSPECT VN005-ADDRESS-LINE4-DESC   REPLACING ALL ',' BY ' '. 06140000
062200     MOVE BUSLOC-CITY-NAME          TO VN005-CITY-NAME.           06150000
062300     INSPECT VN005-CITY-NAME            REPLACING ALL ',' BY ' '. 06160000
062400     MOVE BUSLOC-STATE-CDE          TO VN005-STATE-CDE.           06170000
062500     MOVE BUSLOC-ZIP-CDE            TO VN005-ZIP-CDE.             06180000
062600     MOVE BUSLOC-ROOM-NBR           TO VN005-ROOM-NBR.            06190000
062700     MOVE BUSLOC-ST-PROV-CDE        TO VN005-ST-PROV-CDE.         06200000
062800     MOVE BUSLOC-CNTRY-CDE          TO VN005-CNTRY-CDE.           06210000
062900                                                                  06220000
063000*--------------------------------------------------------------*  06230000
063100*  MOVE THE PRIMARY CONTACT INFORMATION TO THE VENDOR EXTRACT  *  06240000
063200*  RECORD                                                      *  06250000
063300*--------------------------------------------------------------*  06260000
063400 M200-MOVE-PRIM-CONTACT-INFO.                                     06270000
063500                                                                  06280000
063600     MOVE BUSFNC-FUNCTION-NAME     TO VN005-CONTACT-FUNCTION-NAME.06290000
063700     MOVE ENTREP-FIRST-NAME        TO VN005-FIRST-NAME.           06300000
063800     INSPECT VN005-FIRST-NAME           REPLACING ALL ',' BY ' '. 06310000
063900     MOVE ENTREP-LAST-NAME         TO VN005-LAST-NAME.            06320000
064000     INSPECT VN005-LAST-NAME            REPLACING ALL ',' BY ' '. 06330000
064100     MOVE ENTREP-TITLE-NAME        TO VN005-TITLE-NAME.           06340000
064200     INSPECT VN005-TITLE-NAME           REPLACING ALL ',' BY ' '. 06350000
064300     MOVE ENTREP-TEL1-NBR          TO VN005-TEL1-NBR.             06360000
064400     MOVE ENTREP-TEL1-EXT-NBR      TO VN005-TEL1-EXT-NBR.         06370000
064500     MOVE ENTREP-TEL-1-CNTRY-CDE   TO VN005-TEL-1-CNTRY-CDE.      06380000
064600     MOVE ENTREP-TEL2-NBR          TO VN005-TEL2-NBR.             06390000
064700     MOVE ENTREP-TEL2-EXT-NBR      TO VN005-TEL2-EXT-NBR.         06400000
064800     MOVE ENTREP-TEL-2-CNTRY-CDE   TO VN005-TEL-2-CNTRY-CDE.      06410000
064900     MOVE ENTREP-FAX-NBR           TO VN005-FAX-NBR.              06420000
065000     MOVE ENTREP-EMAIL-ADDR-ID     TO VN005-EMAIL-ADDR-ID.        06430000
065100                                                                  06440000
065200*--------------------------------------------------------------*  06450000
065300*  MOVE THE ALTERNATE CONTACT INFORMATION TO THE VENDOR EXTRACT*  06460000
065400*  RECORD                                                      *  06470000
065500*--------------------------------------------------------------*  06480000
065600 M300-MOVE-ALT-CONTACT-INFO.                                      06490000
065700                                                                  06500000
065800     MOVE BUSFNC-FUNCTION-NAME     TO VN005-ALT-FUNCTION-NAME.    06510000
065900     MOVE ENTREP-FIRST-NAME        TO VN005-ALT-FIRST-NAME.       06520000
066000     INSPECT VN005-ALT-FIRST-NAME       REPLACING ALL ',' BY ' '. 06530000
066100     MOVE ENTREP-LAST-NAME         TO VN005-ALT-LAST-NAME.        06540000
066200     INSPECT VN005-ALT-LAST-NAME        REPLACING ALL ',' BY ' '. 06550000
066300     MOVE ENTREP-TITLE-NAME        TO VN005-ALT-TITLE-NAME.       06560000
066400     INSPECT VN005-ALT-TITLE-NAME       REPLACING ALL ',' BY ' '. 06570000
066500     MOVE ENTREP-TEL1-NBR          TO VN005-ALT-TEL1-NBR.         06580000
066600     MOVE ENTREP-TEL1-EXT-NBR      TO VN005-ALT-TEL1-EXT-NBR.     06590000
066700     MOVE ENTREP-TEL-1-CNTRY-CDE   TO VN005-ALT-TEL-1-CNTRY-CDE.  06600000
066800     MOVE ENTREP-TEL2-NBR          TO VN005-ALT-TEL2-NBR.         06610000
066900     MOVE ENTREP-TEL2-EXT-NBR      TO VN005-ALT-TEL2-EXT-NBR.     06620000
067000     MOVE ENTREP-TEL-2-CNTRY-CDE   TO VN005-ALT-TEL-2-CNTRY-CDE.  06630000
067100     MOVE ENTREP-FAX-NBR           TO VN005-ALT-FAX-NBR.          06640000
067200     MOVE ENTREP-EMAIL-ADDR-ID     TO VN005-ALT-EMAIL-ADDR-ID.    06650000
067300                                                                  06660000
067400*--------------------------------------------------------------*  06670000
067500*  SELECT ACTIVE MERCHANDISE DEPARTMENTS                       *  06680000
067600*--------------------------------------------------------------*  06690000
067700 S100-SELECT-ACT-MERCH-DEPTS.                                     06700000
067800                                                                  06710000
067900     EXEC SQL                                                     06720000
068000         SELECT A.DEPT_NBR                                        06730000
068100              , B.MDSEAR_DESC                                     06740000
068200           INTO :VNDDPT-DEPT-NBR                                  06750000
068300              , :MDSEAR-DESC                                      06760000
068400           FROM TVNDDPT A                                         06770000
068500              , TMDSEAR B                                         06780000
068600          WHERE A.DEPT_NBR         = B.DEPT_NBR                   06790000
068700            AND A.ENT_ID           = :VNDDPT-ENT-ID               06800000
068800            AND CURRENT DATE      BETWEEN B.STRT_DTE AND B.END_DTE06810000
068900            AND A.VND_DEPT_STAT_CD = 'A'                          06820000
069000     END-EXEC.                                                    06830000
069100                                                                  06840000
069200     EVALUATE TRUE                                                06850000
069300         WHEN SQLCODE = ZERO                                      06860000
069400             MOVE VNDDPT-DEPT-NBR     TO VN005-DEPT-NBR           06870000
069500             MOVE MDSEAR-DESC         TO VN005-DEPT-DESC          06880000
069600         WHEN SQLCODE = -811                                      06890000
069700             SET VN005-MULTIPLE-DEPTS                             06900000
069800                 VN005-MULTIPLE-DESC  TO TRUE                     06910000
069900         WHEN SQLCODE = +100                                      06920000
070000             CONTINUE                                             06930000
070100         WHEN OTHER                                               06940000
070200             DISPLAY 'VENDOR NAME: ' VN010-ENT-NAME-DESC          06950000
070300             DISPLAY 'VENDOR NBR : ' VN010-DUN-NBR                06960000
070400             SET AC-UNSUCCESSFUL-SELECT    TO TRUE                06970000
070500             MOVE 'S100-SELECT-ACT-MERCH-DEPTS  '                 06980000
070600                                           TO AA-PARAGRAPH-NAME   06990000
070700             MOVE 'UNSUCCESSFUL SELECT'    TO AA-DB2-OPERATION    07000000
070800             MOVE 'TVNDDPT'                TO AA-DB2-TABLE-1      07010000
070900             MOVE 'TMDSEAR'                TO AA-DB2-TABLE-2      07020000
071000             MOVE SPACE                    TO AA-DB2-TABLE-3      07030000
071100             PERFORM Z998-DB2-ABEND                               07040000
071200     END-EVALUATE.                                                07050000
071300                                                                  07060000
071400*--------------------------------------------------------------*  07070000
071500*  SELECT ACTIVE EXPENSE DEPARTMENTS                           *  07080000
071600*--------------------------------------------------------------*  07090000
071700 S200-SELECT-ACT-EXPEN-DEPTS.                                     07100000
071800                                                                  07110000
071900     EXEC SQL                                                     07120000
072000         SELECT A.DEPT_NBR                                        07130000
072100              , B.ORGUNT_NAME                                     07140000
072200           INTO :VNDDPT-DEPT-NBR                                  07150000
072300              , :ORGUNT-ORGUNT-NAME                               07160000
072400           FROM TVNDDPT A                                         07170000
072500              , TORGUNT B                                         07180000
072600          WHERE A.DEPT_NBR         = B.ORGUNT_NICK_NAME           07190000
072700            AND A.ENT_ID           = :VNDDPT-ENT-ID               07200000
072800            AND A.VND_DEPT_STAT_CD = 'A'                          07210000
072900            AND B.ORGUNT_TYP_CDE   = '01'                         07220000
073000     END-EXEC.                                                    07230000
073100                                                                  07240000
073200     EVALUATE TRUE                                                07250000
073300         WHEN SQLCODE = ZERO                                      07260000
073400             MOVE VNDDPT-DEPT-NBR     TO VN005-DEPT-NBR           07270000
073500             MOVE ORGUNT-ORGUNT-NAME  TO VN005-DEPT-DESC          07280000
073600             SET PS-CONTINUE-PROCESSING TO TRUE                   07290000
073700         WHEN SQLCODE = -811                                      07300000
073800             SET VN005-MULTIPLE-DEPTS                             07310000
073900                 VN005-MULTIPLE-DESC                              07320000
074000                 PS-CONTINUE-PROCESSING TO TRUE                   07330000
074100         WHEN SQLCODE = +100                                      07340000
074200             CONTINUE                                             07350000
074300         WHEN OTHER                                               07360000
074400             DISPLAY 'VENDOR NAME: ' VN010-ENT-NAME-DESC          07370000
074500             DISPLAY 'VENDOR NBR : ' VN010-DUN-NBR                07380000
074600             SET AC-UNSUCCESSFUL-SELECT    TO TRUE                07390000
074700             MOVE 'S200-SELECT-ACT-EXPEN-DEPTS  '                 07400000
074800                                           TO AA-PARAGRAPH-NAME   07410000
074900             MOVE 'UNSUCCESSFUL SELECT'    TO AA-DB2-OPERATION    07420000
075000             MOVE 'TVNDDPT'                TO AA-DB2-TABLE-1      07430000
075100             MOVE 'TORGUNT'                TO AA-DB2-TABLE-2      07440000
075200             MOVE SPACE                    TO AA-DB2-TABLE-3      07450000
075300             PERFORM Z998-DB2-ABEND                               07460000
075400     END-EVALUATE.                                                07470000
075500                                                                  07480000
075600*--------------------------------------------------------------*  07490000
075700*  SELECT MERCHANDISE VENDOR ADDRESS INFORMATION               *  07500000
075800*--------------------------------------------------------------*  07510000
075900 S300-SELECT-MERCH-ADDRESS.                                       07520000
076000                                                                  07530000
076100     SET PS-YES-ADDRESS-CONTENT TO TRUE.                          07540000
076200                                                                  07550000
076300     EXEC SQL                                                     07560000
076400         SELECT B.FUNCTION_NAME                                   07570000
076500              , A.ADDRESS_LINE1_DESC                              07580000
076600              , A.ADDRESS_LINE2_DESC                              07590000
076700              , A.ADDRESS_LINE3_DESC                              07600000
076800              , A.ADDRESS_LINE4_DESC                              07610000
076900              , A.CITY_NAME                                       07620000
077000              , A.STATE_CDE                                       07630000
077100              , A.ZIP_CDE                                         07640000
077200              , A.ROOM_NBR                                        07650000
077300              , A.ST_PROV_CDE                                     07660000
077400              , A.CNTRY_CDE                                       07670000
077500           INTO :BUSFNC-FUNCTION-NAME                             07680000
077600              , :BUSLOC-ADDRESS-LINE1-DESC                        07690000
077700              , :BUSLOC-ADDRESS-LINE2-DESC                        07700000
077800              , :BUSLOC-ADDRESS-LINE3-DESC                        07710000
077900              , :BUSLOC-ADDRESS-LINE4-DESC                        07720000
078000              , :BUSLOC-CITY-NAME                                 07730000
078100              , :BUSLOC-STATE-CDE                                 07740000
078200              , :BUSLOC-ZIP-CDE                                   07750000
078300              , :BUSLOC-ROOM-NBR                                  07760000
078400              , :BUSLOC-ST-PROV-CDE                               07770000
078500              , :BUSLOC-CNTRY-CDE                                 07780000
078600           FROM TBUSLOC A                                         07790000
078700              , TBUSFNC B                                         07800000
078800          WHERE A.FUNCTION_ID      = B.FUNCTION_ID                07810000
078900            AND A.ENT_ID           = :VNDDPT-ENT-ID               07820000
079000            AND A.FUNCTION_ID      = :PV-FUNCTION-ID              07830000
079100            AND A.PRIM_ADDR_IND    = 'Y'                          07840000
079200     END-EXEC.                                                    07850000
079300                                                                  07860000
079400     EVALUATE TRUE                                                07870000
079500         WHEN SQLCODE = ZERO                                      07880000
079600             IF PV-FUNCTION-ID = 4                                07890000
079700                PERFORM T100-CHECK-ADDRESS-CONTENT                07900000
079800                IF PS-NO-ADDRESS-CONTENT                          07910000
079900                   MOVE 1 TO PV-FUNCTION-ID                       07920000
080000                ELSE                                              07930000
080100                   SET PS-ADDRESS-FOUND TO TRUE                   07940000
080200                END-IF                                            07950000
080300             ELSE                                                 07960000
080400                IF PV-FUNCTION-ID = 1                             07970000
080500                   PERFORM T100-CHECK-ADDRESS-CONTENT             07980000
080600                   IF PS-NO-ADDRESS-CONTENT                       07990000
080700                      MOVE 2 TO PV-FUNCTION-ID                    08000000
080800                   ELSE                                           08010000
080900                      SET PS-ADDRESS-FOUND TO TRUE                08020000
081000                   END-IF                                         08030000
081100                ELSE                                              08040000
081200                   IF PV-FUNCTION-ID = 2                          08050000
081300                      PERFORM T100-CHECK-ADDRESS-CONTENT          08060000
081400                      IF PS-NO-ADDRESS-CONTENT                    08070000
081500                         MOVE 15 TO PV-FUNCTION-ID                08080000
081600                      ELSE                                        08090000
081700                         SET PS-ADDRESS-FOUND TO TRUE             08100000
081800                      END-IF                                      08110000
081900                   ELSE                                           08120000
082000                      IF PV-FUNCTION-ID = 15                      08130000
082100                         PERFORM T100-CHECK-ADDRESS-CONTENT       08140000
082200                         IF PS-NO-ADDRESS-CONTENT                 08150000
082300                            MOVE 10 TO PV-FUNCTION-ID             08160000
082400                         ELSE                                     08170000
082500                            SET PS-ADDRESS-FOUND TO TRUE          08180000
082600                         END-IF                                   08190000
082700                      ELSE                                        08200000
082800                         IF PV-FUNCTION-ID = 10                   08210000
082900                            PERFORM T100-CHECK-ADDRESS-CONTENT    08220000
083000                            IF PS-NO-ADDRESS-CONTENT              08230000
083100                               MOVE 14 TO PV-FUNCTION-ID          08240000
083200                            ELSE                                  08250000
083300                               SET PS-ADDRESS-FOUND TO TRUE       08260000
083400                            END-IF                                08270000
083500                         ELSE                                     08280000
083600                            IF PV-FUNCTION-ID = 14                08290000
083700                               PERFORM T100-CHECK-ADDRESS-CONTENT 08300000
083800                               IF PS-NO-ADDRESS-CONTENT           08310000
083900                                  SET PS-NO-ADDRESS-FOUND TO TRUE 08320000
084000                               ELSE                               08330000
084100                                  SET PS-ADDRESS-FOUND TO TRUE    08340000
084200                               END-IF                             08350000
084300                            END-IF                                08360000
084400                         END-IF                                   08370000
084500                      END-IF                                      08380000
084600                   END-IF                                         08390000
084700                END-IF                                            08400000
084800             END-IF                                               08410000
084900         WHEN SQLCODE = +100                                      08420000
085000             IF PV-FUNCTION-ID = 4                                08430000
085100                MOVE 1 TO PV-FUNCTION-ID                          08440000
085200             ELSE                                                 08450000
085300                IF PV-FUNCTION-ID = 1                             08460000
085400                   MOVE 2 TO PV-FUNCTION-ID                       08470000
085500                ELSE                                              08480000
085600                   IF PV-FUNCTION-ID = 2                          08490000
085700                      MOVE 15 TO PV-FUNCTION-ID                   08500000
085800                   ELSE                                           08510000
085900                      IF PV-FUNCTION-ID = 15                      08520000
086000                         MOVE 10 TO PV-FUNCTION-ID                08530000
086100                      ELSE                                        08540000
086200                         IF PV-FUNCTION-ID = 10                   08550000
086300                            MOVE 14 TO PV-FUNCTION-ID             08560000
086400                         ELSE                                     08570000
086500                            IF PV-FUNCTION-ID = 14                08580000
086600                               SET PS-NO-ADDRESS-FOUND TO TRUE    08590000
086700                            END-IF                                08600000
086800                         END-IF                                   08610000
086900                      END-IF                                      08620000
087000                   END-IF                                         08630000
087100                END-IF                                            08640000
087200             END-IF                                               08650000
087300         WHEN OTHER                                               08660000
087400             DISPLAY 'VENDOR NAME: ' VN010-ENT-NAME-DESC          08670000
087500             DISPLAY 'VENDOR NBR : ' VN010-DUN-NBR                08680000
087600             SET AC-UNSUCCESSFUL-SELECT    TO TRUE                08690000
087700             MOVE 'S300-SELECT-MERCH-ADDRESS    '                 08700000
087800                                           TO AA-PARAGRAPH-NAME   08710000
087900             MOVE 'UNSUCCESSFUL SELECT'    TO AA-DB2-OPERATION    08720000
088000             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-1      08730000
088100             MOVE 'TBUSFNC'                TO AA-DB2-TABLE-2      08740000
088200             MOVE SPACE                    TO AA-DB2-TABLE-3      08750000
088300             PERFORM Z998-DB2-ABEND                               08760000
088400     END-EVALUATE.                                                08770000
088500                                                                  08780000
088600*--------------------------------------------------------------*  08790000
088700*  SELECT EXPENSE VENDOR ADDRESS INFORMATION                   *  08800000
088800*--------------------------------------------------------------*  08810000
088900 S400-SELECT-EXPEN-ADDRESS.                                       08820000
089000                                                                  08830000
089100     SET PS-YES-ADDRESS-CONTENT TO TRUE.                          08840000
089200                                                                  08850000
089300     EXEC SQL                                                     08860000
089400         SELECT B.FUNCTION_NAME                                   08870000
089500              , A.ADDRESS_LINE1_DESC                              08880000
089600              , A.ADDRESS_LINE2_DESC                              08890000
089700              , A.ADDRESS_LINE3_DESC                              08900000
089800              , A.ADDRESS_LINE4_DESC                              08910000
089900              , A.CITY_NAME                                       08920000
090000              , A.STATE_CDE                                       08930000
090100              , A.ZIP_CDE                                         08940000
090200              , A.ROOM_NBR                                        08950000
090300              , A.ST_PROV_CDE                                     08960000
090400              , A.CNTRY_CDE                                       08970000
090500           INTO :BUSFNC-FUNCTION-NAME                             08980000
090600              , :BUSLOC-ADDRESS-LINE1-DESC                        08990000
090700              , :BUSLOC-ADDRESS-LINE2-DESC                        09000000
090800              , :BUSLOC-ADDRESS-LINE3-DESC                        09010000
090900              , :BUSLOC-ADDRESS-LINE4-DESC                        09020000
091000              , :BUSLOC-CITY-NAME                                 09030000
091100              , :BUSLOC-STATE-CDE                                 09040000
091200              , :BUSLOC-ZIP-CDE                                   09050000
091300              , :BUSLOC-ROOM-NBR                                  09060000
091400              , :BUSLOC-ST-PROV-CDE                               09070000
091500              , :BUSLOC-CNTRY-CDE                                 09080000
091600           FROM TBUSLOC A                                         09090000
091700              , TBUSFNC B                                         09100000
091800          WHERE A.FUNCTION_ID      = B.FUNCTION_ID                09110000
091900            AND A.ENT_ID           = :VNDDPT-ENT-ID               09120000
092000            AND A.FUNCTION_ID      = :PV-FUNCTION-ID              09130000
092100            AND A.SEQ_NBR          =                              09140000
092200                (SELECT MAX(C.SEQ_NBR)                            09150000
092300                   FROM TBUSLOC C                                 09160000
092400                  WHERE C.ENT_ID      = A.ENT_ID                  09170000
092500                    AND C.FUNCTION_ID = A.FUNCTION_ID)            09180000
092600     END-EXEC.                                                    09190000
092700                                                                  09200000
092800     EVALUATE TRUE                                                09210000
092900         WHEN SQLCODE = ZERO                                      09220000
093000             IF PV-FUNCTION-ID = 2                                09230000
093100                PERFORM T100-CHECK-ADDRESS-CONTENT                09240000
093200                IF PS-NO-ADDRESS-CONTENT                          09250000
093300                   MOVE 1 TO PV-FUNCTION-ID                       09260000
093400                ELSE                                              09270000
093500                   SET PS-ADDRESS-FOUND TO TRUE                   09280000
093600                END-IF                                            09290000
093700             ELSE                                                 09300000
093800                IF PV-FUNCTION-ID = 1                             09310000
093900                   PERFORM T100-CHECK-ADDRESS-CONTENT             09320000
094000                   IF PS-NO-ADDRESS-CONTENT                       09330000
094100                      MOVE 7 TO PV-FUNCTION-ID                    09340000
094200                   ELSE                                           09350000
094300                      SET PS-ADDRESS-FOUND TO TRUE                09360000
094400                   END-IF                                         09370000
094500                ELSE                                              09380000
094600                   IF PV-FUNCTION-ID = 7                          09390000
094700                      PERFORM T100-CHECK-ADDRESS-CONTENT          09400000
094800                      IF PS-NO-ADDRESS-CONTENT                    09410000
094900                         MOVE 9 TO PV-FUNCTION-ID                 09420000
095000                      ELSE                                        09430000
095100                         SET PS-ADDRESS-FOUND TO TRUE             09440000
095200                      END-IF                                      09450000
095300                   ELSE                                           09460000
095400                      IF PV-FUNCTION-ID = 9                       09470000
095500                         PERFORM T100-CHECK-ADDRESS-CONTENT       09480000
095600                         IF PS-NO-ADDRESS-CONTENT                 09490000
095700                            SET PS-NO-ADDRESS-FOUND TO TRUE       09500000
095800                         ELSE                                     09510000
095900                            SET PS-ADDRESS-FOUND TO TRUE          09520000
096000                         END-IF                                   09530000
096100                      END-IF                                      09540000
096200                   END-IF                                         09550000
096300                END-IF                                            09560000
096400             END-IF                                               09570000
096500         WHEN SQLCODE = +100                                      09580000
096600             IF PV-FUNCTION-ID = 2                                09590000
096700                MOVE 1 TO PV-FUNCTION-ID                          09600000
096800             ELSE                                                 09610000
096900                IF PV-FUNCTION-ID = 1                             09620000
097000                   MOVE 7 TO PV-FUNCTION-ID                       09630000
097100                ELSE                                              09640000
097200                   IF PV-FUNCTION-ID = 7                          09650000
097300                      MOVE 9 TO PV-FUNCTION-ID                    09660000
097400                   ELSE                                           09670000
097500                      IF PV-FUNCTION-ID = 9                       09680000
097600                         SET PS-NO-ADDRESS-FOUND TO TRUE          09690000
097700                      END-IF                                      09700000
097800                   END-IF                                         09710000
097900                END-IF                                            09720000
098000             END-IF                                               09730000
098100         WHEN OTHER                                               09740000
098200             DISPLAY 'VENDOR NAME: ' VN010-ENT-NAME-DESC          09750000
098300             DISPLAY 'VENDOR NBR : ' VN010-DUN-NBR                09760000
098400             SET AC-UNSUCCESSFUL-SELECT    TO TRUE                09770000
098500             MOVE 'S400-SELECT-EXPEN-ADDRESS    '                 09780000
098600                                           TO AA-PARAGRAPH-NAME   09790000
098700             MOVE 'UNSUCCESSFUL SELECT'    TO AA-DB2-OPERATION    09800000
098800             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-1      09810000
098900             MOVE 'TBUSFNC'                TO AA-DB2-TABLE-2      09820000
099000             MOVE SPACE                    TO AA-DB2-TABLE-3      09830000
099100             PERFORM Z998-DB2-ABEND                               09840000
099200     END-EVALUATE.                                                09850000
099300                                                                  09860000
099400                                                                  09870000
099500*--------------------------------------------------------------*  09880000
099600*  SELECT MERCHANDISE VENDOR PRIMARY CONTACT INFORMATION       *  09890000
099700*--------------------------------------------------------------*  09900000
099800 S500-SELECT-MERCH-PRIM-CONTACT.                                  09910000
099900                                                                  09920000
100000     SET PS-YES-CONTACT-CONTENT TO TRUE.                          09930000
100100                                                                  09940000
100200     EXEC SQL                                                     09950000
100300         SELECT C.FUNCTION_NAME                                   09960000
100400              , A.FIRST_NAME                                      09970000
100500              , A.LAST_NAME                                       09980000
100600              , A.TITLE_NAME                                      09990000
100700              , A.TEL1_NBR                                        10000000
100800              , A.TEL1_EXT_NBR                                    10010000
100900              , A.TEL_1_CNTRY_CDE                                 10020000
101000              , A.TEL2_NBR                                        10030000
101100              , A.TEL2_EXT_NBR                                    10040000
101200              , A.TEL_2_CNTRY_CDE                                 10050000
101300              , A.FAX_NBR                                         10060000
101400              , A.EMAIL_ADDR_ID                                   10070000
101500           INTO :BUSFNC-FUNCTION-NAME                             10080000
101600              , :ENTREP-FIRST-NAME                                10090000
101700              , :ENTREP-LAST-NAME                                 10100000
101800              , :ENTREP-TITLE-NAME                                10110000
101900              , :ENTREP-TEL1-NBR                                  10120000
102000              , :ENTREP-TEL1-EXT-NBR                              10130000
102100              , :ENTREP-TEL-1-CNTRY-CDE                           10140000
102200              , :ENTREP-TEL2-NBR                                  10150000
102300              , :ENTREP-TEL2-EXT-NBR                              10160000
102400              , :ENTREP-TEL-2-CNTRY-CDE                           10170000
102500              , :ENTREP-FAX-NBR                                   10180000
102600              , :ENTREP-EMAIL-ADDR-ID                             10190000
102700           FROM TENTREP A                                         10200000
102800              , TBUSLOC B                                         10210000
102900              , TBUSFNC C                                         10220000
103000          WHERE A.ENT_ID           = B.ENT_ID                     10230000
103100            AND A.ENT_BUS_LOC_ID   = B.SEQ_NBR                    10240000
103200            AND A.ENT_ID           = :VNDDPT-ENT-ID               10250000
103300            AND A.FUNCTION_ID      = :PV-FUNCTION-ID              10260000
103400            AND A.FUNCTION_ID      = C.FUNCTION_ID                10270000
103500            AND B.SEQ_NBR          =                              10280000
103600                (SELECT MAX(D.SEQ_NBR)                            10290000
103700                   FROM TBUSLOC D                                 10300000
103800                  WHERE D.ENT_ID      = B.ENT_ID                  10310000
103900                    AND D.FUNCTION_ID = B.FUNCTION_ID)            10320000
104000     END-EXEC.                                                    10330000
104100                                                                  10340000
104200     EVALUATE TRUE                                                10350000
104300         WHEN SQLCODE = ZERO                                      10360000
104400             IF PV-FUNCTION-ID = 4                                10370000
104500                PERFORM T200-CHECK-CONTACT-CONTENT                10380000
104600                IF PS-NO-CONTACT-CONTENT                          10390000
104700                   MOVE 1 TO PV-FUNCTION-ID                       10400000
104800                ELSE                                              10410000
104900                   SET PS-PRIM-CONTACT-FOUND TO TRUE              10420000
105000                END-IF                                            10430000
105100             ELSE                                                 10440000
105200                IF PV-FUNCTION-ID = 1                             10450000
105300                   PERFORM T200-CHECK-CONTACT-CONTENT             10460000
105400                   IF PS-NO-CONTACT-CONTENT                       10470000
105500                      MOVE 2 TO PV-FUNCTION-ID                    10480000
105600                   ELSE                                           10490000
105700                      SET PS-PRIM-CONTACT-FOUND TO TRUE           10500000
105800                   END-IF                                         10510000
105900                ELSE                                              10520000
106000                   IF PV-FUNCTION-ID = 2                          10530000
106100                      PERFORM T200-CHECK-CONTACT-CONTENT          10540000
106200                      IF PS-NO-CONTACT-CONTENT                    10550000
106300                         MOVE 15 TO PV-FUNCTION-ID                10560000
106400                      ELSE                                        10570000
106500                         SET PS-PRIM-CONTACT-FOUND TO TRUE        10580000
106600                      END-IF                                      10590000
106700                   ELSE                                           10600000
106800                      IF PV-FUNCTION-ID = 15                      10610000
106900                         PERFORM T200-CHECK-CONTACT-CONTENT       10620000
107000                         IF PS-NO-CONTACT-CONTENT                 10630000
107100                            MOVE 10 TO PV-FUNCTION-ID             10640000
107200                         ELSE                                     10650000
107300                            SET PS-PRIM-CONTACT-FOUND TO TRUE     10660000
107400                         END-IF                                   10670000
107500                      ELSE                                        10680000
107600                         IF PV-FUNCTION-ID = 10                   10690000
107700                            PERFORM T200-CHECK-CONTACT-CONTENT    10700000
107800                            IF PS-NO-CONTACT-CONTENT              10710000
107900                               MOVE 14 TO PV-FUNCTION-ID          10720000
108000                            ELSE                                  10730000
108100                               SET PS-PRIM-CONTACT-FOUND TO TRUE  10740000
108200                            END-IF                                10750000
108300                         ELSE                                     10760000
108400                            IF PV-FUNCTION-ID = 14                10770000
108500                               PERFORM T200-CHECK-CONTACT-CONTENT 10780000
108600                               IF PS-NO-CONTACT-CONTENT           10790000
108700                                  SET PS-NO-PRIM-CONTACT-FOUND TO 10800000
108800                                       TRUE                       10810000
108900                               ELSE                               10820000
109000                                  SET PS-PRIM-CONTACT-FOUND    TO 10830000
109100                                       TRUE                       10840000
109200                               END-IF                             10850000
109300                            END-IF                                10860000
109400                         END-IF                                   10870000
109500                      END-IF                                      10880000
109600                   END-IF                                         10890000
109700                END-IF                                            10900000
109800             END-IF                                               10910000
109900         WHEN SQLCODE = +100                                      10920000
110000             IF PV-FUNCTION-ID = 4                                10930000
110100                MOVE 1 TO PV-FUNCTION-ID                          10940000
110200             ELSE                                                 10950000
110300                IF PV-FUNCTION-ID = 1                             10960000
110400                   MOVE 2 TO PV-FUNCTION-ID                       10970000
110500                ELSE                                              10980000
110600                   IF PV-FUNCTION-ID = 2                          10990000
110700                      MOVE 15 TO PV-FUNCTION-ID                   11000000
110800                   ELSE                                           11010000
110900                      IF PV-FUNCTION-ID = 15                      11020000
111000                         MOVE 10 TO PV-FUNCTION-ID                11030000
111100                      ELSE                                        11040000
111200                         IF PV-FUNCTION-ID = 10                   11050000
111300                            MOVE 14 TO PV-FUNCTION-ID             11060000
111400                         ELSE                                     11070000
111500                            IF PV-FUNCTION-ID = 14                11080000
111600                              SET PS-NO-PRIM-CONTACT-FOUND TO TRUE11090000
111700                            END-IF                                11100000
111800                         END-IF                                   11110000
111900                      END-IF                                      11120000
112000                   END-IF                                         11130000
112100                END-IF                                            11140000
112200             END-IF                                               11150000
112300         WHEN OTHER                                               11160000
112400             DISPLAY 'VENDOR NAME: ' VN010-ENT-NAME-DESC          11170000
112500             DISPLAY 'VENDOR NBR : ' VN010-DUN-NBR                11180000
112600             SET AC-UNSUCCESSFUL-SELECT    TO TRUE                11190000
112700             MOVE 'S500-SELECT-MERCH-PRIM-CONTACT'                11200000
112800                                           TO AA-PARAGRAPH-NAME   11210000
112900             MOVE 'UNSUCCESSFUL SELECT'    TO AA-DB2-OPERATION    11220000
113000             MOVE 'TENTREP'                TO AA-DB2-TABLE-1      11230000
113100             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-2      11240000
113200             MOVE 'TBUSFNC'                TO AA-DB2-TABLE-3      11250000
113300             PERFORM Z998-DB2-ABEND                               11260000
113400     END-EVALUATE.                                                11270000
113500                                                                  11280000
113600*--------------------------------------------------------------*  11290000
113700*  SELECT EXPENSE VENDOR PRIMARY CONTACT INFORMATION WHERE THE *  11300000
113800*  PRIMARY ADDRESS IND = 'N'                                   *  11310000
113900*--------------------------------------------------------------*  11320000
114000 S600-SELECT-EXPEN-PRIM-CONTACT.                                  11330000
114100                                                                  11340000
114200     SET PS-YES-CONTACT-CONTENT TO TRUE.                          11350000
114300                                                                  11360000
114400     EXEC SQL                                                     11370000
114500         SELECT C.FUNCTION_NAME                                   11380000
114600              , A.FIRST_NAME                                      11390000
114700              , A.LAST_NAME                                       11400000
114800              , A.TITLE_NAME                                      11410000
114900              , A.TEL1_NBR                                        11420000
115000              , A.TEL1_EXT_NBR                                    11430000
115100              , A.TEL_1_CNTRY_CDE                                 11440000
115200              , A.TEL2_NBR                                        11450000
115300              , A.TEL2_EXT_NBR                                    11460000
115400              , A.TEL_2_CNTRY_CDE                                 11470000
115500              , A.FAX_NBR                                         11480000
115600              , A.EMAIL_ADDR_ID                                   11490000
115700           INTO :BUSFNC-FUNCTION-NAME                             11500000
115800              , :ENTREP-FIRST-NAME                                11510000
115900              , :ENTREP-LAST-NAME                                 11520000
116000              , :ENTREP-TITLE-NAME                                11530000
116100              , :ENTREP-TEL1-NBR                                  11540000
116200              , :ENTREP-TEL1-EXT-NBR                              11550000
116300              , :ENTREP-TEL-1-CNTRY-CDE                           11560000
116400              , :ENTREP-TEL2-NBR                                  11570000
116500              , :ENTREP-TEL2-EXT-NBR                              11580000
116600              , :ENTREP-TEL-2-CNTRY-CDE                           11590000
116700              , :ENTREP-FAX-NBR                                   11600000
116800              , :ENTREP-EMAIL-ADDR-ID                             11610000
116900           FROM TENTREP A                                         11620000
117000              , TBUSLOC B                                         11630000
117100              , TBUSFNC C                                         11640000
117200          WHERE A.ENT_ID           = B.ENT_ID                     11650000
117300            AND A.ENT_BUS_LOC_ID   = B.SEQ_NBR                    11660000
117400            AND A.ENT_ID           = :VNDDPT-ENT-ID               11670000
117500            AND A.FUNCTION_ID      = :PV-FUNCTION-ID              11680000
117600            AND A.FUNCTION_ID      = C.FUNCTION_ID                11690000
117700            AND B.SEQ_NBR          =                              11700000
117800                (SELECT MAX(D.SEQ_NBR)                            11710000
117900                   FROM TBUSLOC D                                 11720000
118000                  WHERE D.ENT_ID      = B.ENT_ID                  11730000
118100                    AND D.FUNCTION_ID = B.FUNCTION_ID)            11740000
118200     END-EXEC.                                                    11750000
118300                                                                  11760000
118400     EVALUATE TRUE                                                11770000
118500         WHEN SQLCODE = ZERO                                      11780000
118600             IF PV-FUNCTION-ID = 2                                11790000
118700                PERFORM T200-CHECK-CONTACT-CONTENT                11800000
118800                IF PS-NO-CONTACT-CONTENT                          11810000
118900                   MOVE 1 TO PV-FUNCTION-ID                       11820000
119000                ELSE                                              11830000
119100                   SET PS-PRIM-CONTACT-FOUND TO TRUE              11840000
119200                END-IF                                            11850000
119300             ELSE                                                 11860000
119400                IF PV-FUNCTION-ID = 1                             11870000
119500                   PERFORM T200-CHECK-CONTACT-CONTENT             11880000
119600                   IF PS-NO-CONTACT-CONTENT                       11890000
119700                      MOVE 7 TO PV-FUNCTION-ID                    11900000
119800                   ELSE                                           11910000
119900                      SET PS-PRIM-CONTACT-FOUND TO TRUE           11920000
120000                   END-IF                                         11930000
120100                ELSE                                              11940000
120200                   IF PV-FUNCTION-ID = 7                          11950000
120300                      PERFORM T200-CHECK-CONTACT-CONTENT          11960000
120400                      IF PS-NO-CONTACT-CONTENT                    11970000
120500                         MOVE 9 TO PV-FUNCTION-ID                 11980000
120600                      ELSE                                        11990000
120700                         SET PS-PRIM-CONTACT-FOUND TO TRUE        12000000
120800                      END-IF                                      12010000
120900                   ELSE                                           12020000
121000                      IF PV-FUNCTION-ID = 9                       12030000
121100                         PERFORM T200-CHECK-CONTACT-CONTENT       12040000
121200                         IF PS-NO-CONTACT-CONTENT                 12050000
121300                            SET PS-NO-PRIM-CONTACT-FOUND TO TRUE  12060000
121400                         ELSE                                     12070000
121500                            SET PS-PRIM-CONTACT-FOUND    TO TRUE  12080000
121600                         END-IF                                   12090000
121700                      END-IF                                      12100000
121800                   END-IF                                         12110000
121900                END-IF                                            12120000
122000             END-IF                                               12130000
122100         WHEN SQLCODE = +100                                      12140000
122200             IF PV-FUNCTION-ID = 2                                12150000
122300                MOVE 1 TO PV-FUNCTION-ID                          12160000
122400             ELSE                                                 12170000
122500                IF PV-FUNCTION-ID = 1                             12180000
122600                   MOVE 7 TO PV-FUNCTION-ID                       12190000
122700                ELSE                                              12200000
122800                   IF PV-FUNCTION-ID = 7                          12210000
122900                      MOVE 9 TO PV-FUNCTION-ID                    12220000
123000                   ELSE                                           12230000
123100                      IF PV-FUNCTION-ID = 9                       12240000
123200                         SET PS-NO-PRIM-CONTACT-FOUND TO TRUE     12250000
123300                      END-IF                                      12260000
123400                   END-IF                                         12270000
123500                END-IF                                            12280000
123600             END-IF                                               12290000
123700         WHEN SQLCODE = -811                                      12300000
123800             PERFORM S650-SELECT-EXPEN-PRIM-CNTCT-Y UNTIL         12310000
123900                 PS-PRIM-CONTACT-FOUND OR PS-NO-PRIM-CONTACT-FOUND12320000
124000         WHEN OTHER                                               12330000
124100             DISPLAY 'VENDOR NAME: ' VN010-ENT-NAME-DESC          12340000
124200             DISPLAY 'VENDOR NBR : ' VN010-DUN-NBR                12350000
124300             SET AC-UNSUCCESSFUL-SELECT    TO TRUE                12360000
124400             MOVE 'S600-SELECT-EXPEN-PRIM-CONTACT'                12370000
124500                                           TO AA-PARAGRAPH-NAME   12380000
124600             MOVE 'UNSUCCESSFUL SELECT'    TO AA-DB2-OPERATION    12390000
124700             MOVE 'TENTREP'                TO AA-DB2-TABLE-1      12400000
124800             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-2      12410000
124900             MOVE 'TBUSFNC'                TO AA-DB2-TABLE-3      12420000
125000             PERFORM Z998-DB2-ABEND                               12430000
125100     END-EVALUATE.                                                12440000
125200                                                                  12450000
125300*--------------------------------------------------------------*  12460000
125400*  SELECT EXPENSE VENDOR PRIMARY CONTACT INFORMATION WHERE THE *  12470000
125500*  PRIMARY ADDRESS IND = 'Y'                                   *  12480000
125600*--------------------------------------------------------------*  12490000
125700 S650-SELECT-EXPEN-PRIM-CNTCT-Y.                                  12500000
125800                                                                  12510000
125900     SET PS-YES-CONTACT-CONTENT TO TRUE.                          12520000
126000                                                                  12530000
126100     EXEC SQL                                                     12540000
126200         SELECT C.FUNCTION_NAME                                   12550000
126300              , A.FIRST_NAME                                      12560000
126400              , A.LAST_NAME                                       12570000
126500              , A.TITLE_NAME                                      12580000
126600              , A.TEL1_NBR                                        12590000
126700              , A.TEL1_EXT_NBR                                    12600000
126800              , A.TEL_1_CNTRY_CDE                                 12610000
126900              , A.TEL2_NBR                                        12620000
127000              , A.TEL2_EXT_NBR                                    12630000
127100              , A.TEL_2_CNTRY_CDE                                 12640000
127200              , A.FAX_NBR                                         12650000
127300              , A.EMAIL_ADDR_ID                                   12660000
127400           INTO :BUSFNC-FUNCTION-NAME                             12670000
127500              , :ENTREP-FIRST-NAME                                12680000
127600              , :ENTREP-LAST-NAME                                 12690000
127700              , :ENTREP-TITLE-NAME                                12700000
127800              , :ENTREP-TEL1-NBR                                  12710000
127900              , :ENTREP-TEL1-EXT-NBR                              12720000
128000              , :ENTREP-TEL-1-CNTRY-CDE                           12730000
128100              , :ENTREP-TEL2-NBR                                  12740000
128200              , :ENTREP-TEL2-EXT-NBR                              12750000
128300              , :ENTREP-TEL-2-CNTRY-CDE                           12760000
128400              , :ENTREP-FAX-NBR                                   12770000
128500              , :ENTREP-EMAIL-ADDR-ID                             12780000
128600           FROM TENTREP A                                         12790000
128700              , TBUSLOC B                                         12800000
128800              , TBUSFNC C                                         12810000
128900          WHERE A.ENT_ID           = B.ENT_ID                     12820000
129000            AND A.ENT_BUS_LOC_ID   = B.SEQ_NBR                    12830000
129100            AND A.ENT_ID           = :VNDDPT-ENT-ID               12840000
129200            AND A.FUNCTION_ID      = :PV-FUNCTION-ID              12850000
129300            AND A.FUNCTION_ID      = C.FUNCTION_ID                12860000
129400            AND B.SEQ_NBR          =                              12870000
129500                (SELECT MAX(D.SEQ_NBR)                            12880000
129600                   FROM TBUSLOC D                                 12890000
129700                  WHERE D.ENT_ID      = B.ENT_ID                  12900000
129800                    AND D.FUNCTION_ID = B.FUNCTION_ID)            12910000
129900     END-EXEC.                                                    12920000
130000                                                                  12930000
130100     EVALUATE TRUE                                                12940000
130200         WHEN SQLCODE = ZERO                                      12950000
130300             IF PV-FUNCTION-ID = 2                                12960000
130400                PERFORM T200-CHECK-CONTACT-CONTENT                12970000
130500                IF PS-NO-CONTACT-CONTENT                          12980000
130600                   MOVE 1 TO PV-FUNCTION-ID                       12990000
130700                ELSE                                              13000000
130800                   SET PS-PRIM-CONTACT-FOUND TO TRUE              13010000
130900                END-IF                                            13020000
131000             ELSE                                                 13030000
131100                IF PV-FUNCTION-ID = 1                             13040000
131200                   PERFORM T200-CHECK-CONTACT-CONTENT             13050000
131300                   IF PS-NO-CONTACT-CONTENT                       13060000
131400                      MOVE 7 TO PV-FUNCTION-ID                    13070000
131500                   ELSE                                           13080000
131600                      SET PS-PRIM-CONTACT-FOUND TO TRUE           13090000
131700                   END-IF                                         13100000
131800                ELSE                                              13110000
131900                   IF PV-FUNCTION-ID = 7                          13120000
132000                      PERFORM T200-CHECK-CONTACT-CONTENT          13130000
132100                      IF PS-NO-CONTACT-CONTENT                    13140000
132200                         MOVE 9 TO PV-FUNCTION-ID                 13150000
132300                      ELSE                                        13160000
132400                         SET PS-PRIM-CONTACT-FOUND TO TRUE        13170000
132500                      END-IF                                      13180000
132600                   ELSE                                           13190000
132700                      IF PV-FUNCTION-ID = 9                       13200000
132800                         PERFORM T200-CHECK-CONTACT-CONTENT       13210000
132900                         IF PS-NO-CONTACT-CONTENT                 13220000
133000                            SET PS-NO-PRIM-CONTACT-FOUND TO TRUE  13230000
133100                         ELSE                                     13240000
133200                            SET PS-PRIM-CONTACT-FOUND    TO TRUE  13250000
133300                         END-IF                                   13260000
133400                      END-IF                                      13270000
133500                   END-IF                                         13280000
133600                END-IF                                            13290000
133700             END-IF                                               13300000
133800         WHEN SQLCODE = +100                                      13310000
133900             IF PV-FUNCTION-ID = 2                                13320000
134000                MOVE 1 TO PV-FUNCTION-ID                          13330000
134100             ELSE                                                 13340000
134200                IF PV-FUNCTION-ID = 1                             13350000
134300                   MOVE 7 TO PV-FUNCTION-ID                       13360000
134400                ELSE                                              13370000
134500                   IF PV-FUNCTION-ID = 7                          13380000
134600                      MOVE 9 TO PV-FUNCTION-ID                    13390000
134700                   ELSE                                           13400000
134800                      IF PV-FUNCTION-ID = 9                       13410000
134900                         SET PS-NO-PRIM-CONTACT-FOUND TO TRUE     13420000
135000                      END-IF                                      13430000
135100                   END-IF                                         13440000
135200                END-IF                                            13450000
135300             END-IF                                               13460000
135400         WHEN OTHER                                               13470000
135500             DISPLAY 'VENDOR NAME: ' VN010-ENT-NAME-DESC          13480000
135600             DISPLAY 'VENDOR NBR : ' VN010-DUN-NBR                13490000
135700             SET AC-UNSUCCESSFUL-SELECT    TO TRUE                13500000
135800             MOVE 'S600-SELECT-EXPEN-PRIM-CNTCT-Y'                13510000
135900                                           TO AA-PARAGRAPH-NAME   13520000
136000             MOVE 'UNSUCCESSFUL SELECT'    TO AA-DB2-OPERATION    13530000
136100             MOVE 'TENTREP'                TO AA-DB2-TABLE-1      13540000
136200             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-2      13550000
136300             MOVE 'TBUSFNC'                TO AA-DB2-TABLE-3      13560000
136400             PERFORM Z998-DB2-ABEND                               13570000
136500     END-EVALUATE.                                                13580000
136600                                                                  13590000
136700*--------------------------------------------------------------*  13600000
136800*  SELECT MERCHANDISE VENDOR ALTERNATE CONTACT INFORMATION     *  13610000
136900*--------------------------------------------------------------*  13620000
137000 S700-SELECT-MERCH-ALT-CONTACT.                                   13630000
137100                                                                  13640000
137200     SET PS-YES-CONTACT-CONTENT TO TRUE.                          13650000
137300                                                                  13660000
137400     EXEC SQL                                                     13670000
137500         SELECT C.FUNCTION_NAME                                   13680000
137600              , A.FIRST_NAME                                      13690000
137700              , A.LAST_NAME                                       13700000
137800              , A.TITLE_NAME                                      13710000
137900              , A.TEL1_NBR                                        13720000
138000              , A.TEL1_EXT_NBR                                    13730000
138100              , A.TEL_1_CNTRY_CDE                                 13740000
138200              , A.TEL2_NBR                                        13750000
138300              , A.TEL2_EXT_NBR                                    13760000
138400              , A.TEL_2_CNTRY_CDE                                 13770000
138500              , A.FAX_NBR                                         13780000
138600              , A.EMAIL_ADDR_ID                                   13790000
138700           INTO :BUSFNC-FUNCTION-NAME                             13800000
138800              , :ENTREP-FIRST-NAME                                13810000
138900              , :ENTREP-LAST-NAME                                 13820000
139000              , :ENTREP-TITLE-NAME                                13830000
139100              , :ENTREP-TEL1-NBR                                  13840000
139200              , :ENTREP-TEL1-EXT-NBR                              13850000
139300              , :ENTREP-TEL-1-CNTRY-CDE                           13860000
139400              , :ENTREP-TEL2-NBR                                  13870000
139500              , :ENTREP-TEL2-EXT-NBR                              13880000
139600              , :ENTREP-TEL-2-CNTRY-CDE                           13890000
139700              , :ENTREP-FAX-NBR                                   13900000
139800              , :ENTREP-EMAIL-ADDR-ID                             13910000
139900           FROM TENTREP A                                         13920000
140000              , TBUSLOC B                                         13930000
140100              , TBUSFNC C                                         13940000
140200          WHERE A.ENT_ID           = B.ENT_ID                     13950000
140300            AND A.ENT_BUS_LOC_ID   = B.SEQ_NBR                    13960000
140400            AND A.ENT_ID           = :VNDDPT-ENT-ID               13970000
140500            AND A.FUNCTION_ID      = :PV-FUNCTION-ID              13980000
140600            AND A.FUNCTION_ID      = C.FUNCTION_ID                13990000
140700            AND B.SEQ_NBR          =                              14000000
140800                (SELECT MAX(D.SEQ_NBR)                            14010000
140900                   FROM TBUSLOC D                                 14020000
141000                  WHERE D.ENT_ID      = B.ENT_ID                  14030000
141100                    AND D.FUNCTION_ID = B.FUNCTION_ID)            14040000
141200     END-EXEC.                                                    14050000
141300                                                                  14060000
141400     EVALUATE TRUE                                                14070000
141500         WHEN SQLCODE = ZERO                                      14080000
141600             IF PV-FUNCTION-ID = 1                                14090000
141700                PERFORM T200-CHECK-CONTACT-CONTENT                14100000
141800                IF PS-NO-CONTACT-CONTENT                          14110000
141900                   MOVE 2 TO PV-FUNCTION-ID                       14120000
142000                ELSE                                              14130000
142100                   SET PS-ALT-CONTACT-FOUND TO TRUE               14140000
142200                END-IF                                            14150000
142300             ELSE                                                 14160000
142400                IF PV-FUNCTION-ID = 2                             14170000
142500                   PERFORM T200-CHECK-CONTACT-CONTENT             14180000
142600                   IF PS-NO-CONTACT-CONTENT                       14190000
142700                      MOVE 15 TO PV-FUNCTION-ID                   14200000
142800                   ELSE                                           14210000
142900                      SET PS-ALT-CONTACT-FOUND TO TRUE            14220000
143000                   END-IF                                         14230000
143100                ELSE                                              14240000
143200                   IF PV-FUNCTION-ID = 15                         14250000
143300                      PERFORM T200-CHECK-CONTACT-CONTENT          14260000
143400                      IF PS-NO-CONTACT-CONTENT                    14270000
143500                         MOVE 10 TO PV-FUNCTION-ID                14280000
143600                      ELSE                                        14290000
143700                         SET PS-ALT-CONTACT-FOUND TO TRUE         14300000
143800                      END-IF                                      14310000
143900                   ELSE                                           14320000
144000                      IF PV-FUNCTION-ID = 10                      14330000
144100                         PERFORM T200-CHECK-CONTACT-CONTENT       14340000
144200                         IF PS-NO-CONTACT-CONTENT                 14350000
144300                            MOVE 14 TO PV-FUNCTION-ID             14360000
144400                         ELSE                                     14370000
144500                            SET PS-ALT-CONTACT-FOUND TO TRUE      14380000
144600                         END-IF                                   14390000
144700                      ELSE                                        14400000
144800                         IF PV-FUNCTION-ID = 14                   14410000
144900                            PERFORM T200-CHECK-CONTACT-CONTENT    14420000
145000                            IF PS-NO-CONTACT-CONTENT              14430000
145100                               MOVE 3 TO PV-FUNCTION-ID           14440000
145200                            ELSE                                  14450000
145300                               SET PS-ALT-CONTACT-FOUND TO TRUE   14460000
145400                            END-IF                                14470000
145500                         ELSE                                     14480000
145600                            IF PV-FUNCTION-ID = 3                 14490000
145700                               PERFORM T200-CHECK-CONTACT-CONTENT 14500000
145800                               IF PS-NO-CONTACT-CONTENT           14510000
145900                                  SET PS-NO-ALT-CONTACT-FOUND TO  14520000
146000                                       TRUE                       14530000
146100                               ELSE                               14540000
146200                                  SET PS-ALT-CONTACT-FOUND    TO  14550000
146300                                       TRUE                       14560000
146400                               END-IF                             14570000
146500                            END-IF                                14580000
146600                         END-IF                                   14590000
146700                      END-IF                                      14600000
146800                   END-IF                                         14610000
146900                END-IF                                            14620000
147000             END-IF                                               14630000
147100         WHEN SQLCODE = +100                                      14640000
147200             IF PV-FUNCTION-ID = 1                                14650000
147300                MOVE 2 TO PV-FUNCTION-ID                          14660000
147400             ELSE                                                 14670000
147500                IF PV-FUNCTION-ID = 2                             14680000
147600                   MOVE 15 TO PV-FUNCTION-ID                      14690000
147700                ELSE                                              14700000
147800                   IF PV-FUNCTION-ID = 15                         14710000
147900                      MOVE 10 TO PV-FUNCTION-ID                   14720000
148000                   ELSE                                           14730000
148100                      IF PV-FUNCTION-ID = 10                      14740000
148200                         MOVE 14 TO PV-FUNCTION-ID                14750000
148300                      ELSE                                        14760000
148400                         IF PV-FUNCTION-ID = 14                   14770000
148500                            MOVE 3 TO PV-FUNCTION-ID              14780000
148600                         ELSE                                     14790000
148700                            IF PV-FUNCTION-ID = 3                 14800000
148800                               SET PS-NO-ALT-CONTACT-FOUND TO TRUE14810000
148900                            END-IF                                14820000
149000                         END-IF                                   14830000
149100                      END-IF                                      14840000
149200                   END-IF                                         14850000
149300                END-IF                                            14860000
149400             END-IF                                               14870000
149500         WHEN OTHER                                               14880000
149600             DISPLAY 'VENDOR NAME: ' VN010-ENT-NAME-DESC          14890000
149700             DISPLAY 'VENDOR NBR : ' VN010-DUN-NBR                14900000
149800             SET AC-UNSUCCESSFUL-SELECT    TO TRUE                14910000
149900             MOVE 'S700-SELECT-MERCH-ALT-CONTACT '                14920000
150000                                           TO AA-PARAGRAPH-NAME   14930000
150100             MOVE 'UNSUCCESSFUL SELECT'    TO AA-DB2-OPERATION    14940000
150200             MOVE 'TENTREP'                TO AA-DB2-TABLE-1      14950000
150300             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-2      14960000
150400             MOVE 'TBUSFNC'                TO AA-DB2-TABLE-3      14970000
150500             PERFORM Z998-DB2-ABEND                               14980000
150600     END-EVALUATE.                                                14990000
150700                                                                  15000000
150800*--------------------------------------------------------------*  15010000
150900*  SELECT EXPENSE VENDOR ALTERNATE CONTACT INFORMATION         *  15020000
151000*--------------------------------------------------------------*  15030000
151100 S800-SELECT-EXPEN-ALT-CONTACT.                                   15040000
151200                                                                  15050000
151300     SET PS-YES-CONTACT-CONTENT TO TRUE.                          15060000
151400                                                                  15070000
151500     EXEC SQL                                                     15080000
151600         SELECT C.FUNCTION_NAME                                   15090000
151700              , A.FIRST_NAME                                      15100000
151800              , A.LAST_NAME                                       15110000
151900              , A.TITLE_NAME                                      15120000
152000              , A.TEL1_NBR                                        15130000
152100              , A.TEL1_EXT_NBR                                    15140000
152200              , A.TEL_1_CNTRY_CDE                                 15150000
152300              , A.TEL2_NBR                                        15160000
152400              , A.TEL2_EXT_NBR                                    15170000
152500              , A.TEL_2_CNTRY_CDE                                 15180000
152600              , A.FAX_NBR                                         15190000
152700              , A.EMAIL_ADDR_ID                                   15200000
152800           INTO :BUSFNC-FUNCTION-NAME                             15210000
152900              , :ENTREP-FIRST-NAME                                15220000
153000              , :ENTREP-LAST-NAME                                 15230000
153100              , :ENTREP-TITLE-NAME                                15240000
153200              , :ENTREP-TEL1-NBR                                  15250000
153300              , :ENTREP-TEL1-EXT-NBR                              15260000
153400              , :ENTREP-TEL-1-CNTRY-CDE                           15270000
153500              , :ENTREP-TEL2-NBR                                  15280000
153600              , :ENTREP-TEL2-EXT-NBR                              15290000
153700              , :ENTREP-TEL-2-CNTRY-CDE                           15300000
153800              , :ENTREP-FAX-NBR                                   15310000
153900              , :ENTREP-EMAIL-ADDR-ID                             15320000
154000           FROM TENTREP A                                         15330000
154100              , TBUSLOC B                                         15340000
154200              , TBUSFNC C                                         15350000
154300          WHERE A.ENT_ID           = B.ENT_ID                     15360000
154400            AND A.ENT_BUS_LOC_ID   = B.SEQ_NBR                    15370000
154500            AND A.ENT_ID           = :VNDDPT-ENT-ID               15380000
154600            AND A.FUNCTION_ID      = :PV-FUNCTION-ID              15390000
154700            AND A.FUNCTION_ID      = C.FUNCTION_ID                15400000
154800            AND B.SEQ_NBR          =                              15410000
154900                (SELECT MAX(D.SEQ_NBR)                            15420000
155000                   FROM TBUSLOC D                                 15430000
155100                  WHERE D.ENT_ID      = B.ENT_ID                  15440000
155200                    AND D.FUNCTION_ID = B.FUNCTION_ID)            15450000
155300     END-EXEC.                                                    15460000
155400                                                                  15470000
155500     EVALUATE TRUE                                                15480000
155600         WHEN SQLCODE = ZERO                                      15490000
155700             IF PV-FUNCTION-ID = 1                                15500000
155800                PERFORM T200-CHECK-CONTACT-CONTENT                15510000
155900                IF PS-NO-CONTACT-CONTENT                          15520000
156000                   MOVE 7 TO PV-FUNCTION-ID                       15530000
156100                ELSE                                              15540000
156200                   SET PS-ALT-CONTACT-FOUND TO TRUE               15550000
156300                END-IF                                            15560000
156400             ELSE                                                 15570000
156500                IF PV-FUNCTION-ID = 7                             15580000
156600                   PERFORM T200-CHECK-CONTACT-CONTENT             15590000
156700                   IF PS-NO-CONTACT-CONTENT                       15600000
156800                      MOVE 9 TO PV-FUNCTION-ID                    15610000
156900                   ELSE                                           15620000
157000                      SET PS-ALT-CONTACT-FOUND TO TRUE            15630000
157100                   END-IF                                         15640000
157200                ELSE                                              15650000
157300                   IF PV-FUNCTION-ID = 9                          15660000
157400                      PERFORM T200-CHECK-CONTACT-CONTENT          15670000
157500                      IF PS-NO-CONTACT-CONTENT                    15680000
157600                         SET PS-NO-ALT-CONTACT-FOUND TO TRUE      15690000
157700                      ELSE                                        15700000
157800                         SET PS-ALT-CONTACT-FOUND    TO TRUE      15710000
157900                      END-IF                                      15720000
158000                   END-IF                                         15730000
158100                END-IF                                            15740000
158200             END-IF                                               15750000
158300         WHEN SQLCODE = +100                                      15760000
158400             IF PV-FUNCTION-ID = 1                                15770000
158500                MOVE 7 TO PV-FUNCTION-ID                          15780000
158600             ELSE                                                 15790000
158700                IF PV-FUNCTION-ID = 7                             15800000
158800                   MOVE 9 TO PV-FUNCTION-ID                       15810000
158900                ELSE                                              15820000
159000                   IF PV-FUNCTION-ID = 9                          15830000
159100                      SET PS-NO-ALT-CONTACT-FOUND TO TRUE         15840000
159200                   END-IF                                         15850000
159300                END-IF                                            15860000
159400             END-IF                                               15870000
159500         WHEN OTHER                                               15880000
159600             DISPLAY 'VENDOR NAME: ' VN010-ENT-NAME-DESC          15890000
159700             DISPLAY 'VENDOR NBR : ' VN010-DUN-NBR                15900000
159800             SET AC-UNSUCCESSFUL-SELECT    TO TRUE                15910000
159900             MOVE 'S800-SELECT-EXPEN-ALT-CONTACT '                15920000
160000                                           TO AA-PARAGRAPH-NAME   15930000
160100             MOVE 'UNSUCCESSFUL SELECT'    TO AA-DB2-OPERATION    15940000
160200             MOVE 'TENTREP'                TO AA-DB2-TABLE-1      15950000
160300             MOVE 'TBUSLOC'                TO AA-DB2-TABLE-2      15960000
160400             MOVE 'TBUSFNC'                TO AA-DB2-TABLE-3      15970000
160500             PERFORM Z998-DB2-ABEND                               15980000
160600     END-EVALUATE.                                                15990000
160700                                                                  16000000
160800*--------------------------------------------------------------*  16010000
160900*  CHECKS IF THERE IS ANY CONTENT TO THE VARIOUS ADDRESS LINES *  16020000
161000*--------------------------------------------------------------*  16030000
161100 T100-CHECK-ADDRESS-CONTENT.                                      16040000
161200                                                                  16050000
161300     IF BUSLOC-ADDRESS-LINE1-DESC = SPACE AND                     16060000
161400        BUSLOC-ADDRESS-LINE2-DESC = SPACE AND                     16070000
161500        BUSLOC-ADDRESS-LINE3-DESC = SPACE AND                     16080000
161600        BUSLOC-ADDRESS-LINE4-DESC = SPACE AND                     16090000
161700        BUSLOC-CITY-NAME = SPACE AND                              16100000
161800        BUSLOC-STATE-CDE = SPACE                                  16110000
161900        SET PS-NO-ADDRESS-CONTENT  TO TRUE                        16120000
162000     ELSE                                                         16130000
162100        SET PS-YES-ADDRESS-CONTENT TO TRUE                        16140000
162200     END-IF.                                                      16150000
162300                                                                  16160000
162400*--------------------------------------------------------------*  16170000
162500*  CHECKS IF THERE IS ANY CONTENT TO THE VARIOUS TELEPHONE     *  16180000
162600*  NUMBERS                                                     *  16190000
162700*--------------------------------------------------------------*  16200000
162800 T200-CHECK-CONTACT-CONTENT.                                      16210000
162900                                                                  16220000
163000     IF ENTREP-TEL1-NBR = SPACE AND                               16230000
163100        ENTREP-TEL2-NBR = SPACE                                   16240000
163200        SET PS-NO-CONTACT-CONTENT  TO TRUE                        16250000
163300     ELSE                                                         16260000
163400        SET PS-YES-CONTACT-CONTENT TO TRUE                        16270000
163500     END-IF.                                                      16280000
163600                                                                  16290000
163700*--------------------------------------------------------------*  16300000
163800*  WRITE OUT A RECORD TO THE VENDOR EXTRACT FILE               *  16310000
163900*--------------------------------------------------------------*  16320000
164000 W100-WRITE-VENDOR-EXTRACT.                                       16330000
164100                                                                  16340000
164200     WRITE VENDOR-EXCEPTION-RECORD FROM VN005-VENDOR-EXTRACT-REC. 16350000
164300                                                                  16360000
164400*--------------------------------------------------------------*  16370000
164500*  WRITE OUT AN ADDRESS EXCEPTION RECORD                       *  16380000
164600*--------------------------------------------------------------*  16390000
164700 W200-WRITE-ADDRESS-EXCEPTION.                                    16400000
164800                                                                  16410000
164900     IF LINE-COUNT >= MAX-LINES                                   16420000
165000        PERFORM W400-WRITE-HEADINGS                               16430000
165100     END-IF.                                                      16440000
165200                                                                  16450000
165300     MOVE VN010-DUN-NBR              TO DTL-VENDOR-ID.            16460000
165400     MOVE VN010-ENT-NAME-DESC        TO DTL-VENDOR-NAME.          16470000
165500     MOVE BUSFNC-FUNCTION-NAME       TO DTL-FUNCTION-NAME.        16480000
165600     MOVE PC-ADDRESS-EXCEPT-TEXT     TO DTL-EXCEPTION-REASON.     16490000
165700                                                                  16500000
165800     WRITE VENDOR-EXCEPTION-RPT FROM DETAIL-1                     16510000
165900           AFTER ADVANCING 1 LINE.                                16520000
166000                                                                  16530000
166100     ADD 1 TO LINE-COUNT                                          16540000
166200              PV-COUNT-EXCEPTION-RECORD.                          16550000
166300                                                                  16560000
166400*--------------------------------------------------------------*  16570000
166500*  WRITE OUT A CONTACT EXCEPTION RECORD                        *  16580000
166600*--------------------------------------------------------------*  16590000
166700 W300-WRITE-CONTACT-EXCEPTION.                                    16600000
166800                                                                  16610000
166900     IF LINE-COUNT >= MAX-LINES                                   16620000
167000        PERFORM W400-WRITE-HEADINGS                               16630000
167100     END-IF.                                                      16640000
167200                                                                  16650000
167300     MOVE VN010-DUN-NBR              TO DTL-VENDOR-ID.            16660000
167400     MOVE VN010-ENT-NAME-DESC        TO DTL-VENDOR-NAME.          16670000
167500     MOVE BUSFNC-FUNCTION-NAME       TO DTL-FUNCTION-NAME.        16680000
167600     MOVE PC-CONTACT-EXCEPT-TEXT     TO DTL-EXCEPTION-REASON.     16690000
167700                                                                  16700000
167800     WRITE VENDOR-EXCEPTION-RPT FROM DETAIL-1                     16710000
167900           AFTER ADVANCING 1 LINE.                                16720000
168000                                                                  16730000
168100     ADD 1 TO LINE-COUNT                                          16740000
168200              PV-COUNT-EXCEPTION-RECORD.                          16750000
168300                                                                  16760000
168400*--------------------------------------------------------------*  16770000
168500*  WRITE THE PAGE HEADINGS FOR THE EXCEPTION REPORT            *  16780000
168600*--------------------------------------------------------------*  16790000
168700 W400-WRITE-HEADINGS.                                             16800000
168800                                                                  16810000
168900      ADD 1 TO PAGE-COUNT.                                        16820000
169000      MOVE PAGE-COUNT TO DP132O-PAGE-NUMBER.                      16830000
169100                                                                  16840000
169200      WRITE VENDOR-EXCEPTION-RPT FROM                             16850000
169300             DP132O-STANDRD-HEADER-132-COLS AFTER ADVANCING PAGE. 16860000
169400      WRITE VENDOR-EXCEPTION-RPT FROM HDR-TITLE-1                 16870000
169500          AFTER ADVANCING 1 LINE.                                 16880000
169600      PERFORM W500-WRITE-BLANK-LINE.                              16890000
169700      WRITE VENDOR-EXCEPTION-RPT FROM HEADER-1                    16900000
169800          AFTER ADVANCING 2 LINES.                                16910000
169900      WRITE VENDOR-EXCEPTION-RPT FROM BLANK-LINE                  16920000
170000          AFTER ADVANCING 1 LINE.                                 16930000
170100                                                                  16940000
170200      MOVE +6            TO LINE-COUNT.                           16950000
170300                                                                  16960000
170400*-------------------------------------------------------------*   16970000
170500*  WRITE A BLANK LINE BETWEEN REMITTANCE LINES                *   16980000
170600*-------------------------------------------------------------*   16990000
170700 W500-WRITE-BLANK-LINE.                                           17000000
170800                                                                  17010000
170900      IF LINE-COUNT >= MAX-LINES                                  17020000
171000         CONTINUE                                                 17030000
171100      ELSE                                                        17040000
171200         WRITE VENDOR-EXCEPTION-RPT FROM BLANK-LINE               17050000
171300         ADD 1 TO LINE-COUNT                                      17060000
171400      END-IF.                                                     17070000
171500                                                                  17080000
171600*--------------------------------------------------------------*  17090000
171700*  DB2 ABEND ROUTINE                                           *  17100000
171800*--------------------------------------------------------------*  17110000
171900 Z998-DB2-ABEND.                                                  17120000
172000                                                                  17130000
172100     DISPLAY '**********************************************'.    17140000
172200     DISPLAY '**        VNKUT015 ABENDING !!!!!!!         **'.    17150000
172300     DISPLAY '**********************************************'.    17160000
172400                                                                  17170000
172500     DISPLAY AA-ABEND-LIT.                                        17180000
172600     DISPLAY AA-DB2-ERROR-LIT.                                    17190000
172700     DISPLAY AA-PROGRAM-LIT.                                      17200000
172800     DISPLAY AA-PARAGRAPH-LIT.                                    17210000
172900     DISPLAY AA-DB2-OPERATION-LIT.                                17220000
173000     DISPLAY AA-DB2-TABLE-1.                                      17230000
173100     DISPLAY AA-DB2-TABLE-2.                                      17240000
173200     DISPLAY AA-DB2-TABLE-3.                                      17250000
173300     SET AC-DB2-ERROR TO TRUE.                                    17260000
173400                                                                  17270000
173500     COPY DPPD004.                                                17280000
173600                                                                  17290000
173700     CLOSE VENDOR-INPUT-FILE                                      17300000
173800           VENDOR-EXCPTION-FILE                                   17310000
173900           VENDOR-EXCEPTION-REPORT.                               17320000
174000                                                                  17330000
174100     CALL 'ILBOABN0' USING ABEND-CODE.                            17340000
174200                                                                  17350000
