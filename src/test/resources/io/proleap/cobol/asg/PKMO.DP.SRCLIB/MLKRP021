000010 IDENTIFICATION DIVISION.                                                 
000030 PROGRAM-ID.    MLKRP021.                                                 
000040 AUTHOR.        TESS BESTE.                                               
000050 INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
000060 DATE-WRITTEN.  04-18-94.                                                 
000070 DATE-COMPILED.                                                           
000080                                                                          
000090******************************************************************        
000100* READ A FILE OF EDITED PURCHASE TRANSACTIONS IN THE MLRD021              
000110* FORMAT. SUM AND REPORT THE COST, RETAIL, AND NUMBER OF                  
000120* TRANSACTIONS.                                                           
000130*                                                                         
000140* COMMENT OUT IF STATEMENTS AS NECESSARY TO SELECT PURCHASES              
000150* AND/OR TRANSFER-FROMS AND/OR TRANSFER-TOS, AND/OR TO SELECT             
000160* SPECIFIC BATCH NUMBERS.                                                 
000170******************************************************************        
000180                                                                 *        
000190                                                                          
000200 ENVIRONMENT DIVISION.                                                    
000210                                                                          
000220 CONFIGURATION SECTION.                                                   
000230                                                                          
000240 SOURCE-COMPUTER.    IBM-3090.                                            
000250 OBJECT-COMPUTER.    IBM-3090.                                            
000260                                                                          
000270                                                                          
000280 INPUT-OUTPUT SECTION.                                                    
000290                                                                          
000300 FILE-CONTROL.                                                            
000310     SELECT INPUT-FILE                                                    
000320         ASSIGN TO INP01.                                                 
000340                                                                          
000350                                                                          
000360 DATA DIVISION.                                                           
000370                                                                          
000380 FILE SECTION.                                                            
000390                                                                          
000400 FD  INPUT-FILE                                                           
000410     LABEL RECORDS ARE STANDARD                                           
000420     BLOCK CONTAINS 0 RECORDS                                             
000430     RECORDING  MODE IS F.                                                
000440 01  INPUT-RECORD                PIC X(150).                              
000450                                                                          
000460 WORKING-STORAGE SECTION.                                                 
000470                                                                          
000480******************************************************************        
000490* INPUT RECORD LAYOUT                                                     
000500******************************************************************        
000510                                                                          
      *++INCLUDE MLRD021                                                        
000520     COPY MLRD021.                                                        
000530                                                                          
000540 01  PS-PROGRAM-SWITCHES.                                                 
000550     05  PS-END-OF-INPUT-FILE-SW      PIC X         VALUE 'N'.            
000560         88  PS-END-OF-INPUT-FILE                   VALUE 'Y'.            
000570         88  PS-NOT-END-OF-INPUT-FILE               VALUE 'N'.            
000580                                                                          
000590 01  PV-PROGRAM-VARIABLES.                                                
000600     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZZ,ZZ9.                
000610     05  PV-DISPLAY-COST              PIC ZZZ,ZZZ,ZZZ,ZZZ.99-.            
000610     05  PV-DISPLAY-FRGT              PIC ZZZ,ZZZ,ZZZ,ZZZ.99-.            
000620     05  PV-DISPLAY-RETAIL            PIC ZZZ,ZZZ,ZZZ,ZZZ.99-.            
000630     05  PV-PURCH-COUNT               PIC S9(13)    VALUE +0              
000640                                                           COMP-3.        
000650     05  PV-XFER-FROM-COUNT           PIC S9(13)    VALUE +0              
000660                                                           COMP-3.        
000670     05  PV-XFER-TO-COUNT             PIC S9(13)    VALUE +0              
000680                                                           COMP-3.        
000690     05  PV-ACCUM-PURCH-COST          PIC S9(13)V99 VALUE +0              
000700                                                           COMP-3.        
000690     05  PV-ACCUM-FRGT-AMT            PIC S9(13)V99 VALUE +0              
000700                                                           COMP-3.        
000710     05  PV-ACCUM-PURCH-RETAIL        PIC S9(13)V99 VALUE +0              
000720                                                           COMP-3.        
000730     05  PV-ACCUM-XFER-FROM-COST      PIC S9(13)V99 VALUE +0              
000740                                                           COMP-3.        
000750     05  PV-ACCUM-XFER-FROM-RETAIL    PIC S9(13)V99 VALUE +0              
000760                                                           COMP-3.        
000770     05  PV-ACCUM-XFER-TO-COST        PIC S9(13)V99 VALUE +0              
000780                                                           COMP-3.        
000790     05  PV-ACCUM-XFER-TO-RETAIL      PIC S9(13)V99 VALUE +0              
000800                                                           COMP-3.        
000810                                                                          
000820 PROCEDURE DIVISION.                                                      
000830                                                                          
000840 A100-PROGRAM-MAINLINE.                                                   
000850                                                                          
000860     OPEN INPUT INPUT-FILE.                                               
000870                                                                          
000880     READ INPUT-FILE INTO ML021-PURCH-RECORD                              
000890         AT END SET PS-END-OF-INPUT-FILE TO TRUE.                         
000900                                                                          
000950     PERFORM UNTIL PS-END-OF-INPUT-FILE                                   
000960         EVALUATE TRUE                                                    
000970             WHEN ML021-PURCH-PURCHASE                                    
000980                 ADD +1 TO PV-PURCH-COUNT                                 
000990                 IF ML021-PURCH-DR-CR-CDE = '01' OR '07'                  
001000                     COMPUTE PV-ACCUM-PURCH-COST                          
001010                           = PV-ACCUM-PURCH-COST                          
001020                           + ML021-PURCH-EXTD-NET-COST-AMT                
001000                     COMPUTE PV-ACCUM-FRGT-AMT                            
001010                           = PV-ACCUM-FRGT-AMT                            
001020                           + ML021-PURCH-FRGT-AMT                         
001030                     COMPUTE PV-ACCUM-PURCH-RETAIL                        
001040                           = PV-ACCUM-PURCH-RETAIL                        
001050                           + ML021-PURCH-EXTD-RTL-AMT                     
001060                 ELSE                                                     
001070                     COMPUTE PV-ACCUM-PURCH-COST                          
001080                           = PV-ACCUM-PURCH-COST                          
001090                           - ML021-PURCH-EXTD-NET-COST-AMT                
001000                     COMPUTE PV-ACCUM-FRGT-AMT                            
001010                           = PV-ACCUM-FRGT-AMT                            
001020                           - ML021-PURCH-FRGT-AMT                         
001100                     COMPUTE PV-ACCUM-PURCH-RETAIL                        
001110                           = PV-ACCUM-PURCH-RETAIL                        
001120                           - ML021-PURCH-EXTD-RTL-AMT                     
001130                 END-IF                                                   
001140             WHEN ML021-PURCH-TRANSFER-FRM-STORE                          
001150                 ADD +1 TO PV-XFER-FROM-COUNT                             
001160                 COMPUTE PV-ACCUM-XFER-FROM-COST                          
001170                       = PV-ACCUM-XFER-FROM-COST                          
001180                       + ML021-PURCH-EXTD-NET-COST-AMT                    
001190                 COMPUTE PV-ACCUM-XFER-FROM-RETAIL                        
001200                       = PV-ACCUM-XFER-FROM-RETAIL                        
001210                       + ML021-PURCH-EXTD-RTL-AMT                         
001220             WHEN ML021-PURCH-TRANSFER-TO-STORE                           
001230                 ADD +1 TO PV-XFER-TO-COUNT                               
001240                 COMPUTE PV-ACCUM-XFER-TO-COST                            
001250                       = PV-ACCUM-XFER-TO-COST                            
001260                       + ML021-PURCH-EXTD-NET-COST-AMT                    
001270                 COMPUTE PV-ACCUM-XFER-TO-RETAIL                          
001280                       = PV-ACCUM-XFER-TO-RETAIL                          
001290                       + ML021-PURCH-EXTD-RTL-AMT                         
001300         END-EVALUATE                                                     
001310         READ INPUT-FILE INTO ML021-PURCH-RECORD                          
001320             AT END SET PS-END-OF-INPUT-FILE TO TRUE                      
001330         END-READ                                                         
001340     END-PERFORM.                                                         
001350                                                                          
000910     DISPLAY '                   COUNT            FREIGHT                 
000920-            '       COST              RETAIL'.                           
000930     DISPLAY ' '.                                                         
000940                                                                          
001360     MOVE PV-PURCH-COUNT        TO PV-DISPLAY-COUNT.                      
001370     MOVE PV-ACCUM-FRGT-AMT     TO PV-DISPLAY-FRGT.                       
001370     MOVE PV-ACCUM-PURCH-COST   TO PV-DISPLAY-COST.                       
001380     MOVE PV-ACCUM-PURCH-RETAIL TO PV-DISPLAY-RETAIL.                     
001390     DISPLAY  'PURCHASE:  '                                               
001400              PV-DISPLAY-COUNT                                            
001410              ' '                                                         
001420              PV-DISPLAY-FRGT                                             
001410              ' '                                                         
001420              PV-DISPLAY-COST                                             
001430              ' '                                                         
001440              PV-DISPLAY-RETAIL.                                          
                                                                                
001460     MOVE PV-XFER-FROM-COUNT        TO PV-DISPLAY-COUNT.                  
001470     MOVE PV-ACCUM-XFER-FROM-COST   TO PV-DISPLAY-COST.                   
001480     MOVE PV-ACCUM-XFER-FROM-RETAIL TO PV-DISPLAY-RETAIL.                 
001490     DISPLAY  'XFER FROM: '                                               
001500              PV-DISPLAY-COUNT                                            
001510              ' '                                                         
001520              PV-DISPLAY-COST                                             
001530              ' '                                                         
001540              PV-DISPLAY-RETAIL.                                          
001550                                                                          
001560     MOVE PV-XFER-TO-COUNT        TO PV-DISPLAY-COUNT.                    
001570     MOVE PV-ACCUM-XFER-TO-COST   TO PV-DISPLAY-COST.                     
001580     MOVE PV-ACCUM-XFER-TO-RETAIL TO PV-DISPLAY-RETAIL.                   
001590     DISPLAY  'XFER TO:   '                                               
001600              PV-DISPLAY-COUNT                                            
001610              ' '                                                         
001620              PV-DISPLAY-COST                                             
001630              ' '                                                         
001640              PV-DISPLAY-RETAIL.                                          
001650                                                                          
001660     CLOSE INPUT-FILE.                                                    
001670                                                                          
001680     STOP RUN.                                                            
