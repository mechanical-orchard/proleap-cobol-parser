       IDENTIFICATION DIVISION.                                         00010016
       PROGRAM-ID.    MLKUP358.                                         00020016
       AUTHOR.        RYAN STAUFFACHER.                                 00030016
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040016
       DATE-WRITTEN.  12/13/05.                                         00050016
       DATE-COMPILED.                                                   00060016
                                                                        00070016
      ******************************************************************00080016
      * THIS PROGRAM WILL PROCESS FILES THAT ARE OUTPUT FROM MLK140    *00090016
      * AND ASSIGN BRAND/VENDOR/PRORATION INFORMATION AS APPROPRIATE.  *00100016
      ******************************************************************00110016
      *CHANGE HISTORY:                                                  00120016
      * WR/PROJ DATE       PGMR           DESCRIPTION OF CHANGES        00130016
      * ------- ---------- -------------  ----------------------------- 00140016
      * W28582  01-01-2007 M MACHNIK      ADD AUDIT REPORTS.            00150016
RONNAX* W28582  02-26-2007 R MCDONALD     FIX DA PRORATION WHEN DA IS   00160016
RONNAX*                                   NOT FOUND.                    00170016
J28582* W28582  03-11-2007 J SELWITSCHKA  ADD DEPT TO HOLD MATCH LOGIC. 00180016
W32898* W32898  10-24-2007 B. GRAHAM - STRATAGEM                        00190016
W32898*                                   BRAND VENDOR PHASE II         00200016
W32898*                                   USE INPUT ENT ID AND LBL SEQ  00210016
W32898*                                   FOR PURCH RECORDS IF PRESENT. 00220016
W32898*                                   DO NOT OVERLAY WITH BV VENDOR 00230016
W32898*                                   RESULTS. NEW AP TRANS CODES   00240016
W32898*                                   Z1 THRU Z4.                   00250016
W34309* W34309  03-11-2008 B. GRAHAM - STRATAGEM                        00260016
W34309*                                   PRIVATE BRAND ACCOUNTING      00270016
W34309*                                   GIVEBACK                      00280016
W34517* W34517  07-28-2008 B. GRAHAM - STRATAGEM                        00281016
W34517*                                   VA VERSION CHANGES            00282016
W34517*                                   ADD AP-TRAN-CODES Z1 AND Z2   00283016
W34517*                                   (REPLACEMENT OF 52, 53)       00284016
W34517*                                   ALSO, PROGRAM ALLOWS FOR      00285016
W34517*                                   Z3 THRU Z8 BUT THE RECORDS    00286016
W34517*                                   WILL BE BYPASSED BEFORE THIS  00287016
W34517*                                   PROGRAM IS EXECUTED.          00288016
W31475* W31475  05-20-2009 COGNIZANT      ML PERFORMANCE TUNING         00289016
W31475*                                   CALL TO MLKUP359 IS SUBSTITUTE00289116
W31475*                                   BY DB2 CURSOR                 00289216
W31475*                                   INPD400 IS REPLACED BY INPD40200289316
W31475*                                   FOR BETTER PERFORMANCE        00289416
P49767*P49767  19-09-2014 COGNIZANT      MODIFIED THE CODE TO HANDLE    00289516
P49767*                                  RTV TRANSACTONS WITH MODIFIED  00289616
P49767*                                  DOC NUMBER FROM AP.            00289716
P49767*                                  ML030-PURCH-DOC-16-NBR         00289816
289763*2897633 19-06-2023 GERMAN BANDA   UPDATE CHANGE P49767 TO ALLOW  00289916
289763*                                  FOR A VARIABLE LENGTH OF THE   00290016
289763*                                  DOC NUMBER FROM AP.            00290116
289763*                                  ML030-PURCH-DOC-16-NBR         00290216
289763*                                     (1:PV-TEMP-COUNT)           00290316
289763*                                  THE DOC NUMBER FROM AP WILL    00290416
289763*                                  STILL CONTAIN ORDERID FOLLOWED 00290516
289763*                                  BY '_' HOWEVER, NOW WILL BE    00290616
289763*                                  BE FOLLOWED BY RTV NOT DATE    00290716
289763*                                  123456789123_RTV - MAX 12      00290816
289763*                                  NO LEADING ZEROES              00290916
RONNAZ*        2023-10-13 RONNA MCDONALD CHG0295071                     00291016
RONNAZ*                                  MAKE CHANGES FOR RTV AP TRAN   00291116
RONNAZ*                                  CODES 54 AND 55 THAT           00291216
RONNAZ*                                  ARE COMING INTO ML AT A DEPT   00291316
RONNAZ*                                  SUBCLASS AND DOC 16 NUMBER     00291416
RONNAY*        2024-02-09 RONNA MCDONALD CHG0295071                     00291516
RONNAY*                                  REVERT CHANGES BACK.           00291616
RONNAY*                                  PRETEST AFTER PROD MOVE        00291716
RONNAY*                                  SHOWS THAT THE INPUT AND       00291816
RONNAY*                                  OUTPUT DOLLARS DO NOT MATCH.   00291916
RONNAY*                                                                 00292016
RONNAW*        02-09-2024 RONNA MCDONALD                                00292117
RONNAW*                   RESTORE CODE FROM LABEL 'RONNAZ' AND FIX      00292217
RONNAW*                   THE ISSUE OF OUT OF BALANCE                   00292317
RONNAW*                                  SEE CHG0305349                 00292421
      ******************************************************************00292521
       ENVIRONMENT DIVISION.                                            00292621
      ******************************************************************00292721
                                                                        00292821
       CONFIGURATION SECTION.                                           00292921
                                                                        00293021
       SOURCE-COMPUTER.        IBM-3090.                                00293121
       OBJECT-COMPUTER.        IMB-3090.                                00294016
                                                                        00295016
       INPUT-OUTPUT SECTION.                                            00296016
                                                                        00297016
       FILE-CONTROL.                                                    00298016
           SELECT PURCH-FILE                                            00299016
               ASSIGN TO INP01.                                         00300016
           SELECT SALE-FILE                                             00310016
               ASSIGN TO INP02.                                         00320016
           SELECT PRC-CHG-FILE                                          00330016
               ASSIGN TO INP03.                                         00340016
           SELECT ADJUSTMENT-FILE                                       00350016
               ASSIGN TO INP04.                                         00360016
           SELECT IN-ORACLE-SRC-CTL                                     00370016
               ASSIGN TO INP05.                                         00380016
           SELECT CNTL-DATE-FILE                                        00390016
               ASSIGN TO INP06.                                         00400016
W28582     SELECT CNTL-JOB-FILE                                         00410016
W28582         ASSIGN TO INP07.                                         00420016
                                                                        00430016
           SELECT BV-PURCH-FILE                                         00440016
               ASSIGN TO OUT01.                                         00450016
           SELECT BV-SALE-FILE                                          00460016
               ASSIGN TO OUT02.                                         00470016
           SELECT BV-PRC-CHG-FILE                                       00480016
               ASSIGN TO OUT03.                                         00490016
           SELECT BV-ADJUSTMENT-FILE                                    00500016
               ASSIGN TO OUT04.                                         00510016
W28582     SELECT BV-ERROR-FILE                                         00520016
W28582         ASSIGN TO OUT05.                                         00530016
W28582                                                                  00540016
W28582     SELECT BV-PURCH-AUDIT-RPT                                    00550016
W28582         ASSIGN TO RPT01.                                         00560016
W28582     SELECT BV-SALE-AUDIT-RPT                                     00570016
W28582         ASSIGN TO RPT02.                                         00580016
W28582     SELECT BV-PRC-CHG-AUDIT-RPT                                  00590016
W28582         ASSIGN TO RPT03.                                         00600016
W28582     SELECT BV-ADJUSTMENT-AUDIT-RPT                               00610016
W28582         ASSIGN TO RPT04.                                         00620016
                                                                        00630016
      ******************************************************************00640016
       DATA DIVISION.                                                   00650016
      ******************************************************************00660016
                                                                        00670016
       FILE SECTION.                                                    00680016
       FD  PURCH-FILE                                                   00690016
           RECORDING  MODE IS F                                         00700016
           BLOCK CONTAINS 0 RECORDS.                                    00710016
       01  PURCH-REC                        PIC X(200).                 00720016
                                                                        00730016
       FD  SALE-FILE                                                    00740016
           RECORDING  MODE IS F                                         00750016
           BLOCK CONTAINS 0 RECORDS.                                    00760016
       01  SALE-REC                         PIC X(80).                  00770016
                                                                        00780016
       FD  PRC-CHG-FILE                                                 00790016
           RECORDING  MODE IS F                                         00800016
           BLOCK CONTAINS 0 RECORDS.                                    00810016
       01  PRC-CHG-REC                      PIC X(200).                 00820016
                                                                        00830016
       FD  ADJUSTMENT-FILE                                              00840016
           RECORDING  MODE IS F                                         00850016
           BLOCK CONTAINS 0 RECORDS.                                    00860016
       01  ADJUSTMENT-REC                   PIC X(90).                  00870016
                                                                        00880016
       FD  IN-ORACLE-SRC-CTL                                            00890016
           LABEL RECORDS ARE STANDARD                                   00900016
           RECORDING MODE IS F                                          00910016
           BLOCK CONTAINS 0 RECORDS.                                    00920016
       01  IN-ORA-SRC-CTL-RECORD.                                       00930016
           05  IOC-SRC-SYSTEM       PIC X(04).                          00940016
           05  FILLER               PIC X(01).                          00950016
           05  IOC-USER-NAME        PIC X(08).                          00960016
           05  FILLER               PIC X(01).                          00970016
           05  IOC-USER-LGTH        PIC 9(02).                          00980016
           05  FILLER               PIC X(01).                          00990016
           05  IOC-PASSWORD         PIC X(08).                          01000016
           05  FILLER               PIC X(01).                          01010016
           05  IOC-PASSWORD-LGTH    PIC 9(02).                          01020016
           05  FILLER               PIC X(01).                          01030016
           05  IOC-REST-RECORD      PIC X(51).                          01040016
                                                                        01050016
                                                                        01060016
       FD  CNTL-DATE-FILE                                               01070016
           RECORDING  MODE IS F.                                        01080016
       01  CNTL-DATE-REC                    PIC X(80).                  01090016
                                                                        01100016
W28582 FD  CNTL-JOB-FILE                                                01110016
W28582     RECORDING  MODE IS F.                                        01120016
W28582 01  CNTL-JOB-REC                     PIC X(80).                  01130016
                                                                        01140016
       FD  BV-PURCH-FILE                                                01150016
           RECORDING  MODE IS F                                         01160016
           BLOCK CONTAINS 0 RECORDS.                                    01170016
       01  BV-PURCH-REC                        PIC X(200).              01180016
                                                                        01190016
       FD  BV-SALE-FILE                                                 01200016
           RECORDING  MODE IS F                                         01210016
           BLOCK CONTAINS 0 RECORDS.                                    01220016
       01  BV-SALE-REC                         PIC X(80).               01230016
                                                                        01240016
       FD  BV-PRC-CHG-FILE                                              01250016
           RECORDING  MODE IS F                                         01260016
           BLOCK CONTAINS 0 RECORDS.                                    01270016
       01  BV-PRC-CHG-REC                      PIC X(200).              01280016
                                                                        01290016
       FD  BV-ADJUSTMENT-FILE                                           01300016
           RECORDING  MODE IS F                                         01310016
           BLOCK CONTAINS 0 RECORDS.                                    01320016
       01  BV-ADJUSTMENT-REC                   PIC X(90).               01330016
                                                                        01340016
W28582 FD  BV-ERROR-FILE                                                01350016
W28582     RECORDING  MODE IS F                                         01360016
W28582     BLOCK CONTAINS 0 RECORDS.                                    01370016
W28582 01  BV-ERROR-REC                        PIC X(247).              01380016
W28582                                                                  01390016
W28582 FD  BV-PURCH-AUDIT-RPT                                           01400016
W28582     RECORDING  MODE IS F                                         01410016
W28582     BLOCK CONTAINS 0 RECORDS.                                    01420016
W28582 01  BV-PURCH-AUDIT-REC                  PIC X(150).              01430016
W28582                                                                  01440016
W28582 FD  BV-SALE-AUDIT-RPT                                            01450016
W28582     RECORDING  MODE IS F                                         01460016
W28582     BLOCK CONTAINS 0 RECORDS.                                    01470016
W28582 01  BV-SALE-AUDIT-REC                   PIC X(132).              01480016
W28582                                                                  01490016
W28582 FD  BV-PRC-CHG-AUDIT-RPT                                         01500016
W28582     RECORDING  MODE IS F                                         01510016
W28582     BLOCK CONTAINS 0 RECORDS.                                    01520016
W28582 01  BV-PCHG-AUDIT-REC                   PIC X(132).              01530016
W28582                                                                  01540016
W28582 FD  BV-ADJUSTMENT-AUDIT-RPT                                      01550016
W28582     RECORDING  MODE IS F                                         01560016
W28582     BLOCK CONTAINS 0 RECORDS.                                    01570016
W28582 01  BV-ADJ-AUDIT-REC                    PIC X(132).              01580016
W28582                                                                  01590016
       WORKING-STORAGE SECTION.                                         01600016
                                                                        01610016
       01  ABEND-CODE                        PIC S9(4) VALUE ZEROS      01620016
                                                       COMP SYNC.       01630016
           88  AC-OTHER-ERROR                          VALUE +4003.     01640016
           88  AC-SQL-ERROR                            VALUE +4013.     01650016
                                                                        01660016
       01  PS-PROGRAM-SWITCHES.                                         01670016
W28582     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.   01680016
W28582         88  PS-NORMAL-RUN                           VALUE '0'.   01690016
W28582         88  PS-RESTART-RUN                          VALUE '9'.   01700016
           05  PS-END-PROCESSING-SW          PIC X(01) VALUE 'N'.       01710016
               88  PS-END-PROCESSING                   VALUE 'Y'.       01720016
               88  PS-NOT-END-PROCESSING               VALUE 'N'.       01730016
           05  PS-CNTL-DATE-FILE-SW          PIC X     VALUE 'N'.       01740016
               88  PS-END-OF-CNTL-DTE-FILE             VALUE 'Y'.       01750016
W28582     05  PS-CNTL-JOB-FILE-SW           PIC X     VALUE 'N'.       01760016
W28582         88  PS-END-OF-CNTL-JOB-FILE             VALUE 'Y'.       01770016
NHOLD$     05  PS-HOLD-MATCH-SW              PIC X(01) VALUE 'N'.       01780016
NHOLD$         88  PS-HOLD-MATCH                       VALUE 'Y'.       01790016
NHOLD$         88  PS-NO-HOLD-MATCH                    VALUE 'N'.       01800016
NHOLD$     05  PS-PREV-DBV-RLTSNHP-CHK-SW    PIC X(01) VALUE SPACE.     01810016
NHOLD$         88  PS-PREV-FOUND-SKU                   VALUE '1'.       01820016
NHOLD$         88  PS-PREV-13-WK-PRRTN                 VALUE '2'.       01830016
NHOLD$         88  PS-PREV-EVEN-PRRTN                  VALUE '3'.       01840016
NHOLD$         88  PS-PREV-USED-UNKNOWN                VALUE '4'.       01850016
NHOLD$         88  PS-PREV-DEBIT-ALLOW                 VALUE '5'.       01860016
NHOLD$         88  PS-PREV-RTV-DOC                     VALUE '6'.       01870016
           05  PS-MORE-PURCH-RECORDS-SW      PIC X(01) VALUE 'Y'.       01880016
               88  PS-MORE-PURCH-RECORDS               VALUE 'Y'.       01890016
               88  PS-NO-MORE-PURCH-RECORDS            VALUE 'N'.       01900016
           05  PS-MORE-ORACLE-CC-SW          PIC X(01) VALUE 'Y'.       01910016
               88  PS-MORE-ORACLE-CC                   VALUE 'Y'.       01920016
               88  PS-NO-MORE-ORACLE-CC                VALUE 'N'.       01930016
           05  PS-MORE-SALE-RECORDS-SW       PIC X(01) VALUE 'Y'.       01940016
               88  PS-MORE-SALE-RECORDS                VALUE 'Y'.       01950016
               88  PS-NO-MORE-SALE-RECORDS             VALUE 'N'.       01960016
           05  PS-MORE-PCHG-RECORDS-SW       PIC X(01) VALUE 'Y'.       01970016
               88  PS-MORE-PCHG-RECORDS                VALUE 'Y'.       01980016
               88  PS-NO-MORE-PCHG-RECORDS             VALUE 'N'.       01990016
           05  PS-MORE-ADJ-RECORDS-SW        PIC X(01) VALUE 'Y'.       02000016
               88  PS-MORE-ADJ-RECORDS                 VALUE 'Y'.       02010016
               88  PS-NO-MORE-ADJ-RECORDS              VALUE 'N'.       02020016
           05  PS-MORE-BVP-RECORDS-SW        PIC X(01) VALUE 'Y'.       02030016
               88  PS-MORE-BVP-RECORDS                 VALUE 'Y'.       02040016
               88  PS-NO-MORE-BVP-RECORDS              VALUE 'N'.       02050016
           05  PS-MORE-RTV-RECORDS-SW        PIC X(01) VALUE 'Y'.       02060016
               88  PS-MORE-RTV-RECORDS                 VALUE 'Y'.       02070016
               88  PS-NO-MORE-RTV-RECORDS              VALUE 'N'.       02080016
           05  PS-RTV-DA-ALW-SW              PIC X(01) VALUE 'N'.       02090016
               88  PS-DA-ALW-OR-RTV                    VALUE 'Y'.       02100016
               88  PS-NOT-DA-ALW-OR-RTV                VALUE 'N'.       02110016
           05  PS-BRND-VNDR-PRRTN-SW         PIC X(02) VALUE SPACES.    02120016
               88  PS-PRRTN-FOR-PCHG                   VALUE 'PC'.      02130016
               88  PS-PRRTN-FOR-PURCH                  VALUE 'PU'.      02140016
               88  PS-PRRTN-FOR-SALE                   VALUE 'SA'.      02150016
           05  PS-PURCH-SYST-ORIG            PIC X(02) VALUE SPACES.    02160016
               88  PS-PURCH-RECEIPT-A                  VALUE '08'.      02170016
               88  PS-PURCH-RECEIPT-B                  VALUE '02'.      02180016
           05  PS-PURCH-TRANS-CDE            PIC X(02) VALUE SPACES.    02190016
               88  PS-PURCH-TRANSFER-FRM-STORE         VALUE '30'.      02200016
               88  PS-PURCH-TRANSFER-TO-STORE          VALUE '31'.      02210016
           05  PS-13-WK-PRRTN-INFO-SW        PIC X(01) VALUE 'Y'.       02220016
               88  PS-13-WK-PRRTN-INFO-EXISTS          VALUE 'Y'.       02230016
               88  PS-NO-13-WK-PRRTN-INFO-EXISTS       VALUE 'N'.       02240016
           05  PS-AP-TRANS-CDE               PIC X(02) VALUE SPACES.    02250016
               88  PS-PURCH-AP-TRANS-RTV               VALUES '54' '55'.02260016
               88  PS-PURCH-AP-TRANS-DA                VALUE  '24' '2F'.02270016
               88  PS-PURCH-AP-TRANS-SKU               VALUES           02280016
                   '13' '15' '28' '29' '34' '35' '36' '37' '45'         02290016
                   '46' '52' '53' '0B' '0E' '2A' '2B' '2C' '2E'         02300016
W34517             'Z1' 'Z2'.                                           02310016
               88  PS-PURCH-AP-TRANS-VND               VALUES           02320016
                   '03' '04' '05' '06' '07' '08' '09' '0A' '0D' '11'    02330016
                   '14' '17' '18' '19' '20' '21' '22' '23' '25' '26'    02340016
                   '27' '30' '31' '32' '33' '38' '39' '40' '41' '42'    02350016
                   '43' '44' '50' '51' '56' '57' '58' '59' '5A' '0C'    02360016
                   '2G' '2H' '2I'.                                      02370016
W32898         88  PS-PURCH-AP-TRANS-BV-REALIGN        VALUES           02380016
W34517             'Z3' 'Z4' 'Z5' 'Z6' 'Z7' 'Z8'.                       02390016
W34309         88  PS-PURCH-AP-TRANS-GIVEBACK          VALUES           02400016
W34309             '4G' '4H' '4J' '4K'                                  02410016
W34309             '6P' '6Q' '6R' '6S'.                                 02420016
               88  PS-PURCH-AP-OTHER                   VALUE SPACES.    02430016
               88  PS-PURCH-AP-STR-RTL                 VALUES '17' '18'.02440016
               88  PS-PURCH-AP-BYR-RTL                 VALUE  '26' '2G'.02450016
               88  PS-PURCH-AP-RCPT-GRS-CST            VALUES           02460016
                   '03' '04' '05' '06' '08' '0B' '0C' '0D' '0E' '11'    02470016
                   '13' '14' '15' '19' '23' '25' '27' '28' '29' '30'    02480016
                   '31' '32' '33' '34' '35' '36' '37' '38' '39' '40'    02490016
                   '41' '42' '43' '44' '45' '46' '50' '51' '52' '53'    02500016
                   '56' '57' '58' '59' '5A' '2A' '2B' '2C' '2E'.        02510016
               88  PS-PURCH-AP-RTV-COST                VALUES           02520016
                   '09' '0A' '20' '21' '22'.                            02530016
               88  PS-PURCH-AP-DA-COST                 VALUE  '07' '24' 02540016
                                                              '2F' '2H' 02550016
                                                              '2I'.     02560016
               88  PS-PCHG-AP-DA-MARKDOWN              VALUE  '24' '2F'.02570016
               88  PS-PCHG-AP-STR-RTL                  VALUES '17'.     02580016
W31475     05  PS-END-OF-BRND-PRRTN-CSR-SW   PIC X(01) VALUE 'N'.       02590016
W31475         88  PS-END-OF-BRND-PRRTN-CSR            VALUE 'Y'.       02600016
W31475         88  PS-NOT-END-OF-BRND-PRRTN-CSR        VALUE 'N'.       02610016
RONNAZ     05  PS-PURCH-RTV-TTL-MATCH-SW     PIC X(01) VALUE 'N'.       02620016
RONNAZ         88  PS-PURCH-RTV-TTL-MATCH-YES          VALUE 'Y'.       02621016
RONNAZ         88  PS-PURCH-RTV-TTL-MATCH-NO           VALUE 'N'.       02622016
RONNAW     05  PS-PURCH-RTV-DOC16-SW         PIC X(01) VALUE 'N'.       02622117
RONNAW         88  PS-PURCH-RTV-DOC16-YES              VALUE 'Y'.       02622217
RONNAW         88  PS-PURCH-RTV-DOC16-NO               VALUE 'N'.       02622317
                                                                        02623016
       01  ABEND-CODE-SQL              PIC S9(04)  VALUE ZERO COMP SYNC.02624016
                                                                        02625016
       01  PC-PROGRAM-CONSTANTS.                                        02626016
           05 PC-PGM-NAME                   PIC X(8)  VALUE 'MLKUP358'. 02627016
W28582     05 PC-JOB-NAME                   PIC X(8)  VALUE SPACES.     02628016
           05 PC-MLKUP359                   PIC X(08) VALUE 'MLKUP359'. 02629016
           05 PC-MAX-RETRIES                PIC S9(03) VALUE 3 COMP-3.  02630016
           05 PC-MAX-LINES                  PIC 9(03) VALUE 60.         02640016
           05 PC-BVD                        PIC X(03) VALUE 'BVD'.      02650016
           05 PC-UNKNOWN-VENDOR             PIC S9(09) VALUE +5161 COMP.02660016
           05 PC-UNKNOWN-BRAND              PIC S9(04) VALUE +2230 COMP.02670016
           05  PC-RUN-IN-PROGRESS-CODE      PIC X(01)  VALUE '9'.       02680016
           05  PC-RUN-COMPLETE-CODE         PIC X(01)  VALUE '0'.       02690016
W28582     05  PC-CKPT-INTERVAL             PIC S9(07) VALUE +100000    02700016
                                                        COMP-3.         02710016
                                                                        02720016
       01  PV-PROGRAM-VARIABLES.                                        02730016
           05 PV-DB2-FIELDS.                                            02740016
              10 PV-DB2-DEPT-NBR             PIC  S9(4)V COMP-3.        02750016
              10 PV-DB2-ENT-ID               PIC  S9(9)  COMP.          02760016
              10 PV-DB2-LBL-SEQ-NBR          PIC  S9(4)  COMP.          02770016
              10 PV-DB2-RTV-DOC-NBR          PIC  S9(12)V COMP-3.       02780016
              10 PV-DB2-DATE-EXISTS          PIC   X(1).                02790016
           05 PV-MISC.                                                  02800016
              10 PV-RETRY-COUNTER            PIC S9(04) COMP.           02810016
              10 PV-PAGE-COUNTER             PIC 9(7) VALUE 0.          02820016
              10 PV-LINE-COUNTER             PIC 9(7) VALUE 0.          02830016
              10 PV-PARAGRAPH-NAME           PIC X(30)  VALUE SPACES.   02840016
              10 PV-DB2-OPERATION-ATTEMPTED  PIC X(30)  VALUE SPACES.   02850016
           05 PV-CKPT-STAT-CODE              PIC X(01)  VALUE SPACES.   02860016
W28582     05 PV-RECS-PROC-FOR-CKPT          PIC S9(07) VALUE ZEROS     02870016
W28582                                                  COMP-3.         02880016
W28582     05 PV-CKPT-TAKEN-CNT              PIC S9(07) VALUE ZEROS     02890016
W28582                                                  COMP-3.         02900016
           05 PV-RTV-COUNT                   PIC S9(09) VALUE +0        02910016
                                                        COMP-3.         02920016
           05 PV-RESTART-COUNT               PIC 9(09) VALUE 0.         02930016
P49767     05 PV-TEMP-COUNT                  PIC 9(09) VALUE 0.         02940016
P49767     05 PV-TEMP-DOC-NBR                PIC X(16) JUST RIGHT.      02950016
P49767     05 PV-INSPT-STRING                PIC X(16) VALUE SPACES.    02960016
           05 PV-BRAND-COUNT                 PIC S9(09) VALUE +0        02970016
                                                        COMP-3.         02980016
           05 PV-MAX-BRAND                   PIC S9(4)  VALUE +0        02990016
                                                        COMP.           03000016
           05 PV-TOT-BRANDS                  PIC S9(09) VALUE +0        03010016
                                                        COMP-3.         03020016
           05 PV-PRORATION-PCT               PIC S9(3)V9(7) VALUE +0    03030016
                                                            COMP-3.     03040016
           05 PV-RTV-DOC-9                   PIC 9(16)  VALUE  0.       03050016
           05 PV-NULL                        PIC S9(04) VALUE +0 COMP.  03060016
RONNAZ     05 PV-NULL2                       PIC S9(04) VALUE +0 COMP.  03061016
           05 PV-SQLCODE                     PIC S9(04) VALUE ZERO.     03062016
           05 PV-SQLCODE-DISP                PIC S9(04) VALUE ZERO.     03063016
           05 PV-CURRENT-TMST                PIC X(26)  VALUE SPACES.   03064016
           05 PV-PROCESS-DATE                PIC X(10)  VALUE SPACES.   03065016
RONNAZ     05 PV-DFMEIT-ITEM-NBR-COUNT       PIC S9(09) COMP VALUE +0.  03066016
RONNAZ     05 PV-DFMEIT-ITEM-NBR-ZERO-COUNT  PIC S9(09) COMP VALUE +0.  03066119
RONNAZ     05 PV-SUM-RTL-COST-AMT            PIC S9(7)V9(2) VALUE +0    03067016
RONNAZ                                                      COMP-3.     03068016
RONNAZ     05 PV-SUM-UNIT-COST-AMT           PIC S9(7)V9(2) VALUE +0    03069016
RONNAZ                                                      COMP-3.     03070016
RONNAZ     05 PV-IN-PURCH-EXTD-GRO-COST-AMT  PIC S9(7)V9(2) VALUE +0    03080016
RONNAZ                                                      COMP-3.     03090016
RONNAZ     05 PV-IN-PURCH-FRGT-AMT           PIC S9(7)V9(2) VALUE +0    03100016
RONNAZ                                                      COMP-3.     03101016
RONNAZ     05 PV-IN-PURCH-DISC-AMT           PIC S9(7)V9(2) VALUE +0    03102016
RONNAZ                                                      COMP-3.     03103016
RONNAZ     05 PV-IN-PURCH-EXTD-NET-COST-AMT  PIC S9(7)V9(2) VALUE +0    03104016
RONNAZ                                                      COMP-3.     03105016
RONNAZ     05 PV-IN-PURCH-EXTD-RTL-AMT       PIC S9(7)V9(2) VALUE +0    03106016
RONNAZ                                                      COMP-3.     03107016
RONNAZ     05 PV-AC-PURCH-EXTD-GRO-COST-AMT  PIC S9(7)V9(2) VALUE +0    03108016
RONNAZ                                                      COMP-3.     03109016
RONNAZ     05 PV-AC-PURCH-FRGT-AMT           PIC S9(7)V9(2) VALUE +0    03109116
RONNAZ                                                      COMP-3.     03109216
RONNAZ     05 PV-AC-PURCH-DISC-AMT           PIC S9(7)V9(2) VALUE +0    03109316
RONNAZ                                                      COMP-3.     03109416
RONNAZ     05 PV-AC-PURCH-EXTD-NET-COST-AMT  PIC S9(7)V9(2) VALUE +0    03109516
RONNAZ                                                      COMP-3.     03109616
RONNAZ     05 PV-AC-PURCH-EXTD-RTL-AMT       PIC S9(7)V9(2) VALUE +0    03109716
RONNAZ                                                      COMP-3.     03109816
RONNAZ     05 PV-COST-PERCENT                PIC S9(3)V9(7) VALUE +0    03109916
RONNAZ                                                      COMP-3.     03110016
RONNAZ     05 PV-LAST-FOUND-ML-LWST-ID       PIC S9(9) COMP VALUE +0.   03110120
RONNAZ     05 PV-LAST-FOUND-LBL-SEQ-NBR      PIC S9(4) COMP VALUE +0.   03110220
RONNAZ     05 PV-LAST-FOUND-ENT-ID           PIC S9(09) COMP VALUE +0.  03110320
RONNAZ                                                                  03110420
           05 PV-BV003-PV-RETURN-CDE         PIC 9(04)  VALUE ZEROS.    03111016
           05  PV-EDIT-ORA-SOURCE            PIC X(04)  VALUE SPACES.   03112016
               88  VALID-ORACLE-CONNECT-STRING                          03113016
                                            VALUES 'PRD ', 'TST ',      03114016
                                                   'LRN ', 'QA  ',      03115016
                                                   'PRDT'.              03116016
               88  VALID-DEVELOPMENT-REGION VALUES 'TST ',              03117016
                                                   'LRN ', 'QA  ',      03118016
                                                   'PRDT'.              03119016
               88  ORA-PROD-REGION          VALUE 'PRD '.               03120016
W32898                                                                  03130016
W32898     05  PV-DEPT-NBR-COMP-3           PIC S9(04)V COMP-3.         03140016
W32898     05  PV-ENT-ID-COMP               PIC S9(09) COMP.            03150016
W32898     05  PV-LBL-SEQ-NBR-COMP          PIC S9(04) COMP.            03160016
W32898     05  PV-DISP-LBL-SEQ-NBR          PIC  9(04).                 03170016
W32898     05  PV-DISP-PURCH-IN-CNT         PIC  9(08).                 03180016
W32898                                                                  03190016
W31475     05  PV-DR-ALW-NBR                PIC  X(16) VALUE SPACE.     03200016
W31475     05  PV-LBL-SEQ-NBR               PIC S9(09) COMP VALUE +0.   03210016
W31475     05  PV-PRRTN-PCT                 PIC S9(03)V99 COMP-3        03220016
W31475                                                    VALUE ZERO.   03230016
           05 PV-BRAND-VENDOR-TOTALS.                                   03240016
              10  PV-REC-TYPE-IN            PIC  X(3) VALUE SPACES.     03250016
              10  PV-TOT-EDIT-ADJ-RECS-IN   PIC  S9(08) COMP-3          03260016
                                                        VALUE ZERO.     03270016
              10  PV-TOT-EDIT-PCHG-RECS-IN  PIC  S9(08) COMP-3          03280016
                                                        VALUE ZERO.     03290016
              10  PV-TOT-EDIT-PURCH-RECS-IN PIC  S9(08) COMP-3          03300016
                                                        VALUE ZERO.     03301016
              10  PV-TOT-EDIT-SALE-RECS-IN  PIC  S9(08) COMP-3          03302016
                                                        VALUE ZERO.     03303016
              10  PV-TOT-EDIT-ADJ-RECS-OUT  PIC  S9(08) COMP-3          03304016
                                                        VALUE ZERO.     03305016
              10  PV-TOT-EDIT-PCHG-RECS-OUT PIC  S9(08) COMP-3          03306016
                                                        VALUE ZERO.     03307016
              10  PV-TOT-EDIT-PURCH-RECS-OUT PIC S9(08) COMP-3          03308016
                                                        VALUE ZERO.     03309016
              10  PV-TOT-EDIT-SALE-RECS-OUT PIC  S9(08) COMP-3          03310016
                                                        VALUE ZERO.     03320016
           05 PV-BRND-PRRTN-TOTS.                                       03330016
              10  PV-TOTAL-AT-RTL-AMT          PIC S9(11)V99 COMP-3     03340016
                                                             VALUE ZERO.03350016
              10  PV-TOTAL-AT-COST-AMT         PIC S9(11)V99 COMP-3     03360016
                                                             VALUE ZERO.03370016
              10  PV-TOTAL-DISC-AMT            PIC S9(07)V99 VALUE ZERO 03380016
                                                             COMP-3.    03390016
              10  PV-TOTAL-EXTD-GRO-COST-AMT   PIC S9(07)V99 VALUE ZERO 03400016
                                                             COMP-3.    03410016
              10  PV-TOTAL-EXTD-NET-COST-AMT   PIC S9(07)V99 VALUE ZERO 03420016
                                                             COMP-3.    03430016
              10  PV-TOTAL-EXTD-RTL-AMT        PIC S9(07)V99 VALUE ZERO 03440016
                                                             COMP-3.    03450016
              10  PV-TOTAL-FRGT-AMT            PIC S9(07)V99 VALUE ZERO 03460016
                                                             COMP-3.    03470016
              10  PV-TOTAL-NEW-PR-AMT          PIC S9(05)V99 COMP-3     03480016
                                                             VALUE ZERO.03490016
              10  PV-TOTAL-OLD-PR-AMT          PIC S9(05)V99 COMP-3     03500016
                                                             VALUE ZERO.03510016
              10  PV-TOT-PADJ-RTV-COST-AMT     PIC S9(07)V99 COMP-3     03520016
                                                             VALUE ZERO.03530016
              10  PV-TOTAL-SALE-EXTD-RTL-AMT   PIC S9(09)V99 COMP-3     03540016
                                                             VALUE ZERO.03550016
              10  PV-TOTAL-PER-UNT-RTL-AMT     PIC S9(05)V99 COMP-3     03560016
                                                             VALUE ZERO.03570016
                                                                        03580016
           05 PV-PRRTN-WORK-FIELDS.                                     03590016
              10  PV-WORK-AT-RTL-AMT        PIC S9(11)V9999  COMP-3     03600016
                                                             VALUE ZERO.03610016
              10  PV-WORK-AT-COST-AMT       PIC S9(11)V9999  COMP-3     03620016
                                                             VALUE ZERO.03630016
              10  PV-WORK-DISC-AMT          PIC S9(07)V9999 VALUE ZERO  03640016
                                                            COMP-3.     03650016
              10  PV-WORK-EXTD-GRO-COST-AMT PIC S9(07)V9999 VALUE ZERO  03660016
                                                            COMP-3.     03670016
              10  PV-WORK-EXTD-NET-COST-AMT PIC S9(07)V9999 VALUE ZERO  03680016
                                                            COMP-3.     03690016
              10  PV-WORK-EXTD-RTL-AMT      PIC S9(07)V9999 VALUE ZERO  03700016
                                                            COMP-3.     03710016
              10  PV-WORK-FRGT-AMT          PIC S9(07)V9999 VALUE ZERO  03720016
                                                            COMP-3.     03730016
              10  PV-WORK-NEW-PR-AMT        PIC S9(05)V9999  COMP-3     03740016
                                                             VALUE ZERO.03750016
              10  PV-WORK-OLD-PR-AMT        PIC S9(05)V9999  COMP-3     03760016
                                                             VALUE ZERO.03770016
              10  PV-WORK-PADJ-RTV-COST-AMT  PIC S9(7)V9999 COMP-3      03780016
                                                            VALUE ZERO. 03790016
              10  PV-WORK-PER-UNT-RTL-AMT    PIC S9(5)V9999 COMP-3      03800016
                                                            VALUE ZERO. 03810016
NHOLD$     05 PV-HOLD-FIELDS.                                           03820016
NHOLD$        10  PV-HOLD-FILE-BEING-READ    PIC X(02) VALUE SPACES.    03830016
NHOLD$            88 PV-HOLD-FILE-PADJ       VALUE 'PA'.                03840016
NHOLD$            88 PV-HOLD-FILE-PCHG       VALUE 'PC'.                03850016
NHOLD$            88 PV-HOLD-FILE-PURCH      VALUE 'PU'.                03860016
NHOLD$            88 PV-HOLD-FILE-SALE       VALUE 'SA'.                03870016
NHOLD$        10  PV-HOLD-SYS-ORIG           PIC X(02) VALUE SPACES.    03880016
NHOLD$        10  PV-HOLD-TRANS-CDE          PIC X(02) VALUE SPACES.    03890016
NHOLD$        10  PV-HOLD-AP-TRANS-CDE       PIC X(02) VALUE SPACES.    03900016
NHOLD$        10  PV-HOLD-SKU                PIC X(08) VALUE SPACES.    03910016
NHOLD$        10  PV-HOLD-ENT-ID             PIC 9(09) VALUE ZERO.      03920016
J28582        10  PV-HOLD-DEPT-NBR           PIC 9(03) VALUE ZERO.      03930016
NHOLD$        10  PV-HOLD-ML-LWST-ID         PIC S9(9) COMP VALUE ZERO. 03940016
BAUDIT                                                                  03950016
026900***************************************************************** 03960016
027000*  CODE FROM PGM=MLKUP021 FOR CONTROL CARD DATE PROCESSING.       03970016
027100***************************************************************** 03980016
027200 01  CC-CONTROL-CARD.                                             03990016
027300     05  CC-CALENDAR-TYPE                PIC X(02).               04000016
027400     05  FILLER                          PIC X.                   04010016
027500     05  CC-PROC-DATE-ISO                PIC X(10).               04020016
027600     05  CC-PROC-DATE-RDF  REDEFINES                              04030016
027700         CC-PROC-DATE-ISO.                                        04040016
027800         10  CC-PROC-CC                  PIC X(02).               04050016
027900         10  CC-PROC-YY                  PIC X(02).               04060016
028000         10  FILLER                      PIC X(01).               04070016
028100         10  CC-PROC-MM                  PIC X(02).               04080016
028200         10  FILLER                      PIC X(01).               04090016
028300         10  CC-PROC-DD                  PIC X(02).               04100016
028400     05  FILLER                          PIC X.                   04110016
028500     05  CC-PROCESSING-MODE              PIC X(04).               04120016
028600         88  CC-PROCESSING-MODE-VALID    VALUE 'ML'  'INV' 'BOTH'.04130016
028700         88  CC-PROCESSING-MODE-ML       VALUE 'ML'  'BOTH'.      04140016
028800         88  CC-PROCESSING-MODE-ML-ONLY  VALUE 'ML'.              04150016
028900         88  CC-PROCESSING-MODE-INV      VALUE 'INV' 'BOTH'.      04160016
029000         88  CC-PROCESSING-MODE-INV-ONLY VALUE 'INV'.             04170016
029100     05  FILLER                          PIC X.                   04180016
029200     05  CC-CHECK-INV-DATES-SW           PIC X.                   04190016
029300         88  CC-CHECK-INV-DATES-SW-VALID VALUE 'Y' 'N'.           04200016
029400         88  CC-CHECK-INV-DATES          VALUE 'Y'.               04210016
029500         88  CC-DONT-CHECK-INV-DATES     VALUE 'N'.               04220016
029600     05  FILLER                          PIC X(60).               04230016
                                                                        04240016
026900***************************************************************** 04250016
027000*  CODE FOR CONTROL JOB                                           04260016
027100***************************************************************** 04270016
W28582 01  CC-CONTROL-JOB.                                              04280016
W28582     05  CC-JOB-NAME                     PIC X(08).               04290016
W28582     05  FILLER                          PIC X(72).               04300016
W28582******************************************************************04310016
W28582*    HEADING LINES FOR THE PURCH FILE AUDIT REPORT               *04320016
W28582******************************************************************04330016
W28582 01  HL1-HEADING-LINE-1.                                          04340016
W28582     05  FILLER                      PIC X(62)      VALUE SPACES. 04350016
W28582     05  FILLER                      PIC X(26)      VALUE         04360016
W28582         'MLKUP358 PURCH FILE REPORT'.                            04370016
W28582     05  FILLER                      PIC X(62)      VALUE SPACES. 04380016
W28582                                                                  04390016
W28582 01  HL1-HEADING-LINE-2.                                          04400016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 04410016
W28582     05  FILLER                      PIC X(17)      VALUE         04420016
W28582         'SYST  PURCH    AP'.                                     04430016
W28582     05  FILLER                      PIC X(28)      VALUE SPACES. 04440016
W28582     05  FILLER                      PIC X(05)      VALUE         04450016
W28582         'GROSS'.                                                 04460016
W28582     05  FILLER                      PIC X(36)      VALUE SPACES. 04470016
W28582     05  FILLER                      PIC X(03)      VALUE         04480016
W28582         'NET'.                                                   04490016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 04500016
W28582     05  FILLER                      PIC X(04)      VALUE         04510016
W28582         'EXTD'.                                                  04520016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 04530016
W28582     05  FILLER                      PIC X(03)      VALUE         04540016
W28582         'UNT'.                                                   04550016
W28582     05  FILLER                      PIC X(20)      VALUE SPACES. 04560016
W28582     05  FILLER                      PIC X(03)      VALUE         04570016
W28582         'LBL'.                                                   04580016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 04590016
W28582     05  FILLER                      PIC X(02)      VALUE         04600016
W28582         'ML'.                                                    04610016
W28582                                                                  04620016
W28582 01  HL1-HEADING-LINE-3.                                          04630016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 04640016
W28582     05  FILLER                      PIC X(18)      VALUE         04650016
W28582         'ORIG  TRANS  TRANS'.                                    04660016
W28582     05  FILLER                      PIC X(28)      VALUE SPACES. 04670016
W28582     05  FILLER                      PIC X(04)      VALUE         04680016
W28582         'COST'.                                                  04690016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 04700016
W28582     05  FILLER                      PIC X(04)      VALUE         04710016
W28582         'FRGT'.                                                  04720016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 04730016
W28582     05  FILLER                      PIC X(04)      VALUE         04740016
W28582         'DISC'.                                                  04750016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 04760016
W28582     05  FILLER                      PIC X(04)      VALUE         04770016
W28582         'COST'.                                                  04780016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 04790016
W28582     05  FILLER                      PIC X(03)      VALUE         04800016
W28582         'RTL'.                                                   04810016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 04820016
W28582     05  FILLER                      PIC X(03)      VALUE         04830016
W28582         'RTL'.                                                   04840016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 04850016
W28582     05  FILLER                      PIC X(03)      VALUE         04860016
W28582         'ENT'.                                                   04870016
W28582     05  FILLER                      PIC X(08)      VALUE SPACES. 04880016
W28582     05  FILLER                      PIC X(03)      VALUE         04890016
W28582         'SEQ'.                                                   04900016
W28582     05  FILLER                      PIC X(07)      VALUE SPACES. 04910016
W28582     05  FILLER                      PIC X(04)      VALUE         04920016
W28582         'LWST'.                                                  04930016
W28582                                                                  04940016
W28582 01  HL1-HEADING-LINE-4.                                          04950016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 04960016
W28582     05  FILLER                      PIC X(47)      VALUE         04970016
W28582         'CDE   CDE     CDE SKU       LOC   DEPT         '.       04980016
W28582     05  FILLER                      PIC X(51)      VALUE         04990016
W28582         'AMT          AMT          AMT          AMT         '.   05000016
W28582     05  FILLER                      PIC X(51)      VALUE         05010016
W28582         ' AMT          AMT          ID        NBR         ID'.   05020016
W28582                                                                  05030016
W28582******************************************************************05040016
W28582*    HEADING LINES FOR THE SALES FILE AUDIT REPORT               *05050016
W28582******************************************************************05060016
W28582 01  HL2-HEADING-LINE-1.                                          05070016
W28582     05  FILLER                      PIC X(53)      VALUE SPACES. 05080016
W28582     05  FILLER                      PIC X(26)      VALUE         05090016
W28582         'MLKUP358 SALES FILE REPORT'.                            05100016
W28582     05  FILLER                      PIC X(24)      VALUE SPACES. 05110016
W28582                                                                  05120016
W28582 01  HL2-HEADING-LINE-2.                                          05130016
W28582     05  FILLER                      PIC X(29)      VALUE SPACES. 05140016
W28582     05  FILLER                      PIC X(42)      VALUE         05150016
W28582         'SKU       LOC   DEPT     EXTD RTL         '.            05160016
W28582     05  FILLER                      PIC X(28)      VALUE         05170016
W28582         ' ENT     LBL SEQ     ML LWST'.                          05180016
W28582     05  FILLER                      PIC X(04)      VALUE SPACES. 05190016
W28582                                                                  05200016
W28582 01  HL2-HEADING-LINE-3.                                          05210016
W28582     05  FILLER                      PIC X(58)      VALUE SPACES. 05220016
W28582     05  FILLER                      PIC X(41)      VALUE         05230016
W28582         ' AMT           ID         NBR          ID'.             05240016
W28582     05  FILLER                      PIC X(04)      VALUE SPACES. 05250016
W28582                                                                  05260016
W28582******************************************************************05270016
W28582*    HEADING LINES FOR THE PR CHG FILE AUDIT REPORT              *05280016
W28582******************************************************************05290016
W28582 01  HL3-HEADING-LINE-1.                                          05300016
W28582     05  FILLER                      PIC X(48)      VALUE SPACES. 05310016
W28582     05  FILLER                      PIC X(27)      VALUE         05320016
W28582         'MLKUP358 PR CHG FILE REPORT'.                           05330016
W28582     05  FILLER                      PIC X(57)      VALUE SPACES. 05340016
W28582                                                                  05350016
W28582 01  HL3-HEADING-LINE-2.                                          05360016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 05370016
W28582     05  FILLER                      PIC X(17)      VALUE         05380016
W28582         'SYST   PC      AP'.                                     05390016
W28582     05  FILLER                      PIC X(32)      VALUE SPACES. 05400016
W28582     05  FILLER                      PIC X(04)      VALUE         05410016
W28582         'EXTD'.                                                  05420016
W28582     05  FILLER                      PIC X(11)      VALUE SPACES. 05430016
W28582     05  FILLER                      PIC X(03)      VALUE         05440016
W28582         'OLD'.                                                   05450016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 05460016
W28582     05  FILLER                      PIC X(03)      VALUE         05470016
W28582         'NEW'.                                                   05480016
W28582     05  FILLER                      PIC X(20)      VALUE SPACES. 05490016
W28582     05  FILLER                      PIC X(03)      VALUE         05500016
W28582         'LBL'.                                                   05510016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 05520016
W28582     05  FILLER                      PIC X(02)      VALUE         05530016
W28582         'ML'.                                                    05540016
W28582     05  FILLER                      PIC X(19)      VALUE SPACES. 05550016
W28582                                                                  05560016
W28582 01  HL3-HEADING-LINE-3.                                          05570016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 05580016
W28582     05  FILLER                      PIC X(18)      VALUE         05590016
W28582         'ORIG  TRANS  TRANS'.                                    05600016
W28582     05  FILLER                      PIC X(32)      VALUE SPACES. 05610016
W28582     05  FILLER                      PIC X(03)      VALUE         05620016
W28582         'RTL'.                                                   05630016
W28582     05  FILLER                      PIC X(12)      VALUE SPACES. 05640016
W28582     05  FILLER                      PIC X(02)      VALUE         05650016
W28582         'PR'.                                                    05660016
W28582     05  FILLER                      PIC X(11)      VALUE SPACES. 05670016
W28582     05  FILLER                      PIC X(02)      VALUE         05680016
W28582         'PR'.                                                    05690016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 05700016
W28582     05  FILLER                      PIC X(03)      VALUE         05710016
W28582         'ENT'.                                                   05720016
W28582     05  FILLER                      PIC X(08)      VALUE SPACES. 05730016
W28582     05  FILLER                      PIC X(03)      VALUE         05740016
W28582         'SEQ'.                                                   05750016
W28582     05  FILLER                      PIC X(07)      VALUE SPACES. 05760016
W28582     05  FILLER                      PIC X(04)      VALUE         05770016
W28582         'LWST'.                                                  05780016
W28582     05  FILLER                      PIC X(19)      VALUE SPACES. 05790016
W28582                                                                  05800016
W28582 01  HL3-HEADING-LINE-4.                                          05810016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 05820016
W28582     05  FILLER                      PIC X(50)      VALUE         05830016
W28582         'CDE   CDE     CDE   SKU       LOC   DEPT          '.    05840016
W28582     05  FILLER                      PIC X(50)      VALUE         05850016
W28582         'AMT           AMT          AMT          ID        '.    05860016
W28582     05  FILLER                      PIC X(31)      VALUE         05870016
W28582         'NBR         ID                 '.                       05880016
W28582******************************************************************05890016
W28582*    HEADING LINES FOR THE ADJ FILE AUDIT REPORT                  05900016
W28582******************************************************************05910016
W28582 01  HL4-HEADING-LINE-1.                                          05920016
W28582     05  FILLER                      PIC X(53)      VALUE SPACES. 05930016
W28582     05  FILLER                      PIC X(24)      VALUE         05940016
W28582         'MLKUP358 ADJ FILE REPORT'.                              05950016
W28582     05  FILLER                      PIC X(26)      VALUE SPACES. 05960016
W28582                                                                  05970016
W28582 01  HL4-HEADING-LINE-2.                                          05980016
W28582     05  FILLER                      PIC X(29)      VALUE SPACES. 05990016
W28582     05  FILLER                      PIC X(04)      VALUE         06000016
W28582         'SYST'.                                                  06010016
W28582     05  FILLER                      PIC X(44)      VALUE SPACES. 06020016
W28582     05  FILLER                      PIC X(04)      VALUE         06030016
W28582         'LBL'.                                                   06040016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 06050016
W28582     05  FILLER                      PIC X(02)      VALUE         06060016
W28582         'ML'.                                                    06070016
W28582     05  FILLER                      PIC X(11)      VALUE SPACES. 06080016
W28582 01  HL4-HEADING-LINE-3.                                          06090016
W28582     05  FILLER                      PIC X(29)      VALUE SPACES. 06100016
W28582     05  FILLER                      PIC X(04)      VALUE         06110016
W28582         'ORIG'.                                                  06120016
W28582     05  FILLER                      PIC X(33)      VALUE SPACES. 06130016
W28582     05  FILLER                      PIC X(03)      VALUE         06140016
W28582         'ENT'.                                                   06150016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 06160016
W28582     05  FILLER                      PIC X(03)      VALUE         06170016
W28582         'SEQ'.                                                   06180016
W28582     05  FILLER                      PIC X(08)      VALUE SPACES. 06190016
W28582     05  FILLER                      PIC X(04)      VALUE         06200016
W28582         'LWST'.                                                  06210016
W28582     05  FILLER                      PIC X(11)      VALUE SPACES. 06220016
W28582 01  HL4-HEADING-LINE-4.                                          06230016
W28582     05  FILLER                      PIC X(29)      VALUE SPACES. 06240016
W28582     05  FILLER                      PIC X(03)      VALUE         06250016
W28582         'CDE'.                                                   06260016
W28582     05  FILLER                      PIC X(03)      VALUE SPACES. 06270016
W28582     05  FILLER                      PIC X(03)      VALUE         06280016
W28582         'SKU'.                                                   06290016
W28582     05  FILLER                      PIC X(08)      VALUE SPACES. 06300016
W28582     05  FILLER                      PIC X(03)      VALUE         06310016
W28582         'LOC'.                                                   06320016
W28582     05  FILLER                      PIC X(04)      VALUE SPACES. 06330016
W28582     05  FILLER                      PIC X(04)      VALUE         06340016
W28582         'DEPT'.                                                  06350016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 06360016
W28582     05  FILLER                      PIC X(02)      VALUE         06370016
W28582         'ID'.                                                    06380016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 06390016
W28582     05  FILLER                      PIC X(03)      VALUE         06400016
W28582         'NBR'.                                                   06410016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 06420016
W28582     05  FILLER                      PIC X(02)      VALUE         06430016
W28582         'ID'.                                                    06440016
W28582     05  FILLER                      PIC X(11)      VALUE SPACES. 06450016
W28582                                                                  06460016
W28582 01  DT1-PURCH-DETAIL.                                            06470016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06480016
W28582     05  DT1-SYST-ORIG-CDE           PIC X(02).                   06490016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     06500016
W28582     05  DT1-PURCH-TRANS-CDE         PIC X(02).                   06510016
W28582     05  FILLER                      PIC X(06)  VALUE SPACES.     06520016
W28582     05  DT1-AP-TRANS-CDE            PIC X(02).                   06530016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06540016
W28582     05  DT1-SKU                     PIC X(08).                   06550016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06560016
W28582     05  DT1-LOC                     PIC X(04).                   06570016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06580016
W28582     05  DT1-DEPT                    PIC X(04).                   06590016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06600016
W28582     05  DT1-GROSS-COST-AMT          PIC ZZZZZZ9.99-.             06610016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06620016
W28582     05  DT1-FRGT-AMT                PIC ZZZZZZ9.99-.             06630016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06640016
W28582     05  DT1-DISC-AMT                PIC ZZZZZZ9.99-.             06650016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06660016
W28582     05  DT1-NET-COST-AMT            PIC ZZZZZZ9.99-.             06670016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06680016
W28582     05  DT1-EXTD-RTL-AMT            PIC ZZZZZZ9.99-.             06690016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06700016
W28582     05  DT1-UNT-RTL-AMT             PIC ZZZZZZ9.99-.             06710016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06720016
W28582     05  DT1-ENT-ID                  PIC X(09).                   06730016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06740016
W28582     05  DT1-LBL-SEQ-NBR             PIC X(09).                   06750016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06760016
W28582     05  DT1-ML-LWST-ID              PIC X(09).                   06770016
W28582 01  DT1-PURCH-ERROR-LINE.                                        06780016
W28582     05  FILLER                      PIC X(43)  VALUE SPACES.     06790016
W28582     05  FILLER                      PIC X(22)  VALUE             06800016
W28582         '*** SEE ERROR FILE ***'.                                06810016
W28582 01  DT2-SALES-DETAIL.                                            06820016
W28582     05  FILLER                      PIC X(29)  VALUE SPACES.     06830016
W28582     05  DT2-SKU                     PIC X(08).                   06840016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06850016
W28582     05  DT2-LOC                     PIC X(04).                   06860016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     06870016
W28582     05  DT2-DEPT                    PIC X(04).                   06880016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     06890016
W28582     05  DT2-EXTD-RTL-AMT            PIC ZZZZZZ9.99-.             06900016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     06910016
W28582     05  DT2-ENT-ID                  PIC X(09).                   06920016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     06930016
W28582     05  DT2-LBL-SEQ-NBR             PIC X(09).                   06940016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     06950016
W28582     05  DT2-ML-LWST-ID              PIC X(09).                   06960016
W28582 01  DT2-SALES-ERROR-LINE.                                        06970016
W28582     05  FILLER                      PIC X(49)  VALUE SPACES.     06980016
W28582     05  FILLER                      PIC X(22)  VALUE             06990016
W28582         '*** SEE ERROR FILE ***'.                                07000016
W28582 01  DT3-PCHG-DETAIL.                                             07010016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     07020016
W28582     05  DT3-SYST-ORIG-CDE           PIC X(02).                   07030016
W28582     05  FILLER                      PIC X(04)  VALUE SPACES.     07040016
W28582     05  DT3-PC-TRANS-CDE            PIC X(02).                   07050016
W28582     05  FILLER                      PIC X(06)  VALUE SPACES.     07060016
W28582     05  DT3-AP-TRANS-CDE            PIC X(02).                   07070016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     07080016
W28582     05  DT3-SKU                     PIC X(08).                   07090016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     07100016
W28582     05  DT3-LOC                     PIC X(04).                   07110016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     07120016
W28582     05  DT3-DEPT                    PIC X(04).                   07130016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     07140016
W28582     05  DT3-EXTD-RTL-AMT            PIC ZZZZZZ9.99-.             07150016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     07160016
W28582     05  DT3-OLD-PR-AMT              PIC ZZZZZZ9.99-.             07170016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     07180016
W28582     05  DT3-NEW-PR-AMT              PIC ZZZZZZ9.99-.             07190016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     07200016
W28582     05  DT3-ENT-ID                  PIC X(09).                   07210016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     07220016
W28582     05  DT3-LBL-SEQ-NBR             PIC X(09).                   07230016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     07240016
W28582     05  DT3-ML-LWST-ID              PIC X(09).                   07250016
W28582 01  DT3-PCHG-ERROR-LINE.                                         07260016
W28582     05  FILLER                      PIC X(43)  VALUE SPACES.     07270016
W28582     05  FILLER                      PIC X(22)  VALUE             07280016
W28582         '*** SEE ERROR FILE ***'.                                07290016
W28582 01  DT4-ADJ-DETAIL.                                              07300016
W28582     05  FILLER                      PIC X(30)  VALUE SPACES.     07310016
W28582     05  DT4-SYST-ORIG-CDE           PIC X(02).                   07320016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     07330016
W28582     05  DT4-SKU                     PIC X(08).                   07340016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     07350016
W28582     05  DT4-LOC                     PIC X(04).                   07360016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     07370016
W28582     05  DT4-DEPT                    PIC X(04).                   07380016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     07390016
W28582     05  DT4-ENT-ID                  PIC X(09).                   07400016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     07410016
W28582     05  DT4-LBL-SEQ-NBR             PIC X(09).                   07420016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     07430016
W28582     05  DT4-ML-LWST-ID              PIC X(09).                   07440016
W28582 01  DT4-ADJ-ERROR-LINE.                                          07450016
W28582     05  FILLER                      PIC X(59)  VALUE SPACES.     07460016
W28582     05  FILLER                      PIC X(22)  VALUE             07470016
W28582         '*** SEE ERROR FILE ***'.                                07480016
W28582 01  CKPT-RESTART-INFO.                                           07490016
W28582     05 CKPT-REC-TYPE               PIC X(03)  VALUE SPACES.      07500016
W28582     05 CKPT-EDIT-ADJ-RECS-IN       PIC S9(08) VALUE +0 COMP-3.   07510016
W28582     05 CKPT-EDIT-PCHG-RECS-IN      PIC S9(08) VALUE +0 COMP-3.   07520016
W28582     05 CKPT-EDIT-PURCH-RECS-IN     PIC S9(08) VALUE +0 COMP-3.   07530016
W28582     05 CKPT-EDIT-SALE-RECS-IN      PIC S9(08) VALUE +0 COMP-3.   07540016
W28582     05 CKPT-EDIT-ADJ-RECS-OUT      PIC S9(08) VALUE +0 COMP-3.   07550016
W28582     05 CKPT-EDIT-PCHG-RECS-OUT     PIC S9(08) VALUE +0 COMP-3.   07560016
W28582     05 CKPT-EDIT-PURCH-RECS-OUT    PIC S9(08) VALUE +0 COMP-3.   07570016
W28582     05 CKPT-EDIT-SALE-RECS-OUT     PIC S9(08) VALUE +0 COMP-3.   07580016
W28582******************************************************************07590016
W28582*    WORK AREA FOR REPORTS                                        07600016
W28582******************************************************************07610016
W28582     COPY DPWS150.                                                07620016
W28582     COPY DPWS132.                                                07630016
W28582                                                                  07640016
      ******************************************************************07650016
      *    WORK AREA PASSED IN CALL TO MLKUP359                        *07660016
      ******************************************************************07670016
           COPY MLWS006.                                                07680016
                                                                        07690016
       01  DP402-COMMAREA             PIC X(1).                         07700016
      ******************************************************************07710016
      *  DB2 SQL ERROR MESSAGE FORMAT AREA                              07720016
      ******************************************************************07730016
           COPY DPWS004.                                                07740016
      ******************************************************************07750016
      * BRAND PRORATION PERCENT TABLE                                   07760016
      ******************************************************************07770016
           EXEC SQL                                                     07780016
             INCLUDE BVT00003                                           07790016
           END-EXEC.                                                    07800016
      ******************************************************************07810016
      * RTV DETAIL TABLE                                                07820016
      ******************************************************************07830016
           EXEC SQL                                                     07840016
             INCLUDE TDFMEIT                                            07850016
           END-EXEC.                                                    07860016
      ******************************************************************07870016
      * DATE TABLE                                                      07880016
      ******************************************************************07890016
           EXEC SQL                                                     07900016
             INCLUDE TDTATTR                                            07910016
           END-EXEC.                                                    07920016
W31475******************************************************************07930016
W31475* MLTW_DR_ALW_BRND_PRRTN TABLE                                    07940016
W31475******************************************************************07950016
W31475     EXEC SQL                                                     07960016
W31475       INCLUDE MLT00019                                           07970016
W31475     END-EXEC.                                                    07980016
      ******************************************************************07990016
      *  SYSTEM DUMMY TABLE                                             08000016
      ******************************************************************08010016
           EXEC SQL                                                     08020016
               INCLUDE SYSDUMMY                                         08030016
           END-EXEC.                                                    08040016
      ******************************************************************08050016
      *  DB2 TABLE DECLARATION - CHECKPOINT RESTART INFO TBL(TCKRSTINF) 08060016
      *  THIS TABLE IS USED TO STORE WORKING STORAGE INFORMATION FOR    08070016
      *  CHECKPOINT RESTARTS.                                           08080016
      ******************************************************************08090016
           EXEC SQL                                                     08100016
               INCLUDE TCKRSTIN                                         08110016
           END-EXEC.                                                    08120016
                                                                        08130016
      ******************************************************************08140016
      *  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)08150016
      *  THIS TABLE IS USED FOR CHECKPOINT RESTARTS.                    08160016
      ******************************************************************08170016
           EXEC SQL                                                     08180016
               INCLUDE TCKRSTCN                                         08190016
           END-EXEC.                                                    08200016
      ***************************************************************** 08210016
      *    DB2 AREA FOR COMMUNICATIONS                                * 08220016
      ***************************************************************** 08230016
           EXEC SQL                                                     08240016
                INCLUDE SQLCA                                           08250016
           END-EXEC.                                                    08260016
                                                                        08270016
      ******************************************************************08280016
      *  MLRD0022 SALES COPYBOOK                                       *08290016
      ******************************************************************08300016
           COPY MLRD022.                                                08310016
           COPY MLRD022 REPLACING ML022 BY SLOUT.                       08320016
                                                                        08330016
      ******************************************************************08340016
      *  MLRD024 INVENTORY ADJUSTMENT RECORDS                          *08350016
      ******************************************************************08360016
           COPY MLRD024.                                                08370016
           COPY MLRD024 REPLACING ML024 BY IAOUT.                       08380016
                                                                        08390016
      ******************************************************************08400016
      *  MLRD029 PRICE CHANGE                                          *08410016
      ******************************************************************08420016
           COPY MLRD029.                                                08430016
           COPY MLRD029 REPLACING ML029 BY PCOUT.                       08440016
                                                                        08450016
      ******************************************************************08460016
      *  MLRD030 PURCHASE ADJUSTMENTS                                  *08470016
      ******************************************************************08480016
           COPY MLRD030.                                                08490016
           COPY MLRD030 REPLACING ML030 BY PAOUT.                       08500016
      ******************************************************************08510016
      *  MLRD205 ERROR FILE                                             08520016
      ******************************************************************08530016
           COPY MLRD205.                                                08540016
      ******************************************************************08550016
      *  INWS001 PRICING MODULE WS                                      08560016
      ******************************************************************08570016
W31475*    COPY INWS400.                                                08580016
W31475     COPY INWS402.                                                08590016
W31475******************************************************************08600016
W31475*  SKU CROSS REFERENCE LOOKUP TABLE                               08610016
W31475******************************************************************08620016
W31475     EXEC SQL                                                     08630016
W31475         INCLUDE TSKXREF                                          08640016
W31475     END-EXEC.                                                    08650016
W31475                                                                  08660016
W31475******************************************************************08670016
W31475*  VENDOR DEPT TABLE                                              08680016
W31475******************************************************************08681016
W31475     EXEC SQL                                                     08681116
W31475         INCLUDE TVNDDPT                                          08681216
W31475     END-EXEC.                                                    08681316
W31475                                                                  08681416
W31475******************************************************************08681516
W31475*  VENDOR STYLE TABLE                                             08681616
W31475******************************************************************08681716
W31475     EXEC SQL                                                     08681816
W31475         INCLUDE TVNDSTL                                          08681916
W31475     END-EXEC.                                                    08682016
W31475                                                                  08682116
W31475******************************************************************08682216
W31475*  TMDARVS TABLE                                                  08682316
W31475******************************************************************08682416
W31475     EXEC SQL                                                     08682516
W31475         INCLUDE TMDARVS                                          08682616
W31475     END-EXEC.                                                    08682716
W31475                                                                  08682816
W31475******************************************************************08682916
W31475*  UPC TABLE                                                      08683016
W31475******************************************************************08683116
W31475     EXEC SQL                                                     08683216
W31475         INCLUDE TUPC                                             08683316
W31475     END-EXEC.                                                    08683416
W31475                                                                  08683516
W31475******************************************************************08683616
W31475*  TUPCSKU TABLE                                                  08683716
W31475******************************************************************08683816
W31475     EXEC SQL                                                     08683916
W31475         INCLUDE TUPCSKU                                          08684016
W31475     END-EXEC.                                                    08684116
W31475                                                                  08684216
W31475******************************************************************08684316
W31475*  UPCPLS TABLE                                                   08684416
W31475******************************************************************08684516
W31475     EXEC SQL                                                     08684616
W31475         INCLUDE TUPCPLS                                          08684716
W31475     END-EXEC.                                                    08684816
W31475                                                                  08684916
W31475******************************************************************08685016
W31475*  GROUP PRICING TABLE                                            08685116
W31475******************************************************************08685216
W31475     EXEC SQL                                                     08685316
W31475         INCLUDE TMEITGP                                          08685416
W31475     END-EXEC.                                                    08685516
W31475                                                                  08685616
W31475******************************************************************08685716
W31475*  GROUP PRICING TABLE                                            08685816
W31475******************************************************************08685916
W31475     EXEC SQL                                                     08686016
W31475         INCLUDE TMITGPL                                          08686116
W31475     END-EXEC.                                                    08686216
W31475                                                                  08686316
W31475******************************************************************08686416
W31475*  INVENTORY SKU STYLE DELETION TABLE.                            08686516
W31475******************************************************************08686616
W31475     EXEC SQL                                                     08686716
W31475         INCLUDE INT00003                                         08686816
W31475     END-EXEC.                                                    08686916
W31475                                                                  08687016
W31475******************************************************************08687116
W31475     EXEC SQL                                                     08687216
W31475         INCLUDE IMT00015                                         08687316
W31475     END-EXEC.                                                    08687416
W31475                                                                  08687516
W31475******************************************************************08687616
W31475     EXEC SQL                                                     08687716
W31475         INCLUDE IMT00017                                         08687816
W31475     END-EXEC.                                                    08687916
W31475                                                                  08688016
W31475******************************************************************08688116
W31475     EXEC SQL                                                     08688216
W31475         INCLUDE IMT00020                                         08688316
W31475     END-EXEC.                                                    08688416
W31475                                                                  08688516
W31475******************************************************************08688616
W31475     EXEC SQL                                                     08688716
W31475         INCLUDE MLT00011                                         08688816
W31475     END-EXEC.                                                    08688916
W31475                                                                  08689016
W31475******************************************************************08689116
W31475     EXEC SQL                                                     08689216
W31475         INCLUDE MLV00000                                         08689316
W31475     END-EXEC.                                                    08689416
W31475                                                                  08689516
W31475******************************************************************08689616
W31475     EXEC SQL                                                     08689716
W31475         INCLUDE TMDSEAR                                          08689816
W31475     END-EXEC.                                                    08689916
W31475                                                                  08690016
W31475******************************************************************08690116
W31475     EXEC SQL                                                     08690216
W31475         INCLUDE TAPLAVL                                          08690316
W31475     END-EXEC.                                                    08690416
W31475                                                                  08690516
W31475******************************************************************08690616
W31475     EXEC SQL                                                     08690716
W31475         INCLUDE TRSPBAR                                          08690816
W31475     END-EXEC.                                                    08690916
W31475                                                                  08691016
W31475******************************************************************08691116
W31475     EXEC SQL                                                     08691216
W31475         INCLUDE TEXTENT                                          08691316
W31475     END-EXEC.                                                    08691416
W31475                                                                  08691516
W31475******************************************************************08691616
W31475*  PERM PRICING TABLE.                                            08691716
W31475******************************************************************08691816
W31475     EXEC SQL                                                     08691916
W31475         INCLUDE TPPCPRC                                          08692016
W31475     END-EXEC.                                                    08692116
W31475                                                                  08692216
W31475******************************************************************08692316
W31475*  TPPCPRC TABLE LOOKUP.                                          08692416
W31475***************************************************************** 08692516
W31475     EXEC SQL                                                     08692616
W31475          DECLARE TPPCPRC-CSR CURSOR FOR                          08692716
W31475             SELECT RTL_AMT                                       08692816
W31475                   ,MEITGP_NBR                                    08692916
W31475                   ,STATUS_CDE                                    08693016
W31475             FROM TPPCPRC                                         08693116
W31475             WHERE TSK_ITM_NBR = :PPCPRC-TSK-ITM-NBR              08693216
W31475               AND STR_NBR = :PPCPRC-STR-NBR                      08693316
W31475               AND (:PPCPRC-STRT-TMST >= STRT_TMST AND            08693416
W31475                    :PPCPRC-END-TMST <= END_TMST)                 08693516
W31475             ORDER BY END_TMST DESC                               08693616
W31475             FOR FETCH ONLY                                       08693716
W31475             WITH UR                                              08693816
W31475     END-EXEC.                                                    08693916
W31475                                                                  08694016
W31475******************************************************************08694116
W31475*  INT_SKU_STYL_DLT TABLE LOOKUP - SKU                            08694216
W31475***************************************************************** 08694316
W31475     EXEC SQL                                                     08694416
W31475        DECLARE SKUSTYL-SKU-CSR CURSOR FOR                        08694516
W31475           SELECT UPC_ID                                          08694616
W31475                 ,LOC_NBR                                         08694716
W31475                 ,EFF_BEG_TMST                                    08694816
W31475                 ,UPC_NBR                                         08694916
W31475                 ,EFF_END_TMST                                    08695016
W31475                 ,UPC_STAT_CDE                                    08695116
W31475                 ,UNT_COST_AMT                                    08695216
W31475                 ,UNT_RTL_AMT                                     08695316
W31475                 ,MEITGP_NBR                                      08695416
W31475                 ,ITM_NBR                                         08695516
W31475                 ,INTR_UPC_ID                                     08695616
W31475                 ,UPC_STAT_CHG_DTE                                08695716
W31475                 ,UNT_RTL_CHG_DTE                                 08695816
W31475                 ,ORIG_CLR_DTE                                    08695916
W31475                 ,MKDN_CDE                                        08696016
W31475                 ,SUB_CL_MDSEAR_ID                                08696116
W31475                 ,VS_ID                                           08696216
W31475                 ,DEPT_NBR                                        08696316
W31475                 ,MAJ_CL_NBR                                      08696416
W31475                 ,SUB_CL_NBR                                      08696516
W31475                 ,SKU_NBR                                         08696616
W31475                 ,ENT_ID                                          08696716
W31475                 ,PLU_DWNLD_IND                                   08696816
W31475            FROM INT_SKU_STYL_DLT                                 08696916
W31475            WHERE SKU_NBR = :INT00003-SKU-NBR                     08697016
W31475              AND LOC_NBR = :INT00003-LOC-NBR                     08697116
W31475              AND EFF_BEG_TMST <= :INT00003-EFF-BEG-TMST          08697216
W31475              AND (EFF_END_TMST >= :INT00003-EFF-END-TMST         08697316
W31475               OR  EFF_END_TMST IS NULL)                          08697416
W31475            ORDER BY EFF_END_TMST DESC                            08697516
W31475            WITH UR                                               08697616
W31475     END-EXEC.                                                    08697716
W31475                                                                  08697816
W31475******************************************************************08697916
W31475*  INT_SKU_STYL_DLT TABLE LOOKUP - UPC_NBR                        08698016
W31475***************************************************************** 08698116
W31475     EXEC SQL                                                     08698216
W31475        DECLARE SKUSTYL-UPC-CSR CURSOR FOR                        08698316
W31475           SELECT UPC_ID                                          08698416
W31475                 ,LOC_NBR                                         08698516
W31475                 ,EFF_BEG_TMST                                    08698616
W31475                 ,UPC_NBR                                         08698716
W31475                 ,EFF_END_TMST                                    08698816
W31475                 ,UPC_STAT_CDE                                    08698916
W31475                 ,UNT_COST_AMT                                    08699016
W31475                 ,UNT_RTL_AMT                                     08699116
W31475                 ,MEITGP_NBR                                      08699216
W31475                 ,ITM_NBR                                         08699316
W31475                 ,INTR_UPC_ID                                     08699416
W31475                 ,UPC_STAT_CHG_DTE                                08699516
W31475                 ,UNT_RTL_CHG_DTE                                 08699616
W31475                 ,ORIG_CLR_DTE                                    08699716
W31475                 ,MKDN_CDE                                        08699816
W31475                 ,SUB_CL_MDSEAR_ID                                08699916
W31475                 ,VS_ID                                           08700016
W31475                 ,DEPT_NBR                                        08700116
W31475                 ,MAJ_CL_NBR                                      08700216
W31475                 ,SUB_CL_NBR                                      08700316
W31475                 ,SKU_NBR                                         08700416
W31475                 ,ENT_ID                                          08700516
W31475                 ,PLU_DWNLD_IND                                   08700616
W31475            FROM INT_SKU_STYL_DLT                                 08700716
W31475            WHERE UPC_NBR = :INT00003-UPC-NBR                     08700816
W31475              AND LOC_NBR = :INT00003-LOC-NBR                     08700916
W31475              AND EFF_BEG_TMST <= :INT00003-EFF-BEG-TMST          08701016
W31475              AND (EFF_END_TMST >= :INT00003-EFF-END-TMST         08701116
W31475               OR  EFF_END_TMST IS NULL)                          08701216
W31475            ORDER BY EFF_END_TMST DESC                            08701316
W31475            WITH UR                                               08701416
W31475     END-EXEC.                                                    08701516
W31475                                                                  08701616
W31475******************************************************************08701716
W31475*  INT_SKU_STYL_DLT TABLE LOOKUP - INTR_UPC_ID                    08701816
W31475***************************************************************** 08701916
W31475     EXEC SQL                                                     08702016
W31475        DECLARE SKUSTYL-IUPC-CSR CURSOR FOR                       08702116
W31475           SELECT UPC_ID                                          08702216
W31475                 ,LOC_NBR                                         08702316
W31475                 ,EFF_BEG_TMST                                    08702416
W31475                 ,UPC_NBR                                         08702516
W31475                 ,EFF_END_TMST                                    08702616
W31475                 ,UPC_STAT_CDE                                    08702716
W31475                 ,UNT_COST_AMT                                    08702816
W31475                 ,UNT_RTL_AMT                                     08702916
W31475                 ,MEITGP_NBR                                      08703016
W31475                 ,ITM_NBR                                         08703116
W31475                 ,INTR_UPC_ID                                     08703216
W31475                 ,UPC_STAT_CHG_DTE                                08703316
W31475                 ,UNT_RTL_CHG_DTE                                 08703416
W31475                 ,ORIG_CLR_DTE                                    08703516
W31475                 ,MKDN_CDE                                        08703616
W31475                 ,SUB_CL_MDSEAR_ID                                08703716
W31475                 ,VS_ID                                           08703816
W31475                 ,DEPT_NBR                                        08703916
W31475                 ,MAJ_CL_NBR                                      08704016
W31475                 ,SUB_CL_NBR                                      08704116
W31475                 ,SKU_NBR                                         08704216
W31475                 ,ENT_ID                                          08704316
W31475                 ,PLU_DWNLD_IND                                   08704416
W31475            FROM INT_SKU_STYL_DLT                                 08704516
W31475            WHERE INTR_UPC_ID = :INT00003-INTR-UPC-ID             08704616
W31475              AND LOC_NBR = :INT00003-LOC-NBR                     08704716
W31475              AND EFF_BEG_TMST <= :INT00003-EFF-BEG-TMST          08704816
W31475              AND (EFF_END_TMST >= :INT00003-EFF-END-TMST         08704916
W31475               OR  EFF_END_TMST IS NULL)                          08705016
W31475            ORDER BY EFF_END_TMST DESC                            08705116
W31475            WITH UR                                               08705216
W31475     END-EXEC.                                                    08705316
W31475                                                                  08705416
W31475******************************************************************08705516
W31475*  INT_SKU_STYL_DLT TABLE LOOKUP - ITM_NBR                        08705616
W31475******************************************************************08705716
W31475     EXEC SQL                                                     08705816
W31475        DECLARE SKUSTYL-ITM-CSR CURSOR FOR                        08705916
W31475           SELECT UPC_ID                                          08706016
W31475                 ,LOC_NBR                                         08706116
W31475                 ,EFF_BEG_TMST                                    08706216
W31475                 ,UPC_NBR                                         08706316
W31475                 ,EFF_END_TMST                                    08706416
W31475                 ,UPC_STAT_CDE                                    08706516
W31475                 ,UNT_COST_AMT                                    08706616
W31475                 ,UNT_RTL_AMT                                     08706716
W31475                 ,MEITGP_NBR                                      08706816
W31475                 ,ITM_NBR                                         08706916
W31475                 ,INTR_UPC_ID                                     08707016
W31475                 ,UPC_STAT_CHG_DTE                                08707116
W31475                 ,UNT_RTL_CHG_DTE                                 08707216
W31475                 ,ORIG_CLR_DTE                                    08707316
W31475                 ,MKDN_CDE                                        08707416
W31475                 ,SUB_CL_MDSEAR_ID                                08707516
W31475                 ,VS_ID                                           08707616
W31475                 ,DEPT_NBR                                        08707716
W31475                 ,MAJ_CL_NBR                                      08707816
W31475                 ,SUB_CL_NBR                                      08707916
W31475                 ,SKU_NBR                                         08708016
W31475                 ,ENT_ID                                          08708116
W31475                 ,PLU_DWNLD_IND                                   08708216
W31475            FROM INT_SKU_STYL_DLT                                 08708316
W31475            WHERE ITM_NBR = :INT00003-ITM-NBR                     08708416
W31475              AND LOC_NBR = :INT00003-LOC-NBR                     08708516
W31475              AND EFF_BEG_TMST <= :INT00003-EFF-BEG-TMST          08708616
W31475              AND (EFF_END_TMST >= :INT00003-EFF-END-TMST         08708716
W31475               OR  EFF_END_TMST IS NULL)                          08708816
W31475            ORDER BY EFF_END_TMST DESC                            08708916
W31475            WITH UR                                               08709016
W31475     END-EXEC.                                                    08709116
W31475                                                                  08709216
W31475******************************************************************08709316
W31475* BRAND CURSOR.                                                   08709416
W31475******************************************************************08709516
W31475     EXEC SQL                                                     08709616
W31475         DECLARE BV_BRND_CSR CURSOR FOR                           08709716
W31475           SELECT  DEPT_BRND_VND_ID                               08709816
W31475                  ,DEPT_NBR                                       08709916
W31475                  ,ENT_ID                                         08710016
W31475           FROM IMT_DEPT_BRND_VND                                 08710116
W31475           WHERE LBL_SEQ_NBR   = :BV003-PV-WORK-BRAND             08710216
W31475             AND EFF_BEG_DTE  <= :BV003-PV-WORK-DATE              08710316
W31475             AND (EFF_END_DTE IS NULL OR                          08710416
W31475                  EFF_END_DTE >= :BV003-PV-WORK-DATE)             08710516
W31475           WITH UR                                                08710616
W31475           FOR FETCH ONLY                                         08710716
W31475     END-EXEC.                                                    08710816
W31475                                                                  08710916
W31475************************************************************      08711016
W31475* BRAND DEPT CURSOR.                                              08711116
W31475************************************************************      08711216
W31475     EXEC SQL                                                     08711316
W31475         DECLARE BV_BRND_DEPT_CSR CURSOR FOR                      08711416
W31475           SELECT  DEPT_BRND_VND_ID                               08711516
W31475                  ,ENT_ID                                         08711616
W31475           FROM IMT_DEPT_BRND_VND                                 08711716
W31475           WHERE LBL_SEQ_NBR   = :BV003-PV-WORK-BRAND             08711816
W31475             AND EFF_BEG_DTE  <= :BV003-PV-WORK-DATE              08711916
W31475             AND (EFF_END_DTE IS NULL OR                          08712016
W31475                  EFF_END_DTE >= :BV003-PV-WORK-DATE)             08712116
W31475             AND DEPT_NBR      = :BV003-PV-WORK-DEPT              08712216
W31475           WITH UR                                                08712316
W31475           FOR FETCH ONLY                                         08712416
W31475     END-EXEC.                                                    08712516
W31475                                                                  08712616
W31475************************************************************      08712716
W31475* VENDOR CURSOR.                                                  08712816
W31475************************************************************      08712916
W31475     EXEC SQL                                                     08713016
W31475         DECLARE BV_VNDR_CSR CURSOR FOR                           08713116
W31475           SELECT  DEPT_BRND_VND_ID                               08713216
W31475                  ,DEPT_NBR                                       08713316
W31475                  ,LBL_SEQ_NBR                                    08713416
W31475           FROM IMT_DEPT_BRND_VND                                 08713516
W31475           WHERE ENT_ID        = :BV003-PV-WORK-ENT-ID            08713616
W31475             AND EFF_BEG_DTE  <= :BV003-PV-WORK-DATE              08713716
W31475             AND (EFF_END_DTE IS NULL OR                          08713816
W31475                  EFF_END_DTE >= :BV003-PV-WORK-DATE)             08713916
W31475           WITH UR                                                08714016
W31475           FOR FETCH ONLY                                         08714116
W31475     END-EXEC.                                                    08714216
W31475                                                                  08714316
W31475************************************************************      08714416
W31475* VENDOR DEPT CURSOR.                                             08714516
W31475************************************************************      08714616
W31475     EXEC SQL                                                     08714716
W31475         DECLARE BV_VNDR_DEPT_CSR CURSOR FOR                      08714816
W31475           SELECT  DEPT_BRND_VND_ID                               08714916
W31475                  ,LBL_SEQ_NBR                                    08715016
W31475           FROM IMT_DEPT_BRND_VND                                 08715116
W31475           WHERE ENT_ID        = :BV003-PV-WORK-ENT-ID            08715216
W31475             AND EFF_BEG_DTE  <= :BV003-PV-WORK-DATE              08715316
W31475             AND (EFF_END_DTE IS NULL OR                          08715416
W31475                  EFF_END_DTE >= :BV003-PV-WORK-DATE)             08715516
W31475             AND DEPT_NBR      = :BV003-PV-WORK-DEPT              08715616
W31475           WITH UR                                                08715716
W31475           FOR FETCH ONLY                                         08715816
W31475     END-EXEC.                                                    08715916
W31475************************************************************      08716016
W31475* VENDOR DEPT FUTURE CURSOR                                       08716116
W31475************************************************************      08716216
W31475     EXEC SQL                                                     08716316
W31475         DECLARE BV_VND_DPT_FUT_CSR CURSOR FOR                    08716416
W31475           SELECT  DEPT_BRND_VND_ID                               08716516
W31475                  ,LBL_SEQ_NBR                                    08716616
W31475           FROM IMT_DEPT_BRND_VND                                 08716716
W31475           WHERE ENT_ID        = :BV003-PV-WORK-ENT-ID            08716816
W31475             AND EFF_BEG_DTE  >  :BV003-PV-WORK-DATE              08716916
W31475             AND (EFF_END_DTE IS NULL OR                          08717016
W31475                  EFF_END_DTE >  :BV003-PV-WORK-DATE)             08717116
W31475             AND DEPT_NBR      = :BV003-PV-WORK-DEPT              08717216
W31475           WITH UR                                                08717316
W31475           FOR FETCH ONLY                                         08717416
W31475     END-EXEC.                                                    08717516
W31475************************************************************      08717616
W31475* VENDOR DEPT PAST CURSOR                                         08717716
W31475************************************************************      08717816
W31475     EXEC SQL                                                     08717916
W31475         DECLARE BV_VND_DPT_PST_CSR CURSOR FOR                    08718016
W31475           SELECT  DEPT_BRND_VND_ID                               08718116
W31475                  ,LBL_SEQ_NBR                                    08718216
W31475           FROM IMT_DEPT_BRND_VND BV1                             08718316
W31475           WHERE ENT_ID      =  :BV003-PV-WORK-ENT-ID             08718416
W31475             AND EFF_BEG_DTE <  :BV003-PV-WORK-DATE               08718516
W31475             AND EFF_BEG_DTE >= DATE(:BV003-PV-WORK-DATE) -       08718616
W31475                                     :BV003-PV-PAST-MONTHS MONTHS 08718716
W31475             AND DEPT_NBR    =  :BV003-PV-WORK-DEPT               08718816
W31475             AND EFF_END_DTE = (SELECT MAX(EFF_END_DTE)           08718916
W31475                                  FROM IMT_DEPT_BRND_VND BV2      08719016
W31475                                 WHERE BV1.ENT_ID = BV2.ENT_ID    08719116
W31475                                   AND BV1.LBL_SEQ_NBR =          08719216
W31475                                       BV2.LBL_SEQ_NBR            08719316
W31475                                   AND BV1.DEPT_NBR    =          08719416
W31475                                       BV2.DEPT_NBR               08719516
W31475                                   AND BV2.EFF_BEG_DTE <          08719616
W31475                                       :BV003-PV-WORK-DATE        08719716
W31475                                   AND BV2.EFF_BEG_DTE >=         08719816
W31475                                       DATE(:BV003-PV-WORK-DATE) -08719916
W31475                                       :BV003-PV-PAST-MONTHS      08720016
W31475                                        MONTHS)                   08720116
W31475           WITH UR                                                08720216
W31475           FOR FETCH ONLY                                         08720316
W31475     END-EXEC.                                                    08720416
      ******************************************************************08720516
      *  BRAND VENDOR UTILITY FUNCTIONS.                               *08720616
      ******************************************************************08720716
      *    COPY BVWS001.                                                08720816
                                                                        08720916
      ***************************************************************** 08721016
      *    THIS CURSOR RETRIEVES RTV DETAIL INFORMATION               * 08721116
      ***************************************************************** 08721216
                                                                        08721316
           EXEC SQL                                                     08721416
                DECLARE BRND-PRRTN-CSR CURSOR WITH HOLD FOR             08721516
                SELECT LBL_SEQ_NBR                                      08721616
                      ,MKDN_BYR_RTL_PCT                                 08721716
                      ,MKDN_STR_RTL_PCT                                 08721816
                      ,RCPT_GRO_COST_PCT                                08721916
                      ,PADJ_DA_COST_PCT                                 08722016
                      ,PADJ_RTV_COST_PCT                                08723016
                      ,SLS_REG_RTL_PCT                                  08724016
                  FROM BVT_BRND_PRRTN_PCT PRCH,                         08725016
                       TDTATTR DT                                       08726016
                 WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE        08727016
                   AND DT.KY_DTE            = :PV-PROCESS-DATE          08728016
                   AND PRCH.ENT_ID          = :PV-DB2-ENT-ID            08729016
                   AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR          08730016
           END-EXEC.                                                    08740016
                                                                        08750016
      ***************************************************************** 08760016
      *    THIS CURSOR RETRIEVES RTV DETAIL INFORMATION               * 08770016
      ***************************************************************** 08780016
                                                                        08790016
           EXEC SQL                                                     08800016
                DECLARE RTV-DOC-CSR CURSOR WITH HOLD FOR                08810016
                SELECT DFCT_ITEM_NBR                                    08820016
                      ,SUM(RTL_COST_AMT)                                08830016
                      ,SUM(UNIT_COST_AMT)                               08840016
                  FROM TDFMEIT                                          08850016
                 WHERE DFCT_ORD_ID   = :PV-DB2-RTV-DOC-NBR              08860016
RONNAZ             AND MDSE_DEPT_NBR = :DFMEIT-MDSE-DEPT-NBR            08870016
RONNAZ             AND MDSE_CLASS_NBR       = :DFMEIT-MDSE-CLASS-NBR    08880016
                 GROUP BY  DFCT_ITEM_NBR                                08890016
                 ORDER BY DFCT_ITEM_NBR                                 08900016
           END-EXEC.                                                    08910016
W31475******************************************************************08920016
W31475*   THIS CURSOR RETRIEVES DA PRORATION DETAILS (EARLIER ORACLE)  *08930016
W31475******************************************************************08940016
W31475                                                                  08950016
W31475     EXEC SQL                                                     08960016
W31475          DECLARE DA-BRND-PRRTN-CSR CURSOR FOR                    08970016
W31475          SELECT LBL_SEQ_NBR                                      08980016
W31475                ,PRRTN_PCT                                        08990016
W31475            FROM MLTW_DR_ALW_BRND_PRRTN                           09000016
W31475           WHERE DR_ALW_NBR = :PV-DR-ALW-NBR                      09010016
W31475           ORDER BY LBL_SEQ_NBR                                   09020016
W31475           FOR FETCH ONLY                                         09030016
W31475           WITH UR                                                09040016
W31475     END-EXEC.                                                    09050016
      ******************************************************************09060016
       PROCEDURE DIVISION.                                              09070016
      ******************************************************************09080016
                                                                        09090016
       0000-MAINLINE.                                                   09100016
                                                                        09101016
           PERFORM 1000-INITIALIZE.                                     09102016
                                                                        09103016
           PERFORM 1100-PROCESS-INPUT.                                  09104016
                                                                        09105016
           PERFORM 1200-END-PROCESSING.                                 09106016
                                                                        09107016
           STOP RUN.                                                    09108016
      ******************************************************************09109016
      *  PERFORM THE NECESSARY INITIALIZATION STEPS                     09110016
      ******************************************************************09120016
       1000-INITIALIZE.                                                 09130016
           OPEN  INPUT PURCH-FILE                                       09140016
                       SALE-FILE                                        09150016
                       PRC-CHG-FILE                                     09160016
                       ADJUSTMENT-FILE                                  09170016
                       IN-ORACLE-SRC-CTL                                09180016
                       CNTL-DATE-FILE                                   09190016
W28582                 CNTL-JOB-FILE                                    09200016
                OUTPUT BV-PURCH-FILE                                    09210016
                       BV-SALE-FILE                                     09220016
                       BV-PRC-CHG-FILE                                  09230016
                       BV-ADJUSTMENT-FILE                               09240016
W28582                 BV-ERROR-FILE                                    09250016
W28582                 BV-PURCH-AUDIT-RPT                               09260016
W28582                 BV-SALE-AUDIT-RPT                                09270016
W28582                 BV-PRC-CHG-AUDIT-RPT                             09280016
W28582                 BV-ADJUSTMENT-AUDIT-RPT.                         09290016
                                                                        09300016
           EXEC SQL                                                     09310016
              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                  09320016
           END-EXEC.                                                    09330016
                                                                        09340016
           EVALUATE TRUE                                                09350016
              WHEN SQLCODE = 0                                          09360016
                 CONTINUE                                               09370016
              WHEN OTHER                                                09380016
                 DISPLAY '1000-INITIALIZE'                              09390016
                 PERFORM 9998-SQL-ABEND                                 09400016
           END-EVALUATE.                                                09410016
                                                                        09420016
W28582     PERFORM 9051-READ-CNTL-JOB.                                  09430016
W28582                                                                  09440016
W28582*DETERMINE RUN TYPE                                               09450016
W28582     PERFORM 9800-GET-CHECKPOINT-CNTL.                            09460016
W28582     MOVE PV-CKPT-STAT-CODE  TO  PS-RUN-TYPE-SW.                  09470016
W28582                                                                  09480016
W28582     IF PS-RESTART-RUN                                            09490016
W28582         PERFORM 9802-CHECKPOINT-RESTART                          09500016
W28582         MOVE 0 TO PV-RESTART-COUNT                               09510016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 09520016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 09530016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 09540016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 09550016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 09560016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 09570016
W28582     ELSE                                                         09580016
W28582         MOVE PC-RUN-IN-PROGRESS-CODE    TO PV-CKPT-STAT-CODE     09590016
W28582         PERFORM 9804-UPDATE-TCKRSTCNTL                           09600016
W28582         PERFORM 9801-INITIALIZE-TCKRSTINF                        09610016
W28582     END-IF.                                                      09620016
W28582                                                                  09630016
W28582     MOVE PV-CURRENT-TMST(6:2) TO DP132-RUN-MONTH.                09640016
W28582     MOVE PV-CURRENT-TMST(9:2) TO DP132-RUN-DAY.                  09650016
W28582     MOVE PV-CURRENT-TMST(1:4) TO DP132-RUN-YEAR.                 09660016
W28582     MOVE PV-CURRENT-TMST(12:2) TO DP132-RUN-HOUR.                09670016
W28582     MOVE PV-CURRENT-TMST(15:2) TO DP132-RUN-MINUTE.              09680016
W28582     MOVE PC-PGM-NAME TO DP132-PROGRAM-NAME                       09690016
W28582     MOVE 0 TO DP132-PAGE-NUMBER.                                 09700016
W28582     MOVE PV-CURRENT-TMST(6:2) TO DP150-RUN-MONTH.                09710016
W28582     MOVE PV-CURRENT-TMST(9:2) TO DP150-RUN-DAY.                  09720016
W28582     MOVE PV-CURRENT-TMST(1:4) TO DP150-RUN-YEAR.                 09730016
W28582     MOVE PV-CURRENT-TMST(12:2) TO DP150-RUN-HOUR.                09740016
W28582     MOVE PV-CURRENT-TMST(15:2) TO DP150-RUN-MINUTE.              09750016
W28582     MOVE PC-PGM-NAME TO DP150-PROGRAM-NAME                       09760016
W28582     MOVE 0 TO DP150-PAGE-NUMBER.                                 09770016
W28582     MOVE 1 TO DP150-REPORT-NUMBER.                               09780016
W28582     MOVE 3 TO DP132-REPORT-NUMBER.                               09790016
W28582     MOVE 100 TO PV-LINE-COUNTER.                                 09800016
                                                                        09810016
           PERFORM 9040-READ-ORACLE-SRC-CTL.                            09820016
                                                                        09830016
           PERFORM 9050-READ-CNTL-DTE.                                  09840016
                                                                        09850016
      ******************************************************************09860016
      *  PROCESS THE INPUT FILES.                                       09870016
      ******************************************************************09880016
       1100-PROCESS-INPUT.                                              09890016
           MOVE SPACES TO PV-REC-TYPE-IN.                               09900016
           DISPLAY 'PROCESSING PURCH RECORDS'.                          09910016
NHOLD$     SET PV-HOLD-FILE-PURCH TO TRUE.                              09920016
NHOLD$     PERFORM 6400-RESET-HOLD.                                     09930016
           PERFORM 9000-READ-PURCH-FILE.                                09940016
           IF PS-MORE-PURCH-RECORDS                                     09950016
W28582        MOVE 'PUR' TO PV-REC-TYPE-IN                              09960016
              PERFORM 2000-PROCESS-PURCH-RECS                           09970016
                      UNTIL PS-NO-MORE-PURCH-RECORDS                    09980016
           END-IF.                                                      09990016
                                                                        10000016
           DISPLAY 'PROCESSING SALE RECORDS'.                           10010016
NHOLD$     SET PV-HOLD-FILE-SALE TO TRUE.                               10020016
NHOLD$     PERFORM 6400-RESET-HOLD.                                     10030016
           PERFORM 9010-READ-SALE-FILE.                                 10040016
           IF PS-MORE-SALE-RECORDS                                      10050016
W28582        MOVE 'SAL' TO PV-REC-TYPE-IN                              10060016
              PERFORM 3000-PROCESS-SALE-RECS                            10070016
                      UNTIL PS-NO-MORE-SALE-RECORDS                     10080016
           END-IF.                                                      10090016
                                                                        10100016
           DISPLAY 'PROCESSING PRICE CHANGE RECORDS'.                   10110016
NHOLD$     SET PV-HOLD-FILE-PCHG TO TRUE.                               10120016
NHOLD$     PERFORM 6400-RESET-HOLD.                                     10130016
           PERFORM 9020-READ-PRC-CHG-FILE.                              10140016
           IF PS-MORE-PCHG-RECORDS                                      10150016
W28582        MOVE 'PCH' TO PV-REC-TYPE-IN                              10160016
              PERFORM 4000-PROCESS-PCHG-RECS                            10170016
                      UNTIL PS-NO-MORE-PCHG-RECORDS                     10180016
           END-IF.                                                      10190016
                                                                        10200016
           DISPLAY 'PROCESSING ADJUSTMENT RECORDS'.                     10210016
NHOLD$     SET PV-HOLD-FILE-PADJ TO TRUE.                               10220016
NHOLD$     PERFORM 6400-RESET-HOLD.                                     10230016
           PERFORM 9030-READ-ADJUSTMENT-FILE.                           10240016
           IF PS-MORE-ADJ-RECORDS                                       10250016
W28582        MOVE 'ADJ' TO PV-REC-TYPE-IN                              10260016
              PERFORM 5000-PROCESS-ADJ-RECS                             10270016
                      UNTIL PS-NO-MORE-ADJ-RECORDS                      10280016
           END-IF.                                                      10290016
      ******************************************************************10300016
      *  PERFORM THE NECESSARY END PROCESSING STEPS                     10310016
      ******************************************************************10320016
       1200-END-PROCESSING.                                             10330016
           DISPLAY '*************************************************'  10340016
           DISPLAY 'TOT ADJ RECS IN         ' PV-TOT-EDIT-ADJ-RECS-IN   10350016
           DISPLAY 'TOT PRICE CHG RECS IN   ' PV-TOT-EDIT-PCHG-RECS-IN  10360016
           DISPLAY 'TOT PURCH RECORDS IN    ' PV-TOT-EDIT-PURCH-RECS-IN 10370016
           DISPLAY 'TOT SALE RECORDS IN     ' PV-TOT-EDIT-SALE-RECS-IN  10380016
           DISPLAY '*************************************************'  10390016
           DISPLAY 'TOT ADJ RECS OUT        ' PV-TOT-EDIT-ADJ-RECS-OUT  10400016
           DISPLAY 'TOT PRICE CHG RECS OUT  ' PV-TOT-EDIT-PCHG-RECS-OUT 10410016
           DISPLAY 'TOT PURCH RECORDS OUT   ' PV-TOT-EDIT-PURCH-RECS-OUT10420016
           DISPLAY 'TOT SALE RECORDS OUT    ' PV-TOT-EDIT-SALE-RECS-OUT 10430016
           DISPLAY '*************************************************'  10440016
                                                                        10450016
           CLOSE PURCH-FILE                                             10460016
                 SALE-FILE                                              10470016
                 PRC-CHG-FILE                                           10480016
                 ADJUSTMENT-FILE                                        10490016
                 BV-PURCH-FILE                                          10500016
                 BV-SALE-FILE                                           10510016
                 BV-PRC-CHG-FILE                                        10520016
                 BV-ADJUSTMENT-FILE                                     10530016
W28582           BV-ERROR-FILE                                          10540016
W28582           BV-PURCH-AUDIT-RPT                                     10550016
W28582           BV-SALE-AUDIT-RPT                                      10560016
W28582           BV-PRC-CHG-AUDIT-RPT                                   10570016
W28582           BV-ADJUSTMENT-AUDIT-RPT                                10580016
W28582           CNTL-JOB-FILE.                                         10590016
W28582                                                                  10600016
W28582*  SET CKPT LOGIC TO END OF RUN STATUS CODE ( 0 )                 10610016
W28582                                                                  10620016
W28582     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.              10630016
W28582     PERFORM 9804-UPDATE-TCKRSTCNTL.                              10640016
                                                                        10650016
      ******************************************************************10660016
      *  PROCESS ALL EDIT PURCH RECORDS                                 10670016
      ******************************************************************10680016
       2000-PROCESS-PURCH-RECS.                                         10690016
           ADD 1 TO PV-TOT-EDIT-PURCH-RECS-IN.                          10700016
W32898     MOVE ML030-PURCH-RECORD        TO PAOUT-PURCH-RECORD.        10710016
W32898     MOVE ML030-PURCH-SYST-ORIG-CDE TO PS-PURCH-SYST-ORIG.        10720016
W32898     MOVE ML030-PURCH-TRANS-CDE     TO PS-PURCH-TRANS-CDE.        10730016
W32898     MOVE ML030-PURCH-AP-TRANS-CDE  TO PS-AP-TRANS-CDE.           10740016
                                                                        10750016
W32898     IF PS-PURCH-AP-TRANS-BV-REALIGN                              10760016
W32898         PERFORM 2750-PADJ-REALIGN-PROCESSING                     10770016
W32898     ELSE                                                         10780016
W34309         IF PS-PURCH-AP-TRANS-GIVEBACK                            10790016
W34309             PERFORM 2760-PADJ-GIVEBACK-PROCESSING                10800016
W34309     ELSE                                                         10810016
 ZEROD         IF ML030-PURCH-DEPT-NBR EQUAL ZERO                       10820016
 ZEROD            PERFORM 2900-PURCH-ZERO-DEPT                          10830016
 ZEROD         ELSE                                                     10840016
NHOLD$            PERFORM 6500-CHECK-HOLD-MATCH                         10850016
NHOLD$            IF PS-HOLD-MATCH     AND                              10860016
NHOLD$              (PS-PREV-FOUND-SKU OR PS-PREV-EVEN-PRRTN)           10870016
NHOLD$               PERFORM 2910-PURCH-SKU-MATCH                       10880016
NHOLD$            ELSE                                                  10890016
                    SET PS-NOT-DA-ALW-OR-RTV TO TRUE                    10900016
                    MOVE ML030-PURCH-SYST-ORIG-CDE TO PS-PURCH-SYST-ORIG10910016
                    MOVE ML030-PURCH-TRANS-CDE   TO PS-PURCH-TRANS-CDE  10920016
                    MOVE ML030-PURCH-AP-TRANS-CDE TO PS-AP-TRANS-CDE    10930016
                    IF PS-PURCH-RECEIPT-A OR PS-PURCH-RECEIPT-B OR      10940016
                       PS-PURCH-TRANSFER-FRM-STORE OR                   10950016
                       PS-PURCH-TRANSFER-TO-STORE OR                    10960016
                       PS-PURCH-AP-TRANS-SKU                            10970016
                       PERFORM 2100-PURCH-SKU-PROCESSING                10980016
                    ELSE                                                10990016
                       IF PS-PURCH-AP-TRANS-RTV                         11000016
                          PERFORM 2200-PROCESS-PURCH-RTV-DOC            11010016
                       ELSE                                             11020016
                          IF PS-PURCH-AP-TRANS-VND                      11030016
                             PERFORM 2300-PURCH-VNDR-PROCESSING         11040016
                          ELSE                                          11050016
                             IF PS-PURCH-AP-TRANS-DA                    11060016
                                PERFORM 2800-PURCH-DA-PROCESSING        11070016
                             ELSE                                       11080016
                                SET PS-PURCH-AP-OTHER TO TRUE           11090016
                                IF ML030-PURCH-SKU NOT EQUAL ZEROES AND 11100016
                                   ML030-PURCH-SKU NOT EQUAL SPACES     11110016
                                   PERFORM 2100-PURCH-SKU-PROCESSING    11120016
                                ELSE                                    11130016
                                   PERFORM 2300-PURCH-VNDR-PROCESSING   11140016
                                END-IF                                  11150016
                             END-IF                                     11160016
                          END-IF                                        11170016
                       END-IF                                           11180016
                    END-IF                                              11190016
NHOLD$            END-IF                                                11200016
W32898         END-IF                                                   11210016
W34309       END-IF                                                     11220016
ZEROD      END-IF.                                                      11230016
           PERFORM 9000-READ-PURCH-FILE.                                11240016
      ******************************************************************11250016
      *  DO SKU LEVEL LOOKUP FOR PURCHASE ADJUSTMENTS                   11260016
      ******************************************************************11270016
W28582                                                                  11280016
W28582 2100-PURCH-SKU-PROCESSING.                                       11290016
W28582     INITIALIZE IN402-PV-INPUT-AREA.                              11300016
W28582     SET IN402-PV-SKU-ATTRIB-LOOK TO TRUE.                        11310016
W28582     MOVE ML030-PURCH-FIN-LIAB-DTE TO IN402-PV-EFF-DTE-IN.        11320016
W28582     MOVE ML030-PURCH-SKU          TO IN402-PV-SKU-IN.            11330016
W28582     MOVE '00000'                  TO IN402-PV-LOC-IN.            11340016
W28582     MOVE ML030-PURCH-DEPT-NBR     TO IN402-PV-DEPT-IN-9.         11350016
JAS        MOVE ML030-PURCH-ENT-ID       TO IN402-PV-ENT-ID-IN-9.       11360016
W28582     IF ML030-PURCH-SKU NOT EQUAL ZEROES                          11370016
W28582        PERFORM IN402-LOOKUP-RETAIL                               11380016
W28582     END-IF.                                                      11390016
W28582     IF (IN402-PV-DBV-FOUND OR ML030-PURCH-SKU EQUAL ZEROES OR    11400016
W28582        ML030-PURCH-SKU EQUAL SPACES)                             11410016
W28582                   AND                                            11420016
W28582        (ML030-PURCH-DEPT-NBR = IN402-ATT-DEPT-OUT)               11430016
W28582        IF BV003-UNKNOWN-INS                                      11440016
W28582           PERFORM 8200-COMMIT                                    11450016
W28582        END-IF                                                    11460016
W28582        IF IN402-PV-DUMMY-SKU-VALID OR                            11470016
W28582           ML030-PURCH-SKU EQUAL ZEROES OR                        11480016
W28582           ML030-PURCH-SKU EQUAL SPACES                           11490016
W28582           IF ML030-PURCH-ENT-ID EQUAL SPACES OR                  11500016
W28582              ML030-PURCH-ENT-ID EQUAL ZERO                       11510016
W28582              IF IN402-VND-ENT-ID-OUT NOT EQUAL ZERO              11520016
W28582                 MOVE IN402-VND-ENT-ID-OUT TO PV-DB2-ENT-ID       11530016
W28582              ELSE                                                11540016
W28582                 MOVE PC-UNKNOWN-VENDOR TO PV-DB2-ENT-ID          11550016
W28582              END-IF                                              11560016
W28582           ELSE                                                   11570016
W28582              MOVE ML030-PURCH-ENT-ID   TO PV-DB2-ENT-ID          11580016
W28582           END-IF                                                 11590016
W28582           MOVE ML030-PURCH-DEPT-NBR TO PV-DB2-DEPT-NBR           11600016
W28582           PERFORM 7020-GET-MAX-RCPT-GRO-CST-PCT                  11610016
W28582           SET PS-PRRTN-FOR-PURCH TO TRUE                         11620016
W28582           PERFORM 6000-VNDR-BRND-PRRTN-PROCESS                   11630016
W28582        ELSE                                                      11640016
NHOLD$           SET PS-PREV-FOUND-SKU TO TRUE                          11650016
W28582           MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO                    11660016
W28582                PAOUT-PURCH-ML-LWST-ID                            11670016
W28582           MOVE IN402-VND-LBL-SEQ-NBR    TO                       11680016
W28582                PAOUT-PURCH-LBL-SEQ-NBR                           11690016
W28582           MOVE IN402-VND-ENT-ID-OUT      TO                      11700016
W28582                PAOUT-PURCH-ENT-ID                                11710016
W28582           PERFORM 9400-WRITE-PURCH-REC                           11720016
W28582        END-IF                                                    11730016
W28582     ELSE                                                         11740016
W28582        DISPLAY 'ERROR LOOKING UP VENDOR/BRAND WITH SKU: '        11750016
W28582                 IN402-PV-SKU-IN                                  11760016
W28582        MOVE 'PUR' TO ML205-ML-TRANSACTION                        11770016
W28582        MOVE IN402-VND-LBL-SEQ-NBR TO ML205-ML-VND-LBL-SEQ-NBR    11780016
W28582        IF IN402-PV-RETURN-RSN = SPACES                           11790016
W28582           CONTINUE                                               11800016
W28582        ELSE                                                      11810016
W28582           MOVE IN402-PV-RETURN-RSN TO ML205-ML-NOTE              11820016
W28582        END-IF                                                    11830016
W28582        MOVE ML030-PURCH-RECORD TO ML205-ML-ERROR-INPUT-REC       11840016
W28582        WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD                11850016
W28582                                                                  11860016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         11870016
W28582        WRITE BV-PURCH-AUDIT-REC FROM DT1-PURCH-ERROR-LINE        11880016
W28582            AFTER ADVANCING 1 LINES                               11890016
W28582        ADD 1 TO PV-LINE-COUNTER                                  11900016
W28582        MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO                       11910016
W28582             PAOUT-PURCH-ML-LWST-ID                               11920016
W28582        MOVE IN402-VND-LBL-SEQ-NBR    TO                          11930016
W28582             PAOUT-PURCH-LBL-SEQ-NBR                              11940016
W28582        MOVE IN402-VND-ENT-ID-OUT      TO                         11950016
W28582             PAOUT-PURCH-ENT-ID                                   11960016
W28582        PERFORM 9400-WRITE-PURCH-REC                              11970016
W28582     END-IF.                                                      11980016
      ******************************************************************11990016
      *  PROCESS RTV FOR A DOC NUMBER, GROUPING BY ITEM NUMBER          12000016
      ******************************************************************12010016
       2200-PROCESS-PURCH-RTV-DOC.                                      12020016
NHOLD$     SET PS-PREV-RTV-DOC TO TRUE                                  12030016
           SET PS-DA-ALW-OR-RTV TO TRUE                                 12040016
P49767* AP SYSTEM RAN OUT OF 6 DIGIT DEBIT ORDER NUMBERS AND HENCE THEY 12050016
P49767* APPENDED THE TRANSACTION DATE ALONG WITH OLD DOC NBR TO REUSE   12060016
P49767* IT.THE NEW DOC NUMBER FOR RTV CONTAINS 2 PORTIONS THE ACTUAL    12070016
P49767* DEFECT ORDER ID FOLLOWED BY UNDERSCORE AND THE TRANS DATE.HENCE 12080016
P49767* WE ARE USING THE FIRST PART OF THE DOC NUMBER BEFORE '_'        12090016
P49767* AGAINST THE DEFECT ORDER ID IN THE TABLE TDFMEIT.               12100016
P49767     INITIALIZE PV-TEMP-COUNT.                                    12110016
P49767     INITIALIZE PV-TEMP-DOC-NBR.                                  12120016
P49767     MOVE ML030-PURCH-DOC-16-NBR TO PV-INSPT-STRING.              12130016
P49767     INSPECT PV-INSPT-STRING  REPLACING FIRST '_' BY SPACE.       12140016
P49767     INSPECT PV-INSPT-STRING  TALLYING PV-TEMP-COUNT              12150016
P49767             FOR CHARACTERS BEFORE INITIAL SPACE.                 12160016
289763*                                                                 12170016
289763*UPDATE CHANGE P49767 TO ALLOW FOR A VARIABLE LENGTH FOR THE      12180016
289763*DOCUMENT NUMBER                                                  12181016
289763     MOVE ML030-PURCH-DOC-16-NBR(1:PV-TEMP-COUNT)                 12182016
289763                                TO PV-TEMP-DOC-NBR                12183016
           MOVE PV-TEMP-DOC-NBR       TO PV-DB2-RTV-DOC-NBR             12184016
      *                                                                 12185016
P49767*GB  EVALUATE TRUE                                                12186016
P49767*GB    WHEN PV-TEMP-COUNT = 6                                     12186116
P49767*GB        MOVE ML030-PURCH-DOC-16-NBR(1:6) TO PV-TEMP-DOC-NBR    12186216
P49767*GB        MOVE PV-TEMP-DOC-NBR             TO PV-DB2-RTV-DOC-NBR 12186316
P49767*GB    WHEN PV-TEMP-COUNT = 8                                     12186416
P49767*GB        MOVE ML030-PURCH-DOC-16-NBR(1:8) TO PV-TEMP-DOC-NBR    12186516
P49767*GB        MOVE PV-TEMP-DOC-NBR             TO PV-DB2-RTV-DOC-NBR 12186616
P49767*GB    WHEN OTHER                                                 12186716
P49767*GB        DISPLAY 'INCORRECT DOC NUMBER FOR RTV TRANSACTION'     12186816
P49767*GB        DISPLAY 'PURCH-DOC-NBR:' ML030-PURCH-DOC-16-NBR        12186916
P49767*GB        PERFORM 9999-OTHER-ABEND                               12187016
P49767*GB  END-EVALUATE.                                                12188016
RONNAZ*  GET THE TOTAL DOLLARS FROM THE TDFMEIT TABLE                   12189016
RONNAZ*  FOR THE RTV DOC NUMBER TO DETERMINE IF THE DOLLARS             12189116
RONNAZ*  MATCH THE INPUT RECORD.  WHEN THE DOLLARS MATCH, THEN          12189216
RONNAZ*  FOLLOW LOGIC OF THE RTV DOC NUMBER TO BE FOUND.  WHEN THE      12189316
RONNAZ*  DOLLARS DO NOT MATCH FOLLOW LOGIC TO WHERE THE DOC NUMBER      12189416
RONNAZ*  IS NOT FOUND (RESULTING IN AN EVEN PRORATION OF THE BRAND      12189516
RONNAZ*  VENDOR FOR THE TRANSACTION)                                    12189616
RONNAZ     SET PS-PURCH-RTV-TTL-MATCH-NO TO TRUE.                       12189716
RONNAZ     MOVE ML030-PURCH-DEPT-NBR     TO DFMEIT-MDSE-DEPT-NBR.       12189816
RONNAZ     MOVE ML030-PURCH-CLASS-NBR    TO DFMEIT-MDSE-CLASS-NBR.      12189916
RONNAZ                                                                  12190016
RONNAZ     PERFORM 2220-PRE-CHECK-RTV.                                  12190116
RONNAW     PERFORM 2230-PRE-CHECK-RTV-ZERO-ITM.                         12190217
RONNAW*    WHEN THERE IS NO DOLLAR MATCH FOUND                          12190317
RONNAW*    OR IF ALL OF THE ITEM NUMBERS ON THE TDFMEIT TABLE ARE ZERO  12190417
RONNAW*    THEN FORCE AND END RESULT OF PRORATION OF THE BRAND          12190517
RONNAW*    TO THE 13 WK TABLE OR EVEN PRORATION                         12190617
RONNAW     IF PS-PURCH-RTV-TTL-MATCH-NO OR                              12190717
RONNAW       (PV-DFMEIT-ITEM-NBR-ZERO-COUNT >= 1 AND                    12190817
RONNAW        PV-DFMEIT-ITEM-NBR-COUNT = 1)                             12190917
RONNAZ*    IF PS-PURCH-RTV-TTL-MATCH-NO                                 12191017
P49767*    MOVE ML030-PURCH-DOC-16-NBR TO PV-DB2-RTV-DOC-NBR.           12191116
290824        MOVE ZEROES                 TO PV-DB2-RTV-DOC-NBR         12191217
RONNAZ        DISPLAY 'ML030-PURCH-DOC-16-NBR :' ML030-PURCH-DOC-16-NBR 12191317
RONNAZ        DISPLAY 'RTV NUMBER IN TDFMEIT TOTALS DO NOT MATCH'       12191417
RONNAZ        DISPLAY 'INPUT RECORD FROM AP.       '                    12191517
RONNAZ        DISPLAY ML030-PURCH-RECORD                                12191617
RONNAZ     ELSE                                                         12191716
RONNAZ*    WHEN TOTALS DO MATCH THEN SAVE OFF THE DOLLARS FROM THE      12191816
RONNAZ*    INPUT RECORD TO BE USED IN THE CALCULATIONS FOR              12192016
RONNAZ*    DISBURSEMENT.  NOTE THAT THE ONLY DOLLAR FIELDS ON THE       12192116
RONNAZ*    TDFMEIT TABLE ARE FOR THE PURCH-EXTD-NET-COST-AMT AND THE    12192216
RONNAZ*    PURCH-EXTD-RTL-AMT.  THERE COULD ALSO BE DOLLARS IN THE      12192316
RONNAZ*    PURCH-EXT-GRO-COST-AMT, PURCH-RGT-AMT, AND PURCH-DISC-AMT    12192416
RONNAZ*    AND THOSE WILL BE DISBURSED AT THE ITEM LEVEL BASED OFF      12192516
RONNAZ*    A PERCENTAGE OF THE DOLLAR IN THE TDFMEIT TABLE              12192616
RONNAZ*    DIVIDED BY THE ML030-PURCH-EXT-NET-COST-AMT IN THE INPUT     12192716
RONNAZ*    RECORD.                                                      12192816
RONNAZ*    MOVE THE INPUT RECORD VALUES TO PROGRAM VARIABLE INPUT       12192916
RONNAZ*    FIELDS AND SET ACCUMULATER FIELDS TO ZERO TO BE USED         12193016
RONNAZ*    TO DETERMINE IF THERE ARE ANY REMAINING CENTS THAT WOULD     12193116
RONNAZ*    NEED TO GET ACCOUNTED FOR.                                   12193216
RONNAZ*    ****                                                         12193316
RONNAZ       MOVE ML030-PURCH-EXTD-GRO-COST-AMT TO                      12193416
RONNAZ            PV-IN-PURCH-EXTD-GRO-COST-AMT                         12193516
RONNAZ       MOVE ML030-PURCH-FRGT-AMT          TO                      12193616
RONNAZ            PV-IN-PURCH-FRGT-AMT                                  12193716
RONNAZ       MOVE ML030-PURCH-DISC-AMT          TO                      12193816
RONNAZ            PV-IN-PURCH-DISC-AMT                                  12193916
RONNAZ       MOVE ML030-PURCH-EXTD-NET-COST-AMT TO                      12194016
RONNAZ            PV-IN-PURCH-EXTD-NET-COST-AMT                         12194116
RONNAZ       MOVE ML030-PURCH-EXTD-RTL-AMT      TO                      12194216
RONNAZ            PV-IN-PURCH-EXTD-RTL-AMT                              12194316
RONNAZ       MOVE ZEROS                         TO                      12194416
RONNAZ            PV-AC-PURCH-EXTD-GRO-COST-AMT                         12194516
RONNAZ            PV-AC-PURCH-FRGT-AMT                                  12194616
RONNAZ            PV-AC-PURCH-DISC-AMT                                  12194716
RONNAZ            PV-AC-PURCH-EXTD-NET-COST-AMT                         12194816
RONNAZ            PV-AC-PURCH-EXTD-RTL-AMT                              12194916
RONNAZ            PV-TOTAL-EXTD-GRO-COST-AMT                            12195016
RONNAZ            PV-TOTAL-FRGT-AMT                                     12195116
RONNAZ            PV-TOTAL-DISC-AMT                                     12195216
RONNAZ            PV-TOTAL-EXTD-NET-COST-AMT                            12195316
RONNAZ            PV-TOTAL-EXTD-RTL-AMT                                 12195416
RONNAZ     END-IF.                                                      12195516
           SET PS-MORE-RTV-RECORDS TO TRUE.                             12195616
           INITIALIZE PV-RTV-COUNT.                                     12195716
           PERFORM 8000-OPEN-RTV-DOC-CSR.                               12195816
           PERFORM 8010-FETCH-RTV-DOC-CSR.                              12195916
RONNAW*    SET SWITCH FOR CHECKING IF THE LOOKUP OF THE RTV DOC 16      12196017
RONNAW*    ITEM IS FOUND IN THE XMT_BOM_SKU_ATTR TABLE AT LEAST ONCE    12196117
RONNAW*    TURN IT OFF HERE, AND IT WILL GET TURNED ON IN 2210*         12196217
RONNAW*    PROCESSING WHEN ATTRIBUTES ARE FOUND FOR AT LEAST ONE ITEM   12196317
RONNAW*    BECAUSE IF NO ATTRIBUTES ARE FOUND THEN THE PV-RTV-COUNT     12196417
RONNAW*    NEEDS TO BE RESET BACK TO 0, SO THAT THE 13 WEEK TABLE       12196517
RONNAW*    OR EVEN PRORATION OCCURS.                                    12196617
RONNAW*    ALSO SET THE LAST FOUND ATTRIBUTES TO ZERO.  THESE ARE       12196717
RONNAW*    USED TO FILL IN ATTRIBUTES FOR A ZERO OR NOT FOUND           12196817
RONNAW*    ITEM WHEN AT LEAST ONE RTV ITEM IS FOUND.                    12196917
RONNAW     SET PS-PURCH-RTV-DOC16-NO TO TRUE.                           12197017
RONNAW     MOVE ZERO TO PV-LAST-FOUND-ML-LWST-ID                        12197117
RONNAW                  PV-LAST-FOUND-LBL-SEQ-NBR                       12197217
RONNAW                  PV-LAST-FOUND-ENT-ID.                           12197317
           PERFORM 2210-PROCESS-RTV-DOC-RECS                            12197416
             UNTIL PS-NO-MORE-RTV-RECORDS.                              12197516
RONNAW*    WHEN PS-PURCH-RTV-DOC16-YES (AT LEASTE ONE RTV ITEM FOUND)   12197617
RONNAW     IF PS-PURCH-RTV-DOC16-YES                                    12197717
RONNAZ*       CHECK TO SEE THAT THE ACCUMLATED FIELD MATCHING THE       12198017
RONNAZ*       INPUT RECORD, AND IF IT DOESN'T ADD UP DISPLAY            12199017
RONNAZ*       THE DIFFERENCES HERE                                      12200017
RONNAZ*       IN THEORY THIS SHOULD NOT HAPPEN BUT WAS CODED TO HELP    12210017
RONNAZ*       PROVIDE A CHECK                                           12211017
RONNAZ        IF (PV-IN-PURCH-EXTD-GRO-COST-AMT =                       12212017
RONNAZ            PV-AC-PURCH-EXTD-GRO-COST-AMT) AND                    12213017
RONNAZ           (PV-IN-PURCH-FRGT-AMT          =                       12214017
RONNAZ            PV-AC-PURCH-FRGT-AMT)          AND                    12214117
RONNAZ           (PV-IN-PURCH-DISC-AMT          =                       12214217
RONNAZ            PV-AC-PURCH-DISC-AMT)          AND                    12214317
RONNAZ           (PV-IN-PURCH-EXTD-NET-COST-AMT =                       12214417
RONNAZ            PV-AC-PURCH-EXTD-NET-COST-AMT) AND                    12214517
RONNAZ           (PV-IN-PURCH-EXTD-RTL-AMT      =                       12214617
RONNAZ            PV-AC-PURCH-EXTD-RTL-AMT)                             12214717
RONNAZ           NEXT SENTENCE                                          12214817
RONNAZ        ELSE                                                      12214917
RONNAZ           DISPLAY 'RTV INPUT AND OUTPUT DOLLARS ARE OFF'         12215017
RONNAZ           DISPLAY 'ML030-DOC-16-NBR: ' ML030-PURCH-DOC-16-NBR    12215117
RONNAZ           DISPLAY 'PV-IN-PURCH-EXTD-GRO-COST-AMT: '              12215217
RONNAZ                    PV-IN-PURCH-EXTD-GRO-COST-AMT                 12215317
RONNAZ           DISPLAY 'PV-AC-PURCH-EXTD-GRO-COST-AMT: '              12215417
RONNAZ                    PV-AC-PURCH-EXTD-GRO-COST-AMT                 12215517
RONNAZ           DISPLAY 'PV-IN-PURCH-FRGT-AMT         : '              12215617
RONNAZ                    PV-IN-PURCH-FRGT-AMT                          12215717
RONNAZ           DISPLAY 'PV-AC-PURCH-FRGT-AMT         : '              12215817
RONNAZ                    PV-AC-PURCH-FRGT-AMT                          12215917
RONNAZ           DISPLAY 'PV-IN-PURCH-DISC-AMT         : '              12216017
RONNAZ                    PV-IN-PURCH-DISC-AMT                          12216117
RONNAZ           DISPLAY 'PV-AC-PURCH-DISC-AMT         : '              12216217
RONNAZ                    PV-AC-PURCH-DISC-AMT                          12216317
RONNAZ           DISPLAY 'PV-IN-PURCH-EXTD-NET-COST-AMT: '              12216417
RONNAZ                    PV-IN-PURCH-EXTD-NET-COST-AMT                 12216517
RONNAZ           DISPLAY 'PV-AC-PURCH-EXTD-NET-COST-AMT: '              12216617
RONNAZ                    PV-AC-PURCH-EXTD-NET-COST-AMT                 12216717
RONNAZ           DISPLAY 'PV-IN-PURCH-EXTD-RTL-AMT     : '              12216817
RONNAZ                    PV-IN-PURCH-EXTD-RTL-AMT                      12216917
RONNAZ           DISPLAY 'PV-AC-PURCH-EXTD-RTL-AMT     : '              12217017
RONNAZ                    PV-AC-PURCH-EXTD-RTL-AMT                      12217117
RONNAZ        END-IF                                                    12217217
RONNAW     ELSE                                                         12217317
RONNAW        MOVE 0 TO PV-RTV-COUNT                                    12217417
RONNAW        DISPLAY 'NO VALID ITEM FOR DOC16 NUMBER'                  12217517
RONNAW     END-IF.                                                      12217617
RONNAZ                                                                  12217716
           PERFORM 8020-CLOSE-RTV-DOC-CSR.                              12217816
RONNAW* IF NO RECORDS ARE FOUND ON THE RTV CURSOR, OR NO BOM FOUND      12217917
RONNAW* FOR ANY OF THE ITEMS IN THE RTV CURSOR, WE NEED TO PRORATE      12218017
      * EVENLY.                                                         12218216
RONNAZ* UPDATING COMMENT HERE TO CLARIFY THAT THE 13 WK TABLE           12218316
RONNAZ* IS USED TO LOOK UP THE BRANDS FOR THE VENDOR'S RECEIPT          12218416
RONNAZ* ACTIVITY PERCENTAGES FOR THE PRORATION OF THE BRANDS            12218516
RONNAZ* UNDER THE VENDOR.  IF THERE IS NOTHING IN THE 13 WEEK TABLE     12218616
RONNAZ* THEN THE BRANDS WILL GET EVENLY PRO-RATED.                      12219016
           IF PV-RTV-COUNT EQUAL ZERO                                   12220016
              MOVE ML030-PURCH-ENT-ID   TO PV-DB2-ENT-ID                12230016
              MOVE ML030-PURCH-DEPT-NBR TO PV-DB2-DEPT-NBR              12240016
              PERFORM 7030-GET-MAX-PADJ-RTV-COST-PCT                    12250016
              SET PS-PRRTN-FOR-PURCH TO TRUE                            12260016
              PERFORM 6000-VNDR-BRND-PRRTN-PROCESS                      12270016
           END-IF.                                                      12280016
      ******************************************************************12290016
      *  PROCESS ALL THE RECORDS IN THE RTV DOCUMENT CURSOR.            12300016
      ******************************************************************12310016
W28582 2210-PROCESS-RTV-DOC-RECS.                                       12320016
W28582     INITIALIZE IN402-PV-INPUT-AREA.                              12330016
W28582     SET IN402-PV-ITEM-ATTRIB-LOOK TO TRUE.                       12340016
W28582     MOVE DFMEIT-DFCT-ITEM-NBR     TO IN402-PV-ITM-NBR-IN.        12350016
RONNAZ*    MAP ZERO LOCATION NUMBER.  THE GOAL IS TO LOOK UP THE        12360016
RONNAZ*    BRAND VENDOR REGARDLESS OF THE LOCATION NUMBER.              12370016
RONNAZ     MOVE ZERO                     TO IN402-PV-LOC-IN.            12380016
W28582     MOVE ML030-PURCH-FIN-LIAB-DTE TO IN402-PV-EFF-DTE-IN.        12390016
RONNAW     IF DFMEIT-DFCT-ITEM-NBR NOT EQUAL ZEROES                     12391017
W28582        PERFORM IN402-LOOKUP-RETAIL                               12400020
RONNAW        IF IN402-PV-DBV-FOUND                                     12401017
RONNAW*          IF IT IS FOUND THEN PROCESS THE ITEM                   12402017
RONNAW           SET PS-PURCH-RTV-DOC16-YES TO TRUE                     12403017
W28582           IF BV003-UNKNOWN-INS                                   12430017
W28582              PERFORM 8200-COMMIT                                 12440017
W28582           END-IF                                                 12450017
RONNAZ*          MAP THE ATTRIBUTE RESULTS                              12451017
RONNAZ*          SAVE THE ATTRIBUTES IN CASE THE LAST ITEM              12452017
RONNAZ*          IN THE RTV LIST IS NOT FOUND OR ZEROS                  12453017
W28582           MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO                    12454017
W28582                PAOUT-PURCH-ML-LWST-ID                            12455017
RONNAZ                PV-LAST-FOUND-ML-LWST-ID                          12456017
W28582           MOVE IN402-VND-LBL-SEQ-NBR       TO                    12457017
W28582                PAOUT-PURCH-LBL-SEQ-NBR                           12458017
RONNAZ                PV-LAST-FOUND-LBL-SEQ-NBR                         12459017
W28582           MOVE IN402-VND-ENT-ID-OUT        TO                    12459117
W28582                PAOUT-PURCH-ENT-ID                                12459217
RONNAZ                PV-LAST-FOUND-ENT-ID                              12459317
RONNAW*          IF DFMEIT-DFCT-ITEM-NBR EQUAL ZEROES                   12460017
RONNAW*             IF ML030-PURCH-ENT-ID EQUAL SPACES OR               12470017
RONNAW*                ML030-PURCH-ENT-ID EQUAL ZERO                    12480017
RONNAW*                IF BV003-PV-ENT-ID-OUT NOT EQUAL ZERO            12490017
RONNAW*                   MOVE BV003-PV-ENT-ID-OUT TO PV-DB2-ENT-ID     12500017
RONNAW*                ELSE                                             12510017
RONNAW*                   MOVE PC-UNKNOWN-VENDOR TO PV-DB2-ENT-ID       12520017
RONNAW*                END-IF                                           12530017
RONNAW*             ELSE                                                12540017
RONNAW**Z              USE THE ENT ID FROM THE INPUT FILE               12541017
RONNAW*                MOVE ML030-PURCH-ENT-ID   TO PV-DB2-ENT-ID       12550017
RONNAW*             END-IF                                              12560017
RONNAW*             MOVE ML030-PURCH-DEPT-NBR TO PV-DB2-DEPT-NBR        12570017
RONNAW*             PERFORM 7030-GET-MAX-PADJ-RTV-COST-PCT              12580017
RONNAW*             SET PS-PRRTN-FOR-PURCH TO TRUE                      12590017
RONNAW*             PERFORM 6000-VNDR-BRND-PRRTN-PROCESS                12600017
RONNAW*          ELSE                                                   12610017
RONNAZ*             THEN ITEM NUMBER WAS FILLED IN WITH SOMETHING AND   12611017
RONNAZ*             FOUND AND                                           12612017
RONNAZ*             IF THIS IS THE LAST ITEM FETCHED THEN COMPUTE THE   12613017
RONNAZ*             REMAINING AMOUNT OF THE INPUT RECORD INTO THE       12614017
RONNAZ*             BUCKETS                                             12615017
RONNAZ*          THE LAST ITEM IN THE RTV LIST AND AT LEAST 1 RTV       12616017
RONNAZ*          ITEM IS FOUND                                          12617017
RONNAZ*          THE REMAINDER OF THE DOLLARS FROM THE INPUT FILE       12618017
RONNAZ*          WILL GET ADDED INTO THE LAST OUTPUT RECORD             12619017
RONNAZ           IF PV-RTV-COUNT = PV-DFMEIT-ITEM-NBR-COUNT AND         12620018
RONNAZ              PS-PURCH-RTV-DOC16-YES                              12630018
RONNAZ              PERFORM 2420-PURCH-PRRTN-LAST                       12690016
RONNAZ              PERFORM 9400-WRITE-PURCH-REC                        12700016
RONNAZ*             ADD THE REMAINDER OF THE AMOUNTS TO THE TOTALS      12710016
RONNAZ              ADD     PAOUT-PURCH-EXTD-NET-COST-AMT TO            12720016
RONNAZ                      PV-AC-PURCH-EXTD-NET-COST-AMT               12730016
RONNAZ                      PV-TOTAL-EXTD-NET-COST-AMT                  12740016
RONNAZ              ADD     PAOUT-PURCH-EXTD-RTL-AMT      TO            12750016
RONNAZ                      PV-AC-PURCH-EXTD-RTL-AMT                    12751016
RONNAZ                      PV-TOTAL-EXTD-RTL-AMT                       12752016
RONNAZ              ADD     PAOUT-PURCH-EXTD-GRO-COST-AMT TO            12753016
RONNAZ                      PV-AC-PURCH-EXTD-GRO-COST-AMT               12754016
RONNAZ                      PV-TOTAL-EXTD-GRO-COST-AMT                  12755016
RONNAZ              ADD     PAOUT-PURCH-FRGT-AMT          TO            12756016
RONNAZ                      PV-AC-PURCH-FRGT-AMT                        12757016
RONNAZ                      PV-TOTAL-FRGT-AMT                           12758016
RONNAZ              ADD     PAOUT-PURCH-DISC-AMT          TO            12759016
RONNAZ                      PV-AC-PURCH-DISC-AMT                        12760016
RONNAZ                      PV-TOTAL-DISC-AMT                           12760116
RONNAZ           ELSE                                                   12760216
RONNAZ*             THIS IS NOT THE LAST RECORD AND THE ITEM WAS FOUND  12760318
RONNAZ*             MAP THE DOLLARS FROM THE RTV TABLE TO THE PAOUT     12760418
RONNAZ*   1         MOVE VALUES TO PAOUT-* FIELDS BECAUSE 9400-* USES   12760518
RONNAZ*   1         THE PAOUT*  FIELDS                                  12760618
RONNAZ*   1         NOTE THAT THE ML030* INPUT VALUES HAVE BEEN         12760718
RONNAZ*   1         SAVED OFF IN PV-IN* FIELDS                          12760818
RONNAZ              MOVE DFMEIT-UNIT-COST-AMT                           12761516
RONNAZ                           TO PAOUT-PURCH-EXTD-NET-COST-AMT       12761616
RONNAZ              MOVE DFMEIT-RTL-COST-AMT                            12761716
RONNAZ                           TO PAOUT-PURCH-EXTD-RTL-AMT            12761816
RONNAZ*1            FIGURE OUT THE PERCENTAGE OF THE NET COST AMOUNT    12761916
RONNAZ*1            AND USE THAT PERCENTAGE FOR THE PURCH-FRGT-AMT      12762016
RONNAZ*1            THE PURCH-DISC-AMT AND EXTD-GRO-COST-AMT            12762116
RONNAZ              COMPUTE PV-PRORATION-PCT        ROUNDED EQUAL       12762216
RONNAZ*             COMPUTE PV-COST-PERCENT               =             12762316
RONNAZ                 DFMEIT-UNIT-COST-AMT / PV-SUM-UNIT-COST-AMT      12762418
RONNAZ              COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT ROUNDED EQUAL 12762516
RONNAZ                      PV-IN-PURCH-EXTD-GRO-COST-AMT *             12762616
RONNAZ                      PV-PRORATION-PCT                            12762716
RONNAZ              COMPUTE PAOUT-PURCH-FRGT-AMT          ROUNDED EQUAL 12762816
RONNAZ                      PV-IN-PURCH-FRGT-AMT *                      12762916
RONNAZ                      PV-PRORATION-PCT                            12763016
RONNAZ              COMPUTE PAOUT-PURCH-DISC-AMT          ROUNDED EQUAL 12763116
RONNAZ                      PV-IN-PURCH-DISC-AMT *                      12763216
RONNAZ                      PV-PRORATION-PCT                            12763316
RONNAZ*1            ADD DOLLARS TO THE ACCUMULATED FIELDS AND TOTALS    12763416
RONNAZ*             THAT WILL BE USED FOR THE LAST RECORD               12763516
RONNAZ              ADD     PAOUT-PURCH-EXTD-NET-COST-AMT TO            12763616
RONNAZ                      PV-AC-PURCH-EXTD-NET-COST-AMT               12763716
RONNAZ                      PV-TOTAL-EXTD-NET-COST-AMT                  12763816
RONNAZ              ADD     PAOUT-PURCH-EXTD-RTL-AMT      TO            12763916
RONNAZ                      PV-AC-PURCH-EXTD-RTL-AMT                    12764016
RONNAZ                      PV-TOTAL-EXTD-RTL-AMT                       12764116
RONNAZ              ADD     PAOUT-PURCH-EXTD-GRO-COST-AMT TO            12764216
RONNAZ                      PV-AC-PURCH-EXTD-GRO-COST-AMT               12764316
RONNAZ                      PV-TOTAL-EXTD-GRO-COST-AMT                  12764416
RONNAZ              ADD     PAOUT-PURCH-FRGT-AMT          TO            12764516
RONNAZ                      PV-AC-PURCH-FRGT-AMT                        12764616
RONNAZ                      PV-TOTAL-FRGT-AMT                           12764716
RONNAZ              ADD     PAOUT-PURCH-DISC-AMT          TO            12764816
RONNAZ                      PV-AC-PURCH-DISC-AMT                        12764916
RONNAZ                      PV-TOTAL-DISC-AMT                           12765016
RONNAZ*             MAP THE ATTRIBUTE RESULTS                           12765418
RONNAZ*             SAVE THE ATTRIBUTES IN CASE THE LAST ITEM           12765518
RONNAZ*             IN THE RTV LIST IS NOT FOUND OR ZEROS               12765618
W28582              MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO                 12765718
W28582                   PAOUT-PURCH-ML-LWST-ID                         12765818
RONNAZ                   PV-LAST-FOUND-ML-LWST-ID                       12765918
W28582              MOVE IN402-VND-LBL-SEQ-NBR       TO                 12766018
W28582                   PAOUT-PURCH-LBL-SEQ-NBR                        12766118
RONNAZ                   PV-LAST-FOUND-LBL-SEQ-NBR                      12766218
W28582              MOVE IN402-VND-ENT-ID-OUT        TO                 12766318
W28582                   PAOUT-PURCH-ENT-ID                             12766418
RONNAZ                   PV-LAST-FOUND-ENT-ID                           12766518
W28582              PERFORM 9400-WRITE-PURCH-REC                        12766618
W28582           END-IF                                                 12766718
W28582        ELSE                                                      12766818
RONNAW*       DBV WAS NOT FOUND                                         12766918
RONNAW*          WRITE THE ERROR RECORD                                 12767018
RONNAW*          NOTE THAT THE ERROR RECORD GOES NO WHERE               12767118
W28582           DISPLAY 'ERROR PERFORMING BRAND VENDOR LOOKUP '        12767218
W28582           DISPLAY 'WITH ITEM NUMBER.'                            12767318
W28582           MOVE 'PUR' TO ML205-ML-TRANSACTION                     12767418
W28582           MOVE IN402-VND-LBL-SEQ-NBR TO                          12767518
W28582                ML205-ML-VND-LBL-SEQ-NBR                          12767618
W28582           IF IN402-PV-RETURN-RSN = SPACES                        12767718
W28582              CONTINUE                                            12767818
W28582           ELSE                                                   12767918
W28582              MOVE IN402-PV-RETURN-RSN TO ML205-ML-NOTE           12768018
W28582           END-IF                                                 12768118
W28582           MOVE ML030-PURCH-RECORD TO ML205-ML-ERROR-INPUT-REC    12768218
W28582           WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD             12768318
RONNAW*          NOTE THAT THE ERROR FILE ABOVE DOESN'T GO ANYWHERE     12768418
RONNAW*          MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO                    12768518
RONNAW*               PAOUT-PURCH-ML-LWST-ID                            12768618
RONNAW*          MOVE IN402-VND-LBL-SEQ-NBR       TO                    12768718
RONNAW*               PAOUT-PURCH-LBL-SEQ-NBR                           12768818
RONNAW*          MOVE IN402-VND-ENT-ID-OUT        TO                    12768918
RONNAW*               PAOUT-PURCH-ENT-ID                                12769018
RONNAW*          MOVE DFMEIT-RTL-COST-AMT          TO                   12769118
RONNAW*               PAOUT-PURCH-EXTD-RTL-AMT                          12769218
RONNAW*          MOVE DFMEIT-UNIT-COST-AMT         TO                   12769318
RONNAW*               PAOUT-PURCH-EXTD-GRO-COST-AMT                     12769418
RONNAW*               PAOUT-PURCH-EXTD-NET-COST-AMT                     12769518
RONNAW*          PERFORM 9400-WRITE-PURCH-REC                           12769618
RONNAW*          IF DBV NOT FOUND AND THIS IS THE LAST RECORD           12769718
RONNAW*          AND AT LEAST 1 RTV ITEM WAS FOUND                      12769818
RONNAW*          AND THERE REMAINDER NEEDS TO BE WRITTEN                12769918
RONNAZ           IF PV-RTV-COUNT = PV-DFMEIT-ITEM-NBR-COUNT AND         12770018
RONNAZ              PS-PURCH-RTV-DOC16-YES                              12770118
RONNAZ*             MOVE THE SAVED DKEY, BRAND, AND VENDOR              12770218
RONNAZ*             FOR THE LAST SUCCESSFUL FIND OF ITEM                12770318
RONNAZ              MOVE PV-LAST-FOUND-ML-LWST-ID    TO                 12770418
RONNAZ                   PAOUT-PURCH-ML-LWST-ID                         12770518
RONNAZ              MOVE PV-LAST-FOUND-LBL-SEQ-NBR   TO                 12770618
RONNAZ                   PAOUT-PURCH-LBL-SEQ-NBR                        12770718
RONNAZ              MOVE PV-LAST-FOUND-ENT-ID        TO                 12770818
RONNAZ                   PAOUT-PURCH-ENT-ID                             12770918
RONNAZ              PERFORM 2420-PURCH-PRRTN-LAST                       12771018
RONNAZ              PERFORM 9400-WRITE-PURCH-REC                        12771118
RONNAZ*             ADD THE REMAINDER OF THE AMOUNTS TO THE TOTALS      12771218
RONNAZ              ADD     PAOUT-PURCH-EXTD-NET-COST-AMT TO            12771318
RONNAZ                      PV-AC-PURCH-EXTD-NET-COST-AMT               12771418
RONNAZ                      PV-TOTAL-EXTD-NET-COST-AMT                  12771518
RONNAZ              ADD     PAOUT-PURCH-EXTD-RTL-AMT      TO            12771618
RONNAZ                      PV-AC-PURCH-EXTD-RTL-AMT                    12771718
RONNAZ                      PV-TOTAL-EXTD-RTL-AMT                       12771818
RONNAZ              ADD     PAOUT-PURCH-EXTD-GRO-COST-AMT TO            12771918
RONNAZ                      PV-AC-PURCH-EXTD-GRO-COST-AMT               12772018
RONNAZ                      PV-TOTAL-EXTD-GRO-COST-AMT                  12772118
RONNAZ              ADD     PAOUT-PURCH-FRGT-AMT          TO            12772218
RONNAZ                      PV-AC-PURCH-FRGT-AMT                        12772318
RONNAZ                      PV-TOTAL-FRGT-AMT                           12772418
RONNAZ              ADD     PAOUT-PURCH-DISC-AMT          TO            12772518
RONNAZ                      PV-AC-PURCH-DISC-AMT                        12772618
RONNAZ                      PV-TOTAL-DISC-AMT                           12772718
RONNAW           END-IF                                                 12772818
RONNAW        END-IF                                                    12772918
RONNAW*    ITEM IS ZERO                                                 12773018
RONNAW     ELSE                                                         12773118
RONNAW*       IF THIS IS THE LAST ITEM IN THE RTV LIST THEN             12773218
RONNAW*       AND AT LEAST ONE RTV ITEM WAS FOUND                       12773318
RONNAW*       THE REMAINDER GOES TO THE LAST FOUND ITEM                 12773418
RONNAZ        IF PV-RTV-COUNT = PV-DFMEIT-ITEM-NBR-COUNT AND            12773518
RONNAZ           PS-PURCH-RTV-DOC16-YES                                 12773618
RONNAZ*          MOVE THE SAVED DKEY, BRAND, AND VENDOR                 12773718
RONNAZ*          FOR THE LAST SUCCESSFUL FIND OF ITEM                   12773818
RONNAZ           MOVE PV-LAST-FOUND-ML-LWST-ID    TO                    12773918
RONNAZ                PAOUT-PURCH-ML-LWST-ID                            12774018
RONNAZ           MOVE PV-LAST-FOUND-LBL-SEQ-NBR   TO                    12774118
RONNAZ                PAOUT-PURCH-LBL-SEQ-NBR                           12774218
RONNAZ           MOVE PV-LAST-FOUND-ENT-ID        TO                    12774318
RONNAZ                PAOUT-PURCH-ENT-ID                                12774418
RONNAZ           PERFORM 2420-PURCH-PRRTN-LAST                          12774518
RONNAZ           PERFORM 9400-WRITE-PURCH-REC                           12774618
RONNAZ*          ADD THE REMAINDER OF THE AMOUNTS TO THE TOTALS         12774718
RONNAZ           ADD     PAOUT-PURCH-EXTD-NET-COST-AMT TO               12774818
RONNAZ                   PV-AC-PURCH-EXTD-NET-COST-AMT                  12774918
RONNAZ                   PV-TOTAL-EXTD-NET-COST-AMT                     12775018
RONNAZ           ADD     PAOUT-PURCH-EXTD-RTL-AMT      TO               12775118
RONNAZ                   PV-AC-PURCH-EXTD-RTL-AMT                       12775218
RONNAZ                   PV-TOTAL-EXTD-RTL-AMT                          12775318
RONNAZ           ADD     PAOUT-PURCH-EXTD-GRO-COST-AMT TO               12775418
RONNAZ                   PV-AC-PURCH-EXTD-GRO-COST-AMT                  12775518
RONNAZ                   PV-TOTAL-EXTD-GRO-COST-AMT                     12775618
RONNAZ           ADD     PAOUT-PURCH-FRGT-AMT          TO               12775718
RONNAZ                   PV-AC-PURCH-FRGT-AMT                           12775818
RONNAZ                   PV-TOTAL-FRGT-AMT                              12775918
RONNAZ           ADD     PAOUT-PURCH-DISC-AMT          TO               12776018
RONNAZ                   PV-AC-PURCH-DISC-AMT                           12776118
RONNAZ                   PV-TOTAL-DISC-AMT                              12776218
RONNAW        END-IF                                                    12776318
W28582     END-IF.                                                      12950016
W28582                                                                  12960016
W28582     PERFORM 8010-FETCH-RTV-DOC-CSR.                              12970016
RONNAZ                                                                  12980016
      ******************************************************************12990016
RONNAZ******************************************************************13000016
RONNAZ*  GET TOTALS FROM THE RTV TABLE TO CHECK AGAINST THE INPUT       13010016
RONNAZ*  RECORD                                                         13011016
RONNAZ******************************************************************13012016
RONNAZ 2220-PRE-CHECK-RTV.                                              13013016
RONNAZ                                                                  13014016
RONNAZ     INITIALIZE PV-DFMEIT-ITEM-NBR-COUNT                          13015016
RONNAZ                PV-SUM-RTL-COST-AMT                               13016016
RONNAZ                PV-SUM-UNIT-COST-AMT                              13017016
RONNAZ                PV-NULL                                           13018016
RONNAZ                PV-NULL2.                                         13019016
RONNAZ                                                                  13019116
RONNAZ     PERFORM                                                      13019216
RONNAZ         WITH TEST AFTER                                          13019316
RONNAZ         VARYING PV-RETRY-COUNTER                                 13019416
RONNAZ         FROM 1 BY 1                                              13019516
RONNAZ         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13019616
RONNAZ                   OR (SQLCODE = ZERO))                           13019716
RONNAZ         EXEC SQL                                                 13019816
RONNAZ            SELECT COUNT(DISTINCT(DFCT_ITEM_NBR))                 13019916
RONNAZ                  ,SUM(RTL_COST_AMT)                              13020016
RONNAZ                  ,SUM(UNIT_COST_AMT)                             13020116
RONNAZ            INTO   :PV-DFMEIT-ITEM-NBR-COUNT                      13020216
RONNAZ                  ,:PV-SUM-RTL-COST-AMT  :PV-NULL                 13020316
RONNAA                  ,:PV-SUM-UNIT-COST-AMT :PV-NULL2                13020416
RONNAZ            FROM TDFMEIT                                          13020516
RONNAZ            WHERE DFCT_ORD_ID          = :PV-DB2-RTV-DOC-NBR      13020616
RONNAZ              AND MDSE_DEPT_NBR        = :DFMEIT-MDSE-DEPT-NBR    13020716
RONNAZ              AND MDSE_CLASS_NBR       = :DFMEIT-MDSE-CLASS-NBR   13020816
RONNAZ         END-EXEC                                                 13020916
RONNAZ                                                                  13021016
RONNAZ         EVALUATE TRUE                                            13021116
RONNAZ            WHEN SQLCODE = 0                                      13021216
RONNAZ                 IF PV-NULL EQUAL ZERO AND PV-NULL2 EQUAL ZERO    13021316
RONNAZ                    IF PV-SUM-RTL-COST-AMT =                      13021416
RONNAZ                                 ML030-PURCH-EXTD-RTL-AMT AND     13021516
RONNAZ                       PV-SUM-UNIT-COST-AMT =                     13021616
RONNAZ                                 ML030-PURCH-EXTD-GRO-COST-AMT    13021716
RONNAZ                       SET PS-PURCH-RTV-TTL-MATCH-YES TO TRUE     13021816
RONNAZ                    END-IF                                        13021916
RONNAZ                 END-IF                                           13022016
RONNAZ            WHEN SQLCODE = -904                                   13022116
RONNAZ            WHEN SQLCODE = -913                                   13022216
RONNAZ                 CONTINUE                                         13022316
RONNAZ            WHEN SQLWARN0 NOT = SPACES                            13022416
RONNAZ            WHEN SQLCODE < +0                                     13022516
RONNAZ            WHEN SQLCODE > +0                                     13022616
RONNAZ                 DISPLAY '2220-PRE-CHECK-RTV'                     13022716
RONNAZ                 DISPLAY 'PRE CHECK DOLLARS FROM RTV'             13022816
RONNAZ                 PERFORM 9998-SQL-ABEND                           13022916
RONNAZ         END-EVALUATE                                             13023016
RONNAZ     END-PERFORM.                                                 13023116
RONNAZ                                                                  13023216
RONNAZ     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         13023316
RONNAZ        DISPLAY 'RETRIES EXCEEDED FOR MARKDOWN STORE RETAIL PCT'  13023416
RONNAZ        PERFORM 9998-SQL-ABEND                                    13023516
RONNAZ     END-IF.                                                      13023616
RONNAZ                                                                  13023716
RONNAW******************************************************************13023818
RONNAW*  GET TOTALS FROM THE RTV TABLE TO CHECK AGAINST THE INPUT       13023918
RONNAW*  RECORD                                                         13024018
RONNAW******************************************************************13024118
RONNAW 2230-PRE-CHECK-RTV-ZERO-ITM.                                     13024218
RONNAW                                                                  13024318
RONNAW     INITIALIZE PV-DFMEIT-ITEM-NBR-ZERO-COUNT.                    13024418
RONNAW                                                                  13024518
RONNAW     PERFORM                                                      13024618
RONNAW         WITH TEST AFTER                                          13024718
RONNAW         VARYING PV-RETRY-COUNTER                                 13024818
RONNAW         FROM 1 BY 1                                              13024918
RONNAW         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13025018
RONNAW                   OR (SQLCODE = ZERO))                           13025118
RONNAW         EXEC SQL                                                 13025218
RONNAW            SELECT COUNT(DFCT_ITEM_NBR)                           13025318
RONNAW            INTO   :PV-DFMEIT-ITEM-NBR-ZERO-COUNT                 13025418
RONNAW            FROM TDFMEIT                                          13025518
RONNAW            WHERE DFCT_ORD_ID          = :PV-DB2-RTV-DOC-NBR      13025618
RONNAW              AND DFCT_ITEM_NBR        = 0                        13025718
RONNAW              AND MDSE_DEPT_NBR        = :DFMEIT-MDSE-DEPT-NBR    13025818
RONNAW              AND MDSE_CLASS_NBR       = :DFMEIT-MDSE-CLASS-NBR   13025918
RONNAW         END-EXEC                                                 13026018
RONNAW                                                                  13026118
RONNAW         EVALUATE TRUE                                            13026218
RONNAW            WHEN SQLCODE = 0                                      13026318
RONNAW***SET A SWITCH TO SHOW THAT THERE ARE ZERO ITEMS? MAYBE          13026418
RONNAW                 CONTINUE                                         13026518
RONNAW            WHEN SQLCODE = -904                                   13026618
RONNAW            WHEN SQLCODE = -913                                   13026718
RONNAW                 CONTINUE                                         13026818
RONNAW            WHEN SQLWARN0 NOT = SPACES                            13026918
RONNAW            WHEN SQLCODE < +0                                     13027018
RONNAW            WHEN SQLCODE > +0                                     13027118
RONNAW                 DISPLAY '2220-PRE-CHECK-RTV'                     13027218
RONNAW                 DISPLAY 'PRE CHECK DOLLARS FROM RTV'             13027318
RONNAW                 PERFORM 9998-SQL-ABEND                           13027418
RONNAW         END-EVALUATE                                             13027518
RONNAW     END-PERFORM.                                                 13027618
RONNAW                                                                  13027718
RONNAW     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         13027818
RONNAW        DISPLAY 'RETRIES EXCEEDED FOR MARKDOWN STORE RETAIL PCT'  13027918
RONNAW        PERFORM 9998-SQL-ABEND                                    13028018
RONNAW     END-IF.                                                      13028118
RONNAW                                                                  13028218
      ******************************************************************13028316
      *  DO VENDOR LEVEL PROCESSING FOR PURCHASE ADJUSTMENTS            13028416
      ******************************************************************13028516
       2300-PURCH-VNDR-PROCESSING.                                      13028616
           IF ML030-PURCH-ENT-ID EQUAL SPACES OR                        13028716
              ML030-PURCH-ENT-ID EQUAL ZERO                             13028816
              MOVE PC-UNKNOWN-VENDOR  TO PV-DB2-ENT-ID                  13028916
           ELSE                                                         13029016
              MOVE ML030-PURCH-ENT-ID TO PV-DB2-ENT-ID                  13030016
           END-IF.                                                      13040016
           MOVE ML030-PURCH-DEPT-NBR  TO PV-DB2-DEPT-NBR.               13050016
           IF PS-PURCH-AP-STR-RTL                                       13060016
              PERFORM 7000-GET-MAX-MKDN-STR-RTL-PCT                     13070016
           ELSE                                                         13080016
              IF PS-PURCH-AP-BYR-RTL                                    13090016
                 PERFORM 7010-GET-MAX-MKDN-BYR-RTL-PCT                  13100016
              ELSE                                                      13110016
                 IF PS-PURCH-AP-RCPT-GRS-CST OR                         13120016
                    PS-PURCH-RECEIPT-A OR                               13130016
                    PS-PURCH-RECEIPT-B OR                               13140016
                    PS-PURCH-TRANSFER-FRM-STORE OR                      13150016
                    PS-PURCH-TRANSFER-TO-STORE OR                       13160016
                    PS-PURCH-AP-OTHER                                   13170016
                    PERFORM 7020-GET-MAX-RCPT-GRO-CST-PCT               13180016
                 ELSE                                                   13190016
                    IF PS-PURCH-AP-RTV-COST                             13200016
                       PERFORM 7030-GET-MAX-PADJ-RTV-COST-PCT           13210016
                    ELSE                                                13220016
                       IF PS-PURCH-AP-DA-COST                           13230016
                          PERFORM 7040-GET-MAX-PADJ-DA-COST-PCT         13240016
                       END-IF                                           13250016
                    END-IF                                              13260016
                 END-IF                                                 13270016
              END-IF                                                    13280016
           END-IF.                                                      13290016
                                                                        13300016
           SET PS-PRRTN-FOR-PURCH TO TRUE.                              13310016
           PERFORM 6000-VNDR-BRND-PRRTN-PROCESS.                        13320016
                                                                        13330016
      ******************************************************************13340016
      *  DO NECESSARY PROCESSING OF THE BRAND PRORATION CURSOR FOR      13350016
      *  PURCHASE ADJUSTMENTS USING THE 13 WEEK TABLE.                  13360016
      ******************************************************************13370016
       2400-PROCESS-13WK-PURCH.                                         13380016
           IF BVT00003-LBL-SEQ-NBR                                      13390016
              NOT EQUAL PV-MAX-BRAND                                    13400016
              IF PS-PURCH-AP-STR-RTL                                    13410016
                 MOVE BVT00003-MKDN-STR-RTL-PCT TO PV-PRORATION-PCT     13420016
              ELSE                                                      13430016
                 IF PS-PURCH-AP-BYR-RTL                                 13440016
                    MOVE BVT00003-MKDN-BYR-RTL-PCT TO PV-PRORATION-PCT  13450016
                 ELSE                                                   13460016
                    IF PS-PURCH-AP-RCPT-GRS-CST OR                      13470016
                       PS-PURCH-RECEIPT-A OR                            13480016
                       PS-PURCH-RECEIPT-B OR                            13490016
                       PS-PURCH-TRANSFER-FRM-STORE OR                   13500016
                       PS-PURCH-TRANSFER-TO-STORE OR                    13510016
                       PS-PURCH-AP-OTHER                                13520016
                       MOVE BVT00003-RCPT-GRO-COST-PCT TO               13530016
                            PV-PRORATION-PCT                            13540016
                    ELSE                                                13550016
                       IF PS-PURCH-AP-RTV-COST OR                       13560016
                          PS-PURCH-AP-TRANS-RTV                         13570016
                          MOVE BVT00003-PADJ-RTV-COST-PCT TO            13580016
                               PV-PRORATION-PCT                         13590016
                       ELSE                                             13600016
                          IF PS-PURCH-AP-DA-COST                        13610016
                             MOVE BVT00003-PADJ-DA-COST-PCT TO          13620016
                                  PV-PRORATION-PCT                      13630016
                          END-IF                                        13640016
                       END-IF                                           13650016
                    END-IF                                              13660016
                 END-IF                                                 13670016
              END-IF                                                    13680016
              IF PV-PRORATION-PCT NOT EQUAL ZERO                        13690016
                 PERFORM 2410-PURCH-PRRTN-CALC                          13700016
              END-IF                                                    13710016
           ELSE                                                         13720016
              PERFORM 2420-PURCH-PRRTN-LAST                             13730016
           END-IF.                                                      13740016
           IF PV-PRORATION-PCT NOT EQUAL ZERO OR                        13750016
              BVT00003-LBL-SEQ-NBR EQUAL PV-MAX-BRAND                   13760016
              PERFORM 2430-WRITE-PURCH-13WK-REC                         13770016
           END-IF.                                                      13780016
      ******************************************************************13790016
      *  CALCULATE QUANTITIES BASED ON THE PRORATION PERCENTAGE.        13800016
      ******************************************************************13810016
       2410-PURCH-PRRTN-CALC.                                           13820016
           COMPUTE PV-WORK-EXTD-GRO-COST-AMT ROUNDED EQUAL              13830016
                   ML030-PURCH-EXTD-GRO-COST-AMT *                      13840016
                   (PV-PRORATION-PCT / 100).                            13850016
           COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT ROUNDED EQUAL          13860016
                   PV-WORK-EXTD-GRO-COST-AMT.                           13870016
                                                                        13880016
           COMPUTE PV-WORK-FRGT-AMT ROUNDED EQUAL                       13890016
                   ML030-PURCH-FRGT-AMT *                               13900016
                   (PV-PRORATION-PCT / 100).                            13910016
           COMPUTE PAOUT-PURCH-FRGT-AMT ROUNDED EQUAL                   13920016
                   PV-WORK-FRGT-AMT.                                    13930016
                                                                        13940016
           COMPUTE PV-WORK-DISC-AMT ROUNDED EQUAL                       13950016
                   ML030-PURCH-DISC-AMT *                               13960016
                   (PV-PRORATION-PCT / 100).                            13970016
           COMPUTE PAOUT-PURCH-DISC-AMT ROUNDED EQUAL                   13980016
                   PV-WORK-DISC-AMT.                                    13990016
                                                                        14000016
           COMPUTE PV-WORK-EXTD-NET-COST-AMT ROUNDED EQUAL              14010016
                   ML030-PURCH-EXTD-NET-COST-AMT *                      14020016
                   (PV-PRORATION-PCT / 100).                            14030016
           COMPUTE PAOUT-PURCH-EXTD-NET-COST-AMT ROUNDED EQUAL          14040016
                   PV-WORK-EXTD-NET-COST-AMT.                           14050016
                                                                        14060016
           COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL                   14070016
                   ML030-PURCH-EXTD-RTL-AMT *                           14080016
                   (PV-PRORATION-PCT / 100).                            14090016
           COMPUTE PAOUT-PURCH-EXTD-RTL-AMT ROUNDED EQUAL               14100016
                   PV-WORK-EXTD-RTL-AMT.                                14110016
                                                                        14120016
           COMPUTE PV-WORK-PER-UNT-RTL-AMT ROUNDED EQUAL                14130016
                   ML030-PURCH-PER-UNT-RTL-AMT *                        14140016
                   (PV-PRORATION-PCT / 100).                            14150016
           COMPUTE PAOUT-PURCH-PER-UNT-RTL-AMT ROUNDED EQUAL            14160016
                   PV-WORK-PER-UNT-RTL-AMT.                             14170016
                                                                        14180016
           ADD PAOUT-PURCH-EXTD-GRO-COST-AMT TO                         14190016
               PV-TOTAL-EXTD-GRO-COST-AMT.                              14200016
           ADD PAOUT-PURCH-FRGT-AMT          TO PV-TOTAL-FRGT-AMT.      14210016
           ADD PAOUT-PURCH-DISC-AMT          TO PV-TOTAL-DISC-AMT.      14220016
           ADD PAOUT-PURCH-EXTD-NET-COST-AMT TO                         14230016
               PV-TOTAL-EXTD-NET-COST-AMT.                              14240016
           ADD PAOUT-PURCH-EXTD-RTL-AMT     TO PV-TOTAL-EXTD-RTL-AMT.   14250016
           ADD PAOUT-PURCH-PER-UNT-RTL-AMT  TO PV-TOTAL-PER-UNT-RTL-AMT.14260016
                                                                        14270016
      ******************************************************************14280016
      *  DO THE NECESSARY CALCULATIONS FOR TO MAKE SURE THE FULL        14290016
      *  QUANTITY IS PRORATED.                                          14300016
      ******************************************************************14310016
       2420-PURCH-PRRTN-LAST.                                           14320016
           COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT  EQUAL                 14330016
                   ML030-PURCH-EXTD-GRO-COST-AMT  -                     14340016
                   PV-TOTAL-EXTD-GRO-COST-AMT.                          14350016
           COMPUTE PAOUT-PURCH-FRGT-AMT EQUAL                           14360016
                   ML030-PURCH-FRGT-AMT - PV-TOTAL-FRGT-AMT.            14370016
           COMPUTE PAOUT-PURCH-DISC-AMT EQUAL                           14380016
                   ML030-PURCH-DISC-AMT - PV-TOTAL-DISC-AMT.            14390016
           COMPUTE PAOUT-PURCH-EXTD-NET-COST-AMT EQUAL                  14400016
                   ML030-PURCH-EXTD-NET-COST-AMT -                      14410016
                   PV-TOTAL-EXTD-NET-COST-AMT.                          14420016
           COMPUTE PAOUT-PURCH-EXTD-RTL-AMT EQUAL                       14430016
                   ML030-PURCH-EXTD-RTL-AMT - PV-TOTAL-EXTD-RTL-AMT.    14440016
           COMPUTE PAOUT-PURCH-PER-UNT-RTL-AMT EQUAL                    14450016
                   ML030-PURCH-PER-UNT-RTL-AMT -                        14460016
                   PV-TOTAL-PER-UNT-RTL-AMT.                            14470016
      ******************************************************************14480016
      *  SET UP THE OUTPUT RECORD AND CALL THE APPROPRIATE FUNCTION TO  14490016
      *  WRITE THE NEW LINE FOR A PURCHASE ADJUSTMENT THAT USED THE 13  14500016
      *  13 WEEK PRORATION TABLE.                                       14510016
      ******************************************************************14520016
       2430-WRITE-PURCH-13WK-REC.                                       14530016
           MOVE BV003-PV-ENT-ID-OUT     TO PAOUT-PURCH-ENT-ID.          14540016
           MOVE BV003-PV-BRAND-OUT      TO PAOUT-PURCH-LBL-SEQ-NBR.     14550016
           MOVE BV003-PV-RLTNSHP-ID-OUT TO PAOUT-PURCH-ML-LWST-ID.      14560016
           PERFORM 9400-WRITE-PURCH-REC.                                14570016
      ******************************************************************14580016
      *  CALCULATE QUANTITIES BASED ON THE PRORATION PERCENTAGE         14590016
      *  TO EVEN PRORATE ACROSS ALL BRANDS FORA  VENDOR DEPARTMENT.     14600016
      ******************************************************************14610016
       2500-PURCH-EVEN-MAIN.                                            14620016
NHOLD$     INITIALIZE PV-BRND-PRRTN-TOTS                                14630016
           IF BV003-PV-RT-SUB-OUT EQUAL ZERO                            14640016
              MOVE BV003-PV-ENT-ID-OUT     TO PAOUT-PURCH-ENT-ID        14650016
              MOVE BV003-PV-BRAND-OUT      TO PAOUT-PURCH-LBL-SEQ-NBR   14660016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO PAOUT-PURCH-ML-LWST-ID    14670016
              PERFORM 9400-WRITE-PURCH-REC                              14680016
           ELSE                                                         14690016
              PERFORM                                                   14700016
                 VARYING PV-BRAND-COUNT                                 14710016
                 FROM 1 BY 1                                            14720016
                 UNTIL (PV-BRAND-COUNT > BV003-PV-RT-SUB-OUT)           14730016
                 IF PV-BRAND-COUNT NOT EQUAL BV003-PV-RT-SUB-OUT        14740016
                    PERFORM 2410-PURCH-PRRTN-CALC                       14750016
                 ELSE                                                   14760016
                    PERFORM 2420-PURCH-PRRTN-LAST                       14770016
                 END-IF                                                 14780016
                 MOVE BV003-RT-ENT-ID-OUT(PV-BRAND-COUNT)               14790016
                                              TO PAOUT-PURCH-ENT-ID     14800016
                 MOVE BV003-RT-BRND-OUT(PV-BRAND-COUNT)                 14810016
                                              TO PAOUT-PURCH-LBL-SEQ-NBR14820016
                 MOVE BV003-RT-RLTNSHP-ID-OUT(PV-BRAND-COUNT)           14830016
                                              TO PAOUT-PURCH-ML-LWST-ID 14840016
                 PERFORM 9400-WRITE-PURCH-REC                           14850016
              END-PERFORM                                               14860016
           END-IF.                                                      14870016
                                                                        14880016
      ******************************************************************14890016
      *  DO NECESSARY PROCESSING OF THE BRAND PRORATION CURSOR FOR      14900016
      *  PURCHASE ADJUSTMENTS OF AN RTV DOC.                            14910016
      ******************************************************************14920016
       2600-PURCH-13WK-RTV-DOC-MAIN.                                    14930016
           IF BVT00003-LBL-SEQ-NBR                                      14940016
              NOT EQUAL PV-MAX-BRAND                                    14950016
              MOVE BVT00003-PADJ-RTV-COST-PCT TO PV-PRORATION-PCT       14960016
              IF PV-PRORATION-PCT NOT EQUAL ZERO                        14970016
                 PERFORM 2610-PURCH-PRRTN-CALC-RTV-DOC                  14980016
              END-IF                                                    14990016
           ELSE                                                         15000016
              PERFORM 2420-PURCH-PRRTN-LAST                             15010016
           END-IF.                                                      15020016
           IF PV-PRORATION-PCT NOT EQUAL ZERO OR                        15030016
              BVT00003-LBL-SEQ-NBR EQUAL PV-MAX-BRAND                   15040016
              PERFORM 2430-WRITE-PURCH-13WK-REC                         15050016
           END-IF.                                                      15060016
      ******************************************************************15070016
      *  CALCULATE QUANTITIES BASED ON THE PRORATION PERCENTAGE FOR     15080016
      *  AN ITEM ON AN RTV DOC.                                         15090016
      ******************************************************************15100016
       2610-PURCH-PRRTN-CALC-RTV-DOC.                                   15110016
           COMPUTE PV-WORK-EXTD-GRO-COST-AMT ROUNDED EQUAL              15120016
                   DFMEIT-UNIT-COST-AMT * (PV-PRORATION-PCT / 100).     15130016
           COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT ROUNDED EQUAL          15140016
                   PV-WORK-EXTD-NET-COST-AMT.                           15150016
                                                                        15160016
           COMPUTE PV-WORK-EXTD-NET-COST-AMT ROUNDED EQUAL              15170016
                   DFMEIT-UNIT-COST-AMT * (PV-PRORATION-PCT / 100).     15180016
           COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT ROUNDED EQUAL          15190016
                   PV-WORK-EXTD-NET-COST-AMT.                           15200016
                                                                        15210016
           COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL                   15220016
                   DFMEIT-RTL-COST-AMT  * (PV-PRORATION-PCT / 100).     15230016
           COMPUTE PAOUT-PURCH-EXTD-RTL-AMT ROUNDED EQUAL               15240016
                   PV-WORK-EXTD-RTL-AMT.                                15250016
                                                                        15260016
           ADD PAOUT-PURCH-EXTD-GRO-COST-AMT TO                         15270016
               PV-TOTAL-EXTD-GRO-COST-AMT.                              15280016
           ADD PAOUT-PURCH-EXTD-NET-COST-AMT TO                         15290016
               PV-TOTAL-EXTD-NET-COST-AMT.                              15300016
           ADD PAOUT-PURCH-EXTD-RTL-AMT      TO PV-TOTAL-EXTD-RTL-AMT.  15310016
                                                                        15320016
      ******************************************************************15330016
      *  CALCULATE QUANTITIES BASED ON THE PRORATION PERCENTAGE.        15340016
      *  FOR AN ITEM ON AN RTV DOC MAKING SURE THAT THE FULL AMOUNT     15350016
      *  IS ACCOUNTED FOR.                                              15360016
      ******************************************************************15370016
       2700-PURCH-EVEN-RTV-DOC.                                         15380016
           IF BV003-PV-RT-SUB-OUT EQUAL ZERO                            15390016
              MOVE BV003-PV-ENT-ID-OUT     TO PAOUT-PURCH-ENT-ID        15400016
              MOVE BV003-PV-BRAND-OUT      TO PAOUT-PURCH-LBL-SEQ-NBR   15410016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO PAOUT-PURCH-ML-LWST-ID    15420016
              PERFORM 9400-WRITE-PURCH-REC                              15430016
           ELSE                                                         15440016
              PERFORM                                                   15450016
                 VARYING PV-BRAND-COUNT                                 15460016
                 FROM 1 BY 1                                            15470016
                 UNTIL (PV-BRAND-COUNT > BV003-PV-RT-SUB-OUT)           15480016
                 IF PV-BRAND-COUNT NOT EQUAL BV003-PV-RT-SUB-OUT        15490016
                    PERFORM 2610-PURCH-PRRTN-CALC-RTV-DOC               15500016
                 ELSE                                                   15510016
                    PERFORM 2420-PURCH-PRRTN-LAST                       15520016
                 END-IF                                                 15530016
                 MOVE BV003-RT-ENT-ID-OUT(BV003-PV-RT-SUB-OUT)          15540016
                                              TO PAOUT-PURCH-ENT-ID     15550016
                 MOVE BV003-RT-BRND-OUT(BV003-PV-RT-SUB-OUT)            15560016
                                              TO PAOUT-PURCH-LBL-SEQ-NBR15570016
                 MOVE BV003-RT-RLTNSHP-ID-OUT(BV003-PV-RT-SUB-OUT)      15580016
                                              TO PAOUT-PURCH-ML-LWST-ID 15590016
                 PERFORM 9400-WRITE-PURCH-REC                           15600016
              END-PERFORM                                               15610016
           END-IF.                                                      15620016
W32898******************************************************************15630016
W32898*  PROCESS PURCHASE ADJUSTMENTS FOR RECLASS / BRAND / VENDOR      15640016
W32898*  REASSIGNMENTS                                                  15650016
W32898******************************************************************15660016
W32898                                                                  15670016
W32898 2750-PADJ-REALIGN-PROCESSING.                                    15680016
W32898                                                                  15690016
W32898     MOVE PAOUT-PURCH-ENT-ID    TO PV-ENT-ID-COMP.                15700016
W32898     MOVE PAOUT-PURCH-DEPT-NBR  TO PV-DEPT-NBR-COMP-3.            15710016
W32898     MOVE PAOUT-PURCH-LBL-SEQ-NBR                                 15720016
W32898                                TO PV-LBL-SEQ-NBR-COMP.           15730016
W32898                                                                  15740016
W32898     EXEC SQL                                                     15750016
W32898         SELECT ML_LO_MDSE_LVL_ID                                 15760016
W32898           INTO :PAOUT-PURCH-ML-LWST-ID                           15770016
W32898           FROM MLV_BRND_VND                                      15780016
W32898           WHERE  DEPT_NBR      = :PV-DEPT-NBR-COMP-3             15790016
W32898           AND    ENT_ID        = :PV-ENT-ID-COMP                 15800016
W32898           AND    LBL_SEQ_NBR   = :PV-LBL-SEQ-NBR-COMP            15810016
W32898           AND    EFF_BEG_DTE  <= :PAOUT-PURCH-FIN-LIAB-DTE       15820016
W32898           AND   (EFF_END_DTE  >= :PAOUT-PURCH-FIN-LIAB-DTE       15830016
W32898           OR     EFF_END_DTE IS NULL)                            15840016
W32898         WITH UR                                                  15850016
W32898     END-EXEC.                                                    15860016
W32898                                                                  15870016
W32898     EVALUATE TRUE                                                15880016
W32898                                                                  15890016
W32898         WHEN SQLCODE = 0                                         15900016
W32898             CONTINUE                                             15910016
W32898         WHEN SQLCODE = +100                                      15920016
W32898             PERFORM 2755-LOOKUP-NOT-FOUND                        15930016
W32898         WHEN SQLCODE < +0                                        15940016
W32898         WHEN SQLCODE > +0                                        15950016
W32898              DISPLAY '2750-PADJ-REALIGN-PROCESSING '             15960016
W32898                     DISPLAY 'GETTING DATALESS KEY  '             15970016
W32898                     PERFORM 9998-SQL-ABEND                       15980016
W32898     END-EVALUATE.                                                15990016
W32898                                                                  16000016
W32898     PERFORM 9400-WRITE-PURCH-REC.                                16010016
W32898                                                                  16020016
W32898     SET PS-NO-HOLD-MATCH   TO TRUE.                              16030016
W32898     MOVE SPACES            TO PS-PREV-DBV-RLTSNHP-CHK-SW.        16040016
W32898                                                                  16050016
W32898*    NEXT INPUT READ IS PERFORMED AT THE END OF THE PERFORMING    16060016
W32898*    PARAGRAPH 2000-PROCESS-PURCH-RECS.                           16070016
W32898                                                                  16080016
W32898                                                                  16090016
W32898 2755-LOOKUP-NOT-FOUND.                                           16100016
W32898                                                                  16110016
W32898     DISPLAY 'DATALESS KEY NOT FOUND FOR :'                       16120016
W32898     DISPLAY 'DEPT :' PAOUT-PURCH-DEPT-NBR.                       16130016
W32898     DISPLAY 'ENT-ID :' PAOUT-PURCH-ENT-ID.                       16140016
W32898     MOVE PAOUT-PURCH-LBL-SEQ-NBR TO PV-DISP-LBL-SEQ-NBR.         16150016
W32898     DISPLAY 'LBL-SEQ :' PV-DISP-LBL-SEQ-NBR.                     16160016
W32898     MOVE PV-TOT-EDIT-PURCH-RECS-IN TO PV-DISP-PURCH-IN-CNT.      16170016
W32898     DISPLAY 'INPUT RECORD # :' PV-DISP-PURCH-IN-CNT.             16180016
W32898                                                                  16190016
W32898                                                                  16200016
W34309 2760-PADJ-GIVEBACK-PROCESSING.                                   16210016
W34309                                                                  16220016
W34309     INITIALIZE BV003-PV-INPUT-AREA.                              16230016
W34309     MOVE PC-BVD                TO BV003-PV-LOOKUP-TYPE-IN.       16240016
W34309     MOVE 'Y'                   TO BV003-PV-VND-PAST-FUT-IN.      16250016
W34309     MOVE 'Y'                   TO BV003-PV-USE-KNWN-UNK-SW.      16260016
W34309     MOVE 06                    TO BV003-PV-PAST-MONTHS.          16270016
W34309     MOVE PAOUT-PURCH-FIN-LIAB-DTE                                16280016
W34309                                TO BV003-PV-EFF-DTE-IN.           16290016
W34309     MOVE PAOUT-PURCH-ENT-ID    TO BV003-PV-ENT-ID-IN-9.          16300016
W34309     MOVE PAOUT-PURCH-LBL-SEQ-NBR                                 16310016
W34309                                TO BV003-PV-BRAND-IN-9.           16320016
W34309     MOVE PAOUT-PURCH-DEPT-NBR  TO BV003-PV-DEPT-IN-9.            16330016
W34309                                                                  16340016
W34309     PERFORM BV003-LOOKUP-MAIN.                                   16350016
W34309                                                                  16360016
W34309                                                                  16370016
W34309     IF BV003-PV-NO-ERRORS-FOUND OR BV003-PV-NO-REL-FOUND         16380016
W34309         MOVE BV003-PV-RLTNSHP-ID-OUT                             16390016
W34309                                TO PAOUT-PURCH-ML-LWST-ID         16400016
W34309                                                                  16410016
W34309         PERFORM 9400-WRITE-PURCH-REC                             16420016
W34309         SET PS-NO-HOLD-MATCH   TO TRUE                           16430016
W34309         MOVE SPACES            TO PS-PREV-DBV-RLTSNHP-CHK-SW     16440016
W34309         IF BV003-UNKNOWN-INS                                     16450016
W34309             PERFORM 8200-COMMIT                                  16460016
W34309         END-IF                                                   16470016
W34309     ELSE                                                         16480016
W34309         PERFORM 2865-LOOKUP-BV-ERROR                             16490016
W34309     END-IF.                                                      16500016
W34309                                                                  16510016
W34309*    NEXT INPUT READ IS PERFORMED AT THE END OF THE PERFORMING    16520016
W34309*    PARAGRAPH 2000-PROCESS-PURCH-RECS.                           16530016
W34309                                                                  16531016
W34309 2865-LOOKUP-BV-ERROR.                                            16532016
W34309                                                                  16533016
W34309     DISPLAY '2865-LOOKUP-BV-ERROR/ GIVEBACK PROCESSING'          16534016
W34309     DISPLAY 'DATALESS KEY NOT FOUND FOR :'                       16535016
W34309     DISPLAY 'DEPT :' PAOUT-PURCH-DEPT-NBR.                       16536016
W34309     DISPLAY 'ENT-ID :' PAOUT-PURCH-ENT-ID.                       16537016
W34309     MOVE PAOUT-PURCH-LBL-SEQ-NBR TO PV-DISP-LBL-SEQ-NBR.         16538016
W34309     DISPLAY 'LBL-SEQ :' PV-DISP-LBL-SEQ-NBR.                     16539016
W34309     MOVE PV-TOT-EDIT-PURCH-RECS-IN TO PV-DISP-PURCH-IN-CNT.      16540016
W34309     DISPLAY 'INPUT RECORD # :' PV-DISP-PURCH-IN-CNT.             16550016
W34309                                                                  16560016
W34309     DISPLAY BV003-PV-RETURN-MSG-1.                               16570016
W34309     DISPLAY BV003-PV-RETURN-MSG-2.                               16580016
W34309     IF BV003-PV-SQL-ERROR                                        16590016
W34309        PERFORM 9998-SQL-ABEND                                    16600016
W34309     ELSE                                                         16601016
W34309        PERFORM 9999-OTHER-ABEND                                  16602016
W34309     END-IF.                                                      16602116
W34309                                                                  16602216
W34309                                                                  16602316
W34309                                                                  16602416
W32898******************************************************************16602516
W32898*  PROCESS A A DEBIT ALLOWANCE MARKDOWN FROM THE PURCH FILE       16602616
W32898******************************************************************16602716
W28582                                                                  16602816
W28582 2800-PURCH-DA-PROCESSING.                                        16602916
W28582     SET PS-PREV-DEBIT-ALLOW TO TRUE                              16603016
W28582     SET PS-DA-ALW-OR-RTV TO TRUE                                 16603116
W28582     INITIALIZE PV-BRND-PRRTN-TOTS.                               16603216
W31475     INITIALIZE PV-DR-ALW-NBR                                     16603316
W31475     INITIALIZE ML006-PARAMETERS.                                 16603416
W31475*    MOVE ML030-PURCH-DOC-16-NBR   TO ML006-DR-ALW-NBR            16603516
W31475*    MOVE IN-ORA-SRC-CTL-RECORD TO ML006-ORACLE-CONNECT-REC       16603616
W31475*    SET ML006-SUCCESSFUL-CALL TO TRUE                            16603716
W31475*    CALL PC-MLKUP359  USING ML006-PARAMETERS                     16603816
W31475     MOVE ML030-PURCH-DOC-16-NBR   TO PV-DR-ALW-NBR               16603916
W31475     SET ML006-SUCCESSFUL-CALL TO TRUE                            16604016
W31475     PERFORM 8300-GET-DA-BRND-PRORATION.                          16605016
                                                                        16606016
W28582     IF ML006-SUCCESSFUL-CALL AND ML006-DA-PRRTN-REC-CNT > 0      16607016
W28582        PERFORM                                                   16607116
W28582           VARYING PV-BRAND-COUNT                                 16607216
W28582           FROM 1 BY 1                                            16607316
W28582           UNTIL (PV-BRAND-COUNT > ML006-DA-PRRTN-REC-CNT)        16607416
W28582           INITIALIZE BV003-PV-INPUT-AREA                         16607516
W28582           IF ML030-PURCH-ENT-ID EQUAL SPACES OR                  16607616
W28582              ML030-PURCH-ENT-ID EQUAL ZERO                       16607716
W28582              MOVE PC-UNKNOWN-VENDOR TO BV003-PV-ENT-ID-IN-9      16607816
W28582           ELSE                                                   16607916
W28582              MOVE ML030-PURCH-ENT-ID TO BV003-PV-ENT-ID-IN-9     16608016
W28582           END-IF                                                 16609016
W28582           MOVE ML030-PURCH-DEPT-NBR TO BV003-PV-DEPT-IN-9        16610016
W28582           MOVE ML006-DA-PRRTN-BRND(PV-BRAND-COUNT) TO            16620016
W28582                BV003-PV-BRAND-IN-9                               16630016
W28582           SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE               16640016
W28582           MOVE ML030-PURCH-FIN-LIAB-DTE TO                       16650016
W28582              BV003-PV-EFF-DTE-IN                                 16660016
W28582           PERFORM BV003-LOOKUP-MAIN                              16670016
W28582           IF BV003-UNKNOWN-INS                                   16680016
W28582              PERFORM 8200-COMMIT                                 16690016
W28582           END-IF                                                 16700016
W28582           IF PV-BRAND-COUNT NOT EQUAL ML006-DA-PRRTN-REC-CNT     16710016
W28582              MOVE ML006-DA-PRRTN-PCT(PV-BRAND-COUNT) TO          16720016
W28582                   PV-PRORATION-PCT                               16730016
W28582              PERFORM 2410-PURCH-PRRTN-CALC                       16740016
W28582           ELSE                                                   16750016
W28582              PERFORM 2420-PURCH-PRRTN-LAST                       16760016
W28582           END-IF                                                 16770016
W28582           MOVE BV003-PV-ENT-ID-OUT     TO                        16780016
W28582                PAOUT-PURCH-ENT-ID                                16790016
W28582           MOVE BV003-PV-BRAND-OUT      TO                        16800016
W28582                PAOUT-PURCH-LBL-SEQ-NBR                           16810016
W28582           MOVE BV003-PV-RLTNSHP-ID-OUT TO                        16820016
W28582                PAOUT-PURCH-ML-LWST-ID                            16830016
W28582           PERFORM 9400-WRITE-PURCH-REC                           16840016
W28582           IF BV003-PV-NO-ERRORS-FOUND OR BV003-NO-RLTNSHP-FOR-DTE16850016
W28582              CONTINUE                                            16860016
W28582           ELSE                                                   16870016
W28582              DISPLAY 'ENT ID:' ML030-PURCH-ENT-ID                16880016
W28582              DISPLAY 'DEPT  :' ML030-PURCH-DEPT-NBR              16890016
W28582              DISPLAY 'BRAND ' ML006-DA-PRRTN-BRND(PV-BRAND-COUNT)16900016
W28582              MOVE 'PUR' TO ML205-ML-TRANSACTION                  16910016
W28582              MOVE BV003-PV-BRAND-OUT TO                          16920016
W28582                 ML205-ML-VND-LBL-SEQ-NBR                         16930016
W28582              STRING 'BV CALL = ' BV003-PV-LOOKUP-TYPE-IN         16940016
W28582                  DELIMITED BY SIZE                               16950016
W28582                  INTO ML205-ML-NOTE                              16960016
W28582              MOVE ML030-PURCH-RECORD TO ML205-ML-ERROR-INPUT-REC 16970016
W28582              WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD          16980016
W28582           END-IF                                                 16990016
W28582        END-PERFORM                                               17000016
W28582     ELSE                                                         17010016
W28582        IF ML006-ERROR-CALL OR ML006-LOGGON-ERROR                 17020016
W28582           DISPLAY 'ERROR GETTING PURCH DA BRAND PRORATION INFO'  17030016
W28582           PERFORM 9999-OTHER-ABEND                               17040016
W28582        ELSE                                                      17050016
W28582           IF ML030-PURCH-ENT-ID EQUAL SPACES OR                  17060016
W28582              ML030-PURCH-ENT-ID EQUAL ZERO                       17070016
W28582              MOVE PC-UNKNOWN-VENDOR    TO PV-DB2-ENT-ID          17080016
W28582           ELSE                                                   17090016
W28582              MOVE ML030-PURCH-ENT-ID   TO PV-DB2-ENT-ID          17100016
W28582           END-IF                                                 17110016
W28582           MOVE ML030-PURCH-DEPT-NBR TO PV-DB2-DEPT-NBR           17120016
W28582           PERFORM 7040-GET-MAX-PADJ-DA-COST-PCT                  17130016
W28582           SET PS-PRRTN-FOR-PURCH TO TRUE                         17140016
W28582           PERFORM 6000-VNDR-BRND-PRRTN-PROCESS                   17150016
W28582        END-IF                                                    17160016
W28582     END-IF.                                                      17170016
      ******************************************************************17180016
      *  DISPLAY APPROPRIATE FIELDS FOR A PURCH ZERO DEPARTMENT RECORD  17190016
      ******************************************************************17200016
NHOLD$ 2910-PURCH-SKU-MATCH.                                            17210016
NHOLD$     EVALUATE TRUE                                                17220016
NHOLD$      WHEN PS-PREV-FOUND-SKU                                      17230016
NHOLD$         MOVE BV003-PV-RLTNSHP-ID-OUT  TO  PAOUT-PURCH-ML-LWST-ID 17240016
NHOLD$         MOVE BV003-PV-BRAND-OUT       TO  PAOUT-PURCH-LBL-SEQ-NBR17250016
NHOLD$         MOVE BV003-PV-ENT-ID-OUT      TO  PAOUT-PURCH-ENT-ID     17260016
NHOLD$         PERFORM 9400-WRITE-PURCH-REC                             17270016
NHOLD$      WHEN PS-PREV-EVEN-PRRTN                                     17280016
NHOLD$         PERFORM 2500-PURCH-EVEN-MAIN                             17290016
NHOLD$      END-EVALUATE.                                               17300016
      ******************************************************************17310016
      *  DISPLAY APPROPRIATE FIELDS FOR A PURCH ZERO DEPARTMENT RECORD  17320016
      ******************************************************************17330016
ZEROD  2900-PURCH-ZERO-DEPT.                                            17340016
ZEROD      DISPLAY 'ML030-PURCH-STORE-NBR: ' ML030-PURCH-STORE-NBR      17350016
ZEROD              ' ML030-PURCH-SKU: ' ML030-PURCH-SKU                 17360016
ZEROD              ' ML030-PURCH-ENT-ID: ' ML030-PURCH-ENT-ID           17370016
ZEROD      DISPLAY 'ML030-PURCH-EXTD-GRO-COST-AMT: '                    17380016
ZEROD               ML030-PURCH-EXTD-GRO-COST-AMT                       17390016
ZEROD      DISPLAY 'ML030-PURCH-FRGT-AMT: '                             17400016
ZEROD               ML030-PURCH-FRGT-AMT                                17410016
ZEROD              ' ML030-PURCH-DISC-AMT: '                            17420016
ZEROD               ML030-PURCH-DISC-AMT                                17430016
ZEROD      DISPLAY 'ML030-PURCH-EXTD-NET-COST-AMT: '                    17440016
ZEROD               ML030-PURCH-EXTD-NET-COST-AMT                       17450016
ZEROD              ' ML030-PURCH-EXTD-RTL-AMT: '                        17460016
ZEROD               ML030-PURCH-EXTD-RTL-AMT                            17470016
ZEROD      DISPLAY 'ML030-PURCH-QTY: '                                  17480016
ZEROD               ML030-PURCH-QTY                                     17490016
ZEROD               ' ML030-PURCH-PER-UNT-RTL-AMT: '                    17500016
ZEROD               ML030-PURCH-PER-UNT-RTL-AMT.                        17510016
      ******************************************************************17520016
      *  PROCESS ALL EDIT SALE RECORDS                                  17530016
      ******************************************************************17540016
W28582                                                                  17550016
W28582 3000-PROCESS-SALE-RECS.                                          17560016
W28582     SET PS-NOT-DA-ALW-OR-RTV TO TRUE                             17570016
W28582     ADD 1 TO PV-TOT-EDIT-SALE-RECS-IN                            17580016
W28582     MOVE ML022-SALE-RECORD TO SLOUT-SALE-RECORD                  17590016
ZEROD      IF ML022-SALE-DEPT-NBR EQUAL ZERO                            17600016
ZEROD         PERFORM 3900-SALE-ZERO-DEPT                               17610016
ZEROD      ELSE                                                         17620016
NHOLD$        PERFORM 6500-CHECK-HOLD-MATCH                             17630016
NHOLD$        IF PS-HOLD-MATCH AND                                      17640016
NHOLD$          (PS-PREV-FOUND-SKU OR PS-PREV-EVEN-PRRTN)               17650016
NHOLD$           PERFORM 3800-SALE-HOLD-MATCH                           17660016
NHOLD$        ELSE                                                      17670016
W34517*          SET IN402-PV-SKU-ATTRIB-LOOK TO TRUE                   17680016
W28582           INITIALIZE IN402-PV-INPUT-AREA                         17690016
W34517           SET IN402-PV-SKU-ATTRIB-LOOK  TO TRUE                  17700016
W28582           MOVE ML022-SALE-SKU           TO IN402-PV-SKU-IN       17710016
W28582           MOVE ML022-SALE-DEPT-NBR      TO IN402-PV-DEPT-IN-9    17720016
W28582           MOVE '00000'                  TO IN402-PV-LOC-IN       17730016
W28582           IF ML022-SALE-SKU NOT EQUAL ZEROES                     17740016
W28582              MOVE ML022-SALE-FIN-LIAB-DTE TO                     17750016
W28582                 IN402-PV-EFF-DTE-IN                              17760016
W28582              PERFORM IN402-LOOKUP-RETAIL                         17770016
W28582           END-IF                                                 17780016
W28582           IF IN402-PV-DBV-FOUND OR                               17790016
W28582              ML022-SALE-SKU EQUAL ZEROES OR                      17800016
W28582              ML022-SALE-SKU EQUAL SPACES                         17810016
W28582              IF BV003-UNKNOWN-INS                                17820016
W28582                 PERFORM 8200-COMMIT                              17830016
W28582              END-IF                                              17840016
W28582              IF IN402-PV-DUMMY-SKU-VALID OR                      17850016
W28582                 ML022-SALE-SKU EQUAL ZEROES OR                   17860016
W28582                 ML022-SALE-SKU EQUAL SPACES                      17870016
UNCOMP                 IF ML022-SALE-ENT-ID EQUAL ZERO                  17880016
W28582                    IF IN402-VND-ENT-ID-OUT NOT EQUAL ZERO        17890016
W28582                       MOVE IN402-VND-ENT-ID-OUT TO PV-DB2-ENT-ID 17900016
W28582                    ELSE                                          17910016
W28582                       MOVE PC-UNKNOWN-VENDOR TO PV-DB2-ENT-ID    17920016
W28582                    END-IF                                        17930016
UNCOMP                 ELSE                                             17940016
UNCOMP                    MOVE ML022-SALE-ENT-ID TO PV-DB2-ENT-ID       17950016
UNCOMP                 END-IF                                           17960016
W28582                 MOVE ML022-SALE-DEPT-NBR TO PV-DB2-DEPT-NBR      17970016
W28582                 PERFORM 7060-GET-MAX-SLS-REG-RTL-PCT             17980016
W28582                 SET PS-PRRTN-FOR-SALE TO TRUE                    17990016
W28582                 PERFORM 6000-VNDR-BRND-PRRTN-PROCESS             18000016
W28582              ELSE                                                18010016
NHOLD$                 SET PS-PREV-FOUND-SKU TO TRUE                    18020016
W28582                 MOVE IN402-VND-LBL-SEQ-NBR       TO              18030016
W28582                      SLOUT-SALE-LBL-SEQ-NBR                      18040016
W28582                 MOVE IN402-VND-ENT-ID-OUT        TO              18050016
W28582                      SLOUT-SALE-ENT-ID                           18060016
W28582                 MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO              18070016
W28582                      SLOUT-SALE-ML-LWST-ID                       18080016
W28582                 PERFORM 9500-WRITE-SALE-REC                      18090016
W28582              END-IF                                              18100016
W28582           ELSE                                                   18110016
W28582              DISPLAY 'ERROR LOOKING UP VENDOR/BRAND WITH SKU: '  18120016
W28582                       ML022-SALE-SKU                             18130016
W28582              MOVE 'SAL' TO ML205-ML-TRANSACTION                  18140016
W28582              MOVE IN402-VND-LBL-SEQ-NBR TO                       18150016
W28582                 ML205-ML-VND-LBL-SEQ-NBR                         18160016
W28582              IF IN402-PV-RETURN-RSN = SPACES                     18170016
W28582                 CONTINUE                                         18180016
W28582              ELSE                                                18190016
W28582                 MOVE IN402-PV-RETURN-RSN TO ML205-ML-NOTE        18200016
W28582              END-IF                                              18210016
W28582              MOVE ML022-SALE-RECORD TO ML205-ML-ERROR-INPUT-REC  18220016
W28582              WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD          18230016
W28582                                                                  18240016
W28582              MOVE SPACES TO BV-SALE-AUDIT-REC                    18250016
W28582              WRITE BV-SALE-AUDIT-REC FROM DT2-SALES-ERROR-LINE   18260016
W28582                  AFTER ADVANCING 1 LINES                         18270016
W28582              ADD 1 TO PV-LINE-COUNTER                            18280016
W28582              MOVE IN402-VND-LBL-SEQ-NBR       TO                 18290016
W28582                   SLOUT-SALE-LBL-SEQ-NBR                         18300016
W28582              MOVE IN402-VND-ENT-ID-OUT        TO                 18310016
W28582                   SLOUT-SALE-ENT-ID                              18320016
W28582              MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO                 18330016
W28582                   SLOUT-SALE-ML-LWST-ID                          18340016
W28582              PERFORM 9500-WRITE-SALE-REC                         18350016
W28582           END-IF                                                 18360016
NHOLD$        END-IF                                                    18370016
ZEROD      END-IF.                                                      18380016
W28582     PERFORM 9010-READ-SALE-FILE.                                 18390016
      ******************************************************************18400016
      *  DO 13 WEEK PRORATION PROCESSING FOR A SALE TRANSACTION.        18410016
      ******************************************************************18420016
       3100-PROCESS-13WK-SALE.                                          18430016
           IF BVT00003-LBL-SEQ-NBR                                      18440016
              NOT EQUAL PV-MAX-BRAND                                    18450016
              MOVE BVT00003-SLS-REG-RTL-PCT TO PV-PRORATION-PCT         18460016
              IF PV-PRORATION-PCT NOT EQUAL ZERO                        18470016
                 COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL             18480016
                         ML022-SALE-EXTD-RTL-AMT *                      18490016
                         (PV-PRORATION-PCT / 100)                       18500016
                 COMPUTE SLOUT-SALE-EXTD-RTL-AMT ROUNDED EQUAL          18510016
                         PV-WORK-EXTD-RTL-AMT                           18520016
                 ADD SLOUT-SALE-EXTD-RTL-AMT TO                         18530016
                     PV-TOTAL-SALE-EXTD-RTL-AMT                         18540016
              END-IF                                                    18550016
           ELSE                                                         18560016
              COMPUTE SLOUT-SALE-EXTD-RTL-AMT  ROUNDED EQUAL            18570016
                      ML022-SALE-EXTD-RTL-AMT  -                        18580016
                      PV-TOTAL-SALE-EXTD-RTL-AMT                        18590016
           END-IF.                                                      18600016
                                                                        18610016
           IF PV-PRORATION-PCT NOT EQUAL ZERO OR                        18620016
              BVT00003-LBL-SEQ-NBR EQUAL PV-MAX-BRAND                   18630016
              MOVE BV003-PV-ENT-ID-OUT     TO SLOUT-SALE-ENT-ID         18640016
              MOVE BV003-PV-BRAND-OUT      TO SLOUT-SALE-LBL-SEQ-NBR    18650016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO SLOUT-SALE-ML-LWST-ID     18660016
              PERFORM 9500-WRITE-SALE-REC                               18670016
           END-IF.                                                      18680016
      ******************************************************************18690016
      *  DO EVEN PRORATION FOR A SALE TRANSACTION.                      18700016
      ******************************************************************18710016
       3200-SALE-EVEN.                                                  18720016
NHOLD$     INITIALIZE PV-BRND-PRRTN-TOTS                                18730016
           IF BV003-PV-RT-SUB-OUT EQUAL ZERO                            18740016
              MOVE BV003-PV-ENT-ID-OUT     TO SLOUT-SALE-ENT-ID         18750016
              MOVE BV003-PV-BRAND-OUT      TO SLOUT-SALE-LBL-SEQ-NBR    18760016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO SLOUT-SALE-ML-LWST-ID     18770016
              PERFORM 9500-WRITE-SALE-REC                               18780016
           ELSE                                                         18790016
              PERFORM                                                   18800016
                 VARYING PV-BRAND-COUNT                                 18810016
                 FROM 1 BY 1                                            18820016
                 UNTIL (PV-BRAND-COUNT > BV003-PV-RT-SUB-OUT)           18830016
                 IF PV-BRAND-COUNT NOT EQUAL BV003-PV-RT-SUB-OUT        18840016
                    COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL          18850016
                            ML022-SALE-EXTD-RTL-AMT *                   18860016
                            (PV-PRORATION-PCT / 100)                    18870016
                    COMPUTE SLOUT-SALE-EXTD-RTL-AMT ROUNDED EQUAL       18880016
                            PV-WORK-EXTD-RTL-AMT                        18890016
                    ADD SLOUT-SALE-EXTD-RTL-AMT TO                      18900016
                        PV-TOTAL-SALE-EXTD-RTL-AMT                      18910016
                 ELSE                                                   18920016
                    COMPUTE SLOUT-SALE-EXTD-RTL-AMT  ROUNDED EQUAL      18930016
                            ML022-SALE-EXTD-RTL-AMT  -                  18940016
                            PV-TOTAL-SALE-EXTD-RTL-AMT                  18950016
                 END-IF                                                 18960016
                 MOVE BV003-RT-ENT-ID-OUT(BV003-PV-RT-SUB-OUT)          18970016
                                              TO SLOUT-SALE-ENT-ID      18980016
                 MOVE BV003-RT-BRND-OUT(BV003-PV-RT-SUB-OUT)            18990016
                                              TO SLOUT-SALE-LBL-SEQ-NBR 19000016
                 MOVE BV003-RT-RLTNSHP-ID-OUT(BV003-PV-RT-SUB-OUT)      19010016
                                              TO SLOUT-SALE-ML-LWST-ID  19020016
                 PERFORM 9500-WRITE-SALE-REC                            19030016
              END-PERFORM                                               19040016
           END-IF.                                                      19050016
      ******************************************************************19060016
      *  DISPLAY APPROPRIATE FIELDS FOR A SALE ZERO DEPARTMENT RECORD   19070016
      ******************************************************************19080016
NHOLD$ 3800-SALE-HOLD-MATCH.                                            19090016
NHOLD$     EVALUATE TRUE                                                19100016
NHOLD$      WHEN PS-PREV-FOUND-SKU                                      19110016
NHOLD$         MOVE BV003-PV-BRAND-OUT      TO                          19120016
NHOLD$              SLOUT-SALE-LBL-SEQ-NBR                              19130016
NHOLD$         MOVE BV003-PV-ENT-ID-OUT     TO SLOUT-SALE-ENT-ID        19140016
NHOLD$         MOVE BV003-PV-RLTNSHP-ID-OUT TO                          19150016
NHOLD$              SLOUT-SALE-ML-LWST-ID                               19160016
NHOLD$         PERFORM 9500-WRITE-SALE-REC                              19170016
NHOLD$      WHEN PS-PREV-EVEN-PRRTN                                     19180016
NHOLD$         PERFORM 3200-SALE-EVEN                                   19190016
NHOLD$      END-EVALUATE.                                               19200016
      ******************************************************************19210016
      *  DISPLAY APPROPRIATE FIELDS FOR A SALE ZERO DEPARTMENT RECORD   19220016
      ******************************************************************19230016
ZEROD  3900-SALE-ZERO-DEPT.                                             19240016
ZEROD      DISPLAY 'ML022-SALE-STORE-NBR: ' ML022-SALE-STORE-NBR        19250016
ZEROD              ' ML022-SALE-SKU: ' ML022-SALE-SKU                   19260016
ZEROD              ' ML022-SALE-ENT-ID: ' ML022-SALE-ENT-ID             19270016
ZEROD      DISPLAY ' ML022-SALE-EXTD-RTL-AMT: '                         19280016
ZEROD               ML022-SALE-EXTD-RTL-AMT.                            19290016
      ******************************************************************19300016
      *  PROCESS PRICE CHANGE RECORDS                                   19310016
      ******************************************************************19320016
W28582                                                                  19330016
W28582 4000-PROCESS-PCHG-RECS.                                          19340016
W28582     ADD 1 TO PV-TOT-EDIT-PCHG-RECS-IN                            19350016
W28582     MOVE ML029-PC-RECORD TO PCOUT-PC-RECORD                      19360016
ZEROD      IF ML029-PC-DEPT-NBR EQUAL ZERO                              19370016
ZEROD         PERFORM 4900-PCHG-ZERO-DEPT                               19380016
ZEROD      ELSE                                                         19390016
NHOLD$        PERFORM 6500-CHECK-HOLD-MATCH                             19400016
NHOLD$        IF PS-HOLD-MATCH     AND                                  19410016
NHOLD$          (PS-PREV-FOUND-SKU OR PS-PREV-EVEN-PRRTN)               19420016
NHOLD$           PERFORM 4800-PCHG-HOLD-MATCH                           19430016
NHOLD$        ELSE                                                      19440016
W28582           SET PS-NOT-DA-ALW-OR-RTV TO TRUE                       19450016
W28582           MOVE ML029-PC-AP-TRANS-CDE TO PS-AP-TRANS-CDE          19460016
W28582           IF PS-PCHG-AP-DA-MARKDOWN                              19470016
W28582              PERFORM 4200-PROCESS-ALW-BRND-PRRTN                 19480016
W28582           ELSE                                                   19490016
W28582              INITIALIZE IN402-PV-INPUT-AREA                      19500016
W28582              MOVE ML029-PC-SKU      TO IN402-PV-SKU-IN           19510016
W28582              MOVE ML029-PC-DEPT-NBR TO IN402-PV-DEPT-IN-9        19520016
W28582              MOVE '00000'           TO IN402-PV-LOC-IN           19530016
SJ                  IF ML029-PC-ENT-ID NOT EQUAL ZEROES                 19540016
JAS                      MOVE ML029-PC-ENT-ID   TO IN402-PV-ENT-ID-IN-9 19550016
SJ                  END-IF                                              19560016
W28582              IF ML029-PC-SKU NOT EQUAL ZEROES                    19570016
W28582                 SET IN402-PV-SKU-ATTRIB-LOOK TO TRUE             19580016
W28582                 MOVE ML029-PC-FIN-LIAB-DTE TO                    19590016
W28582                    IN402-PV-EFF-DTE-IN                           19600016
W28582                 PERFORM IN402-LOOKUP-RETAIL                      19610016
W28582              END-IF                                              19620016
W28582              IF IN402-PV-DBV-FOUND OR                            19630016
W28582                 ML029-PC-SKU EQUAL ZEROES OR                     19640016
W28582                 ML029-PC-SKU EQUAL SPACES                        19650016
W28582                 IF BV003-UNKNOWN-INS                             19660016
W28582                    PERFORM 8200-COMMIT                           19670016
W28582                 END-IF                                           19680016
W28582                 IF IN402-PV-DUMMY-SKU-VALID OR                   19690016
W28582                    ML029-PC-SKU EQUAL ZEROES OR                  19700016
W28582                    ML029-PC-SKU EQUAL SPACES                     19710016
W28582                    IF ML029-PC-ENT-ID EQUAL SPACES OR            19720016
W28582                       ML029-PC-ENT-ID EQUAL ZERO                 19730016
W28582                       IF IN402-VND-ENT-ID-OUT NOT EQUAL ZERO     19740016
W28582                          MOVE IN402-VND-ENT-ID-OUT TO            19750016
W28582                               PV-DB2-ENT-ID                      19760016
W28582                       ELSE                                       19770016
W28582                          MOVE PC-UNKNOWN-VENDOR TO PV-DB2-ENT-ID 19780016
W28582                       END-IF                                     19790016
W28582                    ELSE                                          19800016
W28582                       MOVE ML029-PC-ENT-ID TO PV-DB2-ENT-ID      19810016
W28582                    END-IF                                        19820016
W28582                    MOVE ML029-PC-DEPT-NBR TO PV-DB2-DEPT-NBR     19830016
W28582                    PERFORM 7000-GET-MAX-MKDN-STR-RTL-PCT         19840016
W28582                    SET PS-PRRTN-FOR-PCHG TO TRUE                 19850016
W28582                    PERFORM 6000-VNDR-BRND-PRRTN-PROCESS          19860016
W28582                 ELSE                                             19870016
NHOLD$                    SET PS-PREV-FOUND-SKU TO TRUE                 19880016
W28582                    MOVE IN402-VND-LBL-SEQ-NBR TO                 19890016
W28582                         PCOUT-PC-LBL-SEQ-NBR                     19900016
W28582                    MOVE IN402-VND-ENT-ID-OUT  TO                 19910016
W28582                         PCOUT-PC-ENT-ID                          19920016
W28582                    MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO           19930016
W28582                         PCOUT-PC-ML-LWST-ID                      19940016
W28582                    PERFORM 9600-WRITE-PCHG-REC                   19950016
W28582                 END-IF                                           19960016
W28582              ELSE                                                19970016
W28582                 DISPLAY 'ERROR LOOKING UP VNDR/BRND WITH SKU: '  19980016
W28582                          ML029-PC-SKU                            19990016
W28582                 MOVE 'PRC' TO ML205-ML-TRANSACTION               20000016
W28582                 MOVE IN402-VND-LBL-SEQ-NBR TO                    20010016
W28582                    ML205-ML-VND-LBL-SEQ-NBR                      20020016
W28582                 IF IN402-PV-RETURN-RSN = SPACES                  20030016
W28582                    CONTINUE                                      20040016
W28582                 ELSE                                             20050016
W28582                    MOVE IN402-PV-RETURN-RSN TO ML205-ML-NOTE     20060016
W28582                 END-IF                                           20070016
W28582                 MOVE ML029-PC-RECORD TO ML205-ML-ERROR-INPUT-REC 20080016
W28582                 WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD       20090016
W28582                                                                  20100016
W28582                 MOVE SPACES TO BV-PCHG-AUDIT-REC                 20110016
W28582                 WRITE BV-PURCH-AUDIT-REC FROM                    20120016
W28582                     DT3-PCHG-ERROR-LINE                          20130016
W28582                     AFTER ADVANCING 1 LINES                      20140016
W28582                 ADD 1 TO PV-LINE-COUNTER                         20150016
W28582                 MOVE IN402-VND-LBL-SEQ-NBR TO                    20160016
W28582                      PCOUT-PC-LBL-SEQ-NBR                        20170016
W28582                 MOVE IN402-VND-ENT-ID-OUT  TO                    20180016
W28582                      PCOUT-PC-ENT-ID                             20190016
W28582                 MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO              20200016
W28582                      PCOUT-PC-ML-LWST-ID                         20210016
W28582                 PERFORM 9600-WRITE-PCHG-REC                      20220016
W28582              END-IF                                              20230016
W28582           END-IF                                                 20240016
NHOLD$        END-IF                                                    20250016
ZEROD      END-IF.                                                      20260016
W28582     PERFORM 9020-READ-PRC-CHG-FILE.                              20270016
      ******************************************************************20280016
      *  DO PRORATION FOR A PRICE CHANGE TRANSACTION USING THE 13 WEEK  20290016
      *  TABLE                                                          20300016
      ******************************************************************20310016
       4100-PROCESS-13WK-PCHG.                                          20320016
RONNAX     IF PS-PCHG-AP-DA-MARKDOWN                                    20330016
RONNAX        MOVE BVT00003-PADJ-DA-COST-PCT  TO PV-PRORATION-PCT       20340016
RONNAX     ELSE                                                         20350016
RONNAX        MOVE BVT00003-MKDN-STR-RTL-PCT  TO PV-PRORATION-PCT       20360016
RONNAX     END-IF.                                                      20370016
RONNAX*    MOVE BVT00003-MKDN-STR-RTL-PCT  TO PV-PRORATION-PCT          20380016
           IF BVT00003-LBL-SEQ-NBR NOT EQUAL PV-MAX-BRAND               20390016
              IF PV-PRORATION-PCT NOT EQUAL ZERO                        20400016
                 COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL             20410016
                         ML029-PC-EXTD-RTL-AMT *                        20420016
                         (PV-PRORATION-PCT / 100)                       20430016
                 COMPUTE PCOUT-PC-EXTD-RTL-AMT ROUNDED EQUAL            20440016
                         PV-WORK-EXTD-RTL-AMT                           20450016
                                                                        20460016
                 COMPUTE PV-WORK-NEW-PR-AMT ROUNDED EQUAL               20470016
                         ML029-PC-NEW-PR-AMT *                          20480016
                         (PV-PRORATION-PCT / 100)                       20490016
                 COMPUTE PCOUT-PC-NEW-PR-AMT ROUNDED EQUAL              20500016
                         PV-WORK-NEW-PR-AMT                             20510016
                                                                        20520016
                 COMPUTE PV-WORK-OLD-PR-AMT ROUNDED EQUAL               20530016
                         ML029-PC-OLD-PR-AMT *                          20540016
                         (PV-PRORATION-PCT / 100)                       20550016
                 COMPUTE PCOUT-PC-OLD-PR-AMT ROUNDED EQUAL              20560016
                         PV-WORK-OLD-PR-AMT                             20570016
                                                                        20580016
                 ADD PCOUT-PC-EXTD-RTL-AMT TO                           20590016
                     PV-TOTAL-EXTD-RTL-AMT                              20600016
                 ADD PCOUT-PC-NEW-PR-AMT   TO PV-TOTAL-NEW-PR-AMT       20610016
                 ADD PCOUT-PC-OLD-PR-AMT   TO PV-TOTAL-OLD-PR-AMT       20620016
              END-IF                                                    20630016
           ELSE                                                         20640016
              COMPUTE PCOUT-PC-EXTD-RTL-AMT EQUAL                       20650016
                      ML029-PC-EXTD-RTL-AMT - PV-TOTAL-EXTD-RTL-AMT     20660016
              COMPUTE PCOUT-PC-NEW-PR-AMT EQUAL                         20670016
                      ML029-PC-NEW-PR-AMT - PV-TOTAL-NEW-PR-AMT         20680016
              COMPUTE PCOUT-PC-OLD-PR-AMT EQUAL                         20690016
                      ML029-PC-OLD-PR-AMT - PV-TOTAL-OLD-PR-AMT         20700016
           END-IF.                                                      20710016
                                                                        20720016
           IF PV-PRORATION-PCT NOT EQUAL ZERO                           20730016
              MOVE BV003-PV-ENT-ID-OUT     TO PCOUT-PC-ENT-ID           20740016
              MOVE BV003-PV-BRAND-OUT      TO PCOUT-PC-LBL-SEQ-NBR      20750016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO PCOUT-PC-ML-LWST-ID       20760016
              PERFORM 9600-WRITE-PCHG-REC                               20770016
           END-IF.                                                      20780016
      ******************************************************************20790016
      *  DO PRORATION PROCESSING FOR AN EDIT ADJUSTMENT RECORD THAT HAS 20800016
      *  A DEBIT ALLOWANCE.                                             20810016
      ******************************************************************20820016
W28582                                                                  20830016
W28582 4200-PROCESS-ALW-BRND-PRRTN.                                     20840016
NHOLD$     SET PS-PREV-DEBIT-ALLOW TO TRUE                              20850016
NHOLD$     SET PS-DA-ALW-OR-RTV TO TRUE                                 20860016
W28582     INITIALIZE PV-BRND-PRRTN-TOTS.                               20870016
W31475     INITIALIZE PV-DR-ALW-NBR.                                    20880016
W31475     INITIALIZE ML006-PARAMETERS.                                 20890016
W31475*    MOVE ML029-PC-DOC-16-NBR   TO ML006-DR-ALW-NBR               20900016
W31475*    MOVE IN-ORA-SRC-CTL-RECORD TO ML006-ORACLE-CONNECT-REC       20910016
W31475*    SET ML006-SUCCESSFUL-CALL TO TRUE                            20920016
W31475*    CALL PC-MLKUP359  USING ML006-PARAMETERS                     20930016
W31475     MOVE ML029-PC-DOC-16-NBR   TO PV-DR-ALW-NBR                  20940016
W31475     SET ML006-SUCCESSFUL-CALL TO TRUE                            20950016
W31475     PERFORM 8300-GET-DA-BRND-PRORATION.                          20960016
                                                                        20970016
W28582     IF ML006-SUCCESSFUL-CALL AND ML006-DA-PRRTN-REC-CNT > 0      20980016
W28582        PERFORM                                                   20990016
W28582           VARYING PV-BRAND-COUNT                                 21000016
W28582           FROM 1 BY 1                                            21001016
W28582           UNTIL (PV-BRAND-COUNT > ML006-DA-PRRTN-REC-CNT)        21002016
W28582           INITIALIZE BV003-PV-INPUT-AREA                         21003016
W28582           IF ML029-PC-ENT-ID EQUAL SPACES OR                     21004016
W28582              ML029-PC-ENT-ID EQUAL ZERO                          21005016
W28582              MOVE PC-UNKNOWN-VENDOR TO BV003-PV-ENT-ID-IN-9      21006016
W28582           ELSE                                                   21007016
W28582              MOVE ML029-PC-ENT-ID TO BV003-PV-ENT-ID-IN-9        21008016
W28582           END-IF                                                 21009016
W28582           MOVE ML029-PC-DEPT-NBR TO BV003-PV-DEPT-IN-9           21010016
W28582           MOVE ML006-DA-PRRTN-BRND(PV-BRAND-COUNT) TO            21020016
W28582                BV003-PV-BRAND-IN-9                               21030016
W28582           SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE               21040016
W28582           MOVE ML029-PC-FIN-LIAB-DTE TO BV003-PV-EFF-DTE-IN      21050016
W28582           PERFORM BV003-LOOKUP-MAIN                              21060016
W28582           IF BV003-UNKNOWN-INS                                   21070016
W28582              PERFORM 8200-COMMIT                                 21080016
W28582           END-IF                                                 21090016
W28582           IF PV-BRAND-COUNT NOT EQUAL ML006-DA-PRRTN-REC-CNT     21100016
W28582              COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL          21110016
W28582                      ML029-PC-EXTD-RTL-AMT *                     21120016
W28582                      (ML006-DA-PRRTN-PCT(PV-BRAND-COUNT)         21130016
W28582                       / 100)                                     21140016
W28582              COMPUTE PCOUT-PC-EXTD-RTL-AMT ROUNDED EQUAL         21150016
W28582                      PV-WORK-EXTD-RTL-AMT                        21160016
W28582                                                                  21170016
W28582              COMPUTE PV-WORK-NEW-PR-AMT ROUNDED EQUAL            21180016
W28582                      ML029-PC-NEW-PR-AMT *                       21190016
W28582                      (ML006-DA-PRRTN-PCT(PV-BRAND-COUNT)         21200016
W28582                       / 100)                                     21210016
W28582              COMPUTE PCOUT-PC-NEW-PR-AMT ROUNDED EQUAL           21220016
W28582                      PV-WORK-NEW-PR-AMT                          21230016
W28582                                                                  21240016
W28582              COMPUTE PV-WORK-OLD-PR-AMT ROUNDED EQUAL            21250016
W28582                      ML029-PC-OLD-PR-AMT *                       21260016
W28582                      (ML006-DA-PRRTN-PCT(PV-BRAND-COUNT)         21270016
W28582                       / 100)                                     21280016
W28582              ADD PCOUT-PC-EXTD-RTL-AMT TO                        21290016
W28582                  PV-TOTAL-EXTD-RTL-AMT                           21300016
W28582              ADD PCOUT-PC-NEW-PR-AMT   TO PV-TOTAL-NEW-PR-AMT    21310016
W28582              ADD PCOUT-PC-OLD-PR-AMT   TO PV-TOTAL-OLD-PR-AMT    21320016
W28582                                                                  21330016
W28582           ELSE                                                   21340016
W28582              COMPUTE PCOUT-PC-EXTD-RTL-AMT EQUAL                 21350016
W28582                      ML029-PC-EXTD-RTL-AMT -                     21360016
W28582                      PV-TOTAL-EXTD-RTL-AMT                       21370016
W28582              COMPUTE PCOUT-PC-NEW-PR-AMT EQUAL                   21380016
W28582                      ML029-PC-NEW-PR-AMT -                       21390016
W28582                      PV-TOTAL-NEW-PR-AMT                         21400016
W28582              COMPUTE PCOUT-PC-OLD-PR-AMT EQUAL                   21410016
W28582                      ML029-PC-OLD-PR-AMT -                       21420016
W28582                      PV-TOTAL-OLD-PR-AMT                         21430016
W28582           END-IF                                                 21440016
W28582           MOVE BV003-PV-ENT-ID-OUT     TO PCOUT-PC-ENT-ID        21450016
W28582           MOVE BV003-PV-BRAND-OUT      TO PCOUT-PC-LBL-SEQ-NBR   21460016
W28582           MOVE BV003-PV-RLTNSHP-ID-OUT TO PCOUT-PC-ML-LWST-ID    21470016
W28582           PERFORM 9600-WRITE-PCHG-REC                            21480016
W28582           IF BV003-PV-NO-ERRORS-FOUND OR BV003-NO-RLTNSHP-FOR-DTE21490016
W28582              CONTINUE                                            21500016
W28582           ELSE                                                   21510016
W28582              MOVE 'PRC' TO ML205-ML-TRANSACTION                  21520016
W28582              MOVE BV003-PV-BRAND-IN TO                           21530016
W28582                 ML205-ML-VND-LBL-SEQ-NBR                         21540016
W28582              STRING 'BV CALL = ' BV003-PV-LOOKUP-TYPE-IN         21550016
W28582                  DELIMITED BY SIZE                               21560016
W28582                  INTO ML205-ML-NOTE                              21570016
W28582              MOVE ML029-PC-RECORD TO ML205-ML-ERROR-INPUT-REC    21580016
W28582              WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD          21590016
W28582              DISPLAY 'ML029-PC-DOC-16-NBR: ' ML029-PC-DOC-16-NBR 21600016
W28582              DISPLAY 'BV003-PV-ENT-ID-IN: '  BV003-PV-ENT-ID-IN  21610016
W28582              DISPLAY 'BV003-PV-BRAND-IN: '   BV003-PV-BRAND-IN   21620016
W28582              DISPLAY 'BV003-PV-DEPT-IN:'     BV003-PV-DEPT-IN    21630016
W28582           END-IF                                                 21640016
W28582        END-PERFORM                                               21650016
W28582     ELSE                                                         21660016
W28582        IF ML006-ERROR-CALL OR ML006-LOGGON-ERROR                 21670016
W28582           DISPLAY 'ERROR GETTING PCHG DA BRAND PRORATION INFO'   21680016
W28582           DISPLAY 'ML029-PC-STORE-NBR: ' ML029-PC-STORE-NBR      21690016
W28582           DISPLAY 'ML029-PC-SKU: ' ML029-PC-SKU                  21700016
W28582           DISPLAY 'ML029-PC-FIN-LIAB-DTE: ' ML029-PC-FIN-LIAB-DTE21710016
W28582           DISPLAY 'ML029-PC-SYST-ORIG-CDE: '                     21720016
W28582                    ML029-PC-SYST-ORIG-CDE                        21730016
W28582           DISPLAY 'ML029-PC-TRANS-CDE: ' ML029-PC-TRANS-CDE      21740016
W28582           DISPLAY 'ML029-PC-DOC-16-NBR: ' ML029-PC-DOC-16-NBR    21750016
W28582           DISPLAY 'ML029-PC-ENT-ID: '  ML029-PC-ENT-ID           21760016
W28582           DISPLAY 'ML029-PC-LBL-SEQ-NBR: ' ML029-PC-LBL-SEQ-NBR  21770016
W28582           DISPLAY 'ML029-PC-DEPT-NBR: '   ML029-PC-DEPT-NBR      21780016
W28582           DISPLAY 'ML029-PC-ML-LWST-ID: ' ML029-PC-ML-LWST-ID    21790016
W28582           DISPLAY 'PV-TOT-EDIT-PCHG-RECS-IN '                    21800016
W28582                    PV-TOT-EDIT-PCHG-RECS-IN                      21810016
W28582           DISPLAY 'PV-TOT-EDIT-PCHG-RECS-OUT '                   21820016
W28582                    PV-TOT-EDIT-PCHG-RECS-OUT                     21830016
W28582           PERFORM 9999-OTHER-ABEND                               21840016
W28582        ELSE                                                      21850016
W28582           IF ML029-PC-ENT-ID EQUAL SPACES OR                     21860016
W28582              ML029-PC-ENT-ID EQUAL ZERO                          21870016
W28582              MOVE PC-UNKNOWN-VENDOR TO BV003-PV-ENT-ID-IN        21880016
W28582                                        PV-DB2-ENT-ID             21890016
W28582           ELSE                                                   21900016
W28582              MOVE ML029-PC-ENT-ID TO BV003-PV-ENT-ID-IN          21910016
W28582                                      PV-DB2-ENT-ID               21920016
W28582           END-IF                                                 21930016
W28582           MOVE ML029-PC-DEPT-NBR TO PV-DB2-DEPT-NBR              21940016
W28582           PERFORM 7040-GET-MAX-PADJ-DA-COST-PCT                  21950016
W28582           SET PS-PRRTN-FOR-PCHG TO TRUE                          21960016
W28582           PERFORM 6000-VNDR-BRND-PRRTN-PROCESS                   21970016
W28582        END-IF                                                    21980016
W28582     END-IF.                                                      21990016
      ******************************************************************22000016
      *  EVEN DIVIDE APPROPRIATE FIELDS ON A PRICE CHANGE REC.          22010016
      ******************************************************************22020016
       4300-PCHG-EVEN.                                                  22030016
NHOLD$     INITIALIZE PV-BRND-PRRTN-TOTS                                22040016
           IF BV003-PV-RT-SUB-OUT EQUAL ZERO                            22050016
              MOVE BV003-PV-ENT-ID-OUT     TO PCOUT-PC-ENT-ID           22060016
              MOVE BV003-PV-BRAND-OUT      TO PCOUT-PC-LBL-SEQ-NBR      22070016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO PCOUT-PC-ML-LWST-ID       22080016
              PERFORM 9600-WRITE-PCHG-REC                               22090016
           ELSE                                                         22100016
              PERFORM                                                   22110016
                 VARYING PV-BRAND-COUNT                                 22120016
                 FROM 1 BY 1                                            22130016
                 UNTIL (PV-BRAND-COUNT > BV003-PV-RT-SUB-OUT)           22140016
                 IF PV-BRAND-COUNT NOT EQUAL BV003-PV-RT-SUB-OUT        22150016
                    COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL          22160016
                            ML029-PC-EXTD-RTL-AMT *                     22170016
                            (PV-PRORATION-PCT / 100)                    22180016
                    COMPUTE PCOUT-PC-EXTD-RTL-AMT ROUNDED EQUAL         22190016
                            PV-WORK-EXTD-RTL-AMT                        22200016
                    ADD PCOUT-PC-EXTD-RTL-AMT TO                        22210016
                        PV-TOTAL-EXTD-RTL-AMT                           22220016
                 ELSE                                                   22230016
                    COMPUTE PCOUT-PC-EXTD-RTL-AMT EQUAL                 22240016
                            ML029-PC-EXTD-RTL-AMT -                     22250016
                            PV-TOTAL-EXTD-RTL-AMT                       22260016
                 END-IF                                                 22270016
                 MOVE BV003-RT-ENT-ID-OUT(BV003-PV-RT-SUB-OUT)          22280016
                                              TO PCOUT-PC-ENT-ID        22290016
                 MOVE BV003-RT-BRND-OUT(BV003-PV-RT-SUB-OUT)            22300016
                                              TO PCOUT-PC-LBL-SEQ-NBR   22310016
                 MOVE BV003-RT-RLTNSHP-ID-OUT(BV003-PV-RT-SUB-OUT)      22320016
                                              TO PCOUT-PC-ML-LWST-ID    22330016
                 PERFORM 9600-WRITE-PCHG-REC                            22340016
              END-PERFORM                                               22350016
           END-IF.                                                      22360016
      ******************************************************************22370016
      *  DISPLAY APPROPRIATE FIELDS FOR A PCHG ZERO DEPARTMENT RECORD   22380016
      ******************************************************************22390016
NHOLD$ 4800-PCHG-HOLD-MATCH.                                            22400016
NHOLD$     EVALUATE TRUE                                                22410016
NHOLD$      WHEN PS-PREV-FOUND-SKU                                      22420016
NHOLD$         MOVE BV003-PV-BRAND-OUT TO                               22430016
NHOLD$              PCOUT-PC-LBL-SEQ-NBR                                22440016
NHOLD$         MOVE BV003-PV-ENT-ID-OUT TO PCOUT-PC-ENT-ID              22450016
NHOLD$         MOVE BV003-PV-RLTNSHP-ID-OUT TO                          22460016
NHOLD$              PCOUT-PC-ML-LWST-ID                                 22470016
NHOLD$         PERFORM 9600-WRITE-PCHG-REC                              22480016
NHOLD$      WHEN PS-PREV-EVEN-PRRTN                                     22490016
NHOLD$         PERFORM 4300-PCHG-EVEN                                   22500016
NHOLD$      END-EVALUATE.                                               22510016
      ******************************************************************22520016
      *  DISPLAY APPROPRIATE FIELDS FOR A PCHG ZERO DEPARTMENT RECORD   22530016
      ******************************************************************22540016
ZEROD  4900-PCHG-ZERO-DEPT.                                             22550016
ZEROD      DISPLAY 'ML029-PC-STORE-NBR: ' ML029-PC-STORE-NBR            22560016
ZEROD              ' ML029-PC-SKU: ' ML029-PC-SKU                       22570016
ZEROD              ' ML029-PC-ENT-ID: ' ML029-PC-ENT-ID                 22580016
ZEROD      DISPLAY ' ML029-PC-EXTD-RTL-AMT: '                           22590016
ZEROD               ML029-PC-EXTD-RTL-AMT                               22600016
ZEROD              ' ML029-PC-QTY: ' ML029-PC-QTY                       22610016
ZEROD      DISPLAY 'ML029-PC-OLD-PR-AMT: '                              22620016
ZEROD               ML029-PC-OLD-PR-AMT                                 22630016
ZEROD              ' ML029-PC-NEW-PR-AMT: '                             22640016
ZEROD               ML029-PC-NEW-PR-AMT.                                22650016
      ******************************************************************22660016
      *  PROCESS ALL EDIT ADJUSTMENT RECORDS                            22670016
      ******************************************************************22680016
W28582                                                                  22690016
W28582 5000-PROCESS-ADJ-RECS.                                           22700016
W28582     SET PS-NOT-DA-ALW-OR-RTV TO TRUE                             22710016
W28582     MOVE ML024-ADJ-RECORD      TO IAOUT-ADJ-RECORD               22720016
W28582     ADD 1 TO PV-TOT-EDIT-ADJ-RECS-IN                             22730016
NHOLD$     PERFORM 6500-CHECK-HOLD-MATCH                                22740016
NHOLD$     IF PS-NO-HOLD-MATCH                                          22750016
W28582        INITIALIZE BV003-PV-INPUT-AREA                            22760016
NHOLD$        SET BV003-PV-REL-ID-LOOKUP TO TRUE                        22770016
NHOLD$        MOVE ML024-ADJ-ML-LWST-ID  TO BV003-PV-RLTNSHP-ID-IN      22780016
W28582        MOVE ML024-ADJ-FIN-LIAB-DTE TO BV003-PV-EFF-DTE-IN        22790016
W28582        PERFORM BV003-LOOKUP-MAIN                                 22800016
NHOLD$     END-IF                                                       22810016
W28582     IF BV003-UNKNOWN-INS                                         22820016
W28582        PERFORM 8200-COMMIT                                       22830016
W28582     END-IF                                                       22840016
W28582     MOVE BV003-PV-BRAND-OUT  TO IAOUT-ADJ-LBL-SEQ-NBR            22850016
W28582     MOVE BV003-PV-ENT-ID-OUT TO IAOUT-ADJ-ENT-ID                 22860016
W28582     PERFORM 9700-WRITE-ADJ-REC                                   22870016
W28582     IF BV003-PV-NO-ERRORS-FOUND                                  22880016
W28582        CONTINUE                                                  22890016
W28582     ELSE                                                         22900016
W28582        DISPLAY 'ERROR LOOKING UP BRAND WITH RELATIONSHIP ID: '   22910016
W28582                 ML024-ADJ-ML-LWST-ID                             22920016
W28582        MOVE 'ADJ' TO ML205-ML-TRANSACTION                        22930016
W28582        MOVE BV003-PV-BRAND-OUT TO                                22940016
W28582           ML205-ML-VND-LBL-SEQ-NBR                               22950016
W28582        IF IN402-PV-RETURN-RSN = SPACES                           22960016
W28582           CONTINUE                                               22970016
W28582        ELSE                                                      22980016
W28582           MOVE IN402-PV-RETURN-RSN TO ML205-ML-NOTE              22990016
W28582        END-IF                                                    23000016
W28582        MOVE ML024-ADJ-RECORD TO ML205-ML-ERROR-INPUT-REC         23010016
W28582        WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD                23020016
W28582*       PERFORM 9997-BV-LOOKUP-ERROR                              23030016
W28582     END-IF                                                       23040016
W28582     PERFORM 9030-READ-ADJUSTMENT-FILE.                           23050016
      ****************************************************************  23060016
      * DO NECESSARY BASE PROCESSING FOR VENDOR BRAND PRORATION         23070016
      ****************************************************************  23080016
       6000-VNDR-BRND-PRRTN-PROCESS.                                    23090016
           INITIALIZE PV-BRND-PRRTN-TOTS                                23100016
           IF PS-13-WK-PRRTN-INFO-EXISTS                                23110016
              SET PS-MORE-BVP-RECORDS TO TRUE                           23120016
              PERFORM 8100-OPEN-BRND-PRRTN-CSR                          23130016
              PERFORM 8110-FETCH-BRND-PRRTN-CSR                         23140016
              IF PS-MORE-BVP-RECORDS                                    23150016
                 PERFORM 6010-PROCESS-VB-PRTTN-REC                      23160016
                   UNTIL PS-NO-MORE-BVP-RECORDS                         23170016
              ELSE                                                      23180016
                 SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE              23190016
              END-IF                                                    23200016
              PERFORM 8120-CLOSE-BRND-PRRTN-CSR                         23210016
           END-IF.                                                      23220016
           IF PS-NO-13-WK-PRRTN-INFO-EXISTS                             23230016
              PERFORM 6100-PRORATE-EVENLY                               23240016
NHOLD$     ELSE                                                         23250016
NHOLD$        SET PS-PREV-13-WK-PRRTN TO TRUE                           23260016
           END-IF.                                                      23270016
      ******************************************************************23280016
      *  PROCESS A RECORD ON THE BRAND PRORATION CURSOR                 23290016
      ******************************************************************23300016
W28582                                                                  23310016
W28582 6010-PROCESS-VB-PRTTN-REC.                                       23320016
W28582     INITIALIZE BV003-PV-INPUT-AREA.                              23330016
W28582     SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE.                    23340016
W28582     MOVE PV-DB2-ENT-ID        TO BV003-PV-ENT-ID-IN.             23350016
W28582     MOVE PV-DB2-DEPT-NBR      TO BV003-PV-DEPT-IN.               23360016
W28582     MOVE BVT00003-LBL-SEQ-NBR TO BV003-PV-BRAND-IN-9.            23370016
W28582     MOVE PV-PROCESS-DATE TO BV003-PV-EFF-DTE-IN                  23380016
W28582     PERFORM BV003-LOOKUP-MAIN.                                   23390016
W28582     IF BV003-PV-NO-ERRORS-FOUND                                  23400016
W28582        IF BV003-UNKNOWN-INS                                      23410016
W28582           PERFORM 8200-COMMIT                                    23420016
W28582        END-IF                                                    23430016
W28582        EVALUATE TRUE                                             23440016
W28582           WHEN PS-PRRTN-FOR-PURCH                                23450016
W28582              IF NOT PS-PURCH-AP-TRANS-RTV                        23460016
W28582                 OR (PS-PURCH-AP-TRANS-RTV AND                    23470016
W28582                     PV-RTV-COUNT EQUAL ZERO)                     23480016
W28582                 PERFORM 2400-PROCESS-13WK-PURCH                  23490016
W28582              ELSE                                                23500016
W28582                 PERFORM 2600-PURCH-13WK-RTV-DOC-MAIN             23510016
W28582              END-IF                                              23520016
W28582           WHEN PS-PRRTN-FOR-SALE                                 23530016
W28582              PERFORM 3100-PROCESS-13WK-SALE                      23540016
W28582           WHEN PS-PRRTN-FOR-PCHG                                 23550016
W28582              PERFORM 4100-PROCESS-13WK-PCHG                      23560016
W28582           WHEN OTHER                                             23570016
W28582              DISPLAY 'PRORATION TYPE WAS NOT SET'                23580016
W28582        END-EVALUATE                                              23590016
W28582     ELSE                                                         23600016
W28582        DISPLAY 'BV003-PV-RETURN-CDE ' BV003-PV-RETURN-CDE        23610016
W28582        DISPLAY 'ENT ID ~' BV003-PV-ENT-ID-IN '~'                 23620016
W28582        DISPLAY 'DEPT   ~' BV003-PV-DEPT-IN   '~'                 23630016
W28582        DISPLAY 'BRAND  ~' BV003-PV-BRAND-IN  '~'                 23640016
W28582        DISPLAY 'ERROR LOOKING UP BRND/DEPT/VENDOR FOR PRORATION.'23650016
W28582        EVALUATE TRUE                                             23660016
W28582           WHEN PS-PRRTN-FOR-PURCH                                23670016
W28582              DISPLAY ML030-PURCH-RECORD                          23680016
W28582           WHEN PS-PRRTN-FOR-SALE                                 23690016
W28582              DISPLAY ML022-SALE-RECORD                           23700016
W28582           WHEN PS-PRRTN-FOR-PCHG                                 23710016
W28582              DISPLAY ML029-PC-RECORD                             23720016
W28582           WHEN OTHER                                             23730016
W28582              DISPLAY ML024-ADJ-RECORD                            23740016
W28582        END-EVALUATE                                              23750016
W28582        PERFORM 9997-BV-LOOKUP-ERROR                              23760016
W28582     END-IF.                                                      23770016
W28582     PERFORM 8110-FETCH-BRND-PRRTN-CSR.                           23780016
      ****************************************************************  23790016
      * BECAUSE NO RECORDS WERE FOUND ON THE 13 WEEK TABLE, WE WANT     23800016
      * TO RETRIEVE DEPARTMENT BRAND VENDOR RELATIONSHIPS FOR THE       23810016
      * SPECIFIED DEPARTMENT/VENDOR.  IF WE FIND NO CURRENTLY ACTIVE    23820016
      * ROWS, WE DO WANT TO CHECK FOR ROWS THAT EXPIRED IN THE LAST SIX 23830016
      * MONTHS.  IF NONE ARE FOUND, WE SHOULD CHECK THE FUTURE.  IF WE  23840016
      * STILL CAN'T FIND ANYTHING, WE NEED TO GET/CREATE AN KNOWN       23850016
      * VENDOR/UNKNOWN BRAND ROW FOR THE APPROPRIATE VENDOR/DEPARTMENT. 23860016
      ****************************************************************  23870016
       6100-PRORATE-EVENLY.                                             23880016
NHOLD$     IF PS-NOT-DA-ALW-OR-RTV                                      23890016
NHOLD$        SET PS-PREV-EVEN-PRRTN TO TRUE                            23900016
NHOLD$     END-IF                                                       23910016
           SET BV003-PV-VNDR-DEPT-LOOKUP TO TRUE.                       23920016
           SET BV003-VND-LOOK-PAST-FUT   TO TRUE.                       23930016
           SET BV003-USE-KNOWN-UNKNOWN   TO TRUE.                       23940016
           MOVE 6 TO BV003-PV-PAST-MONTHS.                              23950016
           MOVE PV-DB2-ENT-ID   TO BV003-PV-ENT-ID-IN.                  23960016
           MOVE PV-DB2-DEPT-NBR TO BV003-PV-DEPT-IN.                    23970016
           MOVE PV-PROCESS-DATE TO BV003-PV-EFF-DTE-IN                  23980016
           PERFORM BV003-LOOKUP-MAIN.                                   23990016
           IF BV003-PV-NO-ERRORS-FOUND                                  24000016
             IF BV003-UNKNOWN-INS                                       24010016
                PERFORM 8200-COMMIT                                     24020016
             END-IF                                                     24030016
             IF BV003-PV-RT-SUB-OUT NOT EQUAL ZERO                      24040016
                COMPUTE PV-PRORATION-PCT ROUNDED EQUAL                  24050016
                        100 / BV003-PV-RT-SUB-OUT                       24060016
             END-IF                                                     24070016
             EVALUATE TRUE                                              24080016
                WHEN PS-PRRTN-FOR-PURCH                                 24090016
                     IF NOT PS-PURCH-AP-TRANS-RTV                       24100016
                        OR (PS-PURCH-AP-TRANS-RTV AND                   24110016
                            PV-RTV-COUNT EQUAL ZERO)                    24120016
                        PERFORM 2500-PURCH-EVEN-MAIN                    24130016
                     ELSE                                               24140016
                        PERFORM 2700-PURCH-EVEN-RTV-DOC                 24150016
                     END-IF                                             24160016
                WHEN PS-PRRTN-FOR-SALE                                  24170016
                     PERFORM 3200-SALE-EVEN                             24180016
                WHEN PS-PRRTN-FOR-PCHG                                  24190016
                     PERFORM 4300-PCHG-EVEN                             24200016
             END-EVALUATE                                               24210016
           ELSE                                                         24220016
              DISPLAY 'ERROR PERFORMING VENDOR DEPARTMENT LOOKUP'       24230016
              DISPLAY 'PV-DB2-ENT-ID   ' PV-DB2-ENT-ID                  24240016
              DISPLAY 'PV-DB2-DEPT-NBR ' PV-DB2-DEPT-NBR                24250016
              EVALUATE TRUE                                             24260016
                 WHEN PS-PRRTN-FOR-PURCH                                24270016
                    DISPLAY ML030-PURCH-RECORD                          24280016
                 WHEN PS-PRRTN-FOR-SALE                                 24290016
                    DISPLAY ML022-SALE-RECORD                           24300016
                 WHEN PS-PRRTN-FOR-PCHG                                 24310016
                    DISPLAY ML029-PC-RECORD                             24320016
                 WHEN OTHER                                             24330016
                    DISPLAY ML024-ADJ-RECORD                            24340016
              END-EVALUATE                                              24350016
              PERFORM 9997-BV-LOOKUP-ERROR                              24360016
           END-IF.                                                      24370016
      ****************************************************************  24380016
      * RESET THE HOLD FIELDS                                           24390016
      ****************************************************************  24400016
NHOLD$ 6400-RESET-HOLD.                                                 24410016
NHOLD$     INITIALIZE PV-HOLD-SYS-ORIG                                  24420016
NHOLD$                PV-HOLD-TRANS-CDE                                 24430016
NHOLD$                PV-HOLD-AP-TRANS-CDE                              24440016
NHOLD$                PV-HOLD-SKU                                       24450016
NHOLD$                PV-HOLD-ENT-ID                                    24460016
J28582                PV-HOLD-DEPT-NBR                                  24470016
NHOLD$                PV-HOLD-ML-LWST-ID                                24480016
NHOLD$                PS-PREV-DBV-RLTSNHP-CHK-SW.                       24490016
      ****************************************************************  24500016
      * CHECK THE APPROPRIATE HOLD FIELDS FOR THE FILE CURRENTLY        24510016
      * BEING READ.                                                     24520016
      ****************************************************************  24530016
NHOLD$ 6500-CHECK-HOLD-MATCH.                                           24540016
NHOLD$     EVALUATE TRUE                                                24550016
NHOLD$        WHEN PV-HOLD-FILE-PADJ                                    24560016
NHOLD$             IF ML024-ADJ-ML-LWST-ID EQUAL PV-HOLD-ML-LWST-ID     24570016
NHOLD$                SET PS-HOLD-MATCH TO TRUE                         24580016
NHOLD$             ELSE                                                 24590016
NHOLD$                SET PS-NO-HOLD-MATCH TO TRUE                      24600016
NHOLD$                MOVE ML024-ADJ-ML-LWST-ID TO PV-HOLD-ML-LWST-ID   24610016
NHOLD$             END-IF                                               24620016
NHOLD$        WHEN PV-HOLD-FILE-PCHG                                    24630016
NHOLD$             IF  ML029-PC-AP-TRANS-CDE  EQUAL PV-HOLD-AP-TRANS-CDE24640016
NHOLD$             AND ML029-PC-SKU              EQUAL PV-HOLD-SKU      24650016
NHOLD$             AND ML029-PC-ENT-ID           EQUAL PV-HOLD-ENT-ID   24660016
J28582             AND ML029-PC-DEPT-NBR         EQUAL PV-HOLD-DEPT-NBR 24670016
NHOLD$                 SET PS-HOLD-MATCH TO TRUE                        24680016
NHOLD$             ELSE                                                 24690016
NHOLD$                SET PS-NO-HOLD-MATCH TO TRUE                      24700016
NHOLD$                MOVE ML029-PC-AP-TRANS-CDE TO                     24710016
NHOLD$                     PV-HOLD-AP-TRANS-CDE                         24720016
NHOLD$                MOVE ML029-PC-SKU             TO PV-HOLD-SKU      24730016
NHOLD$                MOVE ML029-PC-ENT-ID          TO PV-HOLD-ENT-ID   24740016
J28582                MOVE ML029-PC-DEPT-NBR        TO PV-HOLD-DEPT-NBR 24750016
NHOLD$             END-IF                                               24760016
NHOLD$        WHEN PV-HOLD-FILE-PURCH                                   24770016
NHOLD$             IF  ML030-PURCH-SYST-ORIG-CDE EQUAL PV-HOLD-SYS-ORIG 24780016
NHOLD$             AND ML030-PURCH-TRANS-CDE     EQUAL PV-HOLD-TRANS-CDE24790016
NHOLD$             AND ML030-PURCH-AP-TRANS-CDE  EQUAL                  24800016
NHOLD$                 PV-HOLD-AP-TRANS-CDE                             24810016
NHOLD$             AND ML030-PURCH-SKU           EQUAL PV-HOLD-SKU      24820016
NHOLD$             AND ML030-PURCH-ENT-ID        EQUAL PV-HOLD-ENT-ID   24830016
J28582             AND ML030-PURCH-DEPT-NBR      EQUAL PV-HOLD-DEPT-NBR 24840016
NHOLD$                 SET PS-HOLD-MATCH TO TRUE                        24850016
NHOLD$             ELSE                                                 24860016
NHOLD$                SET PS-NO-HOLD-MATCH TO TRUE                      24870016
NHOLD$                MOVE ML030-PURCH-SYST-ORIG-CDE TO PV-HOLD-SYS-ORIG24880016
NHOLD$                MOVE ML030-PURCH-TRANS-CDE    TO PV-HOLD-TRANS-CDE24890016
NHOLD$                MOVE ML030-PURCH-AP-TRANS-CDE TO                  24900016
NHOLD$                     PV-HOLD-AP-TRANS-CDE                         24910016
NHOLD$                MOVE ML030-PURCH-SKU          TO PV-HOLD-SKU      24920016
NHOLD$                MOVE ML030-PURCH-ENT-ID       TO PV-HOLD-ENT-ID   24930016
J28582                MOVE ML030-PURCH-DEPT-NBR     TO PV-HOLD-DEPT-NBR 24940016
NHOLD$             END-IF                                               24950016
NHOLD$        WHEN PV-HOLD-FILE-SALE                                    24960016
NHOLD$             IF  ML022-SALE-SKU    EQUAL PV-HOLD-SKU              24970016
NHOLD$             AND ML022-SALE-ENT-ID EQUAL PV-HOLD-ENT-ID           24980016
J28582             AND ML022-SALE-DEPT-NBR EQUAL PV-HOLD-DEPT-NBR       24990016
NHOLD$                 SET PS-HOLD-MATCH TO TRUE                        25000016
NHOLD$             ELSE                                                 25010016
NHOLD$                SET PS-NO-HOLD-MATCH TO TRUE                      25020016
NHOLD$                MOVE ML022-SALE-SKU    TO PV-HOLD-SKU             25030016
NHOLD$                MOVE ML022-SALE-ENT-ID TO PV-HOLD-ENT-ID          25040016
J28582                MOVE ML022-SALE-DEPT-NBR TO PV-HOLD-DEPT-NBR      25050016
NHOLD$             END-IF                                               25060016
NHOLD$     END-EVALUATE.                                                25070016
      ****************************************************************  25080016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  25090016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      25100016
      * A MARKDOWN STORE RETAIL PERCENT NOT EQUAL ZERO.                 25110016
      ****************************************************************  25120016
       7000-GET-MAX-MKDN-STR-RTL-PCT.                                   25130016
           SET PS-13-WK-PRRTN-INFO-EXISTS    TO TRUE                    25140016
           PERFORM                                                      25150016
               WITH TEST AFTER                                          25160016
               VARYING PV-RETRY-COUNTER                                 25170016
               FROM 1 BY 1                                              25180016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25190016
                         OR (SQLCODE = ZERO))                           25200016
                  EXEC SQL                                              25210016
                      SELECT MAX(LBL_SEQ_NBR)                           25220016
                        INTO :PV-MAX-BRAND:PV-NULL                      25230016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   25240016
                             TDTATTR DT                                 25250016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  25260016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    25270016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      25280016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    25290016
                         AND MKDN_STR_RTL_PCT     <> 0                  25300016
                  END-EXEC                                              25310016
                                                                        25320016
                  EVALUATE TRUE                                         25330016
                      WHEN SQLCODE = 0                                  25340016
                           IF PV-NULL NOT EQUAL ZERO                    25350016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 25360016
                           END-IF                                       25370016
                      WHEN SQLCODE = -904                               25380016
                      WHEN SQLCODE = -913                               25390016
                           CONTINUE                                     25400016
                      WHEN SQLWARN0 NOT = SPACES                        25410016
                      WHEN SQLCODE < +0                                 25420016
                      WHEN SQLCODE > +0                                 25430016
                           DISPLAY '7000-GET-MAX-MKDN-STR-RTL-PCT'      25440016
                           DISPLAY 'GETTING MAX BRAND '                 25450016
                           PERFORM 9998-SQL-ABEND                       25460016
                  END-EVALUATE                                          25470016
           END-PERFORM.                                                 25480016
                                                                        25490016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         25500016
              DISPLAY 'RETRIES EXCEEDED FOR MARKDOWN STORE RETAIL PCT'  25510016
              PERFORM 9998-SQL-ABEND                                    25520016
           END-IF.                                                      25530016
      ****************************************************************  25540016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  25550016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      25560016
      * A MARKDOWN BUYER RETAIL PERCENT NOT EQUAL ZERO.                 25570016
      ****************************************************************  25580016
       7010-GET-MAX-MKDN-BYR-RTL-PCT.                                   25590016
           SET PS-13-WK-PRRTN-INFO-EXISTS    TO TRUE                    25600016
           PERFORM                                                      25610016
               WITH TEST AFTER                                          25620016
               VARYING PV-RETRY-COUNTER                                 25630016
               FROM 1 BY 1                                              25640016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25650016
                         OR (SQLCODE = ZERO))                           25660016
                  EXEC SQL                                              25670016
                      SELECT MAX(LBL_SEQ_NBR)                           25680016
                        INTO :PV-MAX-BRAND:PV-NULL                      25690016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   25700016
                             TDTATTR DT                                 25710016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  25720016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    25730016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      25740016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    25750016
                         AND MKDN_BYR_RTL_PCT     <> 0                  25760016
                  END-EXEC                                              25770016
                                                                        25780016
                  EVALUATE TRUE                                         25790016
                      WHEN SQLCODE = 0                                  25800016
                           IF PV-NULL NOT EQUAL ZERO                    25810016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 25820016
                           END-IF                                       25830016
                      WHEN SQLCODE = -904                               25840016
                      WHEN SQLCODE = -913                               25850016
                           CONTINUE                                     25860016
                      WHEN SQLWARN0 NOT = SPACES                        25870016
                      WHEN SQLCODE < +0                                 25880016
                      WHEN SQLCODE > +0                                 25890016
                           DISPLAY '7010-GET-MAX-MKDN-BYR-RTL-PCT'      25900016
                           DISPLAY 'GETTING MAX BRAND '                 25910016
                           PERFORM 9998-SQL-ABEND                       25920016
                  END-EVALUATE                                          25930016
           END-PERFORM.                                                 25940016
                                                                        25950016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         25960016
              DISPLAY 'RETRIES EXCEEDED FOR MARKDOWN BUYER RETAIL PCT'  25970016
              PERFORM 9998-SQL-ABEND                                    25980016
           END-IF.                                                      25990016
      ****************************************************************  26000016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  26010016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      26020016
      * A RECEIPT GROSS COST PERCENT NOT EQUAL ZERO.                    26030016
      ****************************************************************  26040016
       7020-GET-MAX-RCPT-GRO-CST-PCT.                                   26050016
           SET PS-13-WK-PRRTN-INFO-EXISTS    TO TRUE                    26060016
           PERFORM                                                      26070016
               WITH TEST AFTER                                          26080016
               VARYING PV-RETRY-COUNTER                                 26090016
               FROM 1 BY 1                                              26100016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26110016
                         OR (SQLCODE = ZERO))                           26120016
                  EXEC SQL                                              26130016
                      SELECT MAX(LBL_SEQ_NBR)                           26140016
                        INTO :PV-MAX-BRAND:PV-NULL                      26150016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   26160016
                             TDTATTR DT                                 26170016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  26180016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    26190016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      26200016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    26210016
                         AND RCPT_GRO_COST_PCT    <> 0                  26220016
                  END-EXEC                                              26230016
                                                                        26240016
                  EVALUATE TRUE                                         26250016
                      WHEN SQLCODE = 0                                  26260016
                           IF PV-NULL NOT EQUAL ZERO                    26270016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 26280016
                           END-IF                                       26290016
                      WHEN SQLCODE = -904                               26300016
                      WHEN SQLCODE = -913                               26310016
                           CONTINUE                                     26320016
                      WHEN SQLWARN0 NOT = SPACES                        26330016
                      WHEN SQLCODE < +0                                 26340016
                      WHEN SQLCODE > +0                                 26350016
                           DISPLAY '7020-GET-MAX-RCPT-GRO-CST-PCT'      26360016
                           DISPLAY 'GETTING MAX BRAND '                 26370016
                           PERFORM 9998-SQL-ABEND                       26380016
                  END-EVALUATE                                          26390016
           END-PERFORM.                                                 26400016
                                                                        26410016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         26420016
              DISPLAY 'RETRIES EXCEEDED FOR MARKDOWN BUYER RETAIL PCT'  26430016
              PERFORM 9998-SQL-ABEND                                    26440016
           END-IF.                                                      26450016
      ****************************************************************  26460016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  26470016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      26480016
      * AN RTV COST PERCENT NOT EQUAL ZERO.                             26490016
      ****************************************************************  26500016
       7030-GET-MAX-PADJ-RTV-COST-PCT.                                  26510016
           SET PS-13-WK-PRRTN-INFO-EXISTS    TO TRUE                    26520016
           PERFORM                                                      26530016
               WITH TEST AFTER                                          26540016
               VARYING PV-RETRY-COUNTER                                 26550016
               FROM 1 BY 1                                              26560016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26570016
                         OR (SQLCODE = ZERO))                           26580016
                  EXEC SQL                                              26590016
                      SELECT MAX(LBL_SEQ_NBR)                           26600016
                        INTO :PV-MAX-BRAND:PV-NULL                      26610016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   26620016
                             TDTATTR DT                                 26630016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  26640016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    26650016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      26660016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    26670016
                         AND PADJ_RTV_COST_PCT    <> 0                  26680016
                  END-EXEC                                              26690016
                                                                        26700016
                  EVALUATE TRUE                                         26710016
                      WHEN SQLCODE = 0                                  26720016
                           IF PV-NULL NOT EQUAL ZERO                    26730016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 26740016
                           END-IF                                       26750016
                      WHEN SQLCODE = -904                               26760016
                      WHEN SQLCODE = -913                               26770016
                           CONTINUE                                     26780016
                      WHEN SQLWARN0 NOT = SPACES                        26790016
                      WHEN SQLCODE < +0                                 26800016
                      WHEN SQLCODE > +0                                 26810016
                           DISPLAY '7030-GET-MAX-PADJ-RTV-COST-PCT'     26820016
                           DISPLAY 'GETTING MAX BRAND '                 26830016
                           DISPLAY 'PV-DB2-ENT-ID   ' PV-DB2-ENT-ID     26840016
                           DISPLAY 'PV-DB2-DEPT-NBR ' PV-DB2-DEPT-NBR   26850016
                           PERFORM 9998-SQL-ABEND                       26860016
                  END-EVALUATE                                          26870016
           END-PERFORM.                                                 26880016
                                                                        26890016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         26900016
              DISPLAY 'RETRIES EXCEEDED FOR RTV COST PCT'               26910016
              PERFORM 9998-SQL-ABEND                                    26920016
           END-IF.                                                      26930016
      ****************************************************************  26940016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  26950016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      26960016
      * A DA COST PERCENT NOT EQUAL ZERO.                               26970016
      ****************************************************************  26980016
       7040-GET-MAX-PADJ-DA-COST-PCT.                                   26990016
           SET PS-13-WK-PRRTN-INFO-EXISTS    TO TRUE                    27000016
           PERFORM                                                      27010016
               WITH TEST AFTER                                          27020016
               VARYING PV-RETRY-COUNTER                                 27030016
               FROM 1 BY 1                                              27040016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27050016
                         OR (SQLCODE = ZERO))                           27060016
                  EXEC SQL                                              27070016
                      SELECT MAX(LBL_SEQ_NBR)                           27080016
                        INTO :PV-MAX-BRAND:PV-NULL                      27090016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   27100016
                             TDTATTR DT                                 27110016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  27120016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    27130016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      27140016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    27150016
                         AND PADJ_DA_COST_PCT     <> 0                  27160016
                  END-EXEC                                              27170016
                                                                        27180016
                  EVALUATE TRUE                                         27190016
                      WHEN SQLCODE = 0                                  27200016
                           IF PV-NULL NOT EQUAL ZERO                    27210016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 27220016
                           END-IF                                       27230016
                      WHEN SQLCODE = -904                               27240016
                      WHEN SQLCODE = -913                               27250016
                           CONTINUE                                     27260016
                      WHEN SQLWARN0 NOT = SPACES                        27270016
                      WHEN SQLCODE < +0                                 27280016
                      WHEN SQLCODE > +0                                 27290016
                           DISPLAY '7040-GET-MAX-PADJ-DA-COST-PCT'      27300016
                           DISPLAY 'GETTING MAX BRAND '                 27310016
                           PERFORM 9998-SQL-ABEND                       27320016
                  END-EVALUATE                                          27330016
           END-PERFORM.                                                 27340016
                                                                        27350016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         27360016
              DISPLAY 'RETRIES EXCEEDED FOR DA COST PCT'                27370016
              PERFORM 9998-SQL-ABEND                                    27380016
           END-IF.                                                      27390016
      ****************************************************************  27400016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  27410016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      27420016
      * A DA COST AMOUNT PERCENT NOT EQUAL ZERO.                        27430016
      ****************************************************************  27440016
       7060-GET-MAX-SLS-REG-RTL-PCT.                                    27450016
           SET PS-13-WK-PRRTN-INFO-EXISTS TO TRUE                       27460016
           PERFORM                                                      27470016
               WITH TEST AFTER                                          27480016
               VARYING PV-RETRY-COUNTER                                 27490016
               FROM 1 BY 1                                              27500016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27510016
                         OR (SQLCODE = ZERO))                           27520016
                  EXEC SQL                                              27530016
                      SELECT MAX(LBL_SEQ_NBR)                           27540016
                        INTO :PV-MAX-BRAND:PV-NULL                      27550016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   27560016
                             TDTATTR DT                                 27570016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  27580016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    27590016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      27600016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    27610016
                         AND SLS_REG_RTL_PCT      <> 0                  27620016
                  END-EXEC                                              27630016
                                                                        27640016
                  EVALUATE TRUE                                         27650016
                      WHEN SQLCODE = 0                                  27660016
                           IF PV-NULL NOT EQUAL ZERO                    27670016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 27680016
                           END-IF                                       27690016
                      WHEN SQLCODE = -904                               27700016
                      WHEN SQLCODE = -913                               27710016
                           CONTINUE                                     27720016
                      WHEN SQLWARN0 NOT = SPACES                        27730016
                      WHEN SQLCODE < +0                                 27740016
                      WHEN SQLCODE > +0                                 27750016
                           DISPLAY '7060-GET-MAX-SLS-REG-RTL-PCT'       27760016
                           DISPLAY 'GETTING MAX BRAND '                 27770016
                           PERFORM 9998-SQL-ABEND                       27780016
                  END-EVALUATE                                          27790016
           END-PERFORM.                                                 27800016
                                                                        27810016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         27820016
              DISPLAY 'RETRIES EXCEEDED FOR SALES PCT'                  27830016
              PERFORM 9998-SQL-ABEND                                    27840016
           END-IF.                                                      27850016
      ****************************************************************  27860016
      * VALIDATE THE CONTROL CARD DATE                                  27870016
      ****************************************************************  27880016
       7070-VALIDATE-CNTL-DATE.                                         27890016
           PERFORM                                                      27900016
               WITH TEST AFTER                                          27910016
               VARYING PV-RETRY-COUNTER                                 27920016
               FROM 1 BY 1                                              27930016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27940016
                         OR (SQLCODE = ZERO))                           27950016
                  EXEC SQL                                              27960016
                     SELECT 'Y'                                         27970016
                       INTO :PV-DB2-DATE-EXISTS                         27980016
                       FROM TDTATTR                                     27990016
                      WHERE KY_DTE = :PV-PROCESS-DATE                   28000016
                  END-EXEC                                              28010016
                                                                        28020016
                  EVALUATE TRUE                                         28030016
                      WHEN SQLCODE = 0                                  28040016
                      WHEN SQLCODE = -904                               28050016
                      WHEN SQLCODE = -913                               28060016
                           CONTINUE                                     28070016
                      WHEN SQLWARN0 NOT = SPACES                        28080016
                      WHEN SQLCODE < +0                                 28090016
                      WHEN SQLCODE > +0                                 28100016
                           DISPLAY '7070-VALIDATE-CNTL-DATE'            28110016
                           DISPLAY 'GETTING CURRENT DATE'               28120016
                           PERFORM 9998-SQL-ABEND                       28130016
                  END-EVALUATE                                          28140016
           END-PERFORM.                                                 28150016
                                                                        28160016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         28170016
              DISPLAY 'RETRIES EXCEEDED FOR CURRENT DATE'               28180016
              PERFORM 9998-SQL-ABEND                                    28190016
           END-IF.                                                      28200016
      ******************************************************************28210016
      *  OPEN THE RTV DOCUMENT CURSOR                                   28220016
      ******************************************************************28230016
       8000-OPEN-RTV-DOC-CSR.                                           28240016
            EXEC SQL                                                    28250016
                OPEN RTV-DOC-CSR                                        28260016
            END-EXEC.                                                   28270016
                                                                        28280016
            EVALUATE TRUE                                               28290016
                WHEN SQLCODE = +0                                       28300016
                    CONTINUE                                            28310016
                WHEN SQLWARN NOT = SPACE                                28320016
                WHEN SQLCODE NOT = +0                                   28330016
                    DISPLAY '8000-OPEN-RTV-DOC-CSR'                     28340016
                    PERFORM 9998-SQL-ABEND                              28350016
            END-EVALUATE.                                               28360016
                                                                        28370016
      ******************************************************************28380016
      *  FETCH A ROW FROM THE RTV DOCUMENT CURSOR                       28390016
      ******************************************************************28400016
       8010-FETCH-RTV-DOC-CSR.                                          28410016
           EXEC SQL                                                     28420016
             FETCH RTV-DOC-CSR                                          28430016
               INTO :DFMEIT-DFCT-ITEM-NBR                               28440016
RONNAZ*            ,:DFMEIT-MDSE-DEPT-NBR                               28450016
                   ,:DFMEIT-RTL-COST-AMT                                28460016
                   ,:DFMEIT-UNIT-COST-AMT                               28470016
           END-EXEC.                                                    28480016
                                                                        28490016
           EVALUATE TRUE                                                28500016
               WHEN SQLCODE = +0                                        28510016
                    ADD 1 TO PV-RTV-COUNT                               28520016
                    CONTINUE                                            28530016
               WHEN SQLCODE = +100                                      28540016
                   SET PS-NO-MORE-RTV-RECORDS TO TRUE                   28550016
               WHEN SQLWARN NOT = SPACE                                 28560016
               WHEN SQLCODE NOT = +0                                    28570016
                   DISPLAY '8010-FETCH-RTV-DOC-CSR'                     28580016
                   PERFORM 9998-SQL-ABEND                               28590016
           END-EVALUATE.                                                28600016
      ******************************************************************28610016
      *  CLOSE THE RTV DOCUMENT CURSOR                                  28620016
      ******************************************************************28630016
       8020-CLOSE-RTV-DOC-CSR.                                          28640016
           EXEC SQL                                                     28650016
               CLOSE RTV-DOC-CSR                                        28660016
           END-EXEC.                                                    28670016
                                                                        28680016
           EVALUATE TRUE                                                28690016
               WHEN SQLCODE = +0                                        28700016
                   CONTINUE                                             28710016
               WHEN SQLWARN NOT = SPACE                                 28720016
               WHEN SQLCODE NOT = +0                                    28730016
                   DISPLAY '8020-CLOSE-RTV-DOC-CSR'                     28740016
                   PERFORM 9998-SQL-ABEND                               28750016
           END-EVALUATE.                                                28760016
                                                                        28770016
      ******************************************************************28780016
      *  OPEN THE BRAND PRORATION CURSOR                                28790016
      ******************************************************************28800016
       8100-OPEN-BRND-PRRTN-CSR.                                        28810016
            EXEC SQL                                                    28820016
                OPEN BRND-PRRTN-CSR                                     28830016
            END-EXEC.                                                   28840016
                                                                        28850016
            EVALUATE TRUE                                               28860016
                WHEN SQLCODE = +0                                       28870016
                    CONTINUE                                            28880016
                WHEN SQLWARN NOT = SPACE                                28890016
                WHEN SQLCODE NOT = +0                                   28900016
                    DISPLAY '8100-OPEN-BRND-PRRTN-CSR'                  28910016
                    PERFORM 9998-SQL-ABEND                              28920016
            END-EVALUATE.                                               28930016
                                                                        28940016
      ******************************************************************28950016
      *  FETCH A ROW FROM THE BRNAD PRORATION CURSOR                    28960016
      ******************************************************************28970016
       8110-FETCH-BRND-PRRTN-CSR.                                       28980016
           EXEC SQL                                                     28990016
             FETCH BRND-PRRTN-CSR                                       29000016
               INTO :BVT00003-LBL-SEQ-NBR                               29010016
                   ,:BVT00003-MKDN-BYR-RTL-PCT                          29020016
                   ,:BVT00003-MKDN-STR-RTL-PCT                          29030016
                   ,:BVT00003-RCPT-GRO-COST-PCT                         29040016
                   ,:BVT00003-PADJ-DA-COST-PCT                          29050016
                   ,:BVT00003-PADJ-RTV-COST-PCT                         29060016
                   ,:BVT00003-SLS-REG-RTL-PCT                           29070016
           END-EXEC.                                                    29080016
                                                                        29090016
           EVALUATE TRUE                                                29100016
               WHEN SQLCODE = +0                                        29110016
                    CONTINUE                                            29120016
               WHEN SQLCODE = +100                                      29130016
                   SET PS-NO-MORE-BVP-RECORDS TO TRUE                   29140016
               WHEN SQLWARN NOT = SPACE                                 29150016
               WHEN SQLCODE NOT = +0                                    29160016
                   DISPLAY '8110-FETCH-BRND-PRRTN-CSR'                  29170016
                   PERFORM 9998-SQL-ABEND                               29180016
           END-EVALUATE.                                                29190016
      ******************************************************************29200016
      *  CLOSE THE BRAND PRORATION CURSOR                               29210016
      ******************************************************************29220016
       8120-CLOSE-BRND-PRRTN-CSR.                                       29230016
           EXEC SQL                                                     29240016
               CLOSE BRND-PRRTN-CSR                                     29250016
           END-EXEC.                                                    29260016
                                                                        29270016
           EVALUATE TRUE                                                29280016
               WHEN SQLCODE = +0                                        29290016
                   CONTINUE                                             29300016
               WHEN SQLWARN NOT = SPACE                                 29310016
               WHEN SQLCODE NOT = +0                                    29320016
                   DISPLAY '8120-CLOSE-BRND-PRRTN-CSR'                  29330016
                   PERFORM 9998-SQL-ABEND                               29340016
           END-EVALUATE.                                                29350016
                                                                        29360016
      ******************************************************************29370016
      *  PERFORM A DB2 COMMIT                                           29380016
      ******************************************************************29390016
       8200-COMMIT.                                                     29400016
           EXEC SQL                                                     29410016
               COMMIT                                                   29420016
           END-EXEC.                                                    29430016
                                                                        29440016
           EVALUATE TRUE                                                29450016
               WHEN SQLCODE = +0                                        29460016
                   CONTINUE                                             29470016
               WHEN SQLWARN NOT = SPACE                                 29480016
               WHEN SQLCODE NOT = +0                                    29490016
                   DISPLAY '8200-COMMIT'                                29500016
                   PERFORM 9998-SQL-ABEND                               29510016
           END-EVALUATE.                                                29520016
                                                                        29530016
W31475******************************************************************29540016
W31475*  REWRITE OF ORACLE FUNCTIONALITY IN MLKUP359 TO DO PRORATION    29550016
W31475******************************************************************29560016
W31475 8300-GET-DA-BRND-PRORATION.                                      29570016
W31475     PERFORM 8310-OPEN-DA-BRND-PRRTN-CSR.                         29580016
W31475     SET PS-NOT-END-OF-BRND-PRRTN-CSR TO TRUE.                    29590016
W31475     PERFORM 8320-FETCH-DA-BRND-PRRTN-CSR                         29600016
W31475       UNTIL PS-END-OF-BRND-PRRTN-CSR.                            29610016
W31475     PERFORM 8390-CLOSE-DA-BRND-PRRTN-CSR.                        29620016
W31475                                                                  29630016
W31475******************************************************************29640016
W31475*  OPEN THE DA BRAND PRORATION CURSOR                             29650016
W31475******************************************************************29660016
W31475 8310-OPEN-DA-BRND-PRRTN-CSR.                                     29670016
W31475      EXEC SQL                                                    29680016
W31475          OPEN DA-BRND-PRRTN-CSR                                  29690016
W31475      END-EXEC.                                                   29691016
W31475                                                                  29692016
W31475      EVALUATE TRUE                                               29693016
W31475          WHEN SQLCODE = +0                                       29694016
W31475              CONTINUE                                            29695016
W31475          WHEN SQLWARN NOT = SPACE                                29696016
W31475          WHEN SQLCODE NOT = +0                                   29697016
W31475              DISPLAY '8310-OPEN-DA-BRND-PRRTN-CSR'               29698016
W31475              PERFORM 9998-SQL-ABEND                              29699016
W31475      END-EVALUATE.                                               29699116
W31475                                                                  29699216
W31475******************************************************************29699316
W31475*  FETCH THE DA BRAND PRORATION CURSOR                            29699416
W31475******************************************************************29699516
W31475 8320-FETCH-DA-BRND-PRRTN-CSR.                                    29699616
W31475                                                                  29699716
W31475     EXEC SQL                                                     29699816
W31475         FETCH DA-BRND-PRRTN-CSR                                  29699916
W31475         INTO                                                     29700016
W31475              :PV-LBL-SEQ-NBR                                     29700116
W31475             ,:PV-PRRTN-PCT                                       29700216
W31475     END-EXEC.                                                    29700316
W31475                                                                  29700416
W31475     EVALUATE TRUE                                                29700516
W31475       WHEN SQLCODE = ZERO                                        29700616
W31475            ADD 1 TO ML006-DA-PRRTN-REC-CNT                       29700716
W31475            MOVE PV-LBL-SEQ-NBR TO ML006-DA-PRRTN-BRND            29700816
W31475                                  (ML006-DA-PRRTN-REC-CNT)        29700916
W31475*           MOVE PV-PRRTN-PCT   TO ML006-DA-PRRTN-PCT             29701016
W31475*                                 (ML006-DA-PRRTN-REC-CNT)        29701116
W31475            COMPUTE ML006-DA-PRRTN-PCT (ML006-DA-PRRTN-REC-CNT)   29701216
W31475              ROUNDED = PV-PRRTN-PCT                              29701316
W31475       WHEN SQLCODE = +100                                        29701416
W31475             SET PS-END-OF-BRND-PRRTN-CSR TO TRUE                 29701516
W31475       WHEN SQLWARN NOT = SPACE                                   29701616
W31475       WHEN SQLCODE NOT = +0                                      29701716
W31475             DISPLAY '8320-FETCH-DA-BRND-PRRTN-CSR'               29701816
W31475             PERFORM 9998-SQL-ABEND                               29701916
W31475                                                                  29702016
W31475     END-EVALUATE.                                                29702116
W31475******************************************************************29702216
W31475*  CLOSE THE DA BRAND PRORATION CURSOR                            29702316
W31475******************************************************************29702416
W31475 8390-CLOSE-DA-BRND-PRRTN-CSR.                                    29702516
W31475      EXEC SQL                                                    29702616
W31475          CLOSE DA-BRND-PRRTN-CSR                                 29702716
W31475      END-EXEC.                                                   29702816
W31475                                                                  29702916
W31475      EVALUATE TRUE                                               29703016
W31475          WHEN SQLCODE = +0                                       29704016
W31475              CONTINUE                                            29704116
W31475          WHEN SQLWARN NOT = SPACE                                29704216
W31475          WHEN SQLCODE NOT = +0                                   29704316
W31475              DISPLAY '8390-CLOSE-DA-BRND-PRRTN-CSR'              29704416
W31475              PERFORM 9998-SQL-ABEND                              29704516
W31475      END-EVALUATE.                                               29704616
W31475                                                                  29704716
      ******************************************************************29704816
      *  BRAND VENDOR RELATIONSHIP UTILITY FUNCTIONS.                   29704916
      ******************************************************************29705016
      *    COPY BVPD001.                                                29705116
      ******************************************************************29705216
      *  READ THE NEXT RECORD FROM THE EDIT PURCH FILE.                 29705316
      ******************************************************************29705416
       9000-READ-PURCH-FILE.                                            29705516
           READ PURCH-FILE                                              29705616
               INTO ML030-PURCH-RECORD                                  29705716
               AT END                                                   29705816
                   SET PS-NO-MORE-PURCH-RECORDS TO TRUE.                29705916
W28582     IF PS-NO-MORE-PURCH-RECORDS                                  29706016
W28582        CONTINUE                                                  29707016
W28582     ELSE                                                         29708016
W28582        MOVE 1 TO DP150-REPORT-NUMBER                             29709016
W28582        PERFORM 9200-WRITE-PURCH-REPORT                           29710016
W28582        IF PS-RESTART-RUN                                         29720016
W28582            ADD 1 TO PV-RESTART-COUNT                             29730016
W28582        END-IF                                                    29740016
W28582     END-IF.                                                      29750016
      ******************************************************************29760016
      *  READ THE NEXT RECORD FROM THE EDIT SALE FILE.                  29770016
      ******************************************************************29780016
       9010-READ-SALE-FILE.                                             29790016
           READ SALE-FILE                                               29800016
               INTO ML022-SALE-RECORD                                   29810016
               AT END                                                   29820016
                   SET PS-NO-MORE-SALE-RECORDS TO TRUE.                 29830016
W28582     IF PS-NO-MORE-SALE-RECORDS                                   29840016
W28582        CONTINUE                                                  29850016
W28582     ELSE                                                         29860016
W28582        MOVE 2 TO DP132-REPORT-NUMBER                             29870016
W28582        PERFORM 9200-WRITE-SALES-REPORT                           29880016
W28582        IF PS-RESTART-RUN                                         29890016
W28582            ADD 1 TO PV-RESTART-COUNT                             29900016
W28582        END-IF                                                    29910016
W28582     END-IF.                                                      29920016
      ******************************************************************29930016
      *  READ THE NEXT RECORD FROM THE EDIT PRICE CHANGE FILE.          29940016
      ******************************************************************29950016
       9020-READ-PRC-CHG-FILE.                                          29960016
           READ PRC-CHG-FILE                                            29970016
               INTO ML029-PC-RECORD                                     29980016
               AT END                                                   29990016
                   SET PS-NO-MORE-PCHG-RECORDS TO TRUE.                 30000016
W28582     IF PS-NO-MORE-PCHG-RECORDS                                   30010016
W28582        CONTINUE                                                  30020016
W28582     ELSE                                                         30030016
W28582        MOVE 3 TO DP132-REPORT-NUMBER                             30040016
W28582        PERFORM 9200-WRITE-PCHG-REPORT                            30050016
W28582        IF PS-RESTART-RUN                                         30060016
W28582            ADD 1 TO PV-RESTART-COUNT                             30070016
W28582        END-IF                                                    30080016
W28582     END-IF.                                                      30090016
      ******************************************************************30100016
      *  READ THE NEXT RECORD FROM THE INVENTORY ADJUSTMENT FILE.       30110016
      ******************************************************************30120016
       9030-READ-ADJUSTMENT-FILE.                                       30130016
           READ ADJUSTMENT-FILE                                         30140016
               INTO ML024-ADJ-RECORD                                    30150016
               AT END                                                   30160016
                   SET PS-NO-MORE-ADJ-RECORDS TO TRUE.                  30170016
W28582     IF PS-NO-MORE-ADJ-RECORDS                                    30180016
W28582        CONTINUE                                                  30190016
W28582     ELSE                                                         30200016
W28582        MOVE 4 TO DP132-REPORT-NUMBER                             30210016
W28582        PERFORM 9200-WRITE-ADJ-REPORT                             30220016
W28582        IF PS-RESTART-RUN                                         30230016
W28582            ADD 1 TO PV-RESTART-COUNT                             30240016
W28582        END-IF                                                    30250016
W28582     END-IF.                                                      30260016
                                                                        30270016
      ******************************************************************30280016
      * 9040-READ-ORACLE-SRC-CTL.                                       30290016
      *     THE ROUTINE READS IN THE ORACLE SOURCE CONTROL CARD MLCC07*.30300016
      * THE CARD DEFINES WHICH ORACLE ENVIRONMENT WE ARE PROCESSING     30310016
      * FROM.  THIS INFORMATION IS USED BY MLKUP359 WHEN PROCESSING     30320016
      * DEBIT ALLOWANCE TRANSACTIONS.                                   30330016
      ******************************************************************30340016
       9040-READ-ORACLE-SRC-CTL.                                        30350016
           READ IN-ORACLE-SRC-CTL NEXT                                  30360016
               AT END  SET PS-NO-MORE-ORACLE-CC TO TRUE.                30370016
                                                                        30380016
           IF PS-NO-MORE-ORACLE-CC                                      30390016
             DISPLAY '**********************************'               30400016
             DISPLAY '* ABEND: 1000-INITIALIZATION'                     30410016
             DISPLAY '*   MISSING CONTROL CARD MLCC07* INFORMATION'     30420016
             DISPLAY '* THE PROGRAM WILL ABEND'                         30430016
             DISPLAY '**********************************'               30440016
             PERFORM 9999-OTHER-ABEND                                   30450016
           ELSE                                                         30460016
             MOVE IOC-SRC-SYSTEM TO PV-EDIT-ORA-SOURCE                  30470016
             IF (NOT VALID-ORACLE-CONNECT-STRING)                       30480016
               DISPLAY '**********************************'             30490016
               DISPLAY '* ABEND: 1000-INITIALIZATION'                   30500016
               DISPLAY '*   INVALID ORACLE SOURCE SYSTEM INFORMATION'   30510016
               DISPLAY '* EXISTS IN CONTROL CARD MLCC07*'               30520016
               DISPLAY '**********************************'             30530016
               PERFORM 9999-OTHER-ABEND                                 30540016
           END-IF.                                                      30550016
      ******************************************************************30560016
      * 9050-READ-CNTL-DATE.                                            30570016
      ******************************************************************30580016
       9050-READ-CNTL-DTE.                                              30590016
           READ CNTL-DATE-FILE INTO CC-CONTROL-CARD                     30600016
               AT END                                                   30610016
                   DISPLAY '** PROGRAM ABEND **'                        30620016
                   DISPLAY 'MLKUP358  - CONTROL DATE EMPTY'             30630016
                   PERFORM 9999-OTHER-ABEND.                            30640016
                                                                        30650016
           DISPLAY '** MLKUP358 CONTROL CARD:' CNTL-DATE-REC            30660016
                                                                        30670016
           MOVE CC-PROC-DATE-ISO TO PV-PROCESS-DATE                     30680016
           PERFORM 7070-VALIDATE-CNTL-DATE.                             30690016
W28582                                                                  30700016
W28582******************************************************************30710016
W28582* 9051-READ-CNTL-JOB.                                             30720016
W28582******************************************************************30730016
W28582 9051-READ-CNTL-JOB.                                              30740016
W28582     READ CNTL-JOB-FILE INTO CC-CONTROL-JOB                       30750016
W28582         AT END                                                   30760016
W28582             DISPLAY '** PROGRAM ABEND **'                        30770016
W28582             DISPLAY 'MLKUP358  - CONTROL JOB EMPTY'              30780016
W28582             PERFORM 9999-OTHER-ABEND.                            30790016
W28582                                                                  30800016
W28582     DISPLAY '** MLKUP358 CONTROL JOB:' CNTL-JOB-REC              30810016
W28582                                                                  30820016
W28582     MOVE CC-JOB-NAME TO PC-JOB-NAME.                             30830016
W28582******************************************************************30840016
W28582* 9201-MOVE-PURCH-DETAIL                                          30850016
W28582******************************************************************30860016
W28582 9201-MOVE-PURCH-DETAIL.                                          30870016
W28582     MOVE ML030-PURCH-SYST-ORIG-CDE TO DT1-SYST-ORIG-CDE          30880016
W28582     MOVE ML030-PURCH-TRANS-CDE     TO DT1-PURCH-TRANS-CDE        30890016
W28582     MOVE ML030-PURCH-AP-TRANS-CDE  TO DT1-AP-TRANS-CDE           30900016
W28582     MOVE ML030-PURCH-SKU           TO DT1-SKU                    30910016
W28582     MOVE ML030-PURCH-STORE-NBR     TO DT1-LOC                    30920016
W28582     MOVE ML030-PURCH-DEPT-NBR      TO DT1-DEPT                   30930016
W28582     MOVE ML030-PURCH-EXTD-GRO-COST-AMT                           30940016
W28582                                    TO DT1-GROSS-COST-AMT         30950016
W28582     MOVE ML030-PURCH-FRGT-AMT      TO DT1-FRGT-AMT               30960016
W28582     MOVE ML030-PURCH-DISC-AMT      TO DT1-DISC-AMT               30970016
W28582     MOVE ML030-PURCH-EXTD-NET-COST-AMT                           30980016
W28582                                    TO DT1-NET-COST-AMT           30990016
W28582     MOVE ML030-PURCH-EXTD-RTL-AMT  TO DT1-EXTD-RTL-AMT           31000016
W28582     MOVE ML030-PURCH-PER-UNT-RTL-AMT                             31010016
W28582                                    TO DT1-UNT-RTL-AMT            31020016
W28582     MOVE ML030-PURCH-ENT-ID        TO DT1-ENT-ID                 31030016
W28582     MOVE ML030-PURCH-LBL-SEQ-NBR   TO DT1-LBL-SEQ-NBR            31040016
W28582     MOVE ML030-PURCH-ML-LWST-ID    TO DT1-ML-LWST-ID.            31050016
W28582******************************************************************31060016
W28582* 9200-WRITE-SALES-REPORT                                         31070016
W28582******************************************************************31080016
W28582 9200-WRITE-SALES-REPORT.                                         31090016
W28582     IF PV-LINE-COUNTER < 51                                      31100016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          31110016
W28582        PERFORM 9202-MOVE-SALES-DETAIL                            31120016
W28582        WRITE BV-SALE-AUDIT-REC FROM DT2-SALES-DETAIL             31130016
W28582            AFTER ADVANCING 2 LINES                               31140016
W28582        ADD 2 TO PV-LINE-COUNTER                                  31150016
W28582     ELSE                                                         31160016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          31170016
W28582        ADD 1 TO PV-PAGE-COUNTER                                  31180016
W28582        MOVE PV-PAGE-COUNTER TO DP132-PAGE-NUMBER                 31190016
W28582        WRITE BV-SALE-AUDIT-REC FROM DP132-STANDRD-HEADER-132-COLS31200016
W28582            AFTER ADVANCING PAGE                                  31210016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          31220016
W28582        WRITE BV-SALE-AUDIT-REC FROM HL2-HEADING-LINE-1           31230016
W28582            AFTER ADVANCING 2 LINES                               31240016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          31250016
W28582        WRITE BV-SALE-AUDIT-REC FROM HL2-HEADING-LINE-2           31260016
W28582            AFTER ADVANCING 1 LINES                               31270016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          31280016
W28582        WRITE BV-SALE-AUDIT-REC FROM HL2-HEADING-LINE-3           31290016
W28582            AFTER ADVANCING 1 LINES                               31300016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          31310016
W28582        PERFORM 9202-MOVE-SALES-DETAIL                            31320016
W28582        MOVE 8 TO PV-LINE-COUNTER                                 31330016
W28582        WRITE BV-SALE-AUDIT-REC FROM DT2-SALES-DETAIL             31340016
W28582            AFTER ADVANCING 2 LINES                               31350016
W28582     END-IF.                                                      31360016
W28582******************************************************************31370016
W28582* 9200-WRITE-ADJ-REPORT                                           31380016
W28582******************************************************************31390016
W28582 9200-WRITE-ADJ-REPORT.                                           31400016
W28582     IF PV-LINE-COUNTER < 51                                      31410016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           31420016
W28582        PERFORM 9204-MOVE-ADJ-DETAIL                              31430016
W28582        WRITE BV-ADJ-AUDIT-REC FROM DT4-ADJ-DETAIL                31440016
W28582            AFTER ADVANCING 2 LINES                               31450016
W28582        ADD 2 TO PV-LINE-COUNTER                                  31460016
W28582     ELSE                                                         31470016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           31480016
W28582        ADD 1 TO PV-PAGE-COUNTER                                  31490016
W28582        MOVE PV-PAGE-COUNTER TO DP132-PAGE-NUMBER                 31500016
W28582        WRITE BV-ADJ-AUDIT-REC FROM DP132-STANDRD-HEADER-132-COLS 31510016
W28582            AFTER ADVANCING PAGE                                  31520016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           31530016
W28582        WRITE BV-ADJ-AUDIT-REC FROM HL4-HEADING-LINE-1            31540016
W28582            AFTER ADVANCING 2 LINES                               31550016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           31560016
W28582        WRITE BV-ADJ-AUDIT-REC FROM HL4-HEADING-LINE-2            31570016
W28582            AFTER ADVANCING 1 LINES                               31580016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           31590016
W28582        WRITE BV-ADJ-AUDIT-REC FROM HL4-HEADING-LINE-3            31600016
W28582            AFTER ADVANCING 1 LINES                               31610016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           31620016
W28582        WRITE BV-ADJ-AUDIT-REC FROM HL4-HEADING-LINE-4            31630016
W28582            AFTER ADVANCING 1 LINES                               31640016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           31650016
W28582        PERFORM 9204-MOVE-ADJ-DETAIL                              31660016
W28582        MOVE 9 TO PV-LINE-COUNTER                                 31670016
W28582        WRITE BV-ADJ-AUDIT-REC FROM DT4-ADJ-DETAIL                31680016
W28582            AFTER ADVANCING 2 LINES                               31690016
W28582     END-IF.                                                      31700016
W28582******************************************************************31710016
W28582* 9200-WRITE-PURCH-REPORT                                         31720016
W28582******************************************************************31730016
W28582 9200-WRITE-PURCH-REPORT.                                         31740016
W28582     IF PV-LINE-COUNTER < 51                                      31750016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         31760016
W28582        PERFORM 9201-MOVE-PURCH-DETAIL                            31770016
W28582        WRITE BV-PURCH-AUDIT-REC FROM DT1-PURCH-DETAIL            31780016
W28582            AFTER ADVANCING 2 LINES                               31790016
W28582        ADD 2 TO PV-LINE-COUNTER                                  31800016
W28582     ELSE                                                         31810016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         31820016
W28582        ADD 1 TO PV-PAGE-COUNTER                                  31830016
W28582        MOVE PV-PAGE-COUNTER TO DP150-PAGE-NUMBER                 31840016
W28582        WRITE BV-PURCH-AUDIT-REC FROM                             31850016
W28582           DP150-STANDRD-HEADER-150-COLS                          31860016
W28582           AFTER ADVANCING PAGE                                   31870016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         31880016
W28582        WRITE BV-PURCH-AUDIT-REC FROM HL1-HEADING-LINE-1          31890016
W28582            AFTER ADVANCING 2 LINES                               31900016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         31910016
W28582        WRITE BV-PURCH-AUDIT-REC FROM HL1-HEADING-LINE-2          31920016
W28582            AFTER ADVANCING 1 LINES                               31930016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         31940016
W28582        WRITE BV-PURCH-AUDIT-REC FROM HL1-HEADING-LINE-3          31950016
W28582            AFTER ADVANCING 1 LINES                               31960016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         31970016
W28582        WRITE BV-PURCH-AUDIT-REC FROM HL1-HEADING-LINE-4          31980016
W28582            AFTER ADVANCING 1 LINES                               31990016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         32000016
W28582        PERFORM 9201-MOVE-PURCH-DETAIL                            32010016
W28582        MOVE 9 TO PV-LINE-COUNTER                                 32020016
W28582        WRITE BV-PURCH-AUDIT-REC FROM DT1-PURCH-DETAIL            32030016
W28582            AFTER ADVANCING 2 LINES                               32040016
W28582     END-IF.                                                      32050016
W28582******************************************************************32060016
W28582* 9200-WRITE-PCHG-REPORT                                          32070016
W28582******************************************************************32080016
W28582 9200-WRITE-PCHG-REPORT.                                          32090016
W28582     IF PV-LINE-COUNTER < 51                                      32100016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          32110016
W28582        PERFORM 9203-MOVE-PCHG-DETAIL                             32120016
W28582        WRITE BV-PCHG-AUDIT-REC FROM DT3-PCHG-DETAIL              32130016
W28582            AFTER ADVANCING 2 LINES                               32140016
W28582        ADD 2 TO PV-LINE-COUNTER                                  32150016
W28582     ELSE                                                         32160016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          32170016
W28582        ADD 1 TO PV-PAGE-COUNTER                                  32180016
W28582        MOVE PV-PAGE-COUNTER TO DP132-PAGE-NUMBER                 32190016
W28582        WRITE BV-PCHG-AUDIT-REC FROM                              32200016
W28582           DP132-STANDRD-HEADER-132-COLS                          32210016
W28582           AFTER ADVANCING PAGE                                   32220016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          32230016
W28582        WRITE BV-PCHG-AUDIT-REC FROM HL3-HEADING-LINE-1           32240016
W28582            AFTER ADVANCING 2 LINES                               32250016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          32260016
W28582        WRITE BV-PCHG-AUDIT-REC FROM HL3-HEADING-LINE-2           32270016
W28582            AFTER ADVANCING 1 LINES                               32280016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          32290016
W28582        WRITE BV-PCHG-AUDIT-REC FROM HL3-HEADING-LINE-3           32300016
W28582            AFTER ADVANCING 1 LINES                               32310016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          32320016
W28582        WRITE BV-PCHG-AUDIT-REC FROM HL3-HEADING-LINE-4           32330016
W28582            AFTER ADVANCING 1 LINES                               32340016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          32350016
W28582        PERFORM 9203-MOVE-PCHG-DETAIL                             32360016
W28582        MOVE 9 TO PV-LINE-COUNTER                                 32370016
W28582        WRITE BV-PCHG-AUDIT-REC FROM DT3-PCHG-DETAIL              32380016
W28582            AFTER ADVANCING 2 LINES                               32390016
W28582     END-IF.                                                      32400016
W28582******************************************************************32410016
W28582* 9202-MOVE-SALES-DETAIL                                          32420016
W28582******************************************************************32430016
W28582 9202-MOVE-SALES-DETAIL.                                          32440016
W28582     MOVE ML022-SALE-SKU            TO DT2-SKU                    32450016
W28582     MOVE ML022-SALE-STORE-NBR      TO DT2-LOC                    32460016
W28582     MOVE ML022-SALE-DEPT-NBR       TO DT2-DEPT                   32470016
W28582     MOVE ML022-SALE-EXTD-RTL-AMT   TO DT2-EXTD-RTL-AMT           32480016
W28582     MOVE ML022-SALE-ENT-ID         TO DT2-ENT-ID                 32490016
W28582     MOVE ML022-SALE-LBL-SEQ-NBR    TO DT2-LBL-SEQ-NBR            32500016
W28582     MOVE ML022-SALE-ML-LWST-ID     TO DT2-ML-LWST-ID.            32510016
W28582******************************************************************32520016
W28582* 9203-MOVE-PCHG-DETAIL                                           32530016
W28582******************************************************************32540016
W28582 9203-MOVE-PCHG-DETAIL.                                           32550016
W28582     MOVE ML029-PC-SYST-ORIG-CDE    TO DT3-SYST-ORIG-CDE          32560016
W28582     MOVE ML029-PC-TRANS-CDE        TO DT3-PC-TRANS-CDE           32570016
W28582     MOVE ML029-PC-AP-TRANS-CDE     TO DT3-AP-TRANS-CDE           32580016
W28582     MOVE ML029-PC-SKU              TO DT3-SKU                    32590016
W28582     MOVE ML029-PC-STORE-NBR        TO DT3-LOC                    32600016
W28582     MOVE ML029-PC-DEPT-NBR         TO DT3-DEPT                   32610016
W28582     MOVE ML029-PC-EXTD-RTL-AMT     TO DT3-EXTD-RTL-AMT           32620016
W28582     MOVE ML029-PC-OLD-PR-AMT       TO DT3-OLD-PR-AMT             32630016
W28582     MOVE ML029-PC-NEW-PR-AMT       TO DT3-NEW-PR-AMT             32640016
W28582     MOVE ML029-PC-ENT-ID           TO DT3-ENT-ID                 32650016
W28582     MOVE ML029-PC-LBL-SEQ-NBR      TO DT3-LBL-SEQ-NBR            32660016
W28582     MOVE ML029-PC-ML-LWST-ID       TO DT3-ML-LWST-ID.            32670016
W28582******************************************************************32680016
W28582* 9204-MOVE-ADJ-DETAIL                                            32690016
W28582******************************************************************32700016
W28582 9204-MOVE-ADJ-DETAIL.                                            32710016
W28582     MOVE ML024-ADJ-SYST-ORIG-CDE   TO DT4-SYST-ORIG-CDE          32720016
W28582     MOVE ML024-ADJ-SKU             TO DT4-SKU                    32730016
W28582     MOVE ML024-ADJ-STORE-NBR       TO DT4-LOC                    32740016
W28582     MOVE ML024-ADJ-DEPT-NBR        TO DT4-DEPT                   32750016
W28582     MOVE ML024-ADJ-ENT-ID          TO DT4-ENT-ID                 32760016
W28582     MOVE ML024-ADJ-LBL-SEQ-NBR     TO DT4-LBL-SEQ-NBR            32770016
W28582     MOVE ML024-ADJ-ML-LWST-ID      TO DT4-ML-LWST-ID.            32780016
W28582******************************************************************32790016
W28582* 9300-WRITE-SALES-DETAIL-OUT                                     32800016
W28582******************************************************************32810016
W28582 9300-WRITE-SALES-DETAIL-OUT.                                     32820016
W28582     IF PV-LINE-COUNTER < 51                                      32830016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          32840016
W28582        PERFORM 9302-MOVE-SALES-DETAIL-OUT                        32850016
W28582        WRITE BV-SALE-AUDIT-REC FROM DT2-SALES-DETAIL             32860016
W28582            AFTER ADVANCING 1 LINES                               32870016
W28582        ADD 1 TO PV-LINE-COUNTER                                  32880016
W28582     ELSE                                                         32890016
W28582        PERFORM 9200-WRITE-SALES-REPORT                           32900016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          32910016
W28582        PERFORM 9302-MOVE-SALES-DETAIL-OUT                        32920016
W28582        ADD 2 TO PV-LINE-COUNTER                                  32930016
W28582        WRITE BV-SALE-AUDIT-REC FROM DT2-SALES-DETAIL             32940016
W28582            AFTER ADVANCING 1 LINES                               32950016
W28582     END-IF.                                                      32960016
W28582******************************************************************32970016
W28582* 9300-WRITE-ADJ-DETAIL-OUT                                       32980016
W28582******************************************************************32990016
W28582 9300-WRITE-ADJ-DETAIL-OUT.                                       33000016
W28582     IF PV-LINE-COUNTER < 51                                      33010016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           33020016
W28582        PERFORM 9304-MOVE-ADJ-DETAIL-OUT                          33030016
W28582        WRITE BV-ADJ-AUDIT-REC FROM DT4-ADJ-DETAIL                33040016
W28582            AFTER ADVANCING 1 LINES                               33050016
W28582        ADD 1 TO PV-LINE-COUNTER                                  33060016
W28582     ELSE                                                         33070016
W28582        PERFORM 9200-WRITE-ADJ-REPORT                             33080016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           33090016
W28582        PERFORM 9304-MOVE-ADJ-DETAIL-OUT                          33100016
W28582        ADD 2 TO PV-LINE-COUNTER                                  33110016
W28582        WRITE BV-ADJ-AUDIT-REC FROM DT4-ADJ-DETAIL                33120016
W28582            AFTER ADVANCING 1 LINES                               33130016
W28582     END-IF.                                                      33140016
W28582******************************************************************33150016
W28582* 9300-WRITE-PURCH-DETAIL-OUT                                     33160016
W28582******************************************************************33170016
W28582 9300-WRITE-PURCH-DETAIL-OUT.                                     33180016
W28582     IF PV-LINE-COUNTER < 51                                      33190016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         33200016
W28582        PERFORM 9301-MOVE-PURCH-DETAIL-OUT                        33210016
W28582        WRITE BV-PURCH-AUDIT-REC FROM DT1-PURCH-DETAIL            33220016
W28582            AFTER ADVANCING 1 LINES                               33230016
W28582        ADD 1 TO PV-LINE-COUNTER                                  33240016
W28582     ELSE                                                         33250016
W28582        PERFORM 9200-WRITE-PURCH-REPORT                           33260016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         33270016
W28582        PERFORM 9301-MOVE-PURCH-DETAIL-OUT                        33280016
W28582        ADD 2 TO PV-LINE-COUNTER                                  33290016
W28582        WRITE BV-PURCH-AUDIT-REC FROM DT1-PURCH-DETAIL            33300016
W28582            AFTER ADVANCING 1 LINES                               33310016
W28582     END-IF.                                                      33320016
W28582******************************************************************33330016
W28582* 9300-WRITE-PCHG-DETAIL-OUT                                      33340016
W28582******************************************************************33350016
W28582 9300-WRITE-PCHG-DETAIL-OUT.                                      33360016
W28582     IF PV-LINE-COUNTER < 51                                      33370016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          33380016
W28582        PERFORM 9303-MOVE-PCHG-DETAIL-OUT                         33390016
W28582        WRITE BV-PCHG-AUDIT-REC FROM DT3-PCHG-DETAIL              33400016
W28582            AFTER ADVANCING 1 LINES                               33410016
W28582        ADD 1 TO PV-LINE-COUNTER                                  33420016
W28582     ELSE                                                         33430016
W28582        PERFORM 9200-WRITE-PCHG-REPORT                            33440016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          33450016
W28582        PERFORM 9303-MOVE-PCHG-DETAIL-OUT                         33460016
W28582        ADD 2 TO PV-LINE-COUNTER                                  33470016
W28582        WRITE BV-PCHG-AUDIT-REC FROM DT3-PCHG-DETAIL              33480016
W28582            AFTER ADVANCING 1 LINES                               33490016
W28582     END-IF.                                                      33500016
W28582******************************************************************33510016
W28582* 9301-MOVE-PURCH-DETAIL-OUT                                      33520016
W28582******************************************************************33530016
W28582 9301-MOVE-PURCH-DETAIL-OUT.                                      33540016
W28582     MOVE SPACES TO DT1-SYST-ORIG-CDE                             33550016
W28582                    DT1-PURCH-TRANS-CDE                           33560016
W28582                    DT1-AP-TRANS-CDE                              33570016
W28582                    DT1-SKU                                       33580016
W28582                    DT1-LOC                                       33590016
W28582                    DT1-DEPT.                                     33600016
W28582     MOVE PAOUT-PURCH-EXTD-GRO-COST-AMT                           33610016
W28582                                    TO DT1-GROSS-COST-AMT         33620016
W28582     MOVE PAOUT-PURCH-FRGT-AMT      TO DT1-FRGT-AMT               33630016
W28582     MOVE PAOUT-PURCH-DISC-AMT      TO DT1-DISC-AMT               33640016
W28582     MOVE PAOUT-PURCH-EXTD-NET-COST-AMT                           33650016
W28582                                    TO DT1-NET-COST-AMT           33660016
W28582     MOVE PAOUT-PURCH-EXTD-RTL-AMT  TO DT1-EXTD-RTL-AMT           33670016
W28582     MOVE PAOUT-PURCH-PER-UNT-RTL-AMT                             33680016
W28582                                    TO DT1-UNT-RTL-AMT            33690016
W28582     MOVE PAOUT-PURCH-ENT-ID        TO DT1-ENT-ID                 33700016
W28582     MOVE PAOUT-PURCH-LBL-SEQ-NBR   TO DT1-LBL-SEQ-NBR            33710016
W28582     MOVE PAOUT-PURCH-ML-LWST-ID    TO DT1-ML-LWST-ID.            33720016
W28582******************************************************************33730016
W28582* 9302-MOVE-SALES-DETAIL-OUT                                      33740016
W28582******************************************************************33750016
W28582 9302-MOVE-SALES-DETAIL-OUT.                                      33760016
W28582     MOVE SPACES TO DT2-SKU                                       33770016
W28582                    DT2-LOC                                       33780016
W28582                    DT2-DEPT.                                     33790016
W28582     MOVE SLOUT-SALE-EXTD-RTL-AMT   TO DT2-EXTD-RTL-AMT.          33800016
W28582     MOVE SLOUT-SALE-ENT-ID         TO DT2-ENT-ID.                33810016
W28582     MOVE SLOUT-SALE-LBL-SEQ-NBR    TO DT2-LBL-SEQ-NBR.           33820016
W28582     MOVE SLOUT-SALE-ML-LWST-ID     TO DT2-ML-LWST-ID.            33830016
W28582******************************************************************33840016
W28582* 9303-MOVE-PCHG-DETAIL-OUT                                       33850016
W28582******************************************************************33860016
W28582 9303-MOVE-PCHG-DETAIL-OUT.                                       33870016
W28582     MOVE SPACES TO DT3-SYST-ORIG-CDE                             33880016
W28582                    DT3-PC-TRANS-CDE                              33890016
W28582                    DT3-AP-TRANS-CDE                              33900016
W28582                    DT3-SKU                                       33910016
W28582                    DT3-LOC                                       33920016
W28582                    DT3-DEPT.                                     33930016
W28582     MOVE PCOUT-PC-EXTD-RTL-AMT     TO DT3-EXTD-RTL-AMT.          33940016
W28582     MOVE PCOUT-PC-OLD-PR-AMT       TO DT3-OLD-PR-AMT.            33950016
W28582     MOVE PCOUT-PC-NEW-PR-AMT       TO DT3-NEW-PR-AMT.            33960016
W28582     MOVE PCOUT-PC-ENT-ID           TO DT3-ENT-ID.                33970016
W28582     MOVE PCOUT-PC-LBL-SEQ-NBR      TO DT3-LBL-SEQ-NBR.           33980016
W28582     MOVE PCOUT-PC-ML-LWST-ID       TO DT3-ML-LWST-ID.            33990016
W28582******************************************************************34000016
W28582* 9304-MOVE-ADJ-DETAIL-OUT                                        34010016
W28582******************************************************************34020016
W28582 9304-MOVE-ADJ-DETAIL-OUT.                                        34030016
W28582     MOVE SPACES TO DT4-SYST-ORIG-CDE                             34040016
W28582                    DT4-SKU                                       34050016
W28582                    DT4-LOC                                       34060016
W28582                    DT4-DEPT.                                     34070016
W28582     MOVE IAOUT-ADJ-ENT-ID          TO DT4-ENT-ID.                34080016
W28582     MOVE IAOUT-ADJ-LBL-SEQ-NBR     TO DT4-LBL-SEQ-NBR.           34090016
W28582     MOVE IAOUT-ADJ-ML-LWST-ID      TO DT4-ML-LWST-ID.            34100016
W28582******************************************************************34110016
W28582*    WRITE A RECORD TO THE PURCH OUTPUT FILE.                     34120016
W28582******************************************************************34130016
W28582 9400-WRITE-PURCH-REC.                                            34140016
W28582     ADD 1 TO PV-TOT-EDIT-PURCH-RECS-OUT.                         34150016
W28582     WRITE BV-PURCH-REC                                           34160016
W28582         FROM PAOUT-PURCH-RECORD.                                 34170016
W28582     PERFORM 9300-WRITE-PURCH-DETAIL-OUT.                         34180016
W28582     PERFORM 9807-CKPT-LOGIC.                                     34190016
W28582     IF PS-RESTART-RUN                                            34200016
W28582        IF PV-RESTART-COUNT > 1                                   34210016
W28582           CONTINUE                                               34220016
W28582        ELSE                                                      34230016
W28582           DISPLAY PV-RESTART-COUNT                               34240016
W28582           DISPLAY 'RESTARTING ... OUTPUT FROM FIRST REC READ'    34250016
W28582           DISPLAY PAOUT-PURCH-RECORD                             34260016
W28582        END-IF                                                    34270016
W28582     END-IF.                                                      34280016
W28582                                                                  34290016
W28582******************************************************************34300016
W28582*    WRITE A RECORD TO THE SALE OUTPUT FILE.                      34310016
W28582******************************************************************34320016
W28582 9500-WRITE-SALE-REC.                                             34330016
W28582     ADD 1 TO PV-TOT-EDIT-SALE-RECS-OUT.                          34340016
W28582     WRITE BV-SALE-REC                                            34350016
W28582         FROM SLOUT-SALE-RECORD.                                  34360016
W28582     PERFORM 9300-WRITE-SALES-DETAIL-OUT.                         34370016
W28582     PERFORM 9807-CKPT-LOGIC.                                     34380016
W28582     IF PS-RESTART-RUN                                            34390016
W28582        IF PV-RESTART-COUNT > 1                                   34400016
W28582           CONTINUE                                               34410016
W28582        ELSE                                                      34420016
W28582           DISPLAY PV-RESTART-COUNT                               34430016
W28582           DISPLAY 'RESTARTING ... OUTPUT FROM FIRST REC READ'    34440016
W28582           DISPLAY SLOUT-SALE-RECORD                              34450016
W28582        END-IF                                                    34460016
W28582     END-IF.                                                      34470016
W28582                                                                  34480016
W28582******************************************************************34490016
W28582*    WRITE A RECORD TO THE PRICE CHANGE OUTPUT FILE.              34500016
W28582******************************************************************34510016
W28582 9600-WRITE-PCHG-REC.                                             34520016
W28582     ADD 1 TO PV-TOT-EDIT-PCHG-RECS-OUT.                          34530016
W28582     WRITE BV-PRC-CHG-REC                                         34540016
W28582         FROM PCOUT-PC-RECORD.                                    34550016
W28582     PERFORM 9300-WRITE-PCHG-DETAIL-OUT.                          34560016
W28582     PERFORM 9807-CKPT-LOGIC.                                     34570016
W28582     IF PS-RESTART-RUN                                            34580016
W28582        IF PV-RESTART-COUNT > 1                                   34590016
W28582           CONTINUE                                               34600016
W28582        ELSE                                                      34610016
W28582           DISPLAY PV-RESTART-COUNT                               34620016
W28582           DISPLAY 'RESTARTING ... OUTPUT FROM FIRST REC READ'    34630016
W28582           DISPLAY PCOUT-PC-RECORD                                34640016
W28582        END-IF                                                    34650016
W28582     END-IF.                                                      34660016
W28582                                                                  34670016
W28582******************************************************************34680016
W28582*    WRITE A RECORD TO THE INVENTORY ADJUSTMENT OUTPUT FILE.      34690016
W28582******************************************************************34700016
W28582 9700-WRITE-ADJ-REC.                                              34710016
W28582     ADD 1 TO PV-TOT-EDIT-ADJ-RECS-OUT.                           34720016
W28582     WRITE BV-ADJUSTMENT-REC                                      34730016
W28582         FROM IAOUT-ADJ-RECORD.                                   34740016
W28582     PERFORM 9300-WRITE-ADJ-DETAIL-OUT.                           34750016
W28582     PERFORM 9807-CKPT-LOGIC.                                     34760016
W28582     IF PS-RESTART-RUN                                            34770016
W28582        IF PV-RESTART-COUNT > 1                                   34780016
W28582           CONTINUE                                               34790016
W28582        ELSE                                                      34800016
W28582           DISPLAY PV-RESTART-COUNT                               34810016
W28582           DISPLAY 'RESTARTING ... OUTPUT FROM FIRST REC READ'    34820016
W28582           DISPLAY IAOUT-ADJ-RECORD                               34830016
W28582        END-IF                                                    34840016
W28582     END-IF.                                                      34850016
W28582                                                                  34860016
      ******************************************************************34870016
      *  ABEND CALL FOR ERRORS RETURNED BY BRAND VENDOR LOOKUP UTILITY  34880016
      ******************************************************************34890016
       9997-BV-LOOKUP-ERROR.                                            34900016
           DISPLAY '***************************************************'34910016
           DISPLAY BV003-PV-RETURN-MSG-1                                34920016
           DISPLAY '***************************************************'34930016
           DISPLAY BV003-PV-RETURN-MSG-2                                34940016
           DISPLAY '***************************************************'34950016
           IF BV003-PV-SQL-ERROR                                        34960016
              MOVE BV003-PV-SQLCODE-OUT TO PV-SQLCODE                   34970016
              MOVE PV-SQLCODE TO PV-SQLCODE-DISP                        34980016
              DISPLAY 'SQL CODE = ' PV-SQLCODE-DISP                     34990016
              PERFORM 9998-SQL-ABEND                                    35000016
           ELSE                                                         35010016
              PERFORM 9999-OTHER-ABEND                                  35020016
           END-IF.                                                      35030016
W28582******************************************************************35040016
W28582* SELECT CHECKPOINT RESTART CONTROL VALUE TO SEE IF THIS RUN     *35050016
W28582* IS NORMAL (0) OR A RESTART (9).                                *35060016
W28582******************************************************************35070016
W28582 9800-GET-CHECKPOINT-CNTL.                                        35080016
W28582                                                                  35090016
W28582     PERFORM WITH TEST AFTER                                      35100016
W28582             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 35110016
W28582             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         35120016
W28582                     SQLCODE = ZERO                               35130016
W28582                                                                  35140016
W28582       EXEC SQL                                                   35150016
W28582        SELECT CKPT_STAT_CODE                                     35160016
W28582         INTO :PV-CKPT-STAT-CODE                                  35170016
W28582         FROM TCKRSTCNTL                                          35180016
W28582         WHERE JOB_NAME = :PC-JOB-NAME AND                        35190016
W28582               PLAN_NAME = :PC-PGM-NAME                           35200016
W28582       END-EXEC                                                   35210016
W28582                                                                  35220016
W28582       EVALUATE TRUE                                              35230016
W28582           WHEN SQLWARN0 NOT EQUAL SPACE                          35240016
W28582           WHEN SQLCODE NOT EQUAL ZERO                            35250016
W28582               DISPLAY '*****************************************'35260016
W28582               DISPLAY '** ABEND                               **'35270016
W28582               DISPLAY '** PROGRAM = MLKUP358                  **'35280016
W28582               DISPLAY '** PARAGRAPH = 9800-GET-CHECKPOINT-CNTL**'35290016
W28582               DISPLAY '** CHECKING IF RUN IS NORMAL OR RESTART**'35300016
W28582               DISPLAY '*****************************************'35310016
W28582               PERFORM 9998-SQL-ABEND                             35320016
W28582       END-EVALUATE                                               35330016
W28582     END-PERFORM.                                                 35340016
W28582                                                                  35350016
W28582     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    35360016
W28582         SQLCODE NOT = ZERO                                       35370016
W28582         DISPLAY '****************************************'       35380016
W28582         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       35390016
W28582         DISPLAY '** SELECT TCKRSTCNTL                  **'       35400016
W28582         DISPLAY '** PARAGRAPH = 9800-GET-CHECKPOINT-CNTL*'       35410016
W28582         DISPLAY '****************************************'       35420016
W28582         PERFORM 9998-SQL-ABEND                                   35430016
W28582     END-IF.                                                      35440016
W28582                                                                  35450016
W28582******************************************************************35460016
W28582* THIS WILL INITIALIZE THE WORKING STORAGE DESC TEXT THAT IS      35470016
W28582* UPDATED DURING A NORMAL PROGRAM RUN AND USED TO RESTART IN CASE 35480016
W28582* OF AN ABEND. THIS PARAGRAPH IS ONLY EXECUTED DURING A NORMAL RUN35490016
W28582******************************************************************35500016
W28582 9801-INITIALIZE-TCKRSTINF.                                       35510016
W28582                                                                  35520016
W28582     MOVE SPACES TO CKPT-RESTART-INFO.                            35530016
W28582     PERFORM 9806-UPDATE-TCKRSTINF.                               35540016
W28582                                                                  35550016
W28582******************************************************************35560016
W28582* CHECKPOINT-RESTART                                             *35570016
W28582* RETRIEVE THE WORKING STORAGE FIELDS FROM THE DB2 TABLE, THEN   *35580016
W28582* MOVE THE STORED ACCUMULATOR VALUES BACK TO WORKING STORAGE     *35590016
W28582* BEFORE THE PROCESSING FOR THE RESTART CONTINUES. THIS IS DONE  *35600016
W28582* SO THE REPORT STATISTICS IN THE SYSOUT ARE ACCURATE AFTER A    *35610016
W28582* RESTART IS DONE, OTHERWISE THE SYSOUT WOULD ONLY REFLECT WHAT  *35620016
W28582* WAS PROCESSED FROM THE RESTART POINT.                          *35630016
W28582******************************************************************35640016
W28582 9802-CHECKPOINT-RESTART.                                         35650016
W28582                                                                  35660016
W28582     PERFORM 9803-GET-CHECKPOINT-WK-STORG.                        35670016
W28582     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO CKPT-RESTART-INFO.     35680016
W28582                                                                  35690016
W28582*RE-LOAD THE STAT VARIABLES FROM TCKRSTINF WORK STORAGE           35700016
W28582*SO THE PROPER STATISTICS WILL BE DISPLAYED UPON PGM COMPLETION.  35710016
W28582                                                                  35720016
W28582     MOVE CKPT-EDIT-ADJ-RECS-IN    TO PV-TOT-EDIT-ADJ-RECS-IN.    35730016
W28582     MOVE CKPT-EDIT-PCHG-RECS-IN   TO PV-TOT-EDIT-PCHG-RECS-IN.   35740016
W28582     MOVE CKPT-EDIT-PURCH-RECS-IN  TO PV-TOT-EDIT-PURCH-RECS-IN.  35750016
W28582     MOVE CKPT-EDIT-SALE-RECS-IN   TO PV-TOT-EDIT-SALE-RECS-IN.   35760016
W28582     MOVE CKPT-EDIT-ADJ-RECS-OUT   TO PV-TOT-EDIT-ADJ-RECS-OUT.   35770016
W28582     MOVE CKPT-EDIT-PCHG-RECS-OUT  TO PV-TOT-EDIT-PCHG-RECS-OUT.  35780016
W28582     MOVE CKPT-EDIT-PURCH-RECS-OUT TO PV-TOT-EDIT-PURCH-RECS-OUT. 35790016
W28582     MOVE CKPT-EDIT-SALE-RECS-OUT  TO PV-TOT-EDIT-SALE-RECS-OUT.  35800016
W28582                                                                  35810016
W28582******************************************************************35820016
W28582*    SELECT CHECKPOINT RESTART WORKING STORAGE INFORMATION.       35830016
W28582*    THIS FIELD ON THE DCLGEN IS LVC. IT HAS A LENGTH OF 4022.    35840016
W28582******************************************************************35850016
W28582 9803-GET-CHECKPOINT-WK-STORG.                                    35860016
W28582                                                                  35870016
W28582     PERFORM WITH TEST AFTER                                      35880016
W28582             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 35890016
W28582             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         35900016
W28582                     SQLCODE = ZERO                               35910016
W28582                                                                  35920016
W28582       EXEC SQL                                                   35930016
W28582        SELECT WORK_STRG_DESC                                     35940016
W28582         INTO :TCKRSTINF-WORK-STRG-DESC                           35950016
W28582         FROM TCKRSTINF                                           35960016
W28582        WHERE JOB_NAME = :PC-JOB-NAME   AND                       35970016
W28582              PLAN_NAME = :PC-PGM-NAME                            35980016
W28582       END-EXEC                                                   35990016
W28582                                                                  36000016
W28582       EVALUATE TRUE                                              36010016
W28582           WHEN SQLWARN0 NOT EQUAL SPACE                          36020016
W28582           WHEN SQLCODE NOT EQUAL ZERO                            36030016
W28582             DISPLAY '******************************************' 36040016
W28582             DISPLAY '* ABEND                                   ' 36050016
W28582             DISPLAY '* PROGRAM = MLKUP358                      ' 36060016
W28582             DISPLAY '* PARAGRAPH = 9803-GET-CHECKPOINT-WK-STORG' 36070016
W28582             DISPLAY '* GETTING RESTART WORKING STORAGE INFO    ' 36080016
W28582             DISPLAY '******************************************' 36090016
W28582             PERFORM 9998-SQL-ABEND                               36100016
W28582       END-EVALUATE                                               36110016
W28582     END-PERFORM.                                                 36120016
W28582                                                                  36130016
W28582     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    36140016
W28582         SQLCODE NOT = ZERO                                       36150016
W28582         DISPLAY '****************************************'       36160016
W28582         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       36170016
W28582         DISPLAY '** SELECT TCKRSTINF                   **'       36180016
W28582         DISPLAY '** PARAGRAPH = 9803-GET-CHECKPOINT-WK-STORG'    36190016
W28582         DISPLAY '****************************************'       36200016
W28582         PERFORM 9998-SQL-ABEND                                   36210016
W28582     END-IF.                                                      36220016
W28582                                                                  36230016
W28582******************************************************************36240016
W28582*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *36250016
W28582*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *36260016
W28582******************************************************************36270016
W28582 9804-UPDATE-TCKRSTCNTL.                                          36280016
W28582                                                                  36290016
W28582     PERFORM WITH TEST AFTER                                      36300016
W28582             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 36310016
W28582             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         36320016
W28582                     SQLCODE = ZERO                               36330016
W28582                                                                  36340016
W28582       EXEC SQL                                                   36350016
W28582         UPDATE TCKRSTCNTL                                        36360016
W28582         SET CKPT_STAT_CODE   = :PV-CKPT-STAT-CODE                36370016
W28582         WHERE JOB_NAME       = :PC-JOB-NAME AND                  36380016
W28582               PLAN_NAME      = :PC-PGM-NAME                      36390016
W28582       END-EXEC                                                   36400016
W28582                                                                  36410016
W28582       EVALUATE TRUE                                              36420016
W28582           WHEN SQLWARN0 NOT EQUAL SPACE                          36430016
W28582           WHEN SQLCODE NOT EQUAL ZERO                            36440016
W28582               DISPLAY '****************************************' 36450016
W28582               DISPLAY '** ABEND                              **' 36460016
W28582               DISPLAY '** PROGRAM = MLKUP358                 **' 36470016
W28582               DISPLAY '** PARAGRAPH = 9804-UPDATE-TCKRSTCNTL **' 36480016
W28582               DISPLAY '** UPDATING CKPT STAT CODE            **' 36490016
W28582               DISPLAY '****************************************' 36500016
W28582               PERFORM 9998-SQL-ABEND                             36510016
W28582       END-EVALUATE                                               36520016
W28582     END-PERFORM.                                                 36530016
W28582                                                                  36540016
W28582     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    36550016
W28582         SQLCODE NOT = ZERO                                       36560016
W28582         DISPLAY '****************************************'       36570016
W28582         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       36580016
W28582         DISPLAY '** UPDATE TCKRSTCNTL                  **'       36590016
W28582         DISPLAY '** PARAGRAPH = 9804-UPDATE-TCKRSTCNTL **'       36600016
W28582         DISPLAY '****************************************'       36610016
W28582         PERFORM 9998-SQL-ABEND                                   36620016
W28582     END-IF.                                                      36630016
W28582                                                                  36640016
W28582******************************************************************36650016
W28582* THE DATA FROM THESE FIELDS WILL BE STORED IN THE CHECKPOINT    *36660016
W28582* RESTART INFO DESC.                                              36670016
W28582******************************************************************36680016
W28582 9805-SAVE-DATA-FOR-RESTART.                                      36690016
W28582     MOVE PV-REC-TYPE-IN             TO CKPT-REC-TYPE.            36700016
W28582     MOVE PV-TOT-EDIT-ADJ-RECS-IN    TO CKPT-EDIT-ADJ-RECS-IN.    36710016
W28582     MOVE PV-TOT-EDIT-PCHG-RECS-IN   TO CKPT-EDIT-PCHG-RECS-IN.   36720016
W28582     MOVE PV-TOT-EDIT-PURCH-RECS-IN  TO CKPT-EDIT-PURCH-RECS-IN.  36730016
W28582     MOVE PV-TOT-EDIT-SALE-RECS-IN   TO CKPT-EDIT-SALE-RECS-IN.   36740016
W28582     MOVE PV-TOT-EDIT-ADJ-RECS-OUT   TO CKPT-EDIT-ADJ-RECS-OUT.   36750016
W28582     MOVE PV-TOT-EDIT-PCHG-RECS-OUT  TO CKPT-EDIT-PCHG-RECS-OUT.  36760016
W28582     MOVE PV-TOT-EDIT-PURCH-RECS-OUT TO CKPT-EDIT-PURCH-RECS-OUT. 36770016
W28582     MOVE PV-TOT-EDIT-SALE-RECS-OUT  TO CKPT-EDIT-SALE-RECS-OUT.  36780016
W28582                                                                  36790016
W28582******************************************************************36800016
W28582*  UPDATES THE CHECKPOINT RESTART INFORMATION TABLE.  THIS        36810016
W28582*  INFORMATION WOULD BE USED TO RESTART JOB IN CASE OF AN ABEND  *36820016
W28582******************************************************************36830016
W28582 9806-UPDATE-TCKRSTINF.                                           36840016
W28582                                                                  36850016
W28582     MOVE CKPT-RESTART-INFO    TO TCKRSTINF-WORK-STRG-DESC-TEXT.  36860016
W28582     MOVE 4022                 TO TCKRSTINF-WORK-STRG-DESC-LEN.   36870016
W28582                                                                  36880016
W28582     PERFORM WITH TEST AFTER                                      36890016
W28582             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 36900016
W28582             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         36910016
W28582                     SQLCODE = ZERO                               36920016
W28582                                                                  36930016
W28582       EXEC SQL                                                   36940016
W28582          UPDATE TCKRSTINF                                        36950016
W28582           SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC       36960016
W28582           WHERE JOB_NAME       = :PC-JOB-NAME AND                36970016
W28582                 PLAN_NAME      = :PC-PGM-NAME                    36980016
W28582       END-EXEC                                                   36990016
W28582                                                                  37000016
W28582       EVALUATE TRUE                                              37010016
W28582           WHEN SQLCODE EQUAL ZERO                                37020016
W28582              CONTINUE                                            37030016
W28582           WHEN SQLWARN0 NOT EQUAL SPACE                          37040016
W28582           WHEN SQLCODE NOT EQUAL ZERO                            37050016
W28582               DISPLAY '*****************************************'37060016
W28582               DISPLAY '** ABEND                                 '37070016
W28582               DISPLAY '** PROGRAM = MLKUP358                    '37080016
W28582               DISPLAY '** PARAGRAPH = 9806-UPDATE-TCKRSTINF     '37090016
W28582               DISPLAY '** UNSUCCESSFUL UPDATE TCKRSTINF         '37100016
W28582               DISPLAY '*****************************************'37110016
W28582               PERFORM 9998-SQL-ABEND                             37120016
W28582       END-EVALUATE                                               37130016
W28582     END-PERFORM.                                                 37140016
W28582                                                                  37150016
W28582     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    37160016
W28582         SQLCODE NOT = ZERO                                       37170016
W28582         DISPLAY '****************************************'       37180016
W28582         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       37190016
W28582         DISPLAY '** UPDATE TO TCKRSTINF                **'       37200016
W28582         DISPLAY '** PARAGRAPH = 9806-UPDATE-TCKRSTINF  **'       37210016
W28582         DISPLAY '****************************************'       37220016
W28582         PERFORM 9998-SQL-ABEND                                   37230016
W28582     END-IF.                                                      37240016
W28582******************************************************************37250016
W28582* SAVE THE CURRENT SUMMARY STATISTICS TO BE USED TO RE-POPULATE  *37260016
W28582* VARIABLES AFTER RESTART. UPDATE THE CHECKPOINT RESTART INFOR-  *37270016
W28582* MATION WORKING STORAGE DESCRIPTION TEXT.                       *37280016
W28582******************************************************************37290016
W28582 9807-CKPT-LOGIC.                                                 37300016
W28582                                                                  37310016
W28582     ADD +1 TO PV-RECS-PROC-FOR-CKPT.                             37320016
W28582                                                                  37330016
W28582     IF PV-RECS-PROC-FOR-CKPT > PC-CKPT-INTERVAL                  37340016
W28582*SAVE CKPT DATA                                                   37350016
W28582         PERFORM 9805-SAVE-DATA-FOR-RESTART                       37360016
W28582*PLACE CKPT DATA IN RESTART TABLE                                 37370016
W28582         PERFORM 9806-UPDATE-TCKRSTINF                            37380016
W28582*COMMIT                                                           37390016
W28582         PERFORM 8200-COMMIT                                      37400016
W28582         MOVE ZEROS TO PV-RECS-PROC-FOR-CKPT                      37410016
W28582         ADD +1 TO PV-CKPT-TAKEN-CNT                              37420016
W28582*LEAVE DISPLAY IN PROGRAM                                         37430016
W28582         DISPLAY 'PV-CKPT-TAKEN-CNT ' PV-CKPT-TAKEN-CNT           37440016
W28582     END-IF.                                                      37450016
W28582                                                                  37460016
W28582                                                                  37470016
      ******************************************************************37480016
      *  STANDARD DB2 ERROR ABEND ROUTINE                               37490016
      *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.             37500016
      ******************************************************************37510016
       9998-SQL-ABEND.                                                  37520016
           DISPLAY '*************************************************'  37530016
           DISPLAY 'TOT ADJ RECS IN        ' PV-TOT-EDIT-ADJ-RECS-IN    37540016
           DISPLAY 'TOT PRICE CHG RECS IN  ' PV-TOT-EDIT-PCHG-RECS-IN   37550016
           DISPLAY 'TOT PURCH RECORDS IN   ' PV-TOT-EDIT-PURCH-RECS-IN  37560016
           DISPLAY 'TOT SALE RECORDS IN    ' PV-TOT-EDIT-SALE-RECS-IN   37570016
           DISPLAY '*************************************************'  37580016
                                                                        37590016
           SET AC-SQL-ERROR           TO TRUE.                          37600016
           DISPLAY '**  ABEND     **'.                                  37610016
           DISPLAY '**  PROGRAM   **  = ' PC-PGM-NAME.                  37620016
                                                                        37630016
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         37640016
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        37650016
                                                                        37660016
           COPY DPPD004.                                                37670016
                                                                        37680016
           CALL 'ILBOABN0'  USING ABEND-CODE.                           37690016
                                                                        37700016
      ******************************************************************37710016
      * DO THE NECESSARY PROCESSING TO ABEND FOR MISCELLANEOUS REASONS.*37720016
      ******************************************************************37730016
       9999-OTHER-ABEND.                                                37740016
           DISPLAY '*************************************************'  37750016
           DISPLAY 'TOT ADJ RECS IN        ' PV-TOT-EDIT-ADJ-RECS-IN    37760016
           DISPLAY 'TOT PRICE CHG RECS IN  ' PV-TOT-EDIT-PCHG-RECS-IN   37770016
           DISPLAY 'TOT PURCH RECORDS IN   ' PV-TOT-EDIT-PURCH-RECS-IN  37780016
           DISPLAY 'TOT SALE RECORDS IN    ' PV-TOT-EDIT-SALE-RECS-IN   37790016
           DISPLAY '*************************************************'  37800016
           SET AC-OTHER-ERROR TO TRUE.                                  37810016
           DISPLAY '**  ABEND     **'.                                  37820016
           DISPLAY '**  PROGRAM   **  = ' PC-PGM-NAME.                  37830016
           DISPLAY '************************************************'.  37840016
           CALL 'ILBOABN0' USING ABEND-CODE.                            37850016
                                                                        37860016
W28582******************************************************************37870016
W28582* PRICING MODULE CODE                                             37880016
W28582******************************************************************37890016
W31475*    COPY INPD400.                                                37900016
W31475     COPY INPD402.                                                37910016
