000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.      SSKRP025.                                       00030000
000400 AUTHOR.          JIM HUNTER.                                     00040000
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050000
000600 DATE-WRITTEN.    12/07/2006.                                     00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000*  MODULE TYPE:   COBOL2 BATCH                                    00100007
001100*                                                                 00110000
001200*  DESCRIPTION: CREATES THE DAILY GEOGRAPHIC SALES REPORT         00120000
001300*               FROM AN EXTRACT FILE CREATED BY SSKUT025,         00130000
001400*               WHICH IS SORTED IN THE FOLLOWING SEQUENCE:        00140000
001500*               (SALES REFLECT THIS YEAR'S TOTAL SALES)           00150000
001600*               1) STATE NAME                                     00160000
001700*               2) DESCENDING METRO SALES                         00170000
001800*               3) METRO NAME (FOR TIES IN METRO SALES)           00180000
001900*               4) DESCENDING STORE SALES                         00190000
002000*               5) STORE NAME (FOR TIES IN STORE SALES)           00200000
002100*                                                                 00210000
002200*========================== CHANGE LOG ===========================00220000
002300*  AUTH       BY         DATE                 DESCRIPTION         00230000
002400*=================================================================00240000
002500* WR        J.HUNTER   12-07-06   COPIED FROM SSKRP025 -          00250000
002600*                                 ADD COMP STORE LOGIC, NEW SORT  00260000
002610*                                 SEQ, AND YTD FIELDS             00261000
002500* WR        J.HUNTER   01-08-07   REMOVE ECOM FROM STATE TOTALS   00262001
002600*                                 AND LIST IT INDEPENDANTLY AFTER 00263000
002610*                                 THE STATES AND BEFORE THE       00264000
002610*                                 COMPANY TOTALS.                 00265000
002500* WR        J.HUNTER   01-12-07   ADD 53 WEEK PROCESSING.         00266001
002600*                                 ALL DAILY PERCENTS = N/A        00267001
002610*                                 IF 53 WEEK IND IS 'Y', PRINT    00268001
002610*                                 '(COMPARE BY CALENDAR WEEK)'    00269001
002610*                                 IN THE REPORT HEADING.          00269101
002700******************************************************************00270000
002800                                                                  00280000
002900 ENVIRONMENT DIVISION.                                            00290000
003000 CONFIGURATION SECTION.                                           00300000
003100                                                                  00310000
003200 SOURCE-COMPUTER.        IBM-3090.                                00320000
003300 OBJECT-COMPUTER.        IBM-3090.                                00330000
003400                                                                  00340000
003500 INPUT-OUTPUT SECTION.                                            00350000
003600 FILE-CONTROL.                                                    00360000
003700                                                                  00370000
003800     SELECT CTLCD-DATE-FILE       ASSIGN TO INP01                 00380000
003900         FILE STATUS IS WS-DATE-FILE-STATUS.                      00390000
004000     SELECT INPUT-EXTRACT-FILE    ASSIGN TO INP02                 00400000
004100         FILE STATUS IS WS-INPUT-EXTRACT-STATUS.                  00410000
004200     SELECT REPORT-FILE           ASSIGN TO RPT01                 00420000
004300         FILE STATUS IS WS-REPORT-FILE-STATUS.                    00430000
004400                                                                  00440000
004500 DATA DIVISION.                                                   00450000
004600 FILE SECTION.                                                    00460000
004700                                                                  00470000
004800 FD  CTLCD-DATE-FILE                                              00480000
004900     RECORDING MODE IS F                                          00490000
005000     LABEL RECORDS ARE STANDARD                                   00500000
005100     BLOCK CONTAINS 0 RECORDS                                     00510000
005200     RECORD CONTAINS 80 CHARACTERS.                               00520000
005300                                                                  00530000
005400 01  CTLCD-DATE-RECORD                 PIC  X(80).                00540000
005500                                                                  00550000
005600                                                                  00560000
005700 FD  INPUT-EXTRACT-FILE                                           00570000
005800     RECORDING MODE IS F                                          00580000
005900     LABEL RECORDS ARE STANDARD                                   00590000
006000     BLOCK CONTAINS 0 RECORDS                                     00600000
006100     RECORD CONTAINS 200 CHARACTERS.                              00610000
006200                                                                  00620000
006300 01  INPUT-EXTRACT-RECORD              PIC  X(200).               00630000
006400                                                                  00640000
006500                                                                  00650000
006600 FD  REPORT-FILE                                                  00660000
006700     RECORDING MODE IS F                                          00670000
006800     LABEL RECORDS ARE STANDARD                                   00680000
006900     BLOCK CONTAINS 0 RECORDS                                     00690000
007000     RECORD CONTAINS 212 CHARACTERS.                              00700000
007100                                                                  00710000
007200 01  REPORT-RECORD                     PIC  X(212).               00720000
007300                                                                  00730000
007400******************************************************************00740000
007500*                       WORKING STORAGE                           00750000
007600******************************************************************00760000
007700 WORKING-STORAGE SECTION.                                         00770000
007800                                                                  00780000
007900 01  WS-START                          PIC  X(40)                 00790000
008000     VALUE 'SSKRP025 - WORKING STORAGE BEGINS HERE'.              00800000
008100                                                                  00810000
008200                                                                  00820000
008300******************************************************************00830000
008400*                         SWITCHES                                00840000
008500******************************************************************00850000
008600 01  PS-PROGRAM-SWITCHES.                                         00860000
008700     05  PS-END-OF-CTLCD-FILE-SW      PIC  X(01)    VALUE 'N'.    00870000
008800         88  PS-END-OF-CTLCD-FILE                   VALUE 'Y'.    00880000
008900                                                                  00890000
009000     05  PS-END-OF-INPUT-FILE-SW       PIC  X(01)    VALUE 'N'.   00900000
009100         88  PS-END-OF-INPUT-FILE                    VALUE 'Y'.   00910000
009200                                                                  00920000
009300******************************************************************00930000
009400*                        CONSTANTS                                00940000
009500******************************************************************00950000
009600 01  PC-PROGRAM-CONSTANTS.                                        00960000
009700     05  PC-PROGRAM-NAME               PIC X(8)  VALUE 'SSKRP025'.00970000
009800     05  PC-LINE-LIMIT                 PIC S9(3) VALUE +100.      00980000
009900                                                                  00990000
010000******************************************************************01000000
010100*                        VARIABLES                                01010000
010200******************************************************************01020000
010300 01  PV-PROGRAM-VARIABLES.                                        01030000
010400                                                                  01040000
010410     05  PV-FORMATTED-METRO-NAME       PIC X(19) VALUE SPACES.    01041000
010420**       PV-CONT-METRO-NAME AND PV-METRO-ALL-COMP-DESC TOGETHER   01042000
010500     05  PV-CONT-METRO-NAME            PIC X(12) VALUE SPACES.    01050000
010600**       PV-CONT-METRO-NAME IS SET WHEN A METRO RECORD IS READ    01060000
010700**       AND USED WHEN A CONTINUATION LINE IS NEEDED AT THE TOP   01070000
010800**       OF A COLUMN - ONLY 12 CHARS ARE SAVED SINCE THAT IS ALL  01080000
010900**       THERE IS ROOM FOR ON A NORMAL PRINT LINE.                01090000
010910     05  PV-METRO-ALL-COMP-DESC        PIC X(7)  VALUE SPACES.    01091000
010930**       EITHER ' - ALL '  OR  ' - COMP'                          01093000
010931     05  PV-SUB                        PIC S9(4) VALUE ZEROES.    01093100
010940                                                                  01094000
011000     05  PV-DATA-COUNT                 PIC S9(3) VALUE +0.        01100000
011100**       PV-DATA-COUNT IS THE NUMBER OF INPUT RECORDS BEING       01110000
011200**       PROCESSED ON THE CURRENT PAGE.  IT ALLOWS FOR            01120000
011300**       CONTINUATION LINES AT THE TOP OF EACH COLUMN.  IT        01130000
011400**       SHOULD NEVER EXCEED 285 (3 COLUMNS OF 95).               01140000
011500     05  PV-DIV-BY-1000                PIC S9(7) VALUE +0.        01150000
011510     05  PV-DIV-BY-1000000             PIC S9(5)V9 VALUE +0.      01151000
011600     05  PV-PAGE-COUNT                 PIC S9(3) VALUE +1.        01160000
011700     05  PV-PAGE-LINE                  PIC S9(3) VALUE +0.        01170000
011800**       PV-LINE-COUNT IS THE DETAIL LINE NUMBER BEING FILLED     01180000
011900**       IN ON THE CURRENT PAGE.  IT SHOULD NEVER EXCEED 95.      01190000
012000**       WHEN MOVING DATA TO THE 50TH LINE OF THE 3RD COLUMN,     01200000
012100**       PV-DATA-COUNT WILL = 240 AND PV-PAGE-LINE WILL = 50.     01210000
012200     05  PV-PCT-CHANGE                 PIC S9(4)V9(4) VALUE +0.   01220000
012300     05  PV-RUN-DATE-CCYY-MM-DD        PIC X(10) VALUE SPACES.    01230000
012400                                                                  01240000
012500******************************************************************01250000
012600*                        WORK AREA                                01260000
012700******************************************************************01270000
012800 01  WS-WORK-AREA.                                                01280000
012900                                                                  01290000
013000     05  WS-DATE-FILE-STATUS           PIC X(02) VALUE ZEROS.     01300000
013100     05  WS-INPUT-EXTRACT-STATUS       PIC X(02) VALUE ZEROS.     01310000
013200     05  WS-REPORT-FILE-STATUS         PIC X(02) VALUE ZEROS.     01320000
013300                                                                  01330000
013400******************************************************************01340000
013500*                        ACCUMULATORS                             01350000
013600******************************************************************01360000
013700 01  PA-PROGRAM-ACCUMS.                                           01370000
013800                                                                  01380000
013900     05  PA-INPUT-READ                 PIC  9(5) VALUE ZEROS.     01390000
014000                                                                  01400000
014100     05  PA-SUB                        PIC S9(4) VALUE ZEROS.     01410000
014200                                                                  01420000
014300                                                                  01430000
014400******************************************************************01440000
014500*                      CONTROL CARD                               01450000
014600******************************************************************01460000
014700 01  CC-CONTROL-CARD.                                             01470000
014800     05  CC-DB2-CTLCD-DATE-ISO.                                   01480000
014900         10  CC-DB2-REPORT-CC          PIC X(02).                 01490000
015000         10  CC-DB2-REPORT-YY          PIC X(02).                 01500000
015100         10  FILLER                    PIC X(01).                 01510000
015200         10  CC-DB2-REPORT-MM          PIC X(02).                 01520000
015300         10  FILLER                    PIC X(01).                 01530000
015400         10  CC-DB2-REPORT-DD          PIC X(02).                 01540000
030400     05  FILLER                        PIC X.                     01541003
WEEK53     05  CC-53-WEEK-IND                PIC XX.                    01542003
030400     05  FILLER                        PIC X(67).                 01543003
015600                                                                  01560000
015700                                                                  01570000
015800******************************************************************01580000
015900*                INPUT EXTRACT RECORD                             01590000
016000******************************************************************01600000
016100 01  WS-INPUT-RECORD.                                             01610000
018420     05  WS-IN-REC-CODE             PIC X(2)      VALUE SPACES.   01842000
018430**       00 = STATE RECORD                                        01843000
018440**       02 = METRO RECORD                                        01844000
018450**       04 = STORE RECORD                                        01845000
018450**       05 = ECOM RECORD                                         01845100
018460**       06 = COMPANY RECORD                                      01846000
018470     05  WS-IN-STATE                PIC X(2)      VALUE SPACES.   01847000
018480     05  WS-IN-METRO                PIC 9(4)      VALUE ZEROES.   01848000
018490     05  WS-IN-STORE                PIC 9(4)      VALUE ZEROES.   01849000
018491     05  WS-IN-SORT-KEY.                                          01849100
018502**       THE SORT FIELDS WILL REFLECT THIS YEAR'S TOTAL SALES.    01850200
018503         10  WS-IN-SORT-STATE-SALES       PIC S9(13)V99 COMP-3    01850300
018504                                                  VALUE 0.        01850400
018505         10  WS-IN-SORT-METRO-SALES       PIC S9(13)V99 COMP-3    01850500
018506                                                  VALUE 0.        01850600
018507         10  WS-IN-SORT-STORE-SALES       PIC S9(13)V99 COMP-3    01850700
018508                                                  VALUE 0.        01850800
018509     05  WS-IN-TY-DAILY-SALES       PIC S9(11)V99 COMP-3 VALUE 0. 01850900
018510     05  WS-IN-TY-MTD-SALES         PIC S9(11)V99 COMP-3 VALUE 0. 01851000
018511     05  WS-IN-TY-YTD-SALES         PIC S9(13)V99 COMP-3 VALUE 0. 01851100
018512     05  WS-IN-TY-COMP-DLY-SALES    PIC S9(11)V99 COMP-3 VALUE 0. 01851200
018513     05  WS-IN-TY-COMP-MTD-SALES    PIC S9(11)V99 COMP-3 VALUE 0. 01851300
018514     05  WS-IN-TY-COMP-YTD-SALES    PIC S9(13)V99 COMP-3 VALUE 0. 01851400
018515     05  WS-IN-LY-DAILY-SALES       PIC S9(11)V99 COMP-3 VALUE 0. 01851500
018516     05  WS-IN-LY-MTD-SALES         PIC S9(11)V99 COMP-3 VALUE 0. 01851600
018517     05  WS-IN-LY-YTD-SALES         PIC S9(13)V99 COMP-3 VALUE 0. 01851700
018518     05  WS-IN-LY-COMP-DLY-SALES    PIC S9(11)V99 COMP-3 VALUE 0. 01851800
018519     05  WS-IN-LY-COMP-MTD-SALES    PIC S9(11)V99 COMP-3 VALUE 0. 01851900
018520     05  WS-IN-LY-COMP-YTD-SALES    PIC S9(13)V99 COMP-3 VALUE 0. 01852000
018521     05  WS-IN-LY-TOTAL-SALES       PIC S9(13)V99 COMP-3 VALUE 0. 01852100
018522     05  WS-IN-METRO-NAME           PIC X(30)     VALUE SPACES.   01852200
018523     05  WS-IN-STORE-NAME           PIC X(10)     VALUE SPACES.   01852300
018524     05  WS-IN-MULT-METRO-IND       PIC X         VALUE SPACES.   01852400
018525**       WILL CONTAIN AN '*' IF METRO SPANS MULTIPLE STATES       01852500
018526**       WILL CONTAIN A  ' ' IF METRO IS WITHIN 1 STATE           01852600
WEEK53     05  WS-IN-DURING-WEEK-53       PIC X         VALUE SPACES.   01852701
WEEK53**       Y = RUN DATE IS DURING WEEK 53                           01852801
WEEK53     05  WS-IN-LY-SAME-FISCAL-DATE  PIC X(10)     VALUE SPACES.   01852904
018527     05  FILLER                     PIC X(26)     VALUE SPACES.   01854003
018550                                                                  01855000
018600                                                                  01860000
018700******************************************************************01870000
018800*               SYTEM TIME AND DATE VARIABLES                     01880000
018900******************************************************************01890000
019000 01  SYS-DATE-TIME.                                               01900000
019100     05  SYS-DATE                      PIC X(08)  VALUE SPACES.   01910000
019200     05  SYS-TIME                      PIC X(08)  VALUE SPACES.   01920000
019300                                                                  01930000
019400 01  ST-BEG-TIME.                                                 01940000
019500     05  ST-BEG-HR                     PIC 9(02)  VALUE ZEROS.    01950000
019600     05  FILLER                        PIC X(01)  VALUE ':'.      01960000
019700     05  ST-BEG-MN                     PIC 9(02)  VALUE ZEROS.    01970000
019800     05  FILLER                        PIC X(01)  VALUE ':'.      01980000
019900     05  ST-BEG-SS                     PIC 9(02)  VALUE ZEROS.    01990000
020000                                                                  02000000
020100 01  ST-END-TIME.                                                 02010000
020200     05  ST-END-HR                     PIC 9(02)  VALUE ZEROS.    02020000
020300     05  FILLER                        PIC X(01)  VALUE ':'.      02030000
020400     05  ST-END-MN                     PIC 9(02)  VALUE ZEROS.    02040000
020500     05  FILLER                        PIC X(01)  VALUE ':'.      02050000
020600     05  ST-END-SS                     PIC 9(02)  VALUE ZEROS.    02060000
020700                                                                  02070000
020800 01  SD-EDIT-DATE.                                                02080000
020900     05  SD-MONTH                      PIC 9(02)  VALUE ZEROS.    02090000
021000     05  FILLER                        PIC X(01)  VALUE '-'.      02100000
021100     05  SD-DAY                        PIC 9(02)  VALUE ZEROS.    02110000
021200     05  FILLER                        PIC X(01)  VALUE '-'.      02120000
021300     05  SD-CENT                       PIC 9(02)  VALUE ZEROS.    02130000
021400     05  SD-YEAR                       PIC 9(02)  VALUE ZEROS.    02140000
021500                                                                  02150000
021600******************************************************************02160000
021700*                        ERROR HANDLING                           02170000
021800******************************************************************02180000
021900 01  ABEND-CODE                        PIC S9(04) VALUE ZEROS     02190000
022000                                                  COMP SYNC.      02200000
022100     88  ABEND-3333-INVALID-CTLCD-DATE            VALUE +3333.    02210000
022200     88  ABEND-4444-FORCED-ABEND                  VALUE +4444.    02220000
022300                                                                  02230000
022301                                                                  02230100
022310******************************************************************02231000
022320* PARAMETER LIST FOR THE CALENDAR ROUTINE                         02232000
022330******************************************************************02233000
022340     COPY DPWS500.                                                02234000
022350                                                                  02235000
022400                                                                  02240000
022500* THIS REPORT WILL BE 212 CHARACTERS WIDE, BUT THE STANDARD       02250000
022600* 200 COLUMN COPYBOOK WILL BE USED.                               02260000
022700******************************************************************02270000
022800* KOHLS STANDARD HEADING ROUTINE FOR A 200 COLUMN REPORT          02280000
022900******************************************************************02290000
023000     COPY DPWS200O.                                               02300000
023100*                                                                 02310000
026600                                                                  02660000
026700                                                                  02670000
026800******************************************************************02680000
026900* REPORT HEADINGS                                                 02690000
027000******************************************************************02700000
027100 01  HL-HDR1.                                                     02710000
027200     05  FILLER                  PIC  X(72) VALUE SPACES.         02720000
027300     05                          PIC  X(46) VALUE                 02730000
027400        'DAILY GEOGRAPHIC SALES REPORT FOR SALES DATE  '.         02740000
027500     05  HL-REPORT-MONTH         PIC  X(02) VALUE SPACES.         02750000
027600     05  FILLER                  PIC  X(01) VALUE '/'.            02760000
027700     05  HL-REPORT-DAY           PIC  X(02) VALUE SPACES.         02770000
027800     05  FILLER                  PIC  X(01) VALUE '/'.            02780000
027900     05  HL-REPORT-CENTURY       PIC  X(02) VALUE SPACES.         02790000
028000     05  HL-REPORT-YEAR          PIC  X(02) VALUE SPACES.         02800000
028100     05  FILLER                  PIC  X     VALUE SPACES.         02800101
028000     05  HL-CALENDAR-LITERAL     PIC  X(40) VALUE SPACES.         02801005
028000**       (COMPARE BY CALENDAR WEEK)                               02802001
028100     05  FILLER                  PIC  X(43) VALUE SPACES.         02810005
028200                                                                  02820000
028300 01  HL-HDR2.                                                     02830000
028400     05  FILLER                  PIC  X(39) VALUE                 02840000
028500         'ST METRO                 TY $          '.               02850000
028510     05  FILLER                  PIC  X(34) VALUE                 02851000
028520         '  MTD $               YTD $       '.                    02852000
028600     05  FILLER                  PIC  X(39) VALUE                 02860000
028700         'ST METRO                 TY $          '.               02870000
028701     05  FILLER                  PIC  X(33) VALUE                 02870100
028702         '  MTD $               YTD $      '.                     02870200
028800     05  FILLER                  PIC  X(39) VALUE                 02880000
028900         'ST METRO                 TY $          '.               02890000
028910     05  FILLER                  PIC  X(28) VALUE                 02891000
028920         '  MTD $               YTD $ '.                          02892000
029000                                                                  02900000
029100                                                                  02910000
029200 01  HL-HDR3.                                                     02920000
029300     05  FILLER                  PIC  X(39) VALUE                 02930000
030200         '     LY $  STORE NAME   (000)   TY %   '.               02940000
029500     05  FILLER                  PIC  X(34) VALUE                 02950000
029600         '  (000)  MTD %  YTD % (MIL)       '.                    02960000
029700     05  FILLER                  PIC  X(39) VALUE                 02970000
030200         '     LY $  STORE NAME   (000)   TY %   '.               02980000
029900     05  FILLER                  PIC  X(33) VALUE                 02990000
030000         '  (000)  MTD %  YTD % (MIL)      '.                     03000000
030100     05  FILLER                  PIC  X(39) VALUE                 03010000
030200         '     LY $  STORE NAME   (000)   TY %   '.               03020000
030300     05  FILLER                  PIC  X(28) VALUE                 03030000
030400         '  (000)  MTD %  YTD % (MIL) '.                          03040000
030500                                                                  03050000
030600                                                                  03060000
030700******************************************************************03070000
030800* DETAIL LINES                                                    03080000
030900******************************************************************03090000
031000 01  DL-DETAIL-LINE-TABLE.                                        03100000
031100***    THERE IS ROOM FOR 100 PRINT LINES ON A PAGE INCLUDING      03110000
031200***    4 HEADER LINES AND THE CONFIDENTIALITY LINE.               03120000
031300   03  DL-DETAIL-LINE OCCURS 95 TIMES.                            03130000
031400     05  DL-DETAIL-LINE-COLUMN-1.                                 03140000
031500***      REPORT COLUMN 1                                          03150000
031600       07  DL1-DESCRIPTION         PIC  X(21)    VALUE SPACES.    03160000
031700       07  DL1-STATE-DESC REDEFINES DL1-DESCRIPTION.              03170000
031800           10  DL1-STATE           PIC  X(2).                     03180000
031900           10  DL1-STATE-COMP-DESC PIC  X(7).                     03190000
031910           10  FILLER              PIC  X(12).                    03191000
032000       07  DL1-METRO-DESC REDEFINES DL1-DESCRIPTION.              03200000
032100           10  FILLER              PIC  X.                        03210000
032110           10  DL1-MULT-METRO-IND  PIC  X.                        03211000
032200           10  DL1-METRO-NAME      PIC  X(19).                    03220000
032210*          10  FILLER              PIC  X.                        03221000
032300       07  DL1-STORE-DESC REDEFINES DL1-DESCRIPTION.              03230000
032400           10  FILLER                PIC  X(4).                   03240000
032500           10  DL1-LY-TOTAL-SALES-X  PIC  X(5).                   03250000
032600           10  DL1-LY-TOTAL-SALES REDEFINES DL1-LY-TOTAL-SALES-X  03260000
032700                                   PIC  ZZ9.9.                    03270000
032710           10  FILLER              PIC  XX.                       03271000
032720           10  DL1-STORE-NAME      PIC  X(10).                    03272000
032730*          10  FILLER              PIC  X.                        03273000
032800       07  DL1-TY-DAILY-SALES-X    PIC  X(8)     VALUE SPACES.    03280000
032900       07  DL1-TY-DAILY-SALES REDEFINES DL1-TY-DAILY-SALES-X      03290000
033000                                   PIC  ----,--9.                 03300000
033600       07  DL1-TY-LY-PCT-NA        PIC  X(7)     VALUE SPACES.    03360000
033700       07  DL1-TY-LY-PCT-CHANGE REDEFINES DL1-TY-LY-PCT-NA        03370000
033800                                   PIC  ----9.9.                  03380000
033900*      07  FILLER                  PIC  X        VALUE SPACES.    03390000
034000       07  DL1-MTD-SALES-X         PIC  X(10)    VALUE SPACES.    03400000
034100       07  DL1-MTD-SALES REDEFINES DL1-MTD-SALES-X                03410000
034200                                   PIC  --,---,--9.               03420000
034400       07  DL1-MTD-PCT-NA          PIC  X(7)     VALUE SPACES.    03440000
034500       07  DL1-MTD-PCT-CHANGE   REDEFINES DL1-MTD-PCT-NA          03450000
034600                                   PIC  ----9.9.                  03460000
034800       07  DL1-YTD-PCT-NA          PIC  X(7)     VALUE SPACES.    03480000
034900       07  DL1-YTD-PCT-CHANGE   REDEFINES DL1-YTD-PCT-NA          03490000
035000                                   PIC  ----9.9.                  03500000
035010       07  FILLER                  PIC  X        VALUE SPACES.    03501000
035020       07  DL1-TY-TOTAL-SALES-X    PIC  X(5)     VALUE SPACES.    03502000
035030       07  DL1-TY-TOTAL-SALES REDEFINES DL1-TY-TOTAL-SALES-X      03503000
035040                                   PIC  ZZ9.9.                    03504000
035100       07  FILLER                  PIC  X(7)     VALUE SPACES.    03510000
035200                                                                  03520000
035300     05  DL-DETAIL-LINE-COLUMN-2.                                 03530000
035400***      REPORT COLUMN 2                                          03540000
035500       07  DL2-DESCRIPTION         PIC  X(21)    VALUE SPACES.    03550000
035600       07  DL2-STATE-DESC REDEFINES DL2-DESCRIPTION.              03560000
035610           10  DL2-STATE           PIC  X(2).                     03561000
035620           10  DL2-STATE-COMP-DESC PIC  X(7).                     03562000
035630           10  FILLER              PIC  X(12).                    03563000
035900       07  DL2-METRO-DESC REDEFINES DL2-DESCRIPTION.              03590000
036000           10  FILLER              PIC  X.                        03600000
036010           10  DL2-MULT-METRO-IND  PIC  X.                        03601000
036110           10  DL2-METRO-NAME      PIC  X(19).                    03611000
036130       07  DL2-STORE-DESC REDEFINES DL2-DESCRIPTION.              03613000
036140           10  FILLER                PIC  X(4).                   03614000
036150           10  DL2-LY-TOTAL-SALES-X  PIC  X(5).                   03615000
036160           10  DL2-LY-TOTAL-SALES REDEFINES DL2-LY-TOTAL-SALES-X  03616000
036170                                   PIC  ZZ9.9.                    03617000
036180           10  FILLER              PIC  XX.                       03618000
036190           10  DL2-STORE-NAME      PIC  X(10).                    03619000
036700       07  DL2-TY-DAILY-SALES-X    PIC  X(8)     VALUE SPACES.    03670000
036800       07  DL2-TY-DAILY-SALES REDEFINES DL2-TY-DAILY-SALES-X      03680000
036900                                   PIC  ----,--9.                 03690000
037500       07  DL2-TY-LY-PCT-NA        PIC  X(7)     VALUE SPACES.    03750000
037600       07  DL2-TY-LY-PCT-CHANGE REDEFINES DL2-TY-LY-PCT-NA        03760000
037700                                   PIC  ----9.9.                  03770000
037900       07  DL2-MTD-SALES-X         PIC  X(10)    VALUE SPACES.    03790000
038000       07  DL2-MTD-SALES REDEFINES DL2-MTD-SALES-X                03800000
038100                                   PIC  --,---,--9.               03810000
038300       07  DL2-MTD-PCT-NA          PIC  X(7)     VALUE SPACES.    03830000
038400       07  DL2-MTD-PCT-CHANGE   REDEFINES DL2-MTD-PCT-NA          03840000
038500                                   PIC  ----9.9.                  03850000
038700       07  DL2-YTD-PCT-NA          PIC  X(7)     VALUE SPACES.    03870000
038800       07  DL2-YTD-PCT-CHANGE   REDEFINES DL2-YTD-PCT-NA          03880000
038900                                   PIC  ----9.9.                  03890000
038910       07  FILLER                  PIC  X        VALUE SPACES.    03891000
038920       07  DL2-TY-TOTAL-SALES-X    PIC  X(5)     VALUE SPACES.    03892000
038930       07  DL2-TY-TOTAL-SALES REDEFINES DL2-TY-TOTAL-SALES-X      03893000
038940                                   PIC  ZZ9.9.                    03894000
039000       07  FILLER                  PIC  X(6)     VALUE SPACES.    03900000
039100     05  DL-DETAIL-LINE-COLUMN-3.                                 03910000
039200***      REPORT COLUMN 3                                          03920000
039300       07  DL3-DESCRIPTION         PIC  X(21)    VALUE SPACES.    03930000
039400       07  DL3-STATE-DESC REDEFINES DL3-DESCRIPTION.              03940000
039410           10  DL3-STATE           PIC  X(2).                     03941000
039420           10  DL3-STATE-COMP-DESC PIC  X(7).                     03942000
039430           10  FILLER              PIC  X(12).                    03943000
039700       07  DL3-METRO-DESC REDEFINES DL3-DESCRIPTION.              03970000
039800           10  FILLER              PIC  X.                        03980000
039810           10  DL3-MULT-METRO-IND  PIC  X.                        03981000
039910           10  DL3-METRO-NAME      PIC  X(19).                    03991000
039930       07  DL3-STORE-DESC REDEFINES DL3-DESCRIPTION.              03993000
039940           10  FILLER                PIC  X(4).                   03994000
039950           10  DL3-LY-TOTAL-SALES-X  PIC  X(5).                   03995000
039960           10  DL3-LY-TOTAL-SALES REDEFINES DL3-LY-TOTAL-SALES-X  03996000
039970                                   PIC  ZZ9.9.                    03997000
039980           10  FILLER              PIC  XX.                       03998000
039990           10  DL3-STORE-NAME      PIC  X(10).                    03999000
040500       07  DL3-TY-DAILY-SALES-X    PIC  X(8)     VALUE SPACES.    04050000
040600       07  DL3-TY-DAILY-SALES REDEFINES DL3-TY-DAILY-SALES-X      04060000
040700                                   PIC  ----,--9.                 04070000
041610       07  DL3-TY-LY-PCT-NA        PIC  X(7)     VALUE SPACES.    04161000
041620       07  DL3-TY-LY-PCT-CHANGE REDEFINES DL3-TY-LY-PCT-NA        04162000
041630                                   PIC  ----9.9.                  04163000
041700       07  DL3-MTD-SALES-X         PIC  X(10)    VALUE SPACES.    04170000
041800       07  DL3-MTD-SALES REDEFINES DL3-MTD-SALES-X                04180000
041900                                   PIC  --,---,--9.               04190000
042100       07  DL3-MTD-PCT-NA          PIC  X(7)     VALUE SPACES.    04210000
042200       07  DL3-MTD-PCT-CHANGE   REDEFINES DL3-MTD-PCT-NA          04220000
042300                                   PIC  ----9.9.                  04230000
042500       07  DL3-YTD-PCT-NA          PIC  X(7)     VALUE SPACES.    04250000
042600       07  DL3-YTD-PCT-CHANGE   REDEFINES DL3-YTD-PCT-NA          04260000
042700                                   PIC  ----9.9.                  04270000
042710       07  FILLER                  PIC  X        VALUE SPACES.    04271000
042720       07  DL3-TY-TOTAL-SALES-X    PIC  X(5)     VALUE SPACES.    04272000
042730       07  DL3-TY-TOTAL-SALES REDEFINES DL3-TY-TOTAL-SALES-X      04273000
042740                                   PIC  ZZ9.9.                    04274000
042750       07  FILLER                  PIC  X        VALUE SPACES.    04275000
042900                                                                  04290000
043000 PROCEDURE DIVISION.                                              04300000
043100******************************************************************04310000
043200* MAIN DRIVER                                                     04320000
043300******************************************************************04330000
043400                                                                  04340000
043500     PERFORM 1000-INITIALIZE.                                     04350000
043600                                                                  04360000
043700     PERFORM 2000-LOAD-INPUT-TO-PRINT-PAGE                        04370000
043800         UNTIL PS-END-OF-INPUT-FILE.                              04380000
043900                                                                  04390000
044000     PERFORM 9000-END-OF-JOB.                                     04400000
044100                                                                  04410000
044200     STOP RUN.                                                    04420000
044300                                                                  04430000
044400                                                                  04440000
044500******************************************************************04450000
044600* PERFORMS TASK INITIATION PROCESSING                             04460000
044700******************************************************************04470000
044800 1000-INITIALIZE.                                                 04480000
044900                                                                  04490000
045000     OPEN INPUT  CTLCD-DATE-FILE                                  04500000
045100                 INPUT-EXTRACT-FILE                               04510000
045200          OUTPUT REPORT-FILE.                                     04520000
045300                                                                  04530000
045400     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 04540000
045500                                                                  04550000
045600     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            04560000
045700     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            04570000
045800                                                                  04580000
045900     MOVE SYS-DATE (1:2) TO SD-CENT.                              04590000
046000     MOVE SYS-DATE (3:2) TO SD-YEAR.                              04600000
046100     MOVE SYS-DATE (5:2) TO SD-MONTH.                             04610000
046200     MOVE SYS-DATE (7:2) TO SD-DAY.                               04620000
046300                                                                  04630000
046400     PERFORM 1100-READ-CTLCD.                                     04640000
046410     PERFORM 1200-EDIT-DATE.                                      04641000
046500     PERFORM 1300-FORMAT-HEADINGS.                                04650000
046600                                                                  04660000
046700                                                                  04670000
046800******************************************************************04680000
046900* READ THE DATE FILE INTO THE CONTROL CARD                        04690000
047000******************************************************************04700000
047100 1100-READ-CTLCD.                                                 04710000
047200                                                                  04720000
047300     READ CTLCD-DATE-FILE INTO CC-CONTROL-CARD                    04730000
047400         AT END SET PS-END-OF-CTLCD-FILE TO TRUE.                 04740000
047500                                                                  04750000
047600     IF  PS-END-OF-CTLCD-FILE                                     04760000
047700         SET ABEND-3333-INVALID-CTLCD-DATE     TO TRUE            04770000
047800         DISPLAY 'PARA NAME = 1100-READ-CTLCD'                    04780000
047900         DISPLAY 'INPUT CTLCD DATE FILE IS EMPTY'                 04790000
048000         PERFORM 8000-ABEND                                       04800000
048100     END-IF.                                                      04810000
048200                                                                  04820000
048210                                                                  04821000
048220******************************************************************04822000
048230* EDIT THE DB2 DATE TO MAKE SURE THAT IT IS VALID.                04823000
048240******************************************************************04824000
048250 1200-EDIT-DATE.                                                  04825000
048260                                                                  04826000
048270     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04827000
048280                                                                  04828000
048291     SET DPG51-FISCAL-454-CALENDAR     TO TRUE.                   04829100
048292     SET DPG51-DO-NOT-INCR-DECR-DATE   TO TRUE.                   04829200
048293     SET DPG52-LK-DTE-ISO-FMT          TO TRUE.                   04829300
048294                                                                  04829400
048295     MOVE CC-DB2-CTLCD-DATE-ISO        TO DPG52-LK-DATE-INPUT.    04829500
048296                                                                  04829600
048297     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    04829700
048298                                             DPG54 DPG55 DPG56.   04829800
048299                                                                  04829900
048300     EVALUATE TRUE                                                04830000
048301        WHEN DPG54-NO-ERROR                                       04830100
048303           MOVE CC-DB2-CTLCD-DATE-ISO TO PV-RUN-DATE-CCYY-MM-DD   04830300
048308           DISPLAY 'DPG56-FISCAL-YEAR-CCYY = '                    04830800
048309                    DPG56-FISCAL-YEAR-CCYY                        04830900
048313                                                                  04831300
048314        WHEN DPG54-SEVERE-ERROR                                   04831400
048315        WHEN DPG54-DATE-INVALID                                   04831500
048316           SET ABEND-3333-INVALID-CTLCD-DATE     TO TRUE          04831600
048317           DISPLAY 'PARA NAME = 1200-EDIT-DATE - CALL DPKUT500'   04831700
048318           DISPLAY 'INPUT CTLCD DATE  ' CC-DB2-CTLCD-DATE-ISO     04831800
048319                   '  IS INVALID'                                 04831900
048320           DISPLAY 'CALENDAR MODULE ERROR IND = ' DPG54-ERROR-IND 04832000
048321           PERFORM 8000-ABEND                                     04832100
048322     END-EVALUATE.                                                04832200
048323                                                                  04832300
048324                                                                  04832400
048330                                                                  04833000
048400******************************************************************04840000
048500* FORMAT THE HEADINGS FOR THE REPORT                              04850000
048600******************************************************************04860000
048700 1300-FORMAT-HEADINGS.                                            04870000
048800                                                                  04880000
048900     MOVE PC-PROGRAM-NAME TO DP200O-PROGRAM-NAME.                 04890000
049000     MOVE '1'             TO DP200O-REPORT-NUMBER.                04900000
049100                                                                  04910000
049200     MOVE SD-YEAR   TO DP200O-RUN-YEAR.                           04920000
049300     MOVE SD-MONTH  TO DP200O-RUN-MONTH.                          04930000
049400     MOVE SD-DAY    TO DP200O-RUN-DAY.                            04940000
049500                                                                  04950000
049600     MOVE ST-BEG-HR TO DP200O-RUN-HOUR.                           04960000
049700     MOVE ST-BEG-MN TO DP200O-RUN-MINUTE.                         04970000
049800                                                                  04980000
049900     MOVE CC-DB2-REPORT-MM TO HL-REPORT-MONTH.                    04990000
050000     MOVE CC-DB2-REPORT-DD TO HL-REPORT-DAY.                      05000000
050100     MOVE CC-DB2-REPORT-CC TO HL-REPORT-CENTURY.                  05010000
050200     MOVE CC-DB2-REPORT-YY TO HL-REPORT-YEAR.                     05020000
050300                                                                  05030000
050310     SUBTRACT 1 FROM  DPG56-FISCAL-YEAR-CCYY.                     05031000
050400                                                                  05040000
050500******************************************************************05050000
050600* THIS PARAGRAPH WILL CONTROL THE LOADING OF THE HEADERS AND INPUT05060000
050700* DATA INTO THE PAGE LAYOUT (212 CHARACTERS X 100 LINES).         05070000
050800* SINCE THE DATA WILL BE FILLED 1 COLUMN AT A TIME, ALL DATA MUST 05080000
050900* BE LOADED ONTO THE PAGE BEFORE IT CAN BE WRITTEN (COLUMNS 2 AND 05090000
051000* 3 MAY OR MAY NOT CONTAIN DATA ON ANY GIVEN LINE).               05100000
051100* THERE WILL BE 4 HEADERS AT THE TOP OF THE PAGE, INCLUDING THE   05110000
051200* STANDARD KOHLS HEADER AT THE TOP.                               05120000
051300* 95 DETAIL LINES WILL FOLLOW, EACH WITH UP TO 3 SETS OF DATA.    05130000
051400* THE LAST LINE WILL BE THE KOHLS CONFIDENTIALITY LINE.           05140000
051500******************************************************************05150000
051600 2000-LOAD-INPUT-TO-PRINT-PAGE.                                   05160000
051700                                                                  05170000
051800     PERFORM 2100-READ-INPUT-FILE.                                05180000
051900                                                                  05190000
052000     IF NOT PS-END-OF-INPUT-FILE                                  05200000
052001**       IF THERE IS ONLY 1 PRINT LINE LEFT AT THE BOTTOM OF A    05200100
052002**       COLUMN AND THERE IS A STATE OR METRO RECORD TO BE        05200200
052003**       PRINTED, ADD 1 TO PV-DATA-COUNT TO FORCE THE STATE AND   05200300
052004**       METRO LINES TO THE TOP OF THE NEXT COLUMN SO THAT THEIR  05200400
052005**       'ALL' AND 'COMP' VALUES ARE PRINTED TOGETHER.            05200500
052100         IF PV-DATA-COUNT > 285                                   05210000
052200**           WRITE FULL PAGE (285 = 3 COLUMNS OF 95)              05220000
052300             PERFORM 3000-WRITE-PAGE                              05230000
052400         END-IF                                                   05240000
052510         IF PV-DATA-COUNT < 96                                    05251000
052600             MOVE PV-DATA-COUNT   TO PV-PAGE-LINE                 05260000
052700             PERFORM 2500-LOAD-COLUMN-1                           05270000
052800         ELSE                                                     05280000
052900             IF PV-DATA-COUNT < 191                               05290000
053000                 COMPUTE PV-PAGE-LINE = PV-DATA-COUNT - 95        05300000
053100                 PERFORM 2600-LOAD-COLUMN-2                       05310000
053200             ELSE                                                 05320000
053300                 COMPUTE PV-PAGE-LINE = PV-DATA-COUNT - 190       05330000
053400                 PERFORM 2700-LOAD-COLUMN-3                       05340000
053500             END-IF                                               05350000
053600         END-IF                                                   05360000
053700     ELSE                                                         05370000
053800         IF PV-DATA-COUNT > 0                                     05380000
053900**           WRITE PARTIAL LAST PAGE                              05390000
054000             PERFORM 3000-WRITE-PAGE                              05400000
054100         END-IF                                                   05410000
054200     END-IF.                                                      05420000
054300                                                                  05430000
054400                                                                  05440000
054500******************************************************************05450000
054600* READ THE INPUT FILE                                             05460000
054700******************************************************************05470000
054800 2100-READ-INPUT-FILE.                                            05480000
054900                                                                  05490000
055000     READ INPUT-EXTRACT-FILE   INTO WS-INPUT-RECORD               05500000
055100         AT END SET PS-END-OF-INPUT-FILE TO TRUE.                 05510000
055200                                                                  05520000
055300     IF  NOT PS-END-OF-INPUT-FILE                                 05530000
055400         ADD +1          TO PA-INPUT-READ                         05540000
055500                            PV-DATA-COUNT                         05550000
055600     END-IF.                                                      05560000
055700                                                                  05570000
055800                                                                  05580000
055900******************************************************************05590000
056000* LOAD DATA TO THE FIRST COLUMN ON THE PAGE.                      05600000
056100* CHECK IF A CONTINUATION LINE FROM THE PREVIOUS PAGE IS REQUIRED.05610000
056200******************************************************************05620000
056300 2500-LOAD-COLUMN-1.                                              05630000
056400                                                                  05640000
056500     IF PV-PAGE-COUNT > 1 AND PV-PAGE-LINE = 1                    05650000
056600         IF WS-IN-REC-CODE = '02'                                 05660000
056700**           STATE CONTINUATION LINE IS REQUIRED                  05670000
056800             STRING WS-IN-STATE ' (CONT)'                         05680000
056900               DELIMITED BY SIZE                                  05690000
057000                 INTO DL-DETAIL-LINE-COLUMN-1 (PV-PAGE-LINE)      05700000
057100             MOVE 2            TO PV-PAGE-LINE                    05710000
057200             ADD +1            TO PV-DATA-COUNT                   05720000
057300         ELSE                                                     05730000
057400             IF WS-IN-REC-CODE = '04'                             05740000
057500**           STATE / METRO CONTINUATION LINE IS REQUIRED          05750000
057600                 STRING WS-IN-STATE ' ' PV-CONT-METRO-NAME        05760000
057700                        ' (CONT)'                                 05770000
057800                   DELIMITED BY SIZE                              05780000
057900                     INTO DL-DETAIL-LINE-COLUMN-1 (PV-PAGE-LINE)  05790000
058000                 MOVE 2        TO PV-PAGE-LINE                    05800000
058100                 ADD +1        TO PV-DATA-COUNT                   05810000
058200             END-IF                                               05820000
058300         END-IF                                                   05830000
058400     END-IF.                                                      05840000
058500                                                                  05850000
058600     IF WS-IN-REC-CODE = '00'                                     05860000
058820**       00 = STATE - WRITE STATE COMP LINE                       05882000
058850         MOVE SPACES   TO DL-DETAIL-LINE-COLUMN-1 (PV-PAGE-LINE)  05885000
058860         MOVE WS-IN-STATE TO DL1-STATE (PV-PAGE-LINE)             05886000
058870         MOVE ' - COMP'   TO DL1-STATE-COMP-DESC (PV-PAGE-LINE)   05887000
058880         PERFORM 2510-FORMAT-COL1-COMP-LINE                       05888000
058900     ELSE                                                         05890000
059000         IF WS-IN-REC-CODE = '02'                                 05900000
059010**           02 = METRO - WRITE METRO COMP LINE                   05901000
059040             MOVE SPACES TO DL-DETAIL-LINE-COLUMN-1(PV-PAGE-LINE) 05904000
059050             MOVE WS-IN-MULT-METRO-IND                            05905000
059060                             TO DL1-MULT-METRO-IND (PV-PAGE-LINE) 05906000
059070             MOVE ' - COMP'  TO PV-METRO-ALL-COMP-DESC            05907000
059080             PERFORM 2800-FORMAT-METRO-NAME                       05908000
059090             MOVE PV-FORMATTED-METRO-NAME                         05909000
059091                             TO DL1-METRO-NAME(PV-PAGE-LINE)      05909100
059092             PERFORM 2510-FORMAT-COL1-COMP-LINE                   05909200
059500         ELSE                                                     05950000
059510             IF WS-IN-REC-CODE = '04'                             05951000
059600**               04 = STORE - WRITE STORE ALL LINE                05960000
059800                 MOVE WS-IN-STORE-NAME                            05980000
059900                                  TO DL1-STORE-NAME(PV-PAGE-LINE) 05990000
059901                 PERFORM 2505-FORMAT-COL1-ALL-LINE                05990100
059910             ELSE                                                 05991000
059510                 IF WS-IN-REC-CODE = '05'                         05991100
059510                     IF WS-IN-STORE > 0                           05991200
059600**                       05 = ECOM STORE - WRITE STORE ALL LINE   05991300
059800                         MOVE WS-IN-STORE-NAME                    05991400
059900                                  TO DL1-STORE-NAME(PV-PAGE-LINE) 05991500
059901                         PERFORM 2505-FORMAT-COL1-ALL-LINE        05991600
059910                     ELSE                                         05991700
059600**                       05 = ECOM METRO - WRITE METRO COMP LINE  05991800
059600**                            BUT ALIGN METRO UNDER STATE NAMES   05991900
059070                         MOVE ' - COMP'  TO PV-METRO-ALL-COMP-DESC05992000
059080                         PERFORM 2800-FORMAT-METRO-NAME           05992100
059090                         MOVE PV-FORMATTED-METRO-NAME             05992200
059091                             TO DL1-STATE-DESC(PV-PAGE-LINE)      05992300
059092                         PERFORM 2510-FORMAT-COL1-COMP-LINE       05992400
059910                 ELSE                                             05992500
059920**                   06 = COMPANY - WRITE ALL AND COMP LINES      05992600
059921                     MOVE 'COMPANY TOTAL- ALL '                   05992800
059940                                 TO DL1-DESCRIPTION(PV-PAGE-LINE) 05994000
059941                     PERFORM 2505-FORMAT-COL1-ALL-LINE            05994100
059960                     ADD +1          TO PV-DATA-COUNT             05996000
059970                                        PV-PAGE-LINE              05997000
059980                     MOVE SPACES                                  05998000
059990                         TO DL-DETAIL-LINE-COLUMN-1(PV-PAGE-LINE) 05999000
059991                     MOVE 'COMPANY TOTAL- COMP'                   05999100
059992                                 TO DL1-DESCRIPTION(PV-PAGE-LINE) 05999200
059993                     PERFORM 2510-FORMAT-COL1-COMP-LINE           05999300
060000                 END-IF                                           06000000
060000             END-IF                                               06000100
060010         END-IF                                                   06001000
060100     END-IF.                                                      06010000
064801                                                                  06480100
064802                                                                  06480200
064803******************************************************************06480300
064804* FORMAT THE COLUMN 1 LINE FOR ALL STORES (STORE AND COMPANY).    06480400
064805******************************************************************06480500
064806                                                                  06480600
064810 2505-FORMAT-COL1-ALL-LINE.                                       06481000
064811                                                                  06481100
064812     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06481200
064813             WS-IN-TY-DAILY-SALES / 1000.                         06481300
064814     MOVE PV-DIV-BY-1000     TO DL1-TY-DAILY-SALES(PV-PAGE-LINE). 06481400
064815     IF WS-IN-LY-DAILY-SALES = 0                                  06481500
064816       OR WS-IN-TY-DAILY-SALES = 0                                06481600
WEEK53       OR WS-IN-DURING-WEEK-53 = 'Y'                              06481701
064817         MOVE '    N/A'      TO DL1-TY-LY-PCT-NA (PV-PAGE-LINE)   06481801
064818     ELSE                                                         06481901
064819         COMPUTE PV-PCT-CHANGE =                                  06482001
064820               ((WS-IN-TY-DAILY-SALES -                           06482101
064821                 WS-IN-LY-DAILY-SALES)                            06482201
064822               / WS-IN-LY-DAILY-SALES)     *  100                 06482301
064823           ON SIZE ERROR                                          06482401
064824               MOVE 9999.9  TO  PV-PCT-CHANGE                     06482501
064825         END-COMPUTE                                              06482601
064826         COMPUTE DL1-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =     06482701
064827             PV-PCT-CHANGE * 1                                    06482801
064828     END-IF.                                                      06482901
064829     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06483001
064830             WS-IN-TY-MTD-SALES / 1000.                           06483101
064831     MOVE PV-DIV-BY-1000     TO DL1-MTD-SALES (PV-PAGE-LINE).     06483201
064832     IF WS-IN-LY-MTD-SALES = 0                                    06483301
064833       OR WS-IN-TY-MTD-SALES = 00                                 06483401
064834         MOVE '    N/A'      TO DL1-MTD-PCT-NA (PV-PAGE-LINE)     06483501
064835     ELSE                                                         06483601
064836         COMPUTE PV-PCT-CHANGE =                                  06483701
064837               ((WS-IN-TY-MTD-SALES -                             06483801
064838                 WS-IN-LY-MTD-SALES)                              06483901
064839               / WS-IN-LY-MTD-SALES)     *  100                   06484001
064840           ON SIZE ERROR                                          06484101
064841               MOVE 9999.9  TO PV-PCT-CHANGE                      06484201
064842         END-COMPUTE                                              06484301
064843         COMPUTE DL1-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       06484401
064844             PV-PCT-CHANGE * 1                                    06484501
064845     END-IF.                                                      06484601
064846     IF WS-IN-LY-YTD-SALES = 0                                    06484701
064847       OR WS-IN-TY-YTD-SALES = 0                                  06484801
064848         MOVE '    N/A'    TO DL1-YTD-PCT-NA(PV-PAGE-LINE)        06484901
064849     ELSE                                                         06485001
064850         COMPUTE PV-PCT-CHANGE =                                  06485101
064851               ((WS-IN-TY-YTD-SALES -                             06485201
064852                 WS-IN-LY-YTD-SALES)                              06485301
064853               / WS-IN-LY-YTD-SALES)     *  100                   06485401
064854           ON SIZE ERROR                                          06485501
064855               MOVE 9999.9  TO PV-PCT-CHANGE                      06485601
064856         END-COMPUTE                                              06485701
064857         COMPUTE DL1-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       06485801
064858             PV-PCT-CHANGE * 1                                    06485901
064859     END-IF.                                                      06486001
064860                                                                  06486101
064861     IF WS-IN-REC-CODE = '04' OR '05'                             06486201
064862**       REPORT ON LAST YEAR'S STORE SALES IN MILLIONS            06486300
064863         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      06486400
064864                 WS-IN-LY-TOTAL-SALES / 1000000                   06486500
064865         MOVE PV-DIV-BY-1000000                                   06486600
064866                           TO DL1-LY-TOTAL-SALES(PV-PAGE-LINE)    06486700
064867**       REPORT ON THIS YEAR'S STORE SALES IN MILLIONS            06486800
064868         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      06486900
064869                 WS-IN-SORT-STORE-SALES / 1000000                 06487000
064870         MOVE PV-DIV-BY-1000000                                   06487100
064871                           TO DL1-TY-TOTAL-SALES(PV-PAGE-LINE)    06487200
064872     ELSE                                                         06487300
064873         MOVE SPACES       TO DL1-TY-TOTAL-SALES-X(PV-PAGE-LINE)  06487400
064874     END-IF.                                                      06487500
064875                                                                  06487600
064876                                                                  06487700
064877                                                                  06487800
064878******************************************************************06487900
064879* FORMAT THE COLUMN 1 LINE FOR COMP STORES ONLY                   06488000
064880* (STATE, METRO AND COMPANY).                                     06488100
064881******************************************************************06488200
064882                                                                  06488300
064883 2510-FORMAT-COL1-COMP-LINE.                                      06488400
064884                                                                  06488500
064885     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06488600
064886             WS-IN-TY-COMP-DLY-SALES / 1000.                      06488700
064887     MOVE PV-DIV-BY-1000     TO DL1-TY-DAILY-SALES(PV-PAGE-LINE). 06488800
064888     IF WS-IN-LY-COMP-DLY-SALES = 0                               06488900
064889       OR WS-IN-TY-COMP-DLY-SALES = 0                             06489000
WEEK53       OR WS-IN-DURING-WEEK-53 = 'Y'                              06489101
064890         MOVE '    N/A'      TO DL1-TY-LY-PCT-NA (PV-PAGE-LINE)   06489200
064891     ELSE                                                         06489300
064892         COMPUTE PV-PCT-CHANGE =                                  06489400
064893               ((WS-IN-TY-COMP-DLY-SALES -                        06489500
064894                 WS-IN-LY-COMP-DLY-SALES)                         06489600
064895               / WS-IN-LY-COMP-DLY-SALES)     *  100              06489700
064896           ON SIZE ERROR                                          06489800
064897               MOVE 9999.9  TO PV-PCT-CHANGE                      06489900
064898         END-COMPUTE                                              06490000
064899         COMPUTE DL1-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =     06490100
064900             PV-PCT-CHANGE * 1                                    06490200
064901     END-IF.                                                      06490300
064902     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06490400
064903             WS-IN-TY-COMP-MTD-SALES / 1000.                      06490500
064904     MOVE PV-DIV-BY-1000     TO DL1-MTD-SALES (PV-PAGE-LINE).     06490600
064905     IF WS-IN-LY-COMP-MTD-SALES = 0                               06490700
064906       OR WS-IN-TY-COMP-MTD-SALES = 0                             06490800
064907         MOVE '    N/A'      TO DL1-MTD-PCT-NA (PV-PAGE-LINE)     06490900
064908     ELSE                                                         06491000
064909         COMPUTE PV-PCT-CHANGE =                                  06491100
064910               ((WS-IN-TY-COMP-MTD-SALES -                        06491200
064911                 WS-IN-LY-COMP-MTD-SALES)                         06491300
064912               / WS-IN-LY-COMP-MTD-SALES)     *  100              06491400
064913           ON SIZE ERROR                                          06491500
064914               MOVE 9999.9  TO PV-PCT-CHANGE                      06491600
064915         END-COMPUTE                                              06491700
064916         COMPUTE DL1-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       06491800
064917             PV-PCT-CHANGE * 1                                    06491900
064918     END-IF.                                                      06492000
064919     IF WS-IN-LY-COMP-YTD-SALES = 0                               06492100
064920       OR WS-IN-TY-COMP-YTD-SALES = 0                             06492200
064921         MOVE '    N/A'    TO DL1-YTD-PCT-NA(PV-PAGE-LINE)        06492300
064922     ELSE                                                         06492400
064923         COMPUTE PV-PCT-CHANGE =                                  06492500
064924               ((WS-IN-TY-COMP-YTD-SALES -                        06492600
064925                 WS-IN-LY-COMP-YTD-SALES)                         06492700
064926               / WS-IN-LY-COMP-YTD-SALES)     *  100              06492800
064927           ON SIZE ERROR                                          06492900
064928               MOVE 9999.9  TO PV-PCT-CHANGE                      06493000
064929         END-COMPUTE                                              06493100
064930         COMPUTE DL1-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       06493200
064931             PV-PCT-CHANGE * 1                                    06493300
064932     END-IF.                                                      06493400
064933     MOVE SPACES       TO DL1-TY-TOTAL-SALES-X(PV-PAGE-LINE).     06493500
064940                                                                  06494000
064948                                                                  06494800
064950******************************************************************06495000
065000* LOAD DATA TO THE SECOND COLUMN ON THE PAGE.                     06500000
065100* CHECK IF A CONTINUATION LINE FROM THE FIRST COLUMN IS REQUIRED. 06510000
065200******************************************************************06520000
065300 2600-LOAD-COLUMN-2.                                              06530000
065400                                                                  06540000
065500     IF PV-PAGE-LINE = 1                                          06550000
065600         IF WS-IN-REC-CODE = '02'                                 06560000
065700**           STATE CONTINUATION LINE IS REQUIRED                  06570000
065800             STRING WS-IN-STATE ' (CONT)'                         06580000
065900               DELIMITED BY SIZE                                  06590000
066000                 INTO DL-DETAIL-LINE-COLUMN-2 (PV-PAGE-LINE)      06600000
066100             MOVE 2            TO PV-PAGE-LINE                    06610000
066200             ADD +1            TO PV-DATA-COUNT                   06620000
066300         ELSE                                                     06630000
066400             IF WS-IN-REC-CODE = '04'                             06640000
066500**           STATE / METRO CONTINUATION LINE IS REQUIRED          06650000
066600                 STRING WS-IN-STATE ' ' PV-CONT-METRO-NAME        06660000
066700                        ' (CONT)'                                 06670000
066800                   DELIMITED BY SIZE                              06680000
066900                     INTO DL-DETAIL-LINE-COLUMN-2 (PV-PAGE-LINE)  06690000
067000                 MOVE 2        TO PV-PAGE-LINE                    06700000
067100                 ADD +1        TO PV-DATA-COUNT                   06710000
067200             END-IF                                               06720000
067300         END-IF                                                   06730000
067400     END-IF.                                                      06740000
067500                                                                  06750000
067510     IF WS-IN-REC-CODE = '00'                                     06751000
067520**       00 = STATE - WRITE STATE COMP LINE                       06752000
067530         MOVE SPACES   TO DL-DETAIL-LINE-COLUMN-2 (PV-PAGE-LINE)  06753000
067540         MOVE WS-IN-STATE TO DL2-STATE (PV-PAGE-LINE)             06754000
067550         MOVE ' - COMP'   TO DL2-STATE-COMP-DESC (PV-PAGE-LINE)   06755000
067560         PERFORM 2610-FORMAT-COL2-COMP-LINE                       06756000
067570     ELSE                                                         06757000
067580         IF WS-IN-REC-CODE = '02'                                 06758000
067590**           02 = METRO - WRITE METRO COMP LINE                   06759000
067591             MOVE SPACES TO DL-DETAIL-LINE-COLUMN-2(PV-PAGE-LINE) 06759100
067592             MOVE WS-IN-MULT-METRO-IND                            06759200
067593                             TO DL2-MULT-METRO-IND (PV-PAGE-LINE) 06759300
067594             MOVE ' - COMP'  TO PV-METRO-ALL-COMP-DESC            06759400
067595             PERFORM 2800-FORMAT-METRO-NAME                       06759500
067596             MOVE PV-FORMATTED-METRO-NAME                         06759600
067597                             TO DL2-METRO-NAME(PV-PAGE-LINE)      06759700
067598             PERFORM 2610-FORMAT-COL2-COMP-LINE                   06759800
067599         ELSE                                                     06759900
067600             IF WS-IN-REC-CODE = '04'                             06760000
067601**               04 = STORE - WRITE STORE ALL LINE                06760100
067602                 MOVE WS-IN-STORE-NAME                            06760200
067603                                  TO DL2-STORE-NAME(PV-PAGE-LINE) 06760300
067604                 PERFORM 2605-FORMAT-COL2-ALL-LINE                06760400
067605             ELSE                                                 06760500
059510                 IF WS-IN-REC-CODE = '05'                         06760600
059510                     IF WS-IN-STORE > 0                           06760700
059600**                       05 = ECOM STORE - WRITE STORE ALL LINE   06760800
059800                         MOVE WS-IN-STORE-NAME                    06760900
059900                                  TO DL2-STORE-NAME(PV-PAGE-LINE) 06761000
059901                         PERFORM 2605-FORMAT-COL2-ALL-LINE        06761100
059910                     ELSE                                         06761200
059600**                       05 = ECOM METRO - WRITE METRO COMP LINE  06761300
059600**                            BUT ALIGN METRO UNDER STATE NAMES   06761400
059070                         MOVE ' - COMP'  TO PV-METRO-ALL-COMP-DESC06761500
059080                         PERFORM 2800-FORMAT-METRO-NAME           06761600
059090                         MOVE PV-FORMATTED-METRO-NAME             06761700
059091                             TO DL2-STATE-DESC(PV-PAGE-LINE)      06761800
059092                         PERFORM 2610-FORMAT-COL2-COMP-LINE       06761900
059910                 ELSE                                             06762000
059920**                   06 = COMPANY - WRITE ALL AND COMP LINES      06762100
059921                     MOVE 'COMPANY TOTAL- ALL '                   06762200
059940                                 TO DL2-DESCRIPTION(PV-PAGE-LINE) 06762300
059941                     PERFORM 2605-FORMAT-COL2-ALL-LINE            06762400
059960                     ADD +1          TO PV-DATA-COUNT             06762500
059970                                        PV-PAGE-LINE              06762600
059980                     MOVE SPACES                                  06762700
059990                         TO DL-DETAIL-LINE-COLUMN-2(PV-PAGE-LINE) 06762800
059991                     MOVE 'COMPANY TOTAL- COMP'                   06762900
059992                                 TO DL2-DESCRIPTION(PV-PAGE-LINE) 06763000
059993                     PERFORM 2610-FORMAT-COL2-COMP-LINE           06763100
060000                 END-IF                                           06763200
060000             END-IF                                               06763300
067618         END-IF                                                   06764600
067619     END-IF.                                                      06764700
067620                                                                  06765000
073819                                                                  07381900
073820******************************************************************07382000
073821* FORMAT THE COLUMN 2 LINE FOR ALL STORES (STORE AND COMPANY).    07382100
073822******************************************************************07382200
073823                                                                  07382300
073824 2605-FORMAT-COL2-ALL-LINE.                                       07382400
073825                                                                  07382500
073826     COMPUTE PV-DIV-BY-1000 ROUNDED =                             07382600
073827             WS-IN-TY-DAILY-SALES / 1000.                         07382700
073828     MOVE PV-DIV-BY-1000     TO DL2-TY-DAILY-SALES(PV-PAGE-LINE). 07382800
073829     IF WS-IN-LY-DAILY-SALES = 0                                  07382900
073830       OR WS-IN-TY-DAILY-SALES = 0                                07383000
WEEK53       OR WS-IN-DURING-WEEK-53 = 'Y'                              07383101
073831         MOVE '    N/A'      TO DL2-TY-LY-PCT-NA (PV-PAGE-LINE)   07383200
073832     ELSE                                                         07383300
073833         COMPUTE PV-PCT-CHANGE =                                  07383400
073834               ((WS-IN-TY-DAILY-SALES -                           07383500
073835                 WS-IN-LY-DAILY-SALES)                            07383600
073836               / WS-IN-LY-DAILY-SALES)     *  100                 07383700
073837           ON SIZE ERROR                                          07383800
073838               MOVE 9999.9  TO  PV-PCT-CHANGE                     07383900
073839         END-COMPUTE                                              07384000
073840         COMPUTE DL2-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =     07384100
073841             PV-PCT-CHANGE * 1                                    07384200
073842     END-IF.                                                      07384300
073843     COMPUTE PV-DIV-BY-1000 ROUNDED =                             07384400
073844             WS-IN-TY-MTD-SALES / 1000.                           07384500
073845     MOVE PV-DIV-BY-1000     TO DL2-MTD-SALES (PV-PAGE-LINE).     07384600
073846     IF WS-IN-LY-MTD-SALES = 0                                    07384700
073847       OR WS-IN-TY-MTD-SALES = 0                                  07384800
073848         MOVE '    N/A'      TO DL2-MTD-PCT-NA (PV-PAGE-LINE)     07384900
073849     ELSE                                                         07385000
073850         COMPUTE PV-PCT-CHANGE =                                  07385100
073851               ((WS-IN-TY-MTD-SALES -                             07385200
073852                 WS-IN-LY-MTD-SALES)                              07385300
073853               / WS-IN-LY-MTD-SALES)     *  100                   07385400
073854           ON SIZE ERROR                                          07385500
073855               MOVE 9999.9  TO PV-PCT-CHANGE                      07385600
073856         END-COMPUTE                                              07385700
073857         COMPUTE DL2-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       07385800
073858             PV-PCT-CHANGE * 1                                    07385900
073859     END-IF.                                                      07386000
073860     IF WS-IN-LY-YTD-SALES = 0                                    07386100
073861       OR WS-IN-TY-YTD-SALES = 0                                  07386200
073862         MOVE '    N/A'    TO DL2-YTD-PCT-NA(PV-PAGE-LINE)        07386300
073863     ELSE                                                         07386400
073864         COMPUTE PV-PCT-CHANGE =                                  07386500
073865               ((WS-IN-TY-YTD-SALES -                             07386600
073866                 WS-IN-LY-YTD-SALES)                              07386700
073867               / WS-IN-LY-YTD-SALES)     *  100                   07386800
073868           ON SIZE ERROR                                          07386900
073869               MOVE 9999.9  TO PV-PCT-CHANGE                      07387000
073870         END-COMPUTE                                              07387100
073871         COMPUTE DL2-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       07387200
073872             PV-PCT-CHANGE * 1                                    07387300
073873     END-IF.                                                      07387400
073874                                                                  07387500
064861     IF WS-IN-REC-CODE = '04' OR '05'                             07387600
073876**       REPORT ON LAST YEAR'S STORE SALES IN MILLIONS            07387700
073877         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      07387800
073878                 WS-IN-LY-TOTAL-SALES / 1000000                   07387900
073879         MOVE PV-DIV-BY-1000000                                   07388000
073880                           TO DL2-LY-TOTAL-SALES(PV-PAGE-LINE)    07388100
073881**       REPORT ON THIS YEAR'S STORE SALES IN MILLIONS            07388200
073882         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      07388300
073883                 WS-IN-SORT-STORE-SALES / 1000000                 07388400
073884         MOVE PV-DIV-BY-1000000                                   07388500
073885                           TO DL2-TY-TOTAL-SALES(PV-PAGE-LINE)    07388600
073886     ELSE                                                         07388700
073887         MOVE SPACES       TO DL2-TY-TOTAL-SALES-X(PV-PAGE-LINE)  07388800
073888     END-IF.                                                      07388900
073889                                                                  07389000
073890                                                                  07389100
073891******************************************************************07389200
073892* FORMAT THE COLUMN 2 LINE FOR COMP STORES ONLY                   07389300
073893* (STATE, METRO AND COMPANY).                                     07389400
073894******************************************************************07389500
073895                                                                  07389600
073896 2610-FORMAT-COL2-COMP-LINE.                                      07389700
073897                                                                  07389800
073898     COMPUTE PV-DIV-BY-1000 ROUNDED =                             07389900
073899             WS-IN-TY-COMP-DLY-SALES / 1000.                      07390000
073900     MOVE PV-DIV-BY-1000     TO DL2-TY-DAILY-SALES(PV-PAGE-LINE). 07390100
073901     IF WS-IN-LY-COMP-DLY-SALES = 0                               07390200
073902       OR WS-IN-TY-COMP-DLY-SALES = 0                             07390300
WEEK53       OR WS-IN-DURING-WEEK-53 = 'Y'                              07390401
073903         MOVE '    N/A'      TO DL2-TY-LY-PCT-NA (PV-PAGE-LINE)   07390500
073904     ELSE                                                         07390600
073905         COMPUTE PV-PCT-CHANGE =                                  07390700
073906               ((WS-IN-TY-COMP-DLY-SALES -                        07390800
073907                 WS-IN-LY-COMP-DLY-SALES)                         07390900
073908               / WS-IN-LY-COMP-DLY-SALES)     *  100              07391000
073909           ON SIZE ERROR                                          07391100
073910               MOVE 9999.9  TO PV-PCT-CHANGE                      07391200
073911         END-COMPUTE                                              07391300
073912         COMPUTE DL2-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =     07391400
073913             PV-PCT-CHANGE * 1                                    07391500
073914     END-IF.                                                      07391600
073915     COMPUTE PV-DIV-BY-1000 ROUNDED =                             07391700
073916             WS-IN-TY-COMP-MTD-SALES / 1000.                      07391800
073917     MOVE PV-DIV-BY-1000     TO DL2-MTD-SALES (PV-PAGE-LINE).     07391900
073918     IF WS-IN-LY-COMP-MTD-SALES = 0                               07392000
073919       OR WS-IN-TY-COMP-MTD-SALES = 0                             07392100
073920         MOVE '    N/A'      TO DL2-MTD-PCT-NA (PV-PAGE-LINE)     07392200
073921     ELSE                                                         07392300
073922         COMPUTE PV-PCT-CHANGE =                                  07392400
073923               ((WS-IN-TY-COMP-MTD-SALES -                        07392500
073924                 WS-IN-LY-COMP-MTD-SALES)                         07392600
073925               / WS-IN-LY-COMP-MTD-SALES)     *  100              07392700
073926           ON SIZE ERROR                                          07392800
073927               MOVE 9999.9  TO PV-PCT-CHANGE                      07392900
073928         END-COMPUTE                                              07393000
073929         COMPUTE DL2-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       07393100
073930             PV-PCT-CHANGE * 1                                    07393200
073931     END-IF.                                                      07393300
073932     IF WS-IN-LY-COMP-YTD-SALES = 0                               07393400
073933       OR WS-IN-TY-COMP-YTD-SALES = 0                             07393500
073934         MOVE '    N/A'    TO DL2-YTD-PCT-NA(PV-PAGE-LINE)        07393600
073935     ELSE                                                         07393700
073936         COMPUTE PV-PCT-CHANGE =                                  07393800
073937               ((WS-IN-TY-COMP-YTD-SALES -                        07393900
073938                 WS-IN-LY-COMP-YTD-SALES)                         07394000
073939               / WS-IN-LY-COMP-YTD-SALES)     *  100              07394100
073940           ON SIZE ERROR                                          07394200
073941               MOVE 9999.9  TO PV-PCT-CHANGE                      07394300
073942         END-COMPUTE                                              07394400
073943         COMPUTE DL2-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       07394500
073944             PV-PCT-CHANGE * 1                                    07394600
073945     END-IF.                                                      07394700
073946     MOVE SPACES       TO DL2-TY-TOTAL-SALES-X(PV-PAGE-LINE).     07394800
073947                                                                  07394900
073948                                                                  07395000
073950******************************************************************07396000
074000* LOAD DATA TO THE THIRD COLUMN ON THE PAGE.                      07400000
074100* CHECK IF A CONTINUATION LINE FROM THE SECOND COLUMN IS REQUIRED.07410000
074200******************************************************************07420000
074300 2700-LOAD-COLUMN-3.                                              07430000
074400                                                                  07440000
074500     IF PV-PAGE-LINE = 1                                          07450000
074600         IF WS-IN-REC-CODE = '02'                                 07460000
074700**           STATE CONTINUATION LINE IS REQUIRED                  07470000
074800             STRING WS-IN-STATE ' (CONT)'                         07480000
074900               DELIMITED BY SIZE                                  07490000
075000                 INTO DL-DETAIL-LINE-COLUMN-3 (PV-PAGE-LINE)      07500000
075100             MOVE 2            TO PV-PAGE-LINE                    07510000
075200             ADD +1            TO PV-DATA-COUNT                   07520000
075300         ELSE                                                     07530000
075400             IF WS-IN-REC-CODE = '04'                             07540000
075500**           STATE / METRO CONTINUATION LINE IS REQUIRED          07550000
075600                 STRING WS-IN-STATE ' ' PV-CONT-METRO-NAME        07560000
075700                        ' (CONT)'                                 07570000
075800                   DELIMITED BY SIZE                              07580000
075900                     INTO DL-DETAIL-LINE-COLUMN-3 (PV-PAGE-LINE)  07590000
076000                 MOVE 2        TO PV-PAGE-LINE                    07600000
076100                 ADD +1        TO PV-DATA-COUNT                   07610000
076200             END-IF                                               07620000
076300         END-IF                                                   07630000
076400     END-IF.                                                      07640000
076410                                                                  07641000
076420     IF WS-IN-REC-CODE = '00'                                     07642000
076430**       00 = STATE - WRITE STATE COMP LINE                       07643000
076440         MOVE SPACES   TO DL-DETAIL-LINE-COLUMN-3 (PV-PAGE-LINE)  07644000
076450         MOVE WS-IN-STATE TO DL3-STATE (PV-PAGE-LINE)             07645000
076460         MOVE ' - COMP'   TO DL3-STATE-COMP-DESC (PV-PAGE-LINE)   07646000
076470         PERFORM 2710-FORMAT-COL3-COMP-LINE                       07647000
076480     ELSE                                                         07648000
076490         IF WS-IN-REC-CODE = '02'                                 07649000
076491**           02 = METRO - WRITE METRO COMP LINE                   07649100
076492             MOVE SPACES TO DL-DETAIL-LINE-COLUMN-3(PV-PAGE-LINE) 07649200
076493             MOVE WS-IN-MULT-METRO-IND                            07649300
076494                             TO DL3-MULT-METRO-IND (PV-PAGE-LINE) 07649400
076495             MOVE ' - COMP'  TO PV-METRO-ALL-COMP-DESC            07649500
076496             PERFORM 2800-FORMAT-METRO-NAME                       07649600
076497             MOVE PV-FORMATTED-METRO-NAME                         07649700
076498                             TO DL3-METRO-NAME(PV-PAGE-LINE)      07649800
076499             PERFORM 2710-FORMAT-COL3-COMP-LINE                   07649900
076500         ELSE                                                     07650000
076501             IF WS-IN-REC-CODE = '04'                             07650100
076502**               04 = STORE - WRITE STORE ALL LINE                07650200
076503                 MOVE WS-IN-STORE-NAME                            07650300
076504                                  TO DL3-STORE-NAME(PV-PAGE-LINE) 07650400
076505                 PERFORM 2705-FORMAT-COL3-ALL-LINE                07650500
076506             ELSE                                                 07650600
059510                 IF WS-IN-REC-CODE = '05'                         07650700
059510                     IF WS-IN-STORE > 0                           07650800
059600**                       05 = ECOM STORE - WRITE STORE ALL LINE   07650900
059800                         MOVE WS-IN-STORE-NAME                    07651000
059900                                  TO DL3-STORE-NAME(PV-PAGE-LINE) 07651100
059901                         PERFORM 2705-FORMAT-COL3-ALL-LINE        07651200
059910                     ELSE                                         07651300
059600**                       05 = ECOM METRO - WRITE METRO COMP LINE  07651400
059600**                            BUT ALIGN METRO UNDER STATE NAMES   07651500
059070                         MOVE ' - COMP'  TO PV-METRO-ALL-COMP-DESC07651600
059080                         PERFORM 2800-FORMAT-METRO-NAME           07651700
059090                         MOVE PV-FORMATTED-METRO-NAME             07651800
059091                             TO DL3-STATE-DESC(PV-PAGE-LINE)      07651900
059092                         PERFORM 2710-FORMAT-COL3-COMP-LINE       07652000
059910                 ELSE                                             07652100
059920**                   06 = COMPANY - WRITE ALL AND COMP LINES      07652200
059921                     MOVE 'COMPANY TOTAL- ALL '                   07652300
059940                                 TO DL3-DESCRIPTION(PV-PAGE-LINE) 07652400
059941                     PERFORM 2705-FORMAT-COL3-ALL-LINE            07652500
059960                     ADD +1          TO PV-DATA-COUNT             07652600
059970                                        PV-PAGE-LINE              07652700
059980                     MOVE SPACES                                  07652800
059990                         TO DL-DETAIL-LINE-COLUMN-3(PV-PAGE-LINE) 07652900
059991                     MOVE 'COMPANY TOTAL- COMP'                   07653000
059992                                 TO DL3-DESCRIPTION(PV-PAGE-LINE) 07653100
059993                     PERFORM 2710-FORMAT-COL3-COMP-LINE           07653200
060000                 END-IF                                           07653300
076518             END-IF                                               07654500
076519         END-IF                                                   07654600
076520     END-IF.                                                      07654700
076530                                                                  07655000
082820                                                                  08282000
082821******************************************************************08282100
082822* FORMAT THE COLUMN 3 LINE FOR ALL STORES (STORE AND COMPANY).    08282200
082823******************************************************************08282300
082824                                                                  08282400
082825 2705-FORMAT-COL3-ALL-LINE.                                       08282500
082826                                                                  08282600
082827     COMPUTE PV-DIV-BY-1000 ROUNDED =                             08282700
082828             WS-IN-TY-DAILY-SALES / 1000.                         08282800
082829     MOVE PV-DIV-BY-1000     TO DL3-TY-DAILY-SALES(PV-PAGE-LINE). 08282900
082830     IF WS-IN-LY-DAILY-SALES = 0                                  08283000
082831       OR WS-IN-TY-DAILY-SALES = 0                                08283100
WEEK53       OR WS-IN-DURING-WEEK-53 = 'Y'                              08283201
082832         MOVE '    N/A'      TO DL3-TY-LY-PCT-NA (PV-PAGE-LINE)   08283300
082833     ELSE                                                         08283400
082834         COMPUTE PV-PCT-CHANGE =                                  08283500
082835               ((WS-IN-TY-DAILY-SALES -                           08283600
082836                 WS-IN-LY-DAILY-SALES)                            08283700
082837               / WS-IN-LY-DAILY-SALES)     *  100                 08283800
082838           ON SIZE ERROR                                          08283900
082839               MOVE 9999.9  TO  PV-PCT-CHANGE                     08284000
082840         END-COMPUTE                                              08284100
082841         COMPUTE DL3-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =     08284200
082842             PV-PCT-CHANGE * 1                                    08284300
082843     END-IF.                                                      08284400
082844     COMPUTE PV-DIV-BY-1000 ROUNDED =                             08284500
082845             WS-IN-TY-MTD-SALES / 1000.                           08284600
082846     MOVE PV-DIV-BY-1000     TO DL3-MTD-SALES (PV-PAGE-LINE).     08284700
082847     IF WS-IN-LY-MTD-SALES = 0                                    08284800
082848       OR WS-IN-TY-MTD-SALES = 0                                  08284900
082849         MOVE '    N/A'      TO DL3-MTD-PCT-NA (PV-PAGE-LINE)     08285000
082850     ELSE                                                         08285100
082851         COMPUTE PV-PCT-CHANGE =                                  08285200
082852               ((WS-IN-TY-MTD-SALES -                             08285300
082853                 WS-IN-LY-MTD-SALES)                              08285400
082854               / WS-IN-LY-MTD-SALES)     *  100                   08285500
082855           ON SIZE ERROR                                          08285600
082856               MOVE 9999.9  TO PV-PCT-CHANGE                      08285700
082857         END-COMPUTE                                              08285800
082858         COMPUTE DL3-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       08285900
082859             PV-PCT-CHANGE * 1                                    08286000
082860     END-IF.                                                      08286100
082861     IF WS-IN-LY-YTD-SALES = 0                                    08286200
082862       OR WS-IN-TY-YTD-SALES = 0                                  08286300
082863         MOVE '    N/A'    TO DL3-YTD-PCT-NA(PV-PAGE-LINE)        08286400
082864     ELSE                                                         08286500
082865         COMPUTE PV-PCT-CHANGE =                                  08286600
082866               ((WS-IN-TY-YTD-SALES -                             08286700
082867                 WS-IN-LY-YTD-SALES)                              08286800
082868               / WS-IN-LY-YTD-SALES)     *  100                   08286900
082869           ON SIZE ERROR                                          08287000
082870               MOVE 9999.9  TO PV-PCT-CHANGE                      08287100
082871         END-COMPUTE                                              08287200
082872         COMPUTE DL3-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       08287300
082873             PV-PCT-CHANGE * 1                                    08287400
082874     END-IF.                                                      08287500
082875                                                                  08287600
064861     IF WS-IN-REC-CODE = '04' OR '05'                             08287700
082877**       REPORT ON LAST YEAR'S STORE SALES IN MILLIONS            08287800
082878         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      08287900
082879                 WS-IN-LY-TOTAL-SALES / 1000000                   08288000
082880         MOVE PV-DIV-BY-1000000                                   08288100
082881                           TO DL3-LY-TOTAL-SALES(PV-PAGE-LINE)    08288200
082882**       REPORT ON THIS YEAR'S STORE SALES IN MILLIONS            08288300
082883         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      08288400
082884                 WS-IN-SORT-STORE-SALES / 1000000                 08288500
082885         MOVE PV-DIV-BY-1000000                                   08288600
082886                           TO DL3-TY-TOTAL-SALES(PV-PAGE-LINE)    08288700
082887     ELSE                                                         08288800
082888         MOVE SPACES       TO DL3-TY-TOTAL-SALES-X(PV-PAGE-LINE)  08288900
082889     END-IF.                                                      08289000
082890                                                                  08289100
082891                                                                  08289200
082892******************************************************************08289300
082893* FORMAT THE COLUMN 3 LINE FOR COMP STORES ONLY                   08289400
082894* (STATE, METRO AND COMPANY).                                     08289500
082895******************************************************************08289600
082896                                                                  08289700
082897 2710-FORMAT-COL3-COMP-LINE.                                      08289800
082898                                                                  08289900
082899     COMPUTE PV-DIV-BY-1000 ROUNDED =                             08290000
082900             WS-IN-TY-COMP-DLY-SALES / 1000.                      08290100
082901     MOVE PV-DIV-BY-1000     TO DL3-TY-DAILY-SALES(PV-PAGE-LINE). 08290200
082902     IF WS-IN-LY-COMP-DLY-SALES = 0                               08290300
082903       OR WS-IN-TY-COMP-DLY-SALES = 0                             08290400
WEEK53       OR WS-IN-DURING-WEEK-53 = 'Y'                              08290501
082904         MOVE '    N/A'      TO DL3-TY-LY-PCT-NA (PV-PAGE-LINE)   08290600
082905     ELSE                                                         08290700
082906         COMPUTE PV-PCT-CHANGE =                                  08290800
082907               ((WS-IN-TY-COMP-DLY-SALES -                        08290900
082908                 WS-IN-LY-COMP-DLY-SALES)                         08291000
082909               / WS-IN-LY-COMP-DLY-SALES)     *  100              08291100
082910           ON SIZE ERROR                                          08291200
082911               MOVE 9999.9  TO PV-PCT-CHANGE                      08291300
082912         END-COMPUTE                                              08291400
082913         COMPUTE DL3-TY-LY-PCT-CHANGE (PV-PAGE-LINE) ROUNDED =    08291500
082914             PV-PCT-CHANGE * 1                                    08291600
082915     END-IF.                                                      08291700
082916     COMPUTE PV-DIV-BY-1000 ROUNDED =                             08291800
082917             WS-IN-TY-COMP-MTD-SALES / 1000.                      08291900
082918     MOVE PV-DIV-BY-1000     TO DL3-MTD-SALES (PV-PAGE-LINE).     08292000
082919     IF WS-IN-LY-COMP-MTD-SALES = 0                               08292100
082920       OR WS-IN-TY-COMP-MTD-SALES = 0                             08292200
082921         MOVE '    N/A'      TO DL3-MTD-PCT-NA (PV-PAGE-LINE)     08292300
082922     ELSE                                                         08292400
082923         COMPUTE PV-PCT-CHANGE =                                  08292500
082924               ((WS-IN-TY-COMP-MTD-SALES -                        08292600
082925                 WS-IN-LY-COMP-MTD-SALES)                         08292700
082926               / WS-IN-LY-COMP-MTD-SALES)     *  100              08292800
082927           ON SIZE ERROR                                          08292900
082928               MOVE 9999.9  TO PV-PCT-CHANGE                      08293000
082929         END-COMPUTE                                              08293100
082930         COMPUTE DL3-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       08293200
082931             PV-PCT-CHANGE * 1                                    08293300
082932     END-IF.                                                      08293400
082933     IF WS-IN-LY-COMP-YTD-SALES = 0                               08293500
082934       OR WS-IN-TY-COMP-YTD-SALES = 0                             08293600
082935         MOVE '    N/A'    TO DL3-YTD-PCT-NA(PV-PAGE-LINE)        08293700
082936     ELSE                                                         08293800
082937         COMPUTE PV-PCT-CHANGE =                                  08293900
082938               ((WS-IN-TY-COMP-YTD-SALES -                        08294000
082939                 WS-IN-LY-COMP-YTD-SALES)                         08294100
082940               / WS-IN-LY-COMP-YTD-SALES)     *  100              08294200
082941           ON SIZE ERROR                                          08294300
082942               MOVE 9999.9  TO PV-PCT-CHANGE                      08294400
082943         END-COMPUTE                                              08294500
082944         COMPUTE DL3-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       08294600
082945             PV-PCT-CHANGE * 1                                    08294700
082946     END-IF.                                                      08294800
082947     MOVE SPACES       TO DL3-TY-TOTAL-SALES-X(PV-PAGE-LINE).     08294900
082948                                                                  08295000
082949                                                                  08295100
082950******************************************************************08295200
082951* FORMAT THE METRO NAME AND ALL / COMP LITERAL                    08295300
082952******************************************************************08295400
082953                                                                  08295500
082954 2800-FORMAT-METRO-NAME.                                          08295600
082955                                                                  08295700
082956     MOVE WS-IN-METRO-NAME (1:12)   TO PV-CONT-METRO-NAME.        08295800
082957     PERFORM VARYING PV-SUB FROM 12 BY -1                         08295900
082958       UNTIL PV-CONT-METRO-NAME (PV-SUB:1) NOT = SPACE            08296000
082959          OR PV-SUB < 1                                           08296100
082960             CONTINUE                                             08296200
082961     END-PERFORM.                                                 08296300
082962                                                                  08296400
082963     MOVE SPACES   TO PV-FORMATTED-METRO-NAME                     08296500
082964     IF PV-SUB > 0                                                08296600
082965         STRING PV-CONT-METRO-NAME (1:PV-SUB)                     08296700
082966                PV-METRO-ALL-COMP-DESC                            08296800
082967             DELIMITED BY SIZE                                    08296900
082968                 INTO PV-FORMATTED-METRO-NAME                     08297000
082969     ELSE                                                         08297100
082970***      THIS SHOULD NEVER HAPPEN (METRO = SPACES).               08297200
082971         MOVE PV-METRO-ALL-COMP-DESC  TO PV-FORMATTED-METRO-NAME  08297300
082972     END-IF.                                                      08297400
082973                                                                  08297500
082974                                                                  08297600
082980******************************************************************08298000
083000* WRITE THE PAGE WHEN IT IS FULL (AT END OF JOB, A PARTIAL PAGE   08300000
083100* WILL BE WRITTEN.                                                08310000
083200******************************************************************08320000
083300 3000-WRITE-PAGE.                                                 08330000
083400                                                                  08340000
083500     MOVE PV-PAGE-COUNT TO DP200O-PAGE-NUMBER.                    08350000
083600                                                                  08360000
083700     WRITE REPORT-RECORD FROM DP200O-STANDRD-HEADER-200-COLS      08370000
083800          AFTER ADVANCING PAGE.                                   08380000
083900                                                                  08390000
084000     ADD 1 TO PV-PAGE-COUNT.                                      08400000
084100                                                                  08410003
WEEK53     IF CC-53-WEEK-IND = '53'                                     08411003
WEEK53**       FISCAL (NORMAL) VERSION OF REPORT WILL BE BLANK          08411101
WEEK53         STRING '(COMPARE TO CALENDAR DAY '                       08412004
WEEK53                 WS-IN-LY-SAME-FISCAL-DATE (6:2)                  08412105
WEEK53                 '/'                                              08412204
WEEK53                 WS-IN-LY-SAME-FISCAL-DATE (9:2)                  08412305
WEEK53                 '/'                                              08412404
WEEK53                 WS-IN-LY-SAME-FISCAL-DATE (1:4)                  08412504
WEEK53                 ')'                                              08412606
WEEK53             DELIMITED BY SIZE INTO HL-CALENDAR-LITERAL           08413004
WEEK53         END-STRING                                               08414004
WEEK53     END-IF.                                                      08414104
084100                                                                  08415001
084200     WRITE REPORT-RECORD FROM HL-HDR1 AFTER 1.                    08420000
084300     WRITE REPORT-RECORD FROM HL-HDR2 AFTER 1.                    08430000
084400     WRITE REPORT-RECORD FROM HL-HDR3 AFTER 1.                    08440000
084500                                                                  08450000
084600     PERFORM                                                      08460000
084700       VARYING PV-DATA-COUNT FROM 1 BY 1                          08470000
084800         UNTIL PV-DATA-COUNT > 95                                 08480000
084900           WRITE REPORT-RECORD FROM DL-DETAIL-LINE(PV-DATA-COUNT) 08490000
085000           AFTER 1                                                08500000
085100     END-PERFORM.                                                 08510000
085200                                                                  08520000
085210     MOVE '* INDICATES A METRO SPANNING MULTIPLE STATES'          08521000
085220                           TO DP200O-CNFDL-HDR-200-COLS (2:45).   08522000
085300     MOVE DP200O-CNFDL-HDR-200-COLS TO REPORT-RECORD.             08530000
085302     MOVE 'LY $ (MIL) APPEAR TO THE LEFT OF STORE NAME'           08530200
085304                           TO REPORT-RECORD (168:43).             08530400
085310     WRITE REPORT-RECORD  AFTER 1.                                08531000
085400                                                                  08540000
085500     MOVE SPACES    TO  DL-DETAIL-LINE-TABLE.                     08550000
085600                                                                  08560000
085700     MOVE 1 TO PV-DATA-COUNT.                                     08570000
085800                                                                  08580000
085900                                                                  08590000
086000******************************************************************08600000
086100* ABEND ROUTINE                                                   08610000
086200******************************************************************08620000
086300 8000-ABEND.                                                      08630000
086400                                                                  08640000
086500     PERFORM 9000-END-OF-JOB.                                     08650000
086600                                                                  08660000
086700     CALL 'ILBOABN0' USING ABEND-CODE.                            08670000
086800                                                                  08680000
086900                                                                  08690000
087000******************************************************************08700000
087100* PERFORMS TASK TERMINATION PROCESSING                            08710000
087200******************************************************************08720000
087300 9000-END-OF-JOB.                                                 08730000
087400                                                                  08740000
087500     CLOSE CTLCD-DATE-FILE                                        08750000
087600           INPUT-EXTRACT-FILE                                     08760000
087700           REPORT-FILE.                                           08770000
087800                                                                  08780000
087900     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 08790000
088000                                                                  08800000
088100     MOVE SYS-TIME (1:2) TO ST-END-HR.                            08810000
088200     MOVE SYS-TIME (3:2) TO ST-END-MN.                            08820000
088300                                                                  08830000
088400     DISPLAY '                    '.                              08840000
088500     DISPLAY '**********************'.                            08850000
088600     DISPLAY '   SSKRP025 CONTROLS  '.                            08860000
088700     DISPLAY '**********************'.                            08870000
088800     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         08880000
088900     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          08890000
089000     DISPLAY 'END TIME  = ' ST-END-TIME.                          08900000
089100     DISPLAY '======================'.                            08910000
089200     DISPLAY 'CNTL CARD: ' CC-CONTROL-CARD.                       08920000
WEEK53     DISPLAY 'CONTROL CARD 53 WEEK IND: ' CC-53-WEEK-IND.         08921003
089300     DISPLAY '            '.                                      08930000
089400     DISPLAY 'INPUT RECORDS READ = ' PA-INPUT-READ.               08940000
089500     DISPLAY '                    '.                              08950000
089600                                                                  08960000
089700                                                                  08970000
