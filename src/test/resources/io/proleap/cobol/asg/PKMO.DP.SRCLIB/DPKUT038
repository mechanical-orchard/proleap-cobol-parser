000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.    DPKUT038.                                         00040000
000500 AUTHOR.        CHUCK ALBERTY -- EXACTA.                          00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   DECEMBER, 1992.                                   00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000*  THIS PROGRAM DOES THE SAME THING IN CICS THAT DPKUT039 DOES   *00100002
001100*  IN BATCH.  WHAT THAT MEANS IS IT GETS INFORMATION FROM MBS    *00110002
001200*  TABLES.  IT IS INTENDED TO BE USED AS A COMMON ROUTINE THAT   *00120002
001300*  CAN BE LINKED TO BY OTHER CICS PROGRAMS.                      *00130002
001301*                                                                *00130102
001302*  DATE  06/10/97                                                *00130202
001303*  CHANGE MADE: NO CODE CHANGES. ADDITIONAL BINDS, AS DESCRIBED. *00130302
001304*    =*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=**00130402
001305*    =* THIS PLAN IS BOUND TO DP_CICS_COLL.                      *00130502
001306*    =* TO ALLOW THIS ROUTINE TO REMAIN ACCESSIBLE WHEN THE      *00130602
001307*    =* DB2 PACKAGE IS EXPLICITLY SET (USING COPYBOOKS           *00130702
001308*    =* DPWS038 & DPPD038) THIS ROUTINE NEEDS ADDITIONAL BINDS:  *00130802
001309*    =*     AH_CICS_COLL*                                        *00130902
001310*    =*     PO_CICS_COLL*                                        *00131002
001311*    =*     RC_CICS_COLL*                                        *00131102
001312*    =*     PC_CICS_COLL*                                        *00131202
001313*    =*     RV_CICS_COLL*                                        *00131302
001314*    =*     VN_CICS_COLL*                                        *00131402
001315*    =*           WHERE * = TEST..........DB2TDBA                *00131502
001316*    =*                     QA............COLLQA                 *00131602
001317*    =*                     LRN...........COLLLRN                *00131702
001318*    =*                     PROD..........COLL                   *00131802
001319*    =* NOTE1: AP ALSO NEEDS TEAM TEST....DB2ADBA9               *00131902
001320*    =* NOTE2: IF PROGRAMS FROM ADDITIONAL APPLICATIONS BEGIN    *00132002
001321*    =*        TO USE THIS ROUTINE, CORRESPONDING BINDS WILL     *00132102
001322*    =*        BE NEEDED FOR EACH OF THESE APPLICATIONS.         *00132202
001323*    =* PURGE-ARCHIVE-RETRIEVAL PROJECT.                         *00132302
001324*    =*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*    *00132402
001330*        MADE BY: CHERI MASTEL            WR/IR #: 3965          *00133002
001400******************************************************************00140000
001500*                                                                 00150000
001600*                                                                 00160000
001700******************************************************************00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900******************************************************************00190000
002000*                                                                 00200000
002100*                                                                 00210000
002200******************************************************************00220000
002300 DATA DIVISION.                                                   00230000
002400******************************************************************00240000
002500 WORKING-STORAGE SECTION.                                         00250000
002600*                                                                 00260000
002700******************************************************************00270000
002800***  COMMON WORKING STORAGE SHARED BY THIS PROGRAM AND THE BATCH  00280000
002900***  SUBROUTINE 'DPKUT039'.                                       00290000
003000******************************************************************00300000
003100     COPY DPWS007.                                                00310000
003200*                                                                 00320000
003300*                                                                 00330000
003400******************************************************************00340000
003500***  THESE FIELDS ARE USED TO PASS DATA TO AND FROM THE CALLING   00350000
003600***  PROGRAM AND THIS PROGRAM.  THIS MEMBER IS ALSO USED IN THE   00360000
003700***  BATCH SUBROUTINE 'DPKUT039'.                                 00370000
003800******************************************************************00380000
003900     COPY DPWS003.                                                00390000
004000*                                                                 00400000
004100*                                                                 00410000
004200 LINKAGE SECTION.                                                 00420000
004300******************************************************************00430000
004400**  MBS SUBROUTINE FIELDS                                         00440000
004500******************************************************************00450000
004600 01  DFHCOMMAREA                 PIC  X(1237).                    00460000
004700*                                                                 00470000
004800*                                                                 00480000
004900******************************************************************00490000
005000 PROCEDURE DIVISION.                                              00500000
005100******************************************************************00510000
005200                                                                  00520000
005300 0000-PROGRAM-MAINLINE.                                           00530000
005400******************************************************************00540000
005500*  CONTROLS THE MAIN PROCESSING OF THE PROGRAM.                   00550000
005600******************************************************************00560000
005700     PERFORM 1000-INITIAL-PROCESS.                                00570000
005800*                                                                 00580000
005900     PERFORM 2000-MAIN-PROCESS                                    00590000
006000       UNTIL PS-DONE-PROCESSING.                                  00600000
006100*                                                                 00610000
006200     MOVE DP003-MBS-SUBROUTINE-FIELDS                             00620000
006300                                     TO DFHCOMMAREA.              00630000
006400*                                                                 00640000
006500     GOBACK.                                                      00650000
006600*                                                                 00660000
006700*                                                                 00670000
006800 1000-INITIAL-PROCESS.                                            00680000
006900******************************************************************00690000
007000*  -- INITIALIZE FIELDS IN WORKING STORAGE THAT MUST BE BLANKED   00700000
007100*     OUT FOR MULTIPLE CALLS TO THIS SUBROUTINE IN ONE EXECUTION  00710000
007200*     OF A 'CALLING' PROGRAM.                                     00720000
007300*  -- SET THE RETURN CODE TO THE 'SUCCESSFUL' VALUE.              00730000
007400*  -- PERFORM VALIDATION OF INPUT FIELDS.                         00740000
007500*  -- IF ANY ERRORS ON INPUT FIELDS, SET SWITCH SO PROGRAM STOPS  00750000
007600*     PROCESSING BEFORE ANY OF THE 'REAL' PROCESSING TAKES PLACE. 00760000
007700******************************************************************00770000
007800     IF  EIBCALEN = 0                                             00780000
007900         INITIALIZE DP003-MBS-SUBROUTINE-FIELDS                   00790000
008000         MOVE PRV-01             TO DP003-RETURN-DATA             00800000
008100     ELSE                                                         00810000
008200         MOVE DFHCOMMAREA        TO DP003-MBS-SUBROUTINE-FIELDS   00820000
008300         INITIALIZE PS-DONE-PROCESSING-SW                         00830000
008400                    DP003-OUTPUT-FIELDS                           00840000
008500         MOVE PRV-00             TO DP003-RETURN-DATA             00850000
008600         PERFORM 1100-VALIDATE-INPUT-REQUEST                      00860000
008700     END-IF.                                                      00870000
008800*                                                                 00880000
008900     IF  DP003-SUCCESSFUL                                         00890000
009000         CONTINUE                                                 00900000
009100     ELSE                                                         00910000
009200         SET PS-DONE-PROCESSING  TO TRUE                          00920000
009300     END-IF.                                                      00930000
009400*                                                                 00940000
009500*                                                                 00950000
009600     COPY DPPD010.                                                00960000
