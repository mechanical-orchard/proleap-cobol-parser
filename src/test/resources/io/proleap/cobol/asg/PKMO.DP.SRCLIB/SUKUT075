000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKUT075.                                00050000
000600 AUTHOR.                 LYNN MCADAMS.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            AUGUST, 2002.                            00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200* THIS PROGRAM WILL CREATE AN EXTRACT FILE AT THE PO, RECEIVER,  *00120000
001300* LINE LEVEL.  THE INPUT FILE WILL BE THE RETAIN EXTRACT FROM    *00130000
001400* SUKUT073.  THE OUTPUT FILE CREATED IN THIS PROGRAM WILL BE     *00140000
001500* THE INPUT FOR THE REPORT PROGRAM SUKRP031.                     *00150000
001600*----------------------------------------------------------------*00160000
001700                                                                  00170000
001800******************************************************************00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000******************************************************************00200000
002100 INPUT-OUTPUT SECTION.                                            00210000
002200                                                                  00220000
002300 FILE-CONTROL.                                                    00230000
002400                                                                  00240000
002500     SELECT PO-FILE          ASSIGN TO INP01.                     00250000
002600     SELECT EXTRACT-FILE     ASSIGN TO OUT01.                     00260000
002700                                                                  00270000
002800******************************************************************00280000
002900 DATA DIVISION.                                                   00290000
003000******************************************************************00300000
003100 FILE SECTION.                                                    00310000
003200*                                                                 00320000
003300*                                                                 00330000
003400 FD  PO-FILE                                                      00340000
003500     RECORDING MODE IS F                                          00350000
003600     LABEL RECORDS ARE STANDARD                                   00360000
003700     BLOCK CONTAINS 0 RECORDS.                                    00370000
003800 01  PO-RECORD                   PIC X(300).                      00380000
003900*                                                                 00390000
004000 FD  EXTRACT-FILE                                                 00400000
004100     RECORDING MODE IS F                                          00410000
004200     LABEL RECORDS ARE STANDARD                                   00420000
004300     BLOCK CONTAINS 0 RECORDS.                                    00430000
004400 01  EXTRACT-RECORD              PIC X(300).                      00440000
004500*                                                                 00450000
004600***************************************************************** 00460000
004700 WORKING-STORAGE SECTION.                                         00470000
004800                                                                  00480000
004900 01  PS-PROGRAM-SWITCHES.                                         00490000
005000     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00500000
005100         88  PS-ERROR                         VALUE  'Y'.         00510000
005200         88  PS-WARNING                       VALUE  'W'.         00520000
005300         88  PS-NO-ERROR                      VALUE  'N'.         00530000
005400     05  PS-END-OF-PO-SW          PIC X(01)   VALUE 'N'.          00540000
005500         88  PS-END-OF-PO-FILE                VALUE 'Y'.          00550000
005600         88  PS-NOT-END-OF-PO-FILE            VALUE 'N'.          00560000
005700     05  PS-EOF-TOT-UNTS-VRFD-CSR-SW    PIC X(01)  VALUE 'N'.     00570000
005800         88  PS-EOF-TOT-UNTS-VRFD-CSR              VALUE 'Y'.     00580000
005900         88  PS-NOT-EOF-TOT-UNTS-VRFD-CSR          VALUE 'N'.     00590000
006000     05  PS-EOF-TOT-UNTS-MNIFD-CSR-SW PIC X(01)    VALUE 'N'.     00600000
006100         88  PS-EOF-TOT-UNTS-MNIFD-CSR             VALUE 'Y'.     00610000
006200         88  PS-NOT-EOF-TOT-UNTS-MNIFD-CSR         VALUE 'N'.     00620000
006300     05  PS-EOF-TOT-CTNS-LINE-CSR-SW PIC  X(01)    VALUE 'N'.     00630000
006400         88  PS-EOF-TOT-CTNS-LINE-CSR              VALUE 'Y'.     00640000
006500         88  PS-NOT-EOF-TOT-CTNS-LINE-CSR          VALUE 'N'.     00650000
006600     05  PS-EOF-VRFY-SRC-CSR-SW      PIC  X(01)    VALUE 'N'.     00660000
006700         88  PS-EOF-VRFY-SRC-CSR                   VALUE 'Y'.     00670000
006800         88  PS-NOT-EOF-VRFY-SRC-CSR               VALUE 'N'.     00680000
006900     05  PS-EOF-MFST-CTN-CSR-SW      PIC  X(01)    VALUE 'N'.     00690000
007000         88  PS-EOF-MFST-CTN-CSR                   VALUE 'Y'.     00700000
007100         88  PS-NOT-EOF-MFST-CTN-CSR               VALUE 'N'.     00710000
007200     05  PS-MFST-SW                  PIC  X(01)    VALUE 'N'.     00720000
007300         88  PS-MFSTD                              VALUE 'Y'.     00730000
007400         88  PS-NOT-MFSTD                          VALUE 'N'.     00740000
007500*                                                                 00750000
007600 01  PV-PROGRAM-VARIABLES.                                        00760000
007700     05  PV-DIFFERENCE                 PIC  9(07).                00770000
007800     05  PV-CURRENT-TIMESTAMP     PIC X(26)   VALUE               00780000
007900                                                 SPACES.          00790000
008000     05  PV-EXTRACT-DTE                PIC X(10).                 00800000
008100                                                                  00810000
008200     05  PV-SQLCODE                   PIC 9(9)   VALUE ZERO.      00820000
008300     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30) VALUE SPACES.    00830000
008400     05  PV-DISPLAY-SQLCODE           PIC -9(05) VALUE ZEROES.    00840000
008500     05  PV-SQL-RETURN-CD             PIC  999-.                  00850000
008600     05  PV-DB2-TABLE-NAME            PIC  X(08) VALUE SPACES.    00860000
008700     05  PV-DB2-TABLE-NAME1           PIC  X(08) VALUE SPACES.    00870000
008800                                                                  00880000
008900     05  PV-READ-COUNTER              PIC S9(09) VALUE ZERO       00890000
009000                                                  COMP SYNC.      00900000
009100     05  PV-FETCH-COUNTER             PIC S9(09) VALUE ZERO       00910000
009200                                                  COMP SYNC.      00920000
009300     05  PV-WRITE-COUNTER             PIC S9(09) VALUE ZERO       00930000
009400                                                  COMP SYNC.      00940000
009500     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            00950000
009600     05  PV-TOT-UNTS-VERIFD           PIC 9(06).                  00960000
009700     05  PV-TOT-RECDVS-UNTS           PIC  S9(9) COMP.            00970000
009800     05  PV-SHPD-QTY                  PIC  S9(9)V COMP-3.         00980000
009900     05  PV-TOT-UNIT-VARIANCE         PIC  Z(05)-.                00990000
010000     05  PV-LINE-COUNT                PIC S9(09)  VALUE ZERO      01000000
010100                                                  COMP-3.         01010000
010200     05  PV-TOT-CTN-LNE               PIC S9(09) COMP.            01020000
010300     05  PV-VRFD-UNITS                PIC 9(06).                  01030000
010400     05  PV-SHIPT-UNT-SRC-ID             PIC X(03).               01040000
010500                                                                  01050000
010600     05  PV-DSPLY-PKGNG-CD                 PIC  X(01).            01060000
010700         88  PV-DSP-INNER-PREPK                VALUE 'I'.         01070000
010800         88  PV-DSP-MULTI-SKU-PREPK            VALUE 'M'.         01080000
010900         88  PV-DSP-SINGLE-SKU-PREPK           VALUE 'S'.         01090000
011000         88  PV-DSP-CASEPACK                   VALUE 'C'.         01100000
011100         88  PV-DSP-BULK-PACK                  VALUE 'B'.         01110000
011200     05  PV-VRFY-SRC-CDE                   PIC  X(02).            01120000
011300     05  SAVE-VRFY-SRC-CDE                 PIC  X(02).            01130000
011400     05  PV-MANUAL-SRC                     PIC  X(02) VALUE 'MN'. 01140000
011500     05  PV-PRCG-AREA-CDE                  PIC  X(06).            01150000
011600     05  PV-DB2-CURRENT-TIMESTAMP     PIC X(26)  VALUE SPACE.     01160000
011700                                                                  01170000
011800     05  PV-TOT-UNTS-MFST            PIC  S9(9) COMP.             01180000
011900                                                                  01190000
012000     05  PV-MFST-SOURCE                    PIC  X(03).            01200000
012100     05  PV-MFST-UNITS                PIC  S9(9)V COMP-3.         01210000
012200     05  PV-MFST-CTNS                 PIC  S9(9)V COMP-3.         01220000
012300     05  PV-DISPLAY-PO-NBR               PIC 999999999-.          01230000
012400     05  PV-DISPLAY-PO-LINE-NBR          PIC 999999999-.          01240000
012500     05  PV-DISPLAY-RCVR-SEQ-NBR         PIC 999999999-.          01250000
012600                                                                  01260000
012700 01  DN-DB2-NULL-INDICATORS.                                      01270000
012800     05  DN-FCSE-ACTL-UNT-QTY         PIC S9(04) COMP VALUE +0.   01280000
012900     05  DN-ACTL-ALLOC-QTY            PIC S9(04) COMP VALUE +0.   01290000
013000                                                                  01300000
013100 01  DK-DB-KEYS.                                                  01310000
013200     05  DK-OPER-UNT-ID              PIC S9(04) COMP.             01320000
013300     05  DK-PO-NBR                   PIC S9(09) COMP.             01330000
013400     05  DK-REC-SEQ-NBR              PIC S9(09) COMP.             01340000
013500     05  DK-LINE-NBR                 PIC S9(09) COMP.             01350000
013600     05  DK-VRFY-SRC-CDE             PIC X(02).                   01360000
013700     05  DK-ACTN-CDE                 PIC X(01).                   01370000
013800     05  DK-LINE-BEGIN               PIC S9(09) VALUE ZERO        01380000
013900                                                COMP.             01390000
014000     05  DK-LINE-END                 PIC S9(09) VALUE ZERO        01400000
014100                                                COMP.             01410000
014200     05  DK-LINE-ITEM                PIC S9(15)V COMP-3.          01420000
014300     05  DK-TEMP-SEQ-NBR             PIC  9(08).                  01430000
014400     05  DK-TEMP-SEQ-NBR-R REDEFINES DK-TEMP-SEQ-NBR.             01440000
014500         10  DK-TEMP-SEQ-NBR-X       PIC  X(08).                  01450000
014600                                                                  01460000
014700                                                                  01470000
014800 01 PC-PROGRAM-CONSTANTS.                                         01480000
014900     05 PC-PROGRAM-NAME              PIC X(08)  VALUE 'SUKUT075'. 01490000
015000     05 PC-DEFAULT-TMST              PIC X(26)                    01500000
015100             VALUE '9999-09-09-09.09.09.999999'.                  01510000
015200     05 PC-0                         PIC S9(05)  VALUE +0.        01520000
015300     05 PC-C                         PIC  X(01) VALUE 'C'.        01530000
015400     05 PC-P                         PIC  X(01) VALUE 'P'.        01540000
015500     05 PC-V                         PIC  X(01) VALUE 'V'.        01550000
015600     05 PC-MN                        PIC X(02)  VALUE 'MN'.       01560000
015700     05 PC-CP                        PIC X(02)  VALUE 'CP'.       01570000
015800     05 PC-P2                        PIC X(02)  VALUE 'P2'.       01580000
016000     05 PC-MFST-SOURCE-IND.                                       01600000
016100        10 PC-ASN                    PIC X(03)  VALUE 'ASN'.      01610000
016200        10 PC-CPS                    PIC X(03)  VALUE 'CPS'.      01620000
016300        10 PC-FXR                    PIC X(03)  VALUE 'FXR'.      01630000
016400        10 PC-JWL                    PIC X(03)  VALUE 'JWL'.      01640000
016500        10 PC-MSC                    PIC X(03)  VALUE 'MSC'.      01650000
016600        10 PC-P2L                    PIC X(03)  VALUE 'P2L'.      01660000
016700        10 PC-RCV                    PIC X(03)  VALUE 'RCV'.      01670000
016800        10 PC-RDM                    PIC X(03)  VALUE 'RDM'.      01680000
016900        10 PC-SMO                    PIC X(03)  VALUE 'SMO'.      01690000
016910        10 PC-DMG                    PIC X(03)  VALUE 'DMG'.      01691000
016920                                                                  01692000
016930     05  PC-PROCESS-AREA-PGM      PIC  X(08) VALUE 'RCKUT061'.    01693000
016940                                                                  01694000
016950 01  PV-ABEND-FIELDS.                                             01695000
016960     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       01696000
016970     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         01697000
016980                                                 COMP SYNC.       01698000
016990     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'SUKUT075'.01699000
017000     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01700000
017100     05  PV-ABEND-OPERATION1          PIC  X(51) VALUE SPACES.    01710000
017200     05  PV-ABEND-OPERATION2          PIC  X(51) VALUE SPACES.    01720000
017300     05  PV-ABEND-OPERATION3          PIC  X(51) VALUE SPACES.    01730000
017400                                                                  01740000
017500* WORK AREA FOR RCKUT061                                          01750000
017600     COPY RCWS033.                                                01760000
017700                                                                  01770000
017800******************************************************************01780000
017900*  USED FOR DB2 ERROR MESSAGE BUILDING                            01790000
018000******************************************************************01800000
018100     COPY DPWS004.                                                01810000
018200                                                                  01820000
018300*----------------------------------------------------------------*01830000
018400*    ABEND PROCESSING COPYBOOK.                                  *01840000
018500*----------------------------------------------------------------*01850000
018600                                                                  01860000
018700     COPY DPWS013.                                                01870000
018800*----------------------------------------------------------------*01880000
018900*DB2 AREA FOR RC-RECEIPT ITEM TABLE                               01890000
019000     EXEC SQL                                                     01900000
019100          INCLUDE TRECITM                                         01910000
019200     END-EXEC.                                                    01920000
019300                                                                  01930000
019400*DB2 AREA FOR RC-RECEIPT DISTRIBUTION TABLE                       01940000
019500     EXEC SQL                                                     01950000
019600          INCLUDE TRECDIS                                         01960000
019700     END-EXEC.                                                    01970000
019800                                                                  01980000
019900*DB2 AREA FOR RC-RECEIVER TABLE                                   01990000
020000     EXEC SQL                                                     02000000
020100          INCLUDE TRECEIV                                         02010000
020200     END-EXEC.                                                    02020000
020300                                                                  02030000
020400*DB2 AREA FOR RC-RECEIPT DISTRIBUTION VERIFIED SOURCE TABLE       02040000
020500     EXEC SQL                                                     02050000
020600          INCLUDE TRECDVS                                         02060000
020700     END-EXEC.                                                    02070000
020800                                                                  02080000
020900*DB2 AREA FOR DC-DISTRIBUTION TRANSACTION HEADER TABLE            02090000
021000     EXEC SQL                                                     02100000
021100          INCLUDE TDISTHD                                         02110000
021200     END-EXEC.                                                    02120000
021300                                                                  02130000
021400*DB2 AREA FOR DC-DISTRIBUTION TRANSACTION DETAIL TABLE            02140000
021500     EXEC SQL                                                     02150000
021600          INCLUDE TDISTDT                                         02160000
021700     END-EXEC.                                                    02170000
021800                                                                  02180000
021900*DB2 AREA FOR PC - RECEIVER LINE DETAIL TABLE                     02190000
022000*PCT_RCVR_LNE_DTL                                                 02200000
022100     EXEC SQL                                                     02210000
022200          INCLUDE PCT00007                                        02220000
022300     END-EXEC.                                                    02230000
022400                                                                  02240000
022500*DB2 AREA FOR SU-SHIPMENT UNIT TABLE                              02250000
022600     EXEC SQL                                                     02260000
022700          INCLUDE SUT00024                                        02270000
022800     END-EXEC.                                                    02280000
022900                                                                  02290000
023000*DB2 AREA FOR SU-SHIPMENT UNIT/UPC ASSOCIATION TABLE              02300000
023100     EXEC SQL                                                     02310000
023200          INCLUDE SUT00028                                        02320000
023300     END-EXEC.                                                    02330000
023400                                                                  02340000
023500*DB2 AREA FOR PO-PURCHASE ITEM TABLE                              02350000
023600     EXEC SQL                                                     02360000
023700          INCLUDE TPURITM                                         02370000
023800     END-EXEC.                                                    02380000
023900                                                                  02390000
024000*DB2 AREA FOR SU-INBOUND EDI PACKLIST/VENDOR SHIPMENT UNIT TABLE  02400000
024100     EXEC SQL                                                     02410000
024200          INCLUDE SUT00026                                        02420000
024300     END-EXEC.                                                    02430000
024400                                                                  02440000
024500*DB2 AREA FOR RC-PACK SLIP TABLE                                  02450000
024600     EXEC SQL                                                     02460000
024700          INCLUDE TPKSLIP                                         02470000
024800     END-EXEC.                                                    02480000
024900                                                                  02490000
025000                                                                  02500000
025100******************************************************************02510000
025200*   DB2 DCLGEN FOR PARM TABLE                                     02520000
025300******************************************************************02530000
025400     EXEC SQL                                                     02540000
025500          INCLUDE TKRPRPM                                         02550000
025600     END-EXEC.                                                    02560000
025700                                                                  02570000
025800******************************************************************02580000
025900*    XLT_SKU TABLE (XLT00003)                                     02590000
026000******************************************************************02600000
026100     EXEC SQL                                                     02610000
026200          INCLUDE XLT00003                                        02620000
026300     END-EXEC.                                                    02630000
026400                                                                  02640000
026500******************************************************************02650000
026600*   DB2 SQL COMMUNICATION AREA                                    02660000
026700******************************************************************02670000
026800     EXEC SQL                                                     02680000
026900          INCLUDE SQLCA                                           02690000
027000     END-EXEC.                                                    02700000
027100                                                                  02710000
027200*DB2 AREA FOR COMMUNICATIONS AREA2                                02720000
027300     COPY SQLCA2.                                                 02730000
027400                                                                  02740000
027500***********************************************************       02750000
027600*  RECORD LAYOUT FOR THE CARTON EXCEPTION EXTRACT FILE            02760000
027700***********************************************************       02770000
027800     COPY SURD036.                                                02780000
027900                                                                  02790000
028000 EJECT                                                            02800000
028100*-----------------------------------------------------------      02810000
028200*  CURSOR TO GET TOTAL VERIFIED UNITS FOR PO/RCVR                 02820000
028300*-----------------------------------------------------------      02830000
028400           EXEC SQL                                               02840000
028500                DECLARE TOT-UNTS-VRFD-CSR CURSOR FOR              02850000
028600            SELECT  SUM(B.VERIFY_ITM_QTY)                         02860000
028700                   ,SUM(B.AP_VERIFY_ITM_QTY)                      02870000
028800                   ,A.ORD_LNE_NBR                                 02880000
028900                   ,A.STATUS_CDE                                  02890000
029000                   ,A.VRFD_USR_ID                                 02900000
029100              FROM  TRECITM  A                                    02910000
029200                   ,TRECDIS  B                                    02920000
029300             WHERE  A.OPER_UNT_ID       = :DK-OPER-UNT-ID         02930000
029400               AND  A.ORD_NBR           = :DK-PO-NBR              02940000
029500               AND  A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR         02950000
029600               AND  A.ORD_LNE_NBR       = :DK-LINE-BEGIN          02960000
029800               AND  A.VER_STATUS_CDE    = 'A'                     02980000
029900               AND  A.ORD_NBR           = B.ORD_NBR               02990000
030000               AND  A.REC_SEQ_NBR       = B.REC_SEQ_NBR           03000000
030100               AND  A.ORD_LNE_NBR       = B.ORD_LNE_NBR           03010000
030200               AND  A.OPER_UNT_ID       = B.OPER_UNT_ID           03020000
030400             GROUP BY A.ORD_LNE_NBR, A.STATUS_CDE, A.VRFD_USR_ID  03040000
030500             WITH UR                                              03050000
030600           END-EXEC.                                              03060000
030700                                                                  03070000
030800*-----------------------------------------------------------      03080000
030900*  CURSOR TO COUNT MANIFESTED UNITS BY PO/RCVR                    03090000
031000*-----------------------------------------------------------      03100000
031100           EXEC SQL                                               03110000
031200                DECLARE TOT-UNTS-MNIFD-CSR CURSOR FOR             03120000
031300            SELECT  SUM(A.SHPD_UNT_QTY)                           03130000
031400              FROM  SUT_OTBND_UPC A                               03140000
031500                   ,SUT_OTBND_CART B                              03150000
031600             WHERE  A.TRN_NBR           = :DK-PO-NBR              03160000
031700               AND  A.TRN_LNE_NBR       = :DK-LINE-BEGIN          03170000
031900               AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR         03190000
032000               AND  A.TRN_TYP_CDE       = 'PO'                    03200000
032100               AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID          03210000
032200               AND  B.ACTV_IND          = 'Y'                     03220000
032300       UNION ALL                                                  03230000
032400            SELECT  SUM(A.SHPD_UNT_QTY)                           03240000
032500              FROM  SUT_OTBND_UPC A                               03250000
032600                   ,SUT_OTBND_CART B                              03260000
032700                   ,SUT_OTBND_VND C                               03270000
032800                   ,TPKSLIP  D                                    03280000
032900             WHERE  A.TRN_NBR           = :DK-PO-NBR              03290000
033000               AND  A.TRN_LNE_NBR       = :DK-LINE-BEGIN          03300000
033200               AND  A.TRN_TYP_CDE       = 'PO'                    03320000
033300               AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID          03330000
033400               AND  B.ACTV_IND          = 'Y'                     03340000
033500               AND  B.CART_TYP_CDE NOT LIKE 'P'                   03350000
033600               AND  A.TRN_NBR           = C.PO_NBR                03360000
033700               AND  A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID          03370000
033800               AND  C.PO_NBR            = D.PO_NBR                03380000
033900               AND  C.PKSL_SEQ_NBR      = D.SEQ_NBR               03390000
034000               AND  D.REC_SEQ_NBR       = :DK-REC-SEQ-NBR         03400000
034100               AND  D.VER_STAT_CDE      = 'A'                     03410000
034200               WITH UR                                            03420000
034300           END-EXEC                                               03430000
034400                                                                  03440000
034500*---------------------------------------------------------------* 03450000
034600*  CURSOR TO COUNT CARTONS BY PO, RECEIVER                        03460000
034700*---------------------------------------------------------------* 03470000
034800     EXEC SQL                                                     03480000
034900          DECLARE TOT-CTNS-LINE-CSR CURSOR FOR                    03490000
035000        SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)                   03500000
035100          FROM  SUT_OTBND_UPC A                                   03510000
035200               ,SUT_OTBND_CART B                                  03520000
035300               WHERE  A.TRN_NBR           = :DK-PO-NBR            03530000
035400                 AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR       03540000
035500                 AND  A.TRN_LNE_NBR       = :DK-LINE-BEGIN        03550000
035700                 AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID        03570000
035800                 AND  B.ACTV_IND          = 'Y'                   03580000
035900                 GROUP BY A.TRN_LNE_NBR                           03590000
036000             UNION ALL                                            03600000
036100                SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)           03610000
036200                  FROM  SUT_OTBND_UPC A                           03620000
036300                       ,SUT_OTBND_CART B                          03630000
036400                       ,SUT_OTBND_VND C                           03640000
036500                       ,TPKSLIP  D                                03650000
036600               WHERE  A.TRN_NBR           = :DK-PO-NBR            03660000
036700                 AND  A.TRN_LNE_NBR       = :DK-LINE-BEGIN        03670000
036900                 AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID        03690000
037000                 AND  B.ACTV_IND          = 'Y'                   03700000
037100                 AND  B.CART_TYP_CDE NOT LIKE 'P'                 03710000
037200                 AND  A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID        03720000
037300                 AND  A.TRN_NBR           = C.PO_NBR              03730000
037400                 AND  C.PO_NBR            = D.PO_NBR              03740000
037500                 AND  C.PKSL_SEQ_NBR      = D.SEQ_NBR             03750000
037600                 AND  D.REC_SEQ_NBR       = :DK-REC-SEQ-NBR       03760000
037700                 AND  D.VER_STAT_CDE      = 'A'                   03770000
037800                 GROUP BY A.TRN_LNE_NBR                           03780000
037900                 WITH UR                                          03790000
038000     END-EXEC.                                                    03800000
038100                                                                  03810000
038200*---------------------------------------------------------------* 03820000
038300*  CURSOR TO GET VERIFY SOURCE CODE                               03830000
038400*---------------------------------------------------------------* 03840000
038500     EXEC SQL                                                     03850000
038600         DECLARE VRFY-SRC-CSR CURSOR FOR                          03860000
038700          SELECT DISTINCT VRFY_SRC_CDE                            03870000
038800           FROM  TRECDVS                                          03880000
038900          WHERE  ORD_NBR        =  :DK-PO-NBR                     03890000
039000            AND  REC_SEQ_NBR    =  :DK-REC-SEQ-NBR                03900000
039100            AND  ORD_LNE_NBR    =  :DK-LINE-NBR                   03910000
039200            ORDER BY VRFY_SRC_CDE                                 03920000
039300            WITH UR                                               03930000
039400     END-EXEC.                                                    03940000
039500                                                                  03950000
039600                                                                  03960000
039700*---------------------------------------------------------------* 03970000
039800*  CURSOR TO GET MANIFESTED UNIT AND CARTON COUNT BY MFST SOURCE  03980000
039900*---------------------------------------------------------------* 03990000
040000     EXEC SQL                                                     04000000
040100         DECLARE MFST-CTN-CSR CURSOR FOR                          04010000
040200            SELECT  SUM(A.SHPD_UNT_QTY)                           04020000
040300                   ,B.CART_SRC_CDE                                04030000
040400                   ,COUNT(*)                                      04040000
040500              FROM  SUT_OTBND_UPC A                               04050000
040600                   ,SUT_OTBND_CART B                              04060000
040700             WHERE  A.TRN_NBR           = :DK-PO-NBR              04070000
040800               AND  A.TRN_LNE_NBR       = :DK-LINE-BEGIN          04080000
041000               AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR         04100000
041100               AND  A.TRN_TYP_CDE       = 'PO'                    04110000
041200               AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID          04120000
041300               AND  B.ACTV_IND          = 'Y'                     04130000
041400               GROUP BY B.CART_SRC_CDE                            04140000
041500       UNION ALL                                                  04150000
041600            SELECT  SUM(A.SHPD_UNT_QTY)                           04160000
041700                   ,E.CART_SRC_CDE                                04170000
041800                   ,COUNT(*)                                      04180000
041900              FROM  SUT_OTBND_UPC A                               04190000
042000                   ,SUT_OTBND_CART B                              04200000
042100                   ,SUT_OTBND_VND C                               04210000
042200                   ,TPKSLIP  D                                    04220000
042300                   ,SUT_OTBND_CART E                              04230000
042400             WHERE  A.TRN_NBR           = :DK-PO-NBR              04240000
042500               AND  A.TRN_LNE_NBR       = :DK-LINE-BEGIN          04250000
042700               AND  A.TRN_TYP_CDE       = 'PO'                    04270000
042800               AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID          04280000
042900               AND  B.SHIPT_UNT_ID      = E.SHIPT_UNT_ID          04290000
043000               AND  B.ACTV_IND          = 'Y'                     04300000
043100               AND  B.CART_TYP_CDE NOT LIKE 'P'                   04310000
043200               AND  A.TRN_NBR           = C.PO_NBR                04320000
043300               AND  A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID          04330000
043400               AND  C.PO_NBR            = D.PO_NBR                04340000
043500               AND  C.PKSL_SEQ_NBR      = D.SEQ_NBR               04350000
043600               AND  D.REC_SEQ_NBR       = :DK-REC-SEQ-NBR         04360000
043700               AND  D.VER_STAT_CDE      = 'A'                     04370000
043800               GROUP BY E.CART_SRC_CDE                            04380000
043900               ORDER BY CART_SRC_CDE                              04390000
044000               WITH UR                                            04400000
044100     END-EXEC.                                                    04410000
044200                                                                  04420000
044300* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04430000
044400 PROCEDURE DIVISION.                                              04440000
044500* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04450000
044600                                                                  04460000
044700***************************************************************** 04470000
044800 0000-MAINLINE.                                                   04480000
044900***************************************************************** 04490000
045000*    DISPLAY '***BEGINNING SUKUT075***'.                          04500000
045100     PERFORM 1000-INITIALIZE.                                     04510000
045200                                                                  04520000
045300     PERFORM 2000-PROCESS-PO-FILE                                 04530000
045400         UNTIL PS-END-OF-PO-FILE                                  04540000
045500                                                                  04550000
045600     MOVE PV-READ-COUNTER TO PV-DISPLAY-COUNT.                    04560000
045700     DISPLAY 'TOTAL RECORDS READ    '          PV-DISPLAY-COUNT.  04570000
045800                                                                  04580000
045900     MOVE PV-WRITE-COUNTER TO PV-DISPLAY-COUNT.                   04590000
046000     DISPLAY 'TOTAL REPORT RECS WRITTEN '  PV-DISPLAY-COUNT.      04600000
046100*DISPLAY 'READ TOTAL SHOULD EQUAL WRITE TOTAL '.                  04610000
046200                                                                  04620000
046300     CLOSE PO-FILE                                                04630000
046400           EXTRACT-FILE.                                          04640000
046500                                                                  04650000
046600     GOBACK.                                                      04660000
046700                                                                  04670000
046800                                                                  04680000
046900***************************************************************** 04690000
047000 1000-INITIALIZE.                                                 04700000
047100***************************************************************** 04710000
047200     OPEN INPUT  PO-FILE                                          04720000
047300          OUTPUT EXTRACT-FILE.                                    04730000
047400                                                                  04740000
047500     INITIALIZE SU036-RECORD.                                     04750000
047600                                                                  04760000
047700*FIRST READ                                                       04770000
047800     PERFORM 7100-READ-PO-FILE                                    04780000
047900                                                                  04790000
048000     IF PS-END-OF-PO-FILE                                         04800000
048100         DISPLAY '** PO FILE IS EMPTY **'                         04810000
048200     ELSE                                                         04820000
048300         MOVE SU036-PO-NUMBER TO DK-PO-NBR                        04830000
048400     END-IF.                                                      04840000
048500                                                                  04850000
048600                                                                  04860000
048700***************************************************************** 04870000
048800 2000-PROCESS-PO-FILE.                                            04880000
048900***************************************************************** 04890000
049000     MOVE '2000-PROCESS-EXTRACTS   ' TO PV-ABEND-PARAGRAPH.       04900000
049100                                                                  04910000
049200*NEXT READ                                                        04920000
049300     PERFORM 7100-READ-PO-FILE                                    04930000
049400                                                                  04940000
049500     IF PS-END-OF-PO-FILE                                         04950000
049600          CONTINUE                                                04960000
049700     ELSE                                                         04970000
049800         MOVE SU036-PO-NUMBER   TO DK-PO-NBR                      04980000
049900     END-IF.                                                      04990000
050000                                                                  05000000
050100                                                                  05010000
050200***************************************************************** 05020000
050300 2200-LOAD-VE-EXTRACT-RECORD.                                     05030000
050400***************************************************************** 05040000
050500     MOVE '2200-LOAD-VE-EXTRACT-RCD   ' TO PV-ABEND-PARAGRAPH.    05050000
050600                                                                  05060000
050700     MOVE DK-TEMP-SEQ-NBR          TO SU036-SKU-NUMBER.           05070000
050800     MOVE PV-TOT-UNTS-VERIFD       TO SU036-TOT-UNT-VRFD.         05080000
050900     MOVE PV-TOT-UNTS-MFST         TO SU036-TOT-UNT-MFST.         05090000
051000     MOVE PV-TOT-UNIT-VARIANCE     TO SU036-TOT-VARIANCE.         05100000
051100     MOVE PV-TOT-CTN-LNE           TO SU036-TOT-CTNS-LINE.        05110000
051200     MOVE PV-DSPLY-PKGNG-CD        TO SU036-PKG-TYPE.             05120000
051300                                                                  05130000
051400     MOVE PV-VRFY-SRC-CDE          TO SU036-VRFD-SOURCE.          05140000
051500     MOVE PV-PRCG-AREA-CDE         TO SU036-VRFD-AREA.            05150000
051600     MOVE PV-VRFD-UNITS            TO SU036-VRFD-UNITS.           05160000
051700*LMM                                                              05170000
051800     IF PV-VRFY-SRC-CDE = SPACES                                  05180000
051900        SET SU036-NO-VERIFIED TO TRUE                             05190000
052000        SET SU036-VRFD-NO-SRC TO TRUE                             05200000
052100     ELSE                                                         05210000
052200        CONTINUE                                                  05220000
052300     END-IF                                                       05230000
052400                                                                  05240000
052500     MOVE RECITM-VRFD-USR-ID       TO SU036-VRFD-USR-ID.          05250000
052600                                                                  05260000
052700***************************************************************** 05270000
052800 2250-LOAD-MF-EXTRACT-RECORD.                                     05280000
052900***************************************************************** 05290000
053000     MOVE '2250-LOAD-MF-EXTRACT-RCD   ' TO PV-ABEND-PARAGRAPH.    05300000
053100                                                                  05310000
053200     MOVE ZEROES                   TO SU036-MFST-UNITS.           05320000
053300     MOVE SPACES                   TO SU036-MFST-SOURCE.          05330000
053400     MOVE ZEROES                   TO SU036-MFST-CTNS.            05340000
053500                                                                  05350000
053600     MOVE PV-MFST-UNITS            TO SU036-MFST-UNITS.           05360000
053700                                                                  05370000
053800     IF PV-MFST-SOURCE = LOW-VALUES                               05380000
053900        MOVE SPACES                TO SU036-MFST-SOURCE           05390000
054000     ELSE                                                         05400000
054100        MOVE PV-MFST-SOURCE        TO SU036-MFST-SOURCE           05410000
054200     END-IF                                                       05420000
054300                                                                  05430000
054400     MOVE PV-MFST-CTNS             TO SU036-MFST-CTNS.            05440000
054500                                                                  05450000
054600                                                                  05460000
054700*GET ITEM NUMBER FOR PO IN ORDER TO GET SKU NUMBER                05470000
054800***************************************************************** 05480000
054900 2300-GET-ITEM-NBR.                                               05490000
055000***************************************************************** 05500000
055100     EXEC SQL                                                     05510000
055200         SELECT   ITM_NBR                                         05520000
055300           INTO:  PURITM-ITM-NBR                                  05530000
055400           FROM   TPURITM                                         05540000
055500          WHERE   PO_NBR         = :DK-PO-NBR                     05550000
055600            AND   APP_PO_LNE_NBR = :DK-LINE-NBR                   05560000
055700            AND   VER_STATUS_CDE = 'A'                            05570000
055800            WITH UR                                               05580000
055900     END-EXEC.                                                    05590000
056000                                                                  05600000
056100     EVALUATE TRUE                                                05610000
056200         WHEN SQLCODE = ZERO                                      05620000
056300             MOVE PURITM-ITM-NBR TO DK-LINE-ITEM                  05630000
056400             PERFORM 2400-GET-SKU-NBR                             05640000
056500         WHEN SQLCODE = +100                                      05650000
056600             MOVE SPACES TO SU036-SKU-NUMBER                      05660000
056700         WHEN SQLWARN0 NOT = SPACE                                05670000
056800         WHEN SQLCODE  NOT = +0                                   05680000
056900             MOVE '2300-GET-ITEM-NBR'                             05690000
057000                                TO PV-ABEND-PARAGRAPH             05700000
057100             MOVE 'SELECT TPURITM'                                05710000
057200                                 TO PV-ABEND-OPERATION1           05720000
057300             MOVE 'TPURITM' TO PV-DB2-TABLE-NAME                  05730000
057400             PERFORM 9100-SQL-ABEND                               05740000
057500     END-EVALUATE.                                                05750000
057600                                                                  05760000
057700                                                                  05770000
057800******************************************************************05780000
057900* DO A DIRECT READ TO THE XLT_SKU TABLE TO DETERMINE THE SKU      05790000
058000* NUMBER ASSOCIATED TO THE ITEM NUMBER FOUND ON THE TPURITM       05800000
058100* TABLE.                                                          05810000
058200******************************************************************05820000
058300 2400-GET-SKU-NBR.                                                05830000
058400                                                                  05840000
058500     EXEC SQL                                                     05850000
058600         SELECT   SKU_NBR                                         05860000
058700           INTO   :XLT00003-SKU-NBR                               05870000
058710           FROM   XLT_SKU                                         05871000
058720          WHERE   ITM_NBR        = :DK-LINE-ITEM                  05872000
058730            WITH UR                                               05873000
058740     END-EXEC.                                                    05874000
058750                                                                  05875000
058760     EVALUATE TRUE                                                05876000
058770         WHEN SQLCODE = ZERO                                      05877000
058780             MOVE XLT00003-SKU-NBR       TO  DK-TEMP-SEQ-NBR      05878000
058790         WHEN SQLCODE = +100                                      05879000
058791             MOVE SPACES                 TO  DK-TEMP-SEQ-NBR-X    05879100
058792         WHEN SQLWARN0 NOT = SPACE                                05879200
058793         WHEN SQLCODE  NOT = +0                                   05879300
058794             MOVE '2400-GET-SKU-NBR '                             05879400
058795                                TO PV-ABEND-PARAGRAPH             05879500
058796             MOVE 'SELECT XLT_SKU'                                05879600
058797                                 TO PV-ABEND-OPERATION1           05879700
058798             MOVE 'XLT_SKU' TO PV-DB2-TABLE-NAME                  05879800
058799             PERFORM 9100-SQL-ABEND                               05879900
058800     END-EVALUATE.                                                05880000
058900                                                                  05890000
059000******************************************************************05900000
059100* GET TOTAL UNITS VERIFIED                                        05910000
059200******************************************************************05920000
059300 2500-GET-TOT-UNTS-VERIFIED.                                      05930000
059400                                                                  05940000
059500     SET  PS-NOT-EOF-TOT-UNTS-VRFD-CSR TO TRUE.                   05950000
059600                                                                  05960000
059700     MOVE ZEROES TO PV-TOT-UNTS-VERIFD                            05970000
059800     PERFORM 4010-OPEN-TOT-UNTS-VRFD-CSR.                         05980000
059900     PERFORM 4015-FETCH-TOT-UNTS-VRFD-CSR.                        05990000
060000                                                                  06000000
060100     IF  PS-EOF-TOT-UNTS-VRFD-CSR                                 06010000
060200         CONTINUE                                                 06020000
060300     END-IF.                                                      06030000
060400                                                                  06040000
060500     PERFORM 4020-CLOSE-TOT-UNTS-VRFD-CSR.                        06050000
060600                                                                  06060000
060700******************************************************************06070000
060800 2600-GET-TOT-UNITS-MANIFESTED.                                   06080000
060900******************************************************************06090000
061000     SET  PS-NOT-EOF-TOT-UNTS-MNIFD-CSR TO TRUE.                  06100000
061100                                                                  06110000
061200     MOVE ZEROES TO PV-SHPD-QTY PV-TOT-UNTS-MFST                  06120000
061300     PERFORM 4025-OPEN-TOT-UNTS-MNIFD-CSR.                        06130000
061400     INITIALIZE PS-MFST-SW                                        06140000
061500     PERFORM 4030-FETCH-TOT-UNTS-MNIFD-CSR UNTIL SQLCODE = +100.  06150000
061600*                         OR SQLCODE = -305.                      06160000
061700     MOVE ZEROS TO SQLCODE.                                       06170000
061800                                                                  06180000
061900     IF  PS-EOF-TOT-UNTS-MNIFD-CSR                                06190000
062000         CONTINUE                                                 06200000
062100     END-IF.                                                      06210000
062200                                                                  06220000
062300     PERFORM 4035-CLOSE-TOT-UNTS-MNIFD-CSR.                       06230000
062400                                                                  06240000
062500                                                                  06250000
062600******************************************************************06260000
062700 2700-GET-CTNS-BY-LINE.                                           06270000
062800******************************************************************06280000
062900     SET  PS-NOT-EOF-TOT-CTNS-LINE-CSR TO TRUE.                   06290000
063000                                                                  06300000
063100     MOVE ZEROES TO PV-LINE-COUNT PV-TOT-CTN-LNE                  06310000
063200     PERFORM 4040-OPEN-TOT-CTNS-LINE-CSR.                         06320000
063300     PERFORM 4045-FETCH-TOT-CTNS-LINE-CSR UNTIL SQLCODE = +100.   06330000
063400*                         OR SQLCODE = -305.                      06340000
063500     MOVE ZEROS TO SQLCODE.                                       06350000
063600                                                                  06360000
063700     IF  PS-EOF-TOT-CTNS-LINE-CSR                                 06370000
063800         CONTINUE                                                 06380000
063900     END-IF.                                                      06390000
064000                                                                  06400000
064100     PERFORM 4050-CLOSE-TOT-CTNS-LINE-CSR.                        06410000
064200                                                                  06420000
064300                                                                  06430000
064400******************************************************************06440000
064500* RETRIEVE INFO FROM TRECEIV                                      06450000
064600 2800-GET-PKG-TYPE.                                               06460000
064700******************************************************************06470000
064800     EXEC SQL                                                     06480000
064900          SELECT PKGNG_CDE                                        06490000
065000                ,PACK_BY_ST_IND                                   06500000
065100          INTO  :RECEIV-PKGNG-CDE                                 06510000
065200               ,:RECEIV-PACK-BY-ST-IND                            06520000
065300           FROM  TRECEIV                                          06530000
065400          WHERE  ORD_NBR        =  :DK-PO-NBR                     06540000
065500            AND  REC_SEQ_NBR    =  :DK-REC-SEQ-NBR                06550000
065600            AND  VER_STATUS_CDE =  'A'                            06560000
065700            WITH UR                                               06570000
065800     END-EXEC.                                                    06580000
065900                                                                  06590000
066000     EVALUATE TRUE                                                06600000
066100         WHEN SQLCODE = ZERO                                      06610000
066200             IF RECEIV-PACK-BY-ST-IND = 'Y' AND                   06620000
066300                RECEIV-PKGNG-CDE = ' '                            06630000
066400                MOVE PC-P TO PV-DSPLY-PKGNG-CD                    06640000
066500             ELSE                                                 06650000
066600                MOVE RECEIV-PKGNG-CDE    TO PV-DSPLY-PKGNG-CD     06660000
066700             END-IF                                               06670000
066800         WHEN SQLCODE = +100                                      06680000
066900             MOVE SPACES                 TO PV-DSPLY-PKGNG-CD     06690000
067000         WHEN SQLWARN0 NOT = SPACE                                06700000
067100         WHEN SQLCODE  NOT = +0                                   06710000
067200             MOVE '2800-GET-PKG-TYPE'                             06720000
067300                                 TO PV-ABEND-PARAGRAPH            06730000
067400             MOVE 'SELECT TRECEIV'                                06740000
067500                                 TO PV-ABEND-OPERATION1           06750000
067600             MOVE 'TRECEIV'      TO PV-DB2-TABLE-NAME             06760000
067700             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        06770000
067800             STRING 'PO NBR: '         DELIMITED BY SIZE          06780000
067900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          06790000
068000                           INTO PV-ABEND-OPERATION1               06800000
068100             MOVE DK-REC-SEQ-NBR                                  06810000
068200                             TO PV-DISPLAY-RCVR-SEQ-NBR           06820000
068300             STRING 'RECV SEQ: '       DELIMITED BY SIZE          06830000
068400                 PV-DISPLAY-RCVR-SEQ-NBR                          06840000
068500                                       DELIMITED BY SIZE          06850000
068600                           INTO PV-ABEND-OPERATION2               06860000
068700             PERFORM 9100-SQL-ABEND                               06870000
068800     END-EVALUATE.                                                06880000
068900                                                                  06890000
069000******************************************************************06900000
069100* GET VERIFIED USER ID FROM TRECITM                               06910000
069200 2900-GET-VRFD-USR-ID.                                            06920000
069300******************************************************************06930000
069400     MOVE SU036-PO-NUMBER   TO DK-PO-NBR.                         06940000
069500     MOVE SU036-REC-SEQ-NBR TO DK-REC-SEQ-NBR.                    06950000
069600     MOVE SU036-LINE-NBR    TO DK-LINE-NBR.                       06960000
069700                                                                  06970000
069800     EXEC SQL                                                     06980000
069900          SELECT VRFD_USR_ID                                      06990000
070000          INTO  :RECITM-VRFD-USR-ID                               07000000
070100           FROM  TRECITM                                          07010000
070200          WHERE  OPER_UNT_ID    =  :DK-OPER-UNT-ID                07020000
070300            AND  ORD_NBR        =  :DK-PO-NBR                     07030000
070400            AND  REC_SEQ_NBR    =  :DK-REC-SEQ-NBR                07040000
070500            AND  ORD_LNE_NBR    =  :DK-LINE-NBR                   07050000
070600            AND  STATUS_CDE     = 'VE'                            07060000
070700            AND  VER_STATUS_CDE = 'A'                             07070000
070800            WITH UR                                               07080000
070900     END-EXEC.                                                    07090000
071000                                                                  07100000
071100     EVALUATE TRUE                                                07110000
071200         WHEN SQLCODE = ZERO                                      07120000
071300             CONTINUE                                             07130000
071400         WHEN SQLCODE = +100                                      07140000
071500             MOVE SPACES TO RECITM-VRFD-USR-ID                    07150000
071600         WHEN SQLWARN0 NOT = SPACE                                07160000
071700         WHEN SQLCODE  NOT = +0                                   07170000
071800             MOVE '2900-GET-VRFD-USR-ID'                          07180000
071900                                 TO PV-ABEND-PARAGRAPH            07190000
072000             MOVE 'SELECT TRECITM'                                07200000
072100                                 TO PV-ABEND-OPERATION1           07210000
072200             MOVE 'TRECITM'      TO PV-DB2-TABLE-NAME             07220000
072300             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        07230000
072400             STRING 'PO NBR: '         DELIMITED BY SIZE          07240000
072500                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          07250000
072600                           INTO PV-ABEND-OPERATION1               07260000
072700             MOVE DK-REC-SEQ-NBR                                  07270000
072800                             TO PV-DISPLAY-RCVR-SEQ-NBR           07280000
072900             STRING 'RECV SEQ: '       DELIMITED BY SIZE          07290000
073000                 PV-DISPLAY-RCVR-SEQ-NBR                          07300000
073100                                       DELIMITED BY SIZE          07310000
073200                           INTO PV-ABEND-OPERATION2               07320000
073300             MOVE DK-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR      07330000
073400             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          07340000
073500                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          07350000
073600                           INTO PV-ABEND-OPERATION3               07360000
073700             PERFORM 9100-SQL-ABEND                               07370000
073800     END-EVALUATE.                                                07380000
073900                                                                  07390000
074000******************************************************************07400000
074100 3000-GET-VERIFIED-SOURCE.                                        07410000
074200******************************************************************07420000
074300     SET  PS-NOT-EOF-VRFY-SRC-CSR  TO  TRUE.                      07430000
074400     SET  PS-NOT-EOF-MFST-CTN-CSR  TO  TRUE.                      07440000
074500                                                                  07450000
074600     PERFORM 4055-OPEN-VRFY-SRC-CSR                               07460000
074700     PERFORM 4070-OPEN-MFST-CTN-CSR                               07470000
074800                                                                  07480000
074900     PERFORM 4060-FETCH-VRFY-SRC-CSR                              07490000
075000     PERFORM 4075-FETCH-MFST-CTN-CSR                              07500000
075100                                                                  07510000
075200     PERFORM UNTIL PS-EOF-VRFY-SRC-CSR AND                        07520000
075300                   PS-EOF-MFST-CTN-CSR                            07530000
075400                                                                  07540000
075500        PERFORM 2200-LOAD-VE-EXTRACT-RECORD                       07550000
075600        PERFORM 2250-LOAD-MF-EXTRACT-RECORD                       07560000
075700        PERFORM 8000-WRITE-EXTRACT                                07570000
075800                 ADD +1 TO PV-WRITE-COUNTER                       07580000
075900                 INITIALIZE PV-VRFD-UNITS                         07590000
076000                            PV-VRFY-SRC-CDE                       07600000
076100                            PV-PRCG-AREA-CDE                      07610000
076200                 INITIALIZE PV-MFST-UNITS                         07620000
076300                            PV-MFST-SOURCE                        07630000
076400                            PV-MFST-CTNS                          07640000
076500                                                                  07650000
076600        IF  PS-EOF-VRFY-SRC-CSR                                   07660000
076700            CONTINUE                                              07670000
076800        ELSE                                                      07680000
076900            PERFORM 4060-FETCH-VRFY-SRC-CSR                       07690000
077000        END-IF                                                    07700000
077100        IF  PS-EOF-MFST-CTN-CSR                                   07710000
077200            CONTINUE                                              07720000
077300        ELSE                                                      07730000
077400            PERFORM 4075-FETCH-MFST-CTN-CSR                       07740000
077500        END-IF                                                    07750000
077600     END-PERFORM                                                  07760000
077700                                                                  07770000
077800                                                                  07780000
077900     PERFORM 4065-CLOSE-VRFY-SRC-CSR                              07790000
078000     PERFORM 4080-CLOSE-MFST-CTN-CSR.                             07800000
078100                                                                  07810000
078200                                                                  07820000
078300*NOTE: IF UNITS WERE VERIFIED AT ZERO, THERE WILL NOT BE A ROW ON 07830000
078400* PCT_RCVR_LNE_DTL.  GET VERIFIED AREA FROM TWKORIN INSTEAD.      07840000
078500******************************************************************07850000
078600 3100-GET-VERIFIED-AREA.                                          07860000
078700******************************************************************07870000
078800                                                                  07880000
078900     INITIALIZE PV-PRCG-AREA-CDE.                                 07890000
079000     EXEC SQL                                                     07900000
079100       SELECT DISTINCT A.PRCG_AREA_CDE                            07910000
079200         INTO :PCT00007-PRCG-AREA-CDE                             07920000
079300         FROM PCT_RCVR_LNE_DTL A                                  07930000
079400        WHERE PO_NBR       = :DK-PO-NBR                           07940000
079500          AND RCVR_SEQ_NBR = :DK-REC-SEQ-NBR                      07950000
079600          AND PO_LNE_NBR   = :DK-LINE-NBR                         07960000
079700          AND ACTN_CDE     = :DK-ACTN-CDE                         07970000
079800          AND A.WRKD_UNT_TMST IN                                  07980000
079900             (SELECT MAX(B.WRKD_UNT_TMST)                         07990000
080000                FROM PCT_RCVR_LNE_DTL B                           08000000
080100               WHERE PO_NBR       = :DK-PO-NBR                    08010000
080200                 AND RCVR_SEQ_NBR = :DK-REC-SEQ-NBR               08020000
080300                 AND PO_LNE_NBR   = :DK-LINE-NBR                  08030000
080400                 AND ACTN_CDE     = :DK-ACTN-CDE)                 08040000
080500        GROUP BY PRCG_AREA_CDE                                    08050000
080600        WITH UR                                                   08060000
080700     END-EXEC                                                     08070000
080800                                                                  08080000
080900     EVALUATE TRUE                                                08090000
081000         WHEN SQLCODE = ZERO                                      08100000
081100         WHEN SQLCODE = -811                                      08110000
081200             MOVE PCT00007-PRCG-AREA-CDE TO PV-PRCG-AREA-CDE      08120000
081300         WHEN SQLCODE = +100                                      08130000
081400             PERFORM 3150-PROCESS-AREA-RETRIEVAL                  08140000
081500         WHEN SQLWARN0 NOT = SPACE                                08150000
081600         WHEN SQLCODE  NOT = +0                                   08160000
081700             MOVE '3100-GET-VERIFIED-AREA'                        08170000
081800                                 TO PV-ABEND-PARAGRAPH            08180000
081900             MOVE 'SELECT PCT_RCVR_LNE_DTL'                       08190000
082000                                 TO PV-ABEND-OPERATION1           08200000
082100             MOVE 'PCT_RCVR_LNE_DTL' TO PV-DB2-TABLE-NAME         08210000
082200             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        08220000
082300             STRING 'PO NBR: '         DELIMITED BY SIZE          08230000
082400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          08240000
082500                           INTO PV-ABEND-OPERATION1               08250000
082600             MOVE DK-REC-SEQ-NBR                                  08260000
082700                             TO PV-DISPLAY-RCVR-SEQ-NBR           08270000
082800             STRING 'RECV SEQ: '       DELIMITED BY SIZE          08280000
082900                 PV-DISPLAY-RCVR-SEQ-NBR                          08290000
083000                                       DELIMITED BY SIZE          08300000
083100                           INTO PV-ABEND-OPERATION2               08310000
083200             MOVE DK-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR      08320000
083300             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          08330000
083400                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          08340000
083500                           INTO PV-ABEND-OPERATION3               08350000
083600             PERFORM 9100-SQL-ABEND                               08360000
083700     END-EVALUATE.                                                08370000
083800                                                                  08380000
083900******************************************************************08390000
084000*IF PROCESS AREA NOT FOUND ON PCT_RCVR_LNE_DTL TABLE, CALL        08400000
084100*THIS MODULE TO DETERMINE LAST PROCESS AREA                       08410000
084200******************************************************************08420000
084300 3150-PROCESS-AREA-RETRIEVAL.                                     08430000
084400                                                                  08440000
084500     INITIALIZE RC033-FIELDS.                                     08450000
084600                                                                  08460000
084700     MOVE SU036-PO-NUMBER             TO RC033-PO-NBR.            08470000
084800     MOVE SU036-LINE-NBR              TO RC033-PO-LNE-NBR.        08480000
084900     MOVE SU036-REC-SEQ-NBR           TO RC033-REC-SEQ-NBR.       08490000
085000     MOVE SU036-OPER-UNT-ID           TO DK-OPER-UNT-ID.          08500000
085100     MOVE DK-OPER-UNT-ID              TO RC033-OPER-UNT-ID.       08510000
085200     MOVE +1                          TO RC033-FCLTY-ID.          08520000
085300                                                                  08530000
085400*NOTE:  SHOULD ALWAYS GET A ROW BACK FROM TWKORIN SO DON'T        08540000
085500*       NEED TO CODE FOR NOT FOUND CONDITION                      08550000
085600     SET RC033-CHECK-EXIST        TO TRUE.                        08560000
085700                                                                  08570000
085800     CALL PC-PROCESS-AREA-PGM USING RC033-FIELDS.                 08580000
085900                                                                  08590000
086000     IF RC033-CALL-SUCCESSFUL                                     08600000
086100         SET RC033-BYPASS-CHECK-EXIST TO TRUE                     08610000
086200                                                                  08620000
086300         IF RC033-WO-EXISTS                                       08630000
086400             SET RC033-GET-WO-INST TO TRUE                        08640000
086500             CALL PC-PROCESS-AREA-PGM USING RC033-FIELDS          08650000
086600             MOVE RC033-RETURN-LAST-AREA TO PV-PRCG-AREA-CDE      08660000
086700         END-IF                                                   08670000
086800     ELSE                                                         08680000
086900         MOVE RC033-RETURN-CODE   TO PV-DB2-FUNCTION              08690000
087000         MOVE RC033-SQLCODE       TO SQLCODE                      08700000
087100         MOVE '3150-PROCESS-AREA-RETRIEVAL'                       08710000
087200                         TO PV-ABEND-PARAGRAPH                    08720000
087300         MOVE SU036-PO-NUMBER     TO PV-DISPLAY-PO-NBR            08730000
087400         STRING 'PO NBR: '         DELIMITED BY SIZE              08740000
087500             PV-DISPLAY-PO-NBR     DELIMITED BY SIZE              08750000
087600                       INTO PV-ABEND-OPERATION1                   08760000
087700         MOVE SU036-REC-SEQ-NBR                                   08770000
087800                         TO PV-DISPLAY-RCVR-SEQ-NBR               08780000
087900         STRING 'RECV SEQ: '       DELIMITED BY SIZE              08790000
088000             PV-DISPLAY-RCVR-SEQ-NBR                              08800000
088100                                   DELIMITED BY SIZE              08810000
088200                       INTO PV-ABEND-OPERATION2                   08820000
088300         MOVE SU036-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR       08830000
088400         STRING 'PO LINE NBR: '    DELIMITED BY SIZE              08840000
088500            PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE              08850000
088600                       INTO PV-ABEND-OPERATION3                   08860000
088700         MOVE 'TWKORIN'  TO PV-DB2-TABLE-NAME                     08870000
088800         PERFORM 9100-SQL-ABEND                                   08880000
088900     END-IF.                                                      08890000
089000                                                                  08900000
089100                                                                  08910000
089200******************************************************************08920000
089300*SUM VERIFY QTY FROM TRECDIS                                      08930000
089400 3200-SELECT-TRECDIS.                                             08940000
089500******************************************************************08950000
089600     EXEC SQL                                                     08960000
089700         SELECT  SUM(AP_VERIFY_ITM_QTY)                           08970000
089800           INTO  :RECDIS-AP-VERIFY-ITM-QTY                        08980000
089900           FROM  TRECDIS                                          08990000
090000          WHERE  ORD_NBR     = :DK-PO-NBR                         09000000
090100            AND  REC_SEQ_NBR = :DK-REC-SEQ-NBR                    09010000
090200            AND  ORD_LNE_NBR = :DK-LINE-NBR                       09020000
090300            WITH UR                                               09030000
090400     END-EXEC.                                                    09040000
090500                                                                  09050000
090600     EVALUATE TRUE                                                09060000
090700         WHEN SQLCODE = ZERO                                      09070000
090800         WHEN SQLCODE = -305                                      09080000
090900             SET SU036-VERIFIED TO TRUE                           09090000
091000             IF RECITM-STATUS-CDE = 'VE'                          09100000
091100                 MOVE RECDIS-AP-VERIFY-ITM-QTY TO                 09110000
091200                          PV-VRFD-UNITS                           09120000
091300             ELSE                                                 09130000
091400                 PERFORM 3250-SELECT-TDISTDT                      09140000
091500             END-IF                                               09150000
091600         WHEN SQLCODE = +100                                      09160000
091700             SET SU036-NO-VERIFIED TO TRUE                        09170000
091800             SET SU036-VRFD-NO-SRC TO TRUE                        09180000
091900             MOVE ZEROES TO PV-VRFD-UNITS                         09190000
092000         WHEN SQLWARN0 NOT = SPACE                                09200000
092100         WHEN SQLCODE  NOT = +0                                   09210000
092200             MOVE '3200-SELECT-TRECDIS'                           09220000
092300                                 TO PV-ABEND-PARAGRAPH            09230000
092400             MOVE 'SELECT TRECDIS'                                09240000
092500                                 TO PV-ABEND-OPERATION1           09250000
092600             MOVE 'TRECDIS'      TO PV-DB2-TABLE-NAME             09260000
092700             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        09270000
092800             STRING 'PO NBR: '         DELIMITED BY SIZE          09280000
092900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          09290000
093000                           INTO PV-ABEND-OPERATION1               09300000
093100             MOVE DK-REC-SEQ-NBR                                  09310000
093200                             TO PV-DISPLAY-RCVR-SEQ-NBR           09320000
093300             STRING 'RECV SEQ: '       DELIMITED BY SIZE          09330000
093400                 PV-DISPLAY-RCVR-SEQ-NBR                          09340000
093500                                       DELIMITED BY SIZE          09350000
093600                           INTO PV-ABEND-OPERATION2               09360000
093700             MOVE DK-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR      09370000
093800             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          09380000
093900                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          09390000
094000                           INTO PV-ABEND-OPERATION3               09400000
094100             PERFORM 9100-SQL-ABEND                               09410000
094200     END-EVALUATE.                                                09420000
094300                                                                  09430000
094400                                                                  09440000
094500******************************************************************09450000
094600*SUM FCSE & P2L FROM TDISTDT                                      09460000
094700 3250-SELECT-TDISTDT.                                             09470000
094800******************************************************************09480000
094900     EXEC SQL                                                     09490000
095000         SELECT  SUM(A.FCSE_ACTL_UNT_QTY)                         09500000
095100                ,SUM(A.ACTL_ALLOC_QTY)                            09510000
095200           INTO  :DISTDT-FCSE-ACTL-UNT-QTY :DN-FCSE-ACTL-UNT-QTY  09520000
095300                ,:DISTDT-ACTL-ALLOC-QTY :DN-ACTL-ALLOC-QTY        09530000
095400           FROM  TDISTDT A                                        09540000
095500                ,TDISTHD B                                        09550000
095600          WHERE  A.ORD_NBR       = :DK-PO-NBR                     09560000
095700            AND  A.RCVR_SEQ_NBR  = :DK-REC-SEQ-NBR                09570000
095800            AND  A.ORD_LNE_NBR   = :DK-LINE-NBR                   09580000
095900            AND  A.ORD_NBR       = B.ORD_NBR                      09590000
096000            AND  A.RCVR_SEQ_NBR  = B.RCVR_SEQ_NBR                 09600000
096100            AND  A.ORD_LNE_NBR   = B.ORD_LNE_NBR                  09610000
096200            AND  B.TOT_CART_CNT  > 0                              09620000
096300            WITH UR                                               09630000
096400     END-EXEC.                                                    09640000
096500                                                                  09650000
096600     EVALUATE TRUE                                                09660000
096700         WHEN SQLCODE = ZERO                                      09670000
096800         WHEN SQLCODE = -305                                      09680000
096900*NULL IND                                                         09690000
097000            IF DN-FCSE-ACTL-UNT-QTY = -1 OR                       09700000
097100               DN-ACTL-ALLOC-QTY = -1                             09710000
097200               MOVE RECDIS-VERIFY-ITM-QTY TO                      09720000
097300                    PV-VRFD-UNITS                                 09730000
097400               MOVE RECDIS-VERIFY-ITM-QTY TO                      09740000
097500                    PV-TOT-UNTS-VERIFD                            09750000
097600            ELSE                                                  09760000
097700               ADD DISTDT-FCSE-ACTL-UNT-QTY TO                    09770000
097800                   DISTDT-ACTL-ALLOC-QTY                          09780000
097900               GIVING PV-VRFD-UNITS                               09790000
098000               MOVE PV-VRFD-UNITS TO PV-TOT-UNTS-VERIFD           09800000
098100            END-IF                                                09810000
098200         WHEN SQLCODE = +100                                      09820000
098300            MOVE RECDIS-VERIFY-ITM-QTY TO                         09830000
098400                 PV-VRFD-UNITS                                    09840000
098500            MOVE RECDIS-VERIFY-ITM-QTY TO                         09850000
098600                 PV-TOT-UNTS-VERIFD                               09860000
098700         WHEN SQLWARN0 NOT = SPACE                                09870000
098800         WHEN SQLCODE  NOT = +0                                   09880000
098900             MOVE '3200-SELECT-TRECDIS'                           09890000
099000                                 TO PV-ABEND-PARAGRAPH            09900000
099100             MOVE 'SELECT TRECDIS'                                09910000
099200                                 TO PV-ABEND-OPERATION1           09920000
099300             MOVE 'TRECDIS'      TO PV-DB2-TABLE-NAME             09930000
099400             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        09940000
099500             STRING 'PO NBR: '         DELIMITED BY SIZE          09950000
099600                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          09960000
099700                           INTO PV-ABEND-OPERATION1               09970000
099800             MOVE DK-REC-SEQ-NBR                                  09980000
099900                             TO PV-DISPLAY-RCVR-SEQ-NBR           09990000
100000             STRING 'RECV SEQ: '       DELIMITED BY SIZE          10000000
100100                 PV-DISPLAY-RCVR-SEQ-NBR                          10010000
100200                                       DELIMITED BY SIZE          10020000
100300                           INTO PV-ABEND-OPERATION2               10030000
100400             MOVE DK-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR      10040000
100500             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          10050000
100600                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          10060000
100700                           INTO PV-ABEND-OPERATION3               10070000
100800             PERFORM 9100-SQL-ABEND                               10080000
100900     END-EVALUATE.                                                10090000
101000                                                                  10100000
101100******************************************************************10110000
101200*SUM VRFY_ITEM_QTY BY VRFY SOURCE CODE                            10120000
101300 3300-SELECT-TRECDVS.                                             10130000
101400******************************************************************10140000
101500     EXEC SQL                                                     10150000
101600         SELECT  SUM(VRFY_ITM_QTY)                                10160000
101700           INTO  :RECDVS-VRFY-ITM-QTY                             10170000
101800           FROM  TRECDVS                                          10180000
101900          WHERE  ORD_NBR      = :DK-PO-NBR                        10190000
102000            AND  REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   10200000
102100            AND  ORD_LNE_NBR  = :DK-LINE-NBR                      10210000
102200            AND  VRFY_SRC_CDE = :DK-VRFY-SRC-CDE                  10220000
102300            WITH UR                                               10230000
102400     END-EXEC.                                                    10240000
102500                                                                  10250000
102600     EVALUATE TRUE                                                10260000
102700         WHEN SQLCODE = ZERO                                      10270000
102800         WHEN SQLCODE = +100                                      10280000
102900         WHEN SQLCODE = -305                                      10290000
103000             CONTINUE                                             10300000
103100         WHEN SQLWARN0 NOT = SPACE                                10310000
103200         WHEN SQLCODE  NOT = +0                                   10320000
103300             MOVE '3300-SELECT-TRECDVS'                           10330000
103400                                 TO PV-ABEND-PARAGRAPH            10340000
103500             MOVE 'SELECT TRECDVS'                                10350000
103600                                 TO PV-ABEND-OPERATION1           10360000
103700             MOVE 'TRECDVS'      TO PV-DB2-TABLE-NAME             10370000
103800             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        10380000
103900             STRING 'PO NBR: '         DELIMITED BY SIZE          10390000
104000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          10400000
104100                           INTO PV-ABEND-OPERATION1               10410000
104200             MOVE DK-REC-SEQ-NBR                                  10420000
104300                             TO PV-DISPLAY-RCVR-SEQ-NBR           10430000
104400             STRING 'RECV SEQ: '       DELIMITED BY SIZE          10440000
104500                 PV-DISPLAY-RCVR-SEQ-NBR                          10450000
104600                                       DELIMITED BY SIZE          10460000
104700                           INTO PV-ABEND-OPERATION2               10470000
104800             MOVE DK-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR      10480000
104900             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          10490000
105000                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          10500000
105100                           INTO PV-ABEND-OPERATION3               10510000
105200             PERFORM 9100-SQL-ABEND                               10520000
105300     END-EVALUATE.                                                10530000
105400                                                                  10540000
105500                                                                  10550000
105600*SUM VRFY_ITEM_QTY FOR ALL VRFY SOURCE CODES                      10560000
105700 3350-SELECT-TRECDVS.                                             10570000
105800******************************************************************10580000
105900     EXEC SQL                                                     10590000
106000         SELECT  SUM(VRFY_ITM_QTY)                                10600000
106100           INTO  :PV-TOT-RECDVS-UNTS                              10610000
106200           FROM  TRECDVS                                          10620000
106300          WHERE  ORD_NBR      = :DK-PO-NBR                        10630000
106400            AND  REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   10640000
106500            AND  ORD_LNE_NBR  = :DK-LINE-NBR                      10650000
106600            WITH UR                                               10660000
106700     END-EXEC.                                                    10670000
106800                                                                  10680000
106900     EVALUATE TRUE                                                10690000
107000         WHEN SQLCODE = ZERO                                      10700000
107100         WHEN SQLCODE = +100                                      10710000
107200         WHEN SQLCODE = -305                                      10720000
107300             CONTINUE                                             10730000
107400         WHEN SQLWARN0 NOT = SPACE                                10740000
107500         WHEN SQLCODE  NOT = +0                                   10750000
107600             MOVE '3350-SELECT-TRECDVS'                           10760000
107700                                 TO PV-ABEND-PARAGRAPH            10770000
107800             MOVE 'SELECT TRECDVS'                                10780000
107900                                 TO PV-ABEND-OPERATION1           10790000
108000             MOVE 'TRECDVS'      TO PV-DB2-TABLE-NAME             10800000
108100             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        10810000
108200             STRING 'PO NBR: '         DELIMITED BY SIZE          10820000
108300                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          10830000
108400                           INTO PV-ABEND-OPERATION1               10840000
108500             MOVE DK-REC-SEQ-NBR                                  10850000
108600                             TO PV-DISPLAY-RCVR-SEQ-NBR           10860000
108700             STRING 'RECV SEQ: '       DELIMITED BY SIZE          10870000
108800                 PV-DISPLAY-RCVR-SEQ-NBR                          10880000
108900                                       DELIMITED BY SIZE          10890000
109000                           INTO PV-ABEND-OPERATION2               10900000
109100             MOVE DK-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR      10910000
109200             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          10920000
109300                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          10930000
109400                           INTO PV-ABEND-OPERATION3               10940000
109500             PERFORM 9100-SQL-ABEND                               10950000
109600     END-EVALUATE.                                                10960000
109700                                                                  10970000
109800                                                                  10980000
109900******************************************************************10990000
110000 4010-OPEN-TOT-UNTS-VRFD-CSR.                                     11000000
110100******************************************************************11010000
110200     MOVE SU036-OPER-UNT-ID  TO DK-OPER-UNT-ID                    11020000
110300     MOVE SU036-PO-NUMBER    TO DK-PO-NBR                         11030000
110400     MOVE SU036-REC-SEQ-NBR  TO DK-REC-SEQ-NBR                    11040000
110500     MOVE SU036-LINE-NBR     TO DK-LINE-BEGIN                     11050000
110600                                DK-LINE-END                       11060000
110700                                                                  11070000
110800     EXEC SQL                                                     11080000
110900         OPEN TOT-UNTS-VRFD-CSR                                   11090000
111000     END-EXEC.                                                    11100000
111100                                                                  11110000
111200     EVALUATE TRUE                                                11120000
111300         WHEN SQLCODE = ZERO                                      11130000
111400             CONTINUE                                             11140000
111500         WHEN SQLWARN0 NOT = SPACES                               11150000
111600         WHEN SQLCODE < +0                                        11160000
111700         WHEN SQLCODE > ZERO                                      11170000
111800             MOVE '4010-OPEN-TOT-UNTS-VRFD-CSR'                   11180000
111900                                TO PV-ABEND-PARAGRAPH             11190000
112000             MOVE 'OPEN TOT-UNTS-VRFD-CSR'                        11200000
112100                                TO PV-ABEND-OPERATION1            11210000
112200             PERFORM 9100-SQL-ABEND                               11220000
112300     END-EVALUATE.                                                11230000
112400                                                                  11240000
112500                                                                  11250000
112600******************************************************************11260000
112700 4015-FETCH-TOT-UNTS-VRFD-CSR.                                    11270000
112800******************************************************************11280000
112900     EXEC SQL                                                     11290000
113000         FETCH TOT-UNTS-VRFD-CSR                                  11300000
113100         INTO  :RECDIS-VERIFY-ITM-QTY                             11310000
113200              ,:RECDIS-AP-VERIFY-ITM-QTY                          11320000
113300              ,:RECITM-ORD-LNE-NBR                                11330000
113400              ,:RECITM-STATUS-CDE                                 11340000
113500              ,:RECITM-VRFD-USR-ID                                11350000
113600     END-EXEC.                                                    11360000
113700                                                                  11370000
113800     EVALUATE TRUE                                                11380000
113900         WHEN SQLCODE = ZERO                                      11390000
114000             SET SU036-VERIFIED TO TRUE                           11400000
114100             IF RECITM-STATUS-CDE = 'VE'                          11410000
114200                 MOVE RECDIS-AP-VERIFY-ITM-QTY TO                 11420000
114300                          PV-TOT-UNTS-VERIFD                      11430000
114400             ELSE                                                 11440000
114500                 PERFORM 3250-SELECT-TDISTDT                      11450000
114600             END-IF                                               11460000
114700         WHEN SQLCODE = +100                                      11470000
114800             SET SU036-NO-VERIFIED TO TRUE                        11480000
114900             SET SU036-VRFD-NO-SRC TO TRUE                        11490000
115000             MOVE ZEROES TO PV-TOT-UNTS-VERIFD                    11500000
115100             SET PS-EOF-TOT-UNTS-VRFD-CSR TO TRUE                 11510000
115200         WHEN SQLWARN0 NOT = SPACES                               11520000
115300         WHEN SQLCODE < +0                                        11530000
115400         WHEN SQLCODE > ZERO                                      11540000
115500             MOVE '4015-FETCH-TOT-UNTS-VRFD-CSR'                  11550000
115600                                TO PV-ABEND-PARAGRAPH             11560000
115700             MOVE 'FETCH TOT-UNTS-VRFD-CSR'                       11570000
115800                                TO PV-ABEND-OPERATION1            11580000
115900             MOVE 'TRECDIS'     TO PV-DB2-TABLE-NAME              11590000
116000             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        11600000
116100             STRING 'PO NBR: '         DELIMITED BY SIZE          11610000
116200                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          11620000
116300                           INTO PV-ABEND-OPERATION1               11630000
116400             MOVE DK-REC-SEQ-NBR                                  11640000
116500                             TO PV-DISPLAY-RCVR-SEQ-NBR           11650000
116600             STRING 'RECV SEQ: '       DELIMITED BY SIZE          11660000
116700                 PV-DISPLAY-RCVR-SEQ-NBR                          11670000
116800                                       DELIMITED BY SIZE          11680000
116900                           INTO PV-ABEND-OPERATION2               11690000
117000             MOVE DK-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR      11700000
117100             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          11710000
117200                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          11720000
117300                           INTO PV-ABEND-OPERATION3               11730000
117400             PERFORM 9100-SQL-ABEND                               11740000
117500     END-EVALUATE.                                                11750000
117600                                                                  11760000
117700                                                                  11770000
117800******************************************************************11780000
117900 4020-CLOSE-TOT-UNTS-VRFD-CSR.                                    11790000
118000******************************************************************11800000
118100     EXEC SQL                                                     11810000
118200         CLOSE TOT-UNTS-VRFD-CSR                                  11820000
118300     END-EXEC.                                                    11830000
118400                                                                  11840000
118500     EVALUATE TRUE                                                11850000
118600         WHEN SQLCODE = ZERO                                      11860000
118700             CONTINUE                                             11870000
118800                                                                  11880000
118900         WHEN SQLWARN0 NOT = SPACES                               11890000
119000         WHEN SQLCODE < +0                                        11900000
119100         WHEN SQLCODE > ZERO                                      11910000
119200             MOVE '4020-CLOSE-TOT-UNTS-VRFD-CSR'                  11920000
119300                                 TO PV-ABEND-PARAGRAPH            11930000
119400             MOVE 'CLOSE TOT-UNTS-VRFD-CSR'                       11940000
119500                                 TO PV-ABEND-OPERATION1           11950000
119600             PERFORM 9100-SQL-ABEND                               11960000
119700     END-EVALUATE.                                                11970000
119800                                                                  11980000
119900                                                                  11990000
120000******************************************************************12000000
120100 4025-OPEN-TOT-UNTS-MNIFD-CSR.                                    12010000
120200******************************************************************12020000
120300     MOVE SU036-PO-NUMBER    TO DK-PO-NBR                         12030000
120400     MOVE SU036-REC-SEQ-NBR  TO DK-REC-SEQ-NBR                    12040000
120500     MOVE SU036-LINE-NBR     TO DK-LINE-BEGIN                     12050000
120600                                DK-LINE-END                       12060000
120700                                                                  12070000
120800     EXEC SQL                                                     12080000
120900          OPEN TOT-UNTS-MNIFD-CSR                                 12090000
121000     END-EXEC                                                     12100000
121100                                                                  12110000
121200     EVALUATE TRUE                                                12120000
121300         WHEN SQLCODE = ZERO                                      12130000
121400             CONTINUE                                             12140000
121500         WHEN SQLWARN0 NOT = SPACES                               12150000
121600         WHEN SQLCODE < +0                                        12160000
121700         WHEN SQLCODE > ZERO                                      12170000
121800             MOVE '4025-OPEN-TOT-UNTS-MNIFD-CSR'                  12180000
121900                                TO PV-ABEND-PARAGRAPH             12190000
122000             MOVE 'OPEN TOT-UNTS-MNIFD-CSR'                       12200000
122100                                TO PV-ABEND-OPERATION1            12210000
122200             PERFORM 9100-SQL-ABEND                               12220000
122300     END-EVALUATE.                                                12230000
122400                                                                  12240000
122500                                                                  12250000
122600******************************************************************12260000
122700 4030-FETCH-TOT-UNTS-MNIFD-CSR.                                   12270000
122800******************************************************************12280000
122900*    INITIALIZE PV-SHPD-QTY                                       12290000
123000     EXEC SQL                                                     12300000
123100         FETCH TOT-UNTS-MNIFD-CSR                                 12310000
123200          INTO  :PV-SHPD-QTY                                      12320000
123300     END-EXEC                                                     12330000
123400                                                                  12340000
123500     EVALUATE TRUE                                                12350000
123600         WHEN SQLCODE = ZERO                                      12360000
123700            SET SU036-MANIFESTED TO TRUE                          12370000
123800            ADD PV-SHPD-QTY TO PV-TOT-UNTS-MFST                   12380000
123900            SET PS-MFSTD TO TRUE                                  12390000
124000         WHEN SQLCODE = +100                                      12400000
124100            SET SU036-NO-MANIFESTED TO TRUE                       12410000
124200            SET SU036-MFST-NO-SRC   TO TRUE                       12420000
124300            SET PS-EOF-TOT-UNTS-MNIFD-CSR TO TRUE                 12430000
124400*LMM        SET PS-NOT-MFSTD TO TRUE                              12440000
124500         WHEN SQLCODE = -305                                      12450000
124600            ADD ZEROES      TO PV-TOT-UNTS-MFST                   12460000
124700         WHEN SQLWARN0 NOT = SPACES                               12470000
124800         WHEN SQLCODE < +0                                        12480000
124900         WHEN SQLCODE > ZERO                                      12490000
125000             MOVE '4030-FETCH-TOT-UNTS-MNIFD-CSR'                 12500000
125100                                TO PV-ABEND-PARAGRAPH             12510000
125200             MOVE 'FETCH TOT-UNTS-MNIFD-CSR'                      12520000
125300                                TO PV-ABEND-OPERATION1            12530000
125400             MOVE 'SUT00028'    TO PV-DB2-TABLE-NAME              12540000
125500             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        12550000
125600             STRING 'PO NBR: '         DELIMITED BY SIZE          12560000
125700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          12570000
125800                           INTO PV-ABEND-OPERATION1               12580000
125900             MOVE DK-REC-SEQ-NBR                                  12590000
126000                             TO PV-DISPLAY-RCVR-SEQ-NBR           12600000
126100             STRING 'RECV SEQ: '       DELIMITED BY SIZE          12610000
126200                 PV-DISPLAY-RCVR-SEQ-NBR                          12620000
126300                                       DELIMITED BY SIZE          12630000
126400                           INTO PV-ABEND-OPERATION2               12640000
126500             MOVE DK-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR      12650000
126600             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          12660000
126700                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          12670000
126800                           INTO PV-ABEND-OPERATION3               12680000
126900             PERFORM 9100-SQL-ABEND                               12690000
127000     END-EVALUATE.                                                12700000
127100                                                                  12710000
127200                                                                  12720000
127300******************************************************************12730000
127400 4035-CLOSE-TOT-UNTS-MNIFD-CSR.                                   12740000
127500******************************************************************12750000
127600     EXEC SQL                                                     12760000
127700         CLOSE TOT-UNTS-MNIFD-CSR                                 12770000
127800     END-EXEC.                                                    12780000
127900                                                                  12790000
128000     EVALUATE TRUE                                                12800000
128100         WHEN SQLCODE = ZERO                                      12810000
128200             CONTINUE                                             12820000
128300                                                                  12830000
128400         WHEN SQLWARN0 NOT = SPACES                               12840000
128500         WHEN SQLCODE < +0                                        12850000
128600         WHEN SQLCODE > ZERO                                      12860000
128700             MOVE '4035-CLOSE-TOT-UNTS-MNIFD-CSR'                 12870000
128800                                 TO PV-ABEND-PARAGRAPH            12880000
128900             MOVE 'CLOSE TOT-UNTS-MNIFD-CSR'                      12890000
129000                                 TO PV-ABEND-OPERATION1           12900000
129100             PERFORM 9100-SQL-ABEND                               12910000
129200     END-EVALUATE.                                                12920000
129300                                                                  12930000
129400                                                                  12940000
129500******************************************************************12950000
129600* GET TOTAL NUMBER OF CARTONS BY LINE.                            12960000
129700 4040-OPEN-TOT-CTNS-LINE-CSR.                                     12970000
129800******************************************************************12980000
129900     EXEC SQL                                                     12990000
130000          OPEN TOT-CTNS-LINE-CSR                                  13000000
130100     END-EXEC.                                                    13010000
130200                                                                  13020000
130300     EVALUATE TRUE                                                13030000
130400         WHEN SQLCODE = ZERO                                      13040000
130500             CONTINUE                                             13050000
130600         WHEN SQLWARN0 NOT = SPACES                               13060000
130700         WHEN SQLCODE < +0                                        13070000
130800         WHEN SQLCODE > ZERO                                      13080000
130900             MOVE '4040-OPEN-TOT-CTNS-LINE-CSR'                   13090000
131000                                TO PV-ABEND-PARAGRAPH             13100000
131100             MOVE 'OPEN TOT-CTNS-LINE-CSR'                        13110000
131200                                TO PV-ABEND-OPERATION1            13120000
131300             PERFORM 9100-SQL-ABEND                               13130000
131400     END-EVALUATE.                                                13140000
131500                                                                  13150000
131600******************************************************************13160000
131700*    FETCH THE CARTON CURSOR                                      13170000
131800 4045-FETCH-TOT-CTNS-LINE-CSR.                                    13180000
131900******************************************************************13190000
132000     EXEC SQL                                                     13200000
132100         FETCH TOT-CTNS-LINE-CSR                                  13210000
132200          INTO  :PV-LINE-COUNT                                    13220000
132300     END-EXEC.                                                    13230000
132400                                                                  13240000
132500     EVALUATE TRUE                                                13250000
132600         WHEN SQLCODE = ZERO                                      13260000
132700              ADD PV-LINE-COUNT TO PV-TOT-CTN-LNE                 13270000
132800         WHEN SQLCODE = +100                                      13280000
132900              SET PS-EOF-TOT-CTNS-LINE-CSR TO TRUE                13290000
133000         WHEN SQLCODE = -305                                      13300000
133100              ADD ZEROES               TO PV-TOT-CTN-LNE          13310000
133200         WHEN SQLWARN0 NOT = SPACES                               13320000
133300         WHEN SQLCODE < +0                                        13330000
133400         WHEN SQLCODE > ZERO                                      13340000
133500             MOVE '4045-FETCH-TOT-CTNS-LINE-CSR'                  13350000
133600                                TO PV-ABEND-PARAGRAPH             13360000
133700             MOVE 'FETCH TOT-CTNS-LINE-CSR'                       13370000
133800                                TO PV-ABEND-OPERATION1            13380000
133900             MOVE 'SUT00028'    TO PV-DB2-TABLE-NAME              13390000
134000             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        13400000
134100             STRING 'PO NBR: '         DELIMITED BY SIZE          13410000
134200                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          13420000
134300                           INTO PV-ABEND-OPERATION1               13430000
134400             MOVE DK-REC-SEQ-NBR                                  13440000
134500                             TO PV-DISPLAY-RCVR-SEQ-NBR           13450000
134600             STRING 'RECV SEQ: '       DELIMITED BY SIZE          13460000
134700                 PV-DISPLAY-RCVR-SEQ-NBR                          13470000
134800                                       DELIMITED BY SIZE          13480000
134900                           INTO PV-ABEND-OPERATION2               13490000
135000             MOVE DK-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR      13500000
135100             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          13510000
135200                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          13520000
135300                           INTO PV-ABEND-OPERATION3               13530000
135400             PERFORM 9100-SQL-ABEND                               13540000
135500     END-EVALUATE.                                                13550000
135600                                                                  13560000
135700******************************************************************13570000
135800* CLOSE CARTON CURSOR.                                            13580000
135900 4050-CLOSE-TOT-CTNS-LINE-CSR.                                    13590000
136000******************************************************************13600000
136100     EXEC SQL                                                     13610000
136200         CLOSE TOT-CTNS-LINE-CSR                                  13620000
136300     END-EXEC.                                                    13630000
136400                                                                  13640000
136500     EVALUATE TRUE                                                13650000
136600         WHEN SQLCODE = ZERO                                      13660000
136700             CONTINUE                                             13670000
136800                                                                  13680000
136900         WHEN SQLWARN0 NOT = SPACES                               13690000
137000         WHEN SQLCODE < +0                                        13700000
137100         WHEN SQLCODE > ZERO                                      13710000
137200             MOVE '4050-CLOSE-TOT-CTNS-LINE-CSR'                  13720000
137300                                 TO PV-ABEND-PARAGRAPH            13730000
137400             MOVE 'CLOSE TOT-CTNS-LINE-CSR'                       13740000
137500                                 TO PV-ABEND-OPERATION1           13750000
137600             PERFORM 9100-SQL-ABEND                               13760000
137700     END-EVALUATE.                                                13770000
137800                                                                  13780000
137900******************************************************************13790000
138000* OPEN VERIFIED SOURCE CURSOR.                                    13800000
138100 4055-OPEN-VRFY-SRC-CSR.                                          13810000
138200******************************************************************13820000
138300     EXEC SQL                                                     13830000
138400          OPEN VRFY-SRC-CSR                                       13840000
138500     END-EXEC.                                                    13850000
138600                                                                  13860000
138700     EVALUATE TRUE                                                13870000
138800         WHEN SQLCODE = ZERO                                      13880000
138900             CONTINUE                                             13890000
139000         WHEN SQLWARN0 NOT = SPACES                               13900000
139100         WHEN SQLCODE < +0                                        13910000
139200         WHEN SQLCODE > ZERO                                      13920000
139300             MOVE '4055-OPEN-VRFY-SRC-CSR'                        13930000
139400                                TO PV-ABEND-PARAGRAPH             13940000
139500             MOVE 'OPEN VRFY-SRC-CSR'                             13950000
139600                                TO PV-ABEND-OPERATION1            13960000
139700             PERFORM 9100-SQL-ABEND                               13970000
139800     END-EVALUATE.                                                13980000
139900                                                                  13990000
140000******************************************************************14000000
140100*    FETCH THE VERIFY SOURCE CURSOR                               14010000
140200 4060-FETCH-VRFY-SRC-CSR.                                         14020000
140300******************************************************************14030000
140400     EXEC SQL                                                     14040000
140500         FETCH VRFY-SRC-CSR                                       14050000
140600          INTO  :RECDVS-VRFY-SRC-CDE                              14060000
140700     END-EXEC.                                                    14070000
140800                                                                  14080000
140900     EVALUATE TRUE                                                14090000
141000         WHEN SQLCODE = ZERO                                      14100000
141100             SET SU036-VERIFIED TO TRUE                           14110000
141200             EVALUATE TRUE                                        14120000
141300                WHEN RECDVS-VRFY-SRC-CDE = PC-P2                  14130000
141400                   SET SU036-VRFD-P2L  TO TRUE                    14140000
141500                   MOVE PC-P TO DK-ACTN-CDE                       14150000
141600                WHEN RECDVS-VRFY-SRC-CDE = PC-CP                  14160000
141700                   SET SU036-VRFD-FCSE TO TRUE                    14170000
141800                   MOVE PC-C TO DK-ACTN-CDE                       14180000
141900                WHEN OTHER                                        14190000
142000                   SET SU036-VRFD-MAN  TO TRUE                    14200000
142100                   MOVE PC-V TO DK-ACTN-CDE                       14210000
142200             END-EVALUATE                                         14220000
142300                                                                  14230000
142400             MOVE RECDVS-VRFY-SRC-CDE TO PV-VRFY-SRC-CDE          14240000
142500                                         DK-VRFY-SRC-CDE          14250000
142600             PERFORM 3100-GET-VERIFIED-AREA                       14260000
142700             PERFORM 3300-SELECT-TRECDVS                          14270000
142800             MOVE RECDVS-VRFY-ITM-QTY      TO PV-VRFD-UNITS       14280000
142900         WHEN SQLCODE = +100                                      14290000
143000             SET SU036-NO-VERIFIED TO TRUE                        14300000
143100             MOVE SPACES TO RECDVS-VRFY-SRC-CDE                   14310000
143200             MOVE SPACES TO PV-VRFY-SRC-CDE                       14320000
143300             SET PS-EOF-VRFY-SRC-CSR TO TRUE                      14330000
143400         WHEN SQLWARN0 NOT = SPACE                                14340000
143500         WHEN SQLCODE  NOT = +0                                   14350000
143600             MOVE '4060-FETCH-VRFY-SRC-CSR'                       14360000
143700                                TO PV-ABEND-PARAGRAPH             14370000
143800             MOVE 'FETCH VRFY-SRC-CSR'                            14380000
143900                                 TO PV-ABEND-OPERATION1           14390000
144000             MOVE 'TRECDVS' TO PV-DB2-TABLE-NAME                  14400000
144100             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        14410000
144200             STRING 'PO NBR: '         DELIMITED BY SIZE          14420000
144300                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          14430000
144400                           INTO PV-ABEND-OPERATION1               14440000
144500             MOVE DK-REC-SEQ-NBR                                  14450000
144600                             TO PV-DISPLAY-RCVR-SEQ-NBR           14460000
144700             STRING 'RECV SEQ: '       DELIMITED BY SIZE          14470000
144800                 PV-DISPLAY-RCVR-SEQ-NBR                          14480000
144900                                       DELIMITED BY SIZE          14490000
145000                           INTO PV-ABEND-OPERATION2               14500000
145100             MOVE DK-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR      14510000
145200             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          14520000
145300                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          14530000
145400                           INTO PV-ABEND-OPERATION3               14540000
145500             PERFORM 9100-SQL-ABEND                               14550000
145600     END-EVALUATE.                                                14560000
145700                                                                  14570000
145800******************************************************************14580000
145900* CLOSE VERIFY SOURCE CURSOR.                                     14590000
146000 4065-CLOSE-VRFY-SRC-CSR.                                         14600000
146100******************************************************************14610000
146200     EXEC SQL                                                     14620000
146300         CLOSE VRFY-SRC-CSR                                       14630000
146400     END-EXEC.                                                    14640000
146500                                                                  14650000
146600     EVALUATE TRUE                                                14660000
146700         WHEN SQLCODE = ZERO                                      14670000
146800             CONTINUE                                             14680000
146900                                                                  14690000
147000         WHEN SQLWARN0 NOT = SPACES                               14700000
147100         WHEN SQLCODE < +0                                        14710000
147200         WHEN SQLCODE > ZERO                                      14720000
147300             MOVE '4065-CLOSE-VRFY-SRC-CSR'                       14730000
147400                                 TO PV-ABEND-PARAGRAPH            14740000
147500             MOVE 'CLOSE VRFY-SRC-CSR'                            14750000
147600                                 TO PV-ABEND-OPERATION1           14760000
147700             PERFORM 9100-SQL-ABEND                               14770000
147800     END-EVALUATE.                                                14780000
147900                                                                  14790000
148000                                                                  14800000
148100******************************************************************14810000
148200* OPEN MFST CARTON CURSOR.                                        14820000
148300 4070-OPEN-MFST-CTN-CSR.                                          14830000
148400******************************************************************14840000
148500     EXEC SQL                                                     14850000
148600          OPEN MFST-CTN-CSR                                       14860000
148700     END-EXEC.                                                    14870000
148800                                                                  14880000
148900     EVALUATE TRUE                                                14890000
149000         WHEN SQLCODE = ZERO                                      14900000
149100             CONTINUE                                             14910000
149200         WHEN SQLWARN0 NOT = SPACES                               14920000
149300         WHEN SQLCODE < +0                                        14930000
149400         WHEN SQLCODE > ZERO                                      14940000
149500             MOVE '4070-OPEN-MFST-CTN-CSR'                        14950000
149600                                TO PV-ABEND-PARAGRAPH             14960000
149700             MOVE 'OPEN MFST-CTN-CSR'                             14970000
149800                                TO PV-ABEND-OPERATION1            14980000
149900             PERFORM 9100-SQL-ABEND                               14990000
150000     END-EVALUATE.                                                15000000
150100                                                                  15010000
150200******************************************************************15020000
150300*    FETCH THE MFST CARTON CURSOR                                 15030000
150400 4075-FETCH-MFST-CTN-CSR.                                         15040000
150500******************************************************************15050000
150600                                                                  15060000
150700     EXEC SQL                                                     15070000
150800         FETCH MFST-CTN-CSR                                       15080000
150900          INTO  :PV-MFST-UNITS                                    15090000
151000               ,:PV-MFST-SOURCE                                   15100000
151100               ,:PV-MFST-CTNS                                     15110000
151200     END-EXEC                                                     15120000
151300                                                                  15130000
151400     EVALUATE TRUE                                                15140000
151500         WHEN SQLCODE = ZERO                                      15150000
151600              SET SU036-MANIFESTED TO TRUE                        15160000
151700              EVALUATE TRUE                                       15170000
151800                WHEN PV-MFST-SOURCE = PC-JWL OR                   15180000
151900                                      PC-P2L                      15190000
152000                   SET SU036-MFST-P2L  TO TRUE                    15200000
152100                WHEN PV-MFST-SOURCE = PC-ASN OR                   15210000
152200                                      PC-CPS                      15220000
152300                   SET SU036-MFST-FCSE TO TRUE                    15230000
152400                WHEN PV-MFST-SOURCE = PC-FXR OR                   15240000
152500                                      PC-MSC OR                   15250000
152600                                      PC-RCV OR                   15260000
152700                                      PC-RDM OR                   15270000
152800                                      PC-SMO OR                   15280000
152900                                      PC-DMG                      15290000
153000                   SET SU036-MFST-MAN  TO TRUE                    15300000
153100                WHEN OTHER                                        15310000
153200                   SET SU036-MFST-MAN  TO TRUE                    15320000
153300              END-EVALUATE                                        15330000
153400         WHEN SQLCODE = +100                                      15340000
153500            SET SU036-NO-MANIFESTED TO TRUE                       15350000
153600            SET SU036-MFST-NO-SRC   TO TRUE                       15360000
153700            SET PS-EOF-MFST-CTN-CSR TO TRUE                       15370000
153800         WHEN SQLCODE = -305                                      15380000
153900            ADD ZEROES TO PV-MFST-UNITS                           15390000
154000         WHEN SQLWARN0 NOT = SPACES                               15400000
154100         WHEN SQLCODE < +0                                        15410000
154200         WHEN SQLCODE > ZERO                                      15420000
154300             MOVE '4075-FETCH-MFST-CTN-CSR'                       15430000
154400                                TO PV-ABEND-PARAGRAPH             15440000
154500             MOVE 'FETCH MFST CTN CSR'                            15450000
154600                                TO PV-ABEND-OPERATION1            15460000
154700             MOVE 'SUT00028'    TO PV-DB2-TABLE-NAME              15470000
154800             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        15480000
154900             STRING 'PO NBR: '         DELIMITED BY SIZE          15490000
155000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          15500000
155100                           INTO PV-ABEND-OPERATION1               15510000
155200             MOVE DK-REC-SEQ-NBR                                  15520000
155300                             TO PV-DISPLAY-RCVR-SEQ-NBR           15530000
155400             STRING 'RECV SEQ: '       DELIMITED BY SIZE          15540000
155500                 PV-DISPLAY-RCVR-SEQ-NBR                          15550000
155600                                       DELIMITED BY SIZE          15560000
155700                           INTO PV-ABEND-OPERATION2               15570000
155800             MOVE DK-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR      15580000
155900             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          15590000
156000                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          15600000
156100                           INTO PV-ABEND-OPERATION3               15610000
156200             PERFORM 9100-SQL-ABEND                               15620000
156300     END-EVALUATE.                                                15630000
156400                                                                  15640000
156500                                                                  15650000
156600******************************************************************15660000
156700* CLOSE MFST CARTON CURSOR                                        15670000
156800 4080-CLOSE-MFST-CTN-CSR.                                         15680000
156900******************************************************************15690000
157000     EXEC SQL                                                     15700000
157100         CLOSE MFST-CTN-CSR                                       15710000
157200     END-EXEC.                                                    15720000
157300                                                                  15730000
157400     EVALUATE TRUE                                                15740000
157500         WHEN SQLCODE = ZERO                                      15750000
157600             CONTINUE                                             15760000
157700                                                                  15770000
157800         WHEN SQLWARN0 NOT = SPACES                               15780000
157900         WHEN SQLCODE < +0                                        15790000
158000         WHEN SQLCODE > ZERO                                      15800000
158100             MOVE '4080-CLOSE-MFST-CTN-CSR'                       15810000
158200                                 TO PV-ABEND-PARAGRAPH            15820000
158300             MOVE 'CLOSE MFST-CTN-CSR'                            15830000
158400                                 TO PV-ABEND-OPERATION1           15840000
158500             PERFORM 9100-SQL-ABEND                               15850000
158600     END-EVALUATE.                                                15860000
158700                                                                  15870000
158800                                                                  15880000
158900***************************************************************** 15890000
159000 7100-READ-PO-FILE.                                               15900000
159100******************************************************************15910000
159200     READ PO-FILE INTO SU036-RECORD                               15920000
159300        AT END                                                    15930000
159400           SET PS-END-OF-PO-FILE TO TRUE                          15940000
159500        NOT AT END                                                15950000
159600                                                                  15960000
159700     MOVE SU036-PO-NUMBER    TO DK-PO-NBR                         15970000
159800     MOVE SU036-REC-SEQ-NBR  TO DK-REC-SEQ-NBR                    15980000
159900     MOVE SU036-LINE-NBR     TO DK-LINE-NBR                       15990000
160000                                                                  16000000
160100     IF PS-NOT-END-OF-PO-FILE                                     16010000
160200        PERFORM 2300-GET-ITEM-NBR                                 16020000
160300                                                                  16030000
160400        PERFORM 2500-GET-TOT-UNTS-VERIFIED                        16040000
160500                                                                  16050000
160600        PERFORM 2600-GET-TOT-UNITS-MANIFESTED                     16060000
160700                                                                  16070000
160800*IF VE AND MF ARE EQUAL DO NOT DISPLAY LINE                       16080000
160900        IF PV-TOT-UNTS-MFST = PV-TOT-UNTS-VERIFD                  16090000
161000           CONTINUE                                               16100000
161100        ELSE                                                      16110000
161200           INITIALIZE PV-TOT-UNIT-VARIANCE                        16120000
161300           COMPUTE  PV-TOT-UNIT-VARIANCE                          16130000
161400               =  PV-TOT-UNTS-MFST - PV-TOT-UNTS-VERIFD           16140000
161500                                                                  16150000
161600           PERFORM 2700-GET-CTNS-BY-LINE                          16160000
161700                                                                  16170000
161800           PERFORM 2800-GET-PKG-TYPE                              16180000
161900                                                                  16190000
162000           PERFORM 2900-GET-VRFD-USR-ID                           16200000
162100                                                                  16210000
162200           EVALUATE TRUE                                          16220000
162300              WHEN RECITM-VRFD-USR-ID(1:2) = 'TK'                 16230000
162310              WHEN RECITM-VRFD-USR-ID(1:2) = 'TV'                 16231000
162320              WHEN RECITM-VRFD-USR-ID(1:2) = 'TC'                 16232000
162400                 SET SU036-VRFD-MAN     TO TRUE                   16240000
162500                 MOVE PC-MN TO PV-VRFY-SRC-CDE                    16250000
162600                 MOVE PC-V TO DK-ACTN-CDE                         16260000
162700                 PERFORM 3100-GET-VERIFIED-AREA                   16270000
162800                 PERFORM 3200-SELECT-TRECDIS                      16280000
162900                                                                  16290000
163000                 IF PS-MFSTD                                      16300000
163100                    SET  PS-NOT-EOF-MFST-CTN-CSR TO TRUE          16310000
163200                    PERFORM 4070-OPEN-MFST-CTN-CSR                16320000
163300                    PERFORM 4075-FETCH-MFST-CTN-CSR               16330000
163400                                                                  16340000
163500                    PERFORM UNTIL PS-EOF-MFST-CTN-CSR             16350000
163600                       PERFORM 2200-LOAD-VE-EXTRACT-RECORD        16360000
163700                       PERFORM 2250-LOAD-MF-EXTRACT-RECORD        16370000
163800                       PERFORM 8000-WRITE-EXTRACT                 16380000
163900                          ADD +1 TO PV-WRITE-COUNTER              16390000
164000                          INITIALIZE PV-VRFD-UNITS                16400000
164100                                     PV-VRFY-SRC-CDE              16410000
164200                                     PV-PRCG-AREA-CDE             16420000
164300                          INITIALIZE PV-MFST-UNITS                16430000
164400                                     PV-MFST-SOURCE               16440000
164500                                     PV-MFST-CTNS                 16450000
164600                       PERFORM 4075-FETCH-MFST-CTN-CSR            16460000
164700                    END-PERFORM                                   16470000
164800                    PERFORM 4080-CLOSE-MFST-CTN-CSR               16480000
164900                 ELSE                                             16490000
165000                    PERFORM 2200-LOAD-VE-EXTRACT-RECORD           16500000
165100                    PERFORM 2250-LOAD-MF-EXTRACT-RECORD           16510000
165200                    PERFORM 8000-WRITE-EXTRACT                    16520000
165300                       ADD +1 TO PV-WRITE-COUNTER                 16530000
165400                       INITIALIZE PV-VRFD-UNITS                   16540000
165500                                  PV-VRFY-SRC-CDE                 16550000
165600                                  PV-PRCG-AREA-CDE                16560000
165700                       INITIALIZE PV-MFST-UNITS                   16570000
165800                                  PV-MFST-SOURCE                  16580000
165900                                  PV-MFST-CTNS                    16590000
166000                 END-IF                                           16600000
166100                                                                  16610000
166200              WHEN RECITM-VRFD-USR-ID      = 'CASE'               16620000
166300                 SET SU036-VRFD-FCSE    TO TRUE                   16630000
166400                 MOVE PC-CP TO PV-VRFY-SRC-CDE                    16640000
166500                 MOVE PC-C TO DK-ACTN-CDE                         16650000
166600                 PERFORM 3100-GET-VERIFIED-AREA                   16660000
166700                 PERFORM 3200-SELECT-TRECDIS                      16670000
166800                                                                  16680000
166900                 IF PS-MFSTD                                      16690000
167000                    SET  PS-NOT-EOF-MFST-CTN-CSR TO TRUE          16700000
167100                    PERFORM 4070-OPEN-MFST-CTN-CSR                16710000
167200                    PERFORM 4075-FETCH-MFST-CTN-CSR               16720000
167300                                                                  16730000
167400                    PERFORM UNTIL PS-EOF-MFST-CTN-CSR             16740000
167500                       PERFORM 2200-LOAD-VE-EXTRACT-RECORD        16750000
167600                       PERFORM 2250-LOAD-MF-EXTRACT-RECORD        16760000
167700                       PERFORM 8000-WRITE-EXTRACT                 16770000
167800                          ADD +1 TO PV-WRITE-COUNTER              16780000
167900                          INITIALIZE PV-VRFD-UNITS                16790000
168000                                     PV-VRFY-SRC-CDE              16800000
168100                                     PV-PRCG-AREA-CDE             16810000
168200                          INITIALIZE PV-MFST-UNITS                16820000
168300                                     PV-MFST-SOURCE               16830000
168400                                     PV-MFST-CTNS                 16840000
168500                       PERFORM 4075-FETCH-MFST-CTN-CSR            16850000
168600                    END-PERFORM                                   16860000
168700                    PERFORM 4080-CLOSE-MFST-CTN-CSR               16870000
168800                 ELSE                                             16880000
168900                    PERFORM 2200-LOAD-VE-EXTRACT-RECORD           16890000
169000                    PERFORM 2250-LOAD-MF-EXTRACT-RECORD           16900000
169100                    PERFORM 8000-WRITE-EXTRACT                    16910000
169200                       ADD +1 TO PV-WRITE-COUNTER                 16920000
169300                       INITIALIZE PV-VRFD-UNITS                   16930000
169400                                  PV-VRFY-SRC-CDE                 16940000
169500                                  PV-PRCG-AREA-CDE                16950000
169600                       INITIALIZE PV-MFST-UNITS                   16960000
169700                                  PV-MFST-SOURCE                  16970000
169800                                  PV-MFST-CTNS                    16980000
169900                 END-IF                                           16990000
170000                                                                  17000000
170100                                                                  17010000
170200              WHEN RECITM-VRFD-USR-ID      = 'P2L'                17020000
170300                 SET SU036-VRFD-P2L     TO TRUE                   17030000
170400                 MOVE PC-P2 TO PV-VRFY-SRC-CDE                    17040000
170500                 MOVE PC-P TO DK-ACTN-CDE                         17050000
170600                 PERFORM 3100-GET-VERIFIED-AREA                   17060000
170700                 PERFORM 3200-SELECT-TRECDIS                      17070000
170800                                                                  17080000
170900                 IF PS-MFSTD                                      17090000
171000                    SET  PS-NOT-EOF-MFST-CTN-CSR TO TRUE          17100000
171100                    PERFORM 4070-OPEN-MFST-CTN-CSR                17110000
171200                    PERFORM 4075-FETCH-MFST-CTN-CSR               17120000
171300                                                                  17130000
171400                    PERFORM UNTIL PS-EOF-MFST-CTN-CSR             17140000
171500                       PERFORM 2200-LOAD-VE-EXTRACT-RECORD        17150000
171600                       PERFORM 2250-LOAD-MF-EXTRACT-RECORD        17160000
171700                       PERFORM 8000-WRITE-EXTRACT                 17170000
171800                          ADD +1 TO PV-WRITE-COUNTER              17180000
171900                          INITIALIZE PV-VRFD-UNITS                17190000
172000                                     PV-VRFY-SRC-CDE              17200000
172100                                     PV-PRCG-AREA-CDE             17210000
172200                          INITIALIZE PV-MFST-UNITS                17220000
172300                                     PV-MFST-SOURCE               17230000
172400                                     PV-MFST-CTNS                 17240000
172500                       PERFORM 4075-FETCH-MFST-CTN-CSR            17250000
172600                    END-PERFORM                                   17260000
172700                    PERFORM 4080-CLOSE-MFST-CTN-CSR               17270000
172800                 ELSE                                             17280000
172900                    PERFORM 2200-LOAD-VE-EXTRACT-RECORD           17290000
173000                    PERFORM 2250-LOAD-MF-EXTRACT-RECORD           17300000
173100                    PERFORM 8000-WRITE-EXTRACT                    17310000
173200                       ADD +1 TO PV-WRITE-COUNTER                 17320000
173300                       INITIALIZE PV-VRFD-UNITS                   17330000
173400                                  PV-VRFY-SRC-CDE                 17340000
173500                                  PV-PRCG-AREA-CDE                17350000
173600                       INITIALIZE PV-MFST-UNITS                   17360000
173700                                  PV-MFST-SOURCE                  17370000
173800                                  PV-MFST-CTNS                    17380000
173900                 END-IF                                           17390000
174000                                                                  17400000
174100                                                                  17410000
174200              WHEN RECITM-VRFD-USR-ID      = 'P2L/CASE'           17420000
174300                 PERFORM 3000-GET-VERIFIED-SOURCE                 17430000
174400                 PERFORM 3350-SELECT-TRECDVS                      17440000
174500                                                                  17450000
174600                   IF PV-TOT-UNTS-VERIFD = PV-TOT-RECDVS-UNTS     17460000
174700                     CONTINUE                                     17470000
174800                   ELSE                                           17480000
174900                     MOVE PC-MN TO PV-VRFY-SRC-CDE                17490000
175000                     SET SU036-VRFD-NO-SRC TO TRUE                17500000
175100                     COMPUTE PV-DIFFERENCE =                      17510000
175200                     PV-TOT-UNTS-VERIFD - PV-TOT-RECDVS-UNTS      17520000
175300                     MOVE PV-DIFFERENCE TO PV-VRFD-UNITS          17530000
175400                                                                  17540000
175500                     PERFORM 2200-LOAD-VE-EXTRACT-RECORD          17550000
175600                     PERFORM 2250-LOAD-MF-EXTRACT-RECORD          17560000
175700                     PERFORM 8000-WRITE-EXTRACT                   17570000
175800                     ADD +1 TO PV-WRITE-COUNTER                   17580000
175900                   END-IF                                         17590000
176000                                                                  17600000
176100              WHEN RECITM-VRFD-USR-ID(1:2) = '  '                 17610000
176200                 SET SU036-VRFD-MAN     TO TRUE                   17620000
176300                 MOVE PC-MN TO PV-VRFY-SRC-CDE                    17630000
176400                 MOVE PC-V TO DK-ACTN-CDE                         17640000
176500                 PERFORM 3100-GET-VERIFIED-AREA                   17650000
176600                 PERFORM 3200-SELECT-TRECDIS                      17660000
176700                                                                  17670000
176800                 IF PS-MFSTD                                      17680000
176900                    SET  PS-NOT-EOF-MFST-CTN-CSR TO TRUE          17690000
177000                    PERFORM 4070-OPEN-MFST-CTN-CSR                17700000
177100                    PERFORM 4075-FETCH-MFST-CTN-CSR               17710000
177200                                                                  17720000
177300                    PERFORM UNTIL PS-EOF-MFST-CTN-CSR             17730000
177400                       PERFORM 2200-LOAD-VE-EXTRACT-RECORD        17740000
177500                       PERFORM 2250-LOAD-MF-EXTRACT-RECORD        17750000
177600                       PERFORM 8000-WRITE-EXTRACT                 17760000
177700                          ADD +1 TO PV-WRITE-COUNTER              17770000
177800                          INITIALIZE PV-VRFD-UNITS                17780000
177900                                     PV-VRFY-SRC-CDE              17790000
178000                                     PV-PRCG-AREA-CDE             17800000
178100                          INITIALIZE PV-MFST-UNITS                17810000
178200                                     PV-MFST-SOURCE               17820000
178300                                     PV-MFST-CTNS                 17830000
178400                       PERFORM 4075-FETCH-MFST-CTN-CSR            17840000
178500                    END-PERFORM                                   17850000
178600                    PERFORM 4080-CLOSE-MFST-CTN-CSR               17860000
178700                 ELSE                                             17870000
178800                    PERFORM 2200-LOAD-VE-EXTRACT-RECORD           17880000
178900                    PERFORM 2250-LOAD-MF-EXTRACT-RECORD           17890000
179000                    PERFORM 8000-WRITE-EXTRACT                    17900000
179100                       ADD +1 TO PV-WRITE-COUNTER                 17910000
179200                       INITIALIZE PV-VRFD-UNITS                   17920000
179300                                  PV-VRFY-SRC-CDE                 17930000
179400                                  PV-PRCG-AREA-CDE                17940000
179500                       INITIALIZE PV-MFST-UNITS                   17950000
179600                                  PV-MFST-SOURCE                  17960000
179700                                  PV-MFST-CTNS                    17970000
179800                 END-IF                                           17980000
179900                                                                  17990000
180000           END-EVALUATE                                           18000000
180100        END-IF                                                    18010000
180200     END-IF                                                       18020000
180300                                                                  18030000
180400           ADD +1 TO PV-READ-COUNTER                              18040000
180500     END-READ.                                                    18050000
180600                                                                  18060000
180700                                                                  18070000
180800***************************************************************** 18080000
180900 8000-WRITE-EXTRACT.                                              18090000
181000***************************************************************** 18100000
181100     WRITE EXTRACT-RECORD                                         18110000
181200       FROM SU036-RECORD.                                         18120000
181300*    INITIALIZE SU036-RECORD.                                     18130000
181400                                                                  18140000
181500***************************************************************** 18150000
181600 9100-SQL-ABEND.                                                  18160000
181700***************************************************************** 18170000
181800     MOVE SQLCODE                     TO SQLCODE2.                18180000
181900     MOVE SQLERRD(3)                  TO SQLERRD3.                18190000
182000                                                                  18200000
182100     DISPLAY '** ABEND **         ** = SQLERROR'.                 18210000
182200     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                18220000
182300     DISPLAY '** PO NUMBER ** = ' PV-DISPLAY-PO-NBR.              18230000
182400     DISPLAY '** RECEIVER  ** = ' PV-DISPLAY-RCVR-SEQ-NBR.        18240000
182500     DISPLAY '** PO LNE NBR** = ' PV-DISPLAY-PO-LINE-NBR.         18250000
182600                                                                  18260000
182700                                                                  18270000
182800     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             18280000
182900     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                18290000
183000     DISPLAY '** DB2 TABLE ** = ' PV-DB2-TABLE-NAME.              18300000
183100     DISPLAY '** DB2 TABLE ** = ' PV-DB2-TABLE-NAME1.             18310000
183200     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                18320000
183300     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                18330000
183400     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 18340000
183500     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                18350000
183600                                                                  18360000
183700                                                                  18370000
183800     MOVE +4013                       TO PV-ABEND-CODE.           18380000
183900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         18390000
