000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.             SUKRP069.                                00030000
000400 AUTHOR.                 DENISE HAHN.                             00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN.           MAY, 2015.                               00060000
000700 DATE-COMPILED.                                                   00070000
000800***************************************************************** 00080000
000900*                                                               * 00090000
001000*  OPEN TRAILER REPORT -                                        * 00100000
001100*                                                               * 00110000
001200*  ALL SHIPPING DOORS LISTED                                    * 00120000
001300*  ONLY TRIPS TO BRICK & MORTAR STORES ARE LISTED.              * 00130000
001400*                                                               * 00140000
001500*  INPUT FILE IS CREATED BY SUKUT175 - SURD116                  * 00150000
001700*                                                               * 00170000
001800***************************************************************** 00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000 CONFIGURATION SECTION.                                           00200000
002100                                                                  00210000
002200 SOURCE-COMPUTER.        IBM-3090.                                00220000
002300 OBJECT-COMPUTER.        IBM-3090.                                00230000
002400                                                                  00240000
002500***************************************************************** 00250000
002600 INPUT-OUTPUT SECTION.                                            00260000
002700                                                                  00270000
002800 FILE-CONTROL.                                                    00280000
002900                                                                  00290000
003000     SELECT INPUT-FILE                                            00300003
003100         ASSIGN TO INP01.                                         00310000
003200                                                                  00320000
003600     SELECT REPORT-FILE                                           00360000
003700         ASSIGN TO RPT01.                                         00370000
003800                                                                  00380000
003900***************************************************************** 00390000
004000 DATA DIVISION.                                                   00400000
004100***************************************************************** 00410000
004200 FILE SECTION.                                                    00420000
004300                                                                  00430000
004400 FD  INPUT-FILE                                                   00440003
004500     RECORDING MODE IS F                                          00450000
004600     LABEL RECORDS ARE STANDARD                                   00460000
004700     BLOCK CONTAINS 0 RECORDS.                                    00470000
004800 01  INPUT-RECORD                    PIC  X(150).                 00480003
004900                                                                  00490000
005600 FD  REPORT-FILE                                                  00560000
005700     RECORDING MODE IS F                                          00570000
005800     BLOCK CONTAINS 0  RECORDS.                                   00580000
005900 01  REPORT-RECORD                   PIC X(132).                  00590000
006000                                                                  00600000
006100***************************************************************** 00610000
006200 WORKING-STORAGE SECTION.                                         00620000
006300                                                                  00630000
006400 01  PROGRAM-SWITCHES.                                            00640000
006500     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00650001
006600         88  PS-END-OF-INPUT                   VALUE 'Y'.         00660001
006700         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00670001
007400                                                                  00740000
007500 01  PC-PROGRAM-CONSTANTS.                                        00750000
007600     05  PC-SUKRP069                 PIC X(08) VALUE              00760000
007700                                               'SUKRP069'.        00770000
007800     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00780000
007900     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00790000
008000                                               COMP-3.            00800000
008100     05  PC-DEFAULT-TMST             PIC X(26)  VALUE             00810000
008200                                    '9999-09-09-09.09.09.999999'. 00820000
008300     05  PC-SLASH                    PIC X(01) VALUE '/'.         00830000
008400     05  PC-DASH                     PIC X(01) VALUE '-'.         00840000
008500                                                                  00850000
008600 01  SD-DATE-TIME.                                                00860000
008700     05  SD-SYSTEM-DATE.                                          00870000
008800         10  SD-SYSTEM-DATE-YY       PIC 9(02) VALUE ZERO.        00880000
008900         10  SD-SYSTEM-DATE-MM       PIC 9(02) VALUE ZERO.        00890000
009000         10  SD-SYSTEM-DATE-DD       PIC 9(02) VALUE ZERO.        00900000
009100     05  SD-SYSTEM-TIME.                                          00910000
009200         10  SD-SYSTEM-TIME-HH       PIC 9(02) VALUE ZERO.        00920000
009300         10  SD-SYSTEM-TIME-MM       PIC 9(02) VALUE ZERO.        00930000
009400         10  SD-SYSTEM-TIME-SS       PIC 9(02) VALUE ZERO.        00940000
009500         10  FILLER                  PIC 9(02) VALUE ZERO.        00950000
009600                                                                  00960000
009700 01  PV-PROGRAM-VARIABLES.                                        00970000
009800     05  PV-READ-COUNT                PIC S9(7) COMP-3            00980003
009900                                                VALUE ZERO.       00990000
010200     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            01020000
010300                                                VALUE ZERO.       01030000
010400     05  PV-NULL-IND                 PIC S9(04) VALUE +0          01040000
010500                                               COMP SYNC.         01050000
010600     05  PV-FORMAT-DATE.                                          01060000
010700         10 PV-FORMAT-DATE-MM         PIC  9(02).                 01070000
010800         10 FILLER                    PIC  X(01) VALUE '/'.       01080000
010900         10 PV-FORMAT-DATE-DD         PIC  9(02).                 01090000
011000         10 FILLER                    PIC  X(01) VALUE '/'.       01100000
011100         10 PV-FORMAT-DATE-CCYY       PIC  9(04).                 01110000
011200                                                                  01120000
011300     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        01130000
011400     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         01140000
011500                                               COMP-3.            01150000
011600     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         01160000
011700                                               COMP-3.            01170000
011710     05  PV-LINES-ON-PAGE            PIC  9(3) VALUE 60.          01171001
011720                                                                  01172001
011800     05  PV-TODAYS-DATE.                                          01180000
011900         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01190000
012000         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01200000
012100         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01210000
012200     05  PV-TODAYS-DATE-YYYY.                                     01220000
012300         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          01230000
012400         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZERO.        01240000
012500                                                                  01250000
012600     05  PV-TODAYS-TIME.                                          01260000
012700         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01270000
012800         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01280000
012900         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01290000
013000         10  FILLER                  PIC 9(02) VALUE ZERO.        01300000
013100                                                                  01310000
013200 01  PV-ABEND-FIELDS.                                             01320000
013300     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           01330000
013400                                               COMP SYNC.         01340000
013500     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'SUKRP069'.  01350000
013600     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      01360000
013700     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      01370000
013800     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      01380000
013900     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      01390000
014000     05  PV-DB2-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      01400000
014100     05  PV-DB2-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      01410000
014200     05  PV-DB2-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      01420000
014300     05  PV-DB2-TABLE-NAME-1         PIC X(08) VALUE SPACES.      01430000
014400     05  PV-DB2-TABLE-NAME-2         PIC X(08) VALUE SPACES.      01440000
014500                                                                  01450000
014600     05  PV-DISPLAY-OPER             PIC  9(04) VALUE ZEROES.     01460000
014700     05  PV-DISPLAY-SQLCODE          PIC  9(03)- VALUE ZEROES.    01470000
014800     05  PV-DB2-TABLE-NAME1          PIC  X(15) VALUE SPACES.     01480000
014900                                                                  01490000
015000     05  PV-DISPLAY-READ-COUNT       PIC ZZZ,ZZZ,ZZ9.             01500003
015200     05  PV-DISPLAY-WRITE-COUNT      PIC ZZZ,ZZZ,ZZ9.             01520000
015300     05  PV-DISPLAY-PERCENT1         PIC ZZZ.99.                  01530000
015310     05  PV-DISPLAY-PERCENT2         PIC ZZZ.                     01531000
015320                                                                  01532000
019000 01  PV-SAVE-FIELDS.                                              01900000
019100     05  PV-SAVE-OPER-UNT-ID          PIC S9(04) COMP             01910000
019200                                                 VALUE +0.        01920000
019300 01  DK-DB-KEYS.                                                  01930000
019400     05  DK-OPER-UNT-ID              PIC S9(4) COMP.              01940000
019500                                                                  01950000
020200                                                                  02020000
020300******************************************************************02030000
020400* RECORD LAYOUT FOR THE INPUT FILE.                               02040000
020500******************************************************************02050000
020600     COPY SURD116.                                                02060000
020700                                                                  02070000
021300******************************************************************02130000
021400*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02140000
021500******************************************************************02150000
021600     COPY DPWS132O.                                               02160000
021700                                                                  02170000
021800 01  WS-BATCH-PROC-DATE.                                          02180000
021900     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      02190000
022000     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      02200000
022100     05  FILLER                      PIC X(01) VALUE SPACES.      02210000
022200     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      02220000
022300     05  FILLER                      PIC X(01) VALUE SPACES.      02230000
022400     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      02240000
022500*                                                                 02250000
022600 01  HEADING-LINES.                                               02260000
022700     05  HEADING-LINE1.                                           02270000
022800         10  FILLER                  PIC X(49) VALUE SPACES.      02280000
022900         10  FILLER                  PIC X(34) VALUE              02290000
023000         'OPEN SHIPPING TRAILER SUMMARY'.                         02300000
023100         10  FILLER                  PIC X(38) VALUE SPACES.      02310000
023200                                                                  02320000
023300     05  HEADING-LINE2.                                           02330000
023410         10  HD2-OPER-UNT-ID         PIC 9(04) VALUE ZEROES.      02341001
023500         10  FILLER                  PIC X(01) VALUE SPACES.      02350003
023600         10  HD2-DC-NAME             PIC X(40) VALUE SPACES.      02360003
023700         10  FILLER                  PIC X(87) VALUE SPACES.      02370003
023800                                                                  02380000
023900     05  HEADING-LINE3.                                           02390000
024000         10  FILLER            PIC X(47) VALUE SPACES.            02400001
024100         10  FILLER            PIC X(01) VALUE '#'.               02410001
024110         10  FILLER            PIC X(11) VALUE SPACES.            02411001
024120         10  FILLER            PIC X(01) VALUE '#'.               02412001
024130         10  FILLER            PIC X(11) VALUE SPACES.            02413001
024140         10  FILLER            PIC X(01) VALUE '#'.               02414001
024150         10  FILLER            PIC X(25) VALUE SPACES.            02415001
024400         10  FILLER            PIC X(07) VALUE 'TRAILER'.         02440001
024600         10  FILLER            PIC X(04) VALUE SPACES.            02460001
024700         10  FILLER            PIC X(05) VALUE 'OTBND'.           02470001
024800         10  FILLER            PIC X(18) VALUE SPACES.            02480001
024900                                                                  02490000
025000     05  HEADING-LINE4.                                           02500000
025100         10  FILLER            PIC X(05) VALUE ' DC  '.           02510001
025200         10  FILLER            PIC X(07) VALUE 'STORE  '.         02520001
025400         10  FILLER            PIC X(06) VALUE 'DOOR  '.          02540001
025500         10  FILLER            PIC X(05) VALUE 'STORE'.           02550003
025600         10  FILLER            PIC X(21) VALUE SPACES.            02560005
025700         10  FILLER            PIC X(08) VALUE 'CARTONS '.        02570001
025710         10  FILLER            PIC X(12) VALUE '    CARTONS '.    02571001
025711         10  FILLER            PIC X(13) VALUE '    CARTONS  '.   02571101
025720         10  FILLER            PIC X(04) VALUE SPACES.            02572002
025730         10  FILLER            PIC X(13) VALUE ' TRAILER     '.   02573001
025731         10  FILLER            PIC X(11) VALUE '    SERIAL '.     02573101
025740         10  FILLER            PIC X(10) VALUE '    TRIP  '.      02574001
025750         10  FILLER            PIC X(16) VALUE '--- O P E N ----'.02575001
025800         10  FILLER            PIC X(01) VALUE SPACES.            02580000
025900                                                                  02590000
026000     05  HEADING-LINE5.                                           02600000
026010         10  FILLER            PIC X(05) VALUE ' NBR '.           02601001
026020         10  FILLER            PIC X(07) VALUE ' NBR   '.         02602001
026030         10  FILLER            PIC X(06) VALUE ' NBR  '.          02603001
026040         10  FILLER            PIC X(05) VALUE 'NAME '.           02604003
026050         10  FILLER            PIC X(21) VALUE SPACES.            02605005
026060         10  FILLER            PIC X(08) VALUE ' TOTAL  '.        02606001
026070         10  FILLER            PIC X(12) VALUE '   DIVERTED '.    02607001
026080         10  FILLER            PIC X(13) VALUE '    SCANNED  '.   02608001
026090         10  FILLER            PIC X(04) VALUE 'SCAC'.            02609001
026091         10  FILLER            PIC X(13) VALUE '   ID        '.   02609101
026092         10  FILLER            PIC X(11) VALUE '    NUMBER '.     02609201
026093         10  FILLER            PIC X(10) VALUE '     ID   '.      02609301
026094         10  FILLER            PIC X(16) VALUE '   DATE    TIME '.02609401
026095         10  FILLER            PIC X(01) VALUE SPACES.            02609501
028190                                                                  02819000
028200 01  DETAIL-LINES.                                                02820000
028300     05  DETAIL-LINE1.                                            02830000
028500         10  DL1-DC-NBR              PIC Z(04) VALUE ZEROES.      02850001
028600         10  FILLER                  PIC X(01) VALUE SPACES.      02860001
028700         10  DL1-STORE               PIC Z(04) VALUE ZEROES.      02870001
028800         10  FILLER                  PIC X(03) VALUE SPACES.      02880001
028900         10  DL1-DOOR                PIC X(04) VALUE SPACES.      02890001
029000         10  FILLER                  PIC X(02) VALUE SPACES.      02900001
029100         10  DL1-STORE-NAME          PIC X(20) VALUE SPACES.      02910001
029200         10  FILLER                  PIC X(02) VALUE SPACES.      02920000
029300         10  DL1-TOTAL-CARTONS       PIC ZZZ,ZZZ,ZZZ VALUE ZEROES.02930001
029400         10  FILLER                  PIC X(01) VALUE SPACES.      02940001
029500         10  DL1-DIVERTED            PIC ZZZ,ZZZ,ZZZ VALUE ZEROES.02950001
029600         10  FILLER                  PIC X(01) VALUE SPACES.      02960000
029700         10  DL1-SCANNED             PIC ZZZ,ZZZ,ZZZ VALUE ZEROES.02970001
029800         10  FILLER                  PIC X(02) VALUE SPACES.      02980001
029900         10  DL1-SCAC                PIC X(04) VALUE SPACES.      02990001
030000         10  FILLER                  PIC X(01) VALUE SPACES.      03000000
030100         10  DL1-TRLR-ID             PIC X(12) VALUE SPACES.      03010001
030200         10  FILLER                  PIC X(01) VALUE SPACES.      03020003
030300         10  DL1-TRLR-SERIAL         PIC Z(09) VALUE ZEROES.      03030001
030400         10  FILLER                  PIC X(01) VALUE SPACES.      03040000
030500         10  DL1-OTBND-TRIP          PIC Z(09) VALUE SPACES.      03050001
030600         10  FILLER                  PIC X(01) VALUE SPACES.      03060001
030700         10  DL1-DATE                PIC X(10) VALUE SPACES.      03070001
030800         10  FILLER                  PIC X(01) VALUE SPACES.      03080001
030900         10  DL1-TIME                PIC X(05) VALUE SPACES.      03090001
031200         10  FILLER                  PIC X(02) VALUE SPACES.      03120000
031300                                                                  03130000
034600 01  MISCELLANEOUS-LINES.                                         03460000
034700     05  BLANK-LINE.                                              03470000
034800         10  FILLER                  PIC X(132) VALUE SPACES.     03480000
034900                                                                  03490000
035000     05  END-OF-REPORT-LINE.                                      03500000
035100         10  FILLER                  PIC X(44) VALUE SPACES.      03510000
035200         10  FILLER                  PIC X(45) VALUE              03520000
035300             '*******   E N D   O F   R E P O R T   *******'.     03530000
035400         10  FILLER                  PIC X(43) VALUE SPACES.      03540000
035500                                                                  03550000
035600     05  NO-DATA-TO-REPORT-LINE.                                  03560000
035700         10  FILLER                  PIC X(40) VALUE SPACES.      03570000
035800         10  FILLER                  PIC  X(52)    VALUE          03580000
035900         '*******  N O   D A T A   T O   R E P O R T   *******'.  03590000
036000         10  FILLER                  PIC  X(40)    VALUE SPACES.  03600000
036100                                                                  03610000
036200                                                                  03620000
036300******************************************************************03630000
036400*  USED FOR DB2 ERROR MESSAGE BUILDING                            03640000
036500******************************************************************03650000
036600     COPY DPWS004.                                                03660000
036700                                                                  03670000
036800******************************************************************03680000
036900*   DB2 SQL COMMUNICATION AREA                                    03690000
037000******************************************************************03700000
037100     EXEC SQL                                                     03710000
037200          INCLUDE SQLCA                                           03720000
037300     END-EXEC.                                                    03730000
037400                                                                  03740000
037500*---------------------------------------------------------------* 03750000
037600*  DCLGEN FOR THE LOGISTICS LOCATION TABLE                        03760000
037700*  XLT_LOC                                                        03770000
037800*---------------------------------------------------------------* 03780000
037900     EXEC SQL                                                     03790000
038000          INCLUDE XLT00010                                        03800000
038100     END-EXEC.                                                    03810000
038200                                                                  03820000
038300******************************************************************03830000
038400 PROCEDURE DIVISION.                                              03840000
038500     DISPLAY '**** START OF SUKRP069 ****'.                       03850000
038600                                                                  03860000
038700*OPEN FILES.                                                      03870000
038800     OPEN INPUT  INPUT-FILE                                       03880003
039000          OUTPUT REPORT-FILE.                                     03900000
039100                                                                  03910000
039200     PERFORM 1000-INITIALIZATION.                                 03920000
039300                                                                  03930000
039310     SET  PS-NOT-END-OF-INPUT   TO  TRUE.                         03931001
039400                                                                  03940001
039600     PERFORM 7000-READ-EXTRACT-FILE.                              03960003
039800                                                                  03980000
040100     MOVE SU116-OPER-UNT-ID     TO PV-SAVE-OPER-UNT-ID            04010001
040200                                                                  04020000
040400     IF PS-END-OF-INPUT                                           04040001
040500        ADD +1                  TO PV-PAGE-COUNT                  04050000
040600        MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER             04060000
040700        WRITE REPORT-RECORD                                       04070000
040800          FROM DP132O-STANDRD-HEADER-132-COLS                     04080000
040900            AFTER ADVANCING PAGE                                  04090000
041000        WRITE REPORT-RECORD                                       04100000
041100          FROM HEADING-LINE1                                      04110000
041200            AFTER ADVANCING 1 LINES                               04120000
041300        WRITE REPORT-RECORD                                       04130000
041400          FROM HEADING-LINE2                                      04140000
041500            AFTER ADVANCING 1 LINE                                04150000
041600        WRITE REPORT-RECORD                                       04160000
041700          FROM NO-DATA-TO-REPORT-LINE                             04170000
041800            AFTER ADVANCING 2 LINES                               04180000
041900     ELSE                                                         04190000
042000        MOVE SU116-OPER-UNT-ID  TO PV-SAVE-OPER-UNT-ID            04200001
042100        PERFORM 8500-GET-LOCATION-NAME                            04210000
042200        PERFORM 1500-PRINT-HEADINGS                               04220000
042300        PERFORM 2000-PROCESS-INPUT                                04230001
042310          UNTIL PS-END-OF-INPUT                                   04231001
042400     END-IF.                                                      04240000
042500                                                                  04250000
042600*FINISH REPORT.                                                   04260000
043400                                                                  04340000
043500     WRITE REPORT-RECORD                                          04350000
043600       FROM END-OF-REPORT-LINE                                    04360000
043700         AFTER ADVANCING 3 LINES.                                 04370000
043800                                                                  04380000
043900*CLOSE FILES.                                                     04390000
044000     CLOSE INPUT-FILE                                             04400001
044200           REPORT-FILE.                                           04420000
044300                                                                  04430000
044700     MOVE PV-READ-COUNT TO PV-DISPLAY-READ-COUNT.                 04470001
044800     DISPLAY 'TOTAL INPUT READ ' PV-DISPLAY-READ-COUNT.           04480001
044900                                                                  04490000
045000     MOVE PV-WRITE-COUNT TO PV-DISPLAY-WRITE-COUNT.               04500000
045100     DISPLAY 'TOTAL RECS WRITTEN ' PV-DISPLAY-WRITE-COUNT.        04510000
045200                                                                  04520000
045300     GOBACK.                                                      04530000
045400                                                                  04540000
045500******************************************************************04550000
045600*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *04560000
045700******************************************************************04570000
045800 1000-INITIALIZATION.                                             04580000
045900     ACCEPT SD-SYSTEM-DATE                                        04590000
046000       FROM DATE.                                                 04600000
046100                                                                  04610000
046200     ACCEPT SD-SYSTEM-TIME                                        04620000
046300       FROM TIME.                                                 04630000
046400                                                                  04640000
046500     MOVE SD-SYSTEM-DATE-MM  TO DP132O-RUN-MONTH.                 04650000
046600     MOVE SD-SYSTEM-DATE-DD  TO DP132O-RUN-DAY.                   04660000
046700     MOVE SD-SYSTEM-DATE-YY  TO DP132O-RUN-YEAR.                  04670000
046800     MOVE SD-SYSTEM-TIME-HH  TO DP132O-RUN-HOUR.                  04680000
046900     MOVE SD-SYSTEM-TIME-MM  TO DP132O-RUN-MINUTE.                04690000
047000                                                                  04700000
047100     MOVE PC-SUKRP069             TO DP132O-PROGRAM-NAME.         04710000
047200     MOVE PC-REPORT-NBR           TO DP132O-REPORT-NUMBER.        04720000
047300     MOVE +0                      TO PV-PAGE-COUNT.               04730000
047400                                                                  04740000
048300******************************************************************04830000
048400**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  04840000
048500**  PAGES (AS NEEDED).                                            04850000
048600******************************************************************04860000
048700 1500-PRINT-HEADINGS.                                             04870000
048800     ADD +1                  TO PV-PAGE-COUNT.                    04880000
048900     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               04890000
049000                                                                  04900000
049100     WRITE REPORT-RECORD                                          04910000
049200       FROM DP132O-STANDRD-HEADER-132-COLS                        04920000
049300         AFTER ADVANCING PAGE.                                    04930000
049400                                                                  04940000
049500     WRITE REPORT-RECORD                                          04950000
049600       FROM HEADING-LINE1                                         04960000
049700         AFTER ADVANCING 1 LINES.                                 04970000
049800                                                                  04980000
049900     WRITE REPORT-RECORD                                          04990000
050000       FROM HEADING-LINE2                                         05000000
050100         AFTER ADVANCING 1 LINE.                                  05010000
050200                                                                  05020000
050300     WRITE REPORT-RECORD                                          05030000
050400       FROM HEADING-LINE3                                         05040000
050500         AFTER ADVANCING 2 LINES.                                 05050000
050600                                                                  05060000
050700     WRITE REPORT-RECORD                                          05070000
050800       FROM HEADING-LINE4                                         05080000
050900         AFTER ADVANCING 1 LINES.                                 05090000
051000                                                                  05100000
051100     WRITE REPORT-RECORD                                          05110000
051200       FROM HEADING-LINE5                                         05120000
051300         AFTER ADVANCING 1 LINES.                                 05130000
051400                                                                  05140000
051500     WRITE REPORT-RECORD                                          05150000
051600       FROM BLANK-LINE                                            05160000
051700         AFTER ADVANCING 1 LINE.                                  05170000
051800                                                                  05180000
051900     MOVE +08                TO PV-LINE-COUNT.                    05190000
052000                                                                  05200000
052100******************************************************************05210000
052200**  READ INPUT-FILE, WHEN DC CHANGES, DO A PAGE BREAK             05220000
052300******************************************************************05230000
052400 2000-PROCESS-INPUT.                                              05240000
052500     IF  SU116-OPER-UNT-ID          = PV-SAVE-OPER-UNT-ID         05250001
052600         CONTINUE                                                 05260001
052700     ELSE                                                         05270000
053400         MOVE SU116-OPER-UNT-ID    TO PV-SAVE-OPER-UNT-ID         05340001
053500         PERFORM 8500-GET-LOCATION-NAME                           05350000
053600         PERFORM 1500-PRINT-HEADINGS                              05360001
053700     END-IF.                                                      05370000
053800                                                                  05380000
053801     PERFORM 5000-MOVE-TO-DETAIL-LINE.                            05380101
053820                                                                  05382001
053900     PERFORM 7000-READ-EXTRACT-FILE.                              05390000
054000                                                                  05400000
075500                                                                  07550000
075600****************************************************************  07560000
075700* MOVE THE DETAILS TO REPORT LINE.                             *  07570000
075800****************************************************************  07580000
075900 5000-MOVE-TO-DETAIL-LINE.                                        07590000
076008                                                                  07600800
076010     MOVE SU116-OPER-UNT-ID    TO DL1-DC-NBR.                     07601001
076020     MOVE SU116-STORE-DEST     TO DL1-STORE.                      07602001
076030     MOVE SU116-DOOR-ID        TO DL1-DOOR.                       07603001
076040     MOVE SU116-STORE-NAME     TO DL1-STORE-NAME.                 07604001
076091     MOVE SU116-TOTAL-CARTONS  TO DL1-TOTAL-CARTONS.              07609101
076092     MOVE SU116-DIVERT-CARTONS TO DL1-DIVERTED.                   07609201
076093     MOVE SU116-SCANON-CARTONS TO DL1-SCANNED.                    07609301
076095     MOVE SU116-SCAC           TO DL1-SCAC.                       07609501
076096     MOVE SU116-TRLR-ID        TO DL1-TRLR-ID.                    07609601
076097     MOVE SU116-TRLR-SRL       TO DL1-TRLR-SERIAL.                07609701
076098     MOVE SU116-TRIP-ID        TO DL1-OTBND-TRIP.                 07609801
076100     MOVE SU116-STATUS-DATE    TO DL1-DATE.                       07610001
076101     MOVE SU116-STATUS-TIME    TO DL1-TIME.                       07610101
076110                                                                  07611001
097100     WRITE REPORT-RECORD                                          09710000
097200       FROM DETAIL-LINE1                                          09720001
097300         AFTER ADVANCING 1 LINES.                                 09730001
097301                                                                  09730101
097310     ADD  1                  TO PV-LINE-COUNT.                    09731001
097320     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        09732001
097330         PERFORM 1500-PRINT-HEADINGS                              09733001
097340     END-IF.                                                      09734001
097400                                                                  09740000
097500****************************************************************  09750000
097600* PRINTS A BLANK LINE                                          *  09760000
097700****************************************************************  09770000
097800 6000-PRINT-BLANK-LINE.                                           09780000
097900                                                                  09790000
098000        WRITE REPORT-RECORD                                       09800000
098100          FROM BLANK-LINE                                         09810000
098200            AFTER ADVANCING 1 LINE                                09820000
098300                                                                  09830000
098400     ADD +1 TO PV-LINE-COUNT.                                     09840000
098500                                                                  09850000
098600******************************************************************09860000
098700*  READ A RECORD FROM THE MANIFESTED NOT LOADED FILE             *09870000
098800******************************************************************09880000
098900 7000-READ-EXTRACT-FILE.                                          09890000
099000     READ INPUT-FILE                                              09900001
099010          INTO SU116-EXTRACT-RECORD                               09901001
099100         AT END                                                   09910000
099200             SET PS-END-OF-INPUT TO TRUE                          09920001
099300         NOT AT END                                               09930000
099400             ADD +1 TO PV-READ-COUNT                              09940001
099500     END-READ.                                                    09950000
099600                                                                  09960000
102100******************************************************************10210000
102200 8500-GET-LOCATION-NAME.                                          10220000
102300******************************************************************10230000
102400                                                                  10240000
102600     MOVE PV-SAVE-OPER-UNT-ID  TO  XLT00010-LOC-NBR               10260000
102700                                   PV-DISPLAY-OPER.               10270000
102800                                                                  10280000
102900     EXEC SQL                                                     10290000
103000         SELECT   LOC_NM                                          10300005
103100           INTO  :XLT00010-LOC-NM                                 10310005
103200           FROM   XLT_LOC                                         10320000
103300          WHERE   LOC_NBR  =  :XLT00010-LOC-NBR                   10330000
103400     END-EXEC.                                                    10340000
103500                                                                  10350000
103600     EVALUATE TRUE                                                10360000
103700         WHEN SQLCODE = +0                                        10370000
103710              MOVE PV-SAVE-OPER-UNT-ID TO HD2-OPER-UNT-ID         10371005
103730              MOVE XLT00010-LOC-NM     TO HD2-DC-NAME             10373005
104200         WHEN OTHER                                               10420000
104300              CONTINUE                                            10430000
104400     END-EVALUATE.                                                10440000
104500                                                                  10450000
104600******************************************************************10460000
104700*  ABEND ROUTINE                                                 *10470000
104800******************************************************************10480000
104900 9900-DB2-ABEND.                                                  10490000
105000                                                                  10500000
105100     MOVE SQLCODE TO PV-SQLCODE.                                  10510000
105200     DISPLAY '*** DB2 ERROR '.                                    10520000
105300     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       10530000
105400     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 10540000
105500     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               10550000
105600     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               10560000
105700     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       10570000
105800     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       10580000
105900     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME-1.              10590000
106000     DISPLAY '*** TABLE 2   = ' PV-DB2-TABLE-NAME-2.              10600000
106100                                                                  10610000
106200     COPY DPPD004.                                                10620000
106300                                                                  10630000
106400     MOVE +4013 TO PV-ABEND-CODE.                                 10640000
106500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10650000
106600                                                                  10660000
106700 9999-ABEND.                                                      10670000
106800                                                                  10680000
106900     DISPLAY '***************'.                                   10690000
107000     DISPLAY '** ABEND     **'.                                   10700000
107100     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               10710000
107200     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             10720000
107300     DISPLAY '***************'.                                   10730000
107400                                                                  10740000
107500     MOVE +4008                  TO PV-ABEND-CODE.                10750000
107600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10760000
107700                                                                  10770000
107800******************************************************************10780000
107900*                 E N D   O F   P R O G R A M                    *10790000
108000******************************************************************10800000
