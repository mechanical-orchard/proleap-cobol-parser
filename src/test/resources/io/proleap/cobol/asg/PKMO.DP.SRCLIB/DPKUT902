000100 IDENTIFICATION DIVISION.                                         01/27/94
000200 TITLE 'RANDOM NUMBER GENERATOR FOR DB2'.                                 
000300 PROGRAM-ID.    DPKUT902.                                         DPKUT001
000400 AUTHOR.        DENNIS STEFFEN, OMNI RESOURCES.                      LV003
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          DPKUT001
000600 DATE-WRITTEN.  JANUARY 1997.                                     DPKUT001
000700 DATE-COMPILED.                                                   DPKUT001
000800******************************************************************DPKUT001
000900*  THIS PROGRAM WILL GENERATE A RANDOM NUMBER FROM A DB2          DPKUT001
001000*  TIMESTAMP.                                                     DPKUT001
001100*                                                                    CL**3
001200*                                                                    CL**3
001300*  SAMPLE OF THE CODE NEEDED IN A ONLINE PROGRAM                     CL**3
001400*                                                                    CL**3
001500*    INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                        CL**3
001600*                                                                    CL**3
001700*    CALL PC-RAND-PGM USING DP902-RANDNBR-ROUTINE-FIELDS.            CL**3
001800*                                                                    CL**3
001900******************************************************************   CL**3
002000 ENVIRONMENT DIVISION.                                            DPKUT001
002100 CONFIGURATION SECTION.                                           DPKUT001
002200 SOURCE-COMPUTER. IBM-3090.                                       DPKUT001
002300 OBJECT-COMPUTER. IBM-3090.                                       DPKUT001
002400                                                                  DPKUT001
002500 DATA DIVISION.                                                   DPKUT001
002600 WORKING-STORAGE SECTION.                                         DPKUT001
002700 01  PROGRAM-CONSTANTS.                                                   
002800     05  PC-DPKUT500             PIC  X(08)  VALUE 'DPKUT500'.            
002900                                                                          
003000 01  PROGRAM-VARIABLES.                                                   
003100     05  PV-CURRENT-TIMESTAMP    PIC X(26).                               
003200     05  PV-DB2-TIMESTAMP.                                                
003300         10  PV-DB2-DATE.                                                 
003400             15  PV-TMST-CC      PIC XX.                                  
003500             15  PV-TMST-YY      PIC XX.                                  
003600             15  FILLER          PIC X        VALUE '-'.                  
003700             15  PV-TMST-MM      PIC XX.                                  
003800             15  FILLER          PIC X        VALUE '-'.                  
003900             15  PV-TMST-DD      PIC XX.                                  
004000         10  FILLER              PIC X        VALUE '-'.                  
004100         10  PV-DB2-TIME.                                                 
004200             15  PV-TMST-HH      PIC XX.                                  
004300             15  FILLER          PIC X        VALUE '.'.                  
004400             15  PV-TMST-MI-1    PIC X.                                   
004400             15  PV-TMST-MI-2    PIC X.                                   
004500             15  FILLER          PIC X        VALUE '.'.                  
004600             15  PV-TMST-SS      PIC XX.                                  
004700             15  FILLER            PIC X      VALUE '.'.                  
004800             15  PV-TMST-NNNNNN.                                          
004900                 20  PV-NANOSEC-1-3  PIC X(3).                            
005000                 20  PV-NANOSEC-4-6  PIC X(3).                            
005100     05  PV-JULIAN-YYDDD         PIC  9(5)  VALUE ZEROS.                  
005200     05  FILLER REDEFINES PV-JULIAN-YYDDD.                                
005300         10  FILLER              PIC X(01).                               
005400         10  PV-JULIAN-Y         PIC X(01).                               
005500         10  PV-JULIAN-DDD       PIC X(03).                               
005600 01  WS-RANDOM-KEY               PIC 9(9).                                
005700 01  FILLER REDEFINES WS-RANDOM-KEY.                                      
005800     05  WS-RND-1-3              PIC X(3).                                
005900     05  WS-RND-4-6              PIC X(3).                                
006000     05  WS-RND-7-8              PIC X(2).                                
006000     05  WS-RND-9                PIC X(1).                                
006100     COPY DPWS500.                                                        
006200/                                                                 DPKUT001
006300     EXEC SQL                                                             
006400          INCLUDE SQLCA                                                   
006500     END-EXEC.                                                            
006600                                                                          
006700                                                                  DPKUT001
006800 LINKAGE SECTION.                                                 DPKUT001
006900 01  DFHCOMMAREA.                                                         
007000     05  FILLER                 PIC X(200).                               
007100     COPY DPWS902.                                                   CL**3
007200/                                                                 DPKUT001
007300                                                                          
007400 PROCEDURE DIVISION USING DP902-RANDNBR-ROUTINE-FIELDS.           DPKUT001
007500                                                                  DPKUT001
007600 0000-PROGRAM-MAINLINE.                                           DPKUT001
007700                                                                  DPKUT001
007800     SET DP902-SUCCESSFUL        TO TRUE                          DPWS065 
007900                                                                  DPKUT001
008000     EXEC SQL                                                     DPKUT001
008100                                                                  DPKUT001
008200         SET :PV-CURRENT-TIMESTAMP   = CURRENT TIMESTAMP          DPWS065 
008300                                                                  DPKUT001
008400     END-EXEC.                                                    DPKUT001
008500                                                                          
008600     IF SQLCODE = ZERO                                                    
008700         MOVE PV-CURRENT-TIMESTAMP    TO PV-DB2-TIMESTAMP                 
008710         MOVE PV-NANOSEC-4-6          TO WS-RND-1-3                       
008710         MOVE PV-NANOSEC-1-3          TO WS-RND-4-6                       
004600         MOVE PV-TMST-SS              TO WS-RND-7-8                       
004400         MOVE PV-TMST-MI-2            TO WS-RND-9                         
008711                                                                          
008795         MOVE WS-RANDOM-KEY           TO DP902-RANDOM-NUMBER              
008796     ELSE                                                                 
008797         SET DP902-FAILED             TO TRUE                             
008798     END-IF.                                                              
010500                                                                  DPKUT001
010600     GOBACK.                                                      DPKUT001
