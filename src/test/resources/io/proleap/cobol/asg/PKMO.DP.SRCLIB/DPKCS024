000100******************************************************************06/20/94
000200 IDENTIFICATION DIVISION.                                         DPKCS024
000300******************************************************************   LV001
000400 PROGRAM-ID.                DPKCS024.                             DPKCS024
000500 AUTHOR.                    DWYNE WALLACE.                        DPKCS024
000600 INSTALLATION.              KOHLS DEPARTMENT STORES.              DPKCS024
000700 DATE-WRITTEN.              NOVEMBER 1990.                        DPKCS024
000800 DATE-COMPILED.                                                   DPKCS024
000900 SKIP2                                                            DPKCS024
001000******************************************************************DPKCS024
001100*  CICS PROGRAM - DPKCS024                                       *DPKCS024
001200*  TRANSACTION ID. - Z024                                        *DPKCS024
001300*                                                                *DPKCS024
001400*                DELETE MENU ITEM PROGRAM                        *DPKCS024
001500*                                                                *DPKCS024
001600*  THIS TRANSACTION PROCESSES ALL DELETE REQUESTS FOR THE TMENU- *DPKCS024
001700*  ITEM DB2 DATABASE. THIS DATABASE IS USED TO CONTROL NAVI-     *DPKCS024
001800*  GATION WITHIN CICS.                                           *DPKCS024
001900*                                                                *DPKCS024
002000*  PF KEY PROCESSING:                                            *DPKCS024
002100*                                                                *DPKCS024
002200*         ENTER - EDIT SCREEN                                    *DPKCS024
002300*         PA2   - TOGGLE FUNCTION KEY LINES                      *DPKCS024
002400*         PF5   - REFRESH LIST FROM DATABASE                     *DPKCS024
002500*         PF16  - DELETE FROM DATABASE                           *DPKCS024
002600*         CLEAR - RESET SCREEN TO LAST DISPLAY                   *DPKCS024
002700*                                                                *DPKCS024
002800*  NAVIGATION PF KEY PROCESSING:                                 *DPKCS024
002900*                                                                *DPKCS024
003000*         *SEE MNEMONIC FILE FOR NAVIGATION PF KEY DEFINITIONS.  *DPKCS024
003100*                                                                *DPKCS024
003200*  CHANGED 4/92 BY M. FURLICK PER W/R 1937                       *DPKCS024
003300*         ADDED PROGRAM ID TO SCREEN.                            *DPKCS024
003400*                                                                *DPKCS024
003401*    03/21/96  TKMA235  ADD LOGIC FOR CICS24X7 PROCESSING.       *        
003402*                       1) MODIFIED THIS PROGRAM TO UPDATE THE   *        
003403*                          DB2 TMNEMONIC TABLE'S UPD-VSAM-IND.   *        
003405*                          * THIS COLUMN WILL BE UPDATED FOR:    *        
003406*                            THE MENU ROW (NOT THE MENUITEM ROW).*        
003407*                          * THIS COLUMN WILL BE UPDATED WHEN:   *        
003408*                            A MENUITEM IS DELETED ON THIS MENU. *        
003409*                          SEE PARA: X980-UPDT-TMNEMONIC-ROW.    *        
003410*                                                                *      09
003500******************************************************************DPKCS024
003600                                                                  DPKCS024
003700******************************************************************DPKCS024
003800 ENVIRONMENT DIVISION.                                            DPKCS024
003900******************************************************************DPKCS024
004000 EJECT                                                            DPKCS024
004100******************************************************************DPKCS024
004200 DATA DIVISION.                                                   DPKCS024
004300******************************************************************DPKCS024
004400                                                                  DPKCS024
004500 WORKING-STORAGE SECTION.                                         DPKCS024
004600                                                                  DPKCS024
004700*********************                                             DPKCS024
004800* PROGRAM CONSTANTS *                                             DPKCS024
004900*********************                                             DPKCS024
005000                                                                  DPKCS024
005100 01  PROGRAM-CONSTANT-AREA.                                       DPKCS024
005200     05  PC-MAXIMUM-COMMAREA-LENGTH                               DPKCS024
005300                                 PIC S9(4)      VALUE +4072       DPKCS024
005400                                                COMP SYNC.        DPKCS024
005500     05  PC-CURRENT-MAP-NAME     PIC X(8)       VALUE 'DP024A  '. DPKCS024
005600     05  PC-CURRENT-MAPSET-NAME  PIC X(8)       VALUE 'DPKM024 '. DPKCS024
005700     05  PC-CURRENT-PROGRAM-NAME PIC X(8)       VALUE 'DPKCS024'. DPKCS024
005800     05  PC-NAVIGATOR-TRAN-ID    PIC X(4)       VALUE 'Z008'.     DPKCS024
005900     05  PC-MENU-TRAN-ID         PIC X(4)       VALUE 'Z007'.     DPKCS024
006000     05  PC-LEAVE-SYSTEM-LENGTH  PIC S9(4)      VALUE +80         DPKCS024
006100                                                COMP SYNC.        DPKCS024
006200     05  PC-HEX-VALUE-80         PIC X          VALUE 'ø'.        DPKCS024
006300     05  PC-FORMAT-CODE          PIC X(4)       VALUE 'MITM'.     DPKCS024
006400     05  PC-ACKNWLDGE-CODE       PIC X(4)       VALUE 'MITM'.     DPKCS024
006410     05  PC-Y                    PIC X(1)       VALUE 'Y'.              24
006500     05  PC-TSYMSG-00057         PIC 9(5)       VALUE 00057.      DPKCS024
006600     05  PC-TSYMSG-00115         PIC 9(5)       VALUE 00115.      DPKCS024
006700     05  PC-TSYMSG-00148         PIC 9(5)       VALUE 00148.      DPKCS024
006800     05  PC-TSYMSG-00266         PIC 9(5)       VALUE 00266.      DPKCS024
006900                                                                  DPKCS024
007000*********************                                             DPKCS024
007100* PROGRAM VARIABLES *                                             DPKCS024
007200*********************                                             DPKCS024
007300                                                                  DPKCS024
007400 01  PROGRAM-VARIABLE-AREA.                                       DPKCS024
007500     05  PV-CICS-RESPONSE        PIC S9(8)      VALUE ZERO        DPKCS024
007600                                                COMP SYNC.        DPKCS024
007700     05  PV-TERMINAL             PIC X(4)       VALUE SPACES.     DPKCS024
007800     05  PV-LEAVE-SYSTEM-MSG     PIC X(80)      VALUE SPACES.     DPKCS024
007900     05  PV-HOLD-MESSAGE         PIC X(78)      VALUE SPACES.     DPKCS024
008000     05  PV-HOLD-SEVERITY-IND    PIC X(1)       VALUE SPACES.     DPKCS024
008100     05  PV-MNEMONIC             PIC X(8)       VALUE SPACES.     DPKCS024
008200     05  PV-DESC-NULL-IND        PIC S9(4)      VALUE ZERO        DPKCS024
008300                                                COMP.             DPKCS024
008400         88  PV-DESC-NULL                       VALUE -1.         DPKCS024
008500     05  PV-SEQUENCE-NUMBER-ALPHA                                 DPKCS024
008600                                 PIC X(4)       VALUE SPACES.     DPKCS024
008700     05  PV-SEQUENCE-NUMBER-NUMERIC                               DPKCS024
008800                                 REDEFINES                        DPKCS024
008900         PV-SEQUENCE-NUMBER-ALPHA                                 DPKCS024
009000                                 PIC 9(4).                        DPKCS024
009100     05  PV-FORMAT-CODES         PIC X(4)       VALUE SPACES.     DPKCS024
009200         88  PV-ACCEPTED-FORMAT-CODE            VALUE 'CMIA'      DPKCS024
009300                                                      'FKEY'      DPKCS024
009400                                                      'MITM'.     DPKCS024
009401     05  PV-DISPLAY-INFO.                                               12
009402         10  PV-DISP-MENU-NAME   PIC X(8).                              12
009403         10  FILLER              PIC X(2)       VALUE ', '.             12
009410         10  PV-DISP-ITEM        PIC X(8).                              12
009500 EJECT                                                            DPKCS024
009600********************                                              DPKCS024
009700* PROGRAM SWITCHES *                                              DPKCS024
009800********************                                              DPKCS024
009900                                                                  DPKCS024
010000 01  PROGRAM-SWITCHES.                                            DPKCS024
010100     05  PS-MAP-SEND-TYPE        PIC X          VALUE '1'.        DPKCS024
010200         88  PS-SEND-MAP-N-DATA-FRSET           VALUE '1'.        DPKCS024
010300         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN     VALUE '2'.        DPKCS024
010400         88  PS-SEND-DATA-ONLY-FRSET            VALUE '3'.        DPKCS024
010500         88  PS-SEND-DATA-ONLY                  VALUE '4'.        DPKCS024
010600         88  PS-SEND-DATA-ONLY-ERASEAUP         VALUE '5'.        DPKCS024
010700         88  PS-SEND-MAP-ONLY-FRSET             VALUE '6'.        DPKCS024
010800     05  PS-LOCAL-FUNCTION-KEY-IND                                DPKCS024
010900                                 PIC X          VALUE 'N'.        DPKCS024
011000         88  PS-LOCAL-FUNCTION-NO               VALUE 'N'.        DPKCS024
011100         88  PS-LOCAL-FUNCTION-YES              VALUE 'Y'.        DPKCS024
011200     05  PS-ROW-FOUND-IND        PIC X          VALUE 'N'.        DPKCS024
011300         88  PS-ROW-FOUND-NO                    VALUE 'N'.        DPKCS024
011400         88  PS-ROW-FOUND-YES                   VALUE 'Y'.        DPKCS024
011500     05  PS-EDIT-ERROR-SW        PIC X          VALUE 'N'.        DPKCS024
011600         88  PS-EDIT-ERROR-NO                   VALUE 'N'.        DPKCS024
011700         88  PS-EDIT-ERROR-YES                  VALUE 'Y'.        DPKCS024
011800     05  PS-NEW-MNEMONIC-ENTERED-IND                              DPKCS024
011900                                 PIC X          VALUE 'N'.        DPKCS024
012000         88  PS-NEW-MNEMONIC-ENTERED-NO         VALUE 'N'.        DPKCS024
012100         88  PS-NEW-MNEMONIC-ENTERED-YES        VALUE 'Y'.        DPKCS024
012200 EJECT                                                            DPKCS024
012300******************                                                DPKCS024
012400* ERROR MESSAGES *                                                DPKCS024
012500******************                                                DPKCS024
012600                                                                  DPKCS024
012700 01  ERROR-MESSAGES.                                              DPKCS024
012800     05  INVALID-NEXT-APPL-MSG   PIC X(78)      VALUE             DPKCS024
012900         'NEXT APPLICATION CODE INVALID                           DPKCS024
013000-        '                      '.                                DPKCS024
013100 EJECT                                                            DPKCS024
013200**************************                                        DPKCS024
013300* DB2 COMMUNICATION AREA *                                        DPKCS024
013400**************************                                        DPKCS024
013500                                                                  DPKCS024
013600     EXEC SQL                                                     DPKCS024
013700         INCLUDE SQLCA                                            DPKCS024
013800     END-EXEC.                                                    DPKCS024
013900                                                                  DPKCS024
014000***********************************                               DPKCS024
014100* DB2 SQL RETURN CODE DEFINITIONS *                               DPKCS024
014200*    USING '88' LEVEL             *                               DPKCS024
014300***********************************                               DPKCS024
014400                                                                  DPKCS024
014500 01  SQL-RETURN-CODE             PIC S9(9)      COMP-4.           DPKCS024
014600     88  SQL-SUCCESSFUL                         VALUE +0.         DPKCS024
014700     88  SQL-ROW-FOUND                          VALUE +0.         DPKCS024
014800     88  SQL-ROW-NOT-FOUND                      VALUE +100.       DPKCS024
014900     88  SQL-WARNING                            VALUE +100        DPKCS024
015000                                                      +558        DPKCS024
015100                                                      +560.       DPKCS024
015200     88  SQL-DUPLICATE-ROW                      VALUE -803.       DPKCS024
015300     88  SQL-MORE-THAN-1-ROW                    VALUE -811.       DPKCS024
015400     88  SQL-NOT-AVAILABLE                      VALUE -911.       DPKCS024
015500     88  SQL-DB2-DOWN                           VALUE -923.       DPKCS024
015600     88  SQL-NULL-VALUE                         VALUE -305.       DPKCS024
015700     88  SQL-DEPENDENT-ROW                      VALUE -532.       DPKCS024
015800 EJECT                                                            DPKCS024
015900**************************************                            DPKCS024
016000* STANDARD ATTENTION IDENTIFIER LIST *                            DPKCS024
016100**************************************                            DPKCS024
016200                                                                  DPKCS024
016300     COPY DFHAID.                                                 DPKCS024
016400 EJECT                                                            DPKCS024
016500**************************************************************    DPKCS024
016600* WORKING-STORAGE LAYOUT USED FOR STANDARD ERROR MESSAGES.   *    DPKCS024
016700**************************************************************    DPKCS024
016800     COPY DPRD507I.                                               DPKCS024
016900 EJECT                                                            DPKCS024
017000*----------------------------------------------------------------*DPKCS024
017100*    WORKING STORAGE INCLUDE MEMBER USED WITH INCLUDE DPPD005    *DPKCS024
017200*----------------------------------------------------------------*DPKCS024
017300     COPY DPWS006.                                                DPKCS024
017400 EJECT                                                            DPKCS024
017500**************************************************************    DPKCS024
017600* WORKING-STORAGE LAYOUT USED TO LOAD THE FUNCTION KEY LINES *    DPKCS024
017700**************************************************************    DPKCS024
017800     COPY DPWS009.                                                DPKCS024
017900 EJECT                                                            DPKCS024
018000***************************                                       DPKCS024
018100* COMMON ABEND DATA AREAS *                                       DPKCS024
018200***************************                                       DPKCS024
018300                                                                  DPKCS024
018400     COPY DPWS013.                                                DPKCS024
018500 EJECT                                                            DPKCS024
018600*********************************************************         DPKCS024
018700* KOHL'S DEFINED:                                       *         DPKCS024
018800* STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST *         DPKCS024
018900*********************************************************         DPKCS024
019000                                                                  DPKCS024
019100     COPY DPWS015.                                                DPKCS024
019200 EJECT                                                            DPKCS024
019300**************************************                            DPKCS024
019400* KOHL'S:                            *                            DPKCS024
019500* STANDARD ATTENTION IDENTIFIER LIST *                            DPKCS024
019600**************************************                            DPKCS024
019700                                                                  DPKCS024
019800     COPY DPWS016.                                                DPKCS024
019900 EJECT                                                            DPKCS024
020000***************************************************************   DPKCS024
020100* WORKING-STORAGE LAYOUT USED TO GET THE SYSTEM DATE AND TIME *   DPKCS024
020200***************************************************************   DPKCS024
020300     COPY DPWS017.                                                DPKCS024
020400 EJECT                                                            DPKCS024
020500*******************************                                   DPKCS024
020600* STANDARD COMMUNICATION AREA *                                   DPKCS024
020700*******************************                                   DPKCS024
020800                                                                  DPKCS024
020900     COPY DPWS020.                                                DPKCS024
021000     05  FILLER                  REDEFINES                        DPKCS024
021100         DP020-VARIABLE-COMMAREA.                                 DPKCS024
021200***************************************                           DPKCS024
021300* CICSARC INTER APPLICATION DATA AREA *                           DPKCS024
021400***************************************                           DPKCS024
021500         10  INTER-APPL-COMM-AREA                                 DPKCS024
021600                                 PIC X(200).                      DPKCS024
021700     COPY DPWS050.                                                DPKCS024
021800     COPY DPWS051.                                                DPKCS024
021900     COPY DPWS052.                                                DPKCS024
022000     COPY DPWS055.                                                DPKCS024
022100**********************************                                DPKCS024
022200* APPLICATION SPECIFIC COMM AREA *                                DPKCS024
022300**********************************                                DPKCS024
022400         10  APPL-SPECIFIC-COMM-AREA                              DPKCS024
022500                                 PIC X(2865).                     DPKCS024
022600         10  DP024-APPL-SPECIFIC-COMM-AREA                        DPKCS024
022700                                 REDEFINES                        DPKCS024
022800             APPL-SPECIFIC-COMM-AREA.                             DPKCS024
022900             15  FILLER          PIC X(02).                       DPKCS024
023000             15  DP024-CURRENT-SCREEN-IMAGE.                      DPKCS024
023100                 20  DP024-SCREEN-TRAN-ID                         DPKCS024
023200                                 PIC X(04).                       DPKCS024
023300                 20  DP024-SCREEN-MNEMONIC                        DPKCS024
023400                                 PIC X(08).                       DPKCS024
023500                 20  DP024-SCREEN-SEQUENCE-NUMBER                 DPKCS024
023600                                 PIC X(04).                       DPKCS024
023700                 20  DP024-SCREEN-MENU-TITLE                      DPKCS024
023800                                 PIC X(30).                       DPKCS024
023900                 20  DP024-SCREEN-MENU-NAME                       DPKCS024
024000                                 PIC X(08).                       DPKCS024
024100                 20  DP024-SCREEN-FORMAT                          DPKCS024
024200                                 PIC X(01).                       DPKCS024
024300                 20  DP024-SCREEN-PANEL-TITLE-NAME                DPKCS024
024400                                 PIC X(30).                       DPKCS024
024500                 20  DP024-SCREEN-MENU-ITEM-TITLE                 DPKCS024
024600                                 PIC X(30).                       DPKCS024
024700             15  DP024-TRAN-DEFINED-CICS                          DPKCS024
024800                                 PIC X.                           DPKCS024
024900             15  DP024-MENU-TRAN-SW                               DPKCS024
025000                                 PIC X.                           DPKCS024
025100                 88  DP024-A-NON-MENU-TRAN          VALUE 'N'.    DPKCS024
025200                 88  DP024-A-MENU-TRAN              VALUE 'Y'.    DPKCS024
025300             15  DP024-SELECT-MAINT-RESULT                        DPKCS024
025400                                 PIC X.                           DPKCS024
025500                 88  DP024-RESULT-IS-CREATE      VALUE '1'.       DPKCS024
025600                 88  DP024-RESULT-IS-UPDATE      VALUE '2'.       DPKCS024
025700                 88  DP024-RESULT-IS-DELETE      VALUE '3'.       DPKCS024
025800                 88  DP024-RESULT-IS-READ        VALUE '4'.       DPKCS024
025900                 88  DP024-RESULT-IS-ERROR       VALUE '5'.       DPKCS024
026000             15  DP024-INTER-APPL-COMMAREA       PIC X(200).      DPKCS024
026100             15  FILLER  REDEFINES  DP024-INTER-APPL-COMMAREA.    DPKCS024
026200                 20  DP024-INTER-APPL-FORMAT-CODE                 DPKCS024
026300                                 PIC X(04).                       DPKCS024
026400                 20  DP024-INTER-APPL-ACKNLG-CODE                 DPKCS024
026500                                 PIC X(04).                       DPKCS024
026600                 20  DP024-MITM-AREA.                             DPKCS024
026700                     25  DP024-MITM-MENU-NAME                     DPKCS024
026800                                 PIC X(08).                       DPKCS024
026900                     25  DP024-MITM-ITEM-MNEMONIC                 DPKCS024
027000                                 PIC X(08).                       DPKCS024
027100                     25  DP024-MITM-SEQUENCE-NUMBER               DPKCS024
027200                                 PIC S9(4)      COMP.             DPKCS024
027300                     25  DP024-MITM-TRAN-ID                       DPKCS024
027400                                 PIC X(04).                       DPKCS024
027500                     25  DP024-MITM-TITLE                         DPKCS024
027600                                 PIC X(30).                       DPKCS024
027700                     25  DP024-MITM-ITEM-TITLE                    DPKCS024
027800                                 PIC X(30).                       DPKCS024
027900                     25  DP024-MITM-MAINTENANCE-RESULT            DPKCS024
028000                                 PIC X.                           DPKCS024
028100                         88  DP024-MITM-RESULT-IS-CREATE          DPKCS024
028200                                 VALUE '1'.                       DPKCS024
028300                         88  DP024-MITM-RESULT-IS-UPDATE          DPKCS024
028400                                 VALUE '2'.                       DPKCS024
028500                         88  DP024-MITM-RESULT-IS-DELETE          DPKCS024
028600                                 VALUE '3'.                       DPKCS024
028700                         88  DP024-MITM-RESULT-IS-READ            DPKCS024
028800                                 VALUE '4'.                       DPKCS024
028900                         88  DP024-MITM-RESULT-IS-ERROR           DPKCS024
029000                                 VALUE '5'.                       DPKCS024
029100                     25  FILLER  PIC X(109).                      DPKCS024
029200                 20  DP024-FKEY-AREA                              DPKCS024
029300                                 REDEFINES                        DPKCS024
029400                     DP024-MITM-AREA.                             DPKCS024
029500                     25  DP024-FKEY-MNEMONIC                      DPKCS024
029600                                 PIC X(08).                       DPKCS024
029700                     25  DP024-FKEY-FUNCTION-KEY                  DPKCS024
029800                                 PIC S9(04)     COMP.             DPKCS024
029900                     25  DP024-FKEY-FUNCT-KEY-MNEMONIC            DPKCS024
030000                                 PIC X(08).                       DPKCS024
030100                     25  DP024-FKEY-MAINTENANCE-RESULT            DPKCS024
030200                                 PIC X.                           DPKCS024
030300                         88  DP024-FKEY-RESULT-IS-CREATE          DPKCS024
030400                                 VALUE '1'.                       DPKCS024
030500                         88  DP024-FKEY-RESULT-IS-UPDATE          DPKCS024
030600                                 VALUE '2'.                       DPKCS024
030700                         88  DP024-FKEY-RESULT-IS-DELETE          DPKCS024
030800                                 VALUE '3'.                       DPKCS024
030900                         88  DP024-FKEY-RESULT-IS-READ            DPKCS024
031000                                 VALUE '4'.                       DPKCS024
031100                         88  DP024-FKEY-RESULT-IS-ERROR           DPKCS024
031200                                 VALUE '5'.                       DPKCS024
031300                     25  FILLER  PIC X(173).                      DPKCS024
031400                 20  DP024-CMIA-AREA                              DPKCS024
031500                                 REDEFINES                        DPKCS024
031600                     DP024-FKEY-AREA.                             DPKCS024
031700                     25  DP024-CMIA-MNEMONIC                      DPKCS024
031800                                 PIC X(08).                       DPKCS024
031900                     25  DP024-CMIA-TRAN-ID                       DPKCS024
032000                                 PIC X(04).                       DPKCS024
032100                     25  DP024-CMIA-TITLE                         DPKCS024
032200                                 PIC X(30).                       DPKCS024
032300                     25  DP024-CMIA-MAINTENANCE-RESULT            DPKCS024
032400                                 PIC X.                           DPKCS024
032500                         88  DP024-CMIA-RESULT-IS-CREATE          DPKCS024
032600                                 VALUE '1'.                       DPKCS024
032700                         88  DP024-CMIA-RESULT-IS-UPDATE          DPKCS024
032800                                 VALUE '2'.                       DPKCS024
032900                         88  DP024-CMIA-RESULT-IS-DELETE          DPKCS024
033000                                 VALUE '3'.                       DPKCS024
033100                         88  DP024-CMIA-RESULT-IS-READ            DPKCS024
033200                                 VALUE '4'.                       DPKCS024
033300                         88  DP024-CMIA-RESULT-IS-ERROR           DPKCS024
033400                                 VALUE '5'.                       DPKCS024
033500                     25  FILLER  PIC X(149).                      DPKCS024
033600             15  DP024-TIMESTAMP     PIC X(26).                   DPKCS024
033700 EJECT                                                            DPKCS024
033800**************************************************************    DPKCS024
033900* PARAMETER LIST USED TO CALL THE 'TRANSLATE AID' SUBROUTINE *    DPKCS024
034000**************************************************************    DPKCS024
034100     COPY DPWS045.                                                DPKCS024
034200  EJECT                                                           DPKCS024
034300********************************                                  DPKCS024
034400* DSECT FOR THE DPKM021 MAPSET *                                  DPKCS024
034500********************************                                  DPKCS024
034600                                                                  DPKCS024
034700     COPY DPKM024.                                                DPKCS024
034800                                                                  DPKCS024
034900************************************************                  DPKCS024
035000* REDEFINES OF DP024AI MAPSET OF DETAIL FIELDS *                  DPKCS024
035100************************************************                  DPKCS024
035200 01  MD-MAP-DATA-AREA            REDEFINES                        DPKCS024
035300     DP024AO                     PIC X(1000).                     DPKCS024
035400 EJECT                                                            DPKCS024
035500******************************                                    DPKCS024
035600* DCLGEN FOR TABLE TMENUITEM *                                    DPKCS024
035700******************************                                    DPKCS024
035800                                                                  DPKCS024
035900     EXEC SQL                                                     DPKCS024
036000         INCLUDE TMNUITM                                          DPKCS024
036100     END-EXEC.                                                    DPKCS024
036200 EJECT                                                            DPKCS024
036300******************************                                    DPKCS024
036400* DCLGEN FOR TABLE TMNEMONIC *                                    DPKCS024
036500******************************                                    DPKCS024
036600                                                                  DPKCS024
036700     EXEC SQL                                                     DPKCS024
036800         INCLUDE TMNMNC                                           DPKCS024
036900     END-EXEC.                                                    DPKCS024
037000 EJECT                                                            DPKCS024
037100 LINKAGE SECTION.                                                 DPKCS024
037200                                                                  DPKCS024
037300 01  DFHCOMMAREA.                                                 DPKCS024
037400     05  FILLER                         OCCURS  1 TO 4072 TIMES   DPKCS024
037500                                        DEPENDING ON EIBCALEN.    DPKCS024
037600         10  FILLER                     PIC X.                    DPKCS024
037700 EJECT                                                            DPKCS024
037800 PROCEDURE DIVISION.                                              DPKCS024
037900                                                                  DPKCS024
038000******************************************************************DPKCS024
038100* A000-DELETE-MENU-ITEM                                          *DPKCS024
038200* (Z024-00 DELETE MENU ITEM)                                     *DPKCS024
038300* MAINLINE SECTION.                                              *DPKCS024
038400******************************************************************DPKCS024
038500                                                                  DPKCS024
038600 A000-DELETE-MENU-ITEM.                                           DPKCS024
038700                                                                  DPKCS024
038800     PERFORM DP015-0000-CHECK-COMMAREA.                           DPKCS024
038900                                                                  DPKCS024
039000***************************************************************** DPKCS024
039100* THE VARIABLE 'RETURN-WITH-TRAN-ID' WILL BE SET TO 'Y' IN      * DPKCS024
039200* U13-CHECK-COMMAREA IF A BAD COMMAREA OR NO COMMAREA WAS       * DPKCS024
039300* ENCOUNTERED. IF THAT HAPPENS U13-CHECK-COMMAREA STARTS THE    * DPKCS024
039400* NAVIGATION TRANSACTION AND SETS THIS INDICATOR TO 'Y'. CHECK- * DPKCS024
039500* ING FOR A 'Y' HERE WILL PREVENT THIS TRANSACTION FROM CONTINU-* DPKCS024
039600* ING TO EXECUTE IF THE NAVIGATOR HAS BEEN REQUESTED TO START.  * DPKCS024
039700***************************************************************** DPKCS024
039800                                                                  DPKCS024
039900     IF  DP020-SRC-RETURN-W-TRAN-ID                               DPKCS024
040000         PERFORM A050-CONTROL-PROCESSING                          DPKCS024
040100     END-IF.                                                      DPKCS024
040200                                                                  DPKCS024
040300     PERFORM DP003-0000-RETURN-TO-CICS.                           DPKCS024
040400                                                                  DPKCS024
040500 EJECT                                                            DPKCS024
040600******************************************************************DPKCS024
040700* A050-CONTROL-PROCESSING                                        *DPKCS024
040800* (Z024-01 CONTROL PROCESSING)                                   *DPKCS024
040900******************************************************************DPKCS024
041000                                                                  DPKCS024
041100 A050-CONTROL-PROCESSING.                                         DPKCS024
041200                                                                  DPKCS024
041300     EVALUATE TRUE                                                DPKCS024
041400                                                                  DPKCS024
041500         WHEN DP020-NEXT-ACT-INITIAL                              DPKCS024
041600             MOVE INTER-APPL-COMM-AREA                            DPKCS024
041700                                 TO DP024-INTER-APPL-COMMAREA     DPKCS024
041800             SET PS-SEND-MAP-N-DATA-FRSET                         DPKCS024
041900                                 TO TRUE                          DPKCS024
042000             PERFORM A200-PROCESS-INTER-APPL-COMM                 DPKCS024
042100             PERFORM A250-SEND-INITIAL-SCREEN                     DPKCS024
042200                                                                  DPKCS024
042300         WHEN DP020-NEXT-ACT-RETURN                               DPKCS024
042400             SET PS-SEND-MAP-N-DATA-FRSET                         DPKCS024
042500                                 TO TRUE                          DPKCS024
042600             MOVE -1             TO ANAVKEYL                      DPKCS024
042700             PERFORM A470-SET-COMMAND-ATTRIBUTES                  DPKCS024
042800             PERFORM A200-PROCESS-INTER-APPL-COMM                 DPKCS024
042900             PERFORM A450-EDIT-DELETE-OBJECTS                     DPKCS024
043000             PERFORM A550-DISPLAY-PANEL                           DPKCS024
043100         WHEN DP020-NEXT-ACT-ERROR                                DPKCS024
043200             SET PS-SEND-DATA-ONLY-FRSET                          DPKCS024
043300                                 TO TRUE                          DPKCS024
043400             PERFORM A470-SET-COMMAND-ATTRIBUTES                  DPKCS024
043500             PERFORM A450-EDIT-DELETE-OBJECTS                     DPKCS024
043600             MOVE PV-HOLD-MESSAGE                                 DPKCS024
043700                                 TO DP020-MSG-MESSAGE             DPKCS024
043800             MOVE PV-HOLD-SEVERITY-IND                            DPKCS024
043900                                 TO DP020-MSG-SEVERITY-IND        DPKCS024
044000             PERFORM A550-DISPLAY-PANEL                           DPKCS024
044100         WHEN DP020-NEXT-ACT-READ-MAP                             DPKCS024
044200             SET PS-SEND-DATA-ONLY-FRSET                          DPKCS024
044300                                 TO TRUE                          DPKCS024
044400             PERFORM A470-SET-COMMAND-ATTRIBUTES                  DPKCS024
044500             PERFORM A100-PROCESS-MAP                             DPKCS024
044600         WHEN OTHER                                               DPKCS024
044700             SET  DP013-OTHER-ABEND                               DPKCS024
044800                                 TO TRUE                          DPKCS024
044900             MOVE 'A050-CONTROL-PROCESSING       '                DPKCS024
045000                                 TO DP013-PARAGRAPH               DPKCS024
045100             MOVE INVALID-NEXT-APPL-MSG                           DPKCS024
045200                                 TO DP013-MESSAGE-TEXT (1)        DPKCS024
045300             MOVE DP020-NEXT-APPL-ACTIVITY                        DPKCS024
045400                                 TO DP013-MESSAGE-TEXT (2)        DPKCS024
045500             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS024
045600                                                                  DPKCS024
045700     END-EVALUATE.                                                DPKCS024
045800 EJECT                                                            DPKCS024
045900******************************************************************DPKCS024
046000* A100-PROCESS-MAP                                               *DPKCS024
046100* (Z024-03 PROCESS-MAP)                                          *DPKCS024
046200******************************************************************DPKCS024
046300                                                                  DPKCS024
046400 A100-PROCESS-MAP.                                                DPKCS024
046500                                                                  DPKCS024
046600     IF  EIBAID  =  DFHPA2                                        DPKCS024
046700***************************************                           DPKCS024
046800* PA2 KEY  -  CHANGE PFKEYS DISPLAYED *                           DPKCS024
046900***************************************                           DPKCS024
047000         MOVE DP016-PA2          TO DP020-SRC-AID                 DPKCS024
047100         SET PS-SEND-DATA-ONLY                                    DPKCS024
047200                                 TO TRUE                          DPKCS024
047300         MOVE -1                 TO ANAVKEYL                      DPKCS024
047400         PERFORM DP009-0000-LOAD-FK-LINES                         DPKCS024
047500         PERFORM DP018-0000-GET-CURR-TIME                         DPKCS024
047600         PERFORM DP008-0000-WRITE-PANEL                           DPKCS024
047700     ELSE                                                         DPKCS024
047800       IF  EIBAID  =  DFHCLEAR                                    DPKCS024
047900           MOVE DP016-CLEAR      TO DP020-SRC-AID                 DPKCS024
048000           SET PS-SEND-MAP-N-DATA-FRSET                           DPKCS024
048100                                 TO TRUE                          DPKCS024
048200           MOVE -1               TO ANAVKEYL                      DPKCS024
048300           PERFORM A450-EDIT-DELETE-OBJECTS                       DPKCS024
048400           PERFORM A550-DISPLAY-PANEL                             DPKCS024
048500       ELSE                                                       DPKCS024
048600           PERFORM DP007-0000-GET-PANEL                           DPKCS024
048700           IF  DP020-SRC-AID  NOT =  DP016-CLEAR                  DPKCS024
048800               PERFORM A650-MOVE-SCREEN-TO-COMM                   DPKCS024
048900           END-IF                                                 DPKCS024
049000           PERFORM A200-PROCESS-INTER-APPL-COMM                   DPKCS024
049100           PERFORM A300-CHECK-LOCAL-PF-KEYS                       DPKCS024
049200           IF  PS-LOCAL-FUNCTION-NO                               DPKCS024
049300               PERFORM DP015-1000-START-NAVIGATOR                 DPKCS024
049400           ELSE                                                   DPKCS024
049500               IF  ((DP020-SRC-AID  =  DP016-ENTER)    AND        DPKCS024
049600                    (DP020-NAV-MNEMONIC  NOT =  SPACES  AND       DPKCS024
049700                                                LOW-VALUES))      DPKCS024
049800                   PERFORM DP015-1000-START-NAVIGATOR             DPKCS024
049900               ELSE                                               DPKCS024
050000                 IF  PS-NEW-MNEMONIC-ENTERED-NO                   DPKCS024
050100***************************************************************** DPKCS024
050200* THIS SWITCH IS CHECKED TO PREVENT THE PROGRAM FROM EDITTING   * DPKCS024
050300* AND PROCESSING THE SCREEN AFTER A NEW SCREEN HAS BEEN SENT TO * DPKCS024
050400* THE TERMINAL. THIS SWITCH IS SET IN MODULE Z024-13 TO 'Y' IF  * DPKCS024
050500* THE USER HAS ENTERED A NEW ITEM IN THE NAVIGATOR KEY FIELD ON * DPKCS024
050600* THE SCREEN. OTHERWISE IT IS ALWAYS SET TO 'N'.                * DPKCS024
050700***************************************************************** DPKCS024
050800                     MOVE -1     TO ANAVKEYL                      DPKCS024
050900                     PERFORM A350-LOCAL-PF-KEY-CONTROL            DPKCS024
051000                 END-IF                                           DPKCS024
051100               END-IF                                             DPKCS024
051200           END-IF                                                 DPKCS024
051300       END-IF                                                     DPKCS024
051400     END-IF.                                                      DPKCS024
051500 EJECT                                                            DPKCS024
051600******************************************************************DPKCS024
051700* A200-PROCESS-INTER-APPL-COMM                                   *DPKCS024
051800* (Z024-05 PROCESS-INTER-APPL COMMAREA)                          *DPKCS024
051900* THE PURPOSE OF THIS MODULE IS TO MANIPULATE THE INTER-APPL-    *DPKCS024
052000* COMMAREA UNDER THE FOUR POSSIBLE CYCLES OF THIS TRANSACTION:   *DPKCS024
052100*                                                                *DPKCS024
052200*        1. DP020-NEXT-ACT-INITIAL                               *DPKCS024
052300*        2. DP020-NEXT-ACT-RETURN                                *DPKCS024
052400*        3. DP020-NEXT-ACT-READ-MAP                              *DPKCS024
052500*        4. DP020-NEXT-ACT-ERROR-RETURN                          *DPKCS024
052600*                                                                *DPKCS024
052700* THREE DATA AREAS ARE NEEDED TO CORRECTLY USE THE INTER-APPL-   *DPKCS024
052800* COMMAREA:                                                      *DPKCS024
052900*                                                                *DPKCS024
053000*        1. THE INTER-APPL-COMMAREA PORTION OF THE STANDARD-COMM-*DPKCS024
053100*           AREA                                                 *DPKCS024
053200*        2. AN AREA OF THE APPLICATION COMMAREA THAT WILL BE USED*DPKCS024
053300*           TO STORE THE CONTENTS OF THE INTER-APPL-COMMAREA SENT*DPKCS024
053400*           TO THIS PROGRAM. (NOTE: ONLY SAVE THOSE FIELDS       *DPKCS024
053500*           RELAVENT TO THIS PROGRAM).                           *DPKCS024
053600*        3. AN AREA OF THE APPLICATION COMMAREA THAT WILL BE USED*DPKCS024
053700*           TO HOLD THE DATA RELAVENT TO THE CURRENT OBJECT BEING*DPKCS024
053800*           PROCESSED BY THIS PROGRAM.                           *DPKCS024
053900******************************************************************DPKCS024
054000                                                                  DPKCS024
054100 A200-PROCESS-INTER-APPL-COMM.                                    DPKCS024
054200                                                                  DPKCS024
054300     IF  DP020-NEXT-ACT-INITIAL                                   DPKCS024
054400         MOVE INTER-APPL-COMM-AREA                                DPKCS024
054500                               TO  DP024-INTER-APPL-COMMAREA      DPKCS024
054600         MOVE DP055-MENU-NAME  TO  DP024-SCREEN-MENU-NAME         DPKCS024
054700         MOVE DP055-MNEMONIC   TO  DP024-SCREEN-MNEMONIC          DPKCS024
054800     ELSE                                                         DPKCS024
054900       IF  DP020-NEXT-ACT-RETURN                                  DPKCS024
055000           MOVE DP024-INTER-APPL-COMMAREA                         DPKCS024
055100                               TO  INTER-APPL-COMM-AREA           DPKCS024
055200       ELSE                                                       DPKCS024
055300         IF  DP020-NEXT-ACT-READ-MAP                              DPKCS024
055400             IF  DP020-FK-GO-TO-TRAN (DP020-SRC-AID)              DPKCS024
055500                   PERFORM A800-SETUP-INTER-APPL                  DPKCS024
055600             END-IF                                               DPKCS024
055700         END-IF                                                   DPKCS024
055800       END-IF                                                     DPKCS024
055900     END-IF.                                                      DPKCS024
056000 EJECT                                                            DPKCS024
056100******************************************************************DPKCS024
056200* A250-SEND-INITIAL-SCREEN                                       *DPKCS024
056300* (Z024-06 SEND INITIAL SCREEN)                                  *DPKCS024
056400* RETRIEVE THE DATA FROM THE DATABASE, FORMAT DATA ON SCREEN, AND*DPKCS024
056500* DISPLAY THE SCREEN TO THE USER.                                *DPKCS024
056600******************************************************************DPKCS024
056700                                                                  DPKCS024
056800 A250-SEND-INITIAL-SCREEN.                                        DPKCS024
056900                                                                  DPKCS024
057000     PERFORM A500-RETRIEVE-DATA-FOR-SCREEN.                       DPKCS024
057100                                                                  DPKCS024
057200     IF  NOT DP020-NEXT-ACT-APPL-ERROR                            DPKCS024
057300         PERFORM A450-EDIT-DELETE-OBJECTS                         DPKCS024
057400     END-IF.                                                      DPKCS024
057500                                                                  DPKCS024
057600     PERFORM A550-DISPLAY-PANEL.                                  DPKCS024
057700 EJECT                                                            DPKCS024
057800******************************************************************DPKCS024
057900* A300-CHECK-LOCAL-PF-KEYS                                       *DPKCS024
058000* (Z024-09 CHECK FOR LOCAL PF KEYS)                              *DPKCS024
058100*                                                                *DPKCS024
058200* LOCAL FUNCTION KEYS:                                           *DPKCS024
058300*      PF5   (DP020-SRC-AID = 05)  - REFRESH SCREEN              *DPKCS024
058400*      PF16  (DP020-SRC-AID = 16)  - DELETE FROM TMENUITEM TABLE *DPKCS024
058500*      PA2   (DP020-SRC-AID = 26)  - TOGGLE THE FUNCTION KEY     *DPKCS024
058600*                                    LINES ON SCREEN             *DPKCS024
058700*      CLEAR (DP020-SRC-AID = 27)  - REFRESH SCREEN              *DPKCS024
058800*      ENTER (DP020-SRC-AID = 28)  - EDIT SCREEN                 *DPKCS024
058900******************************************************************DPKCS024
059000                                                                  DPKCS024
059100 A300-CHECK-LOCAL-PF-KEYS.                                        DPKCS024
059200                                                                  DPKCS024
059300     SET PS-LOCAL-FUNCTION-NO    TO TRUE.                         DPKCS024
059400                                                                  DPKCS024
059500     IF (DP020-FK-LOCAL-KEY (DP020-SRC-AID)  OR                   DPKCS024
059600         DP020-FK-CONFIRM (DP020-SRC-AID)    OR                   DPKCS024
059700         DP020-FK-REFRESH (DP020-SRC-AID)    OR                   DPKCS024
059800         DP020-FK-PREV-PAGE (DP020-SRC-AID)  OR                   DPKCS024
059900         DP020-FK-NEXT-PAGE (DP020-SRC-AID)  OR                   DPKCS024
060000         DP020-FK-FIRST-PAGE (DP020-SRC-AID) OR                   DPKCS024
060100         DP020-FK-DESELECT (DP020-SRC-AID))                       DPKCS024
060200         SET PS-LOCAL-FUNCTION-YES                                DPKCS024
060300                                 TO TRUE                          DPKCS024
060400     END-IF.                                                      DPKCS024
060500 EJECT                                                            DPKCS024
060600******************************************************************DPKCS024
060700* A350-LOCAL-PF-KEY-CONTROL                                      *DPKCS024
060800* (Z024-10 LOCAL PF KEY CONTROL)                                 *DPKCS024
060900******************************************************************DPKCS024
061000                                                                  DPKCS024
061100 A350-LOCAL-PF-KEY-CONTROL.                                       DPKCS024
061200                                                                  DPKCS024
061300     EVALUATE DP020-SRC-AID                                       DPKCS024
061400                                                                  DPKCS024
061500         WHEN  DP016-PF5                                          DPKCS024
061600             SET PS-SEND-MAP-N-DATA-FRSET                         DPKCS024
061700                                 TO TRUE                          DPKCS024
061800             PERFORM A250-SEND-INITIAL-SCREEN                     DPKCS024
061900         WHEN  DP016-PF16                                         DPKCS024
062000             SET PS-SEND-MAP-N-DATA-FRSET                         DPKCS024
062100                                 TO TRUE                          DPKCS024
062200             PERFORM A450-EDIT-DELETE-OBJECTS                     DPKCS024
062300             IF PS-EDIT-ERROR-NO                                  DPKCS024
062400                 PERFORM A400-PROCESS-DELETE                      DPKCS024
062500             END-IF                                               DPKCS024
062600             PERFORM A550-DISPLAY-PANEL                           DPKCS024
062700         WHEN  DP016-PA2                                          DPKCS024
062800             SET PS-SEND-DATA-ONLY-FRSET                          DPKCS024
062900                                 TO TRUE                          DPKCS024
063000             PERFORM DP009-0000-LOAD-FK-LINES                     DPKCS024
063100             PERFORM DP018-0000-GET-CURR-TIME                     DPKCS024
063200             PERFORM DP008-0000-WRITE-PANEL                       DPKCS024
063300         WHEN  DP016-CLEAR                                        DPKCS024
063400             SET PS-SEND-DATA-ONLY-FRSET                          DPKCS024
063500                                 TO TRUE                          DPKCS024
063600             PERFORM A450-EDIT-DELETE-OBJECTS                     DPKCS024
063700             PERFORM A550-DISPLAY-PANEL                           DPKCS024
063800         WHEN OTHER                                               DPKCS024
063900             SET PS-SEND-MAP-N-DATA-FRSET                         DPKCS024
064000                                 TO TRUE                          DPKCS024
064100             PERFORM A450-EDIT-DELETE-OBJECTS                     DPKCS024
064200             PERFORM A550-DISPLAY-PANEL                           DPKCS024
064300                                                                  DPKCS024
064400     END-EVALUATE.                                                DPKCS024
064500 EJECT                                                            DPKCS024
064600******************************************************************DPKCS024
064700* A400-PROCESS-DELETE                                            *DPKCS024
064800* (Z024-12 PROCESS ADD TO DATABASE)                              *DPKCS024
064900* ALL DB2 DATABASE MAINTENANCE USES 'TIMESTAMP' VALIDATION SYNTAX*DPKCS024
065000* TO ENSURE THAT THE SET OF DATA BEING UPDATED IS IN THE SAME    *DPKCS024
065100* CONDITION AT THE TIME OF UPDATE THAT IT WAS IN WHEN THE SET OF *DPKCS024
065200* DATA WAS RETRIEVED FROM THE DATABASE FOR PROCESSING. THIS IS A *DPKCS024
065300* RECOGNITION OF THE POTENTIAL FOR CONCURRENT UPDATING ON ALL    *DPKCS024
065400* RELATIONS WITHIN THE DB2 ENVIRONMENT.                          *DPKCS024
065500******************************************************************DPKCS024
065600                                                                  DPKCS024
065700 A400-PROCESS-DELETE.                                             DPKCS024
065800                                                                  DPKCS024
065900     MOVE DP024-SCREEN-MENU-NAME TO TMENUITEM-MENU-NAME.          DPKCS024
066000     MOVE DP024-SCREEN-MNEMONIC  TO TMENUITEM-ITEM-MNEMONIC-CODE. DPKCS024
066100     MOVE DP024-TIMESTAMP        TO TMENUITEM-LAST-UPDATE-TMESTP. DPKCS024
066200                                                                  DPKCS024
066300     PERFORM X930-DELETE-TMENUITEM-ROW.                           DPKCS024
066310     PERFORM X980-UPDT-TMNEMONIC-ROW.                             DPKCS024
066400     MOVE PC-TSYMSG-00115        TO DP020-MSG-NUMBER.             DPKCS024
066500     SET DP020-MSG-INFORMATIONAL TO TRUE                          DPKCS024
066600     MOVE 3                      TO DP024-SELECT-MAINT-RESULT.    DPKCS024
066700     SET DP055-DELETED           TO TRUE.                         DPKCS024
066800 EJECT                                                            DPKCS024
066900******************************************************************DPKCS024
067000* A450-EDIT-DELETE-OBJECTS                                       *DPKCS024
067100******************************************************************DPKCS024
067200 A450-EDIT-DELETE-OBJECTS.                                        DPKCS024
067300     SET PS-EDIT-ERROR-NO    TO TRUE.                             DPKCS024
067400     MOVE DP015-PRO-NOR-OFF                                       DPKCS024
067500                             TO AMNUNAMA.                         DPKCS024
067600     MOVE DP015-BLUE         TO AMNUNAMC.                         DPKCS024
067700     MOVE DP015-PRO-NOR-OFF                                       DPKCS024
067800                             TO AMNUTTLA.                         DPKCS024
067900     MOVE DP015-BLUE         TO AMNUTTLC.                         DPKCS024
068000     MOVE DP015-PRO-NOR-OFF                                       DPKCS024
068100                             TO AMNEMONA.                         DPKCS024
068200     MOVE DP015-BLUE         TO AMNEMONC.                         DPKCS024
068300     MOVE DP015-PRO-NOR-OFF                                       DPKCS024
068400                             TO ATRANIDA.                         DPKCS024
068500     MOVE DP015-BLUE         TO ATRANIDC.                         DPKCS024
068600     MOVE DP015-PRO-NOR-OFF                                       DPKCS024
068700                             TO ATITTLEA.                         DPKCS024
068800     MOVE DP015-BLUE         TO ATITTLEC.                         DPKCS024
068900     MOVE DP015-PRO-NOR-OFF                                       DPKCS024
069000                             TO ASEQNUMA.                         DPKCS024
069100     MOVE DP015-BLUE         TO ASEQNUMC.                         DPKCS024
069200     IF (DP024-SCREEN-MENU-NAME = SPACES OR                       DPKCS024
069300                                  LOW-VALUES                      DPKCS024
069400         OR                                                       DPKCS024
069500         DP024-SCREEN-MNEMONIC  = SPACES OR                       DPKCS024
069600                                  LOW-VALUES)                     DPKCS024
069700         SET PS-EDIT-ERROR-YES                                    DPKCS024
069800                             TO TRUE                              DPKCS024
069900         MOVE DP015-PRO-BRT-OFF                                   DPKCS024
070000                             TO AMNEMONA                          DPKCS024
070100         MOVE DP015-REVERSE  TO AMNEMONH                          DPKCS024
070200         MOVE DP015-RED      TO AMNEMONC                          DPKCS024
070300         MOVE 5              TO DP024-SELECT-MAINT-RESULT         DPKCS024
070400         MOVE PC-TSYMSG-00057                                     DPKCS024
070500                             TO DP020-MSG-NUMBER                  DPKCS024
070600         SET DP020-MSG-WARNING                                    DPKCS024
070700                             TO TRUE                              DPKCS024
070800         SET DP020-NEXT-ACT-APPL-ERROR                            DPKCS024
070900                             TO TRUE                              DPKCS024
071000         PERFORM DP015-1000-START-NAVIGATOR                       DPKCS024
071100     ELSE                                                         DPKCS024
071200         IF DP024-A-NON-MENU-TRAN                                 DPKCS024
071300             SET PS-EDIT-ERROR-YES                                DPKCS024
071400                                 TO TRUE                          DPKCS024
071500             MOVE DP015-PRO-BRT-OFF                               DPKCS024
071600                                 TO AMNEMONA                      DPKCS024
071700             MOVE DP015-REVERSE  TO AMNEMONH                      DPKCS024
071800             MOVE DP015-RED      TO AMNEMONC                      DPKCS024
071900             MOVE 5              TO DP024-SELECT-MAINT-RESULT     DPKCS024
072000             MOVE PC-TSYMSG-00266                                 DPKCS024
072100                             TO DP020-MSG-NUMBER                  DPKCS024
072200             SET DP020-MSG-FATAL TO TRUE                          DPKCS024
072300         END-IF                                                   DPKCS024
072400     END-IF.                                                      DPKCS024
072500 EJECT                                                            DPKCS024
072600***************************************************************** DPKCS024
072700*     EVERY TIME IN SET THE COMMAND FIELD TO EITHER RED         * DPKCS024
072800*     OR GREEN. THIS IS BECAUSE IT IS UNEDITTED IN THE          * DPKCS024
072900*     PROGRAM AND IT NEEDS RESETTING.                           * DPKCS024
073000***************************************************************** DPKCS024
073100 A470-SET-COMMAND-ATTRIBUTES.                                     DPKCS024
073200     IF DP020-NEXT-ACT-ERROR                                      DPKCS024
073300         MOVE DP020-MSG-MESSAGE                                   DPKCS024
073400                                 TO PV-HOLD-MESSAGE               DPKCS024
073500         MOVE DP020-MSG-SEVERITY-IND                              DPKCS024
073600                                 TO PV-HOLD-SEVERITY-IND          DPKCS024
073700         IF DP020-NAV-MNEMONIC NOT EQUAL TO SPACES                DPKCS024
073800             MOVE DP015-UNP-ALP-BRT-MDT                           DPKCS024
073900                                 TO ANAVCMDA                      DPKCS024
074000             MOVE DP015-RED                                       DPKCS024
074100                                 TO ANAVCMDC                      DPKCS024
074200             MOVE DP015-REVERSE                                   DPKCS024
074300                                 TO ANAVCMDH                      DPKCS024
074400         ELSE                                                     DPKCS024
074500             MOVE SPACES         TO ANAVCMDO                      DPKCS024
074600                                    DP020-NAV-MNEMONIC            DPKCS024
074700             MOVE DP015-UNP-ALP-NOR-OFF                           DPKCS024
074800                                 TO ANAVCMDA                      DPKCS024
074900             MOVE DP015-GREEN                                     DPKCS024
075000                                 TO ANAVCMDC                      DPKCS024
075100             MOVE DP015-UNDERLINE                                 DPKCS024
075200                                 TO ANAVCMDH                      DPKCS024
075300         END-IF                                                   DPKCS024
075400     ELSE                                                         DPKCS024
075500         IF (EIBAID NOT EQUAL TO DFHPA2 AND                       DPKCS024
075600                                 DFHCLEAR)                        DPKCS024
075700             MOVE DP015-UNP-ALP-NOR-OFF                           DPKCS024
075800                                 TO ANAVCMDA                      DPKCS024
075900             MOVE DP015-GREEN                                     DPKCS024
076000                                 TO ANAVCMDC                      DPKCS024
076100             MOVE DP015-UNDERLINE                                 DPKCS024
076200                                 TO ANAVCMDH                      DPKCS024
076300         END-IF                                                   DPKCS024
076400     END-IF.                                                      DPKCS024
076500 EJECT                                                            DPKCS024
076600******************************************************************DPKCS024
076700* A500-RETRIEVE-DATA-FOR-SCREEN                                  *DPKCS024
076800* (Z024-07 RETRIEVE DATA FOR SCREEN                              *DPKCS024
076900******************************************************************DPKCS024
077000                                                                  DPKCS024
077100 A500-RETRIEVE-DATA-FOR-SCREEN.                                   DPKCS024
077200                                                                  DPKCS024
077300     INITIALIZE DP024-SCREEN-TRAN-ID                              DPKCS024
077400                DP024-SCREEN-SEQUENCE-NUMBER                      DPKCS024
077500                DP024-SCREEN-MENU-TITLE                           DPKCS024
077600                DP024-SCREEN-MENU-ITEM-TITLE                      DPKCS024
077700                DP024-SCREEN-FORMAT                               DPKCS024
077800                DP024-SCREEN-PANEL-TITLE-NAME.                    DPKCS024
077900     MOVE DP024-SCREEN-MENU-NAME TO TMNEMONIC-MNEMONIC-CODE.      DPKCS024
078000                                                                  DPKCS024
078100     SET DP024-A-NON-MENU-TRAN TO TRUE.                           DPKCS024
078200     PERFORM X900-READ-TMNEMONIC-ROW.                             DPKCS024
078300     IF  SQL-ROW-FOUND                                            DPKCS024
078400         MOVE TMNEMONIC-PANEL-TITLE-NAME                          DPKCS024
078500                                 TO DP024-SCREEN-MENU-TITLE       DPKCS024
078600         MOVE DP024-SCREEN-MENU-NAME                              DPKCS024
078700                                 TO TMENUITEM-MENU-NAME           DPKCS024
078800         MOVE DP024-SCREEN-MNEMONIC                               DPKCS024
078900                                 TO TMENUITEM-ITEM-MNEMONIC-CODE  DPKCS024
079000         IF TMNEMONIC-TRANS-ID-CODE = PC-MENU-TRAN-ID             DPKCS024
079100             SET DP024-A-MENU-TRAN TO TRUE                        DPKCS024
079200         END-IF                                                   DPKCS024
079300         PERFORM X910-READ-TMENUITEM-ROW                          DPKCS024
079400         IF  SQL-ROW-FOUND                                        DPKCS024
079500             MOVE DP024-SCREEN-MNEMONIC                           DPKCS024
079600                                 TO TMNEMONIC-MNEMONIC-CODE       DPKCS024
079700             PERFORM X900-READ-TMNEMONIC-ROW                      DPKCS024
079800             IF  SQL-ROW-FOUND                                    DPKCS024
079900                 MOVE TMNEMONIC-TRANS-ID-CODE                     DPKCS024
080000                                 TO DP024-SCREEN-TRAN-ID          DPKCS024
080100                 MOVE TMNEMONIC-PANEL-TITLE-NAME                  DPKCS024
080200                                 TO DP024-SCREEN-PANEL-TITLE-NAME DPKCS024
080300             ELSE                                                 DPKCS024
080400                 MOVE SPACES     TO DP024-SCREEN-TRAN-ID          DPKCS024
080500                                    DP024-SCREEN-MENU-ITEM-TITLE  DPKCS024
080600             END-IF                                               DPKCS024
080700             IF  PV-DESC-NULL                                     DPKCS024
080800                 MOVE SPACES     TO DP024-SCREEN-MENU-ITEM-TITLE  DPKCS024
080900             ELSE                                                 DPKCS024
081000                 MOVE TMENUITEM-DESC                              DPKCS024
081100                                 TO DP024-SCREEN-MENU-ITEM-TITLE  DPKCS024
081200             END-IF                                               DPKCS024
081300             MOVE TMENUITEM-SEQUENCE-NMBR                         DPKCS024
081400                                 TO PV-SEQUENCE-NUMBER-NUMERIC    DPKCS024
081500             MOVE TMENUITEM-IN-APLCTN-COMM-CDE                    DPKCS024
081600                                 TO DP024-SCREEN-FORMAT           DPKCS024
081700             MOVE PV-SEQUENCE-NUMBER-ALPHA                        DPKCS024
081800                                 TO DP024-SCREEN-SEQUENCE-NUMBER  DPKCS024
081900             MOVE TMENUITEM-LAST-UPDATE-TMESTP                    DPKCS024
082000                                 TO DP024-TIMESTAMP               DPKCS024
082100             MOVE -1             TO ANAVKEYL                      DPKCS024
082200         ELSE                                                     DPKCS024
082300             IF  DP024-SCREEN-MNEMONIC GREATER THAN SPACES        DPKCS024
082400                 MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER         DPKCS024
082500                 SET DP020-MSG-FATAL  TO TRUE                     DPKCS024
082600             ELSE                                                 DPKCS024
082700                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         DPKCS024
082800                 SET DP020-MSG-WARNING TO TRUE                    DPKCS024
082900             END-IF                                               DPKCS024
083000                                                                  DPKCS024
083100             SET DP020-NEXT-ACT-APPL-ERROR                        DPKCS024
083200                                  TO TRUE                         DPKCS024
083300             MOVE 5               TO DP024-SELECT-MAINT-RESULT    DPKCS024
083400             PERFORM DP015-1000-START-NAVIGATOR                   DPKCS024
083500         END-IF                                                   DPKCS024
083600     ELSE                                                         DPKCS024
083700         MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER                 DPKCS024
083800         SET DP020-MSG-FATAL  TO TRUE                             DPKCS024
083900         SET DP020-NEXT-ACT-APPL-ERROR                            DPKCS024
084000                              TO TRUE                             DPKCS024
084100         MOVE 5               TO DP024-SELECT-MAINT-RESULT        DPKCS024
084200         PERFORM DP015-1000-START-NAVIGATOR                       DPKCS024
084300     END-IF.                                                      DPKCS024
084400                                                                  DPKCS024
084500     MOVE -1                     TO ANAVKEYL.                     DPKCS024
084600 EJECT                                                            DPKCS024
084700******************************************************************DPKCS024
084800* A550-DISPLAY-PANEL                                             *DPKCS024
084900* (Z024-02 DISPLAY PANEL)                                        *DPKCS024
085000******************************************************************DPKCS024
085100                                                                  DPKCS024
085200 A550-DISPLAY-PANEL.                                              DPKCS024
085300                                                                  DPKCS024
085400     IF  NOT DP020-NEXT-ACT-APPL-ERROR                            DPKCS024
085500                                                                  DPKCS024
085600         IF  PS-SEND-DATA-ONLY-FRSET                              DPKCS024
085700             PERFORM DP018-0000-GET-CURR-TIME                     DPKCS024
085800         ELSE                                                     DPKCS024
085900             PERFORM DP017-0000-GET-CURR-DATE-TIME                DPKCS024
086000             PERFORM DP002-0000-FORMAT-TITLE-LINES                DPKCS024
086100         END-IF                                                   DPKCS024
086200                                                                  DPKCS024
086300         IF  (   PS-SEND-MAP-N-DATA-FRSET                         DPKCS024
086400             OR  PS-NEW-MNEMONIC-ENTERED-YES                      DPKCS024
086500             )                                                    DPKCS024
086600             PERFORM A600-LOAD-DETAIL-DATA                        DPKCS024
086700         END-IF                                                   DPKCS024
086800                                                                  DPKCS024
086900         PERFORM DP005-0000-FORMAT-MSG-LINES                      DPKCS024
087000                                                                  DPKCS024
087100         IF  (   PS-SEND-MAP-N-DATA-FRSET                         DPKCS024
087200             OR  DP020-SRC-AID  =  DP016-PA2                      DPKCS024
087300             )                                                    DPKCS024
087400            PERFORM DP009-0000-LOAD-FK-LINES                      DPKCS024
087500         END-IF                                                   DPKCS024
087600                                                                  DPKCS024
087700         MOVE -1                     TO ANAVCMDL                  DPKCS024
087800         PERFORM DP008-0000-WRITE-PANEL                           DPKCS024
087900                                                                  DPKCS024
088000     END-IF.                                                      DPKCS024
088100 EJECT                                                            DPKCS024
088200******************************************************************DPKCS024
088300* A600-LOAD-DETAIL-DATA                                          *DPKCS024
088400* (Z024-08 LOAD DETAIL DATA)                                     *DPKCS024
088500******************************************************************DPKCS024
088600                                                                  DPKCS024
088700 A600-LOAD-DETAIL-DATA.                                           DPKCS024
088800                                                                  DPKCS024
088900     MOVE DP024-SCREEN-MENU-NAME TO AMNUNAMO.                     DPKCS024
089000     MOVE DP024-SCREEN-MENU-TITLE                                 DPKCS024
089100                                 TO AMNUTTLO.                     DPKCS024
089200     MOVE DP024-SCREEN-MNEMONIC  TO AMNEMONO.                     DPKCS024
089300     MOVE DP024-SCREEN-TRAN-ID   TO ATRANIDO.                     DPKCS024
089400     MOVE DP024-SCREEN-PANEL-TITLE-NAME                           DPKCS024
089500                                 TO APANELO.                      DPKCS024
089600     MOVE DP024-SCREEN-MENU-ITEM-TITLE                            DPKCS024
089700                                 TO ATITTLEO.                     DPKCS024
089800     MOVE DP024-SCREEN-FORMAT    TO AFORMATO.                     DPKCS024
089900     MOVE DP024-SCREEN-SEQUENCE-NUMBER                            DPKCS024
090000                                 TO ASEQNUMO.                     DPKCS024
090100 EJECT                                                            DPKCS024
090200******************************************************************DPKCS024
090300* A650-MOVE-SCREEN-TO-COMM                                       *DPKCS024
090400* (Z024-13 MOVE SCREEN TO COMMAREA)                              *DPKCS024
090500* IN ORDER TO MINIMIZE DATA TRANSMISSIONS, ALL SCREEN VARIABLES  *DPKCS024
090600* WILL BE STORED IN THE COMMAREA. ALL EDITING AND DATABASE I/O   *DPKCS024
090700* WILL BE FROM THESE FIELDS IN THE APPLICATION SPECIFIC COMMAREA.*DPKCS024
090800* ONLY ATTRIBUTE CHANGES WILL BE SENT TO THE TERMINAL AS LONG AS *DPKCS024
090900* THE CURRENT MAP IS STILL BEING DISPLAYED. THIS MODULE OVERLAYS *DPKCS024
091000* ANY COMMAREA SCREEN VARIABLE THAT HAS CHANGED (EITHER A LENGTH *DPKCS024
091100* GREATER THAN ZERO OR EOF HAS BEEN PRESSED) WITH THE INPUT FIELD*DPKCS024
091200* FROM THE SCREEN.                                               *DPKCS024
091300******************************************************************DPKCS024
091400                                                                  DPKCS024
091500 A650-MOVE-SCREEN-TO-COMM.                                        DPKCS024
091600                                                                  DPKCS024
091700     SET PS-NEW-MNEMONIC-ENTERED-NO                               DPKCS024
091800                                 TO TRUE.                         DPKCS024
091900                                                                  DPKCS024
092000     IF  (     ANAVKEYL       >  ZEROS                            DPKCS024
092100         AND   ANAVCMDL       =  ZEROS                            DPKCS024
092200         AND   DP020-SRC-AID  =  DP016-ENTER                      DPKCS024
092300         )                                                        DPKCS024
092400         SET PS-NEW-MNEMONIC-ENTERED-YES                          DPKCS024
092500                                 TO TRUE                          DPKCS024
092600         MOVE ANAVKEYI           TO PV-MNEMONIC                   DPKCS024
092700                                    DP024-SCREEN-MNEMONIC         DPKCS024
092800         MOVE LOW-VALUES         TO ANAVKEYO                      DPKCS024
092900         MOVE SPACES             TO                               DPKCS024
093000                DP024-SELECT-MAINT-RESULT                         DPKCS024
093100         SET PS-SEND-MAP-N-DATA-FRSET                             DPKCS024
093200                                 TO TRUE                          DPKCS024
093300         PERFORM A250-SEND-INITIAL-SCREEN                         DPKCS024
093400     END-IF.                                                      DPKCS024
093500                                                                  DPKCS024
093600 EJECT                                                            DPKCS024
093700******************************************************************DPKCS024
093800* A800-SETUP-INTER-APPL                                          *DPKCS024
093900* (Z024-16 SETUP INTER-APPL)                                     *DPKCS024
094000*                                                                *DPKCS024
094100* WHENEVER THIS TRANSACTION IS ABOUT TO NAVIGATE TO ANOTHER      *DPKCS024
094200* TRANSACTION, THIS MODULE WILL FORMAT THE INTER APPLICATION     *DPKCS024
094300* COMMAREA WITH THE DATA SAVED FOR THE CURRENT OBJECT BEING PRO- *DPKCS024
094400* CESSED BY THIS TRANSACTION.                                    *DPKCS024
094500******************************************************************DPKCS024
094600                                                                  DPKCS024
094700 A800-SETUP-INTER-APPL.                                           DPKCS024
094800                                                                  DPKCS024
094900     MOVE INTER-APPL-COMM-AREA   TO DP024-INTER-APPL-COMMAREA.    DPKCS024
095000     MOVE DP024-SCREEN-MNEMONIC  TO DP055-MNEMONIC.               DPKCS024
095100                                                                  DPKCS024
095200 EJECT                                                            DPKCS024
095300******************************************************************DPKCS024
095400* A850-RESET-INITIAL-INTER-APPL                                  *DPKCS024
095500* (Z024-17 RESET INITIAL INTER-APPL)                             *DPKCS024
095600*                                                                *DPKCS024
095700* WHEN THIS MODULE IS ABOUT TO RETURN TO THE MODULE THAT INVOKED *DPKCS024
095800* IT, IT WILL RESET THE COMMAREA TO THE CONTENTS THAT WERE SENT  *DPKCS024
095900* TO IT ALONG WITH ANY UPDATES TO THE OBJECT SENT TO IT, ALONG   *DPKCS024
096000* WITH AN ACKNOWLEDGEMENT CODE.                                  *DPKCS024
096100******************************************************************DPKCS024
096200                                                                  DPKCS024
096300 A850-RESET-INITIAL-INTER-APPL.                                   DPKCS024
096400                                                                  DPKCS024
096500     MOVE DP024-INTER-APPL-COMMAREA                               DPKCS024
096600                               TO  INTER-APPL-COMM-AREA.          DPKCS024
096700                                                                  DPKCS024
096800 EJECT                                                            DPKCS024
096900************************************                              DPKCS024
097000* FETCH ROW FROM TABLE TMNEMONIC   *                              DPKCS024
097100*    USING TMNEMONIC-MNEMONIC-CODE *                              DPKCS024
097200************************************                              DPKCS024
097300                                                                  DPKCS024
097400 X900-READ-TMNEMONIC-ROW.                                         DPKCS024
097500                                                                  DPKCS024
097600     EXEC SQL                                                     DPKCS024
097700         SELECT       MNEMONIC_CODE,                              DPKCS024
097800                      TRANS_ID_CODE,                              DPKCS024
097900                      PANEL_TITLE_NAME,                           DPKCS024
098000                      PGM_NAME                                    DPKCS024
098100               INTO   :TMNEMONIC-MNEMONIC-CODE,                   DPKCS024
098200                      :TMNEMONIC-TRANS-ID-CODE,                   DPKCS024
098300                      :TMNEMONIC-PANEL-TITLE-NAME,                DPKCS024
098400                      :TMNEMONIC-PGM-NAME                         DPKCS024
098500               FROM   TMNEMONIC                                   DPKCS024
098600               WHERE  MNEMONIC_CODE  =  :TMNEMONIC-MNEMONIC-CODE  DPKCS024
098700     END-EXEC.                                                    DPKCS024
098800                                                                  DPKCS024
098900***************************                                       DPKCS024
099000* CHECK SQLCODE OF SELECT *                                       DPKCS024
099100***************************                                       DPKCS024
099200                                                                  DPKCS024
099300     MOVE SQLCODE                TO SQL-RETURN-CODE.              DPKCS024
099400     IF  SQL-ROW-NOT-FOUND                                        DPKCS024
099500         CONTINUE                                                 DPKCS024
099600     ELSE                                                         DPKCS024
099700       IF  NOT SQL-SUCCESSFUL                                     DPKCS024
099800           SET  DP013-DB2-ABEND                                   DPKCS024
099900                                 TO TRUE                          DPKCS024
100000           MOVE 'X900-READ-TMNEMONIC-ROW       '                  DPKCS024
100100                                 TO DP013-PARAGRAPH               DPKCS024
100200           MOVE SQLCA            TO DP013-SQLCA                   DPKCS024
100300           MOVE 'TMNEMONIC         '                              DPKCS024
100400                                 TO DP013-DB2-TABLE-NAME (1)      DPKCS024
100401           MOVE 'READ FAILED FOR: '                                     12
100402                                 TO DP013-MESSAGE-TEXT (1)              12
100403           MOVE TMENUITEM-ITEM-MNEMONIC-CODE                            12
100404                                 TO PV-DISP-MENU-NAME                   12
100406           MOVE SPACES           TO PV-DISP-ITEM                        12
100410           MOVE PV-DISPLAY-INFO  TO DP013-MESSAGE-TEXT (2)              12
100500           PERFORM DP013-0000-PROCESS-ABEND                       DPKCS024
100600       END-IF                                                     DPKCS024
100700     END-IF.                                                      DPKCS024
100800 EJECT                                                            DPKCS024
100900**********************************                                DPKCS024
101000* FETCH ROW FROM TABLE TMENUITEM *                                DPKCS024
101100**********************************                                DPKCS024
101200                                                                  DPKCS024
101300 X910-READ-TMENUITEM-ROW.                                         DPKCS024
101400                                                                  DPKCS024
101500     EXEC SQL                                                     DPKCS024
101600         SELECT       MENU_NAME,                                  DPKCS024
101700                      ITEM_MNEMONIC_CODE,                         DPKCS024
101800                      IN_APLCTN_COMM_CDE,                         DPKCS024
101900                      DESC,                                       DPKCS024
102000                      SEQUENCE_NMBR,                              DPKCS024
102100                      LAST_UPDATE_TMESTP                          DPKCS024
102200               INTO   :TMENUITEM-MENU-NAME,                       DPKCS024
102300                      :TMENUITEM-ITEM-MNEMONIC-CODE,              DPKCS024
102400                      :TMENUITEM-IN-APLCTN-COMM-CDE,              DPKCS024
102500                      :TMENUITEM-DESC:PV-DESC-NULL-IND,           DPKCS024
102600                      :TMENUITEM-SEQUENCE-NMBR,                   DPKCS024
102700                      :TMENUITEM-LAST-UPDATE-TMESTP               DPKCS024
102800               FROM   TMENUITEM                                   DPKCS024
102900               WHERE  MENU_NAME           =                       DPKCS024
103000                          :TMENUITEM-MENU-NAME                    DPKCS024
103100                      AND                                         DPKCS024
103200                      ITEM_MNEMONIC_CODE  =                       DPKCS024
103300                            :TMENUITEM-ITEM-MNEMONIC-CODE         DPKCS024
103400     END-EXEC.                                                    DPKCS024
103500                                                                  DPKCS024
103600***************************                                       DPKCS024
103700* CHECK SQLCODE OF SELECT *                                       DPKCS024
103800***************************                                       DPKCS024
103900                                                                  DPKCS024
104000     MOVE SQLCODE                TO SQL-RETURN-CODE.              DPKCS024
104100     IF  SQL-ROW-NOT-FOUND                                        DPKCS024
104200         CONTINUE                                                 DPKCS024
104300     ELSE                                                         DPKCS024
104400       IF  NOT SQL-SUCCESSFUL                                     DPKCS024
104500           SET  DP013-DB2-ABEND                                   DPKCS024
104600                                 TO TRUE                          DPKCS024
104700           MOVE 'X910-READ-TMENUITEM-ROW       '                  DPKCS024
104800                                 TO DP013-PARAGRAPH               DPKCS024
104900           MOVE SQLCA            TO DP013-SQLCA                   DPKCS024
105000           MOVE 'TMENUITEM         '                              DPKCS024
105100                                 TO DP013-DB2-TABLE-NAME (1)      DPKCS024
105101           MOVE 'READ FAILED FOR: '                                     12
105102                                 TO DP013-MESSAGE-TEXT (1)              12
105103           MOVE TMENUITEM-MENU-NAME                                     12
105104                                 TO PV-DISP-MENU-NAME                   12
105105           MOVE TMENUITEM-ITEM-MNEMONIC-CODE                            12
105106                                 TO PV-DISP-ITEM                        12
105108           MOVE PV-DISPLAY-INFO  TO DP013-MESSAGE-TEXT (2)              12
105110           PERFORM DP013-0000-PROCESS-ABEND                             21
105300       END-IF                                                     DPKCS024
105400     END-IF.                                                      DPKCS024
105500 EJECT                                                            DPKCS024
105600***********************************                               DPKCS024
105700* DELETE ROW FROM TABLE TMENUITEM *                               DPKCS024
105800***********************************                               DPKCS024
105900                                                                  DPKCS024
106000 X930-DELETE-TMENUITEM-ROW.                                       DPKCS024
106100                                                                  DPKCS024
106200       EXEC SQL                                                   DPKCS024
106300           DELETE FROM  TMENUITEM                                 DPKCS024
106400               WHERE  MENU_NAME           =                       DPKCS024
106500                          :TMENUITEM-MENU-NAME                    DPKCS024
106600                      AND                                         DPKCS024
106700                      ITEM_MNEMONIC_CODE  =                       DPKCS024
106800                          :TMENUITEM-ITEM-MNEMONIC-CODE           DPKCS024
106900       END-EXEC.                                                  DPKCS024
107000                                                                  DPKCS024
107100***************************                                       DPKCS024
107200* CHECK SQLCODE OF DELETE *                                       DPKCS024
107300***************************                                       DPKCS024
107400                                                                  DPKCS024
107500     MOVE SQLCODE                TO SQL-RETURN-CODE.              DPKCS024
107600     IF  SQL-ROW-NOT-FOUND                                        DPKCS024
107700         CONTINUE                                                 DPKCS024
107800     ELSE                                                         DPKCS024
107900       IF  NOT SQL-SUCCESSFUL                                     DPKCS024
108000           SET  DP013-DB2-ABEND  TO TRUE                          DPKCS024
108100           MOVE 'X930-DELETE-TMENUITEM-ROW     '                  DPKCS024
108200                                 TO DP013-PARAGRAPH               DPKCS024
108300           MOVE SQLCA            TO DP013-SQLCA                   DPKCS024
108400           MOVE 'TMENUITEM         '                              DPKCS024
108500                                 TO DP013-DB2-TABLE-NAME (1)      DPKCS024
108501           MOVE 'DELETE FAILED FOR: '                                   12
108502                                 TO DP013-MESSAGE-TEXT (1)              12
108503           MOVE TMENUITEM-MENU-NAME                                     12
108504                                 TO PV-DISP-MENU-NAME                   12
108505           MOVE TMENUITEM-ITEM-MNEMONIC-CODE                            12
108506                                 TO PV-DISP-ITEM                        12
108510           MOVE PV-DISPLAY-INFO  TO DP013-MESSAGE-TEXT (2)              12
108600           PERFORM DP013-0000-PROCESS-ABEND                       DPKCS024
108700         END-IF                                                   DPKCS024
108800     END-IF.                                                      DPKCS024
108900 EJECT                                                            DPKCS024
108901************************************                              DPKCS012
108902* UPDATE ROW FROM TABLE TMNEMONIC  *                              DPKCS012
108903*    FOR THIS MENU.                *                              DPKCS012
108904************************************                              DPKCS012
108905                                                                  DPKCS012
108906 X980-UPDT-TMNEMONIC-ROW.                                         DPKCS012
108907 SKIP2                                                            DPKCS012
108910     EXEC SQL                                                     DPKCS012
108911           UPDATE TMNEMONIC                                             12
108912              SET UPD_VSAM_IND       = :PC-Y,                           12
108913                  LAST_UPDATE_TMESTP = CURRENT TIMESTAMP                12
108914           WHERE  MNEMONIC_CODE      = :DP024-SCREEN-MENU-NAME          12
108915     END-EXEC.                                                    DPKCS012
108916                                                                  DPKCS012
108917***************************                                       DPKCS021
108918* CHECK SQLCODE OF UPDATE *                                       DPKCS021
108919***************************                                       DPKCS021
108920                                                                  DPKCS021
108921     MOVE SQLCODE                TO SQL-RETURN-CODE.              DPKCS021
108922     IF  SQLCODE NOT EQUAL ZERO                                   DPKCS021
108923         SET  DP013-DB2-ABEND  TO TRUE                            DPKCS021
108924         MOVE 'X980-UPDT-TMNEMONIC-ROW       '                    DPKCS021
108925                                 TO DP013-PARAGRAPH               DPKCS021
108926         MOVE SQLCA              TO DP013-SQLCA                   DPKCS021
108927         MOVE 'TMNEMONIC         '                                DPKCS021
108928                                 TO DP013-DB2-TABLE-NAME (1)      DPKCS021
108929         MOVE 'UPDATE OF UPD-VSAM-IND FAILED FOR: '                     12
108930                                 TO DP013-MESSAGE-TEXT (1)        DPKCS012
108931         MOVE DP024-SCREEN-MENU-NAME                                    12
108932                                 TO DP013-MESSAGE-TEXT (2)        DPKCS012
108933         PERFORM DP013-0000-PROCESS-ABEND                         DPKCS021
108934     END-IF.                                                      DPKCS021
108935 EJECT                                                            DPKCS021
108940                                                                        12
109000**********************************************                    DPKCS024
109100* COPYBOOK FOR DP002-0000-FORMAT-TITLE-LINES *                    DPKCS024
109200**********************************************                    DPKCS024
109300     COPY DPPD022.                                                DPKCS024
109400 EJECT                                                            DPKCS024
109500******************************************                        DPKCS024
109600* COPYBOOK FOR DP003-0000-RETURN-TO-CICS *                        DPKCS024
109700******************************************                        DPKCS024
109800     COPY DPPD003.                                                DPKCS024
109900 EJECT                                                            DPKCS024
110000********************************************                      DPKCS024
110100* COPYBOOK FOR DP005-0000-FORMAT-MSG-LINES *                      DPKCS024
110200********************************************                      DPKCS024
110300     COPY DPPD005.                                                DPKCS024
110400 EJECT                                                            DPKCS024
110500*************************************                             DPKCS024
110600* COPYBOOK FOR DP007-0000-GET-PANEL *                             DPKCS024
110700*************************************                             DPKCS024
110800     COPY DPPD007.                                                DPKCS024
110900 EJECT                                                            DPKCS024
111000***************************************                           DPKCS024
111100* COPYBOOK FOR DP008-0000-WRITE-PANEL *                           DPKCS024
111200***************************************                           DPKCS024
111300     COPY DPPD008.                                                DPKCS024
111400 EJECT                                                            DPKCS024
111500*****************************************                         DPKCS024
111600* COPYBOOK FOR DP009-0000-LOAD-FK-LINES *                         DPKCS024
111700*****************************************                         DPKCS024
111800     COPY DPPD009.                                                DPKCS024
111900 EJECT                                                            DPKCS024
112000*****************************************                         DPKCS024
112100* COPYBOOK FOR DP013-0000-PROCESS-ABEND *                         DPKCS024
112200*****************************************                         DPKCS024
112300     COPY DPPD013.                                                DPKCS024
112400 EJECT                                                            DPKCS024
112500******************************************                        DPKCS024
112600* COPYBOOK FOR DP015-0000-CHECK-COMMAREA *                        DPKCS024
112700******************************************                        DPKCS024
112800     COPY DPPD015.                                                DPKCS024
112900 EJECT                                                            DPKCS024
113000**********************************************                    DPKCS024
113100* COPYBOOK FOR DP017-0000-GET-CURR-DATE-TIME *                    DPKCS024
113200**********************************************                    DPKCS024
113300     COPY DPPD017.                                                DPKCS024
113400 EJECT                                                            DPKCS024
113500*****************************************                         DPKCS024
113600* COPYBOOK FOR DP018-0000-GET-CURR-TIME *                         DPKCS024
113700*****************************************                         DPKCS024
113800     COPY DPPD018.                                                DPKCS024
