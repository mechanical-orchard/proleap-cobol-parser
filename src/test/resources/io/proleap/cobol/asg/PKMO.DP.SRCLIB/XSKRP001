000100 IDENTIFICATION DIVISION.                                         00010059
000200 PROGRAM-ID.    XSKRP001                                          00020059
000300 AUTHOR.        BRAD GROCHOWSKI.                                  00030059
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040059
000500 DATE-WRITTEN.  12/17/2002.                                       00050059
000600 DATE-COMPILED.                                                   00060059
000700                                                                  00070059
000800******************************************************************00080059
000900*          DOMAIN LOCATION DATA INTEGRITY                         00090059
001000*                                                                 00100059
001100*     XSKRP001 - LOCATION DATA INTEGRITY REPORT                   00110059
001200*                                                                 00120059
001300* THIS PROGRAM READS AN EXTRACT OF RMS DATA AND COMPARES TO AN    00130059
001400* EXTRACT OF DATA FROM THE XS DOMAIN TABLES.                      00140059
001500* ANY DIFFERENCES ARE WRITTEN TO THE XS LOCATION DATA INTEGRITY   00150059
001600* ERRORS REPORT.                                                  00160059
001700*                                                                 00170059
001800* THE INPUT FILES ARE FORMATTED TO THE HO007-LOCATION-DATA FORMAT 00180059
001900* FOUND IN COPYBOOK HORD007, REGARDLESS OF THE TYPE OF LOCATION,  00190059
002000* IN ORDER TO KEEP THE FILES IN ONE FORMAT RATHER THAN 3.         00200059
002100* THE EXTRACT FROM XS IS DONE IN PROGRAM XSKUT043.                00210059
002200*                                                                 00220059
002300* THE MESSAGE TEXT FOR THE REPORT ERROR MESSAGES ARE FOUND IN     00230059
002400* COPYBOOK XSWS001.                                               00240059
002500*                                                                 00250059
002600* IF THERE ARE ANY ERRORS TO BE REPORTED, PROGRAM WILL END WITH   00260059
002700* RETURN CODE 4095 SO THAT AN E-MAIL CAN BE SENT IN A             00270059
002800* SUBSEQUENT JOB STEP.                                            00280059
002900*                                                                 00290059
003000******************************************************************00300059
003100                                                                  00310059
003200                                                                  00320059
003300 ENVIRONMENT DIVISION.                                            00330059
003400 CONFIGURATION SECTION.                                           00340059
003500 SOURCE-COMPUTER.        IBM-3090.                                00350059
003600 OBJECT-COMPUTER.        IBM-3090.                                00360059
003700 INPUT-OUTPUT SECTION.                                            00370059
003800 FILE-CONTROL.                                                    00380059
003900                                                                  00390059
004000     SELECT RMS-LOC-EXTRACT-DATA-FILE                             00400059
004100         ASSIGN TO INP01.                                         00410059
004200                                                                  00420059
004300     SELECT XS-LOC-EXTRACT-DATA-FILE                              00430059
004400         ASSIGN TO INP02.                                         00440059
004500                                                                  00450059
004600     SELECT XS-LOC-DATA-INTEGRITY-RPT                             00460059
004700         ASSIGN TO RPT01.                                         00470059
004800                                                                  00480059
004900 DATA DIVISION.                                                   00490059
005000 FILE SECTION.                                                    00500059
005100                                                                  00510059
005200 FD  RMS-LOC-EXTRACT-DATA-FILE                                    00520059
005300     RECORDING MODE IS F                                          00530059
005400     LABEL RECORDS ARE STANDARD                                   00540059
005500     BLOCK CONTAINS 0 RECORDS.                                    00550059
005600                                                                  00560059
005700 01  RMS-EXTRACT-REC                  PIC  X(668).                00570059
005800                                                                  00580059
005900 FD  XS-LOC-EXTRACT-DATA-FILE                                     00590059
006000     RECORDING MODE IS F                                          00600059
006100     LABEL RECORDS ARE STANDARD                                   00610059
006200     BLOCK CONTAINS 0 RECORDS.                                    00620059
006300                                                                  00630059
006400 01  XS-EXTRACT-REC                   PIC  X(668).                00640059
006500                                                                  00650059
006600 FD  XS-LOC-DATA-INTEGRITY-RPT                                    00660059
006700     RECORDING  MODE IS F                                         00670059
006800     LABEL RECORDS ARE STANDARD                                   00680059
006900     BLOCK CONTAINS 0 RECORDS.                                    00690059
007000                                                                  00700059
007100 01  XS-LOC-RPT-LINE                  PIC X(200).                 00710059
007200                                                                  00720059
007300                                                                  00730059
007400 WORKING-STORAGE SECTION.                                         00740059
007500                                                                  00750059
007600***************************************************************** 00760059
007700* RECORD LAYOUT FOR RMS LOCATION EXTRACT FILE                     00770059
007800***************************************************************** 00780059
007900     COPY HORD007.                                                00790059
008000                                                                  00800059
008100***************************************************************** 00810059
008200* RECORD LAYOUT FOR XS LOCATION EXTRACT FILE                      00820059
008300***************************************************************** 00830059
008400     COPY HORD007 REPLACING HO007 BY XS007                        00840059
008500                            HORD  BY XSRD.                        00850059
008600                                                                  00860059
008700***************************************************************** 00870059
008800* XS LOCATION DATA INTEGRITY ERROR MESSAGE TABLE                  00880059
008900***************************************************************** 00890059
009000                                                                  00900059
009100     COPY XSWS001.                                                00910059
009200                                                                  00920059
009300                                                                  00930059
009400 01  PC-PROGRAM-CONSTANTS.                                        00940059
009500     05  PC-PGM-NAME             PIC  X(08)      VALUE 'XSKRP001'.00950059
009600     05  PC-MAX-DTL-LINES        PIC S9(04) COMP VALUE +70.       00960059
009700                                                                  00970059
009800 01  PV-PROGRAM-VARIABLES.                                        00980059
009900     05  PV-PAGE-CNT             PIC S9(05)        VALUE ZERO.    00990059
010000     05  PV-LINE-CNT             PIC S9(04) COMP   VALUE +71.     01000059
010100     05  PV-DISPLAY-CNT          PIC ZZZZ9.                       01010059
010200     05  PV-ADVANCE              PIC S9(03) COMP-3 VALUE ZERO.    01020059
010300     05  PV-NBR-ERRORS           PIC S9(04) COMP   VALUE ZERO.    01030059
010400     05  PV-DATE-YYMMDD.                                          01040059
010500         10  PV-YYMMDD-YY        PIC  X(02)        VALUE SPACE.   01050059
010600         10  PV-YYMMDD-MM        PIC  X(02)        VALUE SPACE.   01060059
010700         10  PV-YYMMDD-DD        PIC  X(02)        VALUE SPACE.   01070059
010800     05  PV-TIME-HHMMSS.                                          01080059
010900         10  PV-HHMMSS-HH        PIC  X(02)        VALUE SPACE.   01090059
011000         10  PV-HHMMSS-MM        PIC  X(02)        VALUE SPACE.   01100059
011100         10  PV-HHMMSS-SS        PIC  X(02)        VALUE SPACE.   01110059
011200     05  PV-MSG-NBR              PIC S9(03).                      01120059
011300     05  PV-XS-VALUE             PIC  X(30).                      01130059
011400     05  PV-RMS-VALUE            PIC  X(30).                      01140059
011500     05  PV-LOC-NBR              PIC  S9(4) COMP.                 01150059
011600     05  PV-XS-EXTR-REC-CNT      PIC S9(04)  COMP                 01160059
011700                                             VALUE ZERO.          01170059
011800     05  PV-RMS-EXTR-REC-CNT     PIC S9(04)  COMP                 01180059
011900                                             VALUE ZERO.          01190059
012000     05  PV-REPORT-CNT           PIC S9(04)  COMP                 01200059
012100                                             VALUE ZERO.          01210059
012200     05  ABEND-CODE                     PIC S9(04) VALUE +0.      01220059
012300     05  PV-RETRY-COUNTER               PIC  9(01)  VALUE ZEROS.  01230059
012400     05  PV-PARAGRAPH                   PIC  X(50).               01240059
012500     05  PV-MESSAGE                     PIC  X(50).               01250059
012600                                                                  01260059
012700                                                                  01270059
012800 01  PS-PROGRAM-SWITCHES.                                         01280059
012900     05  PS-END-OF-RMS-FILE-SW PIC X               VALUE 'N'.     01290059
013000         88 PS-END-OF-RMS-FILE                     VALUE 'Y'.     01300059
013100         88 PS-NOT-END-OF-RMS-FILE                 VALUE 'N'.     01310059
013200     05  PS-END-OF-XS-FILE-SW PIC X                VALUE 'N'.     01320059
013300         88 PS-END-OF-XS-FILE                      VALUE 'Y'.     01330059
013400         88 PS-NOT-END-OF-XS-FILE                  VALUE 'N'.     01340059
013500                                                                  01350059
013600                                                                  01360059
013700******************************************************************01370059
013800* STANDARD REPORT HEADING                                         01380059
013900******************************************************************01390059
014000                                                                  01400059
014100     COPY DPWS200O.                                               01410059
014200                                                                  01420059
014300                                                                  01430059
014400 01  RPT-REPORT-HEADING.                                          01440059
014500     05  FILLER            PIC  X(73)    VALUE SPACES.            01450059
014600     05  FILLER            PIC  X(53)    VALUE                    01460059
014700       'XS LOCATION DATA INTEGRITY ERRORS'.                       01470059
014800                                                                  01480059
014900 01  RPT-COL-HEADING-1.                                           01490059
015000     05  FILLER            PIC  X(01) VALUE SPACE.                01500059
015100     05  FILLER            PIC  X(17) VALUE ALL '-'.              01510059
015200     05  FILLER            PIC  X(05) VALUE ' KEY '.              01520059
015300     05  FILLER            PIC  X(18) VALUE ALL '-'.              01530059
015400                                                                  01540059
015500 01  RPT-COL-HEADING-2.                                           01550059
015600     05  FILLER            PIC  X(01) VALUE SPACE.                01560059
015700     05  FILLER            PIC  X(32) VALUE SPACE.                01570059
015800     05  FILLER            PIC  X(10) VALUE 'LOCATION'.           01580059
015900     05  FILLER            PIC  X(07) VALUE 'TYPE'.               01590059
016000     05  FILLER            PIC  X(38) VALUE 'XS DOMAIN'.          01600059
016100     05  FILLER            PIC  X(40) VALUE 'SYSTEM OF RECORD'.   01610059
016200     05  FILLER            PIC  X(08) VALUE 'MESSAGE'.            01620059
016300                                                                  01630059
016400 01  RPT-COL-HEADING-3.                                           01640059
016500     05  FILLER            PIC  X(01) VALUE SPACE.                01650059
016600     05  FILLER            PIC  X(42) VALUE SPACE.                01660059
016700     05  FILLER            PIC  X(07) VALUE 'CODE'.               01670059
016800     05  FILLER            PIC  X(38) VALUE 'VALUE'.              01680059
016900     05  FILLER            PIC  X(10) VALUE 'VALUE'.              01690059
017000                                                                  01700059
017100 01  DL-DETAIL-LINE.                                              01710059
017200     05  FILLER            PIC  X(01) VALUE SPACE.                01720059
017300     05  FILLER            PIC  X(34) VALUE SPACE.                01730059
017400     05  DL-LOCATION       PIC  ZZZZZ.                            01740059
017500     05  FILLER            PIC  X(04) VALUE SPACE.                01750059
017600     05  DL-TYP-CDE        PIC  X(03).                            01760059
017700     05  FILLER            PIC  X(03) VALUE SPACE.                01770059
017800     05  DL-XS-VALUE       PIC  X(35).                            01780059
017900     05  FILLER            PIC  X(03) VALUE SPACE.                01790059
018000     05  DL-RMS-VALUE      PIC  X(35).                            01800059
018100     05  FILLER            PIC  X(03) VALUE SPACE.                01810059
018200     05  DL-MESSAGE        PIC  X(75).                            01820059
018300                                                                  01830059
018400 01  RPT-TOTAL-LINE.                                              01840059
018500     05  FILLER            PIC  X(23) VALUE                       01850059
018600                                        'TOTAL NUMBER OF ERRORS '.01860059
018700     05  RPT-NBR-ERRORS    PIC  ZZZZZZ9.                          01870059
018800                                                                  01880059
018900 01  RPT-END-OF-REPORT-LINE.                                      01890059
019000     05  FILLER            PIC  X(21) VALUE                       01900059
019100                                          '*** END OF REPORT ***'.01910059
019200*----------------------------------------------------------------*01920059
019300*   STANDARD DB2 ERROR HANDLING AREA                            * 01930059
019400*----------------------------------------------------------------*01940059
019500     COPY DPWS004.                                                01950059
019600*----------------------------------------------------------------*01960059
019700*    STANDARD DB2 DCLGEN FOR THE LOC ATTR TABLE (XST_LOC_ATTR)   *01970059
019800*----------------------------------------------------------------*01980059
019900     EXEC SQL                                                     01990059
020000         INCLUDE XST00025                                         02000059
020100     END-EXEC.                                                    02010059
020200*----------------------------------------------------------------*02020059
020300*    STANDARD DB2 COMMUNICATIONS AREA                            *02030059
020400*----------------------------------------------------------------*02040059
020500     EXEC SQL                                                     02050059
020600         INCLUDE SQLCA                                            02060059
020700     END-EXEC.                                                    02070059
020800                                                                  02080059
020900*----------------------------------------------------------------*02090059
021000 PROCEDURE DIVISION.                                              02100059
021100*----------------------------------------------------------------*02110059
021200                                                                  02120059
021300     OPEN INPUT  RMS-LOC-EXTRACT-DATA-FILE                        02130059
021400                  XS-LOC-EXTRACT-DATA-FILE                        02140059
021500          OUTPUT XS-LOC-DATA-INTEGRITY-RPT.                       02150059
021600                                                                  02160059
021700     PERFORM 1000-INITIALIZE.                                     02170059
021800                                                                  02180059
021900     PERFORM 7000-READ-RMS-FILE.                                  02190059
022000     PERFORM 7100-READ-XS-FILE.                                   02200059
022100                                                                  02210059
022200                                                                  02220059
022300     PERFORM 2000-COMPARE-FILES                                   02230059
022400         UNTIL PS-END-OF-RMS-FILE AND                             02240059
022500               PS-END-OF-XS-FILE.                                 02250059
022600                                                                  02260059
022700     PERFORM 8400-WRITE-TOTAL-LINE.                               02270059
022800                                                                  02280059
022900     CLOSE RMS-LOC-EXTRACT-DATA-FILE                              02290059
023000            XS-LOC-EXTRACT-DATA-FILE                              02300059
023100           XS-LOC-DATA-INTEGRITY-RPT.                             02310059
023200                                                                  02320059
023300     DISPLAY '***** ' PC-PGM-NAME ' STATISTICS *****'.            02330059
023400     MOVE PV-XS-EXTR-REC-CNT TO PV-DISPLAY-CNT.                   02340059
023500     DISPLAY '   ** XS EXTRACT RECORDS READ: ' PV-DISPLAY-CNT.    02350059
023600     MOVE PV-RMS-EXTR-REC-CNT    TO PV-DISPLAY-CNT.               02360059
023700     DISPLAY '   ** RMS    EXTRACT RECORDS READ: ' PV-DISPLAY-CNT.02370059
023800     MOVE PV-NBR-ERRORS  TO PV-DISPLAY-CNT.                       02380059
023900                                                                  02390059
024000*    IF THERE ARE ANY ERRORS TO BE REPORTED, ISSUE A              02400059
024100*    RETURN CODE SO THAT AN E-MAIL WILL BE SENT IN A              02410059
024200*    SUBSEQUENT JOB STEP.                                         02420059
024300                                                                  02430059
024400     IF PV-NBR-ERRORS > 0                                         02440059
024500         MOVE 4095 TO RETURN-CODE                                 02450059
024600     END-IF.                                                      02460059
024700                                                                  02470059
024800     DISPLAY '   ** ERRORS REPORTED: ' PV-DISPLAY-CNT.            02480059
024900     GOBACK.                                                      02490059
025000                                                                  02500059
025100                                                                  02510059
025200******************************************************************02520059
025300* INITIALIZE AND WRITE REPORT HEADINGS                            02530059
025400******************************************************************02540059
025500 1000-INITIALIZE.                                                 02550059
025600                                                                  02560059
025700     ACCEPT PV-DATE-YYMMDD FROM DATE.                             02570059
025800     MOVE PV-YYMMDD-YY TO DP200O-RUN-YEAR.                        02580059
025900     MOVE PV-YYMMDD-MM TO DP200O-RUN-MONTH.                       02590059
026000     MOVE PV-YYMMDD-DD TO DP200O-RUN-DAY.                         02600059
026100                                                                  02610059
026200     ACCEPT PV-TIME-HHMMSS FROM TIME.                             02620059
026300     MOVE PV-HHMMSS-HH TO DP200O-RUN-HOUR.                        02630059
026400     MOVE PV-HHMMSS-MM TO DP200O-RUN-MINUTE.                      02640059
026500     MOVE PC-PGM-NAME  TO DP200O-PROGRAM-NAME.                    02650059
026600     MOVE 1            TO DP200O-REPORT-NUMBER.                   02660059
026700                                                                  02670059
026800     PERFORM 8100-WRITE-STD-RPT-HEADING.                          02680059
026900     PERFORM 8200-WRITE-REPORT-HEADING.                           02690059
027000     PERFORM 8300-WRITE-COLUMN-HEADING.                           02700059
027100                                                                  02710059
027200******************************************************************02720059
027300* COMPARE RMS DATA TO XS DATA                                     02730059
027400******************************************************************02740059
027500 2000-COMPARE-FILES.                                              02750059
027600                                                                  02760059
027700     MOVE SPACES       TO PV-XS-VALUE                             02770059
027800                          PV-RMS-VALUE.                           02780059
027900                                                                  02790059
028000     IF XS007-LOC-NBR = HO007-LOC-NBR                             02800059
028100*****    LOCATION IS ON BOTH XS AND RMS.  *****                   02810059
028200         PERFORM 2100-COMPARE-FIELDS                              02820059
028300         PERFORM 7000-READ-RMS-FILE                               02830059
028400         PERFORM 7100-READ-XS-FILE                                02840059
028500     ELSE                                                         02850059
028600         IF XS007-LOC-NBR < HO007-LOC-NBR                         02860059
028700*****        LOCATION IS ON XS ONLY.      *****                   02870059
028800             MOVE 26 TO PV-MSG-NBR                                02880059
028900             PERFORM 3200-WRITE-REPORT-REC-XS                     02890059
029000             PERFORM 7100-READ-XS-FILE                            02900059
029100        ELSE                                                      02910059
029200*****        LOCATION IS ON RMS ONLY.     *****                   02920059
029300             MOVE 27 TO PV-MSG-NBR                                02930059
029400             PERFORM 3100-WRITE-REPORT-REC-RMS                    02940059
029500             PERFORM 7000-READ-RMS-FILE                           02950059
029600        END-IF                                                    02960059
029700     END-IF.                                                      02970059
029800                                                                  02980059
029900                                                                  02990059
030000                                                                  03000059
030100******************************************************************03010059
030200* COMPARE RMS DATA TO XS DATA FIELD BY FIELD                      03020059
030300******************************************************************03030059
030400* DUE TO NULL DATA, NEED TO CHECK FOR THE POSSIBILITY THAT THE    03040059
030500* RMS FILE HAS LOW VALUES WHEN THE XS EXTRACT HAS SPACES. THIS    03050059
030600* IS OK AND SHOULD NOT BE REGARDED AS AN ERROR.                   03060059
030700* ALSO IT IS POSSIBLE THAT FOR DATE FIELDS, XS EXTRACT WILL HAVE  03070059
030800* 9999-09-09 WHEN RMS HAS NULL OR SPACES. THIS IS ALSO OK AND     03080059
030900* SHOULD NOT BE REGARDED AS AN ERROR.                             03090059
031000******************************************************************03100059
031100 2100-COMPARE-FIELDS.                                             03110059
031200     EVALUATE TRUE                                                03120059
031300       WHEN HO007-LOC-REPLT-STR-NBR NOT = XS007-LOC-REPLT-STR-NBR 03130059
031400            MOVE HO007-LOC-REPLT-STR-NBR TO PV-RMS-VALUE          03140059
031500            MOVE XS007-LOC-REPLT-STR-NBR TO PV-XS-VALUE           03150059
031600            MOVE 1                       TO PV-MSG-NBR            03160059
031700            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03170059
031800       WHEN HO007-LOC-DIST-NBR      NOT = XS007-LOC-DIST-NBR      03180059
031900            MOVE HO007-LOC-DIST-NBR    TO PV-RMS-VALUE            03190059
032000            MOVE XS007-LOC-DIST-NBR    TO PV-XS-VALUE             03200059
032100            MOVE 2                     TO PV-MSG-NBR              03210059
032200            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03220059
032300       WHEN (HO007-LOC-TYP-CDE      NOT = XS007-LOC-TYP-CDE       03230059
032400            AND NOT (HO007-LOC-TYP-CDE = LOW-VALUES               03240059
032500                     AND XS007-LOC-TYP-CDE = SPACES))             03250059
032600            MOVE HO007-LOC-TYP-CDE     TO PV-RMS-VALUE            03260059
032700            MOVE XS007-LOC-TYP-CDE     TO PV-XS-VALUE             03270059
032800            MOVE 3                     TO PV-MSG-NBR              03280059
032900            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03290059
033000       WHEN (HO007-LOC-NM           NOT = XS007-LOC-NM            03300059
033100            AND NOT (HO007-LOC-NM = LOW-VALUES                    03310059
033200                     AND XS007-LOC-NM = SPACES))                  03320059
033300            MOVE HO007-LOC-NM          TO PV-RMS-VALUE            03330059
033400            MOVE XS007-LOC-NM          TO PV-XS-VALUE             03340059
033500            MOVE 4                     TO PV-MSG-NBR              03350059
033600            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03360059
033700       WHEN (HO007-LOC-5-ABBR-NM    NOT = XS007-LOC-5-ABBR-NM     03370059
033800            AND NOT (HO007-LOC-5-ABBR-NM = LOW-VALUES             03380059
033900                     AND XS007-LOC-5-ABBR-NM = SPACES))           03390059
034000            MOVE HO007-LOC-5-ABBR-NM   TO PV-RMS-VALUE            03400059
034100            MOVE XS007-LOC-5-ABBR-NM   TO PV-XS-VALUE             03410059
034200            MOVE 5                     TO PV-MSG-NBR              03420059
034300            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03430059
034400       WHEN (HO007-LOC-LNE-1-ADDR   NOT = XS007-LOC-LNE-1-ADDR    03440059
034500            AND NOT (HO007-LOC-LNE-1-ADDR = LOW-VALUES            03450059
034600                     AND XS007-LOC-LNE-1-ADDR = SPACES))          03460059
034700            MOVE HO007-LOC-LNE-1-ADDR  TO PV-RMS-VALUE            03470059
034800            MOVE XS007-LOC-LNE-1-ADDR  TO PV-XS-VALUE             03480059
034900            MOVE 6                     TO PV-MSG-NBR              03490059
035000            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03500059
035100       WHEN (HO007-LOC-LNE-2-ADDR   NOT = XS007-LOC-LNE-2-ADDR    03510059
035200            AND NOT (HO007-LOC-LNE-2-ADDR = LOW-VALUES            03520059
035300                     AND XS007-LOC-LNE-2-ADDR = SPACES))          03530059
035400            MOVE HO007-LOC-LNE-2-ADDR  TO PV-RMS-VALUE            03540059
035500            MOVE XS007-LOC-LNE-2-ADDR  TO PV-XS-VALUE             03550059
035600            MOVE 7                     TO PV-MSG-NBR              03560059
035700            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03570059
035800       WHEN (HO007-LOC-CITY         NOT = XS007-LOC-CITY          03580059
035900            AND NOT (HO007-LOC-CITY = LOW-VALUES                  03590059
036000                     AND XS007-LOC-CITY = SPACES))                03600059
036100            MOVE HO007-LOC-CITY        TO PV-RMS-VALUE            03610059
036200            MOVE XS007-LOC-CITY        TO PV-XS-VALUE             03620059
036300            MOVE 8                     TO PV-MSG-NBR              03630059
036400            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03640059
036500       WHEN (HO007-LOC-ST-CDE       NOT = XS007-LOC-ST-CDE        03650059
036600            AND NOT (HO007-LOC-ST-CDE = LOW-VALUES                03660059
036700                     AND XS007-LOC-ST-CDE = SPACES))              03670059
036800            MOVE HO007-LOC-ST-CDE      TO PV-RMS-VALUE            03680059
036900            MOVE XS007-LOC-ST-CDE      TO PV-XS-VALUE             03690059
037000            MOVE 9                     TO PV-MSG-NBR              03700059
037100            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03710059
037200       WHEN (HO007-LOC-ZIP-10-CDE   NOT = XS007-LOC-ZIP-10-CDE    03720059
037300            AND NOT (HO007-LOC-ZIP-10-CDE = LOW-VALUES            03730059
037400                     AND XS007-LOC-ZIP-10-CDE = SPACES))          03740059
037500            MOVE HO007-LOC-ZIP-10-CDE  TO PV-RMS-VALUE            03750059
037600            MOVE XS007-LOC-ZIP-10-CDE  TO PV-XS-VALUE             03760059
037700            MOVE 10                    TO PV-MSG-NBR              03770059
037800            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03780059
037900       WHEN (HO007-LOC-OPEN-DATE    NOT = XS007-LOC-OPEN-DATE     03790059
038000            AND XS007-LOC-OPEN-DATE  NOT = '9999-09-09'           03800059
038100            AND NOT (HO007-LOC-OPEN-DATE = LOW-VALUES             03810059
038200                     AND XS007-LOC-OPEN-DATE = SPACES))           03820059
038300            MOVE HO007-LOC-OPEN-DATE   TO PV-RMS-VALUE            03830059
038400            MOVE XS007-LOC-OPEN-DATE   TO PV-XS-VALUE             03840059
038500            MOVE 11                    TO PV-MSG-NBR              03850059
038600            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03860059
038700       WHEN (HO007-LOC-CLOSE-DATE    NOT = XS007-LOC-CLOSE-DATE   03870059
038800            AND XS007-LOC-CLOSE-DATE NOT = '9999-09-09'           03880059
038900            AND NOT (HO007-LOC-CLOSE-DATE = LOW-VALUES            03890059
039000                     AND XS007-LOC-CLOSE-DATE = SPACES))          03900059
039100            MOVE HO007-LOC-CLOSE-DATE  TO PV-RMS-VALUE            03910059
039200            MOVE XS007-LOC-CLOSE-DATE  TO PV-XS-VALUE             03920059
039300            MOVE 12                    TO PV-MSG-NBR              03930059
039400            PERFORM 3000-WRITE-REPORT-REC-BOTH                    03940059
039500       WHEN (HO007-LOC-PHONE-NUMBER NOT = XS007-LOC-PHONE-NUMBER  03950059
039600            AND NOT (HO007-LOC-PHONE-NUMBER = LOW-VALUES          03960059
039700                     AND XS007-LOC-PHONE-NUMBER = SPACES))        03970059
039800            MOVE HO007-LOC-PHONE-NUMBER TO PV-RMS-VALUE           03980059
039900            MOVE XS007-LOC-PHONE-NUMBER TO PV-XS-VALUE            03990059
040000            MOVE 14                    TO PV-MSG-NBR              04000059
040100            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04010059
040200       WHEN (HO007-LOC-MGR-NM        NOT = XS007-LOC-MGR-NM       04020059
040300            AND NOT (HO007-LOC-MGR-NM = LOW-VALUES                04030059
040400                     AND XS007-LOC-MGR-NM = SPACES))              04040059
040500            MOVE HO007-LOC-MGR-NM       TO PV-RMS-VALUE           04050059
040600            MOVE XS007-LOC-MGR-NM       TO PV-XS-VALUE            04060059
040700            MOVE 15                    TO PV-MSG-NBR              04070059
040800            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04080059
040900       WHEN (HO007-LOC-FINCL-CLO-DTE NOT = XS007-LOC-FINCL-CLO-DTE04090059
041000            AND XS007-LOC-FINCL-CLO-DTE NOT = '9999-09-09'        04100059
041100            AND NOT (HO007-LOC-FINCL-CLO-DTE = LOW-VALUES         04110059
041200                     AND XS007-LOC-FINCL-CLO-DTE = SPACES))       04120059
041300            MOVE HO007-LOC-FINCL-CLO-DTE TO PV-RMS-VALUE          04130059
041400            MOVE XS007-LOC-FINCL-CLO-DTE TO PV-XS-VALUE           04140059
041500            MOVE 16                    TO PV-MSG-NBR              04150059
041600            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04160059
041700       WHEN (HO007-LOC-MN-SLS-INCL-DTE                            04170059
041800             NOT = XS007-LOC-MN-SLS-INCL-DTE                      04180059
041900            AND XS007-LOC-MN-SLS-INCL-DTE NOT = '9999-09-09'      04190059
042000            AND NOT (HO007-LOC-MN-SLS-INCL-DTE = LOW-VALUES       04200059
042100                     AND XS007-LOC-MN-SLS-INCL-DTE = SPACES))     04210059
042200            MOVE HO007-LOC-MN-SLS-INCL-DTE TO PV-RMS-VALUE        04220059
042300            MOVE XS007-LOC-MN-SLS-INCL-DTE TO PV-XS-VALUE         04230059
042400            MOVE 17                    TO PV-MSG-NBR              04240059
042500            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04250059
042600       WHEN (HO007-LOC-YR-SLS-INCL-DTE                            04260059
042700             NOT = XS007-LOC-YR-SLS-INCL-DTE                      04270059
042800            AND XS007-LOC-YR-SLS-INCL-DTE NOT = '9999-09-09'      04280059
042900            AND NOT (HO007-LOC-YR-SLS-INCL-DTE = LOW-VALUES       04290059
043000                     AND XS007-LOC-YR-SLS-INCL-DTE = SPACES))     04300059
043100            MOVE HO007-LOC-YR-SLS-INCL-DTE TO PV-RMS-VALUE        04310059
043200            MOVE XS007-LOC-YR-SLS-INCL-DTE TO PV-XS-VALUE         04320059
043300            MOVE 18                    TO PV-MSG-NBR              04330059
043400            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04340059
043500       WHEN (HO007-LOC-OCPNC-DTE                                  04350059
043600             NOT = XS007-LOC-OCPNC-DTE                            04360059
043700            AND XS007-LOC-OCPNC-DTE NOT = '9999-09-09'            04370059
043800            AND NOT (HO007-LOC-OCPNC-DTE       = LOW-VALUES       04380059
043900                     AND XS007-LOC-OCPNC-DTE       = SPACES))     04390059
044000            MOVE HO007-LOC-OCPNC-DTE TO PV-RMS-VALUE              04400059
044100            MOVE XS007-LOC-OCPNC-DTE TO PV-XS-VALUE               04410059
044200            MOVE 19                    TO PV-MSG-NBR              04420059
044300            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04430059
044400       WHEN (HO007-LOC-DST-IND      NOT = XS007-LOC-DST-IND       04440059
044500            AND NOT (HO007-LOC-DST-IND         = LOW-VALUES       04450059
044600                     AND XS007-LOC-DST-IND         = SPACES))     04460059
044700            MOVE HO007-LOC-DST-IND      TO PV-RMS-VALUE           04470059
044800            MOVE XS007-LOC-DST-IND      TO PV-XS-VALUE            04480059
044900            MOVE 20                    TO PV-MSG-NBR              04490059
045000            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04500059
045100       WHEN (HO007-LOC-E-BUS-IND    NOT = XS007-LOC-E-BUS-IND     04510059
045200            AND NOT (HO007-LOC-E-BUS-IND       = LOW-VALUES       04520059
045300                     AND XS007-LOC-E-BUS-IND       = SPACES))     04530059
045400            MOVE HO007-LOC-E-BUS-IND    TO PV-RMS-VALUE           04540059
045500            MOVE XS007-LOC-E-BUS-IND    TO PV-XS-VALUE            04550059
045600            MOVE 21                    TO PV-MSG-NBR              04560059
045700            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04570059
045800       WHEN (HO007-LOC-FMT-CDE      NOT = XS007-LOC-FMT-CDE       04580059
045900            AND NOT (HO007-LOC-FMT-CDE         = LOW-VALUES       04590059
046000                     AND XS007-LOC-FMT-CDE         = SPACES))     04600059
046100            MOVE HO007-LOC-FMT-CDE      TO PV-RMS-VALUE           04610059
046200            MOVE XS007-LOC-FMT-CDE      TO PV-XS-VALUE            04620059
046300            MOVE 22                    TO PV-MSG-NBR              04630059
046400            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04640059
046500       WHEN (HO007-LOC-STD-TM-ZN-CDE NOT = XS007-LOC-STD-TM-ZN-CDE04650059
046600            AND NOT (HO007-LOC-STD-TM-ZN-CDE   = LOW-VALUES       04660059
046700                     AND XS007-LOC-STD-TM-ZN-CDE   = SPACES))     04670059
046800            MOVE HO007-LOC-STD-TM-ZN-CDE TO PV-RMS-VALUE          04680059
046900            MOVE XS007-LOC-STD-TM-ZN-CDE TO PV-XS-VALUE           04690059
047000            MOVE 23                    TO PV-MSG-NBR              04700059
047100            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04710059
047200       WHEN (HO007-LOC-SLS-INCL-DTE-CDE NOT =                     04720059
047300               XS007-LOC-SLS-INCL-DTE-CDE                         04730059
047400            AND NOT (HO007-LOC-SLS-INCL-DTE-CDE = LOW-VALUES      04740059
047500                     AND XS007-LOC-SLS-INCL-DTE-CDE = SPACES))    04750059
047600            MOVE HO007-LOC-SLS-INCL-DTE-CDE TO PV-RMS-VALUE       04760059
047700            MOVE XS007-LOC-SLS-INCL-DTE-CDE TO PV-XS-VALUE        04770059
047800            MOVE 24                    TO PV-MSG-NBR              04780059
047900            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04790059
048091                                                                  04809160
048100* IF DEPARTMENT STORE, CHECK FOR A ROW ON XST_LOC_ATTR            04810059
048200                                                                  04820059
048300       WHEN HO007-LOC-TYP-CDE = 'DS'                              04830059
048400            PERFORM 2500-CHECK-FOR-ATTR                           04840059
048500            IF SQLCODE = +100                                     04850059
048600               MOVE 25                 TO PV-MSG-NBR              04860059
048700               PERFORM 3000-WRITE-REPORT-REC-BOTH                 04870059
048800            END-IF                                                04880059
048801                                                                  04880160
048810       WHEN (HO007-LOC-QTR-SLS-INCL-DTE                           04881060
048820             NOT = XS007-LOC-QTR-SLS-INCL-DTE                     04882060
048830            AND XS007-LOC-QTR-SLS-INCL-DTE NOT = '9999-09-09'     04883060
048840            AND NOT (HO007-LOC-QTR-SLS-INCL-DTE = LOW-VALUES      04884060
048850                     AND XS007-LOC-QTR-SLS-INCL-DTE = SPACES))    04885060
048860            MOVE HO007-LOC-QTR-SLS-INCL-DTE TO PV-RMS-VALUE       04886060
048870            MOVE XS007-LOC-QTR-SLS-INCL-DTE TO PV-XS-VALUE        04887060
048880            MOVE 28                    TO PV-MSG-NBR              04888061
048890            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04889060
048891       WHEN (HO007-LOC-SEA-SLS-INCL-DTE                           04889160
048892             NOT = XS007-LOC-SEA-SLS-INCL-DTE                     04889260
048893            AND XS007-LOC-SEA-SLS-INCL-DTE NOT = '9999-09-09'     04889360
048894            AND NOT (HO007-LOC-SEA-SLS-INCL-DTE = LOW-VALUES      04889460
048895                     AND XS007-LOC-SEA-SLS-INCL-DTE = SPACES))    04889560
048896            MOVE HO007-LOC-SEA-SLS-INCL-DTE TO PV-RMS-VALUE       04889660
048897            MOVE XS007-LOC-SEA-SLS-INCL-DTE TO PV-XS-VALUE        04889760
048898            MOVE 29                    TO PV-MSG-NBR              04889861
048899            PERFORM 3000-WRITE-REPORT-REC-BOTH                    04889960
048900     END-EVALUATE.                                                04890059
049000                                                                  04900059
049100******************************************************************04910059
049200* READ XST_LOC_ATTR TABLE TO SEE THAT A RECORD EXISTS FOR         04920059
049300* DEPARTMENT STORE LOCATIONS                                      04930059
049400******************************************************************04940059
049500 2500-CHECK-FOR-ATTR.                                             04950059
049600     MOVE HO007-LOC-NBR TO PV-LOC-NBR.                            04960059
049700     EXEC SQL                                                     04970059
049800         SELECT LOC_NBR                                           04980059
049900         INTO :XST00025-LOC-NBR                                   04990059
050000          FROM XST_LOC_ATTR                                       05000059
050100         WHERE LOC_NBR = :PV-LOC-NBR                              05010059
050200      END-EXEC.                                                   05020059
050300                                                                  05030059
050400     EVALUATE TRUE                                                05040059
050500         WHEN SQLCODE = +0                                        05050059
050600           CONTINUE                                               05060059
050700         WHEN SQLCODE = +100                                      05070059
050800           CONTINUE                                               05080059
050900         WHEN OTHER                                               05090059
051000             MOVE '2500-CHECK-FOR-ATTR'                           05100059
051100                               TO PV-PARAGRAPH                    05110059
051200             MOVE 'SELECT FROM XST_LOC_ATTR TABLE ERROR.'         05120059
051300                               TO PV-MESSAGE                      05130059
051400             PERFORM 9900-PROCESS-DB2-ERROR                       05140059
051500     END-EVALUATE.                                                05150059
051600                                                                  05160059
051700                                                                  05170059
051800******************************************************************05180059
051900* CREATE A REPORT RECORD FOR A KEY THAT IS ON BOTH RMS AND XS.    05190059
052000******************************************************************05200059
052100 3000-WRITE-REPORT-REC-BOTH.                                      05210059
052200                                                                  05220059
052300     MOVE HO007-LOC-NBR        TO DL-LOCATION.                    05230059
052400     MOVE HO007-LOC-TYP-CDE    TO DL-TYP-CDE.                     05240059
052500     MOVE PV-XS-VALUE          TO DL-XS-VALUE.                    05250059
052600     MOVE PV-RMS-VALUE         TO DL-RMS-VALUE.                   05260059
052700     SET  XSEM-IDX             TO PV-MSG-NBR.                     05270059
052800     MOVE XSEM-MSG-TEXT (XSEM-IDX) TO DL-MESSAGE.                 05280059
052900                                                                  05290059
053000     IF PV-LINE-CNT > PC-MAX-DTL-LINES                            05300059
053100         PERFORM 8100-WRITE-STD-RPT-HEADING                       05310059
053200         PERFORM 8200-WRITE-REPORT-HEADING                        05320059
053300         PERFORM 8300-WRITE-COLUMN-HEADING                        05330059
053400     END-IF.                                                      05340059
053500                                                                  05350059
053600     PERFORM 8000-WRITE-RPT-DETAIL-LINE.                          05360059
053700                                                                  05370059
053800******************************************************************05380059
053900* CREATE A REPORT RECORD FOR A KEY THAT IS ON RMS ONLY.           05390059
054000******************************************************************05400059
054100 3100-WRITE-REPORT-REC-RMS.                                       05410059
054200                                                                  05420059
054300     MOVE HO007-LOC-NBR        TO DL-LOCATION.                    05430059
054400     MOVE HO007-LOC-TYP-CDE    TO DL-TYP-CDE.                     05440059
054500     MOVE PV-XS-VALUE          TO DL-XS-VALUE.                    05450059
054600     MOVE PV-RMS-VALUE         TO DL-RMS-VALUE.                   05460059
054700     SET  XSEM-IDX             TO PV-MSG-NBR.                     05470059
054800     MOVE XSEM-MSG-TEXT (XSEM-IDX) TO DL-MESSAGE.                 05480059
054900                                                                  05490059
055000     IF PV-LINE-CNT > PC-MAX-DTL-LINES                            05500059
055100         PERFORM 8100-WRITE-STD-RPT-HEADING                       05510059
055200         PERFORM 8200-WRITE-REPORT-HEADING                        05520059
055300         PERFORM 8300-WRITE-COLUMN-HEADING                        05530059
055400     END-IF.                                                      05540059
055500                                                                  05550059
055600     PERFORM 8000-WRITE-RPT-DETAIL-LINE.                          05560059
055700                                                                  05570059
055800******************************************************************05580059
055900* CREATE A REPORT RECORD FOR A KEY THAT IS ON XS ONLY.            05590059
056000******************************************************************05600059
056100 3200-WRITE-REPORT-REC-XS.                                        05610059
056200                                                                  05620059
056300     MOVE XS007-LOC-NBR        TO DL-LOCATION.                    05630059
056400     MOVE XS007-LOC-TYP-CDE    TO DL-TYP-CDE.                     05640059
056500     MOVE PV-XS-VALUE          TO DL-XS-VALUE.                    05650059
056600     MOVE PV-RMS-VALUE         TO DL-RMS-VALUE.                   05660059
056700     SET  XSEM-IDX             TO PV-MSG-NBR.                     05670059
056800     MOVE XSEM-MSG-TEXT (XSEM-IDX) TO DL-MESSAGE.                 05680059
056900                                                                  05690059
057000     IF PV-LINE-CNT > PC-MAX-DTL-LINES                            05700059
057100         PERFORM 8100-WRITE-STD-RPT-HEADING                       05710059
057200         PERFORM 8200-WRITE-REPORT-HEADING                        05720059
057300         PERFORM 8300-WRITE-COLUMN-HEADING                        05730059
057400     END-IF.                                                      05740059
057500                                                                  05750059
057600     PERFORM 8000-WRITE-RPT-DETAIL-LINE.                          05760059
057700                                                                  05770059
057800******************************************************************05780059
057900* READ RMS INPUT FILE                                             05790059
058000******************************************************************05800059
058100 7000-READ-RMS-FILE.                                              05810059
058200     IF PS-NOT-END-OF-RMS-FILE                                    05820059
058300       READ RMS-LOC-EXTRACT-DATA-FILE                             05830059
058400         INTO HORD007-RECORD                                      05840059
058500           AT END SET PS-END-OF-RMS-FILE TO TRUE                  05850059
058600           MOVE 9999 TO HO007-LOC-NBR                             05860059
058700     END-IF.                                                      05870059
058800     IF PS-NOT-END-OF-RMS-FILE                                    05880059
058900        ADD +1 TO PV-RMS-EXTR-REC-CNT                             05890059
059000     END-IF.                                                      05900059
059100                                                                  05910059
059200******************************************************************05920059
059300* READ XS INPUT FILE                                              05930059
059400******************************************************************05940059
059500 7100-READ-XS-FILE.                                               05950059
059600     IF PS-NOT-END-OF-XS-FILE                                     05960059
059700       READ XS-LOC-EXTRACT-DATA-FILE                              05970059
059800         INTO XSRD007-RECORD                                      05980059
059900           AT END SET PS-END-OF-XS-FILE TO TRUE                   05990059
060000           MOVE 9999 TO XS007-LOC-NBR                             06000059
060100     END-IF.                                                      06010059
060200     IF PS-NOT-END-OF-XS-FILE                                     06020059
060300        ADD +1 TO PV-XS-EXTR-REC-CNT                              06030059
060400     END-IF.                                                      06040059
060500                                                                  06050059
060600                                                                  06060059
060700******************************************************************06070059
060800* WRITE REPORT DETAIL LINE                                        06080059
060900******************************************************************06090059
061000 8000-WRITE-RPT-DETAIL-LINE.                                      06100059
061100                                                                  06110059
061200     WRITE XS-LOC-RPT-LINE FROM DL-DETAIL-LINE                    06120059
061300         AFTER ADVANCING PV-ADVANCE.                              06130059
061400     ADD PV-ADVANCE TO PV-LINE-CNT.                               06140059
061500     MOVE +1        TO PV-ADVANCE.                                06150059
061600     ADD +1 TO PV-NBR-ERRORS.                                     06160059
061700                                                                  06170059
061800                                                                  06180059
061900******************************************************************06190059
062000* PRINT THE KOHLS STANDARD REPORT HEADING.                        06200059
062100******************************************************************06210059
062200 8100-WRITE-STD-RPT-HEADING.                                      06220059
062300                                                                  06230059
062400     ADD 1            TO PV-PAGE-CNT.                             06240059
062500     MOVE PV-PAGE-CNT TO DP200O-PAGE-NUMBER.                      06250059
062600     WRITE XS-LOC-RPT-LINE FROM DP200O-STANDRD-HEADER-200-COLS    06260059
062700         AFTER ADVANCING PAGE.                                    06270059
062800     MOVE +1          TO PV-LINE-CNT.                             06280059
062900                                                                  06290059
063000                                                                  06300059
063100******************************************************************06310059
063200* REPORT HEADING                                                  06320059
063300******************************************************************06330059
063400 8200-WRITE-REPORT-HEADING.                                       06340059
063500                                                                  06350059
063600     WRITE XS-LOC-RPT-LINE FROM RPT-REPORT-HEADING                06360059
063700         AFTER ADVANCING 2 LINES.                                 06370059
063800     ADD +2 TO PV-LINE-CNT.                                       06380059
063900                                                                  06390059
064000                                                                  06400059
064100******************************************************************06410059
064200* REPORT COLUMN HEADING                                           06420059
064300******************************************************************06430059
064400 8300-WRITE-COLUMN-HEADING.                                       06440059
064500                                                                  06450059
064600     WRITE XS-LOC-RPT-LINE FROM RPT-COL-HEADING-1                 06460059
064700         AFTER ADVANCING 2 LINES.                                 06470059
064800     WRITE XS-LOC-RPT-LINE FROM RPT-COL-HEADING-2                 06480059
064900         AFTER ADVANCING 1 LINES.                                 06490059
065000     WRITE XS-LOC-RPT-LINE FROM RPT-COL-HEADING-3                 06500059
065100         AFTER ADVANCING 1 LINES.                                 06510059
065200     ADD  +4 TO PV-LINE-CNT.                                      06520059
065300     MOVE +2 TO PV-ADVANCE.                                       06530059
065400                                                                  06540059
065500                                                                  06550059
065600******************************************************************06560059
065700* REPORT TOTAL LINE                                               06570059
065800******************************************************************06580059
065900 8400-WRITE-TOTAL-LINE.                                           06590059
066000                                                                  06600059
066100     MOVE PV-NBR-ERRORS TO RPT-NBR-ERRORS.                        06610059
066200                                                                  06620059
066300     IF PV-LINE-CNT > PC-MAX-DTL-LINES                            06630059
066400         PERFORM 8100-WRITE-STD-RPT-HEADING                       06640059
066500         PERFORM 8200-WRITE-REPORT-HEADING                        06650059
066600         PERFORM 8300-WRITE-COLUMN-HEADING                        06660059
066700     END-IF.                                                      06670059
066800                                                                  06680059
066900     WRITE XS-LOC-RPT-LINE FROM RPT-TOTAL-LINE                    06690059
067000         AFTER ADVANCING 2 LINES.                                 06700059
067100     ADD +2 TO PV-LINE-CNT.                                       06710059
067200                                                                  06720059
067300     WRITE XS-LOC-RPT-LINE FROM RPT-END-OF-REPORT-LINE            06730059
067400         AFTER ADVANCING 2 LINES.                                 06740059
067500                                                                  06750059
067600*----------------------------------------------------------------*06760059
067700*  FORMAT A DB2 ERROR MESSAGE                                    *06770059
067800*----------------------------------------------------------------*06780059
067900 9900-PROCESS-DB2-ERROR.                                          06790059
068000                                                                  06800059
068100     DISPLAY '***************************************************'06810059
068200     DISPLAY '**  ERROR     **'.                                  06820059
068300     DISPLAY '**  PROGRAM   **  = ' PC-PGM-NAME.                  06830059
068400     DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH.                 06840059
068500     DISPLAY '**  MESSAGE   **  = ' PV-MESSAGE.                   06850059
068600*                                                                 06860059
068700*  ROUTINE TO CONVERT THE SQLCA INTO A READABLE FORMAT, USING     06870059
068800*  THE CALLED MODULE DSNTIAR.                                     06880059
068900*                                                                 06890059
069000     COPY DPPD004.                                                06900059
069100                                                                  06910059
069200     MOVE +4013 TO ABEND-CODE.                                    06920059
069300     CALL 'ILBOABN0' USING ABEND-CODE.                            06930059
