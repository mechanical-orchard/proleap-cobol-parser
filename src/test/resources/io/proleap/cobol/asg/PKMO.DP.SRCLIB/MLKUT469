       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.              MLKUT469.                                       
       INSTALLATION.            KOHLS DEPARTMENT STORES.                        
       DATE-WRITTEN.            11/27/00.                                       
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      *    DEPARTMENT MERCHANDISE LEDGER EXTRACT - ECOMMERCE.                   
      *                                                                         
      * THIS PROGRAM EXTRACTS FROM THE MONTH-TO-DATE DEPARTMENT LEDGER          
      * TABLE AND THE WEEKLY DEPARTMENT LEDGER TABLE.  THE DATA IS FOR          
      * THE COMBINED LEDGER REPORT WHICH SHOWS A COMPARISON OF THE              
      * CURRENT YEAR AND LAST YEAR DATA.                                        
      *                                                                         
      * DATA IS EXTRACTED FOR THE OPEN FISCAL YEAR FROM THE BEGINNING OF        
      * THE YEAR THROUGH THE MAX POSTING MONTH. IF THE MAX POSTING DATE         
      * HAS CROSSED OVER INTO THE NEXT FISCAL YEAR, THE EXTRACT ENDS            
      * WITH THE POSTING FISCAL MONTH INSTEAD OF THE MAX POSTING MONTH.         
      *                                                                         
      * A CONTROL CARD MAY BE USED TO OVERRIDE THE USE OF THE MAX               
      * POSTING DATE. IF A CONTROL CARD IS USED, DATA WILL BE EXTRACTED         
      * FROM THE BEGINNING OF THE FISCAL YEAR (INTO WHICH THE CONTROL           
      * CARD DATE FALLS) THROUGH THE CONTROL CARD DATE.                         
      *                                                                         
      * THE EXTRACT IS DRIVEN BY A CURSOR OF DEPARTMENTS THAT WERE              
      * ACTIVE ON MBS FOR MERCHANDISE LEDGER AS OF THE END OF THE               
      * OPEN FISCAL MONTH PLUS ANY OTHER DEPARTMENTS THAT HAVE                  
      * ACTIVITY ON TMNDPTC CURING THE PERIOD BEING REPORTED.                   
      *                                                                         
      * FOR EACH DEPARTMENT, THE PROGRAM  EXTRACTS THE MONTHLY DATA             
      * FROM THIS YEAR AND LAST YEAR.  IT ALSO EXTRACTS WEEKLY DATA             
      * FROM THIS YEAR AND LAST YEAR FOR THE CURRENT FISCAL MONTH.              
      *                                                                         
      *PROJECT HISTORY:                                                         
31355 * RWJ 11/27/00 -E-COMMERCE COMBINED LEDGER REPORT MODIFICATION.           
31355 *                                                                         
394548* RWJ 03/05/01 - DECIMAL-DIVIDE EXCEPTION IN MLKUT444....                 
394548*                                                                         
      * AML 11/01/01 -CHANGED THE WEEKLY PLANNING PRORATION PERCENT             
      *              CALCULATION.  THE WEEKLY PLAN PURCHASE ADJ                 
      *              DOLLARS WERE REMOVED FROM THE CALCULATION.                 
      *              THE PERCENTAGE IS THEN USED TO CALCULATE THE               
      *              OTB WEEKLY RECEIPT DOLLARS.                                
436795* RWJ 12/10/01 - DECIMAL-DIVIDE EXCEPTION IN MLKUT469....                 
W26603******************************************************************        
W26603* CHG ID   DATE        DESCRIPTION                               *        
W26603* ------   ----------  ----------------------------------------- *        
W26603* W26603   03-18-2004  STORE EXPANSION.  EXPANDED LRECL OF INP02 *        
W26603*                      OUT02, OUT03, OUT04 FILE BECAUSE OF       *        
W26603*                      CHANGES TO MLRD122, MLRD128, MLRD133,     *        
W26603*                      MLRD140.  EXPANDED WORKING STORAGE        *        
W26603*                      VARIABLES.  REPLACED TSTR000 WITH         *        
W26603*                      XMT_LOC.  ADDED 'WITH UR' ON DB2 SELECTS. *        
W26603*                      AT THIS TIME WE ARE NOT                   *        
W26603*                      EXPANDING THE REPORT FIELDS.              *        
W26603*                      - RONNA MCDONALD                          *        
W26006* W26006   02-24-2005  REMOVE REFERENCES TO OBSOLETE STORE TABLE.*        
W26006*                      - ERIN SEARL                              *        
      **************************************************************************
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT CONTROL-CARD-FILE                                             
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT MN-ONORD-PDUE-FILE                                            
               ASSIGN TO INP02.                                                 
                                                                                
           SELECT LEDGER-EXTRACT-DATE-FILE                                      
               ASSIGN TO OUT01.                                                 
                                                                                
           SELECT LEDGER-EXTRACT-WK-FILE                                        
               ASSIGN TO OUT02.                                                 
                                                                                
           SELECT LEDGER-EXTRACT-MN-FILE                                        
               ASSIGN TO OUT03.                                                 
                                                                                
           SELECT LEDGER-EXTRACT-EOW-FILE                                       
               ASSIGN TO OUT04.                                                 
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  CONTROL-CARD-FILE                                                    
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  CONTROL-CARD-RECORD              PIC X(80).                          
                                                                                
       FD  MN-ONORD-PDUE-FILE                                                   
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
W26603*01  MN-ONORD-PDUE-RECORD             PIC X(43).                          
W26603 01  MN-ONORD-PDUE-RECORD             PIC X(80).                          
                                                                                
       FD  LEDGER-EXTRACT-DATE-FILE                                             
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  LEDGER-EXTRACT-DATE-RECORD       PIC X(80).                          
                                                                                
       FD  LEDGER-EXTRACT-WK-FILE                                               
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
W26603*01  LEDGER-EXTRACT-WK-RECORD       PIC X(1449).                          
W26603 01  LEDGER-EXTRACT-WK-RECORD       PIC X(1638).                          
                                                                                
       FD  LEDGER-EXTRACT-MN-FILE                                               
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
W26603*01  LEDGER-EXTRACT-MN-RECORD       PIC X(4432).                          
W26603 01  LEDGER-EXTRACT-MN-RECORD       PIC X(5131).                          
                                                                                
       FD  LEDGER-EXTRACT-EOW-FILE                                              
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
W26603*01  LEDGER-EXTRACT-EOW-RECORD        PIC X(964).                         
W26603 01  LEDGER-EXTRACT-EOW-RECORD        PIC X(1123).                        
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
      ****************************************************************          
      * RECORD LAYOUT FOR LEDGER EXTRACT DATE RECORD                            
      ****************************************************************          
                                                                                
           COPY MLRD131.                                                        
                                                                                
      ****************************************************************          
      * RECORD LAYOUT FOR LEDGER EXTRACT WEEKLY RECORD                          
      ****************************************************************          
                                                                                
21517      COPY MLRD122.                                                        
                                                                                
      ****************************************************************          
      * RECORD LAYOUT FOR LEDGER EXTRACT MONTHLY RECORD                         
      ****************************************************************          
                                                                                
21517      COPY MLRD128.                                                        
                                                                                
      ****************************************************************          
      * RECORD LAYOUT FOR LEDGER EXTRACT WEEKLY ENDING INVENTORY                
      * FOR THE ENTIRE YEAR                                                     
      ****************************************************************          
                                                                                
           COPY MLRD140.                                                        
                                                                                
      ****************************************************************          
      * RECORD LAYOUT FOR INPUT MONTHLY ON  ORDER AND PAST DUE                  
      ****************************************************************          
                                                                                
           COPY MLRD133.                                                        
                                                                                
      ****************************************************************          
      *  ERROR MESSAGE AREA FOR DB2                                             
      ****************************************************************          
                                                                                
           COPY DPWS004.                                                        
                                                                                
      ****************************************************************          
      * RECORD LAYOUT FOR CONTROL CARD FILE.                                    
      ****************************************************************          
                                                                                
       01  CC-CONTROL-CARD.                                                     
           05  CC-EXTRACT-DTE               PIC X(10).                          
           05  FILLER                       PIC X(70).                          
                                                                                
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-OPERCO-NBR                PIC X(02)  VALUE '03'.              
           05  PC-GT-SYMBOL                 PIC X(01)  VALUE '>'.               
           05  PC-Y                         PIC X(01)  VALUE 'Y'.               
           05  PC-N                         PIC X(01)  VALUE 'N'.               
           05  PC-THOUSAND                  PIC S9(04)V99  COMP-3               
                                                           VALUE +1000.         
           05  PC-ONE                       PIC S9(04) COMP SYNC                
                                                       VALUE 1.                 
           05  PC-TWO                       PIC S9(04) COMP SYNC                
                                                       VALUE 2.                 
           05  PC-SIX                       PIC S9(04) COMP SYNC                
                                                       VALUE 6.                 
           05  PC-SEVEN                     PIC S9(04) COMP SYNC                
                                                       VALUE 7.                 
           05  PC-TWELVE                    PIC S9(04) COMP SYNC                
                                                       VALUE 12.                
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-END-OF-CONTROL-CARDS-SW   PIC X      VALUE 'N'.               
               88  PS-END-OF-CONTROL-CARDS             VALUE 'Y'.               
           05  PS-END-OF-MN-INP03-SW        PIC X      VALUE 'N'.               
               88  PS-END-OF-MN-INP03                  VALUE 'Y'.               
           05  PS-DATE-FOUND-SW             PIC X      VALUE 'N'.               
               88  PS-DATE-FOUND                       VALUE 'Y'.               
               88  PS-DATE-NOT-FOUND                   VALUE 'N'.               
           05  PS-DATES-FOUND-SW            PIC X      VALUE 'N'.               
               88  PS-DATES-FOUND                      VALUE 'Y'.               
               88  PS-DATES-NOT-FOUND                  VALUE 'N'.               
           05  PS-END-OF-DEPT-NBR-CSR-SW    PIC X      VALUE 'N'.               
               88  PS-END-OF-DEPT-NBR-CSR              VALUE 'Y'.               
           05  PS-END-OF-TMNDPTC-CSR-SW     PIC X      VALUE 'N'.               
               88  PS-END-OF-TMNDPTC-CSR               VALUE 'Y'.               
               88  PS-NOT-END-OF-TMNDPTC-CSR           VALUE 'N'.               
           05  PS-END-OF-TMNDPLN-CSR-SW     PIC X      VALUE 'N'.               
               88  PS-END-OF-TMNDPLN-CSR               VALUE 'Y'.               
               88  PS-NOT-END-OF-TMNDPLN-CSR           VALUE 'N'.               
           05  PS-END-OF-TMNDOTB-CSR-SW     PIC X      VALUE 'N'.               
               88  PS-END-OF-TMNDOTB-CSR               VALUE 'Y'.               
               88  PS-NOT-END-OF-TMNDOTB-CSR           VALUE 'N'.               
           05  PS-END-OF-LMNDPTC-CSR-SW     PIC X      VALUE 'N'.               
               88  PS-END-OF-LMNDPTC-CSR               VALUE 'Y'.               
               88  PS-NOT-END-OF-LMNDPTC-CSR           VALUE 'N'.               
           05  PS-END-OF-TYWKDPT-CSR-SW     PIC X      VALUE 'N'.               
               88  PS-END-OF-TYWKDPT-CSR               VALUE 'Y'.               
               88  PS-NOT-END-OF-TYWKDPT-CSR           VALUE 'N'.               
           05  PS-END-OF-TYWKDPLN-CSR-SW    PIC X      VALUE 'N'.               
               88  PS-END-OF-TYWKDPLN-CSR              VALUE 'Y'.               
               88  PS-NOT-END-OF-TYWKDPLN-CSR          VALUE 'N'.               
           05  PS-END-OF-LYWKDPTC-CSR-SW    PIC X      VALUE 'N'.               
               88  PS-END-OF-LYWKDPTC-CSR              VALUE 'Y'.               
               88  PS-NOT-END-OF-LYWKDPTC-CSR          VALUE 'N'.               
           05  PS-END-OF-LY-DPT-WK-SUP-CSR-SW PIC X    VALUE 'N'.               
               88  PS-END-OF-LY-DPT-WK-SUP-CSR         VALUE 'Y'.               
               88  PS-NOT-END-LY-DPT-WK-SUP-CSR        VALUE 'N'.               
           05  PS-END-OF-PL-DPT-WK-SUP-CSR-SW PIC X    VALUE 'N'.               
               88  PS-END-OF-PL-DPT-WK-SUP-CSR         VALUE 'Y'.               
               88  PS-NOT-END-PL-DPT-WK-SUP-CSR        VALUE 'N'.               
           05  PS-END-OF-FC-DPT-MN-SUP-CSR-SW PIC X    VALUE 'N'.               
               88  PS-END-OF-FC-DPT-MN-SUP-CSR         VALUE 'Y'.               
               88  PS-NOT-END-FC-DPT-MN-SUP-CSR        VALUE 'N'.               
           05  PS-END-OF-FSCL-MN-CSR-SW PIC X          VALUE 'N'.               
               88  PS-END-OF-FSCL-MN-CSR               VALUE 'Y'.               
               88  PS-NOT-END-OF-FSCL-MN-CSR           VALUE 'N'.               
           05  PS-END-OF-WKDPTC-INV-CSR-SW PIC X       VALUE 'N'.               
               88  PS-END-OF-WKDPTC-INV-CSR            VALUE 'Y'.               
               88  PS-NOT-END-OF-WKDPTC-INV-CSR        VALUE 'N'.               
           05  PS-END-OF-WKDPLN-INV-CSR-SW PIC X       VALUE 'N'.               
               88  PS-END-OF-WKDPLN-INV-CSR            VALUE 'Y'.               
               88  PS-NOT-END-OF-WKDPLN-INV-CSR        VALUE 'N'.               
           05  PS-MBS-INFO-FOUND-SW         PIC X      VALUE 'N'.               
               88  PS-MBS-INFO-FOUND                   VALUE 'Y'.               
               88  PS-MBS-INFO-NOT-FOUND               VALUE 'N'.               
           05  PS-PLAN-INFO-FOUND-SW        PIC X      VALUE 'N'.               
               88  PS-PLAN-INFO-FOUND                  VALUE 'Y'.               
               88  PS-PLAN-INFO-NOT-FOUND              VALUE 'N'.               
           05  PV-SAVE-PLAN-INFO-SW         PIC X      VALUE 'N'.               
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-TY-FSCL-YR-NBR            PIC X(04)  VALUE SPACE.             
           05  PV-TY-FSCL-MN-NBR            PIC S9(04) COMP SYNC                
                                                       VALUE ZERO.              
           05  PV-TY-FSCL-MN-BEG-DTE        PIC X(10)  VALUE SPACE.             
           05  PV-TY-FSCL-MN-END-DTE        PIC X(10)  VALUE SPACE.             
           05  PV-TY-FSCL-YR-END-DTE        PIC X(10)  VALUE SPACE.             
           05  PV-TY-FSCL-YR-BEG-DTE        PIC X(10)  VALUE SPACE.             
           05  PV-BEG-DTE                   PIC X(10)  VALUE SPACE.             
           05  PV-END-DTE                   PIC X(10)  VALUE SPACE.             
           05  PV-LY-FSCL-MN-NBR            PIC S9(04) COMP SYNC                
                                                       VALUE ZERO.              
           05  PV-LY-FSCL-MN-BEG-DTE        PIC X(10)  VALUE SPACE.             
           05  PV-LY-FSCL-MN-END-DTE        PIC X(10)  VALUE SPACE.             
           05  PV-LY-FSCL-YR-BEG-DTE        PIC X(10)  VALUE SPACE.             
           05  PV-LY-FSCL-YR-END-DTE        PIC X(10)  VALUE SPACE.             
           05  PV-PL-FSCL-YR-END-DTE        PIC X(10)  VALUE SPACE.             
           05  PV-TY-LM-FSCL-MN-NBR         PIC X(02)  VALUE SPACE.             
           05  PV-LY-LM-FSCL-MN-NBR         PIC X(02)  VALUE SPACE.             
           05  PV-WK-IN-MN-NBR              PIC 9(01)  VALUE ZERO.              
           05  PV-WKS-SUP                   PIC S9(04) COMP SYNC                
                                                       VALUE ZERO.              
           05  PV-WK                        PIC S9(04) COMP SYNC                
                                                       VALUE ZERO.              
           05  PV-WK-NUM                    PIC S9(04) COMP SYNC                
                                                       VALUE ZERO.              
W26603*    05  PV-END-INV-RTL-AMT           PIC S9(11)V99  COMP-3               
W26603     05  PV-END-INV-RTL-AMT           PIC S9(13)V99  COMP-3               
                                                       VALUE ZERO.              
           05  PV-PROOTB-SLS-RTL-PCT        PIC S9(04)V9999  COMP-3             
                                                       VALUE ZERO.              
           05  PV-PROOTB-MKDN-RTL-PCT       PIC S9(04)V9999  COMP-3             
                                                       VALUE ZERO.              
           05  PV-PROOTB-SHNK-RTL-PCT       PIC S9(04)V9999  COMP-3             
                                                       VALUE ZERO.              
           05  PV-PROOTB-PCT                PIC S9(04)V9999  COMP-3             
                                                       VALUE ZERO.              
W26603*    05  PV-WORK-AMOUNT               PIC S9(11)V99  COMP-3               
W26603     05  PV-WORK-AMOUNT               PIC S9(13)V99  COMP-3               
394548                                                 VALUE ZERO.              
           05  PV-LY-LAST-WK-IN-MN          PIC S9(04) COMP-3                   
                                                       VALUE ZERO.              
           05  PV-TY-LAST-WK-IN-MN          PIC S9(04) COMP-3                   
                                                       VALUE ZERO.              
           05  PV-COMP-MN      OCCURS 12.                                       
               10 PV-COMP-PROC-MN           PIC X(10).                          
                                                                                
           05  PV-COMP-PROC-MN-DB2          PIC X(10).                          
                                                                                
           05  PV-FSCL-MN-END  OCCURS 12.                                       
               10 PV-FSCL-MN-END-DTE        PIC X(10).                          
                                                                                
           05  PV-DB2-OPER-ATTEMPTED        PIC X(30).                          
           05  PV-PARAGRAPH-NAME            PIC X(30).                          
                                                                                
           05  PV-NULL-INDICATOR            PIC S9(04) COMP SYNC                
                                                       VALUE ZERO.              
       01  PV-HOLD-RTL-AMTS-TABLE.                                              
           05  PV-WK-SHNK-RTL-AMT OCCURS 5.                                     
W26603         10  PV-WK-TY-SHNK-RTL-AMT    PIC S9(11)V99  COMP-3.              
W26603         10  PV-WK-FC-SHNK-RTL-AMT    PIC S9(11)V99  COMP-3.              
W26603         10  PV-WK-PL-SHNK-RTL-AMT    PIC S9(11)V99  COMP-3.              
W26603         10  PV-WK-LY-SHNK-RTL-AMT    PIC S9(11)V99  COMP-3.              
           05  PV-MN-SHNK-RTL-AMT OCCURS 12.                                    
W26603         10  PV-MN-FC-SHNK-RTL-AMT    PIC S9(11)V99  COMP-3.              
W26603         10  PV-MN-PL-SHNK-RTL-AMT    PIC S9(11)V99  COMP-3.              
                                                                                
       01  TY-LY-VARIABLES.                                                     
           05  TY-FSCL-YR-NBR               PIC X(04)  VALUE SPACE.             
           05  TY-FSCL-MN-NBR               PIC X(02)  VALUE SPACE.             
           05  TY-FSCL-MN-BEG-DTE           PIC X(10)  VALUE SPACE.             
           05  TY-FSCL-MN-END-DTE           PIC X(10)  VALUE SPACE.             
           05  LY-FSCL-MN-NBR               PIC X(02)  VALUE SPACE.             
           05  LY-FSCL-MN-BEG-DTE           PIC X(10)  VALUE SPACE.             
           05  LY-FSCL-MN-END-DTE           PIC X(10)  VALUE SPACE.             
           05  TY-FSCL-YR-END-DTE           PIC X(10)  VALUE SPACE.             
           05  TY-FSCL-YR-BEG-DTE           PIC X(10)  VALUE SPACE.             
           05  LY-FSCL-YR-BEG-DTE           PIC X(10)  VALUE SPACE.             
           05  LY-FSCL-YR-END-DTE           PIC X(10)  VALUE SPACE.             
           05  PL-FSCL-YR-END-DTE           PIC X(10)  VALUE SPACE.             
           05  TY-LM-FSCL-MN-NBR            PIC X(02)  VALUE SPACE.             
           05  LY-LM-FSCL-MN-NBR            PIC X(02)  VALUE SPACE.             
           05  LY-LAST-WK-IN-MN             PIC X(01)  VALUE SPACE.             
           05  TY-LAST-WK-IN-MN             PIC X(01)  VALUE SPACE.             
                                                                                
       01  SS-SUBSCRIPTS.                                                       
           05  SS-FSCL-MN                   PIC S9(04) COMP SYNC                
                                                       VALUE ZERO.              
           05  SS-FSCL-WK                   PIC S9(04) COMP SYNC                
                                                       VALUE ZERO.              
           05  SS-NEXT-WK                   PIC S9(04) COMP SYNC                
                                                       VALUE ZERO.              
       01  ABEND-CODE                       PIC S9(04) COMP                     
                                                       VALUE ZERO.              
                                                                                
      ****************************************************************          
      * LEDGER MONTH-TO-DATE DEPARTMENT TABLE                                   
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE TMNDPTC                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * LEDGER WEEKLY DEPARTMENT TABLE                                          
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE TWKDPTC                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * LEDGER WEEKLY SUB CLASS TABLE                                           
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE TWKSCLS                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * LEDGER MONTHLY DEPARTMENT STORE TABLE                                   
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE TMNDPTS                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * LEDGER WEEKLY DEPARTMENT PLAN TABLE                                     
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
21517          INCLUDE TWKDPLN                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * LEDGER MONTHLY DEPARTMENT PLAN TABLE                                    
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
21517          INCLUDE TMNDPLN                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * LEDGER MONTHLY DEPARTMENT OPEN TO BUY TABLE                             
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE TMNDOTB                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * MERCHANDISE LEDGER CONTROL TABLE                                        
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE TMLCNTL                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * DATE ATTRIBUTE TABLE                                                    
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE TDTATTR                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * MBS MERCHANDISE AREA TABLE                                              
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE TMDSEAR                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * STORE TABLE                                                             
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
W26603         INCLUDE XMT00001                                                 
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * MBS APPLICATION AVAILABILITY TABLE                                      
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE TAPLAVL                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      *  COMMUNICATION AREAS FOR DB2                                            
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      *  DEPARTMENT NUMBER CURSOR                                               
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
              DECLARE DEPT-NBR-CSR CURSOR FOR                                   
                  SELECT                                                        
                      DEPT_NBR                                                  
                  FROM                                                          
                      TMDSEAR A                                                 
                     ,TAPLAVL B                                                 
                                                                                
                  WHERE A.OPERCO_NBR     = :PC-OPERCO-NBR                       
                    AND A.MDSELV_CDE     = 'DPT'                                
                    AND :PV-TY-FSCL-MN-END-DTE                                  
                         BETWEEN A.STRT_DTE                                     
                             AND A.END_DTE                                      
                    AND A.MDSEAR_DKEY    =  B.MDSEAR_DKEY                       
                    AND B.APLSYS_CDE     = 'ML'                                 
                    AND :PV-TY-FSCL-MN-END-DTE                                  
                         BETWEEN B.MDSEAR_STRT_DTE                              
                             AND B.MDSEAR_END_DTE                               
                                                                                
              UNION                                                             
                                                                                
                  SELECT DISTINCT                                               
                      DEPT_NBR                                                  
                  FROM                                                          
                      TMNDPTC                                                   
                  WHERE FSCL_MN_END_DTE                                         
                            BETWEEN :PV-LY-FSCL-YR-END-DTE                      
                                AND :PV-TY-FSCL-MN-END-DTE                      
                    AND CHNL_CDE = 'V'                                          
              ORDER BY DEPT_NBR                                                 
                                                                                
              FOR FETCH ONLY                                                    
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      *  LEDGER THIS YEAR MONTH CURSOR                                          
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
              DECLARE TMNDPTC-CSR CURSOR FOR                                    
                  SELECT                                                        
                       A.FSCL_MN_NBR                                            
                      ,A.FSCL_MN_END_DTE                                        
                      ,A.SLS_RTL_AMT                                            
                      ,A.MKDN_PLU_RTL_AMT                                       
                      ,A.MKDN_RGST_RTL_AMT                                      
                      ,A.MKDN_UMTCH_RTL_AMT                                     
                      ,A.MKDN_BYR_RTL_AMT                                       
                      ,A.MKDN_STR_RTL_AMT                                       
                      ,A.MKUP_RTL_AMT                                           
                      ,A.XFER_IN_RTL_AMT                                        
                      ,A.XFER_OUT_RTL_AMT                                       
                      ,A.RCPT_RTL_AMT                                           
                      ,A.RCPT_NET_COST_AMT                                      
                      ,A.PADJ_RTL_AMT                                           
                      ,A.PADJ_NET_COST_AMT                                      
                      ,A.INV_ADJ_RTL_AMT                                        
                      ,A.SHNK_RTL_AMT                                           
                      ,A.END_INV_RTL_AMT                                        
                      ,A.END_INV_COST_AMT                                       
                      ,A.SLS_COST_AMT                                           
                      ,A.GRO_MRGN_AMT                                           
                    FROM TMNDPTC A                                              
                    WHERE A.FSCL_MN_END_DTE                                     
                            BETWEEN   :PV-LY-FSCL-YR-END-DTE                    
                                AND   :PV-TY-FSCL-MN-END-DTE                    
                     AND A.DEPT_NBR = :MDSEAR-DEPT-NBR                          
                     AND A.CHNL_CDE = 'V'                                       
                  FOR FETCH ONLY                                                
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
                                                                                
      ****************************************************************          
      *  LEDGER THIS YEAR MONTHLY PLAN CURSOR                                   
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
              DECLARE TMNDPLN-CSR CURSOR FOR                                    
                  SELECT                                                        
                       B.FSCL_MN_NBR                                            
                      ,B.FSCL_MN_END_DTE                                        
                      ,B.SLS_RTL_AMT                                            
                      ,B.MKDN_RTL_AMT                                           
                      ,B.RCPT_RTL_AMT                                           
                      ,B.SHNK_RTL_AMT                                           
                      ,B.END_INV_RTL_AMT                                        
                      ,B.MKUP_PCT                                               
                      ,B.GRO_MRGN_AMT                                           
                      ,B.PADJ_RTL_AMT                                           
                      ,B.BEG_INV_RTL_AMT                                        
                      ,B.CMPR_STR_SLS_AMT                                       
                      ,B.CUM_MKUP_PCT                                           
                      ,B.PADJ_NET_COST_AMT                                      
                      ,B.RCPT_NET_COST_AMT                                      
21517                 ,B.CMPR_END_INV_AMT                                       
                    FROM TMNDPLN B                                              
                    WHERE B.FSCL_MN_END_DTE                                     
                            BETWEEN   :PV-TY-FSCL-YR-BEG-DTE                    
                                AND   :PV-TY-FSCL-YR-END-DTE                    
                     AND B.DEPT_NBR = :MDSEAR-DEPT-NBR                          
31355                AND B.CHNL_CDE = 'V'                                       
                  FOR FETCH ONLY                                                
W26603        WITH UR                                                           
                                                                                
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      *  LEDGER THIS YEAR MONTHLY OTB CURSOR                                    
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
              DECLARE TMNDOTB-CSR CURSOR FOR                                    
                  SELECT                                                        
                       C.FSCL_MN_NBR                                            
                      ,C.FSCL_MN_END_DTE                                        
                      ,C.SLS_RTL_AMT                                            
                      ,C.MKDN_RTL_AMT                                           
                      ,C.RCPT_RTL_AMT                                           
                      ,C.SHNK_RTL_AMT                                           
                      ,C.END_INV_RTL_AMT                                        
                      ,C.TOT_ORD_RTL_AMT                                        
                      ,C.APP_ORD_RTL_AMT                                        
                      ,C.GRO_MRGN_AMT                                           
                      ,C.RCPT_NET_COST_AMT                                      
                      ,C.PADJ_NET_COST_AMT                                      
                      ,C.PADJ_RTL_AMT                                           
                      ,C.BEG_INV_RTL_AMT                                        
                    FROM TMNDOTB C                                              
                    WHERE C.FSCL_MN_END_DTE                                     
                            BETWEEN   :PV-TY-FSCL-YR-BEG-DTE                    
                                AND   :PV-TY-FSCL-YR-END-DTE                    
                     AND C.DEPT_NBR = :MDSEAR-DEPT-NBR                          
31355                AND C.CHNL_CDE = 'V'                                       
                  FOR FETCH ONLY                                                
W26603        WITH UR                                                           
                                                                                
           END-EXEC.                                                            
                                                                                
                                                                                
      ****************************************************************          
      *  LEDGER LAST YEAR MONTH CURSOR                                          
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
              DECLARE LMNDPTC-CSR CURSOR FOR                                    
                  SELECT                                                        
                      FSCL_MN_NBR                                               
                     ,FSCL_MN_END_DTE                                           
                     ,SLS_RTL_AMT                                               
                     ,MKDN_PLU_RTL_AMT                                          
                     ,MKDN_RGST_RTL_AMT                                         
                     ,MKDN_UMTCH_RTL_AMT                                        
                     ,MKDN_BYR_RTL_AMT                                          
                     ,MKDN_STR_RTL_AMT                                          
                     ,MKUP_RTL_AMT                                              
                     ,XFER_IN_RTL_AMT                                           
                     ,XFER_OUT_RTL_AMT                                          
                     ,RCPT_RTL_AMT                                              
                     ,RCPT_NET_COST_AMT                                         
                     ,PADJ_RTL_AMT                                              
                     ,PADJ_NET_COST_AMT                                         
                     ,INV_ADJ_RTL_AMT                                           
                     ,SHNK_RTL_AMT                                              
                     ,END_INV_RTL_AMT                                           
                     ,END_INV_COST_AMT                                          
                     ,GRO_MRGN_AMT                                              
                  FROM                                                          
                      TMNDPTC                                                   
                  WHERE FSCL_MN_END_DTE                                         
                           BETWEEN :PV-PL-FSCL-YR-END-DTE                       
                               AND :PV-LY-FSCL-YR-END-DTE                       
                    AND DEPT_NBR = :MDSEAR-DEPT-NBR                             
                    AND CHNL_CDE = 'V'                                          
                  FOR FETCH ONLY                                                
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
                                                                                
      ****************************************************************          
      *  LEDGER THIS YEAR WEEK CURSOR                                           
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
              DECLARE TYWKDPT-CSR CURSOR FOR                                    
                  SELECT                                                        
                      A.FSCL_WK_NBR                                             
                     ,A.FSCL_WK_END_DTE                                         
                     ,A.SLS_RTL_AMT                                             
                     ,A.MKDN_PLU_RTL_AMT                                        
                     ,A.MKDN_RGST_RTL_AMT                                       
                     ,A.MKDN_UMTCH_RTL_AMT                                      
                     ,A.MKDN_BYR_RTL_AMT                                        
                     ,A.MKDN_STR_RTL_AMT                                        
                     ,A.MKUP_RTL_AMT                                            
                     ,A.XFER_IN_RTL_AMT                                         
                     ,A.XFER_OUT_RTL_AMT                                        
                     ,A.RCPT_RTL_AMT                                            
                     ,A.RCPT_NET_COST_AMT                                       
                     ,A.PADJ_RTL_AMT                                            
                     ,A.PADJ_NET_COST_AMT                                       
                     ,A.INV_ADJ_RTL_AMT                                         
                     ,A.SHNK_RTL_AMT                                            
                     ,A.END_INV_RTL_AMT                                         
                     ,A.END_INV_COST_AMT                                        
                     ,A.GRO_MRGN_AMT                                            
                  FROM TWKDPTC A                                                
                  WHERE A.FSCL_WK_END_DTE                                       
                           BETWEEN :PV-TY-FSCL-MN-BEG-DTE                       
                               AND :PV-TY-FSCL-MN-END-DTE                       
                    AND A.DEPT_NBR = :MDSEAR-DEPT-NBR                           
                    AND A.CHNL_CDE = 'V'                                        
                  FOR FETCH ONLY                                                
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      *  LEDGER THIS YEAR WEEKLY PLAN CURSOR                                    
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
              DECLARE TYWKDPLN-CSR CURSOR FOR                                   
                  SELECT                                                        
                      B.FSCL_WK_NBR                                             
                     ,B.FSCL_WK_END_DTE                                         
                     ,B.SLS_RTL_AMT                                             
                     ,B.MKDN_RTL_AMT                                            
                     ,B.RCPT_RTL_AMT                                            
                     ,B.SHNK_RTL_AMT                                            
                     ,B.END_INV_RTL_AMT                                         
                     ,B.PADJ_RTL_AMT                                            
                  FROM TWKDPLN B                                                
                  WHERE B.FSCL_WK_END_DTE                                       
                           BETWEEN :PV-BEG-DTE                                  
                               AND :PV-END-DTE                                  
                    AND B.DEPT_NBR = :MDSEAR-DEPT-NBR                           
                    AND B.CHNL_CDE = 'V'                                        
                  FOR FETCH ONLY                                                
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
                                                                                
      ****************************************************************          
      *  LEDGER LAST YEAR WEEK CURSOR                                           
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
              DECLARE LYWKDPTC-CSR CURSOR FOR                                   
                  SELECT                                                        
                      FSCL_WK_NBR                                               
                     ,FSCL_WK_END_DTE                                           
                     ,SLS_RTL_AMT                                               
                     ,MKDN_PLU_RTL_AMT                                          
                     ,MKDN_RGST_RTL_AMT                                         
                     ,MKDN_UMTCH_RTL_AMT                                        
                     ,MKDN_BYR_RTL_AMT                                          
                     ,MKDN_STR_RTL_AMT                                          
                     ,MKUP_RTL_AMT                                              
                     ,XFER_IN_RTL_AMT                                           
                     ,XFER_OUT_RTL_AMT                                          
                     ,RCPT_RTL_AMT                                              
                     ,RCPT_NET_COST_AMT                                         
                     ,PADJ_RTL_AMT                                              
                     ,PADJ_NET_COST_AMT                                         
                     ,INV_ADJ_RTL_AMT                                           
                     ,SHNK_RTL_AMT                                              
                     ,END_INV_RTL_AMT                                           
                     ,END_INV_COST_AMT                                          
                     ,GRO_MRGN_AMT                                              
                  FROM                                                          
                      TWKDPTC                                                   
                  WHERE FSCL_WK_END_DTE                                         
                           BETWEEN :PV-LY-FSCL-MN-BEG-DTE                       
                               AND :PV-LY-FSCL-MN-END-DTE                       
                    AND DEPT_NBR = :MDSEAR-DEPT-NBR                             
                    AND CHNL_CDE = 'V'                                          
                  FOR FETCH ONLY                                                
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      *  LAST YEAR WEEKS OF SUPPLY CURSOR                                       
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               DECLARE LY-DPT-WK-SUP-CSR CURSOR FOR                             
                   SELECT FSCL_WK_END_DTE                                       
                         ,SLS_RTL_AMT                                           
                         ,MKDN_PLU_RTL_AMT                                      
                         ,MKDN_RGST_RTL_AMT                                     
                         ,MKDN_UMTCH_RTL_AMT                                    
                         ,MKDN_BYR_RTL_AMT                                      
                         ,MKDN_STR_RTL_AMT                                      
                         ,SHNK_RTL_AMT                                          
                   FROM                                                         
                        TWKDPTC                                                 
                   WHERE FSCL_WK_END_DTE > :PV-LY-FSCL-MN-END-DTE               
                     AND DEPT_NBR        = :MDSEAR-DEPT-NBR                     
                     AND CHNL_CDE        = 'V'                                  
                   ORDER BY FSCL_WK_END_DTE                                     
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      *  PLANNING WEEKS OF SUPPLY CURSOR                                        
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               DECLARE PL-DPT-WK-SUP-CSR CURSOR FOR                             
                   SELECT FSCL_WK_END_DTE                                       
                         ,SLS_RTL_AMT                                           
                         ,MKDN_RTL_AMT                                          
                         ,SHNK_RTL_AMT                                          
                   FROM                                                         
                        TWKDPLN                                                 
                   WHERE FSCL_WK_END_DTE > :PV-TY-FSCL-MN-END-DTE               
                     AND DEPT_NBR        = :MDSEAR-DEPT-NBR                     
31355                AND CHNL_CDE        = 'V'                                  
                   ORDER BY FSCL_WK_END_DTE                                     
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      *  FORECAST MONTHS OF SUPPLY CURSOR                                       
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               DECLARE FC-DPT-MN-SUP-CSR CURSOR FOR                             
                   SELECT FSCL_MN_END_DTE                                       
                         ,SLS_RTL_AMT                                           
                         ,MKDN_RTL_AMT                                          
                         ,SHNK_RTL_AMT                                          
                   FROM                                                         
                        TMNDOTB                                                 
                   WHERE FSCL_MN_END_DTE > :PV-TY-FSCL-MN-END-DTE               
                     AND DEPT_NBR        = :MDSEAR-DEPT-NBR                     
31355                AND CHNL_CDE        = 'V'                                  
                   ORDER BY FSCL_MN_END_DTE                                     
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      *  MONTH END DATES CURSOR FOR AN ENTIRE YEAR                              
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               DECLARE FSCL-MN-CSR CURSOR FOR                                   
                   SELECT DISTINCT                                              
                        FSCL_MN_NBR                                             
                       ,FSCL_MN_END_DTE                                         
                   FROM                                                         
                        TDTATTR                                                 
                   WHERE KY_DTE BETWEEN :PV-TY-FSCL-YR-BEG-DTE                  
                                    AND :PV-TY-FSCL-YR-END-DTE                  
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      *  CURSOR TO GET AN ENTIRE YEAR OF WEEKLY ENDING INVENTORY                
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               DECLARE WKDPTC-INV-CSR CURSOR FOR                                
                   SELECT FSCL_WK_NBR                                           
                         ,END_INV_RTL_AMT                                       
                   FROM                                                         
                        TWKDPTC                                                 
                   WHERE FSCL_WK_END_DTE                                        
                            BETWEEN :PV-BEG-DTE                                 
                                AND :PV-END-DTE                                 
                     AND DEPT_NBR = :MDSEAR-DEPT-NBR                            
                     AND CHNL_CDE = 'V'                                         
                   FOR FETCH ONLY                                               
W26603        WITH UR                                                           
                                                                                
           END-EXEC.                                                            
                                                                                
                                                                                
      ****************************************************************          
      *  CURSOR TO GET THIS YEAR'S PLANNING WEEKLY ENDING INVENTORY             
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               DECLARE WKDPLN-INV-CSR CURSOR FOR                                
                   SELECT FSCL_WK_NBR                                           
                         ,END_INV_RTL_AMT                                       
                   FROM                                                         
                        TWKDPLN                                                 
                   WHERE FSCL_WK_END_DTE                                        
                            BETWEEN :PV-TY-FSCL-YR-BEG-DTE                      
                                AND :PV-TY-FSCL-YR-END-DTE                      
                     AND DEPT_NBR = :MDSEAR-DEPT-NBR                            
31355                AND CHNL_CDE = 'V'                                         
                   FOR FETCH ONLY                                               
W26603        WITH UR                                                           
                                                                                
           END-EXEC.                                                            
                                                                                
                                                                                
       LINKAGE SECTION.                                                         
                                                                                
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
                                                                                
       1000-MAIN-MODULE.                                                        
                                                                                
           OPEN INPUT  CONTROL-CARD-FILE                                        
                       MN-ONORD-PDUE-FILE                                       
                OUTPUT LEDGER-EXTRACT-DATE-FILE                                 
                       LEDGER-EXTRACT-WK-FILE                                   
                       LEDGER-EXTRACT-MN-FILE                                   
                       LEDGER-EXTRACT-EOW-FILE.                                 
                                                                                
           PERFORM 1100-SET-EXTRACT-DTE.                                        
                                                                                
           PERFORM 1400-BUILD-FSCL-MN-TBL.                                      
                                                                                
           PERFORM 7050-READ-MN-ONORD-PDUE-FILE.                                
                                                                                
           PERFORM 8100-OPEN-DEPT-NBR-CSR.                                      
                                                                                
           PERFORM 8110-FETCH-DEPT-NBR-CSR.                                     
                                                                                
           PERFORM 2000-EXTRACT-DEPT-DATA                                       
               UNTIL PS-END-OF-DEPT-NBR-CSR.                                    
                                                                                
           PERFORM 8150-CLOSE-DEPT-NBR-CSR.                                     
                                                                                
           CLOSE CONTROL-CARD-FILE                                              
                       MN-ONORD-PDUE-FILE                                       
                 LEDGER-EXTRACT-DATE-FILE                                       
                       LEDGER-EXTRACT-WK-FILE                                   
                       LEDGER-EXTRACT-MN-FILE                                   
                       LEDGER-EXTRACT-EOW-FILE.                                 
                                                                                
           STOP RUN.                                                            
                                                                                
                                                                                
       1100-SET-EXTRACT-DTE.                                                    
                                                                                
           PERFORM 7000-READ-CONTROL-CARD-FILE.                                 
                                                                                
           IF PS-END-OF-CONTROL-CARDS                                           
           OR CC-EXTRACT-DTE = SPACE                                            
               PERFORM 1300-USE-ML-CNTL-DTES                                    
           ELSE                                                                 
               DISPLAY '** INPUT CONTROL CARD: ' CC-CONTROL-CARD                
               PERFORM 1200-USE-CONTROL-CARD-DTE                                
           END-IF.                                                              
                                                                                
           DISPLAY '** SELECTED EXTRACT MONTH END DATE: '                       
                                PV-TY-FSCL-MN-END-DTE.                          
           DISPLAY '** SELECTED EXTRACT WEEK END DATE:  '                       
                                ML131-EXTRACT-DTE.                              
                                                                                
           PERFORM  7100-WRITE-LEDGER-EXTRACT-DATE.                             
                                                                                
                                                                                
                                                                                
       1200-USE-CONTROL-CARD-DTE.                                               
                                                                                
           DISPLAY '** USING CONTROL CARD DATE FOR EXTRACT DATE.'               
                                                                                
           MOVE CC-EXTRACT-DTE TO DTATTR-KY-DTE.                                
                                                                                
           PERFORM 8050-GET-DATE-ATTRIBUTES.                                    
                                                                                
           IF  PS-DATES-FOUND                                                   
           AND DTATTR-KY-DTE = DTATTR-FSCL-WK-END-DTE                           
               MOVE DTATTR-FSCL-WK-END-DTE TO ML131-EXTRACT-DTE                 
               MOVE TY-FSCL-MN-NBR         TO ML131-EXTRACT-MN-NBR              
               MOVE TY-FSCL-YR-NBR         TO PV-TY-FSCL-YR-NBR                 
               MOVE TY-FSCL-MN-NBR         TO PV-TY-FSCL-MN-NBR                 
               MOVE TY-FSCL-MN-BEG-DTE     TO PV-TY-FSCL-MN-BEG-DTE             
               MOVE TY-FSCL-MN-END-DTE     TO PV-TY-FSCL-MN-END-DTE             
               MOVE LY-FSCL-MN-NBR         TO PV-LY-FSCL-MN-NBR                 
               MOVE LY-FSCL-MN-BEG-DTE     TO PV-LY-FSCL-MN-BEG-DTE             
               MOVE LY-FSCL-MN-END-DTE     TO PV-LY-FSCL-MN-END-DTE             
               MOVE TY-FSCL-YR-END-DTE     TO PV-TY-FSCL-YR-END-DTE             
               MOVE TY-FSCL-YR-BEG-DTE     TO PV-TY-FSCL-YR-BEG-DTE             
               MOVE LY-FSCL-YR-BEG-DTE     TO PV-LY-FSCL-YR-BEG-DTE             
               MOVE LY-FSCL-YR-END-DTE     TO PV-LY-FSCL-YR-END-DTE             
               MOVE PL-FSCL-YR-END-DTE     TO PV-PL-FSCL-YR-END-DTE             
               MOVE TY-LM-FSCL-MN-NBR      TO PV-TY-LM-FSCL-MN-NBR              
               MOVE LY-LM-FSCL-MN-NBR      TO PV-LY-LM-FSCL-MN-NBR              
               MOVE LY-LAST-WK-IN-MN       TO PV-LY-LAST-WK-IN-MN               
               MOVE TY-LAST-WK-IN-MN       TO PV-TY-LAST-WK-IN-MN               
           ELSE                                                                 
               DISPLAY '** ABEND **'                                            
               DISPLAY '** PROGRAM MLKUT469 **'                                 
               DISPLAY '** PARAGRAPH 1200-USE-CONTROL-CARD-DTE'                 
               DISPLAY '** CONTROL CARD DATE NOT A VALID FISCAL'                
               DISPLAY '** WEEK-END DATE. '                                     
               MOVE +4003 TO ABEND-CODE                                         
               PERFORM 9999-ABEND                                               
           END-IF.                                                              
                                                                                
           PERFORM 8080-GET-WK-IN-MN-NBR.                                       
                                                                                
       1300-USE-ML-CNTL-DTES.                                                   
                                                                                
           PERFORM 8000-GET-ML-CNTL-DTES.                                       
                                                                                
           DISPLAY                                                              
            '** POSTING FISCAL WEEK DATE: ' MLCNTL-PSTG-FSCL-WK-DTE             
           DISPLAY                                                              
            '** MAX POSTING WEEK DATE: '    MLCNTL-MXPSTG-FSCL-WK-DTE.          
                                                                                
           MOVE MLCNTL-MXPSTG-FSCL-WK-DTE TO DTATTR-KY-DTE.                     
                                                                                
           PERFORM 8050-GET-DATE-ATTRIBUTES.                                    
                                                                                
           IF PS-DATES-NOT-FOUND                                                
               DISPLAY '** ABEND **'                                            
               DISPLAY '** PROGRAM MLKUT469 **'                                 
               DISPLAY '** PARAGRAPH 1200-USE-ML-CNTL-DTE'                      
               DISPLAY '** MAX POSTING DATE IS NOT A VALID DATE.'               
               MOVE +4008 TO ABEND-CODE                                         
               PERFORM 9999-ABEND                                               
           END-IF.                                                              
                                                                                
           MOVE DTATTR-FSCL-WK-END-DTE TO ML131-EXTRACT-DTE.                    
           MOVE TY-FSCL-MN-NBR         TO ML131-EXTRACT-MN-NBR.                 
           MOVE TY-FSCL-YR-NBR         TO PV-TY-FSCL-YR-NBR.                    
           MOVE TY-FSCL-MN-NBR         TO PV-TY-FSCL-MN-NBR.                    
           MOVE TY-FSCL-MN-BEG-DTE     TO PV-TY-FSCL-MN-BEG-DTE.                
           MOVE TY-FSCL-MN-END-DTE     TO PV-TY-FSCL-MN-END-DTE.                
           MOVE LY-FSCL-MN-NBR         TO PV-LY-FSCL-MN-NBR.                    
           MOVE LY-FSCL-MN-BEG-DTE     TO PV-LY-FSCL-MN-BEG-DTE.                
           MOVE LY-FSCL-MN-END-DTE     TO PV-LY-FSCL-MN-END-DTE.                
           MOVE TY-FSCL-YR-END-DTE     TO PV-TY-FSCL-YR-END-DTE.                
           MOVE TY-FSCL-YR-BEG-DTE     TO PV-TY-FSCL-YR-BEG-DTE.                
           MOVE LY-FSCL-YR-BEG-DTE     TO PV-LY-FSCL-YR-BEG-DTE.                
           MOVE LY-FSCL-YR-END-DTE     TO PV-LY-FSCL-YR-END-DTE.                
           MOVE PL-FSCL-YR-END-DTE     TO PV-PL-FSCL-YR-END-DTE.                
           MOVE TY-LM-FSCL-MN-NBR      TO PV-TY-LM-FSCL-MN-NBR.                 
           MOVE LY-LM-FSCL-MN-NBR      TO PV-LY-LM-FSCL-MN-NBR.                 
           MOVE LY-LAST-WK-IN-MN       TO PV-LY-LAST-WK-IN-MN.                  
           MOVE TY-LAST-WK-IN-MN       TO PV-TY-LAST-WK-IN-MN.                  
                                                                                
           MOVE MLCNTL-PSTG-FSCL-WK-DTE TO DTATTR-KY-DTE.                       
                                                                                
           PERFORM 8050-GET-DATE-ATTRIBUTES.                                    
                                                                                
           IF PS-DATES-NOT-FOUND                                                
               DISPLAY '** ABEND **'                                            
               DISPLAY '** PROGRAM MLKUT469 **'                                 
               DISPLAY '** PARAGRAPH 1200-USE-ML-CNTL-DTE'                      
               DISPLAY                                                          
               '** POSTING FISCAL WEEK DATE IS NOT A VALID DATE.'               
               MOVE +4008 TO ABEND-CODE                                         
               PERFORM 9999-ABEND                                               
           END-IF.                                                              
                                                                                
           IF TY-FSCL-YR-NBR NOT = PV-TY-FSCL-YR-NBR                            
              DISPLAY '** USING POSTING FISCAL MONTH FOR EXTRACT DATE.'         
              MOVE DTATTR-FSCL-WK-END-DTE TO ML131-EXTRACT-DTE                  
              MOVE TY-FSCL-MN-NBR         TO ML131-EXTRACT-MN-NBR               
              MOVE TY-FSCL-YR-NBR         TO PV-TY-FSCL-YR-NBR                  
              MOVE TY-FSCL-MN-NBR         TO PV-TY-FSCL-MN-NBR                  
              MOVE TY-FSCL-MN-BEG-DTE     TO PV-TY-FSCL-MN-BEG-DTE              
              MOVE TY-FSCL-MN-END-DTE     TO PV-TY-FSCL-MN-END-DTE              
              MOVE LY-FSCL-MN-NBR         TO PV-LY-FSCL-MN-NBR                  
              MOVE LY-FSCL-MN-BEG-DTE     TO PV-LY-FSCL-MN-BEG-DTE              
              MOVE LY-FSCL-MN-END-DTE     TO PV-LY-FSCL-MN-END-DTE              
              MOVE TY-FSCL-YR-END-DTE     TO PV-TY-FSCL-YR-END-DTE              
              MOVE TY-FSCL-YR-BEG-DTE     TO PV-TY-FSCL-YR-BEG-DTE              
              MOVE LY-FSCL-YR-BEG-DTE     TO PV-LY-FSCL-YR-BEG-DTE              
              MOVE LY-FSCL-YR-END-DTE     TO PV-LY-FSCL-YR-END-DTE              
              MOVE PL-FSCL-YR-END-DTE     TO PV-PL-FSCL-YR-END-DTE              
              MOVE TY-LM-FSCL-MN-NBR      TO PV-TY-LM-FSCL-MN-NBR               
              MOVE LY-LM-FSCL-MN-NBR      TO PV-LY-LM-FSCL-MN-NBR               
              MOVE LY-LAST-WK-IN-MN       TO PV-LY-LAST-WK-IN-MN                
              MOVE TY-LAST-WK-IN-MN       TO PV-TY-LAST-WK-IN-MN                
           ELSE                                                                 
               DISPLAY '** USING MAX POSTING MONTH FOR EXTRACT DATE.'           
           END-IF.                                                              
                                                                                
           PERFORM 8080-GET-WK-IN-MN-NBR.                                       
                                                                                
       1400-BUILD-FSCL-MN-TBL.                                                  
                                                                                
           SET PS-NOT-END-OF-FSCL-MN-CSR TO TRUE.                               
           PERFORM 8900-OPEN-FSCL-MN-CSR.                                       
                                                                                
           PERFORM 8910-FETCH-FSCL-MN-CSR.                                      
                                                                                
           PERFORM 1410-MOVE-FSCL-MN-TO-TBL                                     
               UNTIL PS-END-OF-FSCL-MN-CSR                                      
                                                                                
           PERFORM 8920-CLOSE-FSCL-MN-CSR.                                      
                                                                                
                                                                                
       1410-MOVE-FSCL-MN-TO-TBL.                                                
                                                                                
           MOVE DTATTR-FSCL-MN-NBR       TO  SS-FSCL-MN.                        
           MOVE DTATTR-FSCL-MN-END-DTE   TO                                     
                                       PV-FSCL-MN-END-DTE (SS-FSCL-MN).         
           PERFORM 8910-FETCH-FSCL-MN-CSR.                                      
                                                                                
                                                                                
       2000-EXTRACT-DEPT-DATA.                                                  
                                                                                
      ******************************************************************        
      *    PROCESS THE FOLLOWING:                                               
      *      THIS YEAR'S AND LAST YEAR'S MONTH DATA                             
      *      THIS YEAR'S AND LAST YEAR'S WEEK DATA                              
      ******************************************************************        
           INITIALIZE ML122-LEDGER-EXTRACT-WK-REC.                              
           INITIALIZE ML128-LEDGER-EXTRACT-MN-REC.                              
           INITIALIZE ML140-LEDGER-EXTRACT-EOW-REC.                             
           INITIALIZE PV-HOLD-RTL-AMTS-TABLE.                                   
                                                                                
21517      INITIALIZE DCLTWKDPLN.                                               
21517      INITIALIZE DCLTMNDPLN.                                               
           INITIALIZE DCLTMNDOTB.                                               
                                                                                
           PERFORM 2050-GET-MBS-INFO.                                           
                                                                                
           SET PS-NOT-END-OF-TMNDPTC-CSR TO TRUE.                               
           PERFORM 8200-OPEN-TMNDPTC-CSR.                                       
                                                                                
           PERFORM 8210-FETCH-TMNDPTC-CSR.                                      
                                                                                
           PERFORM 3000-EXTRACT-TY-MNS-FOR-DEPT                                 
               UNTIL PS-END-OF-TMNDPTC-CSR.                                     
                                                                                
           PERFORM 8250-CLOSE-TMNDPTC-CSR.                                      
                                                                                
           SET PS-NOT-END-OF-LMNDPTC-CSR TO TRUE.                               
           PERFORM 8300-OPEN-LMNDPTC-CSR.                                       
                                                                                
           PERFORM 8310-FETCH-LMNDPTC-CSR.                                      
                                                                                
           PERFORM 3100-EXTRACT-LY-MNS-FOR-DEPT                                 
               UNTIL PS-END-OF-LMNDPTC-CSR.                                     
                                                                                
           PERFORM 8350-CLOSE-LMNDPTC-CSR.                                      
                                                                                
           SET PS-NOT-END-OF-TYWKDPT-CSR TO TRUE.                               
           PERFORM 8400-OPEN-TYWKDPT-CSR.                                       
                                                                                
           PERFORM 8410-FETCH-TYWKDPT-CSR.                                      
                                                                                
           PERFORM 3200-EXTRACT-TY-WEEKS-FOR-DEPT                               
               UNTIL PS-END-OF-TYWKDPT-CSR.                                     
                                                                                
           PERFORM 8450-CLOSE-TYWKDPT-CSR.                                      
                                                                                
           SET PS-NOT-END-OF-LYWKDPTC-CSR TO TRUE.                              
           PERFORM 8500-OPEN-LYWKDPTC-CSR.                                      
                                                                                
           PERFORM 8510-FETCH-LYWKDPTC-CSR.                                     
                                                                                
           PERFORM 3300-EXTRACT-LY-WEEKS-FOR-DEPT                               
               UNTIL PS-END-OF-LYWKDPTC-CSR.                                    
                                                                                
           PERFORM 8550-CLOSE-LYWKDPTC-CSR.                                     
                                                                                
           SET PS-NOT-END-OF-TMNDPLN-CSR TO TRUE.                               
           PERFORM 8600-OPEN-TMNDPLN-CSR.                                       
                                                                                
           PERFORM 8610-FETCH-TMNDPLN-CSR.                                      
                                                                                
           PERFORM 3400-EXTRACT-TY-MNPLN-FOR-DEPT                               
               UNTIL PS-END-OF-TMNDPLN-CSR.                                     
                                                                                
           PERFORM 8620-CLOSE-TMNDPLN-CSR.                                      
                                                                                
           SET PS-NOT-END-OF-TMNDOTB-CSR TO TRUE.                               
           PERFORM 8630-OPEN-TMNDOTB-CSR.                                       
                                                                                
           PERFORM 8640-FETCH-TMNDOTB-CSR.                                      
                                                                                
           PERFORM 3500-EXTRACT-TY-MNOTB-FOR-DEPT                               
               UNTIL PS-END-OF-TMNDOTB-CSR.                                     
                                                                                
           PERFORM 8650-CLOSE-TMNDOTB-CSR.                                      
                                                                                
           SET PS-NOT-END-OF-TYWKDPLN-CSR TO TRUE.                              
           MOVE PV-TY-FSCL-MN-BEG-DTE TO PV-BEG-DTE.                            
           MOVE PV-TY-FSCL-MN-END-DTE TO PV-END-DTE.                            
           PERFORM 8660-OPEN-TWKDPLN-CSR.                                       
                                                                                
           PERFORM 8670-FETCH-TWKDPLN-CSR.                                      
                                                                                
           IF PS-END-OF-TYWKDPLN-CSR                                            
              MOVE PC-N TO PS-PLAN-INFO-FOUND-SW                                
           ELSE                                                                 
              MOVE PC-Y TO PS-PLAN-INFO-FOUND-SW.                               
                                                                                
           PERFORM 3600-EXTRACT-TY-WKPLN-FOR-DEPT                               
               UNTIL PS-END-OF-TYWKDPLN-CSR.                                    
                                                                                
           PERFORM 8680-CLOSE-TWKDPLN-CSR.                                      
                                                                                
      *    WEEKS SUPPLY                                                         
           MOVE 1 TO SS-FSCL-WK.                                                
           PERFORM 6100-GET-TY-WEEKS-SUPPLY UNTIL SS-FSCL-WK > 5.               
                                                                                
           MOVE 1 TO SS-FSCL-WK.                                                
           PERFORM 6200-GET-FC-WEEKS-SUPPLY UNTIL SS-FSCL-WK > 5.               
                                                                                
           MOVE 1 TO SS-FSCL-WK.                                                
           PERFORM 6300-GET-PL-WEEKS-SUPPLY UNTIL SS-FSCL-WK > 5.               
                                                                                
           MOVE 1 TO SS-FSCL-WK.                                                
           PERFORM 6400-GET-LY-WEEKS-SUPPLY UNTIL SS-FSCL-WK > 5.               
                                                                                
      *    FUTURE COMMITMENTS                                                   
           IF NOT PS-END-OF-MN-INP03                                            
               PERFORM 3700-GET-FUTURE-COMMITMENTS                              
               UNTIL ( ML133-DEPT-NBR > MDSEAR-DEPT-NBR OR                      
                       PS-END-OF-MN-INP03)                                      
           END-IF.                                                              
                                                                                
      *    THIS SECTION IS FOR THE                                              
      *    END OF WEEK INVENTORY FOR THE ENTIRE YEAR                            
      *    THIS IS USED FOR INVENTORY TURN                                      
21517      INITIALIZE DCLTWKDPLN.                                               
           INITIALIZE DCLTWKDPTC.                                               
                                                                                
      *    THIS YEAR WEEKLY ENDING INVENTORY                                    
           SET PS-NOT-END-OF-WKDPTC-INV-CSR TO TRUE.                            
           MOVE PV-TY-FSCL-YR-BEG-DTE      TO PV-BEG-DTE.                       
           MOVE PV-TY-FSCL-YR-END-DTE      TO PV-END-DTE.                       
           PERFORM 8930-OPEN-WKDPTC-INV-CSR.                                    
                                                                                
           PERFORM 8940-FETCH-WKDPTC-INV-CSR.                                   
                                                                                
           PERFORM 3800-TY-EXTRACT-WKDPTC-INV-CSR                               
               UNTIL PS-END-OF-WKDPTC-INV-CSR.                                  
                                                                                
           PERFORM 8950-CLOSE-WKDPTC-INV-CSR.                                   
                                                                                
      *    LAST YEAR WEEKLY ENDING INVENTORY                                    
           SET PS-NOT-END-OF-WKDPTC-INV-CSR TO TRUE.                            
           MOVE PV-LY-FSCL-YR-BEG-DTE      TO PV-BEG-DTE.                       
           MOVE PV-LY-FSCL-YR-END-DTE      TO PV-END-DTE.                       
           PERFORM 8930-OPEN-WKDPTC-INV-CSR.                                    
                                                                                
           PERFORM 8940-FETCH-WKDPTC-INV-CSR.                                   
                                                                                
           PERFORM 3850-LY-EXTRACT-WKDPTC-INV-CSR                               
               UNTIL PS-END-OF-WKDPTC-INV-CSR.                                  
                                                                                
           PERFORM 8950-CLOSE-WKDPTC-INV-CSR.                                   
                                                                                
      *    THIS YEAR PLANNING WEEKLY ENDING INVENTORY                           
           SET PS-NOT-END-OF-WKDPLN-INV-CSR TO TRUE.                            
           PERFORM 8960-OPEN-WKDPLN-INV-CSR.                                    
                                                                                
           PERFORM 8970-FETCH-WKDPLN-INV-CSR.                                   
                                                                                
           PERFORM 3900-EXTRACT-WKDPLN-INV-CSR                                  
               UNTIL PS-END-OF-WKDPLN-INV-CSR.                                  
                                                                                
           PERFORM 8980-CLOSE-WKDPLN-INV-CSR.                                   
                                                                                
                                                                                
                                                                                
           PERFORM 7200-WRITE-LEDGER-MN-EXTRACT.                                
           PERFORM 7300-WRITE-LEDGER-WK-EXTRACT.                                
           PERFORM 7400-WRITE-LEDGER-EOW-EXTRACT.                               
           PERFORM 8110-FETCH-DEPT-NBR-CSR.                                     
                                                                                
                                                                                
       2050-GET-MBS-INFO.                                                       
                                                                                
      *****************************************************************         
      * GET THE MBS INFO THAT WAS EFFECTIVE FOR THE MOST RECENT PERIOD          
      * BEING REPORTED. IF THE DEPARTMENT WAS NOT ACTIVE AT THAT TIME,          
      * GET THE MOST RECENT MBS INFO FOR THE DEPARTMENT.                        
      *****************************************************************         
                                                                                
           PERFORM 8060-GET-EFFECTIVE-MBS-INFO.                                 
                                                                                
           IF PS-MBS-INFO-NOT-FOUND                                             
               PERFORM 8070-GET-LATEST-MBS-INFO                                 
           END-IF.                                                              
                                                                                
           MOVE MDSEAR-DEPT-NBR     TO ML122-DEPT-NBR                           
                                       ML128-DEPT-NBR                           
                                       ML140-DEPT-NBR.                          
                                                                                
           IF PS-MBS-INFO-FOUND                                                 
               MOVE MDSEAR-GMA-NBR  TO ML122-GMA-NBR                            
                                       ML128-GMA-NBR                            
                                       ML140-GMA-NBR                            
               MOVE MDSEAR-DMA-NBR  TO ML122-DMA-NBR                            
                                       ML128-DMA-NBR                            
                                       ML140-DMA-NBR                            
               MOVE MDSEAR-BYR-NBR  TO ML122-BYR-NBR                            
                                       ML128-BYR-NBR                            
                                       ML140-BYR-NBR                            
           END-IF.                                                              
                                                                                
                                                                                
       3000-EXTRACT-TY-MNS-FOR-DEPT.                                            
                                                                                
      *****************************************************************         
      * MAP THIS YEAR, FORECAST, AND PLANNING MONTH DEPT DATA.                  
      * WHEN THE FISCAL MONTH END DATE IS THE SAME AS LAST YEARS FISCAL         
      * YEAR END DATE, MAP BEGINNING INVENTORY LEVELS, OTHERWISE MAP            
      * MONTHLY DATA.                                                           
      * ALSO MAP BEGINNING INVENTORY LEVELS FOR THE WEEKLY FILE.                
      *****************************************************************         
                                                                                
           IF MNDPTC-FSCL-MN-END-DTE = PV-LY-FSCL-YR-END-DTE                    
               MOVE MNDPTC-END-INV-COST-AMT                                     
                              TO ML128-TY-BEG-INV-COST-AMT                      
               MOVE MNDPTC-END-INV-RTL-AMT                                      
                              TO ML128-TY-BEG-INV-RTL-AMT                       
           ELSE                                                                 
      *        MONTHLY DATA                                                     
               MOVE MNDPTC-FSCL-MN-NBR                                          
                              TO SS-FSCL-MN                                     
               MOVE MNDPTC-FSCL-MN-END-DTE                                      
                              TO PV-COMP-PROC-MN            (SS-FSCL-MN)        
               MOVE MNDPTC-SLS-RTL-AMT                                          
                              TO ML128-TY-SLS-RTL-AMT       (SS-FSCL-MN)        
                                                                                
               COMPUTE ML128-TY-MKDN-RTL-AMT (SS-FSCL-MN)                       
                              = MNDPTC-MKDN-PLU-RTL-AMT                         
                              + MNDPTC-MKDN-RGST-RTL-AMT                        
                              + MNDPTC-MKDN-UMTCH-RTL-AMT                       
                              + MNDPTC-MKDN-BYR-RTL-AMT                         
                              + MNDPTC-MKDN-STR-RTL-AMT                         
               END-COMPUTE                                                      
                                                                                
               MOVE MNDPTC-MKUP-RTL-AMT                                         
                              TO ML128-TY-MKUP-RTL-AMT      (SS-FSCL-MN)        
               MOVE MNDPTC-XFER-IN-RTL-AMT                                      
                              TO ML128-TY-XFER-IN-RTL-AMT   (SS-FSCL-MN)        
               MOVE MNDPTC-XFER-OUT-RTL-AMT                                     
                              TO ML128-TY-XFER-OUT-RTL-AMT  (SS-FSCL-MN)        
               MOVE MNDPTC-RCPT-RTL-AMT                                         
                              TO ML128-TY-RCPT-RTL-AMT      (SS-FSCL-MN)        
               MOVE MNDPTC-RCPT-NET-COST-AMT                                    
                              TO ML128-TY-RCPT-NET-COST-AMT (SS-FSCL-MN)        
               MOVE MNDPTC-PADJ-RTL-AMT                                         
                              TO ML128-TY-PADJ-RTL-AMT      (SS-FSCL-MN)        
               MOVE MNDPTC-PADJ-NET-COST-AMT                                    
                              TO ML128-TY-PADJ-NET-COST-AMT (SS-FSCL-MN)        
               MOVE MNDPTC-INV-ADJ-RTL-AMT                                      
                              TO ML128-TY-INV-ADJ-RTL-AMT   (SS-FSCL-MN)        
               MOVE MNDPTC-END-INV-RTL-AMT                                      
                              TO ML128-TY-END-INV-RTL-AMT   (SS-FSCL-MN)        
               MOVE MNDPTC-END-INV-COST-AMT                                     
                              TO ML128-TY-END-INV-COST-AMT  (SS-FSCL-MN)        
               MOVE MNDPTC-SLS-COST-AMT                                         
                              TO ML128-TY-SLS-COST-AMT      (SS-FSCL-MN)        
               MOVE MNDPTC-GRO-MRGN-AMT                                         
                              TO ML128-TY-GRO-MRGN-AMT      (SS-FSCL-MN)        
                                                                                
      *        MONTHLY COMP INVENTORY DATA                                      
               MOVE PV-COMP-PROC-MN (SS-FSCL-MN)                                
                              TO PV-COMP-PROC-MN-DB2                            
               PERFORM 8220-SELECT-MN-COMP-INV                                  
               MOVE MNDPTS-END-INV-RTL-AMT                                      
                              TO ML128-TY-COMP-INV-AMT      (SS-FSCL-MN)        
                                                                                
      *        MONTHLY COMP SALES DATA FOR THIS YEAR                            
               PERFORM 8225-SELECT-MN-COMP-SLS                                  
               MOVE MNDPTS-SLS-RTL-AMT                                          
                              TO ML128-TY-COMP-SLS-RTL-AMT  (SS-FSCL-MN)        
                                                                                
      *        SEASON COMP INVENTORY DATA                                       
               IF (SS-FSCL-MN = PV-TY-FSCL-MN-NBR) OR                           
                  (SS-FSCL-MN = 6)                                              
                   PERFORM 8230-SELECT-SEAS-COMP-INV                            
                   IF SS-FSCL-MN <= 6                                           
                       MOVE MNDPTS-END-INV-RTL-AMT                              
                              TO ML128-TY-SEAS-COMP-INV-AMT (1)                 
                   END-IF                                                       
                   IF SS-FSCL-MN > 6                                            
                       MOVE MNDPTS-END-INV-RTL-AMT                              
                              TO ML128-TY-SEAS-COMP-INV-AMT (2)                 
                   END-IF                                                       
               END-IF                                                           
                                                                                
      *        YTD COMP INVENTORY DATA                                          
               IF (SS-FSCL-MN = PV-TY-FSCL-MN-NBR)                              
                   PERFORM 8240-SELECT-YTD-COMP-INV                             
                   MOVE MNDPTS-END-INV-RTL-AMT                                  
                              TO ML128-TY-YTD-COMP-INV-AMT                      
               END-IF                                                           
                                                                                
           END-IF.                                                              
                                                                                
           IF MNDPTC-FSCL-MN-END-DTE = PV-LY-FSCL-YR-END-DTE AND                
              PV-TY-FSCL-MN-NBR     = 1                                         
               MOVE MNDPTC-END-INV-COST-AMT                                     
                              TO ML122-TY-BEG-INV-COST-AMT                      
               MOVE MNDPTC-END-INV-RTL-AMT                                      
                              TO ML122-TY-BEG-INV-RTL-AMT.                      
                                                                                
           IF MNDPTC-FSCL-MN-NBR = PV-TY-LM-FSCL-MN-NBR AND                     
              PV-TY-FSCL-MN-NBR > 1                                             
               MOVE MNDPTC-END-INV-COST-AMT                                     
                              TO ML122-TY-BEG-INV-COST-AMT                      
               MOVE MNDPTC-END-INV-RTL-AMT                                      
                              TO ML122-TY-BEG-INV-RTL-AMT.                      
                                                                                
           PERFORM 8210-FETCH-TMNDPTC-CSR.                                      
                                                                                
                                                                                
       3100-EXTRACT-LY-MNS-FOR-DEPT.                                            
                                                                                
      *****************************************************************         
      * MAP LAST YEAR MONTH DEPT DATA.  WHEN THE FISCAL MONTH END DATE          
      * IS THE SAME AS PREVIOUS FISCAL YEAR END DATE, MAP BEGINNING             
      * INVENTORY LEVELS, OTHERWISE MAP MONTHLY DATA                            
      *****************************************************************         
                                                                                
           IF MNDPTC-FSCL-MN-END-DTE = PV-PL-FSCL-YR-END-DTE                    
               MOVE MNDPTC-END-INV-COST-AMT                                     
                              TO ML128-LY-BEG-INV-COST-AMT                      
               MOVE MNDPTC-END-INV-RTL-AMT                                      
                              TO ML128-LY-BEG-INV-RTL-AMT                       
           ELSE                                                                 
               MOVE MNDPTC-FSCL-MN-NBR                                          
                              TO SS-FSCL-MN                                     
               MOVE MNDPTC-SLS-RTL-AMT                                          
                              TO ML128-LY-SLS-RTL-AMT       (SS-FSCL-MN)        
                                                                                
               COMPUTE ML128-LY-MKDN-RTL-AMT (SS-FSCL-MN)                       
                              = MNDPTC-MKDN-PLU-RTL-AMT                         
                              + MNDPTC-MKDN-RGST-RTL-AMT                        
                              + MNDPTC-MKDN-UMTCH-RTL-AMT                       
                              + MNDPTC-MKDN-BYR-RTL-AMT                         
                              + MNDPTC-MKDN-STR-RTL-AMT                         
               END-COMPUTE                                                      
                                                                                
               MOVE MNDPTC-MKUP-RTL-AMT                                         
                              TO ML128-LY-MKUP-RTL-AMT      (SS-FSCL-MN)        
               MOVE MNDPTC-XFER-IN-RTL-AMT                                      
                              TO ML128-LY-XFER-IN-RTL-AMT   (SS-FSCL-MN)        
               MOVE MNDPTC-XFER-OUT-RTL-AMT                                     
                              TO ML128-LY-XFER-OUT-RTL-AMT  (SS-FSCL-MN)        
               MOVE MNDPTC-RCPT-RTL-AMT                                         
                              TO ML128-LY-RCPT-RTL-AMT      (SS-FSCL-MN)        
               MOVE MNDPTC-RCPT-NET-COST-AMT                                    
                              TO ML128-LY-RCPT-NET-COST-AMT (SS-FSCL-MN)        
               MOVE MNDPTC-PADJ-RTL-AMT                                         
                              TO ML128-LY-PADJ-RTL-AMT      (SS-FSCL-MN)        
               MOVE MNDPTC-PADJ-NET-COST-AMT                                    
                              TO ML128-LY-PADJ-NET-COST-AMT (SS-FSCL-MN)        
               MOVE MNDPTC-INV-ADJ-RTL-AMT                                      
                              TO ML128-LY-INV-ADJ-RTL-AMT   (SS-FSCL-MN)        
               MOVE MNDPTC-END-INV-RTL-AMT                                      
                              TO ML128-LY-END-INV-RTL-AMT   (SS-FSCL-MN)        
               MOVE MNDPTC-END-INV-COST-AMT                                     
                              TO ML128-LY-END-INV-COST-AMT  (SS-FSCL-MN)        
               MOVE MNDPTC-GRO-MRGN-AMT                                         
                              TO ML128-LY-GRO-MRGN-AMT      (SS-FSCL-MN)        
                                                                                
      *        MONTHLY COMP INVENTORY DATA                                      
               IF PV-COMP-PROC-MN (SS-FSCL-MN) > ' '                            
                   MOVE PV-COMP-PROC-MN (SS-FSCL-MN)                            
                                TO PV-COMP-PROC-MN-DB2                          
               ELSE                                                             
                   MOVE PV-FSCL-MN-END-DTE (SS-FSCL-MN)                         
                                TO PV-COMP-PROC-MN-DB2                          
               END-IF                                                           
                                                                                
               PERFORM 8220-SELECT-MN-COMP-INV                                  
               MOVE MNDPTS-END-INV-RTL-AMT                                      
                              TO ML128-LY-COMP-INV-AMT (SS-FSCL-MN)             
                                                                                
      *        MONTHLY COMP SALES DATA FOR LAST YEAR                            
               PERFORM 8225-SELECT-MN-COMP-SLS                                  
               MOVE MNDPTS-SLS-RTL-AMT                                          
                              TO ML128-LY-COMP-SLS-RTL-AMT  (SS-FSCL-MN)        
                                                                                
      *        SEASON COMP INVENTORY DATA                                       
               IF (SS-FSCL-MN = PC-TWELVE) OR                                   
                  (SS-FSCL-MN = PC-SIX)                                         
                   PERFORM 8230-SELECT-SEAS-COMP-INV                            
                   IF SS-FSCL-MN = PC-SIX                                       
                       MOVE MNDPTS-END-INV-RTL-AMT                              
                              TO ML128-LY-SEAS-COMP-INV-AMT (1)                 
                   END-IF                                                       
                   IF SS-FSCL-MN = PC-TWELVE                                    
                       MOVE MNDPTS-END-INV-RTL-AMT                              
                              TO ML128-LY-SEAS-COMP-INV-AMT (2)                 
                   END-IF                                                       
               END-IF                                                           
                                                                                
      *        YTD COMP INVENTORY DATA                                          
               IF (SS-FSCL-MN = PC-TWELVE)                                      
                   PERFORM 8240-SELECT-YTD-COMP-INV                             
                       MOVE MNDPTS-END-INV-RTL-AMT                              
                              TO ML128-LY-YTD-COMP-INV-AMT                      
               END-IF                                                           
                                                                                
           END-IF.                                                              
                                                                                
           IF MNDPTC-FSCL-MN-END-DTE = PV-PL-FSCL-YR-END-DTE AND                
              PV-LY-FSCL-MN-NBR     = 1                                         
               MOVE MNDPTC-END-INV-COST-AMT                                     
                                TO ML122-LY-BEG-INV-COST-AMT                    
               MOVE MNDPTC-END-INV-RTL-AMT                                      
                                TO ML122-LY-BEG-INV-RTL-AMT.                    
                                                                                
           IF MNDPTC-FSCL-MN-NBR = PV-LY-LM-FSCL-MN-NBR AND                     
              PV-LY-FSCL-MN-NBR  > 1                                            
               MOVE MNDPTC-END-INV-COST-AMT                                     
                                TO ML122-LY-BEG-INV-COST-AMT                    
               MOVE MNDPTC-END-INV-RTL-AMT                                      
                                TO ML122-LY-BEG-INV-RTL-AMT.                    
                                                                                
           PERFORM 8310-FETCH-LMNDPTC-CSR.                                      
                                                                                
                                                                                
       3200-EXTRACT-TY-WEEKS-FOR-DEPT.                                          
                                                                                
           MOVE WKDPTC-FSCL-WK-END-DTE                                          
                            TO DTATTR-KY-DTE.                                   
           PERFORM 8430-SELECT-WK-IN-MN.                                        
                                                                                
           MOVE DTATTR-WK-IN-MN-NBR                                             
                            TO SS-FSCL-WK.                                      
           MOVE PV-TY-FSCL-MN-NBR                                               
                            TO SS-FSCL-MN.                                      
           MOVE WKDPTC-SLS-RTL-AMT                                              
                            TO ML122-TY-SLS-RTL-AMT       (SS-FSCL-WK).         
                                                                                
           COMPUTE ML122-TY-MKDN-RTL-AMT (SS-FSCL-WK)                           
                              = WKDPTC-MKDN-PLU-RTL-AMT                         
                              + WKDPTC-MKDN-RGST-RTL-AMT                        
                              + WKDPTC-MKDN-UMTCH-RTL-AMT                       
                              + WKDPTC-MKDN-BYR-RTL-AMT                         
                              + WKDPTC-MKDN-STR-RTL-AMT                         
           END-COMPUTE.                                                         
                                                                                
           MOVE WKDPTC-MKUP-RTL-AMT                                             
                            TO ML122-TY-MKUP-RTL-AMT      (SS-FSCL-WK).         
           MOVE WKDPTC-XFER-IN-RTL-AMT                                          
                            TO ML122-TY-XFER-IN-RTL-AMT   (SS-FSCL-WK).         
           MOVE WKDPTC-XFER-OUT-RTL-AMT                                         
                            TO ML122-TY-XFER-OUT-RTL-AMT  (SS-FSCL-WK).         
           MOVE WKDPTC-RCPT-RTL-AMT                                             
                            TO ML122-TY-RCPT-RTL-AMT      (SS-FSCL-WK).         
           MOVE WKDPTC-RCPT-NET-COST-AMT                                        
                            TO ML122-TY-RCPT-NET-COST-AMT (SS-FSCL-WK).         
           MOVE WKDPTC-PADJ-RTL-AMT                                             
                            TO ML122-TY-PADJ-RTL-AMT      (SS-FSCL-WK).         
           MOVE WKDPTC-PADJ-NET-COST-AMT                                        
                            TO ML122-TY-PADJ-NET-COST-AMT (SS-FSCL-WK).         
           MOVE WKDPTC-INV-ADJ-RTL-AMT                                          
                            TO ML122-TY-INV-ADJ-RTL-AMT   (SS-FSCL-WK).         
           MOVE WKDPTC-SHNK-RTL-AMT                                             
                            TO PV-WK-TY-SHNK-RTL-AMT      (SS-FSCL-WK).         
           MOVE WKDPTC-END-INV-RTL-AMT                                          
                            TO ML122-TY-END-INV-RTL-AMT   (SS-FSCL-WK).         
           MOVE WKDPTC-END-INV-COST-AMT                                         
                            TO ML122-TY-END-INV-COST-AMT  (SS-FSCL-WK).         
           MOVE WKDPTC-GRO-MRGN-AMT                                             
                            TO ML122-TY-GRO-MRGN-AMT      (SS-FSCL-WK).         
                                                                                
      *    WEEKLY ON ORDER RETAIL AMOUNT CALCS.                                 
           PERFORM 8440-SELECT-ONORD.                                           
           MOVE WKSCLS-ONORD-RTL-AMT                                            
                            TO ML122-TY-OPEN-ORDER-AMT (SS-FSCL-WK).            
                                                                                
      *    WEEKLY COMP SALES RETAIL AMOUNT                                      
           PERFORM 8420-SELECT-COMP-SLS.                                        
           MOVE WKSCLS-SLS-RTL-AMT                                              
                            TO ML122-TY-COMP-SLS-AMT      (SS-FSCL-WK).         
                                                                                
           PERFORM 8410-FETCH-TYWKDPT-CSR.                                      
                                                                                
                                                                                
       3300-EXTRACT-LY-WEEKS-FOR-DEPT.                                          
                                                                                
           MOVE WKDPTC-FSCL-WK-END-DTE                                          
                            TO DTATTR-KY-DTE.                                   
           PERFORM 8430-SELECT-WK-IN-MN.                                        
                                                                                
           MOVE DTATTR-WK-IN-MN-NBR                                             
                            TO SS-FSCL-WK.                                      
           MOVE WKDPTC-SLS-RTL-AMT                                              
                            TO ML122-LY-SLS-RTL-AMT       (SS-FSCL-WK).         
                                                                                
           COMPUTE ML122-LY-MKDN-RTL-AMT (SS-FSCL-WK)                           
                              = WKDPTC-MKDN-PLU-RTL-AMT                         
                              + WKDPTC-MKDN-RGST-RTL-AMT                        
                              + WKDPTC-MKDN-UMTCH-RTL-AMT                       
                              + WKDPTC-MKDN-BYR-RTL-AMT                         
                              + WKDPTC-MKDN-STR-RTL-AMT                         
           END-COMPUTE.                                                         
                                                                                
           MOVE WKDPTC-MKUP-RTL-AMT                                             
                            TO ML122-LY-MKUP-RTL-AMT      (SS-FSCL-WK).         
           MOVE WKDPTC-XFER-IN-RTL-AMT                                          
                            TO ML122-LY-XFER-IN-RTL-AMT   (SS-FSCL-WK).         
           MOVE WKDPTC-XFER-OUT-RTL-AMT                                         
                            TO ML122-LY-XFER-OUT-RTL-AMT  (SS-FSCL-WK).         
           MOVE WKDPTC-RCPT-RTL-AMT                                             
                            TO ML122-LY-RCPT-RTL-AMT      (SS-FSCL-WK).         
           MOVE WKDPTC-RCPT-NET-COST-AMT                                        
                            TO ML122-LY-RCPT-NET-COST-AMT (SS-FSCL-WK).         
           MOVE WKDPTC-PADJ-RTL-AMT                                             
                            TO ML122-LY-PADJ-RTL-AMT      (SS-FSCL-WK).         
           MOVE WKDPTC-PADJ-NET-COST-AMT                                        
                            TO ML122-LY-PADJ-NET-COST-AMT (SS-FSCL-WK).         
           MOVE WKDPTC-INV-ADJ-RTL-AMT                                          
                            TO ML122-LY-INV-ADJ-RTL-AMT   (SS-FSCL-WK).         
           MOVE WKDPTC-SHNK-RTL-AMT                                             
                            TO PV-WK-LY-SHNK-RTL-AMT      (SS-FSCL-WK).         
           MOVE WKDPTC-END-INV-RTL-AMT                                          
                            TO ML122-LY-END-INV-RTL-AMT   (SS-FSCL-WK).         
           MOVE WKDPTC-END-INV-COST-AMT                                         
                            TO ML122-LY-END-INV-COST-AMT  (SS-FSCL-WK).         
           MOVE WKDPTC-GRO-MRGN-AMT                                             
                            TO ML122-LY-GRO-MRGN-AMT      (SS-FSCL-WK).         
                                                                                
      *    WEEKLY COMP SALES RETAIL AMOUNT                                      
           PERFORM 8420-SELECT-COMP-SLS.                                        
           MOVE WKSCLS-SLS-RTL-AMT                                              
                            TO ML122-LY-COMP-SLS-AMT      (SS-FSCL-WK).         
           PERFORM 8510-FETCH-LYWKDPTC-CSR.                                     
                                                                                
                                                                                
       3400-EXTRACT-TY-MNPLN-FOR-DEPT.                                          
                                                                                
      *****************************************************************         
      * MAP THIS YEAR MONTHLY PLANNING DEPT DATA.                               
      *****************************************************************         
                                                                                
           MOVE MNDPLN-FSCL-MN-NBR                                              
                          TO SS-FSCL-MN.                                        
           MOVE MNDPLN-SLS-RTL-AMT                                              
                      TO ML128-PL-SLS-RTL-AMT       (SS-FSCL-MN).               
           MOVE MNDPLN-MKDN-RTL-AMT                                             
                      TO ML128-PL-MKDN-RTL-AMT      (SS-FSCL-MN).               
           MOVE MNDPLN-RCPT-RTL-AMT                                             
                      TO ML128-PL-RCPT-RTL-AMT      (SS-FSCL-MN).               
           MOVE MNDPLN-SHNK-RTL-AMT                                             
                      TO PV-MN-PL-SHNK-RTL-AMT      (SS-FSCL-MN).               
           MOVE MNDPLN-END-INV-RTL-AMT                                          
                      TO ML128-PL-END-INV-RTL-AMT   (SS-FSCL-MN).               
           MOVE MNDPLN-MKUP-PCT                                                 
                      TO ML128-PL-MKUP-RTL-PCT      (SS-FSCL-MN).               
           MOVE MNDPLN-GRO-MRGN-AMT                                             
                      TO ML128-PL-GRO-MRGN-AMT      (SS-FSCL-MN).               
           MOVE MNDPLN-PADJ-RTL-AMT                                             
                      TO ML128-PL-PADJ-RTL-AMT      (SS-FSCL-MN).               
           MOVE MNDPLN-CMPR-STR-SLS-AMT                                         
                      TO ML128-PL-COMP-SLS-RTL-AMT  (SS-FSCL-MN).               
           MOVE MNDPLN-RCPT-RTL-AMT                                             
                      TO ML128-PL-RCPT-RTL-AMT      (SS-FSCL-MN).               
      *                                                                         
           MOVE MNDPLN-BEG-INV-RTL-AMT                                          
                      TO ML128-PL-BOM-RTL-AMT       (SS-FSCL-MN).               
           MOVE MNDPLN-PADJ-NET-COST-AMT                                        
                      TO ML128-PL-PADJ-NET-COST-AMT (SS-FSCL-MN).               
           MOVE MNDPLN-RCPT-NET-COST-AMT                                        
                      TO ML128-PL-RCPT-NET-COST-AMT (SS-FSCL-MN).               
21517 *                                                                         
21517      MOVE MNDPLN-CMPR-END-INV-AMT                                         
21517                 TO ML128-PL-CMPR-END-INV-AMT  (SS-FSCL-MN).               
                                                                                
           IF SS-FSCL-MN = PC-ONE                                               
               MOVE MNDPLN-BEG-INV-RTL-AMT                                      
                          TO ML128-PL-BEG-INV-RTL-AMT   (PC-ONE)                
           END-IF.                                                              
                                                                                
           IF SS-FSCL-MN = PC-SIX                                               
               MOVE MNDPLN-CUM-MKUP-PCT                                         
                          TO ML128-PL-SEAS-CUM-MKUP-PCT (PC-ONE)                
           END-IF.                                                              
                                                                                
           IF SS-FSCL-MN = PC-SEVEN                                             
               MOVE MNDPLN-BEG-INV-RTL-AMT                                      
                          TO ML128-PL-BEG-INV-RTL-AMT   (PC-TWO)                
           END-IF.                                                              
                                                                                
           IF SS-FSCL-MN = PC-TWELVE                                            
               MOVE MNDPLN-CUM-MKUP-PCT                                         
                          TO ML128-PL-SEAS-CUM-MKUP-PCT (PC-TWO)                
           END-IF.                                                              
                                                                                
           PERFORM 8610-FETCH-TMNDPLN-CSR.                                      
                                                                                
       3500-EXTRACT-TY-MNOTB-FOR-DEPT.                                          
                                                                                
      *****************************************************************         
      * MAP THIS YEAR FORECAST DEPT DATA.                                       
      *****************************************************************         
                                                                                
           MOVE MNDOTB-FSCL-MN-NBR                                              
                          TO SS-FSCL-MN.                                        
           MOVE MNDOTB-SLS-RTL-AMT                                              
                      TO ML128-FC-SLS-RTL-AMT       (SS-FSCL-MN).               
           MOVE MNDOTB-MKDN-RTL-AMT                                             
                      TO ML128-FC-MKDN-RTL-AMT      (SS-FSCL-MN).               
           MOVE MNDOTB-RCPT-RTL-AMT                                             
                      TO ML128-FC-RCPT-RTL-AMT      (SS-FSCL-MN).               
           MOVE MNDOTB-SHNK-RTL-AMT                                             
                      TO PV-MN-FC-SHNK-RTL-AMT      (SS-FSCL-MN).               
           MOVE MNDOTB-END-INV-RTL-AMT                                          
                      TO ML128-FC-END-INV-RTL-AMT   (SS-FSCL-MN).               
           MOVE MNDOTB-TOT-ORD-RTL-AMT                                          
                      TO ML128-FC-TOT-ORD-RTL-AMT   (SS-FSCL-MN).               
      *                                                                         
           MOVE MNDOTB-BEG-INV-RTL-AMT                                          
                      TO ML128-FC-BOM-RTL-AMT       (SS-FSCL-MN).               
           MOVE MNDOTB-GRO-MRGN-AMT                                             
                      TO ML128-FC-GRO-MRGN-AMT      (SS-FSCL-MN).               
           MOVE MNDOTB-RCPT-NET-COST-AMT                                        
                      TO ML128-FC-RCPT-NET-COST-AMT (SS-FSCL-MN).               
           MOVE MNDOTB-PADJ-NET-COST-AMT                                        
                      TO ML128-FC-PADJ-NET-COST-AMT (SS-FSCL-MN).               
           MOVE MNDOTB-PADJ-RTL-AMT                                             
                      TO ML128-FC-PADJ-RTL-AMT      (SS-FSCL-MN).               
                                                                                
           IF SS-FSCL-MN >= PV-TY-FSCL-MN-NBR                                   
               MOVE MNDOTB-APP-ORD-RTL-AMT                                      
                          TO ML128-FC-APP-ORD-RTL-AMT   (SS-FSCL-MN)            
           END-IF.                                                              
                                                                                
           PERFORM 8640-FETCH-TMNDOTB-CSR.                                      
                                                                                
                                                                                
       3600-EXTRACT-TY-WKPLN-FOR-DEPT.                                          
                                                                                
      *****************************************************************         
      * MAP THIS YEAR WEEKLY PLANNING DEPT DATA                                 
      *****************************************************************         
                                                                                
           MOVE WKDPLN-FSCL-WK-END-DTE                                          
                            TO DTATTR-KY-DTE.                                   
           PERFORM 8430-SELECT-WK-IN-MN.                                        
                                                                                
           MOVE DTATTR-WK-IN-MN-NBR                                             
                            TO SS-FSCL-WK.                                      
           MOVE PV-TY-FSCL-MN-NBR                                               
                            TO SS-FSCL-MN.                                      
           MOVE WKDPLN-SLS-RTL-AMT                                              
                            TO ML122-PL-SLS-RTL-AMT       (SS-FSCL-WK).         
           MOVE WKDPLN-MKDN-RTL-AMT                                             
                            TO ML122-PL-MKDN-RTL-AMT      (SS-FSCL-WK).         
           MOVE WKDPLN-RCPT-RTL-AMT                                             
                            TO ML122-PL-RCPT-RTL-AMT      (SS-FSCL-WK).         
           MOVE WKDPLN-SHNK-RTL-AMT                                             
                            TO PV-WK-PL-SHNK-RTL-AMT      (SS-FSCL-WK).         
           MOVE WKDPLN-END-INV-RTL-AMT                                          
                            TO ML122-PL-END-INV-RTL-AMT   (SS-FSCL-WK).         
21517      MOVE WKDPLN-PADJ-RTL-AMT                                             
21517                       TO ML122-PL-PADJ-RTL-AMT   (SS-FSCL-WK).            
                                                                                
      *    COMPUTE FORECAST WEEKLY SALES USING PRORATED % FROM PLANNING         
           IF ML128-PL-SLS-RTL-AMT (SS-FSCL-MN) = ZERO                          
               MOVE ZERO TO ML122-FC-SLS-RTL-AMT (SS-FSCL-WK)                   
           ELSE                                                                 
               COMPUTE PV-PROOTB-PCT ROUNDED                                    
                     = (WKDPLN-SLS-RTL-AMT                                      
                     /  ML128-PL-SLS-RTL-AMT (SS-FSCL-MN))                      
               COMPUTE ML122-FC-SLS-RTL-AMT (SS-FSCL-WK)                        
                     = ML128-FC-SLS-RTL-AMT (SS-FSCL-MN)                        
                     * PV-PROOTB-PCT                                            
           END-IF.                                                              
                                                                                
      *    COMPUTE FORECAST WEEKLY MARKDOWN USING PRORATED % FROM               
      *    PLANNING                                                             
           IF ML128-PL-MKDN-RTL-AMT (SS-FSCL-MN) = ZERO                         
               MOVE ZERO TO ML122-FC-MKDN-RTL-AMT (SS-FSCL-WK)                  
           ELSE                                                                 
               COMPUTE PV-PROOTB-PCT ROUNDED                                    
                     = (WKDPLN-MKDN-RTL-AMT                                     
                     / ML128-PL-MKDN-RTL-AMT (SS-FSCL-MN))                      
                                                                                
               COMPUTE ML122-FC-MKDN-RTL-AMT (SS-FSCL-WK)                       
                     = ML128-FC-MKDN-RTL-AMT (SS-FSCL-MN)                       
                     * PV-PROOTB-PCT                                            
           END-IF.                                                              
                                                                                
      *    COMPUTE FORECAST WEEKLY SHRINK USING PRORATED % FROM                 
      *    PLANNING                                                             
           IF PV-MN-PL-SHNK-RTL-AMT (SS-FSCL-MN) = ZERO                         
               MOVE ZERO TO PV-WK-FC-SHNK-RTL-AMT (SS-FSCL-WK)                  
           ELSE                                                                 
               COMPUTE PV-PROOTB-PCT ROUNDED                                    
                     = (WKDPLN-SHNK-RTL-AMT                                     
                     / PV-MN-PL-SHNK-RTL-AMT (SS-FSCL-MN))                      
               COMPUTE PV-WK-FC-SHNK-RTL-AMT (SS-FSCL-WK)                       
                     = PV-MN-FC-SHNK-RTL-AMT (SS-FSCL-MN)                       
                     * PV-PROOTB-PCT                                            
           END-IF.                                                              
                                                                                
      *    COMPUTE FORECAST WEEKLY PURCHASES USING PRORATED                     
      *    % FROM PLANNING RECEIPT RETAIL AMOUNT                                
                                                                                
394548     COMPUTE PV-WORK-AMOUNT                                               
394548               = ML128-PL-RCPT-RTL-AMT (SS-FSCL-MN)                       
394548               + ML128-PL-PADJ-RTL-AMT (SS-FSCL-MN).                      
394548                                                                          
436795     IF ML128-PL-RCPT-RTL-AMT (SS-FSCL-MN) = ZERO OR                      
436795        PV-WORK-AMOUNT IS EQUAL TO ZERO                                   
               COMPUTE ML122-FC-TOT-ORD-RTL-AMT (SS-FSCL-WK)                    
21517                = (ML128-FC-TOT-ORD-RTL-AMT (SS-FSCL-MN)                   
21517                / PV-WK-IN-MN-NBR)                                         
           ELSE                                                                 
               COMPUTE PV-PROOTB-PCT ROUNDED                                    
                     = WKDPLN-RCPT-RTL-AMT                                      
                     / ML128-PL-RCPT-RTL-AMT (SS-FSCL-MN)                       
               COMPUTE ML122-FC-TOT-ORD-RTL-AMT (SS-FSCL-WK)                    
21517                = (ML128-FC-TOT-ORD-RTL-AMT (SS-FSCL-MN)                   
21517                * PV-PROOTB-PCT)                                           
           END-IF.                                                              
                                                                                
           PERFORM 8670-FETCH-TWKDPLN-CSR.                                      
                                                                                
                                                                                
       3700-GET-FUTURE-COMMITMENTS.                                             
                                                                                
      *****************************************************************         
      * MAP FUTURE COMMITMENTS FOR DEPARTMENT - PHASE III                       
      *****************************************************************         
                                                                                
           IF (ML133-DEPT-NBR = MDSEAR-DEPT-NBR)                                
                 MOVE ML133-FSCL-MN-NBR                                         
                                 TO SS-FSCL-MN                                  
                 IF ML128-FC-ONORD-RTL-AMT (SS-FSCL-MN) = ZERO                  
                     MOVE ML133-ONORD-RTL-AMT                                   
                                 TO ML128-FC-ONORD-RTL-AMT (SS-FSCL-MN)         
                 END-IF                                                         
                 IF ML128-FC-ONORD-CST-AMT (SS-FSCL-MN) = ZERO                  
                     MOVE ML133-ONORD-CST-AMT                                   
                                 TO ML128-FC-ONORD-CST-AMT (SS-FSCL-MN)         
                 END-IF                                                         
                 IF ML128-FC-PASTDUE-RTL-AMT(SS-FSCL-MN) = ZERO                 
                     MOVE ML133-PAST-DUE-RTL-AMT                                
                                 TO ML128-FC-PASTDUE-RTL-AMT(SS-FSCL-MN)        
                 END-IF                                                         
                 PERFORM 7050-READ-MN-ONORD-PDUE-FILE                           
           ELSE                                                                 
           IF (ML133-DEPT-NBR < MDSEAR-DEPT-NBR)                                
                 PERFORM 7050-READ-MN-ONORD-PDUE-FILE                           
           END-IF.                                                              
                                                                                
                                                                                
       3800-TY-EXTRACT-WKDPTC-INV-CSR.                                          
                                                                                
      *****************************************************************         
      * MAP THIS YEAR WEEKLY ENDING INVENTORY                                   
      *****************************************************************         
                                                                                
           MOVE WKDPTC-FSCL-WK-NBR                                              
                    TO SS-FSCL-WK.                                              
           MOVE WKDPTC-END-INV-RTL-AMT                                          
                    TO ML140-TY-END-INV-RTL-AMT (SS-FSCL-WK).                   
                                                                                
           PERFORM 8940-FETCH-WKDPTC-INV-CSR.                                   
                                                                                
                                                                                
       3850-LY-EXTRACT-WKDPTC-INV-CSR.                                          
                                                                                
      *****************************************************************         
      * MAP THIS YEAR WEEKLY ENDING INVENTORY                                   
      *****************************************************************         
                                                                                
           MOVE WKDPTC-FSCL-WK-NBR                                              
                    TO SS-FSCL-WK.                                              
           MOVE WKDPTC-END-INV-RTL-AMT                                          
                    TO ML140-LY-END-INV-RTL-AMT (SS-FSCL-WK).                   
                                                                                
           PERFORM 8940-FETCH-WKDPTC-INV-CSR.                                   
                                                                                
                                                                                
       3900-EXTRACT-WKDPLN-INV-CSR.                                             
                                                                                
      *****************************************************************         
      * MAP THIS YEAR'S PLANNING WEEKLY ENDING INVENTORY                        
      *****************************************************************         
                                                                                
           MOVE WKDPLN-FSCL-WK-NBR                                              
                    TO SS-FSCL-WK.                                              
           MOVE WKDPLN-END-INV-RTL-AMT                                          
                    TO ML140-PL-END-INV-RTL-AMT (SS-FSCL-WK).                   
                                                                                
           PERFORM 8970-FETCH-WKDPLN-INV-CSR.                                   
                                                                                
                                                                                
                                                                                
       6100-GET-TY-WEEKS-SUPPLY.                                                
      * THIS YEAR WEEKS OF SUPPLY                                               
      * WEEKS SUPPLY - HOW MANY WEEKS UNTIL INVENTORY WILL BE ZERO.             
      * LOOP THROUGH THIS CALCULATION UNTIL EITHER THE RESULT IS ZERO,          
      * OR THERE IS NO MORE WEEKLY DATA.  WHEN NO PLANNING DATA, SET            
      * THE THE WEEKS SUPPLY NO PLAN IND.  WHEN THERE IS NO MORE                
      * PLANNING WEEKLY DATA, THEN INCLUDE A GREATER THAN SYMBOL IN THE         
      * EXTRACT.  KEEP TRACK OF THE NUMBER OF TIMES THROUGH THE LOOP.           
      * EACH TIME THROUGH COUNTS AS ONE WEEK.  THE NUMBER OF TIMES              
      * THROUGH THE LOOP IS THE NUMBER OF WEEKS TO DISPLAY ON THE               
      * REPORT.                                                                 
                                                                                
           IF PS-PLAN-INFO-NOT-FOUND                                            
               MOVE SPACE   TO ML122-TY-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)           
               MOVE PC-Y    TO ML122-TY-WKS-SUP-NO-PLAN (SS-FSCL-WK)            
               MOVE ZERO    TO ML122-TY-WKS-SUP-AMT (SS-FSCL-WK)                
           ELSE                                                                 
               IF ML122-TY-END-INV-RTL-AMT(SS-FSCL-WK) > ZERO                   
                   PERFORM 6110-CALC-TY-WEEKS-SUPPLY                            
                   SUBTRACT 1       FROM PV-WKS-SUP                             
                   MOVE PV-WKS-SUP  TO ML122-TY-WKS-SUP-AMT (SS-FSCL-WK)        
               ELSE                                                             
                   MOVE SPACE  TO ML122-TY-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)        
                   MOVE SPACE  TO ML122-TY-WKS-SUP-NO-PLAN (SS-FSCL-WK)         
                   MOVE ZERO   TO ML122-TY-WKS-SUP-AMT (SS-FSCL-WK)             
               END-IF.                                                          
                                                                                
           ADD 1        TO SS-FSCL-WK.                                          
                                                                                
       6110-CALC-TY-WEEKS-SUPPLY.                                               
      * THIS YEAR WEEKS OF SUPPLY WHEN THERE IS PLANNING DATA                   
      * WEEKS SUPPLY - HOW MANY WEEKS UNTIL INVENTORY WILL BE ZERO.             
      * FIRST LOOP THROUGH THE WEEKLY DATA FOR THE CURRENT MONTH, AND           
      * IF NEEDED, GET DATA FOR THE FUTURE MONTHS.                              
                                                                                
           MOVE 0           TO PV-WKS-SUP.                                      
           MOVE SPACE       TO ML122-TY-WKS-SUP-NO-PLAN (SS-FSCL-WK).           
           COMPUTE PV-END-INV-RTL-AMT                                           
                 = ML122-TY-END-INV-RTL-AMT(SS-FSCL-WK)                         
                 / PC-THOUSAND.                                                 
           MOVE SS-FSCL-WK  TO SS-NEXT-WK.                                      
           PERFORM UNTIL (PV-END-INV-RTL-AMT <= 0                               
                       OR SS-NEXT-WK > PV-TY-LAST-WK-IN-MN)                     
               COMPUTE PV-END-INV-RTL-AMT                                       
                     = PV-END-INV-RTL-AMT                                       
                     - ML122-PL-SLS-RTL-AMT (SS-NEXT-WK)                        
                     - ML122-PL-MKDN-RTL-AMT(SS-NEXT-WK)                        
                     - PV-WK-PL-SHNK-RTL-AMT(SS-NEXT-WK)                        
               ADD 1        TO SS-NEXT-WK                                       
               ADD 1        TO PV-WKS-SUP                                       
           END-PERFORM.                                                         
                                                                                
           IF PV-END-INV-RTL-AMT > 0                                            
               PERFORM 8800-OPEN-PL-DPT-WK-SUP-CSR                              
               PERFORM 8810-FETCH-PL-DPT-WK-SUP-CSR                             
               PERFORM UNTIL (PV-END-INV-RTL-AMT <= 0                           
                           OR PS-END-OF-PL-DPT-WK-SUP-CSR)                      
                   COMPUTE PV-END-INV-RTL-AMT                                   
                         = PV-END-INV-RTL-AMT                                   
                         - WKDPLN-SLS-RTL-AMT                                   
                         - WKDPLN-MKDN-RTL-AMT                                  
                         - WKDPLN-SHNK-RTL-AMT                                  
                   ADD 1        TO PV-WKS-SUP                                   
                   PERFORM 8810-FETCH-PL-DPT-WK-SUP-CSR                         
               END-PERFORM                                                      
               IF PS-END-OF-PL-DPT-WK-SUP-CSR                                   
                   MOVE PC-GT-SYMBOL                                            
                        TO ML122-TY-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)               
               ELSE                                                             
                   MOVE SPACE                                                   
                        TO ML122-TY-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)               
               END-IF                                                           
                                                                                
               PERFORM 8820-CLOSE-PL-DPT-WK-SUP-CSR                             
           ELSE                                                                 
               MOVE SPACE                                                       
                        TO ML122-TY-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)               
           END-IF.                                                              
                                                                                
                                                                                
       6200-GET-FC-WEEKS-SUPPLY.                                                
      * FORCAST WEEKS OF SUPPLY                                                 
      * WEEKS SUPPLY - HOW MANY WEEKS UNTIL INVENTORY WILL BE ZERO.             
      * LOOP THROUGH THIS CALCULATION UNTIL EITHER THE RESULT IS ZERO,          
      * OR THERE IS NO MORE WEEKLY DATA.  WHEN NO PLANNING DATA, SET            
      * THE THE WEEKS SUPPLY NO PLAN IND.  WHEN THERE IS NO MORE                
      * FORECAST WEEKLY DATA, THEN INCLUDE A GREATER THAN SYMBOL IN THE         
      * EXTRACT.  KEEP TRACK OF THE NUMBER OF TIMES THROUGH THE LOOP.           
      * EACH TIME THROUGH COUNTS AS ONE WEEK.  THE NUMBER OF TIMES              
      * THROUGH THE LOOP IS THE NUMBER OF WEEKS TO DISPLAY ON THE               
      * REPORT.                                                                 
                                                                                
           IF PS-PLAN-INFO-NOT-FOUND                                            
               MOVE SPACE   TO ML122-FC-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)           
               MOVE PC-Y    TO ML122-FC-WKS-SUP-NO-PLAN (SS-FSCL-WK)            
               MOVE ZERO    TO ML122-FC-WKS-SUP-AMT (SS-FSCL-WK)                
           ELSE                                                                 
              IF ML122-TY-END-INV-RTL-AMT(SS-FSCL-WK) > ZERO                    
                  MOVE PS-PLAN-INFO-FOUND-SW TO  PV-SAVE-PLAN-INFO-SW           
                  PERFORM 6210-CALC-FC-WEEKS-SUPPLY                             
                  SUBTRACT 1       FROM PV-WKS-SUP                              
                  MOVE PV-WKS-SUP  TO ML122-FC-WKS-SUP-AMT (SS-FSCL-WK)         
                  MOVE PV-SAVE-PLAN-INFO-SW  TO  PS-PLAN-INFO-FOUND-SW          
              ELSE                                                              
                  MOVE SPACE   TO ML122-FC-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)        
                  MOVE SPACE   TO ML122-FC-WKS-SUP-NO-PLAN (SS-FSCL-WK)         
                  MOVE ZERO    TO ML122-FC-WKS-SUP-AMT (SS-FSCL-WK)             
              END-IF.                                                           
                                                                                
           ADD 1            TO SS-FSCL-WK.                                      
                                                                                
                                                                                
        6210-CALC-FC-WEEKS-SUPPLY.                                              
      * FORECAST WEEKS OF SUPPLY WHEN THERE IS PLANNING DATA                    
      * WEEKS SUPPLY - HOW MANY WEEKS UNTIL INVENTORY WILL BE ZERO.             
      * FIRST LOOP THROUGH THE WEEKLY DATA FOR THE CURRENT MONTH, AND           
      * IF NEEDED, GET DATA FOR THE FUTURE MONTHS.                              
                                                                                
           MOVE 0           TO PV-WKS-SUP.                                      
           MOVE SPACE       TO ML122-FC-WKS-SUP-NO-PLAN (SS-FSCL-WK).           
           COMPUTE PV-END-INV-RTL-AMT                                           
                 = ML122-TY-END-INV-RTL-AMT(SS-FSCL-WK)                         
                 / PC-THOUSAND                                                  
           MOVE SS-FSCL-WK  TO SS-NEXT-WK.                                      
                                                                                
      *    LOOP THROUGH WEEKLY DATA FOR THE CURRENT MONTH                       
           PERFORM UNTIL (PV-END-INV-RTL-AMT <= 0                               
                       OR SS-NEXT-WK > PV-TY-LAST-WK-IN-MN)                     
               COMPUTE PV-END-INV-RTL-AMT                                       
                     = PV-END-INV-RTL-AMT                                       
                     - ML122-FC-SLS-RTL-AMT (SS-NEXT-WK)                        
                     - ML122-FC-MKDN-RTL-AMT(SS-NEXT-WK)                        
                     - PV-WK-FC-SHNK-RTL-AMT(SS-NEXT-WK)                        
               ADD 1        TO SS-NEXT-WK                                       
               ADD 1        TO PV-WKS-SUP                                       
           END-PERFORM.                                                         
                                                                                
           IF PV-END-INV-RTL-AMT > 0                                            
      *        PROCESS STARTING WITH FORCAST DATA FOR THE NEXT                  
      *        MONTH AND CONTINUE PROCESSING UNTIL EITHER                       
      *        INVENTORY IS ZERO, OR NO MORE FORECAST DATA,                     
      *        OR NO MORE PLANNING DATA                                         
               PERFORM 8850-OPEN-FC-DPT-MN-SUP-CSR                              
               PERFORM 8860-FETCH-FC-DPT-MN-SUP-CSR                             
               PERFORM UNTIL (PV-END-INV-RTL-AMT <= 0                           
                           OR PS-END-OF-FC-DPT-MN-SUP-CSR                       
                           OR PS-PLAN-INFO-NOT-FOUND)                           
                                                                                
      *            GET THE PLANNING DATA FOR THE FORECAST MONTH                 
      *            THIS IS USED FOR THE PRORATE OF WEEKLY FORCASTING            
                   MOVE MNDOTB-FSCL-MN-END-DTE                                  
                           TO MNDPLN-FSCL-MN-END-DTE                            
                   PERFORM 8690-SELECT-MNDPLN                                   
                                                                                
      *            GET THE WEEKLY PLANNING DATA FOR THE FORECAST MONTH          
      *            AND USE IT TO PRORATE FOR THE WEEKLY FORCASTING              
                                                                                
                   MOVE MNDPLN-FSCL-MN-END-DTE    TO DTATTR-KY-DTE              
                   PERFORM 8430-SELECT-WK-IN-MN                                 
                   MOVE DTATTR-FSCL-MN-BEG-DTE    TO PV-BEG-DTE                 
                   MOVE DTATTR-FSCL-MN-END-DTE    TO PV-END-DTE                 
                   SET PS-NOT-END-OF-TYWKDPLN-CSR TO TRUE                       
                   PERFORM 8660-OPEN-TWKDPLN-CSR                                
                   PERFORM 8670-FETCH-TWKDPLN-CSR                               
      *            LOOP THROUGH SUBTRACTING THE PRORATED FORCASTING             
      *            WEEKLY DATA FOR THE PROCESSING MONTH                         
                   PERFORM UNTIL (PS-END-OF-TYWKDPLN-CSR OR                     
                                  PV-END-INV-RTL-AMT <= 0 OR                    
                                  PS-PLAN-INFO-NOT-FOUND)                       
                       MOVE ZEROS      TO PV-PROOTB-SLS-RTL-PCT                 
                                          PV-PROOTB-MKDN-RTL-PCT                
                                          PV-PROOTB-MKDN-RTL-PCT                
                       IF MNDPLN-SLS-RTL-AMT = 0                                
                           MOVE 0 TO PV-PROOTB-SLS-RTL-PCT                      
                       ELSE                                                     
                       COMPUTE PV-PROOTB-SLS-RTL-PCT ROUNDED                    
                             = (WKDPLN-SLS-RTL-AMT                              
                             /  MNDPLN-SLS-RTL-AMT)                             
                       END-IF                                                   
                                                                                
                       IF MNDPLN-MKDN-RTL-AMT = 0                               
                           MOVE 0 TO PV-PROOTB-MKDN-RTL-PCT                     
                       ELSE                                                     
                       COMPUTE PV-PROOTB-MKDN-RTL-PCT ROUNDED                   
                             = (WKDPLN-MKDN-RTL-AMT                             
                             /  MNDPLN-MKDN-RTL-AMT)                            
                       END-IF                                                   
                                                                                
                       IF MNDPLN-SHNK-RTL-AMT = 0                               
                           MOVE 0 TO PV-PROOTB-SHNK-RTL-PCT                     
                       ELSE                                                     
                       COMPUTE PV-PROOTB-SHNK-RTL-PCT ROUNDED                   
                             = (WKDPLN-SHNK-RTL-AMT                             
                             /  MNDPLN-SHNK-RTL-AMT)                            
                       END-IF                                                   
                                                                                
                       COMPUTE PV-END-INV-RTL-AMT                               
                             = PV-END-INV-RTL-AMT                               
                             - (PV-PROOTB-SLS-RTL-PCT                           
                             *  MNDOTB-SLS-RTL-AMT)                             
                             - (PV-PROOTB-MKDN-RTL-PCT                          
                             *  MNDOTB-MKDN-RTL-AMT)                            
                             - (PV-PROOTB-SHNK-RTL-PCT                          
                             *  MNDOTB-SHNK-RTL-AMT)                            
                       ADD 1        TO PV-WKS-SUP                               
                       PERFORM 8670-FETCH-TWKDPLN-CSR                           
                   END-PERFORM                                                  
                   PERFORM 8680-CLOSE-TWKDPLN-CSR                               
                   PERFORM 8860-FETCH-FC-DPT-MN-SUP-CSR                         
               END-PERFORM                                                      
                                                                                
               IF PV-END-INV-RTL-AMT > 0 AND                                    
                 (PS-END-OF-FC-DPT-MN-SUP-CSR OR                                
                  PS-PLAN-INFO-NOT-FOUND)                                       
                   MOVE PC-GT-SYMBOL                                            
                        TO ML122-FC-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)               
               ELSE                                                             
                   MOVE SPACE                                                   
                        TO ML122-FC-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)               
               END-IF                                                           
               PERFORM 8870-CLOSE-FC-DPT-MN-SUP-CSR                             
           ELSE                                                                 
               MOVE SPACE                                                       
                        TO ML122-FC-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)               
           END-IF.                                                              
                                                                                
       6300-GET-PL-WEEKS-SUPPLY.                                                
      * PLANNING WEEKS OF SUPPLY                                                
      * WEEKS SUPPLY - HOW MANY WEEKS UNTIL INVENTORY WILL BE ZERO.             
      * LOOP THROUGH THIS CALCULATION UNTIL EITHER THE RESULT IS ZERO,          
      * OR THERE IS NO MORE WEEKLY DATA.  WHEN NO PLANNING DATA, SET            
      * THE THE WEEKS SUPPLY NO PLAN IND.  WHEN THERE IS NO MORE                
      * PLANNING WEEKLY DATA, THEN INCLUDE A GREATER THAN SYMBOL IN THE         
      * EXTRACT.  KEEP TRACK OF THE NUMBER OF TIMES THROUGH THE LOOP.           
      * EACH TIME THROUGH COUNTS AS ONE WEEK.  THE NUMBER OF TIMES              
      * THROUGH THE LOOP IS THE NUMBER OF WEEKS TO DISPLAY ON THE               
      * REPORT.                                                                 
                                                                                
           IF PS-PLAN-INFO-NOT-FOUND                                            
               MOVE SPACE   TO ML122-PL-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)           
               MOVE PC-Y    TO ML122-PL-WKS-SUP-NO-PLAN (SS-FSCL-WK)            
               MOVE ZERO    TO ML122-PL-WKS-SUP-AMT (SS-FSCL-WK)                
           ELSE                                                                 
              IF ML122-PL-END-INV-RTL-AMT(SS-FSCL-WK) > ZERO                    
                  PERFORM 6310-CALC-PL-WEEKS-SUPPLY                             
                  SUBTRACT 1       FROM PV-WKS-SUP                              
                  MOVE PV-WKS-SUP  TO ML122-PL-WKS-SUP-AMT (SS-FSCL-WK)         
              ELSE                                                              
                  MOVE SPACE   TO ML122-PL-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)        
                  MOVE SPACE   TO ML122-PL-WKS-SUP-NO-PLAN (SS-FSCL-WK)         
                  MOVE ZERO    TO ML122-PL-WKS-SUP-AMT (SS-FSCL-WK)             
              END-IF.                                                           
                                                                                
           ADD 1        TO SS-FSCL-WK.                                          
                                                                                
       6310-CALC-PL-WEEKS-SUPPLY.                                               
      * PLANNED WEEKS OF SUPPLY WHEN THERE IS PLANNING DATA                     
      * WEEKS SUPPLY - HOW MANY WEEKS UNTIL INVENTORY WILL BE ZERO.             
      * FIRST LOOP THROUGH THE WEEKLY DATA FOR THE CURRENT MONTH, AND           
      * IF NEEDED, GET DATA FOR THE FUTURE MONTHS.                              
                                                                                
           MOVE 0           TO PV-WKS-SUP.                                      
           MOVE SPACE       TO ML122-PL-WKS-SUP-NO-PLAN (SS-FSCL-WK)            
           MOVE ML122-PL-END-INV-RTL-AMT(SS-FSCL-WK)                            
                            TO PV-END-INV-RTL-AMT.                              
           MOVE SS-FSCL-WK  TO SS-NEXT-WK.                                      
           PERFORM UNTIL (PV-END-INV-RTL-AMT <= 0                               
                       OR SS-NEXT-WK > PV-TY-LAST-WK-IN-MN)                     
               COMPUTE PV-END-INV-RTL-AMT                                       
                     = PV-END-INV-RTL-AMT                                       
                     - ML122-PL-SLS-RTL-AMT (SS-NEXT-WK)                        
                     - ML122-PL-MKDN-RTL-AMT(SS-NEXT-WK)                        
                     - PV-WK-PL-SHNK-RTL-AMT(SS-NEXT-WK)                        
               ADD 1        TO SS-NEXT-WK                                       
               ADD 1        TO PV-WKS-SUP                                       
           END-PERFORM.                                                         
                                                                                
           IF PV-END-INV-RTL-AMT > 0                                            
               PERFORM 8800-OPEN-PL-DPT-WK-SUP-CSR                              
               PERFORM 8810-FETCH-PL-DPT-WK-SUP-CSR                             
               PERFORM UNTIL (PV-END-INV-RTL-AMT <= 0                           
                           OR PS-END-OF-PL-DPT-WK-SUP-CSR)                      
                   COMPUTE PV-END-INV-RTL-AMT                                   
                         = PV-END-INV-RTL-AMT                                   
                         - WKDPLN-SLS-RTL-AMT                                   
                         - WKDPLN-MKDN-RTL-AMT                                  
                         - WKDPLN-SHNK-RTL-AMT                                  
                   ADD 1        TO PV-WKS-SUP                                   
                   MOVE SPACE TO ML122-PL-WKS-SUP-NO-PLAN                       
                                             (SS-FSCL-WK)                       
                   PERFORM 8810-FETCH-PL-DPT-WK-SUP-CSR                         
               END-PERFORM                                                      
               IF PS-END-OF-PL-DPT-WK-SUP-CSR                                   
                   MOVE PC-GT-SYMBOL                                            
                        TO ML122-PL-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)               
               ELSE                                                             
                   MOVE SPACE                                                   
                        TO ML122-PL-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)               
               END-IF                                                           
               PERFORM 8820-CLOSE-PL-DPT-WK-SUP-CSR                             
           ELSE                                                                 
               MOVE SPACE                                                       
                        TO ML122-PL-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)               
           END-IF.                                                              
                                                                                
       6400-GET-LY-WEEKS-SUPPLY.                                                
      * LAST YEAR WEEKS OF SUPPLY                                               
      * WEEKS SUPPLY - HOW MANY WEEKS UNTIL INVENTORY WILL BE ZERO.             
      * LOOP THROUGH THIS CALCULATION UNTIL EITHER THE RESULT IS ZERO,          
      * OR THERE IS NO MORE WEEKLY DATA.  WHEN THERE IS NO MORE                 
      * WEEKLY DATA, THEN INCLUDE A GREATER THAN SYMBOL IN THE                  
      * EXTRACT.  KEEP TRACK OF THE NUMBER OF TIMES THROUGH THE LOOP.           
      * EACH TIME THROUGH COUNTS AS ONE WEEK.  THE NUMBER OF TIMES              
      * THROUGH THE LOOP IS THE NUMBER OF WEEKS TO DISPLAY ON THE               
      * REPORT.                                                                 
                                                                                
              IF ML122-LY-END-INV-RTL-AMT(SS-FSCL-WK) > ZERO                    
                  MOVE 0           TO PV-WKS-SUP                                
                  MOVE ML122-LY-END-INV-RTL-AMT(SS-FSCL-WK)                     
                                   TO PV-END-INV-RTL-AMT                        
                  MOVE SS-FSCL-WK  TO SS-NEXT-WK                                
                  PERFORM UNTIL (PV-END-INV-RTL-AMT <= 0                        
                              OR SS-NEXT-WK > PV-LY-LAST-WK-IN-MN)              
                      COMPUTE PV-END-INV-RTL-AMT                                
                            = PV-END-INV-RTL-AMT                                
                            - ML122-LY-SLS-RTL-AMT (SS-NEXT-WK)                 
                            - ML122-LY-MKDN-RTL-AMT(SS-NEXT-WK)                 
                            - PV-WK-LY-SHNK-RTL-AMT(SS-NEXT-WK)                 
                      ADD 1        TO SS-NEXT-WK                                
                      ADD 1        TO PV-WKS-SUP                                
                  END-PERFORM                                                   
                                                                                
                  IF PV-END-INV-RTL-AMT > 0                                     
                      PERFORM 8700-OPEN-LY-DPT-WK-SUP-CSR                       
                      PERFORM 8710-FETCH-LY-DPT-WK-SUP-CSR                      
                      PERFORM UNTIL (PV-END-INV-RTL-AMT <= 0                    
                                  OR PS-END-OF-LY-DPT-WK-SUP-CSR)               
                          COMPUTE PV-END-INV-RTL-AMT                            
                                = ( PV-END-INV-RTL-AMT                          
                                - WKDPTC-SLS-RTL-AMT                            
                                - ( WKDPTC-MKDN-PLU-RTL-AMT                     
                                  + WKDPTC-MKDN-RGST-RTL-AMT                    
                                  + WKDPTC-MKDN-UMTCH-RTL-AMT                   
                                  + WKDPTC-MKDN-BYR-RTL-AMT                     
                                  + WKDPTC-MKDN-STR-RTL-AMT )                   
                                - WKDPTC-SHNK-RTL-AMT )                         
                          ADD 1        TO PV-WKS-SUP                            
                          PERFORM 8710-FETCH-LY-DPT-WK-SUP-CSR                  
                      END-PERFORM                                               
                      IF PS-END-OF-LY-DPT-WK-SUP-CSR                            
                          MOVE PC-GT-SYMBOL                                     
                               TO ML122-LY-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)        
                      ELSE                                                      
                          MOVE SPACES                                           
                               TO ML122-LY-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)        
                      END-IF                                                    
                      PERFORM 8750-CLOSE-LY-DPT-WK-SUP-CSR                      
                  ELSE                                                          
                      MOVE SPACES                                               
                               TO ML122-LY-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)        
                  END-IF                                                        
                  SUBTRACT 1       FROM PV-WKS-SUP                              
                  MOVE PV-WKS-SUP  TO ML122-LY-WKS-SUP-AMT (SS-FSCL-WK)         
                  ADD 1            TO SS-FSCL-WK                                
              ELSE                                                              
                  MOVE SPACES  TO ML122-LY-WKS-SUP-GT-SYMBOL(SS-FSCL-WK)        
                  MOVE ZERO    TO ML122-LY-WKS-SUP-AMT (SS-FSCL-WK)             
                  ADD 1        TO SS-FSCL-WK                                    
              END-IF.                                                           
                                                                                
       7000-READ-CONTROL-CARD-FILE.                                             
                                                                                
           READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD                          
               AT END SET PS-END-OF-CONTROL-CARDS TO TRUE.                      
                                                                                
                                                                                
       7050-READ-MN-ONORD-PDUE-FILE.                                            
                                                                                
           READ MN-ONORD-PDUE-FILE INTO ML133-PO-EXTRACT-MN-REC                 
               AT END SET PS-END-OF-MN-INP03 TO TRUE.                           
                                                                                
                                                                                
       7100-WRITE-LEDGER-EXTRACT-DATE.                                          
                                                                                
           WRITE LEDGER-EXTRACT-DATE-RECORD                                     
               FROM ML131-LEDGER-EXTRACT-DATE-REC.                              
                                                                                
                                                                                
       7200-WRITE-LEDGER-MN-EXTRACT.                                            
                                                                                
           WRITE LEDGER-EXTRACT-MN-RECORD                                       
               FROM ML128-LEDGER-EXTRACT-MN-REC.                                
                                                                                
                                                                                
       7300-WRITE-LEDGER-WK-EXTRACT.                                            
                                                                                
           WRITE LEDGER-EXTRACT-WK-RECORD                                       
               FROM ML122-LEDGER-EXTRACT-WK-REC.                                
                                                                                
                                                                                
       7400-WRITE-LEDGER-EOW-EXTRACT.                                           
                                                                                
           WRITE LEDGER-EXTRACT-EOW-RECORD                                      
               FROM ML140-LEDGER-EXTRACT-EOW-REC.                               
                                                                                
                                                                                
       8000-GET-ML-CNTL-DTES.                                                   
                                                                                
           EXEC SQL                                                             
                SELECT                                                          
                    PSTG_FSCL_WK_DTE                                            
                   ,MXPSTG_FSCL_WK_DTE                                          
                INTO                                                            
                    :MLCNTL-PSTG-FSCL-WK-DTE                                    
                   ,:MLCNTL-MXPSTG-FSCL-WK-DTE                                  
                FROM                                                            
                    TMLCNTL                                                     
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8000-GET-ML-CNTL-DTES' TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT ROW FROM TMLCNTL'                               
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8050-GET-DATE-ATTRIBUTES.                                                
                                                                                
      ******************************************************************        
      * GET THIS YEAR'S AND LAST YEAR'S DATES USED IN THIS PROGRAM.             
      *                                                                         
      * THIS QUERY HANDLES GETTING THE MONTH END DATE WHEN THE CURRENT          
      * MONTH HAS THE 53RD WEEK IN IT.                                          
      *                                                                         
      * IN THE SELECT:                                                          
      *                                                                         
      *    TABLE TDTATTR A - THIS FISCAL YEAR'S DATES                           
      *    TABLE TDTATTR B - LAST FISCAL YEAR'S DATES WHEN THE YEAR             
      *                      ONLY HAS 52 WEEKS                                  
      *    TABLE TDTATTR C - LAST FISCAL YEAR'S DATES WHEN THE YEAR             
      *                      HAS 53 WEEKS                                       
      *    TABLE TDTATTR D - LAST FISCAL YEAR'S PREVIOUS YEAR ENDING            
      *                      DATE.  THIS IS USED TO GET BEGINNING               
      *                      INVENTORY FOR LAST FISCAL YEAR.                    
      *                      THERE AREN'T ANY BEGINNING INVENTORY FIELDS        
      *                      SO THE ENDING INVENTORY FOR THE PRIOR YEAR         
      *                      IS USED TO PROVIDE THE BEGINNING INVENTORY.        
      *    TABLE TDTATTR E - USED TO GET LAST MONTH'S FISCAL MONTH              
      *                      NUMBER FOR THIS YEAR.  THIS IS USED TO GET         
      *                      BEGINNING INVENTORY FOR THE WEEKLY OUTPUT          
      *                      FILE                                               
      *    TABLE TDTATTR F - USED TO GET LAST MONTH'S FISCAL MONTH              
      *                      NUMBER FOR LAST YEAR.  THIS IS USED TO GET         
      *                      BEGINNING INVENTORY FOR THE WEEKLY OUTPUT          
      *                      FILE                                               
      *    TABLE TDTATTR G - USED TO GET NUMBER OF WEEKS FOR LAST YEARS         
      *                      CURRENT PROCESSING MONTH WHEN LAST YEAR            
      *                      HAS 53 WEEKS                                       
      *    TABLE TDTATTR H - USED TO GET NUMBER OF WEEKS FOR LAST YEARS         
      *                      CURRENT PROCESSING MONTH WHEN LAST YEAR            
      *                      HAS 52 WEEKS                                       
      *    TABLE TDTATTR I - USED TO GET NUMBER OF WEEKS FOR THE CURRENT        
      *                      PROCESSING MONTH WHEN THE CURRENT YEAR             
      *                      HAS 53 WEEKS                                       
      *    TABLE TDTATTR J - USED TO GET NUMBER OF WEEKS FOR THE CURRENT        
      *                      PROCESSING MONTH WHEN THE CURRENT YEAR             
      *                      HAS 52 WEEKS                                       
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
              SELECT                                                            
                  A.FSCL_YR_NBR                                                 
                 ,A.FSCL_MN_NBR                                                 
                 ,A.FSCL_MN_BEG_DTE                                             
                 ,A.FSCL_MN_END_DTE                                             
                 ,A.FSCL_WK_END_DTE                                             
                 ,A.FSCL_YR_END_DTE                                             
                 ,A.FSCL_YR_BEG_DTE                                             
                 ,C.FSCL_MN_NBR                                                 
                 ,C.FSCL_MN_BEG_DTE                                             
                 ,C.FSCL_MN_END_DTE                                             
                 ,C.FSCL_YR_BEG_DTE                                             
                 ,C.FSCL_YR_END_DTE                                             
                 ,D.FSCL_YR_END_DTE                                             
                 ,E.FSCL_MN_NBR                                                 
                 ,F.FSCL_MN_NBR                                                 
                 ,G.WK_IN_MN_NBR                                                
                 ,I.WK_IN_MN_NBR                                                
              INTO                                                              
                  :TY-FSCL-YR-NBR                                               
                 ,:TY-FSCL-MN-NBR                                               
                 ,:TY-FSCL-MN-BEG-DTE                                           
                 ,:TY-FSCL-MN-END-DTE                                           
                 ,:DTATTR-FSCL-WK-END-DTE                                       
                 ,:TY-FSCL-YR-END-DTE                                           
                 ,:TY-FSCL-YR-BEG-DTE                                           
                 ,:LY-FSCL-MN-NBR                                               
                 ,:LY-FSCL-MN-BEG-DTE                                           
                 ,:LY-FSCL-MN-END-DTE                                           
                 ,:LY-FSCL-YR-BEG-DTE                                           
                 ,:LY-FSCL-YR-END-DTE                                           
                 ,:PL-FSCL-YR-END-DTE                                           
                 ,:TY-LM-FSCL-MN-NBR                                            
                 ,:LY-LM-FSCL-MN-NBR                                            
                 ,:LY-LAST-WK-IN-MN                                             
                 ,:TY-LAST-WK-IN-MN                                             
              FROM                                                              
                  TDTATTR A                                                     
                 ,TDTATTR B                                                     
                 ,TDTATTR C                                                     
                 ,TDTATTR D                                                     
                 ,TDTATTR E                                                     
                 ,TDTATTR F                                                     
                 ,TDTATTR G                                                     
                 ,TDTATTR I                                                     
              WHERE                                                             
                  A.KY_DTE             = :DTATTR-KY-DTE                         
              AND G.KY_DTE             = C.FSCL_MN_END_DTE                      
              AND I.KY_DTE             = A.FSCL_MN_END_DTE                      
              AND F.KY_DTE             = C.PFM_END_DTE                          
              AND E.KY_DTE             = A.PFM_END_DTE                          
              AND D.KY_DTE             = C.LY_THIS_DAY_KY_DTE                   
              AND C.KY_DTE             = B.LY_THIS_DAY_KY_DTE                   
              AND B.KY_DTE             = A.FSCL_MN_END_DTE - 7 DAYS             
              AND A.FSCL_MN_END_DTE    = B.FSCL_MN_END_DTE                      
              AND A.LY_THIS_DAY_KY_DTE = '9999-09-09'                           
                                                                                
              UNION                                                             
                                                                                
              SELECT                                                            
                  A.FSCL_YR_NBR                                                 
                 ,A.FSCL_MN_NBR                                                 
                 ,A.FSCL_MN_BEG_DTE                                             
                 ,A.FSCL_MN_END_DTE                                             
                 ,A.FSCL_WK_END_DTE                                             
                 ,A.FSCL_YR_END_DTE                                             
                 ,A.FSCL_YR_BEG_DTE                                             
                 ,B.FSCL_MN_NBR                                                 
                 ,B.FSCL_MN_BEG_DTE                                             
                 ,B.FSCL_MN_END_DTE                                             
                 ,B.FSCL_YR_BEG_DTE                                             
                 ,B.FSCL_YR_END_DTE                                             
                 ,C.FSCL_YR_END_DTE                                             
                 ,D.FSCL_MN_NBR                                                 
                 ,E.FSCL_MN_NBR                                                 
                 ,H.WK_IN_MN_NBR                                                
                 ,J.WK_IN_MN_NBR                                                
              INTO                                                              
                  :TY-FSCL-YR-NBR                                               
                 ,:TY-FSCL-MN-NBR                                               
                 ,:TY-FSCL-MN-BEG-DTE                                           
                 ,:TY-FSCL-MN-END-DTE                                           
                 ,:DTATTR-FSCL-WK-END-DTE                                       
                 ,:TY-FSCL-YR-END-DTE                                           
                 ,:TY-FSCL-YR-BEG-DTE                                           
                 ,:LY-FSCL-MN-NBR                                               
                 ,:LY-FSCL-MN-BEG-DTE                                           
                 ,:LY-FSCL-MN-END-DTE                                           
                 ,:LY-FSCL-YR-BEG-DTE                                           
                 ,:LY-FSCL-YR-END-DTE                                           
                 ,:PL-FSCL-YR-END-DTE                                           
                 ,:TY-LM-FSCL-MN-NBR                                            
                 ,:LY-LM-FSCL-MN-NBR                                            
                 ,:LY-LAST-WK-IN-MN                                             
                 ,:TY-LAST-WK-IN-MN                                             
              FROM                                                              
                  TDTATTR A                                                     
                 ,TDTATTR B                                                     
                 ,TDTATTR C                                                     
                 ,TDTATTR D                                                     
                 ,TDTATTR E                                                     
                 ,TDTATTR H                                                     
                 ,TDTATTR J                                                     
              WHERE                                                             
                  A.KY_DTE           = :DTATTR-KY-DTE                           
              AND H.KY_DTE           = B.FSCL_MN_END_DTE                        
              AND J.KY_DTE           = A.FSCL_MN_END_DTE                        
              AND E.KY_DTE           = B.PFM_END_DTE                            
              AND D.KY_DTE           = A.PFM_END_DTE                            
              AND C.KY_DTE           = B.LY_THIS_DAY_KY_DTE                     
              AND B.KY_DTE           = A.LY_THIS_DAY_KY_DTE                     
              AND A.FSCL_MN_END_DTE ^= B.FSCL_MN_END_DTE                        
W26603      WITH UR                                                             
                                                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   SET PS-DATES-FOUND TO TRUE                                   
               WHEN SQLCODE = +100                                              
                   SET PS-DATES-NOT-FOUND TO TRUE                               
               WHEN OTHER                                                       
                   MOVE '8050-GET-DATE-ATTRIBUTES'                              
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT ROW FROM TDTATTR'                               
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8060-GET-EFFECTIVE-MBS-INFO.                                             
                                                                                
      ******************************************************************        
      * GET THE MBS INFO FROM THE EFFECTIVE ROW FOR THE DEPARTMENT.             
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
                SELECT                                                          
                    GMA_NBR                                                     
                   ,DMA_NBR                                                     
                   ,BYR_NBR                                                     
                INTO                                                            
                    :MDSEAR-GMA-NBR                                             
                   ,:MDSEAR-DMA-NBR                                             
                   ,:MDSEAR-BYR-NBR                                             
                FROM                                                            
                    TMDSEAR                                                     
                WHERE OPERCO_NBR  = :PC-OPERCO-NBR                              
                  AND MDSELV_CDE  = 'DPT'                                       
                  AND DEPT_NBR    = :MDSEAR-DEPT-NBR                            
                  AND :PV-TY-FSCL-MN-END-DTE                                    
                       BETWEEN STRT_DTE                                         
                           AND END_DTE                                          
W26603          WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   SET PS-MBS-INFO-FOUND TO TRUE                                
               WHEN SQLCODE = +100                                              
                   SET PS-MBS-INFO-NOT-FOUND TO TRUE                            
               WHEN OTHER                                                       
                   MOVE '8060-GET-EFFECTIVE-MBS-INFO'                           
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT ROW FROM TMDSEAR'                               
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8070-GET-LATEST-MBS-INFO.                                                
                                                                                
      ******************************************************************        
      * GET THE MBS INFO FROM THE MOST RECENT ROW FOR THE DEPARTMENT.           
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
                SELECT                                                          
                    GMA_NBR                                                     
                   ,DMA_NBR                                                     
                   ,BYR_NBR                                                     
                INTO                                                            
                    :MDSEAR-GMA-NBR                                             
                   ,:MDSEAR-DMA-NBR                                             
                   ,:MDSEAR-BYR-NBR                                             
                FROM                                                            
                    TMDSEAR                                                     
                WHERE OPERCO_NBR  = :PC-OPERCO-NBR                              
                  AND MDSELV_CDE  = 'DPT'                                       
                  AND DEPT_NBR    = :MDSEAR-DEPT-NBR                            
                  AND END_DTE     =                                             
                        (SELECT MAX (END_DTE)                                   
                         FROM   TMDSEAR                                         
                         WHERE  OPERCO_NBR = :PC-OPERCO-NBR                     
                           AND  MDSELV_CDE = 'DPT'                              
                           AND  DEPT_NBR   = :MDSEAR-DEPT-NBR)                  
W26603          WITH UR                                                         
                                                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   SET PS-MBS-INFO-FOUND TO TRUE                                
               WHEN SQLCODE = +100                                              
                   SET PS-MBS-INFO-NOT-FOUND TO TRUE                            
               WHEN OTHER                                                       
                   MOVE '8070-GET-LATEST-MBS-INFO'                              
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT ROW FROM TMDSEAR'                               
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
       8080-GET-WK-IN-MN-NBR.                                                   
                                                                                
      ******************************************************************        
      * GET THIS YEAR'S AND LAST YEAR'S DATES USED IN THIS PROGRAM.             
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
              SELECT                                                            
                  WK_IN_MN_NBR                                                  
              INTO                                                              
                  :DTATTR-WK-IN-MN-NBR                                          
              FROM                                                              
                  TDTATTR                                                       
              WHERE                                                             
                  KY_DTE               = :PV-TY-FSCL-MN-END-DTE                 
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   MOVE DTATTR-WK-IN-MN-NBR TO PV-WK-IN-MN-NBR                  
               WHEN OTHER                                                       
                   MOVE '8080-GET-WK-IN-MN-NBR'                                 
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT ROW FROM TDTATTR'                               
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8100-OPEN-DEPT-NBR-CSR.                                                  
                                                                                
           EXEC SQL                                                             
                OPEN DEPT-NBR-CSR                                               
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8100-OPEN-DEPT-NBR-CSR'                                
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'OPEN DEPT-NBR-CSR'     TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8110-FETCH-DEPT-NBR-CSR.                                                 
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   DEPT-NBR-CSR                                                 
               INTO                                                             
                   :MDSEAR-DEPT-NBR                                             
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   SET PS-END-OF-DEPT-NBR-CSR TO TRUE                           
               WHEN OTHER                                                       
                   MOVE '8110-FETCH-DEPT-NBR-CSR'                               
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'FETCH DEPT-NBR-CSR'    TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8150-CLOSE-DEPT-NBR-CSR.                                                 
                                                                                
           EXEC SQL                                                             
               CLOSE DEPT-NBR-CSR                                               
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8150-CLOSE-DEPT-NBR-CSR'                               
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'CLOSE DEPT-NBR-CSR'    TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8200-OPEN-TMNDPTC-CSR.                                                   
                                                                                
           EXEC SQL                                                             
                OPEN TMNDPTC-CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8200-OPEN-TMNDPTC-CSR'                                 
                                            TO PV-PARAGRAPH-NAME                
                   MOVE 'OPEN TMNDPTC-CSR'  TO PV-DB2-OPER-ATTEMPTED            
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8210-FETCH-TMNDPTC-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   TMNDPTC-CSR                                                  
               INTO                                                             
                  :MNDPTC-FSCL-MN-NBR                                           
                 ,:MNDPTC-FSCL-MN-END-DTE                                       
                 ,:MNDPTC-SLS-RTL-AMT                                           
                 ,:MNDPTC-MKDN-PLU-RTL-AMT                                      
                 ,:MNDPTC-MKDN-RGST-RTL-AMT                                     
                 ,:MNDPTC-MKDN-UMTCH-RTL-AMT                                    
                 ,:MNDPTC-MKDN-BYR-RTL-AMT                                      
                 ,:MNDPTC-MKDN-STR-RTL-AMT                                      
                 ,:MNDPTC-MKUP-RTL-AMT                                          
                 ,:MNDPTC-XFER-IN-RTL-AMT                                       
                 ,:MNDPTC-XFER-OUT-RTL-AMT                                      
                 ,:MNDPTC-RCPT-RTL-AMT                                          
                 ,:MNDPTC-RCPT-NET-COST-AMT                                     
                 ,:MNDPTC-PADJ-RTL-AMT                                          
                 ,:MNDPTC-PADJ-NET-COST-AMT                                     
                 ,:MNDPTC-INV-ADJ-RTL-AMT                                       
                 ,:MNDPTC-SHNK-RTL-AMT                                          
                 ,:MNDPTC-END-INV-RTL-AMT                                       
                 ,:MNDPTC-END-INV-COST-AMT                                      
                 ,:MNDPTC-SLS-COST-AMT                                          
                 ,:MNDPTC-GRO-MRGN-AMT                                          
           END-EXEC.                                                            
                                                                                
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   SET PS-END-OF-TMNDPTC-CSR TO TRUE                            
               WHEN OTHER                                                       
                   MOVE '8210-FETCH-TMNDPTC-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'FETCH TMNDPTC-CSR'     TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8220-SELECT-MN-COMP-INV.                                                 
                                                                                
           EXEC SQL                                                             
               SELECT SUM(B.END_INV_RTL_AMT)                                    
               INTO                                                             
                 :MNDPTS-END-INV-RTL-AMT  :PV-NULL-INDICATOR                    
W26603         FROM (SELECT A.LOC_NBR  AS COMP_STORE_NO_INT                     
W26603               FROM  XMT_LOC A                                            
W26603               WHERE (A.LOC_TYP_CDE      = 'DS'                           
W26603                 AND  A.E_BUS_IND        = 'Y'                            
W26603                 AND  A.MN_SLS_INCL_DTE <= :PV-COMP-PROC-MN-DB2           
W26603                 AND (A.CLO_DTE          = '9999-09-09'                   
W26603                  OR  A.REPLT_STR_NBR    > 0 ))) AS COMPSTORE             
               JOIN TMNDPTS B                                                   
               ON B.STR_NBR = COMPSTORE.COMP_STORE_NO_INT                       
               WHERE                                                            
                   B.FSCL_MN_NBR      = :MNDPTC-FSCL-MN-NBR                     
               AND B.FSCL_MN_END_DTE  = :MNDPTC-FSCL-MN-END-DTE                 
               AND B.DEPT_NBR         = :MDSEAR-DEPT-NBR                        
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   IF PV-NULL-INDICATOR < 0                                     
                      MOVE ZEROS TO MNDPTS-END-INV-RTL-AMT                      
                   END-IF                                                       
               WHEN OTHER                                                       
                   MOVE '8220-SELECT-MN-COMP-INV'                               
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT '               TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8225-SELECT-MN-COMP-SLS.                                                 
                                                                                
           EXEC SQL                                                             
               SELECT SUM(B.SLS_RTL_AMT)                                        
               INTO                                                             
                 :MNDPTS-SLS-RTL-AMT  :PV-NULL-INDICATOR                        
W26603         FROM (SELECT A.LOC_NBR  AS COMP_STORE_NO_INT                     
W26603               FROM  XMT_LOC A                                            
W26603               WHERE A.MN_SLS_INCL_DTE  <= :PV-COMP-PROC-MN-DB2           
W26603                 AND A.E_BUS_IND         = 'Y')                           
                     AS COMPSTORE                                               
               JOIN TMNDPTS B                                                   
               ON B.STR_NBR = COMPSTORE.COMP_STORE_NO_INT                       
               WHERE                                                            
                   B.FSCL_MN_NBR      = :MNDPTC-FSCL-MN-NBR                     
               AND B.FSCL_MN_END_DTE  = :MNDPTC-FSCL-MN-END-DTE                 
               AND B.DEPT_NBR         = :MDSEAR-DEPT-NBR                        
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   IF PV-NULL-INDICATOR < 0                                     
                      MOVE ZEROS TO MNDPTS-SLS-RTL-AMT                          
                   END-IF                                                       
               WHEN OTHER                                                       
                   MOVE '8225-SELECT-MN-COMP-SLS'                               
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT '               TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8230-SELECT-SEAS-COMP-INV.                                               
                                                                                
           EXEC SQL                                                             
               SELECT SUM(B.END_INV_RTL_AMT)                                    
               INTO                                                             
                 :MNDPTS-END-INV-RTL-AMT  :PV-NULL-INDICATOR                    
W26603         FROM (SELECT A.LOC_NBR  AS COMP_STORE_NO_INT                     
W26603               FROM  XMT_LOC A                                            
W26603               WHERE (A.LOC_TYP_CDE      = 'DS'                           
W26603                 AND  A.SEA_SLS_INCL_DTE <= :PV-COMP-PROC-MN-DB2          
W26603                 AND  A.E_BUS_IND        = 'Y'                            
W26603                 AND (A.CLO_DTE          = '9999-09-09'                   
W26603                  OR  A.REPLT_STR_NBR    > 0 ))) AS COMPSTORE             
               JOIN TMNDPTS B                                                   
               ON B.STR_NBR = COMPSTORE.COMP_STORE_NO_INT                       
               WHERE                                                            
                   B.FSCL_MN_NBR      = :MNDPTC-FSCL-MN-NBR                     
               AND B.FSCL_MN_END_DTE  = :MNDPTC-FSCL-MN-END-DTE                 
               AND B.DEPT_NBR         = :MDSEAR-DEPT-NBR                        
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   IF PV-NULL-INDICATOR < 0                                     
                      MOVE ZEROS TO MNDPTS-END-INV-RTL-AMT                      
                   END-IF                                                       
               WHEN OTHER                                                       
                   MOVE '8230-SELECT-SEAS-COMP-INV'                             
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT '               TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8240-SELECT-YTD-COMP-INV.                                                
                                                                                
           EXEC SQL                                                             
               SELECT SUM(B.END_INV_RTL_AMT)                                    
               INTO                                                             
                 :MNDPTS-END-INV-RTL-AMT  :PV-NULL-INDICATOR                    
W26603         FROM (SELECT A.LOC_NBR  AS COMP_STORE_NO_INT                     
W26603               FROM  XMT_LOC A                                            
W26603               WHERE (A.LOC_TYP_CDE      = 'DS'                           
W26603                 AND  A.YR_SLS_INCL_DTE <= :PV-COMP-PROC-MN-DB2           
W26603                 AND  A.E_BUS_IND        = 'Y'                            
W26603                 AND (A.CLO_DTE          = '9999-09-09'                   
W26603                  OR  A.REPLT_STR_NBR    > 0 ))) AS COMPSTORE             
               JOIN TMNDPTS B                                                   
               ON B.STR_NBR = COMPSTORE.COMP_STORE_NO_INT                       
               WHERE                                                            
                   B.FSCL_MN_NBR      = :MNDPTC-FSCL-MN-NBR                     
               AND B.FSCL_MN_END_DTE  = :MNDPTC-FSCL-MN-END-DTE                 
               AND B.DEPT_NBR         = :MDSEAR-DEPT-NBR                        
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   IF PV-NULL-INDICATOR < 0                                     
                      MOVE ZEROS TO MNDPTS-END-INV-RTL-AMT                      
                   END-IF                                                       
               WHEN OTHER                                                       
                   MOVE '8240-SELECT-YTD-COMP-INV'                              
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT '               TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8250-CLOSE-TMNDPTC-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               CLOSE TMNDPTC-CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8250-CLOSE-TMNDPTC-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'CLOSE TMNDPTC-CSR'     TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8300-OPEN-LMNDPTC-CSR.                                                   
                                                                                
           EXEC SQL                                                             
                OPEN LMNDPTC-CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8200-OPEN-LMNDPTC-CSR'                                 
                                            TO PV-PARAGRAPH-NAME                
                   MOVE 'OPEN LMNDPTC-CSR'  TO PV-DB2-OPER-ATTEMPTED            
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8310-FETCH-LMNDPTC-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   LMNDPTC-CSR                                                  
               INTO                                                             
                  :MNDPTC-FSCL-MN-NBR                                           
                 ,:MNDPTC-FSCL-MN-END-DTE                                       
                 ,:MNDPTC-SLS-RTL-AMT                                           
                 ,:MNDPTC-MKDN-PLU-RTL-AMT                                      
                 ,:MNDPTC-MKDN-RGST-RTL-AMT                                     
                 ,:MNDPTC-MKDN-UMTCH-RTL-AMT                                    
                 ,:MNDPTC-MKDN-BYR-RTL-AMT                                      
                 ,:MNDPTC-MKDN-STR-RTL-AMT                                      
                 ,:MNDPTC-MKUP-RTL-AMT                                          
                 ,:MNDPTC-XFER-IN-RTL-AMT                                       
                 ,:MNDPTC-XFER-OUT-RTL-AMT                                      
                 ,:MNDPTC-RCPT-RTL-AMT                                          
                 ,:MNDPTC-RCPT-NET-COST-AMT                                     
                 ,:MNDPTC-PADJ-RTL-AMT                                          
                 ,:MNDPTC-PADJ-NET-COST-AMT                                     
                 ,:MNDPTC-INV-ADJ-RTL-AMT                                       
                 ,:MNDPTC-SHNK-RTL-AMT                                          
                 ,:MNDPTC-END-INV-RTL-AMT                                       
                 ,:MNDPTC-END-INV-COST-AMT                                      
                 ,:MNDPTC-GRO-MRGN-AMT                                          
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   SET PS-END-OF-LMNDPTC-CSR TO TRUE                            
               WHEN OTHER                                                       
                   MOVE '8210-FETCH-LMNDPTC-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'FETCH LMNDPTC-CSR'     TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8350-CLOSE-LMNDPTC-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               CLOSE LMNDPTC-CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8250-CLOSE-LMNDPTC-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'CLOSE LMNDPTC-CSR'     TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8400-OPEN-TYWKDPT-CSR.                                                   
                                                                                
           EXEC SQL                                                             
                OPEN TYWKDPT-CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8200-OPEN-TYWKDPT-CSR'                                 
                                            TO PV-PARAGRAPH-NAME                
                   MOVE 'OPEN TYWKDPT-CSR' TO PV-DB2-OPER-ATTEMPTED             
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8410-FETCH-TYWKDPT-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   TYWKDPT-CSR                                                  
               INTO                                                             
                  :WKDPTC-FSCL-WK-NBR                                           
                 ,:WKDPTC-FSCL-WK-END-DTE                                       
                 ,:WKDPTC-SLS-RTL-AMT                                           
                 ,:WKDPTC-MKDN-PLU-RTL-AMT                                      
                 ,:WKDPTC-MKDN-RGST-RTL-AMT                                     
                 ,:WKDPTC-MKDN-UMTCH-RTL-AMT                                    
                 ,:WKDPTC-MKDN-BYR-RTL-AMT                                      
                 ,:WKDPTC-MKDN-STR-RTL-AMT                                      
                 ,:WKDPTC-MKUP-RTL-AMT                                          
                 ,:WKDPTC-XFER-IN-RTL-AMT                                       
                 ,:WKDPTC-XFER-OUT-RTL-AMT                                      
                 ,:WKDPTC-RCPT-RTL-AMT                                          
                 ,:WKDPTC-RCPT-NET-COST-AMT                                     
                 ,:WKDPTC-PADJ-RTL-AMT                                          
                 ,:WKDPTC-PADJ-NET-COST-AMT                                     
                 ,:WKDPTC-INV-ADJ-RTL-AMT                                       
                 ,:WKDPTC-SHNK-RTL-AMT                                          
                 ,:WKDPTC-END-INV-RTL-AMT                                       
                 ,:WKDPTC-END-INV-COST-AMT                                      
                 ,:WKDPTC-GRO-MRGN-AMT                                          
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   SET PS-END-OF-TYWKDPT-CSR TO TRUE                            
               WHEN OTHER                                                       
                   MOVE '8410-FETCH-TYWKDPT-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'FETCH TYWKDPT-CSR'     TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8420-SELECT-COMP-SLS.                                                    
                                                                                
           EXEC SQL                                                             
               SELECT SUM(B.SLS_RTL_AMT)                                        
               INTO                                                             
                 :WKSCLS-SLS-RTL-AMT  :PV-NULL-INDICATOR                        
W26603         FROM (SELECT A.LOC_NBR  AS COMP_STORE_NO_INT                     
W26603               FROM  XMT_LOC A                                            
W26603               WHERE A.MN_SLS_INCL_DTE  <= :TY-FSCL-MN-END-DTE            
W26603                 AND A.E_BUS_IND         = 'Y')                           
                     AS COMPSTORE                                               
               JOIN TWKSCLS B                                                   
               ON B.STR_NBR = COMPSTORE.COMP_STORE_NO_INT                       
               WHERE                                                            
                   B.FSCL_WK_NBR      = :WKDPTC-FSCL-WK-NBR                     
               AND B.FSCL_WK_END_DTE  = :WKDPTC-FSCL-WK-END-DTE                 
               AND B.DEPT_NBR         = :MDSEAR-DEPT-NBR                        
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   IF PV-NULL-INDICATOR < 0                                     
                      MOVE ZEROS TO WKSCLS-SLS-RTL-AMT                          
                   END-IF                                                       
               WHEN OTHER                                                       
                   MOVE '8420-SELECT-COMP-SLS'  TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT '               TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8430-SELECT-WK-IN-MN.                                                    
                                                                                
           EXEC SQL                                                             
               SELECT WK_IN_MN_NBR                                              
                     ,FSCL_MN_BEG_DTE                                           
                     ,FSCL_MN_END_DTE                                           
               INTO                                                             
                 :DTATTR-WK-IN-MN-NBR                                           
                ,:DTATTR-FSCL-MN-BEG-DTE                                        
                ,:DTATTR-FSCL-MN-END-DTE                                        
               FROM TDTATTR                                                     
               WHERE                                                            
                     KY_DTE            = :DTATTR-KY-DTE                         
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8430-SELECT-WK-IN-MN'  TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT '               TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8440-SELECT-ONORD.                                                       
                                                                                
           EXEC SQL                                                             
               SELECT SUM(B.ONORD_RTL_AMT)                                      
               INTO :WKSCLS-ONORD-RTL-AMT :PV-NULL-INDICATOR                    
W26603         FROM (SELECT A.LOC_NBR  AS COMP_STORE_NO_INT                     
W26603               FROM  XMT_LOC A                                            
W26603               WHERE A.MN_SLS_INCL_DTE  <= :TY-FSCL-MN-END-DTE            
W26603                 AND A.E_BUS_IND         = 'Y')                           
                     AS COMPSTORE                                               
               JOIN TWKSCLS B                                                   
               ON B.STR_NBR = COMPSTORE.COMP_STORE_NO_INT                       
               WHERE                                                            
                   B.FSCL_WK_NBR      = :WKDPTC-FSCL-WK-NBR                     
               AND B.FSCL_WK_END_DTE  = :WKDPTC-FSCL-WK-END-DTE                 
               AND B.DEPT_NBR         = :MDSEAR-DEPT-NBR                        
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   IF PV-NULL-INDICATOR < 0                                     
                      MOVE ZEROS TO WKSCLS-ONORD-RTL-AMT                        
                   END-IF                                                       
               WHEN OTHER                                                       
                   MOVE '8440-SELECT-ONORD   '  TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT '               TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8450-CLOSE-TYWKDPT-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               CLOSE TYWKDPT-CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8450-CLOSE-TYWKDPT-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'CLOSE TYWKDPT-CSR'     TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8500-OPEN-LYWKDPTC-CSR.                                                  
                                                                                
           EXEC SQL                                                             
                OPEN LYWKDPTC-CSR                                               
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8200-OPEN-TYWKDPT-CSR'                                 
                                            TO PV-PARAGRAPH-NAME                
                   MOVE 'OPEN TYWKDPT-CSR' TO PV-DB2-OPER-ATTEMPTED             
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8510-FETCH-LYWKDPTC-CSR.                                                 
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   LYWKDPTC-CSR                                                 
               INTO                                                             
                  :WKDPTC-FSCL-WK-NBR                                           
                 ,:WKDPTC-FSCL-WK-END-DTE                                       
                 ,:WKDPTC-SLS-RTL-AMT                                           
                 ,:WKDPTC-MKDN-PLU-RTL-AMT                                      
                 ,:WKDPTC-MKDN-RGST-RTL-AMT                                     
                 ,:WKDPTC-MKDN-UMTCH-RTL-AMT                                    
                 ,:WKDPTC-MKDN-BYR-RTL-AMT                                      
                 ,:WKDPTC-MKDN-STR-RTL-AMT                                      
                 ,:WKDPTC-MKUP-RTL-AMT                                          
                 ,:WKDPTC-XFER-IN-RTL-AMT                                       
                 ,:WKDPTC-XFER-OUT-RTL-AMT                                      
                 ,:WKDPTC-RCPT-RTL-AMT                                          
                 ,:WKDPTC-RCPT-NET-COST-AMT                                     
                 ,:WKDPTC-PADJ-RTL-AMT                                          
                 ,:WKDPTC-PADJ-NET-COST-AMT                                     
                 ,:WKDPTC-INV-ADJ-RTL-AMT                                       
                 ,:WKDPTC-SHNK-RTL-AMT                                          
                 ,:WKDPTC-END-INV-RTL-AMT                                       
                 ,:WKDPTC-END-INV-COST-AMT                                      
                 ,:WKDPTC-GRO-MRGN-AMT                                          
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   SET PS-END-OF-LYWKDPTC-CSR TO TRUE                           
               WHEN OTHER                                                       
                   MOVE '8410-FETCH-LYWKDPTC-CSR' TO PV-PARAGRAPH-NAME          
                   MOVE 'FETCH LYWKDPTC-CSR'    TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8550-CLOSE-LYWKDPTC-CSR.                                                 
                                                                                
           EXEC SQL                                                             
               CLOSE LYWKDPTC-CSR                                               
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8450-CLOSE-LYWKDPTC-CSR' TO PV-PARAGRAPH-NAME          
                   MOVE 'CLOSE LYWKDPTC-CSR'    TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8600-OPEN-TMNDPLN-CSR.                                                   
                                                                                
           EXEC SQL                                                             
                OPEN TMNDPLN-CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8600-OPEN-TMNDPLN-CSR'                                 
                                            TO PV-PARAGRAPH-NAME                
                   MOVE 'OPEN TMNDPLN-CSR'  TO PV-DB2-OPER-ATTEMPTED            
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8610-FETCH-TMNDPLN-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   TMNDPLN-CSR                                                  
               INTO                                                             
                  :MNDPLN-FSCL-MN-NBR                                           
                 ,:MNDPLN-FSCL-MN-END-DTE                                       
                 ,:MNDPLN-SLS-RTL-AMT                                           
                 ,:MNDPLN-MKDN-RTL-AMT                                          
                 ,:MNDPLN-RCPT-RTL-AMT                                          
                 ,:MNDPLN-SHNK-RTL-AMT                                          
                 ,:MNDPLN-END-INV-RTL-AMT                                       
                 ,:MNDPLN-MKUP-PCT                                              
                 ,:MNDPLN-GRO-MRGN-AMT                                          
                 ,:MNDPLN-PADJ-RTL-AMT                                          
                 ,:MNDPLN-BEG-INV-RTL-AMT                                       
                 ,:MNDPLN-CMPR-STR-SLS-AMT                                      
                 ,:MNDPLN-CUM-MKUP-PCT                                          
                 ,:MNDPLN-PADJ-NET-COST-AMT                                     
                 ,:MNDPLN-RCPT-NET-COST-AMT                                     
21517            ,:MNDPLN-CMPR-END-INV-AMT                                      
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   SET PS-END-OF-TMNDPLN-CSR TO TRUE                            
               WHEN OTHER                                                       
                   MOVE '8610-FETCH-TMNDPLN-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'FETCH TMNDPLN-CSR'     TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8620-CLOSE-TMNDPLN-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               CLOSE TMNDPLN-CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8620-CLOSE-TMNDPLN-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'CLOSE TMNDPLN-CSR'     TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8630-OPEN-TMNDOTB-CSR.                                                   
                                                                                
           EXEC SQL                                                             
                OPEN TMNDOTB-CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8630-OPEN-TMNDOTB-CSR'                                 
                                            TO PV-PARAGRAPH-NAME                
                   MOVE 'OPEN TMNDOTB-CSR'  TO PV-DB2-OPER-ATTEMPTED            
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8640-FETCH-TMNDOTB-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   TMNDOTB-CSR                                                  
              INTO                                                              
                  :MNDOTB-FSCL-MN-NBR                                           
                 ,:MNDOTB-FSCL-MN-END-DTE                                       
                 ,:MNDOTB-SLS-RTL-AMT                                           
                 ,:MNDOTB-MKDN-RTL-AMT                                          
                 ,:MNDOTB-RCPT-RTL-AMT                                          
                 ,:MNDOTB-SHNK-RTL-AMT                                          
                 ,:MNDOTB-END-INV-RTL-AMT                                       
                 ,:MNDOTB-TOT-ORD-RTL-AMT                                       
                 ,:MNDOTB-APP-ORD-RTL-AMT                                       
                 ,:MNDOTB-GRO-MRGN-AMT                                          
                 ,:MNDOTB-RCPT-NET-COST-AMT                                     
                 ,:MNDOTB-PADJ-NET-COST-AMT                                     
                 ,:MNDOTB-PADJ-RTL-AMT                                          
                 ,:MNDOTB-BEG-INV-RTL-AMT                                       
                                                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   SET PS-END-OF-TMNDOTB-CSR TO TRUE                            
               WHEN OTHER                                                       
                   MOVE '8640-FETCH-TMNDOTB-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'FETCH TMNDOTB-CSR'     TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8650-CLOSE-TMNDOTB-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               CLOSE TMNDOTB-CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8650-CLOSE-TMNDOTB-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'CLOSE TMNDOTB-CSR'     TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8660-OPEN-TWKDPLN-CSR.                                                   
                                                                                
           EXEC SQL                                                             
                OPEN TYWKDPLN-CSR                                               
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8660-OPEN-TWKDPLN-CSR'                                 
                                            TO PV-PARAGRAPH-NAME                
                   MOVE 'OPEN TYWKDPLN-CSR'  TO PV-DB2-OPER-ATTEMPTED           
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8670-FETCH-TWKDPLN-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   TYWKDPLN-CSR                                                 
               INTO                                                             
                  :WKDPLN-FSCL-WK-NBR                                           
                 ,:WKDPLN-FSCL-WK-END-DTE                                       
                 ,:WKDPLN-SLS-RTL-AMT                                           
                 ,:WKDPLN-MKDN-RTL-AMT                                          
                 ,:WKDPLN-RCPT-RTL-AMT                                          
                 ,:WKDPLN-SHNK-RTL-AMT                                          
                 ,:WKDPLN-END-INV-RTL-AMT                                       
21517            ,:WKDPLN-PADJ-RTL-AMT                                          
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   SET PS-END-OF-TYWKDPLN-CSR TO TRUE                           
               WHEN OTHER                                                       
                   MOVE '8670-FETCH-TWKDPLN-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'FETCH TYWKDPLN-CSR'   TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8680-CLOSE-TWKDPLN-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               CLOSE TYWKDPLN-CSR                                               
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8680-CLOSE-TWKDPLN-CSR' TO PV-PARAGRAPH-NAME           
                   MOVE 'CLOSE TYWKDPLN-CSR'   TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8690-SELECT-MNDPLN.                                                      
           EXEC SQL                                                             
              SELECT                                                            
                   SLS_RTL_AMT                                                  
                  ,MKDN_RTL_AMT                                                 
                  ,SHNK_RTL_AMT                                                 
              INTO                                                              
                  :MNDPLN-SLS-RTL-AMT                                           
                 ,:MNDPLN-MKDN-RTL-AMT                                          
                 ,:MNDPLN-SHNK-RTL-AMT                                          
                FROM TMNDPLN                                                    
                WHERE FSCL_MN_END_DTE = :MNDPLN-FSCL-MN-END-DTE                 
                  AND DEPT_NBR        = :MDSEAR-DEPT-NBR                        
31355             AND CHNL_CDE        = 'V'                                     
W26603        WITH UR                                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   MOVE PC-Y TO PS-PLAN-INFO-FOUND-SW                           
              WHEN SQLCODE = +100                                               
                   MOVE PC-N TO PS-PLAN-INFO-FOUND-SW                           
              WHEN OTHER                                                        
                   MOVE '8690-SELECT-MNDPLN'                                    
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'SELECT TMNDPLN'                                        
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8700-OPEN-LY-DPT-WK-SUP-CSR.                                             
                                                                                
           EXEC SQL                                                             
               OPEN LY-DPT-WK-SUP-CSR                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   MOVE 'N' TO PS-END-OF-LY-DPT-WK-SUP-CSR-SW                   
              WHEN OTHER                                                        
                   MOVE '8700-OPEN-LY-DPT-WK-SUP-CSR'                           
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'OPEN LY-DPT-WK-SUP-CSR'                                
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8710-FETCH-LY-DPT-WK-SUP-CSR.                                            
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   LY-DPT-WK-SUP-CSR                                            
               INTO                                                             
                   :WKDPTC-FSCL-WK-END-DTE                                      
                  ,:WKDPTC-SLS-RTL-AMT                                          
                  ,:WKDPTC-MKDN-PLU-RTL-AMT                                     
                  ,:WKDPTC-MKDN-RGST-RTL-AMT                                    
                  ,:WKDPTC-MKDN-UMTCH-RTL-AMT                                   
                  ,:WKDPTC-MKDN-BYR-RTL-AMT                                     
                  ,:WKDPTC-MKDN-STR-RTL-AMT                                     
                  ,:WKDPTC-SHNK-RTL-AMT                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN SQLCODE = +100                                               
                   SET PS-END-OF-LY-DPT-WK-SUP-CSR TO TRUE                      
              WHEN OTHER                                                        
                   MOVE '8710-FETCH-LY-DPT-WK-SUP-CSR'                          
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'FETCH LY-DPT-WK-SUP-CSR'                               
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8750-CLOSE-LY-DPT-WK-SUP-CSR.                                            
                                                                                
           EXEC SQL                                                             
              CLOSE LY-DPT-WK-SUP-CSR                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   MOVE '8750-CLOSE-LY-DPT-WK-SUP-CSR'                          
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'CLOSE LY-DPT-WK-SUP-CSR'                               
                                               TO PV-DB2-OPER-ATTEMPTED         
                  PERFORM 9998-SQL-ABEND                                        
           END-EVALUATE.                                                        
                                                                                
       8800-OPEN-PL-DPT-WK-SUP-CSR.                                             
                                                                                
           EXEC SQL                                                             
               OPEN PL-DPT-WK-SUP-CSR                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   MOVE 'N' TO PS-END-OF-PL-DPT-WK-SUP-CSR-SW                   
              WHEN OTHER                                                        
                   MOVE '8800-OPEN-PL-DPT-WK-SUP-CSR'                           
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'OPEN PL-DPT-WK-SUP-CSR'                                
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8810-FETCH-PL-DPT-WK-SUP-CSR.                                            
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   PL-DPT-WK-SUP-CSR                                            
               INTO                                                             
                   :WKDPLN-FSCL-WK-END-DTE                                      
                  ,:WKDPLN-SLS-RTL-AMT                                          
                  ,:WKDPLN-MKDN-RTL-AMT                                         
                  ,:WKDPLN-SHNK-RTL-AMT                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN SQLCODE = +100                                               
                   SET PS-END-OF-PL-DPT-WK-SUP-CSR TO TRUE                      
              WHEN OTHER                                                        
                   MOVE '8810-FETCH-PL-DPT-WK-SUP-CSR'                          
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'FETCH PL-DPT-WK-SUP-CSR'                               
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8820-CLOSE-PL-DPT-WK-SUP-CSR.                                            
                                                                                
           EXEC SQL                                                             
              CLOSE PL-DPT-WK-SUP-CSR                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   MOVE '8820-CLOSE-PL-DPT-WK-SUP-CSR'                          
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'CLOSE PL-DPT-WK-SUP-CSR'                               
                                               TO PV-DB2-OPER-ATTEMPTED         
                  PERFORM 9998-SQL-ABEND                                        
           END-EVALUATE.                                                        
                                                                                
       8850-OPEN-FC-DPT-MN-SUP-CSR.                                             
                                                                                
           EXEC SQL                                                             
               OPEN FC-DPT-MN-SUP-CSR                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   MOVE 'N' TO PS-END-OF-FC-DPT-MN-SUP-CSR-SW                   
              WHEN OTHER                                                        
                   MOVE '8850-OPEN-FC-DPT-MN-SUP-CSR'                           
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'OPEN FC-DPT-MN-SUP-CSR'                                
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8860-FETCH-FC-DPT-MN-SUP-CSR.                                            
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   FC-DPT-MN-SUP-CSR                                            
               INTO                                                             
                   :MNDOTB-FSCL-MN-END-DTE                                      
                  ,:MNDOTB-SLS-RTL-AMT                                          
                  ,:MNDOTB-MKDN-RTL-AMT                                         
                  ,:MNDOTB-SHNK-RTL-AMT                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN SQLCODE = +100                                               
                   SET PS-END-OF-FC-DPT-MN-SUP-CSR TO TRUE                      
              WHEN OTHER                                                        
                   MOVE '8860-FETCH-FC-DPT-MN-SUP-CSR'                          
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'FETCH FC-DPT-MN-SUP-CSR'                               
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8870-CLOSE-FC-DPT-MN-SUP-CSR.                                            
                                                                                
           EXEC SQL                                                             
              CLOSE FC-DPT-MN-SUP-CSR                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   MOVE '8870-CLOSE-FC-DPT-MN-SUP-CSR'                          
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'CLOSE FC-DPT-MN-SUP-CSR'                               
                                               TO PV-DB2-OPER-ATTEMPTED         
                  PERFORM 9998-SQL-ABEND                                        
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8900-OPEN-FSCL-MN-CSR.                                                   
                                                                                
           EXEC SQL                                                             
               OPEN FSCL-MN-CSR                                                 
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   MOVE 'N' TO PS-END-OF-FSCL-MN-CSR-SW                         
              WHEN OTHER                                                        
                   MOVE '8900-OPEN-FSCL-MN-CSR'                                 
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'OPEN FSCL-MN-CSR'                                      
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8910-FETCH-FSCL-MN-CSR.                                                  
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   FSCL-MN-CSR                                                  
               INTO                                                             
                   :DTATTR-FSCL-MN-NBR                                          
                  ,:DTATTR-FSCL-MN-END-DTE                                      
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN SQLCODE = +100                                               
                   SET PS-END-OF-FSCL-MN-CSR TO TRUE                            
              WHEN OTHER                                                        
                   MOVE '8910-FETCH-FSCL-MN-CSR'                                
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'FETCH FSCL-MN-CSR'                                     
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8920-CLOSE-FSCL-MN-CSR.                                                  
                                                                                
           EXEC SQL                                                             
              CLOSE FSCL-MN-CSR                                                 
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   MOVE '8920-CLOSE-FSCL-MN-CSR'                                
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'CLOSE FSCL-MN-CSR'                                     
                                               TO PV-DB2-OPER-ATTEMPTED         
                  PERFORM 9998-SQL-ABEND                                        
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8930-OPEN-WKDPTC-INV-CSR.                                                
                                                                                
           EXEC SQL                                                             
               OPEN WKDPTC-INV-CSR                                              
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   MOVE 'N' TO PS-END-OF-WKDPTC-INV-CSR-SW                      
              WHEN OTHER                                                        
                   MOVE '8930-OPEN-WKDPTC-INV-CSR'                              
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'OPEN WKDPTC-INV-CSR'                                   
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8940-FETCH-WKDPTC-INV-CSR.                                               
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   WKDPTC-INV-CSR                                               
               INTO                                                             
                   :WKDPTC-FSCL-WK-NBR                                          
                  ,:WKDPTC-END-INV-RTL-AMT                                      
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN SQLCODE = +100                                               
                   SET PS-END-OF-WKDPTC-INV-CSR TO TRUE                         
              WHEN OTHER                                                        
                   MOVE '8940-FETCH-FSCL-MN-CSR'                                
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'FETCH WKDPTC-INV-CSR'                                  
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8950-CLOSE-WKDPTC-INV-CSR.                                               
                                                                                
           EXEC SQL                                                             
              CLOSE WKDPTC-INV-CSR                                              
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   MOVE '8920-CLOSE-WKDPTC-INV-CSR'                             
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'CLOSE WKDPTC-INV-CSR'                                  
                                               TO PV-DB2-OPER-ATTEMPTED         
                  PERFORM 9998-SQL-ABEND                                        
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8960-OPEN-WKDPLN-INV-CSR.                                                
                                                                                
           EXEC SQL                                                             
               OPEN WKDPLN-INV-CSR                                              
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   MOVE 'N' TO PS-END-OF-WKDPLN-INV-CSR-SW                      
              WHEN OTHER                                                        
                   MOVE '8960-OPEN-WKDPLN-INV-CSR'                              
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'OPEN WKDPLN-INV-CSR'                                   
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8970-FETCH-WKDPLN-INV-CSR.                                               
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   WKDPLN-INV-CSR                                               
               INTO                                                             
                   :WKDPLN-FSCL-WK-NBR                                          
                  ,:WKDPLN-END-INV-RTL-AMT                                      
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN SQLCODE = +100                                               
                   SET PS-END-OF-WKDPLN-INV-CSR TO TRUE                         
              WHEN OTHER                                                        
                   MOVE '8970-FETCH-WKDPLN-INV-CSR'                             
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'FETCH WKDPLN-INV-CSR'                                  
                                               TO PV-DB2-OPER-ATTEMPTED         
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8980-CLOSE-WKDPLN-INV-CSR.                                               
                                                                                
           EXEC SQL                                                             
              CLOSE WKDPLN-INV-CSR                                              
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
              WHEN SQLCODE = ZERO                                               
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   MOVE '8980-CLOSE-WKDPLN-INV-CSR'                             
                                               TO PV-PARAGRAPH-NAME             
                   MOVE 'CLOSE WKDPLN-INV-CSR'                                  
                                               TO PV-DB2-OPER-ATTEMPTED         
                  PERFORM 9998-SQL-ABEND                                        
           END-EVALUATE.                                                        
                                                                                
                                                                                
       9998-SQL-ABEND.                                                          
                                                                                
           MOVE +4013 TO ABEND-CODE.                                            
           DISPLAY ' '.                                                         
           DISPLAY '** ABEND **         ** = SQLERROR'.                         
           DISPLAY '** PROGRAM          ** = MLKUT469'.                         
           DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.               
           DISPLAY '** OPERATION        ** = ' PV-DB2-OPER-ATTEMPTED.           
                                                                                
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
           COPY DPPD004.                                                        
                                                                                
           PERFORM 9999-ABEND.                                                  
                                                                                
                                                                                
       9999-ABEND.                                                              
                                                                                
           CALL 'ILBOABN0' USING ABEND-CODE.                                    
