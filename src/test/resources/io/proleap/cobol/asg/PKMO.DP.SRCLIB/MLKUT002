      ******************************************************************03/27/95
00002  IDENTIFICATION DIVISION.                                         MLKUT002
00003 ******************************************************************   LV002
00004 *                                                                 MLKUT002
00005  PROGRAM-ID.    MLKUT002.                                         MLKUT002
00006  AUTHOR.        RICK A. WALTON.                                   MLKUT002
00007  INSTALLATION.  KOHL'S DEPARTMENT STORES.                         MLKUT002
00008  DATE-WRITTEN.  1/20/89.                                          MLKUT002
00009  DATE-COMPILED.                                                   MLKUT002
00010 *                                                                 MLKUT002
00011 ******************************************************************MLKUT002
00012 *  THIS PROGRAM READS THE SORTED HISTORY WORK FILE.  IT EDITS    *MLKUT002
00013 *  THE INPUT DATA ENSURING THAT THE TRANSFERS ARE FROM STORES    *MLKUT002
00014 *  SERVED BY THE SAME FINANCIAL COMPANY AND THAT THE STORE NUM-  *MLKUT002
00015 *  BERS ARE VALID.  RECORDS FAILING THIS EDIT WILL BE DROPPED    *MLKUT002
00016 *  AND LISTED ON THE DETAIL REPORT AS ERRORS.  ALL RECORDS THAT  *MLKUT002
00017 *  PASS THE EDIT WILL BE WRITTEN TO THE VALID OUTPUT FILE AND    *MLKUT002
00018 *  THE VALID RECORDS' DETAIL WILL BE PRINTED ON THE REPORT.      *MLKUT002
00019 *                                                                *MLKUT002
00020 *  INPUT SORTED BY TRANSFER DOCUMENT NUMBER AND TRANSFER DATE    *MLKUT002
00021 *                                                                *MLKUT002
00022 * PROGRAM CHANGE - 3/3/92                                        *MLKUT002
00023 *    BRUCE JOHNSON - PLATINUM               WR#1807              *MLKUT002
00024 *        ADDED LOGIC TO VERIFY THE DEPT/CLASS AGAINST THE MBS IF *MLKUT002
00025 *        NOT FOUND ON THE SKU TABLE.  IF FOUND, THE SKU IS       *MLKUT002
00026 *        CONSIDERED VALID.                                       *MLKUT002
00027 *                                                                *MLKUT002
00028 * PROGRAM CHANGE - 2/17/92                                       *MLKUT002
00029 *    BRUCE JOHNSON - PLATINUM               WR#1807              *MLKUT002
00030 *        ADDED LOGIC TO TRACE RENUMBERED SKU'S (STATUS CODE 98   *MLKUT002
00031 *        ON SKU TABLE). IF THE SKU IN THE INPUT FILE IS FOUND TO *MLKUT002
00032 *        BE RENUMBERED, THE NEW SKU IS FOUND AND THE DEPARTMENT  *MLKUT002
00033 *        AND CLASS PORTION OF THE SKU ARE MOVED TO THE           *MLKUT002
00034 *        REPORT  AS WELL AS THE OUTPUT FILE.  THE REPORT LISTS   *MLKUT002
00035 *        BOTH THE NEW DPT/CLS AND THE OLD DPT/CLS.     IF THE    *MLKUT002
00036 *        SKU IS NOT FOUND ON THE SKU TABLE, A SECOND ATTEMPT TO  *MLKUT002
00037 *        VALIDATE THE DEPARTMENT/CLASS PORTION OF THE SKU IS     *MLKUT002
00038 *        MADE.  IF THE DEPARTMENT/CLASS IS FOUND ON THE SKU      *MLKUT002
00039 *        TABLE, A WARNING MESSSAGE IS DISPLAYED ON THE REPORT AND*MLKUT002
00040 *        THE RECORD IS PROCESSED NORMALLY (IT WILL LATER BE      *MLKUT002
00041 *        FLAGGED AS INVALID IN THE FASHION SALES SYSTEM).  IF    *MLKUT002
00042 *        THE DPT/CL IS INVALID, AN ERROR MESSAGE IS DISPLAYED    *MLKUT002
00043 *        AND FURTHER PROCESSING FOR THAT RECORD IS BYPASSED.     *MLKUT002
      *                                                                         
MC0698* PROGRAM CHANGE - 6/18/98                                       *MLKUT002
MC0698*    MARY ELLEN CAMPBELL                    WR#6041              *MLKUT002
MC0698*        REMOVED HARD CODED CENTURY DATE IN PROGRAM VARIABLES    *        
MC0698*        FOR THE PURPOSE OF Y2K COMPLIANCE.  ADDED Y2K WINDOWING *        
MC0698*        TECHNIQUE WHERE CENTURY IS BEING SET.                   *        
      *                                                                *        
      *    JIM SHIFF - 12/28/99                   WR#5701              *        
      *        REMOVE REFERENCE TO DJDE PRINTING FUNCTION              *        
      *                                                                *        
      ******************** HISTORY OF CHANGES **************************        
      * CHG ID/                                                        *        
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *        
      * -------  ----------  ----------------------------------------  *        
      * 21731    12-04-2001  CHANGE MODULE FOR NON-INTELLIGENT SKU     *        
      *                      BY ADDING COLUMNS TO REPORT FOR NI-SKU    *        
      *                      AND ACCESSING TSKXREF FOR VARIOUS SKU ATTR*        
      *                      ALSO EXPANDED THE REPORT TO 150 CHARS.    *        
      * 21731A   08-06-2002  UPDATE PROGRAM TO CORRECT DEPT/CLASS      *        
      *                      BEING CLEARED/ZEROED.                     *        
570721* 570721   11-08-2002  FIRE STORE 016 TO 811 CHANGES.            *        
570721*                      1.  NI-SKU CHANGES.                       *        
570721*                      2.  BREAKS AT DEPT/MAJ CLASS CHANGE       *        
570721*                      3.  SUMMARY REPORT (RPT02)                *        
570721*                      -ROD JANSSEN                              *        
W21731* WR21731  11-08-2002  MODIFY TO USE TSKXREF INSTEAD OF TSK      *        
W21731*                      ALSO USE MLRD019 INSTEAD OF MLRD005I.     *        
      * 21731C   07-22-2003  ADD LOGIC TO LOOK UP SYSTEM PRICE AND     *        
      *                      CREATE A NEW REPORT THAT SHOW RECORDS     *        
      *                      WITH SYSTEM PRICE DIFFERENT FROM          *        
      *                      TRANSACTION.  FIX A FEW MINOR BUGS IN     *        
      *                      REPORT FROM NONINTELLIGENT SKU CHANGES.   *        
      * 21731S   08-14-2003  ADD BACK A TOTALING PIECE THAT WAS REMOVED*        
      *                      FOR THE INDIVIDUAL RETAIL COLUMN. USERS   *        
      *                      WANT EXTENDED COLUMN SUMMARIZED AS WELL   *        
      *                      A SUMMARY TOTAL FOR NON-EXTENDED RETAIL.  *        
      *                      REPORT FROM NONINTELLIGENT SKU CHANGES.   *        
      * 21732    08-29-2003  REMOVE BREAKING LOGIC BETWEEN DOC NBRS AND*        
      *                      RETAIN THE BATCH-LEVELS BREAKS. S.JACKSON *        
RM0202* RM0202   02-02-2004  EXPAND RETAIL PRICE ON THE REPORT.        *        
SJ0210* SJ0210   02-10-2004  CHANGE REPORT BREAKING TO SEPARATE BY     *        
SJ0210*                      BATCH NUMBER. FORCE AN EMPTY PAGE IF PRIOR*        
SJ0210*                      BATCH NUMBER ENDED ON AN ODD PAGE.        *        
      * W26606   04-06-2004  LOSS PREVENTION HAS REQUESTED THE ORDER OF         
      *                      THIS REPORT TO BE BY BATCH,DATE,TRAN,SKU           
      *                      AND SUBTOTAL BY DATE WITHIN BATCH NUMBER           
W26603* W26603  04-06-2004 ROD JANSSEN MERCH LEDGER STORE EXPANSION             
S26603* S26603  05-14-2004 S. JACKSON. CHANGE XMTLOC_CSR FOR DC_ASGNMT.         
S26603*                    ALTER MAX(EFF_BEG_DTE) TO BE A DATE LESS THAN        
S26603*                    THE CURRENT DATE. PREVENTS PICKING UP FUTURE         
S26603*                    DC ASSGINMENT-CAUSING TRANS TO FAIL BY DATE.         
S26603*                    ALSO INCREASE DT-MSG-DATA AREA BY 2 BYTES            
S26603*                    AND MODIFY DT-MESSAGE LENGTH TO FIT ON RPT.          
W26006* W26006  02-24-2005 ERIN SEARL. REMOVE REFERENCES TO OBSOLETE            
W26006*                                STORE TABLE.                             
PM3403* PM3403  04-20-2012 LARGE RETAIL RECOMPILE ONLY(MLRD019)            CL**6
PM3403*                      S. JACKSON                                    CL**6
P52621* P52621  02-25-2015 COGNIZANT EXPAND RETAIL PRICE ON THE REPORT.         
00044 ******************************************************************MLKUT002
00046 *                                                                 MLKUT002
00048  ENVIRONMENT DIVISION.                                            MLKUT002
00051  CONFIGURATION SECTION.                                           MLKUT002
00053  SOURCE-COMPUTER.  IBM-3090.                                      MLKUT002
00054  OBJECT-COMPUTER.  IBM-3090.                                      MLKUT002
00056  INPUT-OUTPUT SECTION.                                            MLKUT002
00058  FILE-CONTROL.                                                    MLKUT002
00059      SELECT TRANSFER-FILE                                         MLKUT002
00060          ASSIGN TO INP01.                                         MLKUT002
00061      SELECT VALID-TRANSFER-FILE                                   MLKUT002
00062          ASSIGN TO OUT01.                                         MLKUT002
00063      SELECT TRANSFER-DETAIL-REPORT                                MLKUT002
00064          ASSIGN TO RPT01.                                         MLKUT002
21731C     SELECT TRANSFER-PRICE-EXCEPTION-RPT                                  
21731C         ASSIGN TO RPT02.                                                 
00065 *                                                                 MLKUT002
00066 ******************************************************************MLKUT002
00067  DATA DIVISION.                                                   MLKUT002
00068 ******************************************************************MLKUT002
00069 *                                                                 MLKUT002
00070  FILE SECTION.                                                    MLKUT002
00071  FD  TRANSFER-FILE                                                MLKUT002
00072      RECORDING MODE IS F                                          MLKUT002
00073      LABEL RECORDS ARE STANDARD                                   MLKUT002
00074      RECORD CONTAINS 80 CHARACTERS                                MLKUT002
00075      BLOCK CONTAINS 0 RECORDS                                     MLKUT002
00076      DATA RECORD IS TRANSFER-RECORD.                              MLKUT002
00077  01  TRANSFER-RECORD                PIC X(80).                    MLKUT002
00078 *                                                                 MLKUT002
00079  FD  VALID-TRANSFER-FILE                                          MLKUT002
00080      RECORDING MODE IS F                                          MLKUT002
00081      LABEL RECORDS ARE STANDARD                                   MLKUT002
00082      RECORD CONTAINS 80 CHARACTERS                                MLKUT002
00083      BLOCK CONTAINS 0 RECORDS                                     MLKUT002
00084      DATA RECORD IS VALID-TRANSFER-RECORD.                        MLKUT002
00085  01  VALID-TRANSFER-RECORD          PIC X(80).                    MLKUT002
00086 *                                                                 MLKUT002
00087  FD  TRANSFER-DETAIL-REPORT                                       MLKUT002
00088      RECORDING MODE IS F                                          MLKUT002
00089      LABEL RECORDS ARE OMITTED                                    MLKUT002
21731      RECORD CONTAINS 150 CHARACTERS                               MLKUT002
00091      BLOCK CONTAINS 0 RECORDS                                     MLKUT002
00092      DATA RECORD IS TRANSFER-DETAIL-LINE.                         MLKUT002
21731  01  TRANSFER-DETAIL-LINE           PIC X(150).                   MLKUT002
00094 *                                                                 MLKUT002
21731C FD  TRANSFER-PRICE-EXCEPTION-RPT                                         
21731C     RECORDING MODE IS F                                                  
21731C     LABEL RECORDS ARE OMITTED                                            
21731C     RECORD CONTAINS 150 CHARACTERS                                       
21731C     BLOCK CONTAINS 0 RECORDS                                             
21731C     DATA RECORD IS TRANSFER-PRICE-EXCEPTION-LINE.                        
21731C 01  TRANSFER-PRICE-EXCEPTION-LINE  PIC X(150).                           
21731C                                                                          
00095  WORKING-STORAGE SECTION.                                         MLKUT002
00096 *                                                                 MLKUT002
00097 *                                                                 MLKUT002
00098 ******************************************************************MLKUT002
00099 * THE FOLLOWING FIELDS AND COPY MEMBERS ARE USED FOR THE DB2     *MLKUT002
00100 * STORE TABLE RELATIONSHIP LOAD.                                 *MLKUT002
00101 ******************************************************************MLKUT002
00102 *                                                                 MLKUT002
00103 *     DCLGEN FOR THE DB2 STORE TABLE.                             MLKUT002
00104 *                                                                 MLKUT002
00105       EXEC SQL                                                    MLKUT002
W26603          INCLUDE XMT00001                                        MLKUT002
00107       END-EXEC.                                                   MLKUT002
                                                                        MLKUT002
W26603*                                                                 MLKUT002
W26603*     DCLGEN FOR THE DB2 XM LOCATION DC ASSIGNMENT TABLE          MLKUT002
W26603*                                                                 MLKUT002
W26603      EXEC SQL                                                    MLKUT002
W26603          INCLUDE XMT00002                                        MLKUT002
W26603      END-EXEC.                                                   MLKUT002
W26603                                                                  MLKUT002
21731 *                                                                 MLKUT002
21731 *     DCLGEN FOR THE DB2 SKU XREF TABLE.                          MLKUT002
21731 *                                                                 MLKUT002
21731       EXEC SQL                                                    MLKUT002
21731           INCLUDE TSKXREF                                         MLKUT002
21731       END-EXEC.                                                   MLKUT002
00115 *                                                                 MLKUT002
00109 *                                                                 MLKUT002
W21731*     DCLGEN FOR THE DB2 TUPC    TABLE.                           MLKUT002
00118 *                                                                 MLKUT002
00119       EXEC SQL                                                    MLKUT002
W21731          INCLUDE TUPC                                            MLKUT002
00121       END-EXEC.                                                   MLKUT002
W21731*                                                                 MLKUT002
W21731*                                                                 MLKUT002
W21731*     DCLGEN FOR THE DB2 TUPCPLS TABLE.                           MLKUT002
W21731*                                                                 MLKUT002
W21731      EXEC SQL                                                    MLKUT002
W21731          INCLUDE TUPCPLS                                         MLKUT002
W21731      END-EXEC.                                                   MLKUT002
21731C*                                                                         
21731C*     DCLGEN FOR THE DB2 TMITGPL (GROUP PRICING) TABLE.                   
21731C*                                                                         
21731C      EXEC SQL                                                            
21731C          INCLUDE TMITGPL                                                 
21731C      END-EXEC.                                                           
W21731*                                                                 MLKUT002
W21731*                                                                 MLKUT002
W21731*     DCLGEN FOR THE DB2 TMDARVS TABLE.                           MLKUT002
W21731*                                                                 MLKUT002
W21731      EXEC SQL                                                    MLKUT002
W21731          INCLUDE TMDARVS                                         MLKUT002
W21731      END-EXEC.                                                   MLKUT002
W21731*                                                                 MLKUT002
W21731*                                                                 MLKUT002
00124 ******************************************************************MLKUT002
00125 *  SQL AND COBOL DECLARATIONS FOR THE                             MLKUT002
00126 *  MERCHANDISE AREA TABLE (TMDSEAR)                               MLKUT002
00127 ******************************************************************MLKUT002
00128                                                                   MLKUT002
00129      EXEC SQL                                                     MLKUT002
00130          INCLUDE TMDSEAR                                          MLKUT002
00131      END-EXEC.                                                    MLKUT002
00132                                                                   MLKUT002
00133 ******************************************************************MLKUT002
00134 *  SQL AND COBOL DECLARATIONS FOR THE                             MLKUT002
00135 *  APPLICATION AVAILABILITY TABLE (TAPLAVL)                       MLKUT002
00136 ******************************************************************MLKUT002
00137                                                                   MLKUT002
00138      EXEC SQL                                                     MLKUT002
00139          INCLUDE TAPLAVL                                          MLKUT002
00140      END-EXEC.                                                    MLKUT002
00141                                                                   MLKUT002
00142 **************************************************************    MLKUT002
00143 * THIS TABLE CONTAINS INFORMATION ABOUT A PARTICULAR STORE   *    MLKUT002
00144 * AND HOW IT RELATES AS TO ITS POSITION IN THE FASHION SALES *    MLKUT002
00145 * WEEKEND REPORTING EXTRACT FILES. THIS TABLE IS DYNAMICALLY *    MLKUT002
00146 * LOADED FROM THE DB2 STORE TABLE.                           *    MLKUT002
00147 **************************************************************    MLKUT002
00148  01  ST2-STORE-VALUES.                                            MLKUT002
W26603     05  ST2-STORE-IDENTITY        OCCURS 9999 TIMES.             MLKUT002
00150          10  ST2-OP-CO-NMBR        PIC 9(03).                     MLKUT002
W26603         10  ST2-STORE-NMBR        PIC 9(05).                     MLKUT002
00152          10  ST2-DCX-RCT-START-DATE                               MLKUT002
00153                                    PIC X(10).                     MLKUT002
00154          10  ST2-FINANCE-CORP-NMBR PIC 9(03).                     MLKUT002
00155          10  ST2-FIN-CLS-DTE       PIC X(10).                     MLKUT002
                                                                                
00157 *                                                                 MLKUT002
00158 *  SQL DB2 STORE TABLE CURSOR DECLARATION                         MLKUT002
00159 *                                                                 MLKUT002
00160      EXEC SQL                                                     MLKUT002
W26603       DECLARE XMTLOC_CSR CURSOR FOR                              MLKUT002
W26603         SELECT X.LOC_NBR                                         MLKUT002
W26603               ,DC_ASGNMT.EFF_BEG_DTE                             MLKUT002
W26603               ,VALUE(X.FINCL_CLO_DTE,'9999-09-09')               MLKUT002
W26603                       AS FINCL_CLO_DTE                           MLKUT002
W26603         FROM XMT_LOC X,                                          MLKUT002
W26603              (SELECT B.LOC_NBR                                   MLKUT002
W26603                     ,MAX(B.EFF_BEG_DTE) AS EFF_BEG_DTE           MLKUT002
W26603               FROM XMT_DC_LOC_ASGMT B                            MLKUT002
S26603               WHERE EFF_BEG_DTE <= CURRENT DATE                  MLKUT002
W26603               GROUP BY B.LOC_NBR) DC_ASGNMT                      MLKUT002
W26603         WHERE X.LOC_NBR = DC_ASGNMT.LOC_NBR                      MLKUT002
W26603           AND X.LOC_TYP_CDE IN ('DS', 'CS', 'DC', 'RV')          MLKUT002
W26603         ORDER BY LOC_NBR                                         MLKUT002
00182      END-EXEC.                                                    MLKUT002
                                                                                
00177 *                                                                 MLKUT002
00178 *  COMMUNICATION AREAS FOR DB2                                    MLKUT002
00179 *                                                                 MLKUT002
00180      EXEC SQL                                                     MLKUT002
00181          INCLUDE SQLCA                                            MLKUT002
00182      END-EXEC.                                                    MLKUT002
00183 *                                                                 MLKUT002
00184      COPY SQLCA2.                                                 MLKUT002
00185 *                                                                 MLKUT002
00186 ******************************************************************MLKUT002
00187 *                                                                 MLKUT002
00188 *  INTER-STORE TRANSFER FILE LAYOUT FOR INPUT RECORDS.            MLKUT002
00189 *                                                                 MLKUT002
W26603     COPY MLRD019.                                                MLKUT002
00196 *                                                                 MLKUT002
00197 *                                                                 MLKUT002
21731 *  STANDARD HEADING 150 COLUMNS.                                  MLKUT002
00199 *                                                                 MLKUT002
21731      COPY DPWS150O.                                               MLKUT002
00201 *                                                                 MLKUT002
21731C 01  HL-HEADING-LINE-1.                                                   
21731C     05  FILLER                  PIC X(59)           VALUE SPACES.        
21731C     05  FILLER                  PIC X(30)           VALUE SPACES.        
21731C         88  HL-TRANSFER-DETAIL-RPT                  VALUE                
21731C             'INTER-STORE TRANSFERS - BATCH '.                            
21731C         88  HL-TRANSFER-PRICE-DIFF-RPT              VALUE                
21731C             'TRANSFER PRICE DIFF FOR BATCH '.                            
21731C     05  HL-BATCH                PIC X(03)           VALUE SPACES.        
21731C     05  FILLER                  PIC X(58)           VALUE SPACES.        
                                                                                
21731C 01 HL-HEADING-LINE-2.                                                    
21731C     05  FILLER                      PIC X(05)       VALUE                
21731C         'TRANS'.                                                         
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(05)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(05)       VALUE                
21731C         ' FROM'.                                                         
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(05)       VALUE                
21731C         '  TO '.                                                         
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(18)       VALUE                
21731C         '-----ORIGINAL-----'.                                            
RM0202*    05  FILLER                      PIC X(02)       VALUE SPACES.        
RM0202     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(18)       VALUE                
21731C         '----RENUMBERED----'.                                            
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(12)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
RM0202*    05  FILLER                      PIC X(10)       VALUE                
P52621     05  FILLER                      PIC X(14)       VALUE                
P52621         '       RETAIL '.                                                
P52621*    05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(18)       VALUE                
21731C         '         EXTENDED '.                                            
P52621*    05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  HL-HEADING-2-MESSAGE        PIC X(36)       VALUE SPACES.        
21731C     05  FILLER REDEFINES HL-HEADING-2-MESSAGE.                           
21731C         10  FILLER                  PIC X(13).                           
21731C             88  HL-SYS-RETAIL                       VALUE                
21731C                 '      SYSTEM '.                                         
21731C         10  FILLER                  PIC X(01).                           
21731C         10  FILLER                  PIC X(18).                           
21731C             88  HL-SYS-EXTENDED                     VALUE                
21731C                 '  EXTENDED SYSTEM '.                                    
21731C         10  FILLER                  PIC X(04).                           
                                                                                
21731C 01 HL-HEADING-LINE-3.                                                    
21731C     05  FILLER                      PIC X(05)       VALUE                
21731C         ' NBR '.                                                         
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(05)       VALUE                
21731C         ' DATE'.                                                         
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(02)       VALUE 'KM'.          
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(05)       VALUE                
21731C         'STORE'.                                                         
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(05)       VALUE                
21731C         'STORE'.                                                         
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(08)       VALUE                
21731C         '   SKU  '.                                                      
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(09)       VALUE                
21731C         'DPT-CLASS'.                                                     
RM0202*    05  FILLER                      PIC X(02)       VALUE SPACES.        
RM0202     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(08)       VALUE                
21731C         '   SKU  '.                                                      
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(09)       VALUE                
21731C         'DPT-CLASS'.                                                     
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(12)       VALUE                
21731C         '      UNITS '.                                                  
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
P52621     05  FILLER                      PIC X(13)       VALUE                
P52621         '       PRICE '.                                                 
P52621*    05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(18)       VALUE                
21731C         '           RETAIL '.                                            
P52621*    05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  HL-HEADING-3-MESSAGE        PIC X(36)       VALUE SPACES.        
21731C     05  FILLER REDEFINES HL-HEADING-3-MESSAGE.                           
21731C         10  FILLER                  PIC X(13).                           
21731C             88  HL-SYS-RETAIL-PRICE                 VALUE                
21731C                 '       PRICE '.                                         
21731C         10  FILLER                  PIC X(01).                           
21731C         10  FILLER                  PIC X(18).                           
21731C             88  HL-SYS-EXTENDED-RETAIL              VALUE                
21731C                 '           RETAIL '.                                    
21731C         10  FILLER                  PIC X(04).                           
                                                                                
21731C 01  DT-LINE-LAYOUT.                                                      
21731C     05  DT-TRANSFER-NO              PIC X(05)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  DT-DATE.                                                         
21731C         10  DT-DATE-MM              PIC Z9          VALUE ZEROES.        
21731C         10  DT-DATE-SLASH           PIC X(01)       VALUE SPACES.        
21731C         10  DT-DATE-DD              PIC 9(02)       VALUE ZEROES.        
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  DT-KOHLS-MONTH              PIC X(02)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
W26603***  05  FILLER                      PIC X(02)       VALUE SPACES.        
W26603     05  DT-FROM-STORE               PIC X(05)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
W26603***  05  FILLER                      PIC X(02)       VALUE SPACES.        
W26603     05  DT-TO-STORE                 PIC X(05)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  DT-SKU                      PIC X(08)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  DT-DEPT-CLASS.                                                   
21731C         10  DT-DEPT                 PIC 9(03)       VALUE ZEROES.        
21731C         10  DT-DEPT-CLASS-DASH      PIC X(01)       VALUE SPACES.        
21731C         10  DT-CLASS                PIC 9(02)       VALUE ZEROES.        
21731C         10  FILLER                  PIC X(01)       VALUE SPACES.        
21731C         10  FILLER                  PIC X(02)       VALUE SPACES.        
RM0202*    05  FILLER                      PIC X(02)       VALUE SPACES.        
RM0202     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  DT-RENUM-SKU                PIC X(08)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  DT-RENUM-DEPT-CLASS.                                             
21731C         10  DT-RENUM-DEPT           PIC 9(03)       VALUE ZEROES.        
21731C         10  DT-RENUM-DEPT-CLASS-DSH PIC X(01)       VALUE SPACES.        
21731C         10  DT-RENUM-CLASS          PIC 9(02)       VALUE ZEROES.        
21731C         10  FILLER                  PIC X(01)       VALUE SPACES.        
21731C         10  FILLER                  PIC X(02)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  DT-UNITS                    PIC ZZZ,ZZZ,ZZ9-                     
21731C                                                     VALUE ZEROES.        
P52621*    05  FILLER                      PIC X(01)       VALUE SPACES.        
P52621     05  DT-PRICE                    PIC ZZ,ZZZ,ZZ9.99-                   
21731C                                                     VALUE ZEROES.        
P52621*    05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  DT-EXT-PRICE                PIC ZZ,ZZZ,ZZZ,ZZ9.99-               
21731C                                                     VALUE ZEROES.        
P52621*    05  FILLER                      PIC X(02)       VALUE SPACES.        
S26603     05  DT-MESSAGE                  PIC X(36)       VALUE SPACES.        
21731C         88  DT-INVALID-STORE                        VALUE                
S26603             'INVALID STORE NBR=                  '.                      
21731C         88  DT-INVALID-SKU                          VALUE                
S26603             'INVALID SKU NBR  =                  '.                      
21731C         88  DT-WARN-INVALID-SEQ-NO                  VALUE                
S26603             'WARN-INVALID SEQ =                  '.                      
21731C         88  DT-INVALID-SEQ-NO                       VALUE                
S26603             'INVALID SEQ NBR  =                  '.                      
21731C         88  DT-INVALID-DPT-CLASS                    VALUE                
S26603             'INVALID DEPT-CLS =                  '.                      
21731C     05  FILLER REDEFINES DT-MESSAGE.                                     
S26603         10  FILLER                  PIC X(19).                           
S26603         10  DT-MSG-DATA             PIC X(17).                           
21731C     05  FILLER REDEFINES DT-MESSAGE.                                     
21731C         10  DT-SYS-PRICE            PIC Z,ZZZ,ZZZ.ZZ-.                   
21731C         10  FILLER                  PIC X(01).                           
21731C         10  DT-EXT-SYS-PRICE        PIC ZZ,ZZZ,ZZZ,ZZZ.ZZ-.              
S26603         10  FILLER                  PIC X(04).                           
                                                                        MLKUT002
21731C 01  TL-TOTAL-LINE.                                                       
21731C     05  TL-TOTAL-TRANSFER                           VALUE SPACES.        
21731C         10  FILLER                  PIC X(02).                           
21731C         10  TL-TOTAL-BATCH          PIC X(03).                           
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  TL-TOTAL-TYPE               PIC X(30)       VALUE SPACES.        
RM0202*    05  FILLER                      PIC X(32)       VALUE SPACES.        
RM0202     05  FILLER                      PIC X(31)       VALUE SPACES.        
21731C     05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  TL-TOTAL-UNITS              PIC ZZZ,ZZZ,ZZ9-                     
21731C                                                     VALUE ZEROES.        
RM0202*    05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C*    05  FILLER                      PIC X(10)       VALUE SPACES.        
P52621     05  TL-TOTAL-PRICE              PIC ZZ,ZZZ,ZZ9.99-                   
21731S                                                     VALUE ZEROES.        
21731C     05  FILLER                      PIC X(01)       VALUE SPACES.        
21731C     05  TL-TOTAL-EXT-PRICE          PIC ZZ,ZZZ,ZZZ,ZZ9.99-               
21731C                                                     VALUE ZEROES.        
P52621*    05  FILLER                      PIC X(02)       VALUE SPACES.        
21731C     05  TL-TOTAL-MESSAGE            PIC X(36)       VALUE SPACES.        
21731C     05  FILLER REDEFINES TL-TOTAL-MESSAGE.                               
21731C         10  FILLER                  PIC X(13).                           
21731C         10  FILLER                  PIC X(01).                           
21731C         10  TL-EXT-SYS-PRICE        PIC ZZ,ZZZ,ZZZ,ZZZ.ZZ-.              
21731C         10  FILLER                  PIC X(04).                           
SJ0210                                                                          
SJ0210 01  BP-BLANK-PAGE-DETAIL.                                                
SJ0210     05  FILLER                 PIC X(55)            VALUE SPACES.        
SJ0210     05  FILLER                 PIC X(40)            VALUE                
SJ0210           '  THIS PAGE IS INTENTIONALLY LEFT BLANK '.                    
SJ0210     05  FILLER                 PIC X(55)            VALUE SPACES.        
                                                                        MLKUT002
00263  01  PC-PROGRAM-CONSTANTS.                                        MLKUT002
21731C     05  PC-MAX-LINE                 PIC S9(03)      VALUE +056           
21731C                         COMP-3.                                          
00268      05  PC-SLASH                   PIC X(01)     VALUE '/'.      MLKUT002
00269      05  PC-DASH                    PIC X(01)     VALUE '-'.      MLKUT002
00272      05  PC-TRNS-ACC-TOTAL          PIC X(30)     VALUE           MLKUT002
00273          'ACCEPTED TRANSFER TOTAL       '.                        MLKUT002
00274      05  PC-TRNS-REJ-TOTAL          PIC X(30)     VALUE           MLKUT002
00275          'REJECTED TRANSFER TOTAL       '.                        MLKUT002
00276      05  PC-BTCH-ACC-TOTAL          PIC X(30)     VALUE           MLKUT002
00277          'ACCEPTED BATCH TOTAL          '.                        MLKUT002
00278      05  PC-BTCH-REJ-TOTAL          PIC X(30)     VALUE           MLKUT002
00279          'REJECTED BATCH TOTAL          '.                        MLKUT002
00280      05  PC-BTCH-TOTAL              PIC X(30)     VALUE           MLKUT002
00281          '** BATCH TOTAL                '.                        MLKUT002
00282      05  PC-GRND-ACC-TOTAL          PIC X(30)     VALUE           MLKUT002
00283          'ACCEPTED GRAND TOTAL          '.                        MLKUT002
00284      05  PC-GRND-REJ-TOTAL          PIC X(30)     VALUE           MLKUT002
00285          'REJECTED GRAND TOTAL          '.                        MLKUT002
00286      05  PC-GRND-TOTAL              PIC X(30)     VALUE           MLKUT002
00287          '** GRAND TOTAL                '.                        MLKUT002
00288      05  PC-MAX-RETRIES                  PIC S9(4)                MLKUT002
00289                                          COMP SYNC   VALUE +2.    MLKUT002
W21731     05  PC-DELETED-STATUS               PIC X(02)   VALUE '00'.  MLKUT002
W21731     05  PC-NEW-STATUS                   PIC X(02)   VALUE '10'.  MLKUT002
W21731     05  PC-PROMO-STATUS                 PIC X(02)   VALUE '40'.  MLKUT002
W21731     05  PC-DISCONTINUE-STATUS           PIC X(02)   VALUE '90'.  MLKUT002
W21731     05  PC-RENUM-STATUS                 PIC X(02)   VALUE '98'.  MLKUT002
00293      05  PC-MDSELV-CDE                   PIC X(03)   VALUE 'SCL'. MLKUT002
00294      05  PC-OPERCO-NBR                   PIC X(02)   VALUE '03'.  MLKUT002
00295      05  PC-APLSYS-CDE                   PIC X(02)   VALUE 'ML'.  MLKUT002
SJ0210     05  PC-TWO                          PIC 9(02)   VALUE 2.             
00296 *                                                                 MLKUT002
00297  01  PI-PROGRAM-INDICATORS.                                       MLKUT002
21731C     05  PI-PRICE-FOUND-SWITCH      PIC X(01)     VALUE 'N'.              
21731C         88  PI-PRICE-FOUND                       VALUE 'Y'.              
21731C         88  PI-PRICE-NOT-FOUND                   VALUE 'N'.              
00298      05  PI-TRANSFER-EOF-SWITCH     PIC X(01)     VALUE 'N'.      MLKUT002
00299          88  PI-TRANSFER-EOF                      VALUE 'Y'.      MLKUT002
00300      05  PI-INVALID-RECORD-SWITCH   PIC X(01)     VALUE 'N'.      MLKUT002
00301          88  PI-VALID-RECORD                      VALUE 'N'.      MLKUT002
00302          88  PI-INVALID-RECORD                    VALUE 'Y'.      MLKUT002
00303      05  PI-VALID-SKU-SWITCH        PIC X(01)     VALUE 'Y'.      MLKUT002
00304          88  PI-VALID-SKU                         VALUE 'Y'.      MLKUT002
00305          88  PI-INVALID-SKU                       VALUE 'N'.      MLKUT002
570721         88  PI-WARN-SEQ-NO                       VALUE 'S'.      MLKUT002
570721         88  PI-INVALID-SEQ-NO                    VALUE 'X'.      MLKUT002
00307          88  PI-INVALID-DPT-CL                    VALUE 'D'.      MLKUT002
00308      05  PI-RENUMBERED-SKU-SWITCH   PIC X(01)     VALUE 'Y'.      MLKUT002
00309          88  PI-RENUMBERED-SKU-FOUND              VALUE 'Y'.      MLKUT002
00310          88  PI-RENUMBERED-SKU-NOT-FOUND          VALUE 'N'.      MLKUT002
00311 *                                                                 MLKUT002
00312  01  PS-PROGRAM-SUBSCRIPTS.                                       MLKUT002
00313      05  PS-SUB                     PIC S9(04)    VALUE +0        MLKUT002
00314                                                   COMP.           MLKUT002
00315 *                                                                 MLKUT002
00316  01  PV-PROGRAM-VARIABLES.                                        MLKUT002
21731C     05  PV-TIMESTAMP.                                                    
21731C         10  PV-TIMESTAMP-DATE-CCYY PIC X(04)     VALUE SPACES.           
21731C         10  FILLER                 PIC X(01)     VALUE '-'.              
21731C         10  PV-TIMESTAMP-DATE-MM   PIC X(02)     VALUE SPACES.           
21731C         10  FILLER                 PIC X(01)     VALUE '-'.              
21731C         10  PV-TIMESTAMP-DATE-DD   PIC X(02)     VALUE SPACES.           
21731C         10  FILLER                 PIC X(01)     VALUE '-'.              
21731C         10  PV-TIMESTAMP-TIME      PIC X(15)     VALUE                   
21731C             '23.59.59.999999'.                                           
00317      05  PV-DATE.                                                 MLKUT002
21731C         10  PV-DATE-CCYY            PIC 9(04)       VALUE ZEROES.        
21731C         10  FILLER REDEFINES PV-DATE-CCYY.                               
21731C             15  PV-CENTURY          PIC 9(02).                           
21731C             15  PV-YEAR             PIC 9(02).                           
00320          10  FILLER                  PIC X(01)       VALUE '-'.   MLKUT002
00321          10  PV-MONTH                PIC 9(02)       VALUE ZEROES.MLKUT002
00322          10  FILLER                  PIC X(01)       VALUE '-'.   MLKUT002
00323          10  PV-DAY                  PIC 9(02)       VALUE ZEROES.MLKUT002
00324      05  PV-PREVIOUS-BATCH-NO        PIC X(03)       VALUE SPACES.MLKUT002
W26606     05  PV-PREVIOUS-TRAN-DTE        PIC X(04)       VALUE SPACES.MLKUT002
00325      05  PV-PREVIOUS-TRANSFER-NO     PIC X(05)       VALUE SPACES.MLKUT002
21731C     05  PV-LINE-TO-ADVANCE          PIC S9(04)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-PRINT-LINE-1             PIC S9(04)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-PRINT-LINE-2             PIC S9(04)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-PAGE-NUMBER-1            PIC S9(05)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-PAGE-NUMBER-2            PIC S9(05)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-DT-EXT-PRICE             PIC S9(07)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-EXCP-EXT-PRICE           PIC S9(07)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-TRANSFER-TOTALS.                                              
21731C         10  PV-TRNS-ACC-TOT-UNITS   PIC S9(07)      VALUE ZEROES         
21731C                         COMP-3.                                          
RM0202*        10  PV-TRNS-ACC-TOT-RETAIL  PIC S9(05)V99   VALUE ZEROES         
RM0202         10  PV-TRNS-ACC-TOT-RETAIL  PIC S9(08)V99   VALUE ZEROES         
21731S                         COMP-3.                                          
21731C         10  PV-TRNS-ACC-TOT-EXT     PIC S9(09)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-TRNS-REJ-TOT-UNITS   PIC S9(07)      VALUE ZEROES         
21731C                         COMP-3.                                          
RM0202*        10  PV-TRNS-REJ-TOT-RETAIL  PIC S9(05)V99   VALUE ZEROES         
RM0202         10  PV-TRNS-REJ-TOT-RETAIL  PIC S9(08)V99   VALUE ZEROES         
21731S                         COMP-3.                                          
21731C         10  PV-TRNS-REJ-TOT-EXT     PIC S9(09)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-BATCH-TOTALS.                                                 
21731C         10  PV-BTCH-ACC-TOT-UNITS   PIC S9(08)      VALUE ZEROES         
21731C                         COMP-3.                                          
RM0202*        10  PV-BTCH-ACC-TOT-RETAIL  PIC S9(05)V99   VALUE ZEROES         
RM0202         10  PV-BTCH-ACC-TOT-RETAIL  PIC S9(08)V99   VALUE ZEROES         
21731S                         COMP-3.                                          
21731C         10  PV-BTCH-ACC-TOT-EXT     PIC S9(10)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-BTCH-REJ-TOT-UNITS   PIC S9(08)      VALUE ZEROES         
21731C                         COMP-3.                                          
RM0202*        10  PV-BTCH-REJ-TOT-RETAIL  PIC S9(05)V99   VALUE ZEROES         
RM0202         10  PV-BTCH-REJ-TOT-RETAIL  PIC S9(08)V99   VALUE ZEROES         
21731S                         COMP-3.                                          
21731C         10  PV-BTCH-REJ-TOT-EXT     PIC S9(10)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-BTCH-TOT-UNITS       PIC S9(08)      VALUE ZEROES         
21731C                         COMP-3.                                          
RM0202*        10  PV-BTCH-TOT-RETAIL      PIC S9(07)V99   VALUE ZEROES         
RM0202         10  PV-BTCH-TOT-RETAIL      PIC S9(08)V99   VALUE ZEROES         
21731S                         COMP-3.                                          
21731C         10  PV-BTCH-TOT-EXT         PIC S9(10)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-GRAND-TOTALS.                                                 
21731C         10  PV-GRND-ACC-TOT-UNITS   PIC S9(09)      VALUE ZEROES         
21731C                         COMP-3.                                          
RM0202*        10  PV-GRND-ACC-TOT-RETAIL  PIC S9(05)V99   VALUE ZEROES         
RM0202         10  PV-GRND-ACC-TOT-RETAIL  PIC S9(08)V99   VALUE ZEROES         
21731S                         COMP-3.                                          
21731C         10  PV-GRND-ACC-TOT-EXT     PIC S9(11)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-GRND-REJ-TOT-UNITS   PIC S9(09)      VALUE ZEROES         
21731C                         COMP-3.                                          
RM0202*        10  PV-GRND-REJ-TOT-RETAIL  PIC S9(05)V99   VALUE ZEROES         
RM0202         10  PV-GRND-REJ-TOT-RETAIL  PIC S9(08)V99   VALUE ZEROES         
21731S                         COMP-3.                                          
21731C         10  PV-GRND-REJ-TOT-EXT     PIC S9(11)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-GRND-TOT-UNITS       PIC S9(09)      VALUE ZEROES         
21731C                         COMP-3.                                          
RM0202*        10  PV-GRND-TOT-RETAIL      PIC S9(07)V99   VALUE ZEROES         
RM0202         10  PV-GRND-TOT-RETAIL      PIC S9(08)V99   VALUE ZEROES         
21731S                         COMP-3.                                          
21731C         10  PV-GRND-TOT-EXT         PIC S9(11)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-TRNX-EXCP-TOTALS.                                             
21731C         10  PV-TRNX-ACC-TOT-UNITS   PIC S9(07)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-TRNX-ACC-TOT-EXT     PIC S9(09)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-TRNX-REJ-TOT-UNITS   PIC S9(07)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-TRNX-REJ-TOT-EXT     PIC S9(09)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-TRNXS-ACC-TOT-EXT    PIC S9(09)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-BTCHX-EXCP-TOTALS.                                            
21731C         10  PV-BTCHX-ACC-TOT-UNITS  PIC S9(08)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-BTCHX-ACC-TOT-EXT    PIC S9(10)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-BTCHX-REJ-TOT-UNITS  PIC S9(08)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-BTCHX-REJ-TOT-EXT    PIC S9(10)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-BTCHX-TOT-UNITS      PIC S9(08)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-BTCHX-TOT-EXT        PIC S9(10)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-BTCHXS-ACC-TOT-EXT   PIC S9(10)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C     05  PV-GRNDX-EXCP-TOTALS.                                            
21731C         10  PV-GRNDX-ACC-TOT-UNITS  PIC S9(09)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-GRNDX-ACC-TOT-EXT    PIC S9(11)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-GRNDX-REJ-TOT-UNITS  PIC S9(09)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-GRNDX-REJ-TOT-EXT    PIC S9(11)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-GRNDX-TOT-UNITS      PIC S9(09)      VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-GRNDX-TOT-EXT        PIC S9(11)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
21731C         10  PV-GRNDXS-ACC-TOT-EXT   PIC S9(11)V99   VALUE ZEROES         
21731C                         COMP-3.                                          
00360      05  PV-RETRY-COUNT                  PIC S9(4)                MLKUT002
00361                                          COMP SYNC   VALUE +0.    MLKUT002
W21731     05  PV-MIN-KOHLS-UPC-X.                                              
W21731         10  FILLER                PIC X(06)     VALUE '000400'.          
W21731         10  PV-MIN-KOHLS-UPC-SKU  PIC X(08)     VALUE ZEROES.            
W21731         10  FILLER                PIC X(01)     VALUE '0'.               
W21731     05  PV-MIN-KOHLS-UPC REDEFINES PV-MIN-KOHLS-UPC-X            MLKUT002
W21731                                   PIC 9(15).                             
W21731     05  PV-MIN-KOHLS-UPC-COMP     PIC S9(15)V   VALUE ZEROES             
W21731                         COMP-3.                                          
W21731     05  PV-MAX-KOHLS-UPC-X.                                              
W21731         10  FILLER                PIC X(06)     VALUE '000400'.          
W21731         10  PV-MAX-KOHLS-UPC-SKU  PIC X(08)     VALUE ZEROES.            
W21731         10  FILLER                PIC X(01)     VALUE '9'.               
W21731     05  PV-MAX-KOHLS-UPC REDEFINES PV-MAX-KOHLS-UPC-X            MLKUT002
W21731                                   PIC 9(15).                             
W21731     05  PV-MAX-KOHLS-UPC-COMP     PIC S9(15)V   VALUE ZEROES             
W21731                         COMP-3.                                          
21731      05  PV-CURRENT-SKU-NBR        PIC X(08)     VALUE SPACES.    MLKUT002
W21731     05  PV-CURRENT-SKU-NBR-9 REDEFINES PV-CURRENT-SKU-NBR                
W21731                                   PIC 9(08).                             
21731      05  PV-CURRENT-SKU-DEPT       PIC X(03)     VALUE SPACES.    MLKUT002
21731      05  PV-CURRENT-SKU-DEPT-9 REDEFINES PV-CURRENT-SKU-DEPT              
21731                                    PIC 9(03).                             
21731      05  PV-CURRENT-SKU-CLASS      PIC X(02)     VALUE SPACES.    MLKUT002
21731      05  PV-CURRENT-SKU-CLASS-9 REDEFINES PV-CURRENT-SKU-CLASS            
21731                                    PIC 9(02).                             
W21731     05  PV-DB2-TEST                 PIC S9(04)      VALUE ZEROES         
W21731                         COMP.                                            
00389      05  PV-DEPT-NBR                     PIC X(03)   VALUE SPACE. MLKUT002
00390      05  PV-MAJ-CL-NBR-WORK.                                      MLKUT002
00391          10  PV-MAJ-CL-NBR-1             PIC X(01)   VALUE SPACE. MLKUT002
00392          10  PV-MAJ-CL-NBR-2             PIC X(01)   VALUE '0'.   MLKUT002
00393      05  PV-MAJ-CL-NBR                   REDEFINES                MLKUT002
00394          PV-MAJ-CL-NBR-WORK              PIC X(02).               MLKUT002
00395      05  PV-SUB-CL-NBR-WORK.                                      MLKUT002
00396          10  PV-SUB-CL-NBR-1             PIC X(01)   VALUE '0'.   MLKUT002
00397          10  PV-SUB-CL-NBR-2-3           PIC X(02)   VALUE SPACE. MLKUT002
00398      05  PV-SUB-CL-NBR                   REDEFINES                MLKUT002
00399          PV-SUB-CL-NBR-WORK              PIC X(03).               MLKUT002
SJ0210     05  PV-HALF-PAGES                   PIC 9(10)   VALUE ZEROES.        
SJ0210     05  PV-REMAINDER-PAGES              PIC 9(10)   VALUE ZEROES.        
00400 *                                                                 MLKUT002
00401  01  ST-SYSTEM-TIME.                                              MLKUT002
00402      05  ST-SYSTEM-HOUR             PIC 9(02)     VALUE ZEROES.   MLKUT002
00403      05  ST-SYSTEM-MINUTE           PIC 9(02)     VALUE ZEROES.   MLKUT002
00404      05  FILLER                     PIC X(04)     VALUE SPACES.   MLKUT002
00405 *                                                                 MLKUT002
00406  01  SD-SYSTEM-DATE.                                              MLKUT002
00407      05  SD-SYSTEM-YEAR             PIC 9(02)     VALUE ZEROES.   MLKUT002
00408      05  SD-SYSTEM-MONTH            PIC 9(02)     VALUE ZEROES.   MLKUT002
00409      05  SD-SYSTEM-DAY              PIC 9(02)     VALUE ZEROES.   MLKUT002
00410 *                                                                 MLKUT002
       01  ABEND-CODE                     PIC S9(04)    VALUE +0        MLKUT002
00427                                                   COMP SYNC.      MLKUT002
00428 *                                                                 MLKUT002
00429 ******************************************************************MLKUT002
00430  PROCEDURE DIVISION.                                              MLKUT002
00431 ******************************************************************MLKUT002
00432 *                                                                 MLKUT002
00433 *                                                                 MLKUT002
00434  A000-MAIN-DRIVER.                                                MLKUT002
00435 ******************************************************************MLKUT002
00436 * THIS PARAGRAPH CONTROLS THE OVERALL FLOW OF THE PROGRAM.  IT   *MLKUT002
00437 * FIRST OPENS THE FILES USED AND THEN PERFORMS THE PROGRAM       *MLKUT002
00438 * INITIALIZATION ROUTINE.  THE INITIAL READ ON THE INPUT FILE IS *MLKUT002
00439 * THEN ACCOMPLISHED.  THE MAIN LOGIC PARAGRAPH IS THEN EXECUTED  *MLKUT002
00440 * UNTIL THE END OF THE INPUT FILE.  THE FINAL TOTALS ARE THEN    *MLKUT002
00441 * FORMATTED AND PRINTED.  THE FILES ARE THEN CLOSED AND THE      *MLKUT002
00442 * PROGRAM TERMINATES NORMALLY.                                   *MLKUT002
00443 ******************************************************************MLKUT002
00444      OPEN INPUT  TRANSFER-FILE                                    MLKUT002
00445           OUTPUT VALID-TRANSFER-FILE                              MLKUT002
21731C                 TRANSFER-DETAIL-REPORT                                   
21731C                 TRANSFER-PRICE-EXCEPTION-RPT.                            
00447      PERFORM B000-INITIALIZATION.                                 MLKUT002
00448      PERFORM Z000-READ-TRANSFER-FILE.                             MLKUT002
00449      PERFORM B050-PROCESS-TRANSFERS                               MLKUT002
00450          UNTIL PI-TRANSFER-EOF.                                   MLKUT002
SJ0210                                                                  MLKUT002
SJ0210     PERFORM C100-PROCESS-BATCH-BREAK.                            MLKUT002
SJ0210                                                                  MLKUT002
00451      PERFORM C200-FORMAT-GRAND-TOTALS.                            MLKUT002
21731C     PERFORM C700-FORMAT-GRNDX-TOTALS.                                    
00452      CLOSE TRANSFER-FILE                                          MLKUT002
00453            VALID-TRANSFER-FILE                                    MLKUT002
21731C           TRANSFER-DETAIL-REPORT                                         
21731C           TRANSFER-PRICE-EXCEPTION-RPT.                                  
00455      STOP RUN.                                                    MLKUT002
00456 *                                                                 MLKUT002
00457 *                                                                 MLKUT002
00458  B000-INITIALIZATION.                                             MLKUT002
00459 ******************************************************************MLKUT002
00460 * THIS PARAGRAPH PERFORMS THE INITIALIZATION REQUIRED BY PROC-   *MLKUT002
00461 * ESSING THE SYSTEM DATE AND TIME AND PREPARING THE OUTPUT       *MLKUT002
00462 * REPORT FILE TO BE PRINTED ON THE LASER PRINTER.                *MLKUT002
00463 ******************************************************************MLKUT002
00464      ACCEPT SD-SYSTEM-DATE FROM DATE.                             MLKUT002
21731      MOVE SD-SYSTEM-YEAR TO DP150O-RUN-YEAR                       MLKUT002
00466                             PV-YEAR.                              MLKUT002
MC0698     IF PV-YEAR > 80                                              L**1    
MC0698         MOVE 19 TO PV-CENTURY                                    L**1    
MC0698     ELSE                                                         L**1    
MC0698         MOVE 20 TO PV-CENTURY                                    L**1    
MC0698     END-IF.                                                              
21731      MOVE SD-SYSTEM-MONTH TO DP150O-RUN-MONTH                     MLKUT002
00468                              PV-MONTH.                            MLKUT002
21731      MOVE SD-SYSTEM-DAY TO DP150O-RUN-DAY                         MLKUT002
00470                            PV-DAY.                                MLKUT002
00471      ACCEPT ST-SYSTEM-TIME FROM TIME.                             MLKUT002
21731      MOVE ST-SYSTEM-HOUR TO DP150O-RUN-HOUR.                      MLKUT002
21731      MOVE ST-SYSTEM-MINUTE TO DP150O-RUN-MINUTE.                  MLKUT002
21731      MOVE 'MLKUT002' TO DP150O-PROGRAM-NAME.                      MLKUT002
00492      PERFORM Z050-LOAD-STORE-TABLE.                               MLKUT002
21731C     MOVE PV-DATE-CCYY TO PV-TIMESTAMP-DATE-CCYY.                         
00493 *                                                                 MLKUT002
00494 *                                                                 MLKUT002
00495  B050-PROCESS-TRANSFERS.                                          MLKUT002
00496 ******************************************************************MLKUT002
00497 * THIS PARAGRAPH IS THE MAIN LOOP LOGIC OF THE PROGRAM AND IT IS *MLKUT002
00498 * EXECUTED UNTIL THE END OF THE INPUT FILE.  CONTROL BREAKS ARE  *MLKUT002
00499 * TAKEN WHEN THE INPUT BATCH NUMBERS CHANGE AND WHEN THE INPUT   *MLKUT002
00500 * TRANSFER DOCUMENT NUMBERS CHANGE.                              *MLKUT002
00501 ******************************************************************MLKUT002
21731C     MOVE SPACES TO DT-LINE-LAYOUT.                                       
W21731     MOVE ML019-TRANSFER-BATCH-NBR TO PV-PREVIOUS-BATCH-NO.       MLKUT002
00504      PERFORM                                                      MLKUT002
00505          UNTIL PI-TRANSFER-EOF                                    MLKUT002
W21731          OR ML019-TRANSFER-BATCH-NBR NOT = PV-PREVIOUS-BATCH-NO  MLKUT002
W21731         MOVE ML019-TRANSFER-NBR TO PV-PREVIOUS-TRANSFER-NO       MLKUT002
W26606         MOVE ML019-TRANSFER-DTE TO PV-PREVIOUS-TRAN-DTE                  
00508          PERFORM                                                  MLKUT002
00509              UNTIL PI-TRANSFER-EOF                                MLKUT002
W21731              OR ML019-TRANSFER-NBR NOT =                         MLKUT002
00511                   PV-PREVIOUS-TRANSFER-NO                         MLKUT002
W21731              OR ML019-TRANSFER-BATCH-NBR NOT =                           
W21731                  PV-PREVIOUS-BATCH-NO                                    
W26606              OR (ML019-TRANSFER-NBR = PV-PREVIOUS-TRANSFER-NO            
W26606              AND ML019-TRANSFER-DTE NOT = PV-PREVIOUS-TRAN-DTE)  MLKUT002
21731C             SET PI-VALID-RECORD TO TRUE                                  
00513              PERFORM C000-FORMAT-DETAIL-LINE                      MLKUT002
21731C             PERFORM C500-REPORT-SYS-PRICE                                
21731C             IF PI-VALID-RECORD                                   MLKUT002
21731C                 IF PV-CURRENT-SKU-NBR NOT = SPACE                MLKUT002
21731                      MOVE PV-CURRENT-SKU-DEPT                     MLKUT002
W21731                         TO ML019-TRANSFER-DEPT-NBR               MLKUT002
21731                      MOVE PV-CURRENT-SKU-CLASS                    MLKUT002
W21731                         TO ML019-TRANSFER-CLASS-NBR              MLKUT002
21731                      MOVE PV-CURRENT-SKU-NBR                      MLKUT002
W21731                         TO ML019-SKU                             MLKUT002
00530                  END-IF                                           MLKUT002
21731C                 PERFORM Z150-WRITE-OUTPUT-RECORD                         
00533              END-IF                                               MLKUT002
00534              PERFORM Z000-READ-TRANSFER-FILE                      MLKUT002
00535          END-PERFORM                                              MLKUT002
00536          PERFORM C050-FORMAT-TRANS-TOTALS                         MLKUT002
21731C*        IF PV-TRNX-ACC-TOT-UNITS    > 0                                  
21731C*            OR PV-TRNX-ACC-TOT-EXT  > 0                                  
21731C*            OR PV-TRNXS-ACC-TOT-EXT > 0                                  
21731C*            PERFORM C550-FORMAT-TRANX-TOTALS                             
21731C*        END-IF                                                           
00538      END-PERFORM.                                                 MLKUT002
00539      PERFORM C150-FORMAT-BATCH-TOTALS.                            MLKUT002
21731C     IF PV-BTCHX-ACC-TOT-UNITS    > 0                                     
21731C         OR PV-BTCHX-ACC-TOT-EXT  > 0                                     
21731C         OR PV-BTCHXS-ACC-TOT-EXT > 0                                     
21731C         PERFORM C650-FORMAT-BTCHX-TOTALS                                 
21731C     END-IF.                                                              
21731C     MOVE +2 TO PV-LINE-TO-ADVANCE.                                       
00541 *                                                                 MLKUT002
00542 *                                                                 MLKUT002
00543  C000-FORMAT-DETAIL-LINE.                                         MLKUT002
00544 ******************************************************************MLKUT002
00545 * THIS PARAGRAPH FORMATS THE DETAIL LINE AND CHECKS THE VALID-   *MLKUT002
00546 * ITY OF THE TWO STORES PERFORMING THE TRANSFER ENSURING THAT    *MLKUT002
00547 * THEY ARE VALID STORE NUMBERS AND THAT THEY ARE SERVED BY THE   *MLKUT002
00548 * SAME DISTRIBUTION CENTER.  IF THESE CHECKS ARE TRUE, THE       *MLKUT002
00549 * DETAIL AMOUNTS ARE ADDED TO THE ACCEPTED ACCUMULATORS AND IF   *MLKUT002
00550 * NOT, THE DETAIL AMOUNTS ARE ADDED TO THE REJECTED ACCUMULATORS.*MLKUT002
00551 ******************************************************************MLKUT002
21731C     MOVE SPACES TO DT-MESSAGE.                                           
21731C     MOVE ML019-TRANSFER-NBR TO DT-TRANSFER-NO.                   MLKUT002
21731C     MOVE ML019-TRANSFER-MM TO DT-DATE-MM.                        MLKUT002
21731C     MOVE PC-SLASH TO DT-DATE-SLASH.                              MLKUT002
21731C     MOVE ML019-TRANSFER-DD TO DT-DATE-DD.                        MLKUT002
21731C     MOVE ML019-TRANSFER-KOHLS-MM TO DT-KOHLS-MONTH.              MLKUT002
21731C     MOVE ML019-TRANSFER-FROM-STORE-NBR TO DT-FROM-STORE.         MLKUT002
21731C     MOVE ML019-TRANSFER-TO-STORE-NBR TO DT-TO-STORE.             MLKUT002
21731C     MOVE ML019-SKU                TO DT-SKU.                     MLKUT002
21731C     MOVE ML019-TRANSFER-QTY   TO DT-UNITS.                       MLKUT002
21731C     MOVE ML019-TRANSFER-PER-UNT-RTL-AMT TO DT-PRICE.             MLKUT002
W21731     MULTIPLY ML019-TRANSFER-QTY   BY                             MLKUT002
W21731             ML019-TRANSFER-PER-UNT-RTL-AMT                       MLKUT002
21731C         GIVING PV-DT-EXT-PRICE.                                  MLKUT002
21731C     MOVE PV-DT-EXT-PRICE TO DT-EXT-PRICE.                        MLKUT002
21731C     MOVE SPACE TO DT-DEPT-CLASS.                                 MLKUT002
21731C     MOVE SPACE TO DT-RENUM-DEPT-CLASS                            MLKUT002
21731C                   DT-RENUM-SKU.                                  MLKUT002
00571                                                                   MLKUT002
00572      PERFORM C010-VERIFY-SKU.                                     MLKUT002
00573                                                                   MLKUT002
21731C     IF PI-VALID-RECORD                                                   
00577          PERFORM C020-VERIFY-STORE                                MLKUT002
00578      END-IF.                                                      MLKUT002
00579                                                                   MLKUT002
00580      IF PI-VALID-RECORD                                           MLKUT002
W21731         ADD ML019-TRANSFER-QTY   TO PV-TRNS-ACC-TOT-UNITS        MLKUT002
21731S         ADD ML019-TRANSFER-PER-UNT-RTL-AMT TO                            
21731S             PV-TRNS-ACC-TOT-RETAIL                                       
21731C         ADD PV-DT-EXT-PRICE TO PV-TRNS-ACC-TOT-EXT               MLKUT002
00585      ELSE                                                         MLKUT002
W21731         ADD ML019-TRANSFER-QTY TO PV-TRNS-REJ-TOT-UNITS          MLKUT002
21731S         ADD ML019-TRANSFER-PER-UNT-RTL-AMT TO                            
21731S             PV-TRNS-REJ-TOT-RETAIL                                       
21731C         ADD PV-DT-EXT-PRICE TO PV-TRNS-REJ-TOT-EXT               MLKUT002
00590      END-IF.                                                      MLKUT002
                                                                                
21731C     PERFORM Z100-WRITE-DETAIL-LINE.                                      
00591 *                                                                 MLKUT002
00592 *                                                                 MLKUT002
00593  C010-VERIFY-SKU.                                                 MLKUT002
00594 ******************************************************************MLKUT002
00595 *  EACH SKU IS VERIFIED AGAINST TSK TO DETERMINE IF IT IS        *MLKUT002
00596 *  INVALID, VALID OR RENUMBERED.  IF THE SKU IS RENUMBERED,      *MLKUT002
00597 *  THE RENUMBERED SKU IS VERIFIED AGAINST TSK.  THIS PROCESS IS  *MLKUT002
00598 *  REPEATED UNTIL THE FINAL SKU IS FOUND ON TSK.                 *MLKUT002
00599 ******************************************************************MLKUT002
00600                                                                   MLKUT002
21731      MOVE SPACE TO PV-CURRENT-SKU-NBR                                     
21731                    PV-CURRENT-SKU-DEPT                                    
21731                    PV-CURRENT-SKU-CLASS.                                  
W21731     MOVE ZEROES TO SKXREF-SKU-STAT-CDE.                          MLKUT002
00603      SET PI-VALID-SKU TO TRUE.                                    MLKUT002
00604                                                                   MLKUT002
00605      PERFORM Z500-READ-SKU-TABLE.                                 MLKUT002
00606                                                                   MLKUT002
00607      IF  PI-VALID-SKU                                             MLKUT002
21731C         MOVE SKXREF-DEPT     TO DT-DEPT                                  
21731C         MOVE PC-DASH         TO DT-DEPT-CLASS-DASH               MLKUT002
21731C         MOVE SKXREF-SUBCLASS TO DT-CLASS                                 
W21731         IF  SKXREF-SKU-STAT-CDE = PC-RENUM-STATUS                        
00609              SET PI-RENUMBERED-SKU-NOT-FOUND TO TRUE              MLKUT002
W21731             PERFORM D100-FIND-RENUMBERED-SKU                     MLKUT002
00612          END-IF                                                   MLKUT002
W21731     END-IF.                                                      MLKUT002
                                                                        MLKUT002
W21731     IF ML019-TRANSFER-DEPT-NBR = SPACES OR ZEROES                        
W21731         AND ML019-TRANSFER-CLASS-NBR = SPACES OR ZEROES                  
W21731         IF SKXREF-DEPT IS NUMERIC                                        
W21731             AND SKXREF-DEPT > ZEROES                                     
W21731             AND SKXREF-SUBCLASS IS NUMERIC                               
W21731             AND SKXREF-SUBCLASS > ZEROES                                 
W21731             MOVE SKXREF-DEPT     TO ML019-TRANSFER-DEPT-NBR              
W21731             MOVE SKXREF-SUBCLASS TO ML019-TRANSFER-CLASS-NBR             
W21731         END-IF                                                           
W21731     END-IF.                                                              
W21731                                                                          
21731C     EVALUATE TRUE                                                        
21731C         WHEN PI-INVALID-SKU                                              
21731C             SET DT-INVALID-SKU            TO TRUE                        
21731C             MOVE ML019-SKU                TO DT-MSG-DATA                 
21731C             SET PI-INVALID-RECORD         TO TRUE                        
21731C         WHEN PI-INVALID-DPT-CL                                           
21731C             SET DT-INVALID-DPT-CLASS      TO TRUE                        
21731C             MOVE ML019-SKU                TO DT-MSG-DATA                 
21731C             SET PI-INVALID-RECORD         TO TRUE                        
21731C         WHEN PI-WARN-SEQ-NO                                              
21731C             SET DT-WARN-INVALID-SEQ-NO    TO TRUE                        
21731C             MOVE ML019-SKU                TO DT-MSG-DATA                 
21731C         WHEN PI-INVALID-SEQ-NO                                           
21731C             SET DT-INVALID-SEQ-NO         TO TRUE                        
21731C             MOVE ML019-SKU                TO DT-MSG-DATA                 
21731C             SET PI-INVALID-RECORD         TO TRUE                        
21731C     END-EVALUATE.                                                        
                                                                                
21731C     IF PV-CURRENT-SKU-NBR = SPACE                                        
21731C         CONTINUE                                                         
21731C     ELSE                                                                 
21731C         MOVE PV-CURRENT-SKU-DEPT  TO DT-RENUM-DEPT                       
21731C         MOVE PC-DASH          TO DT-RENUM-DEPT-CLASS-DSH                 
21731C         MOVE PV-CURRENT-SKU-CLASS TO DT-RENUM-CLASS                      
21731C         MOVE PV-CURRENT-SKU-NBR   TO DT-RENUM-SKU                        
21731C     END-IF.                                                      MLKUT002
00641 *                                                                 MLKUT002
00642  C020-VERIFY-STORE.                                               MLKUT002
00643 ******************************************************************MLKUT002
21731 *  VERIFY THAT THE TRANSFERING TO AND FROM STORES ARE VALID      *MLKUT002
21731 *  STORES WITH VALID OPERATIONAL DATES.                          *MLKUT002
00648 ******************************************************************MLKUT002
00649                                                                   MLKUT002
21731C     IF ML019-TRANSFER-FROM-STORE-9                                       
21731C             NOT = ST2-STORE-NMBR(ML019-TRANSFER-FROM-STORE-9)            
21731C         OR ML019-TRANSFER-TO-STORE-9                                     
21731C             NOT = ST2-STORE-NMBR(ML019-TRANSFER-TO-STORE-9)              
21731C         SET DT-INVALID-STORE TO TRUE                                     
21731C         STRING 'FR='                                                     
21731C                ML019-TRANSFER-FROM-STORE-NBR                             
21731C                ' TO='                                                    
21731C                ML019-TRANSFER-TO-STORE-NBR                               
21731C             DELIMITED BY SIZE                                            
21731C             INTO DT-MSG-DATA                                             
00655          SET PI-INVALID-RECORD TO TRUE                            MLKUT002
00656      ELSE                                                         MLKUT002
00657          IF (PV-DATE < ST2-DCX-RCT-START-DATE                     MLKUT002
W21731                             (ML019-TRANSFER-FROM-STORE-9)        MLKUT002
00659              OR  PV-DATE > ST2-FIN-CLS-DTE                        MLKUT002
W21731                             (ML019-TRANSFER-FROM-STORE-9)        MLKUT002
00661              OR  PV-DATE < ST2-DCX-RCT-START-DATE                 MLKUT002
W21731                             (ML019-TRANSFER-TO-STORE-9)          MLKUT002
00663              OR  PV-DATE > ST2-FIN-CLS-DTE                        MLKUT002
W21731                             (ML019-TRANSFER-TO-STORE-9))         MLKUT002
21731C             SET DT-INVALID-STORE TO TRUE                                 
21731C             STRING 'FR-'                                                 
21731C                    ML019-TRANSFER-FROM-STORE-NBR                         
21731C                    ' TO-'                                                
21731C                    ML019-TRANSFER-TO-STORE-NBR                           
21731C                 DELIMITED BY SIZE                                        
21731C                 INTO DT-MSG-DATA                                         
00666              SET PI-INVALID-RECORD  TO TRUE                       MLKUT002
00667          END-IF                                                   MLKUT002
00668      END-IF.                                                      MLKUT002
00669 *                                                                 MLKUT002
       C050-FORMAT-TRANS-TOTALS.                                        MLKUT002
00671 ******************************************************************MLKUT002
00672 * THIS PARAGRAPH FORMATS THE TOTAL LINE FOR THE CONTROL BREAK ON *MLKUT002
00673 * TRANSFER DOCUMENT NUMBER CHANGE AND ADDS THE AMOUNTS TO THE    *MLKUT002
00674 * PROPER BATCH ACCUMULATORS.                                     *MLKUT002
00675 ******************************************************************MLKUT002
21731C     MOVE SPACES                  TO TL-TOTAL-MESSAGE.                    
00676      MOVE PV-PREVIOUS-TRANSFER-NO TO TL-TOTAL-TRANSFER.           MLKUT002
00677      MOVE PC-TRNS-ACC-TOTAL TO TL-TOTAL-TYPE.                     MLKUT002
00678      MOVE PV-TRNS-ACC-TOT-UNITS TO TL-TOTAL-UNITS.                MLKUT002
21731S     MOVE PV-TRNS-ACC-TOT-RETAIL TO TL-TOTAL-PRICE.                       
00680      MOVE PV-TRNS-ACC-TOT-EXT TO TL-TOTAL-EXT-PRICE.              MLKUT002
W26606     MOVE +1 TO PV-LINE-TO-ADVANCE.                                       
W26606***  MOVE +2 TO PV-LINE-TO-ADVANCE.                                       
21732      PERFORM Z200-PRINT-TOTALS-1.                                 MLKUT002
00683      IF PV-TRNS-REJ-TOT-UNITS > 0                                 MLKUT002
00684          MOVE PV-PREVIOUS-TRANSFER-NO TO TL-TOTAL-TRANSFER        MLKUT002
00685          MOVE PC-TRNS-REJ-TOTAL TO TL-TOTAL-TYPE                  MLKUT002
00686          MOVE PV-TRNS-REJ-TOT-UNITS TO TL-TOTAL-UNITS             MLKUT002
21731S         MOVE PV-TRNS-REJ-TOT-RETAIL TO TL-TOTAL-PRICE                    
00688          MOVE PV-TRNS-REJ-TOT-EXT TO TL-TOTAL-EXT-PRICE           MLKUT002
21731C         MOVE +1 TO PV-LINE-TO-ADVANCE                                    
21731C         PERFORM Z200-PRINT-TOTALS-1                              MLKUT002
00691      END-IF.                                                      MLKUT002
00692      ADD PV-TRNS-ACC-TOT-UNITS TO PV-BTCH-ACC-TOT-UNITS.          MLKUT002
21731S     ADD PV-TRNS-ACC-TOT-RETAIL TO PV-BTCH-ACC-TOT-RETAIL.                
00694      ADD PV-TRNS-ACC-TOT-EXT TO PV-BTCH-ACC-TOT-EXT.              MLKUT002
00695      ADD PV-TRNS-REJ-TOT-UNITS TO PV-BTCH-REJ-TOT-UNITS.          MLKUT002
21731S     ADD PV-TRNS-REJ-TOT-RETAIL TO PV-BTCH-REJ-TOT-RETAIL.                
00697      ADD PV-TRNS-REJ-TOT-EXT TO PV-BTCH-REJ-TOT-EXT.              MLKUT002
00698      INITIALIZE PV-TRNS-ACC-TOT-UNITS                             MLKUT002
21731S                PV-TRNS-ACC-TOT-RETAIL                                    
00700                 PV-TRNS-ACC-TOT-EXT                               MLKUT002
00701                 PV-TRNS-REJ-TOT-UNITS                             MLKUT002
21731S                PV-TRNS-REJ-TOT-RETAIL                                    
00703                 PV-TRNS-REJ-TOT-EXT.                              MLKUT002
21732 *    IF NOT PI-TRANSFER-EOF                                               
21732 *        ADD PC-MAX-LINE TO PV-PRINT-LINE-1                               
21732 *    END-IF.                                                              
00704 *                                                                 MLKUT002
SJ0210******************************************************************MLKUT002
  |   * THIS PARAGRAPH DETERMINES IF THE LAST PAGE WAS ON AND ODD PAGE.*MLKUT002
  |   * IF ODD, WRITE AN INTENTIONAL BLANK PAGE TO SEPARATE BATCHES ON *MLKUT002
  |   * A PAGE (IE. NO BATCH ON THE BACK PAGE OF ANOTHER BATCH)        *MLKUT002
  |   ******************************************************************MLKUT002
  |    C100-PROCESS-BATCH-BREAK.                                        MLKUT002
  |   *                                                                         
  |        DIVIDE PV-PAGE-NUMBER-1                                              
  |            BY PC-TWO                                                        
  |               GIVING PV-HALF-PAGES                                          
  |                   REMAINDER PV-REMAINDER-PAGES.                             
  |        IF PV-REMAINDER-PAGES NOT = ZERO                                     
  |            PERFORM Z250-HEADING-ROUTINE-1                                   
  |   *                                                                         
  |            MOVE BP-BLANK-PAGE-DETAIL TO TRANSFER-DETAIL-LINE                
  |            WRITE TRANSFER-DETAIL-LINE                                       
  |   *            AFTER ADVANCING PAGE.                                        
  |                AFTER ADVANCING 2 LINES                                      
  |        END-IF.                                                              
SJ0210                                                                  MLKUT002
00705 *                                                                 MLKUT002
00706  C150-FORMAT-BATCH-TOTALS.                                        MLKUT002
00707 ******************************************************************MLKUT002
00708 * THIS PARAGRAPH FORMATS THE TOTAL LINE FOR THE CONTROL BREAK ON *MLKUT002
00709 * BATCH NUMBER CHANGE AND ADDS THE AMOUNTS TO THE PROPER GRAND   *MLKUT002
00710 * TOTAL ACCUMULATORS.                                            *MLKUT002
00711 ******************************************************************MLKUT002
21731C     MOVE SPACES                  TO TL-TOTAL-MESSAGE.                    
00712      MOVE PV-PREVIOUS-BATCH-NO TO TL-TOTAL-BATCH.                 MLKUT002
00713      MOVE PC-BTCH-ACC-TOTAL TO TL-TOTAL-TYPE.                     MLKUT002
00714      MOVE PV-BTCH-ACC-TOT-UNITS TO TL-TOTAL-UNITS.                MLKUT002
21731S     MOVE PV-BTCH-ACC-TOT-RETAIL TO TL-TOTAL-PRICE.                       
00716      MOVE PV-BTCH-ACC-TOT-EXT TO TL-TOTAL-EXT-PRICE.              MLKUT002
21731C     MOVE +2 TO PV-LINE-TO-ADVANCE.                                       
21731C     PERFORM Z200-PRINT-TOTALS-1.                                 MLKUT002
00719      IF PV-BTCH-REJ-TOT-UNITS > 0                                 MLKUT002
00720          MOVE PV-PREVIOUS-BATCH-NO TO TL-TOTAL-BATCH              MLKUT002
00721          MOVE PC-BTCH-REJ-TOTAL TO TL-TOTAL-TYPE                  MLKUT002
00722          MOVE PV-BTCH-REJ-TOT-UNITS TO TL-TOTAL-UNITS             MLKUT002
21731S         MOVE PV-BTCH-REJ-TOT-RETAIL TO TL-TOTAL-PRICE                    
00724          MOVE PV-BTCH-REJ-TOT-EXT TO TL-TOTAL-EXT-PRICE           MLKUT002
21731C         MOVE +1 TO PV-LINE-TO-ADVANCE                                    
21731C         PERFORM Z200-PRINT-TOTALS-1                              MLKUT002
00727      END-IF.                                                      MLKUT002
00728      ADD PV-BTCH-ACC-TOT-UNITS  PV-BTCH-REJ-TOT-UNITS             MLKUT002
00729          GIVING PV-BTCH-TOT-UNITS.                                MLKUT002
21731S     ADD PV-BTCH-ACC-TOT-RETAIL PV-BTCH-REJ-TOT-RETAIL                    
21731S         GIVING PV-BTCH-TOT-RETAIL.                                       
00732      ADD PV-BTCH-ACC-TOT-EXT    PV-BTCH-REJ-TOT-EXT               MLKUT002
00733          GIVING PV-BTCH-TOT-EXT.                                  MLKUT002
00734      MOVE PV-PREVIOUS-BATCH-NO TO TL-TOTAL-BATCH.                 MLKUT002
00735      MOVE PC-BTCH-TOTAL TO TL-TOTAL-TYPE.                         MLKUT002
00736      MOVE PV-BTCH-TOT-UNITS TO TL-TOTAL-UNITS.                    MLKUT002
21731S     MOVE PV-BTCH-TOT-RETAIL TO TL-TOTAL-PRICE.                           
00738      MOVE PV-BTCH-TOT-EXT TO TL-TOTAL-EXT-PRICE.                  MLKUT002
21731C     MOVE +1 TO PV-LINE-TO-ADVANCE.                                       
21731C     PERFORM Z200-PRINT-TOTALS-1.                                 MLKUT002
SJ0210                                                                  MLKUT002
SJ0210     PERFORM C100-PROCESS-BATCH-BREAK.                            MLKUT002
SJ0210                                                                  MLKUT002
00741      ADD PV-BTCH-ACC-TOT-UNITS TO PV-GRND-ACC-TOT-UNITS.          MLKUT002
21731S     ADD PV-BTCH-ACC-TOT-RETAIL TO PV-GRND-ACC-TOT-RETAIL.                
00743      ADD PV-BTCH-ACC-TOT-EXT TO PV-GRND-ACC-TOT-EXT.              MLKUT002
00744      ADD PV-BTCH-REJ-TOT-UNITS TO PV-GRND-REJ-TOT-UNITS.          MLKUT002
21731S     ADD PV-BTCH-REJ-TOT-RETAIL TO PV-GRND-REJ-TOT-RETAIL.                
00746      ADD PV-BTCH-REJ-TOT-EXT TO PV-GRND-REJ-TOT-EXT.              MLKUT002
00747      INITIALIZE PV-BTCH-ACC-TOT-UNITS                             MLKUT002
21731S                PV-BTCH-ACC-TOT-RETAIL                                    
00749                 PV-BTCH-ACC-TOT-EXT                               MLKUT002
00750                 PV-BTCH-REJ-TOT-UNITS                             MLKUT002
21731S                PV-BTCH-REJ-TOT-RETAIL                                    
00752                 PV-BTCH-REJ-TOT-EXT.                              MLKUT002
21731C     IF NOT PI-TRANSFER-EOF                                               
21731C         ADD PC-MAX-LINE TO PV-PRINT-LINE-1                               
21731C     END-IF.                                                              
00753 *                                                                 MLKUT002
00754 *                                                                 MLKUT002
00755  C200-FORMAT-GRAND-TOTALS.                                        MLKUT002
00756 ******************************************************************MLKUT002
00757 * THIS PARAGRAPH FORMATS THE GRAND TOTALS FOR THE PROGRAM.       *MLKUT002
00758 ******************************************************************MLKUT002
SJ0210     MOVE 'TOT'                   TO PV-PREVIOUS-BATCH-NO.                
SJ0210     PERFORM Z250-HEADING-ROUTINE-1.                                      
SJ0210**** PERFORM Z200-PRINT-TOTALS-1.                                         
SJ0210                                                                          
21731C     MOVE SPACES                  TO TL-TOTAL-MESSAGE.                    
00759      MOVE SPACES TO TL-TOTAL-TRANSFER.                            MLKUT002
00760      MOVE PC-GRND-ACC-TOTAL TO TL-TOTAL-TYPE.                     MLKUT002
00761      MOVE PV-GRND-ACC-TOT-UNITS TO TL-TOTAL-UNITS.                MLKUT002
21731S     MOVE PV-GRND-ACC-TOT-RETAIL TO TL-TOTAL-PRICE.                       
00763      MOVE PV-GRND-ACC-TOT-EXT TO TL-TOTAL-EXT-PRICE.              MLKUT002
21731C     MOVE +2 TO PV-LINE-TO-ADVANCE.                                       
21731C     PERFORM Z200-PRINT-TOTALS-1.                                 MLKUT002
00766      IF PV-GRND-REJ-TOT-UNITS > 0                                 MLKUT002
00767          MOVE SPACES TO TL-TOTAL-TRANSFER                         MLKUT002
00768          MOVE PC-GRND-REJ-TOTAL TO TL-TOTAL-TYPE                  MLKUT002
00769          MOVE PV-GRND-REJ-TOT-UNITS TO TL-TOTAL-UNITS             MLKUT002
21731S         MOVE PV-GRND-REJ-TOT-RETAIL TO TL-TOTAL-PRICE                    
00771          MOVE PV-GRND-REJ-TOT-EXT TO TL-TOTAL-EXT-PRICE           MLKUT002
21731C         MOVE +1 TO PV-LINE-TO-ADVANCE                                    
21731C         PERFORM Z200-PRINT-TOTALS-1                              MLKUT002
00774      END-IF.                                                      MLKUT002
00775      ADD PV-GRND-ACC-TOT-UNITS  PV-GRND-REJ-TOT-UNITS             MLKUT002
00776          GIVING PV-GRND-TOT-UNITS.                                MLKUT002
21731S     ADD PV-GRND-ACC-TOT-RETAIL PV-GRND-REJ-TOT-RETAIL                    
21731S         GIVING PV-GRND-TOT-RETAIL.                                       
00779      ADD PV-GRND-ACC-TOT-EXT    PV-GRND-REJ-TOT-EXT               MLKUT002
00780          GIVING PV-GRND-TOT-EXT.                                  MLKUT002
00781      MOVE SPACES TO TL-TOTAL-TRANSFER.                            MLKUT002
00782      MOVE PC-GRND-TOTAL TO TL-TOTAL-TYPE.                         MLKUT002
00783      MOVE PV-GRND-TOT-UNITS TO TL-TOTAL-UNITS.                    MLKUT002
21731S     MOVE PV-GRND-TOT-RETAIL TO TL-TOTAL-PRICE.                           
00785      MOVE PV-GRND-TOT-EXT TO TL-TOTAL-EXT-PRICE.                  MLKUT002
21731C     MOVE +1 TO PV-LINE-TO-ADVANCE.                                       
21731C     PERFORM Z200-PRINT-TOTALS-1.                                 MLKUT002
00788 *                                                                 MLKUT002
00789 *                                                                 MLKUT002
21731C C500-REPORT-SYS-PRICE.                                                   
21731C                                                                          
21731C     PERFORM D200-CHECK-SYS-PRICE.                                        
21731C     IF ML019-TRANSFER-PER-UNT-RTL-AMT NOT = UPCPLS-UNT-RTL-AMT           
21731C         OR PI-PRICE-NOT-FOUND                                            
21731C         IF PI-VALID-RECORD                                               
21731C             AND PI-PRICE-FOUND                                           
21731C             MOVE SPACES TO DT-MESSAGE                                    
21731C             MULTIPLY ML019-TRANSFER-QTY   BY                             
21731C                      UPCPLS-UNT-RTL-AMT                                  
21731C                 GIVING PV-EXCP-EXT-PRICE                                 
21731C             MOVE UPCPLS-UNT-RTL-AMT TO DT-SYS-PRICE                      
21731C             MOVE PV-EXCP-EXT-PRICE  TO DT-EXT-SYS-PRICE                  
21731C             ADD ML019-TRANSFER-QTY   TO PV-TRNX-ACC-TOT-UNITS            
21731C             ADD PV-DT-EXT-PRICE      TO PV-TRNX-ACC-TOT-EXT              
21731C             ADD PV-EXCP-EXT-PRICE    TO PV-TRNXS-ACC-TOT-EXT             
21731C         ELSE                                                             
21731C             ADD ML019-TRANSFER-QTY TO PV-TRNX-REJ-TOT-UNITS              
21731C             ADD PV-DT-EXT-PRICE    TO PV-TRNX-REJ-TOT-EXT                
21731C         END-IF                                                           
21731C         PERFORM Z125-WRITE-EXCP-LINE                                     
21731C     END-IF.                                                              
21731C                                                                          
21731C C550-FORMAT-TRANX-TOTALS.                                                
21731C******************************************************************        
21731C* THIS PARAGRAPH FORMATS THE TOTAL LINE FOR THE CONTROL BREAK ON *        
21731C* TRANSFER DOCUMENT NUMBER CHANGE AND ADDS THE AMOUNTS TO THE    *        
21731C* PROPER BATCH ACCUMULATORS.                                     *        
21731C******************************************************************        
21731C     MOVE SPACES                  TO TL-TOTAL-MESSAGE.                    
21731C     MOVE PV-PREVIOUS-TRANSFER-NO TO TL-TOTAL-TRANSFER.                   
21731C     MOVE PC-TRNS-ACC-TOTAL       TO TL-TOTAL-TYPE.                       
21731C     MOVE PV-TRNX-ACC-TOT-UNITS   TO TL-TOTAL-UNITS.                      
21731C     MOVE PV-TRNX-ACC-TOT-EXT     TO TL-TOTAL-EXT-PRICE.                  
21731C     MOVE PV-TRNXS-ACC-TOT-EXT    TO TL-EXT-SYS-PRICE.                    
21731C     MOVE +2 TO PV-LINE-TO-ADVANCE.                                       
21731C     PERFORM Z225-PRINT-TOTALS-2.                                         
21731C                                                                          
21731C     IF PV-TRNX-REJ-TOT-UNITS > 0                                         
21731C         MOVE PV-PREVIOUS-TRANSFER-NO TO TL-TOTAL-TRANSFER                
21731C         MOVE PC-TRNS-REJ-TOTAL       TO TL-TOTAL-TYPE                    
21731C         MOVE PV-TRNX-REJ-TOT-UNITS   TO TL-TOTAL-UNITS                   
21731C         MOVE PV-TRNX-REJ-TOT-EXT     TO TL-TOTAL-EXT-PRICE               
21731C         MOVE ZEROES                  TO TL-EXT-SYS-PRICE                 
21731C         MOVE +1 TO PV-LINE-TO-ADVANCE                                    
21731C         PERFORM Z225-PRINT-TOTALS-2                                      
21731C     END-IF.                                                              
21731C                                                                          
21731C     ADD PV-TRNX-ACC-TOT-UNITS TO PV-BTCHX-ACC-TOT-UNITS.                 
21731C     ADD PV-TRNX-ACC-TOT-EXT   TO PV-BTCHX-ACC-TOT-EXT.                   
21731C     ADD PV-TRNXS-ACC-TOT-EXT  TO PV-BTCHXS-ACC-TOT-EXT.                  
21731C     ADD PV-TRNX-REJ-TOT-UNITS TO PV-BTCHX-REJ-TOT-UNITS.                 
21731C     ADD PV-TRNX-REJ-TOT-EXT   TO PV-BTCHX-REJ-TOT-EXT.                   
21731C     INITIALIZE PV-TRNX-ACC-TOT-UNITS                                     
21731C                PV-TRNX-ACC-TOT-EXT                                       
21731C                PV-TRNXS-ACC-TOT-EXT                                      
21731C                PV-TRNX-REJ-TOT-UNITS                                     
21731C                PV-TRNX-REJ-TOT-EXT.                                      
21731C     IF NOT PI-TRANSFER-EOF                                               
21731C         ADD PC-MAX-LINE TO PV-PRINT-LINE-2                               
21731C     END-IF.                                                              
21731C                                                                          
21731C C650-FORMAT-BTCHX-TOTALS.                                                
21731C******************************************************************        
21731C* THIS PARAGRAPH FORMATS THE TOTAL LINE FOR THE CONTROL BREAK ON *        
21731C* BATCH NUMBER CHANGE AND ADDS THE AMOUNTS TO THE PROPER GRAND   *        
21731C* TOTAL ACCUMULATORS.                                            *        
21731C******************************************************************        
21731C     MOVE SPACES                  TO TL-TOTAL-MESSAGE.                    
21731C     MOVE PV-PREVIOUS-BATCH-NO   TO TL-TOTAL-BATCH.                       
21731C     MOVE PC-BTCH-ACC-TOTAL      TO TL-TOTAL-TYPE.                        
21731C     MOVE PV-BTCHX-ACC-TOT-UNITS TO TL-TOTAL-UNITS.                       
21731C     MOVE PV-BTCHX-ACC-TOT-EXT   TO TL-TOTAL-EXT-PRICE.                   
21731C     MOVE PV-BTCHXS-ACC-TOT-EXT  TO TL-EXT-SYS-PRICE.                     
21731C     MOVE +2 TO PV-LINE-TO-ADVANCE.                                       
21731C     PERFORM Z225-PRINT-TOTALS-2.                                         
21731C                                                                          
21731C     IF PV-BTCHX-REJ-TOT-UNITS > 0                                        
21731C         MOVE PV-PREVIOUS-BATCH-NO   TO TL-TOTAL-BATCH                    
21731C         MOVE PC-BTCH-REJ-TOTAL      TO TL-TOTAL-TYPE                     
21731C         MOVE PV-BTCHX-REJ-TOT-UNITS TO TL-TOTAL-UNITS                    
21731C         MOVE PV-BTCHX-REJ-TOT-EXT   TO TL-TOTAL-EXT-PRICE                
21731C         MOVE ZEROES                 TO TL-EXT-SYS-PRICE                  
21731C         MOVE +1 TO PV-LINE-TO-ADVANCE                                    
21731C         PERFORM Z225-PRINT-TOTALS-2                                      
21731C     END-IF.                                                              
21731C                                                                          
21731C     ADD PV-BTCHX-ACC-TOT-UNITS  PV-BTCHX-REJ-TOT-UNITS                   
21731C         GIVING PV-BTCHX-TOT-UNITS.                                       
21731C     ADD PV-BTCHX-ACC-TOT-EXT    PV-BTCHX-REJ-TOT-EXT                     
21731C         GIVING PV-BTCHX-TOT-EXT.                                         
21731C     MOVE PV-PREVIOUS-BATCH-NO  TO TL-TOTAL-BATCH.                        
21731C     MOVE PC-BTCH-TOTAL         TO TL-TOTAL-TYPE.                         
21731C     MOVE PV-BTCHX-TOT-UNITS    TO TL-TOTAL-UNITS.                        
21731C     MOVE PV-BTCHX-TOT-EXT      TO TL-TOTAL-EXT-PRICE.                    
21731C     MOVE PV-BTCHXS-ACC-TOT-EXT TO TL-EXT-SYS-PRICE.                      
21731C     MOVE +1 TO PV-LINE-TO-ADVANCE.                                       
21731C     PERFORM Z225-PRINT-TOTALS-2.                                         
21731C                                                                          
21731C     ADD PV-BTCHX-ACC-TOT-UNITS TO PV-GRNDX-ACC-TOT-UNITS.                
21731C     ADD PV-BTCHX-ACC-TOT-EXT   TO PV-GRNDX-ACC-TOT-EXT.                  
21731C     ADD PV-BTCHXS-ACC-TOT-EXT  TO PV-GRNDXS-ACC-TOT-EXT.                 
21731C     ADD PV-BTCHX-REJ-TOT-UNITS TO PV-GRNDX-REJ-TOT-UNITS.                
21731C     ADD PV-BTCHX-REJ-TOT-EXT   TO PV-GRNDX-REJ-TOT-EXT.                  
21731C     INITIALIZE PV-BTCHX-ACC-TOT-UNITS                                    
21731C                PV-BTCHX-ACC-TOT-EXT                                      
21731C                PV-BTCHXS-ACC-TOT-EXT                                     
21731C                PV-BTCHX-REJ-TOT-UNITS                                    
21731C                PV-BTCHX-REJ-TOT-EXT.                                     
21731C     IF NOT PI-TRANSFER-EOF                                               
21731C         ADD PC-MAX-LINE TO PV-PRINT-LINE-2                               
21731C     END-IF.                                                              
21731C                                                                          
21731C C700-FORMAT-GRNDX-TOTALS.                                                
21731C******************************************************************        
21731C* THIS PARAGRAPH FORMATS THE GRAND TOTALS FOR THE PROGRAM.       *        
21731C******************************************************************        
21731C     MOVE SPACES                  TO TL-TOTAL-MESSAGE.                    
21731C     MOVE SPACES TO TL-TOTAL-TRANSFER.                                    
21731C     MOVE PC-GRND-ACC-TOTAL      TO TL-TOTAL-TYPE.                        
21731C     MOVE PV-GRNDX-ACC-TOT-UNITS TO TL-TOTAL-UNITS.                       
21731C     MOVE PV-GRNDX-ACC-TOT-EXT   TO TL-TOTAL-EXT-PRICE.                   
21731C     MOVE PV-GRNDXS-ACC-TOT-EXT  TO TL-EXT-SYS-PRICE.                     
21731C     MOVE +2 TO PV-LINE-TO-ADVANCE.                                       
21731C     PERFORM Z225-PRINT-TOTALS-2.                                         
21731C                                                                          
21731C     IF PV-GRNDX-REJ-TOT-UNITS > 0                                        
21731C         MOVE SPACES TO TL-TOTAL-TRANSFER                                 
21731C         MOVE PC-GRND-REJ-TOTAL      TO TL-TOTAL-TYPE                     
21731C         MOVE PV-GRNDX-REJ-TOT-UNITS TO TL-TOTAL-UNITS                    
21731C         MOVE PV-GRNDX-REJ-TOT-EXT   TO TL-TOTAL-EXT-PRICE                
21731C         MOVE ZEROES                 TO TL-EXT-SYS-PRICE                  
21731C         MOVE +1 TO PV-LINE-TO-ADVANCE                                    
21731C         PERFORM Z225-PRINT-TOTALS-2                                      
21731C     END-IF.                                                              
21731C                                                                          
21731C     ADD PV-GRNDX-ACC-TOT-UNITS  PV-GRNDX-REJ-TOT-UNITS                   
21731C         GIVING PV-GRNDX-TOT-UNITS.                                       
21731C     ADD PV-GRNDX-ACC-TOT-EXT    PV-GRNDX-REJ-TOT-EXT                     
21731C         GIVING PV-GRNDX-TOT-EXT.                                         
21731C     MOVE SPACES TO TL-TOTAL-TRANSFER.                                    
21731C     MOVE PC-GRND-TOTAL        TO TL-TOTAL-TYPE.                          
21731C     MOVE PV-GRNDX-TOT-UNITS   TO TL-TOTAL-UNITS.                         
21731C     MOVE PV-GRNDX-TOT-EXT     TO TL-TOTAL-EXT-PRICE.                     
21731C     MOVE PV-GRNDXS-ACC-TOT-EXT TO TL-EXT-SYS-PRICE.                      
21731C     MOVE +1 TO PV-LINE-TO-ADVANCE.                                       
21731C     PERFORM Z225-PRINT-TOTALS-2.                                         
21731C                                                                          
00790  D100-FIND-RENUMBERED-SKU.                                        MLKUT002
00791 *                                                                 MLKUT002
W21731*  GET NON-RENUMBERED SKU FROM CROSS-REFERENCE TABLE THAT         MLKUT002
W21731*  MATCH THE INTERNAL UPC ID PREVIOUSLY RETRIEVED IN Z500-        MLKUT002
21731 *                                                                 MLKUT002
W21731     PERFORM Z700-READ-SKU-TABLE.                                 MLKUT002
                                                                                
W21731     IF PI-VALID-SKU                                                      
W21731         MOVE SKXREF-SKU      TO PV-CURRENT-SKU-NBR-9                     
W21731         MOVE SKXREF-DEPT     TO PV-CURRENT-SKU-DEPT-9                    
W21731         MOVE SKXREF-SUBCLASS TO PV-CURRENT-SKU-CLASS-9                   
W21731         SET PI-RENUMBERED-SKU-FOUND TO TRUE                              
W21731         DISPLAY '  RENUMBERED SKU ' ML019-SKU                            
W21731                 ' FOUND TO BE ' PV-CURRENT-SKU-NBR                       
W21731     END-IF.                                                              
00809                                                                   MLKUT002
00826 *                                                                 MLKUT002
00827 *                                                                 MLKUT002
00828 *                                                                 MLKUT002
21731C D200-CHECK-SYS-PRICE.                                                    
21731C                                                                          
21731C     MOVE ML019-TRANSFER-MM  TO PV-TIMESTAMP-DATE-MM.                     
21731C     MOVE ML019-TRANSFER-DD  TO PV-TIMESTAMP-DATE-DD.                     
21731C                                                                          
21731C     IF SKXREF-SKU-STAT-CDE = '20'                                        
21731C         MOVE ZEROES             TO UPCPLS-STR-NBR                        
21731C         PERFORM Z800-GET-PRICE                                           
21731C     ELSE                                                                 
21731C         MOVE ML019-TRANSFER-FROM-STORE-9 TO UPCPLS-STR-NBR               
21731C         PERFORM Z800-GET-PRICE                                           
21731C         IF PI-PRICE-NOT-FOUND                                            
21731C             MOVE ZEROES             TO UPCPLS-STR-NBR                    
21731C             PERFORM Z800-GET-PRICE                                       
21731C         END-IF                                                           
21731C     END-IF.                                                              
21731C     IF PI-PRICE-NOT-FOUND                                                
21731C         MOVE ZEROES TO UPCPLS-UNT-RTL-AMT                                
21731C     END-IF.                                                              
21731C                                                                          
00829  Z000-READ-TRANSFER-FILE.                                         MLKUT002
00830 ******************************************************************MLKUT002
00831 * THIS PARAGRAPH READS THE INPUT TRANSFER FILE AND SETS THE      *MLKUT002
00832 * END OF FILE SWITCH WHEN END OF FILE IS FOUND.                  *MLKUT002
00833 ******************************************************************MLKUT002
W21731     READ TRANSFER-FILE INTO ML019-TRANSFER-RECORD                MLKUT002
00835          AT END                                                   MLKUT002
00836              SET PI-TRANSFER-EOF TO TRUE.                         MLKUT002
00837 *                                                                 MLKUT002
00838 *                                                                 MLKUT002
00839  Z050-LOAD-STORE-TABLE.                                           MLKUT002
00840 ******************************************************************MLKUT002
00841 *  LOAD THE WORKING STORAGE TABLE CONTAINING THE STORE AND THEIR *MLKUT002
00842 *  DISTRIBUTION CENTER RELATIONSHIPS FROM THE DB2 STORE TABLE.   *MLKUT002
00843 ******************************************************************MLKUT002
W26603     INITIALIZE DCLXMT00001                                       MLKUT002
W26603                DCLXMT00002                                               
00845                 ST2-STORE-VALUES.                                 MLKUT002
00846 *                                                                 MLKUT002
00847      EXEC SQL                                                     MLKUT002
W26603         OPEN XMTLOC_CSR                                          MLKUT002
00849      END-EXEC.                                                    MLKUT002
00850 *                                                                 MLKUT002
00851      IF SQLCODE < 000                                             MLKUT002
00852          DISPLAY '** ABEND ** = OPEN CSR ERROR ON STORE TABLE'    MLKUT002
00853          GO TO Z998-SQL-ERROR                                     MLKUT002
00854      ELSE                                                         MLKUT002
00855          IF SQLCODE > +100                                        MLKUT002
00856              DISPLAY '** ABEND ** = OPEN CSR WARNING '            MLKUT002
00857                      'ON STORE TABLE'                             MLKUT002
00858              GO TO Z999-SQL-WARNING                               MLKUT002
00859          END-IF                                                   MLKUT002
00860      END-IF.                                                      MLKUT002
00861 *                                                                 MLKUT002
00862      PERFORM Z910-FETCH-STORE-TABLE.                              MLKUT002
00863      PERFORM Z920-LOAD-STORES                                     MLKUT002
00864          UNTIL SQLCODE = +100.                                    MLKUT002
00865 *                                                                 MLKUT002
00866      EXEC SQL                                                     MLKUT002
W26603         CLOSE XMTLOC_CSR                                         MLKUT002
00868      END-EXEC.                                                    MLKUT002
00869 *                                                                 MLKUT002
00870      IF SQLCODE < 000                                             MLKUT002
00871          DISPLAY '** ABEND ** = CLOSE CSR ERROR ON STORE TABLE'   MLKUT002
00872          GO TO Z998-SQL-ERROR                                     MLKUT002
00873      ELSE                                                         MLKUT002
00874          IF SQLCODE > +100                                        MLKUT002
00875              DISPLAY '** ABEND ** = CLOSE CSR WARNING '           MLKUT002
00876                      'ON STORE TABLE'                             MLKUT002
00877              GO TO Z999-SQL-WARNING                               MLKUT002
00878          END-IF                                                   MLKUT002
00879      END-IF.                                                      MLKUT002
00880 *                                                                 MLKUT002
00881      EXEC SQL                                                     MLKUT002
00882          COMMIT                                                   MLKUT002
00883      END-EXEC.                                                    MLKUT002
00884 *                                                                 MLKUT002
00885      IF SQLCODE < 000                                             MLKUT002
00886          DISPLAY '** ABEND ** = COMMIT ERROR ON STORE TABLE'      MLKUT002
00887          GO TO Z998-SQL-ERROR                                     MLKUT002
00888      ELSE                                                         MLKUT002
00889          IF SQLCODE > +100                                        MLKUT002
00890              DISPLAY '** ABEND ** = COMMIT WARNING '              MLKUT002
00891                      'ON STORE TABLE'                             MLKUT002
00892              GO TO Z999-SQL-WARNING                               MLKUT002
00893          END-IF                                                   MLKUT002
00894      END-IF.                                                      MLKUT002
00895 *                                                                 MLKUT002
00896 *                                                                 MLKUT002
00897  Z100-WRITE-DETAIL-LINE.                                          MLKUT002
00898 ******************************************************************MLKUT002
00899 * THIS PARAGRAPH WRITES THE DETAIL LINE ON THE OUTPUT REPORT.    *MLKUT002
00900 ******************************************************************MLKUT002
21731C     IF PV-PAGE-NUMBER-1 = 0                                              
21731C         OR PV-PRINT-LINE-1 + PV-LINE-TO-ADVANCE > PC-MAX-LINE            
21731C         PERFORM Z250-HEADING-ROUTINE-1                                   
21731C         MOVE +2 TO PV-LINE-TO-ADVANCE                                    
21731C     END-IF.                                                              
                                                                                
21731C     WRITE TRANSFER-DETAIL-LINE FROM DT-LINE-LAYOUT               MLKUT002
21731C         AFTER ADVANCING PV-LINE-TO-ADVANCE.                              
21731C     ADD PV-LINE-TO-ADVANCE TO PV-PRINT-LINE-1.                           
21731C     MOVE +1                TO PV-LINE-TO-ADVANCE.                        
00905 *                                                                 MLKUT002
00906 *                                                                 MLKUT002
21731C Z125-WRITE-EXCP-LINE.                                                    
21731C******************************************************************        
21731C* THIS PARAGRAPH WRITES THE PRICE DIFF EXCEPTION REPORT          *        
21731C******************************************************************        
21731C     IF PV-PAGE-NUMBER-2 = 0                                              
21731C         OR PV-PRINT-LINE-2 + PV-LINE-TO-ADVANCE > PC-MAX-LINE            
21731C         PERFORM Z275-HEADING-ROUTINE-2                                   
21731C         MOVE +2 TO PV-LINE-TO-ADVANCE                                    
21731C     END-IF.                                                              
21731C                                                                          
21731C     WRITE TRANSFER-PRICE-EXCEPTION-LINE FROM DT-LINE-LAYOUT              
21731C         AFTER ADVANCING PV-LINE-TO-ADVANCE.                              
21731C     ADD PV-LINE-TO-ADVANCE TO PV-PRINT-LINE-2.                           
21731C     MOVE +1                TO PV-LINE-TO-ADVANCE.                        
21731C                                                                          
00907  Z150-WRITE-OUTPUT-RECORD.                                        MLKUT002
00908 ******************************************************************MLKUT002
00909 * THIS PARAGRAPH WRITES THE VALID OUTPUT RECORD TO THE OUTPUT    *MLKUT002
00910 * FILE.                                                          *MLKUT002
00911 ******************************************************************MLKUT002
00912      WRITE VALID-TRANSFER-RECORD FROM                             MLKUT002
W21731         ML019-TRANSFER-RECORD.                                   MLKUT002
00914 *                                                                 MLKUT002
00915 *                                                                 MLKUT002
21731C Z200-PRINT-TOTALS-1.                                                     
00917 ******************************************************************MLKUT002
00918 * THIS PARAGRAPH PRINTS THE CONTROL BREAK TOTAL LINES.           *MLKUT002
00919 ******************************************************************MLKUT002
21731C     IF PV-PAGE-NUMBER-1 = 0                                              
21731C         PERFORM Z250-HEADING-ROUTINE-1                                   
21731C         MOVE +2 TO PV-LINE-TO-ADVANCE                                    
21731C     END-IF.                                                              
                                                                                
00920      WRITE TRANSFER-DETAIL-LINE FROM TL-TOTAL-LINE                MLKUT002
21731C         AFTER ADVANCING PV-LINE-TO-ADVANCE.                              
21731C     ADD PV-LINE-TO-ADVANCE TO PV-PRINT-LINE-1.                           
00923      MOVE SPACES TO TL-TOTAL-LINE.                                MLKUT002
W26606*    MOVE +1                TO PV-LINE-TO-ADVANCE.                        
W26606     MOVE +2                TO PV-LINE-TO-ADVANCE.                        
00925 *                                                                 MLKUT002
21731C Z225-PRINT-TOTALS-2.                                                     
21731C******************************************************************        
21731C* THIS PARAGRAPH PRINTS THE CONTROL BREAK TOTAL LINES.           *        
21731C******************************************************************        
21731C     IF PV-PAGE-NUMBER-2 = 0                                              
21731C         PERFORM Z275-HEADING-ROUTINE-2                                   
21731C         MOVE +2 TO PV-LINE-TO-ADVANCE                                    
21731C     END-IF.                                                              
21731C                                                                          
21731C     WRITE TRANSFER-PRICE-EXCEPTION-LINE FROM TL-TOTAL-LINE               
21731C         AFTER ADVANCING PV-LINE-TO-ADVANCE.                              
21731C     ADD PV-LINE-TO-ADVANCE TO PV-PRINT-LINE-2.                           
21731C     MOVE SPACES TO TL-TOTAL-LINE.                                        
21731C     MOVE +1                TO PV-LINE-TO-ADVANCE.                        
21731C                                                                          
21731C Z250-HEADING-ROUTINE-1.                                                  
00927 ******************************************************************MLKUT002
21731C*  FORMAT AND PRINT THE HEADING FOR IN-STORE TRANSFER REPORT     *        
00929 ******************************************************************MLKUT002
21731C     ADD 1 TO PV-PAGE-NUMBER-1.                                           
21731C     MOVE 1 TO DP150O-REPORT-NUMBER.                                      
21731C     MOVE PV-PAGE-NUMBER-1 TO DP150O-PAGE-NUMBER.                         
00933      WRITE TRANSFER-DETAIL-LINE                                   MLKUT002
21731          FROM DP150O-STANDRD-HEADER-150-COLS                      MLKUT002
00935          AFTER ADVANCING PAGE.                                    MLKUT002
                                                                                
21731C     MOVE PV-PREVIOUS-BATCH-NO TO HL-BATCH.                               
21731C     SET HL-TRANSFER-DETAIL-RPT TO TRUE.                                  
21731C     WRITE TRANSFER-DETAIL-LINE FROM HL-HEADING-LINE-1            MLKUT002
00938          AFTER ADVANCING 1 LINE.                                  MLKUT002
                                                                                
21731C     MOVE SPACES TO HL-HEADING-2-MESSAGE.                                 
21731C     WRITE TRANSFER-DETAIL-LINE FROM HL-HEADING-LINE-2            MLKUT002
00940          AFTER ADVANCING 2 LINES.                                 MLKUT002
                                                                                
21731C     MOVE SPACES TO HL-HEADING-3-MESSAGE.                                 
21731C     WRITE TRANSFER-DETAIL-LINE FROM HL-HEADING-LINE-3            MLKUT002
00942          AFTER ADVANCING 1 LINE.                                  MLKUT002
                                                                                
21731C     MOVE 6 TO PV-PRINT-LINE-1.                                           
00946 *                                                                 MLKUT002
21731C Z275-HEADING-ROUTINE-2.                                                  
21731C******************************************************************        
21731C*  FORMAT AND PRINT THE HEADING FOR PRICE DIFF EXCEPTION REPORT  *        
21731C******************************************************************        
21731C     ADD 1 TO PV-PAGE-NUMBER-2.                                           
21731C     MOVE 2 TO DP150O-REPORT-NUMBER.                                      
21731C     MOVE PV-PAGE-NUMBER-2 TO DP150O-PAGE-NUMBER.                         
21731C     WRITE TRANSFER-PRICE-EXCEPTION-LINE                                  
21731C         FROM DP150O-STANDRD-HEADER-150-COLS                              
21731C         AFTER ADVANCING PAGE.                                            
21731C                                                                          
21731C     MOVE PV-PREVIOUS-BATCH-NO TO HL-BATCH.                               
21731C     SET HL-TRANSFER-PRICE-DIFF-RPT TO TRUE.                              
21731C     WRITE TRANSFER-PRICE-EXCEPTION-LINE FROM HL-HEADING-LINE-1           
21731C         AFTER ADVANCING 1 LINE.                                          
21731C                                                                          
21731C     SET HL-SYS-RETAIL           TO TRUE.                                 
21731C     SET HL-SYS-EXTENDED         TO TRUE.                                 
21731C     WRITE TRANSFER-PRICE-EXCEPTION-LINE FROM HL-HEADING-LINE-2           
21731C         AFTER ADVANCING 2 LINES.                                         
21731C                                                                          
21731C     SET HL-SYS-RETAIL-PRICE     TO TRUE.                                 
21731C     SET HL-SYS-EXTENDED-RETAIL  TO TRUE.                                 
21731C     WRITE TRANSFER-PRICE-EXCEPTION-LINE FROM HL-HEADING-LINE-3           
21731C         AFTER ADVANCING 1 LINE.                                          
21731C                                                                          
21731C     MOVE 6 TO PV-PRINT-LINE-2.                                           
                                                                        MLKUT002
                                                                        MLKUT002
00949  Z500-READ-SKU-TABLE.                                             MLKUT002
00950 *                                                                 MLKUT002
00951 *  READ THE SKU TABLE RECORDS                                     MLKUT002
00952 *                                                                 MLKUT002
00953                                                                   MLKUT002
21731 *  THIS IS THE NON-INTELLIGENT SKU                                        
W21731     MOVE ML019-SKU TO SKXREF-SKU.                                MLKUT002
00955                                                                   MLKUT002
00956      PERFORM                                                      MLKUT002
00957          WITH TEST AFTER                                          MLKUT002
00958          VARYING PV-RETRY-COUNT FROM 1 BY 1                       MLKUT002
00959          UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                  MLKUT002
00960              OR (SQLCODE = 0)                                     MLKUT002
00961              OR (SQLCODE = +100)                                  MLKUT002
00962                                                                   MLKUT002
00963          EXEC SQL                                                 MLKUT002
W21731             SELECT  SKU_STAT_CDE                                 MLKUT002
W21731                    ,INTR_UPC_ID                                  MLKUT002
W21731                    ,DEPT                                         MLKUT002
W21731                    ,SUBCLASS                                     MLKUT002
W21731             INTO   :SKXREF-SKU-STAT-CDE                          MLKUT002
W21731                   ,:SKXREF-INTR-UPC-ID                           MLKUT002
W21731                   ,:SKXREF-DEPT                                  MLKUT002
W21731                   ,:SKXREF-SUBCLASS                              MLKUT002
W21731             FROM  TSKXREF                                        MLKUT002
W21731             WHERE SKU   = :SKXREF-SKU                            MLKUT002
00976          END-EXEC                                                 MLKUT002
00977                                                                   MLKUT002
00978          EVALUATE TRUE                                            MLKUT002
00979              WHEN SQLCODE = 0                                     MLKUT002
21731C                 CONTINUE                                                 
00980              WHEN SQLCODE = -904                                  MLKUT002
00981              WHEN SQLCODE = -911                                  MLKUT002
00982              WHEN SQLCODE = +100                                  MLKUT002
21731C                 MOVE ZEROES TO SKXREF-SKU-STAT-CDE               MLKUT002
21731C                                SKXREF-DEPT                       MLKUT002
21731C                                SKXREF-SUBCLASS                   MLKUT002
21731C                                SKXREF-INTR-UPC-ID                MLKUT002
00984              WHEN OTHER                                           MLKUT002
00985                  DISPLAY '***PARAGRAPH - Z500-READ-SKU-TABLE ***' MLKUT002
00986                  PERFORM Z998-SQL-ERROR                           MLKUT002
00987          END-EVALUATE                                             MLKUT002
00988      END-PERFORM.                                                 MLKUT002
00989                                                                   MLKUT002
00990      IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          MLKUT002
00991          DISPLAY '***PARAGRAPH - Z500-READ-SKU-TABLE ***'         MLKUT002
00992          PERFORM Z998-SQL-ERROR                                   MLKUT002
00993      END-IF.                                                      MLKUT002
00994                                                                   MLKUT002
00995 * IF THE SKU WAS NOT FOUND, DETERMINE IF THE DPT/CL OR THE SEQUENCMLKUT002
00996 * NUMBER IS INVALID.                                              MLKUT002
00997                                                                   MLKUT002
00998      IF  SQLCODE = +100                                           MLKUT002
W21731         IF ML019-TRANSFER-SEQ-NO = ZEROES                                
W21731             MOVE ML019-SKU (1:3) TO ML019-TRANSFER-DEPT-NBR              
W21731             MOVE ML019-SKU (4:2) TO ML019-TRANSFER-CLASS-NBR             
W21731         ELSE                                                             
W21731             PERFORM Z600-READ-TMDARVS                                    
W21731         END-IF                                                           
W21731                                                                          
W21731         IF SQLCODE NOT = ZEROES                                          
W21731             IF ML019-TRANSFER-DEPT-NBR NUMERIC                           
W21731                 AND ML019-TRANSFER-CLASS-NBR NUMERIC                     
W21731                 PERFORM Z550-READ-SKU-XREF-TABLE                 MLKUT002
W21731             ELSE                                                         
W21731                 IF ML019-TRANSFER-SEQ-NO = ZEROES                        
W21731                     SET PI-WARN-SEQ-NO TO TRUE                           
W21731                     MOVE ZEROES TO SKXREF-SKU-STAT-CDE                   
W21731                 ELSE                                                     
W21731                     SET PI-INVALID-SEQ-NO TO TRUE                        
W21731                     MOVE ZEROES TO SKXREF-SKU-STAT-CDE                   
W21731                 END-IF                                                   
W21731             END-IF                                                       
W21731         END-IF                                                           
01000      END-IF.                                                      MLKUT002
01001 *                                                                 MLKUT002
01002 *                                                                 MLKUT002
01003  Z550-READ-SKU-XREF-TABLE.                                        MLKUT002
01004 *                                                                 MLKUT002
21731 *  READ THE SKU XREF TABLE RECORDS USING DEPARTMENT AND CLASS.    MLKUT002
01006 *                                                                 MLKUT002
W21731     MOVE ML019-TRANSFER-DEPT-NBR TO SKXREF-DEPT.                         
W21731     MOVE ML019-TRANSFER-CLASS-NBR TO SKXREF-SUBCLASS.                    
01007                                                                   MLKUT002
01008      PERFORM                                                      MLKUT002
01009          WITH TEST AFTER                                          MLKUT002
01010          VARYING PV-RETRY-COUNT FROM 1 BY 1                       MLKUT002
01011          UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                  MLKUT002
01012              OR (SQLCODE = 0)                                     MLKUT002
01013              OR (SQLCODE = +100)                                  MLKUT002
01014                                                                   MLKUT002
01015          EXEC SQL                                                 MLKUT002
W21731             SELECT  1                                            MLKUT002
W21731             INTO   :PV-DB2-TEST                                  MLKUT002
W21731             FROM    TSKXREF                                      MLKUT002
W21731             WHERE   DEPT     = :SKXREF-DEPT                      MLKUT002
W21731               AND   SUBCLASS = :SKXREF-SUBCLASS                  MLKUT002
W21731             FETCH FIRST 1 ROW ONLY                                       
01024          END-EXEC                                                 MLKUT002
01025                                                                   MLKUT002
01026          EVALUATE TRUE                                            MLKUT002
01027              WHEN SQLCODE = 0                                     MLKUT002
W21731                 MOVE ZEROES TO SKXREF-SKU-STAT-CDE               MLKUT002
01030              WHEN SQLCODE = +100                                  MLKUT002
W21731                 MOVE ZEROES TO SKXREF-SKU-STAT-CDE               MLKUT002
01032              WHEN SQLCODE = -904                                  MLKUT002
01033              WHEN SQLCODE = -911                                  MLKUT002
01034                  CONTINUE                                         MLKUT002
01035              WHEN OTHER                                           MLKUT002
21731                  DISPLAY '*PARAGRAPH - Z550-READ-SKU-XREF-TABLE*' MLKUT002
01037                  PERFORM Z998-SQL-ERROR                           MLKUT002
01038          END-EVALUATE                                             MLKUT002
01039      END-PERFORM.                                                 MLKUT002
01040                                                                   MLKUT002
01041      IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          MLKUT002
21731          DISPLAY '***PARAGRAPH - Z550-READ-SKU-XREF-TABLE ***'    MLKUT002
01043          PERFORM Z998-SQL-ERROR                                   MLKUT002
01044      END-IF.                                                      MLKUT002
01045                                                                   MLKUT002
01046 * IF THE DPT/CL WAS NOT FOUND, ATTEMPT VERIFICATION AGAINST THE MBMLKUT002
01047                                                                   MLKUT002
01048      IF  SQLCODE = +100                                           MLKUT002
01049          PERFORM Z560-READ-MBS                                    MLKUT002
01050      END-IF.                                                      MLKUT002
01051                                                                   MLKUT002
01052 *                                                                 MLKUT002
01053 *                                                                 MLKUT002
01054  Z560-READ-MBS.                                                   MLKUT002
01055 *                                                                 MLKUT002
01056 *  IF THE DEPARTMENT AND CLASS FIELDS DO NOT PASS VERIFICATION    MLKUT002
01057 *  ON THE SKU TABLE, ATTEMPT VERIFICATION AGAINST THE MBS.        MLKUT002
01058 *                                                                 MLKUT002
01059 * PARSE 2 CHARACTER CLASS INTO MBS 2 CHARACTER MAJOR CLASS AND    MLKUT002
01060 * 3 CHARACTER SUB CLASS.                                          MLKUT002
01061                                                                   MLKUT002
W21731     MOVE ML019-TRANSFER-CLASS-NBR TO PV-MAJ-CL-NBR-WORK          MLKUT002
01063                                        PV-SUB-CL-NBR-2-3.         MLKUT002
01064      MOVE '0'                       TO PV-MAJ-CL-NBR-2            MLKUT002
01065                                        PV-SUB-CL-NBR-1.           MLKUT002
W21731     MOVE ML019-TRANSFER-DEPT-NBR   TO PV-DEPT-NBR.               MLKUT002
01067                                                                   MLKUT002
01068 * AT PRESENT, DO NOT INCLUDE MAJ_CL_NBR AS PART OF THE WHERE CLAUSMLKUT002
01069      PERFORM                                                      MLKUT002
01070          WITH TEST AFTER                                          MLKUT002
01071          VARYING PV-RETRY-COUNT FROM 1 BY 1                       MLKUT002
01072          UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                  MLKUT002
01073              OR (SQLCODE = 0)                                     MLKUT002
01074              OR (SQLCODE = +100)                                  MLKUT002
01075                                                                   MLKUT002
01076              EXEC SQL                                             MLKUT002
01077                  SELECT     A.DEPT_NBR                            MLKUT002
01078                       ,     A.MAJ_CL_NBR                          MLKUT002
01079                       ,     A.SUB_CL_NBR                          MLKUT002
21731                    INTO    :MDSEAR-DEPT-NBR                       MLKUT002
21731                       ,    :MDSEAR-MAJ-CL-NBR                     MLKUT002
21731                       ,    :MDSEAR-SUB-CL-NBR                     MLKUT002
01083                    FROM     TMDSEAR A                             MLKUT002
01084                       ,     TAPLAVL B                             MLKUT002
01085                   WHERE    (A.DEPT_NBR    = :PV-DEPT-NBR)         MLKUT002
01086 *                   AND    (A.MAJ_CL_NBR  = :PV-MAJ-CL-NBR)       MLKUT002
01087                     AND    (A.SUB_CL_NBR  = :PV-SUB-CL-NBR)       MLKUT002
01088                     AND    (A.MDSELV_CDE  = :PC-MDSELV-CDE)       MLKUT002
01089                     AND    (A.OPERCO_NBR  = :PC-OPERCO-NBR)       MLKUT002
01090                     AND    (B.APLSYS_CDE  = :PC-APLSYS-CDE)       MLKUT002
01091                     AND    (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)       MLKUT002
01092                     AND    (CURRENT DATE     BETWEEN              MLKUT002
01093                             CHAR(B.MDSEAR_STRT_DTE,ISO)  AND      MLKUT002
01094                             CHAR(B.MDSEAR_END_DTE,ISO))           MLKUT002
01095                     AND    (CURRENT DATE     BETWEEN              MLKUT002
01096                             CHAR(A.STRT_DTE,ISO)         AND      MLKUT002
01097                             CHAR(A.END_DTE,ISO))                  MLKUT002
01098              END-EXEC                                             MLKUT002
01099                                                                   MLKUT002
01100          EVALUATE TRUE                                            MLKUT002
01101              WHEN SQLCODE = 0                                     MLKUT002
01102                  CONTINUE                                         MLKUT002
01103              WHEN SQLCODE = +100                                  MLKUT002
01104                  SET PI-INVALID-DPT-CL TO TRUE                    MLKUT002
01105              WHEN SQLCODE = -904                                  MLKUT002
01106              WHEN SQLCODE = -911                                  MLKUT002
01107                  CONTINUE                                         MLKUT002
01108              WHEN OTHER                                           MLKUT002
01109                  DISPLAY '***PARAGRAPH - Z560-READ-MBS ***'       MLKUT002
01110                  PERFORM Z998-SQL-ERROR                           MLKUT002
01111          END-EVALUATE                                             MLKUT002
01112                                                                   MLKUT002
01113      END-PERFORM.                                                 MLKUT002
01114                                                                   MLKUT002
01115      IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          MLKUT002
01116          DISPLAY '***PARAGRAPH - Z560-READ-MBS ***'               MLKUT002
01117          PERFORM Z998-SQL-ERROR                                   MLKUT002
01118      END-IF.                                                      MLKUT002
01119                                                                   MLKUT002
01120                                                                   MLKUT002
W21731*                                                                 MLKUT002
W21731*  READ THE UPC AND MDARVS TO GET THE DEPARTMENT/SUB-CLASS        MLKUT002
W21731*                                                                 MLKUT002
W21731 Z600-READ-TMDARVS.                                               MLKUT002
W21731     MOVE ML019-SKU  TO PV-MIN-KOHLS-UPC-SKU                              
W21731                        PV-MAX-KOHLS-UPC-SKU.                             
W21731     MOVE PV-MIN-KOHLS-UPC TO PV-MIN-KOHLS-UPC-COMP.                      
W21731     MOVE PV-MAX-KOHLS-UPC TO PV-MAX-KOHLS-UPC-COMP.                      
W21731                                                                          
W21731     PERFORM                                                      MLKUT002
W21731         WITH TEST AFTER                                          MLKUT002
W21731         VARYING PV-RETRY-COUNT FROM 1 BY 1                       MLKUT002
W21731         UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                  MLKUT002
W21731             OR (SQLCODE = 0)                                     MLKUT002
W21731             OR (SQLCODE = +100)                                  MLKUT002
W21731                                                                  MLKUT002
W21731         EXEC SQL                                                 MLKUT002
W21731             SELECT  C.UPC_STAT_CDE                               MLKUT002
W21731                    ,B.DEPT_NBR                                   MLKUT002
W21731                    ,B.SUB_CL_NBR                                 MLKUT002
W21731             INTO   :SKXREF-SKU-STAT-CDE                          MLKUT002
W21731                   ,:SKXREF-DEPT                                  MLKUT002
W21731                   ,:SKXREF-SUBCLASS                              MLKUT002
W21731             FROM  TUPC    A                                      MLKUT002
W21731                  ,TMDARVS B                                      MLKUT002
W21731                  ,TUPCPLS C                                      MLKUT002
W21731             WHERE (A.UPC_NBR      >= :PV-MIN-KOHLS-UPC-COMP      MLKUT002
W21731                    AND A.UPC_NBR  <= :PV-MAX-KOHLS-UPC-COMP)             
W21731               AND A.EFF_BEG_DTE   <= CURRENT DATE                        
W21731               AND (A.EFF_END_DTE  >= CURRENT DATE                        
W21731                    OR A.EFF_END_DTE IS NULL)                             
W21731               AND A.SUB_CL_MDSEAR_ID = B.SUB_CL_MDSEAR_ID                
W21731               AND A.VS_ID            = B.VS_ID                           
W21731               AND A.UPC_ID           = C.UPC_ID                          
W21731               AND C.OPERCO_NBR       = :PC-OPERCO-NBR                    
W21731               AND C.STR_NBR          = 0                                 
W21731               AND C.EFF_BEG_TMST    <= CURRENT TIMESTAMP                 
W21731               AND (C.EFF_END_TMST   >= CURRENT TIMESTAMP                 
W21731                    OR C.EFF_END_TMST IS NULL)                            
W21731         END-EXEC                                                 MLKUT002
W21731                                                                  MLKUT002
W21731         EVALUATE TRUE                                            MLKUT002
W21731             WHEN SQLCODE = 0                                     MLKUT002
W21731             WHEN SQLCODE = -904                                  MLKUT002
W21731             WHEN SQLCODE = -911                                  MLKUT002
W21731                 CONTINUE                                         MLKUT002
W21731             WHEN SQLCODE = +100                                  MLKUT002
W21731                 SET PI-INVALID-SKU TO TRUE                       MLKUT002
W21731                 DISPLAY ' '                                      MLKUT002
W21731                 DISPLAY '**** PROGRAM MLKUT002'                  MLKUT002
W21731                 DISPLAY '**** PARAGRAPH Z600-READ-TMDARVS'       MLKUT002
W21731                 DISPLAY '**** ORIGINAL SKU = ' ML019-SKU         MLKUT002
W21731                         '**** NOT FOUND ON TUPC/TMDARVS'         MLKUT002
W21731             WHEN OTHER                                           MLKUT002
W21731                 DISPLAY '***PARAGRAPH - Z600-READ-TMDARVS ***'   MLKUT002
W21731                 PERFORM Z998-SQL-ERROR                           MLKUT002
W21731         END-EVALUATE                                             MLKUT002
W21731     END-PERFORM.                                                 MLKUT002
W21731                                                                  MLKUT002
W21731     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          MLKUT002
W21731         DISPLAY '***PARAGRAPH - Z600-READ-TMDARVS ***'           MLKUT002
W21731         PERFORM Z998-SQL-ERROR                                   MLKUT002
W21731     END-IF.                                                      MLKUT002
W21731                                                                  MLKUT002
01166  Z700-READ-SKU-TABLE.                                             MLKUT002
01167 *                                                                 MLKUT002
01168 *  READ THE SKU TABLE RECORDS USING ITEM NUMBER                   MLKUT002
01169 *                                                                 MLKUT002
01170      PERFORM                                                      MLKUT002
01171          WITH TEST AFTER                                          MLKUT002
01172          VARYING PV-RETRY-COUNT FROM 1 BY 1                       MLKUT002
01173          UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                  MLKUT002
01174              OR (SQLCODE = 0)                                     MLKUT002
01175              OR (SQLCODE = +100)                                  MLKUT002
01176                                                                   MLKUT002
01177          EXEC SQL                                                 MLKUT002
W21731             SELECT  SKU_STAT_CDE                                 MLKUT002
W21731                    ,DEPT                                         MLKUT002
W21731                    ,SUBCLASS                                     MLKUT002
W21731                    ,SKU                                          MLKUT002
W21731             INTO   :SKXREF-SKU-STAT-CDE                          MLKUT002
W21731                   ,:SKXREF-DEPT                                  MLKUT002
W21731                   ,:SKXREF-SUBCLASS                              MLKUT002
W21731                   ,:SKXREF-SKU                                   MLKUT002
W21731             FROM  TSKXREF                                        MLKUT002
W21731             WHERE INTR_UPC_ID = :SKXREF-INTR-UPC-ID              MLKUT002
W21731               AND SKU_STAT_CDE ^= :PC-RENUM-STATUS                       
W21731               AND SKU_STAT_CDE ^= :PC-DELETED-STATUS                     
01188          END-EXEC                                                 MLKUT002
01189                                                                   MLKUT002
01190          EVALUATE TRUE                                            MLKUT002
01191              WHEN SQLCODE = 0                                     MLKUT002
01192              WHEN SQLCODE = -904                                  MLKUT002
01193              WHEN SQLCODE = -911                                  MLKUT002
01194                  CONTINUE                                         MLKUT002
01195              WHEN SQLCODE = +100                                  MLKUT002
01196                  SET PI-INVALID-SKU TO TRUE                       MLKUT002
01197                  DISPLAY ' '                                      MLKUT002
01198                  DISPLAY '**** PROGRAM MLKUT002'                  MLKUT002
01199                  DISPLAY '**** PARAGRAPH Z700-READ-SKU-TABLE'     MLKUT002
W21731                 DISPLAY '**** ORIGINAL SKU = ' ML019-SKU         MLKUT002
W21731                         '**** NOT FOUND ON TSKXREF'              MLKUT002
01204              WHEN OTHER                                           MLKUT002
01205                  DISPLAY '***PARAGRAPH - Z700-READ-SKU-TABLE ***' MLKUT002
01206                  PERFORM Z998-SQL-ERROR                           MLKUT002
01207          END-EVALUATE                                             MLKUT002
01208      END-PERFORM.                                                 MLKUT002
01209                                                                   MLKUT002
01210      IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          MLKUT002
01211          DISPLAY '***PARAGRAPH - Z700-READ-SKU-TABLE ***'         MLKUT002
01212          PERFORM Z998-SQL-ERROR                                   MLKUT002
01213      END-IF.                                                      MLKUT002
01214                                                                   MLKUT002
21731C Z800-GET-PRICE.                                                          
21731C                                                                          
21731C     MOVE PV-TIMESTAMP      TO UPCPLS-EFF-BEG-TMST.                       
21731C     SET PI-PRICE-NOT-FOUND TO TRUE.                                      
21731C                                                                          
21731C     PERFORM                                                              
21731C         WITH TEST AFTER                                                  
21731C         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
21731C         UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                          
21731C             OR (SQLCODE = 0)                                             
21731C             OR (SQLCODE = +100)                                          
21731C                                                                          
21731C         EXEC SQL                                                         
21731C             SELECT  UNT_RTL_AMT                                          
21731C                    ,MEITGP_NBR                                           
21731C                    ,UPC_STAT_CHG_DTE                                     
21731C                    ,UNT_RTL_CHG_DTE                                      
21731C             INTO   :UPCPLS-UNT-RTL-AMT                                   
21731C                   ,:UPCPLS-MEITGP-NBR                                    
21731C                   ,:UPCPLS-UPC-STAT-CHG-DTE                              
21731C                   ,:UPCPLS-UNT-RTL-CHG-DTE                               
21731C             FROM                                                         
21731C                   TUPCPLS                                                
21731C             WHERE                                                        
21731C                   UPC_ID             = :SKXREF-INTR-UPC-ID               
21731C               AND OPERCO_NBR         = :PC-OPERCO-NBR                    
21731C               AND STR_NBR            = :UPCPLS-STR-NBR                   
21731C               AND EFF_BEG_TMST      <= :UPCPLS-EFF-BEG-TMST              
21731C               AND (EFF_END_TMST     >= :UPCPLS-EFF-BEG-TMST              
21731C                    OR EFF_END_TMST IS NULL)                              
21731C         END-EXEC                                                         
21731C                                                                          
21731C         EVALUATE TRUE                                                    
21731C             WHEN SQLCODE = 0                                             
21731C                  SET PI-PRICE-FOUND    TO TRUE                           
21731C                  IF UPCPLS-MEITGP-NBR NOT = ZEROES                       
21731C                      PERFORM Z850-GET-GROUP-PRICE                        
21731C                  END-IF                                                  
21731C             WHEN SQLCODE = -904                                          
21731C             WHEN SQLCODE = -911                                          
21731C             WHEN SQLCODE = +100                                          
21731C                 CONTINUE                                                 
21731C             WHEN OTHER                                                   
21731C                 DISPLAY '***PARAGRAPH - Z800-GET-PRICE ***'              
21731C                 DISPLAY ' UPC-ID: ' SKXREF-INTR-UPC-ID                   
21731C                         ' STORE:  ' UPCPLS-STR-NBR                       
21731C                         ' EFF TIMESTAMP: ' UPCPLS-EFF-BEG-TMST           
21731C                 PERFORM Z998-SQL-ERROR                                   
21731C         END-EVALUATE                                                     
21731C     END-PERFORM.                                                         
21731C                                                                          
21731C     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
21731C         DISPLAY '*** MAX RETRIES - Z800-GET-PRICE ***'                   
21731C         DISPLAY ' UPC-ID: ' SKXREF-INTR-UPC-ID                           
21731C                 ' STORE:  ' UPCPLS-STR-NBR                               
21731C                 ' EFF TIMESTAMP: ' UPCPLS-EFF-BEG-TMST                   
21731C         PERFORM Z998-SQL-ERROR                                           
21731C     END-IF.                                                              
21731C                                                                          
21731C Z850-GET-GROUP-PRICE.                                                    
21731C                                                                          
21731C     DISPLAY ' *** LOOKING UP GROUP PRICING ***'                          
21731C             ' FROM STORE: ' ML019-TRANSFER-FROM-STORE-NBR                
21731C             ' TO STORE: ' ML019-TRANSFER-TO-STORE-NBR                    
21731C             ' SKU:   ' ML019-SKU.                                        
21731C                                                                          
21731C     PERFORM                                                              
21731C         WITH TEST AFTER                                                  
21731C         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
21731C         UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                          
21731C             OR (SQLCODE = 0)                                             
21731C             OR (SQLCODE = +100)                                          
21731C                                                                          
21731C         EXEC SQL                                                         
21731C             SELECT  MITGPL_QTY                                           
21731C                    ,GP_AMT                                               
21731C             INTO    :MITGPL-MITGPL-QTY                                   
21731C                    ,:MITGPL-GP-AMT                                       
21731C             FROM   TMITGPL                                               
21731C             WHERE  OPERCO_NBR    = :PC-OPERCO-NBR                        
21731C               AND  MEITGP_NBR    = :UPCPLS-MEITGP-NBR                    
21731C               AND  ADLOC_ID      = '   '                                 
21731C               AND  (CURRENT DATE BETWEEN                                 
21731C                     BEG_DTE AND END_DTE)                                 
21731C         END-EXEC                                                         
21731C                                                                          
21731C         EVALUATE TRUE                                                    
21731C             WHEN SQLCODE = 0                                             
21731C                  COMPUTE UPCPLS-UNT-RTL-AMT ROUNDED =                    
21731C                        (MITGPL-GP-AMT /                                  
21731C                         MITGPL-MITGPL-QTY )                              
21731C             WHEN SQLCODE = -904                                          
21731C             WHEN SQLCODE = -911                                          
21731C             WHEN SQLCODE = +100                                          
21731C                 CONTINUE                                                 
21731C             WHEN OTHER                                                   
21731C                 DISPLAY '***PARAGRAPH - Z850-GET-GROUP-PRICE ***'        
21731C                 DISPLAY ' UPC-ID: ' SKXREF-INTR-UPC-ID                   
21731C                         ' STORE:  ' UPCPLS-STR-NBR                       
21731C                         ' GROUP PRICE ID: ' UPCPLS-MEITGP-NBR            
21731C                 PERFORM Z998-SQL-ERROR                                   
21731C         END-EVALUATE                                                     
21731C     END-PERFORM.                                                         
21731C                                                                          
21731C     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
21731C         DISPLAY '*** MAX RETRIES - Z850-GET-GROUP-PRICE ***'             
21731C         DISPLAY ' UPC-ID: ' SKXREF-INTR-UPC-ID                           
21731C                 ' STORE:  ' UPCPLS-STR-NBR                               
21731C                 ' GROUP PRICE ID: ' UPCPLS-MEITGP-NBR                    
21731C         PERFORM Z998-SQL-ERROR                                           
21731C     END-IF.                                                              
21731C                                                                          
01215  Z910-FETCH-STORE-TABLE.                                          MLKUT002
01216 ******************************************************************MLKUT002
01217 *  FETCH THE DB2 STORE TABLE INTO THE DCLGEN.                    *MLKUT002
01218 ******************************************************************MLKUT002
01219      EXEC SQL                                                     MLKUT002
W26603         FETCH XMTLOC_CSR                                         MLKUT002
W26603         INTO   :XMT00001-LOC-NBR,                                MLKUT002
W26603                :XMT00002-EFF-BEG-DTE,                            MLKUT002
W26603                :XMT00001-FINCL-CLO-DTE                           MLKUT002
01227      END-EXEC.                                                    MLKUT002
01228 *                                                                 MLKUT002
01229      IF SQLCODE < 000                                             MLKUT002
01230          DISPLAY '** ABEND ** = FETCH ERROR ON STORE TABLE'       MLKUT002
W26603         DISPLAY '** LAST STORE READ ** = ' XMT00001-LOC-NBR      MLKUT002
01232          GO TO Z998-SQL-ERROR                                     MLKUT002
01233      ELSE                                                         MLKUT002
01234          IF SQLCODE > +100                                        MLKUT002
01235              DISPLAY '** ABEND ** = FETCH WARNING '               MLKUT002
01236                      'ON STORE TABLE'                             MLKUT002
01237              DISPLAY '** LAST STORE READ ** = '                   MLKUT002
W26603                     XMT00001-LOC-NBR                             MLKUT002
01239              GO TO Z999-SQL-WARNING                               MLKUT002
01240          END-IF                                                   MLKUT002
01241      END-IF.                                                      MLKUT002
01242 *                                                                 MLKUT002
01243  Z920-LOAD-STORES.                                                MLKUT002
01244 ******************************************************************MLKUT002
01245 *  LOAD THE STORE DATA INTO THE WORKING STORAGE TABLE.           *MLKUT002
01246 ******************************************************************MLKUT002
01247                                                                   MLKUT002
01248      IF SQLCODE = 000                                             MLKUT002
W26603         MOVE XMT00001-LOC-NBR TO PS-SUB                          MLKUT002
W26603         MOVE 03               TO ST2-OP-CO-NMBR (PS-SUB)         MLKUT002
W26603         MOVE XMT00001-LOC-NBR TO ST2-STORE-NMBR (PS-SUB)         MLKUT002
01252                                                                   MLKUT002
W26603         MOVE XMT00002-EFF-BEG-DTE                                MLKUT002
W26603                             TO ST2-DCX-RCT-START-DATE (PS-SUB)   MLKUT002
W26603                                                                  MLKUT002
W26603         MOVE XMT00001-FINCL-CLO-DTE TO ST2-FIN-CLS-DTE (PS-SUB)  MLKUT002
W26603         MOVE '01'             TO ST2-FINANCE-CORP-NMBR (PS-SUB)  MLKUT002
W26603                                                                  MLKUT002
01265      END-IF.                                                      MLKUT002
01266                                                                   MLKUT002
01267      PERFORM Z910-FETCH-STORE-TABLE.                              MLKUT002
01268                                                                   MLKUT002
01269  Z998-SQL-ERROR.                                                  MLKUT002
01270 ******************************************************************MLKUT002
01271 *  THIS MODULE PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT   *MLKUT002
01272 *  THAT AN SQL ERROR CODE OCCURS.                                *MLKUT002
01273 ******************************************************************MLKUT002
01274      MOVE SQLCODE TO SQLCODE2.                                    MLKUT002
01275      MOVE SQLERRD(3) TO SQLERRD3.                                 MLKUT002
01276      DISPLAY '** ABEND **         ** = SQLERROR'.                 MLKUT002
01277      DISPLAY '** PROGRAM          ** = MLKUT002'.                 MLKUT002
01278      DISPLAY '** SQLCODE          ** = ' SQLCODE2.                MLKUT002
01279      DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                MLKUT002
01280      DISPLAY '** SQLERRM          ** = ' SQLERRM.                 MLKUT002
01281      DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                MLKUT002
01282 *                                                                 MLKUT002
01283      EXEC SQL                                                     MLKUT002
01284          COMMIT                                                   MLKUT002
01285      END-EXEC.                                                    MLKUT002
01286 *                                                                 MLKUT002
01287      MOVE +4013 TO ABEND-CODE.                                    MLKUT002
01288      CALL 'ILBOABN0' USING ABEND-CODE.                            MLKUT002
01289 *                                                                 MLKUT002
01290 *                                                                 MLKUT002
01291  Z999-SQL-WARNING.                                                MLKUT002
01292 ******************************************************************MLKUT002
01293 *  THIS MODULE PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT   *MLKUT002
01294 *  THAT AN SQL WARNING CODE OCCURS.                              *MLKUT002
01295 ******************************************************************MLKUT002
01296      MOVE SQLERRD(3) TO SQLERRD3.                                 MLKUT002
01297      DISPLAY '** ABEND **       ** = SQLWARNING'.                 MLKUT002
01298      DISPLAY '** PROGRAM        ** = MLKUT002'.                   MLKUT002
01299      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  MLKUT002
01300      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  MLKUT002
01301      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  MLKUT002
01302      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  MLKUT002
01303      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  MLKUT002
01304      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  MLKUT002
01305      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  MLKUT002
01306      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  MLKUT002
01307      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  MLKUT002
01308      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  MLKUT002
01309 *                                                                 MLKUT002
01310      EXEC SQL                                                     MLKUT002
01311          COMMIT                                                   MLKUT002
01312      END-EXEC.                                                    MLKUT002
01313 *                                                                 MLKUT002
01314      MOVE +4013 TO ABEND-CODE.                                    MLKUT002
01315      CALL 'ILBOABN0' USING ABEND-CODE.                            MLKUT002
