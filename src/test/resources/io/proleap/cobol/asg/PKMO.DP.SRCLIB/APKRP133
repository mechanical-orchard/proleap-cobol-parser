000100*-----------------------*                                         00010025
000200 IDENTIFICATION DIVISION.                                         00020026
000300*-----------------------*                                         00030026
000400 PROGRAM-ID.     APKRP133.                                        00040026
000500 AUTHOR.         CHRIS KUNSTMANN IBS.                             00050026
000600 DATE-WRITTEN.   12/29/1998.                                      00060026
000700 DATE-COMPILED.                                                   00070026
000800*---------------------------------------------------------------* 00080026
000900*    COBOL II                                                   * 00090026
001000*                                                               * 00100026
001100*          BATCH ADJUSTMENT JOURNAL ERROR REPORT                * 00110026
001200*                                                               * 00120026
001300* THE PURPOSE OF THIS PROGRAM IS TO PRODUCE A REPORT OF ANY     * 00130026
001400* ERRORS ENCOUNTERED WHEN ATTEMPTING INTO INSERT ROWS TO THE    * 00140026
001500* ADJUSTMENT JOURNAL DATABASE.                                  * 00150026
001600*                                                               * 00160026
001700*---------------------------------------------------------------* 00170026
001800*                                                               * 00180026
001900* INPUT:                                                        * 00190026
002000*  1. BATCH ADJUSTMENT LOAD ERRORS          (APRD041)           * 00200026
002100*                                                               * 00210026
002200* OUTPUT:                                                       * 00220026
002300*  1. BATCH ADJUSTMENT JOURNAL ERROR REPORT                     * 00230026
002400*                                                               * 00240026
002500*---------------------------------------------------------------* 00250026
002600*   CHANGES:                                                    * 00260026
002700*   10/06/1999   JILL JUEL               WR/PITS # 5998         * 00270026
002800*       ADDED CODE FOR DMA NBR NOT FOUND.                       * 00280026
002900*                                                               * 00290026
003000*   08/25/2000  JILL JUEL                WR/IR #: 20224         * 00300026
003100*      ADDED LOGIC TO PROCESS THE NEW MOS FIELDS. THE NEW       * 00310026
003200*      FIELD IS HANDLED THE SAME WAY THE NEW STORE DISCOUNT     * 00320026
003300*      IS HANDLED.                                              * 00330026
003400*                                                               * 00340026
003410*   DATE  10/24/2008                                            * 00341027
003420*       CHANGE MADE: UPDATED THE LENGTH OF THE INPUT FILE FROM  * 00342027
003421*       80 TO 100 BYTES TO MATCH THE LENGTH OF THE APRD041      * 00342127
003422*       COPYBOOK.                                               * 00342227
003430*       MADE BY: MIKE BESKE              WR/IR #: WR35173       * 00343027
003450*                                                               * 00345027
003500*---------------------------------------------------------------* 00350026
003600                                                                  00360026
003700 ENVIRONMENT DIVISION.                                            00370026
003800 CONFIGURATION SECTION.                                           00380026
003900 SOURCE-COMPUTER.    IBM-3090.                                    00390026
004000 OBJECT-COMPUTER.    IBM-3090.                                    00400026
004100                                                                  00410026
004200 INPUT-OUTPUT SECTION.                                            00420026
004300 FILE-CONTROL.                                                    00430026
004400                                                                  00440026
004500     SELECT ADJ-ERROR-FILE       ASSIGN TO UT-S-INP01.            00450026
004600     SELECT REPORT-FILE          ASSIGN TO UT-S-RPT01.            00460026
004700                                                                  00470026
004800                                                                  00480026
004900 DATA DIVISION.                                                   00490026
005000 FILE SECTION.                                                    00500026
005100                                                                  00510026
005200 FD  ADJ-ERROR-FILE                                               00520026
005300     RECORDING MODE IS F                                          00530026
005400     LABEL RECORDS ARE STANDARD                                   00540026
005500     BLOCK CONTAINS 0 RECORDS                                     00550026
005600     DATA RECORD IS ADJ-ERROR-REC.                                00560026
005700 01  ADJ-ERROR-REC               PIC  X(100).                     00570027
005800                                                                  00580026
005900 FD  REPORT-FILE                                                  00590026
006000     RECORDING MODE IS F                                          00600026
006100     LABEL RECORDS ARE STANDARD                                   00610026
006200     BLOCK CONTAINS 0 RECORDS                                     00620026
006300     DATA RECORD IS REPORT-REC.                                   00630026
006400 01  REPORT-REC                  PIC  X(132).                     00640026
006500                                                                  00650026
006600                                                                  00660026
006700 WORKING-STORAGE SECTION.                                         00670026
006800 01  PROGRAM-CONSTANTS.                                           00680026
006900     05  PC-PROGRAM-NAME         PIC  X(08)     VALUE 'APKRP133'. 00690026
007000     05  PC-TRANCODE-ERR         PIC  X(45)     VALUE             00700026
007100         'INVALID AP TRANS CODE - NOT FOUND ON SYSTEM  '.         00710026
007200     05  PC-OUTOFBAL-ERR         PIC  X(45)     VALUE             00720026
007300         'HEADER/DETAIL RECORDS OUT OF BALANCE         '.         00730026
007400     05  PC-DTLWOHDR-ERR         PIC  X(45)     VALUE             00740026
007500         'DETAIL RECORD(S) FOUND WITHOUT HEADER RECORD '.         00750026
007600     05  PC-HDRWODTL-ERR         PIC  X(45)     VALUE             00760026
007700         'HEADER RECORD FOUND WITHOUT DETAIL RECORD(S) '.         00770026
007800     05  PC-INPUT-ERR            PIC  X(45)     VALUE             00780026
007900         'INVALID INPUT DATA - UNSPECIFIED ERROR FOUND '.         00790026
008000     05  PC-DMA-NOT-FOUND        PIC  X(45)     VALUE             00800026
008100         'DMA NUMBER NOT FOUND FROM ADJ JRNL EXTRACT   '.         00810026
008200     05  PC-FIELD-ERR-MSG        PIC  X(20)     VALUE             00820026
008300         'FIELDS IN ERROR     '.                                  00830026
008400     05  PC-MULT-ERR-MSG         PIC  X(18)     VALUE             00840026
008500         '  MULTIPLE AMOUNT '.                                    00850026
008600     05  PC-GROSS-ERR-MSG        PIC  X(20)     VALUE             00860026
008700         '  GROSS COST AMOUNT '.                                  00870026
008800     05  PC-RETAIL-ERR-MSG       PIC  X(16)     VALUE             00880026
008900         '  RETAIL AMOUNT '.                                      00890026
009000     05  PC-FREIGHT-ERR-MSG      PIC  X(17)     VALUE             00900026
009100         '  FREIGHT AMOUNT '.                                     00910026
009200     05  PC-MISC-ERR-MSG         PIC  X(21)     VALUE             00920026
009300         '  MISC CHARGE AMOUNT '.                                 00930026
009400     05  PC-NET-ERR-MSG          PIC  X(18)     VALUE             00940026
009500         '  NET COST AMOUNT '.                                    00950026
009600     05  PC-TERM-ERR-MSG         PIC  X(23)     VALUE             00960026
009700         '  TERM DISCOUNT AMOUNT '.                               00970026
009800     05  PC-NEW-STORE-ERR-MSG    PIC  X(25)     VALUE             00980026
009900         '  NEW STORE DISCOUNT AMT '.                             00990026
010000     05  PC-TRD-ERR-MSG          PIC  X(22)     VALUE             01000026
010100         '  TRD DISCOUNT AMOUNT '.                                01010026
010200     05  PC-MOS-ERR-MSG          PIC  X(22)     VALUE             01020026
010300         '  MOS DISCOUNT AMOUNT '.                                01030026
010400     05  PC-LINES-MAX            PIC S999       VALUE +60.        01040026
010500                                                                  01050026
010600 01  PROGRAM-SWITCHES.                                            01060026
010700     05  PS-ERROR-EOF-SW         PIC  X         VALUE 'N'.        01070026
010800         88  PS-ERROR-NOT-EOF                   VALUE 'N'.        01080026
010900         88  PS-ERROR-EOF                       VALUE 'Y'.        01090026
011000                                                                  01100026
011100 01  PV-REPORT-CONTROLS.                                          01110026
011200     05  PV-LINE-SKIP            PIC S999       VALUE ZEROES.     01120026
011300     05  PV-LINES-PER-PAGE       PIC S999       VALUE +999.       01130026
011400     05  PV-PAGE-COUNT           PIC S9(05)     VALUE ZEROES.     01140026
011500                                                                  01150026
011600 01  PV-PROCESS-COUNTERS.                                         01160026
011700     05  PV-ERRORS-READ          PIC  9(08)     VALUE ZEROES.     01170026
011800     05  PV-ERRORS-PRINTED       PIC  9(08)     VALUE ZEROES.     01180026
011900                                                                  01190026
012000 01  PROGRAM-VARIABLES.                                           01200026
012100     05  PV-CURRENT-DATE.                                         01210026
012200         10  PV-CURRENT-YEAR     PIC  9(02)     VALUE ZEROS.      01220026
012300         10  PV-CURRENT-MONTH    PIC  9(02)     VALUE ZEROS.      01230026
012400         10  PV-CURRENT-DAY      PIC  9(02)     VALUE ZEROS.      01240026
012500     05  PV-CURRENT-TIME.                                         01250026
012600         10  PV-CURRENT-HOUR     PIC  9(02)     VALUE ZEROES.     01260026
012700         10  PV-CURRENT-MINUTE   PIC  9(02)     VALUE ZEROES.     01270026
012800         10  FILLER              PIC  9(02)     VALUE ZEROES.     01280026
012900                                                                  01290026
013000     05  PV-KEY-FIELDS.                                           01300026
013100         10  PV-VENDOR-NBR       PIC X(09)      VALUE SPACES.     01310026
013200         10  PV-DOC-NBR          PIC X(16)      VALUE SPACES.     01320026
013300         10  PV-DOC-DTE          PIC X(10)      VALUE SPACES.     01330026
013400         10  PV-AP-TRN-CDE       PIC X(02)      VALUE SPACES.     01340026
013500                                                                  01350026
013600     05  PV-VENDOR-NAME          PIC  X(30)     VALUE SPACES.     01360026
013700     05  PV-ERROR-CDE            PIC  X(02)     VALUE SPACES.     01370026
013800                                                                  01380026
013900     05  PV-FIELD-ERR.                                            01390026
014000         10  FILLER              PIC  X(02)     VALUE SPACES.     01400026
014100         10  PV-FIELD-ERR-VAR    PIC  X(23)     VALUE SPACES.     01410026
014200         10  PV-FIELD-ERR-CON    PIC  X(20)     VALUE SPACES.     01420026
014300                                                                  01430026
014400*----------------------------------------------------------------*01440026
014500*  INPUT RECORD LAYOUT                                            01450026
014600*----------------------------------------------------------------*01460026
014700     COPY APRD041.                                                01470026
014800                                                                  01480026
014900*----------------------------------------------------------------*01490026
015000*  STANDARD HEADER LAYOUT                                         01500026
015100*----------------------------------------------------------------*01510026
015200     COPY DPWS132O.                                               01520026
015300                                                                  01530026
015400*----------------------------------------------------------------*01540026
015500*  REPORT LAYOUT                                                  01550026
015600*----------------------------------------------------------------*01560026
015700                                                                  01570026
015800 01  HL-HEADER2.                                                  01580026
015900     05  FILLER                  PIC  X(48)     VALUE SPACES.     01590026
016000     05  HL-TITLE                PIC  X(37)     VALUE             01600026
016100         'BATCH ADJUSTMENT JOURNAL ERROR REPORT'.                 01610026
016200     05  FILLER                  PIC  X(47)     VALUE SPACES.     01620026
016300                                                                  01630026
016400 01  HL-HEADER3.                                                  01640026
016500     05  FILLER                  PIC   X(09)    VALUE             01650026
016600         '   VENDOR'.                                             01660026
016700     05  FILLER                  PIC   X(10)    VALUE SPACES.     01670026
016800     05  FILLER                  PIC   X(08)    VALUE 'DOCUMENT'. 01680026
016900     05  FILLER                  PIC   X(07)    VALUE SPACES.     01690026
017000     05  FILLER                  PIC   X(08)    VALUE 'DOCUMENT'. 01700026
017100     05  FILLER                  PIC   X(03)    VALUE SPACES.     01710026
017200     05  FILLER                  PIC   X(04)    VALUE 'TRAN'.     01720026
017300     05  FILLER                  PIC   X(10)    VALUE SPACES.     01730026
017400     05  FILLER                  PIC   X(06)    VALUE 'VENDOR'.   01740026
017500     05  FILLER                  PIC   X(67)    VALUE SPACES.     01750026
017600                                                                  01760026
017700 01  HL-HEADER4.                                                  01770026
017800     05  FILLER                  PIC   X(09)    VALUE             01780026
017900         '   NUMBER'.                                             01790026
018000     05  FILLER                  PIC   X(11)    VALUE SPACES.     01800026
018100     05  FILLER                  PIC   X(06)    VALUE 'NUMBER'.   01810026
018200     05  FILLER                  PIC   X(10)    VALUE SPACES.     01820026
018300     05  FILLER                  PIC   X(04)    VALUE 'DATE'.     01830026
018400     05  FILLER                  PIC   X(05)    VALUE SPACES.     01840026
018500     05  FILLER                  PIC   X(04)    VALUE 'CODE'.     01850026
018600     05  FILLER                  PIC   X(11)    VALUE SPACES.     01860026
018700     05  FILLER                  PIC   X(04)    VALUE 'NAME'.     01870026
018800     05  FILLER                  PIC   X(28)    VALUE SPACES.     01880026
018900     05  FILLER                  PIC   X(14)    VALUE             01890026
019000         'ERROR MESSAGES'.                                        01900026
019100     05  FILLER                  PIC   X(26)    VALUE SPACES.     01910026
019200                                                                  01920026
019300                                                                  01930026
019400 01  DL-DETAIL.                                                   01940026
019500     05  FILLER                  PIC   X(02)    VALUE SPACES.     01950026
019600     05  DL-VENDOR-NBR           PIC   X(09)    VALUE SPACES.     01960026
019700     05  FILLER                  PIC   X(03)    VALUE SPACES.     01970026
019800     05  DL-DOC-NBR              PIC   X(16)    VALUE SPACES.     01980026
019900     05  FILLER                  PIC   X(03)    VALUE SPACES.     01990026
020000     05  DL-DOC-DTE              PIC   X(10)    VALUE SPACES.     02000026
020100     05  FILLER                  PIC   X(03)    VALUE SPACES.     02010026
020200     05  DL-AP-TRN-CDE           PIC   X(02)    VALUE SPACES.     02020026
020300     05  FILLER                  PIC   X(03)    VALUE SPACES.     02030026
020400     05  DL-VENDOR-NAME          PIC   X(30)    VALUE SPACES.     02040026
020500     05  FILLER                  PIC   X(03)    VALUE SPACES.     02050026
020600     05  DL-ERROR-MESSAGE        PIC   X(45)    VALUE SPACES.     02060026
020700     05  FILLER                  PIC   X(03)    VALUE SPACES.     02070026
020800                                                                  02080026
020900                                                                  02090026
021000 01  END-OF-REPORT.                                               02100026
021100     05  FILLER                  PIC  X(47)   VALUE SPACES.       02110026
021200     05  FILLER                  PIC  X(37)   VALUE               02120026
021300         '**********  END OF REPORT  **********'.                 02130026
021400     05  FILLER                  PIC  X(48)   VALUE SPACES.       02140026
021500                                                                  02150026
021600                                                                  02160026
021700 01  FILLER                      PIC  X(25)  VALUE                02170026
021800     '** END OF APKRP133 W/S **'.                                 02180026
021900                                                                  02190026
022000 PROCEDURE DIVISION.                                              02200026
022100 A100-MAIN.                                                       02210026
022200                                                                  02220026
022300     PERFORM B100-INITIALIZE.                                     02230026
022400                                                                  02240026
022500     PERFORM B200-PROCESS-ERROR-FILE                              02250026
022600         UNTIL PS-ERROR-EOF.                                      02260026
022700                                                                  02270026
022800     PERFORM B300-END-OF-PROGRAM.                                 02280026
022900                                                                  02290026
023000     GOBACK.                                                      02300026
023100                                                                  02310026
023200                                                                  02320026
023300 B100-INITIALIZE.                                                 02330026
023400*----------------------------------------------------------------*02340026
023500*    INITIALIZATION PROCESSING                                   *02350026
023600*    - OPEN FILES.                                               *02360026
023700*    - FORMAT PAGE HEADINGS.                                     *02370026
023800*    - READ INPUT FILE.                                          *02380026
023900*----------------------------------------------------------------*02390026
024000                                                                  02400026
024100     OPEN INPUT  ADJ-ERROR-FILE                                   02410026
024200          OUTPUT REPORT-FILE.                                     02420026
024300                                                                  02430026
024400     ACCEPT PV-CURRENT-DATE FROM DATE.                            02440026
024500     MOVE PV-CURRENT-MONTH       TO DP132O-RUN-MONTH.             02450026
024600     MOVE PV-CURRENT-DAY         TO DP132O-RUN-DAY.               02460026
024700     MOVE PV-CURRENT-YEAR        TO DP132O-RUN-YEAR.              02470026
024800                                                                  02480026
024900     ACCEPT PV-CURRENT-TIME FROM TIME.                            02490026
025000     MOVE PV-CURRENT-HOUR        TO DP132O-RUN-HOUR.              02500026
025100     MOVE PV-CURRENT-MINUTE      TO DP132O-RUN-MINUTE.            02510026
025200     MOVE PC-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          02520026
025300     MOVE 1                      TO DP132O-REPORT-NUMBER.         02530026
025400                                                                  02540026
025500     PERFORM R100-READ-INPUT.                                     02550026
025600     IF PS-ERROR-EOF                                              02560026
025700         PERFORM W100-WRITE-HEADINGS                              02570026
025800         DISPLAY ' NO RECORDS TO PROCESS. EMPTY ERROR DATASET'    02580026
025900         MOVE ' NO RECORDS TO PROCESS. EMPTY ERROR DATASET'       02590026
026000                                 TO REPORT-REC                    02600026
026100         WRITE REPORT-REC AFTER 2                                 02610026
026200     END-IF.                                                      02620026
026300                                                                  02630026
026400                                                                  02640026
026500 B200-PROCESS-ERROR-FILE.                                         02650026
026600*----------------------------------------------------------------*02660026
026700*    PROCESS ERROR FILE.                                         *02670026
026800*                                                                *02680026
026900*    - IF NEW KEY, MOVE THE KEY FIELDS TO THE PRINT LINE AND     *02690026
027000*       UPDATE THE HOLD FIELDS.                                  *02700026
027100*    - FORMAT AND WRITE THE ERROR MESSAGE.                       *02710026
027200*    - IF OUT OF BALANCE ERROR, FORMAT AND PRINT A DETAILED MSG. *02720026
027300*    - READ THE IMPORT FILE.                                     *02730026
027400*----------------------------------------------------------------*02740026
027500                                                                  02750026
027600*    - IF NEW KEY, MOVE THE KEY FIELDS TO THE PRINT LINE AND      02760026
027700*       UPDATE THE HOLD FIELDS.                                   02770026
027800     IF AP041-KEY-FIELDS NOT = PV-KEY-FIELDS                      02780026
027900         MOVE AP041-VENDOR-NBR   TO DL-VENDOR-NBR                 02790026
028000         MOVE AP041-DOC-NBR      TO DL-DOC-NBR                    02800026
028100         MOVE AP041-DOC-DTE      TO DL-DOC-DTE                    02810026
028200         MOVE AP041-AP-TRN-CDE   TO DL-AP-TRN-CDE                 02820026
028300         MOVE AP041-VENDOR-NAME  TO DL-VENDOR-NAME                02830026
028400                                                                  02840026
028500         MOVE AP041-KEY-FIELDS   TO PV-KEY-FIELDS                 02850026
028600         MOVE +2                 TO PV-LINE-SKIP                  02860026
028700     ELSE                                                         02870026
028800         MOVE +1                 TO PV-LINE-SKIP                  02880026
028900     END-IF.                                                      02890026
029000                                                                  02900026
029100*  FORMAT AND WRITE THE ERROR MESSAGE.                            02910026
029200     EVALUATE TRUE                                                02920026
029300       WHEN AP041-INVALID-AP-TRN-CDE                              02930026
029400         MOVE PC-TRANCODE-ERR    TO DL-ERROR-MESSAGE              02940026
029500       WHEN AP041-HDR-DTL-OUT-OF-BALANCE                          02950026
029600         MOVE PC-OUTOFBAL-ERR    TO DL-ERROR-MESSAGE              02960026
029700       WHEN AP041-DTLS-WITH-NO-HDR                                02970026
029800         MOVE PC-DTLWOHDR-ERR    TO DL-ERROR-MESSAGE              02980026
029900       WHEN AP041-HDRS-WITH-NO-DTL                                02990026
030000         MOVE PC-HDRWODTL-ERR    TO DL-ERROR-MESSAGE              03000026
030100       WHEN AP041-INVALID-INPUT-DATA                              03010026
030200         MOVE PC-INPUT-ERR       TO DL-ERROR-MESSAGE              03020026
030300       WHEN AP041-DMA-NBR-NOT-FOUND                               03030026
030400         MOVE PC-DMA-NOT-FOUND   TO DL-ERROR-MESSAGE              03040026
030500       WHEN OTHER                                                 03050026
030600         STRING AP041-ERROR-CDE                                   03060026
030700                ', UNKNOWN ERROR CODE, CONTACT I.S. DEPT'         03070026
030800           DELIMITED BY SIZE                                      03080026
030900           INTO DL-ERROR-MESSAGE                                  03090026
031000         END-STRING                                               03100026
031100     END-EVALUATE.                                                03110026
031200                                                                  03120026
031300     PERFORM F100-FORMAT-DETAIL.                                  03130026
031400                                                                  03140026
031500* IF OUT OF BALANCE ERROR, FORMAT AND PRINT A DETAILED MSG.       03150026
031600     IF AP041-HDR-DTL-OUT-OF-BALANCE                              03160026
031700         MOVE +1                 TO PV-LINE-SKIP                  03170026
031800         EVALUATE TRUE                                            03180026
031900           WHEN AP041-OB-MULT-AMTS                                03190026
032000               STRING PC-MULT-ERR-MSG                             03200026
032100                      PC-FIELD-ERR-MSG                            03210026
032200                 DELIMITED BY SIZE                                03220026
032300                 INTO DL-ERROR-MESSAGE                            03230026
032400               END-STRING                                         03240026
032500           WHEN AP041-OB-GRO-COST-AMT                             03250026
032600               STRING PC-GROSS-ERR-MSG                            03260026
032700                      PC-FIELD-ERR-MSG                            03270026
032800                 DELIMITED BY SIZE                                03280026
032900                 INTO DL-ERROR-MESSAGE                            03290026
033000               END-STRING                                         03300026
033100           WHEN AP041-OB-RETL-AMT                                 03310026
033200               STRING PC-RETAIL-ERR-MSG                           03320026
033300                      PC-FIELD-ERR-MSG                            03330026
033400                 DELIMITED BY SIZE                                03340026
033500                 INTO DL-ERROR-MESSAGE                            03350026
033600               END-STRING                                         03360026
033700           WHEN AP041-OB-FRGT-AMT                                 03370026
033800               STRING PC-FREIGHT-ERR-MSG                          03380026
033900                      PC-FIELD-ERR-MSG                            03390026
034000                 DELIMITED BY SIZE                                03400026
034100                 INTO DL-ERROR-MESSAGE                            03410026
034200               END-STRING                                         03420026
034300           WHEN AP041-OB-MISC-CHRG-AMT                            03430026
034400               STRING PC-MISC-ERR-MSG                             03440026
034500                      PC-FIELD-ERR-MSG                            03450026
034600                 DELIMITED BY SIZE                                03460026
034700                 INTO DL-ERROR-MESSAGE                            03470026
034800               END-STRING                                         03480026
034900           WHEN AP041-OB-NET-COST-AMT                             03490026
035000               STRING PC-NET-ERR-MSG                              03500026
035100                      PC-FIELD-ERR-MSG                            03510026
035200                 DELIMITED BY SIZE                                03520026
035300                 INTO DL-ERROR-MESSAGE                            03530026
035400               END-STRING                                         03540026
035500           WHEN AP041-OB-TERM-DISC-AMT                            03550026
035600               STRING PC-TERM-ERR-MSG                             03560026
035700                      PC-FIELD-ERR-MSG                            03570026
035800                 DELIMITED BY SIZE                                03580026
035900                 INTO DL-ERROR-MESSAGE                            03590026
036000               END-STRING                                         03600026
036100           WHEN AP041-OB-NW-STR-DISC-AMT                          03610026
036200               STRING PC-NEW-STORE-ERR-MSG                        03620026
036300                      PC-FIELD-ERR-MSG                            03630026
036400                 DELIMITED BY SIZE                                03640026
036500                 INTO DL-ERROR-MESSAGE                            03650026
036600               END-STRING                                         03660026
036700           WHEN AP041-OB-TRD-DISC-AMT                             03670026
036800             STRING PC-TRD-ERR-MSG                                03680026
036900                    PC-FIELD-ERR-MSG                              03690026
037000               DELIMITED BY SIZE                                  03700026
037100               INTO DL-ERROR-MESSAGE                              03710026
037200             END-STRING                                           03720026
037300           WHEN AP041-OB-MOS-DISC-AMT                             03730026
037400               STRING PC-MOS-ERR-MSG                              03740026
037500                      PC-FIELD-ERR-MSG                            03750026
037600                 DELIMITED BY SIZE                                03760026
037700                 INTO DL-ERROR-MESSAGE                            03770026
037800               END-STRING                                         03780026
037900                                                                  03790026
038000           WHEN OTHER                                             03800026
038100             STRING AP041-OB-FIELD-CDE                            03810026
038200                    ', '                                          03820026
038300                    'UNKNOWN "OUT OF BAL" CODE, CONTACT I.S.'     03830026
038400               DELIMITED BY SIZE                                  03840026
038500               INTO DL-ERROR-MESSAGE                              03850026
038600             END-STRING                                           03860026
038700         END-EVALUATE                                             03870026
038800                                                                  03880026
038900         PERFORM W200-WRITE-DETAIL                                03890026
039000     END-IF.                                                      03900026
039100                                                                  03910026
039200*    - READ THE IMPORT FILE.                                      03920026
039300     PERFORM R100-READ-INPUT.                                     03930026
039400                                                                  03940026
039500                                                                  03950026
039600 B300-END-OF-PROGRAM.                                             03960026
039700*----------------------------------------------------------------*03970026
039800*  END OF PROGRAM                                                *03980026
039900*----------------------------------------------------------------*03990026
040000                                                                  04000026
040100     WRITE REPORT-REC FROM END-OF-REPORT AFTER 2.                 04010026
040200                                                                  04020026
040300     DISPLAY '** END OF APKRP133 PROCESSING **'.                  04030026
040400     DISPLAY '** ERRORS READ            = ' PV-ERRORS-READ.       04040026
040500     DISPLAY '** ERRORS PRINTED         = ' PV-ERRORS-PRINTED.    04050026
040600                                                                  04060026
040700     CLOSE ADJ-ERROR-FILE                                         04070026
040800           REPORT-FILE.                                           04080026
040900                                                                  04090026
041000                                                                  04100026
041100 F100-FORMAT-DETAIL.                                              04110026
041200*----------------------------------------------------------------*04120026
041300*    FORMAT DETAIL DATA TO THE REPORT HEADINGS, DETAIL LINES.    *04130026
041400*                                                                *04140026
041500*    - WRITE PAGE HEADINGS, IF PAGE IS FULL.                     *04150026
041600*----------------------------------------------------------------*04160026
041700                                                                  04170026
041800     IF PV-LINES-PER-PAGE > PC-LINES-MAX                          04180026
041900         PERFORM W100-WRITE-HEADINGS                              04190026
042000     END-IF.                                                      04200026
042100                                                                  04210026
042200     ADD +1                    TO  PV-ERRORS-PRINTED.             04220026
042300     PERFORM W200-WRITE-DETAIL.                                   04230026
042400                                                                  04240026
042500                                                                  04250026
042600 R100-READ-INPUT.                                                 04260026
042700*----------------------------------------------------------------*04270026
042800*  READ IMPORT FILE.                                             *04280026
042900*----------------------------------------------------------------*04290026
043000                                                                  04300026
043100     READ ADJ-ERROR-FILE INTO AP041-RECORD                        04310026
043200       AT END                                                     04320026
043300           SET PS-ERROR-EOF      TO TRUE                          04330026
043400       NOT AT END                                                 04340026
043500           ADD 1                 TO PV-ERRORS-READ                04350026
043600     END-READ.                                                    04360026
043700                                                                  04370026
043800                                                                  04380026
043900 W100-WRITE-HEADINGS.                                             04390026
044000*----------------------------------------------------------------*04400026
044100*  WRITE PAGE HEADING LINES.                                     *04410026
044200*----------------------------------------------------------------*04420026
044300                                                                  04430026
044400     ADD +1                      TO PV-PAGE-COUNT.                04440026
044500     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER            04450026
044600                                                                  04460026
044700* HEADING LINE 1 (STANDARD)                                       04470026
044800     WRITE REPORT-REC FROM DP132O-STANDRD-HEADER-132-COLS         04480026
044900       AFTER ADVANCING PAGE.                                      04490026
045000     WRITE REPORT-REC FROM HL-HEADER2                             04500026
045100       AFTER ADVANCING +1 LINES.                                  04510026
045200                                                                  04520026
045300     WRITE REPORT-REC FROM HL-HEADER3                             04530026
045400       AFTER ADVANCING +2 LINES.                                  04540026
045500     WRITE REPORT-REC FROM HL-HEADER4                             04550026
045600       AFTER ADVANCING +1 LINES.                                  04560026
045700     MOVE +5                     TO PV-LINES-PER-PAGE.            04570026
045800                                                                  04580026
045900                                                                  04590026
046000 W200-WRITE-DETAIL.                                               04600026
046100*----------------------------------------------------------------*04610026
046200*  PRINTS PO DETAIL LINES.                                       *04620026
046300*----------------------------------------------------------------*04630026
046400                                                                  04640026
046500     WRITE REPORT-REC FROM DL-DETAIL                              04650026
046600       AFTER ADVANCING PV-LINE-SKIP LINES.                        04660026
046700                                                                  04670026
046800     ADD PV-LINE-SKIP              TO PV-LINES-PER-PAGE.          04680026
046900     INITIALIZE DL-DETAIL.                                        04690026
047000                                                                  04700026
047100                                                                  04710026
