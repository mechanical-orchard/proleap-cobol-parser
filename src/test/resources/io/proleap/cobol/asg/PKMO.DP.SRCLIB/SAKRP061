000100 IDENTIFICATION DIVISION.                                         00010011
000200                                                                  00020011
000300 PROGRAM-ID.      SAKRP061.                                       00030087
000400 AUTHOR.          STEVEN NOWAK.                                   00040011
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050011
000600 DATE-WRITTEN.    11/01/2005.                                     00060011
000700 DATE-COMPILED.                                                   00070011
000800                                                                  00080011
000900******************************************************************00090011
001000*  MODULE TYPE:   COBOL2 DB2 BATCH                                00100011
001100*                                                                 00110011
001200*  DESCRIPTION:   CREATES THE INVENTORY CONTROL MARKDOWN          00120011
001300*                 BALANCING REPORT UTILIZING DATA FROM THE        00130011
001400*                 COSA TABLES.                                    00140011
001500*                                                                 00150011
001600*========================== CHANGE LOG ===========================00160011
001700*  AUTH       BY         DATE                 DESCRIPTION         00170011
001800*=================================================================00180011
001900* WR29590   S.NOWAK    11-01-05   CREATE PROGRAM                  00190011
002000*                                                                 00200011
002100* WR29912   S.NOWAK    01-15-06   ADD EMPLOYEE DISCOUNTS          00210049
002200*                                                                 00220050
002300******************************************************************00230011
002400*  JIM HUNTER      03/25/2008          WR: 33714                  00240011
002500*     EXCLUDE THIRD PARTY CARD SALES (DEPARTMENTS 833 AND 834)    00250011
002600******************************************************************00260011
002700*  STEVEN NOWAK    04/15/2008          WR: 33714                  00270011
002800*     DUE TO QUANTITY EXTEND CHANGES IN THE NEWEST RELEASE, NEED  00280011
002900*     TO RING EACH ITEM SEPERATLY, COMMENT OUT PARA H6900- WHICH  00290011
003000*     IS CAUSING NO MATCHES DUE TO 'PENNY' DIFFERENCES            00300011
003100******************************************************************00310011
003200* DATE: 10/14/2008                                                00320011
003300* WHO: JOANNE PIETROSKE (REFER TO 'SP0906' FOR ALL CHANGES)       00330011
003400* WHY: ADD REPORT LINES FOR EACH OF THE 4 NEW LID REASON CODES    00340011
003500******************************************************************00350011
003600*  COGNIZANT       08/11/2009          INC000000907935            00360011
003700*     TO HANDLE -811 CONDITION AS A VALID RETURN CODE.            00370011
003800*     SECTIONS MODIFIED : G1000-CHECK-TIERED-LID                  00380011
003900******************************************************************00390011
004000*  COGNIZANT       06/20/2012          PKE000000011018            00400026
004100*   TO HANDLE DBKR0127 FAILURE DUE TO CONTENTION WITH JOB SAK008  00410024
004200*   CHANGE MADE: ADD COMMIT STATEMENTS TO B3000- AND C3000- PARA  00420024
004300******************************************************************00430024
004400* DATE: 07/18/2012                                                00440029
004500* WHO: JIM HUNTER  (REFER TO 'POS12 ' FOR ALL CHANGES)            00450029
004600* WHY: ADD REPORT LINES FOR DISCOUNT CODE 765                     00460029
004700******************************************************************00470029
004800* DATE: 08/06/2012                     WR39372                    00480032
004900* WHO: JIM ARENDT  (REFER TO 'POS12 ' FOR ALL CHANGES)            00490032
005000* WHY: MOVED REPORT LINE FOR DISCOUNT CODE 765.                   00500032
005100******************************************************************00510047
005200* DATE: 03/06/2013                     WR41687                    00520045
005300* WHO: JOE GARDETTO                                               00530045
005400* WHY: CORRECT FOR MISSING ZERO CHARGE ITEMS.                     00540045
P8612 ******************************************************************00550063
P8612 * DATE: 08/25/2014                      CHG0092405                00560062
P8612 * WHO: COGNIZANT                                                  00570061
P8612 * WHY: EXCLUDE NEW MARKET PLACE DEPARTMENT 070.                   00580061
005500******************************************************************00590051
205464* DATE: 08/16/2018                      CHG0205464                00600089
205464* WHO: JIM ARENDT  (REFER TO '0709' FOR ALL CHANGES)              00610089
205464* WHY: ADD REPORT LINES FOR DISCOUNT CODE 710                     00620089
004700******************************************************************00630064
MKTPLC* DATE: 07/29/2020                      CHG0246098                00631092
MKTPLC* WHO: JIM HUNTER  (REFER TO 'MKTPLC' FOR ALL CHANGES)            00632090
MKTPLC* WHY: REPLACE WAYFAIR DEPT 070 CHECK WITH MARKETPLACE DEPT 985   00633090
MKTPLC*      CHECK TO PREVENT MARKETPLACE ITEMS FROM GOING TO ML.       00633190
MKTPLC******************************************************************00634090
GOLDFX* DATE: 09/21/2020                      CHG0249017                00634198
GOLDFX* WHO: JIM HUNTER  (REFER TO 'GOLDFX' FOR ALL CHANGES)            00634293
GOLDFX* WHY: PER PRB0075999, THE GOLDSTAR CALCULATIONS ARE NOT          00634393
GOLDFX*      GENERATING THE CORRECT LID AMOUNTS.  THE ECOM GOLDSTAR     00634497
GOLDFX*      LID AMOUNTS ON RETURNS HAVE NEGATIVE VALUES.  ADDED A      00634597
GOLDFX*      CHECK FOR THESE AND UPDATE THE MARKDOWN CANCEL TOTALS      00634697
GOLDFX*      INSTEAD OF THE MARKDOWN FIELDS WHEN THIS HAPPENS.          00634797
GOLDFX******************************************************************00634897
SEPHOR*   03/16/2022 - JIM HUNTER  SEPHORA GIFT CARDS  CHG0??????       00634999
SEPHOR* THIS CHANGE PREVENTS SEPHORA GIFT CARDS FROM GOING TO THE       00635099
SEPHOR* MU / MD REPORT OR ML OUTPUT FILES.                              00635199
SEPHOR******************************************************************00635299
005600                                                                  00640011
005700 ENVIRONMENT DIVISION.                                            00650011
005800 CONFIGURATION SECTION.                                           00660011
005900                                                                  00670011
006000 SOURCE-COMPUTER.        IBM-3090.                                00680011
006100 OBJECT-COMPUTER.        IBM-3090.                                00690011
006200                                                                  00700011
006300 INPUT-OUTPUT SECTION.                                            00710011
006400 FILE-CONTROL.                                                    00720011
006500                                                                  00730011
006600     SELECT POS-DATE-FILE ASSIGN TO INP01                         00740011
006700         FILE STATUS IS WS-POS-FILE-STATUS.                       00750011
006800     SELECT INVENTORY-RPT ASSIGN TO RPT01                         00760011
006900         FILE STATUS IS WS-RPT-FILE-STATUS.                       00770011
007000                                                                  00780011
007100 DATA DIVISION.                                                   00790011
007200 FILE SECTION.                                                    00800011
007300                                                                  00810011
007400 FD POS-DATE-FILE                                                 00820011
007500     RECORDING MODE IS F                                          00830011
007600     LABEL RECORDS ARE STANDARD                                   00840011
007700     BLOCK CONTAINS 0 RECORDS                                     00850011
007800     RECORD CONTAINS 80 CHARACTERS.                               00860011
007900                                                                  00870011
008000 01 DATE-REC                           PIC  X(80).                00880011
008100                                                                  00890011
008200 FD  INVENTORY-RPT                                                00900011
008300     RECORDING MODE IS F                                          00910011
008400     LABEL RECORDS ARE STANDARD                                   00920011
008500     BLOCK CONTAINS 0 RECORDS                                     00930011
008600     RECORD CONTAINS 132 CHARACTERS.                              00940011
008700                                                                  00950011
008800 01  RPT-REC                           PIC  X(132).               00960011
008900                                                                  00970011
009000******************************************************************00980011
009100*                       WORKING STORAGE                           00990011
009200******************************************************************01000011
009300 WORKING-STORAGE SECTION.                                         01010011
009400                                                                  01020011
009500 01  W-START                           PIC  X(40)                 01030011
009600     VALUE 'SAKRP061 - WORKING STORAGE BEGINS HERE'.              01040011
009700                                                                  01050011
009800                                                                  01060011
009900******************************************************************01070011
010000*                         SWITCHES                                01080011
010100******************************************************************01090011
010200 01  PS-PROGRAM-SWITCHES.                                         01100011
010300     05  PS-END-OF-CARD-FILE-SW        PIC  X(01)    VALUE 'N'.   01110011
010400         88  PS-END-OF-CARD-FILE                     VALUE 'Y'.   01120011
010500                                                                  01130011
010600     05  PS-END-OF-TRAN-SW             PIC  X(01)    VALUE 'N'.   01140011
010700         88  PS-END-OF-TRAN                          VALUE 'Y'.   01150011
010800     05  PS-END-OF-ITEM-SW             PIC  X(01)    VALUE 'N'.   01160011
010900         88  PS-END-OF-ITEM                          VALUE 'Y'.   01170011
011000                                                                  01180011
011100     05  PS-END-OF-LID-IND             PIC  X(01)    VALUE 'N'.   01190011
011200         88  PS-END-OF-LID-YES                       VALUE 'Y'.   01200011
011300         88  PS-END-OF-LID-NO                        VALUE 'N'.   01210011
011400                                                                  01220011
011500     05  PS-TIERED-ITEM-IND            PIC  X(01)    VALUE 'N'.   01230011
011600         88  PS-TIERED-ITEM-YES                      VALUE 'Y'.   01240011
011700         88  PS-TIERED-ITEM-NO                       VALUE 'N'.   01250011
011800                                                                  01260011
011900     05  PS-RECEIPTED-IND              PIC  X(01)    VALUE 'N'.   01270011
012000         88  PS-RECEIPTED-YES                        VALUE 'Y'.   01280011
012100         88  PS-RECEIPTED-NO                         VALUE 'N'.   01290011
012200                                                                  01300011
012300     05  PS-END-OF-DKEY-IND            PIC  X(01)    VALUE 'N'.   01310011
012400         88  PS-END-OF-DKEY-YES                      VALUE 'Y'.   01320011
012500                                                                  01330011
012600     05  PS-BACK-OFFICE-IND            PIC  X(01)    VALUE 'N'.   01340011
012700         88  PS-BACK-OFFICE-NO                       VALUE 'N'.   01350011
012800         88  PS-BACK-OFFICE-YES                      VALUE 'Y'.   01360011
012900                                                                  01370011
013000     05  PS-FIRST-READ-SW              PIC  X(01)    VALUE 'N'.   01380011
013100         88  PS-FIRST-READ-YES                       VALUE 'Y'.   01390011
013200         88  PS-FIRST-READ-NO                        VALUE 'N'.   01400011
013300     05  PS-UNMTCHD-AMT-SW             PIC  X(01)    VALUE 'N'.   01410011
013400         88  PS-UNMTCHD-AMT-YES                      VALUE 'Y'.   01420011
013500         88  PS-UNMTCHD-AMT-NO                       VALUE 'N'.   01430011
013600                                                                  01440011
013700******************************************************************01450011
013800*                        CONSTANTS                                01460011
013900******************************************************************01470011
014000 01  PC-PROGRAM-CONSTANTS.                                        01480011
014100     05  PC-PROGRAM-NAME               PIC  X(08)    VALUE        01490011
014200                                                       'SAKRP061'.01500011
014300     05  PC-LINE-LIMIT                 PIC  9(02)    VALUE 65.    01510011
014400     05  PC-ROW-NOT-FOUND              PIC S9(03)    VALUE +100.  01520011
014500                                                                  01530011
014600     05  PC-NON-OWNED                  PIC  X(01)    VALUE 'N'.   01540011
014700     05  PC-NON-OWNED-TRACKED          PIC  X(01)    VALUE 'T'.   01550011
014800     05  PC-RSLV-ORIGINAL              PIC  X(01)    VALUE 'R'.   01560011
014900     05  PC-RSLV-VOID                  PIC  X(01)    VALUE 'V'.   01570011
015000     05  PC-GIFT-CARD                  PIC  X(03)    VALUE '983'. 01580011
SEPHOR     05  PC-SEPHORA-GIFT-CARD-712      PIC  X(03)    VALUE '712'. 01581099
015100     05  PC-THIRD-PARTY-CARD-833       PIC  X(03)    VALUE '833'. 01590011
015200     05  PC-THIRD-PARTY-CARD-834       PIC  X(03)    VALUE '834'. 01600011
MKTPLC     05  PC-MKTPLACE-DEPT-985          PIC  X(03)    VALUE '985'. 01610090
015400     05  PC-701-SIGNING-ERROR          PIC  X(03)    VALUE '701'. 01630011
015500     05  PC-702-PLU-ERROR              PIC  X(03)    VALUE '702'. 01640011
015600     05  PC-703-DAMAGED-MDSE           PIC  X(03)    VALUE '703'. 01650011
015700     05  PC-704-GIFT-WITH-PURCH        PIC  X(03)    VALUE '704'. 01660011
015800     05  PC-705-OPERATOR-MKDN          PIC  X(03)    VALUE '705'. 01670011
015900     05  PC-706-RAINCHECK              PIC  X(03)    VALUE '706'. 01680011
016000     05  PC-707-COMPETITIVE            PIC  X(03)    VALUE '707'. 01690011
016100     05  PC-708-SPECIAL-PROMO          PIC  X(03)    VALUE '708'. 01700011
016200     05  PC-709-YES-WE-CAN             PIC  X(03)    VALUE '709'. 01710011
205464     05  PC-710-NON-RECEIPT-RTN        PIC  X(03)    VALUE '710'. 01720089
016300     05  PC-746-PLU-TIER               PIC  X(03)    VALUE '746'. 01730011
016400                                                                  01740011
016500     05  PC-728-SENIOR-DISC            PIC  X(03)    VALUE '728'. 01750011
016600     05  PC-733-KOHLS-CPON             PIC  X(03)    VALUE '733'. 01760011
016700     05  PC-753-GOLDSTAR               PIC  X(03)    VALUE '753'. 01770011
016800     05  PC-760-OFFER-SIMPLE-COUPON    PIC  X(03)    VALUE '760'. 01780011
016900     05  PC-761-OFFER-TLD-TIERED       PIC  X(03)    VALUE '761'. 01790011
017000     05  PC-762-OFFER-LID-TIERED       PIC  X(03)    VALUE '762'. 01800011
017100     05  PC-763-OFFER-GWP-PWP-PRORATED PIC  X(03)    VALUE '763'. 01810011
017200     05  PC-765-KC-GIFT-RCPT-UNEARNED  PIC  X(03)    VALUE '765'. 01820027
017300     05  PC-775-BOGO                   PIC  X(03)    VALUE '775'. 01830011
017400     05  PC-777-BOGO                   PIC  X(03)    VALUE '777'. 01840011
017500     05  PC-780-UNEARNED-REWARDS       PIC  X(03)    VALUE '780'. 01850011
017600     05  PC-790-EMPLY-DISCOUNT         PIC  X(03)    VALUE '790'. 01860011
017700                                                                  01870011
017800******************************************************************01880011
017900*                        VARIABLES                                01890011
018000******************************************************************01900011
018100 01  PC-PROGRAM-VARIABLES.                                        01910011
018200     05  PV-SQLCODE                    PIC +9(04)    VALUE ZEROS. 01920011
018300     05  PV-PARAGRAPH-NAME             PIC  X(30)    VALUE SPACES.01930011
018400     05  PV-TABLE-NAME                 PIC  X(12)    VALUE SPACES.01940011
018500     05  PV-OPERATION-MSG              PIC  X(60)    VALUE SPACES.01950011
018600                                                                  01960011
018700     05  PV-PAGE-COUNT                 PIC  9(02)    VALUE 1.     01970011
018800     05  PV-LINE-COUNT                 PIC  9(02)    VALUE ZERO.  01980011
018900                                                                  01990011
019000     05  PV-RUN-DATE-CCYY-MM-DD        PIC  X(10)    VALUE SPACES.02000011
019100                                                                  02010011
019200     05  PV-DB2-KEY-FIELDS.                                       02020011
019300         10  PV-PARTN-NBR              PIC S9(04)    COMP SYNC    02030011
019400                                                     VALUE ZERO.  02040011
019500         10  PV-STR-NBR                PIC S9(04)    COMP SYNC    02050011
019600                                                     VALUE ZERO.  02060011
019700         10  PV-RGST-ID                PIC S9(04)    COMP SYNC    02070011
019800                                                     VALUE ZERO.  02080011
019900         10  PV-TRN-NBR                PIC S9(04)    COMP SYNC    02090011
020000                                                     VALUE ZERO.  02100011
020100         10  PV-STRT-TM                PIC  X(08)    VALUE SPACE. 02110011
020200         10  PV-SLS-CORR-SEQ-NBR       PIC S9(04)    COMP SYNC    02120011
020300                                                     VALUE ZERO.  02130011
020400         10  PV-LNE-ITM-SEQ-NBR        PIC S9(04)    COMP SYNC    02140011
020500                                                     VALUE ZERO.  02150042
020600                                                                  02160011
020700******************************************************************02170011
020800*                        WORK AREA                                02180011
020900******************************************************************02190011
021000 01  WS-WORK-AREA.                                                02200011
021100                                                                  02210011
021200     05  WS-POS-FILE-STATUS            PIC  X(02)    VALUE ZEROS. 02220011
021300     05  WS-RPT-FILE-STATUS            PIC  X(02)    VALUE ZEROS. 02230011
021400                                                                  02240011
021500     05  WS-REC-TYPE                   PIC  X(01)    VALUE SPACES.02250011
021600         88 WS-SALE                                  VALUE 'S'.   02260011
021700         88 WS-RETURN                                VALUE 'R'.   02270011
021800                                                                  02280011
021900     05  WS-DUMMY-FIELD                PIC S9(01)V   COMP-3       02290011
022000                                                     VALUE ZEROS. 02300011
022100                                                                  02310011
022200     05  WS-LID-AMT                    PIC  9(7)V99  VALUE ZEROS. 02320011
022300     05  WS-QTY                        PIC  9(09)    VALUE ZEROS. 02330011
022400     05  WS-AMT                        PIC  9(09)V99 VALUE ZEROS. 02340011
022500                                                                  02350011
022600     05  WS-CMT-CNT                    PIC 9(4)      VALUE ZERO.  02360024
022700                                                                  02370011
022800******************************************************************02380011
022900*                        ACCUMULATORS                             02390011
023000******************************************************************02400011
023100 01  PA-PROGRAM-ACCUMS.                                           02410011
023200                                                                  02420011
023300     05  PA-TRAN-READ                  PIC  9(11)    VALUE ZEROS. 02430011
023400     05  PA-ITEM-READ                  PIC  9(11)    VALUE ZEROS. 02440011
023500                                                                  02450011
023600     05  PA-SALE                       PIC  9(11)    VALUE ZEROS. 02460011
023700     05  PA-RETURN                     PIC  9(11)    VALUE ZEROS. 02470011
023800                                                                  02480011
023900*=================================================================02490011
024000*                         TABLE ACCUM                             02500011
024100*  1 = ORIGINAL SALES                                             02510011
024200*  2 = SALE CORRECTIONS                                           02520011
024300*  3 = LATE SALES                                                 02530011
024400*=================================================================02540011
024500     05  PA-SUB                        PIC S9(04)    VALUE ZEROS. 02550011
024600                                                                  02560011
024700     05  PA-PGM-TTLS OCCURS 3 TIMES.                              02570011
024800         10  PA-701-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 02580011
024900         10  PA-701-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 02590011
025000         10  PA-701-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 02600011
025100         10  PA-701-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 02610011
025200         10  PA-701-BO-MKDN-QTY        PIC S9(09)    VALUE ZEROS. 02620011
025300         10  PA-701-BO-MKDN-AMT        PIC S9(09)V99 VALUE ZEROS. 02630011
025400         10  PA-701-BO-MDC-QTY         PIC S9(09)    VALUE ZEROS. 02640011
025500         10  PA-701-BO-MDC-AMT         PIC S9(09)V99 VALUE ZEROS. 02650011
025600                                                                  02660011
025700         10  PA-702-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 02670011
025800         10  PA-702-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 02680011
025900         10  PA-702-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 02690011
026000         10  PA-702-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 02700011
026100         10  PA-702-BO-MKDN-QTY        PIC S9(09)    VALUE ZEROS. 02710011
026200         10  PA-702-BO-MKDN-AMT        PIC S9(09)V99 VALUE ZEROS. 02720011
026300         10  PA-702-BO-MDC-QTY         PIC S9(09)    VALUE ZEROS. 02730011
026400         10  PA-702-BO-MDC-AMT         PIC S9(09)V99 VALUE ZEROS. 02740011
026500                                                                  02750011
026600         10  PA-703-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 02760011
026700         10  PA-703-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 02770011
026800         10  PA-703-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 02780011
026900         10  PA-703-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 02790011
027000         10  PA-703-BO-MKDN-QTY        PIC S9(09)    VALUE ZEROS. 02800011
027100         10  PA-703-BO-MKDN-AMT        PIC S9(09)V99 VALUE ZEROS. 02810011
027200         10  PA-703-BO-MDC-QTY         PIC S9(09)    VALUE ZEROS. 02820011
027300         10  PA-703-BO-MDC-AMT         PIC S9(09)V99 VALUE ZEROS. 02830011
027400                                                                  02840011
027500         10  PA-704-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 02850011
027600         10  PA-704-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 02860011
027700         10  PA-704-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 02870011
027800         10  PA-704-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 02880011
027900         10  PA-704-BO-MKDN-QTY        PIC S9(09)    VALUE ZEROS. 02890011
028000         10  PA-704-BO-MKDN-AMT        PIC S9(09)V99 VALUE ZEROS. 02900011
028100         10  PA-704-BO-MDC-QTY         PIC S9(09)    VALUE ZEROS. 02910011
028200         10  PA-704-BO-MDC-AMT         PIC S9(09)V99 VALUE ZEROS. 02920011
028300                                                                  02930011
028400         10  PA-705-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 02940011
028500         10  PA-705-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 02950011
028600         10  PA-705-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 02960011
028700         10  PA-705-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 02970011
028800         10  PA-705-BO-MKDN-QTY        PIC S9(09)    VALUE ZEROS. 02980011
028900         10  PA-705-BO-MKDN-AMT        PIC S9(09)V99 VALUE ZEROS. 02990011
029000         10  PA-705-BO-MDC-QTY         PIC S9(09)    VALUE ZEROS. 03000011
029100         10  PA-705-BO-MDC-AMT         PIC S9(09)V99 VALUE ZEROS. 03010011
029200                                                                  03020011
029300         10  PA-706-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03030011
029400         10  PA-706-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03040011
029500         10  PA-706-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03050011
029600         10  PA-706-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03060011
029700         10  PA-706-BO-MKDN-QTY        PIC S9(09)    VALUE ZEROS. 03070011
029800         10  PA-706-BO-MKDN-AMT        PIC S9(09)V99 VALUE ZEROS. 03080011
029900         10  PA-706-BO-MDC-QTY         PIC S9(09)    VALUE ZEROS. 03090011
030000         10  PA-706-BO-MDC-AMT         PIC S9(09)V99 VALUE ZEROS. 03100011
030100                                                                  03110011
030200         10  PA-707-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03120011
030300         10  PA-707-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03130011
030400         10  PA-707-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03140011
030500         10  PA-707-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03150011
030600         10  PA-707-BO-MKDN-QTY        PIC S9(09)    VALUE ZEROS. 03160011
030700         10  PA-707-BO-MKDN-AMT        PIC S9(09)V99 VALUE ZEROS. 03170011
030800         10  PA-707-BO-MDC-QTY         PIC S9(09)    VALUE ZEROS. 03180011
030900         10  PA-707-BO-MDC-AMT         PIC S9(09)V99 VALUE ZEROS. 03190011
031000                                                                  03200011
031100         10  PA-708-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03210011
031200         10  PA-708-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03220011
031300         10  PA-708-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03230011
031400         10  PA-708-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03240011
031500         10  PA-708-BO-MKDN-QTY        PIC S9(09)    VALUE ZEROS. 03250011
031600         10  PA-708-BO-MKDN-AMT        PIC S9(09)V99 VALUE ZEROS. 03260011
031700         10  PA-708-BO-MDC-QTY         PIC S9(09)    VALUE ZEROS. 03270011
031800         10  PA-708-BO-MDC-AMT         PIC S9(09)V99 VALUE ZEROS. 03280011
031900                                                                  03290011
032000         10  PA-709-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03300011
032100         10  PA-709-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03310011
032200         10  PA-709-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03320011
032300         10  PA-709-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03330011
032400         10  PA-709-BO-MKDN-QTY        PIC S9(09)    VALUE ZEROS. 03340011
032500         10  PA-709-BO-MKDN-AMT        PIC S9(09)V99 VALUE ZEROS. 03350011
032600         10  PA-709-BO-MDC-QTY         PIC S9(09)    VALUE ZEROS. 03360011
032700         10  PA-709-BO-MDC-AMT         PIC S9(09)V99 VALUE ZEROS. 03370011
205464                                                                  03380089
205464         10  PA-710-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03390089
205464         10  PA-710-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03400089
205464         10  PA-710-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03410089
205464         10  PA-710-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03420089
032800                                                                  03430011
032900         10  PA-753-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03440011
033000         10  PA-753-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03450011
033100         10  PA-753-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03460011
033200         10  PA-753-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03470011
033300         10  PA-753-BO-MKDN-QTY        PIC S9(09)    VALUE ZEROS. 03480011
033400         10  PA-753-BO-MKDN-AMT        PIC S9(09)V99 VALUE ZEROS. 03490011
033500         10  PA-753-BO-MDC-QTY         PIC S9(09)    VALUE ZEROS. 03500011
033600         10  PA-753-BO-MDC-AMT         PIC S9(09)V99 VALUE ZEROS. 03510011
033700                                                                  03520011
033800         10  PA-728-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03530011
033900         10  PA-728-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03540011
034000         10  PA-728-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03550011
034100         10  PA-728-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03560011
034200                                                                  03570011
034300         10  PA-733-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03580011
034400         10  PA-733-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03590011
034500         10  PA-733-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03600011
034600         10  PA-733-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03610011
034700                                                                  03620011
034800         10  PA-760-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03630011
034900         10  PA-760-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03640011
035000         10  PA-760-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03650011
035100         10  PA-760-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03660011
035200                                                                  03670011
035300         10  PA-761-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03680011
035400         10  PA-761-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03690011
035500         10  PA-761-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03700011
035600         10  PA-761-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03710011
035700                                                                  03720011
035800         10  PA-762-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03730011
035900         10  PA-762-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03740011
036000         10  PA-762-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03750011
036100         10  PA-762-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03760011
036200                                                                  03770011
036300         10  PA-763-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03780011
036400         10  PA-763-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03790011
036500         10  PA-763-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03800011
036600         10  PA-763-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03810011
036700                                                                  03820027
036800         10  PA-765-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03830027
036900         10  PA-765-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03840027
037000         10  PA-765-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03850027
037100         10  PA-765-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03860027
037200                                                                  03870011
037300         10  PA-775-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03880011
037400         10  PA-775-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03890011
037500         10  PA-775-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03900011
037600         10  PA-775-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03910011
037700                                                                  03920011
037800         10  PA-777-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03930011
037900         10  PA-777-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03940011
038000         10  PA-777-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 03950011
038100         10  PA-777-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 03960011
038200                                                                  03970011
038300         10  PA-780-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 03980011
038400         10  PA-780-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 03990011
038500         10  PA-780-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 04000011
038600         10  PA-780-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 04010011
038700                                                                  04020011
038800         10  PA-790-REG-MKDN-QTY       PIC S9(09)    VALUE ZEROS. 04030011
038900         10  PA-790-REG-MKDN-AMT       PIC S9(09)V99 VALUE ZEROS. 04040011
039000         10  PA-790-REG-MDC-QTY        PIC S9(09)    VALUE ZEROS. 04050011
039100         10  PA-790-REG-MDC-AMT        PIC S9(09)V99 VALUE ZEROS. 04060011
039200                                                                  04070011
039300                                                                  04080011
039400                                                                  04090011
039500     05  PA-NET-MKDN-QTY               PIC S9(09)    VALUE ZEROS. 04100011
039600     05  PA-NET-MKDN-AMT               PIC S9(09)V99 VALUE ZEROS. 04110011
039700     05  PA-NET-MDC-QTY                PIC S9(09)    VALUE ZEROS. 04120011
039800     05  PA-NET-MDC-AMT                PIC S9(09)V99 VALUE ZEROS. 04130011
039900                                                                  04140011
040000 01  PA-TOTALS.                                                   04150011
040100     05  PA-SUB-MKDN-QTY               PIC S9(09)    VALUE ZEROS. 04160011
040200     05  PA-SUB-MKDN-AMT               PIC S9(09)V99 VALUE ZEROS. 04170011
040300     05  PA-SUB-MDC-QTY                PIC S9(09)    VALUE ZEROS. 04180011
040400     05  PA-SUB-MDC-AMT                PIC S9(09)V99 VALUE ZEROS. 04190011
040500                                                                  04200011
040600     05  PA-TTL-MKDN-QTY               PIC S9(09)    VALUE ZEROS. 04210011
040700     05  PA-TTL-MKDN-AMT               PIC S9(09)V99 VALUE ZEROS. 04220011
040800     05  PA-TTL-MDC-QTY                PIC S9(09)    VALUE ZEROS. 04230011
040900     05  PA-TTL-MDC-AMT                PIC S9(09)V99 VALUE ZEROS. 04240011
041000                                                                  04250011
041100                                                                  04260011
041200******************************************************************04270011
041300*                      CONTROL CARD                               04280011
041400******************************************************************04290011
041500 01  CC-CONTROL-CARD.                                             04300011
041600     05  CC-CONTROL-CARD-DISPLAY.                                 04310011
041700         10  CC-CONTROL-NAME           PIC  X(14)    VALUE SPACE. 04320011
041800         10  CC-POS-DATE-MMDDYY        PIC  9(06)    VALUE ZERO.  04330011
041900         10  FILLER REDEFINES CC-POS-DATE-MMDDYY.                 04340011
042000             15  CC-POS-DATE-MM        PIC  9(02).                04350011
042100             15  CC-POS-DATE-DD        PIC  9(02).                04360011
042200             15  CC-POS-DATE-YY        PIC  9(02).                04370011
042300     05 FILLER                         PIC  X(60)    VALUE SPACE. 04380011
042400                                                                  04390011
042500                                                                  04400011
042600******************************************************************04410011
042700*               SYTEM TIME AND DATE VARIABLES                     04420011
042800******************************************************************04430011
042900 01  SYS-DATE-TIME.                                               04440011
043000     05  SYS-DATE                      PIC  X(08)    VALUE SPACES.04450011
043100     05  SYS-TIME                      PIC  X(08)    VALUE SPACES.04460011
043200                                                                  04470011
043300 01  ST-BEG-TIME.                                                 04480011
043400     05  ST-BEG-HR                     PIC  9(02)    VALUE ZEROS. 04490011
043500     05  FILLER                        PIC  X(01)    VALUE ':'.   04500011
043600     05  ST-BEG-MN                     PIC  9(02)    VALUE ZEROS. 04510011
043700     05  FILLER                        PIC  X(01)    VALUE ':'.   04520011
043800     05  ST-BEG-SS                     PIC  9(02)    VALUE ZEROS. 04530011
043900                                                                  04540011
044000 01  ST-END-TIME.                                                 04550011
044100     05  ST-END-HR                     PIC  9(02)    VALUE ZEROS. 04560011
044200     05  FILLER                        PIC  X(01)    VALUE ':'.   04570011
044300     05  ST-END-MN                     PIC  9(02)    VALUE ZEROS. 04580011
044400     05  FILLER                        PIC  X(01)    VALUE ':'.   04590011
044500     05  ST-END-SS                     PIC  9(02)    VALUE ZEROS. 04600011
044600                                                                  04610011
044700 01  SD-EDIT-DATE.                                                04620011
044800     05  SD-MONTH                      PIC  9(02)    VALUE ZEROS. 04630011
044900     05  FILLER                        PIC  X(01)    VALUE '-'.   04640011
045000     05  SD-DAY                        PIC  9(02)    VALUE ZEROS. 04650011
045100     05  FILLER                        PIC  X(01)    VALUE '-'.   04660011
045200     05  SD-CENT                       PIC  9(02)    VALUE ZEROS. 04670011
045300     05  SD-YEAR                       PIC  9(02)    VALUE ZEROS. 04680011
045400                                                                  04690011
045500******************************************************************04700011
045600*                        ERROR HANDLING                           04710011
045700******************************************************************04720011
045800 01  ABEND-CODE                        PIC S9(04)    VALUE ZEROS  04730011
045900                                                     COMP SYNC.   04740011
046000     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 04750011
046100     88  ABEND-4444-FORCED-ABEND                     VALUE +4444. 04760011
046200                                                                  04770011
046300                                                                  04780011
046400******************************************************************04790011
046500* KOHLS STANDARD HEADING ROUTINE FOR A 132 COLUMN REPORT          04800011
046600******************************************************************04810011
046700*    COPY DPWS132O.                                               04820011
046800 01  DP132O-STANDRD-HEADER-132-COLS.                              04830011
046900     05  DP132O-RUN-DATE.                                         04840011
047000         10  DP132O-RUN-MONTH          PIC  9(02)    VALUE ZERO.  04850011
047100         10  FILLER                    PIC  X(01)    VALUE '/'.   04860011
047200         10  DP132O-RUN-DAY            PIC  9(02)    VALUE ZERO.  04870011
047300         10  FILLER                    PIC  X(01)    VALUE '/'.   04880011
047400         10  DP132O-RUN-CENTURY        PIC  9(02)    VALUE ZERO.  04890011
047500         10  DP132O-RUN-YEAR           PIC  9(02)    VALUE ZERO.  04900011
047600         10  FILLER                    PIC  X(01)    VALUE SPACE. 04910011
047700     05  DP132O-RUN-TIME.                                         04920011
047800         10  DP132O-RUN-HOUR           PIC  9(02)    VALUE ZERO.  04930011
047900         10  FILLER                    PIC  X(01)    VALUE ':'.   04940011
048000         10  DP132O-RUN-MINUTE         PIC  9(02)    VALUE ZERO.  04950011
048100     05  FILLER                        PIC  X(26)    VALUE SPACE. 04960011
048200     05  FILLER                        PIC  X(45)                 04970011
048300         VALUE 'K O H L S   D E P A R T M E N T   S T O R E S'.   04980011
048400     05  FILLER                        PIC  X(21)    VALUE SPACE. 04990011
048500     05  DP132O-PROGRAM-NAME           PIC  X(08)    VALUE SPACE. 05000011
048600     05  FILLER                        PIC  X(01)    VALUE '-'.   05010011
048700     05  DP132O-REPORT-NUMBER          PIC  9(01)    VALUE ZERO.  05020011
048800     05  FILLER                        PIC  X(02)    VALUE SPACE. 05030011
048900     05  FILLER                        PIC  X(05)    VALUE 'PAGE'.05040011
049000     05  DP132O-PAGE-NUMBER            PIC ZZZZ9     VALUE ZERO.  05050011
049100     05  FILLER                        PIC  X(02)    VALUE SPACE. 05060011
049200                                                                  05070011
049300                                                                  05080011
049400******************************************************************05090011
049500* REPORT HEADINGS                                                 05100011
049600******************************************************************05110011
049700 01  HL-HDR1.                                                     05120011
049800     05  FILLER                  PIC  X(43) VALUE SPACES.         05130011
049900     05                          PIC  X(43) VALUE                 05140011
050000        'INVENTORY CONTROL MARKDOWN BALANCING REPORT'.            05150011
050100     05  FILLER                  PIC  X(46) VALUE SPACES.         05160011
050200                                                                  05170011
050300 01  HL-HDR2.                                                     05180011
050400     05  FILLER                  PIC  X(59) VALUE SPACES.         05190011
050500     05                          PIC  X(04) VALUE                 05200011
050600         'FOR '.                                                  05210011
050700     05  HL-REPORT-MONTH         PIC  X(02) VALUE SPACES.         05220011
050800     05  FILLER                  PIC  X(01) VALUE '/'.            05230011
050900     05  HL-REPORT-DAY           PIC  X(02) VALUE SPACES.         05240011
051000     05  FILLER                  PIC  X(01) VALUE '/'.            05250011
051100     05  HL-REPORT-YEAR          PIC  X(02) VALUE SPACES.         05260011
051200     05  FILLER                  PIC  X(59) VALUE SPACES.         05270011
051300                                                                  05280011
051400 01  HL-HDR3.                                                     05290011
051500     05  FILLER                  PIC  X(04) VALUE SPACES.         05300011
051600     05  FILLER                  PIC  X(04) VALUE                 05310011
051700         'CODE'.                                                  05320011
051800     05  FILLER                  PIC  X(02) VALUE SPACES.         05330011
051900     05  FILLER                  PIC  X(14) VALUE                 05340011
052000         'PRICE CHG TYPE'.                                        05350011
052100     05  FILLER                  PIC  X(22) VALUE SPACES.         05360011
052200     05  FILLER                  PIC  X(11) VALUE                 05370011
052300         'MKDN QTY'.                                              05380011
052400     05  FILLER                  PIC  X(02) VALUE SPACES.         05390011
052500     05  FILLER                  PIC  X(15) VALUE                 05400011
052600         'MKDN AMT'.                                              05410011
052700     05  FILLER                  PIC  X(02) VALUE SPACES.         05420011
052800     05  FILLER                  PIC  X(11) VALUE                 05430011
052900         'MDC QTY'.                                               05440011
053000     05  FILLER                  PIC  X(02) VALUE SPACES.         05450011
053100     05  FILLER                  PIC  X(15) VALUE                 05460011
053200         'MDC AMT'.                                               05470011
053300     05  FILLER                  PIC  X(02) VALUE SPACES.         05480011
053400                                                                  05490011
053500 01  HL-HDR4.                                                     05500011
053600     05  FILLER                  PIC  X(04) VALUE SPACES.         05510011
053700     05  FILLER                  PIC  X(04) VALUE ALL '-'.        05520011
053800     05  FILLER                  PIC  X(02) VALUE SPACES.         05530011
053900     05  FILLER                  PIC  X(14) VALUE ALL '-'.        05540011
054000     05  FILLER                  PIC  X(22) VALUE SPACES.         05550011
054100     05  FILLER                  PIC  X(11) VALUE ALL '-'.        05560011
054200     05  FILLER                  PIC  X(02) VALUE SPACES.         05570011
054300     05  FILLER                  PIC  X(15) VALUE ALL '-'.        05580011
054400     05  FILLER                  PIC  X(02) VALUE SPACES.         05590011
054500     05  FILLER                  PIC  X(11) VALUE ALL '-'.        05600011
054600     05  FILLER                  PIC  X(02) VALUE SPACES.         05610011
054700     05  FILLER                  PIC  X(15) VALUE ALL '-'.        05620011
054800     05  FILLER                  PIC  X(02) VALUE SPACES.         05630011
054900                                                                  05640011
055000 01  HL-HDR5.                                                     05650011
055100     05  FILLER                  PIC  X(53) VALUE SPACES.         05660011
055200     05  FILLER                  PIC  X(26) VALUE SPACES.         05670011
055300         88  HD-ORIGINAL-SALES              VALUE                 05680011
055400             '    ORIGINAL POS SALES    '.                        05690011
055500         88  HD-SALES-CORR                  VALUE                 05700011
055600             '    SALES CORRECTIONS     '.                        05710011
055700         88  HD-LATE-TRANSACTIONS           VALUE                 05720011
055800             '    LATE TRANSACTIONS     '.                        05730011
055900     05  FILLER                  PIC  X(53) VALUE SPACES.         05740011
056000                                                                  05750011
056100 01  HL-HDR6.                                                     05760011
056200     05  FILLER                  PIC  X(04) VALUE SPACES.         05770011
056300     05  FILLER                  PIC  X(04) VALUE SPACES.         05780011
056400     05  FILLER                  PIC  X(02) VALUE SPACES.         05790011
056500     05  FILLER                  PIC  X(14) VALUE SPACES.         05800011
056600     05  FILLER                  PIC  X(22) VALUE SPACES.         05810011
056700     05  FILLER                  PIC  X(11) VALUE ALL '-'.        05820011
056800     05  FILLER                  PIC  X(02) VALUE SPACES.         05830011
056900     05  FILLER                  PIC  X(15) VALUE ALL '-'.        05840011
057000     05  FILLER                  PIC  X(02) VALUE SPACES.         05850011
057100     05  FILLER                  PIC  X(11) VALUE ALL '-'.        05860011
057200     05  FILLER                  PIC  X(02) VALUE SPACES.         05870011
057300     05  FILLER                  PIC  X(15) VALUE ALL '-'.        05880011
057400     05  FILLER                  PIC  X(02) VALUE SPACES.         05890011
057500                                                                  05900011
057600                                                                  05910011
057700******************************************************************05920011
057800* DETAIL DESCRIPTIONS                                             05930011
057900******************************************************************05940011
058000 01  DD-DETAIL-DESC.                                              05950011
058100     05  DD-SIGNING-ERR-REG      PIC X(30)                        05960011
058200                           VALUE 'SIGNING ERROR - REGISTER      '.05970011
058300     05  DD-SIGNING-ERR-BO       PIC X(30)                        05980011
058400                           VALUE 'SIGNING ERROR - BACK OFFICE   '.05990011
058500     05  DD-SIGNING-ERR-NET      PIC X(30)                        06000011
058600                           VALUE 'SIGNING ERROR - NET RESULT    '.06010011
058700                                                                  06020011
058800     05  DD-PLU-ERR-REG          PIC X(30)                        06030011
058900                           VALUE 'PLU ERROR - REGISTER          '.06040011
059000     05  DD-PLU-ERR-BO           PIC X(30)                        06050011
059100                           VALUE 'PLU ERROR - BACK OFFICE       '.06060011
059200     05  DD-PLU-ERR-NET          PIC X(30)                        06070011
059300                           VALUE 'PLU ERROR - NET RESULT        '.06080011
059400                                                                  06090011
059500     05  DD-DAMAGED-REG          PIC X(30)                        06100011
059600                           VALUE 'DAMAGED MERCH - REGISTER      '.06110011
059700     05  DD-DAMAGED-BO           PIC X(30)                        06120011
059800                           VALUE 'DAMAGED MERCH - BACK OFFICE   '.06130011
059900     05  DD-DAMAGED-NET          PIC X(30)                        06140011
060000                           VALUE 'DAMAGED MERCH - NET RESULT    '.06150011
060100                                                                  06160011
060200     05  DD-GIFT-REG             PIC X(30)                        06170011
060300                           VALUE 'GIFT W/PURCHASE - REGISTER    '.06180011
060400     05  DD-GIFT-BO              PIC X(30)                        06190011
060500                           VALUE 'GIFT W/PURCHASE - BACK OFFICE '.06200011
060600     05  DD-GIFT-NET             PIC X(30)                        06210011
060700                           VALUE 'GIFT W/PURCHASE - NET RESULT  '.06220011
060800                                                                  06230011
060900     05  DD-OPERATOR-REG         PIC X(30)                        06240011
061000                           VALUE 'OPERATOR MKDWN - REGISTER     '.06250011
061100     05  DD-OPERATOR-BO          PIC X(30)                        06260011
061200                           VALUE 'OPERATOR MKDWN - BACK OFFICE  '.06270011
061300     05  DD-OPERATOR-NET         PIC X(30)                        06280011
061400                           VALUE 'OPERATOR MKDWN - NET RESULT   '.06290011
061500                                                                  06300011
061600     05  DD-RAINCHCK-REG         PIC X(30)                        06310011
061700                           VALUE 'RAINCHECKS - REGISTER         '.06320011
061800     05  DD-RAINCHCK-BO          PIC X(30)                        06330011
061900                           VALUE 'RAINCHECKS - BACK OFFICE      '.06340011
062000     05  DD-RAINCHCK-NET         PIC X(30)                        06350011
062100                           VALUE 'RAINCHECKS - NET RESULT       '.06360011
062200                                                                  06370011
062300     05  DD-COMP-REG             PIC X(30)                        06380011
062400                           VALUE 'COMPETITIVE - REGISTER        '.06390011
062500     05  DD-COMP-BO              PIC X(30)                        06400011
062600                           VALUE 'COMPETITIVE - BACK OFFICE     '.06410011
062700     05  DD-COMP-NET             PIC X(30)                        06420011
062800                           VALUE 'COMPETITIVE - NET RESULT      '.06430011
062900                                                                  06440011
063000     05  DD-SPEC-PROMO-REG       PIC X(30)                        06450011
063100                           VALUE 'SPECIAL PROMO - REGISTER      '.06460011
063200     05  DD-SPEC-PROMO-BO        PIC X(30)                        06470011
063300                           VALUE 'SPECIAL PROMO - BACK OFFICE   '.06480011
063400     05  DD-SPEC-PROMO-NET       PIC X(30)                        06490011
063500                           VALUE 'SPECIAL PROMO - NET RESULT    '.06500011
063600                                                                  06510011
063700     05  DD-YES-WE-CAN-REG       PIC X(30)                        06520011
063800                           VALUE 'YES WE CAN - REGISTER         '.06530011
063900     05  DD-YES-WE-CAN-BO        PIC X(30)                        06540011
064000                           VALUE 'YES WE CAN - BACK OFFICE      '.06550011
064100     05  DD-YES-WE-CAN-NET       PIC X(30)                        06560011
064200                           VALUE 'YES WE CAN - NET RESULT       '.06570011
064300                                                                  06580011
064400     05  DD-GOLDSTAR-REG         PIC X(30)                        06590011
064500                           VALUE 'GOLDSTAR - REGISTER           '.06600011
064600     05  DD-GOLDSTAR-BO          PIC X(30)                        06610011
064700                           VALUE 'GOLDSTAR - BACK OFFICE        '.06620011
064800     05  DD-GOLDSTAR-NET         PIC X(30)                        06630011
064900                           VALUE 'GOLDSTAR - NET RESULT         '.06640011
065000                                                                  06650011
065100     05  DD-SENIOR-CITIZEN       PIC X(30)                        06660011
065200                           VALUE 'SENIOR CITZEN DISCOUNTS       '.06670011
065300     05  DD-KOHLS-COUPON         PIC X(30)                        06680011
065400                           VALUE 'KOHLS COUPON                  '.06690011
065500     05  DD-SIMPLE-OFFER         PIC X(30)                        06700011
065600                           VALUE 'SIMPLE OFFER                  '.06710011
065700     05  DD-TLD-TIERED-OFFER     PIC X(30)                        06720011
065800                           VALUE 'TLD TIERED OFFER              '.06730011
065900     05  DD-LID-TIERED-OFFER     PIC X(30)                        06740011
066000                           VALUE 'LID TIERED OFFER              '.06750011
066100     05  DD-GWP-TIERED-OFFER     PIC X(30)                        06760011
066200                           VALUE 'GWP/PWP OFFERS                '.06770011
066300     05  DD-BOGO                 PIC X(30)                        06780011
066400                           VALUE 'E-BOGO                        '.06790011
066500     05  DD-BOGOII               PIC X(30)                        06800011
066600                           VALUE 'E-BOGO II                     '.06810011
066700     05  DD-UNEARNED-REWARDS     PIC X(30)                        06820011
066800                           VALUE 'UNEARNED REWARDS              '.06830011
066900     05  DD-EMPLY-DISCOUNT       PIC X(30)                        06840011
067000                           VALUE 'EMPLOYEE DISCOUNT             '.06850011
067100     05  DD-KC-GIFT-RCPT-UNEARNED PIC X(30)                       06860027
067200                           VALUE 'UNEARNED KC GIFT RCPT RETURNS '.06870027
205464     05  DD-NON-RECEIPT-RETURN    PIC X(30)                       06880089
205464                           VALUE 'NON-RECEIPTED RETURN          '.06890089
067300     05  DD-SUB-TTL              PIC X(30)                        06900011
067400                           VALUE 'MANUAL (701-709) TOTALS       '.06910011
067500     05  DD-TOTAL                PIC X(30)                        06920011
067600                           VALUE 'TOTALS                        '.06930011
067700                                                                  06940011
067800******************************************************************06950011
067900* DETAIL LINES                                                    06960011
068000******************************************************************06970011
068100 01  DL-DETAIL-LINE.                                              06980011
068200     05  FILLER                  PIC  X(04) VALUE SPACES.         06990011
068300     05  DL-RSN-CDE              PIC  X(03) VALUE SPACES.         07000011
068400     05  FILLER                  PIC  X(03) VALUE SPACES.         07010011
068500     05  DL-PRICE-CHANGE-TYPE    PIC  X(30) VALUE SPACES.         07020011
068600     05  FILLER                  PIC  X(06) VALUE SPACES.         07030011
068700     05  DL-MARKDOWN-QTY         PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      07040011
068800     05  FILLER                  PIC  X(02) VALUE SPACES.         07050011
068900     05  DL-MARKDOWN-AMT         PIC ZZZ,ZZZ,ZZ9.99 VALUE ZERO.   07060011
069000     05  FILLER                  PIC  X(02) VALUE SPACES.         07070011
069100     05  DL-MDC-QTY              PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      07080011
069200     05  FILLER                  PIC  X(02) VALUE SPACES.         07090011
069300     05  DL-MDC-AMT              PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  07100011
069400     05  FILLER                  PIC  X(02) VALUE SPACES.         07110011
069500                                                                  07120011
069600 01  DL-DETAIL-SPACE.                                             07130011
069700     05  FILLER                  PIC  X(132) VALUE SPACES.        07140011
069800                                                                  07150011
069900******************************************************************07160011
070000* PARAMETER LIST FOR THE CALENDAR ROUTINE                         07170011
070100******************************************************************07180011
070200     COPY DPWS500.                                                07190011
070300                                                                  07200011
070400******************************************************************07210011
070500* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         07220011
070600******************************************************************07230011
070700     COPY DPWS004.                                                07240011
070800                                                                  07250011
070900******************************************************************07260011
071000* DB2 MESSAGE AREA                                                07270011
071100******************************************************************07280011
071200     COPY SQLCA2.                                                 07290011
071300                                                                  07300011
071400******************************************************************07310011
071500* DB2 COMMUNICATION AREA                                          07320011
071600******************************************************************07330011
071700     EXEC SQL                                                     07340011
071800          INCLUDE SQLCA                                           07350011
071900     END-EXEC.                                                    07360011
072000                                                                  07370011
072100******************************************************************07380011
072200* PARTITION CONTROL TABLE                                         07390011
072300******************************************************************07400011
072400     EXEC SQL                                                     07410011
072500          INCLUDE TEPPART                                         07420011
072600     END-EXEC.                                                    07430011
072700                                                                  07440011
072800******************************************************************07450011
072900* CURRENT PROCESSING DAY KEY TABLE                                07460011
073000******************************************************************07470011
073100     EXEC SQL                                                     07480011
073200          INCLUDE TEPDKEY                                         07490011
073300     END-EXEC.                                                    07500011
073400                                                                  07510011
073500******************************************************************07520011
073600* TRANSACTION TABLE                                               07530011
073700******************************************************************07540011
073800     EXEC SQL                                                     07550011
073900          INCLUDE TEPTRN                                          07560011
074000     END-EXEC.                                                    07570011
074100                                                                  07580011
074200******************************************************************07590011
074300* ITEM TABLE                                                      07600011
074400******************************************************************07610011
074500     EXEC SQL                                                     07620011
074600          INCLUDE TEPITM                                          07630011
074700     END-EXEC.                                                    07640011
074800                                                                  07650011
074900******************************************************************07660011
075000* ITEM GROUP PRICING TABLE                                        07670011
075100******************************************************************07680011
075200     EXEC SQL                                                     07690011
075300          INCLUDE TEPIGP                                          07700011
075400     END-EXEC.                                                    07710011
075500                                                                  07720011
075600******************************************************************07730011
075700* LINE ITEM DISCOUNT TABLE                                        07740011
075800******************************************************************07750011
075900     EXEC SQL                                                     07760011
076000          INCLUDE TEPLID                                          07770011
076100     END-EXEC.                                                    07780011
076200                                                                  07790011
076300******************************************************************07800011
076400* EMPLOYEE ITEM DISCOUNT TABLE                                    07810011
076500******************************************************************07820011
076600     EXEC SQL                                                     07830011
076700          INCLUDE TEPEID                                          07840011
076800     END-EXEC.                                                    07850011
076900                                                                  07860011
077000******************************************************************07870011
077100*  TEPTRN-CURSOR --> VALID CURRENT DAY TRANSACTIONS.              07880011
077200******************************************************************07890011
077300     EXEC SQL                                                     07900011
077400        DECLARE TEPTRN-CURSOR CURSOR WITH HOLD FOR                07910024
077500         SELECT A.PARTN_NBR                                       07920011
077600               ,A.STR_NBR                                         07930011
077700               ,A.RGST_ID                                         07940011
077800               ,A.TRN_NBR                                         07950011
077900               ,A.STRT_TM                                         07960011
078000               ,A.SLS_CORR_SEQ_NBR                                07970011
078100               ,A.TRN_STAT_CDE                                    07980011
078200               ,A.SLS_DTE                                         07990011
078300               ,A.CRE_TMST                                        08000011
078400                                                                  08010011
078500           FROM TEPTRN A                                          08020011
078600               ,TEPPART B                                         08030011
078700                                                                  08040011
078800          WHERE A.PARTN_NBR     = B.PARTN_NBR                     08050011
078900            AND B.SLS_DTE       = :PV-RUN-DATE-CCYY-MM-DD         08060011
079000            AND A.VOID_ABRT_CDE = 'N'                             08070011
079100            AND A.TRN_STAT_CDE  = 'Z'                             08080011
079200            AND B.STR_GP_CDE    = 'A'                             08090011
079300            AND A.TRN_TYP_CDE IN ('01', '02', '11', '12',         08100011
079400                                  '22', '23', '24', '25')         08110011
079500            AND A.SLS_CORR_SEQ_NBR = 0                            08120011
079600                                                                  08130011
079700       ORDER BY A.STR_NBR                                         08140011
079800               ,A.RGST_ID                                         08150011
079900               ,A.TRN_NBR                                         08160011
080000               ,A.STRT_TM                                         08170011
080100               ,A.SLS_CORR_SEQ_NBR                                08180011
080200                                                                  08190011
080300       WITH UR                                                    08200011
080400     END-EXEC.                                                    08210011
080500                                                                  08220011
080600******************************************************************08230011
080700*  TEPDKEY CURSOR --> VALID LATE, CORRECTION TRANSACTIONS.        08240011
080800******************************************************************08250011
080900     EXEC SQL                                                     08260011
081000        DECLARE TEPDKEY-CURSOR CURSOR WITH HOLD FOR               08270024
081100         SELECT B.PARTN_NBR                                       08280011
081200               ,B.STR_NBR                                         08290011
081300               ,B.RGST_ID                                         08300011
081400               ,B.TRN_NBR                                         08310011
081500               ,B.STRT_TM                                         08320011
081600               ,B.SLS_CORR_SEQ_NBR                                08330011
081700               ,B.TRN_STAT_CDE                                    08340011
081800               ,B.SLS_DTE                                         08350011
081900               ,B.CRE_TMST                                        08360011
082000                                                                  08370011
082100           FROM TEPDKEY A                                         08380011
082200               ,TEPTRN  B                                         08390011
082300               ,TEPPART C                                         08400011
082400                                                                  08410011
082500          WHERE A.PRCG_DTE         = :PV-RUN-DATE-CCYY-MM-DD      08420011
082600            AND A.SLS_DTE          = C.SLS_DTE                    08430011
082700            AND B.PARTN_NBR        = C.PARTN_NBR                  08440011
082800            AND A.STR_NBR          = B.STR_NBR                    08450011
082900            AND A.RGST_ID          = B.RGST_ID                    08460011
083000            AND A.TRN_NBR          = B.TRN_NBR                    08470011
083100            AND A.STRT_TM          = B.STRT_TM                    08480011
083200            AND A.SLS_CORR_SEQ_NBR = B.SLS_CORR_SEQ_NBR           08490011
083300            AND B.VOID_ABRT_CDE    = 'N'                          08500011
083400            AND B.TRN_STAT_CDE    IN ('V','R','L')                08510011
083500            AND C.STR_GP_CDE       = 'A'                          08520011
083600            AND B.TRN_TYP_CDE     IN ('01', '02', '11', '12',     08530011
083700                                      '22', '23', '24', '25')     08540011
083800                                                                  08550011
083900       ORDER BY B.PARTN_NBR                                       08560011
084000               ,B.STR_NBR                                         08570011
084100               ,B.RGST_ID                                         08580011
084200               ,B.TRN_NBR                                         08590011
084300               ,B.STRT_TM                                         08600011
084400               ,B.SLS_CORR_SEQ_NBR                                08610011
084500                                                                  08620011
084600       WITH UR                                                    08630011
084700     END-EXEC.                                                    08640011
084800                                                                  08650011
084900******************************************************************08660011
085000* ITEM CURSOR                                                     08670011
085100******************************************************************08680011
085200     EXEC SQL                                                     08690011
085300        DECLARE TEPITM-CURSOR CURSOR FOR                          08700022
085400         SELECT LNE_ITM_SEQ_NBR                                   08710011
085500               ,LIV_RSLU_CDE                                      08720011
085600               ,DEPT_NBR                                          08730011
085700               ,SUB_CL_NBR                                        08740011
085800               ,SLD_QTY                                           08750011
085900               ,NET_CHRGD_AMT                                     08760011
086000               ,SAL_TYP_CDE                                       08770011
086100               ,SAL_RET_CDE                                       08780011
086200               ,DEPT_CL_ERR_CDE                                   08790011
086300               ,SKU_ERR_CDE                                       08800011
086400               ,PRIC_SRC_CDE                                      08810011
086500               ,CUST_CHRGD_AMT                                    08820011
086600               ,REG_RTL_AMT                                       08830011
086700               ,ADITEM_NBR                                        08840011
086800               ,UNT_COST_AMT                                      08850011
086900               ,OWND_UNT_RTL_AMT                                  08860011
087000               ,OWNSHP_CDE                                        08870011
087100               ,REG_RTL_ORGN_CDE                                  08880011
087200               ,SKU_NBR                                           08890011
087300               ,MAJ_CL_NBR                                        08900011
087400               ,PROMO_INTFC_ID                                    08910011
087500                                                                  08920011
087600           FROM TEPITM                                            08930011
087700                                                                  08940011
087800          WHERE PARTN_NBR        = :PV-PARTN-NBR                  08950011
087900            AND STR_NBR          = :PV-STR-NBR                    08960011
088000            AND RGST_ID          = :PV-RGST-ID                    08970011
088100            AND TRN_NBR          = :PV-TRN-NBR                    08980011
088200            AND STRT_TM          = :PV-STRT-TM                    08990011
088300            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           09000011
088400            AND LIV_RSLU_CDE    IN ('+', '-')                     09010011
088500                                                                  09020011
088600       ORDER BY LNE_ITM_SEQ_NBR                                   09030011
088700                                                                  09040011
088800       WITH UR                                                    09050011
088900         OPTIMIZE FOR 5 ROWS                                      09060011
089000                                                                  09070011
089100     END-EXEC.                                                    09080011
089200                                                                  09090011
089300                                                                  09100011
089400******************************************************************09110011
089500* LINE ITEM DISCOUNT CURSOR                                       09120011
089600******************************************************************09130011
089700     EXEC SQL                                                     09140011
089800        DECLARE TEPLID-CURSOR CURSOR FOR                          09150022
089900         SELECT LID_SEQ_NBR                                       09160011
090000               ,LID_AMT                                           09170011
090100               ,LID_RSN_CDE                                       09180011
090200                                                                  09190011
090300           FROM TEPLID                                            09200011
090400                                                                  09210011
090500          WHERE PARTN_NBR        = :PV-PARTN-NBR                  09220011
090600            AND STR_NBR          = :PV-STR-NBR                    09230011
090700            AND RGST_ID          = :PV-RGST-ID                    09240011
090800            AND TRN_NBR          = :PV-TRN-NBR                    09250011
090900            AND STRT_TM          = :PV-STRT-TM                    09260011
091000            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           09270011
091100            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            09280011
091200            AND LID_TYP_CDE     NOT IN ('E', 'G')                 09290011
091300            AND LID_RSN_CDE     IN ('701', '702', '703', '704',   09300011
091400                                    '705', '706', '707', '708',   09310011
205464                                    '709', '710',                 09320089
091500                                    '728', '733', '753',          09330064
091600                                    '760', '761', '762', '763',   09340011
091700                                    '765', '775', '777', '780')   09350027
091800                                                                  09360011
091900       ORDER BY LID_SEQ_NBR                                       09370011
092000                                                                  09380011
092100       WITH UR                                                    09390011
092200         OPTIMIZE FOR 2 ROWS                                      09400011
092300                                                                  09410011
092400     END-EXEC.                                                    09420011
092500                                                                  09430011
092600                                                                  09440011
092700 PROCEDURE DIVISION.                                              09450011
092800******************************************************************09460011
092900* MAIN DRIVER                                                     09470011
093000******************************************************************09480011
093100                                                                  09490011
093200     PERFORM A1000-INITIALIZE.                                    09500011
093300                                                                  09510011
093400     PERFORM B1000-PROCESS-TRAN.                                  09520011
093500     PERFORM C1000-PROCESS-DKEY.                                  09530011
093600                                                                  09540011
093700     PERFORM K1000-PROCESS-REPT.                                  09550011
093800                                                                  09560011
093900     PERFORM Z9000-END-PROC.                                      09570011
094000                                                                  09580011
094100     STOP RUN.                                                    09590011
094200                                                                  09600011
094300                                                                  09610011
094400******************************************************************09620011
094500* PREFORMS TASK INITIATION PROCESSING                             09630011
094600******************************************************************09640011
094700 A1000-INITIALIZE.                                                09650011
094800                                                                  09660011
094900     OPEN INPUT  POS-DATE-FILE                                    09670011
095000          OUTPUT INVENTORY-RPT.                                   09680011
095100                                                                  09690011
095200     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 09700011
095300                                                                  09710011
095400     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            09720011
095500     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            09730011
095600                                                                  09740011
095700     MOVE SYS-DATE (1:2) TO SD-CENT.                              09750011
095800     MOVE SYS-DATE (3:2) TO SD-YEAR.                              09760011
095900     MOVE SYS-DATE (5:2) TO SD-MONTH.                             09770011
096000     MOVE SYS-DATE (7:2) TO SD-DAY.                               09780011
096100                                                                  09790011
096200     PERFORM A2000-READ-CC.                                       09800011
096300     PERFORM A3000-CONVERT-DATE.                                  09810011
096400     PERFORM A4000-FORMAT-HEADINGS.                               09820011
096500                                                                  09830011
096600                                                                  09840011
096700******************************************************************09850011
096800* READ THE DATE FILE INTO THE CONTROL CARD                        09860011
096900******************************************************************09870011
097000 A2000-READ-CC.                                                   09880011
097100                                                                  09890011
097200     READ POS-DATE-FILE INTO CC-CONTROL-CARD                      09900011
097300        AT END SET PS-END-OF-CARD-FILE TO TRUE.                   09910011
097400                                                                  09920011
097500     IF  PS-END-OF-CARD-FILE                                      09930011
097600         MOVE SQLCODE         TO PV-SQLCODE                       09940011
097700         MOVE 'DATE FILE'     TO PV-TABLE-NAME                    09950011
097800         MOVE 'A2000-READ-CC' TO PV-PARAGRAPH-NAME                09960011
097900                                                                  09970011
098000         STRING 'NO DATE TO PROCESS - SQLCODE= '                  09980011
098100                 PV-SQLCODE DELIMITED BY SIZE INTO                09990011
098200                 PV-OPERATION-MSG                                 10000011
098300         END-STRING                                               10010011
098400                                                                  10020011
098500         PERFORM Z1000-ABEND                                      10030011
098600     END-IF.                                                      10040011
098700                                                                  10050011
098800                                                                  10060011
098900******************************************************************10070011
099000* CONVERT THE INPUT DATE TO CORRECT FORMAT                        10080011
099100******************************************************************10090011
099200 A3000-CONVERT-DATE.                                              10100011
099300                                                                  10110011
099400     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              10120011
099500                                                                  10130011
099600     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     10140011
099700     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     10150011
099800     SET DPG52-LK-DTE-GREG           TO TRUE.                     10160011
099900                                                                  10170011
100000     MOVE CC-POS-DATE-MMDDYY TO DPG52-LK-DATE-INPUT.              10180011
100100                                                                  10190011
100200     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    10200011
100300                                             DPG54 DPG55 DPG56.   10210011
100400                                                                  10220011
100500     EVALUATE TRUE                                                10230011
100600        WHEN DPG54-NO-ERROR                                       10240011
100700           MOVE DPG55-DB2-ISO-DATE-FMT                            10250011
100800                                     TO PV-RUN-DATE-CCYY-MM-DD    10260011
100900                                                                  10270011
101000        WHEN DPG54-SEVERE-ERROR                                   10280011
101100        WHEN DPG54-DATE-INVALID                                   10290011
101200           MOVE SQLCODE              TO PV-SQLCODE                10300011
101300           MOVE 'DPKUT100'           TO PV-TABLE-NAME             10310011
101400           MOVE 'A3000-CONVERT-DATE' TO PV-PARAGRAPH-NAME         10320011
101500                                                                  10330011
101600           STRING 'BAD CALL TO THE CALENDAR MODULE - SQLCODE= '   10340011
101700                   PV-SQLCODE DELIMITED BY SIZE INTO              10350011
101800                   PV-OPERATION-MSG                               10360011
101900           END-STRING                                             10370011
102000                                                                  10380011
102100           PERFORM Z1000-ABEND                                    10390011
102200     END-EVALUATE.                                                10400011
102300                                                                  10410011
102400                                                                  10420011
102500******************************************************************10430011
102600* FORMAT THE HEADINGS FOR THE REPORT                              10440011
102700******************************************************************10450011
102800 A4000-FORMAT-HEADINGS.                                           10460011
102900                                                                  10470011
103000     MOVE PC-PROGRAM-NAME TO DP132O-PROGRAM-NAME.                 10480011
103100     MOVE '1'             TO DP132O-REPORT-NUMBER.                10490011
103200                                                                  10500011
103300     MOVE SD-YEAR   TO DP132O-RUN-YEAR.                           10510011
103400     MOVE SD-MONTH  TO DP132O-RUN-MONTH.                          10520011
103500     MOVE SD-DAY    TO DP132O-RUN-DAY.                            10530011
103600     MOVE SD-CENT   TO DP132O-RUN-CENTURY.                        10540011
103700                                                                  10550011
103800     MOVE ST-BEG-HR TO DP132O-RUN-HOUR.                           10560011
103900     MOVE ST-BEG-MN TO DP132O-RUN-MINUTE.                         10570011
104000                                                                  10580011
104100     INITIALIZE DL-DETAIL-LINE.                                   10590011
104200                                                                  10600011
104300     MOVE CC-POS-DATE-MM TO HL-REPORT-MONTH.                      10610011
104400     MOVE CC-POS-DATE-DD TO HL-REPORT-DAY.                        10620011
104500     MOVE CC-POS-DATE-YY TO HL-REPORT-YEAR.                       10630011
104600                                                                  10640011
104700                                                                  10650011
104800******************************************************************10660011
104900* PROCESS TRAN                                                    10670011
105000******************************************************************10680011
105100 B1000-PROCESS-TRAN.                                              10690011
105200                                                                  10700011
105300     MOVE 1 TO PA-SUB.                                            10710011
105400                                                                  10720011
105500     PERFORM B2000-OPEN-TRAN-CURSOR.                              10730011
105600                                                                  10740011
105700     PERFORM B3000-FETCH-TRAN-CURSOR                              10750011
105800        UNTIL PS-END-OF-TRAN.                                     10760011
105900                                                                  10770011
106000     PERFORM B4000-CLOSE-TRAN-CURSOR.                             10780011
106100                                                                  10790011
106200                                                                  10800011
106300******************************************************************10810011
106400* OPEN TRANSACTION CURSOR                                         10820011
106500******************************************************************10830011
106600 B2000-OPEN-TRAN-CURSOR.                                          10840011
106700                                                                  10850011
106800     EXEC SQL                                                     10860011
106900          OPEN TEPTRN-CURSOR                                      10870011
107000     END-EXEC.                                                    10880011
107100                                                                  10890011
107200     IF SQLCODE NOT EQUAL ZERO                                    10900011
107300        MOVE SQLCODE                  TO PV-SQLCODE               10910011
107400        MOVE 'TEPTRN'                 TO PV-TABLE-NAME            10920011
107500        MOVE 'B2000-OPEN-TRAN-CURSOR' TO PV-PARAGRAPH-NAME        10930011
107600                                                                  10940011
107700        STRING 'ERROR ON OPEN OF TEPTRN CURSOR - SQLCODE= '       10950011
107800                PV-SQLCODE DELIMITED BY SIZE INTO                 10960011
107900                PV-OPERATION-MSG                                  10970011
108000        END-STRING                                                10980011
108100                                                                  10990011
108200        PERFORM Z1000-ABEND                                       11000011
108300     END-IF.                                                      11010011
108400                                                                  11020011
108500                                                                  11030011
108600******************************************************************11040011
108700* FETCH TRANSACTION CURSOR                                        11050011
108800******************************************************************11060011
108900 B3000-FETCH-TRAN-CURSOR.                                         11070011
109000                                                                  11080011
109100     EXEC SQL                                                     11090011
109200         FETCH TEPTRN-CURSOR                                      11100011
109300          INTO :EPTRN-PARTN-NBR                                   11110011
109400              ,:EPTRN-STR-NBR                                     11120011
109500              ,:EPTRN-RGST-ID                                     11130011
109600              ,:EPTRN-TRN-NBR                                     11140011
109700              ,:EPTRN-STRT-TM                                     11150011
109800              ,:EPTRN-SLS-CORR-SEQ-NBR                            11160011
109900              ,:EPTRN-TRN-STAT-CDE                                11170011
110000              ,:EPTRN-SLS-DTE                                     11180011
110100              ,:EPTRN-CRE-TMST                                    11190011
110200     END-EXEC.                                                    11200011
110300                                                                  11210011
110400     EVALUATE TRUE                                                11220011
110500        WHEN SQLCODE = ZERO                                       11230011
110600           ADD 1 TO PA-TRAN-READ                                  11240011
110700           ADD 1 TO WS-CMT-CNT                                    11250024
110800                                                                  11260011
110900           PERFORM D1000-PROCESS-ITEMS                            11270011
111000                                                                  11280011
111100        WHEN SQLCODE = PC-ROW-NOT-FOUND                           11290011
111200           SET PS-END-OF-TRAN TO TRUE                             11300011
111300                                                                  11310011
111400        WHEN OTHER                                                11320011
111500           MOVE SQLCODE                   TO PV-SQLCODE           11330011
111600           MOVE 'TEPTRN'                  TO PV-TABLE-NAME        11340011
111700           MOVE 'B3000-FETCH-TRAN-CURSOR' TO PV-PARAGRAPH-NAME    11350011
111800                                                                  11360011
111900           STRING 'ERROR ON FETCH OF TEPTRN CURSOR - SQLCODE= '   11370011
112000                   PV-SQLCODE DELIMITED BY SIZE INTO              11380011
112100                   PV-OPERATION-MSG                               11390011
112200           END-STRING                                             11400011
112300                                                                  11410011
112400           PERFORM Z1000-ABEND                                    11420011
112500     END-EVALUATE.                                                11430011
112600                                                                  11440011
112700     IF WS-CMT-CNT > 1000                                         11450024
112800       PERFORM Z2000-COMMIT-PARA                                  11460024
112900       MOVE ZEROS                         TO WS-CMT-CNT           11470024
113000     END-IF.                                                      11480024
113100                                                                  11490011
113200******************************************************************11500011
113300* CLOSE TRANSACTION CURSOR                                        11510011
113400******************************************************************11520011
113500 B4000-CLOSE-TRAN-CURSOR.                                         11530011
113600                                                                  11540011
113700     EXEC SQL                                                     11550011
113800          CLOSE TEPTRN-CURSOR                                     11560011
113900     END-EXEC.                                                    11570011
114000                                                                  11580011
114100     IF SQLCODE NOT EQUAL ZERO                                    11590011
114200        MOVE SQLCODE                   TO PV-SQLCODE              11600011
114300        MOVE 'TEPTRN'                  TO PV-TABLE-NAME           11610011
114400        MOVE 'B4000-CLOSE-TRAN-CURSOR' TO PV-PARAGRAPH-NAME       11620011
114500                                                                  11630011
114600        STRING 'ERROR ON CLOSE OF TEPTRN CURSOR - SQLCODE= '      11640011
114700                PV-SQLCODE DELIMITED BY SIZE INTO                 11650011
114800                PV-OPERATION-MSG                                  11660011
114900        END-STRING                                                11670011
115000                                                                  11680011
115100        PERFORM Z1000-ABEND                                       11690011
115200     END-IF.                                                      11700011
115300                                                                  11710011
115400                                                                  11720011
115500******************************************************************11730011
115600* PROCESS LATES/CORRECTIONS                                       11740011
115700******************************************************************11750011
115800 C1000-PROCESS-DKEY.                                              11760011
115900                                                                  11770011
116000     PERFORM C2000-OPEN-DKEY-CURSOR.                              11780011
116100                                                                  11790017
116200     MOVE ZEROS      TO WS-CMT-CNT.                               11800024
116300                                                                  11810017
116400     PERFORM C3000-FETCH-DKEY-CURSOR                              11820011
116500       UNTIL PS-END-OF-DKEY-YES.                                  11830011
116600                                                                  11840011
116700     PERFORM C4000-CLOSE-DKEY-CURSOR.                             11850011
116800                                                                  11860011
116900                                                                  11870011
117000******************************************************************11880011
117100* OPEN DKEY CURSOR                                                11890011
117200******************************************************************11900011
117300 C2000-OPEN-DKEY-CURSOR.                                          11910011
117400                                                                  11920011
117500     EXEC SQL                                                     11930011
117600          OPEN TEPDKEY-CURSOR                                     11940011
117700     END-EXEC.                                                    11950011
117800                                                                  11960011
117900     IF SQLCODE NOT EQUAL ZERO                                    11970011
118000        MOVE SQLCODE                  TO PV-SQLCODE               11980011
118100        MOVE 'TEPDKEY'                TO PV-TABLE-NAME            11990011
118200        MOVE 'C2000-OPEN-DKEY-CURSOR' TO PV-PARAGRAPH-NAME        12000011
118300                                                                  12010011
118400        STRING 'ERROR ON OPEN OF TEPDKEY CURSOR - SQLCODE= '      12020011
118500                PV-SQLCODE DELIMITED BY SIZE INTO                 12030011
118600                PV-OPERATION-MSG                                  12040011
118700        END-STRING                                                12050011
118800                                                                  12060011
118900        PERFORM Z1000-ABEND                                       12070011
119000     END-IF.                                                      12080011
119100                                                                  12090011
119200                                                                  12100011
119300******************************************************************12110011
119400* FETCH LATE AND SALES CORRECTION TRANSACTIONS                    12120011
119500******************************************************************12130011
119600 C3000-FETCH-DKEY-CURSOR.                                         12140011
119700                                                                  12150011
119800     EXEC SQL                                                     12160011
119900          FETCH TEPDKEY-CURSOR                                    12170011
120000           INTO :EPTRN-PARTN-NBR                                  12180011
120100               ,:EPTRN-STR-NBR                                    12190011
120200               ,:EPTRN-RGST-ID                                    12200011
120300               ,:EPTRN-TRN-NBR                                    12210011
120400               ,:EPTRN-STRT-TM                                    12220011
120500               ,:EPTRN-SLS-CORR-SEQ-NBR                           12230011
120600               ,:EPTRN-TRN-STAT-CDE                               12240011
120700               ,:EPTRN-SLS-DTE                                    12250011
120800               ,:EPTRN-CRE-TMST                                   12260011
120900     END-EXEC.                                                    12270011
121000                                                                  12280011
121100     EVALUATE TRUE                                                12290011
121200        WHEN SQLCODE = ZERO                                       12300011
121300           IF  EPTRN-TRN-STAT-CDE = 'R'                           12310011
121400           OR  EPTRN-TRN-STAT-CDE = 'V'                           12320011
121500               MOVE 2 TO PA-SUB                                   12330011
121600           ELSE                                                   12340011
121700               MOVE 3 TO PA-SUB                                   12350011
121800           END-IF                                                 12360011
121900           ADD 1 TO WS-CMT-CNT                                    12370024
122000                                                                  12380011
122100           PERFORM D1000-PROCESS-ITEMS                            12390011
122200                                                                  12400011
122300                                                                  12410011
122400        WHEN SQLCODE = PC-ROW-NOT-FOUND                           12420011
122500           SET PS-END-OF-DKEY-YES TO TRUE                         12430011
122600                                                                  12440011
122700        WHEN SQLWARN0 NOT EQUAL SPACE                             12450011
122800        WHEN SQLCODE NOT EQUAL ZERO                               12460011
122900           MOVE SQLCODE                   TO PV-SQLCODE           12470011
123000           MOVE 'TEPDKEY'                 TO PV-TABLE-NAME        12480011
123100           MOVE 'C3000-FETCH-DKEY-CURSOR' TO PV-PARAGRAPH-NAME    12490011
123200                                                                  12500011
123300           STRING 'ERROR ON FETCH OF TEPDKEY CURSOR - SQLCODE= '  12510011
123400                   PV-SQLCODE DELIMITED BY SIZE INTO              12520011
123500                   PV-OPERATION-MSG                               12530011
123600           END-STRING                                             12540011
123700                                                                  12550011
123800           PERFORM Z1000-ABEND                                    12560011
123900     END-EVALUATE.                                                12570011
124000                                                                  12580011
124100     IF WS-CMT-CNT > 1000                                         12590024
124200       PERFORM Z2000-COMMIT-PARA                                  12600024
124300       MOVE ZEROS                         TO WS-CMT-CNT           12610024
124400     END-IF.                                                      12620024
124500                                                                  12630011
124600******************************************************************12640011
124700* CLOSE DKEY CURSOR                                               12650011
124800******************************************************************12660011
124900 C4000-CLOSE-DKEY-CURSOR.                                         12670011
125000                                                                  12680011
125100     EXEC SQL                                                     12690011
125200          CLOSE TEPDKEY-CURSOR                                    12700011
125300     END-EXEC.                                                    12710011
125400                                                                  12720011
125500     IF SQLCODE NOT EQUAL ZERO                                    12730011
125600        MOVE SQLCODE                   TO PV-SQLCODE              12740011
125700        MOVE 'TEPDKEY'                 TO PV-TABLE-NAME           12750011
125800        MOVE 'B4000-CLOSE-TRAN-CURSOR' TO PV-PARAGRAPH-NAME       12760011
125900                                                                  12770011
126000        STRING 'ERROR ON CLOSE OF TEPDKEY CURSOR - SQLCODE= '     12780011
126100                PV-SQLCODE DELIMITED BY SIZE INTO                 12790011
126200                PV-OPERATION-MSG                                  12800011
126300        END-STRING                                                12810011
126400                                                                  12820011
126500        PERFORM Z1000-ABEND                                       12830011
126600     END-IF.                                                      12840011
126700                                                                  12850011
126800                                                                  12860011
126900******************************************************************12870011
127000* PROCESS THE ITEMS                                               12880011
127100******************************************************************12890011
127200 D1000-PROCESS-ITEMS.                                             12900011
127300                                                                  12910011
127400     MOVE 'N' TO PS-END-OF-ITEM-SW.                               12920011
127500                                                                  12930011
127600     MOVE EPTRN-PARTN-NBR         TO PV-PARTN-NBR.                12940011
127700     MOVE EPTRN-STR-NBR           TO PV-STR-NBR.                  12950011
127800     MOVE EPTRN-RGST-ID           TO PV-RGST-ID.                  12960011
127900     MOVE EPTRN-TRN-NBR           TO PV-TRN-NBR.                  12970011
128000     MOVE EPTRN-STRT-TM           TO PV-STRT-TM.                  12980011
128100     MOVE EPTRN-SLS-CORR-SEQ-NBR  TO PV-SLS-CORR-SEQ-NBR.         12990011
128200                                                                  13000011
128300     PERFORM D2000-OPEN-ITEM-CURSOR.                              13010011
128400                                                                  13020011
128500     PERFORM D3000-FETCH-ITEM-CURSOR                              13030011
128600        UNTIL PS-END-OF-ITEM.                                     13040011
128700                                                                  13050011
128800     PERFORM D4000-CLOSE-ITEM-CURSOR.                             13060011
128900                                                                  13070011
129000                                                                  13080011
129100******************************************************************13090011
129200* OPEN ITEM CURSOR                                                13100011
129300******************************************************************13110011
129400 D2000-OPEN-ITEM-CURSOR.                                          13120011
129500                                                                  13130011
129600     EXEC SQL                                                     13140011
129700          OPEN TEPITM-CURSOR                                      13150011
129800     END-EXEC.                                                    13160011
129900                                                                  13170011
130000     IF SQLCODE NOT EQUAL ZERO                                    13180011
130100        MOVE SQLCODE                  TO PV-SQLCODE               13190011
130200        MOVE 'TEPITM'                 TO PV-TABLE-NAME            13200011
130300        MOVE 'D2000-OPEN-ITEM-CURSOR' TO PV-PARAGRAPH-NAME        13210011
130400                                                                  13220011
130500        STRING 'ERROR ON OPEN OF TEPITM CURSOR - SQLCODE= '       13230011
130600                PV-SQLCODE DELIMITED BY SIZE INTO                 13240011
130700                PV-OPERATION-MSG                                  13250011
130800        END-STRING                                                13260011
130900                                                                  13270011
131000        PERFORM Z1000-ABEND                                       13280011
131100     END-IF.                                                      13290011
131200                                                                  13300011
131300                                                                  13310011
131400******************************************************************13320011
131500* FETCH ITEMS FROM TEPITM TABLE                                   13330011
131600******************************************************************13340011
131700 D3000-FETCH-ITEM-CURSOR.                                         13350011
131800                                                                  13360011
131900     EXEC SQL                                                     13370011
132000          FETCH TEPITM-CURSOR                                     13380011
132100           INTO :EPITM-LNE-ITM-SEQ-NBR                            13390011
132200               ,:EPITM-LIV-RSLU-CDE                               13400011
132300               ,:EPITM-DEPT-NBR                                   13410011
132400               ,:EPITM-SUB-CL-NBR                                 13420011
132500               ,:EPITM-SLD-QTY                                    13430011
132600               ,:EPITM-NET-CHRGD-AMT                              13440011
132700               ,:EPITM-SAL-TYP-CDE                                13450011
132800               ,:EPITM-SAL-RET-CDE                                13460011
132900               ,:EPITM-DEPT-CL-ERR-CDE                            13470011
133000               ,:EPITM-SKU-ERR-CDE                                13480011
133100               ,:EPITM-PRIC-SRC-CDE                               13490011
133200               ,:EPITM-CUST-CHRGD-AMT                             13500011
133300               ,:EPITM-REG-RTL-AMT                                13510011
133400               ,:EPITM-ADITEM-NBR                                 13520011
133500               ,:EPITM-UNT-COST-AMT                               13530011
133600               ,:EPITM-OWND-UNT-RTL-AMT                           13540011
133700               ,:EPITM-OWNSHP-CDE                                 13550011
133800               ,:EPITM-REG-RTL-ORGN-CDE                           13560011
133900               ,:EPITM-SKU-NBR                                    13570011
134000               ,:EPITM-MAJ-CL-NBR                                 13580011
134100               ,:EPITM-PROMO-INTFC-ID                             13590011
134200     END-EXEC.                                                    13600011
134300                                                                  13610011
134400     EVALUATE TRUE                                                13620011
134500        WHEN SQLCODE = ZERO                                       13630011
134600           ADD 1 TO PA-ITEM-READ                                  13640011
134700           PERFORM E1000-SCREEN-ITEM                              13650011
134800                                                                  13660011
134900        WHEN SQLCODE = PC-ROW-NOT-FOUND                           13670011
135000           SET PS-END-OF-ITEM         TO TRUE                     13680011
135100                                                                  13690011
135200        WHEN OTHER                                                13700011
135300           MOVE SQLCODE                   TO PV-SQLCODE           13710011
135400           MOVE 'TEPITM'                  TO PV-TABLE-NAME        13720011
135500           MOVE 'D3000-FETCH-ITEM-CURSOR' TO PV-PARAGRAPH-NAME    13730011
135600                                                                  13740011
135700           STRING 'ERROR ON FETCH OF TEPITM CURSOR - SQLCODE= '   13750011
135800                   PV-SQLCODE DELIMITED BY SIZE INTO              13760011
135900                   PV-OPERATION-MSG                               13770011
136000           END-STRING                                             13780011
136100                                                                  13790011
136200           PERFORM Z1000-ABEND                                    13800011
136300     END-EVALUATE.                                                13810011
136400                                                                  13820011
136500                                                                  13830011
136600******************************************************************13840011
136700* CLOSE ITEM CURSOR                                               13850011
136800******************************************************************13860011
136900 D4000-CLOSE-ITEM-CURSOR.                                         13870011
137000                                                                  13880011
137100     EXEC SQL                                                     13890011
137200          CLOSE TEPITM-CURSOR                                     13900011
137300     END-EXEC.                                                    13910011
137400                                                                  13920011
137500     IF SQLCODE NOT EQUAL ZERO                                    13930011
137600        MOVE SQLCODE                   TO PV-SQLCODE              13940011
137700        MOVE 'TEPITM'                  TO PV-TABLE-NAME           13950011
137800        MOVE 'D4000-CLOSE-ITEM-CURSOR' TO PV-PARAGRAPH-NAME       13960011
137900                                                                  13970011
138000        STRING 'ERROR ON CLOSE OF TEPITM CURSOR - SQLCODE= '      13980011
138100                PV-SQLCODE DELIMITED BY SIZE INTO                 13990011
138200                PV-OPERATION-MSG                                  14000011
138300        END-STRING                                                14010011
138400                                                                  14020011
138500        PERFORM Z1000-ABEND                                       14030011
138600     END-IF.                                                      14040011
138700                                                                  14050011
138800                                                                  14060011
138900******************************************************************14070011
139000* FILTER ITEMS. DETERMINE WHAT IS TO BE PROCESSED                 14080011
139100******************************************************************14090011
139200 E1000-SCREEN-ITEM.                                               14100011
139300                                                                  14110011
139400     MOVE EPITM-LNE-ITM-SEQ-NBR TO PV-LNE-ITM-SEQ-NBR.            14120011
139500                                                                  14130060
139600     EVALUATE TRUE                                                14140011
139700        WHEN EPITM-LIV-RSLU-CDE = PC-RSLV-ORIGINAL                14150011
139800        WHEN EPITM-LIV-RSLU-CDE = PC-RSLV-VOID                    14160011
139900        WHEN EPITM-DEPT-NBR     = PC-GIFT-CARD                    14170011
SEPHOR        WHEN EPITM-DEPT-NBR     = PC-SEPHORA-GIFT-CARD-712        14171099
140000        WHEN EPITM-DEPT-NBR     = PC-THIRD-PARTY-CARD-833         14180011
140100        WHEN EPITM-DEPT-NBR     = PC-THIRD-PARTY-CARD-834         14190011
MKTPLC        WHEN EPITM-DEPT-NBR     = PC-MKTPLACE-DEPT-985            14200090
140200        WHEN EPITM-OWNSHP-CDE   = PC-NON-OWNED                    14210011
140300        WHEN EPITM-OWNSHP-CDE   = PC-NON-OWNED-TRACKED            14220011
140400           CONTINUE                                               14230011
140500                                                                  14240011
140600        WHEN OTHER                                                14250011
140700           IF  (EPITM-NET-CHRGD-AMT  > ZERO AND                   14260011
140800                EPITM-CUST-CHRGD-AMT < ZERO)                      14270011
140900           OR  (EPITM-NET-CHRGD-AMT  < ZERO AND                   14280011
141000                EPITM-CUST-CHRGD-AMT > ZERO)                      14290011
141100               CONTINUE                                           14300011
141200           ELSE                                                   14310011
141300              PERFORM E2000-PROCESS-ITEM                          14320011
141400           END-IF                                                 14330011
141500                                                                  14340011
141600     END-EVALUATE.                                                14350011
141700                                                                  14360011
141800                                                                  14370011
141900******************************************************************14380011
142000* DIRECT THE FLOW OF AN ITEM                                      14390011
142100******************************************************************14400011
142200 E2000-PROCESS-ITEM.                                              14410011
142300                                                                  14420011
142400     MOVE 'N' TO PS-BACK-OFFICE-IND.                              14430011
142500                                                                  14440011
142600     PERFORM E3000-CHECK-DISCOUNT.                                14450011
142700                                                                  14460011
142800* PROCESS SALES                                                   14470011
142900     IF  EPITM-SAL-RET-CDE = 'S'                                  14480011
143000     OR  EPITM-SAL-RET-CDE = 'A'                                  14490011
143100         MOVE 'S' TO WS-REC-TYPE                                  14500011
143200         ADD 1 TO PA-SALE                                         14510011
143300         PERFORM F1000-PROCESS-LINE-ITEM-DISC                     14520011
143400                                                                  14530036
143500* PROCESS ZERO CHARGE MARKDOWN AS GWP 704                         14540044
143600         IF EPITM-CUST-CHRGD-AMT = ZERO AND                       14550039
143700            EPITM-REG-RTL-AMT > ZERO AND                          14560043
143800            EPITM-PROMO-INTFC-ID = ZERO                           14570043
143900            COMPUTE EPLID-LID-AMT = EPITM-REG-RTL-AMT * (-1)      14580040
144000            PERFORM J1004-GIFT-WITH-PURCH-LID                     14590040
144100         END-IF                                                   14600040
144200     END-IF.                                                      14610040
144300                                                                  14620011
144400                                                                  14630011
144500* PROCESS RETURNS                                                 14640011
144600     IF  EPITM-SAL-RET-CDE = 'R'                                  14650011
144700     OR  EPITM-SAL-RET-CDE = 'B'                                  14660011
144800         MOVE 'R' TO WS-REC-TYPE                                  14670011
144900         ADD 1 TO PA-RETURN                                       14680011
145000                                                                  14690011
145100         PERFORM F1000-PROCESS-LINE-ITEM-DISC                     14700011
145200                                                                  14710011
145300     END-IF.                                                      14720011
145400                                                                  14730011
145500                                                                  14740011
145600******************************************************************14750011
145700* CHECK FOR EMPLOYEE DISCOUNT                                     14760011
145800******************************************************************14770011
145900 E3000-CHECK-DISCOUNT.                                            14780011
146000                                                                  14790011
146100      EXEC SQL                                                    14800011
146200         SELECT  EMP_DISC_AMT                                     14810011
146300           INTO :EPEID-EMP-DISC-AMT                               14820011
146400                                                                  14830011
146500           FROM TEPEID                                            14840011
146600                                                                  14850011
146700          WHERE PARTN_NBR        = :PV-PARTN-NBR                  14860011
146800            AND STR_NBR          = :PV-STR-NBR                    14870011
146900            AND RGST_ID          = :PV-RGST-ID                    14880011
147000            AND TRN_NBR          = :PV-TRN-NBR                    14890011
147100            AND STRT_TM          = :PV-STRT-TM                    14900011
147200            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           14910011
147300            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            14920011
147400                                                                  14930011
147500          WITH UR                                                 14940011
147600      END-EXEC.                                                   14950011
147700                                                                  14960011
147800     EVALUATE TRUE                                                14970011
147900        WHEN SQLCODE = ZERO                                       14980011
148000           PERFORM E4000-EMPLY-DISCOUNT                           14990011
148100     END-EVALUATE.                                                15000011
148200                                                                  15010011
148300                                                                  15020011
148400******************************************************************15030011
148500* PROCESS EMPLOYEE DISCOUNTS                                      15040011
148600******************************************************************15050011
148700 E4000-EMPLY-DISCOUNT.                                            15060011
148800                                                                  15070011
148900     IF  EPEID-EMP-DISC-AMT < ZERO                                15080011
149000         ADD +1  TO PA-790-REG-MKDN-QTY (PA-SUB)                  15090011
149100         ADD EPEID-EMP-DISC-AMT                                   15100011
149200                 TO PA-790-REG-MKDN-AMT (PA-SUB)                  15110011
149300     ELSE                                                         15120011
149400         ADD +1  TO PA-790-REG-MDC-QTY (PA-SUB)                   15130011
149500         ADD EPEID-EMP-DISC-AMT                                   15140011
149600                 TO PA-790-REG-MDC-AMT (PA-SUB)                   15150011
149700     END-IF.                                                      15160011
149800                                                                  15170011
149900                                                                  15180011
150000******************************************************************15190011
150100* PROCESS LINE ITEM DISCOUNTS                                     15200011
150200******************************************************************15210011
150300 F1000-PROCESS-LINE-ITEM-DISC.                                    15220011
150400                                                                  15230011
150500     PERFORM F1100-OPEN-LID-CURSOR.                               15240011
150600                                                                  15250011
150700     PERFORM F1200-FETCH-LID-CURSOR                               15260011
150800       UNTIL PS-END-OF-LID-YES.                                   15270011
150900                                                                  15280011
151000     PERFORM F1300-CLOSE-LID-CURSOR.                              15290011
151100                                                                  15300011
151200                                                                  15310011
151300******************************************************************15320011
151400* OPEN TEPLID CURSOR TO PROCESS LINE ITEM DISCOUNTS               15330011
151500******************************************************************15340011
151600 F1100-OPEN-LID-CURSOR.                                           15350011
151700                                                                  15360011
151800     EXEC SQL                                                     15370011
151900          OPEN TEPLID-CURSOR                                      15380011
152000     END-EXEC.                                                    15390011
152100                                                                  15400011
152200     EVALUATE TRUE                                                15410011
152300        WHEN SQLCODE = ZERO                                       15420011
152400           SET PS-END-OF-LID-NO TO TRUE                           15430011
152500                                                                  15440011
152600        WHEN OTHER                                                15450011
152700           MOVE SQLCODE                 TO PV-SQLCODE             15460011
152800           MOVE 'TEPLID'                TO PV-TABLE-NAME          15470011
152900           MOVE 'F1100-OPEN-LID-CURSOR' TO PV-PARAGRAPH-NAME      15480011
153000                                                                  15490011
153100           STRING 'ERROR ON OPEN OF TEPLID CURSOR - SQLCODE= '    15500011
153200                   PV-SQLCODE DELIMITED BY SIZE INTO              15510011
153300                   PV-OPERATION-MSG                               15520011
153400           END-STRING                                             15530011
153500                                                                  15540011
153600           PERFORM Z1000-ABEND                                    15550011
153700     END-EVALUATE.                                                15560011
153800                                                                  15570011
153900                                                                  15580011
154000******************************************************************15590011
154100* FETCH AND PROCESS LINE ITEM DISCOUNT INFORMATION.               15600011
154200******************************************************************15610011
154300 F1200-FETCH-LID-CURSOR.                                          15620011
154400                                                                  15630011
154500     EXEC SQL                                                     15640011
154600          FETCH TEPLID-CURSOR                                     15650011
154700          INTO  :EPLID-LID-SEQ-NBR                                15660011
154800               ,:EPLID-LID-AMT                                    15670011
154900               ,:EPLID-LID-RSN-CDE                                15680011
155000     END-EXEC.                                                    15690011
155100                                                                  15700011
155200     EVALUATE TRUE                                                15710011
155300         WHEN SQLCODE = ZERO                                      15720011
155400             PERFORM J0000-PROCESS-LID                            15730011
155500                                                                  15740011
155600         WHEN SQLCODE = PC-ROW-NOT-FOUND                          15750011
155700             SET PS-END-OF-LID-YES TO TRUE                        15760011
155800                                                                  15770011
155900         WHEN OTHER                                               15780011
156000             MOVE SQLCODE                  TO PV-SQLCODE          15790011
156100             MOVE 'TEPLID'                 TO PV-TABLE-NAME       15800011
156200             MOVE 'F1200-FETCH-LID-CURSOR' TO PV-PARAGRAPH-NAME   15810011
156300                                                                  15820011
156400             STRING 'ERROR ON FETCH OF TEPLID CURSOR - SQLCODE= ' 15830011
156500                     PV-SQLCODE DELIMITED BY SIZE INTO            15840011
156600                     PV-OPERATION-MSG                             15850011
156700             END-STRING                                           15860011
156800                                                                  15870011
156900             PERFORM Z1000-ABEND                                  15880011
157000     END-EVALUATE.                                                15890011
157100                                                                  15900011
157200                                                                  15910011
157300******************************************************************15920011
157400* CLOSE TEPLID CURSOR                                             15930011
157500******************************************************************15940011
157600 F1300-CLOSE-LID-CURSOR.                                          15950011
157700                                                                  15960011
157800     EXEC SQL                                                     15970011
157900          CLOSE TEPLID-CURSOR                                     15980011
158000     END-EXEC.                                                    15990011
158100                                                                  16000011
158200     IF SQLCODE NOT EQUAL ZERO                                    16010011
158300        MOVE SQLCODE                  TO PV-SQLCODE               16020011
158400        MOVE 'TEPLID'                 TO PV-TABLE-NAME            16030011
158500        MOVE 'F1300-CLOSE-LID-CURSOR' TO PV-PARAGRAPH-NAME        16040011
158600                                                                  16050011
158700        STRING 'ERROR ON CLOSE OF TEPLID CURSOR - SQLCODE= '      16060011
158800                PV-SQLCODE DELIMITED BY SIZE INTO                 16070011
158900                PV-OPERATION-MSG                                  16080011
159000        END-STRING                                                16090011
159100                                                                  16100011
159200        PERFORM Z1000-ABEND                                       16110011
159300     END-IF.                                                      16120011
159400                                                                  16130011
159500                                                                  16140011
159600******************************************************************16150011
159700* CHECK FOR TIERED LINE ITEM DISCOUNT                             16160011
159800******************************************************************16170011
159900 G1000-CHECK-TIERED-LID.                                          16180011
160000                                                                  16190011
160100      EXEC SQL                                                    16200011
160200         SELECT 1                                                 16210011
160300           INTO :WS-DUMMY-FIELD                                   16220011
160400                                                                  16230011
160500           FROM TEPLID                                            16240011
160600                                                                  16250011
160700          WHERE PARTN_NBR        = :PV-PARTN-NBR                  16260011
160800            AND STR_NBR          = :PV-STR-NBR                    16270011
160900            AND RGST_ID          = :PV-RGST-ID                    16280011
161000            AND TRN_NBR          = :PV-TRN-NBR                    16290011
161100            AND STRT_TM          = :PV-STRT-TM                    16300011
161200            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           16310011
161300            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            16320011
161400            AND LID_RSN_CDE      IN ('746', '761', '762')         16330011
161500                                                                  16340011
161600          WITH UR                                                 16350011
161700      END-EXEC.                                                   16360011
161800                                                                  16370011
161900     EVALUATE TRUE                                                16380011
162000        WHEN SQLCODE = ZERO                                       16390011
162100        WHEN SQLCODE = -811                                       16400011
162200           SET PS-TIERED-ITEM-YES TO TRUE                         16410011
162300                                                                  16420011
162400        WHEN SQLCODE = PC-ROW-NOT-FOUND                           16430011
162500           SET PS-TIERED-ITEM-NO  TO TRUE                         16440011
162600                                                                  16450011
162700        WHEN SQLWARN0 NOT EQUAL SPACE                             16460011
162800        WHEN SQLCODE  NOT EQUAL ZERO                              16470011
162900           MOVE SQLCODE                  TO PV-SQLCODE            16480011
163000           MOVE 'TEPLID'                 TO PV-TABLE-NAME         16490011
163100           MOVE 'G1000-CHECK-TIERED-LID' TO PV-PARAGRAPH-NAME     16500011
163200                                                                  16510011
163300           STRING 'ERROR ON READ OF TEPLID CURSOR - SQLCODE= '    16520011
163400                   PV-SQLCODE DELIMITED BY SIZE INTO              16530011
163500                   PV-OPERATION-MSG                               16540011
163600           END-STRING                                             16550011
163700                                                                  16560011
163800           PERFORM Z1000-ABEND                                    16570011
163900                                                                  16580011
164000     END-EVALUATE.                                                16590011
164100                                                                  16600011
164200                                                                  16610011
164300******************************************************************16620011
164400* PROCESS LINE ITEM DISCOUNTS                                     16630011
164500******************************************************************16640011
164600 J0000-PROCESS-LID.                                               16650011
164700                                                                  16660011
164800     IF  EPLID-LID-AMT = ZERO                                     16670011
164900         CONTINUE                                                 16680011
165000     ELSE                                                         16690011
165100         PERFORM J1000-DETERMINE-LID-TYPE                         16700011
165200     END-IF.                                                      16710011
165300                                                                  16720011
165400                                                                  16730011
165500******************************************************************16740011
165600* DETERMINE THE LINE ITEM DISCOUNT TYPE                           16750011
165700******************************************************************16760011
165800 J1000-DETERMINE-LID-TYPE.                                        16770011
165900                                                                  16780011
166000     EVALUATE EPLID-LID-RSN-CDE                                   16790011
166100                                                                  16800011
166200        WHEN PC-701-SIGNING-ERROR                                 16810011
166300           PERFORM J1001-SIGNING-ERROR-LID                        16820011
166400                                                                  16830011
166500        WHEN PC-702-PLU-ERROR                                     16840011
166600           PERFORM J1002-PLU-ERROR-LID                            16850011
166700                                                                  16860011
166800        WHEN PC-703-DAMAGED-MDSE                                  16870011
166900           PERFORM J1003-DAMAGED-MDSE-LID                         16880011
167000                                                                  16890011
167100        WHEN PC-704-GIFT-WITH-PURCH                               16900011
167200           PERFORM J1004-GIFT-WITH-PURCH-LID                      16910011
167300                                                                  16920011
167400        WHEN PC-705-OPERATOR-MKDN                                 16930011
167500           PERFORM J1005-OPERATOR-MKDN-LID                        16940011
167600                                                                  16950011
167700        WHEN PC-706-RAINCHECK                                     16960011
167800           PERFORM J1006-RAINCHECK-LID                            16970011
167900                                                                  16980011
168000        WHEN PC-707-COMPETITIVE                                   16990011
168100           PERFORM J1007-COMPETITIVE-LID                          17000011
168200                                                                  17010011
168300        WHEN PC-708-SPECIAL-PROMO                                 17020011
168400           PERFORM J1008-SPECIAL-PROMO-LID                        17030011
168500                                                                  17040011
168600        WHEN PC-709-YES-WE-CAN                                    17050011
168700           PERFORM J1009-YES-WE-CAN-LID                           17060065
205464                                                                  17070089
205464        WHEN PC-710-NON-RECEIPT-RTN                               17080089
205464           PERFORM J1021-NON-RECEIPT-RTN                          17090089
168800                                                                  17100011
168900        WHEN PC-728-SENIOR-DISC                                   17110011
169000           PERFORM J1010-SENIOR-DISC-LID                          17120011
169100                                                                  17130011
169200        WHEN PC-733-KOHLS-CPON                                    17140079
169300           PERFORM J1011-KOHLS-CPON-LID                           17150081
169400                                                                  17160011
169500        WHEN PC-753-GOLDSTAR                                      17170011
169600           PERFORM J1012-GOLDSTAR-LID                             17180011
169700                                                                  17190011
169800        WHEN PC-760-OFFER-SIMPLE-COUPON                           17200011
169900           PERFORM J1016-OFFER-SIMPLE-COUPON                      17210011
170000                                                                  17220011
170100        WHEN PC-761-OFFER-TLD-TIERED                              17230011
170200           PERFORM J1017-OFFER-TLD-TIERED                         17240011
170300                                                                  17250011
170400        WHEN PC-762-OFFER-LID-TIERED                              17260011
170500           PERFORM J1018-OFFER-LID-TIERED                         17270011
170600                                                                  17280011
170700        WHEN PC-763-OFFER-GWP-PWP-PRORATED                        17290011
170800           PERFORM J1019-OFFER-GWP-PWP                            17300011
170900                                                                  17310085
171000        WHEN PC-765-KC-GIFT-RCPT-UNEARNED                         17320027
171100           PERFORM J1020-KC-GIFT-RCPT-UNEARNED                    17330027
171200                                                                  17340027
171300        WHEN PC-775-BOGO                                          17350011
171400           PERFORM J1013-BOGO-LID                                 17360011
171500                                                                  17370011
171600        WHEN PC-777-BOGO                                          17380011
171700           PERFORM J1014-BOGO2-LID                                17390011
171800                                                                  17400011
171900        WHEN PC-780-UNEARNED-REWARDS                              17410011
172000           PERFORM J1015-UNEARNED-RWDS-LID                        17420011
172100                                                                  17430011
172200     END-EVALUATE.                                                17440011
172300                                                                  17450011
172400                                                                  17460011
172500******************************************************************17470011
172600* PROCESS SIGNING ERROR ITEMS                                     17480011
172700******************************************************************17490011
172800 J1001-SIGNING-ERROR-LID.                                         17500011
172900                                                                  17510011
173000     IF  PS-BACK-OFFICE-NO                                        17520011
173100         IF  EPITM-LIV-RSLU-CDE = '+'                             17530011
173200             IF  EPLID-LID-AMT IS NEGATIVE                        17540011
173300                 ADD +1            TO PA-701-REG-MKDN-QTY(PA-SUB) 17550011
173400                 ADD EPLID-LID-AMT TO PA-701-REG-MKDN-AMT(PA-SUB) 17560011
173500             ELSE                                                 17570011
173600                 ADD +1            TO PA-701-REG-MDC-QTY(PA-SUB)  17580011
173700                 ADD EPLID-LID-AMT TO PA-701-REG-MDC-AMT(PA-SUB)  17590011
173800             END-IF                                               17600011
173900         END-IF                                                   17610011
174000                                                                  17620011
174100         IF  EPITM-LIV-RSLU-CDE = '-'                             17630011
174200             IF  EPLID-LID-AMT IS NEGATIVE                        17640011
174300                 ADD +1            TO PA-701-REG-MDC-QTY(PA-SUB)  17650011
174400                 ADD EPLID-LID-AMT TO PA-701-REG-MDC-AMT(PA-SUB)  17660011
174500             ELSE                                                 17670011
174600                 ADD +1            TO PA-701-REG-MKDN-QTY(PA-SUB) 17680011
174700                 ADD EPLID-LID-AMT TO PA-701-REG-MKDN-AMT(PA-SUB) 17690011
174800             END-IF                                               17700011
174900         END-IF                                                   17710011
175000                                                                  17720011
175100     ELSE                                                         17730011
175200         IF  EPITM-LIV-RSLU-CDE = '+'                             17740011
175300             IF  EPLID-LID-AMT IS NEGATIVE                        17750011
175400                 ADD +1            TO PA-701-BO-MKDN-QTY(PA-SUB)  17760011
175500                 ADD EPLID-LID-AMT TO PA-701-BO-MKDN-AMT(PA-SUB)  17770011
175600             ELSE                                                 17780011
175700                 ADD +1            TO PA-701-BO-MDC-QTY(PA-SUB)   17790011
175800                 ADD EPLID-LID-AMT TO PA-701-BO-MDC-AMT(PA-SUB)   17800011
175900             END-IF                                               17810011
176000         END-IF                                                   17820011
176100                                                                  17830011
176200         IF  EPITM-LIV-RSLU-CDE = '-'                             17840011
176300             IF  EPLID-LID-AMT IS NEGATIVE                        17850011
176400                 ADD +1            TO PA-701-BO-MDC-QTY(PA-SUB)   17860011
176500                 ADD EPLID-LID-AMT TO PA-701-BO-MDC-AMT(PA-SUB)   17870011
176600             ELSE                                                 17880011
176700                 ADD +1            TO PA-701-BO-MKDN-QTY(PA-SUB)  17890011
176800                 ADD EPLID-LID-AMT TO PA-701-BO-MKDN-AMT(PA-SUB)  17900011
176900             END-IF                                               17910011
177000         END-IF                                                   17920011
177100     END-IF.                                                      17930011
177200                                                                  17940011
177300                                                                  17950011
177400******************************************************************17960011
177500* PROCESS PLU ERROR ITEMS                                         17970011
177600******************************************************************17980011
177700 J1002-PLU-ERROR-LID.                                             17990011
177800                                                                  18000011
177900     IF  PS-BACK-OFFICE-NO                                        18010011
178000         IF  EPITM-LIV-RSLU-CDE = '+'                             18020011
178100             IF  EPLID-LID-AMT IS NEGATIVE                        18030011
178200                 ADD +1            TO PA-702-REG-MKDN-QTY(PA-SUB) 18040011
178300                 ADD EPLID-LID-AMT TO PA-702-REG-MKDN-AMT(PA-SUB) 18050011
178400             ELSE                                                 18060011
178500                 ADD +1            TO PA-702-REG-MDC-QTY(PA-SUB)  18070011
178600                 ADD EPLID-LID-AMT TO PA-702-REG-MDC-AMT(PA-SUB)  18080011
178700             END-IF                                               18090011
178800         END-IF                                                   18100011
178900                                                                  18110011
179000         IF  EPITM-LIV-RSLU-CDE = '-'                             18120011
179100             IF  EPLID-LID-AMT IS NEGATIVE                        18130011
179200                 ADD +1            TO PA-702-REG-MDC-QTY(PA-SUB)  18140011
179300                 ADD EPLID-LID-AMT TO PA-702-REG-MDC-AMT(PA-SUB)  18150011
179400             ELSE                                                 18160011
179500                 ADD +1            TO PA-702-REG-MKDN-QTY(PA-SUB) 18170011
179600                 ADD EPLID-LID-AMT TO PA-702-REG-MKDN-AMT(PA-SUB) 18180011
179700             END-IF                                               18190011
179800         END-IF                                                   18200011
179900                                                                  18210011
180000     ELSE                                                         18220011
180100         IF  EPITM-LIV-RSLU-CDE = '+'                             18230011
180200             IF  EPLID-LID-AMT IS NEGATIVE                        18240011
180300                 ADD +1            TO PA-702-BO-MKDN-QTY(PA-SUB)  18250011
180400                 ADD EPLID-LID-AMT TO PA-702-BO-MKDN-AMT(PA-SUB)  18260011
180500             ELSE                                                 18270011
180600                 ADD +1            TO PA-702-BO-MDC-QTY(PA-SUB)   18280011
180700                 ADD EPLID-LID-AMT TO PA-702-BO-MDC-AMT(PA-SUB)   18290011
180800             END-IF                                               18300011
180900         END-IF                                                   18310011
181000                                                                  18320011
181100         IF  EPITM-LIV-RSLU-CDE = '-'                             18330011
181200             IF  EPLID-LID-AMT IS NEGATIVE                        18340011
181300                 ADD +1            TO PA-702-BO-MDC-QTY(PA-SUB)   18350011
181400                 ADD EPLID-LID-AMT TO PA-702-BO-MDC-AMT(PA-SUB)   18360011
181500             ELSE                                                 18370011
181600                 ADD +1            TO PA-702-BO-MKDN-QTY(PA-SUB)  18380011
181700                 ADD EPLID-LID-AMT TO PA-702-BO-MKDN-AMT(PA-SUB)  18390011
181800             END-IF                                               18400011
181900         END-IF                                                   18410011
182000     END-IF.                                                      18420011
182100                                                                  18430011
182200                                                                  18440011
182300******************************************************************18450011
182400* PROCESS DAMAGED MERCHANDISE ITEMS                               18460011
182500******************************************************************18470011
182600 J1003-DAMAGED-MDSE-LID.                                          18480011
182700                                                                  18490011
182800     IF  PS-BACK-OFFICE-NO                                        18500011
182900         IF  EPITM-LIV-RSLU-CDE = '+'                             18510011
183000             IF  EPLID-LID-AMT IS NEGATIVE                        18520011
183100                 ADD +1            TO PA-703-REG-MKDN-QTY(PA-SUB) 18530011
183200                 ADD EPLID-LID-AMT TO PA-703-REG-MKDN-AMT(PA-SUB) 18540011
183300             ELSE                                                 18550011
183400                 ADD +1            TO PA-703-REG-MDC-QTY(PA-SUB)  18560011
183500                 ADD EPLID-LID-AMT TO PA-703-REG-MDC-AMT(PA-SUB)  18570011
183600             END-IF                                               18580011
183700         END-IF                                                   18590011
183800                                                                  18600011
183900         IF  EPITM-LIV-RSLU-CDE = '-'                             18610011
184000             IF  EPLID-LID-AMT IS NEGATIVE                        18620011
184100                 ADD +1            TO PA-703-REG-MDC-QTY(PA-SUB)  18630011
184200                 ADD EPLID-LID-AMT TO PA-703-REG-MDC-AMT(PA-SUB)  18640011
184300             ELSE                                                 18650011
184400                 ADD +1            TO PA-703-REG-MKDN-QTY(PA-SUB) 18660011
184500                 ADD EPLID-LID-AMT TO PA-703-REG-MKDN-AMT(PA-SUB) 18670011
184600             END-IF                                               18680011
184700         END-IF                                                   18690011
184800                                                                  18700011
184900     ELSE                                                         18710011
185000         IF  EPITM-LIV-RSLU-CDE = '+'                             18720011
185100             IF  EPLID-LID-AMT IS NEGATIVE                        18730011
185200                 ADD +1            TO PA-703-BO-MKDN-QTY(PA-SUB)  18740011
185300                 ADD EPLID-LID-AMT TO PA-703-BO-MKDN-AMT(PA-SUB)  18750011
185400             ELSE                                                 18760011
185500                 ADD +1            TO PA-703-BO-MDC-QTY(PA-SUB)   18770011
185600                 ADD EPLID-LID-AMT TO PA-703-BO-MDC-AMT(PA-SUB)   18780011
185700             END-IF                                               18790011
185800         END-IF                                                   18800011
185900                                                                  18810011
186000         IF  EPITM-LIV-RSLU-CDE = '-'                             18820011
186100             IF  EPLID-LID-AMT IS NEGATIVE                        18830011
186200                 ADD +1            TO PA-703-BO-MDC-QTY(PA-SUB)   18840011
186300                 ADD EPLID-LID-AMT TO PA-703-BO-MDC-AMT(PA-SUB)   18850011
186400             ELSE                                                 18860011
186500                 ADD +1            TO PA-703-BO-MKDN-QTY(PA-SUB)  18870011
186600                 ADD EPLID-LID-AMT TO PA-703-BO-MKDN-AMT(PA-SUB)  18880011
186700             END-IF                                               18890011
186800         END-IF                                                   18900011
186900     END-IF.                                                      18910011
187000                                                                  18920011
187100                                                                  18930011
187200******************************************************************18940011
187300* PROCESS GIFT WITH PURCHASE ITEMS                                18950011
187400******************************************************************18960011
187500 J1004-GIFT-WITH-PURCH-LID.                                       18970011
187600                                                                  18980011
187700     IF  PS-BACK-OFFICE-NO                                        18990011
187800         IF  EPITM-LIV-RSLU-CDE = '+'                             19000011
187900             IF  EPLID-LID-AMT IS NEGATIVE                        19010011
188000                 ADD +1            TO PA-704-REG-MKDN-QTY(PA-SUB) 19020011
188100                 ADD EPLID-LID-AMT TO PA-704-REG-MKDN-AMT(PA-SUB) 19030011
188200             ELSE                                                 19040011
188300                 ADD +1            TO PA-704-REG-MDC-QTY(PA-SUB)  19050011
188400                 ADD EPLID-LID-AMT TO PA-704-REG-MDC-AMT(PA-SUB)  19060011
188500             END-IF                                               19070011
188600         END-IF                                                   19080011
188700                                                                  19090011
188800         IF  EPITM-LIV-RSLU-CDE = '-'                             19100011
188900             IF  EPLID-LID-AMT IS NEGATIVE                        19110011
189000                 ADD +1            TO PA-704-REG-MDC-QTY(PA-SUB)  19120011
189100                 ADD EPLID-LID-AMT TO PA-704-REG-MDC-AMT(PA-SUB)  19130011
189200             ELSE                                                 19140011
189300                 ADD +1            TO PA-704-REG-MKDN-QTY(PA-SUB) 19150011
189400                 ADD EPLID-LID-AMT TO PA-704-REG-MKDN-AMT(PA-SUB) 19160011
189500             END-IF                                               19170011
189600         END-IF                                                   19180011
189700                                                                  19190011
189800     ELSE                                                         19200011
189900         IF  EPITM-LIV-RSLU-CDE = '+'                             19210011
190000             IF  EPLID-LID-AMT IS NEGATIVE                        19220011
190100                 ADD +1            TO PA-704-BO-MKDN-QTY(PA-SUB)  19230011
190200                 ADD EPLID-LID-AMT TO PA-704-BO-MKDN-AMT(PA-SUB)  19240011
190300             ELSE                                                 19250011
190400                 ADD +1            TO PA-704-BO-MDC-QTY(PA-SUB)   19260011
190500                 ADD EPLID-LID-AMT TO PA-704-BO-MDC-AMT(PA-SUB)   19270011
190600             END-IF                                               19280011
190700         END-IF                                                   19290011
190800                                                                  19300011
190900         IF  EPITM-LIV-RSLU-CDE = '-'                             19310011
191000             IF  EPLID-LID-AMT IS NEGATIVE                        19320011
191100                 ADD +1            TO PA-704-BO-MDC-QTY(PA-SUB)   19330011
191200                 ADD EPLID-LID-AMT TO PA-704-BO-MDC-AMT(PA-SUB)   19340011
191300             ELSE                                                 19350011
191400                 ADD +1            TO PA-704-BO-MKDN-QTY(PA-SUB)  19360011
191500                 ADD EPLID-LID-AMT TO PA-704-BO-MKDN-AMT(PA-SUB)  19370011
191600             END-IF                                               19380011
191700         END-IF                                                   19390011
191800     END-IF.                                                      19400011
191900                                                                  19410011
192000                                                                  19420011
192100******************************************************************19430011
192200* PROCESS OPERATOR MARKDOWN ITEMS                                 19440011
192300******************************************************************19450011
192400 J1005-OPERATOR-MKDN-LID.                                         19460011
192500                                                                  19470011
192600     IF  PS-BACK-OFFICE-NO                                        19480011
192700         IF  EPITM-LIV-RSLU-CDE = '+'                             19490011
192800             IF  EPLID-LID-AMT IS NEGATIVE                        19500011
192900                 ADD +1            TO PA-705-REG-MKDN-QTY(PA-SUB) 19510011
193000                 ADD EPLID-LID-AMT TO PA-705-REG-MKDN-AMT(PA-SUB) 19520011
193100             ELSE                                                 19530011
193200                 ADD +1            TO PA-705-REG-MDC-QTY(PA-SUB)  19540011
193300                 ADD EPLID-LID-AMT TO PA-705-REG-MDC-AMT(PA-SUB)  19550011
193400             END-IF                                               19560011
193500         END-IF                                                   19570011
193600                                                                  19580011
193700         IF  EPITM-LIV-RSLU-CDE = '-'                             19590011
193800             IF  EPLID-LID-AMT IS NEGATIVE                        19600011
193900                 ADD +1            TO PA-705-REG-MDC-QTY(PA-SUB)  19610011
194000                 ADD EPLID-LID-AMT TO PA-705-REG-MDC-AMT(PA-SUB)  19620011
194100             ELSE                                                 19630011
194200                 ADD +1            TO PA-705-REG-MKDN-QTY(PA-SUB) 19640011
194300                 ADD EPLID-LID-AMT TO PA-705-REG-MKDN-AMT(PA-SUB) 19650011
194400             END-IF                                               19660011
194500         END-IF                                                   19670011
194600                                                                  19680011
194700     ELSE                                                         19690011
194800         IF  EPITM-LIV-RSLU-CDE = '+'                             19700011
194900             IF  EPLID-LID-AMT IS NEGATIVE                        19710011
195000                 ADD +1            TO PA-705-BO-MKDN-QTY(PA-SUB)  19720011
195100                 ADD EPLID-LID-AMT TO PA-705-BO-MKDN-AMT(PA-SUB)  19730011
195200             ELSE                                                 19740011
195300                 ADD +1            TO PA-705-BO-MDC-QTY(PA-SUB)   19750011
195400                 ADD EPLID-LID-AMT TO PA-705-BO-MDC-AMT(PA-SUB)   19760011
195500             END-IF                                               19770011
195600         END-IF                                                   19780011
195700                                                                  19790011
195800         IF  EPITM-LIV-RSLU-CDE = '-'                             19800011
195900             IF  EPLID-LID-AMT IS NEGATIVE                        19810011
196000                 ADD +1            TO PA-705-BO-MDC-QTY(PA-SUB)   19820011
196100                 ADD EPLID-LID-AMT TO PA-705-BO-MDC-AMT(PA-SUB)   19830011
196200             ELSE                                                 19840011
196300                 ADD +1            TO PA-705-BO-MKDN-QTY(PA-SUB)  19850011
196400                 ADD EPLID-LID-AMT TO PA-705-BO-MKDN-AMT(PA-SUB)  19860011
196500             END-IF                                               19870011
196600         END-IF                                                   19880011
196700     END-IF.                                                      19890011
196800                                                                  19900011
196900                                                                  19910011
197000******************************************************************19920011
197100* PROCESS RAINCHECK ITEMS                                         19930011
197200******************************************************************19940011
197300 J1006-RAINCHECK-LID.                                             19950011
197400                                                                  19960011
197500     IF  PS-BACK-OFFICE-NO                                        19970011
197600         IF  EPITM-LIV-RSLU-CDE = '+'                             19980011
197700             IF  EPLID-LID-AMT IS NEGATIVE                        19990011
197800                 ADD +1            TO PA-706-REG-MKDN-QTY(PA-SUB) 20000011
197900                 ADD EPLID-LID-AMT TO PA-706-REG-MKDN-AMT(PA-SUB) 20010011
198000             ELSE                                                 20020011
198100                 ADD +1            TO PA-706-REG-MDC-QTY(PA-SUB)  20030011
198200                 ADD EPLID-LID-AMT TO PA-706-REG-MDC-AMT(PA-SUB)  20040011
198300             END-IF                                               20050011
198400         END-IF                                                   20060011
198500                                                                  20070011
198600         IF  EPITM-LIV-RSLU-CDE = '-'                             20080011
198700             IF  EPLID-LID-AMT IS NEGATIVE                        20090011
198800                 ADD +1            TO PA-706-REG-MDC-QTY(PA-SUB)  20100011
198900                 ADD EPLID-LID-AMT TO PA-706-REG-MDC-AMT(PA-SUB)  20110011
199000             ELSE                                                 20120011
199100                 ADD +1            TO PA-706-REG-MKDN-QTY(PA-SUB) 20130011
199200                 ADD EPLID-LID-AMT TO PA-706-REG-MKDN-AMT(PA-SUB) 20140011
199300             END-IF                                               20150011
199400         END-IF                                                   20160011
199500                                                                  20170011
199600     ELSE                                                         20180011
199700         IF  EPITM-LIV-RSLU-CDE = '+'                             20190011
199800             IF  EPLID-LID-AMT IS NEGATIVE                        20200011
199900                 ADD +1            TO PA-706-BO-MKDN-QTY(PA-SUB)  20210011
200000                 ADD EPLID-LID-AMT TO PA-706-BO-MKDN-AMT(PA-SUB)  20220011
200100             ELSE                                                 20230011
200200                 ADD +1            TO PA-706-BO-MDC-QTY(PA-SUB)   20240011
200300                 ADD EPLID-LID-AMT TO PA-706-BO-MDC-AMT(PA-SUB)   20250011
200400             END-IF                                               20260011
200500         END-IF                                                   20270011
200600                                                                  20280011
200700         IF  EPITM-LIV-RSLU-CDE = '-'                             20290011
200800             IF  EPLID-LID-AMT IS NEGATIVE                        20300011
200900                 ADD +1            TO PA-706-BO-MDC-QTY(PA-SUB)   20310011
201000                 ADD EPLID-LID-AMT TO PA-706-BO-MDC-AMT(PA-SUB)   20320011
201100             ELSE                                                 20330011
201200                 ADD +1            TO PA-706-BO-MKDN-QTY(PA-SUB)  20340011
201300                 ADD EPLID-LID-AMT TO PA-706-BO-MKDN-AMT(PA-SUB)  20350011
201400             END-IF                                               20360011
201500         END-IF                                                   20370011
201600     END-IF.                                                      20380011
201700                                                                  20390011
201800                                                                  20400011
201900******************************************************************20410011
202000* PROCESS COMPETITIVE ITEMS                                       20420011
202100******************************************************************20430011
202200 J1007-COMPETITIVE-LID.                                           20440011
202300                                                                  20450011
202400     IF  PS-BACK-OFFICE-NO                                        20460011
202500         IF  EPITM-LIV-RSLU-CDE = '+'                             20470011
202600             IF  EPLID-LID-AMT IS NEGATIVE                        20480011
202700                 ADD +1            TO PA-707-REG-MKDN-QTY(PA-SUB) 20490011
202800                 ADD EPLID-LID-AMT TO PA-707-REG-MKDN-AMT(PA-SUB) 20500011
202900             ELSE                                                 20510011
203000                 ADD +1            TO PA-707-REG-MDC-QTY(PA-SUB)  20520011
203100                 ADD EPLID-LID-AMT TO PA-707-REG-MDC-AMT(PA-SUB)  20530011
203200             END-IF                                               20540011
203300         END-IF                                                   20550011
203400                                                                  20560011
203500         IF  EPITM-LIV-RSLU-CDE = '-'                             20570011
203600             IF  EPLID-LID-AMT IS NEGATIVE                        20580011
203700                 ADD +1            TO PA-707-REG-MDC-QTY(PA-SUB)  20590011
203800                 ADD EPLID-LID-AMT TO PA-707-REG-MDC-AMT(PA-SUB)  20600011
203900             ELSE                                                 20610011
204000                 ADD +1            TO PA-707-REG-MKDN-QTY(PA-SUB) 20620011
204100                 ADD EPLID-LID-AMT TO PA-707-REG-MKDN-AMT(PA-SUB) 20630011
204200             END-IF                                               20640011
204300         END-IF                                                   20650011
204400                                                                  20660011
204500     ELSE                                                         20670011
204600         IF  EPITM-LIV-RSLU-CDE = '+'                             20680011
204700             IF  EPLID-LID-AMT IS NEGATIVE                        20690011
204800                 ADD +1            TO PA-707-BO-MKDN-QTY(PA-SUB)  20700011
204900                 ADD EPLID-LID-AMT TO PA-707-BO-MKDN-AMT(PA-SUB)  20710011
205000             ELSE                                                 20720011
205100                 ADD +1            TO PA-707-BO-MDC-QTY(PA-SUB)   20730011
205200                 ADD EPLID-LID-AMT TO PA-707-BO-MDC-AMT(PA-SUB)   20740011
205300             END-IF                                               20750011
205400         END-IF                                                   20760011
205500                                                                  20770011
205600         IF  EPITM-LIV-RSLU-CDE = '-'                             20780011
205700             IF  EPLID-LID-AMT IS NEGATIVE                        20790011
205800                 ADD +1            TO PA-707-BO-MDC-QTY(PA-SUB)   20800011
205900                 ADD EPLID-LID-AMT TO PA-707-BO-MDC-AMT(PA-SUB)   20810011
206000             ELSE                                                 20820011
206100                 ADD +1            TO PA-707-BO-MKDN-QTY(PA-SUB)  20830011
206200                 ADD EPLID-LID-AMT TO PA-707-BO-MKDN-AMT(PA-SUB)  20840011
206300             END-IF                                               20850011
206400         END-IF                                                   20860011
206500     END-IF.                                                      20870011
206600                                                                  20880011
206700                                                                  20890011
206800******************************************************************20900011
206900* PROCESS SPECIAL PROMOTION ITEMS                                 20910011
207000******************************************************************20920011
207100 J1008-SPECIAL-PROMO-LID.                                         20930011
207200                                                                  20940011
207300     IF  PS-BACK-OFFICE-NO                                        20950011
207400         IF  EPITM-LIV-RSLU-CDE = '+'                             20960011
207500             IF  EPLID-LID-AMT IS NEGATIVE                        20970011
207600                 ADD +1            TO PA-708-REG-MKDN-QTY(PA-SUB) 20980011
207700                 ADD EPLID-LID-AMT TO PA-708-REG-MKDN-AMT(PA-SUB) 20990011
207800             ELSE                                                 21000011
207900                 ADD +1            TO PA-708-REG-MDC-QTY(PA-SUB)  21010011
208000                 ADD EPLID-LID-AMT TO PA-708-REG-MDC-AMT(PA-SUB)  21020011
208100             END-IF                                               21030011
208200         END-IF                                                   21040011
208300                                                                  21050011
208400         IF  EPITM-LIV-RSLU-CDE = '-'                             21060011
208500             IF  EPLID-LID-AMT IS NEGATIVE                        21070011
208600                 ADD +1            TO PA-708-REG-MDC-QTY(PA-SUB)  21080011
208700                 ADD EPLID-LID-AMT TO PA-708-REG-MDC-AMT(PA-SUB)  21090011
208800             ELSE                                                 21100011
208900                 ADD +1            TO PA-708-REG-MKDN-QTY(PA-SUB) 21110011
209000                 ADD EPLID-LID-AMT TO PA-708-REG-MKDN-AMT(PA-SUB) 21120011
209100             END-IF                                               21130011
209200         END-IF                                                   21140011
209300                                                                  21150011
209400     ELSE                                                         21160011
209500         IF  EPITM-LIV-RSLU-CDE = '+'                             21170011
209600             IF  EPLID-LID-AMT IS NEGATIVE                        21180011
209700                 ADD +1            TO PA-708-BO-MKDN-QTY(PA-SUB)  21190011
209800                 ADD EPLID-LID-AMT TO PA-708-BO-MKDN-AMT(PA-SUB)  21200011
209900             ELSE                                                 21210011
210000                 ADD +1            TO PA-708-BO-MDC-QTY(PA-SUB)   21220011
210100                 ADD EPLID-LID-AMT TO PA-708-BO-MDC-AMT(PA-SUB)   21230011
210200             END-IF                                               21240011
210300         END-IF                                                   21250011
210400                                                                  21260011
210500         IF  EPITM-LIV-RSLU-CDE = '-'                             21270011
210600             IF  EPLID-LID-AMT IS NEGATIVE                        21280011
210700                 ADD +1            TO PA-708-BO-MDC-QTY(PA-SUB)   21290011
210800                 ADD EPLID-LID-AMT TO PA-708-BO-MDC-AMT(PA-SUB)   21300011
210900             ELSE                                                 21310011
211000                 ADD +1            TO PA-708-BO-MKDN-QTY(PA-SUB)  21320011
211100                 ADD EPLID-LID-AMT TO PA-708-BO-MKDN-AMT(PA-SUB)  21330011
211200             END-IF                                               21340011
211300         END-IF                                                   21350011
211400     END-IF.                                                      21360011
211500                                                                  21370011
211600                                                                  21380011
211700******************************************************************21390011
211800* PROCESS YES-WE-CAN ITEMS                                        21400011
211900******************************************************************21410011
212000 J1009-YES-WE-CAN-LID.                                            21420011
212100                                                                  21430011
212200     IF  PS-BACK-OFFICE-NO                                        21440011
212300         IF  EPITM-LIV-RSLU-CDE = '+'                             21450011
212400             IF  EPLID-LID-AMT IS NEGATIVE                        21460011
212500                 ADD +1            TO PA-709-REG-MKDN-QTY(PA-SUB) 21470011
212600                 ADD EPLID-LID-AMT TO PA-709-REG-MKDN-AMT(PA-SUB) 21480011
212700             ELSE                                                 21490011
212800                 ADD +1            TO PA-709-REG-MDC-QTY(PA-SUB)  21500011
212900                 ADD EPLID-LID-AMT TO PA-709-REG-MDC-AMT(PA-SUB)  21510011
213000             END-IF                                               21520011
213100         END-IF                                                   21530011
213200                                                                  21540011
213300         IF  EPITM-LIV-RSLU-CDE = '-'                             21550011
213400             IF  EPLID-LID-AMT IS NEGATIVE                        21560011
213500                 ADD +1            TO PA-709-REG-MDC-QTY(PA-SUB)  21570011
213600                 ADD EPLID-LID-AMT TO PA-709-REG-MDC-AMT(PA-SUB)  21580011
213700             ELSE                                                 21590011
213800                 ADD +1            TO PA-709-REG-MKDN-QTY(PA-SUB) 21600011
213900                 ADD EPLID-LID-AMT TO PA-709-REG-MKDN-AMT(PA-SUB) 21610011
214000             END-IF                                               21620011
214100         END-IF                                                   21630011
214200                                                                  21640011
214300     ELSE                                                         21650011
214400         IF  EPITM-LIV-RSLU-CDE = '+'                             21660011
214500             IF  EPLID-LID-AMT IS NEGATIVE                        21670011
214600                 ADD +1            TO PA-709-BO-MKDN-QTY(PA-SUB)  21680011
214700                 ADD EPLID-LID-AMT TO PA-709-BO-MKDN-AMT(PA-SUB)  21690011
214800             ELSE                                                 21700011
214900                 ADD +1            TO PA-709-BO-MDC-QTY(PA-SUB)   21710011
215000                 ADD EPLID-LID-AMT TO PA-709-BO-MDC-AMT(PA-SUB)   21720011
215100             END-IF                                               21730011
215200         END-IF                                                   21740011
215300                                                                  21750011
215400         IF  EPITM-LIV-RSLU-CDE = '-'                             21760011
215500             IF  EPLID-LID-AMT IS NEGATIVE                        21770011
215600                 ADD +1            TO PA-709-BO-MDC-QTY(PA-SUB)   21780011
215700                 ADD EPLID-LID-AMT TO PA-709-BO-MDC-AMT(PA-SUB)   21790011
215800             ELSE                                                 21800011
215900                 ADD +1            TO PA-709-BO-MKDN-QTY(PA-SUB)  21810011
216000                 ADD EPLID-LID-AMT TO PA-709-BO-MKDN-AMT(PA-SUB)  21820011
216100             END-IF                                               21830011
216200         END-IF                                                   21840011
216300     END-IF.                                                      21850011
216400                                                                  21860011
216500                                                                  21870065
216600******************************************************************21880011
216700* PROCESS SENIOR DISCOUNT ITEMS                                   21890011
216800******************************************************************21900011
216900 J1010-SENIOR-DISC-LID.                                           21910011
217000                                                                  21920011
217100     IF  EPITM-LIV-RSLU-CDE = '+'                                 21930011
217200         IF  EPLID-LID-AMT IS NEGATIVE                            21940011
217300             ADD +1            TO PA-728-REG-MKDN-QTY(PA-SUB)     21950011
217400             ADD EPLID-LID-AMT TO PA-728-REG-MKDN-AMT(PA-SUB)     21960011
217500         ELSE                                                     21970011
217600             ADD +1            TO PA-728-REG-MDC-QTY(PA-SUB)      21980011
217700             ADD EPLID-LID-AMT TO PA-728-REG-MDC-AMT(PA-SUB)      21990011
217800         END-IF                                                   22000011
217900     END-IF.                                                      22010011
218000                                                                  22020011
218100     IF  EPITM-LIV-RSLU-CDE = '-'                                 22030011
218200         IF  EPLID-LID-AMT IS NEGATIVE                            22040011
218300             ADD +1            TO PA-728-REG-MDC-QTY(PA-SUB)      22050011
218400             ADD EPLID-LID-AMT TO PA-728-REG-MDC-AMT(PA-SUB)      22060011
218500         ELSE                                                     22070011
218600             ADD +1            TO PA-728-REG-MKDN-QTY(PA-SUB)     22080011
218700             ADD EPLID-LID-AMT TO PA-728-REG-MKDN-AMT(PA-SUB)     22090011
218800         END-IF                                                   22100011
218900     END-IF.                                                      22110011
219000                                                                  22120011
219100                                                                  22130011
219200******************************************************************22140011
219300* PROCESS KOHLS COUPON ITEMS                                      22150011
219400******************************************************************22160011
219500 J1011-KOHLS-CPON-LID.                                            22170011
219600                                                                  22180011
219700     IF  EPITM-LIV-RSLU-CDE = '+'                                 22190011
219800         IF  EPLID-LID-AMT IS NEGATIVE                            22200011
219900             ADD +1            TO PA-733-REG-MKDN-QTY(PA-SUB)     22210011
220000             ADD EPLID-LID-AMT TO PA-733-REG-MKDN-AMT(PA-SUB)     22220011
220100         ELSE                                                     22230011
220200             ADD +1            TO PA-733-REG-MDC-QTY(PA-SUB)      22240011
220300             ADD EPLID-LID-AMT TO PA-733-REG-MDC-AMT(PA-SUB)      22250011
220400         END-IF                                                   22260011
220500     END-IF.                                                      22270011
220600                                                                  22280011
220700     IF  EPITM-LIV-RSLU-CDE = '-'                                 22290011
220800         IF  EPLID-LID-AMT IS NEGATIVE                            22300011
220900             ADD +1            TO PA-733-REG-MDC-QTY(PA-SUB)      22310011
221000             ADD EPLID-LID-AMT TO PA-733-REG-MDC-AMT(PA-SUB)      22320011
221100         ELSE                                                     22330011
221200             ADD +1            TO PA-733-REG-MKDN-QTY(PA-SUB)     22340011
221300             ADD EPLID-LID-AMT TO PA-733-REG-MKDN-AMT(PA-SUB)     22350011
221400         END-IF                                                   22360011
221500     END-IF.                                                      22370011
221600                                                                  22380011
221700                                                                  22390011
221800******************************************************************22400011
221900* PROCESS GOLDSTAR ITEMS                                          22410011
222000******************************************************************22420011
222100 J1012-GOLDSTAR-LID.                                              22430011
222200                                                                  22440011
222300     IF  PS-BACK-OFFICE-NO                                        22450011
222400         IF  EPITM-LIV-RSLU-CDE = '+'                             22450197
222500             IF  EPLID-LID-AMT IS NEGATIVE                        22450297
GOLDFX***             THIS IS A FIX FOR RETURN TRANSACTIONS FROM ECOM   22451097
GOLDFX***             THAT HAVE NEGATIVE GOLDSTAR LID AMOUNTS.          22451197
GOLDFX                IF WS-RETURN                                      22451297
GOLDFX                   ADD +1          TO PA-753-REG-MDC-QTY(PA-SUB)  22452197
222700                   ADD EPLID-LID-AMT                              22452297
222750                                   TO PA-753-REG-MDC-AMT(PA-SUB)  22452397
GOLDFX                ELSE                                              22453097
222600                   ADD +1          TO PA-753-REG-MKDN-QTY(PA-SUB) 22480097
222700                   ADD EPLID-LID-AMT                              22481097
222750                                   TO PA-753-REG-MKDN-AMT(PA-SUB) 22482097
GOLDFX                END-IF                                            22493097
222800             ELSE                                                 22500011
222900                 ADD +1            TO PA-753-REG-MDC-QTY(PA-SUB)  22510011
223000                 ADD EPLID-LID-AMT TO PA-753-REG-MDC-AMT(PA-SUB)  22520011
223100             END-IF                                               22530011
223200         END-IF                                                   22540011
223300                                                                  22550011
223400         IF  EPITM-LIV-RSLU-CDE = '-'                             22560011
223500             IF  EPLID-LID-AMT IS NEGATIVE                        22570011
223600                 ADD +1            TO PA-753-REG-MDC-QTY(PA-SUB)  22580011
223700                 ADD EPLID-LID-AMT TO PA-753-REG-MDC-AMT(PA-SUB)  22590011
223800             ELSE                                                 22600011
223900                 ADD +1            TO PA-753-REG-MKDN-QTY(PA-SUB) 22610011
224000                 ADD EPLID-LID-AMT TO PA-753-REG-MKDN-AMT(PA-SUB) 22620011
224100             END-IF                                               22630011
224200         END-IF                                                   22640011
224300                                                                  22650011
224400     ELSE                                                         22660011
224500         IF  EPITM-LIV-RSLU-CDE = '+'                             22670011
224600             IF  EPLID-LID-AMT IS NEGATIVE                        22680011
224700                 ADD +1            TO PA-753-BO-MKDN-QTY(PA-SUB)  22690011
224800                 ADD EPLID-LID-AMT TO PA-753-BO-MKDN-AMT(PA-SUB)  22700011
224900             ELSE                                                 22710011
225000                 ADD +1            TO PA-753-BO-MDC-QTY(PA-SUB)   22720011
225100                 ADD EPLID-LID-AMT TO PA-753-BO-MDC-AMT(PA-SUB)   22730011
225200             END-IF                                               22740011
225300         END-IF                                                   22750011
225400                                                                  22760011
225500         IF  EPITM-LIV-RSLU-CDE = '-'                             22770011
225600             IF  EPLID-LID-AMT IS NEGATIVE                        22780011
225700                 ADD +1            TO PA-753-BO-MDC-QTY(PA-SUB)   22790011
225800                 ADD EPLID-LID-AMT TO PA-753-BO-MDC-AMT(PA-SUB)   22800011
225900             ELSE                                                 22810011
226000                 ADD +1            TO PA-753-BO-MKDN-QTY(PA-SUB)  22820011
226100                 ADD EPLID-LID-AMT TO PA-753-BO-MKDN-AMT(PA-SUB)  22830011
226200             END-IF                                               22840011
226300         END-IF                                                   22850011
226400     END-IF.                                                      22860011
226500                                                                  22870011
226600                                                                  22880011
226700******************************************************************22890011
226800* PROCESS BOGO ITEMS                                              22900011
226900******************************************************************22910011
227000 J1013-BOGO-LID.                                                  22920011
227100                                                                  22930011
227200     IF  EPITM-LIV-RSLU-CDE = '+'                                 22940011
227300         IF  EPLID-LID-AMT IS NEGATIVE                            22950011
227400             ADD +1            TO PA-775-REG-MKDN-QTY(PA-SUB)     22960011
227500             ADD EPLID-LID-AMT TO PA-775-REG-MKDN-AMT(PA-SUB)     22970011
227600         ELSE                                                     22980011
227700             ADD +1            TO PA-775-REG-MDC-QTY(PA-SUB)      22990011
227800             ADD EPLID-LID-AMT TO PA-775-REG-MDC-AMT(PA-SUB)      23000011
227900         END-IF                                                   23010011
228000     END-IF.                                                      23020011
228100                                                                  23030011
228200     IF  EPITM-LIV-RSLU-CDE = '-'                                 23040011
228300         IF  EPLID-LID-AMT IS NEGATIVE                            23050011
228400             ADD +1            TO PA-775-REG-MDC-QTY(PA-SUB)      23060011
228500             ADD EPLID-LID-AMT TO PA-775-REG-MDC-AMT(PA-SUB)      23070011
228600         ELSE                                                     23080011
228700             ADD +1            TO PA-775-REG-MKDN-QTY(PA-SUB)     23090011
228800             ADD EPLID-LID-AMT TO PA-775-REG-MKDN-AMT(PA-SUB)     23100011
228900         END-IF                                                   23110011
229000     END-IF.                                                      23120011
229100                                                                  23130011
229200                                                                  23140011
229300******************************************************************23150011
229400* PROCESS BOGO II ITEMS                                           23160011
229500******************************************************************23170011
229600 J1014-BOGO2-LID.                                                 23180011
229700                                                                  23190011
229800     IF  EPITM-LIV-RSLU-CDE = '+'                                 23200011
229900         IF  EPLID-LID-AMT IS NEGATIVE                            23210011
230000             ADD +1            TO PA-777-REG-MKDN-QTY(PA-SUB)     23220011
230100             ADD EPLID-LID-AMT TO PA-777-REG-MKDN-AMT(PA-SUB)     23230011
230200         ELSE                                                     23240011
230300             ADD +1            TO PA-777-REG-MDC-QTY(PA-SUB)      23250011
230400             ADD EPLID-LID-AMT TO PA-777-REG-MDC-AMT(PA-SUB)      23260011
230500         END-IF                                                   23270011
230600     END-IF.                                                      23280011
230700                                                                  23290011
230800     IF  EPITM-LIV-RSLU-CDE = '-'                                 23300011
230900         IF  EPLID-LID-AMT IS NEGATIVE                            23310011
231000             ADD +1            TO PA-777-REG-MDC-QTY(PA-SUB)      23320011
231100             ADD EPLID-LID-AMT TO PA-777-REG-MDC-AMT(PA-SUB)      23330011
231200         ELSE                                                     23340011
231300             ADD +1            TO PA-777-REG-MKDN-QTY(PA-SUB)     23350011
231400             ADD EPLID-LID-AMT TO PA-777-REG-MKDN-AMT(PA-SUB)     23360011
231500         END-IF                                                   23370011
231600     END-IF.                                                      23380011
231700                                                                  23390011
231800                                                                  23400011
231900******************************************************************23410011
232000* PROCESS UNEARNED REWARD ITEMS                                   23420011
232100******************************************************************23430011
232200 J1015-UNEARNED-RWDS-LID.                                         23440011
232300                                                                  23450011
232400     IF  EPITM-LIV-RSLU-CDE = '+'                                 23460011
232500         IF  EPLID-LID-AMT IS NEGATIVE                            23470011
232600             ADD +1            TO PA-780-REG-MKDN-QTY(PA-SUB)     23480011
232700             ADD EPLID-LID-AMT TO PA-780-REG-MKDN-AMT(PA-SUB)     23490011
232800         ELSE                                                     23500011
232900             ADD +1            TO PA-780-REG-MDC-QTY(PA-SUB)      23510011
233000             ADD EPLID-LID-AMT TO PA-780-REG-MDC-AMT(PA-SUB)      23520011
233100         END-IF                                                   23530011
233200     END-IF.                                                      23540011
233300                                                                  23550011
233400     IF  EPITM-LIV-RSLU-CDE = '-'                                 23560011
233500         IF  EPLID-LID-AMT IS NEGATIVE                            23570011
233600             ADD +1            TO PA-780-REG-MDC-QTY(PA-SUB)      23580011
233700             ADD EPLID-LID-AMT TO PA-780-REG-MDC-AMT(PA-SUB)      23590011
233800         ELSE                                                     23600011
233900             ADD +1            TO PA-780-REG-MKDN-QTY(PA-SUB)     23610011
234000             ADD EPLID-LID-AMT TO PA-780-REG-MKDN-AMT(PA-SUB)     23620011
234100         END-IF                                                   23630011
234200     END-IF.                                                      23640011
234300                                                                  23650011
234400******************************************************************23660011
234500* PROCESS OFFERS SIMPLE COUPONS                                   23670011
234600******************************************************************23680011
234700 J1016-OFFER-SIMPLE-COUPON.                                       23690011
234800                                                                  23700011
234900     IF  EPITM-LIV-RSLU-CDE = '+'                                 23710011
235000         IF  EPLID-LID-AMT IS NEGATIVE                            23720011
235100             ADD +1            TO PA-760-REG-MKDN-QTY(PA-SUB)     23730011
235200             ADD EPLID-LID-AMT TO PA-760-REG-MKDN-AMT(PA-SUB)     23740011
235300         ELSE                                                     23750011
235400             ADD +1            TO PA-760-REG-MDC-QTY(PA-SUB)      23760011
235500             ADD EPLID-LID-AMT TO PA-760-REG-MDC-AMT(PA-SUB)      23770011
235600         END-IF                                                   23780011
235700     END-IF.                                                      23790011
235800                                                                  23800011
235900     IF  EPITM-LIV-RSLU-CDE = '-'                                 23810011
236000         IF  EPLID-LID-AMT IS NEGATIVE                            23820011
236100             ADD +1            TO PA-760-REG-MDC-QTY(PA-SUB)      23830011
236200             ADD EPLID-LID-AMT TO PA-760-REG-MDC-AMT(PA-SUB)      23840011
236300         ELSE                                                     23850011
236400             ADD +1            TO PA-760-REG-MKDN-QTY(PA-SUB)     23860011
236500             ADD EPLID-LID-AMT TO PA-760-REG-MKDN-AMT(PA-SUB)     23870011
236600         END-IF                                                   23880011
236700     END-IF.                                                      23890011
236800                                                                  23900011
236900******************************************************************23910011
237000* PROCESS OFFERS TLD TIERED                                       23920011
237100******************************************************************23930011
237200 J1017-OFFER-TLD-TIERED.                                          23940011
237300                                                                  23950011
237400     IF  EPITM-LIV-RSLU-CDE = '+'                                 23960011
237500         IF  EPLID-LID-AMT IS NEGATIVE                            23970011
237600             ADD +1            TO PA-761-REG-MKDN-QTY(PA-SUB)     23980011
237700             ADD EPLID-LID-AMT TO PA-761-REG-MKDN-AMT(PA-SUB)     23990011
237800         ELSE                                                     24000011
237900             ADD +1            TO PA-761-REG-MDC-QTY(PA-SUB)      24010011
238000             ADD EPLID-LID-AMT TO PA-761-REG-MDC-AMT(PA-SUB)      24020011
238100         END-IF                                                   24030011
238200     END-IF.                                                      24040011
238300                                                                  24050011
238400     IF  EPITM-LIV-RSLU-CDE = '-'                                 24060011
238500         IF  EPLID-LID-AMT IS NEGATIVE                            24070011
238600             ADD +1            TO PA-761-REG-MDC-QTY(PA-SUB)      24080011
238700             ADD EPLID-LID-AMT TO PA-761-REG-MDC-AMT(PA-SUB)      24090011
238800         ELSE                                                     24100011
238900             ADD +1            TO PA-761-REG-MKDN-QTY(PA-SUB)     24110011
239000             ADD EPLID-LID-AMT TO PA-761-REG-MKDN-AMT(PA-SUB)     24120011
239100         END-IF                                                   24130011
239200     END-IF.                                                      24140011
239300                                                                  24150011
239400******************************************************************24160011
239500* PROCESS OFFERS LID TIERED                                       24170011
239600******************************************************************24180011
239700 J1018-OFFER-LID-TIERED.                                          24190011
239800                                                                  24200011
239900     IF  EPITM-LIV-RSLU-CDE = '+'                                 24210011
240000         IF  EPLID-LID-AMT IS NEGATIVE                            24220011
240100             ADD +1            TO PA-762-REG-MKDN-QTY(PA-SUB)     24230011
240200             ADD EPLID-LID-AMT TO PA-762-REG-MKDN-AMT(PA-SUB)     24240011
240300         ELSE                                                     24250011
240400             ADD +1            TO PA-762-REG-MDC-QTY(PA-SUB)      24260011
240500             ADD EPLID-LID-AMT TO PA-762-REG-MDC-AMT(PA-SUB)      24270011
240600         END-IF                                                   24280011
240700     END-IF.                                                      24290011
240800                                                                  24300011
240900     IF  EPITM-LIV-RSLU-CDE = '-'                                 24310011
241000         IF  EPLID-LID-AMT IS NEGATIVE                            24320011
241100             ADD +1            TO PA-762-REG-MDC-QTY(PA-SUB)      24330011
241200             ADD EPLID-LID-AMT TO PA-762-REG-MDC-AMT(PA-SUB)      24340011
241300         ELSE                                                     24350011
241400             ADD +1            TO PA-762-REG-MKDN-QTY(PA-SUB)     24360011
241500             ADD EPLID-LID-AMT TO PA-762-REG-MKDN-AMT(PA-SUB)     24370011
241600         END-IF                                                   24380011
241700     END-IF.                                                      24390011
241800                                                                  24400011
241900******************************************************************24410011
242000* PROCESS OFFERS GWP PWP PRORATED                                 24420011
242100******************************************************************24430011
242200 J1019-OFFER-GWP-PWP.                                             24440011
242300                                                                  24450011
242400     IF  EPITM-LIV-RSLU-CDE = '+'                                 24460011
242500         IF  EPLID-LID-AMT IS NEGATIVE                            24470011
242600             ADD +1            TO PA-763-REG-MKDN-QTY(PA-SUB)     24480011
242700             ADD EPLID-LID-AMT TO PA-763-REG-MKDN-AMT(PA-SUB)     24490011
242800         ELSE                                                     24500011
242900             ADD +1            TO PA-763-REG-MDC-QTY(PA-SUB)      24510011
243000             ADD EPLID-LID-AMT TO PA-763-REG-MDC-AMT(PA-SUB)      24520011
243100         END-IF                                                   24530011
243200     END-IF.                                                      24540011
243300                                                                  24550011
243400     IF  EPITM-LIV-RSLU-CDE = '-'                                 24560011
243500         IF  EPLID-LID-AMT IS NEGATIVE                            24570011
243600             ADD +1            TO PA-763-REG-MDC-QTY(PA-SUB)      24580011
243700             ADD EPLID-LID-AMT TO PA-763-REG-MDC-AMT(PA-SUB)      24590011
243800         ELSE                                                     24600011
243900             ADD +1            TO PA-763-REG-MKDN-QTY(PA-SUB)     24610011
244000             ADD EPLID-LID-AMT TO PA-763-REG-MKDN-AMT(PA-SUB)     24620011
244100         END-IF                                                   24630011
244200     END-IF.                                                      24640011
244300                                                                  24650027
244400******************************************************************24660027
244500* PROCESS KOHLS CASH GIFT RECEIPTED RETURNS                       24670027
244600******************************************************************24680027
244700 J1020-KC-GIFT-RCPT-UNEARNED.                                     24690027
244800                                                                  24700027
244900     IF  EPITM-LIV-RSLU-CDE = '+'                                 24710027
245000         IF  EPLID-LID-AMT IS NEGATIVE                            24720027
245100             ADD +1            TO PA-765-REG-MKDN-QTY(PA-SUB)     24730027
245200             ADD EPLID-LID-AMT TO PA-765-REG-MKDN-AMT(PA-SUB)     24740027
245300         ELSE                                                     24750027
245400             ADD +1            TO PA-765-REG-MDC-QTY(PA-SUB)      24760027
245500             ADD EPLID-LID-AMT TO PA-765-REG-MDC-AMT(PA-SUB)      24770027
245600         END-IF                                                   24780027
245700     END-IF.                                                      24790027
245800                                                                  24800027
245900     IF  EPITM-LIV-RSLU-CDE = '-'                                 24810027
246000         IF  EPLID-LID-AMT IS NEGATIVE                            24820027
246100             ADD +1            TO PA-765-REG-MDC-QTY(PA-SUB)      24830027
246200             ADD EPLID-LID-AMT TO PA-765-REG-MDC-AMT(PA-SUB)      24840027
246300         ELSE                                                     24850027
246400             ADD +1            TO PA-765-REG-MKDN-QTY(PA-SUB)     24860027
246500             ADD EPLID-LID-AMT TO PA-765-REG-MKDN-AMT(PA-SUB)     24870027
246600         END-IF                                                   24880027
246700     END-IF.                                                      24890027
246800                                                                  24900027
246900                                                                  24910049
205464******************************************************************24920089
205464* PROCESS NON-RECEIPTED RETURNS                                   24930089
205464******************************************************************24940089
205464 J1021-NON-RECEIPT-RTN.                                           24950089
205464                                                                  24960089
205464     IF  EPITM-LIV-RSLU-CDE = '+'                                 24970089
205464         IF  EPLID-LID-AMT IS NEGATIVE                            24980089
205464             ADD +1            TO PA-710-REG-MKDN-QTY(PA-SUB)     24990089
205464             ADD EPLID-LID-AMT TO PA-710-REG-MKDN-AMT(PA-SUB)     25000089
205464         ELSE                                                     25010089
205464             ADD +1            TO PA-710-REG-MDC-QTY(PA-SUB)      25020089
205464             ADD EPLID-LID-AMT TO PA-710-REG-MDC-AMT(PA-SUB)      25030089
205464         END-IF                                                   25040089
205464     END-IF.                                                      25050089
205464                                                                  25060089
205464     IF  EPITM-LIV-RSLU-CDE = '-'                                 25070089
205464         IF  EPLID-LID-AMT IS NEGATIVE                            25080089
205464             ADD +1            TO PA-710-REG-MDC-QTY(PA-SUB)      25090089
205464             ADD EPLID-LID-AMT TO PA-710-REG-MDC-AMT(PA-SUB)      25100089
205464         ELSE                                                     25110089
205464             ADD +1            TO PA-710-REG-MKDN-QTY(PA-SUB)     25120089
205464             ADD EPLID-LID-AMT TO PA-710-REG-MKDN-AMT(PA-SUB)     25130089
205464         END-IF                                                   25140089
205464     END-IF.                                                      25150089
205464                                                                  25160089
205464                                                                  25170089
247000******************************************************************25180011
247100* PROCESS THE REPORT                                              25190011
247200******************************************************************25200011
247300 K1000-PROCESS-REPT.                                              25210011
247400                                                                  25220011
247500     PERFORM K2000-PRINT-RPT                                      25230011
247600         VARYING PA-SUB FROM 1 BY 1                               25240011
247700             UNTIL PA-SUB GREATER THAN 3.                         25250011
247800                                                                  25260011
247900                                                                  25270011
248000******************************************************************25280011
248100* PRINT DETAIL LINES OF THE REPORT                                25290011
248200******************************************************************25300011
248300 K2000-PRINT-RPT.                                                 25310011
248400                                                                  25320011
248500     PERFORM K3000-DESC-HDR.                                      25330011
248600                                                                  25340011
248700     PERFORM K4100-SIGNING-ERR.                                   25350011
248800     PERFORM K4200-PLU-ERR.                                       25360011
248900     PERFORM K4300-DAMAGED-MDSE.                                  25370011
249000     PERFORM K4400-GIFT-WITH-PURCH.                               25380011
249100     PERFORM K4500-OPERATOR-MKDN.                                 25390011
249200     PERFORM K4600-RAINCHECK.                                     25400011
249300     PERFORM K4700-COMPETITIVE.                                   25410065
249400     PERFORM K4800-SPECIAL-PROMO.                                 25420011
249500     PERFORM K4900-YES-WE-CAN.                                    25430011
249600                                                                  25440011
249700     PERFORM T1000-SUB-TOTALS.                                    25450011
249800                                                                  25460011
205464     PERFORM K4960-NON-RECEIPT-RETURN.                            25470089
249900     PERFORM K5000-SENIOR-DISC.                                   25480011
250000     PERFORM K5100-KOHLS-COUPON.                                  25490011
250100     PERFORM K5200-GOLDSTAR.                                      25500032
250200     PERFORM K5110-760-OFFER-SIMPLE-COUPON.                       25510011
250300     PERFORM K5120-761-OFFER-TLD-TIERED.                          25520011
250400     PERFORM K5130-762-OFFER-LID-TIERED.                          25530011
250500     PERFORM K5140-763-OFFER-GWP-PWP.                             25540011
250600     PERFORM K4950-KC-GIFT-RCPT-UNEARNED.                         25550032
250700     PERFORM K5300-BOGO.                                          25560011
250800     PERFORM K5400-BOGO2.                                         25570011
250900     PERFORM K5500-UNEARNED.                                      25580011
251000     PERFORM K5600-EMPLY-DISC.                                    25590011
251100                                                                  25600011
251200     PERFORM T2000-TOTALS.                                        25610011
251300                                                                  25620011
251400                                                                  25630011
251500******************************************************************25640011
251600* PRINT DETAIL LINES OF THE REPORT                                25650011
251700******************************************************************25660011
251800 K3000-DESC-HDR.                                                  25670011
251900                                                                  25680011
252000     PERFORM P1000-HEADERS.                                       25690011
252100                                                                  25700011
252200     EVALUATE PA-SUB                                              25710011
252300         WHEN 1                                                   25720011
252400             SET HD-ORIGINAL-SALES    TO TRUE                     25730011
252500             INITIALIZE PA-TOTALS                                 25740011
252600         WHEN 2                                                   25750011
252700             SET HD-SALES-CORR        TO TRUE                     25760011
252800             INITIALIZE PA-TOTALS                                 25770011
252900         WHEN 3                                                   25780011
253000             SET HD-LATE-TRANSACTIONS TO TRUE                     25790011
253100             INITIALIZE PA-TOTALS                                 25800011
253200     END-EVALUATE.                                                25810011
253300                                                                  25820011
253400     WRITE RPT-REC FROM HL-HDR5 AFTER 1.                          25830011
253500                                                                  25840011
253600     ADD 2 TO PV-LINE-COUNT.                                      25850011
253700                                                                  25860011
253800                                                                  25870011
253900******************************************************************25880011
254000* WRITE SIGNING ERROR INFO                                        25890011
254100******************************************************************25900011
254200 K4100-SIGNING-ERR.                                               25910011
254300                                                                  25920011
254400     PERFORM K4101-CHECK-MDC-SIGN.                                25930011
254500                                                                  25940011
254600     PERFORM K4102-PRINT-REGISTER.                                25950011
254700     PERFORM K4103-PRINT-BACK-OFFICE.                             25960011
254800     PERFORM K4104-PRINT-NET.                                     25970011
254900                                                                  25980011
255000     PERFORM K7000-ACCUM-SUB-TOTALS.                              25990011
255100     PERFORM K8000-ACCUM-TOTALS.                                  26000011
255200                                                                  26010011
255300     PERFORM P3000-DETAIL-SPACE.                                  26020011
255400                                                                  26030011
255500                                                                  26040011
255600******************************************************************26050011
255700* CHECK MARKDOWN CANCEL SIGN - SHOULD ALWAYS BE NEGATIVE          26060011
255800******************************************************************26070011
255900 K4101-CHECK-MDC-SIGN.                                            26080011
256000                                                                  26090011
256100     IF  PA-701-REG-MDC-AMT(PA-SUB) = ZERO                        26100011
256200     OR  PA-701-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   26110011
256300         CONTINUE                                                 26120011
256400     ELSE                                                         26130011
256500         COMPUTE PA-701-REG-MDC-AMT(PA-SUB) =                     26140011
256600                 PA-701-REG-MDC-AMT(PA-SUB) * (-1)                26150011
256700     END-IF.                                                      26160011
256800                                                                  26170011
256900     IF  PA-701-BO-MDC-AMT(PA-SUB) = ZERO                         26180011
257000     OR  PA-701-BO-MDC-AMT(PA-SUB) IS NEGATIVE                    26190011
257100         CONTINUE                                                 26200011
257200     ELSE                                                         26210011
257300         COMPUTE PA-701-BO-MDC-AMT(PA-SUB) =                      26220011
257400                 PA-701-BO-MDC-AMT(PA-SUB) * (-1)                 26230011
257500     END-IF.                                                      26240011
257600                                                                  26250011
257700                                                                  26260011
257800******************************************************************26270011
257900* PRINT REGISTER GENERATED INFO                                   26280011
258000******************************************************************26290011
258100 K4102-PRINT-REGISTER.                                            26300011
258200                                                                  26310011
258300     MOVE '701'                       TO DL-RSN-CDE.              26320011
258400     MOVE DD-SIGNING-ERR-REG          TO DL-PRICE-CHANGE-TYPE.    26330011
258500                                                                  26340011
258600     MOVE PA-701-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         26350011
258700     MOVE PA-701-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         26360011
258800     MOVE PA-701-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              26370011
258900     MOVE PA-701-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              26380011
259000                                                                  26390011
259100     PERFORM P2000-DETAIL-LINE.                                   26400011
259200                                                                  26410011
259300                                                                  26420011
259400******************************************************************26430011
259500* PRINT BACK OFFICE GENERATED INFO                                26440011
259600******************************************************************26450011
259700 K4103-PRINT-BACK-OFFICE.                                         26460011
259800                                                                  26470011
259900     MOVE SPACES                      TO DL-RSN-CDE.              26480011
260000     MOVE DD-SIGNING-ERR-BO           TO DL-PRICE-CHANGE-TYPE.    26490011
260100                                                                  26500011
260200     MOVE PA-701-BO-MKDN-QTY(PA-SUB)  TO DL-MARKDOWN-QTY.         26510011
260300     MOVE PA-701-BO-MKDN-AMT(PA-SUB)  TO DL-MARKDOWN-AMT.         26520011
260400     MOVE PA-701-BO-MDC-QTY(PA-SUB)   TO DL-MDC-QTY.              26530011
260500     MOVE PA-701-BO-MDC-AMT(PA-SUB)   TO DL-MDC-AMT.              26540011
260600                                                                  26550011
260700     PERFORM P2000-DETAIL-LINE.                                   26560011
260800                                                                  26570011
260900                                                                  26580011
261000******************************************************************26590011
261100* PRINT NET RESULTS INFO                                          26600011
261200******************************************************************26610011
261300 K4104-PRINT-NET.                                                 26620011
261400                                                                  26630011
261500     MOVE DD-SIGNING-ERR-NET TO DL-PRICE-CHANGE-TYPE.             26640011
261600                                                                  26650011
261700     ADD PA-701-BO-MKDN-QTY(PA-SUB)                               26660011
261800         PA-701-REG-MKDN-QTY(PA-SUB) GIVING PA-NET-MKDN-QTY.      26670011
261900     ADD PA-701-BO-MKDN-AMT(PA-SUB)                               26680011
262000         PA-701-REG-MKDN-AMT(PA-SUB) GIVING PA-NET-MKDN-AMT.      26690011
262100     ADD PA-701-BO-MDC-QTY(PA-SUB)                                26700011
262200         PA-701-REG-MDC-QTY(PA-SUB)  GIVING PA-NET-MDC-QTY.       26710011
262300     ADD PA-701-BO-MDC-AMT(PA-SUB)                                26720011
262400         PA-701-REG-MDC-AMT(PA-SUB)  GIVING PA-NET-MDC-AMT.       26730011
262500                                                                  26740011
262600     MOVE PA-NET-MKDN-QTY TO DL-MARKDOWN-QTY.                     26750011
262700     MOVE PA-NET-MKDN-AMT TO DL-MARKDOWN-AMT.                     26760011
262800     MOVE PA-NET-MDC-QTY  TO DL-MDC-QTY.                          26770011
262900     MOVE PA-NET-MDC-AMT  TO DL-MDC-AMT.                          26780011
263000                                                                  26790011
263100     PERFORM P2000-DETAIL-LINE.                                   26800011
263200                                                                  26810011
263300                                                                  26820011
263400******************************************************************26830011
263500* WRITE PLU ERROR INFO                                            26840011
263600******************************************************************26850011
263700 K4200-PLU-ERR.                                                   26860011
263800                                                                  26870011
263900     PERFORM K4201-CHECK-MDC-SIGN.                                26880011
264000                                                                  26890011
264100     PERFORM K4202-PRINT-REGISTER.                                26900011
264200     PERFORM K4203-PRINT-BACK-OFFICE.                             26910011
264300     PERFORM K4204-PRINT-NET.                                     26920011
264400                                                                  26930011
264500     PERFORM K7000-ACCUM-SUB-TOTALS.                              26940011
264600     PERFORM K8000-ACCUM-TOTALS.                                  26950011
264700                                                                  26960011
264800     PERFORM P3000-DETAIL-SPACE.                                  26970011
264900                                                                  26980011
265000                                                                  26990011
265100******************************************************************27000011
265200* CHECK MARKDOWN CANCEL SIGN - SHOULD ALWAYS BE NEGATIVE          27010011
265300******************************************************************27020011
265400 K4201-CHECK-MDC-SIGN.                                            27030011
265500                                                                  27040011
265600     IF  PA-702-REG-MDC-AMT(PA-SUB) = ZERO                        27050011
265700     OR  PA-702-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   27060011
265800         CONTINUE                                                 27070011
265900     ELSE                                                         27080011
266000         COMPUTE PA-702-REG-MDC-AMT(PA-SUB) =                     27090011
266100                 PA-702-REG-MDC-AMT(PA-SUB) * (-1)                27100011
266200     END-IF.                                                      27110011
266300                                                                  27120011
266400     IF  PA-702-BO-MDC-AMT(PA-SUB) = ZERO                         27130011
266500     OR  PA-702-BO-MDC-AMT(PA-SUB) IS NEGATIVE                    27140011
266600         CONTINUE                                                 27150011
266700     ELSE                                                         27160011
266800         COMPUTE PA-702-BO-MDC-AMT(PA-SUB) =                      27170011
266900                 PA-702-BO-MDC-AMT(PA-SUB) * (-1)                 27180011
267000     END-IF.                                                      27190011
267100                                                                  27200011
267200                                                                  27210011
267300******************************************************************27220011
267400* PRINT REGISTER GENERATED INFO                                   27230011
267500******************************************************************27240011
267600 K4202-PRINT-REGISTER.                                            27250011
267700                                                                  27260011
267800     MOVE '702'                       TO DL-RSN-CDE.              27270011
267900     MOVE DD-PLU-ERR-REG              TO DL-PRICE-CHANGE-TYPE.    27280011
268000                                                                  27290011
268100     MOVE PA-702-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         27300011
268200     MOVE PA-702-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         27310011
268300     MOVE PA-702-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              27320011
268400     MOVE PA-702-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              27330011
268500                                                                  27340011
268600     PERFORM P2000-DETAIL-LINE.                                   27350011
268700                                                                  27360011
268800                                                                  27370011
268900******************************************************************27380011
269000* PRINT BACK OFFICE GENERATED INFO                                27390011
269100******************************************************************27400011
269200 K4203-PRINT-BACK-OFFICE.                                         27410011
269300                                                                  27420011
269400     MOVE SPACES                      TO DL-RSN-CDE.              27430011
269500     MOVE DD-PLU-ERR-BO               TO DL-PRICE-CHANGE-TYPE.    27440011
269600                                                                  27450011
269700     MOVE PA-702-BO-MKDN-QTY(PA-SUB)  TO DL-MARKDOWN-QTY.         27460011
269800     MOVE PA-702-BO-MKDN-AMT(PA-SUB)  TO DL-MARKDOWN-AMT.         27470011
269900     MOVE PA-702-BO-MDC-QTY(PA-SUB)   TO DL-MDC-QTY.              27480011
270000     MOVE PA-702-BO-MDC-AMT(PA-SUB)   TO DL-MDC-AMT.              27490011
270100                                                                  27500011
270200     PERFORM P2000-DETAIL-LINE.                                   27510011
270300                                                                  27520011
270400                                                                  27530011
270500******************************************************************27540011
270600* PRINT NET RESULTS INFO                                          27550011
270700******************************************************************27560011
270800 K4204-PRINT-NET.                                                 27570011
270900                                                                  27580011
271000     MOVE DD-PLU-ERR-NET TO DL-PRICE-CHANGE-TYPE.                 27590011
271100                                                                  27600011
271200     ADD PA-702-BO-MKDN-QTY(PA-SUB)                               27610011
271300         PA-702-REG-MKDN-QTY(PA-SUB) GIVING PA-NET-MKDN-QTY.      27620011
271400     ADD PA-702-BO-MKDN-AMT(PA-SUB)                               27630011
271500         PA-702-REG-MKDN-AMT(PA-SUB) GIVING PA-NET-MKDN-AMT.      27640011
271600     ADD PA-702-BO-MDC-QTY(PA-SUB)                                27650011
271700         PA-702-REG-MDC-QTY(PA-SUB)  GIVING PA-NET-MDC-QTY.       27660011
271800     ADD PA-702-BO-MDC-AMT(PA-SUB)                                27670011
271900         PA-702-REG-MDC-AMT(PA-SUB)  GIVING PA-NET-MDC-AMT.       27680011
272000                                                                  27690011
272100     MOVE PA-NET-MKDN-QTY TO DL-MARKDOWN-QTY.                     27700011
272200     MOVE PA-NET-MKDN-AMT TO DL-MARKDOWN-AMT.                     27710011
272300     MOVE PA-NET-MDC-QTY  TO DL-MDC-QTY.                          27720011
272400     MOVE PA-NET-MDC-AMT  TO DL-MDC-AMT.                          27730011
272500                                                                  27740011
272600     PERFORM P2000-DETAIL-LINE.                                   27750011
272700                                                                  27760011
272800                                                                  27770011
272900******************************************************************27780011
273000* WRITE DAMAGED MERCHANDISE INFO                                  27790011
273100******************************************************************27800011
273200 K4300-DAMAGED-MDSE.                                              27810011
273300                                                                  27820011
273400     PERFORM K4301-CHECK-MDC-SIGN.                                27830011
273500                                                                  27840011
273600     PERFORM K4302-PRINT-REGISTER.                                27850011
273700     PERFORM K4303-PRINT-BACK-OFFICE.                             27860011
273800     PERFORM K4304-PRINT-NET.                                     27870011
273900                                                                  27880011
274000     PERFORM K7000-ACCUM-SUB-TOTALS.                              27890011
274100     PERFORM K8000-ACCUM-TOTALS.                                  27900011
274200                                                                  27910011
274300     PERFORM P3000-DETAIL-SPACE.                                  27920011
274400                                                                  27930011
274500                                                                  27940011
274600******************************************************************27950011
274700* CHECK MARKDOWN CANCEL SIGN - SHOULD ALWAYS BE NEGATIVE          27960011
274800******************************************************************27970011
274900 K4301-CHECK-MDC-SIGN.                                            27980011
275000                                                                  27990011
275100     IF  PA-703-REG-MDC-AMT(PA-SUB) = ZERO                        28000011
275200     OR  PA-703-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   28010011
275300         CONTINUE                                                 28020011
275400     ELSE                                                         28030011
275500         COMPUTE PA-703-REG-MDC-AMT(PA-SUB) =                     28040011
275600                 PA-703-REG-MDC-AMT(PA-SUB) * (-1)                28050011
275700     END-IF.                                                      28060011
275800                                                                  28070011
275900     IF  PA-703-BO-MDC-AMT(PA-SUB) = ZERO                         28080011
276000     OR  PA-703-BO-MDC-AMT(PA-SUB) IS NEGATIVE                    28090011
276100         CONTINUE                                                 28100011
276200     ELSE                                                         28110011
276300         COMPUTE PA-703-BO-MDC-AMT(PA-SUB) =                      28120011
276400                 PA-703-BO-MDC-AMT(PA-SUB) * (-1)                 28130011
276500     END-IF.                                                      28140011
276600                                                                  28150011
276700                                                                  28160011
276800******************************************************************28170011
276900* PRINT REGISTER GENERATED INFO                                   28180011
277000******************************************************************28190011
277100 K4302-PRINT-REGISTER.                                            28200011
277200                                                                  28210011
277300     MOVE '703'                       TO DL-RSN-CDE.              28220011
277400     MOVE DD-DAMAGED-REG              TO DL-PRICE-CHANGE-TYPE.    28230011
277500                                                                  28240011
277600     MOVE PA-703-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         28250011
277700     MOVE PA-703-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         28260011
277800     MOVE PA-703-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              28270011
277900     MOVE PA-703-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              28280011
278000                                                                  28290011
278100     PERFORM P2000-DETAIL-LINE.                                   28300011
278200                                                                  28310011
278300                                                                  28320011
278400******************************************************************28330011
278500* PRINT BACK OFFICE GENERATED INFO                                28340011
278600******************************************************************28350011
278700 K4303-PRINT-BACK-OFFICE.                                         28360011
278800                                                                  28370011
278900     MOVE SPACES                      TO DL-RSN-CDE.              28380011
279000     MOVE DD-DAMAGED-BO               TO DL-PRICE-CHANGE-TYPE.    28390011
279100                                                                  28400011
279200     MOVE PA-703-BO-MKDN-QTY(PA-SUB)  TO DL-MARKDOWN-QTY.         28410011
279300     MOVE PA-703-BO-MKDN-AMT(PA-SUB)  TO DL-MARKDOWN-AMT.         28420011
279400     MOVE PA-703-BO-MDC-QTY(PA-SUB)   TO DL-MDC-QTY.              28430011
279500     MOVE PA-703-BO-MDC-AMT(PA-SUB)   TO DL-MDC-AMT.              28440011
279600                                                                  28450011
279700     PERFORM P2000-DETAIL-LINE.                                   28460011
279800                                                                  28470011
279900                                                                  28480011
280000******************************************************************28490011
280100* PRINT NET RESULTS INFO                                          28500011
280200******************************************************************28510011
280300 K4304-PRINT-NET.                                                 28520011
280400                                                                  28530011
280500     MOVE DD-DAMAGED-NET TO DL-PRICE-CHANGE-TYPE.                 28540011
280600                                                                  28550011
280700     ADD PA-703-BO-MKDN-QTY(PA-SUB)                               28560011
280800         PA-703-REG-MKDN-QTY(PA-SUB) GIVING PA-NET-MKDN-QTY.      28570011
280900     ADD PA-703-BO-MKDN-AMT(PA-SUB)                               28580011
281000         PA-703-REG-MKDN-AMT(PA-SUB) GIVING PA-NET-MKDN-AMT.      28590011
281100     ADD PA-703-BO-MDC-QTY(PA-SUB)                                28600011
281200         PA-703-REG-MDC-QTY(PA-SUB)  GIVING PA-NET-MDC-QTY.       28610011
281300     ADD PA-703-BO-MDC-AMT(PA-SUB)                                28620011
281400         PA-703-REG-MDC-AMT(PA-SUB)  GIVING PA-NET-MDC-AMT.       28630011
281500                                                                  28640011
281600     MOVE PA-NET-MKDN-QTY TO DL-MARKDOWN-QTY.                     28650011
281700     MOVE PA-NET-MKDN-AMT TO DL-MARKDOWN-AMT.                     28660011
281800     MOVE PA-NET-MDC-QTY  TO DL-MDC-QTY.                          28670011
281900     MOVE PA-NET-MDC-AMT  TO DL-MDC-AMT.                          28680011
282000                                                                  28690011
282100     PERFORM P2000-DETAIL-LINE.                                   28700011
282200                                                                  28710011
282300                                                                  28720011
282400******************************************************************28730011
282500* WRITE GIFT WITH PURCHASE INFO                                   28740011
282600******************************************************************28750011
282700 K4400-GIFT-WITH-PURCH.                                           28760011
282800                                                                  28770011
282900     PERFORM K4401-CHECK-MDC-SIGN.                                28780011
283000                                                                  28790011
283100     PERFORM K4402-PRINT-REGISTER.                                28800011
283200     PERFORM K4403-PRINT-BACK-OFFICE.                             28810011
283300     PERFORM K4404-PRINT-NET.                                     28820011
283400                                                                  28830011
283500     PERFORM K7000-ACCUM-SUB-TOTALS.                              28840011
283600     PERFORM K8000-ACCUM-TOTALS.                                  28850011
283700                                                                  28860011
283800     PERFORM P3000-DETAIL-SPACE.                                  28870011
283900                                                                  28880011
284000                                                                  28890011
284100******************************************************************28900011
284200* CHECK MARKDOWN CANCEL SIGN - SHOULD ALWAYS BE NEGATIVE          28910011
284300******************************************************************28920011
284400 K4401-CHECK-MDC-SIGN.                                            28930011
284500                                                                  28940011
284600     IF  PA-704-REG-MDC-AMT(PA-SUB) = ZERO                        28950011
284700     OR  PA-704-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   28960011
284800         CONTINUE                                                 28970011
284900     ELSE                                                         28980011
285000         COMPUTE PA-704-REG-MDC-AMT(PA-SUB) =                     28990011
285100                 PA-704-REG-MDC-AMT(PA-SUB) * (-1)                29000011
285200     END-IF.                                                      29010011
285300                                                                  29020011
285400     IF  PA-704-BO-MDC-AMT(PA-SUB) = ZERO                         29030011
285500     OR  PA-704-BO-MDC-AMT(PA-SUB) IS NEGATIVE                    29040011
285600         CONTINUE                                                 29050011
285700     ELSE                                                         29060011
285800         COMPUTE PA-704-BO-MDC-AMT(PA-SUB) =                      29070011
285900                 PA-704-BO-MDC-AMT(PA-SUB) * (-1)                 29080011
286000     END-IF.                                                      29090011
286100                                                                  29100011
286200                                                                  29110011
286300******************************************************************29120011
286400* PRINT REGISTER GENERATED INFO                                   29130011
286500******************************************************************29140011
286600 K4402-PRINT-REGISTER.                                            29150011
286700                                                                  29160011
286800     MOVE '704'                       TO DL-RSN-CDE.              29170011
286900     MOVE DD-GIFT-REG                 TO DL-PRICE-CHANGE-TYPE.    29180011
287000                                                                  29190011
287100     MOVE PA-704-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         29200011
287200     MOVE PA-704-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         29210011
287300     MOVE PA-704-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              29220011
287400     MOVE PA-704-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              29230011
287500                                                                  29240011
287600     PERFORM P2000-DETAIL-LINE.                                   29250011
287700                                                                  29260011
287800                                                                  29270011
287900******************************************************************29280011
288000* PRINT BACK OFFICE GENERATED INFO                                29290011
288100******************************************************************29300011
288200 K4403-PRINT-BACK-OFFICE.                                         29310011
288300                                                                  29320011
288400     MOVE SPACES                      TO DL-RSN-CDE.              29330011
288500     MOVE DD-GIFT-BO                  TO DL-PRICE-CHANGE-TYPE.    29340011
288600                                                                  29350011
288700     MOVE PA-704-BO-MKDN-QTY(PA-SUB)  TO DL-MARKDOWN-QTY.         29360011
288800     MOVE PA-704-BO-MKDN-AMT(PA-SUB)  TO DL-MARKDOWN-AMT.         29370011
288900     MOVE PA-704-BO-MDC-QTY(PA-SUB)   TO DL-MDC-QTY.              29380011
289000     MOVE PA-704-BO-MDC-AMT(PA-SUB)   TO DL-MDC-AMT.              29390011
289100                                                                  29400011
289200     PERFORM P2000-DETAIL-LINE.                                   29410011
289300                                                                  29420011
289400                                                                  29430011
289500******************************************************************29440011
289600* PRINT NET RESULTS INFO                                          29450011
289700******************************************************************29460011
289800 K4404-PRINT-NET.                                                 29470011
289900                                                                  29480011
290000     MOVE DD-GIFT-NET TO DL-PRICE-CHANGE-TYPE.                    29490011
290100                                                                  29500011
290200     ADD PA-704-BO-MKDN-QTY(PA-SUB)                               29510011
290300         PA-704-REG-MKDN-QTY(PA-SUB) GIVING PA-NET-MKDN-QTY.      29520011
290400     ADD PA-704-BO-MKDN-AMT(PA-SUB)                               29530011
290500         PA-704-REG-MKDN-AMT(PA-SUB) GIVING PA-NET-MKDN-AMT.      29540011
290600     ADD PA-704-BO-MDC-QTY(PA-SUB)                                29550011
290700         PA-704-REG-MDC-QTY(PA-SUB)  GIVING PA-NET-MDC-QTY.       29560011
290800     ADD PA-704-BO-MDC-AMT(PA-SUB)                                29570011
290900         PA-704-REG-MDC-AMT(PA-SUB)  GIVING PA-NET-MDC-AMT.       29580011
291000                                                                  29590011
291100     MOVE PA-NET-MKDN-QTY TO DL-MARKDOWN-QTY.                     29600011
291200     MOVE PA-NET-MKDN-AMT TO DL-MARKDOWN-AMT.                     29610011
291300     MOVE PA-NET-MDC-QTY  TO DL-MDC-QTY.                          29620011
291400     MOVE PA-NET-MDC-AMT  TO DL-MDC-AMT.                          29630011
291500                                                                  29640011
291600     PERFORM P2000-DETAIL-LINE.                                   29650011
291700                                                                  29660011
291800                                                                  29670011
291900******************************************************************29680011
292000* WRITE OPERATOR MARKDOWN INFO                                    29690011
292100******************************************************************29700011
292200 K4500-OPERATOR-MKDN.                                             29710011
292300                                                                  29720011
292400     PERFORM K4501-CHECK-MDC-SIGN.                                29730011
292500                                                                  29740011
292600     PERFORM K4502-PRINT-REGISTER.                                29750011
292700     PERFORM K4503-PRINT-BACK-OFFICE.                             29760011
292800     PERFORM K4504-PRINT-NET.                                     29770011
292900                                                                  29780011
293000     PERFORM K7000-ACCUM-SUB-TOTALS.                              29790011
293100     PERFORM K8000-ACCUM-TOTALS.                                  29800011
293200                                                                  29810011
293300     PERFORM P3000-DETAIL-SPACE.                                  29820011
293400                                                                  29830011
293500                                                                  29840011
293600******************************************************************29850011
293700* CHECK MARKDOWN CANCEL SIGN - SHOULD ALWAYS BE NEGATIVE          29860011
293800******************************************************************29870011
293900 K4501-CHECK-MDC-SIGN.                                            29880011
294000                                                                  29890011
294100     IF  PA-705-REG-MDC-AMT(PA-SUB) = ZERO                        29900011
294200     OR  PA-705-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   29910011
294300         CONTINUE                                                 29920011
294400     ELSE                                                         29930011
294500         COMPUTE PA-705-REG-MDC-AMT(PA-SUB) =                     29940011
294600                 PA-705-REG-MDC-AMT(PA-SUB) * (-1)                29950011
294700     END-IF.                                                      29960011
294800                                                                  29970011
294900     IF  PA-705-BO-MDC-AMT(PA-SUB) = ZERO                         29980011
295000     OR  PA-705-BO-MDC-AMT(PA-SUB) IS NEGATIVE                    29990011
295100         CONTINUE                                                 30000011
295200     ELSE                                                         30010011
295300         COMPUTE PA-705-BO-MDC-AMT(PA-SUB) =                      30020011
295400                 PA-705-BO-MDC-AMT(PA-SUB) * (-1)                 30030011
295500     END-IF.                                                      30040011
295600                                                                  30050011
295700                                                                  30060011
295800******************************************************************30070011
295900* PRINT REGISTER GENERATED INFO                                   30080011
296000******************************************************************30090011
296100 K4502-PRINT-REGISTER.                                            30100011
296200                                                                  30110011
296300     MOVE '705'                       TO DL-RSN-CDE.              30120011
296400     MOVE DD-OPERATOR-REG             TO DL-PRICE-CHANGE-TYPE.    30130011
296500                                                                  30140011
296600     MOVE PA-705-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         30150011
296700     MOVE PA-705-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         30160011
296800     MOVE PA-705-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              30170011
296900     MOVE PA-705-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              30180011
297000                                                                  30190011
297100     PERFORM P2000-DETAIL-LINE.                                   30200011
297200                                                                  30210011
297300                                                                  30220011
297400******************************************************************30230011
297500* PRINT BACK OFFICE GENERATED INFO                                30240011
297600******************************************************************30250011
297700 K4503-PRINT-BACK-OFFICE.                                         30260011
297800                                                                  30270011
297900     MOVE SPACES                      TO DL-RSN-CDE.              30280011
298000     MOVE DD-OPERATOR-BO              TO DL-PRICE-CHANGE-TYPE.    30290011
298100                                                                  30300011
298200     MOVE PA-705-BO-MKDN-QTY(PA-SUB)  TO DL-MARKDOWN-QTY.         30310011
298300     MOVE PA-705-BO-MKDN-AMT(PA-SUB)  TO DL-MARKDOWN-AMT.         30320011
298400     MOVE PA-705-BO-MDC-QTY(PA-SUB)   TO DL-MDC-QTY.              30330011
298500     MOVE PA-705-BO-MDC-AMT(PA-SUB)   TO DL-MDC-AMT.              30340011
298600                                                                  30350011
298700     PERFORM P2000-DETAIL-LINE.                                   30360011
298800                                                                  30370011
298900                                                                  30380011
299000******************************************************************30390011
299100* PRINT NET RESULTS INFO                                          30400011
299200******************************************************************30410011
299300 K4504-PRINT-NET.                                                 30420011
299400                                                                  30430011
299500     MOVE DD-OPERATOR-NET TO DL-PRICE-CHANGE-TYPE.                30440011
299600                                                                  30450011
299700     ADD PA-705-BO-MKDN-QTY(PA-SUB)                               30460011
299800         PA-705-REG-MKDN-QTY(PA-SUB) GIVING PA-NET-MKDN-QTY.      30470011
299900     ADD PA-705-BO-MKDN-AMT(PA-SUB)                               30480011
300000         PA-705-REG-MKDN-AMT(PA-SUB) GIVING PA-NET-MKDN-AMT.      30490011
300100     ADD PA-705-BO-MDC-QTY(PA-SUB)                                30500011
300200         PA-705-REG-MDC-QTY(PA-SUB)  GIVING PA-NET-MDC-QTY.       30510011
300300     ADD PA-705-BO-MDC-AMT(PA-SUB)                                30520011
300400         PA-705-REG-MDC-AMT(PA-SUB)  GIVING PA-NET-MDC-AMT.       30530011
300500                                                                  30540011
300600     MOVE PA-NET-MKDN-QTY TO DL-MARKDOWN-QTY.                     30550011
300700     MOVE PA-NET-MKDN-AMT TO DL-MARKDOWN-AMT.                     30560011
300800     MOVE PA-NET-MDC-QTY  TO DL-MDC-QTY.                          30570011
300900     MOVE PA-NET-MDC-AMT  TO DL-MDC-AMT.                          30580011
301000                                                                  30590011
301100     PERFORM P2000-DETAIL-LINE.                                   30600011
301200                                                                  30610011
301300                                                                  30620011
301400******************************************************************30630011
301500* WRITE RAINCHECK INFO                                            30640011
301600******************************************************************30650011
301700 K4600-RAINCHECK.                                                 30660011
301800                                                                  30670011
301900     PERFORM K4601-CHECK-MDC-SIGN.                                30680011
302000                                                                  30690011
302100     PERFORM K4602-PRINT-REGISTER.                                30700011
302200     PERFORM K4603-PRINT-BACK-OFFICE.                             30710011
302300     PERFORM K4604-PRINT-NET.                                     30720011
302400                                                                  30730011
302500     PERFORM K7000-ACCUM-SUB-TOTALS.                              30740011
302600     PERFORM K8000-ACCUM-TOTALS.                                  30750011
302700                                                                  30760011
302800     PERFORM P3000-DETAIL-SPACE.                                  30770011
302900                                                                  30780011
303000                                                                  30790011
303100******************************************************************30800011
303200* CHECK MARKDOWN CANCEL SIGN - SHOULD ALWAYS BE NEGATIVE          30810011
303300******************************************************************30820011
303400 K4601-CHECK-MDC-SIGN.                                            30830011
303500                                                                  30840011
303600     IF  PA-706-REG-MDC-AMT(PA-SUB) = ZERO                        30850011
303700     OR  PA-706-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   30860011
303800         CONTINUE                                                 30870011
303900     ELSE                                                         30880011
304000         COMPUTE PA-706-REG-MDC-AMT(PA-SUB) =                     30890011
304100                 PA-706-REG-MDC-AMT(PA-SUB) * (-1)                30900011
304200     END-IF.                                                      30910011
304300                                                                  30920011
304400     IF  PA-706-BO-MDC-AMT(PA-SUB) = ZERO                         30930011
304500     OR  PA-706-BO-MDC-AMT(PA-SUB) IS NEGATIVE                    30940011
304600         CONTINUE                                                 30950011
304700     ELSE                                                         30960011
304800         COMPUTE PA-706-BO-MDC-AMT(PA-SUB) =                      30970011
304900                 PA-706-BO-MDC-AMT(PA-SUB) * (-1)                 30980011
305000     END-IF.                                                      30990011
305100                                                                  31000011
305200                                                                  31010011
305300******************************************************************31020011
305400* PRINT REGISTER GENERATED INFO                                   31030011
305500******************************************************************31040011
305600 K4602-PRINT-REGISTER.                                            31050011
305700                                                                  31060011
305800     MOVE '706'                       TO DL-RSN-CDE.              31070011
305900     MOVE DD-RAINCHCK-REG             TO DL-PRICE-CHANGE-TYPE.    31080011
306000                                                                  31090011
306100     MOVE PA-706-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         31100011
306200     MOVE PA-706-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         31110011
306300     MOVE PA-706-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              31120011
306400     MOVE PA-706-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              31130011
306500                                                                  31140011
306600     PERFORM P2000-DETAIL-LINE.                                   31150011
306700                                                                  31160011
306800                                                                  31170011
306900******************************************************************31180011
307000* PRINT BACK OFFICE GENERATED INFO                                31190011
307100******************************************************************31200011
307200 K4603-PRINT-BACK-OFFICE.                                         31210011
307300                                                                  31220011
307400     MOVE SPACES                      TO DL-RSN-CDE.              31230011
307500     MOVE DD-RAINCHCK-BO              TO DL-PRICE-CHANGE-TYPE.    31240011
307600                                                                  31250011
307700     MOVE PA-706-BO-MKDN-QTY(PA-SUB)  TO DL-MARKDOWN-QTY.         31260011
307800     MOVE PA-706-BO-MKDN-AMT(PA-SUB)  TO DL-MARKDOWN-AMT.         31270011
307900     MOVE PA-706-BO-MDC-QTY(PA-SUB)   TO DL-MDC-QTY.              31280011
308000     MOVE PA-706-BO-MDC-AMT(PA-SUB)   TO DL-MDC-AMT.              31290011
308100                                                                  31300011
308200     PERFORM P2000-DETAIL-LINE.                                   31310011
308300                                                                  31320011
308400                                                                  31330011
308500******************************************************************31340011
308600* PRINT NET RESULTS INFO                                          31350011
308700******************************************************************31360011
308800 K4604-PRINT-NET.                                                 31370011
308900                                                                  31380011
309000     MOVE DD-RAINCHCK-NET TO DL-PRICE-CHANGE-TYPE.                31390011
309100                                                                  31400011
309200     ADD PA-706-BO-MKDN-QTY(PA-SUB)                               31410011
309300         PA-706-REG-MKDN-QTY(PA-SUB) GIVING PA-NET-MKDN-QTY.      31420011
309400     ADD PA-706-BO-MKDN-AMT(PA-SUB)                               31430011
309500         PA-706-REG-MKDN-AMT(PA-SUB) GIVING PA-NET-MKDN-AMT.      31440011
309600     ADD PA-706-BO-MDC-QTY(PA-SUB)                                31450011
309700         PA-706-REG-MDC-QTY(PA-SUB)  GIVING PA-NET-MDC-QTY.       31460011
309800     ADD PA-706-BO-MDC-AMT(PA-SUB)                                31470011
309900         PA-706-REG-MDC-AMT(PA-SUB)  GIVING PA-NET-MDC-AMT.       31480011
310000                                                                  31490011
310100     MOVE PA-NET-MKDN-QTY TO DL-MARKDOWN-QTY.                     31500011
310200     MOVE PA-NET-MKDN-AMT TO DL-MARKDOWN-AMT.                     31510011
310300     MOVE PA-NET-MDC-QTY  TO DL-MDC-QTY.                          31520011
310400     MOVE PA-NET-MDC-AMT  TO DL-MDC-AMT.                          31530011
310500                                                                  31540011
310600     PERFORM P2000-DETAIL-LINE.                                   31550011
310700                                                                  31560011
310800                                                                  31570011
310900******************************************************************31580011
311000* WRITE COMPETITIVE INFO                                          31590011
311100******************************************************************31600011
311200 K4700-COMPETITIVE.                                               31610011
311300                                                                  31620011
311400     PERFORM K4701-CHECK-MDC-SIGN.                                31630011
311500                                                                  31640011
311600     PERFORM K4702-PRINT-REGISTER.                                31650011
311700     PERFORM K4703-PRINT-BACK-OFFICE.                             31660011
311800     PERFORM K4704-PRINT-NET.                                     31670011
311900                                                                  31680011
312000     PERFORM K7000-ACCUM-SUB-TOTALS.                              31690011
312100     PERFORM K8000-ACCUM-TOTALS.                                  31700011
312200                                                                  31710011
312300     PERFORM P3000-DETAIL-SPACE.                                  31720011
312400                                                                  31730011
312500                                                                  31740011
312600******************************************************************31750011
312700* CHECK MARKDOWN CANCEL SIGN - SHOULD ALWAYS BE NEGATIVE          31760011
312800******************************************************************31770011
312900 K4701-CHECK-MDC-SIGN.                                            31780011
313000                                                                  31790011
313100     IF  PA-707-REG-MDC-AMT(PA-SUB) = ZERO                        31800011
313200     OR  PA-707-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   31810011
313300         CONTINUE                                                 31820011
313400     ELSE                                                         31830011
313500         COMPUTE PA-707-REG-MDC-AMT(PA-SUB) =                     31840011
313600                 PA-707-REG-MDC-AMT(PA-SUB) * (-1)                31850011
313700     END-IF.                                                      31860011
313800                                                                  31870011
313900     IF  PA-707-BO-MDC-AMT(PA-SUB) = ZERO                         31880011
314000     OR  PA-707-BO-MDC-AMT(PA-SUB) IS NEGATIVE                    31890011
314100         CONTINUE                                                 31900011
314200     ELSE                                                         31910011
314300         COMPUTE PA-707-BO-MDC-AMT(PA-SUB) =                      31920011
314400                 PA-707-BO-MDC-AMT(PA-SUB) * (-1)                 31930011
314500     END-IF.                                                      31940011
314600                                                                  31950011
314700                                                                  31960011
314800******************************************************************31970011
314900* PRINT REGISTER GENERATED INFO                                   31980011
315000******************************************************************31990011
315100 K4702-PRINT-REGISTER.                                            32000011
315200                                                                  32010011
315300     MOVE '707'                       TO DL-RSN-CDE.              32020011
315400     MOVE DD-COMP-REG                 TO DL-PRICE-CHANGE-TYPE.    32030011
315500                                                                  32040011
315600     MOVE PA-707-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         32050011
315700     MOVE PA-707-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         32060011
315800     MOVE PA-707-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              32070011
315900     MOVE PA-707-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              32080011
316000                                                                  32090011
316100     PERFORM P2000-DETAIL-LINE.                                   32100011
316200                                                                  32110011
316300                                                                  32120011
316400******************************************************************32130011
316500* PRINT BACK OFFICE GENERATED INFO                                32140011
316600******************************************************************32150011
316700 K4703-PRINT-BACK-OFFICE.                                         32160011
316800                                                                  32170011
316900     MOVE SPACES                      TO DL-RSN-CDE.              32180011
317000     MOVE DD-COMP-BO                  TO DL-PRICE-CHANGE-TYPE.    32190011
317100                                                                  32200011
317200     MOVE PA-707-BO-MKDN-QTY(PA-SUB)  TO DL-MARKDOWN-QTY.         32210011
317300     MOVE PA-707-BO-MKDN-AMT(PA-SUB)  TO DL-MARKDOWN-AMT.         32220011
317400     MOVE PA-707-BO-MDC-QTY(PA-SUB)   TO DL-MDC-QTY.              32230011
317500     MOVE PA-707-BO-MDC-AMT(PA-SUB)   TO DL-MDC-AMT.              32240011
317600                                                                  32250011
317700     PERFORM P2000-DETAIL-LINE.                                   32260011
317800                                                                  32270011
317900                                                                  32280011
318000******************************************************************32290011
318100* PRINT NET RESULTS INFO                                          32300011
318200******************************************************************32310011
318300 K4704-PRINT-NET.                                                 32320011
318400                                                                  32330011
318500     MOVE DD-COMP-NET TO DL-PRICE-CHANGE-TYPE.                    32340011
318600                                                                  32350011
318700     ADD PA-707-BO-MKDN-QTY(PA-SUB)                               32360011
318800         PA-707-REG-MKDN-QTY(PA-SUB) GIVING PA-NET-MKDN-QTY.      32370011
318900     ADD PA-707-BO-MKDN-AMT(PA-SUB)                               32380011
319000         PA-707-REG-MKDN-AMT(PA-SUB) GIVING PA-NET-MKDN-AMT.      32390011
319100     ADD PA-707-BO-MDC-QTY(PA-SUB)                                32400011
319200         PA-707-REG-MDC-QTY(PA-SUB)  GIVING PA-NET-MDC-QTY.       32410011
319300     ADD PA-707-BO-MDC-AMT(PA-SUB)                                32420011
319400         PA-707-REG-MDC-AMT(PA-SUB)  GIVING PA-NET-MDC-AMT.       32430011
319500                                                                  32440011
319600     MOVE PA-NET-MKDN-QTY TO DL-MARKDOWN-QTY.                     32450011
319700     MOVE PA-NET-MKDN-AMT TO DL-MARKDOWN-AMT.                     32460011
319800     MOVE PA-NET-MDC-QTY  TO DL-MDC-QTY.                          32470011
319900     MOVE PA-NET-MDC-AMT  TO DL-MDC-AMT.                          32480011
320000                                                                  32490011
320100     PERFORM P2000-DETAIL-LINE.                                   32500011
320200                                                                  32510011
320300                                                                  32520011
320400******************************************************************32530011
320500* WRITE SPECIAL PROMOTIONAL INFO                                  32540011
320600******************************************************************32550011
320700 K4800-SPECIAL-PROMO.                                             32560011
320800                                                                  32570011
320900     PERFORM K4801-CHECK-MDC-SIGN.                                32580011
321000                                                                  32590011
321100     PERFORM K4802-PRINT-REGISTER.                                32600011
321200     PERFORM K4803-PRINT-BACK-OFFICE.                             32610011
321300     PERFORM K4804-PRINT-NET.                                     32620011
321400                                                                  32630011
321500     PERFORM K7000-ACCUM-SUB-TOTALS.                              32640011
321600     PERFORM K8000-ACCUM-TOTALS.                                  32650011
321700                                                                  32660011
321800     PERFORM P3000-DETAIL-SPACE.                                  32670011
321900                                                                  32680011
322000                                                                  32690011
322100******************************************************************32700011
322200* CHECK MARKDOWN CANCEL SIGN - SHOULD ALWAYS BE NEGATIVE          32710011
322300******************************************************************32720011
322400 K4801-CHECK-MDC-SIGN.                                            32730011
322500                                                                  32740011
322600     IF  PA-708-REG-MDC-AMT(PA-SUB) = ZERO                        32750011
322700     OR  PA-708-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   32760011
322800         CONTINUE                                                 32770011
322900     ELSE                                                         32780011
323000         COMPUTE PA-708-REG-MDC-AMT(PA-SUB) =                     32790011
323100                 PA-708-REG-MDC-AMT(PA-SUB) * (-1)                32800011
323200     END-IF.                                                      32810011
323300                                                                  32820011
323400     IF  PA-708-BO-MDC-AMT(PA-SUB) = ZERO                         32830011
323500     OR  PA-708-BO-MDC-AMT(PA-SUB) IS NEGATIVE                    32840011
323600         CONTINUE                                                 32850011
323700     ELSE                                                         32860011
323800         COMPUTE PA-708-BO-MDC-AMT(PA-SUB) =                      32870011
323900                 PA-708-BO-MDC-AMT(PA-SUB) * (-1)                 32880011
324000     END-IF.                                                      32890011
324100                                                                  32900011
324200                                                                  32910011
324300******************************************************************32920011
324400* PRINT REGISTER GENERATED INFO                                   32930011
324500******************************************************************32940011
324600 K4802-PRINT-REGISTER.                                            32950011
324700                                                                  32960011
324800     MOVE '708'                       TO DL-RSN-CDE.              32970011
324900     MOVE DD-SPEC-PROMO-REG           TO DL-PRICE-CHANGE-TYPE.    32980011
325000                                                                  32990011
325100     MOVE PA-708-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         33000011
325200     MOVE PA-708-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         33010011
325300     MOVE PA-708-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              33020011
325400     MOVE PA-708-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              33030011
325500                                                                  33040011
325600     PERFORM P2000-DETAIL-LINE.                                   33050011
325700                                                                  33060011
325800                                                                  33070011
325900******************************************************************33080011
326000* PRINT BACK OFFICE GENERATED INFO                                33090011
326100******************************************************************33100011
326200 K4803-PRINT-BACK-OFFICE.                                         33110011
326300                                                                  33120011
326400     MOVE SPACES                      TO DL-RSN-CDE.              33130011
326500     MOVE DD-SPEC-PROMO-BO            TO DL-PRICE-CHANGE-TYPE.    33140011
326600                                                                  33150011
326700     MOVE PA-708-BO-MKDN-QTY(PA-SUB)  TO DL-MARKDOWN-QTY.         33160011
326800     MOVE PA-708-BO-MKDN-AMT(PA-SUB)  TO DL-MARKDOWN-AMT.         33170011
326900     MOVE PA-708-BO-MDC-QTY(PA-SUB)   TO DL-MDC-QTY.              33180011
327000     MOVE PA-708-BO-MDC-AMT(PA-SUB)   TO DL-MDC-AMT.              33190011
327100                                                                  33200011
327200     PERFORM P2000-DETAIL-LINE.                                   33210011
327300                                                                  33220011
327400                                                                  33230011
327500******************************************************************33240011
327600* PRINT NET RESULTS INFO                                          33250011
327700******************************************************************33260011
327800 K4804-PRINT-NET.                                                 33270011
327900                                                                  33280011
328000     MOVE DD-SPEC-PROMO-NET TO DL-PRICE-CHANGE-TYPE.              33290011
328100                                                                  33300011
328200     ADD PA-708-BO-MKDN-QTY(PA-SUB)                               33310011
328300         PA-708-REG-MKDN-QTY(PA-SUB) GIVING PA-NET-MKDN-QTY.      33320011
328400     ADD PA-708-BO-MKDN-AMT(PA-SUB)                               33330011
328500         PA-708-REG-MKDN-AMT(PA-SUB) GIVING PA-NET-MKDN-AMT.      33340011
328600     ADD PA-708-BO-MDC-QTY(PA-SUB)                                33350011
328700         PA-708-REG-MDC-QTY(PA-SUB)  GIVING PA-NET-MDC-QTY.       33360011
328800     ADD PA-708-BO-MDC-AMT(PA-SUB)                                33370011
328900         PA-708-REG-MDC-AMT(PA-SUB)  GIVING PA-NET-MDC-AMT.       33380011
329000                                                                  33390011
329100     MOVE PA-NET-MKDN-QTY TO DL-MARKDOWN-QTY.                     33400011
329200     MOVE PA-NET-MKDN-AMT TO DL-MARKDOWN-AMT.                     33410011
329300     MOVE PA-NET-MDC-QTY  TO DL-MDC-QTY.                          33420011
329400     MOVE PA-NET-MDC-AMT  TO DL-MDC-AMT.                          33430011
329500                                                                  33440011
329600     PERFORM P2000-DETAIL-LINE.                                   33450011
329700                                                                  33460011
329800                                                                  33470011
329900******************************************************************33480011
330000* WRITE YES-WE-CAN INFO                                           33490011
330100******************************************************************33500011
330200 K4900-YES-WE-CAN.                                                33510011
330300                                                                  33520011
330400     PERFORM K4901-CHECK-MDC-SIGN.                                33530011
330500                                                                  33540011
330600     PERFORM K4902-PRINT-REGISTER.                                33550011
330700     PERFORM K4903-PRINT-BACK-OFFICE.                             33560011
330800     PERFORM K4904-PRINT-NET.                                     33570011
330900                                                                  33580011
331000     PERFORM K7000-ACCUM-SUB-TOTALS.                              33590011
331100     PERFORM K8000-ACCUM-TOTALS.                                  33600011
331200                                                                  33610011
331300                                                                  33620011
331400******************************************************************33630011
331500* CHECK MARKDOWN CANCEL SIGN - SHOULD ALWAYS BE NEGATIVE          33640011
331600******************************************************************33650011
331700 K4901-CHECK-MDC-SIGN.                                            33660011
331800                                                                  33670011
331900     IF  PA-709-REG-MDC-AMT(PA-SUB) = ZERO                        33680011
332000     OR  PA-709-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   33690011
332100         CONTINUE                                                 33700011
332200     ELSE                                                         33710011
332300         COMPUTE PA-709-REG-MDC-AMT(PA-SUB) =                     33720011
332400                 PA-709-REG-MDC-AMT(PA-SUB) * (-1)                33730011
332500     END-IF.                                                      33740011
332600                                                                  33750011
332700     IF  PA-709-BO-MDC-AMT(PA-SUB) = ZERO                         33760011
332800     OR  PA-709-BO-MDC-AMT(PA-SUB) IS NEGATIVE                    33770011
332900         CONTINUE                                                 33780011
333000     ELSE                                                         33790011
333100         COMPUTE PA-709-BO-MDC-AMT(PA-SUB) =                      33800011
333200                 PA-709-BO-MDC-AMT(PA-SUB) * (-1)                 33810011
333300     END-IF.                                                      33820011
333400                                                                  33830011
333500                                                                  33840011
333600******************************************************************33850011
333700* PRINT REGISTER GENERATED INFO                                   33860011
333800******************************************************************33870011
333900 K4902-PRINT-REGISTER.                                            33880011
334000                                                                  33890011
334100     MOVE '709'                       TO DL-RSN-CDE.              33900011
334200     MOVE DD-YES-WE-CAN-REG           TO DL-PRICE-CHANGE-TYPE.    33910011
334300                                                                  33920011
334400     MOVE PA-709-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         33930011
334500     MOVE PA-709-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         33940011
334600     MOVE PA-709-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              33950011
334700     MOVE PA-709-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              33960011
334800                                                                  33970011
334900     PERFORM P2000-DETAIL-LINE.                                   33980011
335000                                                                  33990011
335100                                                                  34000011
335200******************************************************************34010011
335300* PRINT BACK OFFICE GENERATED INFO                                34020011
335400******************************************************************34030011
335500 K4903-PRINT-BACK-OFFICE.                                         34040011
335600                                                                  34050011
335700     MOVE SPACES                      TO DL-RSN-CDE.              34060011
335800     MOVE DD-YES-WE-CAN-BO            TO DL-PRICE-CHANGE-TYPE.    34070011
335900                                                                  34080011
336000     MOVE PA-709-BO-MKDN-QTY(PA-SUB)  TO DL-MARKDOWN-QTY.         34090011
336100     MOVE PA-709-BO-MKDN-AMT(PA-SUB)  TO DL-MARKDOWN-AMT.         34100011
336200     MOVE PA-709-BO-MDC-QTY(PA-SUB)   TO DL-MDC-QTY.              34110011
336300     MOVE PA-709-BO-MDC-AMT(PA-SUB)   TO DL-MDC-AMT.              34120011
336400                                                                  34130011
336500     PERFORM P2000-DETAIL-LINE.                                   34140011
336600                                                                  34150011
336700                                                                  34160011
336800******************************************************************34170011
336900* PRINT NET RESULTS INFO                                          34180011
337000******************************************************************34190011
337100 K4904-PRINT-NET.                                                 34200011
337200                                                                  34210011
337300     MOVE DD-YES-WE-CAN-NET TO DL-PRICE-CHANGE-TYPE.              34220011
337400                                                                  34230011
337500     ADD PA-709-BO-MKDN-QTY(PA-SUB)                               34240011
337600         PA-709-REG-MKDN-QTY(PA-SUB) GIVING PA-NET-MKDN-QTY.      34250011
337700     ADD PA-709-BO-MKDN-AMT(PA-SUB)                               34260011
337800         PA-709-REG-MKDN-AMT(PA-SUB) GIVING PA-NET-MKDN-AMT.      34270011
337900     ADD PA-709-BO-MDC-QTY(PA-SUB)                                34280011
338000         PA-709-REG-MDC-QTY(PA-SUB)  GIVING PA-NET-MDC-QTY.       34290011
338100     ADD PA-709-BO-MDC-AMT(PA-SUB)                                34300011
338200         PA-709-REG-MDC-AMT(PA-SUB)  GIVING PA-NET-MDC-AMT.       34310011
338300                                                                  34320011
338400     MOVE PA-NET-MKDN-QTY TO DL-MARKDOWN-QTY.                     34330011
338500     MOVE PA-NET-MKDN-AMT TO DL-MARKDOWN-AMT.                     34340011
338600     MOVE PA-NET-MDC-QTY  TO DL-MDC-QTY.                          34350011
338700     MOVE PA-NET-MDC-AMT  TO DL-MDC-AMT.                          34360011
338800                                                                  34370011
338900     PERFORM P2000-DETAIL-LINE.                                   34380011
339000                                                                  34390011
339100                                                                  34400027
339200******************************************************************34410027
339300* PRINT KOHLS CASH GIFT RECEIPTED RETURNS INFO                    34420027
339400******************************************************************34430027
339500 K4950-KC-GIFT-RCPT-UNEARNED.                                     34440027
339600                                                                  34450027
339700     IF  PA-765-REG-MDC-AMT(PA-SUB) = ZERO                        34460027
339800     OR  PA-765-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   34470027
339900         CONTINUE                                                 34480027
340000     ELSE                                                         34490027
340100         COMPUTE PA-765-REG-MDC-AMT(PA-SUB) =                     34500027
340200                 PA-765-REG-MDC-AMT(PA-SUB) * (-1)                34510027
340300     END-IF.                                                      34520027
340400                                                                  34530027
340500     MOVE '765'                       TO DL-RSN-CDE.              34540027
340600     MOVE DD-KC-GIFT-RCPT-UNEARNED    TO DL-PRICE-CHANGE-TYPE.    34550027
340700     MOVE PA-765-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         34560027
340800     MOVE PA-765-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         34570027
340900     MOVE PA-765-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              34580027
341000     MOVE PA-765-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              34590027
341100     PERFORM P2000-DETAIL-LINE.                                   34600027
341200                                                                  34610027
341300     PERFORM P3000-DETAIL-SPACE.                                  34620032
341400                                                                  34630030
341500     ADD PA-765-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         34640027
341600     ADD PA-765-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         34650027
341700     ADD PA-765-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          34660027
341800     ADD PA-765-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          34670027
341900                                                                  34680027
342000                                                                  34690011
205464******************************************************************34700089
205464* PRINT NON-RECEIPTED RETURNS INFO                                34710089
205464******************************************************************34720089
205464 K4960-NON-RECEIPT-RETURN.                                        34730089
205464                                                                  34740089
205464     IF  PA-710-REG-MDC-AMT(PA-SUB) = ZERO                        34750089
205464     OR  PA-710-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   34760089
205464         CONTINUE                                                 34770089
205464     ELSE                                                         34780089
205464         COMPUTE PA-710-REG-MDC-AMT(PA-SUB) =                     34790089
205464                 PA-710-REG-MDC-AMT(PA-SUB) * (-1)                34800089
205464     END-IF.                                                      34810089
205464                                                                  34820089
205464     MOVE '710'                       TO DL-RSN-CDE.              34830089
205464     MOVE DD-NON-RECEIPT-RETURN       TO DL-PRICE-CHANGE-TYPE.    34840089
205464     MOVE PA-710-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         34850089
205464     MOVE PA-710-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         34860089
205464     MOVE PA-710-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              34870089
205464     MOVE PA-710-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              34880089
205464     PERFORM P2000-DETAIL-LINE.                                   34890089
205464                                                                  34900089
205464     PERFORM P3000-DETAIL-SPACE.                                  34910089
205464                                                                  34920089
205464     ADD PA-710-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         34930089
205464     ADD PA-710-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         34940089
205464     ADD PA-710-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          34950089
205464     ADD PA-710-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          34960089
205464                                                                  34970089
205464                                                                  34980089
342100******************************************************************34990011
342200* WRITE SENIOR CITIZEN DISCOUNTS INFO                             35000011
342300******************************************************************35010011
342400 K5000-SENIOR-DISC.                                               35020011
342500                                                                  35030011
342600     IF  PA-728-REG-MDC-AMT(PA-SUB) = ZERO                        35040011
342700     OR  PA-728-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   35050011
342800         CONTINUE                                                 35060011
342900     ELSE                                                         35070011
343000         COMPUTE PA-728-REG-MDC-AMT(PA-SUB) =                     35080011
343100                 PA-728-REG-MDC-AMT(PA-SUB) * (-1)                35090011
343200     END-IF.                                                      35100011
343300                                                                  35110011
343400     MOVE '728'                       TO DL-RSN-CDE.              35120011
343500     MOVE DD-SENIOR-CITIZEN           TO DL-PRICE-CHANGE-TYPE.    35130011
343600     MOVE PA-728-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         35140011
343700     MOVE PA-728-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         35150011
343800     MOVE PA-728-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              35160011
343900     MOVE PA-728-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              35170011
344000     PERFORM P2000-DETAIL-LINE.                                   35180011
344100                                                                  35190011
344200     PERFORM P3000-DETAIL-SPACE.                                  35200011
344300                                                                  35210011
344400     ADD PA-728-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         35220011
344500     ADD PA-728-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         35230011
344600     ADD PA-728-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          35240011
344700     ADD PA-728-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          35250011
344800                                                                  35260011
344900                                                                  35270011
345000******************************************************************35280011
345100* WRITE KOHLS COUPON INFO                                         35290011
345200******************************************************************35300011
345300 K5100-KOHLS-COUPON.                                              35310011
345400                                                                  35320011
345500     IF  PA-733-REG-MDC-AMT(PA-SUB) = ZERO                        35330011
345600     OR  PA-733-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   35340011
345700         CONTINUE                                                 35350011
345800     ELSE                                                         35360011
345900         COMPUTE PA-733-REG-MDC-AMT(PA-SUB) =                     35370011
346000                 PA-733-REG-MDC-AMT(PA-SUB) * (-1)                35380011
346100     END-IF.                                                      35390011
346200                                                                  35400011
346300     MOVE '733'                       TO DL-RSN-CDE.              35410011
346400     MOVE DD-KOHLS-COUPON             TO DL-PRICE-CHANGE-TYPE.    35420011
346500     MOVE PA-733-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         35430011
346600     MOVE PA-733-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         35440011
346700     MOVE PA-733-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              35450011
346800     MOVE PA-733-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              35460011
346900     PERFORM P2000-DETAIL-LINE.                                   35470011
347000                                                                  35480011
347100     PERFORM P3000-DETAIL-SPACE.                                  35490011
347200                                                                  35500011
347300     ADD PA-733-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         35510011
347400     ADD PA-733-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         35520011
347500     ADD PA-733-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          35530011
347600     ADD PA-733-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          35540011
347700                                                                  35550011
347800******************************************************************35560011
347900* WRITE OFFERS SIMPLE COUPON                                      35570011
348000******************************************************************35580011
348100 K5110-760-OFFER-SIMPLE-COUPON.                                   35590011
348200                                                                  35600011
348300     IF  PA-760-REG-MDC-AMT(PA-SUB) = ZERO                        35610011
348400     OR  PA-760-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   35620011
348500         CONTINUE                                                 35630011
348600     ELSE                                                         35640011
348700         COMPUTE PA-760-REG-MDC-AMT(PA-SUB) =                     35650011
348800                 PA-760-REG-MDC-AMT(PA-SUB) * (-1)                35660011
348900     END-IF.                                                      35670011
349000                                                                  35680011
349100     MOVE '760'                       TO DL-RSN-CDE.              35690011
349200     MOVE DD-SIMPLE-OFFER             TO DL-PRICE-CHANGE-TYPE.    35700011
349300     MOVE PA-760-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         35710011
349400     MOVE PA-760-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         35720011
349500     MOVE PA-760-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              35730011
349600     MOVE PA-760-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              35740011
349700     PERFORM P2000-DETAIL-LINE.                                   35750011
349800                                                                  35760011
349900     PERFORM P3000-DETAIL-SPACE.                                  35770011
350000                                                                  35780011
350100     ADD PA-760-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         35790011
350200     ADD PA-760-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         35800011
350300     ADD PA-760-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          35810011
350400     ADD PA-760-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          35820011
350500                                                                  35830011
350600******************************************************************35840011
350700* WRITE OFFERS TLD TIERED                                         35850011
350800******************************************************************35860011
350900 K5120-761-OFFER-TLD-TIERED.                                      35870011
351000                                                                  35880011
351100     IF  PA-761-REG-MDC-AMT(PA-SUB) = ZERO                        35890011
351200     OR  PA-761-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   35900011
351300         CONTINUE                                                 35910011
351400     ELSE                                                         35920011
351500         COMPUTE PA-761-REG-MDC-AMT(PA-SUB) =                     35930011
351600                 PA-761-REG-MDC-AMT(PA-SUB) * (-1)                35940011
351700     END-IF.                                                      35950011
351800                                                                  35960011
351900     MOVE '761'                       TO DL-RSN-CDE.              35970011
352000     MOVE DD-TLD-TIERED-OFFER         TO DL-PRICE-CHANGE-TYPE.    35980011
352100     MOVE PA-761-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         35990011
352200     MOVE PA-761-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         36000011
352300     MOVE PA-761-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              36010011
352400     MOVE PA-761-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              36020011
352500     PERFORM P2000-DETAIL-LINE.                                   36030011
352600                                                                  36040011
352700     PERFORM P3000-DETAIL-SPACE.                                  36050011
352800                                                                  36060011
352900     ADD PA-761-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         36070011
353000     ADD PA-761-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         36080011
353100     ADD PA-761-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          36090011
353200     ADD PA-761-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          36100011
353300                                                                  36110011
353400******************************************************************36120011
353500* WRITE OFFERS LID TIERED                                         36130011
353600******************************************************************36140011
353700 K5130-762-OFFER-LID-TIERED.                                      36150011
353800                                                                  36160011
353900     IF  PA-762-REG-MDC-AMT(PA-SUB) = ZERO                        36170011
354000     OR  PA-762-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   36180011
354100         CONTINUE                                                 36190011
354200     ELSE                                                         36200011
354300         COMPUTE PA-762-REG-MDC-AMT(PA-SUB) =                     36210011
354400                 PA-762-REG-MDC-AMT(PA-SUB) * (-1)                36220011
354500     END-IF.                                                      36230011
354600                                                                  36240011
354700     MOVE '762'                       TO DL-RSN-CDE.              36250011
354800     MOVE DD-LID-TIERED-OFFER         TO DL-PRICE-CHANGE-TYPE.    36260011
354900     MOVE PA-762-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         36270011
355000     MOVE PA-762-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         36280011
355100     MOVE PA-762-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              36290011
355200     MOVE PA-762-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              36300011
355300     PERFORM P2000-DETAIL-LINE.                                   36310011
355400                                                                  36320011
355500     PERFORM P3000-DETAIL-SPACE.                                  36330011
355600                                                                  36340011
355700     ADD PA-762-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         36350011
355800     ADD PA-762-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         36360011
355900     ADD PA-762-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          36370011
356000     ADD PA-762-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          36380011
356100                                                                  36390011
356200******************************************************************36400011
356300* WRITE OFFERS GWP PWP                                            36410011
356400******************************************************************36420011
356500 K5140-763-OFFER-GWP-PWP.                                         36430011
356600                                                                  36440011
356700     IF  PA-763-REG-MDC-AMT(PA-SUB) = ZERO                        36450011
356800     OR  PA-763-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   36460011
356900         CONTINUE                                                 36470011
357000     ELSE                                                         36480011
357100         COMPUTE PA-763-REG-MDC-AMT(PA-SUB) =                     36490011
357200                 PA-763-REG-MDC-AMT(PA-SUB) * (-1)                36500011
357300     END-IF.                                                      36510011
357400                                                                  36520011
357500     MOVE '763'                       TO DL-RSN-CDE.              36530011
357600     MOVE DD-GWP-TIERED-OFFER         TO DL-PRICE-CHANGE-TYPE.    36540011
357700     MOVE PA-763-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         36550011
357800     MOVE PA-763-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         36560011
357900     MOVE PA-763-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              36570011
358000     MOVE PA-763-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              36580011
358100     PERFORM P2000-DETAIL-LINE.                                   36590011
358200                                                                  36600011
358300     PERFORM P3000-DETAIL-SPACE.                                  36610011
358400                                                                  36620011
358500     ADD PA-763-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         36630011
358600     ADD PA-763-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         36640011
358700     ADD PA-763-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          36650011
358800     ADD PA-763-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          36660011
358900                                                                  36670011
359000******************************************************************36680011
359100* WRITE GOLDSTAR INFO                                             36690011
359200******************************************************************36700011
359300 K5200-GOLDSTAR.                                                  36710011
359400                                                                  36720011
359500     PERFORM K5201-CHECK-MDC-SIGN.                                36730011
359600                                                                  36740011
359700     PERFORM K5202-PRINT-REGISTER.                                36750011
359800     PERFORM K5203-PRINT-BACK-OFFICE.                             36760011
359900     PERFORM K5204-PRINT-NET.                                     36770011
360000                                                                  36780011
360100     PERFORM K8000-ACCUM-TOTALS.                                  36790011
360200                                                                  36800011
360300     PERFORM P3000-DETAIL-SPACE.                                  36810011
360400                                                                  36820011
360500                                                                  36830011
360600******************************************************************36840011
360700* CHECK MARKDOWN CANCEL SIGN - SHOULD ALWAYS BE NEGATIVE          36850011
360800******************************************************************36860011
360900 K5201-CHECK-MDC-SIGN.                                            36870011
361000                                                                  36880011
361100     IF  PA-753-REG-MDC-AMT(PA-SUB) = ZERO                        36890011
361200     OR  PA-753-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   36900011
361300         CONTINUE                                                 36910011
361400     ELSE                                                         36920011
361500         COMPUTE PA-753-REG-MDC-AMT(PA-SUB) =                     36930011
361600                 PA-753-REG-MDC-AMT(PA-SUB) * (-1)                36940011
361700     END-IF.                                                      36950011
361800                                                                  36960011
361900     IF  PA-753-BO-MDC-AMT(PA-SUB) = ZERO                         36970011
362000     OR  PA-753-BO-MDC-AMT(PA-SUB) IS NEGATIVE                    36980011
362100         CONTINUE                                                 36990011
362200     ELSE                                                         37000011
362300         COMPUTE PA-753-BO-MDC-AMT(PA-SUB) =                      37010011
362400                 PA-753-BO-MDC-AMT(PA-SUB) * (-1)                 37020011
362500     END-IF.                                                      37030011
362600                                                                  37040011
362700                                                                  37050011
362800******************************************************************37060011
362900* PRINT REGISTER GENERATED INFO                                   37070011
363000******************************************************************37080011
363100 K5202-PRINT-REGISTER.                                            37090011
363200                                                                  37100011
363300     MOVE '753'                       TO DL-RSN-CDE.              37110011
363400     MOVE DD-GOLDSTAR-REG             TO DL-PRICE-CHANGE-TYPE.    37120011
363500                                                                  37130011
363600     MOVE PA-753-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         37140011
363700     MOVE PA-753-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         37150011
363800     MOVE PA-753-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              37160011
363900     MOVE PA-753-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              37170011
364000                                                                  37180011
364100     PERFORM P2000-DETAIL-LINE.                                   37190011
364200                                                                  37200011
364300                                                                  37210011
364400******************************************************************37220011
364500* PRINT BACK OFFICE GENERATED INFO                                37230011
364600******************************************************************37240011
364700 K5203-PRINT-BACK-OFFICE.                                         37250011
364800                                                                  37260011
364900     MOVE SPACES                      TO DL-RSN-CDE.              37270011
365000     MOVE DD-GOLDSTAR-BO              TO DL-PRICE-CHANGE-TYPE.    37280011
365100                                                                  37290011
365200     MOVE PA-753-BO-MKDN-QTY(PA-SUB)  TO DL-MARKDOWN-QTY.         37300011
365300     MOVE PA-753-BO-MKDN-AMT(PA-SUB)  TO DL-MARKDOWN-AMT.         37310011
365400     MOVE PA-753-BO-MDC-QTY(PA-SUB)   TO DL-MDC-QTY.              37320011
365500     MOVE PA-753-BO-MDC-AMT(PA-SUB)   TO DL-MDC-AMT.              37330011
365600                                                                  37340011
365700     PERFORM P2000-DETAIL-LINE.                                   37350011
365800                                                                  37360011
365900                                                                  37370011
366000******************************************************************37380011
366100* PRINT NET RESULTS INFO                                          37390011
366200******************************************************************37400011
366300 K5204-PRINT-NET.                                                 37410011
366400                                                                  37420011
366500     MOVE DD-GOLDSTAR-NET TO DL-PRICE-CHANGE-TYPE.                37430011
366600                                                                  37440011
366700     ADD PA-753-BO-MKDN-QTY(PA-SUB)                               37450011
366800         PA-753-REG-MKDN-QTY(PA-SUB) GIVING PA-NET-MKDN-QTY.      37460011
366900     ADD PA-753-BO-MKDN-AMT(PA-SUB)                               37470011
367000         PA-753-REG-MKDN-AMT(PA-SUB) GIVING PA-NET-MKDN-AMT.      37480011
367100     ADD PA-753-BO-MDC-QTY(PA-SUB)                                37490011
367200         PA-753-REG-MDC-QTY(PA-SUB)  GIVING PA-NET-MDC-QTY.       37500011
367300     ADD PA-753-BO-MDC-AMT(PA-SUB)                                37510011
367400         PA-753-REG-MDC-AMT(PA-SUB)  GIVING PA-NET-MDC-AMT.       37520011
367500                                                                  37530011
367600     MOVE PA-NET-MKDN-QTY TO DL-MARKDOWN-QTY.                     37540011
367700     MOVE PA-NET-MKDN-AMT TO DL-MARKDOWN-AMT.                     37550011
367800     MOVE PA-NET-MDC-QTY  TO DL-MDC-QTY.                          37560011
367900     MOVE PA-NET-MDC-AMT  TO DL-MDC-AMT.                          37570011
368000                                                                  37580011
368100     PERFORM P2000-DETAIL-LINE.                                   37590011
368200                                                                  37600011
368300                                                                  37610011
368400******************************************************************37620011
368500* WRITE BOGO INFO                                                 37630011
368600******************************************************************37640011
368700 K5300-BOGO.                                                      37650011
368800                                                                  37660011
368900     IF  PA-775-REG-MDC-AMT(PA-SUB) = ZERO                        37670011
369000     OR  PA-775-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   37680011
369100         CONTINUE                                                 37690011
369200     ELSE                                                         37700011
369300         COMPUTE PA-775-REG-MDC-AMT(PA-SUB) =                     37710011
369400                 PA-775-REG-MDC-AMT(PA-SUB) * (-1)                37720011
369500     END-IF.                                                      37730011
369600                                                                  37740011
369700     MOVE '775'                       TO DL-RSN-CDE.              37750011
369800     MOVE DD-BOGO                     TO DL-PRICE-CHANGE-TYPE.    37760011
369900     MOVE PA-775-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         37770011
370000     MOVE PA-775-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         37780011
370100     MOVE PA-775-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              37790011
370200     MOVE PA-775-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              37800011
370300     PERFORM P2000-DETAIL-LINE.                                   37810011
370400                                                                  37820011
370500     PERFORM P3000-DETAIL-SPACE.                                  37830011
370600                                                                  37840011
370700     ADD PA-775-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         37850011
370800     ADD PA-775-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         37860011
370900     ADD PA-775-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          37870011
371000     ADD PA-775-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          37880011
371100                                                                  37890011
371200                                                                  37900011
371300******************************************************************37910011
371400* WRITE BOGO II INFO                                              37920011
371500******************************************************************37930011
371600 K5400-BOGO2.                                                     37940011
371700                                                                  37950011
371800     IF  PA-777-REG-MDC-AMT(PA-SUB) = ZERO                        37960011
371900     OR  PA-777-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   37970011
372000         CONTINUE                                                 37980011
372100     ELSE                                                         37990011
372200         COMPUTE PA-777-REG-MDC-AMT(PA-SUB) =                     38000011
372300                 PA-777-REG-MDC-AMT(PA-SUB) * (-1)                38010011
372400     END-IF.                                                      38020011
372500                                                                  38030011
372600     MOVE '777'                       TO DL-RSN-CDE.              38040011
372700     MOVE DD-BOGOII                   TO DL-PRICE-CHANGE-TYPE.    38050011
372800     MOVE PA-777-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         38060011
372900     MOVE PA-777-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         38070011
373000     MOVE PA-777-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              38080011
373100     MOVE PA-777-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              38090011
373200     PERFORM P2000-DETAIL-LINE.                                   38100011
373300                                                                  38110011
373400     PERFORM P3000-DETAIL-SPACE.                                  38120011
373500                                                                  38130011
373600     ADD PA-777-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         38140011
373700     ADD PA-777-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         38150011
373800     ADD PA-777-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          38160011
373900     ADD PA-777-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          38170011
374000                                                                  38180011
374100                                                                  38190011
374200******************************************************************38200011
374300* WRITE UNEARNED REWARDS INFO                                     38210011
374400******************************************************************38220011
374500 K5500-UNEARNED.                                                  38230011
374600                                                                  38240011
374700     IF  PA-780-REG-MDC-AMT(PA-SUB) = ZERO                        38250011
374800     OR  PA-780-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   38260011
374900         CONTINUE                                                 38270011
375000     ELSE                                                         38280011
375100         COMPUTE PA-780-REG-MDC-AMT(PA-SUB) =                     38290011
375200                 PA-780-REG-MDC-AMT(PA-SUB) * (-1)                38300011
375300     END-IF.                                                      38310011
375400                                                                  38320011
375500     MOVE '780'                       TO DL-RSN-CDE.              38330011
375600     MOVE DD-UNEARNED-REWARDS         TO DL-PRICE-CHANGE-TYPE.    38340011
375700     MOVE PA-780-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         38350011
375800     MOVE PA-780-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         38360011
375900     MOVE PA-780-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              38370011
376000     MOVE PA-780-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              38380011
376100     PERFORM P2000-DETAIL-LINE.                                   38390011
376200                                                                  38400011
376300     PERFORM P3000-DETAIL-SPACE.                                  38410011
376400                                                                  38420011
376500     ADD PA-780-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         38430011
376600     ADD PA-780-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         38440011
376700     ADD PA-780-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          38450011
376800     ADD PA-780-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          38460011
376900                                                                  38470011
377000                                                                  38480011
377100******************************************************************38490011
377200* WRITE EMPLOYEE DISCOUNT INFO                                    38500011
377300******************************************************************38510011
377400 K5600-EMPLY-DISC.                                                38520011
377500                                                                  38530011
377600     IF  PA-790-REG-MDC-AMT(PA-SUB) = ZERO                        38540011
377700     OR  PA-790-REG-MDC-AMT(PA-SUB) IS NEGATIVE                   38550011
377800         CONTINUE                                                 38560011
377900     ELSE                                                         38570011
378000         COMPUTE PA-790-REG-MDC-AMT(PA-SUB) =                     38580011
378100                 PA-790-REG-MDC-AMT(PA-SUB) * (-1)                38590011
378200     END-IF.                                                      38600011
378300                                                                  38610011
378400     MOVE '790'                       TO DL-RSN-CDE.              38620011
378500     MOVE DD-EMPLY-DISCOUNT           TO DL-PRICE-CHANGE-TYPE.    38630011
378600     MOVE PA-790-REG-MKDN-QTY(PA-SUB) TO DL-MARKDOWN-QTY.         38640011
378700     MOVE PA-790-REG-MKDN-AMT(PA-SUB) TO DL-MARKDOWN-AMT.         38650011
378800     MOVE PA-790-REG-MDC-QTY(PA-SUB)  TO DL-MDC-QTY.              38660011
378900     MOVE PA-790-REG-MDC-AMT(PA-SUB)  TO DL-MDC-AMT.              38670011
379000     PERFORM P2000-DETAIL-LINE.                                   38680011
379100                                                                  38690011
379200     PERFORM P3000-DETAIL-SPACE.                                  38700011
379300                                                                  38710011
379400     ADD PA-790-REG-MKDN-QTY(PA-SUB)  TO PA-TTL-MKDN-QTY.         38720011
379500     ADD PA-790-REG-MKDN-AMT(PA-SUB)  TO PA-TTL-MKDN-AMT.         38730011
379600     ADD PA-790-REG-MDC-QTY(PA-SUB)   TO PA-TTL-MDC-QTY.          38740011
379700     ADD PA-790-REG-MDC-AMT(PA-SUB)   TO PA-TTL-MDC-AMT.          38750011
379800                                                                  38760011
379900                                                                  38770011
380000******************************************************************38780011
380100* ACCUMULATE THE TOTALS                                           38790011
380200******************************************************************38800011
380300 K7000-ACCUM-SUB-TOTALS.                                          38810011
380400                                                                  38820011
380500     ADD PA-NET-MKDN-QTY TO PA-SUB-MKDN-QTY.                      38830011
380600     ADD PA-NET-MKDN-AMT TO PA-SUB-MKDN-AMT.                      38840011
380700     ADD PA-NET-MDC-QTY  TO PA-SUB-MDC-QTY.                       38850011
380800     ADD PA-NET-MDC-AMT  TO PA-SUB-MDC-AMT.                       38860011
380900                                                                  38870011
381000                                                                  38880011
381100******************************************************************38890011
381200* ACCUMULATE THE TOTALS                                           38900011
381300******************************************************************38910011
381400 K8000-ACCUM-TOTALS.                                              38920011
381500                                                                  38930011
381600     ADD PA-NET-MKDN-QTY TO PA-TTL-MKDN-QTY.                      38940011
381700     ADD PA-NET-MKDN-AMT TO PA-TTL-MKDN-AMT.                      38950011
381800     ADD PA-NET-MDC-QTY  TO PA-TTL-MDC-QTY.                       38960011
381900     ADD PA-NET-MDC-AMT  TO PA-TTL-MDC-AMT.                       38970011
382000                                                                  38980011
382100                                                                  38990011
382200******************************************************************39000011
382300* WRITE THE REPORT HEADERS                                        39010011
382400******************************************************************39020011
382500 P1000-HEADERS.                                                   39030011
382600                                                                  39040011
382700     MOVE ZERO TO PV-LINE-COUNT.                                  39050011
382800                                                                  39060011
382900     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    39070011
383000                                                                  39080011
383100     WRITE RPT-REC FROM DP132O-STANDRD-HEADER-132-COLS            39090011
383200          AFTER ADVANCING PAGE.                                   39100011
383300                                                                  39110011
383400     ADD 1 TO PV-PAGE-COUNT.                                      39120011
383500                                                                  39130011
383600     WRITE RPT-REC FROM HL-HDR1 AFTER 1.                          39140011
383700     WRITE RPT-REC FROM HL-HDR2 AFTER 1.                          39150011
383800     WRITE RPT-REC FROM HL-HDR3 AFTER 2.                          39160011
383900     WRITE RPT-REC FROM HL-HDR4 AFTER 1.                          39170011
384000                                                                  39180011
384100     ADD 7 TO PV-LINE-COUNT.                                      39190011
384200                                                                  39200011
384300                                                                  39210011
384400******************************************************************39220011
384500* WRITE THE DETAIL LINES FOR THE REPORT                           39230011
384600******************************************************************39240011
384700 P2000-DETAIL-LINE.                                               39250011
384800                                                                  39260011
384900     WRITE RPT-REC FROM DL-DETAIL-LINE AFTER 1.                   39270011
385000                                                                  39280011
385100     INITIALIZE DL-DETAIL-LINE.                                   39290011
385200                                                                  39300011
385300     ADD 1 TO PV-LINE-COUNT.                                      39310011
385400                                                                  39320011
385500     IF  PV-LINE-COUNT GREATER THAN PC-LINE-LIMIT                 39330011
385600         PERFORM P1000-HEADERS                                    39340011
385700     END-IF.                                                      39350011
385800                                                                  39360011
385900                                                                  39370011
386000******************************************************************39380011
386100* WRITE SPACE LINE                                                39390011
386200******************************************************************39400011
386300 P3000-DETAIL-SPACE.                                              39410011
386400                                                                  39420011
386500     WRITE RPT-REC FROM DL-DETAIL-SPACE AFTER 1.                  39430011
386600                                                                  39440011
386700     ADD 1 TO PV-LINE-COUNT.                                      39450011
386800                                                                  39460011
386900     IF  PV-LINE-COUNT GREATER THAN PC-LINE-LIMIT                 39470011
387000         PERFORM P1000-HEADERS                                    39480011
387100         MOVE ZERO TO PV-LINE-COUNT                               39490011
387200     END-IF.                                                      39500011
387300                                                                  39510011
387400                                                                  39520011
387500******************************************************************39530011
387600* WRITE THE SUB TOTALS                                            39540011
387700******************************************************************39550011
387800 T1000-SUB-TOTALS.                                                39560011
387900                                                                  39570011
388000     WRITE RPT-REC FROM HL-HDR6 AFTER 1.                          39580011
388100                                                                  39590011
388200     MOVE DD-SUB-TTL            TO DL-PRICE-CHANGE-TYPE.          39600011
388300     MOVE PA-SUB-MKDN-QTY       TO DL-MARKDOWN-QTY.               39610011
388400     MOVE PA-SUB-MKDN-AMT       TO DL-MARKDOWN-AMT.               39620011
388500     MOVE PA-SUB-MDC-QTY        TO DL-MDC-QTY.                    39630011
388600     MOVE PA-SUB-MDC-AMT        TO DL-MDC-AMT.                    39640011
388700     PERFORM P2000-DETAIL-LINE.                                   39650011
388800                                                                  39660011
388900     PERFORM P3000-DETAIL-SPACE.                                  39670011
389000     PERFORM P3000-DETAIL-SPACE.                                  39680011
389100                                                                  39690011
389200                                                                  39700011
389300******************************************************************39710011
389400* WRITE THE TOTALS                                                39720011
389500******************************************************************39730011
389600 T2000-TOTALS.                                                    39740011
389700                                                                  39750011
389800     WRITE RPT-REC FROM HL-HDR6 AFTER 1.                          39760011
389900                                                                  39770011
390000     MOVE DD-TOTAL              TO DL-PRICE-CHANGE-TYPE.          39780011
390100     MOVE PA-TTL-MKDN-QTY       TO DL-MARKDOWN-QTY.               39790011
390200     MOVE PA-TTL-MKDN-AMT       TO DL-MARKDOWN-AMT.               39800011
390300     MOVE PA-TTL-MDC-QTY        TO DL-MDC-QTY.                    39810011
390400     MOVE PA-TTL-MDC-AMT        TO DL-MDC-AMT.                    39820011
390500     PERFORM P2000-DETAIL-LINE.                                   39830011
390600                                                                  39840011
390700                                                                  39850011
390800******************************************************************39860011
390900* ABEND ROUTINE                                                   39870011
391000******************************************************************39880011
391100 Z1000-ABEND.                                                     39890011
391200                                                                  39900011
391300     PERFORM Z9000-END-PROC.                                      39910011
391400                                                                  39920011
391500     MOVE SQLCODE TO SQLCODE2.                                    39930011
391600     MOVE SQLERRD(3) TO SQLERRD3.                                 39940011
391700                                                                  39950011
391800     DISPLAY 'Z1000-ABEND'.                                       39960011
391900     DISPLAY '** ABEND           ** = SQLABEND'.                  39970011
392000     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          39980011
392100     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        39990011
392200     DISPLAY '** TABLES AFFECTED ** = ' PV-TABLE-NAME.            40000011
392300     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         40010011
392400     DISPLAY '** SQLCODE         ** = ' SQLCODE2.                 40020011
392500     DISPLAY '** ROWS PROCESSED  ** = ' SQLERRD3.                 40030011
392600     DISPLAY '** SQLERRM         ** = ' SQLERRM.                  40040011
392700     DISPLAY '** SQLERRMC        ** = ' SQLERRMC.                 40050011
392800                                                                  40060011
392900******************************************************************40070011
393000*  THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   40080011
393100*  MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        40090011
393200* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     40100011
393300*  FORMAT.                                                        40110011
393400******************************************************************40120011
393500     COPY DPPD004.                                                40130011
393600                                                                  40140011
393700     SET ABEND-4013-DB2-ERROR TO TRUE.                            40150011
393800                                                                  40160011
393900     CALL 'ILBOABN0' USING ABEND-CODE.                            40170011
394000                                                                  40180011
394100                                                                  40190011
394200******************************************************************40200024
394300* COMMIT DATABASE CHNAGES                                         40210025
394400******************************************************************40220024
394500 Z2000-COMMIT-PARA.                                               40230024
394600                                                                  40240024
394700     EXEC SQL                                                     40250024
394800         COMMIT                                                   40260024
394900     END-EXEC.                                                    40270024
395000                                                                  40280024
395100     EVALUATE TRUE                                                40290024
395200       WHEN SQLCODE = ZERO                                        40300024
395300         CONTINUE                                                 40310024
395400                                                                  40320024
395500       WHEN SQLWARN0 NOT EQUAL SPACE                              40330024
395600       WHEN SQLCODE NOT EQUAL ZERO                                40340024
395700                                                                  40350024
395800         MOVE SQLCODE             TO PV-SQLCODE                   40360024
395900         MOVE 'Z2000-COMMIT-PARA' TO PV-PARAGRAPH-NAME            40370024
396000         STRING 'ERROR ON COMMIT LOGIC - SQLCODE= '               40380024
396100            PV-SQLCODE DELIMITED BY SIZE INTO                     40390024
396200            PV-OPERATION-MSG                                      40400024
396300         END-STRING                                               40410024
396400                                                                  40420024
396500         PERFORM Z1000-ABEND                                      40430024
396600                                                                  40440024
396700     END-EVALUATE.                                                40450024
396800******************************************************************40460011
396900* PREFORMS TASK TERMINATION PROCESSING                            40470011
397000******************************************************************40480011
397100 Z9000-END-PROC.                                                  40490011
397200                                                                  40500011
397300     CLOSE POS-DATE-FILE                                          40510011
397400           INVENTORY-RPT.                                         40520011
397500                                                                  40530011
397600     PERFORM Z9100-CONTROLS.                                      40540011
397700                                                                  40550011
397800                                                                  40560011
397900******************************************************************40570011
398000* PROGRAM CONTROLS                                                40580011
398100******************************************************************40590011
398200 Z9100-CONTROLS.                                                  40600011
398300                                                                  40610011
398400     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 40620011
398500                                                                  40630011
398600     MOVE SYS-TIME (1:2) TO ST-END-HR.                            40640011
398700     MOVE SYS-TIME (3:2) TO ST-END-MN.                            40650011
398800                                                                  40660011
398900     DISPLAY '                    '.                              40670011
399000     DISPLAY '**********************'.                            40680011
399100     DISPLAY '   SAKRP061 CONTROLS  '.                            40690011
399200     DISPLAY '**********************'.                            40700011
399300     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         40710011
399400     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          40720011
399500     DISPLAY 'END TIME  = ' ST-END-TIME.                          40730011
399600     DISPLAY '======================'.                            40740011
399700     DISPLAY 'CNTL CARD: ' CC-CONTROL-CARD-DISPLAY.               40750011
399800     DISPLAY '            '.                                      40760011
399900     DISPLAY 'TRAN READ = ' PA-TRAN-READ.                         40770011
400000     DISPLAY 'ITEM READ = ' PA-ITEM-READ.                         40780011
400100     DISPLAY '                    '.                              40790011
400200     DISPLAY '    SALES = ' PA-SALE.                              40800011
400300     DISPLAY '  RETURNS = ' PA-RETURN.                            40810011
400400     DISPLAY '                    '.                              40820011
400500                                                                  40830011
400600                                                                  40840048
