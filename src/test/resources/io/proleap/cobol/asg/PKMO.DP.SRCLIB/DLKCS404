000100 TITLE  'SHIP DOOR TEMPLATE LIST'.                                00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300 PROGRAM-ID.    DLKCS404.                                         00030099
000400 AUTHOR.        DENNIS STEFFEN.                                   00040099
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050099
000600 DATE-WRITTEN.  NOVEMBER 2003.                                    00060099
000700 DATE-COMPILED.                                                   00070099
000800                                                                  00080099
263627*----------------------------------------------------------------*00081099
263627* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         00082099
263627* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00083099
263627* MAKING THE CALL DYNAMIC VS STATIC.                              00084099
      *                                                                 00084199
009461* CHANGED 10/24/2022    BY BOB MCASEY      WR: CHG0279137         00084299
009491* ADD COPYBOOK DPWS930 CHANGE CICS ARCHITECTURE CALL TO           00084399
009491* CHANGE CICS ARCHITECTURE CALL TO USE DP930-CICS-ARCH-API        00084499
263627*----------------------------------------------------------------*00085099
000900 ENVIRONMENT DIVISION.                                            00090099
001000 DATA DIVISION.                                                   00100099
001100 WORKING-STORAGE SECTION.                                         00110099
001200                                                                  00120099
001300 01  DK-DB2-KEYS.                                                 00130099
001400     05  DK-DC-NBR                    PIC S9(04) COMP VALUE ZERO. 00140099
001500                                                                  00150099
001600                                                                  00160099
001700 01  PC-PROGRAM-CONSTANTS.                                        00170099
001800     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00180099
001900                                                    'DLK404  '.   00190099
002000     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00200099
002100                                                    'DLKM404 '.   00210099
002200     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00220099
002300                                                    'DLKCS404'.   00230099
002400     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00240099
002500     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00250099
002600     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00260099
002700     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00270099
002800                                                    COMP SYNC.    00280099
002900     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00290099
003000                                                    COMP SYNC.    00300099
003100     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00310099
003200                                                    +1000000      00320099
003300                                                    COMP-3.       00330099
003400     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00340099
003500                                                    COMP SYNC.    00350099
003600     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00360099
003700                                                    COMP-3.       00370099
003800     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00380099
003900     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00390099
004000     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00400099
004100     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00410099
004200     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00420099
004300*                                                                 00430099
004400     05  PC-TSYMSG-NUMBERS.                                       00440099
004500         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00450099
004600         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00460099
004700         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00470099
004800         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00480099
004900         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00490099
005000         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00500099
005100         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00510099
005200         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00520099
005300         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00530099
005400         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00540099
005500         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00550099
005510         10  PC-TSYMSG-00657            PIC  9(05)  VALUE 00657.  00560099
005600         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00570099
005700         10  PC-TSYMSG-01305            PIC  9(05)  VALUE 01305.  00580099
005800         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00590099
005900         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  00600099
005910         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  00610099
005920         10  PC-TSYMSG-02721            PIC  9(05)  VALUE 02721.  00620099
006000         10  PC-TSYMSG-03181            PIC  9(05)  VALUE 03181.  00630099
006100         10  PC-TSYMSG-03184            PIC  9(05)  VALUE 03184.  00640099
006200         10  PC-TSYMSG-03185            PIC  9(05)  VALUE 03185.  00650099
006300         10  PC-TSYMSG-03186            PIC  9(05)  VALUE 03186.  00660099
006400         10  PC-TSYMSG-03199            PIC  9(05)  VALUE 03199.  00670099
006500         10  PC-TSYMSG-03240            PIC  9(05)  VALUE 03240.  00680099
006501         10  PC-TSYMSG-03594            PIC  9(05)  VALUE 03594.  00690099
006510         10  PC-TSYMSG-03662            PIC  9(05)  VALUE 03662.  00700099
006520*NO CURRENT ACTIVE ASSIGNMENTS FOR SELECTED TEMPLATE              00710099
006600         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  00720099
006700*                                                                 00730099
006800 01  PS-PROGRAM-SWITCHES.                                         00740099
006900     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    00750099
007000         88  PS-NO-ERROR                            VALUE 'N'.    00760099
007100         88  PS-ERROR                               VALUE 'Y'.    00770099
007110     05  PS-PROCESS-ERROR-SW             PIC  X(01)  VALUE 'N'.   00780099
007120         88  PS-PROCESS-ERROR-NO                    VALUE 'N'.    00790099
007130         88  PS-PROCESS-ERROR                       VALUE 'Y'.    00800099
007200     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00810099
007300         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00820099
007400         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00830099
007500     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    00840099
007600         88  PS-DONE                                VALUE 'Y'.    00850099
007700         88  PS-NOT-DONE                            VALUE 'N'.    00860099
007800     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    00870099
007900         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    00880099
008000         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    00890099
008010     05  PS-DC-PARM-FUNC-SW             PIC  X(01).               00900099
008020         88  PS-DC-PARM-FUNC-YES                    VALUE 'Y'.    00910099
008030         88  PS-DC-PARM-FUNC-NO                     VALUE 'N'.    00920099
008200     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    00930099
008300         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    00940099
008400         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    00950099
008500     05  PS-ACTIVE-ASSSIGNMENTS-SW      PIC  X(01)  VALUE 'N'.    00960099
008600         88  PS-ACTIVE-ASSIGNMENTS                  VALUE 'Y'.    00970099
008700         88  PS-NO-ACTIVE-ASSIGNMENTS               VALUE 'N'.    00980099
008800     05  PS-EOC-ACT-TEM-ASGMT-CSR-SW PIC     X(01)  VALUE  'N'.   00990099
008900         88  PS-EOC-ACT-TEM-ASGMT-CSR               VALUE  'Y'.   01000099
009000         88  PS-NOT-EOC-ACT-TEM-ASGMT-CSR           VALUE  'N'.   01010099
008800     05  PS-EOC-ACT-ASGMT-CSR-SW PIC         X(01)  VALUE  'N'.   01020099
008900         88  PS-EOC-ACT-ASGMT-CSR                   VALUE  'Y'.   01030099
009000         88  PS-NOT-EOC-ACT-ASGMT-CSR               VALUE  'N'.   01040099
009100*                                                                 01050099
009200 01  PV-PROGRAM-VARIABLES.                                        01060099
009300     05  PV-SUB                         PIC S9(04)  VALUE +0      01070099
009400                                                    COMP SYNC.    01080099
009500     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01090099
009600                                                    COMP SYNC.    01100099
009700     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01110099
009800                                                    COMP-3.       01120099
009900     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01130099
010000                                                    COMP-3.       01140099
010100     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01150099
010200                                                    COMP-3.       01160099
010300     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01170099
010400                                                    COMP-3.       01180099
010500     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01190099
010600                                                    COMP-3.       01200099
010700     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01210099
010800                                                    COMP-3.       01220099
010900     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01230099
011000                                                    COMP-3.       01240099
011100     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01250099
011200                                                    COMP SYNC.    01260099
011300     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01270099
011400                                                    COMP SYNC.    01280099
011500     05  PV-ITEM                        PIC S9(04)  VALUE +0      01290099
011600                                                    COMP SYNC.    01300099
011700     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01310099
011800                                                    COMP SYNC.    01320099
011900     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01330099
012000                                                    COMP SYNC.    01340099
012100     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01350099
012200                                                    COMP SYNC.    01360099
012300     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01370099
012400                                                    COMP SYNC.    01380099
012500     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01390099
012600                                                    COMP SYNC.    01400099
012700     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01410099
012800                                                    COMP SYNC.    01420099
012900     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01430099
013000                                                    COMP SYNC.    01440099
013100     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01450099
013200                                                    COMP SYNC.    01460099
013300     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01470099
013400                                                    COMP SYNC.    01480099
013500     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01490099
013600                                                    COMP SYNC.    01500099
013700     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01510099
013800                                                    COMP SYNC.    01520099
013900     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01530099
014000                                                    COMP SYNC.    01540099
014100     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01550099
014200                                                    COMP SYNC.    01560099
014300                                                                  01570099
014400                                                                  01580099
014500                                                                  01590099
014600     05  PV-TEMPLATE-STATUS           PIC X(08) VALUE SPACE.      01600099
014700     05  PV-TEMPLATE-DOOR-COUNT       PIC S9(05) COMP-3.          01610099
014800     05  PV-ACTV-TEM-ASGMT-COUNT      PIC S9(05) COMP-3.          01620099
014800     05  PV-ACTV-ASGMT-COUNT          PIC S9(05) COMP-3.          01630099
014810     05  PV-DOOR-COUNT                PIC S9(05) COMP-3.          01640099
014900     05  PV-ACTIVE-ASSIGNMENTS        PIC S9(05) COMP-3.          01650099
015000     05  PV-GROUP-COUNT               PIC S9(05) COMP-3.          01660099
015100     05  PV-COMMAREA-LENGTH           PIC S9(04) COMP VALUE ZERO. 01670099
015200     05  PV-SOFT-ABORT-MSG.                                       01680099
015300         10  FILLER            PIC X(12) VALUE ' DLKCS404 - '.    01690099
015400         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       01700099
015500         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    01710099
015600         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    01720099
015700         10  PV-SOFT-PARAGRAPH PIC X(30).                         01730099
015800     05  PV-CICS-MSG-AREA2            PIC  X(100) VALUE SPACE.    01740099
015900     05  PV-DISPLAY-OPER              PIC  9(04) VALUE ZEROES.    01750099
015901     05  PV-DISPLAY-SQLCODE           PIC  9(04)  VALUE ZERO.     01760099
015902     05  PV-DISPLAY-ASGMT-NBR         PIC  9(09)  VALUE ZERO.     01770099
015903     05  PV-DISPLAY-TEM-ASGMT-NBR     PIC  9(09)  VALUE ZERO.     01780099
015910     05  PV-USER-ID-KOHL-TEMP-IND     PIC  X(01) VALUE SPACES.    01790099
015920     05  PV-LABOR-CURRENT-TIMESTAMP   PIC  X(26).                 01800099
P50752*START PRB0050752                                                 01810099
P50752     05  PV-END-ASGMNT-ERROR-MSG      PIC  X(65).                 01820099
P50752     05  PV-SQL-ERROR-CODE            PIC  X(50).                 01830099
P50752     05  PV-SQL-CODE                  PIC  9(10).                 01840099
P50752     05  PV-KEY-NBR-SEQ-NBR           PIC  9(09).                 01850099
P50752*END PRB0050752                                                   01860099
015930 01  DN-NULL-INDICATORS.                                          01870099
015940     05  DN-KOHLS-USR-NULL            PIC S9(04) COMP VALUE ZERO. 01880099
015950     05  DN-TEMP-USR-NULL             PIC S9(04) COMP VALUE ZERO. 01890099
016000                                                                  01900099
016100******************************************************************01910099
016200**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01920099
016300**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01930099
016400**  APPLICATION-SPECIFIC COMMAREA.                              **01940099
016500******************************************************************01950099
016600 01  LQW-LIST-QUEUE-WORK-AREA.                                    01960099
016700     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01970099
016800     05  LQW-ITEM-ENTRIES               OCCURS 13 TIMES           01980099
016900                                        INDEXED BY LQW-IDX.       01990099
017000         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02000099
017100         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02010099
017200         10  LQW-SELECTED-SW            PIC  X(01).               02020099
017300             88  LQW-SELECT                         VALUE 'S'.    02030099
017400             88  LQW-DESELECT                       VALUE ' '.    02040099
017500                                                                  02050099
017600         10  LQW-ACTION                 PIC  X(03).               02060099
017700         10  LQW-TEMPLATE-DESC        PIC  X(40).                 02070099
017800         10  LQW-TEMPLATE-NBR         PIC  9(04).                 02080099
017900         10  LQW-TEMPLATE-STATUS      PIC  X(08).                 02090099
018000         10  LQW-GROUP-TOTAL          PIC  9(05).                 02100099
018100         10  LQW-DOOR-COUNT           PIC  9(05).                 02110099
018200/                                                                 02120099
018300*---------------------------------------------------------------* 02130099
018400*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 02140099
018500*---------------------------------------------------------------* 02150099
018600                                                                  02160099
018700*    COPY DPWS057.                                                02170099
018800     COPY DLWS006.                                                02180099
018900                                                                  02190099
019000/                                                                 02200099
019100*---------------------------------------------------------------* 02210099
019200*    MAP LAYOUT                                                 * 02220099
019300*---------------------------------------------------------------* 02230099
019400                                                                  02240099
019500     COPY DLKM404.                                                02250099
019600*                                                                 02260099
019700 01  MR-OCCURS-LAYOUT                   REDEFINES  DLK404O.       02270099
019800     05  FILLER                         PIC X(093).               02280099
019900     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          02290099
020000         10  MR-SELECTL                 PIC S9(04) COMP.          02300099
020100         10  MR-SELECTA                 PIC  X(01).               02310099
020200         10  MR-SELECTC                 PIC  X(01).               02320099
020300         10  MR-SELECTH                 PIC  X(01).               02330099
020400         10  MR-SELECTI                 PIC  X(01).               02340099
020500                                                                  02350099
020600         10  MR-ACTIONL                 PIC S9(04) COMP.          02360099
020700         10  MR-ACTIONA                 PIC  X(01).               02370099
020800         10  MR-ACTIONC                 PIC  X(01).               02380099
020900         10  MR-ACTIONH                 PIC  X(01).               02390099
021000         10  MR-ACTION                  PIC  X(03).               02400099
021100                                                                  02410099
021200         10  MR-TEMPLATE-DESC-L       PIC S9(04) COMP.            02420099
021300         10  MR-TEMPLATE-DESCA        PIC  X(01).                 02430099
021400         10  MR-TEMPLATE-DESCC        PIC  X(01).                 02440099
021500         10  MR-TEMPLATE-DESCH        PIC  X(01).                 02450099
021600         10  MR-TEMPLATE-DESC         PIC  X(40).                 02460099
021700                                                                  02470099
021800         10  MR-TEMPLATE-NBR-L        PIC S9(04) COMP.            02480099
021900         10  MR-TEMPLATE-NBRA         PIC  X(01).                 02490099
022000         10  MR-TEMPLATE-NBRC         PIC  X(01).                 02500099
022100         10  MR-TEMPLATE-NBRH         PIC  X(01).                 02510099
022200         10  MR-TEMPLATE-NBR          PIC  9(04) BLANK ZERO.      02520099
022300                                                                  02530099
022400         10  MR-TEMPLATE-STATUS-L     PIC S9(04) COMP.            02540099
022500         10  MR-TEMPLATE-STATUSA      PIC  X(01).                 02550099
022600         10  MR-TEMPLATE-STATUSC      PIC  X(01).                 02560099
022700         10  MR-TEMPLATE-STATUSH      PIC  X(01).                 02570099
022800         10  MR-TEMPLATE-STATUS       PIC  X(08).                 02580099
022900                                                                  02590099
023000         10  MR-GROUP-TOTAL-L         PIC S9(04) COMP.            02600099
023100         10  MR-GROUP-TOTALA          PIC  X(01).                 02610099
023200         10  MR-GROUP-TOTALC          PIC  X(01).                 02620099
023300         10  MR-GROUP-TOTALH          PIC  X(01).                 02630099
023400         10  MR-GROUP-TOTAL           PIC  Z(05).                 02640099
023500                                                                  02650099
023600         10  MR-DOOR-TOTAL-L          PIC S9(04) COMP.            02660099
023700         10  MR-DOOR-TOTALA           PIC  X(01).                 02670099
023800         10  MR-DOOR-TOTALC           PIC  X(01).                 02680099
023900         10  MR-DOOR-TOTALH           PIC  X(01).                 02690099
024000         10  MR-DOOR-TOTAL            PIC  Z(05).                 02700099
024100/                                                                 02710099
024200*---------------------------------------------------------------* 02720099
024300*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02730099
024400*---------------------------------------------------------------* 02740099
024500                                                                  02750099
024600     COPY DPWS015.                                                02760099
024700                                                                  02770099
024800*---------------------------------------------------------------* 02780099
024900*    FUNCTION KEYS COPYBOOK.                                    * 02790099
025000*---------------------------------------------------------------* 02800099
025100                                                                  02810099
025200     COPY DPWS016.                                                02820099
025300                                                                  02830099
025400*---------------------------------------------------------------* 02840099
025500*    NUMERIC EDIT LAYOUT.                                       * 02850099
025600*---------------------------------------------------------------* 02860099
025700                                                                  02870099
025800     COPY DPWS010I.                                               02880099
025900 EJECT                                                            02890099
026000*---------------------------------------------------------------* 02900099
026100*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 02910099
026200*---------------------------------------------------------------* 02920099
026300                                                                  02930099
026400     COPY DPWS030.                                                02940099
1022RM     COPY DPWS930.                                                02941099
026500 EJECT                                                            02950099
026600*---------------------------------------------------------------* 02960099
026700*    STANDARD COMMAREA.                                         * 02970099
026800*---------------------------------------------------------------* 02980099
026900                                                                  02990099
027000     COPY DPWS020.                                                03000099
027100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03010099
027200                                                                  03020099
027300*---------------------------------------------------------------* 03030099
027400* INTER-APPLICATION COMMAREA.                                   * 03040099
027500*   DPWS054 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 03050099
027600*             SPEC SCREEN.                                      * 03060099
027700*   DPWS056 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 03070099
027800*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 03080099
027900*---------------------------------------------------------------* 03090099
028000                                                                  03100099
028100         10  INTER-APPL-COMM-AREA       PIC X(200).               03110099
028200     COPY DLWS002.                                                03120099
028300*---------------------------------------------------------------* 03130099
028400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03140099
028500*---------------------------------------------------------------* 03150099
028600         10  ASC-SPECIFIC-COMMAREA.                               03160099
028700             15  ASC-LIST-KEYS.                                   03170099
028800                 20  ASC-KEY-OPER-UNT-ID                          03180099
028900                                      PIC S9(04) COMP.            03190099
029000                 20  ASC-KEY-OPER-DESC                            03200099
029100                                      PIC X(40).                  03210099
029200                 20  ASC-KEY-DOOR-COUNT                           03220099
029300                                      PIC S9(04) COMP.            03230099
029400                                                                  03240099
029410             15  ASC-CONFIRM-INACTV-SW        PIC  X(01).         03250099
029420                 88  ASC-CONFIRM-INACTV          VALUE 'I'.       03260099
029430                 88  ASC-NO-CONFIRM-INACTV       VALUE 'N'.       03270099
029440             15  ASC-CONFIRM-ISTOP-SW         PIC  X(01).         03280099
029450                 88  ASC-CONFIRM-ISTOP           VALUE 'I'.       03290099
029460                 88  ASC-NO-CONFIRM-ISTOP        VALUE 'N'.       03300099
029500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03310099
029600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03320099
029700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03330099
029800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03340099
029900                                                                  03350099
030000                 20  ASC-ITEM-ARRAY.                              03360099
030100                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        03370099
030200                         30  ASC-LIST-ITEM-NUMBER                 03380099
030300                                                     PIC S9(09)   03390099
030400                                                     COMP-3.      03400099
030500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03410099
030600                             88  ASC-VALID-SELECT    VALUE ' '    03420099
030700                                                           'S'    03430099
030800                                                           'B'    03440099
030900                                                           'E'.   03450099
031000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03460099
031100                             88  ASC-TEMP-SELECT     VALUE 'S'.   03470099
031200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03480099
031300                             88  ASC-TEMP-END        VALUE 'E'.   03490099
031400                         30  ASC-SELECTED-SW         PIC  X(01).  03500099
031500                             88  ASC-NO-SELECT       VALUE ' '.   03510099
031600                             88  ASC-SELECT          VALUE 'S'.   03520099
031700                             88  ASC-BEGIN           VALUE 'B'.   03530099
031800                             88  ASC-END             VALUE 'E'.   03540099
031900                                                                  03550099
032000                         30  ASC-ACTION              PIC  X(03).  03560099
032100                         30  ASC-TEMPLATE-DESC        PIC  X(40). 03570099
032200                         30  ASC-TEMPLATE-NBR         PIC  9(04). 03580099
032300                         30  ASC-TEMPLATE-STATUS      PIC  X(08). 03590099
032310                             88  ASC-TEMPLATE-ACTIVE              03600099
032320                                 VALUE 'ACTIVE'.                  03610099
032330                             88  ASC-TEMPLATE-INACTIVE            03620099
032340                                 VALUE 'INACTIVE'.                03630099
032400                         30  ASC-GROUP-TOTAL          PIC  9(05). 03640099
032500                         30  ASC-DOOR-COUNT           PIC  9(05). 03650099
032600                                                                  03660099
032700             15  ASC-BLK-SUB                         PIC S9(04)   03670099
032800                                                          COMP    03680099
032900                                                          SYNC.   03690099
033000             15  ASC-ITEM-SUB                        PIC S9(04)   03700099
033100                                                          COMP    03710099
033200                                                          SYNC.   03720099
033300             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   03730099
033400                                                          COMP-3. 03740099
033500             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   03750099
033600                                                          COMP-3. 03760099
033700             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   03770099
033800                                                          COMP-3. 03780099
033900             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   03790099
034000                                                          COMP-3. 03800099
034100             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   03810099
034200                                                          COMP-3. 03820099
034300             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   03830099
034400                                                          COMP    03840099
034500                                                          SYNC.   03850099
034600             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   03860099
034700                                                          COMP-3. 03870099
034800             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   03880099
034900                                                          COMP-3. 03890099
035000             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  03900099
035100                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   03910099
035200                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   03920099
035300             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  03930099
035400                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   03940099
035500                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   03950099
035600             15  ASC-LIST-QUEUE-NAME.                             03960099
035700                 20  ASC-LIST-TERM-ID                PIC  X(04).  03970099
035800                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   03980099
035900                                                          COMP-3. 03990099
036000                 20  ASC-LIST-SEQ                    PIC  9(01).  04000099
036100             15  ASC-SEL-QUEUE-NAME.                              04010099
036200                 20  ASC-SEL-TERM-ID                 PIC  X(04).  04020099
036300                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   04030099
036400                                                          COMP-3. 04040099
036500                 20  ASC-SEL-SEQ                     PIC  9(01).  04050099
036600                                                                  04060099
036700             15  ASC-CURSOR-SW                       PIC  X(01).  04070099
036800                 88  ASC-NO-CURSOR                   VALUE 'Z'.   04080099
036900                 88  ASC-SYSTEM-ID-CURSOR            VALUE 'S'.   04090099
037000                 88  ASC-MESSAGE-NUMBER-CURSOR       VALUE 'N'.   04100099
037100                 88  ASC-MESSAGE-TEXT-CURSOR         VALUE 'T'.   04110099
037200             15  ASC-START-ITEM-REQUEST.                          04120099
037300                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  04130099
037400             15  ASC-FUNCTION-SW      PIC X(01).                  04140099
037500                 88  ASC-ADD-FUNCTION    VALUE 'A'.               04150099
037600                 88  ASC-UPDATE-FUNCTION VALUE 'U'.               04160099
037700                 88  ASC-OTHER-FUNCTION  VALUE 'O'.               04170099
037800/                                                                 04180099
037900*---------------------------------------------------------------* 04190099
038000*    ABEND PROCESSING COPYBOOK.                                 * 04200099
038100*---------------------------------------------------------------* 04210099
038200                                                                  04220099
038300     COPY DPWS013.                                                04230099
038400*----------------------------------------------------------------*04240099
038500**  SECURITY SUBROUTINE PARAMETERS                                04250099
038600*----------------------------------------------------------------*04260099
038700     COPY DPWS008.                                                04270099
038710*----------------------------------------------------------------*04280099
038720**  XL072-EAI-EXPORT-COMMAREA                                     04290099
038730*----------------------------------------------------------------*04300099
038740     COPY XLWS072.                                                04310099
038800                                                                  04320099
038810*----------------------------------------------------------------*04330099
038820**  ASSIGNMENT COMMAREA                                           04340099
038830*----------------------------------------------------------------*04350099
038840     COPY DLWS005.                                                04360099
038850                                                                  04370099
038900/                                                                 04380099
039000     EXEC SQL                                                     04390099
039100          INCLUDE TCNDCDR                                         04400099
039200     END-EXEC.                                                    04410099
039300                                                                  04420099
039400*    DLT_DOOR_GP_TMPL                                             04430099
039500     EXEC SQL                                                     04440099
039600          INCLUDE DLT00000                                        04450099
039700     END-EXEC.                                                    04460099
039800                                                                  04470099
039900*    DLT_DOOR_GP                                                  04480099
040000     EXEC SQL                                                     04490099
040100          INCLUDE DLT00001                                        04500099
040101     END-EXEC.                                                    04510099
040102                                                                  04520099
040103     EXEC SQL                                                     04530099
040104         INCLUDE DLT00004                                         04540099
040105     END-EXEC.                                                    04550099
040106                                                                  04560099
040107*    XLT_LOC                                                      04570099
040108     EXEC SQL                                                     04580099
040109          INCLUDE XLT00010                                        04590099
040110     END-EXEC.                                                    04600099
040120                                                                  04610099
040126*    DLT_TEM_ASGMT                                                04620099
040127     EXEC SQL                                                     04630099
040128          INCLUDE DLT00003                                        04640099
040129     END-EXEC.                                                    04650099
040130                                                                  04660099
040131*    TKRPRPM                                                      04670099
040132     EXEC SQL                                                     04680099
040133          INCLUDE TKRPRPM                                         04690099
040134     END-EXEC.                                                    04700099
040135                                                                  04710099
040136*    DB2 AREA FOR COMMUNICATIONS                                * 04720099
040140     EXEC SQL                                                     04730099
040150          INCLUDE SQLCA                                           04740099
040160     END-EXEC.                                                    04750099
040170/                                                                 04760099
040180*    TEMPLATE CURSOR                                              04770099
040190     EXEC SQL                                                     04780099
040200         DECLARE TEMPLATE-CSR CURSOR FOR                          04790099
040300             SELECT  TMP.DOOR_GP_TMPL_DESC                        04800099
040400                 ,   TMP.DOOR_GP_TMPL_ID                          04810099
040500                 ,   CASE                                         04820099
040600                         WHEN TMP.ACTV_IND = 'Y'                  04830099
040700                         THEN 'ACTIVE  '                          04840099
040800                         ELSE 'INACTIVE'                          04850099
040900                     END                                          04860099
041000             FROM   DLT_DOOR_GP_TMPL TMP                          04870099
041100             WHERE   TMP.DC_NBR  = :DK-DC-NBR                     04880099
041200             ORDER BY                                             04890099
041300                 TMP.ACTV_IND    DESC                             04900099
041400             ,   TMP.DOOR_GP_TMPL_DESC                            04910099
041500     END-EXEC.                                                    04920099
041600                                                                  04930099
041700     EXEC SQL                                                     04940099
041800         DECLARE ACT-TEM-ASGMT-CSR CURSOR WITH HOLD FOR           04950099
041810            SELECT A.ASGMT_STRT_DTE                               04960099
041820                 , A.ASGMT_NBR_TXT                                04970099
041830                 , A.ASGMT_NBR_SEQ_NBR                            04980099
041831                 , B.TEM_ASGMT_SEQ_NBR                            04990099
041832                 , CASE                                           05000099
041833                     WHEN B.KOHLS_USR_ID IS NOT NULL              05010099
041834                      THEN 'KOHLS'                                05020099
041835                      ELSE                                        05030099
041836                         'TEMP'                                   05040099
041837                      END                                         05050099
041838                ,  B.KOHLS_USR_ID                                 05060099
041839                ,  B.TMP_USR_ID                                   05070099
041860             FROM DLT_ASGMT         A                             05080099
041870                , DLT_TEM_ASGMT     B                             05090099
041880            WHERE A.WK_TYP_DESC       = 'SHIP'                    05100099
041890              AND A.DC_NBR            = :DK-DC-NBR                05110099
041891              AND A.ASGMT_STP_RSN_CDE = 'N'                       05120099
041892              AND A.ASGMT_STRT_DTE    = B.ASGMT_STRT_DTE          05130099
041893              AND A.ASGMT_NBR_TXT     = B.ASGMT_NBR_TXT           05140099
041894              AND A.ASGMT_NBR_SEQ_NBR = B.ASGMT_NBR_SEQ_NBR       05150099
041895              AND B.LVE_RSN_CDE       = 'N'                       05160099
042700     END-EXEC.                                                    05170099
042800                                                                  05180099
           EXEC SQL                                                     05190099
               DECLARE ACT-ASGMT-CSR CURSOR WITH HOLD FOR               05200099
                SELECT A.ASGMT_STRT_DTE                                 05210099
                     , A.ASGMT_NBR_TXT                                  05220099
                     , A.ASGMT_NBR_SEQ_NBR                              05230099
                  FROM DLT_ASGMT A                                      05240099
                 WHERE A.WK_TYP_DESC       = 'SHIP'                     05250099
                   AND A.DC_NBR            = :DK-DC-NBR                 05260099
                   AND A.ASGMT_STP_RSN_CDE = 'N'                        05270099
                   AND NOT EXISTS                                       05280099
                      (SELECT B.ASGMT_NBR_SEQ_NBR                       05290099
                         FROM DLT_TEM_ASGMT B                           05300099
                        WHERE A.ASGMT_STRT_DTE    = B.ASGMT_STRT_DTE    05310099
                          AND A.ASGMT_NBR_TXT     = B.ASGMT_NBR_TXT     05320099
                          AND A.ASGMT_NBR_SEQ_NBR = B.ASGMT_NBR_SEQ_NBR 05330099
                          AND B.LVE_RSN_CDE       = 'N')                05340099
042700     END-EXEC.                                                    05350099
042900 EJECT                                                            05360099
043000 LINKAGE SECTION.                                                 05370099
043100                                                                  05380099
043200 01  DFHCOMMAREA.                                                 05390099
043300     05  FILLER                         OCCURS  1 TO 4072 TIMES   05400099
043400                                        DEPENDING ON EIBCALEN.    05410099
043500         10  FILLER                     PIC X.                    05420099
043600                                                                  05430099
043700/                                                                 05440099
043800 PROCEDURE DIVISION.                                              05450099
043900******************************************************************05460099
044000**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **05470099
044100**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **05480099
044200**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **05490099
044300******************************************************************05500099
044400 0000-MAIN-MODULE.                                                05510099
044500     INITIALIZE DP030-CICS-API-FIELDS.                            05520099
044600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05530099
044700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05540099
044800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05550099
044900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05560099
045000     MOVE LENGTH OF DLK404I        TO DP030-MAP-LENGTH (1).       05570099
045100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05580099
045200     PERFORM 0001-CALL-CICS-ARCH-API.                             05590099
045300*                                                                 05600099
045400     PERFORM 1000-CONTROL-PROCESSING                              05610099
045500*                                                                 05620099
045600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05630099
045700     PERFORM 0001-CALL-CICS-ARCH-API.                             05640099
045800                                                                  05650099
045900******************************************************************05660099
046000**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **05670099
046100**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **05680099
046200******************************************************************05690099
046300 0001-CALL-CICS-ARCH-API.                                         05700099
046400     CALL DP930-CICS-ARCH-API  USING DFHEIBLK                     05710099
046500                                     DFHCOMMAREA                  05720099
046600                                     DP030-CICS-API-FIELDS        05730099
046700                                     DP020-STANDARD-COMMAREA      05740099
046800                                     DLK404I.                     05750099
046900*                                                                 05760099
047000     IF  DP030-RC-CALL-SUCCESSFUL                                 05770099
047100         CONTINUE                                                 05780099
047200     ELSE                                                         05790099
047300         SET DP013-NO-ROLLBACK                                    05800099
047400             DP013-XCTL-DISPLAY-RESTART                           05810099
047500             DP013-CICS-ABEND      TO TRUE                        05820099
047600         MOVE '0001-CALL-CICS-ARCH-API'                           05830099
047700                                   TO DP013-PARAGRAPH             05840099
1022RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05861099
1022RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05862099
048000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05870099
048100         PERFORM DP013-0000-PROCESS-ABEND                         05880099
048200     END-IF.                                                      05890099
048300*----------------------------------------------------------------*05900099
048400* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05910099
048500* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05920099
048600*                                                                *05930099
048700* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05940099
048800*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05950099
048900*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05960099
049000*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05970099
049100*----------------------------------------------------------------*05980099
049200                                                                  05990099
049300 1000-CONTROL-PROCESSING.                                         06000099
049400                                                                  06010099
049500     EVALUATE TRUE                                                06020099
049600         WHEN DP020-NEXT-ACT-INITIAL                              06030099
049700             INITIALIZE ASC-SPECIFIC-COMMAREA                     06040099
049800             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            06050099
049900                                      ASC-SEL-TERM-ID             06060099
050000             MOVE DP020-SRC-TASK-NUMBER                           06070099
050100                                   TO ASC-LIST-TASK-NUMBER        06080099
050200                                      ASC-SEL-TASK-NUMBER         06090099
050300             MOVE PC-LIST-QUEUE-SEQ                               06100099
050400                                   TO ASC-LIST-SEQ                06110099
050500             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 06120099
050600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 06130099
050700***-----$TEMPLATE NOTE$-------------------------------------------06140099
050800*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,06150099
050900*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  06160099
051000*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.06170099
051100***---------------------------------------------------------------06180099
051200             IF  PS-COMMAREA-NOT-VALID                            06190099
051300***              MOVE PC-TSYMSG-99901                             06200099
051400***                                TO DP020-MSG-NUMBER            06210099
051500***              SET DP020-MSG-FATAL                              06220099
051600***                                TO TRUE                        06230099
051700                 SET DP020-NEXT-ACT-APPL-ERROR                    06240099
051800                                   TO TRUE                        06250099
051900             ELSE                                                 06260099
052000                 PERFORM 4000-BUILD-INITIAL-PANEL                 06270099
052100             END-IF                                               06280099
052200                                                                  06290099
052300         WHEN DP020-NEXT-ACT-READ-MAP                             06300099
052400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06310099
052500                                   TO PV-TOP-ITEM                 06320099
052600             PERFORM 2000-PROCESS-PANEL                           06330099
052700                                                                  06340099
052800         WHEN DP020-NEXT-ACT-RETURN                               06350099
052900                                                                  06360099
053000             IF ASC-ADD-FUNCTION OR ASC-UPDATE-FUNCTION           06370099
053100                 MOVE ASC-KEY-OPER-UNT-ID                         06380099
053200                                       TO DK-DC-NBR               06390099
053300                 PERFORM 2050-DELETE-LIST-QUEUE                   06400099
053400                 PERFORM 4000-BUILD-INITIAL-PANEL                 06410099
053500             ELSE                                                 06420099
053600                 MOVE ASC-ITEM-AT-TOP-OF-PANEL                    06430099
053700                                      TO PV-TOP-ITEM              06440099
053800                 MOVE ZERO            TO ASC-ITEM-AT-TOP-OF-PANEL 06450099
053900                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             06460099
054000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06470099
054100             END-IF                                               06480099
054200                                                                  06490099
054300         WHEN OTHER                                               06500099
054400             SET DP013-LOGIC-ABEND TO TRUE                        06510099
054500             SET DP013-NO-ROLLBACK TO TRUE                        06520099
054600             MOVE '1000-CONTROL-PROCESSING'                       06530099
054700                                   TO DP013-PARAGRAPH             06540099
054800             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    06550099
054900                                   TO DP013-MESSAGE-TEXT(1)       06560099
055000             PERFORM DP013-0000-PROCESS-ABEND                     06570099
055100     END-EVALUATE.                                                06580099
055200                                                                  06590099
055300 EJECT                                                            06600099
055400*----------------------------------------------------------------*06610099
055500* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06620099
055600* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06630099
055700*----------------------------------------------------------------*06640099
055800                                                                  06650099
055900 1100-PROCESS-INTER-APPL-COMM.                                    06660099
056000                                                                  06670099
056100     SET PS-COMMAREA-VALID         TO TRUE.                       06680099
056200     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     06690099
056300*    IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          06700099
056400*        MOVE DP054-MESSAGE-TEXT                                  06710099
056500*                                  TO ASC-KEY-MESSAGE-TEXT        06720099
056600*                                     DK-MESSAGE-TEXT             06730099
056700*        MOVE DP054-MESSAGE-NUMBER                                06740099
056800*                                  TO ASC-KEY-MESSAGE-NUMBER      06750099
056900*                                     DK-MESSAGE-NUMBER           06760099
057000*        MOVE DP054-SYSTEM-ID      TO ASC-KEY-SYSTEM-ID           06770099
057100*                                     DK-SYSTEM-ID                06780099
057200*        MOVE DP054-REVIEW-IND     TO ASC-KEY-REVIEW-IND          06790099
057300*                                     DK-REVIEW-IND               06800099
057400*    ELSE                                                         06810099
057500                                                                  06820099
057600     MOVE DP020-LOCATION-NBR          TO DK-DC-NBR                06830099
057700                                         ADCO                     06840099
057800                                         ASC-KEY-OPER-UNT-ID.     06850099
057900                                                                  06860099
058000     PERFORM 7010-LOCATION-DESC.                                  06870099
058100     MOVE ASC-KEY-OPER-DESC           TO ADCNMEO.                 06880099
058200                                                                  06890099
058300     PERFORM 7000-COUNT-DOORS.                                    06900099
058400     MOVE PV-DOOR-COUNT               TO DL002-DOOR-COUNT         06910099
058500                                         ASC-KEY-DOOR-COUNT       06920099
058600                                         ATDOORO.                 06930099
058700                                                                  06940099
058800                                                                  06950099
058900*    IF  DP020-NAV-KEY-DATA > SPACE                               06960099
059000*        MOVE DP020-NAV-KEY-DATA                                  06970099
059100*                                  TO DK-MESSAGE-TEXT             06980099
059200*                                     ASC-KEY-MESSAGE-TEXT        06990099
059300*    END-IF.                                                      07000099
059400*    END-IF.                                                      07010099
059500                                                                  07020099
059600 EJECT                                                            07030099
059700*----------------------------------------------------------------*07040099
059800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *07050099
059900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *07060099
060000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *07070099
060100* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *07080099
060200* FUNCTION KEYS CAN GET THIS FAR.                                *07090099
060300*----------------------------------------------------------------*07100099
060400                                                                  07110099
060500 2000-PROCESS-PANEL.                                              07120099
060600     EVALUATE TRUE                                                07130099
060700         WHEN DP020-SRC-AID = DP016-CLEAR                         07140099
060800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    07150099
060900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07160099
061000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07170099
061100                                                                  07180099
061200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    07190099
061300             MOVE ASC-KEY-OPER-UNT-ID                             07200099
061400                                   TO DK-DC-NBR                   07210099
061500             PERFORM 2050-DELETE-LIST-QUEUE                       07220099
061600             PERFORM 4000-BUILD-INITIAL-PANEL                     07230099
061700                                                                  07240099
061800         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    07250099
061900             PERFORM 2140-DESELECT-ALL-ITEMS                      07260099
062000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07270099
062100                                                                  07280099
062200         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  07290099
062300             PERFORM 2150-SELECT-ALL-ITEMS                        07300099
062400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07310099
062500                                                                  07320099
062600         WHEN OTHER                                               07330099
062700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07340099
062800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07350099
062900             IF  PS-NO-ERROR                                      07360099
063000                 SET DP030-CONTINUE-GO                            07370099
063100                                 TO TRUE                          07380099
063200                 PERFORM 2100-CHECK-FUNCTION-KEY                  07390099
063300             ELSE                                                 07400099
063400                 SET DP030-OVERRIDE-GO                            07410099
063500                                 TO TRUE                          07420099
063600             END-IF                                               07430099
063700     END-EVALUATE.                                                07440099
063800 EJECT                                                            07450099
063900*----------------------------------------------------------------*07460099
064000*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *07470099
064100*----------------------------------------------------------------*07480099
064200 2050-DELETE-LIST-QUEUE.                                          07490099
064300                                                                  07500099
064400     EXEC CICS                                                    07510099
064500         DELETEQ TS                                               07520099
064600             QUEUE (ASC-LIST-QUEUE-NAME)                          07530099
064700             RESP  (PV-CICS-RESP)                                 07540099
064800     END-EXEC.                                                    07550099
064900                                                                  07560099
065000     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       07570099
065100        (PV-CICS-RESP = DFHRESP(QIDERR))                          07580099
065200         CONTINUE                                                 07590099
065300     ELSE                                                         07600099
065400         SET DP013-CICS-ABEND      TO TRUE                        07610099
065500         SET DP013-NO-ROLLBACK     TO TRUE                        07620099
065600                                                                  07630099
065700         MOVE '2050-DELETE-LIST-QUEUE'                            07640099
065800                                   TO DP013-PARAGRAPH             07650099
065900         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    07660099
066000                                   TO DP013-MESSAGE-TEXT (1)      07670099
066100         PERFORM DP013-0000-PROCESS-ABEND                         07680099
066200     END-IF.                                                      07690099
066300                                                                  07700099
066400     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  07710099
066500/                                                                 07720099
066600*----------------------------------------------------------------*07730099
066700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*07740099
066800* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *07750099
066900* CICS ARCHITECTURE API.                                         *07760099
067000*----------------------------------------------------------------*07770099
067100 2100-CHECK-FUNCTION-KEY.                                         07780099
067200     EVALUATE TRUE                                                07790099
067300         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               07800099
067400*            ADD A TEMPLATE (DLKCS405)                            07810099
067500             SET ASC-ADD-FUNCTION     TO TRUE                     07820099
067600                                                                  07830099
067700         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              07840099
067800*            ACTIVATE A TEMPLATE                                  07850099
067900             SET ASC-OTHER-FUNCTION   TO TRUE                     07860099
068000             EVALUATE TRUE                                        07870099
068100               WHEN ASC-NUMBER-OF-SELECTED-ITEMS = 1              07880099
068200                 MOVE 'DLACTIVT'      TO DP008-FUNCTION-NAME      07890099
068300                 PERFORM 2105-RACF-ACCESS                         07900099
068400                 IF  PS-ACCESS-NOT-ALLOWED                        07910099
068500                     SET  PS-ERROR                                07920099
068600                          DP020-MSG-FATAL TO TRUE                 07930099
068700*                        YOU DO NOT HAVE THE AUTHORITY            07940099
068800*                          TO ADD/UPDATE A SHIP DOOR TEMPLATE     07950099
068900                     MOVE PC-TSYMSG-03199 TO DP020-MSG-NUMBER     07960099
069000                     MOVE -1              TO MR-SELECTL (1)       07970099
069100                     SET  DP030-SET-CURSOR-APPL-1 TO TRUE         07980099
069200                     SET DP030-OVERRIDE-GO       TO TRUE          07990099
069300                 ELSE                                             08000099
069400                 PERFORM 2500-COUNT-ACTIVE-ASSIGMENTS             08010099
069500                     IF PS-ACTIVE-ASSIGNMENTS                     08020099
069600                         SET  PS-ERROR                            08030099
069700                              DP020-MSG-FATAL TO TRUE             08040099
069800*                          CAN'T ACTIVATE TEMPLATE - ASSIGNMENTS  08050099
069900*                          FOR OLD TEMPLATE MUST BE CLOSED FIRST  08060099
070000                         MOVE PC-TSYMSG-03240 TO DP020-MSG-NUMBER 08070099
070100                         MOVE -1              TO MR-SELECTL (1)   08080099
070200                         SET  DP030-SET-CURSOR-APPL-1 TO TRUE     08090099
070300                         SET DP030-OVERRIDE-GO       TO TRUE      08100099
070400                     ELSE                                         08110099
070500                         PERFORM 2100A-ACTIVATE-PROCESS           08120099
070600                     END-IF                                       08130099
070700                 END-IF                                           08140099
070710             END-EVALUATE                                         08150099
070720                                                                  08160099
070730**GB 5/15/09 BEG                                                  08170099
070810         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              08180099
070811         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              08190099
070812             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              08200099
070813               CONTINUE                                           08210099
070817             ELSE                                                 08220099
070818                SET  PS-ERROR                                     08230099
070819                     DP020-MSG-FATAL TO TRUE                      08240099
070822                MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER          08250099
070823                MOVE -1              TO MR-SELECTL (1)            08260099
070824                SET  DP030-SET-CURSOR-APPL-1 TO TRUE              08270099
070825                SET DP030-OVERRIDE-GO       TO TRUE               08280099
070832             END-IF                                               08290099
070833**GB 5/15/09 END                                                  08300099
070834**F23 ENDSHIP                                                     08310099
070835                                                                  08320099
070836         WHEN DP020-FK-CONFIRM (DP020-SRC-AID) AND                08330099
070837             (ASC-CONFIRM-INACTV OR ASC-CONFIRM-ISTOP)            08340099
070838** END ALL ASSIGNMENTS                                            08350099
070840             EVALUATE TRUE                                        08360099
070850             WHEN ASC-NUMBER-OF-SELECTED-ITEMS = 1                08370099
070860                 MOVE 'DLACTIVT'      TO DP008-FUNCTION-NAME      08380099
070870                 PERFORM 2105-RACF-ACCESS                         08390099
070880                 IF  PS-ACCESS-NOT-ALLOWED                        08400099
070890                     SET  PS-ERROR                                08410099
070891                          DP020-MSG-FATAL TO TRUE                 08420099
070892*                        YOU DO NOT HAVE THE AUTHORITY            08430099
070893*                          TO ADD/UPDATE A SHIP DOOR TEMPLATE     08440099
070894**?? NEW MESSAGE                                                  08450099
070895                     MOVE PC-TSYMSG-03199 TO DP020-MSG-NUMBER     08460099
070896                     MOVE -1              TO MR-SELECTL (1)       08470099
070897                     SET  DP030-SET-CURSOR-APPL-1 TO TRUE         08480099
070898                     SET DP030-OVERRIDE-GO       TO TRUE          08490099
070899                     SET ASC-NO-CONFIRM-INACTV                    08500099
070900                         ASC-NO-CONFIRM-ISTOP  TO TRUE            08510099
070901                 ELSE                                             08520099
070910                     PERFORM 7500-PROCESS-ACTV-TEM-ASGMT          08530099
                           PERFORM 7600-PROCESS-ACTV-ASGMT              08540099
070911                     IF PS-PROCESS-ERROR-NO                       08550099
070912                        IF   PV-ACTV-TEM-ASGMT-COUNT = 0          08560099
                               AND PV-ACTV-ASGMT-COUNT = 0              08570099
070913                          MOVE PC-TSYMSG-03662 TO DP020-MSG-NUMBER08580099
070914                          MOVE -1              TO MR-SELECTL (1)  08590099
070915                          SET  DP030-SET-CURSOR-APPL-1 TO TRUE    08600099
070916                          SET DP030-OVERRIDE-GO       TO TRUE     08610099
070917                        ELSE                                      08620099
070919                          MOVE PC-TSYMSG-01305 TO DP020-MSG-NUMBER08630099
070920                          MOVE -1              TO MR-SELECTL (1)  08640099
070921                          SET  DP030-SET-CURSOR-APPL-1 TO TRUE    08650099
070922                          SET DP030-OVERRIDE-GO       TO TRUE     08660099
070923                        END-IF                                    08670099
070924                     END-IF                                       08680099
070925                     SET ASC-NO-CONFIRM-INACTV                    08690099
070926                         ASC-NO-CONFIRM-ISTOP  TO TRUE            08700099
070927                 END-IF                                           08710099
070928                                                                  08720099
070930             WHEN OTHER                                           08730099
071000                 SET PS-ERROR                                     08740099
071100                     DP020-MSG-FATAL                              08750099
071200                     DP030-SET-CURSOR-APPL-1                      08760099
071300                     DP030-OVERRIDE-GO       TO TRUE              08770099
071400*                      'MUST SELECT ONE INACTIVE TEMPLATE         08780099
071500*                            FOR THE ACTIVATE FUNCTION'           08790099
071600*???? NEW MESSAGE OVE PC-TSYMSG-03185 TO DP020-MSG-NUMBER         08800099
071610                 MOVE PC-TSYMSG-03185 TO DP020-MSG-NUMBER         08810099
071700                 MOVE -1              TO MR-SELECTL (1)           08820099
071800             END-EVALUATE                                         08830099
071810                                                                  08840099
071900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              08850099
072000             SET ASC-OTHER-FUNCTION   TO TRUE                     08860099
072100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              08870099
072200                 INITIALIZE DL002-INTER-APPL-COMMAREA             08880099
072300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                08890099
072400                                TO DL002-NUMBER-OF-SELECTED-ITEMS 08900099
072500                 PERFORM 5000-PREPARE-SEL-QUEUE                   08910099
072600             ELSE                                                 08920099
072700                 SET DP030-OVERRIDE-GO                            08930099
072800                                   TO TRUE                        08940099
072900                 MOVE PC-TSYMSG-00057                             08950099
073000                                   TO DP020-MSG-NUMBER            08960099
073100                 SET DP020-MSG-WARNING                            08970099
073200                                   TO TRUE                        08980099
073300             END-IF                                               08990099
073400                                                                  09000099
073500         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09010099
073600             SET ASC-UPDATE-FUNCTION   TO TRUE                    09020099
073700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              09030099
073800                 INITIALIZE DL002-INTER-APPL-COMMAREA             09040099
073900                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                09050099
074000                                TO DL002-NUMBER-OF-SELECTED-ITEMS 09060099
074100                 PERFORM 5000-PREPARE-SEL-QUEUE                   09070099
074200                 IF PS-ERROR                                      09080099
074300                     SET DP020-MSG-FATAL                          09090099
074400                         DP030-SET-CURSOR-APPL-1                  09100099
074500                         DP030-OVERRIDE-GO   TO TRUE              09110099
074600                     MOVE -1          TO MR-SELECTL (1)           09120099
074700                 END-IF                                           09130099
074800             ELSE                                                 09140099
074900                 SET DP030-OVERRIDE-GO                            09150099
075000                                   TO TRUE                        09160099
075100                 MOVE PC-TSYMSG-00057                             09170099
075200                                   TO DP020-MSG-NUMBER            09180099
075300                 SET DP020-MSG-WARNING                            09190099
075400                                   TO TRUE                        09200099
075500             END-IF                                               09210099
075600                                                                  09220099
075700         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  09230099
075800             SET ASC-OTHER-FUNCTION   TO TRUE                     09240099
075900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              09250099
076000                 INITIALIZE DL002-INTER-APPL-COMMAREA             09260099
076100                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                09270099
076200                                TO DL002-NUMBER-OF-SELECTED-ITEMS 09280099
076300                 PERFORM 5000-PREPARE-SEL-QUEUE                   09290099
076400             ELSE                                                 09300099
076500                 SET DP030-OVERRIDE-GO                            09310099
076600                                   TO TRUE                        09320099
076700                 MOVE PC-TSYMSG-00057                             09330099
076800                                   TO DP020-MSG-NUMBER            09340099
076900                 SET DP020-MSG-WARNING                            09350099
077000                                   TO TRUE                        09360099
077100             END-IF                                               09370099
077200                                                                  09380099
077300         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  09390099
077400             MOVE +1               TO PV-TOP-ITEM                 09400099
077500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09410099
077600                                                                  09420099
077700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   09430099
077800             PERFORM 2110-BROWSE-BACKWARD                         09440099
077900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09450099
078000                                                                  09460099
078100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   09470099
078200             PERFORM 2120-BROWSE-FORWARD                          09480099
078300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09490099
078400                                                                  09500099
078500         WHEN DP020-SRC-AID = DP016-ENTER                         09510099
078600             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   09520099
078700             IF  PS-ERROR                                         09530099
078800                 CONTINUE                                         09540099
078900             ELSE                                                 09550099
079000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09560099
079100             END-IF                                               09570099
079200                                                                  09580099
079300         WHEN OTHER                                               09590099
079400             SET DP013-NO-ROLLBACK                                09600099
079500                 DP013-XCTL-DISPLAY-RESTART                       09610099
079600                 DP013-CICS-ABEND  TO TRUE                        09620099
079700             MOVE '2100-CHECK-FUNCTION-KEY'                       09630099
079800                                   TO DP013-PARAGRAPH             09640099
079900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09650099
080000                                   TO DP013-MESSAGE-TEXT (1)      09660099
080100             PERFORM DP013-0000-PROCESS-ABEND                     09670099
080200     END-EVALUATE.                                                09680099
080300/                                                                 09690099
080400 2100A-ACTIVATE-PROCESS.                                          09700099
080500                                                                  09710099
080600     PERFORM 7200-INACTIVATE-TEMPLATES.                           09720099
080700                                                                  09730099
080800     PERFORM 4600-PROCESS-ACTIVATE-FUNCTION                       09740099
080900             VARYING PV-ITEM  FROM 1 BY 1                         09750099
081000             UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN            09760099
081100             OR PS-ERROR                                          09770099
081200                                                                  09780099
081300     IF PS-NO-ERROR                                               09790099
081400         PERFORM 2050-DELETE-LIST-QUEUE                           09800099
081500         PERFORM 4000-BUILD-INITIAL-PANEL                         09810099
081600         SET DP020-MSG-INFORMATIONAL  TO  TRUE                    09820099
081700         MOVE PC-TSYMSG-01305         TO DP020-MSG-NUMBER         09830099
081800*                ELSE                                             09840099
081900*                    MOVE PC-TSYMSG-02848 TO DP020-MSG-NUMBER     09850099
082000*                    SET DP030-OVERRIDE-GO TO TRUE                09860099
082100*                    SET DP020-MSG-WARNING TO TRUE                09870099
082200     END-IF                                                       09880099
082300                                                                  09890099
082301     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        09900099
082302                                                                  09910099
082303 2200-UNASSIGN-PROCESS.                                           09920099
082304                                                                  09930099
082305     PERFORM 7200-INACTIVATE-TEMPLATES.                           09940099
082306                                                                  09950099
082307     PERFORM 4600-PROCESS-ACTIVATE-FUNCTION                       09960099
082308             VARYING PV-ITEM  FROM 1 BY 1                         09970099
082309             UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN            09980099
082310             OR PS-ERROR                                          09990099
082311                                                                  10000099
082312     IF PS-NO-ERROR                                               10010099
082313         PERFORM 2050-DELETE-LIST-QUEUE                           10020099
082314         PERFORM 4000-BUILD-INITIAL-PANEL                         10030099
082315         SET DP020-MSG-INFORMATIONAL  TO  TRUE                    10040099
082316         MOVE PC-TSYMSG-01305         TO DP020-MSG-NUMBER         10050099
082317*                ELSE                                             10060099
082318*                    MOVE PC-TSYMSG-02848 TO DP020-MSG-NUMBER     10070099
082319*                    SET DP030-OVERRIDE-GO TO TRUE                10080099
082320*                    SET DP020-MSG-WARNING TO TRUE                10090099
082321     END-IF                                                       10100099
082322                                                                  10110099
082323     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        10120099
082324                                                                  10130099
082325 2500-COUNT-ACTIVE-ASSIGMENTS.                                    10140099
082326                                                                  10150099
082327     MOVE 0 TO PV-ACTIVE-ASSIGNMENTS.                             10160099
082328                                                                  10170099
082329     MOVE DP020-LOCATION-NBR          TO DLT00004-DC-NBR          10180099
082330     EXEC SQL                                                     10190099
082331           SELECT COUNT(*)                                        10200099
082332                                                                  10210099
082333             INTO :PV-ACTIVE-ASSIGNMENTS                          10220099
082334                                                                  10230099
082335             FROM DLT_ASGMT         ASGMT                         10240099
082336            WHERE ASGMT.WK_TYP_DESC = 'SHIP'                      10250099
082337              AND ASGMT.DC_NBR = :DLT00004-DC-NBR                 10260099
082338              AND ASGMT.ASGMT_STP_RSN_CDE = 'N'                   10270099
082339                                                                  10280099
082340     END-EXEC.                                                    10290099
082341                                                                  10300099
082342     EVALUATE TRUE                                                10310099
082343         WHEN SQLCODE = ZERO                                      10320099
082344         WHEN SQLCODE = +100                                      10330099
082350             CONTINUE                                             10340099
082360         WHEN SQLCODE = -904                                      10350099
082370         WHEN SQLCODE = -911                                      10360099
082380         WHEN SQLCODE = -913                                      10370099
082390             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    10380099
082400             MOVE '2500-COUNT-ASGMT'        TO PV-SOFT-PARAGRAPH  10390099
082500             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  10400099
082600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     10410099
082700               TO PV-COMMAREA-LENGTH                              10420099
082800             EXEC CICS                                            10430099
082900                  WRITEQ TD                                       10440099
083000                   QUEUE  ('CSSL')                                10450099
083100                    FROM  (PV-CICS-MSG-AREA2)                     10460099
083200                  LENGTH  (PV-COMMAREA-LENGTH)                    10470099
083300                    RESP  (PV-CICS-RESP)                          10480099
083400             END-EXEC                                             10490099
083500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          10500099
083600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              10510099
083700             PERFORM 9900-SOFT-ABORT                              10520099
083800         WHEN OTHER                                               10530099
083900              MOVE '2500-COUNT-ASGMT'                             10540099
084000                               TO DP013-PARAGRAPH                 10550099
084100              MOVE 'COUNT ACTIVE ASGMTS '                         10560099
084200                               TO DP013-MESSAGE-TEXT (1)          10570099
084300              MOVE SQLCA       TO DP013-SQLCA                     10580099
084400              MOVE 'DLT_ASGM'  TO DP013-DB2-TABLE-NAME (1)        10590099
084500              SET DP013-DB2-ABEND                                 10600099
084600                  DP013-XCTL-DISPLAY-RESTART                      10610099
084700                                   TO TRUE                        10620099
084800                  PERFORM DP013-0000-PROCESS-ABEND                10630099
084900     END-EVALUATE.                                                10640099
085000                                                                  10650099
085100     IF PV-ACTIVE-ASSIGNMENTS > 0                                 10660099
085200         SET PS-ACTIVE-ASSIGNMENTS TO TRUE                        10670099
085300     ELSE                                                         10680099
085400         SET PS-NO-ACTIVE-ASSIGNMENTS TO TRUE                     10690099
085500     END-IF.                                                      10700099
085600/                                                                 10710099
085700 4600-PROCESS-ACTIVATE-FUNCTION.                                  10720099
085800                                                                  10730099
085900     MOVE +1                       TO ASC-BLK-SUB.                10740099
086000     PERFORM 5100-WRITE-TEMP-STORAGE.                             10750099
086100     ADD +1                        TO ASC-BLK-SUB.                10760099
086200     PERFORM 5100-WRITE-TEMP-STORAGE.                             10770099
086300                                                                  10780099
086400     PERFORM 6112-READ-LIST-QUEUE.                                10790099
086500                                                                  10800099
086600     SET  LQW-IDX  TO   1.                                        10810099
086700                                                                  10820099
086800     IF PV-CICS-RESP = DFHRESP (NORMAL)                           10830099
086900         PERFORM                                                  10840099
087000         VARYING LQW-IDX  FROM 1 BY 1                             10850099
087100         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     10860099
087200            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            10870099
087300            OR   PS-ERROR                                         10880099
087400             IF  LQW-SELECT (LQW-IDX)                             10890099
087500                 IF LQW-TEMPLATE-STATUS (LQW-IDX) = 'INACTIVE'    10900099
087600                     PERFORM 4600A-CHECK-DOOR-TOTALS              10910099
087700                     IF PS-NO-ERROR                               10920099
087800                         PERFORM 4605-PROCESS-SELECTED-LINES      10930099
087900                     END-IF                                       10940099
088000                 ELSE                                             10950099
088100                 SET PS-ERROR                                     10960099
088200                     DP020-MSG-FATAL                              10970099
088300                     DP030-SET-CURSOR-APPL-1                      10980099
088400                     DP030-OVERRIDE-GO       TO TRUE              10990099
088500*                      'MUST SELECT ONE INACTIVE TEMPLATE         11000099
088600*                            FOR THE ACTIVATE FUNCTION'           11010099
088700                 MOVE PC-TSYMSG-03185 TO DP020-MSG-NUMBER         11020099
088800                 MOVE -1              TO MR-SELECTL (1)           11030099
088900                 END-IF                                           11040099
089000             END-IF                                               11050099
089100         END-PERFORM                                              11060099
089200       END-IF.                                                    11070099
089300                                                                  11080099
089400     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           11090099
089500     PERFORM 6111-WRITE-LIST-QUEUE.                               11100099
089600                                                                  11110099
089700     MOVE +1                     TO  ASC-BLK-SUB.                 11120099
089800     PERFORM 4410-READ-TEMP-STORAGE.                              11130099
089900                                                                  11140099
090000     ADD +1                      TO  ASC-BLK-SUB                  11150099
090100                                     PV-BLOCK-NUMBER.             11160099
090200                                                                  11170099
090300     PERFORM 4410-READ-TEMP-STORAGE.                              11180099
090400                                                                  11190099
090500 4600A-CHECK-DOOR-TOTALS.                                         11200099
090600     MOVE LQW-TEMPLATE-NBR (LQW-IDX)  TO DLT00001-DOOR-GP-TMPL-ID 11210099
090700     PERFORM 7030-COUNT-TEMPLATE-DOORS                            11220099
090800                                                                  11230099
090900     IF PV-TEMPLATE-DOOR-COUNT = ASC-KEY-DOOR-COUNT               11240099
091000         CONTINUE                                                 11250099
091100     ELSE                                                         11260099
091200         PERFORM 9910-ROLLBACK                                    11270099
091300         SET PS-ERROR                                             11280099
091400             DP020-MSG-FATAL                                      11290099
091500             DP030-SET-CURSOR-APPL-1                              11300099
091600             DP030-OVERRIDE-GO       TO TRUE                      11310099
091700*                'TEMPLATE MUST BE UPDATED - NOT ALL              11320099
091800*                      DOORS ARE GROUPED IN TEMPLATE'             11330099
091900             MOVE PC-TSYMSG-03181 TO DP020-MSG-NUMBER             11340099
092000             MOVE -1              TO MR-SELECTL (1)               11350099
092100     END-IF.                                                      11360099
092200                                                                  11370099
092300*----------------------------------------------------------------*11380099
092400*                                                                 11390099
092500*----------------------------------------------------------------*11400099
092600 4605-PROCESS-SELECTED-LINES.                                     11410099
092700                                                                  11420099
092800     PERFORM 4620-PROCESS-LINES.                                  11430099
092900                                                                  11440099
093000     IF  PS-NO-ERROR                                              11450099
093100         SET  LQW-DESELECT (LQW-IDX) TO TRUE                      11460099
093200         MOVE PC-UPD      TO LQW-ACTION (LQW-IDX)                 11470099
093300                                                                  11480099
093400         SUBTRACT  1                                              11490099
093500             FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   11500099
093600         MOVE LQW-SELECTED-SW (LQW-IDX)                           11510099
093700                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   11520099
093800     END-IF.                                                      11530099
093900                                                                  11540099
094000 4620-PROCESS-LINES.                                              11550099
094100                                                                  11560099
094200     IF  PS-NO-ERROR                                              11570099
094300         IF  LQW-SELECT (LQW-IDX)                                 11580099
094400             MOVE LQW-TEMPLATE-NBR (LQW-IDX)                      11590099
094500                                      TO DLT00000-DOOR-GP-TMPL-ID 11600099
094600                 PERFORM 7210-ACTIVATE-SELECTED-TEMPL             11610099
094700         END-IF                                                   11620099
094800     END-IF.                                                      11630099
094900                                                                  11640099
095000*----------------------------------------------------------------*11650099
095100* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     11660099
095200*----------------------------------------------------------------*11670099
095300 2105-RACF-ACCESS.                                                11680099
095400                                                                  11690099
095500      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  11700099
095600      SET DP008-ACCESS-TYPE-USE          TO TRUE                  11710099
095700                                                                  11720099
095800      EXEC CICS                                                   11730099
095900         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 11740099
096000              COMMAREA (DP008-SECURITY-COMMAREA)                  11750099
096100              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             11760099
096200      END-EXEC                                                    11770099
096300                                                                  11780099
096400      IF DP008-CALL-SUCCESSFUL                                    11790099
096500         IF DP008-ACCESS-ALLOWED                                  11800099
096600             SET PS-ACCESS-ALLOWED TO TRUE                        11810099
096700         ELSE                                                     11820099
096800             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    11830099
096900         END-IF                                                   11840099
097000     ELSE                                                         11850099
097100         MOVE '2105-RACF-ACCESS'                                  11860099
097200                               TO DP013-PARAGRAPH                 11870099
097300          MOVE 'UNABLE TO ACCESS CICS'                            11880099
097400                               TO DP013-MESSAGE-TEXT (1)          11890099
097500          MOVE SQLCA                 TO DP013-SQLCA               11900099
097600          SET DP013-DB2-ABEND                                     11910099
097700              DP013-XCTL-DISPLAY-RESTART                          11920099
097800                               TO TRUE                            11930099
097900          PERFORM DP013-0000-PROCESS-ABEND                        11940099
098000      END-IF.                                                     11950099
098100                                                                  11960099
098200*                                                                 11970099
098300*----------------------------------------------------------------*11980099
098400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *11990099
098500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *12000099
098600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *12010099
098700*    MESSAGE.                                                    *12020099
098800*----------------------------------------------------------------*12030099
098900                                                                  12040099
099000 2110-BROWSE-BACKWARD.                                            12050099
099100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12060099
099200         GIVING PV-TOP-ITEM.                                      12070099
099300*                                                                 12080099
099400     IF  ((PV-TOP-ITEM < +1)                                      12090099
099500       OR (PV-TOP-ITEM = +1))                                     12100099
099600         MOVE +1                   TO PV-TOP-ITEM                 12110099
099700*        -- TOP OF LIST --                                        12120099
099800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12130099
099900         SET DP020-MSG-INFORMATIONAL TO TRUE                      12140099
100000     END-IF.                                                      12150099
100100                                                                  12160099
100200 EJECT                                                            12170099
100300*----------------------------------------------------------------*12180099
100400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *12190099
100500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *12200099
100600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *12210099
100700*----------------------------------------------------------------*12220099
100800                                                                  12230099
100900 2120-BROWSE-FORWARD.                                             12240099
101000                                                                  12250099
101100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12260099
101200         GIVING PV-TOP-ITEM.                                      12270099
101300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   12280099
101400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12290099
101500                                   TO PV-TOP-ITEM                 12300099
101600*        -- BOTTOM OF LIST --                                     12310099
101700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12320099
101800         SET DP020-MSG-INFORMATIONAL                              12330099
101900                                   TO TRUE                        12340099
102000     ELSE                                                         12350099
102100         COMPUTE PV-BOTTOM-ITEM =                                 12360099
102200             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12370099
102300         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            12380099
102400*            -- BOTTOM OF LIST --                                 12390099
102500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            12400099
102600             SET DP020-MSG-INFORMATIONAL                          12410099
102700                                   TO TRUE                        12420099
102800         END-IF                                                   12430099
102900     END-IF.                                                      12440099
103000 EJECT                                                            12450099
103100*----------------------------------------------------------------*12460099
103200*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *12470099
103300*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *12480099
103400*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *12490099
103500*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *12500099
103600*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *12510099
103700*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *12520099
103800*----------------------------------------------------------------*12530099
103900                                                                  12540099
104000 2130-CHECK-FOR-JUMP-BROWSE.                                      12550099
104100     SET PS-NO-ERROR               TO TRUE.                       12560099
104200     IF (ASC-START-ITEM-REQUEST = SPACE)                          12570099
104300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12580099
104400                                   TO PV-TOP-ITEM                 12590099
104500     ELSE                                                         12600099
104600         MOVE ASC-START-ITEM-REQUEST                              12610099
104700                                   TO DP010I-UNEDITED-FIELD       12620099
104800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       12630099
104900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     12640099
105000         SET DP010I-NEGATIVE-NOT-ALLOWED                          12650099
105100                                   TO TRUE                        12660099
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12671099
263627              USING DP010I-NUMERIC-EDIT-AREA                      12672099
105300                                                                  12680099
105400         IF  NOT DP010I-ERROR-DETECTED                            12690099
105500             MOVE DP010I-NUMERIC-FIELD                            12700099
105600                                   TO  ASC-START-ITEM-REQUEST-N   12710099
105700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  12720099
105800                 IF  ASC-START-ITEM-REQUEST-N >                   12730099
105900                                          ASC-NUMBER-OF-ITEMS-READ12740099
106000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         12750099
106100                     COMPUTE PV-TOP-ITEM =                        12760099
106200                             ASC-NUMBER-OF-ITEMS-READ             12770099
106300                             - PC-ITEMS-PER-PANEL + 1             12780099
106400                     IF  PV-TOP-ITEM < +1                         12790099
106500                         MOVE +1   TO PV-TOP-ITEM                 12800099
106600                         MOVE PC-TSYMSG-00070                     12810099
106700                                   TO DP020-MSG-NUMBER            12820099
106800                         SET DP020-MSG-INFORMATIONAL              12830099
106900                                   TO TRUE                        12840099
107000                     END-IF                                       12850099
107100                 ELSE                                             12860099
107200                     MOVE ASC-START-ITEM-REQUEST-N                12870099
107300                                   TO PV-TOP-ITEM                 12880099
107400                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      12890099
107500                     COMPUTE PV-BOTTOM-ITEM =                     12900099
107600                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     12910099
107700                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ12920099
107800*                        -- BOTTOM OF LIST --                     12930099
107900                         MOVE PC-TSYMSG-00070                     12940099
108000                                   TO DP020-MSG-NUMBER            12950099
108100                         SET DP020-MSG-INFORMATIONAL              12960099
108200                                   TO TRUE                        12970099
108300                     END-IF                                       12980099
108400                 END-IF                                           12990099
108500             ELSE                                                 13000099
108600*                --- VALUE OUT OF RANGE ----                      13010099
108700                 MOVE PC-TSYMSG-00101                             13020099
108800                                   TO DP020-MSG-NUMBER            13030099
108900                 MOVE -1           TO ASTRTITL                    13040099
109000                 SET DP030-SET-CURSOR-APPL-1                      13050099
109100                                   TO TRUE                        13060099
109200                 MOVE DP015-REVERSE                               13070099
109300                                   TO ASTRTITH                    13080099
109400                 MOVE DP015-RED    TO ASTRTITC                    13090099
109500                 MOVE DP015-UNP-NUM-BRT-MDT                       13100099
109600                                   TO ASTRTITA                    13110099
109700                 SET DP020-MSG-FATAL                              13120099
109800                                   TO TRUE                        13130099
109900                 SET PS-ERROR      TO TRUE                        13140099
110000             END-IF                                               13150099
110100                                                                  13160099
110200         ELSE                                                     13170099
110300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13180099
110400             MOVE -1               TO ASTRTITL                    13190099
110500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13200099
110600             MOVE DP015-REVERSE    TO ASTRTITH                    13210099
110700             MOVE DP015-RED        TO ASTRTITC                    13220099
110800             MOVE DP015-UNP-NUM-BRT-MDT                           13230099
110900                                   TO ASTRTITA                    13240099
111000             SET DP020-MSG-FATAL   TO TRUE                        13250099
111100             SET PS-ERROR          TO TRUE                        13260099
111200         END-IF                                                   13270099
111300     END-IF.                                                      13280099
111400 EJECT                                                            13290099
111500*----------------------------------------------------------------*13300099
111600*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *13310099
111700*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *13320099
111800*----------------------------------------------------------------*13330099
111900 2140-DESELECT-ALL-ITEMS.                                         13340099
112000     MOVE +1                       TO ASC-BLK-SUB.                13350099
112100                                                                  13360099
112200     PERFORM 2141-CLEAR-SELECTED-INDS                             13370099
112300         VARYING ASC-ITEM-SUB                                     13380099
112400         FROM 1 BY 1                                              13390099
112500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13400099
112600                                                                  13410099
112700     ADD +1                        TO ASC-BLK-SUB.                13420099
112800                                                                  13430099
112900     PERFORM 2141-CLEAR-SELECTED-INDS                             13440099
113000         VARYING ASC-ITEM-SUB                                     13450099
113100         FROM 1 BY 1                                              13460099
113200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13470099
113300                                                                  13480099
113400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13490099
113500                                   TO PV-LIST-ITEM-NUMBER.        13500099
113600                                                                  13510099
113700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13520099
113800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13530099
113900                                                                  13540099
114000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13550099
114100        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      13560099
114200         MOVE +1                   TO ASC-BLK-SUB                 13570099
114300                                                                  13580099
114400         PERFORM 5100-WRITE-TEMP-STORAGE                          13590099
114500                                                                  13600099
114600         MOVE +1                   TO PV-BLOCK-NUMBER             13610099
114700                                                                  13620099
114800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13630099
114900             PV-FIRST-BLOCK-IN-ARRAY - 1                          13640099
115000                                                                  13650099
115100         PERFORM                                                  13660099
115200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13670099
115300                                                                  13680099
115400             PERFORM 4410-READ-TEMP-STORAGE                       13690099
115500                                                                  13700099
115600             PERFORM 2141-CLEAR-SELECTED-INDS                     13710099
115700                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 13720099
115800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13730099
115900                                                                  13740099
116000             PERFORM 5100-WRITE-TEMP-STORAGE                      13750099
116100                                                                  13760099
116200             ADD +1                TO PV-BLOCK-NUMBER             13770099
116300                                                                  13780099
116400         END-PERFORM                                              13790099
116500                                                                  13800099
116600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13810099
116700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13820099
116800                                                                  13830099
116900         PERFORM                                                  13840099
117000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13850099
117100                   ASC-HIGHEST-BLOCK-WRITTEN                      13860099
117200                                                                  13870099
117300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13880099
117400                                   TO PV-BLOCK-NUMBER             13890099
117500                                                                  13900099
117600             PERFORM 4410-READ-TEMP-STORAGE                       13910099
117700                                                                  13920099
117800             PERFORM 2141-CLEAR-SELECTED-INDS                     13930099
117900                 VARYING ASC-ITEM-SUB                             13940099
118000                 FROM 1 BY 1                                      13950099
118100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13960099
118200                                                                  13970099
118300             PERFORM 5100-WRITE-TEMP-STORAGE                      13980099
118400                                                                  13990099
118500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14000099
118600                                                                  14010099
118700         END-PERFORM                                              14020099
118800                                                                  14030099
118900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14040099
119000                                   TO PV-BLOCK-NUMBER             14050099
119100                                                                  14060099
119200         PERFORM 4410-READ-TEMP-STORAGE                           14070099
119300     END-IF.                                                      14080099
119400                                                                  14090099
119500                                                                  14100099
119600     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 14110099
119700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.14120099
119800     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  14130099
119900                                                                  14140099
120000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14150099
120100                                                                  14160099
120200 EJECT                                                            14170099
120300*----------------------------------------------------------------*14180099
120400*    MARK EACH ITEM AS BEING NOT SELECTED.                       *14190099
120500*----------------------------------------------------------------*14200099
120600                                                                  14210099
120700 2141-CLEAR-SELECTED-INDS.                                        14220099
120800                                                                  14230099
120900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14240099
121000             NOT EQUAL ZERO                                       14250099
121100         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14260099
121200             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14270099
121300                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    14280099
121400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14290099
121500                                   TO TRUE                        14300099
121600         END-IF                                                   14310099
121700     END-IF.                                                      14320099
121800                                                                  14330099
121900 EJECT                                                            14340099
122000*----------------------------------------------------------------*14350099
122100*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *14360099
122200*  FOR ALL ITEMS.                                                *14370099
122300*----------------------------------------------------------------*14380099
122400                                                                  14390099
122500 2150-SELECT-ALL-ITEMS.                                           14400099
122600                                                                  14410099
122700     MOVE +1                       TO ASC-BLK-SUB.                14420099
122800                                                                  14430099
122900     PERFORM 2151-SET-SELECTED-INDS                               14440099
123000         VARYING ASC-ITEM-SUB                                     14450099
123100         FROM 1 BY 1                                              14460099
123200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14470099
123300                                                                  14480099
123400     ADD +1                        TO ASC-BLK-SUB.                14490099
123500                                                                  14500099
123600     PERFORM 2151-SET-SELECTED-INDS                               14510099
123700         VARYING ASC-ITEM-SUB                                     14520099
123800         FROM 1 BY 1                                              14530099
123900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14540099
124000                                                                  14550099
124100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14560099
124200                                   TO PV-LIST-ITEM-NUMBER.        14570099
124300                                                                  14580099
124400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14590099
124500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14600099
124600                                                                  14610099
124700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14620099
124800        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    14630099
124900         MOVE +1                   TO ASC-BLK-SUB                 14640099
125000                                                                  14650099
125100         PERFORM 5100-WRITE-TEMP-STORAGE                          14660099
125200                                                                  14670099
125300         MOVE +1                   TO PV-BLOCK-NUMBER             14680099
125400                                                                  14690099
125500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14700099
125600             PV-FIRST-BLOCK-IN-ARRAY - 1                          14710099
125700                                                                  14720099
125800         PERFORM                                                  14730099
125900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14740099
126000                                                                  14750099
126100             PERFORM 4410-READ-TEMP-STORAGE                       14760099
126200                                                                  14770099
126300             PERFORM 2151-SET-SELECTED-INDS                       14780099
126400                 VARYING ASC-ITEM-SUB                             14790099
126500                 FROM 1 BY 1                                      14800099
126600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14810099
126700                                                                  14820099
126800             PERFORM 5100-WRITE-TEMP-STORAGE                      14830099
126900                                                                  14840099
127000             ADD +1                TO PV-BLOCK-NUMBER             14850099
127100                                                                  14860099
127200         END-PERFORM                                              14870099
127300                                                                  14880099
127400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14890099
127500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14900099
127600                                                                  14910099
127700         PERFORM                                                  14920099
127800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14930099
127900                   ASC-HIGHEST-BLOCK-WRITTEN                      14940099
128000                                                                  14950099
128100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14960099
128200                                   TO PV-BLOCK-NUMBER             14970099
128300                                                                  14980099
128400             PERFORM 4410-READ-TEMP-STORAGE                       14990099
128500                                                                  15000099
128600             PERFORM 2151-SET-SELECTED-INDS                       15010099
128700                 VARYING ASC-ITEM-SUB                             15020099
128800                 FROM 1 BY 1                                      15030099
128900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15040099
129000                                                                  15050099
129100             PERFORM 5100-WRITE-TEMP-STORAGE                      15060099
129200                                                                  15070099
129300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15080099
129400                                                                  15090099
129500         END-PERFORM                                              15100099
129600                                                                  15110099
129700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15120099
129800                                   TO PV-BLOCK-NUMBER             15130099
129900                                                                  15140099
130000         PERFORM 4410-READ-TEMP-STORAGE                           15150099
130100     END-IF.                                                      15160099
130200                                                                  15170099
130300                                                                  15180099
130400     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             15190099
130500                       ASC-NUMBER-OF-SELECTED-ITEMS.              15200099
130600                                                                  15210099
130700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15220099
130800                                                                  15230099
130900 EJECT                                                            15240099
131000*----------------------------------------------------------------*15250099
131100*    MARK EACH ITEM AS BEING SELECTED.                           *15260099
131200*----------------------------------------------------------------*15270099
131300                                                                  15280099
131400 2151-SET-SELECTED-INDS.                                          15290099
131500                                                                  15300099
131600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           15310099
131700             NOT EQUAL ZERO                                       15320099
131800         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15330099
131900             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15340099
132000                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        15350099
132100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15360099
132200                               TO  TRUE                           15370099
132300         END-IF                                                   15380099
132400     END-IF.                                                      15390099
132500******************************************************************15400099
132600** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **15410099
132700** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **15420099
132800******************************************************************15430099
132900 2200-MOVE-SCREEN-TO-COMMAREA.                                    15440099
133000                                                                  15450099
133100     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             15460099
133200     MOVE +1                       TO PV-SUB.                     15470099
133300*                                                                 15480099
133400     PERFORM 3100-SET-SUBSCRIPTS.                                 15490099
133500     IF  ASTRTITL > ZERO                                          15500099
133600         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          15510099
133700     ELSE                                                         15520099
133800         IF  ASTRTITF = DP015-ERASE-EOF                           15530099
133900             INITIALIZE ASC-START-ITEM-REQUEST                    15540099
134000         END-IF                                                   15550099
134100     END-IF.                                                      15560099
134200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          15570099
134300         VARYING PV-SUB                                           15580099
134400         FROM 1 BY 1                                              15590099
134500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      15600099
134600******************************************************************15610099
134700** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**15620099
134800******************************************************************15630099
134900 2210-MOVE-LINES-TO-COMMAREA.                                     15640099
135000     IF  MR-SELECTL (PV-SUB) > ZERO                               15650099
135100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             15660099
135200         MOVE MR-SELECTI (PV-SUB)                                 15670099
135300                                   TO ASC-TEMP-SELECTED-SW        15680099
135400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15690099
135500     ELSE                                                         15700099
135600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                15710099
135700                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     15720099
135800                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        15730099
135900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15740099
136000         END-IF                                                   15750099
136100     END-IF.                                                      15760099
136200     ADD +1                        TO ASC-ITEM-SUB.               15770099
136300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        15780099
136400         ADD +1                    TO ASC-BLK-SUB                 15790099
136500         MOVE +1                   TO ASC-ITEM-SUB                15800099
136600     END-IF.                                                      15810099
136700******************************************************************15820099
136800** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **15830099
136900** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **15840099
137000******************************************************************15850099
137100 3000-EDIT-DATA-IN-COMMAREA.                                      15860099
137200     SET PS-NO-ERROR               TO TRUE.                       15870099
137201                                                                  15880099
137300     PERFORM 3200-RESET-ATTRIBUTES.                               15890099
137400     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     15900099
137500**                                                                15910099
137600* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              15920099
137700* EDITTING IS DONE FROM THE BOTTOM UP.                            15930099
137800**                                                                15940099
137900     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       15950099
138000         ASC-ITEMS-DISPLAYED - 1.                                 15960099
138100     PERFORM 3100-SET-SUBSCRIPTS.                                 15970099
138200     PERFORM 3300-EDIT-SELECTIONS                                 15980099
138300         VARYING PV-SUB                                           15990099
138400         FROM PV-SUB BY -1                                        16000099
138500         UNTIL PV-SUB < +1                                        16010099
138600*                                                                 16020099
138700     IF  PS-NO-ERROR                                              16030099
138800         PERFORM 3400-CHECK-RANGE-SEQUENCE                        16040099
138900     END-IF.                                                      16050099
139000*                                                                 16060099
139100     IF  ((PS-NO-ERROR)                                           16070099
139200       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   16080099
139300       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    16090099
139400             PERFORM 3500-MARK-RANGE-AS-SELECTED                  16100099
139500     END-IF.                                                      16110099
139600 EJECT                                                            16120099
139700*----------------------------------------------------------------*16130099
139800*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *16140099
139900*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*16150099
140000*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *16160099
140100*                                                                *16170099
140200*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *16180099
140300*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *16190099
140400*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *16200099
140500*    US IN THE 2ND BLOCK OF THE ARRAY.                           *16210099
140600*----------------------------------------------------------------*16220099
140700                                                                  16230099
140800 3100-SET-SUBSCRIPTS.                                             16240099
140900                                                                  16250099
141000     COMPUTE ASC-ITEM-SUB =                                       16260099
141100         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        16270099
141200                                                                  16280099
141300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         16290099
141400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            16300099
141500                                                                  16310099
141600         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               16320099
141700     ELSE                                                         16330099
141800         MOVE +1                     TO ASC-BLK-SUB               16340099
141900     END-IF.                                                      16350099
142000******************************************************************16360099
142100** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **16370099
142200******************************************************************16380099
142300                                                                  16390099
142400 3200-RESET-ATTRIBUTES.                                           16400099
142500     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   16410099
142600     MOVE DP015-GREEN              TO ASTRTITC.                   16420099
142700     MOVE DP015-UNDERLINE          TO ASTRTITH.                   16430099
142800*                                                                 16440099
142900     PERFORM                                                      16450099
143000         VARYING PV-SUB                                           16460099
143100         FROM 1 BY 1                                              16470099
143200         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        16480099
143300         MOVE DP015-UNP-ALP-NOR-OFF                               16490099
143400                                   TO MR-SELECTA (PV-SUB)         16500099
143500         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         16510099
143600         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         16520099
143700     END-PERFORM.                                                 16530099
143800******************************************************************16540099
143900** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **16550099
144000** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **16560099
144100** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **16570099
144200** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **16580099
144300******************************************************************16590099
144400 3300-EDIT-SELECTIONS.                                            16600099
144500     EVALUATE TRUE                                                16610099
144600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16620099
144700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         16630099
144800                 CONTINUE                                         16640099
144900         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         16650099
145000             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        16660099
145100                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   16670099
145200                 MOVE ASC-TEMP-SELECTED-SW                        16680099
145300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16690099
145400                                TO ASC-SELECTED-SW                16700099
145500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16710099
145600             END-IF                                               16720099
145700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16730099
145800                 = SPACE                                          16740099
145900             EVALUATE TRUE                                        16750099
146000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       16760099
146100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS16770099
146200                     MOVE SPACE TO ASC-SELECTED-SW                16780099
146300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16790099
146400                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        16800099
146500                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    16810099
146600                     MOVE SPACE TO ASC-SELECTED-SW                16820099
146700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16830099
146800                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          16840099
146900                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      16850099
147000                     MOVE SPACE TO ASC-SELECTED-SW                16860099
147100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16870099
147200             END-EVALUATE                                         16880099
147300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           16890099
147400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16900099
147500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    16910099
147600             END-IF                                               16920099
147700             PERFORM 3310-EDIT-RANGE                              16930099
147800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             16940099
147900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16950099
148000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    16960099
148100             END-IF                                               16970099
148200             PERFORM 3310-EDIT-RANGE                              16980099
148300         WHEN OTHER                                               16990099
148400             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           17000099
148500             SET DP020-MSG-FATAL    TO TRUE                       17010099
148600             MOVE -1                TO MR-SELECTL (PV-SUB)        17020099
148700             SET DP030-SET-CURSOR-APPL-1                          17030099
148800                                    TO TRUE                       17040099
148900             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        17050099
149000             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        17060099
149100             SET PS-ERROR TO TRUE                                 17070099
149200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17080099
149300                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     17090099
149400                 MOVE SPACE         TO ASC-SELECTED-SW            17100099
149500                                        (ASC-BLK-SUB ASC-ITEM-SUB)17110099
149600             END-IF                                               17120099
149700     END-EVALUATE.                                                17130099
149701                                                                  17140099
149710*** DMH BEGIN - 4/17/09                                           17150099
149720                                                                  17160099
149730     EVALUATE TRUE                                                17170099
149740         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              17180099
149750              EVALUATE TRUE                                       17190099
149760                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      17200099
149770                   EVALUATE TRUE                                  17210099
149780                       WHEN ASC-TEMPLATE-ACTIVE                   17220099
149790                                  (ASC-BLK-SUB ASC-ITEM-SUB)      17230099
149791                            SET PS-ERROR                          17240099
149792                                DP020-MSG-FATAL                   17250099
149793                                DP030-SET-CURSOR-APPL-1           17260099
149794                                DP030-OVERRIDE-GO                 17270099
149795                                             TO TRUE              17280099
149796                                MOVE PC-TSYMSG-03185              17290099
149797                                      TO DP020-MSG-NUMBER         17300099
149798                                MOVE -1                           17310099
149799                                      TO MR-SELECTL (1)           17320099
149800                   END-EVALUATE                                   17330099
149801              END-EVALUATE                                        17340099
149802     END-EVALUATE.                                                17350099
149803                                                                  17360099
149804*** DMH END   - 4/17/09                                           17370099
149805                                                                  17380099
149806*GB 3/31/09                                                       17390099
149810     IF PS-NO-ERROR                                               17400099
149820       IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                   17410099
149830          EVALUATE TRUE                                           17420099
149840             WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)          17430099
149841             WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)          17440099
149842               SET PS-DC-PARM-FUNC-NO                             17450099
149843                   ASC-NO-CONFIRM-INACTV                          17460099
149844                   ASC-NO-CONFIRM-ISTOP  TO TRUE                  17470099
149845               PERFORM 6500-CHECK-DC-FUNC-PARM                    17480099
149846               IF PS-DC-PARM-FUNC-YES                             17490099
149847                 IF ASC-TEMPLATE-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)17500099
149848                             = 'ACTIVE'                           17510099
149849                     IF DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)    17520099
149850                        SET ASC-CONFIRM-INACTV  TO TRUE           17530099
149851                     ELSE                                         17540099
149852                        SET ASC-CONFIRM-ISTOP   TO TRUE           17550099
149853                     END-IF                                       17560099
149854                     SET  PS-ERROR                                17570099
149855                          DP020-MSG-FATAL TO TRUE                 17580099
149856                     IF ASC-CONFIRM-INACTV                        17590099
149857                        MOVE PC-TSYMSG-03594 TO DP020-MSG-NUMBER  17600099
149858                        MOVE "ENDSHIP"         TO DP020-MSG-TEXT  17610099
149859                        MOVE -1           TO MR-SELECTL (PV-SUB)  17620099
149860                        SET  DP030-SET-CURSOR-APPL-1 TO TRUE      17630099
149861                     ELSE                                         17640099
149862                        MOVE PC-TSYMSG-03594 TO DP020-MSG-NUMBER  17650099
149863                        MOVE "ISTOP"           TO DP020-MSG-TEXT  17660099
149864                        MOVE -1              TO MR-SELECTL(PV-SUB)17670099
149865                        SET  DP030-SET-CURSOR-APPL-1 TO TRUE      17680099
149866                     END-IF                                       17690099
149867                 ELSE                                             17700099
149868                   MOVE PC-TSYMSG-00657   TO DP020-MSG-NUMBER     17710099
149869                   SET DP020-MSG-FATAL    TO TRUE                 17720099
149870                   MOVE -1                TO MR-SELECTL (PV-SUB)  17730099
149871                   SET DP030-SET-CURSOR-APPL-1                    17740099
149872                                          TO TRUE                 17750099
149873                   MOVE DP015-RED         TO MR-SELECTC (PV-SUB)  17760099
149874                   MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)  17770099
149875                   SET PS-ERROR TO TRUE                           17780099
149876                 END-IF                                           17790099
149877               ELSE                                               17800099
149878                   MOVE PC-TSYMSG-02227   TO DP020-MSG-NUMBER     17810099
149879                   SET DP020-MSG-FATAL    TO TRUE                 17820099
149880                   MOVE -1                TO MR-SELECTL (PV-SUB)  17830099
149881                   SET DP030-SET-CURSOR-APPL-1                    17840099
149882                                          TO TRUE                 17850099
149883                   MOVE DP015-RED         TO MR-SELECTC (PV-SUB)  17860099
149884                   MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)  17870099
149885                   SET PS-ERROR TO TRUE                           17880099
149886               END-IF                                             17890099
149887          END-EVALUATE                                            17900099
149888       END-IF                                                     17910099
149889     END-IF                                                       17920099
149890                                                                  17930099
149900     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 17940099
150000     SUBTRACT +1 FROM ASC-ITEM-SUB.                               17950099
150100     IF  ASC-ITEM-SUB < 1                                         17960099
150200         SUBTRACT +1 FROM ASC-BLK-SUB                             17970099
150300         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                17980099
150400     END-IF.                                                      17990099
150500******************************************************************18000099
150600** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **18010099
150700** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **18020099
150800** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**18030099
150900** THE ENDING.                                                  **18040099
151000******************************************************************18050099
151100 3310-EDIT-RANGE.                                                 18060099
151200     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                18070099
151300         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   18080099
151400             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)18090099
151500                                   TO ASC-SELECTED-SW             18100099
151600                                        (ASC-BLK-SUB ASC-ITEM-SUB)18110099
151700             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 18120099
151800         ELSE                                                     18130099
151900             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     18140099
152000                 CONTINUE                                         18150099
152100             ELSE                                                 18160099
152200*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        18170099
152300                 MOVE PC-TSYMSG-00054                             18180099
152400                                   TO DP020-MSG-NUMBER            18190099
152500                 SET DP020-MSG-FATAL                              18200099
152600                                   TO TRUE                        18210099
152700                 MOVE -1           TO MR-SELECTL (PV-SUB)         18220099
152800                 SET DP030-SET-CURSOR-APPL-1                      18230099
152900                                   TO TRUE                        18240099
153000                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         18250099
153100                 MOVE DP015-UNDERLINE                             18260099
153200                                   TO MR-SELECTH (PV-SUB)         18270099
153300                 SET PS-ERROR      TO TRUE                        18280099
153400             END-IF                                               18290099
153500         END-IF                                                   18300099
153600     ELSE                                                         18310099
153700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     18320099
153800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 18330099
153900                                   TO ASC-SELECTED-SW             18340099
154000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18350099
154100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   18360099
154200         ELSE                                                     18370099
154300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       18380099
154400                 CONTINUE                                         18390099
154500             ELSE                                                 18400099
154600*                -- ONLY ONE END-OF-RANGE ALLOWED --              18410099
154700                 MOVE PC-TSYMSG-00055                             18420099
154800                                   TO DP020-MSG-NUMBER            18430099
154900                 SET DP020-MSG-FATAL                              18440099
155000                                   TO TRUE                        18450099
155100                 MOVE -1           TO MR-SELECTL (PV-SUB)         18460099
155200                 SET DP030-SET-CURSOR-APPL-1                      18470099
155300                                   TO TRUE                        18480099
155400                 SET PS-ERROR      TO TRUE                        18490099
155500             END-IF                                               18500099
155600         END-IF                                                   18510099
155700     END-IF.                                                      18520099
155800*                                                                 18530099
155900******************************************************************18540099
156000** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **18550099
156100** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **18560099
156200******************************************************************18570099
156300 3400-CHECK-RANGE-SEQUENCE.                                       18580099
156400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       18590099
156500       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      18600099
156600       AND  ASC-START-OF-SELECTED-RANGE >                         18610099
156700                                         ASC-END-OF-SELECTED-RANGE18620099
156800*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                18630099
156900         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 18640099
157000         SET DP020-MSG-FATAL TO TRUE                              18650099
157100         SET PS-ERROR TO TRUE                                     18660099
157200         PERFORM 3410-POSITION-AT-ERROR                           18670099
157300     END-IF.                                                      18680099
157400******************************************************************18690099
157500** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **18700099
157600** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **18710099
157700** SHOULD BE POSITIONED ON A RANGE ERROR.                       **18720099
157800******************************************************************18730099
157900 3410-POSITION-AT-ERROR.                                          18740099
158000     SET DP030-SET-CURSOR-APPL-1                                  18750099
158100                                   TO TRUE.                       18760099
158200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 18770099
158300                    - PV-TOP-ITEM + 1.                            18780099
158400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      18790099
158500         CONTINUE                                                 18800099
158600     ELSE                                                         18810099
158700         MOVE -1                   TO MR-SELECTL (PV-SUB)         18820099
158800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         18830099
158900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         18840099
159000     END-IF.                                                      18850099
159100*                                                                 18860099
159200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   18870099
159300                    - PV-TOP-ITEM + 1.                            18880099
159400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      18890099
159500         CONTINUE                                                 18900099
159600     ELSE                                                         18910099
159700         MOVE -1                   TO MR-SELECTL (PV-SUB)         18920099
159800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         18930099
159900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         18940099
160000     END-IF.                                                      18950099
160100 EJECT                                                            18960099
160200*----------------------------------------------------------------*18970099
160300*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *18980099
160400*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *18990099
160500*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *19000099
160600*----------------------------------------------------------------*19010099
160700                                                                  19020099
160800 3500-MARK-RANGE-AS-SELECTED.                                     19030099
160900     MOVE +1                       TO  ASC-BLK-SUB.               19040099
161000     PERFORM 3510-MARK-SELECTED-INDS                              19050099
161100         VARYING ASC-ITEM-SUB                                     19060099
161200         FROM 1 BY 1                                              19070099
161300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19080099
161400                                                                  19090099
161500     ADD +1                        TO ASC-BLK-SUB.                19100099
161600     PERFORM 3510-MARK-SELECTED-INDS                              19110099
161700         VARYING ASC-ITEM-SUB                                     19120099
161800         FROM 1 BY 1                                              19130099
161900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19140099
162000                                                                  19150099
162100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19160099
162200                                   TO  PV-LIST-ITEM-NUMBER.       19170099
162300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19180099
162400         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         19190099
162500               PC-ITEMS-PER-PANEL).                               19200099
162600                                                                  19210099
162700     MOVE ASC-START-OF-SELECTED-RANGE                             19220099
162800                                   TO PV-START-OF-SELECTED-RANGE. 19230099
162900     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            19240099
163000         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  19250099
163100               PC-ITEMS-PER-PANEL).                               19260099
163200                                                                  19270099
163300     MOVE ASC-END-OF-SELECTED-RANGE                               19280099
163400                                   TO  PV-END-OF-SELECTED-RANGE.  19290099
163500     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             19300099
163600         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    19310099
163700               PC-ITEMS-PER-PANEL).                               19320099
163800     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             19330099
163900         PV-FIRST-BLOCK-IN-ARRAY + 1.                             19340099
164000                                                                  19350099
164100     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    19360099
164200        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        19370099
164300         MOVE +1                   TO ASC-BLK-SUB                 19380099
164400         PERFORM 5100-WRITE-TEMP-STORAGE                          19390099
164500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19400099
164600             PV-FIRST-BLOCK-IN-ARRAY - 1                          19410099
164700                                                                  19420099
164800         PERFORM                                                  19430099
164900             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      19440099
165000                   PV-PREV-BLOCK-IN-ARRAY                         19450099
165100             MOVE PV-FIRST-BLOCK-IN-RANGE                         19460099
165200                                   TO PV-BLOCK-NUMBER             19470099
165300             PERFORM 4410-READ-TEMP-STORAGE                       19480099
165400             PERFORM 3510-MARK-SELECTED-INDS                      19490099
165500                 VARYING ASC-ITEM-SUB                             19500099
165600                 FROM 1 BY 1                                      19510099
165700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19520099
165800             PERFORM 5100-WRITE-TEMP-STORAGE                      19530099
165900             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     19540099
166000         END-PERFORM                                              19550099
166100                                                                  19560099
166200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19570099
166300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19580099
166400         PERFORM                                                  19590099
166500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19600099
166600                   PV-LAST-BLOCK-IN-RANGE                         19610099
166700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19620099
166800                                   TO PV-BLOCK-NUMBER             19630099
166900             PERFORM 4410-READ-TEMP-STORAGE                       19640099
167000             PERFORM 3510-MARK-SELECTED-INDS                      19650099
167100                 VARYING ASC-ITEM-SUB                             19660099
167200                 FROM 1 BY 1                                      19670099
167300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19680099
167400             PERFORM 5100-WRITE-TEMP-STORAGE                      19690099
167500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19700099
167600         END-PERFORM                                              19710099
167700                                                                  19720099
167800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19730099
167900                                   TO PV-BLOCK-NUMBER             19740099
168000         PERFORM 4410-READ-TEMP-STORAGE                           19750099
168100     END-IF.                                                      19760099
168200                                                                  19770099
168300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 19780099
168400                                      ASC-END-OF-SELECTED-RANGE.  19790099
168500                                                                  19800099
168600 EJECT                                                            19810099
168700*----------------------------------------------------------------*19820099
168800* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *19830099
168900*----------------------------------------------------------------*19840099
169000                                                                  19850099
169100 3510-MARK-SELECTED-INDS.                                         19860099
169200                                                                  19870099
169300     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         19880099
169400                                ASC-ITEM-SUB) >                   19890099
169500         ASC-START-OF-SELECTED-RANGE)                             19900099
169600     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         19910099
169700                                ASC-ITEM-SUB) =                   19920099
169800         ASC-START-OF-SELECTED-RANGE)                             19930099
169900                                                                  19940099
170000         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     19950099
170100                                    ASC-ITEM-SUB) <               19960099
170200             ASC-END-OF-SELECTED-RANGE)                           19970099
170300         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     19980099
170400                                    ASC-ITEM-SUB) =               19990099
170500             ASC-END-OF-SELECTED-RANGE)                           20000099
170600                                                                  20010099
170700             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20020099
170800                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   20030099
170900                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   20040099
171000                               TO TRUE                            20050099
171100                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              20060099
171200                               TO TRUE                            20070099
171300                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    20080099
171400             END-IF                                               20090099
171500         END-IF                                                   20100099
171600     END-IF.                                                      20110099
171700                                                                  20120099
171800 EJECT                                                            20130099
171900*----------------------------------------------------------------*20140099
172000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *20150099
172100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *20160099
172200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *20170099
172300*    DISPLAY THE PANEL TO USER.                                  *20180099
172400*----------------------------------------------------------------*20190099
172500                                                                  20200099
172600 4000-BUILD-INITIAL-PANEL.                                        20210099
172700                                                                  20220099
172800     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            20230099
172900                                 ASC-BLOCK-ENTRIES (2).           20240099
173000     MOVE +1                 TO ASC-BLK-SUB.                      20250099
173100     SET ASC-ITEMS-LEFT-ON-DB                                     20260099
173200                             TO TRUE.                             20270099
173300                                                                  20280099
173400     MOVE +0                 TO ASC-ITEM-SUB                      20290099
173500                                ASC-NUMBER-OF-ITEMS-READ          20300099
173600                                ASC-NUMBER-OF-SELECTED-ITEMS      20310099
173700                                ASC-HIGHEST-BLOCK-WRITTEN         20320099
173800                                ASC-START-OF-SELECTED-RANGE       20330099
173900                                ASC-END-OF-SELECTED-RANGE         20340099
174000                                ASC-ITEM-AT-TOP-OF-PANEL.         20350099
174100     PERFORM 4100-PREPARE-CURSOR                                  20360099
174200                                                                  20370099
174300     PERFORM 4010-OPEN-CURSOR.                                    20380099
174400                                                                  20390099
174500     PERFORM 4300-READ-ITEMS-FROM-DB.                             20400099
174600                                                                  20410099
174700     PERFORM 4020-CLOSE-CURSOR.                                   20420099
174800                                                                  20430099
174900     MOVE +1                   TO  PV-TOP-ITEM.                   20440099
175000     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          20450099
175100         MOVE -1               TO MR-SELECTL (1)                  20460099
175200         MOVE ASC-KEY-OPER-UNT-ID         TO ADCO                 20470099
175300         MOVE ASC-KEY-OPER-DESC           TO ADCNMEO              20480099
175400         PERFORM VARYING PV-SUB                                   20490099
175500                 FROM PC-ITEMS-PER-PANEL BY -1                    20500099
175600                 UNTIL PV-SUB < +1                                20510099
175700             MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)       20520099
175800         END-PERFORM                                              20530099
175900         SET DP020-MSG-FATAL                                      20540099
176000             DP030-SET-CURSOR-APPL-1                              20550099
176100             DP030-OVERRIDE-APPL-ERROR TO TRUE                    20560099
176200         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               20570099
176300     ELSE                                                         20580099
176400         MOVE -1               TO MR-SELECTL (1)                  20590099
176500         SET DP030-SET-CURSOR-APPL-1                              20600099
176600                               TO TRUE                            20610099
176700         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     20620099
176800     END-IF.                                                      20630099
176900/                                                                 20640099
177000 4010-OPEN-CURSOR.                                                20650099
177100                                                                  20660099
177200     MOVE ASC-KEY-OPER-UNT-ID         TO DK-DC-NBR                20670099
177300     PERFORM 7100-OPEN-TEMPLATE-CSR.                              20680099
177400/                                                                 20690099
177500                                                                  20700099
177600 4020-CLOSE-CURSOR.                                               20710099
177700     PERFORM 7120-CLOSE-TEMPLATE-CSR.                             20720099
177800/                                                                 20730099
177900*----------------------------------------------------------------*20740099
178000*    SET UP THE HOST VARIABLES.                                  *20750099
178100*----------------------------------------------------------------*20760099
178200                                                                  20770099
178300 4100-PREPARE-CURSOR.                                             20780099
178400     CONTINUE.                                                    20790099
178500                                                                  20800099
178600                                                                  20810099
178700/                                                                 20820099
178800*----------------------------------------------------------------*20830099
178900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *20840099
179000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *20850099
179100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *20860099
179200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *20870099
179300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *20880099
179400*                                                                *20890099
179500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *20900099
179600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *20910099
179700*    UPON INITIALIZATION.                                        *20920099
179800*----------------------------------------------------------------*20930099
179900                                                                  20940099
180000 4300-READ-ITEMS-FROM-DB.                                         20950099
180100                                                                  20960099
180200     PERFORM                                                      20970099
180300         VARYING PV-READ-COUNT                                    20980099
180400         FROM 1 BY 1                                              20990099
180500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21000099
180600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         21010099
180700                                                                  21020099
180800         PERFORM 4310-FETCH                                       21030099
180900                                                                  21040099
181000         IF  ASC-ITEMS-LEFT-ON-DB                                 21050099
181100             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                21060099
181200                 ADD +1            TO ASC-ITEM-SUB                21070099
181300             ELSE                                                 21080099
181400                 ADD +1            TO ASC-BLK-SUB                 21090099
181500                 MOVE +1           TO ASC-ITEM-SUB                21100099
181600                                                                  21110099
181700                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         21120099
181800                     MOVE +1       TO ASC-BLK-SUB                 21130099
181900                     SET ASC-BLOCK-MODIFIED (1)                   21140099
182000                                   TO TRUE                        21150099
182100                     PERFORM 5100-WRITE-TEMP-STORAGE              21160099
182200                     MOVE ASC-BLOCK-ENTRIES                       21170099
182300                               (PC-MAX-BLOCKS-IN-ARRAY)           21180099
182400                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 21190099
182500                     ADD +1        TO ASC-BLK-SUB                 21200099
182600                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   21210099
182700                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      21220099
182800                                   TO TRUE                        21230099
182900                 END-IF                                           21240099
183000             END-IF                                               21250099
183100             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    21260099
183200             MOVE ASC-NUMBER-OF-ITEMS-READ                        21270099
183300                                   TO ASC-LIST-ITEM-NUMBER        21280099
183400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21290099
183500*            LOAD CURSOR FIELDS TO ASC                            21300099
183600             MOVE DLT00000-DOOR-GP-TMPL-DESC-TEX                  21310099
183700                          (1:DLT00000-DOOR-GP-TMPL-DESC-LEN)      21320099
183800                                      TO ASC-TEMPLATE-DESC        21330099
183900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21340099
184000             MOVE DLT00000-DOOR-GP-TMPL-ID                        21350099
184100                                      TO ASC-TEMPLATE-NBR         21360099
184200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21370099
184300             MOVE PV-TEMPLATE-STATUS  TO ASC-TEMPLATE-STATUS      21380099
184400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21390099
184500                                                                  21400099
184600             MOVE DLT00000-DOOR-GP-TMPL-ID                        21410099
184700                                      TO DLT00001-DOOR-GP-TMPL-ID 21420099
184800             PERFORM 7020-COUNT-GROUPS                            21430099
184900             MOVE PV-GROUP-COUNT      TO ASC-GROUP-TOTAL          21440099
185000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21450099
185100                                                                  21460099
185200             PERFORM 7030-COUNT-TEMPLATE-DOORS                    21470099
185300             MOVE PV-TEMPLATE-DOOR-COUNT                          21480099
185400                                      TO ASC-DOOR-COUNT           21490099
185500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21500099
185600         END-IF                                                   21510099
185700     END-PERFORM.                                                 21520099
185800                                                                  21530099
185900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          21540099
186000         MOVE +1               TO ASC-BLK-SUB                     21550099
186100         PERFORM 5100-WRITE-TEMP-STORAGE                          21560099
186200         ADD +1                TO ASC-BLK-SUB                     21570099
186300         PERFORM 5100-WRITE-TEMP-STORAGE                          21580099
186400                                                                  21590099
186500         MOVE 1                TO ASC-BLK-SUB                     21600099
186600                                  PV-BLOCK-NUMBER                 21610099
186700         PERFORM 4410-READ-TEMP-STORAGE                           21620099
186800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             21630099
186900             MOVE 2            TO ASC-BLK-SUB                     21640099
187000                                  PV-BLOCK-NUMBER                 21650099
187100             PERFORM 4410-READ-TEMP-STORAGE                       21660099
187200         END-IF                                                   21670099
187300     END-IF.                                                      21680099
187400/                                                                 21690099
187500 4310-FETCH.                                                      21700099
187600                                                                  21710099
187700     PERFORM 7110-FETCH-TEMPLATE-CSR.                             21720099
187800/                                                                 21730099
187900*----------------------------------------------------------------*21740099
188000* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *21750099
188100*----------------------------------------------------------------*21760099
188200                                                                  21770099
188300 4400-MOVE-COMMAREA-TO-SCREEN.                                    21780099
188400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             21790099
188500         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          21800099
188600         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          21810099
188700             MOVE +1    TO ASC-BLK-SUB                            21820099
188800             PERFORM 5100-WRITE-TEMP-STORAGE                      21830099
188900             ADD +1     TO ASC-BLK-SUB                            21840099
189000             PERFORM 5100-WRITE-TEMP-STORAGE                      21850099
189100             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             21860099
189200                 GIVING PV-BLOCK-NUMBER                           21870099
189300                 REMAINDER PV-REMAINDER                           21880099
189400             IF  PV-REMAINDER > ZERO                              21890099
189500                 ADD +1 TO PV-BLOCK-NUMBER                        21900099
189600             END-IF                                               21910099
189700             MOVE +1    TO ASC-BLK-SUB                            21920099
189800             PERFORM 4410-READ-TEMP-STORAGE                       21930099
189900             ADD +1     TO ASC-BLK-SUB                            21940099
190000                           PV-BLOCK-NUMBER                        21950099
190100             PERFORM 4410-READ-TEMP-STORAGE                       21960099
190200     END-IF.                                                      21970099
190300     MOVE +1            TO ASC-BLK-SUB.                           21980099
190400     COMPUTE ASC-ITEM-SUB =                                       21990099
190500         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              22000099
190600         + PC-ITEMS-PER-PANEL).                                   22010099
190700*                                                                 22020099
190800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        22030099
190900         ADD +1         TO ASC-BLK-SUB                            22040099
191000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            22050099
191100     END-IF.                                                      22060099
191200*                                                                 22070099
191300     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           22080099
191400         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                22090099
191500     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        22100099
191600     PERFORM 4420-FORMAT-LIST-LINES                               22110099
191700         VARYING PV-SUB                                           22120099
191800         FROM PC-ITEMS-PER-PANEL BY -1                            22130099
191900         UNTIL PV-SUB < +1.                                       22140099
192000*                                                                 22150099
192100     COMPUTE ASC-ITEMS-DISPLAYED =                                22160099
192200         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          22170099
192300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    22180099
192400                                      ASTRTITO.                   22190099
192500     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    22200099
192600     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    22210099
192700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            22220099
192800                                   TO ASELITO.                    22230099
192900                                                                  22240099
193000*    HEADINGS                                                     22250099
193100                                                                  22260099
193200     MOVE ASC-KEY-OPER-UNT-ID         TO ADCO                     22270099
193300     MOVE ASC-KEY-OPER-DESC           TO ADCNMEO.                 22280099
193400     MOVE ASC-KEY-DOOR-COUNT          TO ATDOORO.                 22290099
193500                                                                  22300099
193600*                                                                 22310099
193700     IF  DP020-MSG-NUMBER-X = SPACE                               22320099
193800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  22330099
193900*            --- MORE ITEMS TO DISPLAY ----                       22340099
194000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            22350099
194100             SET DP020-MSG-INFORMATIONAL TO TRUE                  22360099
194200         END-IF                                                   22370099
194300     END-IF.                                                      22380099
194400*----------------------------------------------------------------*22390099
194500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *22400099
194600*----------------------------------------------------------------*22410099
194700                                                                  22420099
194800 4410-READ-TEMP-STORAGE.                                          22430099
194900                                                                  22440099
195000     EXEC CICS                                                    22450099
195100         READQ TS                                                 22460099
195200             QUEUE (ASC-LIST-QUEUE-NAME)                          22470099
195300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               22480099
195400             ITEM  (PV-BLOCK-NUMBER)                              22490099
195500             RESP  (PV-CICS-RESP)                                 22500099
195600     END-EXEC.                                                    22510099
195700                                                                  22520099
195800     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       22530099
195900       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     22540099
196000         CONTINUE                                                 22550099
196100     ELSE                                                         22560099
196200         SET DP013-CICS-ABEND     TO TRUE                         22570099
196300         SET DP013-NO-ROLLBACK    TO TRUE                         22580099
196400         MOVE '4410-READ-TEMP-STORAGE'                            22590099
196500                                  TO DP013-PARAGRAPH              22600099
196600         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      22610099
196700                                  TO DP013-MESSAGE-TEXT(1)        22620099
196800         PERFORM DP013-0000-PROCESS-ABEND                         22630099
196900     END-IF.                                                      22640099
197000                                                                  22650099
197100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             22660099
197200*                                                                 22670099
197300     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         22680099
197400         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               22690099
197500     END-IF.                                                      22700099
197600 EJECT                                                            22710099
197700*----------------------------------------------------------------*22720099
197800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *22730099
197900*----------------------------------------------------------------*22740099
198000                                                                  22750099
198100 4420-FORMAT-LIST-LINES.                                          22760099
198200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      22770099
198300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                22780099
198400         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           22790099
198500         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           22800099
198600         MOVE SPACE              TO MR-SELECTI (PV-SUB)           22810099
198700                                    MR-ACTION (PV-SUB)            22820099
198800                                    MR-TEMPLATE-DESC (PV-SUB)     22830099
198900                                    MR-TEMPLATE-STATUS (PV-SUB)   22840099
199000         MOVE ZEROES             TO MR-GROUP-TOTAL (PV-SUB)       22850099
199100                                    MR-DOOR-TOTAL (PV-SUB)        22860099
199200                                    MR-TEMPLATE-NBR (PV-SUB)      22870099
199300     ELSE                                                         22880099
199400         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      22890099
199500                                                   > SPACE        22900099
199600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 22910099
199700                                 TO MR-SELECTI (PV-SUB)           22920099
199800         ELSE                                                     22930099
199900             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      22940099
200000                                 TO MR-SELECTI (PV-SUB)           22950099
200100         END-IF                                                   22960099
200200*                                                                 22970099
200300         IF  DP030-SET-CURSOR-TRAILER                             22980099
200400             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)22990099
200500                 > SPACE)                                         23000099
200600               OR (PV-SUB = 1))                                   23010099
200700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               23020099
200800                MOVE -1          TO MR-SELECTL (PV-SUB)           23030099
200900             END-IF                                               23040099
201000         END-IF                                                   23050099
201100*                                                                 23060099
201200         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           23070099
201300             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           23080099
201400                                 TO MR-ACTION (PV-SUB)            23090099
201500                                                                  23100099
201600             MOVE ASC-TEMPLATE-DESC (ASC-BLK-SUB ASC-ITEM-SUB)    23110099
201700                                 TO MR-TEMPLATE-DESC (PV-SUB)     23120099
201800             MOVE ASC-TEMPLATE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)     23130099
201900                                 TO MR-TEMPLATE-NBR (PV-SUB)      23140099
202000             MOVE ASC-TEMPLATE-STATUS(ASC-BLK-SUB ASC-ITEM-SUB)   23150099
202100                                 TO MR-TEMPLATE-STATUS (PV-SUB)   23160099
202200             MOVE ASC-GROUP-TOTAL(ASC-BLK-SUB ASC-ITEM-SUB)       23170099
202300                                 TO MR-GROUP-TOTAL (PV-SUB)       23180099
202400             MOVE ASC-DOOR-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)       23190099
202500                                 TO MR-DOOR-TOTAL (PV-SUB)        23200099
202600                                                                  23210099
202700             IF ASC-TEMPLATE-STATUS(ASC-BLK-SUB ASC-ITEM-SUB)     23220099
202800                             = 'ACTIVE'                           23230099
202900                AND ASC-KEY-DOOR-COUNT NOT =                      23240099
203000                  ASC-DOOR-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)       23250099
203100                     MOVE DP015-YELLOW    TO                      23260099
203200                                    MR-TEMPLATE-DESCC (PV-SUB)    23270099
203300                                    MR-DOOR-TOTALC (PV-SUB)       23280099
203400                                    ATDOORC                       23290099
203500             ELSE                                                 23300099
203600                 MOVE DP015-BLUE      TO                          23310099
203700                                    MR-TEMPLATE-DESCC (PV-SUB)    23320099
203800                                    MR-DOOR-TOTALC (PV-SUB)       23330099
203900             END-IF                                               23340099
204000                                                                  23350099
204100         END-IF                                                   23360099
204200     END-IF.                                                      23370099
204300     SUBTRACT +1 FROM ASC-ITEM-SUB                                23380099
204400     IF  ASC-ITEM-SUB < + 1                                       23390099
204500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  23400099
204600         MOVE +1                 TO ASC-BLK-SUB                   23410099
204700     END-IF.                                                      23420099
204800******************************************************************23430099
204900** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **23440099
205000** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **23450099
205100** ISSUE A WARNING.                                             **23460099
205200******************************************************************23470099
205300 4430-CHECK-FOR-BEGIN-AND-END.                                    23480099
205400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       23490099
205500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     23500099
205600*            -- NO END-OF-RANGE SPECFIED ---                      23510099
205700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            23520099
205800             SET DP020-MSG-WARNING TO TRUE                        23530099
205900             PERFORM 4431-POSITION-AT-WARNING                     23540099
206000         END-IF                                                   23550099
206100     ELSE                                                         23560099
206200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     23570099
206300*            -- NO BEGINNING-OF-RANGE SPECFIED ---                23580099
206400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            23590099
206500             SET DP020-MSG-WARNING TO TRUE                        23600099
206600             PERFORM 4431-POSITION-AT-WARNING                     23610099
206700         END-IF                                                   23620099
206800     END-IF.                                                      23630099
206900******************************************************************23640099
207000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **23650099
207100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **23660099
207200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **23670099
207300** POSITION THE CURSOR THERE.                                   **23680099
207400******************************************************************23690099
207500 4431-POSITION-AT-WARNING.                                        23700099
207600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 23710099
207700                    - PV-TOP-ITEM + 1.                            23720099
207800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23730099
207900         CONTINUE                                                 23740099
208000     ELSE                                                         23750099
208100         SET DP030-SET-CURSOR-APPL-1                              23760099
208200                                   TO TRUE                        23770099
208300         MOVE -1                   TO MR-SELECTL (PV-SUB)         23780099
208400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         23790099
208500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         23800099
208600     END-IF.                                                      23810099
208700*                                                                 23820099
208800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   23830099
208900                    - PV-TOP-ITEM + 1.                            23840099
209000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23850099
209100         CONTINUE                                                 23860099
209200     ELSE                                                         23870099
209300         SET DP030-SET-CURSOR-APPL-1                              23880099
209400                                   TO TRUE                        23890099
209500         MOVE -1                   TO MR-SELECTL (PV-SUB)         23900099
209600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         23910099
209700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         23920099
209800     END-IF.                                                      23930099
209900 EJECT                                                            23940099
210000*----------------------------------------------------------------*23950099
210100* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *23960099
210200* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *23970099
210300* FOR THE SELECTED ITEMS QUEUE.                                  *23980099
210400*                                                                *23990099
210500* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *24000099
210600* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *24010099
210700* THE ARRAY IS FULL.                                             *24020099
210800*----------------------------------------------------------------*24030099
210900                                                                  24040099
211000 5000-PREPARE-SEL-QUEUE.                                          24050099
211100                                                                  24060099
211200     MOVE +1                   TO  ASC-BLK-SUB.                   24070099
211300     PERFORM 5100-WRITE-TEMP-STORAGE.                             24080099
211400     ADD +1                    TO  ASC-BLK-SUB.                   24090099
211500     PERFORM 5100-WRITE-TEMP-STORAGE.                             24100099
211600                                                                  24110099
211700     MOVE ASC-SEL-QUEUE-NAME   TO  DL002-SEL-QUEUE-NAME.          24120099
211800     PERFORM 6010-DELETE-SEL-QUEUE.                               24130099
211900                                                                  24140099
212000     SET ASC-UPDATE-TSQ        TO  TRUE.                          24150099
212100                                                                  24160099
212200     SET DL006-IDX             TO  1.                             24170099
212300     MOVE ZERO                 TO DL002-NUMBER-OF-TS-ITEMS.       24180099
212400     INITIALIZE DL006-SELECTED-ITEM-ARRAY.                        24190099
212500                                                                  24200099
212600     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           24210099
212700             VARYING PV-ITEM                                      24220099
212800             FROM 1 BY 1                                          24230099
212900             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     24240099
213000                                                                  24250099
213100     IF  DL006-IDX > 1                                            24260099
213200         PERFORM 5205-WRITE-SEL-QUEUE                             24270099
213300         ADD +1                TO DL002-NUMBER-OF-TS-ITEMS        24280099
213400     END-IF.                                                      24290099
213500/                                                                 24300099
213600*----------------------------------------------------------------*24310099
213700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *24320099
213800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *24330099
213900*----------------------------------------------------------------*24340099
214000                                                                  24350099
214100 5100-WRITE-TEMP-STORAGE.                                         24360099
214200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     24370099
214300                                   TO PV-LIST-ITEM-NUMBER.        24380099
214400     COMPUTE PV-BLOCK-NUMBER =                                    24390099
214500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    24400099
214600                                                                  24410099
214700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             24420099
214800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             24430099
214900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      24440099
215000             PERFORM 5105-REWRITE-ASC-LISTQ                       24450099
215100         END-IF                                                   24460099
215200     ELSE                                                         24470099
215300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       24480099
215400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            24490099
215500         PERFORM 5110-WRITE-ASC-LISTQ                             24500099
215600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   24510099
215700     END-IF.                                                      24520099
215800                                                                  24530099
215900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             24540099
216000******************************************************************24550099
216100** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **24560099
216200** SPECIFIC COMMAREA.                                           **24570099
216300******************************************************************24580099
216400 5105-REWRITE-ASC-LISTQ.                                          24590099
216500     EXEC CICS                                                    24600099
216600         WRITEQ TS                                                24610099
216700             QUEUE (ASC-LIST-QUEUE-NAME)                          24620099
216800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               24630099
216900             ITEM  (PV-BLOCK-NUMBER)                              24640099
217000             REWRITE                                              24650099
217100             RESP  (PV-CICS-RESP)                                 24660099
217200     END-EXEC.                                                    24670099
217300                                                                  24680099
217400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           24690099
217500         CONTINUE                                                 24700099
217600     ELSE                                                         24710099
217700         SET DP013-CICS-ABEND            TO TRUE                  24720099
217800         SET DP013-NO-ROLLBACK           TO TRUE                  24730099
217900         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       24740099
218000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     24750099
218100                                         TO DP013-MESSAGE-TEXT(1) 24760099
218200         PERFORM DP013-0000-PROCESS-ABEND                         24770099
218300     END-IF.                                                      24780099
218400                                                                  24790099
218500******************************************************************24800099
218600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **24810099
218700** SPECIFIC COMMAREA.                                           **24820099
218800******************************************************************24830099
218900 5110-WRITE-ASC-LISTQ.                                            24840099
219000     EXEC CICS                                                    24850099
219100         WRITEQ TS                                                24860099
219200             QUEUE (ASC-LIST-QUEUE-NAME)                          24870099
219300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               24880099
219400             ITEM  (PV-BLOCK-NUMBER)                              24890099
219500             RESP  (PV-CICS-RESP)                                 24900099
219600     END-EXEC.                                                    24910099
219700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      24920099
219800         SET DP013-CICS-ABEND      TO TRUE                        24930099
219900         SET DP013-NO-ROLLBACK     TO TRUE                        24940099
220000         MOVE '5110-WRITE-ASC-LISTQ'                              24950099
220100                                   TO DP013-PARAGRAPH             24960099
220200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           24970099
220300                                   TO DP013-MESSAGE-TEXT(1)       24980099
220400         PERFORM DP013-0000-PROCESS-ABEND                         24990099
220500     END-IF.                                                      25000099
220600/                                                                 25010099
220700*----------------------------------------------------------------*25020099
220800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *25030099
220900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *25040099
221000*----------------------------------------------------------------*25050099
221100                                                                  25060099
221200 5200-FILL-SEL-QUEUE-RECORD.                                      25070099
221300                                                                  25080099
221400     PERFORM 6112-READ-LIST-QUEUE.                                25090099
221500                                                                  25100099
221600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       25110099
221700         PERFORM                                                  25120099
221800         VARYING LQW-IDX                                          25130099
221900         FROM 1 BY 1                                              25140099
222000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            25150099
222100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          25160099
222200                                                                  25170099
222300             IF  LQW-SELECT (LQW-IDX)                             25180099
222400                 IF LQW-TEMPLATE-STATUS (LQW-IDX) = 'INACTIVE'    25190099
222500                       OR DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)  25200099
222600                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          25210099
222700                                   TO DL006-ITEM (DL006-IDX)      25220099
222800                     MOVE LQW-TEMPLATE-NBR (LQW-IDX)              25230099
222900                                   TO DL006-GP-TMPL-ID            25240099
223000                                        (DL006-IDX)               25250099
223100                     MOVE LQW-TEMPLATE-DESC(LQW-IDX)              25260099
223200                                   TO DL006-TEMPLATE-DESC         25270099
223300                                        (DL006-IDX)               25280099
223400                     MOVE ASC-KEY-DOOR-COUNT                      25290099
223500                                   TO DL006-DOOR-COUNT            25300099
223600                                        (DL006-IDX)               25310099
223700                     MOVE SPACE    TO DL006-ACTION-SW (DL006-IDX) 25320099
223800                     SET DL006-IDX UP BY 1                        25330099
223900                     IF  DL006-IDX > DL006-MAX-ITEMS              25340099
224000                         PERFORM 5205-WRITE-SEL-QUEUE             25350099
224100                         ADD +1    TO DL002-NUMBER-OF-TS-ITEMS    25360099
224200                         INITIALIZE DL006-SELECTED-ITEM-ARRAY     25370099
224300                         SET DL006-IDX TO  1                      25380099
224400                     END-IF                                       25390099
224500                 ELSE                                             25400099
224600                     SET PS-ERROR TO TRUE                         25410099
224700                     MOVE PC-TSYMSG-03184 TO DP020-MSG-NUMBER     25420099
224800*                    MOVE -1          TO LQW-SELECTL(LQW-IDX)     25430099
224900                     SET  DP030-SET-CURSOR-APPL-1                 25440099
225000                         DP030-OVERRIDE-GO       TO TRUE          25450099
225100                 END-IF                                           25460099
225200             END-IF                                               25470099
225300         END-PERFORM                                              25480099
225400     END-IF.                                                      25490099
225500                                                                  25500099
225600*----------------------------------------------------------------*25510099
225700*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *25520099
225800*----------------------------------------------------------------*25530099
225900                                                                  25540099
226000 5205-WRITE-SEL-QUEUE.                                            25550099
226100                                                                  25560099
226200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            25570099
226300                                   TO DL006-SELECTED-ITEMS.       25580099
226400                                                                  25590099
226500     EXEC CICS                                                    25600099
226600          WRITEQ TS                                               25610099
226700              QUEUE (ASC-SEL-QUEUE-NAME)                          25620099
226800              FROM  (DL006-SELECT-RECORD)                         25630099
226900              ITEM  (PV-SEL-QUEUE-ITEM)                           25640099
227000              RESP  (PV-CICS-RESP)                                25650099
227100     END-EXEC.                                                    25660099
227200                                                                  25670099
227300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          25680099
227400         CONTINUE                                                 25690099
227500     ELSE                                                         25700099
227600         SET DP013-CICS-ABEND      TO TRUE                        25710099
227700         SET DP013-NO-ROLLBACK     TO TRUE                        25720099
227800         MOVE '5205-WRITE-SEL-QUEUE'                              25730099
227900                                   TO DP013-PARAGRAPH             25740099
228000         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          25750099
228100                                   TO DP013-MESSAGE-TEXT(1)       25760099
228200         PERFORM DP013-0000-PROCESS-ABEND                         25770099
228300     END-IF.                                                      25780099
228400 EJECT                                                            25790099
228500******************************************************************25800099
228600** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **25810099
228700** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **25820099
228800** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **25830099
228900** THE USER.                                                    **25840099
229000******************************************************************25850099
229100 6000-REFRESH-PANEL-FROM-TEMP.                                    25860099
229200     IF  ASC-UPDATE-TSQ                                           25870099
229300         SET ASC-NO-TSQ-UPDATE TO TRUE                            25880099
229400         MOVE ZERO                 TO PV-SAVE-ITEM                25890099
229500                                      PV-SEL-QUEUE-ITEM           25900099
229600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        25910099
229700                                   TO PV-HOLD-SELECTED-ITEMS      25920099
229800         MOVE +1                   TO PV-ITEMS-PROCESSED          25930099
229900         PERFORM 6100-UPDATE-TSQ                                  25940099
230000             UNTIL PV-ITEMS-PROCESSED >                           25950099
230100                                     PV-HOLD-SELECTED-ITEMS       25960099
230200         PERFORM 6010-DELETE-SEL-QUEUE                            25970099
230300         INITIALIZE ASC-BLOCK-ENTRIES (1)                         25980099
230400                    ASC-BLOCK-ENTRIES (2)                         25990099
230500     END-IF.                                                      26000099
230600                                                                  26010099
230700*----------------------------------------------------------------*26020099
230800*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *26030099
230900*----------------------------------------------------------------*26040099
231000 6010-DELETE-SEL-QUEUE.                                           26050099
231100                                                                  26060099
231200     EXEC CICS                                                    26070099
231300         DELETEQ TS                                               26080099
231400             QUEUE (ASC-SEL-QUEUE-NAME)                           26090099
231500             RESP  (PV-CICS-RESP)                                 26100099
231600     END-EXEC.                                                    26110099
231700*                                                                 26120099
231800     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      26130099
231900        (PV-CICS-RESP = DFHRESP(QIDERR)))                         26140099
232000         CONTINUE                                                 26150099
232100     ELSE                                                         26160099
232200         SET DP013-CICS-ABEND TO TRUE                             26170099
232300         SET DP013-NO-ROLLBACK TO TRUE                            26180099
232400         MOVE '6010-DELETE-SEL-QUEUE'                             26190099
232500                        TO DP013-PARAGRAPH                        26200099
232600         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         26210099
232700                        TO DP013-MESSAGE-TEXT (1)                 26220099
232800         PERFORM DP013-0000-PROCESS-ABEND                         26230099
232900     END-IF.                                                      26240099
233000                                                                  26250099
233100*----------------------------------------------------------------*26260099
233200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *26270099
233300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *26280099
233400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *26290099
233500*    THE TEMP QUEUE.                                             *26300099
233600*----------------------------------------------------------------*26310099
233700                                                                  26320099
233800 6100-UPDATE-TSQ.                                                 26330099
233900                                                                  26340099
234000     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             26350099
234100     PERFORM 6105-READ-SEL-QUEUE.                                 26360099
234200     PERFORM                                                      26370099
234300         VARYING DL006-IDX                                        26380099
234400         FROM 1 BY 1                                              26390099
234500         UNTIL ((PV-ITEMS-PROCESSED >                             26400099
234600                              PV-HOLD-SELECTED-ITEMS)             26410099
234700         OR (DL006-IDX GREATER THAN DL006-MAX-ITEMS))             26420099
234800         IF  DL006-ACTION-SW (DL006-IDX) > SPACE                  26430099
234900             PERFORM 6110-PROCESS-ITEMS                           26440099
235000         END-IF                                                   26450099
235100         ADD +1                TO PV-ITEMS-PROCESSED              26460099
235200     END-PERFORM.                                                 26470099
235300     PERFORM 6111-WRITE-LIST-QUEUE.                               26480099
235400*----------------------------------------------------------------*26490099
235500*    READ THE LIST QUEUE RECORD.                                 *26500099
235600*----------------------------------------------------------------*26510099
235700                                                                  26520099
235800 6105-READ-SEL-QUEUE.                                             26530099
235900                                                                  26540099
236000     EXEC CICS                                                    26550099
236100          READQ TS                                                26560099
236200              QUEUE (ASC-SEL-QUEUE-NAME)                          26570099
236300              INTO  (DL006-SELECT-RECORD)                         26580099
236400              ITEM  (PV-SEL-QUEUE-ITEM)                           26590099
236500              RESP  (PV-CICS-RESP)                                26600099
236600     END-EXEC.                                                    26610099
236700*                                                                 26620099
236800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          26630099
236900         CONTINUE                                                 26640099
237000     ELSE                                                         26650099
237100         SET DP013-CICS-ABEND      TO  TRUE                       26660099
237200         SET DP013-NO-ROLLBACK     TO  TRUE                       26670099
237300         MOVE '6105-READ-SEL-QUEUE'                               26680099
237400                                   TO  DP013-PARAGRAPH            26690099
237500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           26700099
237600                                   TO  DP013-MESSAGE-TEXT(1)      26710099
237700         PERFORM DP013-0000-PROCESS-ABEND                         26720099
237800     END-IF.                                                      26730099
237900 EJECT                                                            26740099
238000*----------------------------------------------------------------*26750099
238100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*26760099
238200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*26770099
238300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *26780099
238400*----------------------------------------------------------------*26790099
238500                                                                  26800099
238600 6110-PROCESS-ITEMS.                                              26810099
238700                                                                  26820099
238800     COMPUTE PV-ITEM = 1 + ((DL006-ITEM (DL006-IDX) - 1)          26830099
238900                     / PC-ITEMS-PER-PANEL).                       26840099
239000                                                                  26850099
239100     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           26860099
239200         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          26870099
239300             PERFORM 6111-WRITE-LIST-QUEUE                        26880099
239400         END-IF                                                   26890099
239500         MOVE PV-ITEM          TO PV-SAVE-ITEM                    26900099
239600                                                                  26910099
239700         PERFORM 6112-READ-LIST-QUEUE                             26920099
239800         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               26930099
239900             CONTINUE                                             26940099
240000         END-IF                                                   26950099
240100     END-IF.                                                      26960099
240200                                                                  26970099
240300     COMPUTE PV-SUB = (DL006-ITEM (DL006-IDX)                     26980099
240400                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              26990099
240500     SET LQW-DESELECT (PV-SUB) TO    TRUE                         27000099
240600     MOVE LQW-SELECTED-SW (PV-SUB)                                27010099
240700                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  27020099
240800     EVALUATE TRUE                                                27030099
240900         WHEN DL006-INQ (DL006-IDX)                               27040099
241000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             27050099
241100                                                                  27060099
241200         WHEN DL006-UPD (DL006-IDX)                               27070099
241300              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             27080099
241400                                                                  27090099
241500         WHEN DL006-DEL (DL006-IDX)                               27100099
241600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             27110099
241700                                                                  27120099
241800         WHEN DL006-ERR (DL006-IDX)                               27130099
241900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             27140099
242000     END-EVALUATE.                                                27150099
242100                                                                  27160099
242200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                27170099
242300                                                                  27180099
242400*----------------------------------------------------------------*27190099
242500*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *27200099
242600*----------------------------------------------------------------*27210099
242700                                                                  27220099
242800 6111-WRITE-LIST-QUEUE.                                           27230099
242900                                                                  27240099
243000     EXEC CICS                                                    27250099
243100         WRITEQ TS                                                27260099
243200             QUEUE (ASC-LIST-QUEUE-NAME)                          27270099
243300             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     27280099
243400             ITEM  (PV-SAVE-ITEM)                                 27290099
243500             REWRITE                                              27300099
243600             RESP  (PV-CICS-RESP)                                 27310099
243700     END-EXEC.                                                    27320099
243800*                                                                 27330099
243900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27340099
244000         CONTINUE                                                 27350099
244100     ELSE                                                         27360099
244200         SET DP013-CICS-ABEND  TO  TRUE                           27370099
244300         SET DP013-NO-ROLLBACK TO  TRUE                           27380099
244400         MOVE '6111-WRITE-LIST-QUEUE'                             27390099
244500                               TO  DP013-PARAGRAPH                27400099
244600         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  27410099
244700                               TO  DP013-MESSAGE-TEXT(1)          27420099
244800         PERFORM DP013-0000-PROCESS-ABEND                         27430099
244900     END-IF.                                                      27440099
245000                                                                  27450099
245100 EJECT                                                            27460099
245200*----------------------------------------------------------------*27470099
245300*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*27480099
245400*----------------------------------------------------------------*27490099
245500                                                                  27500099
245600 6112-READ-LIST-QUEUE.                                            27510099
245700                                                                  27520099
245800     EXEC CICS                                                    27530099
245900         READQ TS                                                 27540099
246000             QUEUE (ASC-LIST-QUEUE-NAME)                          27550099
246100             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     27560099
246200             ITEM  (PV-ITEM)                                      27570099
246300             RESP  (PV-CICS-RESP)                                 27580099
246400     END-EXEC.                                                    27590099
246500*                                                                 27600099
246600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27610099
246700         CONTINUE                                                 27620099
246800     ELSE                                                         27630099
246900         SET DP013-CICS-ABEND        TO TRUE                      27640099
247000         SET DP013-NO-ROLLBACK       TO TRUE                      27650099
247100         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           27660099
247200         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    27670099
247300                                     TO DP013-MESSAGE-TEXT(1)     27680099
247400         PERFORM DP013-0000-PROCESS-ABEND                         27690099
247500     END-IF.                                                      27700099
247600/                                                                 27710099
247610 6500-CHECK-DC-FUNC-PARM.                                         27720099
247611                                                                  27730099
247620        SET PS-DC-PARM-FUNC-NO  TO TRUE                           27740099
247621                                                                  27750099
247622     EXEC SQL                                                     27760099
247625        SELECT                                                    27770099
247626            FUNC_TXT                                              27780099
247627        INTO :KRPRPM-FUNC-TXT                                     27790099
247628        FROM                                                      27800099
247629            TKRPRPM                                               27810099
247630        WHERE SYS_PRC_FUNC_CDE = 'DLSRSN'                         27820099
247631          AND FUNC_PRC_STAT_CDE = 'AC'                            27830099
247632          AND CURRENT TIMESTAMP > FUNC_BEG_TMST                   27840099
247633          AND LOC_ID            = :ASC-KEY-OPER-UNT-ID            27850099
247634     END-EXEC.                                                    27860099
247635                                                                  27870099
247636       EVALUATE TRUE                                              27880099
247637           WHEN SQLCODE = ZERO                                    27890099
247638           WHEN SQLCODE = +100                                    27900099
247639                IF KRPRPM-FUNC-TXT = 'Y'                          27910099
247640                   SET PS-DC-PARM-FUNC-YES TO TRUE                27920099
247641                END-IF                                            27930099
247642           WHEN SQLCODE = -904                                    27940099
247643           WHEN SQLCODE = -911                                    27950099
247644           WHEN SQLCODE = -913                                    27960099
247645               MOVE SQLCODE                   TO PV-SOFT-SQLCODE  27970099
247646               MOVE '6500-CHECK-DC-FUNC-PARM' TO PV-SOFT-PARAGRAPH27980099
247647               MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA227990099
247648               MOVE LENGTH OF PV-CICS-MSG-AREA2                   28000099
247649                 TO PV-COMMAREA-LENGTH                            28010099
247650               EXEC CICS                                          28020099
247651                    WRITEQ TD                                     28030099
247652                     QUEUE  ('CSSL')                              28040099
247653                      FROM  (PV-CICS-MSG-AREA2)                   28050099
247654                    LENGTH  (PV-COMMAREA-LENGTH)                  28060099
247655                      RESP  (PV-CICS-RESP)                        28070099
247656               END-EXEC                                           28080099
247657               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        28090099
247658               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            28100099
247659               PERFORM 9900-SOFT-ABORT                            28110099
247660           WHEN OTHER                                             28120099
247661                MOVE '6500-CHECK-DC-FUNC-PARM'                    28130099
247662                                 TO DP013-PARAGRAPH               28140099
247663                MOVE 'GET PARM FOR F22/F23'                       28150099
247664                                 TO DP013-MESSAGE-TEXT (1)        28160099
247665                MOVE SQLCA       TO DP013-SQLCA                   28170099
247666                MOVE 'TKRPRPM '  TO DP013-DB2-TABLE-NAME (1)      28180099
247667                SET DP013-DB2-ABEND                               28190099
247668                    DP013-XCTL-DISPLAY-RESTART                    28200099
247669                                     TO TRUE                      28210099
247670                    PERFORM DP013-0000-PROCESS-ABEND              28220099
247671       END-EVALUATE.                                              28230099
247673                                                                  28240099
247680                                                                  28250099
247700 7000-COUNT-DOORS.                                                28260099
247800     MOVE DP020-LOCATION-NBR          TO CNDCDR-OPER-UNT-ID       28270099
247900     MOVE ZERO                        TO PV-DOOR-COUNT            28280099
248000                                                                  28290099
248100     EXEC SQL                                                     28300099
248200         SELECT  COUNT(*)                                         28310099
248300           INTO  :PV-DOOR-COUNT                                   28320099
248400           FROM  TCNDCDR DR                                       28330099
248500         WHERE DR.OPER_UNT_ID = :CNDCDR-OPER-UNT-ID               28340099
248600               AND   DOOR_TYP_CDE IN ('SH', 'DS', 'ST')           28350099
248700     END-EXEC                                                     28360099
248800                                                                  28370099
248900     EVALUATE TRUE                                                28380099
249000         WHEN SQLCODE = ZERO                                      28390099
249100         WHEN SQLCODE = +100                                      28400099
249200             CONTINUE                                             28410099
249300         WHEN SQLCODE = -904                                      28420099
249400         WHEN SQLCODE = -911                                      28430099
249500         WHEN SQLCODE = -913                                      28440099
249600             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    28450099
249700             MOVE '7000-COUNT-DOORS'        TO PV-SOFT-PARAGRAPH  28460099
249800             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  28470099
249900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     28480099
250000               TO PV-COMMAREA-LENGTH                              28490099
250100             EXEC CICS                                            28500099
250200                  WRITEQ TD                                       28510099
250300                   QUEUE  ('CSSL')                                28520099
250400                    FROM  (PV-CICS-MSG-AREA2)                     28530099
250500                  LENGTH  (PV-COMMAREA-LENGTH)                    28540099
250600                    RESP  (PV-CICS-RESP)                          28550099
250700             END-EXEC                                             28560099
250800             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          28570099
250900             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              28580099
251000             PERFORM 9900-SOFT-ABORT                              28590099
251100         WHEN OTHER                                               28600099
251200              MOVE '7000-COUNT-DOORS'                             28610099
251300                               TO DP013-PARAGRAPH                 28620099
251400              MOVE 'GET VENDOR NAME     '                         28630099
251500                               TO DP013-MESSAGE-TEXT (1)          28640099
251600              MOVE SQLCA       TO DP013-SQLCA                     28650099
251700              MOVE 'TCNDCDR '  TO DP013-DB2-TABLE-NAME (1)        28660099
251800              SET DP013-DB2-ABEND                                 28670099
251900                  DP013-XCTL-DISPLAY-RESTART                      28680099
252000                                   TO TRUE                        28690099
252100                  PERFORM DP013-0000-PROCESS-ABEND                28700099
252200     END-EVALUATE.                                                28710099
252300                                                                  28720099
252400 7010-LOCATION-DESC.                                              28730099
252500     MOVE DP020-LOCATION-NBR          TO XLT00010-LOC-NBR         28740099
252600                                                                  28750099
252700     EXEC SQL                                                     28760099
252800         SELECT  LOC_NM                                           28770099
252900           INTO  :XLT00010-LOC-NM                                 28780099
253000           FROM  XLT_LOC                                          28790099
253100         WHERE LOC_NBR        = :XLT00010-LOC-NBR                 28800099
253200     END-EXEC                                                     28810099
253300                                                                  28820099
253400     EVALUATE TRUE                                                28830099
253500         WHEN SQLCODE = ZERO                                      28840099
253600             MOVE XLT00010-LOC-NM     TO ASC-KEY-OPER-DESC        28850099
253700         WHEN SQLCODE = +100                                      28860099
253800             MOVE ALL '?'             TO ASC-KEY-OPER-DESC        28870099
253900         WHEN SQLCODE = -904                                      28880099
254000         WHEN SQLCODE = -911                                      28890099
254100         WHEN SQLCODE = -913                                      28900099
254200             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    28910099
254300             MOVE '7010-LOCATION-DESC'      TO PV-SOFT-PARAGRAPH  28920099
254400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  28930099
254500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     28940099
254600               TO PV-COMMAREA-LENGTH                              28950099
254700             EXEC CICS                                            28960099
254800                  WRITEQ TD                                       28970099
254900                   QUEUE  ('CSSL')                                28980099
255000                    FROM  (PV-CICS-MSG-AREA2)                     28990099
255100                  LENGTH  (PV-COMMAREA-LENGTH)                    29000099
255200                    RESP  (PV-CICS-RESP)                          29010099
255300             END-EXEC                                             29020099
255400             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29030099
255500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              29040099
255600             PERFORM 9900-SOFT-ABORT                              29050099
255700         WHEN OTHER                                               29060099
255800              MOVE '7010-LOCATION-DESC'                           29070099
255900                               TO DP013-PARAGRAPH                 29080099
256000              MOVE 'GET LOCATION DESCRIPTION'                     29090099
256100                               TO DP013-MESSAGE-TEXT (1)          29100099
256200              MOVE SQLCA       TO DP013-SQLCA                     29110099
256300              MOVE 'XLT_LOC '  TO DP013-DB2-TABLE-NAME (1)        29120099
256400              SET DP013-DB2-ABEND                                 29130099
256500                  DP013-XCTL-DISPLAY-RESTART                      29140099
256600                                   TO TRUE                        29150099
256700                  PERFORM DP013-0000-PROCESS-ABEND                29160099
256800     END-EVALUATE.                                                29170099
256900                                                                  29180099
257000 7030-COUNT-TEMPLATE-DOORS.                                       29190099
257100                                                                  29200099
257200     MOVE ZERO                        TO PV-TEMPLATE-DOOR-COUNT   29210099
257300     EXEC SQL                                                     29220099
257400         SELECT  COUNT(*)                                         29230099
257500           INTO  :PV-TEMPLATE-DOOR-COUNT                          29240099
257600           FROM  DLT_DOOR_GP                                      29250099
257700         WHERE DOOR_GP_TMPL_ID = :DLT00001-DOOR-GP-TMPL-ID        29260099
257800     END-EXEC                                                     29270099
257900                                                                  29280099
258000     EVALUATE TRUE                                                29290099
258100         WHEN SQLCODE = ZERO                                      29300099
258200         WHEN SQLCODE = +100                                      29310099
258300             CONTINUE                                             29320099
258400         WHEN SQLCODE = -904                                      29330099
258500         WHEN SQLCODE = -911                                      29340099
258600         WHEN SQLCODE = -913                                      29350099
258700             MOVE SQLCODE             TO PV-SOFT-SQLCODE          29360099
258800             MOVE '7030-COUNT-TEMPLATE-DOORS'                     29370099
258900                                      TO PV-SOFT-PARAGRAPH        29380099
259000             MOVE PV-SOFT-ABORT-MSG   TO PV-CICS-MSG-AREA2        29390099
259100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     29400099
259200               TO PV-COMMAREA-LENGTH                              29410099
259300             EXEC CICS                                            29420099
259400                  WRITEQ TD                                       29430099
259500                   QUEUE  ('CSSL')                                29440099
259600                    FROM  (PV-CICS-MSG-AREA2)                     29450099
259700                  LENGTH  (PV-COMMAREA-LENGTH)                    29460099
259800                    RESP  (PV-CICS-RESP)                          29470099
259900             END-EXEC                                             29480099
260000             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29490099
260100             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              29500099
260200             PERFORM 9900-SOFT-ABORT                              29510099
260300         WHEN OTHER                                               29520099
260400              MOVE '7030-COUNT-TEMPLATE-DOORS'                    29530099
260500                                      TO DP013-PARAGRAPH          29540099
260600              MOVE 'COUNT GROUPS WITHIN TEMPLATE'                 29550099
260700                                      TO DP013-MESSAGE-TEXT (1)   29560099
260800              MOVE SQLCA              TO DP013-SQLCA              29570099
260900              MOVE 'DLT_DOOR_GP'      TO DP013-DB2-TABLE-NAME (1) 29580099
261000              SET DP013-DB2-ABEND                                 29590099
261100                  DP013-XCTL-DISPLAY-RESTART                      29600099
261200                                   TO TRUE                        29610099
261300                  PERFORM DP013-0000-PROCESS-ABEND                29620099
261400     END-EVALUATE.                                                29630099
261500                                                                  29640099
261600 7020-COUNT-GROUPS.                                               29650099
261700     MOVE ZERO                        TO PV-GROUP-COUNT           29660099
261800     EXEC SQL                                                     29670099
261900         SELECT  COUNT(DISTINCT DOOR_GP_NBR)                      29680099
262000           INTO  :PV-GROUP-COUNT                                  29690099
262100           FROM  DLT_DOOR_GP                                      29700099
262200         WHERE DOOR_GP_TMPL_ID = :DLT00001-DOOR-GP-TMPL-ID        29710099
262300     END-EXEC                                                     29720099
262400                                                                  29730099
262500     EVALUATE TRUE                                                29740099
262600         WHEN SQLCODE = ZERO                                      29750099
262700         WHEN SQLCODE = +100                                      29760099
262800             CONTINUE                                             29770099
262900         WHEN SQLCODE = -904                                      29780099
263000         WHEN SQLCODE = -911                                      29790099
263100         WHEN SQLCODE = -913                                      29800099
263200             MOVE SQLCODE             TO PV-SOFT-SQLCODE          29810099
263300             MOVE '7030-COUNT-TEMPLATE-DOORS'                     29820099
263400                                      TO PV-SOFT-PARAGRAPH        29830099
263500             MOVE PV-SOFT-ABORT-MSG   TO PV-CICS-MSG-AREA2        29840099
263600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     29850099
263700               TO PV-COMMAREA-LENGTH                              29860099
263800             EXEC CICS                                            29870099
263900                  WRITEQ TD                                       29880099
264000                   QUEUE  ('CSSL')                                29890099
264100                    FROM  (PV-CICS-MSG-AREA2)                     29900099
264200                  LENGTH  (PV-COMMAREA-LENGTH)                    29910099
264300                    RESP  (PV-CICS-RESP)                          29920099
264400             END-EXEC                                             29930099
264500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29940099
264600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              29950099
264700             PERFORM 9900-SOFT-ABORT                              29960099
264800         WHEN OTHER                                               29970099
264900              MOVE '7030-COUNT-TEMPLATE-DOORS'                    29980099
265000                                      TO DP013-PARAGRAPH          29990099
265100              MOVE 'COUNT DOORS WITHIN TEMPLATE'                  30000099
265200                                      TO DP013-MESSAGE-TEXT (1)   30010099
265300              MOVE SQLCA              TO DP013-SQLCA              30020099
265400              MOVE 'DLT_DOOR_GP'      TO DP013-DB2-TABLE-NAME (1) 30030099
265500              SET DP013-DB2-ABEND                                 30040099
265600                  DP013-XCTL-DISPLAY-RESTART                      30050099
265700                                   TO TRUE                        30060099
265800                  PERFORM DP013-0000-PROCESS-ABEND                30070099
265900     END-EVALUATE.                                                30080099
266000                                                                  30090099
266100/                                                                 30100099
266200 7100-OPEN-TEMPLATE-CSR.                                          30110099
266300                                                                  30120099
266400     EXEC SQL                                                     30130099
266500         OPEN TEMPLATE-CSR                                        30140099
266600     END-EXEC                                                     30150099
266700                                                                  30160099
266800     EVALUATE TRUE                                                30170099
266900         WHEN SQLCODE = ZERO                                      30180099
267000             CONTINUE                                             30190099
267100         WHEN SQLCODE = -904                                      30200099
267200         WHEN SQLCODE = -911                                      30210099
267300         WHEN SQLCODE = -913                                      30220099
267400             MOVE '7100-OPEN-TEMPLATE-CSR'                        30230099
267500                                      TO DP013-PARAGRAPH          30240099
267600             MOVE 'DB2 TIMEOUT ATTEMPTING TO OPEN CSR'            30250099
267700                                      TO DP013-MESSAGE-TEXT (1)   30260099
267800             MOVE SQLCA               TO DP013-SQLCA              30270099
267900             MOVE 'DLT_DOOR_GP_TMPL'  TO DP013-DB2-TABLE-NAME (1) 30280099
268000             SET DP013-DB2-ABEND                                  30290099
268100                 DP013-XCTL-DISPLAY-RESTART                       30300099
268200                                      TO TRUE                     30310099
268300             PERFORM DP013-0000-PROCESS-ABEND                     30320099
268400         WHEN SQLWARN0 NOT = SPACES                               30330099
268500         WHEN SQLCODE < ZERO                                      30340099
268600         WHEN SQLCODE > ZERO                                      30350099
268700             MOVE '7100-OPEN-TEMPLATE-CSR'                        30360099
268800                                      TO DP013-PARAGRAPH          30370099
268900             MOVE 'OPEN TEMPLATE CURSOR - '                       30380099
269000                                      TO DP013-MESSAGE-TEXT (1)   30390099
269100             MOVE SQLCA               TO DP013-SQLCA              30400099
269200             MOVE 'DLT_DOOR_GP_TMPL'  TO DP013-DB2-TABLE-NAME (1) 30410099
269300             SET DP013-DB2-ABEND                                  30420099
269400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30430099
269500             PERFORM DP013-0000-PROCESS-ABEND                     30440099
269600     END-EVALUATE.                                                30450099
269700*                                                                 30460099
269800 7110-FETCH-TEMPLATE-CSR.                                         30470099
269900                                                                  30480099
270000     EXEC SQL                                                     30490099
270100         FETCH TEMPLATE-CSR                                       30500099
270200         INTO                                                     30510099
270300             :DLT00000-DOOR-GP-TMPL-DESC                          30520099
270400         ,   :DLT00000-DOOR-GP-TMPL-ID                            30530099
270500         ,   :PV-TEMPLATE-STATUS                                  30540099
270600     END-EXEC                                                     30550099
270700                                                                  30560099
270800     EVALUATE TRUE                                                30570099
270900         WHEN SQLCODE = ZERO                                      30580099
271000             CONTINUE                                             30590099
271100         WHEN SQLCODE = +100                                      30600099
271200              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 30610099
271300                                                                  30620099
271400         WHEN SQLCODE = -904                                      30630099
271500         WHEN SQLCODE = -911                                      30640099
271600         WHEN SQLCODE = -913                                      30650099
271700             MOVE '7110-FETCH-TEMPLATE-CSR'                       30660099
271800                                      TO DP013-PARAGRAPH          30670099
271900             MOVE 'DB2 TIMEOUT ATTEMPTING TO FETCH CSR'           30680099
272000                                      TO DP013-MESSAGE-TEXT (1)   30690099
272100             MOVE SQLCA               TO DP013-SQLCA              30700099
272200             MOVE 'DLT_DOOR_GP_TMPL'  TO DP013-DB2-TABLE-NAME (1) 30710099
272300             SET DP013-DB2-ABEND                                  30720099
272400                 DP013-XCTL-DISPLAY-RESTART                       30730099
272500                                      TO TRUE                     30740099
272600             PERFORM DP013-0000-PROCESS-ABEND                     30750099
272700         WHEN SQLWARN0 NOT = SPACE                                30760099
272800         WHEN SQLCODE NOT = ZERO                                  30770099
272900              MOVE '7110-FETCH-TEMPLATE-CSR'                      30780099
273000                               TO DP013-PARAGRAPH                 30790099
273100              MOVE 'FETCH TEMPLATE CURSOR'                        30800099
273200                               TO DP013-MESSAGE-TEXT (1)          30810099
273300              MOVE SQLCA       TO DP013-SQLCA                     30820099
273400              SET DP013-DB2-ABEND                                 30830099
273500                               TO TRUE                            30840099
273600              PERFORM DP013-0000-PROCESS-ABEND                    30850099
273700     END-EVALUATE.                                                30860099
273800                                                                  30870099
273900 7120-CLOSE-TEMPLATE-CSR.                                         30880099
274000                                                                  30890099
274100     EXEC SQL                                                     30900099
274200         CLOSE TEMPLATE-CSR                                       30910099
274300     END-EXEC                                                     30920099
274400                                                                  30930099
274500     EVALUATE TRUE                                                30940099
274600         WHEN SQLCODE = ZERO                                      30950099
274700             CONTINUE                                             30960099
274800         WHEN SQLWARN0 NOT = SPACES                               30970099
274900         WHEN SQLCODE < ZERO                                      30980099
275000         WHEN SQLCODE > ZERO                                      30990099
275100             MOVE 'DLT_DOOR_GP_TMPL'  TO DP013-DB2-TABLE-NAME (1) 31000099
275200             MOVE '7120-CLOSE-TEMPLATE-CSR'                       31010099
275300                                      TO DP013-PARAGRAPH          31020099
275400             MOVE 'CLOSE TEMPLATE CURSOR '                        31030099
275500                                      TO DP013-MESSAGE-TEXT (1)   31040099
275600             MOVE SQLCA               TO DP013-SQLCA              31050099
275700             SET DP013-DB2-ABEND                                  31060099
275800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31070099
275900             PERFORM DP013-0000-PROCESS-ABEND                     31080099
276000     END-EVALUATE.                                                31090099
276100/                                                                 31100099
276200 7200-INACTIVATE-TEMPLATES.                                       31110099
276300     MOVE DP020-LOCATION-NBR          TO DLT00000-DC-NBR          31120099
276400     EXEC SQL                                                     31130099
276500         UPDATE DLT_DOOR_GP_TMPL                                  31140099
276600         SET                                                      31150099
276700             ACTV_IND = 'N'                                       31160099
276800*        ,   LAST_GP_MNT_TMST = CURRENT TIMESTAMP                 31170099
276900*        ,   LAST_GP_MNT_USR_ID = :DP020-USERID                   31180099
277000     WHERE                                                        31190099
277100         DC_NBR                 = :DLT00000-DC-NBR                31200099
277200*    AND ACTV_IND               = 'Y'                             31210099
277300     END-EXEC                                                     31220099
277400                                                                  31230099
277500     EVALUATE TRUE                                                31240099
277600         WHEN SQLCODE = ZERO                                      31250099
277700             CONTINUE                                             31260099
277800         WHEN SQLCODE = -904                                      31270099
277900         WHEN SQLCODE = -911                                      31280099
278000         WHEN SQLCODE = -913                                      31290099
278100             MOVE '7200-INACTIVATE-TEMPLATES'                     31300099
278200                                      TO DP013-PARAGRAPH          31310099
278300             MOVE 'DB2 TIMEOUT ATTEMPTING TO UPDATE TEMPLATES'    31320099
278400                                      TO DP013-MESSAGE-TEXT (1)   31330099
278500             MOVE SQLCA               TO DP013-SQLCA              31340099
278600             MOVE 'DLT_DOOR_GP_TMPL'  TO DP013-DB2-TABLE-NAME (1) 31350099
278700             SET DP013-DB2-ABEND                                  31360099
278800                 DP013-XCTL-DISPLAY-RESTART                       31370099
278900                                      TO TRUE                     31380099
279000             PERFORM DP013-0000-PROCESS-ABEND                     31390099
279100         WHEN SQLWARN0 NOT = SPACES                               31400099
279200         WHEN SQLCODE < ZERO                                      31410099
279300         WHEN SQLCODE > ZERO                                      31420099
279400             MOVE 'DLT_DOOR_GP_TMPL'  TO DP013-DB2-TABLE-NAME (1) 31430099
279500             MOVE '7200-INACTIVATE-TEMPLATES'                     31440099
279600                                      TO DP013-PARAGRAPH          31450099
279700             MOVE 'INACTIVATE ALL ACTIVE TEMPLATES'               31460099
279800                                      TO DP013-MESSAGE-TEXT (1)   31470099
279900             MOVE SQLCA               TO DP013-SQLCA              31480099
280000             SET DP013-DB2-ABEND                                  31490099
280100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31500099
280200             PERFORM DP013-0000-PROCESS-ABEND                     31510099
280300     END-EVALUATE.                                                31520099
280400/                                                                 31530099
280500 7210-ACTIVATE-SELECTED-TEMPL.                                    31540099
280600                                                                  31550099
280700     EXEC SQL                                                     31560099
280800         UPDATE DLT_DOOR_GP_TMPL                                  31570099
280900         SET                                                      31580099
281000             ACTV_IND = 'Y'                                       31590099
281100         ,   LAST_GP_MNT_TMST = CURRENT TIMESTAMP                 31600099
281200         ,   LAST_GP_MNT_USR_ID = :DP020-USERID                   31610099
281300     WHERE                                                        31620099
281400         DOOR_GP_TMPL_ID       = :DLT00000-DOOR-GP-TMPL-ID        31630099
281500     END-EXEC                                                     31640099
281600                                                                  31650099
281700     EVALUATE TRUE                                                31660099
281800         WHEN SQLCODE = ZERO                                      31670099
281900             CONTINUE                                             31680099
282000         WHEN SQLCODE = -904                                      31690099
282100         WHEN SQLCODE = -911                                      31700099
282200         WHEN SQLCODE = -913                                      31710099
282300             MOVE '7210-ACTIVATE-SELECTED-TEMPLATE'               31720099
282400                                      TO DP013-PARAGRAPH          31730099
282500             MOVE 'DB2 TIMEOUT ATTEMPTING TO UPDATE TEMPLATES'    31740099
282600                                      TO DP013-MESSAGE-TEXT (1)   31750099
282700             MOVE SQLCA               TO DP013-SQLCA              31760099
282800             MOVE 'DLT_DOOR_GP_TMPL'  TO DP013-DB2-TABLE-NAME (1) 31770099
282900             SET DP013-DB2-ABEND                                  31780099
283000                 DP013-XCTL-DISPLAY-RESTART                       31790099
283100                                      TO TRUE                     31800099
283200             PERFORM DP013-0000-PROCESS-ABEND                     31810099
283300         WHEN SQLWARN0 NOT = SPACES                               31820099
283400         WHEN SQLCODE < ZERO                                      31830099
283500         WHEN SQLCODE > ZERO                                      31840099
283600             MOVE 'DLT_DOOR_GP_TMPL'  TO DP013-DB2-TABLE-NAME (1) 31850099
283700             MOVE '7210-ACTIVATE-SELECTED-TEMPLATE'               31860099
283800                                      TO DP013-PARAGRAPH          31870099
283900             MOVE 'ACTIVATE SELECTED TEMPLATE'                    31880099
284000                                      TO DP013-MESSAGE-TEXT (1)   31890099
284100             MOVE SQLCA               TO DP013-SQLCA              31900099
284200             SET DP013-DB2-ABEND                                  31910099
284300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31920099
284400             PERFORM DP013-0000-PROCESS-ABEND                     31930099
284500     END-EVALUATE.                                                31940099
284600/ ESS-ERROR-NO                                                    31950099
284700 7500-PROCESS-ACTV-TEM-ASGMT.                                     31960099
284800     MOVE +0  TO PV-ACTV-TEM-ASGMT-COUNT.                         31970099
284900     SET  PS-PROCESS-ERROR-NO                                     31980099
284910          PS-NOT-EOC-ACT-TEM-ASGMT-CSR TO TRUE.                   31990099
284920     MOVE ASC-KEY-OPER-UNT-ID  TO DK-DC-NBR                       32000099
285000     PERFORM 7515-OPEN-ACT-TEM-ASGMT-CSR                          32010099
285100     PERFORM 7530-FETCH-ACT-TEM-ASGMT-CSR                         32020099
285200             UNTIL PS-EOC-ACT-TEM-ASGMT-CSR OR                    32030099
285210              PS-PROCESS-ERROR                                    32040099
285300     PERFORM 7550-CLOSE-ACT-TEM-ASGMT-CSR.                        32050099
285400                                                                  32060099
285500*----------------------------------------------------------------*32070099
285600* OPEN UPD CARTON CSR                                             32080099
285700*----------------------------------------------------------------*32090099
285800 7515-OPEN-ACT-TEM-ASGMT-CSR.                                     32100099
285900                                                                  32110099
286000     MOVE 'CURSOR: ACT-TEM-ASGMT-CSR'                             32120099
286100                       TO DP013-MESSAGE-TEXT (2).                 32130099
286200     EXEC SQL                                                     32140099
286300          OPEN ACT-TEM-ASGMT-CSR                                  32150099
286400     END-EXEC.                                                    32160099
286500                                                                  32170099
286600     EVALUATE TRUE                                                32180099
286700         WHEN SQLCODE = ZERO                                      32190099
286800             CONTINUE                                             32200099
286900         WHEN SQLCODE = -904                                      32210099
287000         WHEN SQLCODE = -911                                      32220099
287100         WHEN SQLCODE = -913                                      32230099
287200             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    32240099
287300             MOVE '7515-OPEN-ACT-TEM-ASGMT-CSR'                   32250099
287300                                            TO PV-SOFT-PARAGRAPH  32260099
287400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  32270099
287500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     32280099
287600               TO PV-COMMAREA-LENGTH                              32290099
287700             EXEC CICS                                            32300099
287800                  WRITEQ TD                                       32310099
287900                   QUEUE  ('CSSL')                                32320099
288000                    FROM  (PV-CICS-MSG-AREA2)                     32330099
288100                  LENGTH  (PV-COMMAREA-LENGTH)                    32340099
288200                    RESP  (PV-CICS-RESP)                          32350099
288300             END-EXEC                                             32360099
288400             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          32370099
288500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              32380099
288600         WHEN SQLWARN0 NOT = SPACES                               32390099
288700         WHEN SQLCODE < ZERO                                      32400099
288800         WHEN SQLCODE > ZERO                                      32410099
287300             MOVE '7515-OPEN-ACT-TEM-ASGMT-CSR'                   32420099
289000                                   TO DP013-PARAGRAPH             32430099
289100             MOVE 'OPEN ACT-TEM-ASGMT-CSR - '                     32440099
289200                                   TO DP013-MESSAGE-TEXT (1)      32450099
289300             MOVE SQLCA            TO DP013-SQLCA                 32460099
289400             MOVE 'DLT_ASGMT '     TO DP013-DB2-TABLE-NAME (1)    32470099
289400             MOVE 'DLT_TEM_ASGMT ' TO DP013-DB2-TABLE-NAME (2)    32480099
289500             SET DP013-DB2-ABEND                                  32490099
289600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32500099
289700             PERFORM DP013-0000-PROCESS-ABEND                     32510099
289800     END-EVALUATE.                                                32520099
289900                                                                  32530099
290000                                                                  32540099
290100*----------------------------------------------------------------*32550099
290200* FETCH UPDATE CARTON CSR - INACTIVATE ROWS                       32560099
290300*----------------------------------------------------------------*32570099
290400 7530-FETCH-ACT-TEM-ASGMT-CSR.                                    32580099
290410                                                                  32590099
290500     MOVE SPACES TO PV-USER-ID-KOHL-TEMP-IND.                     32600099
290510                                                                  32610099
290600     MOVE 'CURSOR: ACT-TEM-ASGMT-CSR'                             32620099
290700                       TO DP013-MESSAGE-TEXT (2).                 32630099
290800                                                                  32640099
290900     EXEC SQL                                                     32650099
291000          FETCH ACT-TEM-ASGMT-CSR                                 32660099
291100           INTO :DLT00004-ASGMT-STRT-DTE                          32670099
291110              , :DLT00004-ASGMT-NBR-TXT                           32680099
291120              , :DLT00004-ASGMT-NBR-SEQ-NBR                       32690099
291121              , :DLT00003-TEM-ASGMT-SEQ-NBR                       32700099
291130              , :PV-USER-ID-KOHL-TEMP-IND                         32710099
291140              , :DLT00003-KOHLS-USR-ID  :DN-KOHLS-USR-NULL        32720099
291150              , :DLT00003-TMP-USR-ID    :DN-TEMP-USR-NULL         32730099
291200     END-EXEC.                                                    32740099
291300                                                                  32750099
291400     EVALUATE TRUE                                                32760099
291500         WHEN SQLCODE = ZERO                                      32770099
291510           ADD +1 TO PV-ACTV-TEM-ASGMT-COUNT                      32780099
291600           PERFORM 7560-PROCESS-CLOSE-ASSIGNMENTS                 32790099
291800         WHEN SQLCODE = +100                                      32800099
291900             SET PS-EOC-ACT-TEM-ASGMT-CSR TO TRUE                 32810099
292000         WHEN SQLCODE = -904                                      32820099
292100         WHEN SQLCODE = -911                                      32830099
292200         WHEN SQLCODE = -913                                      32840099
292300             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    32850099
                   MOVE '7530-FETCH-ACT-TEM-ASGMT-CSR'                  32860099
292400                                            TO PV-SOFT-PARAGRAPH  32870099
292500             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  32880099
292600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     32890099
292700               TO PV-COMMAREA-LENGTH                              32900099
292800             EXEC CICS                                            32910099
292900                  WRITEQ TD                                       32920099
293000                   QUEUE  ('CSSL')                                32930099
293100                    FROM  (PV-CICS-MSG-AREA2)                     32940099
293200                  LENGTH  (PV-COMMAREA-LENGTH)                    32950099
293300                    RESP  (PV-CICS-RESP)                          32960099
293400             END-EXEC                                             32970099
293500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          32980099
293600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              32990099
293700             PERFORM 9900-SOFT-ABORT                              33000099
293800         WHEN SQLWARN0 NOT = SPACE                                33010099
293900         WHEN SQLCODE NOT = ZERO                                  33020099
                    MOVE '7530-FETCH-ACT-TEM-ASGMT-CSR'                 33030099
294100                               TO DP013-PARAGRAPH                 33040099
294200              MOVE 'FETCH ACT-TEM-ASGMT-CSR   '                   33050099
294300                               TO DP013-MESSAGE-TEXT (2)          33060099
294400              MOVE SQLCA       TO DP013-SQLCA                     33070099
294500              SET DP013-DB2-ABEND                                 33080099
294600                               TO TRUE                            33090099
294700              PERFORM DP013-0000-PROCESS-ABEND                    33100099
294800     END-EVALUATE.                                                33110099
294900                                                                  33120099
295000                                                                  33130099
295100*----------------------------------------------------------------*33140099
295200* CLOSE LABEL CROSS REFERENCE CURSOR                              33150099
295300*----------------------------------------------------------------*33160099
295400 7550-CLOSE-ACT-TEM-ASGMT-CSR.                                    33170099
295500                                                                  33180099
295600     MOVE 'CURSOR: ACT-TEM-ASGMT-CSR'                             33190099
295700                       TO DP013-MESSAGE-TEXT (2).                 33200099
295800     EXEC SQL                                                     33210099
295900          CLOSE ACT-TEM-ASGMT-CSR                                 33220099
296000     END-EXEC.                                                    33230099
296100                                                                  33240099
296200     EVALUATE TRUE                                                33250099
296300         WHEN SQLCODE = ZERO                                      33260099
296400             CONTINUE                                             33270099
296500         WHEN SQLCODE = -904                                      33280099
296600         WHEN SQLCODE = -911                                      33290099
296700         WHEN SQLCODE = -913                                      33300099
296800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   33310099
                   MOVE '7550-CLOSE-ACT-TEM-ASGMT-CSR'                  33320099
296900                                             TO PV-SOFT-PARAGRAPH 33330099
297000             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 33340099
297100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     33350099
297200               TO PV-COMMAREA-LENGTH                              33360099
297300             EXEC CICS                                            33370099
297400                  WRITEQ TD                                       33380099
297500                   QUEUE  ('CSSL')                                33390099
297600                    FROM  (PV-CICS-MSG-AREA2)                     33400099
297700                  LENGTH  (PV-COMMAREA-LENGTH)                    33410099
297800                    RESP  (PV-CICS-RESP)                          33420099
297900             END-EXEC                                             33430099
298000             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          33440099
298100             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              33450099
298200         WHEN SQLWARN0 NOT = SPACES                               33460099
298300         WHEN SQLCODE < ZERO                                      33470099
298400         WHEN SQLCODE > ZERO                                      33480099
                   MOVE '7550-CLOSE-ACT-TEM-ASGMT-CSR'                  33490099
298600                               TO DP013-PARAGRAPH                 33500099
298700             MOVE 'CLOSE ACT-TEM-ASGMT-CSR     '                  33510099
298800                               TO DP013-MESSAGE-TEXT (1)          33520099
298900             MOVE SQLCA        TO DP013-SQLCA                     33530099
299000             MOVE 'DLT_TEM_ASGMT' TO DP013-DB2-TABLE-NAME (1)     33540099
289400             MOVE 'DLT_ASGMT '    TO DP013-DB2-TABLE-NAME (2)     33550099
299100             SET DP013-DB2-ABEND                                  33560099
299200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33570099
299300             PERFORM DP013-0000-PROCESS-ABEND                     33580099
299400     END-EVALUATE.                                                33590099
299401                                                                  33600099
299410 7560-PROCESS-CLOSE-ASSIGNMENTS.                                  33610099
299411                                                                  33620099
299420     INITIALIZE DL005-ASGMT-COMMAREA                              33630099
299430     SET DL005-BY-ASGMT-NBR                                       33640099
299440         DL005-END-FROM-ASGMT                                     33650099
299450         DL005-DO-NOT-COMMIT-UPDATE   TO TRUE                     33660099
299460                                                                  33670099
299470     MOVE DLT00004-ASGMT-STRT-DTE     TO DL005-KEY-START-DTE      33680099
299480     MOVE DLT00004-ASGMT-NBR-TXT      TO DL005-KEY-NBR-TXT        33690099
P50752*START PRB0050752                                                 33700099
299490     MOVE DLT00004-ASGMT-NBR-SEQ-NBR  TO DL005-KEY-NBR-SEQ-NBR    33710099
P50752                                         PV-KEY-NBR-SEQ-NBR       33720099
P50752*END PRB0050752                                                   33730099
299491     MOVE DLT00003-TEM-ASGMT-SEQ-NBR  TO                          33740099
299492                                     DL005-KEY-TEM-ASGMT-SEQ-NBR  33750099
299493     MOVE PV-USER-ID-KOHL-TEMP-IND    TO DL005-KEY-USR-TYPE-CDE   33760099
299494     IF   DL005-KEY-USR-IS-KOHLS                                  33770099
299495          MOVE DLT00003-KOHLS-USR-ID  TO DL005-KEY-USER-ID        33780099
299496                                         DL005-KEY-ADD-BY-USER-ID 33790099
299497     ELSE                                                         33800099
299498          MOVE DLT00003-TMP-USR-ID    TO DL005-KEY-USER-ID        33810099
299499                                         DL005-KEY-ADD-BY-USER-ID 33820099
299500     END-IF                                                       33830099
299501*    MOVE DP020-USERID                TO DL005-KEY-ADD-BY-USER-ID 33840099
299502                                                                  33850099
299503     MOVE 'DLKCS404'                  TO DL005-ORIG-CALLING-PGM-NM33860099
299504                                         DL005-KEY-LVE-PGM-NM     33870099
299505     IF ASC-CONFIRM-ISTOP                                         33880099
299508         SET DL005-KEY-LVE-RSN-SSTOP  TO TRUE                     33890099
299509     ELSE                                                         33900099
299510         SET DL005-KEY-LVE-RSN-ASTOP  TO TRUE                     33910099
299511     END-IF                                                       33920099
299512                                                                  33930099
299513     PERFORM 8620-CALL-DLKUP002.                                  33940099
299514     IF PS-PROCESS-ERROR-NO                                       33950099
299515        PERFORM 8410-CALL-XLKUP033                                33960099
299516     END-IF.                                                      33970099
299517/                                                                 33980099
284700 7600-PROCESS-ACTV-ASGMT.                                         33990099
284800     MOVE +0                       TO PV-ACTV-ASGMT-COUNT.        34000099
284900     SET  PS-PROCESS-ERROR-NO                                     34010099
284910          PS-NOT-EOC-ACT-ASGMT-CSR TO TRUE.                       34020099
284920     MOVE ASC-KEY-OPER-UNT-ID      TO DK-DC-NBR                   34030099
285000     PERFORM 7615-OPEN-ACT-ASGMT-CSR                              34040099
285100     PERFORM 7630-FETCH-ACT-ASGMT-CSR                             34050099
285200             UNTIL PS-EOC-ACT-ASGMT-CSR OR                        34060099
285210              PS-PROCESS-ERROR                                    34070099
285300     PERFORM 7650-CLOSE-ACT-ASGMT-CSR.                            34080099
299520                                                                  34090099
285800 7615-OPEN-ACT-ASGMT-CSR.                                         34100099
285900                                                                  34110099
286000     MOVE 'CURSOR: ACT-ASGMT-CSR'                                 34120099
286100                       TO DP013-MESSAGE-TEXT (2).                 34130099
286200     EXEC SQL                                                     34140099
286300          OPEN ACT-ASGMT-CSR                                      34150099
286400     END-EXEC.                                                    34160099
286500                                                                  34170099
286600     EVALUATE TRUE                                                34180099
286700         WHEN SQLCODE = ZERO                                      34190099
286800             CONTINUE                                             34200099
286900         WHEN SQLCODE = -904                                      34210099
287000         WHEN SQLCODE = -911                                      34220099
287100         WHEN SQLCODE = -913                                      34230099
287200             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   34240099
287300             MOVE '7615-OPEN-ACT-ASGMT-CSR ' TO PV-SOFT-PARAGRAPH 34250099
287400             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 34260099
287500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     34270099
287600               TO PV-COMMAREA-LENGTH                              34280099
287700             EXEC CICS                                            34290099
287800                  WRITEQ TD                                       34300099
287900                   QUEUE  ('CSSL')                                34310099
288000                    FROM  (PV-CICS-MSG-AREA2)                     34320099
288100                  LENGTH  (PV-COMMAREA-LENGTH)                    34330099
288200                    RESP  (PV-CICS-RESP)                          34340099
288300             END-EXEC                                             34350099
288400             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          34360099
288500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              34370099
288600         WHEN SQLWARN0 NOT = SPACES                               34380099
288700         WHEN SQLCODE < ZERO                                      34390099
288800         WHEN SQLCODE > ZERO                                      34400099
288900             MOVE '7615-OPEN-ACT-ASGMT-CSR'                       34410099
289000                               TO DP013-PARAGRAPH                 34420099
289100             MOVE 'OPEN ACT-ASGMT-CSR - '                         34430099
289200                               TO DP013-MESSAGE-TEXT (1)          34440099
289300             MOVE SQLCA        TO DP013-SQLCA                     34450099
289400             MOVE 'DLT_ASGMT ' TO DP013-DB2-TABLE-NAME (1)        34460099
289500             SET DP013-DB2-ABEND                                  34470099
289600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               34480099
289700             PERFORM DP013-0000-PROCESS-ABEND                     34490099
289800     END-EVALUATE.                                                34500099
289900                                                                  34510099
290400 7630-FETCH-ACT-ASGMT-CSR.                                        34520099
290410                                                                  34530099
290600     MOVE 'CURSOR: ACT-ASGMT-CSR'                                 34540099
290700                       TO DP013-MESSAGE-TEXT (2).                 34550099
290800                                                                  34560099
290900     EXEC SQL                                                     34570099
291000          FETCH ACT-ASGMT-CSR                                     34580099
291100           INTO :DLT00004-ASGMT-STRT-DTE                          34590099
291110              , :DLT00004-ASGMT-NBR-TXT                           34600099
291120              , :DLT00004-ASGMT-NBR-SEQ-NBR                       34610099
291200     END-EXEC.                                                    34620099
291300                                                                  34630099
291400     EVALUATE TRUE                                                34640099
291500         WHEN SQLCODE = ZERO                                      34650099
291510             ADD +1 TO PV-ACTV-ASGMT-COUNT                        34660099
291600             PERFORM 7660-CLOSE-ASSIGNMENT                        34670099
291800         WHEN SQLCODE = +100                                      34680099
291900             SET PS-EOC-ACT-ASGMT-CSR TO TRUE                     34690099
292000         WHEN SQLCODE = -904                                      34700099
292100         WHEN SQLCODE = -911                                      34710099
292200         WHEN SQLCODE = -913                                      34720099
292300             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    34730099
                   MOVE '7630-FETCH-ACT-ASGMT-CSR'                      34740099
292400                                            TO PV-SOFT-PARAGRAPH  34750099
292500             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  34760099
292600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     34770099
292700               TO PV-COMMAREA-LENGTH                              34780099
292800             EXEC CICS                                            34790099
292900                  WRITEQ TD                                       34800099
293000                   QUEUE  ('CSSL')                                34810099
293100                    FROM  (PV-CICS-MSG-AREA2)                     34820099
293200                  LENGTH  (PV-COMMAREA-LENGTH)                    34830099
293300                    RESP  (PV-CICS-RESP)                          34840099
293400             END-EXEC                                             34850099
293500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          34860099
293600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              34870099
293700             PERFORM 9900-SOFT-ABORT                              34880099
293800         WHEN SQLWARN0 NOT = SPACE                                34890099
293900         WHEN SQLCODE NOT = ZERO                                  34900099
                    MOVE '7630-FETCH-ACT-ASGMT-CSR'                     34910099
294100                               TO DP013-PARAGRAPH                 34920099
294200              MOVE 'FETCH ACT-ASGMT-CSR   '                       34930099
294300                               TO DP013-MESSAGE-TEXT (2)          34940099
294400              MOVE SQLCA       TO DP013-SQLCA                     34950099
294500              SET DP013-DB2-ABEND                                 34960099
294600                               TO TRUE                            34970099
294700              PERFORM DP013-0000-PROCESS-ABEND                    34980099
294800     END-EVALUATE.                                                34990099
294900                                                                  35000099
295400 7650-CLOSE-ACT-ASGMT-CSR.                                        35010099
295500                                                                  35020099
295600     MOVE 'CURSOR: ACT-ASGMT-CSR'                                 35030099
295700                       TO DP013-MESSAGE-TEXT (2).                 35040099
295800     EXEC SQL                                                     35050099
295900          CLOSE ACT-ASGMT-CSR                                     35060099
296000     END-EXEC.                                                    35070099
296100                                                                  35080099
296200     EVALUATE TRUE                                                35090099
296300         WHEN SQLCODE = ZERO                                      35100099
296400             CONTINUE                                             35110099
296500         WHEN SQLCODE = -904                                      35120099
296600         WHEN SQLCODE = -911                                      35130099
296700         WHEN SQLCODE = -913                                      35140099
296800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   35150099
                   MOVE '7650-CLOSE-ACT-ASGMT-CSR'                      35160099
296900                                             TO PV-SOFT-PARAGRAPH 35170099
297000             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 35180099
297100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     35190099
297200               TO PV-COMMAREA-LENGTH                              35200099
297300             EXEC CICS                                            35210099
297400                  WRITEQ TD                                       35220099
297500                   QUEUE  ('CSSL')                                35230099
297600                    FROM  (PV-CICS-MSG-AREA2)                     35240099
297700                  LENGTH  (PV-COMMAREA-LENGTH)                    35250099
297800                    RESP  (PV-CICS-RESP)                          35260099
297900             END-EXEC                                             35270099
298000             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          35280099
298100             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              35290099
298200         WHEN SQLWARN0 NOT = SPACES                               35300099
298300         WHEN SQLCODE < ZERO                                      35310099
298400         WHEN SQLCODE > ZERO                                      35320099
                   MOVE '7650-CLOSE-ACT-ASGMT-CSR'                      35330099
298600                               TO DP013-PARAGRAPH                 35340099
298700             MOVE 'CLOSE ACT-ASGMT-CSR     '                      35350099
298800                               TO DP013-MESSAGE-TEXT (1)          35360099
298900             MOVE SQLCA        TO DP013-SQLCA                     35370099
289400             MOVE 'DLT_ASGMT ' TO DP013-DB2-TABLE-NAME (1)        35380099
299100             SET DP013-DB2-ABEND                                  35390099
299200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               35400099
299300             PERFORM DP013-0000-PROCESS-ABEND                     35410099
299400     END-EVALUATE.                                                35420099
299401                                                                  35430099
058000 7660-CLOSE-ASSIGNMENT.                                           35440099
058100                                                                  35450099
299505     IF ASC-CONFIRM-ISTOP                                         35460099
299508         SET DL005-KEY-LVE-RSN-SSTOP  TO TRUE                     35470099
299509     ELSE                                                         35480099
299510         SET DL005-KEY-LVE-RSN-ASTOP  TO TRUE                     35490099
299511     END-IF                                                       35500099
                                                                        35510099
058200     PERFORM                                                      35520099
058300         WITH TEST AFTER                                          35530099
058400         VARYING PV-RETRY-COUNTER                                 35540099
058500         FROM 1 BY 1                                              35550099
058600         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  35560099
058700            OR SQLCODE = ZERO                                     35570099
058800                                                                  35580099
058900         EXEC SQL                                                 35590099
059000             UPDATE DLT_ASGMT                                     35600099
059100                SET ASGMT_STP_TMST    = CURRENT TIMESTAMP         35610099
059200                   ,ASGMT_STP_RSN_CDE = :DL005-KEY-LVE-RSN-CDE    35620099
059300                   ,STP_BY_PGM_NM     = :PC-CURRENT-PROGRAM-NAME  35630099
059400                                                                  35640099
059500            WHERE  ASGMT_STRT_DTE    = :DLT00004-ASGMT-STRT-DTE   35650099
059600              AND  ASGMT_NBR_TXT     = :DLT00004-ASGMT-NBR-TXT    35660099
059700              AND  ASGMT_NBR_SEQ_NBR = :DLT00004-ASGMT-NBR-SEQ-NBR35670099
059800              AND  ASGMT_STP_RSN_CDE = 'N'                        35680099
059900         END-EXEC                                                 35690099
060000                                                                  35700099
291400         EVALUATE TRUE                                            35710099
291500             WHEN SQLCODE = ZERO                                  35720099
292000             WHEN SQLCODE = -904                                  35730099
292100             WHEN SQLCODE = -911                                  35740099
292200             WHEN SQLCODE = -913                                  35750099
291510                 CONTINUE                                         35760099
293800             WHEN SQLWARN0 NOT = SPACE                            35770099
293900             WHEN SQLCODE NOT = ZERO                              35780099
                        MOVE 4 TO PV-RETRY-COUNTER                      35790099
                        MOVE '7660-CLOSE-ASSIGNMENT'                    35800099
294100                                   TO DP013-PARAGRAPH             35810099
294200                  MOVE 'DB2 ERROR TRYING TO CLOSE ASSIGNMENT'     35820099
294300                                   TO DP013-MESSAGE-TEXT (1)      35830099
294400                  MOVE SQLCA       TO DP013-SQLCA                 35840099
282800                  MOVE 'DLT_ASGMT' TO DP013-DB2-TABLE-NAME (1)    35850099
294500                  SET DP013-DB2-ABEND                             35860099
283000                      DP013-XCTL-DISPLAY-RESTART                  35870099
294600                                   TO TRUE                        35880099
294700                  PERFORM DP013-0000-PROCESS-ABEND                35890099
294800         END-EVALUATE                                             35900099
058200     END-PERFORM.                                                 35910099
                                                                        35920099
058600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         35930099
282300         MOVE '7660-CLOSE-ASSIGNMENT'                             35940099
282400                               TO DP013-PARAGRAPH                 35950099
282500         MOVE 'DB2 CONTENTION TRYING TO CLOSE ASSIGNMENT'         35960099
282600                               TO DP013-MESSAGE-TEXT (1)          35970099
282700         MOVE SQLCA            TO DP013-SQLCA                     35980099
282800         MOVE 'DLT_ASGMT'      TO DP013-DB2-TABLE-NAME (1)        35990099
282900         SET DP013-DB2-ABEND                                      36000099
283000             DP013-XCTL-DISPLAY-RESTART                           36010099
283100                               TO TRUE                            36020099
283200         PERFORM DP013-0000-PROCESS-ABEND                         36030099
           END-IF.                                                      36040099
062300                                                                  36050099
299530 8620-CALL-DLKUP002.                                              36060099
299540                                                                  36070099
299550     CALL DL005-USER-PGM USING DFHEIBLK                           36080099
299560                               DL005-COMMAREA                     36090099
299570                               DL005-ASGMT-COMMAREA               36100099
299590     EVALUATE TRUE                                                36110099
299600         WHEN DL005-SUCCESSFUL                                    36120099
299601         WHEN DL005-ASGMT-NOT-ACTIVE                              36130099
299610             CONTINUE                                             36140099
299650         WHEN DL005-SQL-ERROR                                     36150099
299651             SET PS-PROCESS-ERROR           TO TRUE               36160099
299653             MOVE '8620-CALL-DLKUP002'      TO PV-SOFT-PARAGRAPH  36170099
299654             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  36180099
299655             MOVE LENGTH OF PV-CICS-MSG-AREA2                     36190099
299656               TO PV-COMMAREA-LENGTH                              36200099
299657             EXEC CICS                                            36210099
299658                  WRITEQ TD                                       36220099
299659                   QUEUE  ('CSSL')                                36230099
299660                    FROM  (PV-CICS-MSG-AREA2)                     36240099
299661                  LENGTH  (PV-COMMAREA-LENGTH)                    36250099
299662                    RESP  (PV-CICS-RESP)                          36260099
299663             END-EXEC                                             36270099
299664             MOVE 'DLKCS404 - END ASSIGNMENT'                     36280099
299665                                      TO DP013-MESSAGE-TEXT(1)    36290099
299666             MOVE DL005-SQL-ERROR-PARA                            36300099
299667                                      TO DP013-MESSAGE-TEXT(2)    36310099
P50752*START PRB0050752                                                 36320099
299668             MOVE DL005-SQLCA         TO DP013-SQLCA              36330099
P50752                                         SQLCODE                  36340099
299668             MOVE SQLCODE             TO PV-SQL-CODE              36350099
P50752             STRING 'START DTE: '           DELIMITED BY SIZE     36360099
P50752                    DL005-KEY-START-DTE     DELIMITED BY SIZE     36370099
P50752                    ', KEY #: '             DELIMITED BY SIZE     36380099
P50752                    DL005-KEY-NBR-TXT       DELIMITED BY SIZE     36390099
P50752                    ', KEY SEQ #: '         DELIMITED BY SIZE     36400099
P50752                    PV-KEY-NBR-SEQ-NBR      DELIMITED BY SIZE     36410099
P50752             INTO   PV-END-ASGMNT-ERROR-MSG                       36420099
299676             MOVE PV-END-ASGMNT-ERROR-MSG                         36430099
P50752                                       TO DP013-MESSAGE-TEXT (3)  36440099
299673             MOVE '8620-CALL-DLKUT002' TO DP013-PARAGRAPH         36450099
299674             STRING 'DB2 ERROR IN PROGRAM DLKCS404, SQLCODE= '    36460099
P50752                                            DELIMITED BY SIZE     36470099
P50752                    PV-SQL-CODE             DELIMITED BY SIZE     36480099
P50752             INTO   PV-SQL-ERROR-CODE                             36490099
299674             MOVE PV-SQL-ERROR-CODE    TO DP013-MESSAGE-TEXT (4)  36500099
299677             SET DP013-CICS-ABEND                                 36510099
299678                 DP013-ROLLBACK       TO TRUE                     36520099
299679             PERFORM DP013-0000-PROCESS-ABEND                     36530099
299680         WHEN DL005-INVALID-ACCESS                                36540099
299690             SET PS-PROCESS-ERROR           TO TRUE               36550099
299694             MOVE 'DLKCS404 - END ASSIGNMENT'                     36560099
299695                                      TO DP013-MESSAGE-TEXT(1)    36570099
299696             MOVE DL005-SQL-ERROR-PARA                            36580099
299697                                      TO DP013-MESSAGE-TEXT(2)    36590099
299698             MOVE DL005-SQLCA         TO DP013-SQLCA              36600099
299706             MOVE '8620-CALL-DLKUP002' TO DP013-PARAGRAPH         36610099
P50752             MOVE 'DLKCS404 - DL005-INVALID-ACCESS  '             36620099
P50752                                       TO DP013-MESSAGE-TEXT (3)  36630099
P50752             MOVE 'DLKUP002'           TO DP013-MESSAGE-TEXT (4)  36640099
P50752*END PRB0050752                                                   36650099
299711             SET DP013-CICS-ABEND                                 36660099
299712                 DP013-ROLLBACK       TO TRUE                     36670099
299713             PERFORM DP013-0000-PROCESS-ABEND                     36680099
299716         WHEN OTHER                                               36690099
299717             SET PS-PROCESS-ERROR           TO TRUE               36700099
299718             MOVE '8620-CALL-DLKUP002' TO DP013-PARAGRAPH         36710099
299719             MOVE 'DLKCS404 - UNDETERMINED ERROR IN PGM: '        36720099
299720                                      TO DP013-MESSAGE-TEXT (1)   36730099
299721             MOVE DL005-ASGMT-SQLCODE TO PV-DISPLAY-SQLCODE       36740099
299722           MOVE DL005-KEY-NBR-SEQ-NBR TO PV-DISPLAY-ASGMT-NBR     36750099
299723           MOVE DL005-KEY-TEM-ASGMT-SEQ-NBR                       36760099
299724                                      TO PV-DISPLAY-TEM-ASGMT-NBR 36770099
299725             STRING 'DLKUP002 KEYS = ' DELIMITED BY SIZE          36780099
299726                DL005-KEYS             DELIMITED BY SIZE          36790099
299727                           INTO DP013-MESSAGE-TEXT(2)             36800099
299739             STRING '* NBR-SEQ      = ' DELIMITED BY SIZE         36810099
299740          PV-DISPLAY-ASGMT-NBR     DELIMITED BY SIZE              36820099
299741                    ' * TEM-SEQ       = ' DELIMITED BY SIZE       36830099
299742          PV-DISPLAY-TEM-ASGMT-NBR     DELIMITED BY SIZE          36840099
299743                           INTO DP013-MESSAGE-TEXT(3)             36850099
299746             PERFORM DP013-0000-PROCESS-ABEND                     36860099
299747             SET DP013-CICS-ABEND                                 36870099
299748                 DP013-ROLLBACK       TO TRUE                     36880099
299753     END-EVALUATE.                                                36890099
299754                                                                  36900099
299755                                                                  36910099
299756 8410-CALL-XLKUP033.                                              36920099
299757                                                                  36930099
299758     INITIALIZE XL072-EAI-EXPORT-COMMAREA                         36940099
299759                                                                  36950099
299760     SET XL072-PC-APP-ID          TO TRUE.                        36960099
299761     MOVE 'DC LABOR'              TO XL072-EVNT-OBJ-TXT           36970099
299762     MOVE 'INDIRECT LABOR'        TO XL072-EVNT-OBJ-ACTN-TXT      36980099
299763     MOVE DL005-KEY-ADD-BY-USER-ID TO XL072-CRE-BY-USR-ID.        36990099
299764**** MOVE DL005-KEY-ADD-BY-USER-ID TO XL072-CRE-BY-USR-ID.        37000099
299765     MOVE 'DLKCS404'              TO XL072-CRE-PGM-NM.            37010099
299766     MOVE  DK-DC-NBR              TO XL072-EVNT-KY-1-NBR.         37020099
299767     MOVE 'N/A'                   TO XL072-DTL-COPYBOOK-NM        37030099
299768     IF ASC-CONFIRM-INACTV                                        37040099
299772        MOVE 'ENDSHP'                TO XL072-EVNT-KY-1-TXT       37050099
299773     ELSE                                                         37060099
299774        MOVE 'IDONE'                TO XL072-EVNT-KY-1-TXT        37070099
299775     END-IF                                                       37080099
299776                                                                  37090099
299777     SET XL072-COMMIT-UPDATE      TO TRUE.                        37100099
299778     MOVE 'DLKCS410'              TO XL072-ORIG-CALLING-PGM-NM.   37110099
299779                                                                  37120099
299780     EXEC SQL                                                     37130099
299781         SET :XL072-EVNT-KY-1-TMST = CURRENT TIMESTAMP            37140099
299782           , :PV-LABOR-CURRENT-TIMESTAMP =                        37150099
299783              CURRENT TIMESTAMP + 1 SECOND                        37160099
299784     END-EXEC                                                     37170099
299785                                                                  37180099
299786     CALL XL072-USER-PGM USING DFHEIBLK                           37190099
299787                               XL072-COMMAREA                     37200099
299788                               XL072-EAI-EXPORT-COMMAREA          37210099
299789                                                                  37220099
299794     EVALUATE TRUE                                                37230099
299795         WHEN XL072-SUCCESSFUL                                    37240099
299796             CONTINUE                                             37250099
299797         WHEN XL072-SQL-ERROR                                     37260099
299798             SET PS-PROCESS-ERROR           TO TRUE               37270099
299799             MOVE XL072-EAI-DB-SQLCODE      TO PV-SOFT-SQLCODE    37280099
299800             MOVE '8410-CALL-XLKUP033'      TO PV-SOFT-PARAGRAPH  37290099
299801             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  37300099
299802             MOVE LENGTH OF PV-CICS-MSG-AREA2                     37310099
299803               TO PV-COMMAREA-LENGTH                              37320099
299804             EXEC CICS                                            37330099
299805                  WRITEQ TD                                       37340099
299806                   QUEUE  ('CSSL')                                37350099
299807                    FROM  (PV-CICS-MSG-AREA2)                     37360099
299808                  LENGTH  (PV-COMMAREA-LENGTH)                    37370099
299809                    RESP  (PV-CICS-RESP)                          37380099
299810             END-EXEC                                             37390099
299811             MOVE '8410-CALL-XLKUP033'                            37400099
299812                                      TO DP013-PARAGRAPH          37410099
299813             MOVE 'DLKCS404 - END ASSIGNMENT'                     37420099
299814                                      TO DP013-MESSAGE-TEXT(1)    37430099
299815             MOVE XL072-SQL-ERROR-PARA                            37440099
299816                                      TO DP013-MESSAGE-TEXT(2)    37450099
299817             MOVE XL072-SQLCA         TO DP013-SQLCA              37460099
299818             PERFORM DP013-0000-PROCESS-ABEND                     37470099
299819             SET DP013-CICS-ABEND                                 37480099
299820                 DP013-ROLLBACK       TO TRUE                     37490099
299821         WHEN XL072-INVALID-ACCESS                                37500099
299822             SET PS-PROCESS-ERROR           TO TRUE               37510099
299823             MOVE '8410-CALL-XLKUP033' TO DP013-PARAGRAPH         37520099
299824             MOVE 'DLKCS410 - DB2 ERROR IN PROGRAM: '             37530099
299825                                      TO DP013-MESSAGE-TEXT (1)   37540099
299826             MOVE 'XLKUP033'          TO DP013-MESSAGE-TEXT (2)   37550099
299827             SET DP013-CICS-ABEND                                 37560099
299828                 DP013-ROLLBACK       TO TRUE                     37570099
299829             PERFORM DP013-0000-PROCESS-ABEND                     37580099
299830         WHEN OTHER                                               37590099
299831             SET PS-PROCESS-ERROR           TO TRUE               37600099
299832             MOVE '8410-CALL-XLKUP033' TO DP013-PARAGRAPH         37610099
299833             MOVE 'DLKCS410 - UNDETERMINED ERROR IN PGM: '        37620099
299834                                      TO DP013-MESSAGE-TEXT (1)   37630099
299835             MOVE 'XLKUP033'          TO DP013-MESSAGE-TEXT (2)   37640099
299836             SET DP013-CICS-ABEND                                 37650099
299837                 DP013-ROLLBACK       TO TRUE                     37660099
299838             PERFORM DP013-0000-PROCESS-ABEND                     37670099
299840     END-EVALUATE.                                                37680099
299841                                                                  37690099
299842 9900-SOFT-ABORT.                                                 37700099
299850                                                                  37710099
299900     EXEC CICS SYNCPOINT                                          37720099
300000          ROLLBACK                                                37730099
300100     END-EXEC.                                                    37740099
300200                                                                  37750099
300300     SET  PS-ERROR                                                37760099
300400          PS-SOFT-ABORT-ERROR                                     37770099
300500          DP020-MSG-FATAL       TO  TRUE.                         37780099
300600                                                                  37790099
300700 9910-ROLLBACK.                                                   37800099
300800                                                                  37810099
300900     EXEC CICS SYNCPOINT                                          37820099
301000          ROLLBACK                                                37830099
301100     END-EXEC.                                                    37840099
301200                                                                  37850099
301300/                                                                 37860099
301400*----------------------------------------------------------------*37870099
301500*    ABEND PROCESSOR MODULE                                      *37880099
301600*----------------------------------------------------------------*37890099
301700                                                                  37900099
301800     COPY DPPD013.                                                37910099
