000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      POKUT081.                                       00040000
000500 AUTHOR.          RYAN STAUFFACHER                                00050000
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
000700 DATE-WRITTEN.    06/04/01.                                       00070001
000800*DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000* WEEKLY PLANNED RECEIPTS PROGRAM                                 00100000
001100* THIS PROGRAM TAKES AN INPUT FILE AND CREATES A FLAT FILE WHICH  00110012
001200* WILL EVENTUALLY BE TURNED INTO THE WEEKLY PLANNED RECEIPTS VSAM 00120024
001300* FILE.                                                           00130000
001400******************************************************************00140000
      *  CHANGED PROGRAM TO NOT ABEND ON ROWS NOT FOUND IN TMDSEAR      00141024
      *  UNLESS PLANNED RECEIPT AMOUNT IS NOT ZERO.                     00142024
      *  MADE BY: R. STAUFFACHER          PITS #: 4314189               00143024
      ******************************************************************00144024
001500 ENVIRONMENT DIVISION.                                            00150000
001600*                                                                 00160000
001700*                                                                 00170000
001800 CONFIGURATION SECTION.                                           00180000
001900 SOURCE-COMPUTER. IBM-3090.                                       00190000
002000 OBJECT-COMPUTER. IBM-3090.                                       00200000
002100*                                                                 00210000
002200*                                                                 00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400 FILE-CONTROL.                                                    00240000
002500                                                                  00250000
002600     SELECT BASIC-RECEIPTS-FILE                                   00260000
002700         ASSIGN                       TO INP01.                   00270000
002800                                                                  00280000
002900                                                                  00290000
003000     SELECT DETAILED-RECEIPTS-FILE                                00300000
003100         ASSIGN                       TO OUT01.                   00310000
003200                                                                  00320000
003300     EJECT                                                        00330000
003400*                                                                 00340000
003500*                                                                 00350000
003600***************                                                   00360000
003700 DATA DIVISION.                                                   00370000
003800***************                                                   00380000
003900*                                                                 00390000
004000*                                                                 00400000
004100*                                                                 00410000
004200 FILE SECTION.                                                    00420000
004300                                                                  00430000
004400 FD  BASIC-RECEIPTS-FILE                                          00440000
004500     RECORDING MODE F                                             00450000
004600     LABEL RECORDS ARE STANDARD                                   00460000
004700     RECORD CONTAINS 600 CHARACTERS                               00470000
004800     BLOCK CONTAINS 0 RECORDS                                     00480000
004900     DATA RECORD IS BASIC-REC.                                    00490000
005000 01  BASIC-REC                        PIC X(600).                 00500000
005100                                                                  00510000
005200 FD  DETAILED-RECEIPTS-FILE                                       00520000
005300     RECORDING MODE F                                             00530000
005400     LABEL RECORDS ARE STANDARD                                   00540000
005500     RECORD CONTAINS 21 CHARACTERS                                00550013
005600     BLOCK CONTAINS 0 RECORDS                                     00560000
005700     DATA RECORD IS DETAILED-REC.                                 00570000
005800 01  DETAILED-REC                     PIC X(21).                  00580013
005900                                                                  00590000
006000     EJECT                                                        00600000
006100*                                                                 00610000
006200 WORKING-STORAGE SECTION.                                         00620000
006300 01  BASIC-RECORD.                                                00630000
006400    05  BR-DEPT-CLASS.                                            00640000
006500      10 BR-DEPT-RECORD.                                          00650002
006600        15 FILLER                    PIC X(03).                   00660002
006700        15 BR-DEPT-NBR               PIC X(03).                   00670002
006800        15 FILLER                    PIC X(12).                   00680000
006900   05  BR-SEASON-MONTH.                                           00690000
007000      10 BR-SEASON                   PIC X(01).                   00700000
007100      10 BR-YEAR.                                                 00710003
007200        15 BR-CC                     PIC 9(02).                   00720003
007300        15 BR-YY                     PIC 9(02).                   00730003
007400      10 BR-WEEK-IND                 PIC X(01).                   00740017
007500      10 BR-WK                       PIC 9(02).                   00750002
007600   05  FILLER                        PIC X(64).                   00760000
007700   05  BR-PLANNED-RECEIPTS           PIC X(15).                   00770000
007800   05  FILLER                        PIC X(493).                  00780000
007900*                                                                 00790000
       01 PV-PROGRAM-VARIABLES.                                         00800014
         05 PC-DECIMAL-PLACES            PIC S9(01)      VALUE +4.      00810014
      *                                                                 00820014
008000 01 PV-PROGRAM-VARIABLES.                                         00830000
008100     05 PV-HOLD-DEPT                 PIC X(3)    VALUE SPACES.    00840011
008200     05 PV-ABEND-PARAGRAPH           PIC X(30)      VALUE SPACES. 00850000
008300     05 PV-PLANNED-RECEIPTS-N        PIC S9(10)V9(04)             00860000
008400                                         COMP-3 VALUE ZERO.       00870000
008700     05 PV-PR-CHAR-POS               PIC 9(02)       VALUE ZERO.  00880000
008800     05 PV-PR-CHAR-DECIMAL-POS       PIC 9(02)       VALUE ZERO.  00890000
008900     05 PV-PR-POS-LEFT-OF-DECIMAL    PIC S9(02)      VALUE ZERO.  00900000
009000     05 PV-PR-CHAR                   PIC X(01).                   00910000
009100     05 PV-PR-NBR-LEFT-OF-DECIMAL    PIC 9(7) COMP-3.             00920000
009200     05 PV-PR-NBR-RIGHT-OF-DECIMAL   PIC 9(4) COMP-3.             00930000
009300     05 PV-PR-NBR                    PIC S9(7)V9(4).              00940000
009400     05 PV-WEEK-OF-MONTH.                                         00950005
009500       10 FILLER                     PIC 9(1).                    00960005
009600       10 PV-WEEK                    PIC 9(1).                    00970005
009700*                                                                 00980000
009800 01  PS-PROGRAM-SWITCHES.                                         00990000
009900     05  PS-BASIC-RECS-EOF-SW            PIC X(01)   VALUE 'N'.   01000000
010000         88  PS-BASIC-RECS-EOF                       VALUE 'Y'.   01010000
010100     05  PS-SP-FOUND-SW                  PIC X(01)   VALUE 'N'.   01020000
010200         88  PS-SP-NOT-FOUND                         VALUE 'N'.   01030000
010300         88  PS-SP-FOUND                             VALUE 'Y'.   01040000
010400     05  PS-PR-NEGATIVE-SW               PIC X(01)   VALUE 'N'.   01050000
010500         88  PS-PR-NOT-NEGATIVE                      VALUE 'N'.   01060000
010600         88  PS-PR-NEGATIVE                          VALUE 'Y'.   01070000
           05  PS-TMDSEAR-ERROR-SW             PIC X(01)   VALUE 'N'.   01071019
               88  PS-NO-TMDSEAR-ERROR                     VALUE 'N'.   01072019
               88  PS-TMDSEAR-ERROR                        VALUE 'Y'.   01073019
010700*                                                                 01080000
010800 01 PV-ABEND-CODE                   PIC S9(04)     VALUE +0       01090000
010900                                                      COMP SYNC.  01100000
011000     88 ABEND-4001-WRITE-ERROR                     VALUE +4001.   01110000
011100     88 ABEND-4002-READ-ERROR                      VALUE +4002.   01120000
011200     88 ABEND-4003-CTRL-CARD-ERROR                 VALUE +4003.   01130000
011300     88 ABEND-4004-TABLE-ERROR                     VALUE +4004.   01140000
011400     88 ABEND-4005-OPEN-ERROR                      VALUE +4005.   01150000
011500     88 ABEND-4006-CLOSE-ERROR                     VALUE +4006.   01160000
011600     88 ABEND-4007-SEQUENCE-ERROR                  VALUE +4007.   01170000
011700     88 ABEND-4008-DATA-ERROR                      VALUE +4008.   01180000
011800     88 ABEND-4009-KEY-DATA-ERROR                  VALUE +4009.   01190000
012100     88 ABEND-4013-DB2-ERROR                       VALUE +4013.   01220000
012200     88 ABEND-4019-CAL-ROUTINE-ERROR               VALUE +4019.   01230003
012300                                                                  01240000
012400*                                                                 01250000
012500******************************************************************01260000
012600*  MERCHANDISE PLANNING FILE LAYOUT.                              01270000
012700******************************************************************01280000
012800     COPY PORD032.                                                01290028
012900                                                                  01300000
013000******************************************************************01310002
013100*  CALENDAR ROUTINE.                                              01320002
013200******************************************************************01330002
013300     COPY DPWS500.                                                01340028
013400                                                                  01350002
013500* MERCHANDISE AREA TABLE.                                         01360000
013600     EXEC SQL                                                     01370000
013700         INCLUDE TMDSEAR                                          01380000
013800     END-EXEC.                                                    01390000
013900 EJECT                                                            01400000
014000*                                                                 01410000
014100* DB2 COMMUNICATION AREA                                          01420000
014200*                                                                 01430000
014300     EXEC SQL                                                     01440000
014400         INCLUDE SQLCA                                            01450000
014500     END-EXEC.                                                    01460000
014600 EJECT                                                            01470000
014700* DB2 COMMUNICATION AREA2                                         01480000
014800*                                                                 01490000
014900     COPY SQLCA2.                                                 01500000
015000 EJECT                                                            01510000
015100*                                                                 01520000
015200*                                                                 01530000
015300******************************************************************01540000
015400* MAIN BODY OF PROGRAM                                           *01550000
015500******************************************************************01560000
015600 PROCEDURE DIVISION.                                              01570000
015700                                                                  01580000
015800 0000-MAINLINE.                                                   01590000
015900     PERFORM 1000-INITIALIZE.                                     01600000
016000                                                                  01610000
016100     IF PS-BASIC-RECS-EOF                                         01620000
016200        DISPLAY 'NO RECORDS IN INPUT FILE'                        01630000
016300        DISPLAY '** POKUT081 ABEND - INPUT FILE EMPTY **'         01640006
016400        MOVE +4008                  TO PV-ABEND-CODE              01650007
016500        CALL 'ILBOABN0'             USING PV-ABEND-CODE           01660009
016600     ELSE                                                         01670000
016700       PERFORM 2000-PROCESS-INPUT                                 01680000
016800         UNTIL PS-BASIC-RECS-EOF                                  01690000
016900     END-IF.                                                      01700000
017000                                                                  01710000
017100     CLOSE BASIC-RECEIPTS-FILE                                    01720000
017200           DETAILED-RECEIPTS-FILE.                                01730000
017300     GOBACK.                                                      01740000
017400*                                                                 01750000
017500******************************************************************01760000
017600*     PERFORM INITIALIZATIONS                                    *01770000
017700******************************************************************01780000
017800                                                                  01790000
017900 1000-INITIALIZE.                                                 01800000
018000     OPEN INPUT  BASIC-RECEIPTS-FILE.                             01810000
018100     OPEN OUTPUT DETAILED-RECEIPTS-FILE.                          01820000
018200     PERFORM 9000-READ-BASIC-RECEIPTS.                            01830000
018300*                                                                 01840000
018400*                                                                 01850000
018500******************************************************************01860000
018600*     PROCESS INPUT RECORDS                                      *01870000
018700******************************************************************01880000
018800                                                                  01890000
018900 2000-PROCESS-INPUT.                                              01900000
           IF BR-WEEK-IND NOT EQUAL 'W'                                 01910017
              DISPLAY '*** ABEND ***'                                   01920017
              DISPLAY '*** THERE IS AN INVALID LINE FORMAT ***'         01930017
              DISPLAY 'WEEK INDICATOR = ' BR-WEEK-IND                   01940017
              SET ABEND-4008-DATA-ERROR TO TRUE                         01950017
              CALL 'ILBOABN0' USING PV-ABEND-CODE                       01960017
           END-IF                                                       01970017
019000     PERFORM 2100-REFORMAT-PLANNED-RECEIPTS.                      01980014
019100     PERFORM 2200-GET-MONTH-AND-WEEK.                             01990002
019200     IF (BR-DEPT-NBR NOT EQUAL PV-HOLD-DEPT)                      02000011
019300       PERFORM 2300-GET-MDSEAR-INFO                               02010011
019400     END-IF.                                                      02020011
      * IF THE MDSEAR ROW WAS FOUND FOR THE DEPT AND CLASS, WRITE THE   02020127
      * OUTPUT RECORD.  IF THE ROW WAS NOT FOUND AND AND THE PLANNED    02020226
      * RECEIPT AMOUNT IS ZERO, DO NOT WRITE AN OUTPUT RECORD, AND LET  02020326
      * THE PROGRAM READ IN THE NEXT RECORD FROM THE INPUT FILE.  IF THE02020426
      * TMDSEAR ROW WAS NOT FOUND AND THE PLANNED RECEIPT AMOUNT IS NOT 02020527
      * ZERO, THE PROGRAM WILL ABEND.                                   02020627
           IF PS-NO-TMDSEAR-ERROR                                       02021019
019500       PERFORM 9100-WRITE-DETAILED-RECS                           02030019
           ELSE                                                         02030120
             IF PV-PLANNED-RECEIPTS-N NOT EQUAL ZERO                    02030320
               DISPLAY 'A RECORD WITHOUT A CORRESPONDING TMDSEAR ROW'   02030422
               DISPLAY 'HAS PLANNED RECEIPTS NOT EQUAL TO ZERO.'        02030522
               DISPLAY 'SEASON AND WEEK: ' BR-SEASON-MONTH              02030623
               DISPLAY 'PLANNED RECEIPT AMOUNT: ' BR-PLANNED-RECEIPTS   02030728
               DISPLAY PV-ABEND-PARAGRAPH                               02030820
               PERFORM 9999-SQL-ERROR                                   02030920
             END-IF                                                     02031020
           END-IF.                                                      02032019
019600     MOVE BR-DEPT-NBR TO PV-HOLD-DEPT.                            02040011
019700     PERFORM 9000-READ-BASIC-RECEIPTS.                            02050000
019800*                                                                 02060000
019900******************************************************************02070000
020000*     PROCESS DEPARTMENT RECORD                                  *02080000
020100******************************************************************02090000
020200                                                                  02100000
020300 2100-REFORMAT-PLANNED-RECEIPTS.                                  02110014
020400     SET PS-SP-NOT-FOUND TO TRUE.                                 02120000
020500     SET PS-PR-NOT-NEGATIVE TO TRUE.                              02130000
020600     MOVE ZERO TO PV-PR-CHAR-DECIMAL-POS.                         02140000
020700     MOVE ZERO TO  PV-PR-POS-LEFT-OF-DECIMAL.                     02150000
020800                                                                  02160000
020900     IF (BR-PLANNED-RECEIPTS(1:1) EQUAL '-')                      02170000
021000       MOVE 1 TO PV-PR-CHAR-POS                                   02180000
021100       SET PS-PR-NEGATIVE TO TRUE                                 02190000
021200     ELSE                                                         02200000
021300       MOVE 0 TO PV-PR-CHAR-POS                                   02210000
021400     END-IF.                                                      02220000
021500                                                                  02230000
021600     PERFORM UNTIL (PS-SP-FOUND)                                  02240000
021700       ADD 1 TO PV-PR-CHAR-POS                                    02250000
021800       MOVE BR-PLANNED-RECEIPTS(PV-PR-CHAR-POS:1)                 02260000
021900                            TO PV-PR-CHAR                         02270000
022000       IF (PV-PR-CHAR EQUAL  ' ')                                 02280000
022100         SET PS-SP-FOUND TO TRUE                                  02290000
022200       ELSE                                                       02300000
022300         IF (PV-PR-CHAR EQUAL  '.')                               02310000
022400           MOVE PV-PR-CHAR-POS TO PV-PR-CHAR-DECIMAL-POS          02320000
022500         END-IF                                                   02330000
022600       END-IF                                                     02340000
022700       IF ((PV-PR-CHAR-DECIMAL-POS EQUAL ZERO) AND                02350000
022800            (PV-PR-CHAR NOT EQUAL  ' '))                          02360000
022900         ADD 1 TO PV-PR-POS-LEFT-OF-DECIMAL                       02370000
023000       END-IF                                                     02380000
023100     END-PERFORM.                                                 02390000
023200                                                                  02400000
023300     SUBTRACT 1 FROM PV-PR-CHAR-POS                               02410000
023400                                                                  02420000
023500     IF (PS-PR-NOT-NEGATIVE)                                      02430000
023600       MOVE BR-PLANNED-RECEIPTS(1:PV-PR-POS-LEFT-OF-DECIMAL)      02440000
023700         TO PV-PR-NBR-LEFT-OF-DECIMAL                             02450000
023800     ELSE                                                         02460000
023900       MOVE BR-PLANNED-RECEIPTS(2:PV-PR-POS-LEFT-OF-DECIMAL)      02470000
024000         TO PV-PR-NBR-LEFT-OF-DECIMAL                             02480000
024100     END-IF.                                                      02490000
024200                                                                  02500000
030600     IF (((PV-PR-CHAR-DECIMAL-POS NOT EQUAL ZERO) AND             02510014
030610         ((PV-PR-CHAR-POS - PV-PR-CHAR-DECIMAL-POS) EQUAL         02520014
030611          PC-DECIMAL-PLACES))                                     02530014
030620     OR (PV-PR-CHAR-DECIMAL-POS EQUAL ZERO))                      02540014
030650       IF (PV-PR-CHAR-DECIMAL-POS NOT EQUAL ZERO)                 02550014
030700         MOVE BR-PLANNED-RECEIPTS((PV-PR-CHAR-DECIMAL-POS + 1):   02560014
030800                        (PV-PR-CHAR-POS - PV-PR-CHAR-DECIMAL-POS))02570014
030900           TO PV-PR-NBR-RIGHT-OF-DECIMAL                          02580014
030910       ELSE                                                       02590014
030920         MOVE ZERO TO PV-PR-NBR-RIGHT-OF-DECIMAL                  02600014
030930       END-IF                                                     02610014
031000     ELSE                                                         02620014
031010         DISPLAY '*** ABEND ***'                                  02630014
031020         DISPLAY '*** THERE IS AN INVALID NUMBER FORMAT ***'      02640014
031021         DISPLAY 'PLANNED RECEIPT AMOUNT = ' BR-PLANNED-RECEIPTS  02650014
031030         SET ABEND-4008-DATA-ERROR TO TRUE                        02660014
031040         CALL 'ILBOABN0' USING PV-ABEND-CODE                      02670014
031200     END-IF.                                                      02680014
025000                                                                  02690000
025100     IF PS-PR-NEGATIVE                                            02700000
025200       COMPUTE PV-PLANNED-RECEIPTS-N =                            02710000
025300          ((PV-PR-NBR-LEFT-OF-DECIMAL +                           02720000
025400           (PV-PR-NBR-RIGHT-OF-DECIMAL / 10000)) * -1)            02730000
025500     ELSE                                                         02740000
025600       COMPUTE PV-PLANNED-RECEIPTS-N =                            02750000
025700          (PV-PR-NBR-LEFT-OF-DECIMAL +                            02760000
025800           (PV-PR-NBR-RIGHT-OF-DECIMAL / 10000))                  02770000
025900     END-IF.                                                      02780000
026100*                                                                 02790000
026200******************************************************************02800000
026300*     GET FISCAL MONTH AND WEEK FOR RECORD.                      *02810002
026400******************************************************************02820000
026500                                                                  02830000
026600 2200-GET-MONTH-AND-WEEK.                                         02840002
026700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              02850003
026800     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       02860003
026900     SET DPG52-LK-DTE-FISC-WEEK-CC TO TRUE.                       02870003
027000     MOVE BR-YEAR TO DPG52-FISCAL-CC-WEEK-YR.                     02880003
027100     MOVE BR-WK TO DPG52-FISCAL-CC-WEEK-WK.                       02890003
027200     CALL DP500-KOHLS-CALENDAR-ROUTINE                            02900003
027300                   USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.     02910003
027400     IF (NOT DPG54-NO-ERROR)                                      02920003
027500         DISPLAY  '** ABEND **'                                   02930003
027600         DISPLAY 'POKUT081 - CALENDAR ROUTINE '                   02940003
027700                   'ERROR GETTING FISCAL WEEK AND MONTH'          02950003
027800         DISPLAY 'SEASON AND WEEK ' BR-SEASON-MONTH               02960003
027900         DISPLAY 'FORMAT = '                                      02970003
028000                   DPG52-LK-DATE-FORMAT-CODE                      02980003
028100         DISPLAY 'ERROR MESSAGE = '                               02990003
028200                   DPG54-ERROR-MESSAGE                            03000003
028300         SET ABEND-4019-CAL-ROUTINE-ERROR TO TRUE                 03010003
028400         CALL 'ILBOABN0'  USING PV-ABEND-CODE                     03020003
028500     END-IF.                                                      03030003
028600     MOVE DPG56-FISCAL-PERIOD-WEEK-X TO PV-WEEK-OF-MONTH.         03040005
028800*                                                                 03050005
028900******************************************************************03060002
029000*     GET GMM, DMA, AND BUYER INFORMATION FROM TMDSEAR TABLE     *03070002
029100******************************************************************03080002
029200                                                                  03090002
029300 2300-GET-MDSEAR-INFO.                                            03100002
           SET PS-NO-TMDSEAR-ERROR TO TRUE.                             03101019
029400     MOVE '2300-GET-MDSEAR-INFO'                                  03110002
029500                                 TO PV-ABEND-PARAGRAPH.           03120000
029600                                                                  03130000
029700     EXEC SQL                                                     03140000
029800          SELECT O.GMA_NBR                                        03150000
029900                ,O.DMA_NBR                                        03160000
030000                ,O.BYR_NBR                                        03170000
030100            INTO :MDSEAR-GMA-NBR                                  03180000
030200                ,:MDSEAR-DMA-NBR                                  03190000
030300                ,:MDSEAR-BYR-NBR                                  03200000
030400          FROM TMDSEAR O                                          03210000
030500          WHERE O.DEPT_NBR = :BR-DEPT-NBR                         03220002
030600            AND O.MAJ_CL_NBR = '00'                               03230002
030700            AND O.SUB_CL_NBR = '000'                              03240000
030800            AND O.END_DTE =                                       03250000
030900                (SELECT MAX(I.END_DTE)                            03260000
031000                 FROM TMDSEAR I                                   03270000
031100                 WHERE O.DEPT_NBR   = I.DEPT_NBR                  03280000
031200                 AND   O.MAJ_CL_NBR = I.MAJ_CL_NBR                03290000
031300                 AND I.SUB_CL_NBR   ='000')                       03300000
031400     END-EXEC.                                                    03310000
031500                                                                  03320000
031600     EVALUATE TRUE                                                03330000
031700       WHEN SQLCODE = ZEROS                                       03340000
031800         CONTINUE                                                 03350000
             WHEN SQLCODE = +100                                        03351020
               DISPLAY '** DEPT **        ** = ' BR-DEPT-NBR            03352020
               SET PS-TMDSEAR-ERROR TO TRUE                             03354020
032100       WHEN OTHER                                                 03360000
               SET PS-TMDSEAR-ERROR TO TRUE                             03361019
               DISPLAY '** DEPT **        ** = ' BR-DEPT-NBR            03362020
032200         DISPLAY PV-ABEND-PARAGRAPH                               03370020
032300         PERFORM 9999-SQL-ERROR                                   03390020
032400     END-EVALUATE.                                                03400000
032500*                                                                 03410000
032600******************************************************************03420000
032700*     READ INPUT RECORDS                                         *03430000
032800******************************************************************03440000
032900                                                                  03450000
033000 9000-READ-BASIC-RECEIPTS.                                        03460000
033100     READ BASIC-RECEIPTS-FILE                                     03470000
033200         INTO BASIC-RECORD                                        03480000
033300         AT END                                                   03490000
033400              SET PS-BASIC-RECS-EOF TO TRUE.                      03500000
033500*                                                                 03510000
033600******************************************************************03520000
033700*     WRITE DETAILED RECORD                                      *03530002
033800******************************************************************03540000
033900                                                                  03550000
034000 9100-WRITE-DETAILED-RECS.                                        03560002
034100     MOVE MDSEAR-GMA-NBR TO PO032-GMM-NO.                         03570002
034200     MOVE MDSEAR-DMA-NBR TO PO032-DIV-NO.                         03580002
034300     MOVE BR-DEPT-NBR    TO PO032-DEPT-NO.                        03590002
034400     MOVE BR-YY          TO PO032-YEAR-NO.                        03600002
034500     MOVE DPG56-FISCAL-PERIOD-NBR TO PO032-MONTH-NO.              03610002
034600     MOVE PV-WEEK        TO PO032-WEEK-NO.                        03620005
034700     MOVE MDSEAR-BYR-NBR TO PO032-BUYER-NMBR.                     03630002
034800     MOVE PV-PLANNED-RECEIPTS-N TO PO032-PLAN-RCPTS.              03640008
035100     WRITE DETAILED-REC FROM PO032-MERCH-PLAN-REC.                03650002
035200******************************************************************03660000
035300*     SQL WARNING OR ERROR PROCESSING                            *03670000
035400******************************************************************03680000
035500                                                                  03690000
035600 9999-SQL-ERROR.                                                  03700000
035700*--------                                                         03710000
035800                                                                  03720000
035900     MOVE SQLCODE    TO SQLCODE2.                                 03730000
036000     MOVE SQLERRD(3) TO SQLERRD3.                                 03740000
036100     DISPLAY '** ABEND **       ** = SQLERROR'.                   03750000
036200     DISPLAY '** PROGRAM        ** = POKUT081'.                   03760010
036300     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  03770000
036400     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  03780000
036500     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   03790000
036600     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  03800000
036700     MOVE +4013 TO PV-ABEND-CODE.                                 03810000
036800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         03820000
036900*                                                                 03830000
037000******************************************************************03840000
