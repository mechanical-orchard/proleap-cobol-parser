000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP213.                                        00020000
000300 AUTHOR.         ROBIN BERNOSKI.                                  00030000
000400 DATE-WRITTEN.   04/01/2000.                                      00040000
000500 DATE-COMPILED.                                                   00050000
000600*************************************************************     00060000
000700*    COBOL 2                                                *     00070000
000800*                                                           *     00080000
000900*    IMPORT UNJOURNALIZED RECEIPT AGING REPORT              *     00090000
001000*                                                           *     00100000
001100*   PROGRAM OVERVIEW:                                       *     00110000
001200*                                                           *     00120000
001300*     THIS PROGRAM CREATES THE IMPORT UNJOURNALIZED RECEIPT *     00130000
001400*   AGING REPORT BY VENDOR FROM AN EXTRACT FILE PRODUCED    *     00140000
001500*   IN APKUT256.                                            *     00150000
001600*                                                           *     00160000
001700*   INPUT:                                                  *     00170000
001800*                                                           *     00180000
001900*  1) IMPORT-UNJRNL-FILE                      (APRD042)     *     00190000
002000*                                                           *     00200000
002100*   OUTPUT:                                                 *     00210000
002200*                                                           *     00220000
002300*  1) RPT01-FILE                              (DPWS200O)    *     00230000
002400*                                                           *     00240000
002500*************************************************************     00250000
002600*   CHANGES:                                                *     00260000
002700*                                                           *     00270000
002800* 02/05/2003                                                *     00280000
002900*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     00290000
003000*    UPDATED THE FILE NAMES IN THE PROGRAM COMMENT BLOCK.   *     00300000
003100*    INCREASED THE SIZE OF THE PRINT PO NBR TO Z(9).        *     00310000
003200*    ADDED PV-PO-NBR TO BE USED AS A BREAK FIELD.           *     00320000
003300* MADE BY:  MIKE BESKE                          WR#: 23500  *     00330000
003400*                                                           *     00340000
003500* 05/21/2004  CHANGED MADE: STORE CONSTRAINTS PROJECT       *     00350000
003600*             RECOMPILED THIS PROGRAM TO PICK UP THE APRD042*     00360000
003700*             COPYBOOK MODIFICATIONS.                       *     00370000
003800*             MADE BY: MIKE BESKE             WR/IR #:25805 *     00380000
003900*                                                           *     00390000
004000* 07/05/2011                                                *     00400000
004100*    CHANGE MADE: REFERENCE AP042-COLBY-IND INPUT FIELD     *     00410000
004200*    TO CONTROL THE CALCULATIONOF THE REPORT TOTALS.        *     00420000
004300* MADE BY:  TOM MARTIN                          WR#: 39735  *     00430000
003900*                                                           *     00431001
004000* 09/08/2021                                                *     00432001
004100*    CHANGE MADE: RECOMPILE FOR NEW VERSION OF APRD042      *     00433001
004300* MADE BY:  JEAN KURK                         CHG0260549    *     00435001
003900*                                                           *     00436002
004000* 09/27/2023                                                *     00437002
004100*    CHANGE MADE: RENAME AP042-COLBY-IND TO                 *     00438002
004100*    AP042-IMPRT-PYMT-TYP, ADD VALUE FOR INFOR NEXUS        *     00438102
004300* MADE BY:  JEAN KURK                         CHG0294227    *     00439002
004400*************************************************************     00440000
004500/                                                                 00450000
004600 ENVIRONMENT DIVISION.                                            00460000
004700 CONFIGURATION SECTION.                                           00470000
004800 INPUT-OUTPUT SECTION.                                            00480000
004900 FILE-CONTROL.                                                    00490000
005000                                                                  00500000
005100     SELECT IMPORT-UNJRNL-FILE   ASSIGN TO UT-S-INP01.            00510000
005200     SELECT RPT01-FILE           ASSIGN TO UT-S-RPT01.            00520000
005300                                                                  00530000
005400 DATA DIVISION.                                                   00540000
005500 FILE SECTION.                                                    00550000
005600 FD  IMPORT-UNJRNL-FILE                                           00560000
005700     RECORDING MODE IS F                                          00570000
005800     LABEL RECORDS ARE STANDARD                                   00580000
005900     BLOCK CONTAINS 0 RECORDS                                     00590000
006000     DATA RECORD IS IMPORT-UNJRNL-RECORD.                         00600000
006100 01  IMPORT-UNJRNL-RECORD        PIC  X(120).                     00610000
006200                                                                  00620000
006300 FD  RPT01-FILE                                                   00630000
006400     RECORDING MODE IS F                                          00640000
006500     LABEL RECORDS ARE STANDARD                                   00650000
006600     BLOCK CONTAINS 0 RECORDS                                     00660000
006700     DATA RECORD IS RPT01-RECORD.                                 00670000
006800 01  RPT01-RECORD                PIC  X(200).                     00680000
006900                                                                  00690000
007000 EJECT                                                            00700000
007100 WORKING-STORAGE SECTION.                                         00710000
007200                                                                  00720000
007300 01  PROGRAM-CONSTANTS.                                           00730000
007400     05  PC-MAX-LINES            PIC S9(05)   COMP-3  VALUE +60.  00740000
007500                                                                  00750000
007600 01  PROGRAM-WORKAREA.                                            00760000
007700     05  FILLER                  PIC  X(30)           VALUE       00770000
007800         '** BEGINING OF APKRP213 W/S **'.                        00780000
007900                                                                  00790000
008000     05  PV-CURRENT-PARAGRAPH    PIC  X(30)           VALUE SPACE.00800000
008100     05  PV-PROGRAM-NAME         PIC  X(08)           VALUE       00810000
008200         'APKRP213'.                                              00820000
008300     05  DB2-RETRY-MAX           PIC S9(04)    COMP   VALUE +3.   00830000
008400                                                                  00840000
008500     05  PV-PO-NBR               PIC  9(09)    VALUE ZERO.        00850000
008600                                                                  00860000
008700     05  PV-YYYY-MM-DD.                                           00870000
008800         10  PV-CHECK-DATE       PIC X(10) VALUE SPACES.          00880000
008900                                                                  00890000
009000     05  PV-CURRENT-DATE.                                         00900000
009100         10  PV-CURRENT-YEAR     PIC  9(02)           VALUE 0.    00910000
009200         10  PV-CURRENT-MONTH    PIC  9(02)           VALUE 0.    00920000
009300         10  PV-CURRENT-DAY      PIC  9(02)           VALUE 0.    00930000
009400                                                                  00940000
009500     05  PV-CURRENT-JULIAN.                                       00950000
009600         10 PV-CURRENT-JUL-YY    PIC  9(02) VALUE 0.              00960000
009700         10 PV-CURRENT-JUL-DDD   PIC  9(03) VALUE 0.              00970000
009800     05  PV-CURRENT-JULIAN-CCYYDDD.                               00980000
009900         10 PV-CURRENT-JUL-CC    PIC  9(02) VALUE 0.              00990000
010000         10 PV-CURRENT-JUL-YYDDD PIC  9(05) VALUE 0.              01000000
010100                                                                  01010000
010200     05  PV-CURR-DATE-MINUS-30   PIC 9(07)            VALUE 0.    01020000
010300     05  PV-CURR-DT-MINUS-30-CH REDEFINES                         01030000
010400               PV-CURR-DATE-MINUS-30   PIC X(07).                 01040000
010500     05  PV-CURR-DATE-MINUS-60   PIC 9(07)            VALUE 0.    01050000
010600     05  PV-CURR-DT-MINUS-60-CH REDEFINES                         01060000
010700               PV-CURR-DATE-MINUS-60   PIC X(07).                 01070000
010800     05  PV-CURR-DATE-MINUS-90   PIC 9(07)            VALUE 0.    01080000
010900     05  PV-CURR-DT-MINUS-90-CH REDEFINES                         01090000
011000               PV-CURR-DATE-MINUS-90   PIC X(07).                 01100000
011100     05  PV-CURR-DATE-MINUS-120  PIC 9(07)            VALUE 0.    01110000
011200     05  PV-CURR-DT-MINUS-120-CH REDEFINES                        01120000
011300               PV-CURR-DATE-MINUS-120  PIC X(07).                 01130000
011400     05  PV-CURR-DATE-MINUS-360  PIC 9(07)            VALUE 0.    01140000
011500     05  PV-CURR-DT-MINUS-360-CH REDEFINES                        01150000
011600               PV-CURR-DATE-MINUS-360  PIC X(07).                 01160000
011700                                                                  01170000
011800     05  WS-COMPARE-CCYYDDD            PIC 9(07)      VALUE 0.    01180000
011900                                                                  01190000
012000     05  PV-CURRENT-TIME.                                         01200000
012100         10  PV-CURRENT-HOUR     PIC  9(02)           VALUE 0.    01210000
012200         10  PV-CURRENT-MINUTE   PIC  9(02)           VALUE 0.    01220000
012300         10  FILLER              PIC  9(02)           VALUE 0.    01230000
012400                                                                  01240000
012500     05  PV-COLBY-FIELDS.                                         01250000
012600         10  PV-RETAIL-COLBY-0   PIC  S9(09)V99 VALUE ZEROES.     01260000
012700         10  PV-COST-COLBY-0     PIC  S9(09)V99 VALUE ZEROES.     01270000
012800         10  PV-RETAIL-COLBY-31  PIC  S9(09)V99 VALUE ZEROES.     01280000
012900         10  PV-COST-COLBY-31    PIC  S9(09)V99 VALUE ZEROES.     01290000
013000         10  PV-RETAIL-COLBY-61  PIC  S9(09)V99 VALUE ZEROES.     01300000
013100         10  PV-COST-COLBY-61    PIC  S9(09)V99 VALUE ZEROES.     01310000
013200         10  PV-RETAIL-COLBY-91  PIC  S9(09)V99 VALUE ZEROES.     01320000
013300         10  PV-COST-COLBY-91    PIC  S9(09)V99 VALUE ZEROES.     01330000
013400         10  PV-RETAIL-COLBY-121 PIC  S9(09)V99 VALUE ZEROES.     01340000
013500         10  PV-COST-COLBY-121   PIC  S9(09)V99 VALUE ZEROES.     01350000
013600                                                                  01360000
013700     05  PV-COLBY-TOTAL-FIELDS.                                   01370000
013800         10  CC-CROSS-RETAIL-TOTAL PIC  S9(09)V99 VALUE ZEROES.   01380000
013900         10  CC-CROSS-COST-TOTAL   PIC  S9(09)V99 VALUE ZEROES.   01390000
014000                                                                  01400000
014100 01  ACCUM-FIELDS.                                                01410000
014200     05  DTL-FIELDS.                                              01420000
014300         10  DTL-COST-0          PIC S9(08)V99 COMP-3 VALUE +0.   01430000
014400         10  DTL-COST-31         PIC S9(08)V99 COMP-3 VALUE +0.   01440000
014500         10  DTL-COST-61         PIC S9(08)V99 COMP-3 VALUE +0.   01450000
014600         10  DTL-COST-91         PIC S9(08)V99 COMP-3 VALUE +0.   01460000
014700         10  DTL-COST-121        PIC S9(08)V99 COMP-3 VALUE +0.   01470000
014800         10  DTL-RETAIL-0        PIC S9(08)V99 COMP-3 VALUE +0.   01480000
014900         10  DTL-RETAIL-31       PIC S9(08)V99 COMP-3 VALUE +0.   01490000
015000         10  DTL-RETAIL-61       PIC S9(08)V99 COMP-3 VALUE +0.   01500000
015100         10  DTL-RETAIL-91       PIC S9(08)V99 COMP-3 VALUE +0.   01510000
015200         10  DTL-RETAIL-121      PIC S9(08)V99 COMP-3 VALUE +0.   01520000
015300     05  TOT-FIELDS.                                              01530000
015400         10  TOT-COST-0          PIC S9(09)V99 COMP-3 VALUE +0.   01540000
015500         10  TOT-COST-31         PIC S9(09)V99 COMP-3 VALUE +0.   01550000
015600         10  TOT-COST-61         PIC S9(09)V99 COMP-3 VALUE +0.   01560000
015700         10  TOT-COST-91         PIC S9(09)V99 COMP-3 VALUE +0.   01570000
015800         10  TOT-COST-121        PIC S9(09)V99 COMP-3 VALUE +0.   01580000
015900         10  TOT-RETAIL-0        PIC S9(09)V99 COMP-3 VALUE +0.   01590000
016000         10  TOT-RETAIL-31       PIC S9(09)V99 COMP-3 VALUE +0.   01600000
016100         10  TOT-RETAIL-61       PIC S9(09)V99 COMP-3 VALUE +0.   01610000
016200         10  TOT-RETAIL-91       PIC S9(09)V99 COMP-3 VALUE +0.   01620000
016300         10  TOT-RETAIL-121      PIC S9(09)V99 COMP-3 VALUE +0.   01630000
016400     05  GR-TOT-FIELDS.                                           01640000
016500         10  GR-TOT-COST-0       PIC S9(09)V99 COMP-3 VALUE +0.   01650000
016600         10  GR-TOT-COST-31      PIC S9(09)V99 COMP-3 VALUE +0.   01660000
016700         10  GR-TOT-COST-61      PIC S9(09)V99 COMP-3 VALUE +0.   01670000
016800         10  GR-TOT-COST-91      PIC S9(09)V99 COMP-3 VALUE +0.   01680000
016900         10  GR-TOT-COST-121     PIC S9(09)V99 COMP-3 VALUE +0.   01690000
017000         10  GR-TOT-RETAIL-0     PIC S9(09)V99 COMP-3 VALUE +0.   01700000
017100         10  GR-TOT-RETAIL-31    PIC S9(09)V99 COMP-3 VALUE +0.   01710000
017200         10  GR-TOT-RETAIL-61    PIC S9(09)V99 COMP-3 VALUE +0.   01720000
017300         10  GR-TOT-RETAIL-91    PIC S9(09)V99 COMP-3 VALUE +0.   01730000
017400         10  GR-TOT-RETAIL-121   PIC S9(09)V99 COMP-3 VALUE +0.   01740000
017500     05  LLC-TOT-FIELDS.                                          01750000
017600         10  LLC-RETAIL-TOT-0    PIC S9(09)V99 COMP-3 VALUE +0.   01760000
017700         10  LLC-COST-TOT-0      PIC S9(09)V99 COMP-3 VALUE +0.   01770000
017800         10  LLC-RETAIL-TOT-31   PIC S9(09)V99 COMP-3 VALUE +0.   01780000
017900         10  LLC-COST-TOT-31     PIC S9(09)V99 COMP-3 VALUE +0.   01790000
018000         10  LLC-RETAIL-TOT-61   PIC S9(09)V99 COMP-3 VALUE +0.   01800000
018100         10  LLC-COST-TOT-61     PIC S9(09)V99 COMP-3 VALUE +0.   01810000
018200         10  LLC-RETAIL-TOT-91   PIC S9(09)V99 COMP-3 VALUE +0.   01820000
018300         10  LLC-COST-TOT-91     PIC S9(09)V99 COMP-3 VALUE +0.   01830000
018400         10  LLC-RETAIL-TOT-121  PIC S9(09)V99 COMP-3 VALUE +0.   01840000
018500         10  LLC-COST-TOT-121    PIC S9(09)V99 COMP-3 VALUE +0.   01850000
018600         10  LLC-RETAIL-GRND-TOT PIC S9(09)V99 COMP-3 VALUE +0.   01860000
018700         10  LLC-COST-GRND-TOT   PIC S9(09)V99 COMP-3 VALUE +0.   01870000
018800*    05  LLC-TOT-FIELDS.                                          01880003
018800     05  OPN-TOT-FIELDS.                                          01881003
018900         10  OPN-RETAIL-TOT-0    PIC S9(09)V99 COMP-3 VALUE +0.   01890000
019000         10  OPN-COST-TOT-0      PIC S9(09)V99 COMP-3 VALUE +0.   01900000
019100         10  OPN-RETAIL-TOT-31   PIC S9(09)V99 COMP-3 VALUE +0.   01910000
019200         10  OPN-COST-TOT-31     PIC S9(09)V99 COMP-3 VALUE +0.   01920000
019300         10  OPN-RETAIL-TOT-61   PIC S9(09)V99 COMP-3 VALUE +0.   01930000
019400         10  OPN-COST-TOT-61     PIC S9(09)V99 COMP-3 VALUE +0.   01940000
019500         10  OPN-RETAIL-TOT-91   PIC S9(09)V99 COMP-3 VALUE +0.   01950000
019600         10  OPN-COST-TOT-91     PIC S9(09)V99 COMP-3 VALUE +0.   01960000
019700         10  OPN-RETAIL-TOT-121  PIC S9(09)V99 COMP-3 VALUE +0.   01970000
019800         10  OPN-COST-TOT-121    PIC S9(09)V99 COMP-3 VALUE +0.   01980000
019900         10  OPN-RETAIL-GRND-TOT PIC S9(09)V99 COMP-3 VALUE +0.   01990000
020000         10  OPN-COST-GRND-TOT   PIC S9(09)V99 COMP-3 VALUE +0.   02000000
018800     05  NXS-TOT-FIELDS.                                          02001003
018900         10  NXS-RETAIL-TOT-0    PIC S9(09)V99 COMP-3 VALUE +0.   02002003
019000         10  NXS-COST-TOT-0      PIC S9(09)V99 COMP-3 VALUE +0.   02003003
019100         10  NXS-RETAIL-TOT-31   PIC S9(09)V99 COMP-3 VALUE +0.   02004003
019200         10  NXS-COST-TOT-31     PIC S9(09)V99 COMP-3 VALUE +0.   02005003
019300         10  NXS-RETAIL-TOT-61   PIC S9(09)V99 COMP-3 VALUE +0.   02006003
019400         10  NXS-COST-TOT-61     PIC S9(09)V99 COMP-3 VALUE +0.   02007003
019500         10  NXS-RETAIL-TOT-91   PIC S9(09)V99 COMP-3 VALUE +0.   02008003
019600         10  NXS-COST-TOT-91     PIC S9(09)V99 COMP-3 VALUE +0.   02009003
019700         10  NXS-RETAIL-TOT-121  PIC S9(09)V99 COMP-3 VALUE +0.   02009103
019800         10  NXS-COST-TOT-121    PIC S9(09)V99 COMP-3 VALUE +0.   02009203
019900         10  NXS-RETAIL-GRND-TOT PIC S9(09)V99 COMP-3 VALUE +0.   02009303
020000         10  NXS-COST-GRND-TOT   PIC S9(09)V99 COMP-3 VALUE +0.   02009403
020100                                                                  02010000
020200 01  PRINT-FIELDS.                                                02020000
020300     05  PV-LINE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   02030000
020400     05  PV-PAGE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   02040000
020500                                                                  02050000
020600 01  PROGRAM-SWITCHES-SUBS.                                       02060000
020700     05  PV-EOF-SW               PIC  X(01)           VALUE 'N'.  02070000
020800         88  EOF                 VALUE 'Y'.                       02080000
020900     05  PV-DATE-SW              PIC  X(01)           VALUE 'N'.  02090000
021000         88  VALID-DATE          VALUE 'Y'.                       02100000
021100         88  NOT-VALID-DATE      VALUE 'N'.                       02110000
021200                                                                  02120000
021300 EJECT                                                            02130000
021400*  INPUT RECORD AREA                                              02140000
021500                                                                  02150000
021600     COPY APRD042.                                                02160000
021700                                                                  02170000
021800 EJECT                                                            02180000
021900*  PRINT AREA                                                     02190000
022000                                                                  02200000
022100     COPY DPWS200O.                                               02210000
022200                                                                  02220000
022300 01  HDR-LINE2.                                                   02230000
022400     05  FILLER                  PIC  X(79)   VALUE SPACES.       02240000
022500     05  HL2-TITLE               PIC  X(42)   VALUE               02250000
022600         'IMPORT UNJOURNALIZED RECEIPTS AGING REPORT'.            02260000
022700     05  FILLER                  PIC  X(79)   VALUE SPACES.       02270000
022800                                                                  02280000
022900 01  HDR-LINE3.                                                   02290000
023000     05  FILLER                  PIC  X(13)    VALUE              02300000
023100         'VENDOR NAME: '.                                         02310000
023200     05  HDR3-VENDOR-NAME        PIC  X(30)    VALUE SPACE.       02320000
023300     05  FILLER                  PIC  X(02)    VALUE SPACE.       02330000
023400     05  FILLER                  PIC  X(15)    VALUE              02340000
023500         'VENDOR NUMBER: '.                                       02350000
023600     05  HDR3-VENDOR-NBR         PIC  X(09)    VALUE SPACE.       02360000
023700     05  FILLER                  PIC  X(131)   VALUE SPACE.       02370000
023800                                                                  02380000
023900 01  HDR-LINE4.                                                   02390000
024000     05  FILLER                  PIC  X(08)    VALUE              02400000
024100         '  PO NBR'.                                              02410000
024200     05  FILLER                  PIC  X(30)    VALUE              02420000
024300         '              0 - 30 DAYS     '.                        02430000
024400     05  FILLER                  PIC  X(30)    VALUE              02440000
024500         '               31 - 60 DAYS   '.                        02450000
024600     05  FILLER                  PIC  X(31)    VALUE              02460000
024700         '                 61 - 90 DAYS '.                        02470000
024800     05  FILLER                  PIC  X(31)    VALUE              02480000
024900         '                 91 - 120 DAYS '.                       02490000
025000     05  FILLER                  PIC  X(31)    VALUE              02500000
025100         '                  OVER 120 DAYS'.                       02510000
025200     05  FILLER                  PIC  X(30)    VALUE              02520000
025300         '                    TOTAL COST'.                        02530000
025400                                                                  02540000
025500 01  HDR-LINE5.                                                   02550000
025600     05  FILLER                  PIC  X(10)    VALUE SPACE.       02560000
025700     05  FILLER                  PIC  X(31)    VALUE              02570000
025800         '        COST        RETAIL     '.                       02580000
025900     05  FILLER                  PIC  X(31)    VALUE              02590000
026000         '         COST        RETAIL    '.                       02600000
026100     05  FILLER                  PIC  X(31)    VALUE              02610000
026200         '          COST        RETAIL   '.                       02620000
026300     05  FILLER                  PIC  X(31)    VALUE              02630000
026400         '           COST       RETAIL   '.                       02640000
026500     05  FILLER                  PIC  X(31)    VALUE              02650000
026600         '            COST        RETAIL '.                       02660000
026700     05  FILLER                  PIC  X(31)    VALUE              02670000
026800         '            COST        RETAIL '.                       02680000
026900                                                                  02690000
027000 01  DETAIL-LINE.                                                 02700000
027100     05  DL-PO-NBR               PIC  Z(09)    VALUE ZERO.        02710000
027200     05  FILLER                  PIC  X(02)    VALUE SPACES.      02720000
027300     05  DL-COST-0               PIC  ZZ,ZZZ,ZZZ.99-              02730000
027400                                               BLANK WHEN ZERO.   02740000
027500     05  FILLER                  PIC  X(01)    VALUE SPACES.      02750000
027600     05  DL-RETAIL-0             PIC  ZZ,ZZZ,ZZZ.99-              02760000
027700                                               BLANK WHEN ZERO.   02770000
027800     05  FILLER                  PIC  X(03)    VALUE '  |'.       02780000
027900     05  DL-COST-31              PIC  ZZ,ZZZ,ZZZ.99-              02790000
028000                                               BLANK WHEN ZERO.   02800000
028100     05  FILLER                  PIC  X(01)    VALUE SPACES.      02810000
028200     05  DL-RETAIL-31            PIC  ZZ,ZZZ,ZZZ.99-              02820000
028300                                               BLANK WHEN ZERO.   02830000
028400     05  FILLER                  PIC  X(03)    VALUE '  |'.       02840000
028500     05  DL-COST-61              PIC  ZZ,ZZZ,ZZZ.99-              02850000
028600                                               BLANK WHEN ZERO.   02860000
028700     05  FILLER                  PIC  X(01)    VALUE SPACES.      02870000
028800     05  DL-RETAIL-61            PIC  ZZ,ZZZ,ZZZ.99-              02880000
028900                                               BLANK WHEN ZERO.   02890000
029000     05  FILLER                  PIC  X(03)    VALUE '  |'.       02900000
029100     05  DL-COST-91              PIC  ZZ,ZZZ,ZZZ.99-              02910000
029200                                               BLANK WHEN ZERO.   02920000
029300     05  FILLER                  PIC  X(01)    VALUE SPACES.      02930000
029400     05  DL-RETAIL-91            PIC  ZZ,ZZZ,ZZZ.99-              02940000
029500                                               BLANK WHEN ZERO.   02950000
029600     05  FILLER                  PIC  X(03)    VALUE '  |'.       02960000
029700     05  DL-COST-121             PIC  ZZ,ZZZ,ZZZ.99-              02970000
029800                                               BLANK WHEN ZERO.   02980000
029900     05  FILLER                  PIC  X(01)    VALUE SPACES.      02990000
030000     05  DL-RETAIL-121           PIC  ZZ,ZZZ,ZZZ.99-              03000000
030100                                               BLANK WHEN ZERO.   03010000
030200     05  FILLER                  PIC  X(03)    VALUE '  |'.       03020000
030300                                                                  03030000
030400 01  LLC-TOTAL-LINE.                                              03040000
030500     05  FILLER                  PIC  X(10)    VALUE              03050000
030600         'LLC TOTAL:'.                                            03060000
030700     05  FILLER                  PIC  X(01)    VALUE SPACES.      03070000
030800     05  LLC-COST-0              PIC  ZZ,ZZZ,ZZZ.99-              03080000
030900                                               BLANK WHEN ZERO.   03090000
031000     05  FILLER                  PIC  X(01)    VALUE SPACES.      03100000
031100     05  LLC-RETAIL-0            PIC  ZZ,ZZZ,ZZZ.99-              03110000
031200                                               BLANK WHEN ZERO.   03120000
031300     05  FILLER                  PIC  X(03)    VALUE '  |'.       03130000
031400     05  LLC-COST-31             PIC  ZZ,ZZZ,ZZZ.99-              03140000
031500                                               BLANK WHEN ZERO.   03150000
031600     05  FILLER                  PIC  X(01)    VALUE SPACES.      03160000
031700     05  LLC-RETAIL-31           PIC  ZZ,ZZZ,ZZZ.99-              03170000
031800                                               BLANK WHEN ZERO.   03180000
031900     05  FILLER                  PIC  X(03)    VALUE '  |'.       03190000
032000     05  LLC-COST-61             PIC  ZZ,ZZZ,ZZZ.99-              03200000
032100                                               BLANK WHEN ZERO.   03210000
032200     05  FILLER                  PIC  X(01)    VALUE SPACES.      03220000
032300     05  LLC-RETAIL-61           PIC  ZZ,ZZZ,ZZZ.99-              03230000
032400                                               BLANK WHEN ZERO.   03240000
032500     05  FILLER                  PIC  X(03)    VALUE '  |'.       03250000
032600     05  LLC-COST-91             PIC  ZZ,ZZZ,ZZZ.99-              03260000
032700                                               BLANK WHEN ZERO.   03270000
032800     05  FILLER                  PIC  X(01)    VALUE SPACES.      03280000
032900     05  LLC-RETAIL-91           PIC  ZZ,ZZZ,ZZZ.99-              03290000
033000                                               BLANK WHEN ZERO.   03300000
033100     05  FILLER                  PIC  X(03)    VALUE '  |'.       03310000
033200     05  LLC-COST-121            PIC  ZZ,ZZZ,ZZZ.99-              03320000
033300                                               BLANK WHEN ZERO.   03330000
033400     05  FILLER                  PIC  X(01)    VALUE SPACES.      03340000
033500     05  LLC-RETAIL-121          PIC  ZZ,ZZZ,ZZZ.99-              03350000
033600                                               BLANK WHEN ZERO.   03360000
033700     05  FILLER                  PIC  X(03)    VALUE '  |'.       03370000
033800     05  LLC-COST-TOTAL          PIC  ZZ,ZZZ,ZZZ.99-              03380000
033900                                               BLANK WHEN ZERO.   03390000
034000     05  FILLER                  PIC  X(01)    VALUE SPACES.      03400000
034100     05  LLC-RETAIL-TOTAL        PIC  ZZ,ZZZ,ZZZ.99-              03410000
034200                                               BLANK WHEN ZERO.   03420000
034300                                                                  03430000
034400 01  OPN-TOTAL-LINE.                                              03440000
034500     05  FILLER                  PIC  X(10)    VALUE              03450000
034600         'OPN TOTAL:'.                                            03460000
034700     05  FILLER                  PIC  X(01)    VALUE SPACES.      03470000
034800     05  OPN-COST-0              PIC  ZZ,ZZZ,ZZZ.99-              03480000
034900                                               BLANK WHEN ZERO.   03490000
035000     05  FILLER                  PIC  X(01)    VALUE SPACES.      03500000
035100     05  OPN-RETAIL-0            PIC  ZZ,ZZZ,ZZZ.99-              03510000
035200                                               BLANK WHEN ZERO.   03520000
035300     05  FILLER                  PIC  X(03)    VALUE '  |'.       03530000
035400     05  OPN-COST-31             PIC  ZZ,ZZZ,ZZZ.99-              03540000
035500                                               BLANK WHEN ZERO.   03550000
035600     05  FILLER                  PIC  X(01)    VALUE SPACES.      03560000
035700     05  OPN-RETAIL-31           PIC  ZZ,ZZZ,ZZZ.99-              03570000
035800                                               BLANK WHEN ZERO.   03580000
035900     05  FILLER                  PIC  X(03)    VALUE '  |'.       03590000
036000     05  OPN-COST-61             PIC  ZZ,ZZZ,ZZZ.99-              03600000
036100                                               BLANK WHEN ZERO.   03610000
036200     05  FILLER                  PIC  X(01)    VALUE SPACES.      03620000
036300     05  OPN-RETAIL-61           PIC  ZZ,ZZZ,ZZZ.99-              03630000
036400                                               BLANK WHEN ZERO.   03640000
036500     05  FILLER                  PIC  X(03)    VALUE '  |'.       03650000
036600     05  OPN-COST-91             PIC  ZZ,ZZZ,ZZZ.99-              03660000
036700                                               BLANK WHEN ZERO.   03670000
036800     05  FILLER                  PIC  X(01)    VALUE SPACES.      03680000
036900     05  OPN-RETAIL-91           PIC  ZZ,ZZZ,ZZZ.99-              03690000
037000                                               BLANK WHEN ZERO.   03700000
037100     05  FILLER                  PIC  X(03)    VALUE '  |'.       03710000
037200     05  OPN-COST-121            PIC  ZZ,ZZZ,ZZZ.99-              03720000
037300                                               BLANK WHEN ZERO.   03730000
037400     05  FILLER                  PIC  X(01)    VALUE SPACES.      03740000
037500     05  OPN-RETAIL-121          PIC  ZZ,ZZZ,ZZZ.99-              03750000
037600                                               BLANK WHEN ZERO.   03760000
037700     05  FILLER                  PIC  X(03)    VALUE '  |'.       03770000
037800     05  OPN-COST-TOTAL          PIC  ZZ,ZZZ,ZZZ.99-              03780000
037900                                               BLANK WHEN ZERO.   03790000
038000     05  FILLER                  PIC  X(01)    VALUE SPACES.      03800000
038100     05  OPN-RETAIL-TOTAL        PIC  ZZ,ZZZ,ZZZ.99-              03810000
038200                                               BLANK WHEN ZERO.   03820000
038300                                                                  03830000
034400 01  NXS-TOTAL-LINE.                                              03831004
034500     05  FILLER                  PIC  X(10)    VALUE              03832004
034600         'NXS TOTAL:'.                                            03833004
034700     05  FILLER                  PIC  X(01)    VALUE SPACES.      03834004
034800     05  NXS-COST-0              PIC  ZZ,ZZZ,ZZZ.99-              03835004
034900                                               BLANK WHEN ZERO.   03836004
035000     05  FILLER                  PIC  X(01)    VALUE SPACES.      03837004
035100     05  NXS-RETAIL-0            PIC  ZZ,ZZZ,ZZZ.99-              03838004
035200                                               BLANK WHEN ZERO.   03839004
035300     05  FILLER                  PIC  X(03)    VALUE '  |'.       03839104
035400     05  NXS-COST-31             PIC  ZZ,ZZZ,ZZZ.99-              03839204
035500                                               BLANK WHEN ZERO.   03839304
035600     05  FILLER                  PIC  X(01)    VALUE SPACES.      03839404
035700     05  NXS-RETAIL-31           PIC  ZZ,ZZZ,ZZZ.99-              03839504
035800                                               BLANK WHEN ZERO.   03839604
035900     05  FILLER                  PIC  X(03)    VALUE '  |'.       03839704
036000     05  NXS-COST-61             PIC  ZZ,ZZZ,ZZZ.99-              03839804
036100                                               BLANK WHEN ZERO.   03839904
036200     05  FILLER                  PIC  X(01)    VALUE SPACES.      03840004
036300     05  NXS-RETAIL-61           PIC  ZZ,ZZZ,ZZZ.99-              03840104
036400                                               BLANK WHEN ZERO.   03840204
036500     05  FILLER                  PIC  X(03)    VALUE '  |'.       03840304
036600     05  NXS-COST-91             PIC  ZZ,ZZZ,ZZZ.99-              03840404
036700                                               BLANK WHEN ZERO.   03840504
036800     05  FILLER                  PIC  X(01)    VALUE SPACES.      03840604
036900     05  NXS-RETAIL-91           PIC  ZZ,ZZZ,ZZZ.99-              03840705
037000                                               BLANK WHEN ZERO.   03840804
037100     05  FILLER                  PIC  X(03)    VALUE '  |'.       03840904
037200     05  NXS-COST-121            PIC  ZZ,ZZZ,ZZZ.99-              03841004
037300                                               BLANK WHEN ZERO.   03841104
037400     05  FILLER                  PIC  X(01)    VALUE SPACES.      03841204
037500     05  NXS-RETAIL-121          PIC  ZZ,ZZZ,ZZZ.99-              03841304
037600                                               BLANK WHEN ZERO.   03841404
037700     05  FILLER                  PIC  X(03)    VALUE '  |'.       03841504
037800     05  NXS-COST-TOTAL          PIC  ZZ,ZZZ,ZZZ.99-              03841604
037900                                               BLANK WHEN ZERO.   03841704
038000     05  FILLER                  PIC  X(01)    VALUE SPACES.      03841804
038100     05  NXS-RETAIL-TOTAL        PIC  ZZ,ZZZ,ZZZ.99-              03841904
038200                                               BLANK WHEN ZERO.   03842004
038300                                                                  03842104
038400 01  TOTAL-LINE.                                                  03843000
038500     05  FILLER                  PIC  X(03)    VALUE SPACES.      03850000
038600     05  FILLER                  PIC  X(06)    VALUE              03860000
038700         'TOTAL:'.                                                03870000
038800     05  FILLER                  PIC  X(01)    VALUE SPACES.      03880000
038900     05  TL-COST-0               PIC  ZZ,ZZZ,ZZZ.99-              03890000
039000                                               BLANK WHEN ZERO.   03900000
039100     05  FILLER                  PIC  X(01)    VALUE SPACES.      03910000
039200     05  TL-RETAIL-0             PIC  ZZ,ZZZ,ZZZ.99-              03920000
039300                                               BLANK WHEN ZERO.   03930000
039400     05  FILLER                  PIC  X(04)    VALUE '   |'.      03940000
039500     05  TL-COST-31              PIC  ZZ,ZZZ,ZZZ.99-              03950000
039600                                               BLANK WHEN ZERO.   03960000
039700     05  FILLER                  PIC  X(01)    VALUE SPACES.      03970000
039800     05  TL-RETAIL-31            PIC  ZZ,ZZZ,ZZZ.99-              03980000
039900                                               BLANK WHEN ZERO.   03990000
040000     05  FILLER                  PIC  X(03)    VALUE '  |'.       04000000
040100     05  TL-COST-61              PIC  ZZ,ZZZ,ZZZ.99-              04010000
040200                                               BLANK WHEN ZERO.   04020000
040300     05  FILLER                  PIC  X(01)    VALUE SPACES.      04030000
040400     05  TL-RETAIL-61            PIC  ZZ,ZZZ,ZZZ.99-              04040000
040500                                               BLANK WHEN ZERO.   04050000
040600     05  FILLER                  PIC  X(03)    VALUE '  |'.       04060000
040700     05  TL-COST-91              PIC  ZZ,ZZZ,ZZZ.99-              04070000
040800                                               BLANK WHEN ZERO.   04080000
040900     05  FILLER                  PIC  X(01)    VALUE SPACES.      04090000
041000     05  TL-RETAIL-91            PIC  ZZ,ZZZ,ZZZ.99-              04100000
041100                                               BLANK WHEN ZERO.   04110000
041200     05  FILLER                  PIC  X(03)    VALUE '  |'.       04120000
041300     05  TL-COST-121             PIC  ZZ,ZZZ,ZZZ.99-              04130000
041400                                               BLANK WHEN ZERO.   04140000
041500     05  FILLER                  PIC  X(01)    VALUE SPACES.      04150000
041600     05  TL-RETAIL-121           PIC  ZZ,ZZZ,ZZZ.99-              04160000
041700                                               BLANK WHEN ZERO.   04170000
041800     05  FILLER                  PIC  X(03)    VALUE '  |'.       04180000
041900     05  TL-TOTAL-COST           PIC  ZZ,ZZZ,ZZZ.99-              04190000
042000                                               BLANK WHEN ZERO.   04200000
042100     05  FILLER                  PIC  X(01)    VALUE SPACES.      04210000
042200     05  TL-TOTAL-RETAIL         PIC  ZZ,ZZZ,ZZZ.99-              04220000
042300                                               BLANK WHEN ZERO.   04230000
042400                                                                  04240000
042500 01  DASH-LINE.                                                   04250000
042600     05  FILLER                  PIC  X(200)   VALUE ALL '-'.     04260000
042700                                                                  04270000
042800 01  BLANK-LINE.                                                  04280000
042900     05  FILLER                  PIC  X(42)    VALUE SPACES.      04290000
043000     05  FILLER                  PIC  X(01)    VALUE '|'.         04300000
043100     05  FILLER                  PIC  X(31)    VALUE SPACES.      04310000
043200     05  FILLER                  PIC  X(01)    VALUE '|'.         04320000
043300     05  FILLER                  PIC  X(31)    VALUE SPACES.      04330000
043400     05  FILLER                  PIC  X(01)    VALUE '|'.         04340000
043500     05  FILLER                  PIC  X(31)    VALUE SPACES.      04350000
043600     05  FILLER                  PIC  X(01)    VALUE '|'.         04360000
043700     05  FILLER                  PIC  X(31)    VALUE SPACES.      04370000
043800     05  FILLER                  PIC  X(01)    VALUE '|'.         04380000
043900                                                                  04390000
044000 01  EOR-END-OF-REPORT.                                           04400000
044100     05  FILLER                  PIC  X(80)    VALUE SPACES.      04410000
044200     05  FILLER                  PIC  X(120)   VALUE              04420000
044300         '*****  END OF REPORT *****'.                            04430000
044400                                                                  04440000
044500*** GREGORIAN/JULIAN DATE CONVERSION                              04450000
044600     COPY DPWS500.                                                04460000
044700                                                                  04470000
044800 EJECT                                                            04480000
044900*----------------------------------------------------------------*04490000
045000*  ABEND DATA AREAS                                              *04500000
045100*----------------------------------------------------------------*04510000
045200 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          04520000
045300                                             COMP SYNC.           04530000
045400     88  AC-BAD-DATA                         VALUE +4003.         04540000
045500     88  AC-DATE-ERROR                       VALUE +4019.         04550000
045600                                                                  04560000
045700                                                                  04570000
045800 01  ABEND-AREAS.                                                 04580000
045900     05  AA-ABEND-LIT            PIC  X(40)  VALUE                04590000
046000             '*****       ABEND'.                                 04600000
046100     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                04610000
046200             '*****   PROGRAM: APKRP213'.                         04620000
046300     05  AA-PARAGRAPH-LIT.                                        04630000
046400         10  FILLER              PIC  X(17)  VALUE                04640000
046500             '***** PARAGRAPH: '.                                 04650000
046600         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        04660000
046700     05  AA-MESSAGE-LINE.                                         04670000
046800         10  FILLER              PIC  X(06)  VALUE '*****'.       04680000
046900         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        04690000
047000                                                                  04700000
047100 01  FILLER                      PIC  X(25)  VALUE                04710000
047200     '** END OF APKRP213 W/S **'.                                 04720000
047300                                                                  04730000
047400 EJECT                                                            04740000
047500 PROCEDURE DIVISION.                                              04750000
047600                                                                  04760000
047700***************************************************************** 04770000
047800*  MAIN PARAGRAPH                                                 04780000
047900***************************************************************** 04790000
048000 0000-MAIN.                                                       04800000
048100                                                                  04810000
048200     MOVE '0000-MAIN'            TO   PV-CURRENT-PARAGRAPH.       04820000
048300                                                                  04830000
048400     PERFORM 1000-BEGIN-PROGRAM.                                  04840000
048500                                                                  04850000
048600     PERFORM 2000-PROCESS-DATA UNTIL EOF.                         04860000
048700                                                                  04870000
048800     PERFORM 9200-END-PROGRAM.                                    04880000
048900                                                                  04890000
049000     GOBACK.                                                      04900000
049100                                                                  04910000
049200 EJECT                                                            04920000
049300***************************************************************** 04930000
049400*  BEGIN PROGRAM STUFF                                            04940000
049500***************************************************************** 04950000
049600 1000-BEGIN-PROGRAM.                                              04960000
049700                                                                  04970000
049800     MOVE '1000-BEGIN-PROGRAM'   TO   PV-CURRENT-PARAGRAPH.       04980000
049900                                                                  04990000
050000     OPEN INPUT  IMPORT-UNJRNL-FILE                               05000000
050100          OUTPUT RPT01-FILE.                                      05010000
050200                                                                  05020000
050300     ACCEPT PV-CURRENT-JULIAN    FROM DAY.                        05030000
050400     MOVE PV-CURRENT-JULIAN  TO PV-CURRENT-JUL-YYDDD.             05040000
050500     IF PV-CURRENT-JUL-YY > 80                                    05050000
050600        MOVE 19 TO PV-CURRENT-JUL-CC                              05060000
050700     ELSE                                                         05070000
050800        MOVE 20 TO PV-CURRENT-JUL-CC.                             05080000
050900                                                                  05090000
051000     PERFORM 1100-CALC-OLD-DATES.                                 05100000
051100                                                                  05110000
051200     ACCEPT PV-CURRENT-DATE      FROM DATE.                       05120000
051300     MOVE PV-CURRENT-MONTH       TO   DP200O-RUN-MONTH.           05130000
051400     MOVE PV-CURRENT-DAY         TO   DP200O-RUN-DAY.             05140000
051500     MOVE PV-CURRENT-YEAR        TO   DP200O-RUN-YEAR.            05150000
051600                                                                  05160000
051700     ACCEPT PV-CURRENT-TIME      FROM TIME.                       05170000
051800     MOVE PV-CURRENT-HOUR        TO   DP200O-RUN-HOUR.            05180000
051900     MOVE PV-CURRENT-MINUTE      TO   DP200O-RUN-MINUTE.          05190000
052000                                                                  05200000
052100     MOVE PV-PROGRAM-NAME        TO   DP200O-PROGRAM-NAME.        05210000
052200     MOVE 1                      TO   DP200O-REPORT-NUMBER.       05220000
052300                                                                  05230000
052400     MOVE 99                     TO   PV-LINE-COUNT.              05240000
052500                                                                  05250000
052600     PERFORM 8000-READ-IMPORT-UNJRNL-FILE.                        05260000
052700     MOVE AP042-ENT-NM-DESC      TO   HDR3-VENDOR-NAME.           05270000
052800     MOVE AP042-VND-NBR          TO   HDR3-VENDOR-NBR.            05280000
052900     MOVE AP042-PO-NBR           TO   PV-PO-NBR.                  05290000
053000                                                                  05300000
053100                                                                  05310000
053200***************************************************************** 05320000
053300*  CALCULATES DATES 60, 90, 120, 180, AND 360 DAYS PAST TO BE     05330000
053400*  USED IN DATE COMPARISONS FOR AGING.                            05340000
053500***************************************************************** 05350000
053600 1100-CALC-OLD-DATES.                                             05360000
053700                                                                  05370000
053800* CALCULATE 0 - 30 DAYS AGO                                       05380000
053900     MOVE SPACES                    TO PV-DATE-SW.                05390000
054000     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         05400000
054100     SET DPG51-ACTUAL-CALENDAR-ONLY                               05410000
054200         DPG51-DECREMENT-DATE                                     05420000
054300                                                                  05430000
054400         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      05440000
054500     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       05450000
054600     MOVE 30                        TO DPG51-INCR-DECR-DAYS-9.    05460000
054700     PERFORM 4000-DATE-ROUTINE.                                   05470000
054800     IF VALID-DATE                                                05480000
054900         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-30-CH 05490000
055000     ELSE                                                         05500000
055100         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        05510000
055200         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          05520000
055300         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 30'     05530000
055400                                    TO AA-MESSAGE                 05540000
055500         SET AC-DATE-ERROR          TO TRUE                       05550000
055600         PERFORM 9999-ABEND                                       05560000
055700     END-IF.                                                      05570000
055800                                                                  05580000
055900* CALCULATE 31 - 60 DAYS AGO                                      05590000
056000     MOVE SPACES                    TO PV-DATE-SW.                05600000
056100     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         05610000
056200     SET DPG51-ACTUAL-CALENDAR-ONLY                               05620000
056300         DPG51-DECREMENT-DATE                                     05630000
056400**       DPG52-LK-DTE-JULIAN        TO TRUE.                      05640000
056500         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      05650000
056600     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       05660000
056700     MOVE 60                        TO DPG51-INCR-DECR-DAYS-9.    05670000
056800     PERFORM 4000-DATE-ROUTINE.                                   05680000
056900     IF VALID-DATE                                                05690000
057000**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-60      05700000
057100         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-60-CH 05710000
057200     ELSE                                                         05720000
057300         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        05730000
057400         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          05740000
057500         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 60'     05750000
057600                                    TO AA-MESSAGE                 05760000
057700         SET AC-DATE-ERROR          TO TRUE                       05770000
057800         PERFORM 9999-ABEND                                       05780000
057900     END-IF.                                                      05790000
058000                                                                  05800000
058100* CALCULATE 61 - 90 DAYS AGO                                      05810000
058200     MOVE SPACES                    TO PV-DATE-SW.                05820000
058300     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         05830000
058400     SET DPG51-ACTUAL-CALENDAR-ONLY                               05840000
058500         DPG51-DECREMENT-DATE                                     05850000
058600**       DPG52-LK-DTE-JULIAN        TO TRUE.                      05860000
058700         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      05870000
058800     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       05880000
058900     MOVE 90                        TO DPG51-INCR-DECR-DAYS-9.    05890000
059000     PERFORM 4000-DATE-ROUTINE.                                   05900000
059100     IF VALID-DATE                                                05910000
059200**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-90      05920000
059300         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-90-CH 05930000
059400     ELSE                                                         05940000
059500         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        05950000
059600         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          05960000
059700         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 90'     05970000
059800                                    TO AA-MESSAGE                 05980000
059900         SET AC-DATE-ERROR          TO TRUE                       05990000
060000         PERFORM 9999-ABEND                                       06000000
060100     END-IF.                                                      06010000
060200                                                                  06020000
060300* CALCULATE 91 - 120 DAYS AGO                                     06030000
060400     MOVE SPACES                    TO PV-DATE-SW.                06040000
060500     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         06050000
060600     SET DPG51-ACTUAL-CALENDAR-ONLY                               06060000
060700         DPG51-DECREMENT-DATE                                     06070000
060800**       DPG52-LK-DTE-JULIAN        TO TRUE.                      06080000
060900         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      06090000
061000     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       06100000
061100     MOVE 120                       TO DPG51-INCR-DECR-DAYS-9.    06110000
061200     PERFORM 4000-DATE-ROUTINE.                                   06120000
061300     IF VALID-DATE                                                06130000
061400**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-120     06140000
061500         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-120-CH06150000
061600     ELSE                                                         06160000
061700         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        06170000
061800         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          06180000
061900         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 120'    06190000
062000                                    TO AA-MESSAGE                 06200000
062100         SET AC-DATE-ERROR          TO TRUE                       06210000
062200         PERFORM 9999-ABEND                                       06220000
062300     END-IF.                                                      06230000
062400                                                                  06240000
062500* CALCULATE 121 AND UP DAYS AGO                                   06250000
062600     MOVE SPACES                    TO PV-DATE-SW.                06260000
062700     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         06270000
062800     SET DPG51-ACTUAL-CALENDAR-ONLY                               06280000
062900         DPG51-DECREMENT-DATE                                     06290000
063000**       DPG52-LK-DTE-JULIAN        TO TRUE.                      06300000
063100         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      06310000
063200     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       06320000
063300     MOVE 180                       TO DPG51-INCR-DECR-DAYS-9.    06330000
063400     PERFORM 4000-DATE-ROUTINE.                                   06340000
063500     IF VALID-DATE                                                06350000
063600**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-360     06360000
063700         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-360-CH06370000
063800     ELSE                                                         06380000
063900         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        06390000
064000         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          06400000
064100         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 180'    06410000
064200                                    TO AA-MESSAGE                 06420000
064300         SET AC-DATE-ERROR          TO TRUE                       06430000
064400         PERFORM 9999-ABEND                                       06440000
064500     END-IF.                                                      06450000
064600                                                                  06460000
064700 EJECT                                                            06470000
064800***************************************************************** 06480000
064900*  MAIN PROGRAM LOOP                                              06490000
065000*                                                                 06500000
065100*  CALLED FROM 0000-MAIN                                          06510000
065200***************************************************************** 06520000
065300 2000-PROCESS-DATA.                                               06530000
065400                                                                  06540000
065500     MOVE '2000-PROCESS-DATA'    TO   PV-CURRENT-PARAGRAPH.       06550000
065600                                                                  06560000
065700*  PROCESS INPUT RECORD                                           06570000
065800                                                                  06580000
065900     IF AP042-ENT-NM-DESC NOT = HDR3-VENDOR-NAME                  06590000
066000        PERFORM 3000-PROCESS-DETAIL                               06600000
066100        PERFORM 3100-PROCESS-VENDOR                               06610000
066200        MOVE AP042-ENT-NM-DESC     TO   HDR3-VENDOR-NAME          06620000
066300        MOVE AP042-VND-NBR          TO   HDR3-VENDOR-NBR          06630000
066400        MOVE AP042-PO-NBR           TO   PV-PO-NBR                06640000
066500                                                                  06650000
066600        IF (PV-LINE-COUNT + 2) > PC-MAX-LINES                     06660000
066700           PERFORM 9000-WRITE-HEADING                             06670000
066800        ELSE                                                      06680000
066900          WRITE RPT01-RECORD FROM DASH-LINE AFTER 1               06690000
067000          WRITE RPT01-RECORD FROM HDR-LINE3 AFTER 1               06700000
067100          ADD +2                    TO PV-LINE-COUNT              06710000
067200        END-IF                                                    06720000
067300     ELSE                                                         06730000
067400        IF AP042-PO-NBR NOT  = PV-PO-NBR                          06740000
067500           PERFORM 3000-PROCESS-DETAIL                            06750000
067600           MOVE AP042-PO-NBR        TO   PV-PO-NBR                06760000
067700        END-IF                                                    06770000
067800     END-IF.                                                      06780000
067900                                                                  06790000
068000     SET NOT-VALID-DATE TO TRUE.                                  06800000
068100     MOVE AP042-REC-DTE                TO PV-CHECK-DATE.          06810000
068200                                                                  06820000
068300     MOVE SPACES                     TO PV-DATE-SW                06830000
068400     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56          06840000
068500     SET DPG51-ACTUAL-CALENDAR-ONLY                               06850000
068600         DPG52-LK-DTE-ISO-FMT                                     06860000
068700         DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                      06870000
068800     MOVE PV-YYYY-MM-DD              TO DPG52-LK-DATE-INPUT       06880000
068900     PERFORM 4000-DATE-ROUTINE                                    06890000
069000                                                                  06900000
069100     IF VALID-DATE                                                06910000
069200          MOVE DPG55-JULIAN-DATE-CCYYDDD TO WS-COMPARE-CCYYDDD    06920000
069300        EVALUATE TRUE                                             06930000
069400          WHEN WS-COMPARE-CCYYDDD < PV-CURR-DATE-MINUS-120        06940000
069500               PERFORM 2500-COST-121                              06950000
069600          WHEN WS-COMPARE-CCYYDDD < PV-CURR-DATE-MINUS-90         06960000
069700               PERFORM 2400-COST-91                               06970000
069800          WHEN WS-COMPARE-CCYYDDD < PV-CURR-DATE-MINUS-60         06980000
069900               PERFORM 2300-COST-61                               06990000
070000          WHEN WS-COMPARE-CCYYDDD < PV-CURR-DATE-MINUS-30         07000000
070100               PERFORM 2200-COST-31                               07010000
070200          WHEN OTHER                                              07020000
070300               PERFORM 2100-COST-0                                07030000
070400        END-EVALUATE                                              07040000
070500     END-IF.                                                      07050000
070600                                                                  07060000
070700*  READ NEXT INPUT RECORD                                         07070000
070800                                                                  07080000
070900     PERFORM 8000-READ-IMPORT-UNJRNL-FILE.                        07090000
071000                                                                  07100000
071100 2100-COST-0.                                                     07110000
071200                                                                  07120000
071300     ADD AP042-CALCD-VRFD-RTL-AMT TO  DTL-RETAIL-0                07130000
071400                                      TOT-RETAIL-0                07140000
071500                                      GR-TOT-RETAIL-0.            07150000
071600     ADD AP042-CALCD-VRFD-COST-AMT TO DTL-COST-0                  07160000
071700                                      TOT-COST-0                  07170000
071800                                      GR-TOT-COST-0.              07180000
071900                                                                  07190000
072000     IF AP042-VND-NBR = '009206194' THEN                          07200000
072100       ADD AP042-CALCD-VRFD-RTL-AMT  TO PV-RETAIL-COLBY-0         07210000
072200       ADD AP042-CALCD-VRFD-COST-AMT TO PV-COST-COLBY-0           07220000
072300     ELSE                                                         07230000
072400       IF AP042-LLC THEN                                          07240003
072400*      IF AP042-COLBY-IND = 'L' THEN                              07241003
072500         ADD AP042-CALCD-VRFD-RTL-AMT TO LLC-RETAIL-TOT-0         07250000
072600         ADD AP042-CALCD-VRFD-COST-AMT TO LLC-COST-TOT-0          07260000
072700       ELSE                                                       07270000
072800         IF AP042-OPEN-ACCT THEN                                  07280003
072800*        IF AP042-COLBY-IND = 'O' THEN                            07281003
072900           ADD AP042-CALCD-VRFD-RTL-AMT TO OPN-RETAIL-TOT-0       07290000
073000           ADD AP042-CALCD-VRFD-COST-AMT TO OPN-COST-TOT-0        07300000
072700         ELSE                                                     07301003
072800           IF AP042-INFOR-NEXUS THEN                              07302003
072900             ADD AP042-CALCD-VRFD-RTL-AMT TO NXS-RETAIL-TOT-0     07304003
073000             ADD AP042-CALCD-VRFD-COST-AMT TO NXS-COST-TOT-0      07305005
073100           END-IF                                                 07310003
073100         END-IF                                                   07311003
073200       END-IF                                                     07320000
073300     END-IF.                                                      07330000
073400                                                                  07340000
073500 2200-COST-31.                                                    07350000
073600                                                                  07360000
073700     ADD AP042-CALCD-VRFD-RTL-AMT TO  DTL-RETAIL-31               07370000
073800                                      TOT-RETAIL-31               07380000
073900                                      GR-TOT-RETAIL-31.           07390000
074000     ADD AP042-CALCD-VRFD-COST-AMT TO DTL-COST-31                 07400000
074100                                      TOT-COST-31                 07410000
074200                                      GR-TOT-COST-31.             07420000
074300                                                                  07430000
074400     IF AP042-VND-NBR = '009206194' THEN                          07440000
074500        ADD AP042-CALCD-VRFD-RTL-AMT  TO PV-RETAIL-COLBY-31       07450000
074600        ADD AP042-CALCD-VRFD-COST-AMT TO PV-COST-COLBY-31         07460000
074700     ELSE                                                         07470000
074800       IF AP042-LLC THEN                                          07480003
074800*      IF AP042-COLBY-IND = 'L' THEN                              07481003
074900         ADD AP042-CALCD-VRFD-RTL-AMT TO LLC-RETAIL-TOT-0         07490000
075000         ADD AP042-CALCD-VRFD-COST-AMT TO LLC-COST-TOT-0          07500000
075100       ELSE                                                       07510000
075200         IF AP042-OPEN-ACCT THEN                                  07520003
075200*        IF AP042-COLBY-IND = 'O' THEN                            07521003
075300           ADD AP042-CALCD-VRFD-RTL-AMT TO OPN-RETAIL-TOT-0       07530000
075400           ADD AP042-CALCD-VRFD-COST-AMT TO OPN-COST-TOT-0        07540000
075100         ELSE                                                     07551003
075200           IF AP042-INFOR-NEXUS THEN                              07552006
075300             ADD AP042-CALCD-VRFD-RTL-AMT TO NXS-RETAIL-TOT-0     07554003
075400             ADD AP042-CALCD-VRFD-COST-AMT TO NXS-COST-TOT-0      07555003
075500           END-IF                                                 07556003
075500         END-IF                                                   07557003
075600       END-IF                                                     07560000
075700     END-IF.                                                      07570000
075800                                                                  07580000
075900 2300-COST-61.                                                    07590000
076000                                                                  07600000
076100     ADD AP042-CALCD-VRFD-RTL-AMT TO  DTL-RETAIL-61               07610000
076200                                      TOT-RETAIL-61               07620000
076300                                      GR-TOT-RETAIL-61.           07630000
076400     ADD AP042-CALCD-VRFD-COST-AMT TO DTL-COST-61                 07640000
076500                                      TOT-COST-61                 07650000
076600                                      GR-TOT-COST-61.             07660000
076700                                                                  07670000
076800     IF AP042-VND-NBR = '009206194' THEN                          07680000
076900        ADD AP042-CALCD-VRFD-RTL-AMT  TO PV-RETAIL-COLBY-61       07690000
077000        ADD AP042-CALCD-VRFD-COST-AMT TO PV-COST-COLBY-61         07700000
077100     ELSE                                                         07710000
077200       IF AP042-LLC THEN                                          07720003
077200*      IF AP042-COLBY-IND = 'L' THEN                              07721003
077300         ADD AP042-CALCD-VRFD-RTL-AMT TO LLC-RETAIL-TOT-0         07730000
077400         ADD AP042-CALCD-VRFD-COST-AMT TO LLC-COST-TOT-0          07740000
077500       ELSE                                                       07750000
077600         IF AP042-OPEN-ACCT THEN                                  07760003
077600*        IF AP042-COLBY-IND = 'O' THEN                            07761003
077700           ADD AP042-CALCD-VRFD-RTL-AMT TO OPN-RETAIL-TOT-0       07770000
077800           ADD AP042-CALCD-VRFD-COST-AMT TO OPN-COST-TOT-0        07780000
077500         ELSE                                                     07791003
077600           IF AP042-INFOR-NEXUS THEN                              07792006
077700             ADD AP042-CALCD-VRFD-RTL-AMT TO NXS-RETAIL-TOT-0     07794003
077800             ADD AP042-CALCD-VRFD-COST-AMT TO NXS-COST-TOT-0      07795003
077900           END-IF                                                 07795103
077900         END-IF                                                   07796003
078000       END-IF                                                     07800000
078100     END-IF.                                                      07810000
078200                                                                  07820000
078300 2400-COST-91.                                                    07830000
078400                                                                  07840000
078500     ADD AP042-CALCD-VRFD-RTL-AMT TO  DTL-RETAIL-91               07850000
078600                                      TOT-RETAIL-91               07860000
078700                                      GR-TOT-RETAIL-91.           07870000
078800     ADD AP042-CALCD-VRFD-COST-AMT TO DTL-COST-91                 07880000
078900                                      TOT-COST-91                 07890000
079000                                      GR-TOT-COST-91.             07900000
079100                                                                  07910000
079200     IF AP042-VND-NBR = '009206194' THEN                          07920000
079300        ADD AP042-CALCD-VRFD-RTL-AMT  TO PV-RETAIL-COLBY-91       07930000
079400        ADD AP042-CALCD-VRFD-COST-AMT TO PV-COST-COLBY-91         07940000
079500     ELSE                                                         07950000
079600       IF AP042-LLC THEN                                          07960003
079600*      IF AP042-COLBY-IND = 'L' THEN                              07961003
079700         ADD AP042-CALCD-VRFD-RTL-AMT TO LLC-RETAIL-TOT-0         07970000
079800         ADD AP042-CALCD-VRFD-COST-AMT TO LLC-COST-TOT-0          07980000
079900       ELSE                                                       07990000
080000         IF AP042-OPEN-ACCT THEN                                  08000003
080000*        IF AP042-COLBY-IND = 'O' THEN                            08001003
080100           ADD AP042-CALCD-VRFD-RTL-AMT TO OPN-RETAIL-TOT-0       08010000
080200           ADD AP042-CALCD-VRFD-COST-AMT TO OPN-COST-TOT-0        08020000
079900         ELSE                                                     08021003
080000           IF AP042-INFOR-NEXUS THEN                              08022006
080100             ADD AP042-CALCD-VRFD-RTL-AMT TO NXS-RETAIL-TOT-0     08024003
080200             ADD AP042-CALCD-VRFD-COST-AMT TO NXS-COST-TOT-0      08025003
080300           END-IF                                                 08030003
080300         END-IF                                                   08031003
080400       END-IF                                                     08040000
080500     END-IF.                                                      08050000
080600                                                                  08060000
080700 2500-COST-121.                                                   08070000
080800                                                                  08080000
080900     ADD AP042-CALCD-VRFD-RTL-AMT TO  DTL-RETAIL-121              08090000
081000                                      TOT-RETAIL-121              08100000
081100                                      GR-TOT-RETAIL-121.          08110000
081200     ADD AP042-CALCD-VRFD-COST-AMT TO DTL-COST-121                08120000
081300                                      TOT-COST-121                08130000
081400                                      GR-TOT-COST-121.            08140000
081500                                                                  08150000
081600     IF AP042-VND-NBR = '009206194' THEN                          08160000
081700        ADD AP042-CALCD-VRFD-RTL-AMT  TO PV-RETAIL-COLBY-121      08170000
081800        ADD AP042-CALCD-VRFD-COST-AMT TO PV-COST-COLBY-121        08180000
081900     ELSE                                                         08190000
082000       IF AP042-LLC THEN                                          08200003
082000*      IF AP042-COLBY-IND = 'L' THEN                              08201003
082100         ADD AP042-CALCD-VRFD-RTL-AMT TO LLC-RETAIL-TOT-0         08210000
082200         ADD AP042-CALCD-VRFD-COST-AMT TO LLC-COST-TOT-0          08220000
082300       ELSE                                                       08230000
082400         IF AP042-OPEN-ACCT THEN                                  08240003
082400*        IF AP042-COLBY-IND = 'O' THEN                            08241003
082500           ADD AP042-CALCD-VRFD-RTL-AMT TO OPN-RETAIL-TOT-0       08250000
082600           ADD AP042-CALCD-VRFD-COST-AMT TO OPN-COST-TOT-0        08260000
082300         ELSE                                                     08261003
082400           IF AP042-INFOR-NEXUS THEN                              08262006
082500             ADD AP042-CALCD-VRFD-RTL-AMT TO NXS-RETAIL-TOT-0     08264003
082600             ADD AP042-CALCD-VRFD-COST-AMT TO NXS-COST-TOT-0      08265003
082700           END-IF                                                 08270003
082700         END-IF                                                   08271003
082800       END-IF                                                     08280000
082900     END-IF.                                                      08290000
083000                                                                  08300000
083100*    IF DPG55-JULIAN-DATE-CCYYDDD < PV-CURR-DATE-MINUS-360        08310000
083200*       MOVE '**'     TO DL-OLD-IND                               08320000
083300*    END-IF.                                                      08330000
083400                                                                  08340000
083500 EJECT                                                            08350000
083600 3000-PROCESS-DETAIL.                                             08360000
083700                                                                  08370000
083800     MOVE PV-PO-NBR      TO DL-PO-NBR.                            08380000
083900                                                                  08390000
084000     MOVE DTL-COST-0     TO DL-COST-0.                            08400000
084100     MOVE DTL-COST-31    TO DL-COST-31.                           08410000
084200     MOVE DTL-COST-61    TO DL-COST-61.                           08420000
084300     MOVE DTL-COST-91    TO DL-COST-91.                           08430000
084400     MOVE DTL-COST-121   TO DL-COST-121.                          08440000
084500                                                                  08450000
084600     MOVE DTL-RETAIL-0   TO DL-RETAIL-0.                          08460000
084700     MOVE DTL-RETAIL-31  TO DL-RETAIL-31.                         08470000
084800     MOVE DTL-RETAIL-61  TO DL-RETAIL-61.                         08480000
084900     MOVE DTL-RETAIL-91  TO DL-RETAIL-91.                         08490000
085000     MOVE DTL-RETAIL-121 TO DL-RETAIL-121.                        08500000
085100                                                                  08510000
085200     IF PV-LINE-COUNT > PC-MAX-LINES                              08520000
085300        PERFORM 9000-WRITE-HEADING                                08530000
085400     END-IF.                                                      08540000
085500                                                                  08550000
085600     WRITE RPT01-RECORD FROM DETAIL-LINE                          08560000
085700        AFTER ADVANCING 1 LINES.                                  08570000
085800     ADD +1            TO PV-LINE-COUNT.                          08580000
085900                                                                  08590000
086000     INITIALIZE DTL-FIELDS                                        08600000
086100                DETAIL-LINE.                                      08610000
086200                                                                  08620000
086300 3100-PROCESS-VENDOR.                                             08630000
086400                                                                  08640000
086500     MOVE TOT-COST-0     TO TL-COST-0.                            08650000
086600     MOVE TOT-COST-31    TO TL-COST-31.                           08660000
086700     MOVE TOT-COST-61    TO TL-COST-61.                           08670000
086800     MOVE TOT-COST-91    TO TL-COST-91.                           08680000
086900     MOVE TOT-COST-121   TO TL-COST-121.                          08690000
087000     ADD  TOT-COST-0                                              08700000
087100          TOT-COST-31                                             08710000
087200          TOT-COST-61                                             08720000
087300          TOT-COST-91                                             08730000
087400          TOT-COST-121        TO CC-CROSS-COST-TOTAL.             08740000
087500     MOVE CC-CROSS-COST-TOTAL TO TL-TOTAL-COST.                   08750000
087600                                                                  08760000
087700     MOVE TOT-RETAIL-0   TO TL-RETAIL-0.                          08770000
087800     MOVE TOT-RETAIL-31  TO TL-RETAIL-31.                         08780000
087900     MOVE TOT-RETAIL-61  TO TL-RETAIL-61.                         08790000
088000     MOVE TOT-RETAIL-91  TO TL-RETAIL-91.                         08800000
088100     MOVE TOT-RETAIL-121 TO TL-RETAIL-121.                        08810000
088200                                                                  08820000
088300     ADD  TOT-RETAIL-0                                            08830000
088400          TOT-RETAIL-31                                           08840000
088500          TOT-RETAIL-61                                           08850000
088600          TOT-RETAIL-91                                           08860000
088700          TOT-RETAIL-121        TO CC-CROSS-RETAIL-TOTAL.         08870000
088800     MOVE CC-CROSS-RETAIL-TOTAL TO TL-TOTAL-RETAIL.               08880000
088900                                                                  08890000
089000     WRITE RPT01-RECORD FROM BLANK-LINE AFTER 1.                  08900000
089100     WRITE RPT01-RECORD FROM TOTAL-LINE AFTER 1.                  08910000
089200     ADD +2            TO PV-LINE-COUNT.                          08920000
089300                                                                  08930000
089400     INITIALIZE TOT-FIELDS                                        08940000
089500                PV-COLBY-TOTAL-FIELDS.                            08950000
089600                                                                  08960000
089700 3200-COMPUTE-LLC-VENDOR-TOTALS.                                  08970000
089800                                                                  08980000
089900     MOVE LLC-RETAIL-TOT-0   TO LLC-RETAIL-0.                     08990000
090000     MOVE LLC-COST-TOT-0     TO LLC-COST-0.                       09000000
090100     MOVE LLC-RETAIL-TOT-31  TO LLC-RETAIL-31.                    09010000
090200     MOVE LLC-COST-TOT-31    TO LLC-COST-31.                      09020000
090300     MOVE LLC-RETAIL-TOT-61  TO LLC-RETAIL-61.                    09030000
090400     MOVE LLC-COST-TOT-61    TO LLC-COST-61.                      09040000
090500     MOVE LLC-RETAIL-TOT-91  TO LLC-RETAIL-91.                    09050000
090600     MOVE LLC-COST-TOT-91    TO LLC-COST-91.                      09060000
090700     MOVE LLC-RETAIL-TOT-121 TO LLC-RETAIL-121.                   09070000
090800     MOVE LLC-COST-TOT-121   TO LLC-COST-121.                     09080000
090900                                                                  09090000
091000     ADD  LLC-RETAIL-TOT-0                                        09100000
091100          LLC-RETAIL-TOT-31                                       09110000
091200          LLC-RETAIL-TOT-61                                       09120000
091300          LLC-RETAIL-TOT-91                                       09130000
091400          LLC-RETAIL-TOT-121  TO LLC-RETAIL-GRND-TOT.             09140000
091500     MOVE LLC-RETAIL-GRND-TOT TO LLC-RETAIL-TOTAL.                09150000
091600                                                                  09160000
091700     ADD  LLC-COST-TOT-0                                          09170000
091800          LLC-COST-TOT-31                                         09180000
091900          LLC-COST-TOT-61                                         09190000
092000          LLC-COST-TOT-91                                         09200000
092100          LLC-COST-TOT-121   TO LLC-COST-GRND-TOT.                09210000
092200     MOVE LLC-COST-GRND-TOT  TO LLC-COST-TOTAL.                   09220000
092300                                                                  09230000
092400                                                                  09240000
092500 EJECT                                                            09250000
092600                                                                  09260000
092700 3300-COMPUTE-OPN-VENDOR-TOTALS.                                  09270000
092800                                                                  09280000
092900     MOVE OPN-RETAIL-TOT-0   TO OPN-RETAIL-0.                     09290000
093000     MOVE OPN-COST-TOT-0     TO OPN-COST-0.                       09300000
093100     MOVE OPN-RETAIL-TOT-31  TO OPN-RETAIL-31.                    09310000
093200     MOVE OPN-COST-TOT-31    TO OPN-COST-31.                      09320000
093300     MOVE OPN-RETAIL-TOT-61  TO OPN-RETAIL-61.                    09330000
093400     MOVE OPN-COST-TOT-61    TO OPN-COST-61.                      09340000
093500     MOVE OPN-RETAIL-TOT-91  TO OPN-RETAIL-91.                    09350000
093600     MOVE OPN-COST-TOT-91    TO OPN-COST-91.                      09360000
093700     MOVE OPN-RETAIL-TOT-121 TO OPN-RETAIL-121.                   09370000
093800     MOVE OPN-COST-TOT-121   TO OPN-COST-121.                     09380000
093900                                                                  09390000
094000     ADD  OPN-RETAIL-TOT-0                                        09400000
094100          OPN-RETAIL-TOT-31                                       09410000
094200          OPN-RETAIL-TOT-61                                       09420000
094300          OPN-RETAIL-TOT-91                                       09430000
094400          OPN-RETAIL-TOT-121  TO OPN-RETAIL-GRND-TOT.             09440000
094500     MOVE OPN-RETAIL-GRND-TOT TO OPN-RETAIL-TOTAL.                09450000
094600                                                                  09460000
094700     ADD  OPN-COST-TOT-0                                          09470000
094800          OPN-COST-TOT-31                                         09480000
094900          OPN-COST-TOT-61                                         09490000
095000          OPN-COST-TOT-91                                         09500000
095100          OPN-COST-TOT-121   TO OPN-COST-GRND-TOT.                09510000
095200     MOVE OPN-COST-GRND-TOT  TO OPN-COST-TOTAL.                   09520000
095300                                                                  09530000
095400                                                                  09540000
092700 3400-COMPUTE-NXS-VENDOR-TOTALS.                                  09541005
092800                                                                  09542004
092900     MOVE NXS-RETAIL-TOT-0   TO NXS-RETAIL-0.                     09543004
093000     MOVE NXS-COST-TOT-0     TO NXS-COST-0.                       09544004
093100     MOVE NXS-RETAIL-TOT-31  TO NXS-RETAIL-31.                    09545004
093200     MOVE NXS-COST-TOT-31    TO NXS-COST-31.                      09546004
093300     MOVE NXS-RETAIL-TOT-61  TO NXS-RETAIL-61.                    09547004
093400     MOVE NXS-COST-TOT-61    TO NXS-COST-61.                      09548004
093500     MOVE NXS-RETAIL-TOT-91  TO NXS-RETAIL-91.                    09549004
093600     MOVE NXS-COST-TOT-91    TO NXS-COST-91.                      09549104
093700     MOVE NXS-RETAIL-TOT-121 TO NXS-RETAIL-121.                   09549204
093800     MOVE NXS-COST-TOT-121   TO NXS-COST-121.                     09549304
093900                                                                  09549404
094000     ADD  NXS-RETAIL-TOT-0                                        09549504
094100          NXS-RETAIL-TOT-31                                       09549604
094200          NXS-RETAIL-TOT-61                                       09549704
094300          NXS-RETAIL-TOT-91                                       09549804
094400          NXS-RETAIL-TOT-121  TO NXS-RETAIL-GRND-TOT.             09549904
094500     MOVE NXS-RETAIL-GRND-TOT TO NXS-RETAIL-TOTAL.                09550004
094600                                                                  09550104
094700     ADD  NXS-COST-TOT-0                                          09550204
094800          NXS-COST-TOT-31                                         09550304
094900          NXS-COST-TOT-61                                         09550404
095000          NXS-COST-TOT-91                                         09550504
095100          NXS-COST-TOT-121   TO NXS-COST-GRND-TOT.                09550604
095200     MOVE NXS-COST-GRND-TOT  TO NXS-COST-TOTAL.                   09550704
095300                                                                  09550804
095400                                                                  09550904
095500 EJECT                                                            09551000
095600*----------------------------------------------------------------*09560000
095700*    CALLS THE DATE ROUTINE MODULE.                              *09570000
095800*----------------------------------------------------------------*09580000
095900 4000-DATE-ROUTINE.                                               09590000
096000                                                                  09600000
096100     CALL DP500-KOHLS-CALENDAR-ROUTINE                            09610000
096200         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               09620000
096300                                                                  09630000
096400     IF (DPG54-SEVERE-ERROR OR                                    09640000
096500         DPG54-WARNING-ERROR)                                     09650000
096600         SET NOT-VALID-DATE TO TRUE                               09660000
096700     ELSE                                                         09670000
096800         SET VALID-DATE TO TRUE                                   09680000
096900     END-IF.                                                      09690000
097000 EJECT                                                            09700000
097100***************************************************************** 09710000
097200*  THIS ROUTINE READS THE REPORT FILE FROM APKUP230               09720000
097300*                                                                 09730000
097400*  CALLED FROM 1000-BEGIN-PROGRAM                                 09740000
097500***************************************************************** 09750000
097600 8000-READ-IMPORT-UNJRNL-FILE.                                    09760000
097700                                                                  09770000
097800     MOVE '8000-READ-IMPORT-UNJRNL-FILE'                          09780000
097900                                 TO   PV-CURRENT-PARAGRAPH.       09790000
098000                                                                  09800000
098100     READ IMPORT-UNJRNL-FILE     INTO AP042-EXTRACT-FILE          09810000
098200         AT END                                                   09820000
098300             SET EOF TO TRUE.                                     09830000
098400                                                                  09840000
098500 EJECT                                                            09850000
098600***************************************************************** 09860000
098700*  REPORT AND COLUMN HEADINGS FOR BOTH REPORTS                    09870000
098800*                                                                 09880000
098900*  CALLED FROM                                                    09890000
099000***************************************************************** 09900000
099100 9000-WRITE-HEADING.                                              09910000
099200                                                                  09920000
099300     MOVE '9000-WRITE-HEADING'   TO   PV-CURRENT-PARAGRAPH.       09930000
099400                                                                  09940000
099500*  BUMP PAGE COUNT                                                09950000
099600                                                                  09960000
099700     ADD 1                       TO   PV-PAGE-COUNT.              09970000
099800     MOVE PV-PAGE-COUNT          TO   DP200O-PAGE-NUMBER.         09980000
099900                                                                  09990000
100000*  CLEAR LINE COUNT                                               10000000
100100                                                                  10010000
100200     MOVE 0                      TO   PV-LINE-COUNT.              10020000
100300                                                                  10030000
100400*  HEADING LINE 1 (STANDARD)                                      10040000
100500                                                                  10050000
100600     WRITE RPT01-RECORD FROM DP200O-STANDRD-HEADER-200-COLS       10060000
100700           AFTER ADVANCING PAGE.                                  10070000
100800                                                                  10080000
100900*  HEADING LINE 2 APPL SPECIFIC                                   10090000
101000                                                                  10100000
101100     WRITE RPT01-RECORD FROM HDR-LINE2                            10110000
101200           AFTER ADVANCING 1 LINES.                               10120000
101300                                                                  10130000
101400*  HEADING LINE 3 APPL SPECIFIC                                   10140000
101500                                                                  10150000
101600     WRITE RPT01-RECORD FROM HDR-LINE3 AFTER 2.                   10160000
101700                                                                  10170000
101800*  HEADING LINE 4 APPL SPECIFIC                                   10180000
101900                                                                  10190000
102000     WRITE RPT01-RECORD FROM HDR-LINE4                            10200000
102100           AFTER ADVANCING 1 LINES.                               10210000
102200                                                                  10220000
102300*  HEADING LINE 5 APPL SPECIFIC                                   10230000
102400                                                                  10240000
102500     WRITE RPT01-RECORD FROM HDR-LINE5                            10250000
102600           AFTER ADVANCING 1 LINES.                               10260000
102700                                                                  10270000
102800     MOVE SPACES TO RPT01-RECORD.                                 10280000
102900     WRITE RPT01-RECORD  AFTER ADVANCING 1 LINES.                 10290000
103000                                                                  10300000
103100     MOVE 7                      TO   PV-LINE-COUNT.              10310000
103200                                                                  10320000
103300 EJECT                                                            10330000
103400***************************************************************** 10340000
103500 9200-END-PROGRAM.                                                10350000
103600                                                                  10360000
103700     MOVE '9200-END-PROGRAM'     TO   PV-CURRENT-PARAGRAPH.       10370000
103800                                                                  10380000
103900     PERFORM 3000-PROCESS-DETAIL.                                 10390000
104000     PERFORM 3100-PROCESS-VENDOR.                                 10400000
104100                                                                  10410000
104200     MOVE GR-TOT-COST-0     TO TL-COST-0.                         10420000
104300     MOVE GR-TOT-COST-31    TO TL-COST-31.                        10430000
104400     MOVE GR-TOT-COST-61    TO TL-COST-61.                        10440000
104500     MOVE GR-TOT-COST-91    TO TL-COST-91.                        10450000
104600     MOVE GR-TOT-COST-121   TO TL-COST-121.                       10460000
104700     ADD  GR-TOT-COST-0                                           10470000
104800          GR-TOT-COST-31                                          10480000
104900          GR-TOT-COST-61                                          10490000
105000          GR-TOT-COST-91                                          10500000
105100          GR-TOT-COST-121   TO  CC-CROSS-COST-TOTAL.              10510000
105200     MOVE CC-CROSS-COST-TOTAL TO TL-TOTAL-COST.                   10520000
105300                                                                  10530000
105400     MOVE GR-TOT-RETAIL-0   TO TL-RETAIL-0.                       10540000
105500     MOVE GR-TOT-RETAIL-31  TO TL-RETAIL-31.                      10550000
105600     MOVE GR-TOT-RETAIL-61  TO TL-RETAIL-61.                      10560000
105700     MOVE GR-TOT-RETAIL-91  TO TL-RETAIL-91.                      10570000
105800     MOVE GR-TOT-RETAIL-121 TO TL-RETAIL-121.                     10580000
105900     ADD  GR-TOT-RETAIL-0                                         10590000
106000          GR-TOT-RETAIL-31                                        10600000
106100          GR-TOT-RETAIL-61                                        10610000
106200          GR-TOT-RETAIL-91                                        10620000
106300          GR-TOT-RETAIL-121 TO CC-CROSS-RETAIL-TOTAL.             10630000
106400     MOVE CC-CROSS-RETAIL-TOTAL TO TL-TOTAL-RETAIL.               10640000
106500                                                                  10650000
106600     PERFORM 3200-COMPUTE-LLC-VENDOR-TOTALS.                      10660000
106700     WRITE RPT01-RECORD FROM BLANK-LINE     AFTER 1.              10670000
106800     WRITE RPT01-RECORD FROM LLC-TOTAL-LINE AFTER 1.              10680000
106900     ADD +2             TO PV-LINE-COUNT.                         10690000
107000                                                                  10700000
107100     PERFORM 3300-COMPUTE-OPN-VENDOR-TOTALS.                      10710000
107200     WRITE RPT01-RECORD FROM BLANK-LINE     AFTER 1.              10720000
107300     WRITE RPT01-RECORD FROM OPN-TOTAL-LINE AFTER 1.              10730000
107400     ADD +2             TO PV-LINE-COUNT.                         10740000
107500                                                                  10750000
107100     PERFORM 3400-COMPUTE-NXS-VENDOR-TOTALS.                      10751004
107200     WRITE RPT01-RECORD FROM BLANK-LINE     AFTER 1.              10752004
107300     WRITE RPT01-RECORD FROM NXS-TOTAL-LINE AFTER 1.              10753004
107400     ADD +2             TO PV-LINE-COUNT.                         10754004
107500                                                                  10755004
107600     WRITE RPT01-RECORD FROM BLANK-LINE AFTER 1.                  10760000
107700     WRITE RPT01-RECORD FROM TOTAL-LINE AFTER 1.                  10770000
107800     ADD +2             TO PV-LINE-COUNT.                         10780000
107900                                                                  10790000
108000     WRITE RPT01-RECORD FROM EOR-END-OF-REPORT                    10800000
108100           AFTER ADVANCING 2 LINES.                               10810000
108200                                                                  10820000
108300 EJECT                                                            10830000
108400*----------------------------------------------------------------*10840000
108500*    ABEND ROUTINE                                               *10850000
108600*----------------------------------------------------------------*10860000
108700 9999-ABEND.                                                      10870000
108800                                                                  10880000
108900     CLOSE  IMPORT-UNJRNL-FILE                                    10890000
109000            RPT01-FILE.                                           10900000
109100                                                                  10910000
109200     DISPLAY AA-ABEND-LIT.                                        10920000
109300     DISPLAY AA-PROGRAM-LIT.                                      10930000
109400     DISPLAY AA-PARAGRAPH-LIT.                                    10940000
109500     DISPLAY AA-MESSAGE-LINE.                                     10950000
109600     CALL 'ILBOABN0' USING ABEND-CODE.                            10960000
