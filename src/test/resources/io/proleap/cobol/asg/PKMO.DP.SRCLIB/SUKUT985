000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.    SUKUT985.                                         00050000
000600 AUTHOR.        TOM BOYD                                          00060000
000700 INSTALLATION.  KOHLS.                                            00070000
000800 DATE-WRITTEN   JULY 2002.                                        00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM WILL CREATE A FILE OF RECORDS WHICH WILL BE USED   00120000
001300* TO PRODUCE A UCC-128 ARCHIVE REPORT.                            00130000
001310******************************************************************00140000
001320                                                                  00150000
001330******************************************************************00160000
001340 ENVIRONMENT DIVISION.                                            00170000
001350******************************************************************00180000
001360                                                                  00190000
001370 CONFIGURATION SECTION.                                           00200000
001380                                                                  00210000
001390 SOURCE-COMPUTER.        IBM-3090.                                00220000
001400 OBJECT-COMPUTER.        IBM-3090.                                00230000
001500                                                                  00240000
001600 INPUT-OUTPUT SECTION.                                            00250000
001700                                                                  00260000
001800 FILE-CONTROL.                                                    00270000
001900                                                                  00280000
002000     SELECT INPUT-FILE-ARC                                        00290000
002100         ASSIGN TO INP01.                                         00300000
002101                                                                  00310000
002110     SELECT INPUT-FILE-REQ                                        00320000
002120         ASSIGN TO INP02.                                         00330000
002200                                                                  00340000
002300     SELECT OUTPUT-FILE                                           00350000
002400         ASSIGN TO OUT01.                                         00360000
002500                                                                  00370000
002600******************************************************************00380000
002700 DATA DIVISION.                                                   00390000
002800******************************************************************00400000
002900                                                                  00410000
003000 FILE SECTION.                                                    00420000
003100                                                                  00430000
003200 FD  INPUT-FILE-ARC                                               00440000
003300     RECORDING MODE IS F                                          00450000
003400     LABEL RECORDS ARE STANDARD                                   00460000
003500     RECORD CONTAINS 118                                          00470000
003600     BLOCK CONTAINS 0 RECORDS                                     00480000
003700     DATA RECORD IS INPUT-RECORD-ARC.                             00490000
003800                                                                  00500000
003900 01  INPUT-RECORD-ARC          PIC  X(118).                       00510000
004000                                                                  00520000
004010 FD  INPUT-FILE-REQ                                               00530000
004020     RECORDING MODE IS F                                          00540000
004030     LABEL RECORDS ARE STANDARD                                   00550000
004050     BLOCK CONTAINS 0 RECORDS                                     00560000
004060     DATA RECORD IS INPUT-RECORD-REQ.                             00570000
004070                                                                  00580000
004080 01  INPUT-RECORD-REQ          PIC  X(69).                        00590000
004090                                                                  00600000
004100 FD  OUTPUT-FILE                                                  00610000
004200     RECORDING MODE IS F                                          00620000
004300     LABEL RECORDS ARE STANDARD                                   00630000
004500     BLOCK CONTAINS 0 RECORDS                                     00640000
004510     DATA RECORD IS OUTPUT-RECORD.                                00650000
004520                                                                  00660000
004530 01  OUTPUT-RECORD             PIC  X(173).                       00670000
004540                                                                  00680000
004541******************************************************************00690000
004542 WORKING-STORAGE SECTION.                                         00700000
004543******************************************************************00710000
004544 01  PS-PROGRAM-SWITCHES.                                         00720000
004545     05  PS-EOF-INP-SW                PIC X(01)  VALUE 'N'.       00730000
004546         88  PS-EOF-INP                          VALUE 'Y'.       00740000
004547         88  PS-NOT-EOF-INP                      VALUE 'N'.       00750000
004548     05  PS-EOF-REQ-SW                PIC X(01)  VALUE 'N'.       00760000
004549         88  PS-EOF-REQ                          VALUE 'Y'.       00770000
004550         88  PS-NOT-EOF-REQ                      VALUE 'N'.       00780000
004551     05  PS-ACTIVE-REC-SW             PIC X(01)  VALUE 'N'.       00790000
004552         88  PS-ACTIVE                           VALUE 'Y'.       00800000
004553         88  PS-INACTIVE                         VALUE 'N'.       00810000
004560                                                                  00820000
004561 01  PC-PROGRAM-CONSTANTS.                                        00830000
004562     05  PC-PROGRAM-NAME              PIC X(08)  VALUE 'SUKUT985'.00840000
004563                                                                  00850000
004564     05  PC-A                         PIC X(01)  VALUE 'A'.       00860000
004565     05  PC-B                         PIC X(01)  VALUE 'B'.       00870000
004566     05  PC-I                         PIC X(01)  VALUE 'I'.       00880000
004567     05  PC-N                         PIC X(01)  VALUE 'N'.       00890000
004568     05  PC-Y                         PIC X(01)  VALUE 'Y'.       00900000
004569                                                                  00910000
004570 01  PV-PROGRAM-VARIABLES.                                        00920000
004571     05  PV-RECORDS-READ              PIC 9(09)     VALUE ZERO.   00930000
004572     05  PV-RECORDS-READ-REQ          PIC 9(09)     VALUE ZERO.   00940000
004573     05  PV-RECORDS-WRITTEN           PIC 9(09)     VALUE ZERO.   00950000
004574*    05  PV-REQ-COUNT                 PIC 9(09)     VALUE ZERO.   00960000
004580     05  PV-CURRENT-PO                PIC 9(09)     VALUE ZERO.   00970000
004581*    05  PV-CURRENT-PO                PIC S9(09) COMP.            00980000
004582     05  PV-CURRENT-REC-SEQ           PIC 9(09)     VALUE ZERO.   00990000
004583     05  PV-CURRENT-OPER-ID           PIC 9(04)     VALUE ZERO.   01000000
004584     05  PV-CURRENT-DEST-ID           PIC 9(04)     VALUE ZERO.   01010000
004590     05  PV-CURRENT-SHIPT-ID          PIC S9(18)V   VALUE ZERO    01020000
004600                                                    COMP-3.       01030000
004700     05  PV-PREV-SHIPT-ID             PIC S9(18)V   VALUE ZERO    01040000
004800                                                    COMP-3.       01050000
004810                                                                  01060000
004820 01  PT-REQUEST-TABLE.                                            01070000
004830     05  PT-REQUESTS OCCURS 5000 TIMES INDEXED BY PT-IDX,         01080000
004840                                                PT-SRCH-IDX,      01090000
004850                                                PT-END-IDX,       01100000
004860                                                PT-FINAL-IDX.     01110000
004870                                                                  01120000
004890         10 PT-PO-NBR               PIC S9(09) COMP.              01130000
004891         10 PT-REC-SEQ-NBR          PIC S9(09) COMP.              01140000
004892         10 PT-OPER-UNT-ID          PIC S9(04) COMP.              01150000
004893         10 PT-DEST-OPER-UNT-ID     PIC S9(04) COMP.              01160000
004894         10 PT-TK-NBR               PIC X(08).                    01170000
004897         10 PT-REQ-DATE.                                          01180000
004898            15 PT-REQ-YY            PIC X(04).                    01190000
004899            15 FILLER               PIC X(01).                    01200000
004900            15 PT-REQ-MM            PIC X(02).                    01210000
004901            15 FILLER               PIC X(01).                    01220000
004902            15 PT-REQ-DD            PIC X(02).                    01230000
004903         10 PT-REQ-TIME.                                          01240000
004904            15 PT-REQ-HRS           PIC X(02).                    01250000
004905            15 FILLER               PIC X(01).                    01260000
004906            15 PT-REQ-MIN           PIC X(02).                    01270000
004907            15 FILLER               PIC X(01).                    01280000
004908            15 PT-REQ-SEC           PIC X(02).                    01290000
004909         10 PT-REC-SEQ-IND          PIC X(01).                    01300000
004910            88 PT-ALL-RECEIVERS              VALUE 'Y'.           01310000
004911            88 PT-NOT-ALL-RECEIVERS          VALUE 'N'.           01320000
004912         10 PT-REQUEST-PO-FOUND-SW  PIC X(01).                    01330000
004913            88 PT-PO-FOUND                   VALUE 'Y'.           01340000
004914            88 PT-PO-NOT-FOUND               VALUE 'N'.           01350000
004920/                                                                 01360000
005000******************************************************************01370000
005100*  COPYBOOK ARCHIVE RECORD LAYOUT                                 01380000
005200******************************************************************01390000
005300     COPY SURD020.                                                01400000
005310/                                                                 01410000
005320******************************************************************01420000
005330*                                                                 01430000
005340******************************************************************01440000
005350     COPY SURD039.                                                01450000
005360/                                                                 01460000
005361******************************************************************01470000
005362*  LAYOUT ARCHIVE RECORD COMBINED REC A/B                         01480000
005363******************************************************************01490000
005364     COPY SURD038.                                                01500000
005365/                                                                 01510000
005370******************************************************************01520000
005380 PROCEDURE DIVISION.                                              01530000
005390******************************************************************01540000
005400                                                                  01550000
005500 0000-PROGRAM-MAINLINE.                                           01560000
005600                                                                  01570000
005700     DISPLAY 'START OF PROGRAM SUKUT985'.                         01580000
005800     DISPLAY ' '.                                                 01590000
005900                                                                  01600000
006000     OPEN INPUT  INPUT-FILE-ARC                                   01610000
006010          INPUT  INPUT-FILE-REQ                                   01620000
006100          OUTPUT OUTPUT-FILE                                      01630000
006110                                                                  01640000
006200     PERFORM 500-LOAD-REQUEST-TABLE.                              01650000
006300     PERFORM 1000-READ-INPUT-FILE-ARC.                            01660000
006600                                                                  01670000
006700     PERFORM 2000-PROCESS-RECORDS                                 01680000
006800        UNTIL PS-EOF-INP.                                         01690000
006900                                                                  01700000
006910     PERFORM 4000-SEARCH-NOT-FOUND-PO.                            01710000
007000     CLOSE INPUT-FILE-ARC                                         01720000
007010           INPUT-FILE-REQ                                         01730000
007100           OUTPUT-FILE                                            01740000
007200                                                                  01750000
007300     DISPLAY '**** PROGRAM SUMMARY ****'.                         01760000
007400     DISPLAY 'NBR REQUESTS: ' PV-RECORDS-READ-REQ.                01770000
007410     DISPLAY 'RECORDS READ: ' PV-RECORDS-READ.                    01780000
007500     DISPLAY 'RECORDS WRITTEN: ' PV-RECORDS-WRITTEN.              01790000
007600     DISPLAY '**** END OF SUMMARY ****'.                          01800000
007610     DISPLAY ' '.                                                 01810000
007700     DISPLAY 'END OF PROGRAM SUKUT985'.                           01820000
007800     STOP RUN.                                                    01830000
007900/                                                                 01840000
008000******************************************************************01850000
008100* LOAD REQUEST FILE INTO INTERNAL TABLE.                          01860000
008200******************************************************************01870000
008300 500-LOAD-REQUEST-TABLE.                                          01880000
008310                                                                  01890000
008313     INITIALIZE PV-RECORDS-READ-REQ                               01900000
008314     PERFORM 1500-READ-INPUT-FILE-REQ.                            01910000
008316                                                                  01920000
008317     PERFORM VARYING PT-IDX FROM 1 BY 1                           01930000
008318        UNTIL PS-EOF-REQ                                          01940000
008320           PERFORM 750-REQ-TO-TABLE                               01950000
008321           PERFORM 1500-READ-INPUT-FILE-REQ                       01960000
008323     END-PERFORM.                                                 01970000
008330                                                                  01980000
008400/                                                                 01990000
008410******************************************************************02000000
008420*                                                                 02010000
008430******************************************************************02020000
008440 750-REQ-TO-TABLE.                                                02030000
008441                                                                  02040000
008442     MOVE SU039-PO-NBR            TO PT-PO-NBR           (PT-IDX).02050000
008443     MOVE SU039-REC-SEQ-NBR       TO PT-REC-SEQ-NBR      (PT-IDX).02060000
008444     MOVE SU039-OPER-UNT-ID       TO PT-OPER-UNT-ID      (PT-IDX).02070000
008445     MOVE SU039-DEST-OPER-UNT-ID  TO PT-DEST-OPER-UNT-ID (PT-IDX).02080000
008446     MOVE SU039-TK-NBR            TO PT-TK-NBR           (PT-IDX).02090000
008448     MOVE SU039-REQ-DATE          TO PT-REQ-DATE         (PT-IDX).02100000
008449     MOVE SU039-REQ-TIME          TO PT-REQ-TIME         (PT-IDX).02110000
008450     MOVE SU039-REC-SEQ-IND       TO PT-REC-SEQ-IND      (PT-IDX).02120000
008451     SET PT-PO-NOT-FOUND (PT-IDX) TO TRUE.                        02130000
008454                                                                  02140000
008455/                                                                 02150000
008460******************************************************************02160000
008470* READS RECORD FROM THE INPUT FILE                                02170000
008480******************************************************************02180000
008490 1000-READ-INPUT-FILE-ARC.                                        02190000
008491                                                                  02200000
008500     INITIALIZE SU020-VEND-ARCHIVE-RECORD.                        02210000
008600                                                                  02220000
008700     READ INPUT-FILE-ARC                                          02230000
008800          INTO SU020-VEND-ARCHIVE-RECORD                          02240000
008900            AT END                                                02250000
009000               SET PS-EOF-INP       TO TRUE                       02260000
009100                                                                  02270000
009200            NOT AT END                                            02280000
009300               SET PS-NOT-EOF-INP   TO TRUE                       02290000
009400               ADD +1 TO PV-RECORDS-READ                          02300000
009410               MOVE SU020-PO-NBR           TO PV-CURRENT-PO       02310000
009420               MOVE SU020-SHIPT-UNT-ID     TO PV-CURRENT-SHIPT-ID 02320000
009430               MOVE SU020-REC-SEQ-NBR      TO PV-CURRENT-REC-SEQ  02330000
009500     END-READ.                                                    02340000
009600/                                                                 02350000
009610******************************************************************02360000
009620* READS RECORD FROM THE REQ INPUT FILE                            02370000
009630******************************************************************02380000
009640 1500-READ-INPUT-FILE-REQ.                                        02390000
009650                                                                  02400000
009660     INITIALIZE SU039-REQUEST-RECORD.                             02410000
009670                                                                  02420000
009680     READ INPUT-FILE-REQ                                          02430000
009690          INTO SU039-REQUEST-RECORD                               02440000
009691            AT END                                                02450000
009692               SET PS-EOF-REQ       TO TRUE                       02460000
009693               SET PT-END-IDX       TO PV-RECORDS-READ-REQ        02470000
009694            NOT AT END                                            02480000
009695               SET PS-NOT-EOF-REQ   TO TRUE                       02490000
009696               ADD +1 TO PV-RECORDS-READ-REQ                      02500000
009697     END-READ.                                                    02510000
009698/                                                                 02520000
009700******************************************************************02530000
009800*                                                                *02540000
009900******************************************************************02550000
010000 2000-PROCESS-RECORDS.                                            02560000
010100                                                                  02570000
010200     IF PV-CURRENT-SHIPT-ID NOT = PV-PREV-SHIPT-ID                02580000
010300*    SHOULD BE AN A-TYPE RECORD SO FILL APPROPRIATE FIELDS        02590000
010400        MOVE PV-CURRENT-SHIPT-ID   TO PV-PREV-SHIPT-ID            02600000
010500        IF SU020-RECORD-TYPE = PC-A                               02610000
010600           PERFORM 3000-FILL-FIELDS-A                             02620000
010700        END-IF                                                    02630000
010800                                                                  02640000
010900     ELSE                                                         02650000
011000         IF (PV-CURRENT-SHIPT-ID = PV-PREV-SHIPT-ID)              02660000
011100             AND (SU020-RECORD-TYPE = PC-B)                       02670000
011200*               TYPE B RECORDS, FILL APPROPIATE FIELDS            02680000
011300                                                                  02690000
011400                IF PS-ACTIVE                                      02700000
011500                   PERFORM 3500-FILL-FIELDS-B                     02710000
011510                                                                  02720000
011600                   PERFORM 9000-WRITE-OUTPUT-RECORD               02730000
011700                END-IF                                            02740000
011800         ELSE                                                     02750000
011900                                                                  02760000
012000            IF (PV-CURRENT-SHIPT-ID = PV-PREV-SHIPT-ID)           02770000
012001                AND (SU020-RECORD-TYPE = PC-A)                    02780000
012002                                                                  02790000
012003                IF SU020-ACTV-IND = PC-I                          02800000
012004                   SET PS-INACTIVE TO TRUE                        02810000
012005                ELSE                                              02820000
012006                   PERFORM 3000-FILL-FIELDS-A                     02830000
012007                END-IF                                            02840000
012008                                                                  02850000
012009         END-IF                                                   02860000
012010     END-IF.                                                      02870000
012020                                                                  02880000
012030     PERFORM 1000-READ-INPUT-FILE-ARC.                            02890000
012040/                                                                 02900000
012050******************************************************************02910000
012060*                                                                *02920000
012070******************************************************************02930000
012080 3000-FILL-FIELDS-A.                                              02940000
012090                                                                  02950000
012100     IF SU020-ACTV-IND = PC-A                                     02960000
012200*       ACTIVE RECORD                                             02970000
012300        SET PS-ACTIVE TO TRUE                                     02980000
012400     ELSE                                                         02990000
012500*       INACTIVE RECORD                                           03000000
012600        SET PS-INACTIVE TO TRUE                                   03010000
012610     END-IF.                                                      03020000
012620                                                                  03030000
012630     MOVE SU020-SHIPT-UNT-ID         TO SU038-SHIPT-UNT-ID.       03040000
012631     MOVE SU020-PO-NBR               TO SU038-PO-NBR.             03050000
012632     MOVE SU020-REC-SEQ-NBR          TO SU038-REC-SEQ-NBR.        03060000
012633     MOVE SU020-TRIP-ID              TO SU038-TRIP-ID.            03070000
012634     MOVE SU020-ORGN-OPER-UNT-ID     TO SU038-ORGN-OPER-UNT-ID.   03080000
012635     MOVE SU020-ORGN-OPER-UNT-ID     TO PV-CURRENT-OPER-ID.       03090000
012640     MOVE SU020-DEST-OPER-UNT-ID     TO SU038-DEST-OPER-UNT-ID.   03100000
012641     MOVE SU020-DEST-OPER-UNT-ID     TO PV-CURRENT-DEST-ID.       03110000
012650     MOVE SU020-SHIPT-UNT-SRC-ID     TO SU038-SHIPT-UNT-SRC-ID.   03120000
012660     MOVE SU020-ACTV-IND             TO SU038-ACTV-IND.           03130000
012670     MOVE SU020-CRE-DTE              TO SU038-CRE-DTE.            03140000
012671     MOVE SU020-CRE-TM               TO SU038-CRE-TM.             03150000
012672     MOVE SU020-CRE-USR-ID           TO SU038-CRE-USR-ID.         03160000
012673     MOVE SU020-CRE-PGM-NM           TO SU038-CRE-PGM-NM.         03170000
012674                                                                  03180000
012675                                                                  03190000
012676/                                                                 03200000
012677******************************************************************03210000
012678*                                                                *03220000
012679******************************************************************03230000
012680 3500-FILL-FIELDS-B.                                              03240000
012690                                                                  03250000
012700     MOVE SU020-TRN-NBR           TO SU038-TRN-NBR.               03260000
012800     MOVE SU020-TRN-LNE-NBR       TO SU038-TRN-LNE-NBR.           03270000
012900     MOVE SU020-TRN-TYP-CDE       TO SU038-TRN-TYP-CDE.           03280000
013000     MOVE SU020-UPC-NBR           TO SU038-UPC-NBR.               03290000
013100     MOVE SU020-SHPD-QTY          TO SU038-SHPD-QTY.              03300000
013200                                                                  03310000
013300/                                                                 03320000
013810******************************************************************03330000
013820* LOOKS FOR REQUESTS THAT HAVE NO MATCHING RECORDS               *03340000
013830******************************************************************03350000
013840 4000-SEARCH-NOT-FOUND-PO.                                        03360000
013850*                                                                 03370000
013852     SET PT-SRCH-IDX                  TO 1.                       03380000
013853                                                                  03390000
013855     PERFORM VARYING PT-SRCH-IDX FROM 1 BY 1                      03400000
013856        UNTIL PT-SRCH-IDX > PT-END-IDX                            03410000
013858                                                                  03420000
013859              IF PT-PO-NOT-FOUND (PT-SRCH-IDX)                    03430000
013860*                NO RECORDS ON ARCHIVE FILE WITH THIS PO          03440000
013861                 INITIALIZE SU038-EXTRACT-RECORD                  03450000
013862                 MOVE PT-PO-NBR   (PT-SRCH-IDX)  TO SU038-PO-NBR  03460000
013863                 MOVE PT-REC-SEQ-NBR (PT-SRCH-IDX)                03470000
013864                                            TO SU038-REC-SEQ-NBR  03480000
013868                 MOVE ZEROS                      TO SU038-TRIP-ID 03490000
013869                 PERFORM 9100-WRITE-REC-TO-FILE                   03500000
013870              END-IF                                              03510000
013877                                                                  03520000
013878     END-PERFORM.                                                 03530000
013879                                                                  03540000
013880/                                                                 03550000
013881******************************************************************03560000
013882* WRITES THE RECEIVER-EXT-RECORD TO THE OUTPUT FILE              *03570000
013883******************************************************************03580000
013884 9000-WRITE-OUTPUT-RECORD.                                        03590000
013885*                                                                 03600000
013886     SET PT-SRCH-IDX                  TO 1.                       03610000
013887                                                                  03620000
013888     PERFORM VARYING PT-SRCH-IDX FROM 1 BY 1                      03630000
013889        UNTIL PT-SRCH-IDX > PT-END-IDX                            03640000
013892**           (PT-PO-NBR (PT-SRCH-IDX) < PV-CURRENT-PO)            03650000
013893                                                                  03660000
013894        IF PT-PO-NBR (PT-SRCH-IDX) = PV-CURRENT-PO                03670000
013895                                                                  03680000
013896           IF PT-REC-SEQ-NBR (PT-SRCH-IDX) = PV-CURRENT-REC-SEQ   03690000
013897              OR (PT-REC-SEQ-IND (PT-SRCH-IDX) = PC-Y)            03700000
013898                                                                  03710000
013899                 IF (PT-OPER-UNT-ID (PT-SRCH-IDX) =               03720000
013900                                PV-CURRENT-OPER-ID)               03730000
013901                    AND (PT-DEST-OPER-UNT-ID (PT-SRCH-IDX) =      03740000
013902                                PV-CURRENT-DEST-ID)               03750000
013903                                                                  03760000
013904                        SET PT-PO-FOUND (PT-SRCH-IDX) TO TRUE     03770000
013905                        PERFORM 9100-WRITE-REC-TO-FILE            03780000
013906                 ELSE                                             03790000
013907                    IF (PT-OPER-UNT-ID (PT-SRCH-IDX) = ZERO) AND  03800000
013908                    (PT-DEST-OPER-UNT-ID (PT-SRCH-IDX) = ZERO)    03810000
013909                                                                  03820000
013910                       SET PT-PO-FOUND (PT-SRCH-IDX) TO TRUE      03830000
013911                       PERFORM 9100-WRITE-REC-TO-FILE             03840000
013912                    ELSE                                          03850000
013913                       IF (PT-OPER-UNT-ID (PT-SRCH-IDX) = ZERO)   03860000
013914                           AND (PT-DEST-OPER-UNT-ID (PT-SRCH-IDX) 03870000
013915                                = PV-CURRENT-DEST-ID)             03880000
013916                             SET PT-PO-FOUND (PT-SRCH-IDX) TO TRUE03890000
013917                             PERFORM 9100-WRITE-REC-TO-FILE       03900000
013918                                                                  03910000
013919                       ELSE                                       03920000
013920                         IF (PT-OPER-UNT-ID (PT-SRCH-IDX) =       03930000
013921                                             PV-CURRENT-OPER-ID)  03940000
013922                            AND (PT-DEST-OPER-UNT-ID (PT-SRCH-IDX)03950000
013923                                 = ZERO)                          03960000
013924                                                                  03970000
013925                             SET PT-PO-FOUND (PT-SRCH-IDX) TO TRUE03980000
013926                             PERFORM 9100-WRITE-REC-TO-FILE       03990000
013927                                                                  04000000
013928                                                                  04010000
013929                         END-IF                                   04020000
013930                       END-IF                                     04030000
013931                    END-IF                                        04040000
013932                 END-IF                                           04050000
013933           END-IF                                                 04060000
013934        END-IF                                                    04070000
013935     END-PERFORM.                                                 04080000
013936                                                                  04090000
013937/                                                                 04100000
013938******************************************************************04110000
013939* WRITES THE RECEIVER-EXT-RECORD TO THE OUTPUT FILE              *04120000
013940******************************************************************04130000
013941 9100-WRITE-REC-TO-FILE.                                          04140000
013942                                                                  04150000
013943     MOVE PT-TK-NBR   (PT-SRCH-IDX)  TO SU038-TK-NBR.             04160000
013944     MOVE PT-REQ-DATE (PT-SRCH-IDX)  TO SU038-REQ-DATE.           04170000
013945     MOVE PT-REQ-TIME (PT-SRCH-IDX)  TO SU038-REQ-TIME.           04180000
013946     MOVE PT-DEST-OPER-UNT-ID (PT-SRCH-IDX)                       04190000
013947                                     TO SU038-REQ-DEST-ID.        04200000
013948     MOVE PT-OPER-UNT-ID (PT-SRCH-IDX)                            04210000
013949                                     TO SU038-REQ-OPER-ID.        04220000
013950                                                                  04230000
013960     WRITE OUTPUT-RECORD                                          04240000
014000        FROM SU038-EXTRACT-RECORD.                                04250000
014100        ADD  1  TO  PV-RECORDS-WRITTEN.                           04260000
014500/                                                                 04270000
