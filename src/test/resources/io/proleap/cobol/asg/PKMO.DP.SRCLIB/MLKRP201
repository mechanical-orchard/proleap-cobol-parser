000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.    MLKRP201.                                         00030000
000400 AUTHOR.        SCOTT JACKSON.                                    00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  06/30/98.                                         00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000*     MLKRP201 - MAJOR CLASS-LEVEL MERCHANDISE LEDGER REPORT      00100000
001100*                                                                 00110000
001200* THIS PROGRAM READS AN EXTRACT FROM THE MAJOR-CLASS-LEVEL MTD    00120000
001300* MERCHANDISE LEDGER TABLE AND PRODUCES THE MAJOR-CLASS-LEVEL MTD 00130000
001400* MERCHANDISE LEDGER REPORT.                                      00140000
001500*                                                                 00150000
      *       MAJOR CLASS                                               00160000
001700*       DEPARTMENT                                                00170000
001800*       BUYER                                                     00180000
001900*       MANAGER  (DMM)                                            00190000
002000*       DIVISION (GMM)                                            00200000
002100*       COMPANY                                                   00210000
002200*                                                                 00220000
002300* AN ADJUSTMENT LINE IS ALSO PRINTED TO SHOW THE INVENTORY        00230000
002400* ADJUSTMENT TO BOOK INVENTORY AFTER A PHYSICAL INVENTORY.        00240000
002500*                                                                 00250000
002600* THIS PROGRAM WAS CREATED FROM MLKRP200 (DEPT-LEVEL DB2 REPORT)  00260000
      * AND THE ORIGINAL MODEL REPORT PGM MLKRP015, WHICH PRODUCED THE  00270000
002700* DEPARTMENT-LEVEL MERCHANDISE LEDGER REPORT FROM AN EXTRACT      00280000
002800* FROM THE MERCHANDISE LEDGER IMS DATABASES.                      00290000
002900******************************************************************00300000
WR5701*   DATE : 12/28/98       CHANGE ID : WR5701     WHO :TKMA372     00310000
WR5701*   REASON FOR CHANGE : 'PURCHASES' COLUMN OBSOLETED.             00320000
WR5701*    REPLACED WITH 'RECEIPTS' AND 'PURCHASE ADJ' COST & RETAIL.   00330000
WR5701*    'B.I.' LINE ONLY DISPLAYED FOR INITIAL MONTH AS PREV END-INV.00340000
WR5701******************************************************************00350000
003000*    12/28/99             WR#5701                    JIM SHIFF    00360000
      *     REMOVE REFERENCE TO LASER PRINTING FUNCTION                 00370000
W26603******************************************************************00380000
W26603* CHG ID   DATE        DESCRIPTION                               *00390000
W26603* ------   ----------  ----------------------------------------- *00400000
W26603* W26603   03-18-2004  STORE EXPANSION.  EXPANDED LRECL OF       *00410000
W26603*                      INP01 BECAUSE OF CHANGES TO MLRD102.      *00420000
W26603*                      EXPANDED WORKING STORAGE                  *00430000
W26603*                      VARIABLES.                                *00440000
W26603*                      ADDED 'WITH UR' TO DB2 SELECTS.           *00450000
W26603*                      AT THIS TIME THE REPORT FIELDS WILL NOT   *00460000
W26603*                      BE INCREASED.                              00470000
W26603*                      - RONNA MCDONALD                          *00480000
003100*                                                                 00480100
C14666* CRQ000000014666   07-10-2012     RAVIKUMAR GUNTHA              *00481003
C14666*                      CHANGES MADE TO SHOW SHORTAGE SHRINK      *00482000
C14666*                      PERCENTAGE WITH 2 POSITIONS TO THE RIGHT  *00483000
C14666*                      OF THE DECIMAL POINT AND TO SHIFT         *00484000
C14666*                      EVERYTHING IN THE REPORT AFTER 'SHK%' BY 1*00485000
C14666*                      POSITION.                                 *00486000
222725* CHG0222725        04-29-2019                                   *00487010
222725*                      CHANGES MADE TO PICK ONLY THE BUYER       *00488010
222725*                      CREATED  UNDER 'DPT' IN TMDSEAR TABLE     *00489010
      ******************************************************************00500000
003200 ENVIRONMENT DIVISION.                                            00510000
003300                                                                  00520000
003400                                                                  00530000
003500 CONFIGURATION SECTION.                                           00540000
003600                                                                  00550000
003700 SOURCE-COMPUTER.        IBM-3090.                                00560000
003800 OBJECT-COMPUTER.        IBM-3090.                                00570000
003900                                                                  00580000
004000                                                                  00590000
004100 INPUT-OUTPUT SECTION.                                            00600000
004200                                                                  00610000
004300 FILE-CONTROL.                                                    00620000
004400                                                                  00630000
004500     SELECT LEDGER-EXTRACT-FILE                                   00640000
004600         ASSIGN TO INP01.                                         00650000
004700                                                                  00660000
004800     SELECT LEDGER-EXTRACT-DATE-FILE                              00670000
004900         ASSIGN TO INP02.                                         00680000
005000                                                                  00690000
005100     SELECT LEDGER-REPORT-FILE                                    00700000
005200         ASSIGN RPT01.                                            00710000
005300                                                                  00720000
005400                                                                  00730000
005500                                                                  00740000
005600 DATA DIVISION.                                                   00750000
005700                                                                  00760000
005800                                                                  00770000
005900 FILE SECTION.                                                    00780000
006000                                                                  00790000
006100 FD  LEDGER-EXTRACT-FILE                                          00800000
006200     RECORDING MODE IS F                                          00810000
006300     LABEL RECORDS ARE STANDARD                                   00820000
006400     BLOCK CONTAINS 0 RECORDS.                                    00830000
006500                                                                  00840000
W26603*01  LEDGER-EXTRACT-RECORD            PIC  X(1106).               00850000
W26603 01  LEDGER-EXTRACT-RECORD            PIC  X(1288).               00860000
006700                                                                  00870000
006800 FD  LEDGER-EXTRACT-DATE-FILE                                     00880000
006900     RECORDING MODE IS F                                          00890000
007000     LABEL RECORDS ARE STANDARD                                   00900000
007100     BLOCK CONTAINS 0 RECORDS.                                    00910000
007200                                                                  00920000
007300 01  LEDGER-EXTRACT-DATE-RECORD       PIC X(80).                  00930000
007400                                                                  00940000
007500 FD  LEDGER-REPORT-FILE                                           00950000
007600     RECORDING MODE IS F                                          00960000
007700     LABEL RECORDS ARE STANDARD                                   00970000
007800     BLOCK CONTAINS 0 RECORDS.                                    00980000
007900                                                                  00990000
WR5701 01  LEDGER-REPORT-RECORD             PIC  X(175).                01000000
008100                                                                  01010000
008200                                                                  01020000
008300 WORKING-STORAGE SECTION.                                         01030000
008400                                                                  01040000
008500***************************************************************** 01050000
008600* RECORD LAYOUT FOR LEDGER EXTRACT FILE                           01060000
008700***************************************************************** 01070000
008800                                                                  01080000
008900     COPY MLRD102.                                                01090000
009000                                                                  01100000
009100*************************************************************     01110000
009200* RECORD LAYOUT FOR LEDGER EXTRACT DATE RECORD                    01120000
009300*************************************************************     01130000
009400                                                                  01140000
009500     COPY MLRD114.                                                01150000
009600                                                                  01160000
010300***************************************************************** 01170000
010400*    WORKING STORAGE AREA FOR ROUTINE TO FORMAT NAME              01180000
010500***************************************************************** 01190000
010600                                                                  01200000
010700     COPY DPWS024.                                                01210000
010800                                                                  01220000
010900******************************************************************01230000
011000*  VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        01240000
011100******************************************************************01250000
011200                                                                  01260000
011300     COPY DPWS004.                                                01270000
011400                                                                  01280000
011500 01  PC-PROGRAM-CONSTANTS.                                        01290000
011600     05  PC-COMPANY-TOTALS            PIC  X(22)    VALUE         01300000
011700                                      '*** COMPANY TOTALS ***'.   01310000
011800     05  PC-DIVISION-TOTALS           PIC  X(23)    VALUE         01320000
011900                                      '*** DIVISION TOTALS ***'.  01330000
012000     05  PC-MANAGER-TOTALS            PIC  X(22)    VALUE         01340000
012100                                      '*** MANAGER TOTALS ***'.   01350000
012200     05  PC-BUYER-TOTALS              PIC  X(20)    VALUE         01360000
012300                                      '*** BUYER TOTALS ***'.     01370000
012400     05  PC-DEPT-TOTALS               PIC  X(19)    VALUE         01380000
012500                                      '*** DEPT TOTALS ***'.      01390000
012400     05  PC-CLASS-TOTALS              PIC  X(20)    VALUE         01400000
012500                                      '*** CLASS TOTALS ***'.     01410000
012600                                                                  01420000
012700     05  PC-CLASS-LVL                 PIC S9(04)    COMP SYNC     01430000
012800                                                    VALUE +1.     01440000
012700     05  PC-DEPT-LVL                  PIC S9(04)    COMP SYNC     01450000
012800                                                    VALUE +2.     01460000
012900     05  PC-BYR-LVL                   PIC S9(04)    COMP SYNC     01470000
013000                                                    VALUE +3.     01480000
013100     05  PC-DMA-LVL                   PIC S9(04)    COMP SYNC     01490000
013200                                                    VALUE +4.     01500000
013300     05  PC-GMA-LVL                   PIC S9(04)    COMP SYNC     01510000
013400                                                    VALUE +5.     01520000
013500     05  PC-OPERCO-LVL                PIC S9(04)    COMP SYNC     01530000
013600                                                    VALUE +6.     01540000
013700                                                                  01550000
013800     05  PC-MDSELV-GMA                PIC  X(03)    VALUE 'GMA'.  01560000
013900     05  PC-MDSELV-DMA                PIC  X(03)    VALUE 'DMA'.  01570000
014000     05  PC-MDSELV-DPT                PIC  X(03)    VALUE 'DPT'.  01580000
014000     05  PC-MDSELV-MCL                PIC  X(03)    VALUE 'MCL'.  01590000
014100                                                                  01600000
014200     05  PC-RSPLVL-CDE-GMM            PIC  X(03)    VALUE 'GMM'.  01610000
014300     05  PC-RSPLVL-CDE-DMM            PIC  X(03)    VALUE 'DMM'.  01620000
014400     05  PC-RSPLVL-CDE-BYR            PIC  X(03)    VALUE 'BYR'.  01630000
014500                                                                  01640000
014600     05  PC-THOUSAND                  PIC S9(04)V99  COMP-3       01650000
014700                                                     VALUE +1000. 01660000
014800     05  PC-DEPT-NBR-000              PIC  X(03)     VALUE '000'. 01670000
014900     05  PC-OPERCO-NBR                PIC  X(02)     VALUE '03'.  01680000
015000     05  PC-APLSYS-CDE                PIC  X(02)     VALUE 'ML'.  01690000
015100     05  PC-MAX-RETRIES               PIC S9(4)      COMP SYNC    01700000
015200                                                     VALUE +2.    01710000
015300     05  PC-2-SPACES-LIT              PIC  X(02)     VALUE '  '.  01720000
015400     05  PC-PAREN-SPACE-LIT           PIC  X(02)     VALUE ') '.  01730000
015500                                                                  01740000
015600 01  PS-PROGRAM-SWITCHES.                                         01750000
015700     05  PS-END-OF-OPEN-FSCL-MN-SW    PIC X      VALUE 'N'.       01760000
015800         88  PS-END-OF-OPEN-FSCL-MN              VALUE 'Y'.       01770000
015900     05  PS-END-OF-FSCL-MN-NM-CSR-SW  PIC X      VALUE 'N'.       01780000
016000         88 PS-END-OF-FSCL-MN-NM-CSR             VALUE 'Y'.       01790000
016100     05  PS-END-OF-LEDGER-EXTRACT-SW  PIC X      VALUE 'N'.       01800000
016200         88 PS-END-OF-LEDGER-EXTRACT             VALUE 'Y'.       01810000
015900     05  PS-END-OF-LEDGER-DATE-FILE-SW PIC X     VALUE 'N'.       01820000
016000         88 PS-END-OF-LEDGER-DATE-FILE           VALUE 'Y'.       01830000
016300                                                                  01840000
016400     05  PS-BREAK-LEVEL-SW            PIC X      VALUE SPACE.     01850000
016500         88  PS-BREAK-LEVEL-SW-INIT              VALUE ' '.       01860000
016600         88  PS-BREAK-IS-OPERCO                  VALUE 'C'.       01870000
016700         88  PS-BREAK-IS-GMA                     VALUE 'G'.       01880000
016800         88  PS-BREAK-IS-DMA                     VALUE 'V'.       01890000
016900         88  PS-BREAK-IS-BYR                     VALUE 'B'.       01900000
017000         88  PS-BREAK-IS-DEPT                    VALUE 'D'.       01910000
017000         88  PS-BREAK-IS-MAJ-CLASS               VALUE 'M'.       01920000
017100                                                                  01930000
017200 01  PV-PROGRAM-VARIABLES.                                        01940000
017300     05  PV-OPEN-FSCL-MN-NBR          PIC  9(02).                 01950000
017400     05  PV-FSCL-MN-NBR               PIC  9(02).                 01960000
017500     05  PV-AMT-RNDED                 PIC S9(11)V9   COMP-3       01970000
017600                                                     VALUE ZERO.  01980000
C14666     05  PV-SHNK-PCT                  PIC S9(03)V99  COMP-3       01990001
C14666                                                     VALUE ZERO.  02000001
017700     05  PV-PCT                       PIC S9(04)V9   COMP-3       02001001
017800                                                     VALUE ZERO.  02002001
017900     05  PV-BEG-INV-COST-AMT          PIC S9(11)V99  COMP-3       02010000
018000                                                     VALUE ZERO.  02020000
018100     05  PV-BEG-INV-RTL-AMT           PIC S9(11)V99  COMP-3       02030000
018200                                                     VALUE ZERO.  02040000
018300     05  PV-DEPT-NBR                  PIC  X(03)     VALUE SPACE. 02050000
018300     05  PV-CLASS-NBR                 PIC  X(02)     VALUE SPACE. 02060000
018400     05  PV-GMA-NBR                   PIC  X(02)     VALUE SPACE. 02070000
018500     05  PV-DMA-NBR                   PIC  X(02)     VALUE SPACE. 02080000
018600     05  PV-BYR-NBR                   PIC  X(03)     VALUE SPACE. 02090000
018700     05  PV-MDSELV-CDE                PIC  X(03)     VALUE SPACE. 02100000
018800     05  PV-NAME-WITH-PARENS.                                     02110000
018900         10  PV-NAME-PAREN-1          PIC  X(02)     VALUE ' ('.  02120000
019000         10  PV-ENTIRE-NAME           PIC  X(20).                 02130000
019100         10  PV-NAME-PAREN-2          PIC  X(02)     VALUE SPACE. 02140000
019200     05  PV-DESC                      PIC  X(25)     VALUE SPACE. 02150000
019300     05  PV-NAME                      PIC  X(24)     VALUE SPACE. 02160000
019400     05  PV-PAGE-CNT                  PIC S9(05)     COMP-3       02170000
019500                                                     VALUE ZERO.  02180000
019600     05  PV-PARAGRAPH-NAME            PIC  X(30)     VALUE SPACE. 02190000
019700     05  PV-DB2-OPER-ATTEMPTED        PIC  X(30)     VALUE SPACE. 02200000
019800     05  PV-RETRY-COUNT               PIC S9(04)     COMP SYNC    02210000
019900                                                     VALUE ZERO.  02220000
020000     05  PV-ABEND-CODE                PIC S9(04)     COMP         02230000
020100                                                     VALUE ZERO.  02240000
020200                                                                  02250000
020300 01  SS-SUBSCRIPTS.                                               02260000
020400     05  SS-OPEN-MN                   PIC S9(04)     COMP SYNC    02270000
020500                                                     VALUE ZERO.  02280000
020600     05  SS-CURR-MN                   PIC S9(04)     COMP SYNC    02290000
020700                                                     VALUE ZERO.  02300000
020800     05  SS-SEASON                    PIC S9(04)     COMP SYNC    02310000
020900                                                     VALUE ZERO.  02320000
021000     05  SS-CURR-LVL                  PIC S9(04)     COMP SYNC    02330000
021100                                                     VALUE ZERO.  02340000
021200     05  SS-NEXT-LVL                  PIC S9(04)     COMP SYNC    02350000
021300                                                     VALUE ZERO.  02360000
021400                                                                  02370000
021500                                                                  02380000
021600 01  AT-ACCUMULATION-TABLE.                                       02390000
021700     05  AT-BUSINESS-LEVEL-TOTALS     OCCURS  6.                  02400000
W26603         10  AT-BEG-INV-COST-AMT      PIC S9(13)V99  COMP-3.      02410000
W26603         10  AT-BEG-INV-RTL-AMT       PIC S9(13)V99               02420000
022000                                                     COMP-3.      02430000
022100         10  AT-MONTH-TOTALS          OCCURS 12.                  02440000
W26603             15  AT-PRCH-NET-COST-AMT PIC S9(13)V99  COMP-3.      02450000
W26603             15  AT-PRCH-RTL-AMT      PIC S9(13)V99  COMP-3.      02460000
W26603             15  AT-RCPT-NET-COST-AMT PIC S9(13)V99  COMP-3.      02470000
W26603             15  AT-RCPT-RTL-AMT      PIC S9(13)V99  COMP-3.      02480000
W26603             15  AT-PADJ-NET-COST-AMT PIC S9(13)V99  COMP-3.      02490000
W26603             15  AT-PADJ-RTL-AMT      PIC S9(13)V99  COMP-3.      02500000
W26603             15  AT-SLS-RTL-AMT       PIC S9(13)V99  COMP-3.      02510000
W26603             15  AT-SHNK-RTL-AMT      PIC S9(13)V99  COMP-3.      02520000
W26603             15  AT-INV-ADJ-RTL-AMT   PIC S9(13)V99  COMP-3.      02530000
W26603             15  AT-MKDN-RTL-AMT      PIC S9(13)V99  COMP-3.      02540000
W26603             15  AT-END-INV-COST-AMT  PIC S9(13)V99  COMP-3.      02550000
W26603             15  AT-END-INV-RTL-AMT   PIC S9(13)V99  COMP-3.      02560000
W26603             15  AT-SLS-COST-AMT      PIC S9(13)V99  COMP-3.      02570000
W26603             15  AT-GRO-MRGN-AMT      PIC S9(13)V99  COMP-3.      02580000
023200                                                                  02590000
023300         10  AT-SEASON-TOTALS         OCCURS  2.                  02600000
023400             15  AT-SEAS-PRCH-NET-COST-AMT                        02610000
W26603                                      PIC S9(13)V99  COMP-3.      02620000
W26603             15  AT-SEAS-PRCH-RTL-AMT PIC S9(13)V99  COMP-3.      02630000
WR5701             15  AT-SEAS-RCPT-NET-COST-AMT                        02640000
W26603                                      PIC S9(13)V99  COMP-3.      02650000
W26603             15  AT-SEAS-RCPT-RTL-AMT PIC S9(13)V99  COMP-3.      02660000
WR5701             15  AT-SEAS-PADJ-NET-COST-AMT                        02670000
W26603                                      PIC S9(13)V99  COMP-3.      02680000
W26603             15  AT-SEAS-PADJ-RTL-AMT PIC S9(13)V99  COMP-3.      02690000
023700             15  AT-SEAS-SLS-RTL-AMT  PIC S9(12)V99  COMP-3.      02700000
023800             15  AT-SEAS-SHNK-RTL-AMT PIC S9(10)V99  COMP-3.      02710000
W26603             15  AT-SEAS-MKDN-RTL-AMT PIC S9(13)V99  COMP-3.      02720000
W26603             15  AT-SEAS-SLS-COST-AMT PIC S9(13)V99  COMP-3.      02730000
W26603             15  AT-SEAS-GRO-MRGN-AMT PIC S9(13)V99  COMP-3.      02740000
024200                                                                  02750000
024300 01  YTD-YEAR-TO-DATE-TOTALS.                                     02760000
W26603     05  YTD-SLS-RTL-AMT              PIC S9(13)V99  COMP-3       02770000
024500                                                     VALUE ZERO.  02780000
W26603     05  YTD-SHNK-RTL-AMT             PIC S9(13)V99  COMP-3       02790000
024700                                                     VALUE ZERO.  02800000
W26603     05  YTD-MKDN-RTL-AMT             PIC S9(13)V99  COMP-3       02810000
024900                                                     VALUE ZERO.  02820000
W26603     05  YTD-SLS-COST-AMT             PIC S9(13)V99  COMP-3       02830000
025100                                                     VALUE ZERO.  02840000
W26603     05  YTD-GRO-MRGN-AMT             PIC S9(13)V99  COMP-3       02850000
025300                                                     VALUE ZERO.  02860000
W26603     05  YTD-PRCH-NET-COST-AMT        PIC S9(13)V99  COMP-3       02870000
025500                                                     VALUE ZERO.  02880000
W26603     05  YTD-PRCH-RTL-AMT             PIC S9(13)V99  COMP-3       02890000
025700                                                     VALUE ZERO.  02900000
W26603     05  YTD-RCPT-NET-COST-AMT        PIC S9(13)V99  COMP-3       02910000
WR5701                                                     VALUE ZERO.  02920000
W26603     05  YTD-RCPT-RTL-AMT             PIC S9(13)V99  COMP-3       02930000
WR5701                                                     VALUE ZERO.  02940000
W26603     05  YTD-PADJ-NET-COST-AMT        PIC S9(13)V99  COMP-3       02950000
WR5701                                                     VALUE ZERO.  02960000
W26603     05  YTD-PADJ-RTL-AMT             PIC S9(13)V99  COMP-3       02970000
WR5701                                                     VALUE ZERO.  02980000
025800                                                                  02990000
025900 01  MT-MONTH-NAME-TABLE.                                         03000000
026000     05  MT-FSCL-MN-NM-ENTRY          OCCURS 12.                  03010000
026100         10  MT-FSCL-MN-NM.                                       03020000
026200             15  MT-FSCL-MN-NM-ABBREV PIC  X(03)     VALUE SPACE. 03030000
026300             15  FILLER               PIC  X(06)     VALUE SPACE. 03040000
026400                                                                  03050000
026500 01  HN-HOLD-NUMBERS.                                             03060000
026600     05  HN-GMA-NBR                   PIC  X(02)     VALUE ZERO.  03070000
026700     05  HN-DMA-NBR                   PIC  X(02)     VALUE ZERO.  03080000
026800     05  HN-BYR-NBR                   PIC  X(03)     VALUE ZERO.  03090000
026900     05  HN-DEPT-NBR                  PIC  X(03)     VALUE ZERO.  03100000
026900     05  HN-CLASS-NBR                 PIC  X(02)     VALUE ZERO.  03110000
027000                                                                  03120000
027100*01  LC-LASER-CONTROL-SWITCHES.                                   03130000
027200*    05  LC-LASER-CONTROL-FF.                                     03140000
027300*        10  FILLER                   PIC S9(04)     COMP         03150000
027400*                                                    VALUE -1.    03160000
027500*    05  LC-LASER-CONTROL-FD.                                     03170000
027600*        10  FILLER                   PIC S9(04)     COMP         03180000
027700*                                                    VALUE -513.  03190000
027800*        10  FILLER                   PIC  X(79)     VALUE SPACE. 03200000
027900*    05  LC-LASER-BREAK-SW            PIC  X         VALUE 'N'.   03210000
028000*        88  LC-LASER-BREAK                          VALUE 'Y'.   03220000
028100                                                                  03230000
028200 01  TD-TODAYS-DATE.                                              03240000
028300     05  TD-YEAR                      PIC  9(02)     VALUE ZERO.  03250000
028400     05  TD-MONTH                     PIC  9(02)     VALUE ZERO.  03260000
028500     05  TD-DAY                       PIC  9(02)     VALUE ZERO.  03270000
028600                                                                  03280000
028700 01  TT-TODAYS-TIME.                                              03290000
028800     05  TT-HOUR                      PIC  9(02)     VALUE ZERO.  03300000
028900     05  TT-MINUTE                    PIC  9(02)     VALUE ZERO.  03310000
029000     05  FILLER                       PIC  9(04)     VALUE ZERO.  03320000
029100                                                                  03330000
WR5701 01  DP175O-STANDRD-HEADER-175-COLS.                              03340000
00002      05  DP175O-LASER-NEW-PAGE-INDICATR    PIC X(02) VALUE SPACE. 03350000
00003      05  DP175O-RUN-DATE.                                         03360000
00004          10  DP175O-RUN-MONTH              PIC 9(02) VALUE ZERO.  03370000
00005          10  FILLER                        PIC X(01) VALUE '/'.   03380000
00006          10  DP175O-RUN-DAY                PIC 9(02) VALUE ZERO.  03390000
00007          10  FILLER                        PIC X(01) VALUE '/'.   03400000
00008          10  DP175O-RUN-YEAR               PIC 9(02) VALUE ZERO.  03410000
00009      05  FILLER                            PIC X(02) VALUE SPACE. 03420000
00010      05  DP175O-RUN-TIME.                                         03430000
00011          10  DP175O-RUN-HOUR               PIC 9(02) VALUE ZERO.  03440000
00012          10  FILLER                        PIC X(01) VALUE ':'.   03450000
00013          10  DP175O-RUN-MINUTE             PIC 9(02) VALUE ZERO.  03460000
00014      05  FILLER                            PIC X(47) VALUE SPACE. 03470000
00015      05  FILLER                            PIC X(45)              03480000
00016          VALUE 'K O H L S   D E P A R T M E N T   S T O R E S'.   03490000
00017      05  FILLER                            PIC X(42) VALUE SPACE. 03500000
00018      05  DP175O-PROGRAM-NAME               PIC X(08) VALUE SPACE. 03510000
00019      05  FILLER                            PIC X(01) VALUE '-'.   03520000
00020      05  DP175O-REPORT-NUMBER              PIC 9(01) VALUE ZERO.  03530000
00021      05  FILLER                            PIC X(02) VALUE SPACE. 03540000
00022      05  FILLER                            PIC X(05) VALUE 'PAGE'.03550000
00023      05  DP175O-PAGE-NUMBER                PIC ZZZZ9 VALUE ZERO.  03560000
00024                                                                   03570000
029200 01  PH2-PAGE-HEADING-2.                                          03580000
WR5701     05  FILLER                       PIC X(62) VALUE SPACE.      03590000
029400     05  FILLER                       PIC X(08) VALUE             03600000
029500                                                   'MONTHLY '.    03610000
029600     05  FILLER                       PIC X(12) VALUE             03620000
029700                                                   'MERCHANDISE '.03630000
029800     05  FILLER                       PIC X(07) VALUE             03640000
029900                                                   'LEDGER '.     03650000
030000     05  FILLER                       PIC X(11) VALUE             03660000
030100                                                   'FOR FISCAL '. 03670000
030200     05  PH2-FSCL-MN-NM               PIC X(09) VALUE SPACE.      03680000
030300     05  FILLER                       PIC X(01) VALUE SPACE.      03690000
030400     05  PH2-FSCL-YR-NBR              PIC X(04) VALUE SPACE.      03700000
WR5701     05  FILLER                       PIC X(61) VALUE SPACE.      03710000
030600                                                                  03720000
030700 01  PH3-PAGE-HEADING-3.                                          03730000
WR5701     05  FILLER                       PIC X(73) VALUE SPACES.     03740000
030800     05  FILLER                       PIC X(07) VALUE '(CLASS '.  03750000
030800     05  FILLER                       PIC X(06) VALUE 'LEVEL '.   03760000
030800     05  FILLER                       PIC X(09) VALUE 'TOTALS - '.03770000
030900     05  FILLER                       PIC X(04) VALUE '$000'.     03780000
031000     05  FILLER                       PIC X(01) VALUE QUOTE.      03790000
031100     05  FILLER                       PIC X(02) VALUE 'S)'.       03800000
031200     05  FILLER                       PIC X(73) VALUE SPACE.      03810000
031300                                                                  03820000
031400 01  CH-COMPANY-HEADING.                                          03830000
031500     05  FILLER                       PIC X(24) VALUE             03840000
031600                              ' KOHLS DEPARTMENT STORES'.         03850000
WR5701     05  FILLER                       PIC X(151) VALUE SPACES.    03860000
031800                                                                  03870000
031900 01  GH-GMA-HEADING.                                              03880000
032000     05  FILLER                       PIC X(06) VALUE '  GMM:'.   03890000
032100     05  FILLER                       PIC X(02) VALUE SPACE.      03900000
032200     05  GH-GMA-NBR                   PIC X(02) VALUE SPACE.      03910000
032300     05  FILLER                       PIC X(01) VALUE '-'.        03920000
032400     05  GH-GMA-DESC-GMM-NAME         PIC X(50) VALUE SPACE.      03930000
WR5701     05  FILLER                       PIC X(89) VALUE SPACE.      03940000
032600                                                                  03950000
032700 01  DH-DMA-HEADING.                                              03960000
032800     05  FILLER                       PIC X(06) VALUE '  DMM:'.   03970000
032900     05  FILLER                       PIC X(02) VALUE SPACE.      03980000
033000     05  DH-DMA-NBR                   PIC X(02) VALUE SPACE.      03990000
033100     05  FILLER                       PIC X(01) VALUE '-'.        04000000
033200     05  DH-DMA-DESC-DMM-NAME         PIC X(50) VALUE SPACE.      04010000
WR5701     05  FILLER                       PIC X(89) VALUE SPACE.      04020000
033400                                                                  04030000
033500 01  BH-BUYER-HEADING.                                            04040000
033600     05  FILLER                       PIC X(06) VALUE 'BUYER:'.   04050000
WR5701     05  FILLER                       PIC X(01) VALUE SPACE.      04060000
WR5701     05  BH-BYR-NBR                   PIC X(03) VALUE SPACE.      04070000
033900     05  FILLER                       PIC X(01) VALUE '-'.        04080000
034000     05  BH-BYR-NAME                  PIC X(31) VALUE SPACE.      04090000
WR5701     05  FILLER                       PIC X(108) VALUE SPACE.     04100000
034200                                                                  04110000
034300 01  DH-DEPT-HEADING.                                             04120000
034400     05  FILLER                       PIC X(06) VALUE ' DEPT:'.   04130000
034500     05  FILLER                       PIC X(01) VALUE SPACE.      04140000
034600     05  DH-DEPT-NBR                  PIC 9(03) VALUE ZERO.       04150000
034700     05  FILLER                       PIC X(01) VALUE '-'.        04160000
034800     05  DH-DEPT-NAME                 PIC X(20) VALUE SPACE.      04170000
WR5701     05  FILLER                       PIC X(116) VALUE SPACE.     04180000
035000                                                                  04190000
034300 01  DH-CLASS-HEADING.                                            04200000
034400     05  FILLER                       PIC X(06) VALUE 'CLASS:'.   04210000
034500     05  FILLER                       PIC X(01) VALUE SPACE.      04220000
034600     05  DH-CLASS-NBR                 PIC 9(03) VALUE ZERO.       04230000
034700     05  FILLER                       PIC X(01) VALUE '-'.        04240000
034800     05  DH-CLASS-NAME                PIC X(20) VALUE SPACE.      04250000
WR5701     05  FILLER                       PIC X(144) VALUE SPACE.     04260000
035000                                                                  04270000
035100 01  DH1-DETAIL-HEADING-1.                                        04280000
035200     05  FILLER                       PIC X(04) VALUE SPACE.      04290000
034700     05  FILLER                       PIC X(09) VALUE             04300000
034800                                                     '<------- '. 04310000
034900     05  FILLER                       PIC X(09) VALUE             04320000
035000                                                    'RECEIPTS '.  04330000
035100     05  FILLER                       PIC X(08) VALUE             04340000
035200                                                     '------> '.  04350000
034700     05  FILLER                       PIC X(07) VALUE             04360000
034800                                                     '<----- '.   04370000
034900     05  FILLER                       PIC X(09) VALUE             04380000
035000                                                    'PURCHASE '.  04390000
034900     05  FILLER                       PIC X(04) VALUE             04400000
035000                                                    'ADJ '.       04410000
035100     05  FILLER                       PIC X(07) VALUE             04420000
035200                                                     '-----> '.   04430000
035100     05  FILLER                       PIC X(06) VALUE SPACES.     04440000
036000     05  FILLER                       PIC X(15) VALUE             04450000
036100                                                '<--------------'.04460000
036200     05  FILLER                       PIC X(19) VALUE             04470000
036300                                            ' RETAIL REDUCTIONS '.04480000
C14666     05  FILLER                       PIC X(16) VALUE             04490001
C14666                                               '--------------->'.04500001
036600     05  FILLER                       PIC X(01) VALUE SPACE.      04510000
036700     05  FILLER                       PIC X(03) VALUE '<--'.      04520000
036800     05  FILLER                       PIC X(18) VALUE             04530000
036900                                             ' ENDING INVENTORY '.04540000
037000     05  FILLER                       PIC X(04) VALUE '--->'.     04550000
037100     05  FILLER                       PIC X(03) VALUE SPACE.      04560000
037200     05  FILLER                       PIC X(07) VALUE 'COST OF'.  04570000
037300     05  FILLER                       PIC X(08) VALUE SPACE.      04580000
037400                                                                  04590000
036900 01  DH2-DETAIL-HEADING-2.                                        04600000
WR5701     05  FILLER                       PIC X(04) VALUE 'MNTH'.     04610000
WR5701     05  FILLER                       PIC X(04) VALUE SPACE.      04620000
WR5701     05  FILLER                       PIC X(04) VALUE 'COST'.     04630000
WR5701     05  FILLER                       PIC X(07) VALUE SPACE.      04640000
WR5701     05  FILLER                       PIC X(06) VALUE 'RETAIL'.   04650000
WR5701     05  FILLER                       PIC X(09) VALUE SPACE.      04660000
WR5701     05  FILLER                       PIC X(04) VALUE 'COST'.     04670000
WR5701     05  FILLER                       PIC X(08) VALUE SPACE.      04680000
WR5701     05  FILLER                       PIC X(06) VALUE 'RETAIL'.   04690000
WR5701     05  FILLER                       PIC X(04) VALUE SPACE.      04700000
WR5701     05  FILLER                       PIC X(05) VALUE 'MKON%'.    04710000
WR5701     05  FILLER                       PIC X(06) VALUE SPACE.      04720000
037700     05  FILLER                       PIC X(05) VALUE 'SALES'.    04730000
037800     05  FILLER                       PIC X(05) VALUE SPACE.      04740000
037900     05  FILLER                       PIC X(09) VALUE 'SHRINKAGE'.04750000
038000     05  FILLER                       PIC X(02) VALUE SPACE.      04760000
C14666     05  FILLER                       PIC X(05) VALUE 'SHK% '.    04770001
038200     05  FILLER                       PIC X(03) VALUE SPACE.      04780000
038300     05  FILLER                       PIC X(09) VALUE 'MARKDOWNS'.04790000
038400     05  FILLER                       PIC X(03) VALUE SPACE.      04800000
038500     05  FILLER                       PIC X(05) VALUE 'MKDN%'.    04810000
038600     05  FILLER                       PIC X(05) VALUE SPACE.      04820000
038700     05  FILLER                       PIC X(04) VALUE 'COST'.     04830000
038800     05  FILLER                       PIC X(08) VALUE SPACE.      04840000
038900     05  FILLER                       PIC X(06) VALUE 'RETAIL'.   04850000
039000     05  FILLER                       PIC X(07) VALUE SPACE.      04860000
039100     05  FILLER                       PIC X(05) VALUE 'SALES'.    04870000
039200     05  FILLER                       PIC X(08) VALUE SPACE.      04880000
039300     05  FILLER                       PIC X(07) VALUE 'GM DLRS'.  04890000
039400     05  FILLER                       PIC X(05) VALUE SPACE.      04900000
039500     05  FILLER                       PIC X(03) VALUE 'GM%'.      04910000
039600     05  FILLER                       PIC X(01) VALUE SPACE.      04920000
040300                                                                  04930000
040400 01  DL-DETAIL-LINE.                                              04940000
040500     05  DL-MONTH-ABBREV              PIC X(03) VALUE SPACES.     04950000
040600     05  FILLER                       PIC X(01) VALUE SPACES.     04960000
WR5701     05  DL-RECEIPTS-COST             PIC ZZ,ZZZ,ZZZ.Z-           04970000
WR5701                                                VALUE ZEROES.     04980000
WR5701     05  DL-RECEIPTS-RETAIL           PIC ZZ,ZZZ,ZZZ.Z-           04990000
WR5701                                                VALUE ZEROES.     05000000
WR5701     05  DL-PURCHASE-ADJ-COST         PIC ZZ,ZZZ,ZZZ.Z-           05010000
WR5701                                                VALUE ZEROES.     05020000
WR5701     05  DL-PURCHASE-ADJ-RETAIL       PIC ZZ,ZZZ,ZZZ.Z-           05030000
WR5701                                                VALUE ZEROES.     05040000
041100     05  DL-MKON-PCT                  PIC ZZ9.9-                  05050000
041200                                                VALUE ZEROES.     05060000
041300     05  DL-SALES                     PIC ZZ,ZZZ,ZZZ.Z-           05070000
041400                                                VALUE ZEROES.     05080000
041500     05  DL-SHRINKAGE                 PIC Z,ZZZ,ZZZ.Z-            05090000
041600                                                VALUE ZEROES.     05100000
C14666     05  DL-SHNK-PCT                  PIC ZZ9.99-                 05110001
041800                                                VALUE ZEROES.     05120000
041900     05  DL-MARKDOWNS                 PIC ZZ,ZZZ,ZZZ.Z-           05130000
042000                                                VALUE ZEROES.     05140000
042100     05  DL-MKDN-PCT                  PIC ZZ9.9-                  05150000
042200                                                VALUE ZEROES.     05160000
042300     05  DL-END-INV-COST              PIC ZZ,ZZZ,ZZZ.Z-           05170000
042400                                                VALUE ZEROES.     05180000
042500     05  DL-END-INV-RETAIL            PIC ZZ,ZZZ,ZZZ.Z-           05190000
042600                                                VALUE ZEROES.     05200000
042700     05  DL-COST-OF-SALES             PIC ZZ,ZZZ,ZZZ.Z-           05210000
042800                                                VALUE ZEROES.     05220000
042900     05  DL-GM-DLRS                   PIC ZZ,ZZZ,ZZZ.Z-           05230000
043000                                                VALUE ZEROES.     05240000
043100     05  FILLER                       PIC X(01) VALUE SPACES.     05250000
043200     05  DL-GM-PCT                    PIC ZZ9.9-                  05260000
043300                                                VALUE ZEROES.     05270000
043400                                                                  05280000
043400                                                                  05290000
043500 01  UL-UNDER-LINE.                                               05300000
043600     05  FILLER                       PIC X(05) VALUE SPACES.     05310000
043700     05  FILLER                       PIC X(12) VALUE             05320000
043800     '------------'.                                              05330000
043900     05  FILLER                       PIC X(01) VALUE SPACES.     05340000
044000     05  FILLER                       PIC X(12) VALUE             05350000
044100     '------------'.                                              05360000
043300     05  FILLER                       PIC X(01) VALUE SPACES.     05370000
043400     05  FILLER                       PIC X(12) VALUE             05380000
044400     '------------'.                                              05390000
044500     05  FILLER                       PIC X(01) VALUE SPACES.     05400000
044500     05  FILLER                       PIC X(12) VALUE             05410000
044600     '------------'.                                              05420000
044200     05  FILLER                       PIC X(01) VALUE SPACES.     05430000
044300     05  FILLER                       PIC X(05) VALUE             05440000
044400     '-----'.                                                     05450000
044500     05  FILLER                       PIC X(01) VALUE SPACES.     05460000
044600     05  FILLER                       PIC X(12) VALUE             05470000
044700     '------------'.                                              05480000
044800     05  FILLER                       PIC X(01) VALUE SPACES.     05490000
044900     05  FILLER                       PIC X(11) VALUE             05500000
045000     '-----------'.                                               05510000
045100     05  FILLER                       PIC X(01) VALUE SPACES.     05520000
C14666     05  FILLER                       PIC X(06) VALUE             05530001
C14666     '------'.                                                    05540001
045400     05  FILLER                       PIC X(01) VALUE SPACES.     05550000
045500     05  FILLER                       PIC X(12) VALUE             05560000
045600     '------------'.                                              05570000
045700     05  FILLER                       PIC X(01) VALUE SPACES.     05580000
045800     05  FILLER                       PIC X(05) VALUE             05590000
045900     '-----'.                                                     05600000
046000     05  FILLER                       PIC X(01) VALUE SPACES.     05610000
046100     05  FILLER                       PIC X(12) VALUE             05620000
046200     '------------'.                                              05630000
046300     05  FILLER                       PIC X(01) VALUE SPACES.     05640000
046400     05  FILLER                       PIC X(12) VALUE             05650000
046500     '------------'.                                              05660000
046600     05  FILLER                       PIC X(01) VALUE SPACES.     05670000
046700     05  FILLER                       PIC X(12) VALUE             05680000
046800     '------------'.                                              05690000
046900     05  FILLER                       PIC X(01) VALUE SPACES.     05700000
047000     05  FILLER                       PIC X(12) VALUE             05710000
047100     '------------'.                                              05720000
047200     05  FILLER                       PIC X(02) VALUE SPACES.     05730000
047300     05  FILLER                       PIC X(05) VALUE             05740000
047400     '-----'.                                                     05750000
047500                                                                  05760000
047600                                                                  05770000
047700****************************************************************  05780000
047800* DATE ATTRIBUTE TABLE                                            05790000
047900****************************************************************  05800000
048000                                                                  05810000
048100     EXEC SQL                                                     05820000
048200         INCLUDE TDTATTR                                          05830000
048300     END-EXEC.                                                    05840000
048400                                                                  05850000
048400                                                                  05860000
048500******************************************************************05870000
048600*  MERCHANDISE AREA TABLE (TMDSEAR)                               05880000
048700******************************************************************05890000
048800                                                                  05900000
048900     EXEC SQL                                                     05910000
049000         INCLUDE TMDSEAR                                          05920000
049100     END-EXEC.                                                    05930000
049200                                                                  05940000
049300******************************************************************05950000
049400*  APPLICATION AVAILABILITY TABLE (TAPLAVL)                       05960000
049500******************************************************************05970000
049600                                                                  05980000
049700     EXEC SQL                                                     05990000
049800         INCLUDE TAPLAVL                                          06000000
049900     END-EXEC.                                                    06010000
050000                                                                  06020000
050100******************************************************************06030000
050200*  RESPONSIBILITY AREA TABLE (TRSPBAR)                           *06040000
050300******************************************************************06050000
050400                                                                  06060000
050500     EXEC SQL                                                     06070000
050600         INCLUDE TRSPBAR                                          06080000
050700     END-EXEC.                                                    06090000
050800                                                                  06100000
050900                                                                  06110000
051000******************************************************************06120000
051100*    DB2 COMMUNICATION AREA                                       06130000
051200******************************************************************06140000
051300                                                                  06150000
051400     EXEC SQL                                                     06160000
051500         INCLUDE SQLCA                                            06170000
051600     END-EXEC.                                                    06180000
051601                                                                  06190000
051602****************************************************************  06200000
051603*  DATE TABLE CURSOR                                              06210000
051604****************************************************************  06220000
051605                                                                  06230000
051606     EXEC SQL                                                     06240000
051607         DECLARE FSCL-MN-NM-CSR CURSOR FOR                        06250000
059106             SELECT DISTINCT                                      06260000
059109                  FSCL_MN_NBR                                     06270000
059110                 ,FSCL_MN_NM                                      06280000
059120             FROM                                                 06290000
059130                  TDTATTR                                         06300000
059140             WHERE KY_DTE BETWEEN :DTATTR-FSCL-YR-BEG-DTE         06310000
052400                              AND :ML114-EXTRACT-DTE              06320000
W26603             WITH UR                                              06330000
059151     END-EXEC.                                                    06340000
059152                                                                  06350000
059153                                                                  06360000
059154                                                                  06370000
059155 LINKAGE SECTION.                                                 06380000
059156                                                                  06390000
059157                                                                  06400000
059158                                                                  06410000
059159 PROCEDURE DIVISION.                                              06420000
059160                                                                  06430000
059170                                                                  06440000
059180 1000-MAIN-MODULE.                                                06450000
059190                                                                  06460000
059200     OPEN INPUT  LEDGER-EXTRACT-FILE                              06470000
059200                 LEDGER-EXTRACT-DATE-FILE                         06480000
059400          OUTPUT LEDGER-REPORT-FILE.                              06490000
059500                                                                  06500000
059600     PERFORM 1150-INIT.                                           06510000
059700                                                                  06520000
059800     PERFORM 7000-READ-LEDGER-EXTRACT.                            06530000
059900                                                                  06540000
060000     PERFORM 2000-PROCESS-EXTRACT                                 06550000
060100         UNTIL PS-END-OF-LEDGER-EXTRACT.                          06560000
060200                                                                  06570000
060300     SET PS-BREAK-IS-OPERCO TO TRUE.                              06580000
060400*    MOVE 'Y' TO LC-LASER-BREAK-SW.                               06590000
060500                                                                  06600000
060600     PERFORM 2600-PROCESS-BREAKS.                                 06610000
060700                                                                  06620000
060800     CLOSE LEDGER-EXTRACT-FILE                                    06630000
060800           LEDGER-EXTRACT-DATE-FILE                               06640000
061000           LEDGER-REPORT-FILE.                                    06650000
061100                                                                  06660000
061200     STOP RUN.                                                    06670000
061300                                                                  06680000
061400                                                                  06690000
061500 1150-INIT.                                                       06700000
061600                                                                  06710000
           PERFORM 7100-READ-LEDGER-EXTRACT-DATE.                       06720000
061700*    GET THE OPEN FISCAL MONTH INFORMATION.                       06730000
056500     IF PS-END-OF-LEDGER-DATE-FILE                                06740000
056600         DISPLAY '** ABEND **'                                    06750000
056700         DISPLAY '** PROGRAM MLKRP201 **'                         06760000
056800         DISPLAY '** PARAGRAPH 1150-INIT'                         06770000
056900         DISPLAY '** LEDGER EXTRACT DATE FILE IS EMPTY.'          06780000
057000         MOVE +4003 TO PV-ABEND-CODE                              06790000
057100         PERFORM 9999-ABEND                                       06800000
057200     END-IF.                                                      06810000
057300                                                                  06820000
057400     MOVE ML114-EXTRACT-MN-NBR       TO SS-OPEN-MN.               06830000
057500     MOVE ML114-EXTRACT-DTE          TO DTATTR-KY-DTE.            06840000
063600*                                                                 06850000
063700     PERFORM 8000-GET-DATE-ATTRIBUTES.                            06860000
063800                                                                  06870000
063900     MOVE DTATTR-FSCL-YR-NBR         TO PH2-FSCL-YR-NBR.          06880000
064000     MOVE DTATTR-FSCL-MN-NM          TO PH2-FSCL-MN-NM.           06890000
064100                                                                  06900000
064200*    TABLE THE MONTH NAMES OF THE MONTHS IN THE OPEN FISCAL       06910000
064300*    YEAR.                                                        06920000
064400                                                                  06930000
064500     PERFORM 8500-OPEN-FSCL-MN-NM-CSR.                            06940000
064600                                                                  06950000
064700     PERFORM 8600-FETCH-FSCL-MN-NM-CSR.                           06960000
064800                                                                  06970000
064801     PERFORM UNTIL PS-END-OF-FSCL-MN-NM-CSR                       06980000
064802         MOVE DTATTR-FSCL-MN-NBR TO PV-FSCL-MN-NBR                06990000
064803         MOVE PV-FSCL-MN-NBR     TO SS-CURR-MN                    07000000
064804         MOVE DTATTR-FSCL-MN-NM  TO MT-FSCL-MN-NM (SS-CURR-MN)    07010000
064805         PERFORM 8600-FETCH-FSCL-MN-NM-CSR                        07020000
064806     END-PERFORM.                                                 07030000
064807                                                                  07040000
064808     PERFORM 8700-CLOSE-FSCL-MN-NM-CSR.                           07050000
064809                                                                  07060000
064810*    BUILD STANDARD REPORT HEADING.                               07070000
064820                                                                  07080000
064830     ACCEPT TD-TODAYS-DATE FROM DATE.                             07090000
WR5701     MOVE TD-YEAR    TO DP175O-RUN-YEAR.                          07100000
WR5701     MOVE TD-MONTH   TO DP175O-RUN-MONTH.                         07110000
WR5701     MOVE TD-DAY     TO DP175O-RUN-DAY.                           07120000
064870                                                                  07130000
064880     ACCEPT TT-TODAYS-TIME FROM TIME.                             07140000
WR5701     MOVE TT-HOUR    TO DP175O-RUN-HOUR.                          07150000
WR5701     MOVE TT-MINUTE  TO DP175O-RUN-MINUTE.                        07160000
065000                                                                  07170000
WR5701     MOVE 'MLKRP201' TO DP175O-PROGRAM-NAME.                      07180000
WR5701     MOVE 1          TO DP175O-REPORT-NUMBER.                     07190000
065300                                                                  07200000
065400     INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-OPERCO-LVL).         07210000
065500                                                                  07220000
065600     MOVE +20        TO DP024-FLNAME-LENGTH.                      07230000
065700                                                                  07240000
065800                                                                  07250000
065900 2000-PROCESS-EXTRACT.                                            07260000
066000                                                                  07270000
066100******************************************************************07280000
066200*    PROCESS ALL GMAS IN THE COMPANY.  WHEN A NEW GMA IS          07290000
066300*    ENCOUNTERED, PRINT THE INFO FOR THE PREVIOUS GMA.            07300000
066400******************************************************************07310000
066500                                                                  07320000
066600     MOVE ML102-GMA-NBR TO HN-GMA-NBR.                            07330000
066700     INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-GMA-LVL).            07340000
066800                                                                  07350000
066900     PERFORM 2100-PROCESS-GMA                                     07360000
067000         UNTIL (ML102-GMA-NBR NOT = HN-GMA-NBR)                   07370000
067100            OR (PS-END-OF-LEDGER-EXTRACT).                        07380000
067200                                                                  07390000
067300     SET PS-BREAK-IS-GMA TO TRUE.                                 07400000
067400                                                                  07410000
067500     PERFORM 2600-PROCESS-BREAKS.                                 07420000
067600*    MOVE 'Y' TO LC-LASER-BREAK-SW.                               07430000
067700                                                                  07440000
067800                                                                  07450000
067900 2100-PROCESS-GMA.                                                07460000
068000                                                                  07470000
068100******************************************************************07480000
068200*    PROCESS ALL DMAS WITHIN THIS GMA.  WHEN A NEW GMA OR DMA IS  07490000
068300*    ENCOUNTERED, PRINT THE INFO FOR THE PREVIOUS DMA.            07500000
068400******************************************************************07510000
068500                                                                  07520000
068600     MOVE ML102-DMA-NBR   TO HN-DMA-NBR.                          07530000
068700     INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-DMA-LVL).            07540000
068800                                                                  07550000
068900     PERFORM 2200-PROCESS-DMA                                     07560000
069000         UNTIL (ML102-GMA-NBR NOT = HN-GMA-NBR)                   07570000
069100            OR (ML102-DMA-NBR NOT = HN-DMA-NBR)                   07580000
069200            OR  PS-END-OF-LEDGER-EXTRACT.                         07590000
069300                                                                  07600000
069400     SET PS-BREAK-IS-DMA TO TRUE.                                 07610000
069500                                                                  07620000
069600     PERFORM 2600-PROCESS-BREAKS.                                 07630000
069700*    MOVE 'Y' TO LC-LASER-BREAK-SW.                               07640000
069800                                                                  07650000
069900                                                                  07660000
070000 2200-PROCESS-DMA.                                                07670000
070100                                                                  07680000
070200******************************************************************07690000
070300*    PROCESS ALL BYRS WITHIN THIS DMA.  WHEN A NEW GMA, DMA, OR   07700000
070400*    BYR IS ENCOUNTERED, PRINT THE INFO FOR THE PREVIOUS BYR.     07710000
070500******************************************************************07720000
070600                                                                  07730000
070700     MOVE ML102-BYR-NBR TO HN-BYR-NBR.                            07740000
070800     INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-BYR-LVL).            07750000
070900                                                                  07760000
071000     PERFORM 2300-PROCESS-BYR                                     07770000
071100         UNTIL (ML102-GMA-NBR NOT = HN-GMA-NBR)                   07780000
071200            OR (ML102-DMA-NBR NOT = HN-DMA-NBR)                   07790000
071300            OR (ML102-BYR-NBR NOT = HN-BYR-NBR)                   07800000
071400            OR (PS-END-OF-LEDGER-EXTRACT).                        07810000
071500                                                                  07820000
071600     SET PS-BREAK-IS-BYR TO TRUE.                                 07830000
071700                                                                  07840000
071800     PERFORM 2600-PROCESS-BREAKS.                                 07850000
071900*    MOVE 'Y' TO LC-LASER-BREAK-SW.                               07860000
072000                                                                  07870000
072100                                                                  07880000
072200 2300-PROCESS-BYR.                                                07890000
072300                                                                  07900000
072400******************************************************************07910000
072500*    PROCESS ALL DEPTS WITHIN THIS BYR.  WHEN A NEW GMA, DMA,     07920000
072600*    BYR, OR DEPT IS ENCOUNTERED, PRINT THE INFO FOR THE          07930000
072700*    PREVIOUS DEPT.                                               07940000
072800******************************************************************07950000
072900                                                                  07960000
073000     MOVE ML102-DEPT-NBR TO HN-DEPT-NBR.                          07970000
073100     INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-DEPT-LVL).           07980000
073200                                                                  07990000
073300     PERFORM 3000-FILL-HEADINGS.                                  08000000
073400                                                                  08010000
073500     PERFORM 2400-PROCESS-DEPT                                    08020000
073600         UNTIL (ML102-GMA-NBR  NOT = HN-GMA-NBR)                  08030000
073700            OR (ML102-DMA-NBR  NOT = HN-DMA-NBR)                  08040000
073800            OR (ML102-BYR-NBR  NOT = HN-BYR-NBR)                  08050000
073900            OR (ML102-DEPT-NBR NOT = HN-DEPT-NBR)                 08060000
074000            OR (PS-END-OF-LEDGER-EXTRACT).                        08070000
074100                                                                  08080000
074200     SET PS-BREAK-IS-DEPT TO TRUE.                                08090000
074300                                                                  08100000
074400     PERFORM 2600-PROCESS-BREAKS.                                 08110000
074500                                                                  08120000
074600                                                                  08130000
072200 2400-PROCESS-DEPT.                                               08140000
072300                                                                  08150000
072400******************************************************************08160000
072500*    PROCESS ALL DEPTS WITHIN THIS BYR.  WHEN A NEW GMA, DMA,     08170000
072600*    BYR, OR DEPT IS ENCOUNTERED, PRINT THE INFO FOR THE          08180000
072700*    PREVIOUS DEPT.                                               08190000
072800******************************************************************08200000
072900                                                                  08210000
073000     MOVE ML102-MAJ-CL-NBR TO HN-CLASS-NBR.                       08220000
073100     INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-CLASS-LVL).          08230000
073200                                                                  08240000
073300     PERFORM 3000-FILL-HEADINGS.                                  08250000
073400                                                                  08260000
073500     PERFORM 2500-PROCESS-MAJOR-CLASS                             08270000
073600         UNTIL (ML102-GMA-NBR    NOT = HN-GMA-NBR)                08280000
073700            OR (ML102-DMA-NBR    NOT = HN-DMA-NBR)                08290000
073800            OR (ML102-BYR-NBR    NOT = HN-BYR-NBR)                08300000
073900            OR (ML102-DEPT-NBR   NOT = HN-DEPT-NBR)               08310000
073900            OR (ML102-MAJ-CL-NBR NOT = HN-CLASS-NBR)              08320000
074000            OR (PS-END-OF-LEDGER-EXTRACT).                        08330000
074100                                                                  08340000
074200     SET PS-BREAK-IS-MAJ-CLASS TO TRUE.                           08350000
074300                                                                  08360000
074400     PERFORM 2600-PROCESS-BREAKS.                                 08370000
074500                                                                  08380000
074600                                                                  08390000
074700 2500-PROCESS-MAJOR-CLASS.                                        08400000
074800                                                                  08410000
074900******************************************************************08420000
075000*    PROCESS THE MERCHANDISE LEDGER RECORD.  UPDATE THE           08430000
075100*    APPROPRIATE BUCKETS USING THE MAJOR CLASS INFORMATION.       08440000
075200******************************************************************08450000
075300                                                                  08460000
075400     MOVE ML102-BEG-INV-COST-AMT                                  08470000
075500          TO AT-BEG-INV-COST-AMT (PC-CLASS-LVL).                  08480000
075600     MOVE ML102-BEG-INV-RTL-AMT                                   08490000
075700          TO AT-BEG-INV-RTL-AMT  (PC-CLASS-LVL).                  08500000
075800                                                                  08510000
075900     PERFORM VARYING SS-CURR-MN FROM 1 BY 1                       08520000
076000       UNTIL SS-CURR-MN > SS-OPEN-MN                              08530000
076100                                                                  08540000
076200         COMPUTE AT-PRCH-NET-COST-AMT    (PC-CLASS-LVL SS-CURR-MN)08550000
076300               = ML102-RCPT-NET-COST-AMT (SS-CURR-MN)             08560000
076400               + ML102-PADJ-NET-COST-AMT (SS-CURR-MN)             08570000
076500         COMPUTE AT-PRCH-RTL-AMT         (PC-CLASS-LVL SS-CURR-MN)08580000
076600               = ML102-RCPT-RTL-AMT      (SS-CURR-MN)             08590000
076700               + ML102-PADJ-RTL-AMT      (SS-CURR-MN)             08600000
076800               + ML102-MKUP-RTL-AMT      (SS-CURR-MN)             08610000
076900               + ML102-XFER-IN-RTL-AMT   (SS-CURR-MN)             08620000
077000               - ML102-XFER-OUT-RTL-AMT  (SS-CURR-MN)             08630000
WR5701                                                                  08640000
WR5701         MOVE ML102-RCPT-NET-COST-AMT    (SS-CURR-MN)             08650000
WR5701              TO AT-RCPT-NET-COST-AMT    (PC-CLASS-LVL SS-CURR-MN)08660000
WR5701         MOVE ML102-RCPT-RTL-AMT         (SS-CURR-MN)             08670000
WR5701              TO AT-RCPT-RTL-AMT         (PC-CLASS-LVL SS-CURR-MN)08680000
WR5701         MOVE ML102-PADJ-NET-COST-AMT    (SS-CURR-MN)             08690000
WR5701              TO AT-PADJ-NET-COST-AMT    (PC-CLASS-LVL SS-CURR-MN)08700000
WR5701         COMPUTE AT-PADJ-RTL-AMT         (PC-CLASS-LVL SS-CURR-MN)08710000
WR5701               = ML102-PADJ-RTL-AMT      (SS-CURR-MN)             08720000
WR5701               + ML102-MKUP-RTL-AMT      (SS-CURR-MN)             08730000
WR5701               + ML102-XFER-IN-RTL-AMT   (SS-CURR-MN)             08740000
WR5701               - ML102-XFER-OUT-RTL-AMT  (SS-CURR-MN)             08750000
WR5701                                                                  08760000
077100         MOVE ML102-SLS-RTL-AMT          (SS-CURR-MN)             08770000
077200              TO AT-SLS-RTL-AMT          (PC-CLASS-LVL SS-CURR-MN)08780000
077300         MOVE ML102-SHNK-RTL-AMT         (SS-CURR-MN)             08790000
077400              TO AT-SHNK-RTL-AMT         (PC-CLASS-LVL SS-CURR-MN)08800000
077500         MOVE ML102-INV-ADJ-RTL-AMT      (SS-CURR-MN)             08810000
077600              TO AT-INV-ADJ-RTL-AMT      (PC-CLASS-LVL SS-CURR-MN)08820000
077700         MOVE ML102-MKDN-RTL-AMT         (SS-CURR-MN)             08830000
077800              TO AT-MKDN-RTL-AMT         (PC-CLASS-LVL SS-CURR-MN)08840000
077900         MOVE ML102-END-INV-RTL-AMT      (SS-CURR-MN)             08850000
078000              TO AT-END-INV-RTL-AMT      (PC-CLASS-LVL SS-CURR-MN)08860000
078100         MOVE ML102-END-INV-COST-AMT     (SS-CURR-MN)             08870000
078200              TO AT-END-INV-COST-AMT     (PC-CLASS-LVL SS-CURR-MN)08880000
078300         MOVE ML102-SLS-COST-AMT         (SS-CURR-MN)             08890000
078400              TO AT-SLS-COST-AMT         (PC-CLASS-LVL SS-CURR-MN)08900000
078500         MOVE ML102-GRO-MRGN-AMT         (SS-CURR-MN)             08910000
078600              TO AT-GRO-MRGN-AMT         (PC-CLASS-LVL SS-CURR-MN)08920000
078700     END-PERFORM.                                                 08930000
078800                                                                  08940000
078900     PERFORM 3200-ADD-TO-MCL-SEASON-TOTS.                         08950000
079000                                                                  08960000
079100     PERFORM 7000-READ-LEDGER-EXTRACT.                            08970000
079200                                                                  08980000
079300                                                                  08990000
079400 2600-PROCESS-BREAKS.                                             09000000
079500                                                                  09010000
079600*    DETERMINE WHICH BUSINES LEVEL THE BREAK IS OCCURRING ON AND  09020000
079700*    SET THE LEVEL SUBSCRIPT ACCORDINGLY.                         09030000
079800                                                                  09040000
079900     EVALUATE  TRUE                                               09050000
080000         WHEN PS-BREAK-IS-MAJ-CLASS                               09060000
080100             MOVE PC-CLASS-LVL  TO SS-CURR-LVL                    09070000
080000         WHEN PS-BREAK-IS-DEPT                                    09080000
080100             MOVE PC-DEPT-LVL   TO SS-CURR-LVL                    09090000
080200         WHEN PS-BREAK-IS-BYR                                     09100000
080300             MOVE PC-BYR-LVL    TO SS-CURR-LVL                    09110000
080400         WHEN PS-BREAK-IS-DMA                                     09120000
080500             MOVE PC-DMA-LVL    TO SS-CURR-LVL                    09130000
080600         WHEN PS-BREAK-IS-GMA                                     09140000
080700             MOVE PC-GMA-LVL    TO SS-CURR-LVL                    09150000
080800         WHEN PS-BREAK-IS-OPERCO                                  09160000
080900             MOVE PC-OPERCO-LVL TO SS-CURR-LVL                    09170000
081000     END-EVALUATE.                                                09180000
081100                                                                  09190000
081200*    PRINT THE HEADINGS                                           09200000
081300                                                                  09210000
081400     PERFORM 7200-PRINT-PAGE-HEADINGS.                            09220000
081500     PERFORM 7300-PRINT-TOTAL-HEADING.                            09230000
081600     PERFORM 7400-PRINT-DETAIL-HEADINGS.                          09240000
081700                                                                  09250000
081800*    PRINT THE DETAIL                                             09260000
081900                                                                  09270000
082000     MOVE AT-BEG-INV-COST-AMT (SS-CURR-LVL)                       09280000
082100                                           TO PV-BEG-INV-COST-AMT.09290000
082200     MOVE AT-BEG-INV-RTL-AMT  (SS-CURR-LVL)                       09300000
082300                                           TO PV-BEG-INV-RTL-AMT. 09310000
082400     PERFORM 3600-PROCESS-BEGIN-INV-LINE.                         09320000
082500                                                                  09330000
082600     PERFORM 3300-PROCESS-MONTH-DET-LINES                         09340000
082700         VARYING SS-CURR-MN FROM 1 BY 1                           09350000
082800         UNTIL   SS-CURR-MN > SS-OPEN-MN.                         09360000
082900                                                                  09370000
083000*    PRINT THE YEAR-TO-DATE TOTALS                                09380000
083100                                                                  09390000
083200     IF SS-OPEN-MN > 6                                            09400000
083300         PERFORM 3400-PROCESS-YTD-TOTAL-LINE                      09410000
083400     END-IF.                                                      09420000
083500                                                                  09430000
083600     IF PS-BREAK-IS-OPERCO                                        09440000
083700         NEXT SENTENCE                                            09450000
083800     ELSE                                                         09460000
083900         PERFORM 3100-ADD-TO-NEXT-HIGHER-LEVEL                    09470000
084000     END-IF.                                                      09480000
084100                                                                  09490000
084200     SET PS-BREAK-LEVEL-SW-INIT TO TRUE.                          09500000
084300                                                                  09510000
084400                                                                  09520000
084500 3000-FILL-HEADINGS.                                              09530000
084600                                                                  09540000
084700******************************************************************09550000
084800*    FILL IN THE SUB HEADING INFORMATION.                         09560000
084900******************************************************************09570000
085000                                                                  09580000
085100     IF NOT PS-END-OF-LEDGER-EXTRACT                              09590000
085200*        GET GMM NAME                                             09600000
085300         MOVE ML102-GMA-NBR           TO PV-GMA-NBR               09610000
085400         PERFORM 8100-GET-GMM-NAME                                09620000
085500         MOVE RSPBAR-WORKER-FIR-NAME  TO DP024-FNAME              09630000
085600         MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME              09640000
085700         PERFORM DP024-0000-FORMAT-NAME                           09650000
085800                                                                  09660000
085900*        PUT PARENTHESES AROUND GMM NAME                          09670000
086000         MOVE SPACES                  TO PV-ENTIRE-NAME           09680000
086100                                         PV-NAME-PAREN-2          09690000
086200                                         PV-NAME                  09700000
086300         MOVE DP024-FLNAME            TO PV-ENTIRE-NAME           09710000
086400         INSPECT PV-NAME-WITH-PARENS REPLACING                    09720000
086500             FIRST PC-2-SPACES-LIT                                09730000
086600                BY PC-PAREN-SPACE-LIT                             09740000
086700         MOVE PV-NAME-WITH-PARENS     TO PV-NAME                  09750000
086800                                                                  09760000
086900*        GET GMA DESCRIPTION                                      09770000
087000         MOVE '??'                    TO PV-DMA-NBR               09780000
087100                                         PV-BYR-NBR               09790000
087200         MOVE PC-DEPT-NBR-000         TO PV-DEPT-NBR              09800000
087300         MOVE PC-MDSELV-GMA           TO PV-MDSELV-CDE            09810000
087400         PERFORM 8400-GET-MDSEAR-DESC                             09820000
087500                                                                  09830000
087600*        BUILD GMA HEADING LINE                                   09840000
087700         MOVE ML102-GMA-NBR           TO GH-GMA-NBR               09850000
087800         MOVE SPACES                  TO GH-GMA-DESC-GMM-NAME     09860000
087900         MOVE MDSEAR-DESC             TO PV-DESC                  09870000
088000         STRING PV-DESC  PV-NAME                                  09880000
088100             DELIMITED BY PC-2-SPACES-LIT                         09890000
088200                                    INTO GH-GMA-DESC-GMM-NAME     09900000
088300                                                                  09910000
088400*        GET DMM NAME                                             09920000
088500         MOVE ML102-DMA-NBR           TO PV-DMA-NBR               09930000
088600         PERFORM 8200-GET-DMM-NAME                                09940000
088700         MOVE RSPBAR-WORKER-FIR-NAME  TO DP024-FNAME              09950000
088800         MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME              09960000
088900         PERFORM DP024-0000-FORMAT-NAME                           09970000
089000                                                                  09980000
089100*        PUT PARENTHESES AROUND DMM NAME                          09990000
089200         MOVE SPACES                  TO PV-ENTIRE-NAME           10000000
089300                                         PV-NAME-PAREN-2          10010000
089400                                         PV-NAME                  10020000
089500         MOVE DP024-FLNAME            TO PV-ENTIRE-NAME           10030000
089600         INSPECT PV-NAME-WITH-PARENS REPLACING                    10040000
089700             FIRST PC-2-SPACES-LIT   BY                           10050000
089800                   PC-PAREN-SPACE-LIT                             10060000
089900         MOVE PV-NAME-WITH-PARENS     TO PV-NAME                  10070000
090000                                                                  10080000
090100*        GET DMA DESCRIPTION                                      10090000
090200         MOVE '??'                    TO  PV-GMA-NBR              10100000
090300                                          PV-BYR-NBR              10110000
090400         MOVE PC-DEPT-NBR-000         TO  PV-DEPT-NBR             10120000
090500         MOVE PC-MDSELV-DMA           TO  PV-MDSELV-CDE           10130000
090600         PERFORM 8400-GET-MDSEAR-DESC                             10140000
090700                                                                  10150000
090800*        BUILD DMA HEADING LINE                                   10160000
090900         MOVE ML102-DMA-NBR           TO DH-DMA-NBR               10170000
091000         MOVE SPACES                  TO DH-DMA-DESC-DMM-NAME     10180000
091100         MOVE MDSEAR-DESC             TO PV-DESC                  10190000
091200         STRING PV-DESC  PV-NAME                                  10200000
091300         DELIMITED BY PC-2-SPACES-LIT                             10210000
091400                                    INTO DH-DMA-DESC-DMM-NAME     10220000
091500                                                                  10230000
091600*        GET BUYER NAME                                           10240000
091700         MOVE ML102-BYR-NBR           TO PV-BYR-NBR               10250000
091800         MOVE ML102-DEPT-NBR          TO PV-DEPT-NBR              10260000
091900         PERFORM 8300-GET-BYR-NAME                                10270000
092000         MOVE RSPBAR-WORKER-FIR-NAME  TO DP024-FNAME              10280000
092100         MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME              10290000
092200         PERFORM DP024-0000-FORMAT-NAME                           10300000
092300                                                                  10310000
092400*        BUILD BUYER HEADING LINE                                 10320000
WR5701         MOVE ML102-BYR-NBR           TO BH-BYR-NBR               10330000
092600         MOVE DP024-FLNAME            TO BH-BYR-NAME              10340000
092700                                                                  10350000
092800*        GET DEPT DESCRIPTION                                     10360000
092900         MOVE '??'                    TO PV-GMA-NBR               10370000
093000                                         PV-DMA-NBR               10380000
093100         MOVE ML102-DEPT-NBR          TO PV-DEPT-NBR              10390000
093200         MOVE PC-MDSELV-DPT           TO PV-MDSELV-CDE            10400000
093300         PERFORM 8400-GET-MDSEAR-DESC                             10410000
093400                                                                  10420000
093500*        BUILD DEPT HEADING LINE                                  10430000
093600         MOVE ML102-DEPT-NBR          TO DH-DEPT-NBR              10440000
093700         MOVE MDSEAR-DESC             TO DH-DEPT-NAME             10450000
093900                                                                  10460000
092800*        GET CLASS DESCRIPTION                                    10470000
092900         MOVE '??'                    TO PV-GMA-NBR               10480000
093000                                         PV-DMA-NBR               10490000
093100         MOVE ML102-DEPT-NBR          TO PV-DEPT-NBR              10500000
093100         MOVE ML102-MAJ-CL-NBR        TO PV-CLASS-NBR             10510000
093200         MOVE PC-MDSELV-MCL           TO PV-MDSELV-CDE            10520000
093300         PERFORM 8500-GET-CLASS-LEVEL-DESC                        10530000
093400                                                                  10540000
093500*        BUILD MCL HEADING LINE                                   10550000
093600         MOVE ML102-MAJ-CL-NBR        TO DH-CLASS-NBR             10560000
093700         MOVE MDSEAR-DESC             TO DH-CLASS-NAME            10570000
093800     END-IF.                                                      10580000
093900                                                                  10590000
094000                                                                  10600000
094100 3100-ADD-TO-NEXT-HIGHER-LEVEL.                                   10610000
094200                                                                  10620000
094300******************************************************************10630000
094400* ADD THE BEGINNING INVENTORY, MONTHLY, AND SEASON TOTALS         10640000
094500* FOR THE CURRENT LEVEL TO THE NEXT HIGHER LEVEL.                 10650000
094600******************************************************************10660000
094700                                                                  10670000
094800     ADD 1 SS-CURR-LVL GIVING SS-NEXT-LVL.                        10680000
094900                                                                  10690000
095000     ADD AT-BEG-INV-COST-AMT (SS-CURR-LVL) TO                     10700000
095100         AT-BEG-INV-COST-AMT (SS-NEXT-LVL).                       10710000
095200     ADD AT-BEG-INV-RTL-AMT  (SS-CURR-LVL) TO                     10720000
095300         AT-BEG-INV-RTL-AMT  (SS-NEXT-LVL).                       10730000
095400                                                                  10740000
095500     PERFORM VARYING SS-CURR-MN FROM 1 BY 1                       10750000
095600       UNTIL SS-CURR-MN > SS-OPEN-MN                              10760000
095700         ADD AT-PRCH-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN) TO     10770000
095800             AT-PRCH-NET-COST-AMT (SS-NEXT-LVL SS-CURR-MN)        10780000
095900         ADD AT-PRCH-RTL-AMT      (SS-CURR-LVL SS-CURR-MN) TO     10790000
096000             AT-PRCH-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)        10800000
WR5701         ADD AT-RCPT-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN) TO     10810000
WR5701             AT-RCPT-NET-COST-AMT (SS-NEXT-LVL SS-CURR-MN)        10820000
WR5701         ADD AT-RCPT-RTL-AMT      (SS-CURR-LVL SS-CURR-MN) TO     10830000
WR5701             AT-RCPT-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)        10840000
WR5701         ADD AT-PADJ-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN) TO     10850000
WR5701             AT-PADJ-NET-COST-AMT (SS-NEXT-LVL SS-CURR-MN)        10860000
WR5701         ADD AT-PADJ-RTL-AMT      (SS-CURR-LVL SS-CURR-MN) TO     10870000
WR5701             AT-PADJ-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)        10880000
096100         ADD AT-SLS-RTL-AMT       (SS-CURR-LVL SS-CURR-MN) TO     10890000
096200             AT-SLS-RTL-AMT       (SS-NEXT-LVL SS-CURR-MN)        10900000
096300         ADD AT-SHNK-RTL-AMT      (SS-CURR-LVL SS-CURR-MN) TO     10910000
096400             AT-SHNK-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)        10920000
096500         ADD AT-INV-ADJ-RTL-AMT   (SS-CURR-LVL SS-CURR-MN) TO     10930000
096600             AT-INV-ADJ-RTL-AMT   (SS-NEXT-LVL SS-CURR-MN)        10940000
096700         ADD AT-MKDN-RTL-AMT      (SS-CURR-LVL SS-CURR-MN) TO     10950000
096800             AT-MKDN-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)        10960000
096900         ADD AT-END-INV-COST-AMT  (SS-CURR-LVL SS-CURR-MN) TO     10970000
097000             AT-END-INV-COST-AMT  (SS-NEXT-LVL SS-CURR-MN)        10980000
097100         ADD AT-END-INV-RTL-AMT   (SS-CURR-LVL SS-CURR-MN) TO     10990000
097200             AT-END-INV-RTL-AMT   (SS-NEXT-LVL SS-CURR-MN)        11000000
097300         ADD AT-SLS-COST-AMT      (SS-CURR-LVL SS-CURR-MN) TO     11010000
097400             AT-SLS-COST-AMT      (SS-NEXT-LVL SS-CURR-MN)        11020000
097500         ADD AT-GRO-MRGN-AMT      (SS-CURR-LVL SS-CURR-MN) TO     11030000
097600             AT-GRO-MRGN-AMT      (SS-NEXT-LVL SS-CURR-MN)        11040000
097700     END-PERFORM.                                                 11050000
097800                                                                  11060000
           PERFORM VARYING SS-SEASON FROM 1 BY 1                        11070000
098000       UNTIL SS-SEASON > 2                                        11080000
098100         ADD AT-SEAS-PRCH-NET-COST-AMT (SS-CURR-LVL SS-SEASON) TO 11090000
098200             AT-SEAS-PRCH-NET-COST-AMT (SS-NEXT-LVL SS-SEASON)    11100000
098300         ADD AT-SEAS-PRCH-RTL-AMT      (SS-CURR-LVL SS-SEASON) TO 11110000
098400             AT-SEAS-PRCH-RTL-AMT      (SS-NEXT-LVL SS-SEASON)    11120000
WR5701         ADD AT-SEAS-RCPT-NET-COST-AMT (SS-CURR-LVL SS-SEASON) TO 11130000
WR5701             AT-SEAS-RCPT-NET-COST-AMT (SS-NEXT-LVL SS-SEASON)    11140000
WR5701         ADD AT-SEAS-RCPT-RTL-AMT      (SS-CURR-LVL SS-SEASON) TO 11150000
WR5701             AT-SEAS-RCPT-RTL-AMT      (SS-NEXT-LVL SS-SEASON)    11160000
WR5701         ADD AT-SEAS-PADJ-NET-COST-AMT (SS-CURR-LVL SS-SEASON) TO 11170000
WR5701             AT-SEAS-PADJ-NET-COST-AMT (SS-NEXT-LVL SS-SEASON)    11180000
WR5701         ADD AT-SEAS-PADJ-RTL-AMT      (SS-CURR-LVL SS-SEASON) TO 11190000
WR5701             AT-SEAS-PADJ-RTL-AMT      (SS-NEXT-LVL SS-SEASON)    11200000
098500         ADD AT-SEAS-SLS-RTL-AMT       (SS-CURR-LVL SS-SEASON) TO 11210000
098600             AT-SEAS-SLS-RTL-AMT       (SS-NEXT-LVL SS-SEASON)    11220000
098700         ADD AT-SEAS-SHNK-RTL-AMT      (SS-CURR-LVL SS-SEASON) TO 11230000
098800             AT-SEAS-SHNK-RTL-AMT      (SS-NEXT-LVL SS-SEASON)    11240000
098900         ADD AT-SEAS-MKDN-RTL-AMT      (SS-CURR-LVL SS-SEASON) TO 11250000
099000             AT-SEAS-MKDN-RTL-AMT      (SS-NEXT-LVL SS-SEASON)    11260000
099100         ADD AT-SEAS-SLS-COST-AMT      (SS-CURR-LVL SS-SEASON) TO 11270000
099200             AT-SEAS-SLS-COST-AMT      (SS-NEXT-LVL SS-SEASON)    11280000
099300         ADD AT-SEAS-GRO-MRGN-AMT      (SS-CURR-LVL SS-SEASON) TO 11290000
099400             AT-SEAS-GRO-MRGN-AMT      (SS-NEXT-LVL SS-SEASON)    11300000
099500     END-PERFORM.                                                 11310000
099600                                                                  11320000
099700                                                                  11330000
099800 3200-ADD-TO-MCL-SEASON-TOTS.                                     11340000
099900                                                                  11350000
100000******************************************************************11360000
100100* ADD THE CLASS DOLLARS TO THE SEASON TOTALS FOR THE MAJOR CLASS *11370000
100300******************************************************************11380000
100400                                                                  11390000
100500*    ADD THE BEGINNING INVENTORY TO THE SEASON PURCHASE TOTAL     11400000
100600*    FOR THE DEPARTMENT.                                          11410000
100700     MOVE 1 TO SS-SEASON.                                         11420000
100800     MOVE AT-BEG-INV-COST-AMT       (PC-CLASS-LVL)                11430000
100900       TO AT-SEAS-PRCH-NET-COST-AMT (PC-CLASS-LVL SS-SEASON).     11440000
101000     MOVE AT-BEG-INV-RTL-AMT        (PC-CLASS-LVL)                11450000
101100       TO AT-SEAS-PRCH-RTL-AMT      (PC-CLASS-LVL SS-SEASON).     11460000
101200                                                                  11470000
101300     MOVE 2 TO SS-SEASON.                                         11480000
           IF SS-OPEN-MN > 6                                            11490000
101500         MOVE AT-END-INV-COST-AMT       (PC-CLASS-LVL 6)          11500000
101600           TO AT-SEAS-PRCH-NET-COST-AMT (PC-CLASS-LVL SS-SEASON)  11510000
101700         MOVE AT-END-INV-RTL-AMT        (PC-CLASS-LVL 6)          11520000
101800           TO AT-SEAS-PRCH-RTL-AMT      (PC-CLASS-LVL SS-SEASON)  11530000
101900     END-IF.                                                      11540000
102000                                                                  11550000
102100*    ADD THE MONTHLY DOLLARS TO THE SEASON TOTALS FOR THE         11560000
102200*    DEPARTMENT. MONTHS 1-6 BELONG TO THE SPRING SEASON.          11570000
102300*    MONTHS 7-12 BELONG TO THE FALL SEASON.                       11580000
102400                                                                  11590000
102500     PERFORM VARYING SS-CURR-MN FROM 1 BY 1                       11600000
102600       UNTIL (SS-CURR-MN > SS-OPEN-MN) OR (SS-CURR-MN > 12)       11610000
102700                                                                  11620000
102800         IF SS-CURR-MN < 7                                        11630000
102900             MOVE 1 TO SS-SEASON                                  11640000
103000         ELSE                                                     11650000
103100             MOVE 2 TO SS-SEASON                                  11660000
103200         END-IF                                                   11670000
103300                                                                  11680000
103400        ADD AT-PRCH-NET-COST-AMT      (PC-CLASS-LVL SS-CURR-MN) TO11690000
103500            AT-SEAS-PRCH-NET-COST-AMT (PC-CLASS-LVL SS-SEASON)    11700000
103600        ADD AT-PRCH-RTL-AMT           (PC-CLASS-LVL SS-CURR-MN) TO11710000
103700            AT-SEAS-PRCH-RTL-AMT      (PC-CLASS-LVL SS-SEASON)    11720000
WR5701        ADD AT-RCPT-NET-COST-AMT      (PC-CLASS-LVL SS-CURR-MN) TO11730000
WR5701            AT-SEAS-RCPT-NET-COST-AMT (PC-CLASS-LVL SS-SEASON)    11740000
WR5701        ADD AT-RCPT-RTL-AMT           (PC-CLASS-LVL SS-CURR-MN) TO11750000
WR5701            AT-SEAS-RCPT-RTL-AMT      (PC-CLASS-LVL SS-SEASON)    11760000
WR5701        ADD AT-PADJ-NET-COST-AMT      (PC-CLASS-LVL SS-CURR-MN) TO11770000
WR5701            AT-SEAS-PADJ-NET-COST-AMT (PC-CLASS-LVL SS-SEASON)    11780000
WR5701        ADD AT-PADJ-RTL-AMT           (PC-CLASS-LVL SS-CURR-MN) TO11790000
WR5701            AT-SEAS-PADJ-RTL-AMT      (PC-CLASS-LVL SS-SEASON)    11800000
103800        ADD AT-SLS-RTL-AMT            (PC-CLASS-LVL SS-CURR-MN) TO11810000
103900            AT-SEAS-SLS-RTL-AMT       (PC-CLASS-LVL SS-SEASON)    11820000
104000        ADD AT-SHNK-RTL-AMT           (PC-CLASS-LVL SS-CURR-MN) TO11830000
104100            AT-SEAS-SHNK-RTL-AMT      (PC-CLASS-LVL SS-SEASON)    11840000
104200        ADD AT-INV-ADJ-RTL-AMT        (PC-CLASS-LVL SS-CURR-MN) TO11850000
104300            AT-SEAS-SHNK-RTL-AMT      (PC-CLASS-LVL SS-SEASON)    11860000
104400        ADD AT-MKDN-RTL-AMT           (PC-CLASS-LVL SS-CURR-MN) TO11870000
104500            AT-SEAS-MKDN-RTL-AMT      (PC-CLASS-LVL SS-SEASON)    11880000
104600        ADD AT-SLS-COST-AMT           (PC-CLASS-LVL SS-CURR-MN) TO11890000
104700            AT-SEAS-SLS-COST-AMT      (PC-CLASS-LVL SS-SEASON)    11900000
104800        ADD AT-GRO-MRGN-AMT           (PC-CLASS-LVL SS-CURR-MN) TO11910000
104900            AT-SEAS-GRO-MRGN-AMT      (PC-CLASS-LVL SS-SEASON)    11920000
105000     END-PERFORM.                                                 11930000
105100                                                                  11940000
105200                                                                  11950000
105300 3300-PROCESS-MONTH-DET-LINES.                                    11960000
105400                                                                  11970000
105500******************************************************************11980000
105600* BUILD THE DETAIL LINE FOR THE CURRENT MONTH.                    11990000
105700******************************************************************12000000
105800                                                                  12010000
105900     MOVE MT-FSCL-MN-NM-ABBREV (SS-CURR-MN) TO DL-MONTH-ABBREV.   12020000
WR5701                                                                  12030000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 12040000
WR5701           = AT-RCPT-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN)        12050000
WR5701           / PC-THOUSAND.                                         12060000
WR5701     MOVE PV-AMT-RNDED     TO DL-RECEIPTS-COST.                   12070000
WR5701                                                                  12080000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 12090000
WR5701           = AT-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)             12100000
WR5701           / PC-THOUSAND.                                         12110000
WR5701     MOVE PV-AMT-RNDED     TO DL-RECEIPTS-RETAIL.                 12120000
WR5701                                                                  12130000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 12140000
WR5701           = AT-PADJ-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN)        12150000
WR5701           / PC-THOUSAND.                                         12160000
WR5701     MOVE PV-AMT-RNDED     TO DL-PURCHASE-ADJ-COST.               12170000
WR5701                                                                  12180000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 12190000
WR5701           = AT-PADJ-RTL-AMT (SS-CURR-LVL SS-CURR-MN)             12200000
WR5701           / PC-THOUSAND.                                         12210000
WR5701     MOVE PV-AMT-RNDED     TO DL-PURCHASE-ADJ-RETAIL.             12220000
107000                                                                  12230000
107100     IF AT-PRCH-RTL-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO       12240000
107200         COMPUTE PV-PCT ROUNDED                                   12250000
107300               = ((AT-PRCH-RTL-AMT    (SS-CURR-LVL SS-CURR-MN)    12260000
107400               - AT-PRCH-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN))   12270000
107500               * 100)                                             12280000
107600               / AT-PRCH-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)    12290000
107700         MOVE PV-PCT       TO DL-MKON-PCT                         12300000
107800     ELSE                                                         12310000
107900         MOVE ZERO         TO DL-MKON-PCT                         12320000
108000     END-IF.                                                      12330000
108100                                                                  12340000
108200     COMPUTE PV-AMT-RNDED ROUNDED                                 12350000
108300           = AT-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-MN)              12360000
108400           / PC-THOUSAND.                                         12370000
108500     MOVE PV-AMT-RNDED     TO DL-SALES.                           12380000
108600                                                                  12390000
108700     COMPUTE PV-AMT-RNDED ROUNDED                                 12400000
108800           = AT-SHNK-RTL-AMT (SS-CURR-LVL SS-CURR-MN)             12410000
108900           / PC-THOUSAND.                                         12420000
109000     MOVE PV-AMT-RNDED     TO DL-SHRINKAGE.                       12430000
109100                                                                  12440000
109200     COMPUTE PV-AMT-RNDED ROUNDED                                 12450000
109300           = AT-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-MN)             12460000
109400           / PC-THOUSAND.                                         12470000
109500     MOVE PV-AMT-RNDED     TO DL-MARKDOWNS.                       12480000
109600                                                                  12490000
109700     COMPUTE PV-AMT-RNDED ROUNDED                                 12500000
109800           = AT-END-INV-COST-AMT (SS-CURR-LVL SS-CURR-MN)         12510000
109900           / PC-THOUSAND.                                         12520000
110000     MOVE PV-AMT-RNDED     TO DL-END-INV-COST.                    12530000
110100                                                                  12540000
110200     COMPUTE PV-AMT-RNDED ROUNDED                                 12550000
110300           = AT-END-INV-RTL-AMT (SS-CURR-LVL SS-CURR-MN)          12560000
110400           / PC-THOUSAND.                                         12570000
110500     MOVE PV-AMT-RNDED     TO DL-END-INV-RETAIL.                  12580000
110600                                                                  12590000
110700     COMPUTE PV-AMT-RNDED ROUNDED                                 12600000
110800           = AT-SLS-COST-AMT (SS-CURR-LVL SS-CURR-MN)             12610000
110900           / PC-THOUSAND.                                         12620000
111000     MOVE PV-AMT-RNDED     TO DL-COST-OF-SALES.                   12630000
111100                                                                  12640000
111200     COMPUTE PV-AMT-RNDED ROUNDED                                 12650000
111300           = AT-GRO-MRGN-AMT (SS-CURR-LVL SS-CURR-MN)             12660000
111400           / PC-THOUSAND.                                         12670000
111500     MOVE PV-AMT-RNDED     TO DL-GM-DLRS.                         12680000
111600                                                                  12690000
111700     IF AT-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO        12700000
C14666         COMPUTE PV-SHNK-PCT ROUNDED                              12710001
111900               = (AT-SHNK-RTL-AMT (SS-CURR-LVL SS-CURR-MN) * 100) 12720000
112000               / AT-SLS-RTL-AMT   (SS-CURR-LVL SS-CURR-MN)        12730000
C14666         MOVE PV-SHNK-PCT  TO DL-SHNK-PCT                         12740001
112200                                                                  12750000
112300         COMPUTE PV-PCT ROUNDED                                   12760000
112400               = (AT-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-MN) * 100) 12770000
112500               / AT-SLS-RTL-AMT   (SS-CURR-LVL SS-CURR-MN)        12780000
112600         MOVE PV-PCT       TO DL-MKDN-PCT                         12790000
112700                                                                  12800000
112800         COMPUTE PV-PCT ROUNDED                                   12810000
112900               = (AT-GRO-MRGN-AMT (SS-CURR-LVL SS-CURR-MN) * 100) 12820000
113000               / AT-SLS-RTL-AMT   (SS-CURR-LVL SS-CURR-MN)        12830000
113100         MOVE PV-PCT       TO DL-GM-PCT                           12840000
113200     ELSE                                                         12850000
113300         MOVE ZEROES       TO DL-SHNK-PCT                         12860000
 13400                              DL-MKDN-PCT                         12870000
113500                              DL-GM-PCT                           12880000
113600     END-IF.                                                      12890000
113700                                                                  12900000
113800     PERFORM 7500-PRINT-DETAIL-LINE.                              12910000
113900                                                                  12920000
114000     IF AT-INV-ADJ-RTL-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO    12930000
114100         MOVE SPACES TO DL-DETAIL-LINE                            12940000
114200         MOVE 'ADJ.' TO DL-MONTH-ABBREV                           12950000
                                                                        12960000
114300         COMPUTE PV-AMT-RNDED ROUNDED                             12970000
114400               = AT-INV-ADJ-RTL-AMT (SS-CURR-LVL SS-CURR-MN)      12980000
114500               / PC-THOUSAND                                      12990000
114600         MOVE PV-AMT-RNDED TO DL-SHRINKAGE                        13000000
114700                                                                  13010000
114800         PERFORM 7500-PRINT-DETAIL-LINE                           13020000
114900                                                                  13030000
115000         MOVE SPACES TO DL-MONTH-ABBREV                           13040000
115100     END-IF.                                                      13050000
115200                                                                  13060000
115300     IF (SS-CURR-MN = SS-OPEN-MN) OR                              13070000
115400        (SS-CURR-MN = 6)                                          13080000
115500         PERFORM 3500-PROCESS-SEASON-TOTALS                       13090000
115600     END-IF.                                                      13100000
115700                                                                  13110000
115800     IF (SS-CURR-MN NOT = SS-OPEN-MN) AND                         13120000
115900        (SS-CURR-MN     = 6)                                      13130000
116000         MOVE AT-END-INV-COST-AMT (SS-CURR-LVL SS-CURR-MN)        13140000
116100              TO PV-BEG-INV-COST-AMT                              13150000
116200         MOVE AT-END-INV-RTL-AMT (SS-CURR-LVL SS-CURR-MN)         13160000
116300              TO PV-BEG-INV-RTL-AMT                               13170000
116400         PERFORM 3600-PROCESS-BEGIN-INV-LINE                      13180000
116500     END-IF.                                                      13190000
116600                                                                  13200000
116700                                                                  13210000
116800 3400-PROCESS-YTD-TOTAL-LINE.                                     13220000
116900                                                                  13230000
117000******************************************************************13240000
117100*    SET THE DETAIL LINE FOR THE YEAR TO DATE INFORMATION.        13250000
117200******************************************************************13260000
117300                                                                  13270000
117400     INITIALIZE     DL-DETAIL-LINE.                               13280000
117500     MOVE 'YTD'  TO DL-MONTH-ABBREV.                              13290000
117600                                                                  13300000
117700     COMPUTE YTD-PRCH-NET-COST-AMT                                13310000
117800           = AT-SEAS-PRCH-NET-COST-AMT (SS-CURR-LVL 1)            13320000
117900           + AT-SEAS-PRCH-NET-COST-AMT (SS-CURR-LVL 2)            13330000
118000           - AT-END-INV-COST-AMT       (SS-CURR-LVL 6).           13340000
118100*                                                                 13350000
118200     COMPUTE YTD-PRCH-RTL-AMT                                     13360000
118300           = AT-SEAS-PRCH-RTL-AMT(SS-CURR-LVL 1)                  13370000
118400           + AT-SEAS-PRCH-RTL-AMT(SS-CURR-LVL 2)                  13380000
118500           - AT-END-INV-RTL-AMT(SS-CURR-LVL 6).                   13390000
118600                                                                  13400000
WR5701     COMPUTE YTD-RCPT-NET-COST-AMT                                13410000
WR5701           = AT-SEAS-RCPT-NET-COST-AMT (SS-CURR-LVL 1)            13420000
WR5701           + AT-SEAS-RCPT-NET-COST-AMT (SS-CURR-LVL 2).           13430000
WR5701                                                                  13440000
WR5701     COMPUTE YTD-RCPT-RTL-AMT                                     13450000
WR5701           = AT-SEAS-RCPT-RTL-AMT(SS-CURR-LVL 1)                  13460000
WR5701           + AT-SEAS-RCPT-RTL-AMT(SS-CURR-LVL 2).                 13470000
WR5701                                                                  13480000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 13490000
WR5701           = YTD-RCPT-NET-COST-AMT / PC-THOUSAND.                 13500000
WR5701     MOVE PV-AMT-RNDED TO DL-RECEIPTS-COST.                       13510000
WR5701                                                                  13520000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 13530000
WR5701           = YTD-RCPT-RTL-AMT / PC-THOUSAND.                      13540000
WR5701     MOVE PV-AMT-RNDED TO DL-RECEIPTS-RETAIL.                     13550000
WR5701                                                                  13560000
WR5701     COMPUTE YTD-PADJ-NET-COST-AMT                                13570000
WR5701           = AT-SEAS-PADJ-NET-COST-AMT (SS-CURR-LVL 1)            13580000
WR5701           + AT-SEAS-PADJ-NET-COST-AMT (SS-CURR-LVL 2).           13590000
WR5701                                                                  13600000
WR5701     COMPUTE YTD-PADJ-RTL-AMT                                     13610000
WR5701           = AT-SEAS-PADJ-RTL-AMT(SS-CURR-LVL 1)                  13620000
WR5701           + AT-SEAS-PADJ-RTL-AMT(SS-CURR-LVL 2).                 13630000
WR5701                                                                  13640000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 13650000
WR5701           = YTD-PADJ-NET-COST-AMT / PC-THOUSAND.                 13660000
WR5701     MOVE PV-AMT-RNDED TO DL-PURCHASE-ADJ-COST.                   13670000
WR5701                                                                  13680000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 13690000
WR5701           = YTD-PADJ-RTL-AMT / PC-THOUSAND.                      13700000
WR5701     MOVE PV-AMT-RNDED TO DL-PURCHASE-ADJ-RETAIL.                 13710000
WR5701                                                                  13720000
WR5701     IF YTD-PRCH-RTL-AMT  NOT = ZERO                              13730000
WR5701         COMPUTE PV-PCT ROUNDED =                                 13740000
WR5701           (((  YTD-PRCH-RTL-AMT                                  13750000
WR5701             -  YTD-PRCH-NET-COST-AMT ) * 100 )                   13760000
WR5701             /  YTD-PRCH-RTL-AMT )                                13770000
WR5701         MOVE PV-PCT   TO DL-MKON-PCT                             13780000
WR5701     ELSE                                                         13790000
WR5701         MOVE ZERO     TO DL-MKON-PCT                             13800000
WR5701     END-IF.                                                      13810000
120400                                                                  13820000
120500     COMPUTE YTD-SLS-RTL-AMT                                      13830000
120600           = AT-SEAS-SLS-RTL-AMT (SS-CURR-LVL 1)                  13840000
120700           + AT-SEAS-SLS-RTL-AMT (SS-CURR-LVL 2).                 13850000
120800                                                                  13860000
120900     COMPUTE YTD-SHNK-RTL-AMT                                     13870000
121000           = AT-SEAS-SHNK-RTL-AMT (SS-CURR-LVL 1)                 13880000
121100           + AT-SEAS-SHNK-RTL-AMT (SS-CURR-LVL 2).                13890000
121200                                                                  13900000
121300     COMPUTE YTD-MKDN-RTL-AMT                                     13910000
121400           = AT-SEAS-MKDN-RTL-AMT (SS-CURR-LVL 1)                 13920000
121500           + AT-SEAS-MKDN-RTL-AMT (SS-CURR-LVL 2).                13930000
121600                                                                  13940000
121700     COMPUTE YTD-SLS-COST-AMT                                     13950000
121800           = AT-SEAS-SLS-COST-AMT (SS-CURR-LVL 1)                 13960000
121900           + AT-SEAS-SLS-COST-AMT (SS-CURR-LVL 2).                13970000
122000                                                                  13980000
122100     COMPUTE YTD-GRO-MRGN-AMT                                     13990000
122200           = AT-SEAS-GRO-MRGN-AMT (SS-CURR-LVL 1)                 14000000
122300           + AT-SEAS-GRO-MRGN-AMT (SS-CURR-LVL 2).                14010000
122400                                                                  14020000
122500     COMPUTE PV-AMT-RNDED ROUNDED                                 14030000
122600           = YTD-SLS-RTL-AMT / PC-THOUSAND.                       14040000
122700     MOVE PV-AMT-RNDED TO DL-SALES.                               14050000
122800                                                                  14060000
122900     COMPUTE PV-AMT-RNDED ROUNDED                                 14070000
123000           = YTD-SHNK-RTL-AMT / PC-THOUSAND.                      14080000
123100     MOVE PV-AMT-RNDED TO DL-SHRINKAGE.                           14090000
123200                                                                  14100000
123300     COMPUTE PV-AMT-RNDED ROUNDED                                 14110000
123400           = YTD-MKDN-RTL-AMT / PC-THOUSAND.                      14120000
123500     MOVE PV-AMT-RNDED TO DL-MARKDOWNS.                           14130000
123600                                                                  14140000
123700     COMPUTE PV-AMT-RNDED ROUNDED                                 14150000
123800           = YTD-SLS-COST-AMT / PC-THOUSAND.                      14160000
123900     MOVE PV-AMT-RNDED TO DL-COST-OF-SALES.                       14170000
124000                                                                  14180000
124100     COMPUTE PV-AMT-RNDED ROUNDED                                 14190000
124200           = YTD-GRO-MRGN-AMT / PC-THOUSAND.                      14200000
124300     MOVE PV-AMT-RNDED TO DL-GM-DLRS.                             14210000
124400                                                                  14220000
124500     IF YTD-SLS-RTL-AMT NOT = ZERO                                14230000
C14666         COMPUTE PV-SHNK-PCT ROUNDED                              14240001
124700               = (YTD-SHNK-RTL-AMT * 100) / YTD-SLS-RTL-AMT       14250000
C14666         MOVE PV-SHNK-PCT TO DL-SHNK-PCT                          14260001
124900                                                                  14270000
125000         COMPUTE PV-PCT ROUNDED                                   14280000
125100               = (YTD-MKDN-RTL-AMT * 100) / YTD-SLS-RTL-AMT       14290000
125200         MOVE PV-PCT   TO DL-MKDN-PCT                             14300000
125300                                                                  14310000
125400         COMPUTE PV-PCT ROUNDED                                   14320000
125500               = (YTD-GRO-MRGN-AMT * 100) / YTD-SLS-RTL-AMT       14330000
125600         MOVE PV-PCT   TO DL-GM-PCT                               14340000
125700     ELSE                                                         14350000
125800         MOVE ZEROES   TO DL-SHNK-PCT                             14360000
125900                          DL-MKDN-PCT                             14370000
126000                          DL-GM-PCT                               14380000
126100     END-IF.                                                      14390000
126200                                                                  14400000
126300     PERFORM 7600-PRINT-TOTAL-LINE.                               14410000
126400                                                                  14420000
126500                                                                  14430000
126600 3500-PROCESS-SEASON-TOTALS.                                      14440000
126700                                                                  14450000
126800******************************************************************14460000
126900* SET UP THE DETAIL LINE FOR THE END OF SEASON INFO.              14470000
127000******************************************************************14480000
127100                                                                  14490000
127200     INITIALIZE DL-DETAIL-LINE.                                   14500000
127300                                                                  14510000
127400     IF SS-CURR-MN < 7                                            14520000
127500         MOVE 1        TO SS-SEASON                               14530000
127600         MOVE 'SPR'   TO DL-MONTH-ABBREV                          14540000
127700     ELSE                                                         14550000
127800         MOVE 2        TO SS-SEASON                               14560000
127900         MOVE 'FAL'   TO DL-MONTH-ABBREV                          14570000
128000     END-IF.                                                      14580000
128100                                                                  14590000
128200     COMPUTE PV-AMT-RNDED ROUNDED                                 14600000
WR5701           = AT-SEAS-RCPT-NET-COST-AMT (SS-CURR-LVL SS-SEASON)    14610000
128400           / PC-THOUSAND.                                         14620000
WR5701     MOVE PV-AMT-RNDED TO DL-RECEIPTS-COST.                       14630000
128600                                                                  14640000
128700     COMPUTE PV-AMT-RNDED ROUNDED                                 14650000
WR5701           = AT-SEAS-RCPT-RTL-AMT (SS-CURR-LVL SS-SEASON)         14660000
128900           / PC-THOUSAND.                                         14670000
WR5701     MOVE PV-AMT-RNDED TO DL-RECEIPTS-RETAIL.                     14680000
129100                                                                  14690000
123900     COMPUTE PV-AMT-RNDED ROUNDED                                 14700000
WR5701           = AT-SEAS-PADJ-NET-COST-AMT (SS-CURR-LVL SS-SEASON)    14710000
124100           / PC-THOUSAND.                                         14720000
WR5701     MOVE PV-AMT-RNDED TO DL-PURCHASE-ADJ-COST.                   14730000
124300                                                                  14740000
124400     COMPUTE PV-AMT-RNDED ROUNDED                                 14750000
WR5701           = AT-SEAS-PADJ-RTL-AMT (SS-CURR-LVL SS-SEASON)         14760000
124600           / PC-THOUSAND.                                         14770000
WR5701     MOVE PV-AMT-RNDED TO DL-PURCHASE-ADJ-RETAIL.                 14780000
124800                                                                  14790000
WR5701     IF AT-SEAS-RCPT-RTL-AMT (SS-CURR-LVL SS-SEASON) NOT = ZERO   14800000
WR5701         COMPUTE AT-SEAS-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON)     14810000
WR5701             =  (AT-SEAS-RCPT-RTL-AMT (SS-CURR-LVL SS-SEASON)     14820000
WR5701               + AT-SEAS-PADJ-RTL-AMT (SS-CURR-LVL SS-SEASON)     14830000
WR5701               + PV-BEG-INV-RTL-AMT  )                            14840000
WR5701         COMPUTE AT-SEAS-PRCH-NET-COST-AMT (SS-CURR-LVL SS-SEASON)14850000
WR5701             =  (AT-SEAS-RCPT-NET-COST-AMT (SS-CURR-LVL SS-SEASON)14860000
WR5701               + AT-SEAS-PADJ-NET-COST-AMT (SS-CURR-LVL SS-SEASON)14870000
WR5701               + PV-BEG-INV-COST-AMT  )                           14880000
WR5701         IF AT-SEAS-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON) NOT = 0  14890000
WR5701             COMPUTE PV-PCT ROUNDED =                             14900000
WR5701                 (((AT-SEAS-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON)  14910000
WR5701                  - AT-SEAS-PRCH-NET-COST-AMT                     14920000
WR5701                                         (SS-CURR-LVL SS-SEASON)) 14930000
WR5701                  * 100)                                          14940000
WR5701                 /  AT-SEAS-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON)) 14950000
125600             MOVE PV-PCT   TO DL-MKON-PCT                         14960000
WR5701         ELSE                                                     14970000
WR5701             MOVE ZERO     TO DL-MKON-PCT                         14980000
125700     ELSE                                                         14990000
125800         MOVE ZERO     TO DL-MKON-PCT                             15000000
125900     END-IF.                                                      15010000
126000                                                                  15020000
130400     COMPUTE PV-AMT-RNDED ROUNDED                                 15030000
130500           = AT-SEAS-SLS-RTL-AMT (SS-CURR-LVL SS-SEASON)          15040000
130600           / PC-THOUSAND.                                         15050000
130700     MOVE PV-AMT-RNDED TO DL-SALES.                               15060000
130800                                                                  15070000
130900     COMPUTE PV-AMT-RNDED ROUNDED                                 15080000
131000           = AT-SEAS-SHNK-RTL-AMT (SS-CURR-LVL SS-SEASON)         15090000
131100           / PC-THOUSAND.                                         15100000
131200     MOVE PV-AMT-RNDED TO DL-SHRINKAGE.                           15110000
131300                                                                  15120000
131400     COMPUTE PV-AMT-RNDED ROUNDED                                 15130000
131500           = AT-SEAS-MKDN-RTL-AMT (SS-CURR-LVL SS-SEASON)         15140000
131600           / PC-THOUSAND.                                         15150000
131700     MOVE PV-AMT-RNDED TO DL-MARKDOWNS.                           15160000
131800                                                                  15170000
131900     COMPUTE PV-AMT-RNDED ROUNDED                                 15180000
132000           = AT-SEAS-SLS-COST-AMT (SS-CURR-LVL SS-SEASON)         15190000
132100           / PC-THOUSAND.                                         15200000
132200     MOVE PV-AMT-RNDED TO DL-COST-OF-SALES.                       15210000
132300                                                                  15220000
132400     COMPUTE PV-AMT-RNDED ROUNDED                                 15230000
132500           = AT-SEAS-GRO-MRGN-AMT (SS-CURR-LVL SS-SEASON)         15240000
132600           / PC-THOUSAND.                                         15250000
132700     MOVE PV-AMT-RNDED TO DL-GM-DLRS.                             15260000
132800                                                                  15270000
132900     IF AT-SEAS-SLS-RTL-AMT (SS-CURR-LVL SS-SEASON) NOT = ZERO    15280000
C14666         COMPUTE PV-SHNK-PCT ROUNDED                              15290001
133100               = (AT-SEAS-SHNK-RTL-AMT (SS-CURR-LVL SS-SEASON)    15300000
133200               * 100)                                             15310000
133300               / AT-SEAS-SLS-RTL-AMT   (SS-CURR-LVL SS-SEASON)    15320000
C14666         MOVE PV-SHNK-PCT   TO DL-SHNK-PCT                        15330001
133500                                                                  15340000
133600         COMPUTE PV-PCT ROUNDED                                   15350000
133700               = (AT-SEAS-MKDN-RTL-AMT (SS-CURR-LVL SS-SEASON)    15360000
133800               * 100)                                             15370000
133900               / AT-SEAS-SLS-RTL-AMT   (SS-CURR-LVL SS-SEASON)    15380000
134000         MOVE PV-PCT   TO DL-MKDN-PCT                             15390000
134100                                                                  15400000
134200         COMPUTE PV-PCT ROUNDED                                   15410000
134300               = (AT-SEAS-GRO-MRGN-AMT (SS-CURR-LVL SS-SEASON)    15420000
134400               * 100)                                             15430000
134500               / AT-SEAS-SLS-RTL-AMT   (SS-CURR-LVL SS-SEASON)    15440000
134600         MOVE PV-PCT   TO DL-GM-PCT                               15450000
134700                                                                  15460000
134800     ELSE                                                         15470000
134900         MOVE ZEROES   TO DL-SHNK-PCT                             15480000
135000                          DL-MKDN-PCT                             15490000
135100                          DL-GM-PCT                               15500000
135200     END-IF.                                                      15510000
135300                                                                  15520000
135400     PERFORM 7600-PRINT-TOTAL-LINE.                               15530000
135500     PERFORM 7700-PRINT-BLANK-LINE.                               15540000
135600                                                                  15550000
135700                                                                  15560000
135800 3600-PROCESS-BEGIN-INV-LINE.                                     15570000
135900                                                                  15580000
136000******************************************************************15590000
136100* BUILD THE DETAIL LINE FOR THE BEGINNING INVENTORY INFO.         15600000
136200******************************************************************15610000
136300                                                                  15620000
136400     MOVE SPACES       TO DL-DETAIL-LINE.                         15630000
136500     MOVE 'B.I.'       TO DL-MONTH-ABBREV.                        15640000
136600                                                                  15650000
136700     COMPUTE PV-AMT-RNDED ROUNDED                                 15660000
136800           = PV-BEG-INV-COST-AMT / PC-THOUSAND.                   15670000
WR5701     MOVE PV-AMT-RNDED TO DL-END-INV-COST.                        15680000
137000                                                                  15690000
137100     COMPUTE PV-AMT-RNDED ROUNDED                                 15700000
137200           = PV-BEG-INV-RTL-AMT / PC-THOUSAND.                    15710000
WR5701     MOVE PV-AMT-RNDED TO DL-END-INV-RETAIL.                      15720000
137400                                                                  15730000
WR5701**   IF SS-CURR-MN NOT = 6                                        15740000
WR5701**       PERFORM 7500-PRINT-DETAIL-LINE                           15750000
WR5701**   END-IF.                                                      15760000
WR5701                                                                  15770000
137500     IF PV-BEG-INV-RTL-AMT NOT = ZERO                             15780000
137600         COMPUTE PV-PCT ROUNDED                                   15790000
137700             = ((PV-BEG-INV-RTL-AMT - PV-BEG-INV-COST-AMT) * 100) 15800000
137800             /   PV-BEG-INV-RTL-AMT                               15810000
137900         MOVE PV-PCT   TO DL-MKON-PCT                             15820000
138000     ELSE                                                         15830000
138100         MOVE ZERO     TO DL-MKON-PCT                             15840000
138200     END-IF.                                                      15850000
138300                                                                  15860000
******     PERFORM 7500-PRINT-DETAIL-LINE.                              15870000
138500                                                                  15880000
138600                                                                  15890000
138700 7000-READ-LEDGER-EXTRACT.                                        15900000
138800                                                                  15910000
138900     READ LEDGER-EXTRACT-FILE INTO ML102-LEDGER-EXTRACT-REC       15920000
139000         AT END SET PS-END-OF-LEDGER-EXTRACT TO TRUE.             15930000
139100                                                                  15940000
139200                                                                  15950000
135000 7100-READ-LEDGER-EXTRACT-DATE.                                   15960000
135100                                                                  15970000
135200     READ LEDGER-EXTRACT-DATE-FILE                                15980000
135300         INTO ML114-LEDGER-EXTRACT-DATE-REC                       15990000
135400         AT END SET PS-END-OF-LEDGER-DATE-FILE TO TRUE.           16000000
135500                                                                  16010000
139700                                                                  16020000
139800                                                                  16030000
139900 7200-PRINT-PAGE-HEADINGS.                                        16040000
140000                                                                  16050000
140100******************************************************************16060000
140200* PRINT THE PAGE HEADINGS.                                        16070000
140300* PRINT THE SUB HEADINGS BASED ON THE VALUE OF THE SUBSCRIPT.     16080000
140400******************************************************************16090000
140500                                                                  16100000
140600*    IF LC-LASER-BREAK                                            16110000
140700*        MOVE LC-LASER-CONTROL-FF TO                              16120000
140800*            DP175O-LASER-NEW-PAGE-INDICATR                       16130000
140900*        WRITE LEDGER-REPORT-RECORD FROM                          16140000
141000*            LC-LASER-CONTROL-FD                                  16150000
141100*                AFTER ADVANCING PAGE                             16160000
141200*    ELSE                                                         16170000
141300*        MOVE SPACES TO DP175O-LASER-NEW-PAGE-INDICATR .          16180000
141400*    END-IF.                                                      16190000
141500*    MOVE 'N' TO LC-LASER-BREAK-SW.                               16200000
141600                                                                  16210000
141700     ADD  1           TO PV-PAGE-CNT.                             16220000
141800     MOVE PV-PAGE-CNT TO DP175O-PAGE-NUMBER.                      16230000
141900                                                                  16240000
142000     WRITE LEDGER-REPORT-RECORD                                   16250000
142100         FROM DP175O-STANDRD-HEADER-175-COLS                      16260000
142200         AFTER ADVANCING PAGE.                                    16270000
142300                                                                  16280000
142400     WRITE LEDGER-REPORT-RECORD                                   16290000
142500         FROM PH2-PAGE-HEADING-2                                  16300000
142600         AFTER ADVANCING 1 LINE.                                  16310000
142700                                                                  16320000
142800     WRITE LEDGER-REPORT-RECORD                                   16330000
142900         FROM PH3-PAGE-HEADING-3                                  16340000
143000         AFTER ADVANCING 1 LINE.                                  16350000
143100                                                                  16360000
143200     IF SS-CURR-LVL = PC-OPERCO-LVL                               16370000
143300         WRITE LEDGER-REPORT-RECORD  FROM CH-COMPANY-HEADING      16380000
143400             AFTER ADVANCING 1 LINE                               16390000
143500     END-IF.                                                      16400000
143600                                                                  16410000
143700     IF SS-CURR-LVL < PC-OPERCO-LVL                               16420000
143800         WRITE LEDGER-REPORT-RECORD  FROM GH-GMA-HEADING          16430000
143900             AFTER ADVANCING 1 LINE                               16440000
144000     END-IF.                                                      16450000
144100                                                                  16460000
144200     IF SS-CURR-LVL < PC-GMA-LVL                                  16470000
144300         WRITE LEDGER-REPORT-RECORD  FROM DH-DMA-HEADING          16480000
144400             AFTER ADVANCING 1 LINE                               16490000
144500     END-IF.                                                      16500000
144600                                                                  16510000
144700     IF SS-CURR-LVL < PC-DMA-LVL                                  16520000
144800         WRITE LEDGER-REPORT-RECORD  FROM BH-BUYER-HEADING        16530000
144900             AFTER ADVANCING 1 LINE                               16540000
145000     END-IF.                                                      16550000
145100                                                                  16560000
145200     IF SS-CURR-LVL < PC-BYR-LVL                                  16570000
145300         WRITE LEDGER-REPORT-RECORD  FROM DH-DEPT-HEADING         16580000
145400             AFTER ADVANCING 1 LINE                               16590000
145100                                                                  16600000
145200     IF SS-CURR-LVL < PC-DEPT-LVL                                 16610000
145300         WRITE LEDGER-REPORT-RECORD  FROM DH-CLASS-HEADING        16620000
145400             AFTER ADVANCING 1 LINE                               16630000
145500     END-IF.                                                      16640000
145700                                                                  16650000
145700                                                                  16660000
145800 7300-PRINT-TOTAL-HEADING.                                        16670000
145900                                                                  16680000
146000     EVALUATE TRUE                                                16690000
146100         WHEN PS-BREAK-IS-OPERCO                                  16700000
146200             WRITE LEDGER-REPORT-RECORD FROM PC-COMPANY-TOTALS    16710000
146300             AFTER ADVANCING 1 LINE                               16720000
146400         WHEN PS-BREAK-IS-GMA                                     16730000
146500             WRITE LEDGER-REPORT-RECORD FROM PC-DIVISION-TOTALS   16740000
146600         WHEN PS-BREAK-IS-DMA                                     16750000
146700             WRITE LEDGER-REPORT-RECORD FROM PC-MANAGER-TOTALS    16760000
146800         WHEN PS-BREAK-IS-BYR                                     16770000
146900             WRITE LEDGER-REPORT-RECORD FROM PC-BUYER-TOTALS      16780000
147000             AFTER ADVANCING 1 LINE                               16790000
147100         WHEN PS-BREAK-IS-DEPT                                    16800000
147200             WRITE LEDGER-REPORT-RECORD FROM PC-DEPT-TOTALS       16810000
147300             AFTER ADVANCING 1 LINE                               16820000
147100*        WHEN PS-BREAK-IS-MAJ-CLASS                               16830000
147200*            WRITE LEDGER-REPORT-RECORD FROM PC-CLASS-TOTALS      16840000
147300*            AFTER ADVANCING 1 LINE                               16850000
147400     END-EVALUATE.                                                16860000
145600                                                                  16870000
150600*    PERFORM 7700-PRINT-BLANK-LINE.                               16880000
150600*    WRITE LEDGER-REPORT-RECORD FROM CH-COMPANY-HEADING           16890000
145700*        AFTER ADVANCING 1 LINE.                                  16900000
150600*    PERFORM 7700-PRINT-BLANK-LINE.                               16910000
147500                                                                  16920000
147600                                                                  16930000
147700 7400-PRINT-DETAIL-HEADINGS.                                      16940000
147800                                                                  16950000
147900     WRITE LEDGER-REPORT-RECORD                                   16960000
148000         FROM DH1-DETAIL-HEADING-1                                16970000
148100         AFTER ADVANCING 2 LINES.                                 16980000
148200                                                                  16990000
148300     WRITE LEDGER-REPORT-RECORD                                   17000000
148400         FROM DH2-DETAIL-HEADING-2                                17010000
148500         AFTER ADVANCING 1 LINE.                                  17020000
148600                                                                  17030000
148700                                                                  17040000
148800 7500-PRINT-DETAIL-LINE.                                          17050000
148900                                                                  17060000
149000     WRITE LEDGER-REPORT-RECORD                                   17070000
149100         FROM DL-DETAIL-LINE                                      17080000
149200         AFTER ADVANCING 1 LINE.                                  17090000
149300                                                                  17100000
149400                                                                  17110000
149500 7600-PRINT-TOTAL-LINE.                                           17120000
149600                                                                  17130000
149700     WRITE LEDGER-REPORT-RECORD                                   17140000
149800         FROM UL-UNDER-LINE                                       17150000
149900         AFTER ADVANCING 1 LINE.                                  17160000
150000                                                                  17170000
150100     WRITE LEDGER-REPORT-RECORD                                   17180000
150200         FROM DL-DETAIL-LINE                                      17190000
150300         AFTER ADVANCING 1 LINE.                                  17200000
150400                                                                  17210000
150400                                                                  17220000
150500                                                                  17230000
150600 7700-PRINT-BLANK-LINE.                                           17240000
150700                                                                  17250000
150800     INITIALIZE LEDGER-REPORT-RECORD.                             17260000
150900     WRITE LEDGER-REPORT-RECORD                                   17270000
151000        AFTER ADVANCING 1 LINE.                                   17280000
151100                                                                  17290000
151200                                                                  17300000
151300 8000-GET-DATE-ATTRIBUTES.                                        17310000
151400                                                                  17320000
152200         EXEC SQL                                                 17330000
152300              SELECT                                              17340000
152400                  FSCL_YR_NBR                                     17350000
152500                 ,FSCL_MN_NM                                      17360000
152600                 ,FSCL_YR_BEG_DTE                                 17370000
152700              INTO                                                17380000
152800                  :DTATTR-FSCL-YR-NBR                             17390000
152900                 ,:DTATTR-FSCL-MN-NM                              17400000
153000                 ,:DTATTR-FSCL-YR-BEG-DTE                         17410000
153100              FROM                                                17420000
153200                  TDTATTR                                         17430000
153300              WHERE                                               17440000
153400                  KY_DTE = :DTATTR-KY-DTE                         17450000
W26603             WITH UR                                              17460000
153500         END-EXEC                                                 17470000
153600                                                                  17480000
153700         EVALUATE TRUE                                            17490000
153800             WHEN SQLCODE        = +000                           17500000
153900             WHEN SQLCODE        = -904                           17510000
154000             WHEN SQLCODE        = -911                           17520000
154100                 CONTINUE                                         17530000
154200             WHEN OTHER                                           17540000
154300                 DISPLAY 'DTATTR-KY-DTE: ' DTATTR-KY-DTE          17550000
154400                 MOVE    '8000-GET-DATE-ATTRIBUTES'               17560000
154500                                          TO PV-PARAGRAPH-NAME    17570000
154600                 MOVE    'SELECT ROW FROM TDTATTR'                17580000
154700                                          TO PV-DB2-OPER-ATTEMPTED17590000
154800                 PERFORM 9998-SQL-ABEND                           17600000
154900         END-EVALUATE.                                            17610000
155000                                                                  17620000
156100                                                                  17630000
156200                                                                  17640000
156300 8100-GET-GMM-NAME.                                               17650000
156400                                                                  17660000
157100                                                                  17670000
157200         EXEC SQL                                                 17680000
157300              SELECT      B.WORKER_LAST_NAME                      17690000
157400                   ,      B.WORKER_FIR_NAME                       17700000
157500                INTO     :RSPBAR-WORKER-LAST-NAME                 17710000
157600                   ,     :RSPBAR-WORKER-FIR-NAME                  17720000
157700                FROM      TMDSEAR A                               17730000
157800                   ,      TRSPBAR B                               17740000
157900                   ,      TAPLAVL C                               17750000
158000               WHERE     (A.GMA_NBR     = :PV-GMA-NBR)            17760000
158100                 AND     (B.RSPLVL_CDE  = :PC-RSPLVL-CDE-GMM)     17770000
158200                 AND     (A.OPERCO_NBR  = :PC-OPERCO-NBR)         17780000
158300                 AND     (C.APLSYS_CDE  = :PC-APLSYS-CDE)         17790000
158400                 AND     (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)         17800000
158500                 AND     (A.MDSEAR_DKEY =  C.MDSEAR_DKEY)         17810000
                       AND     (:ML114-EXTRACT-DTE                      17820000
                                BETWEEN B.WORKER_STRT_DTE               17830000
                                AND     B.WORKER_END_DTE)               17840000
                       AND     (:ML114-EXTRACT-DTE                      17850000
                                BETWEEN C.MDSEAR_STRT_DTE               17860000
                                AND     C.MDSEAR_END_DTE)               17870000
W26603             WITH UR                                              17880000
159200         END-EXEC                                                 17890000
159300                                                                  17900000
159400         EVALUATE TRUE                                            17910000
159500             WHEN SQLCODE        = +000                           17920000
159600             WHEN SQLCODE        = -904                           17930000
159700             WHEN SQLCODE        = -911                           17940000
159800                 CONTINUE                                         17950000
159900             WHEN SQLCODE        = +100                           17960000
160000                 DISPLAY 'GMA NUMBER ' PV-GMA-NBR ' NOT FOUND.'   17970000
160100                 MOVE 'OPEN' TO  RSPBAR-WORKER-FIR-NAME           17980000
160200                 MOVE SPACE  TO  RSPBAR-WORKER-LAST-NAME          17990000
160300             WHEN OTHER                                           18000000
160400                 MOVE '8100-GET-GMM-NAME' TO PV-PARAGRAPH-NAME    18010000
160500                 MOVE 'SELECT ROW FROM TRSPBAR  '                 18020000
160600                                          TO PV-DB2-OPER-ATTEMPTED18030000
160700                 PERFORM 9998-SQL-ABEND                           18040000
160800         END-EVALUATE.                                            18050000
161000                                                                  18060000
161700                                                                  18070000
161800                                                                  18080000
161900 8200-GET-DMM-NAME.                                               18090000
162000                                                                  18100000
162700                                                                  18110000
162800         EXEC SQL                                                 18120000
162900              SELECT      B.WORKER_LAST_NAME                      18130000
163000                   ,      B.WORKER_FIR_NAME                       18140000
163100                INTO     :RSPBAR-WORKER-LAST-NAME                 18150000
163200                   ,     :RSPBAR-WORKER-FIR-NAME                  18160000
163300                FROM      TMDSEAR A                               18170000
163400                   ,      TRSPBAR B                               18180000
163500                   ,      TAPLAVL C                               18190000
163600               WHERE     (A.DMA_NBR     = :PV-DMA-NBR)            18200000
163700                 AND     (B.RSPLVL_CDE  = :PC-RSPLVL-CDE-DMM)     18210000
163800                 AND     (A.OPERCO_NBR  = :PC-OPERCO-NBR)         18220000
163900                 AND     (C.APLSYS_CDE  = :PC-APLSYS-CDE)         18230000
164000                 AND     (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)         18240000
164100                 AND     (A.MDSEAR_DKEY =  C.MDSEAR_DKEY)         18250000
50 ..              AND     (:ML114-EXTRACT-DTE                          18260000
00 ..                       BETWEEN B.WORKER_STRT_DTE                   18270000
00 ..                       AND     B.WORKER_END_DTE)                   18280000
50 ..              AND     (:ML114-EXTRACT-DTE                          18290000
00 ..                       BETWEEN C.MDSEAR_STRT_DTE                   18300000
00 ..                       AND     C.MDSEAR_END_DTE)                   18310000
W26603             WITH UR                                              18320000
164800         END-EXEC                                                 18330000
164900                                                                  18340000
165000         EVALUATE TRUE                                            18350000
165100             WHEN SQLCODE        = +000                           18360000
165200             WHEN SQLCODE        = -904                           18370000
165300             WHEN SQLCODE        = -911                           18380000
165400                 CONTINUE                                         18390000
165500             WHEN SQLCODE        = +100                           18400000
165600                 DISPLAY 'DMA NUMBER ' PV-DMA-NBR ' NOT FOUND.'   18410000
165700                 MOVE 'OPEN' TO  RSPBAR-WORKER-FIR-NAME           18420000
165800                 MOVE SPACE  TO  RSPBAR-WORKER-LAST-NAME          18430000
165900             WHEN OTHER                                           18440000
166000                 MOVE '8200-GET-DMM-NAME' TO PV-PARAGRAPH-NAME    18450000
166100                 MOVE 'SELECT ROW FROM TRSPBAR  '                 18460000
166200                                          TO PV-DB2-OPER-ATTEMPTED18470000
166300                 PERFORM 9998-SQL-ABEND                           18480000
166400         END-EVALUATE.                                            18490000
167300                                                                  18500000
167400                                                                  18510000
167500 8300-GET-BYR-NAME.                                               18520000
167600                                                                  18530000
168300                                                                  18540000
168400         EXEC SQL                                                 18550000
168500              SELECT      DISTINCT                                18560000
168600                          A.BYR_NBR                               18570000
168700                   ,      B.WORKER_LAST_NAME                      18580000
168800                   ,      B.WORKER_FIR_NAME                       18590000
168900                INTO     :MDSEAR-BYR-NBR                          18600000
169000                   ,     :RSPBAR-WORKER-LAST-NAME                 18610000
169100                   ,     :RSPBAR-WORKER-FIR-NAME                  18620000
169200                FROM      TMDSEAR A                               18630000
169300                   ,      TRSPBAR B                               18640000
169400                   ,      TAPLAVL C                               18650000
169500               WHERE     (A.BYR_NBR     = :PV-BYR-NBR)            18660000
169600                 AND     (A.DEPT_NBR    = :PV-DEPT-NBR)           18670000
169700                 AND     (B.RSPLVL_CDE  = :PC-RSPLVL-CDE-BYR)     18680000
222725                 AND     (A.MDSELV_CDE  = 'DPT')                  18681010
169800                 AND     (A.OPERCO_NBR  = :PC-OPERCO-NBR)         18690000
169900                 AND     (C.APLSYS_CDE  = :PC-APLSYS-CDE)         18700000
170000                 AND     (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)         18710000
170100                 AND     (A.MDSEAR_DKEY =  C.MDSEAR_DKEY)         18720000
50 ..              AND     (:ML114-EXTRACT-DTE                          18730000
00 ..                       BETWEEN B.WORKER_STRT_DTE                   18740000
00 ..                       AND     B.WORKER_END_DTE)                   18750000
50 ..              AND     (:ML114-EXTRACT-DTE                          18760000
00 ..                       BETWEEN C.MDSEAR_STRT_DTE                   18770000
00 ..                       AND     C.MDSEAR_END_DTE)                   18780000
W26603             WITH UR                                              18790000
170800         END-EXEC                                                 18800000
170900                                                                  18810000
171000         EVALUATE TRUE                                            18820000
171100             WHEN SQLCODE        = +000                           18830000
171200             WHEN SQLCODE        = -904                           18840000
171300             WHEN SQLCODE        = -911                           18850000
171400                 CONTINUE                                         18860000
171500             WHEN SQLCODE        = +100                           18870000
171600                 DISPLAY 'BYR NUMBER ' PV-BYR-NBR ' NOT FOUND.'   18880000
171700                 MOVE 'OPEN' TO  RSPBAR-WORKER-FIR-NAME           18890000
171800                 MOVE SPACE  TO  RSPBAR-WORKER-LAST-NAME          18900000
171900             WHEN OTHER                                           18910000
172000                 MOVE '8300-GET-BYR-NAME' TO PV-PARAGRAPH-NAME    18920000
172100                 MOVE 'SELECT ROW FROM TRSPBAR  '                 18930000
172200                                          TO PV-DB2-OPER-ATTEMPTED18940000
172300                 PERFORM 9998-SQL-ABEND                           18950000
172400         END-EVALUATE.                                            18960000
173400                                                                  18970000
173500 8400-GET-MDSEAR-DESC.                                            18980000
173600                                                                  18990000
174400             EXEC SQL                                             19000000
174500                 SELECT     A.MDSEAR_DESC                         19010000
174600                   INTO    :MDSEAR-DESC                           19020000
174700                   FROM     TMDSEAR A                             19030000
174800                      ,     TAPLAVL B                             19040000
174900                  WHERE    (A.GMA_NBR     = :PV-GMA-NBR           19050000
175000                     OR     A.DMA_NBR     = :PV-DMA-NBR           19060000
175100                     OR     A.BYR_NBR     = :PV-BYR-NBR)          19070000
175200                    AND    (A.DEPT_NBR    = :PV-DEPT-NBR)         19080000
175300                    AND    (A.MDSELV_CDE  = :PV-MDSELV-CDE)       19090000
175400                    AND    (A.OPERCO_NBR  = :PC-OPERCO-NBR)       19100000
175500                    AND    (B.APLSYS_CDE  = :PC-APLSYS-CDE)       19110000
175600                    AND    (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)       19120000
                  AND    (:ML114-EXTRACT-DTE                            19130000
                          BETWEEN B.MDSEAR_STRT_DTE                     19140000
                          AND     B.MDSEAR_END_DTE)                     19150000
                  AND    (:ML114-EXTRACT-DTE                            19160000
                          BETWEEN A.STRT_DTE                            19170000
                          AND     A.END_DTE)                            19180000
W26603             WITH UR                                              19190000
176300             END-EXEC                                             19200000
176400                                                                  19210000
176500         EVALUATE TRUE                                            19220000
176600             WHEN SQLCODE        = +000                           19230000
176700             WHEN SQLCODE        = -904                           19240000
176800             WHEN SQLCODE        = -911                           19250000
176900                 CONTINUE                                         19260000
177000             WHEN SQLCODE        = +100                           19270000
177100                 DISPLAY 'DEPT NUMBER ' PV-DEPT-NBR ' NOT FOUND.' 19280000
177200                 MOVE 'NOT FOUND' TO MDSEAR-DESC                  19290000
177300             WHEN OTHER                                           19300000
177400                 MOVE '8400-GET-MDSEAR-DESC'                      19310000
177500                                          TO PV-PARAGRAPH-NAME    19320000
177600                 MOVE 'SELECT DEPARTMENT ROW ON TMDSEAR'          19330000
177700                                          TO PV-DB2-OPER-ATTEMPTED19340000
177800                 PERFORM 9998-SQL-ABEND                           19350000
177900         END-EVALUATE.                                            19360000
178900                                                                  19370000
173500 8500-GET-CLASS-LEVEL-DESC.                                       19380000
173600                                                                  19390000
174400             EXEC SQL                                             19400000
174500                 SELECT     A.MDSEAR_DESC                         19410000
174600                   INTO    :MDSEAR-DESC                           19420000
174700                   FROM     TMDSEAR A                             19430000
174800                      ,     TAPLAVL B                             19440000
174900                  WHERE    (A.GMA_NBR     = :PV-GMA-NBR           19450000
175000                     OR     A.DMA_NBR     = :PV-DMA-NBR           19460000
175100                     OR     A.BYR_NBR     = :PV-BYR-NBR)          19470000
175200                    AND    (A.DEPT_NBR    = :PV-DEPT-NBR)         19480000
175200                    AND    (A.MAJ_CL_NBR  = :PV-CLASS-NBR)        19490000
175300                    AND    (A.MDSELV_CDE  = :PV-MDSELV-CDE)       19500000
175400                    AND    (A.OPERCO_NBR  = :PC-OPERCO-NBR)       19510000
175500                    AND    (B.APLSYS_CDE  = :PC-APLSYS-CDE)       19520000
175600                    AND    (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)       19530000
                  AND    (:ML114-EXTRACT-DTE                            19540000
                          BETWEEN B.MDSEAR_STRT_DTE                     19550000
                          AND     B.MDSEAR_END_DTE)                     19560000
                  AND    (:ML114-EXTRACT-DTE                            19570000
                          BETWEEN A.STRT_DTE                            19580000
                          AND     A.END_DTE)                            19590000
W26603             WITH UR                                              19600000
176300             END-EXEC                                             19610000
176400                                                                  19620000
176500         EVALUATE TRUE                                            19630000
176600             WHEN SQLCODE        = +000                           19640000
176700             WHEN SQLCODE        = -904                           19650000
176800             WHEN SQLCODE        = -911                           19660000
176900                 CONTINUE                                         19670000
177000             WHEN SQLCODE        = +100                           19680000
177100                 DISPLAY 'DEPT NUMBER ' PV-DEPT-NBR ' NOT FOUND.' 19690000
177200                 MOVE 'NOT FOUND' TO MDSEAR-DESC                  19700000
177300             WHEN OTHER                                           19710000
177400                 MOVE '8400-GET-MDSEAR-DESC'                      19720000
177500                                          TO PV-PARAGRAPH-NAME    19730000
177600                 MOVE 'SELECT MAJ CLASS ROW ON TMDSEAR'           19740000
177700                                          TO PV-DB2-OPER-ATTEMPTED19750000
177800                 PERFORM 9998-SQL-ABEND                           19760000
177900         END-EVALUATE.                                            19770000
178900                                                                  19780000
165400                                                                  19790000
165500 8500-OPEN-FSCL-MN-NM-CSR.                                        19800000
165600                                                                  19810000
165700     EXEC SQL                                                     19820000
165800          OPEN FSCL-MN-NM-CSR                                     19830000
165900     END-EXEC.                                                    19840000
166000                                                                  19850000
166100     EVALUATE TRUE                                                19860000
166200         WHEN SQLCODE = ZERO                                      19870000
166300             CONTINUE                                             19880000
166400         WHEN OTHER                                               19890000
166500             MOVE '8500-OPEN-FSCL-MN-NM-CSR'                      19900000
166600                                          TO PV-PARAGRAPH-NAME    19910000
166700             MOVE 'OPEN FSCL-MN-NM-CSR'   TO PV-DB2-OPER-ATTEMPTED19920000
166800             PERFORM 9998-SQL-ABEND                               19930000
166900     END-EVALUATE.                                                19940000
167000                                                                  19950000
167100                                                                  19960000
167200 8600-FETCH-FSCL-MN-NM-CSR.                                       19970000
167300                                                                  19980000
167400     EXEC SQL                                                     19990000
167500         FETCH                                                    20000000
167600             FSCL-MN-NM-CSR                                       20010000
167700         INTO                                                     20020000
167800             :DTATTR-FSCL-MN-NBR                                  20030000
167900            ,:DTATTR-FSCL-MN-NM                                   20040000
168000     END-EXEC.                                                    20050000
168100                                                                  20060000
168200     EVALUATE TRUE                                                20070000
168300         WHEN SQLCODE = ZERO                                      20080000
168400             CONTINUE                                             20090000
168500         WHEN SQLCODE = +100                                      20100000
168600             SET PS-END-OF-FSCL-MN-NM-CSR TO TRUE                 20110000
168700         WHEN OTHER                                               20120000
168800             MOVE '8600-FETCH-FSCL-MN-NM-CSR'                     20130000
168900                                          TO PV-PARAGRAPH-NAME    20140000
169000             MOVE 'FETCH FSCL-MN-NM-CSR'  TO PV-DB2-OPER-ATTEMPTED20150000
169100             PERFORM 9998-SQL-ABEND                               20160000
169200     END-EVALUATE.                                                20170000
169300                                                                  20180000
169400                                                                  20190000
169500 8700-CLOSE-FSCL-MN-NM-CSR.                                       20200000
169600                                                                  20210000
169700     EXEC SQL                                                     20220000
169800         CLOSE FSCL-MN-NM-CSR                                     20230000
169900     END-EXEC.                                                    20240000
170000                                                                  20250000
170100     EVALUATE TRUE                                                20260000
170200         WHEN SQLCODE = ZERO                                      20270000
170300             CONTINUE                                             20280000
170400         WHEN OTHER                                               20290000
170500             MOVE '8700-CLOSE-FSCL-MN-NM-CSR'                     20300000
170600                                          TO PV-PARAGRAPH-NAME    20310000
170700             MOVE 'CLOSE FSCL-MN-NM-CSR'  TO PV-DB2-OPER-ATTEMPTED20320000
170800             PERFORM 9998-SQL-ABEND                               20330000
170900     END-EVALUATE.                                                20340000
171000                                                                  20350000
171100                                                                  20360000
171200* DPPD024 COMBINES SEPARATE FIRST AND LAST NAME FIELDS INTO ONE  *20370000
171300* FIRST/LAST NAME FIELD.                                         *20380000
171400                                                                  20390000
171500     COPY DPPD024..                                               20400000
171600                                                                  20410000
187400                                                                  20420000
187500 9998-SQL-ABEND.                                                  20430000
187600                                                                  20440000
187700     MOVE +4013 TO PV-ABEND-CODE.                                 20450000
187800     DISPLAY '** ABEND **         ** = SQLERROR'.                 20460000
187900     DISPLAY '** PROGRAM          ** = MLKRP201'.                 20470000
188000     DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.       20480000
188100     DISPLAY '** OPERATION        ** = ' PV-DB2-OPER-ATTEMPTED.   20490000
188200                                                                  20500000
188300*    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         20510000
188400*    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        20520000
188500     COPY DPPD004.                                                20530000
188600                                                                  20540000
188700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         20550000
173200                                                                  20560000
173200 9999-ABEND.                                                      20570000
173300                                                                  20580000
173400     CALL 'ILBOABN0'  USING PV-ABEND-CODE.                        20590000
