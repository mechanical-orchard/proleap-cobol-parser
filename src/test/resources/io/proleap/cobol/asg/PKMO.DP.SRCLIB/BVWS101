      *****************************************************************         
      *  BVWS101 - BV BEGINNING OF MONTH LOOKUP WORKING STORAGE.                
      *                                                                         
      *-----------------------------------------------------------------        
      * CHG ID/                                                        *        
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *        
      * -------  ----------  ----------------------------------------  *        
      * WR34517  2008-05-12  J SELWITSCHKA                             *        
      *                      INITIAL IMPLEMENTATION                    *        
      *                                                                *        
      *-----------------------------------------------------------------        
      *PURPOSE: BV BEGINNING OF MONTH LOOKUP WORKING STORAGE COPY CODE.         
      *                                                                         
      *NOTE:    REFER TO MODULE BVPD100 FOR EACH PROCESSING OPTION.             
      *         THE INPUT FIELDS WILL BE INITIALIZED AFTER EACH                 
      *         CALL TO THE ROUTINE.                                            
      *                                                                         
      *         THIS MODULE USES THE BRAND VENDOR RELATIONSHIP UTILITY          
      *         (BVPD001) TO GET THE BRAND VENDOR RELATIONSHIP. ANY             
      *         PROGRAM THAT USES THIS MODULE MUST ALSO USE COPYBOOKS           
      *         BVPD001 AND BVWS001.                                            
      *                                                                         
      *-----------------------------------------------------------------        
      *  HOW TO USE THIS COPYBOOK WITH BVPD100:                                 
      *-----------------------------------------------------------------        
      *  1.  FILL THE INPUT FIELDS WITH THE DATA REQUIRED TO RETRIEVE           
      *      THE BEGINNING OF MONTH DATA:                                       
      *                                                                         
      *      IF DOING LOOKUP USING SKU:                                         
      *      - SET BV101-PV-SKU-LOOKUP TO TRUE.                                 
      *        FILL BV101-PV-SKU-IN. (REQUIRED FOR SKU LOOKUP)                  
      *      IF DOING LOOKUP USING ITM-NBR:                                     
      *      - SET BV101-PV-ITM-LOOKUP TO TRUE.                                 
      *        FILL BV101-PV-ITM-NBR-IN. (REQUIRED FOR ITM LOOKUP)              
      *      EFFECTIVE DATE (NOT REQUIRED)                                      
      *      - BV101-PV-EFF-DTE-IN (IF NOT FILLED, CURRENT DATE WILL BE         
      *        USED).                                                           
      *                                                                         
      *  2.  BEGINNING OF MONTH LOOKUP.                                         
      *      A.  INPUT(S) BUILD.                                                
      *      - IF DATE IS NOT PROVIDED, GET THE CURRENT DATE.                   
      *      - USE THE DATE PASSED OR THE CURRENT DATE TO OBTAIN THE            
      *        BEGINNING OF MONTH DATE FROM THE DATE ATTRIBUTE TABLE            
      *        (TDTATTR).                                                       
      *      - FOR SKU LOOKUP, USE SKU-NBR AND BEGINNING OF MONTH DATE          
      *        TO GET BRAND AND VENDOR FROM THE BOM TABLE                       
      *        (XMT_BOM_SKU_ATTR).                                              
      *      - FOR ITM LOOKUP, USE ITM-NBR AND BEGINNING OF MONTH DATE          
      *        TO GET BRAND AND VENDOR FROM THE BOM TABLE.                      
      *        (XMT_BOM_SKU_ATTR).                                              
      *                                                                         
      *      - ENTRY PROCEDURE: BV101-LOOKUP-BOM                                
      *                                                                         
      *      B.  RESULTS.                                                       
      *      - BOM LOOKUP RETURN CODE VARIABLES ARE DEFINED HERE.               
      *        (BV101-PV-COMMON-AREA)                                           
      *         - RETURN STATUS CODE                                            
      *         - RETURN STATUS CODE REASON TEXT                                
      *                                                                         
      *      - ON A SUCCESSFUL EXECUTION THE FOLLOWING DATA WILL BE             
      *        MOVED TO THE FOLLOWING WORKING STORAGE FIELDS                    
      *        (BV101-PRICE-RESULT-AREA)                                        
      *         - ENT ID (VENDOR)           BV101-BOM-ENT-ID-OUT                
      *         - LBL SEQ NBR (BRAND)       BV101-BOM-LBL-SEQ-NBR-OUT           
      *         - ML LO MDSE LVL ID         BV101-BOM-LO-MDSE-LVL-ID-OUT        
      *           (BV RELATIONSHIP ID OR DKEY)                                  
      *         - DEPT NBR                  BV101-BOM-DEPT-NBR-OUT              
      *         - MAJ CLASS                 BV101-BOM-MAJ-CL-OUT                
      *         - SUB CLASS                 BV101-BOM-SUB-CL-OUT                
      *                                                                         
      *      - THE BEGINNING-OF-MONTH DATE WILL BE RETURNED IN A                
      *        SEPARATE AREA (ASSIGNED ONCE ON THE FIRST PERFORM OF             
      *        THE MODULE)                                                      
      *         - BEGINNING OF MONTH DATE   BV101-BOM-FSCL-DTE-OUT              
      *-----------------------------------------------------------------        
      *                                                                         
      *  3.  ERROR HANDLING PASSED TO THE SOURCE MODULE.                        
      *                                                                         
      ******************************************************************        
                                                                                
       01  BV101-PV-PROGRAM-VARIABLE.                                           
           05  BV101-PV-MAX-RETRIES    PIC S9(03) VALUE +03 COMP-3.     INKUT102
           05  BV101-PV-INPUT-AREA.                                             
               10  BV101-PV-LOOKUP-TYPE-IN PIC X(06)   VALUE SPACES.            
                   88  BV101-PV-NO-LOOKUP-TYPE         VALUE SPACES.            
                                                                                
                   88  BV101-PV-BOM-LOOKUP             VALUES                   
                       'SKU   ', 'ITM   '.                                      
                   88  BV101-PV-SKU-LOOKUP             VALUE 'SKU   '.          
                   88  BV101-PV-ITM-LOOKUP             VALUE 'ITM   '.          
                                                                                
               10  BV101-PV-EFF-BEG-DTE-IN.                                     
                   15  BV101-PV-EFF-BEG-DTE-CCYY PIC X(04).                     
                   15  FILLER                    PIC X(01).                     
                   15  BV101-PV-EFF-BEG-DTE-MM   PIC X(02).                     
                   15  FILLER                    PIC X(01).                     
                   15  BV101-PV-EFF-BEG-DTE-DD   PIC X(02).                     
               10  BV101-PV-EFF-BEG-DTE-X REDEFINES                             
                   BV101-PV-EFF-BEG-DTE-IN       PIC X(10).                     
                                                                                
               10  BV101-PV-EFF-END-DTE-IN.                                     
                   15  BV101-PV-EFF-END-DTE-CCYY PIC X(04).                     
                   15  FILLER                    PIC X(01).                     
                   15  BV101-PV-EFF-END-DTE-MM   PIC X(02).                     
                   15  FILLER                    PIC X(01).                     
                   15  BV101-PV-EFF-END-DTE-DD   PIC X(02).                     
               10  BV101-PV-EFF-END-DTE-X REDEFINES                             
                   BV101-PV-EFF-END-DTE-IN       PIC X(10).                     
                                                                                
               10  BV101-PV-SKU-IN         PIC X(08) VALUE SPACES.              
               10  BV101-PV-SKU-IN-NUM REDEFINES                                
                   BV101-PV-SKU-IN         PIC 9(08).                           
               10  FILLER REDEFINES BV101-PV-SKU-IN.                            
                   15  FILLER              PIC X(05).                           
                   15  FILLER              PIC X(03).                           
                       88  BV101-PV-DUMMY-SKU    VALUES '000' '999'.            
                                                                                
               10  BV101-PV-ITM-NBR-IN     PIC X(15) VALUE SPACES.              
               10  BV101-PV-ITM-NBR-IN-NUM REDEFINES                            
                   BV101-PV-ITM-NBR-IN     PIC 9(15).                           
                                                                                
               10  BV101-PV-EFF-DTE-IN     PIC X(10) VALUE SPACES.              
               10  BV101-PV-ENT-ID-IN      PIC X(09) VALUE SPACES.              
               10  BV101-PV-ENT-ID-IN-9 REDEFINES                               
                   BV101-PV-ENT-ID-IN      PIC 9(09).                           
                                                                                
               10  BV101-PV-DEPT-IN        PIC X(04)       VALUE SPACES.        
               10  BV101-PV-DEPT-IN-9 REDEFINES BV101-PV-DEPT-IN                
                                           PIC 9(04).                           
               10  FILLER REDEFINES BV101-PV-DEPT-IN.                           
                   15  FILLER              PIC X(01).                           
                   15  BV101-PV-DEPT-IN-3X PIC X(03).                           
                   15  BV101-PV-DEPT-IN-3X-9 REDEFINES                          
                       BV101-PV-DEPT-IN-3X PIC 9(03).                           
                                                                                
           05  BV101-PV-COMMON-AREA.                                            
               10  BV101-PV-SQL-SUB        PIC 9(03)  VALUE ZERO.       INKUT102
               10  BV101-PV-RETURN-STATUS-AREA.                                 
                   15  BV101-PV-BOM-SQLCDE PIC S9(9) COMP-4 VALUE ZEROS.        
                   15  BV101-PV-BOM-RTNCDE PIC S9(04) COMP VALUE +08.           
                       88  BV101-PV-BOM-FOUND         VALUES ZEROS, +04.        
                       88  BV101-PV-BOM-FOUND-AS-RQSTD     VALUE ZEROS.         
                       88  BV101-PV-BOM-FOUND-WITH-ASSMPT  VALUE +04.           
                       88  BV101-PV-BOM-NOT-FOUND          VALUE +08.           
                       88  BV101-PV-BOM-SQL-ERROR          VALUE +16.           
                       88  BV101-PV-BOM-ERROR              VALUE +20.           
                   15  BV101-PV-RTNCDE-DKEY-RTNCDE                              
                                           PIC S9(04) COMP VALUE ZEROS.         
                       88  BV101-PV-DKEY-FOUND             VALUE ZEROS.         
                       88  BV101-PV-DKEY-FOUND-NO-EFF      VALUE +04.           
                       88  BV101-PV-DKEY-UNKN-BRAND        VALUE +08.           
                       88  BV101-PV-DKEY-UNKN-UNKN         VALUE +12.           
                       88  BV101-PV-DKEY-UNKN-NOT-FOUND    VALUE +16.           
                   15  BV101-PV-RTNCDE-DKEY-ZERO                                
                                           PIC S9(04) COMP VALUE ZEROS.         
                       88  BV101-PV-DKEY-ZERO-NOT-FOUND    VALUE ZEROS.         
                       88  BV101-PV-DKEY-ZERO-FOUND        VALUE +04.           
                       88  BV101-PV-DKEY-ZERO-NO-EFF-FND   VALUE +08.           
                   15  BV101-PV-RETURN-RSN PIC X(40)       VALUE SPACES.        
      *** ANY NEW 'ERROR RELATED' BV101-PV-RETURN-RSN NEED TO INCLUDE           
      *** IN THE BV101-PV-INVALID-KEY-INPUT LEVEL 88...                         
                       88  BV101-PV-INVALID-KEY-INPUT      VALUES ARE           
                           'LOOKUP TYPE MISSING OR INVALID          ',          
                           'THE DATE IS INVALID                     ',          
                           'THE SKU-NBR IS MISSING OR INVALID       ',          
                           'THE DATE IS INVALID                     ',          
                           'THE ITM-NBR IS MISSING OR INVALID       ',          
                           'CURSOR OPEN ISSUE                       ',          
                           'CURSOR FETCH ISSUE                      ',          
                           'CURSOR CLOSE ISSUE                      ',          
                           'DEADLOCK ERROR                          ',          
                           'AN UNDEFINED SQLCODE ERROR IS PRESENT   '.          
      *** VALID RETURN MESSAGES....                                             
                       88  BV101-PV-BOM-FOUND-VALID        VALUE                
                           'BOM DATA FOUND                          '.          
                       88  BV101-PV-BOM-NOT-FOUND-VALID    VALUE                
                           'BOM DATA NOT FOUND                      '.          
                       88  BV101-PV-BV-RELATION-NOT-FOUND  VALUE                
                           'BV RELATIONSHIP NOT FOUND               '.          
      *** INVALID "ERROR" RETURN MESSAGES....                                   
                       88  BV101-PV-INVALID-LOOKUP-TYPE    VALUE                
                           'LOOKUP TYPE MISSING OR INVALID          '.          
                       88  BV101-PV-INVALID-DTE            VALUE                
                           'THE DATE IS INVALID                     '.          
                       88  BV101-PV-INVALID-SKU            VALUE                
                           'THE SKU-NBR IS MISSING OR INVALID       '.          
                       88  BV101-PV-INVALID-ITM            VALUE                
                           'THE ITM-NBR IS MISSING OR INVALID       '.          
                       88  BV101-PV-CURSOR-OPEN            VALUE                
                           'CURSOR OPEN ISSUE                       '.          
                       88  BV101-PV-CURSOR-FETCH           VALUE                
                           'CURSOR FETCH ISSUE                      '.          
                       88  BV101-PV-CURSOR-CLOSE           VALUE                
                           'CURSOR CLOSE ISSUE                      '.          
                       88  BV101-PV-DEADLOCK               VALUE                
                           'DEADLOCK ERROR                          '.          
                       88  BV101-PV-UNDEFINED-SQL-ERROR    VALUE                
                           'AN UNDEFINED SQLCODE ERROR IS PRESENT   '.          
                                                                                
               10  BV101-PS-LOOKUP-SWITCHES.                                    
                   15  BV101-PS-BOM-FOUND-SW  PIC X(01)     VALUE 'Y'.          
                       88  BV101-PS-BOM-NOT-FOUND           VALUE 'N'.          
                       88  BV101-PS-BOM-FOUND               VALUE 'Y'.          
                                                                                
                                                                                
           05  BV101-PC-CONTSANT-AREA.                                          
               10  BV101-PV-PARAGRAPH  PIC X(100) VALUE SPACES.                 
               10  BV101-PC-UNKNOWN-VENDOR   PIC S9(09) VALUE +5161             
                                             COMP.                              
               10  BV101-PC-UNKNOWN-BRAND    PIC S9(04) VALUE +2230             
                                             COMP.                              
                                                                                
           05  BV101-BOM-RESULT-AREA.                                           
               10  BV101-BOM-ENT-ID-OUT      PIC S9(9) COMP VALUE ZEROS.        
               10  BV101-BOM-LBL-SEQ-NBR-OUT PIC S9(4) COMP VALUE ZEROS.        
               10  BV101-BOM-LO-MDSE-LVL-ID-OUT                                 
                                             PIC S9(9) COMP VALUE ZEROS.        
               10  BV101-BOM-DEPT-NBR-OUT    PIC S9(4) COMP-3 VALUE +0.         
               10  BV101-BOM-MAJ-CL-OUT      PIC S9(4) COMP-3 VALUE +0.         
               10  BV101-BOM-SUB-CL-OUT      PIC S9(4) COMP-3 VALUE +0.         
               10  FILLER                    PIC X(80) VALUE SPACES.            
                                                                                
           05  BV101-DB2-DEPT-NBR            PIC S9(4) COMP-3 VALUE +0.         
           05  BV101-BOM-FSCL-DTE-OUT        PIC X(10) VALUE SPACES.            
                                                                                
           05  BV101-PS-NEW-BOM-DTE-SW       PIC X(01)  VALUE 'Y'.              
               88  BV101-PS-NEW-BOM-DTE-NO              VALUE 'N'.              
               88  BV101-PS-NEW-BOM-DTE-YES             VALUE 'Y'.              
                                                                                
           05  BV101-PV-WORK-AREA.                                              
               10  BV101-PV-BEG-FSCL-DTE PIC X(10) VALUE SPACES.                
               10  BV101-PV-END-FSCL-DTE PIC X(10) VALUE SPACES.                
               10  BV101-PV-MIN-RECLS-TMST  PIC X(26) VALUE SPACES.             
               10  BV101-PV-WORK-RETAIL  PIC S9(7)V9(2) COMP-3                  
                                                      VALUE ZEROS.              
               10  BV101-PV-MITGPL-QTY   PIC S9(4) COMP.                        
               10  BV101-PV-MITGPL-GP-AMT PIC S9(5)V9(2) COMP-3.                
               10  BV101-PV-WORK-SKU     PIC S9(08)V COMP-3 VALUE ZEROS.        
               10  BV101-PV-DUMB-SKU     PIC 9(08)          VALUE ZEROS.        
               10  BV101-PV-DUMB-SKU-X REDEFINES                                
                   BV101-PV-DUMB-SKU     PIC X(08).                             
               10  BV101-PV-WORK-UPC-NBR PIC S9(15)V COMP-3 VALUE ZEROS.        
               10  BV101-PV-WORK-UPC-ID  PIC S9(09) COMP VALUE ZEROS.           
               10  BV101-PV-WORK-ITM-NBR PIC S9(15)V COMP-3 VALUE ZEROS.        
                                                                                
               10  BV101-CONVERT-MCL           PIC 9(04) VALUE ZEROS.           
               10  BV101-PV-WORK-MCL           PIC X(04) VALUE SPACES.          
               10  BV101-PV-WORK-MCL-9 REDEFINES                                
                   BV101-PV-WORK-MCL           PIC 9(04).                       
               10  FILLER REDEFINES BV101-PV-WORK-MCL.                          
                   15  FILLER                  PIC X(01).                       
                   15  BV101-PV-WORK-MCL-3X    PIC X(03).                       
                   15  BV101-PV-WORK-MCL-3X-9 REDEFINES                         
                       BV101-PV-WORK-MCL-3X    PIC 9(03).                       
               10  FILLER2 REDEFINES BV101-PV-WORK-MCL.                         
                   15  FILLER                  PIC X(02).                       
                   15  BV101-PV-WORK-MCL-2X    PIC X(02).                       
                   15  BV101-PV-WORK-MCL-2X-9 REDEFINES                         
                       BV101-PV-WORK-MCL-2X    PIC 9(02).                       
                                                                                
               10  BV101-CONVERT-DEPT          PIC 9(04) VALUE ZEROS.           
               10  BV101-PV-WORK-DEPT          PIC X(04) VALUE SPACES.          
               10  BV101-PV-WORK-DEPT-9 REDEFINES                               
                   BV101-PV-WORK-DEPT          PIC 9(04).                       
               10  FILLER REDEFINES BV101-PV-WORK-DEPT.                         
                   15  FILLER                  PIC X(01).                       
                   15  BV101-PV-WORK-DEPT-3X   PIC X(03).                       
                   15  BV101-PV-WORK-DEPT-3X-9 REDEFINES                        
                       BV101-PV-WORK-DEPT-3X   PIC 9(03).                       
                                                                                
               10  BV101-CONVERT-SCL           PIC 9(04) VALUE ZEROS.           
               10  BV101-PV-WORK-SCL           PIC X(04) VALUE SPACES.          
               10  BV101-PV-WORK-SCL-9 REDEFINES                                
                   BV101-PV-WORK-SCL           PIC 9(04).                       
               10  FILLER REDEFINES BV101-PV-WORK-SCL.                          
                   15  FILLER                  PIC X(01).                       
                   15  BV101-PV-WORK-SCL-3X    PIC X(03).                       
                   15  BV101-PV-WORK-SCL-3X-9 REDEFINES                         
                       BV101-PV-WORK-SCL-3X    PIC 9(03).                       
                                                                                
               10  BV101-PV-WORK-INHOUSE PIC S9(03)V COMP-3 VALUE ZEROS.        
                                                                                
           05  BV101-CONVERT-UPC         PIC S9(15) COMP VALUE ZEROES.          
           05  BV101-CONVERT-UPC-9       PIC 9(15) VALUE ZEROES.                
                                                                                
           05  BV101-TEMP-UPC.                                                  
               10  FILLER                    PIC 9(02).                         
               10  BV101-TEMP-UPC-KOHL-UPC   PIC 9(04).                         
               10  BV101-TEMP-UPC-SKU        PIC 9(08).                         
               10  BV101-TEMP-UPC-CHK-DIGIT  PIC 9(01).                         
                                                                                
           05  BV101-PV-EFF-BEG-DTE-TMST.                                       
               10  BV101-PV-EFF-BEG-DTE    PIC  X(10) VALUE SPACES.             
               10  FILLER                  PIC  X(16) VALUE                     
                                                 '-23.59.59.999999'.            
                                                                                
           05  BV101-PV-EFF-END-DTE-TMST.                                       
               10  BV101-PV-EFF-END-DTE    PIC  X(10) VALUE SPACES.             
               10  FILLER                  PIC  X(16) VALUE                     
                                                 '-23.59.59.999999'.            
                                                                                
      ******************** END OF BVWS101 COPYBOOK *********************        
