      *-----------------------*                                         12/16/94
00002  IDENTIFICATION DIVISION.                                         INKCS005
00003 *-----------------------*                                            LV001
00004  PROGRAM-ID.    INKCS005.                                         INKCS005
00005  AUTHOR.        M. FURLICK - STRATAGEM                            INKCS005
00006  INSTALLATION.  KOHLS DEPARTMENT STORES.                          INKCS005
00007  DATE-WRITTEN.  07-28-93.                                         INKCS005
00008  DATE-COMPILED.                                                   INKCS005
00009                                                                   INKCS005
00010 *----------------------------------------------------------------*INKCS005
00011 *    I005 - PHYSICAL INVENTORY INVALID DATA DETAIL UPDATE.       *INKCS005
00012 *                                                                *INKCS005
00013 *    THIS PROGRAM IS INVOKED FROM INKCS004 AND DISPLAYS THE      *INKCS005
00014 *    SELECTED DATA, ONE LINE ITEM AT A TIME.  THE USER MAY CHANGE*INKCS005
00015 *    THE SKU, UPC QUANTITY, AND/OR PRICE.  IF THE SKU IS CHANGED *INKCS005
00016 *    TO A CLEARANCE ITEM, THE USER MUST ENTER THE PRICE AS WELL. *INKCS005
00017 *                                                                *INKCS005
00018 *----------------------------------------------------------------*INKCS005
00019 *    3/94   - CHANGE BY M BLAZICH                                *INKCS005
00020 *                                                                *INKCS005
00021 *    ADDED SCAN-LINE-NBR AND INV-LINE-NBR TO COMMAREA            *INKCS005
00022 *    AND SQL CALLS TO AVOID DUPLICATES                           *INKCS005
00023 *    ALSO EXPANDED EXTD_AMT COLUMN ON TADJDTL                    *INKCS005
00024 *----------------------------------------------------------------*INKCS005
00025 *    8/5/94 - CHANGE BY KIM WRIGHT                               *INKCS005
00026 *                                                                *INKCS005
00027 *    ALLOW THE USER TO 'DELETE' INVALID DETAIL RECORDS.  CHANGES *INKCS005
00028 *    MADE FOR THE DELETE SCREEN: NO ENTERABLE FIELDS, PF2 CONFIRMSINKCS005
00029 *    DELETION.  THE INVALID INDICATORS ON THE TINVDTL DB2 TABLE  *INKCS005
00030 *    ARE UPDATED TO 'N' STATUS, INSTEAD OF ACTUALLY DELETING THE *INKCS005
00031 *    RECORD FROM THE TABLE (FOR AUDIT PURPOSES).  PARAGRAPHS     *INKCS005
00032 *    CHANGED: 2000-PROCESS-PANEL, 3200-RESET-ATTRIBUTES,         *INKCS005
00033 *    4000-BUILD-INITIAL-PANEL.  NEW PARAGRAPH: 5600-DB2-COMMIT.  *INKCS005
00034 *----------------------------------------------------------------*INKCS005
00035 *    9/16/94 -  KIM WRIGHT                                        INKCS005
00036 *  CHANGED THE SELECTION OF CUTOFF PRICE ON THE TSKST TABLE TO  * INKCS005
00037 *  SELECT FROM STORE '000' INSTEAD OF THE SPECIFIC STORE        * INKCS005
00034 *----------------------------------------------------------------*INKCS005
00035 *    3/21/99 -  SCOTT JACKSON                                    *INKCS005
00036 *  CHANGED THE SELECTION OF CUTOFF PRICE ON THE TSKST TABLE TO   *INKCS005
00037 *  SELECT FROM SPECIFIC STORE INSTEAD OF STORE '000'             *INKCS005
00038 *----------------------------------------------------------------*INKCS005
00035 *   10/20/99 -  JULIE SEIDLER                                    *INKCS005
00036 *  CHANGED THE PGM TO OBTAIN CUTOFF PRICE AND STATUS FROM THE     INKCS005
00037 *  TUPCPLS TABLE                                                 *INKCS005
00038 *----------------------------------------------------------------*INKCS005
IN2001* 09/25/2000  SCOTT JACKSON      CHG ID:IN2001                  *         
IN2001*  AN ITEM IN RCP STATUS MAY BE RETURNED TO NON-RCP STATUS      *         
IN2001*  PRIOR TO PROCESSING ALL OF THE STORE'S DATA. THEREFORE USING *         
IN2001*  TSK.REGN_PRICE_IND AS THE IND TO OBTAINING CURRENT PRICE MAY *         
IN2001*  BE INCORRECT AND UNRELIABLE BASED ON WHEN DATA IS PROCESSED. *         
IN2001*  TUPCPLS WILL BE USED SOLELY IN DETERMINING AN ITEM'S STATUS. *         
IN2001*  CHECK STORE 000 ROW 1ST (IF STATUS = '25' - THEN CHECK FOR   *         
IN2001*  STORE-SPECIFIC ROW). USE STORE 000 PRICING IF NO STORE ROW.  *         
IN2001*  IF STATUS <> '25' THEN STORE-SPECIFIC ROW WILL NOT BE CHECKED*         
IN2001*---------------------------------------------------------------*         
W03072* 03/07/2002  ROD JANSSEN        CHG ID:99999                             
W03072*  BUILD IN EFFICIENCIES TO TUPCPLS (PER BRAD DORN - DBA)                 
W03072*----------------------------------------------------------------*        
W21732* 10/24/2002 IGSI                WR #  21732                     *INKCS005
W21732*                                                                *        
W21732*       CHANGED THE PROGRAM TO DISPLAY AND ACCEPT THE NON-       *INKCS005
W21732*       INTELLIGENT  SKU INSTEAD OF DEPT/CLASS/SEQ NUMBER.       *        
W21732*----------------------------------------------------------------*INKCS005
C21732* 10/24/2002 S.JACKSON           WR # C21732                     *INKCS005
C21732*       USE UPC CHCK FOR CHECK DIGIT COMPUTATION                          
C21732*----------------------------------------------------------------*INKCS005
R21732* 04/18/2003 S.JACKSON           WR # R21732                     *INKCS005
R21732*       FIX CODE FROM OFFSHORE CHANGES                                    
R21732*----------------------------------------------------------------*INKCS005
RMCD01* 06/27/2003 R.MCDONALD          WR #          CHGID RMCD01      *INKCS005
RMCD01*                                                                *INKCS005
RMCD01*       WHEN THE INVENTORIED UPC IS AN INVALID AND THE           *INKCS005
RMCD01*       CORRECTION IS A DUMMY SKU, VARIABLES WERE NOT BEING      *INKCS005
RMCD01*       SET CORRECTLY TO VERIFY THAT DEPT, CLASS, AND MAJOR      *INKCS005
RMCD01*       CLASS OF THE DUMMY SKU WERE VALID.  THE VALUES WERE      *INKCS005
RMCD01*       JUNK.  CORRECTED THE CODE TO MAP THE DEPT, AND CLASS     *INKCS005
RMCD01*       CORRECTLY SO THAT THE DEPT AND CLASS COULD BE FOUND.     *INKCS005
R21732*----------------------------------------------------------------*INKCS005
25248 * 25248    10-06-2003  UPC CAPABILITIES                                   
25248 *                      -ROD JANSSEN                                       
      * 26600    04-20-2004  STORE NUMBER EXPANSION FOR INV. LEDGER             
      *                      TEMPORARILY ADD LOC-NBR TO INSERT STMT             
      *                      -V. LEE YANG                                       
W26600* W26600   06-29-2004  INV STORE EXPANSION                                
W26600*                      -ROD JANSSEN                                       
J28545* J28545   05-30-2006  USE THE PRICING MODULE, INPD400, TO LOOK           
J28545*                      UP PRICE AND VALIDATE SKU OR UPC.                  
J28545* W28545 06-16-2006    TINVPAR/TINCNTL ARE USED TO GET THE                
J28545*                      PROPER INV-ID AND STORE                            
J28545*                      -JAN BLAZICH                                       
X28545* W28545 08-11-2006 ROD JANSSEN     NOT SHOWING SKU WHEN UPC IS           
X28545*                                ENTERED                                  
X28545*                                   THE PRICE IS CLEARED WHEN             
X28545*                                ENTERED AND THE ENTER KEY IS             
X28545*                                SELECTED                                 
X28545*                                   NOT FINDING CORP SKU_DLT PRC          
X28545*                                PROPERLY.                                
X28545*                                   AZRA ABEND WITH DUMMY SKU(S)          
X28545*                                AND TRAVELING FROM SUMMARY/LIST          
X28545*                                SCREENS TO THE UPDATE SCREENS.           
32318 * W32318 02-22-2007 ROD JANSSEN  INVALID CORRECTION SCREENS ARE           
32318 *                                NOT TESTING FOR PLU = 'N'. ADD AN        
32318 *                                ERROR LOGIC TO ACCOMPLISH THIS.          
J32318* W32318 03-12-2007 JILL LIN     REMOVE CLEARANCE AREA EDIT.              
      * W33304 05-01-2008 JILL LIN     HOLDING INVENTORY LEDGER OPEN            
      *                                ACROSS PERIODS INVENTORY SHORTAGE        
      *                                REPORTING                                
RMCD01*----------------------------------------------------------------*INKCS005
RONNA * PITS 1029440                                                            
RONNA *        06-05-2007 RONNA      - FIX SO THAT CORP INVALID                 
RONNA *                   MCDONALD     WILL NOT ERR OUT IN INK407.              
RONNA *                                MAP THE DUMMY UPC AND BUILD THE          
RONNA *                                DUMMY SKU BASED ON WHAT CAME             
RONNA *                                IN FROM THE INVENTORY SERVICE.           
RONNA *                                CORPORATE INVALIDS - ONLY PRICE          
RONNA *                                CAN GET ENTERED.                         
RMCD01*----------------------------------------------------------------*INKCS005
263126* CHANGED 10/25/2021    BY JIM HUNTER      WR: CHG0263126                 
263126* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263126* MAKING THE CALL DYNAMIC VS STATIC.                                      
263126*----------------------------------------------------------------*   CL*17
1022RM* CHANGED 10/26/2022    BY BOB MCASEY      WR: CHG0277188                 
1022RM* ADDED THE DPKCS930 COPYBOOK. CHANGED THE PARAMETERS FOR CALLING         
1022RM* THE CICS ARCHITECTURE API.                                              
1022RM*---------------------------------------------------------------*   CL*17 
00038** CHANGED 02/14/2023    BY JEAN KURK       WR: CHG0281369                 
00038**    CHANGE THE CALL OF UPC CHECK DIGIT ROUTINE TO DYNAMIC                
00038**---------------------------------------------------------------*   CL*17 
00039                                                                   INKCS005
00041  ENVIRONMENT DIVISION.                                            INKCS005
00043  DATA DIVISION.                                                   INKCS005
00045                                                                   INKCS005
00046  WORKING-STORAGE SECTION.                                         INKCS005
00047  01  PC-PROGRAM-CONSTANTS.                                        INKCS005
00048      05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'INKCS005'.  INKCS005
00049      05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'IN005A  '.  INKCS005
00050      05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'INKM005 '.  INKCS005
00051      05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           INKCS005
00052                                               COMP.               INKCS005
00053      05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           INKCS005
00054                                               COMP.               INKCS005
00055      05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE  +1           INKCS005
00056                                               COMP.               INKCS005
00057      05  PC-MAX-EXTD-AMT          PIC S9(09)V99 COMP-3            INKCS005
00058                                               VALUE +999999999.99.INKCS005
00059      05  PC-MAX-PRICE             PIC S9(05)V99 COMP-3            INKCS005
00060                                               VALUE +99999.99.    INKCS005
00061      05  PC-TWENTY-ONE-CENTS      PIC S9(05)V99 COMP-3            INKCS005
00062                                               VALUE +.21.         INKCS005
00063 *    05  PC-STORE-000             PIC X(03)   VALUE '000'.        INKCS005
IN2001     05  PC-STORE-000             PIC S9(04) COMP       VALUE +0.         
00064      05  PC-INTER-APPL-CODES.                                     INKCS005
00065          10  PC-INTER-APPL-CRIT-SPEC                              INKCS005
00066                                   PIC  X(01)  VALUE '1'.          INKCS005
00067          10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '2'.          INKCS005
00068      05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       INKCS005
00069      05  PC-NINES                 PIC  X(08)  VALUE ALL '9'.      INKCS005
JS1099     05  PC-98                    PIC  X(02)  VALUE '98'.         INKCS005
JS1099     05  PC-30                    PIC  X(02)  VALUE '30'.         INKCS005
IN2001     05  PC-25                    PIC  X(02)  VALUE '25'.         INKCS003
00072      05  PC-8999                  PIC  9(05)  VALUE 8999.         INKCS005
00073      05  PC-9000                  PIC  9(05)  VALUE 9000.         INKCS005
00074      05  PC-9999                  PIC  9(05)  VALUE 9999.         INKCS005
00075      05  PC-10000                 PIC  9(05)  VALUE 10000.        INKCS005
00076      05  PC-15                    PIC  9(02)  VALUE 15.           INKCS005
00077      05  PC-9                     PIC  9(01)  VALUE 9.            INKCS005
00078      05  PC-7                     PIC  9(01)  VALUE 7.            INKCS005
W21732     05  PC-8                     PIC  9(01)  VALUE 8.            INKCS005
00080      05  PC-2                     PIC  9(01)  VALUE 2.            INKCS005
00080      05  PC-03                    PIC  X(02)  VALUE '03'.         INKCS005
00081      05  PC-CO                    PIC  X(02)  VALUE 'CO'.         INKCS005
00082      05  PC-CORRECTION            PIC  X(10)  VALUE 'CORRECTION'. INKCS005
00083      05  PC-N                     PIC  X(01)  VALUE 'N'.          INKCS005
00084      05  PC-Y                     PIC  X(01)  VALUE 'Y'.          INKCS005
00085      05  PC-SCL                   PIC  X(03)  VALUE 'SCL'.        INKCS005
W03072     05  PC-ZERO-STORE           PIC S9(4)    VALUE +0 COMP.              
W03072**** 05  PC-ZERO-STORE           PIC S9(9)    VALUE +0 COMP.              
JS1099     05  PC-NULL-DATE            PIC X(10)    VALUE '9999-09-09'.         
00086                                                                   INKCS005
00087      05  PC-TSYMSG-NUMBERS.                                       INKCS005
00088          10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       INKCS005
J28545* 00004 = PRESS F2 TO CONFIRM REQUEST                                     
00089          10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       INKCS005
00090          10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       INKCS005
00091          10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       INKCS005
00092          10  PC-TSYMSG-00010      PIC  9(05)  VALUE  00010.       INKCS005
00093          10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       INKCS005
00094          10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       INKCS005
00095          10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       INKCS005
00096          10  PC-TSYMSG-00073      PIC  9(05)  VALUE  00073.       INKCS005
00097          10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       INKCS005
J28545*  APPLICATION SYSTEM DOES NOT EXIST                                      
00098          10  PC-TSYMSG-00100      PIC  9(05)  VALUE  00100.       INKCS005
00099          10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       INKCS005
J28545*  DELETE SUCCESSFUL                                                      
00100          10  PC-TSYMSG-00116      PIC  9(05)  VALUE  00116.       INKCS005
J28545*  CANNOT DELETE - RECORD DOES NOT EXIST                                  
00101          10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       INKCS005
00102          10  PC-TSYMSG-00302      PIC  9(05)  VALUE  00302.       INKCS005
J28545*  DATA ENTERED IN THE 'KEY' FIELD IS INVALID                             
00103          10  PC-TSYMSG-00316      PIC  9(05)  VALUE  00316.       INKCS005
J28545*  INVALID CHECK DIGIT.                                                   
00104          10  PC-TSYMSG-00388      PIC  9(05)  VALUE  00388.       INKCS005
J28545*  ONLY ONE REPLACEABLE SYMBOLIC VARIABLE (&VAR) CAN BE ENTERED           
00105          10  PC-TSYMSG-00410      PIC  9(05)  VALUE  00410.       INKCS005
J28545*  SKU RENUMBERED - NEW NUMBER IS: &VAR                                   
J28545         10  PC-TSYMSG-00453      PIC  9(05)  VALUE  00453.               
00106          10  PC-TSYMSG-00474      PIC  9(05)  VALUE  00474.       INKCS005
00107          10  PC-TSYMSG-00547      PIC  9(05)  VALUE  00547.       INKCS005
00108          10  PC-TSYMSG-00548      PIC  9(05)  VALUE  00548.       INKCS005
J28545*  INVALID HAS ALREADY BEEN CORRECTED; PRESS PF5 TO REFRESH               
00109          10  PC-TSYMSG-00551      PIC  9(05)  VALUE  00551.       INKCS005
00110          10  PC-TSYMSG-00686      PIC  9(05)  VALUE  00686.       INKCS005
00111          10  PC-TSYMSG-00687      PIC  9(05)  VALUE  00687.       INKCS005
J28545*  QUANTITY GREATER THAN MAXIMUM ALLOWED; MUST BE LESS THAN 99,999        
00112          10  PC-TSYMSG-00688      PIC  9(05)  VALUE  00688.       INKCS005
IN2001*        10  PC-TSYMSG-01922      PIC  9(05)  VALUE  00688.       INKCS005
00113          10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       INKCS005
32318          10  PC-TSYMSG-03549      PIC  9(05)  VALUE  03549.       INKCS005
00114 *                                                                 INKCS005
00115  01  PS-PROGRAM-SWITCHES.                                         INKCS005
00116      05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         INKCS005
00117          88  PS-ERROR                         VALUE  'Y'.         INKCS005
00118          88  PS-WARNING                       VALUE  'W'.         INKCS005
00119          88  PS-NO-ERROR                      VALUE  'N'.         INKCS005
00120      05  PS-QTY-ENTERED-SW        PIC  X(01)  VALUE  'N'.         INKCS005
00121          88  PS-QTY-ENTERED                   VALUE  'Y'.         INKCS005
00122      05  PS-PRICE-ENTERED-SW      PIC  X(01)  VALUE  'N'.         INKCS005
00123          88  PS-PRICE-ENTERED                 VALUE  'Y'.         INKCS005
00124      05  PS-SOFT-ABORT-SW         PIC  X(01)  VALUE  'N'.         INKCS005
00125          88  PS-SOFT-ABORT                    VALUE  'Y'.         INKCS005
00126      05  PS-SKU-RENUMBERED-SW     PIC  X(01)  VALUE  'N'.         INKCS005
00127          88  PS-SKU-RENUMBERED                VALUE  'Y'.         INKCS005
00128 *                                                                 INKCS005
00129  01  PV-PROGRAM-VARIABLES.                                        INKCS005
W21732     05  PV-SKU                   PIC 9(08).                      INKCS005
W26600     05  PV-STORE-NBR-X           PIC X(04)   VALUE ZEROES.       INKCS005
W26600     05  PV-STORE-NBR-9 REDEFINES PV-STORE-NBR-X                          
W26600                                  PIC 9(04).                              
00130      05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            INKCS005
00131                                               COMP SYNC.          INKCS005
00132      05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            INKCS005
00133                                               COMP SYNC.          INKCS005
00134      05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            INKCS005
00135                                               COMP SYNC.          INKCS005
00136      05  PV-WORK-PR-AMT-X.                                        INKCS005
00137          10  PV-WORK-PR-AMT       PIC S9(05)V99.                  INKCS005
00138      05  PV-ADJ-EXTD-AMT          PIC S9(15)V99 COMP-3.           INKCS005
00139                                                                   INKCS005
00140      05  PV-RENUMBERED-SKU.                                       INKCS005
W21732         10  PV-RSKU-NBR          PIC X(08).                      INKCS005
00146                                                                   INKCS005
00147      05  PV-WORK-UPC              PIC 9(13).                      INKCS005
00148      05  PV-WORK-UPC-X  REDEFINES PV-WORK-UPC.                    INKCS005
00149          10  FILLER               PIC X(4).                       INKCS005
00150              88  PV-KOHLS-UPC                 VALUE '0400'.       INKCS005
W21732         10  PV-UPC-SKU           PIC X(8).                       INKCS005
00155          10  PV-UPC-CHK-DIG       PIC 9.                          INKCS005
00156      05  PV-WORK-UPC-X2.                                          INKCS005
00157          10  FILLER               PIC X(4)    VALUE '0400'.       INKCS005
W21732         10  PV-UPC-SKU2          PIC X(8).                       INKCS005
00161          10  PV-UPC-CHK-DIG2      PIC 9       VALUE ZERO.         INKCS005
00162      05  PV-WORK-UPC2  REDEFINES  PV-WORK-UPC-X2                  INKCS005
00163                                   PIC 9(13).                      INKCS005
00164      05  PV-MAJ-CL-NBR.                                           INKCS005
00165          10  PV-MAJ-CL-NBR1       PIC X.                          INKCS005
00166          10  PV-MAJ-CL-NBR2       PIC X.                          INKCS005
00167      05  PV-SUB-CL-NBR.                                           INKCS005
00168          10  PV-SUB-CL-NBR1       PIC X      VALUE '0'.           INKCS005
00169          10  PV-SUB-CL-NBR2-3     PIC X(02).                      INKCS005
W21732     05  PV-WORK-NBR-X            PIC X(08).                      INKCS005
W21732     05  PV-WORK-NBR  REDEFINES PV-WORK-NBR-X  PIC 9(08).         INKCS005
W26600     05  PV-CHAR-STORE            PIC X(04)    VALUE SPACES.              
JS1099     05  PV-UNT-RTL-AMT           PIC S9(7)V9(2) COMP-3.                  
JS1099     05  PV-GROUP-UNIT-RTL        PIC S9(7)V9(2) COMP-3.                  
W03072     05  PV-UPCPLS-STR-NBR        PIC S9(4) COMP VALUE +0.                
W03072**** 05  PV-UPCPLS-STR-NBR        PIC S9(9) COMP VALUE +0.                
JS1099     05  PV-NUMERIC-STORE         PIC S9(9)    VALUE +0.                  
JS1099*    05  PV-REGION-IND            PIC X(01)    VALUE 'N'.                 
JS1099*        88  PV-REGIONAL-CLEARANCE             VALUE 'Y'.                 
JS1099     05  PV-PLND-INV-TMST.                                                
JS1099         10  PV-DB2-PLND-INV-DTE     PIC X(10) VALUE SPACES.              
JS1099         10  FILLER                  PIC X(16)                            
JS1099             VALUE '-23.59.59.999999'.                                    
JS1099     05  FILLER REDEFINES PV-PLND-INV-TMST.                               
JS1099         10  PV-PLND-INV-TMST-REDEF  PIC X(26).                           
                                                                                
IN2001     05  PV-STR000-ROW.                                                   
IN2001         10  PV-STR000-UPC-STAT-CDE  PIC X(02)    VALUE SPACES.           
IN2001         10  PV-STR000-UNT-RTL-AMT   PIC S9(7)V99 VALUE +0 COMP-3.        
IN2001         10  PV-STR000-MEITGP-NBR    PIC S9(9)    VALUE +0 COMP-3.        
JKB        05  PV-INV-ID                   PIC S9(9)    COMP.                   
00175 /                                                                 INKCS005
00176 *----------------------------------------------------------------*INKCS005
00177 *  THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING         *INKCS005
00178 *  SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.          *INKCS005
00179 *----------------------------------------------------------------*INKCS005
00180      COPY INWS003.                                                INKCS005
00181  EJECT                                                            INKCS005
00182                                                                   INKCS005
00183 *----------------------------------------------------------------*INKCS005
00184 *    MAP LAYOUT                                                  *INKCS005
00185 *----------------------------------------------------------------*INKCS005
00186                                                                   INKCS005
W26600     COPY INKM005.                                                INKCS005
00188                                                                   INKCS005
00189  EJECT                                                            INKCS005
00190 *----------------------------------------------------------------*INKCS005
00191 *    ATTRIBUTE SETTINGS COPYBOOK.                                *INKCS005
00192 *----------------------------------------------------------------*INKCS005
00193                                                                   INKCS005
00194      COPY DPWS015.                                                INKCS005
00195                                                                   INKCS005
00196 *----------------------------------------------------------------*INKCS005
00197 *    FUNCTION KEYS COPYBOOK                                      *INKCS005
00198 *----------------------------------------------------------------*INKCS005
00199                                                                   INKCS005
00200      COPY DPWS016.                                                INKCS005
00201                                                                   INKCS005
00202 *----------------------------------------------------------------*INKCS005
00203 *    CHECK DIGIT COPYBOOK                                        *INKCS005
00204 *----------------------------------------------------------------*INKCS005
00205                                                                   INKCS005
00206      COPY DPWS040I.                                               INKCS005
00207                                                                   INKCS005
00208 /                                                                 INKCS005
00209 **--------------------------------------------------------------**INKCS005
00210 ** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **INKCS005
00211 ** SUB-ROUTINE (DPKUT100).                                      **INKCS005
00212 **--------------------------------------------------------------**INKCS005
00213      COPY DPWS010I.                                               INKCS005
00214  EJECT                                                            INKCS005
00215 **--------------------------------------------------------------**INKCS005
00216 ** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*INKCS005
00217 ** APPLICATION PROGRAMMING INTERFACE MODULE -- DPKCS030.        **INKCS005
00218 **--------------------------------------------------------------**INKCS005
00219      COPY DPWS030.                                                INKCS005
1022RM     COPY DPWS930.                                                INKCS005
00220  EJECT                                                            INKCS005
00221 **--------------------------------------------------------------**INKCS005
00222 *    STANDARD COMMAREA.                                           INKCS005
00223 **--------------------------------------------------------------**INKCS005
00224                                                                   INKCS005
00225      COPY DPWS020.                                                INKCS005
00226      05  INKCS005-APPL REDEFINES DP020-VARIABLE-COMMAREA.         INKCS005
00227                                                                   INKCS005
00228 ***************************************************************** INKCS005
00229 *    INTER-APPLICATION COMMAREA.                                  INKCS005
00230 ***************************************************************** INKCS005
00231                                                                   INKCS005
00232          10  INTER-APPL-COMM-AREA PIC X(200).                     INKCS005
W26600     COPY INWS001.                                                INKCS005
00234 ***************************************************************** INKCS005
00235 *    SPECIFIC COMMMAREA FOR DPKCS041.                             INKCS005
00236 ***************************************************************** INKCS005
00237          10  ASC-SPECIFIC-COMMAREA.                               INKCS005
00238              15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            INKCS005
W26600             15  ASC-STORE-NBR             PIC  X(04).            INKCS005
00240              15  ASC-AREA-NBR              PIC S9(08)  COMP.      INKCS005
00241              15  ASC-INV-LINE-NBR          PIC S9(08)  COMP.      INKCS005
00242              15  ASC-SCAN-LINE-NBR         PIC S9(08)  COMP.      INKCS005
00243                                                                   INKCS005
00244            12    ASC-SCREEN-ENTERABLE-FIELDS.                     INKCS005
00245              15  ASC-SKU-NBR.                                     INKCS005
W21732                 20  ASC-SKU               PIC  X(08).            INKCS005
00250              15  ASC-UPC-NBR-X.                                   INKCS005
00251                  20  ASC-UPC-NBR           PIC  9(15).            INKCS005
00252              15  ASC-INV-QTY-X.                                   INKCS005
00253                  20  ASC-INV-QTY           PIC  9(07).            INKCS005
00254              15  ASC-INV-PR-AMT-X.                                INKCS005
00255                  20  ASC-INV-PR-AMT        PIC  9(08)V99.         INKCS005
00256              15  ASC-SKU-RENUMBERED-SW     PIC  X(01).            INKCS005
00257                  88  ASC-SKU-RENUMBERED                VALUE  'Y'.INKCS005
00258                  88  ASC-SKU-NOT-RENUMBERED            VALUE  'N'.INKCS005
00259              15  ASC-SKU-ENTERED-SW        PIC  X(01).            INKCS005
00260                  88  ASC-SKU-ENTERED                   VALUE  'Y'.INKCS005
00261                  88  ASC-SKU-NOT-ENTERED               VALUE  'N'.INKCS005
00262                  88  ASC-SKU-ERROR                     VALUE  'E'.INKCS005
00263              15  ASC-UPC-ENTERED-SW        PIC  X(01).            INKCS005
00264                  88  ASC-UPC-ENTERED                   VALUE  'Y'.INKCS005
00265                  88  ASC-UPC-NOT-ENTERED               VALUE  'N'.INKCS005
00266                  88  ASC-UPC-ERROR                     VALUE  'E'.INKCS005
00267              15  ASC-ENTER-PRICE-SW        PIC  X(01).            INKCS005
00268                  88  ASC-ENTER-PRICE                   VALUE 'Y'. INKCS005
00269                  88  ASC-RESET-PRICE                   VALUE 'N'. INKCS005
00270              15  ASC-PRICE-WAS-ENTERED-SW  PIC  X(01).            INKCS005
00271                  88  ASC-PRICE-WAS-ENTERED             VALUE 'Y'. INKCS005
00272                  88  ASC-PRICE-NOT-ENTERED             VALUE 'N'. INKCS005
00273                  88  ASC-PRICE-ERROR                   VALUE 'R'. INKCS005
00274              15  ASC-QTY-WAS-ENTERED-SW  PIC  X(01).              INKCS005
00275                  88  ASC-QTY-ENTERED                   VALUE 'Y'. INKCS005
00276                  88  ASC-QTY-NOT-ENTERED               VALUE 'N'. INKCS005
00277                  88  ASC-QTY-ERROR                     VALUE 'R'. INKCS005
00278              15  ASC-PROTECT-ENTRY-SW      PIC  X(01).            INKCS005
00279                  88  ASC-PROTECT-ENTRY                 VALUE 'Y'. INKCS005
00280                  88  ASC-DONT-PROTECT-ENTRY            VALUE 'N'. INKCS005
00281            12    ASC-SCREEN-ENTER-FIELDS-END.                     INKCS005
00282                                                                   INKCS005
00283              15  ASC-RENUM-SKU-NBR.                               INKCS005
W21732                 20  ASC-RSKU-NBR          PIC  X(08).            INKCS005
00287              15  ASC-ORIG-SKU-NBR.                                INKCS005
W21732                 20  ASC-OSKU-NBR          PIC  X(08).            INKCS005
00291              15  ASC-ORIG-UPC-NBR-X.                              INKCS005
00292                  20  ASC-ORIG-UPC-NBR      PIC  9(15).            INKCS005
00293              15  ASC-ORIG-INV-QTY          PIC  9(07).            INKCS005
00294              15  ASC-ORIG-INV-PR-AMT       PIC  9(08)V99.         INKCS005
00295              15  ASC-STATUS-CODE           PIC  S9(3)  COMP-3.    INKCS005
00296                                                                   INKCS005
00297              15  ASC-MDSEAR-DKEY           PIC S9(6)   COMP-3.    INKCS005
00298              15  ASC-INVALID-ITM-IND       PIC  X(01).            INKCS005
00299              15  ASC-INVALID-REC-IND       PIC  X(01).            INKCS005
00300              15  ASC-USE-SELECTION-QUEUE-IND                      INKCS005
00301                                            PIC  X(01).            INKCS005
00302                  88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. INKCS005
00303              15  ASC-SEL-QUEUE-NAME        PIC  X(08).            INKCS005
00304              15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    INKCS005
00305              15  ASC-NUMBER-OF-SELECTED-ITEMS                     INKCS005
00306                                            PIC S9(09)  COMP-3.    INKCS005
00307              15  ASC-SEL-SUB               PIC S9(04)  COMP.      INKCS005
00308              15  ASC-SEL-ITEM              PIC S9(04)  COMP.      INKCS005
00309                                                                   INKCS005
00310              15  ASC-PR-AMT-COLOR          PIC  X(01).            INKCS005
00311              15  ASC-PR-AMT-ATTRIBUTE      PIC  X(01).            INKCS005
00312              15  ASC-PR-AMT-HILIGHT        PIC  X(01).            INKCS005
00313              15  ASC-INV-QTY-COLOR         PIC  X(01).            INKCS005
00314              15  ASC-INV-QTY-ATTRIBUTE     PIC  X(01).            INKCS005
00315              15  ASC-INV-QTY-HILIGHT       PIC  X(01).            INKCS005
00316                                                                   INKCS005
00317              15  ASC-HOLD-INTER-APPL       PIC  X(200).           INKCS005
W26600         10  FILLER                        PIC  X(2518).          INKCS005
00319      EJECT                                                        INKCS005
00320 *----------------------------------------------------------------*INKCS005
00321 *    ABEND PROCESSING COPYBOOK.                                  *INKCS005
00322 *----------------------------------------------------------------*INKCS005
00323                                                                   INKCS005
00324      COPY DPWS013.                                                INKCS005
00325                                                                   INKCS005
00326  EJECT                                                            INKCS005
00327                                                                   INKCS005
00328 *    DB2 AREA FOR TINVDTL (PI INVALID DETAIL)                     INKCS005
00329                                                                   INKCS005
00330      EXEC SQL                                                     INKCS005
00331           INCLUDE TINVDTL                                         INKCS005
00332      END-EXEC.                                                    INKCS005
00333                                                                   INKCS005
00334 *    DB2 AREA FOR TINVLOC (PI LOCATION)                           INKCS005
00335                                                                   INKCS005
00336      EXEC SQL                                                     INKCS005
00337           INCLUDE TINVLOC                                         INKCS005
00338      END-EXEC.                                                    INKCS005
00339                                                                   INKCS005
00340 *    DB2 AREA FOR TADJDTL (PI ADJUSTMENT DETAIL)                  INKCS005
00341                                                                   INKCS005
00342      EXEC SQL                                                     INKCS005
W26600          INCLUDE TADJDTL                                         INKCS005
00344      END-EXEC.                                                    INKCS005
00345                                                                   INKCS005
JS1099*****************************************************************         
JS1099*  DCLGEN FOR THE TINVPAR DB2 TABLE.                                      
JS1099*****************************************************************         
JS1099                                                                          
JS1099     EXEC SQL                                                             
JS1099         INCLUDE TINVPAR                                                  
JS1099     END-EXEC.                                                            
JS1099                                                                          
W28545*****************************************************************         
W33304*  DCLGEN FOR THE TINCNTL DB2 TABLE.                                      
W28545*****************************************************************         
W28545                                                                          
W28545     EXEC SQL                                                             
W28545         INCLUDE TINCNTL                                                  
W28545     END-EXEC.                                                            
W28545                                                                          
W28545                                                                          
00370 *    DB2 AREA FOR COMMUNICATIONS                                  INKCS005
00371                                                                   INKCS005
00372      EXEC SQL                                                     INKCS005
00373           INCLUDE SQLCA                                           INKCS005
00374      END-EXEC.                                                    INKCS005
00375                                                                   INKCS005
28545 *-----------------------------------------------------------------        
28545 *  INWS400 - COMMON PRICE LOOKUP MODULE WORKING STORAGE DEFINITION        
28545 *-----------------------------------------------------------------        
J28545     COPY INWS400.                                                        
00376  EJECT                                                            INKCS005
00377  LINKAGE SECTION.                                                 INKCS005
00378                                                                   INKCS005
00379  01  DFHCOMMAREA.                                                 INKCS005
00380      05  FILLER                         OCCURS  1 TO 4072 TIMES   INKCS005
00381                                         DEPENDING ON EIBCALEN.    INKCS005
00382          10  FILLER                     PIC X.                    INKCS005
00383                                                                   INKCS005
00384                                                                   INKCS005
00385  PROCEDURE DIVISION.                                              INKCS005
00386 **-------------------------------------------------------------** INKCS005
00387 ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** INKCS005
00388 ** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** INKCS005
00389 ** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** INKCS005
00390 **                                                             ** INKCS005
00391 ** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** INKCS005
00392 ** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** INKCS005
00393 **-------------------------------------------------------------** INKCS005
00394                                                                   INKCS005
00395  0000-MAIN-MODULE.                                                INKCS005
00396                                                                   INKCS005
00397      INITIALIZE DP030-CICS-API-FIELDS.                            INKCS005
00398      MOVE +1                       TO DP030-NUMBER-OF-MAPS.       INKCS005
00399      MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          INKCS005
00400      MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         INKCS005
00401                                                                   INKCS005
00402      SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       INKCS005
00403      MOVE LENGTH OF IN005AI        TO DP030-MAP-LENGTH (1).       INKCS005
00404      MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     INKCS005
00405      PERFORM 0001-CALL-CICS-ARCH-API.                             INKCS005
00406                                                                   INKCS005
00407      PERFORM 1000-CONTROL-PROCESSING                              INKCS005
00408                                                                   INKCS005
00409      MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     INKCS005
00410      PERFORM 0001-CALL-CICS-ARCH-API.                             INKCS005
00411                                                                   INKCS005
00412  0001-CALL-CICS-ARCH-API.                                         INKCS005
00413                                                                   INKCS005
1022RM*    CALL 'DPKCS030' USING DFHEIBLK                               INKCS005
1022RM     CALL DP930-CICS-ARCH-API                                     INKCS002
1022RM                     USING DFHEIBLK                                       
00415                            DFHCOMMAREA                            INKCS005
00416                            DP030-CICS-API-FIELDS                  INKCS005
00417                            DP020-STANDARD-COMMAREA                INKCS005
00418                            IN005AI.                               INKCS005
00419                                                                   INKCS005
00420      IF  DP030-RC-CALL-SUCCESSFUL                                 INKCS005
00421          CONTINUE                                                 INKCS005
00422      ELSE                                                         INKCS005
00423          SET DP013-NO-ROLLBACK                                    INKCS005
00424              DP013-XCTL-DISPLAY-RESTART                           INKCS005
00425              DP013-CICS-ABEND      TO TRUE                        INKCS005
00426          MOVE 'BEFORE 0000-MAIN-MODULE'                           INKCS005
00427                                    TO DP013-PARAGRAPH             INKCS005
1022RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEXINKCS005
1022RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      INKCS005
1022RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
1022RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
00430          MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      INKCS005
00431          PERFORM DP013-0000-PROCESS-ABEND                         INKCS005
00432      END-IF.                                                      INKCS005
00433 /                                                                 INKCS005
00434 *----------------------------------------------------------------*INKCS005
00435 *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *INKCS005
00436 *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *INKCS005
00437 *----------------------------------------------------------------*INKCS005
00438                                                                   INKCS005
00439  1000-CONTROL-PROCESSING.                                         INKCS005
00440                                                                   INKCS005
00441      EVALUATE TRUE                                                INKCS005
00442          WHEN DP020-NEXT-ACT-INITIAL                              INKCS005
00443               PERFORM 1100-FIND-OBJECT-KEYS                       INKCS005
00444               IF  PS-ERROR                                        INKCS005
00445                   CONTINUE                                        INKCS005
00446               ELSE                                                INKCS005
00447                   MOVE INTER-APPL-COMM-AREA                       INKCS005
00448                                    TO  ASC-HOLD-INTER-APPL        INKCS005
00449                   PERFORM 4000-BUILD-INITIAL-PANEL                INKCS005
00450                   IF ASC-INT-APPL-FORMAT-IND EQUAL PC-2           INKCS005
00451                      IF (ASC-INVALID-ITM-IND = PC-Y OR            INKCS005
00452                          ASC-INVALID-REC-IND = PC-Y)              INKCS005
00453                         MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER  INKCS005
00454                         SET DP020-MSG-WARNING TO TRUE             INKCS005
00455                      ELSE                                         INKCS005
00456                         MOVE PC-TSYMSG-00116 TO DP020-MSG-NUMBER  INKCS005
00457                         SET DP020-MSG-WARNING TO TRUE             INKCS005
00458                      END-IF                                       INKCS005
00459                   END-IF                                          INKCS005
00460                   PERFORM 3200-RESET-ATTRIBUTES                   INKCS005
00461                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            INKCS005
00462                   IF  SQLCODE = +100                              INKCS005
00463                       SET DP020-NEXT-ACT-APPL-ERROR TO TRUE       INKCS005
00464                       MOVE PC-TSYMSG-00148                        INKCS005
00465                                    TO  DP020-MSG-NUMBER           INKCS005
00466                       SET DP020-MSG-INFORMATIONAL TO TRUE         INKCS005
00467                   END-IF                                          INKCS005
00468               END-IF                                              INKCS005
00469                                                                   INKCS005
00470          WHEN DP020-NEXT-ACT-READ-MAP                             INKCS005
00471               PERFORM 2000-PROCESS-PANEL                          INKCS005
00472                                                                   INKCS005
00473          WHEN DP020-NEXT-ACT-RETURN                               INKCS005
00474               MOVE ASC-HOLD-INTER-APPL                            INKCS005
00475                                    TO  INTER-APPL-COMM-AREA       INKCS005
00476               IF ASC-INT-APPL-FORMAT-IND EQUAL PC-2               INKCS005
00477                  IF (ASC-INVALID-ITM-IND = PC-Y OR                INKCS005
00478                      ASC-INVALID-REC-IND = PC-Y)                  INKCS005
00479                     MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER      INKCS005
00480                     SET DP020-MSG-WARNING TO TRUE                 INKCS005
00481                  ELSE                                             INKCS005
00482                     MOVE PC-TSYMSG-00116 TO DP020-MSG-NUMBER      INKCS005
00483                     SET DP020-MSG-WARNING TO TRUE                 INKCS005
00484                  END-IF                                           INKCS005
00485               END-IF                                              INKCS005
00486               PERFORM 3000-EDIT-DATA-IN-COMMAREA                  INKCS005
00487               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                INKCS005
00488                                                                   INKCS005
00489          WHEN OTHER                                               INKCS005
00490               SET DP013-LOGIC-ABEND TO TRUE                       INKCS005
00491               SET DP013-NO-ROLLBACK TO TRUE                       INKCS005
00492               MOVE '1000-CONTROL-PROCESSING'                      INKCS005
00493                                    TO  DP013-PARAGRAPH            INKCS005
00494               MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  INKCS005
00495                                    TO  DP013-MESSAGE-TEXT(1)      INKCS005
00496               MOVE DP020-NEXT-APPL-ACTIVITY                       INKCS005
00497                                    TO  DP013-MESSAGE-TEXT(2)      INKCS005
00498               PERFORM DP013-0000-PROCESS-ABEND                    INKCS005
00499      END-EVALUATE.                                                INKCS005
00500                                                                   INKCS005
00501 *----------------------------------------------------------------*INKCS005
00502 *  DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE    *INKCS005
00503 *  INTER-APPLICATION FORMAT CODE.                                *INKCS005
00504 *----------------------------------------------------------------*INKCS005
00505                                                                   INKCS005
00506  1100-FIND-OBJECT-KEYS.                                           INKCS005
00507                                                                   INKCS005
00508      INITIALIZE ASC-SPECIFIC-COMMAREA.                            INKCS005
00509      MOVE DP020-INT-APPL-FORMAT-IND                               INKCS005
00510                                    TO  ASC-INT-APPL-FORMAT-IND.   INKCS005
00511                                                                   INKCS005
00530                                                                   INKCS005
00532               SET ASC-USE-SELECTION-QUEUE TO TRUE                 INKCS005
00533               MOVE IN001-NUMBER-OF-SELECTED-ITEMS                 INKCS005
00534                                    TO ASC-NUMBER-OF-SELECTED-ITEMSINKCS005
00535               MOVE IN001-NUMBER-OF-TS-ITEMS                       INKCS005
00536                                    TO  ASC-NUMBER-OF-TS-ITEMS     INKCS005
00537               MOVE IN001-SEL-QUEUE-NAME                           INKCS005
00538                                    TO  ASC-SEL-QUEUE-NAME         INKCS005
00539               PERFORM 1120-PREPARE-LIST-ENTRY.                    INKCS005
00540                                                                   INKCS005
00547                                                                   INKCS005
00548                                                                   INKCS005
00549 *----------------------------------------------------------------*INKCS005
00550 * ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *INKCS005
00551 * STORAGE QUEUE PASSED FROM THE LIST.                            *INKCS005
00552 *----------------------------------------------------------------*INKCS005
00553                                                                   INKCS005
00554  1120-PREPARE-LIST-ENTRY.                                         INKCS005
00555                                                                   INKCS005
00556      MOVE IN003-MAX-ITEMS          TO ASC-SEL-SUB.                INKCS005
00557      MOVE ZERO                     TO ASC-SEL-ITEM.               INKCS005
00558      PERFORM 2110-GET-NEXT-LINE.                                  INKCS005
00559                                                                   INKCS005
00560 *----------------------------------------------------------------*INKCS005
00561 * DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *INKCS005
00562 * ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *INKCS005
00563 * USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *INKCS005
00564 * OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *INKCS005
00565 * FUNCTION KEYS CAN GET THIS FAR.                                *INKCS005
00566 *----------------------------------------------------------------*INKCS005
00567                                                                   INKCS005
00568  2000-PROCESS-PANEL.                                              INKCS005
00569                                                                   INKCS005
00570      IF  IN001-STORE-NBR NOT NUMERIC                              INKCS005
00571          MOVE ASC-HOLD-INTER-APPL TO INTER-APPL-COMM-AREA         INKCS005
00572      END-IF.                                                      INKCS005
00573                                                                   INKCS005
00574      EVALUATE TRUE                                                INKCS005
00575                                                                   INKCS005
00576          WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                     INKCS005
00577               IF ASC-INT-APPL-FORMAT-IND EQUAL PC-2  AND          INKCS005
00578                 (ASC-INVALID-ITM-IND = PC-Y OR                    INKCS005
00579                  ASC-INVALID-REC-IND = PC-Y)                      INKCS005
00580                                                                   INKCS005
00581                  MOVE 'N'    TO INVDTL-INVALID-REC-IND            INKCS005
00582                                 INVDTL-INVALID-ITM-IND            INKCS005
00583                  MOVE  0     TO INVDTL-CORR-UPC-NBR               INKCS005
00584                                 INVDTL-CORR-QTY                   INKCS005
00585                                 INVDTL-CORR-PR-AMT                INKCS005
W21732                 MOVE ZEROES TO INVDTL-CORR-SKU-NBR               INKCS005
00589                  PERFORM 5200-UPDATE-TINVDTL-ROW                  INKCS005
00590                  PERFORM 5300-UPDATE-TINVLOC                      INKCS005
00591                  PERFORM 5600-DB2-COMMIT                          INKCS005
00592                  MOVE PC-TSYMSG-00115 TO DP020-MSG-NUMBER         INKCS005
00593                  SET DP020-MSG-INFORMATIONAL TO TRUE              INKCS005
00594                  PERFORM 9100-READ-SEL-QUEUE                      INKCS005
00595                  SET IN003-DEL (ASC-SEL-SUB) TO TRUE              INKCS005
00596                  PERFORM 9200-REWRITE-SEL-QUEUE                   INKCS005
00597                  PERFORM 4000-BUILD-INITIAL-PANEL                 INKCS005
00598                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             INKCS005
00599               ELSE                                                INKCS005
00600                  MOVE PC-TSYMSG-00116 TO DP020-MSG-NUMBER         INKCS005
00601                  SET DP020-MSG-WARNING TO TRUE                    INKCS005
00602               END-IF                                              INKCS005
00603                                                                   INKCS005
00604          WHEN DP020-SRC-AID = DP016-CLEAR                         INKCS005
00605               IF ASC-INT-APPL-FORMAT-IND NOT EQUAL PC-2           INKCS005
00606                  PERFORM 3000-EDIT-DATA-IN-COMMAREA               INKCS005
00607                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             INKCS005
00608               ELSE                                                INKCS005
00609                  IF (ASC-INVALID-ITM-IND = PC-Y OR                INKCS005
00610                      ASC-INVALID-REC-IND = PC-Y)                  INKCS005
00611                     MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER      INKCS005
00612                     SET DP020-MSG-WARNING TO TRUE                 INKCS005
00613                  ELSE                                             INKCS005
00614                     MOVE PC-TSYMSG-00116 TO DP020-MSG-NUMBER      INKCS005
00615                     SET DP020-MSG-WARNING TO TRUE                 INKCS005
00616                  END-IF                                           INKCS005
00617                  PERFORM 3200-RESET-ATTRIBUTES                    INKCS005
00618                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             INKCS005
00619               END-IF                                              INKCS005
00620                                                                   INKCS005
00621          WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     INKCS005
00622               SET DP030-DONT-ERASE                                INKCS005
00623                   DP030-SEND-DATAONLY (PC-APPL-MAP)               INKCS005
00624                                    TO TRUE                        INKCS005
00625               IF ASC-INT-APPL-FORMAT-IND EQUAL PC-2               INKCS005
00626                  IF (ASC-INVALID-ITM-IND = PC-Y OR                INKCS005
00627                      ASC-INVALID-REC-IND = PC-Y)                  INKCS005
00628                     MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER      INKCS005
00629                     SET DP020-MSG-WARNING TO TRUE                 INKCS005
00630                  ELSE                                             INKCS005
00631                     MOVE PC-TSYMSG-00116 TO DP020-MSG-NUMBER      INKCS005
00632                     SET DP020-MSG-WARNING TO TRUE                 INKCS005
00633                  END-IF                                           INKCS005
00634               END-IF                                              INKCS005
00635               PERFORM 4000-BUILD-INITIAL-PANEL                    INKCS005
00636               PERFORM 3200-RESET-ATTRIBUTES                       INKCS005
00637               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                INKCS005
00638                                                                   INKCS005
00639          WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             INKCS005
00640               IF  ASC-USE-SELECTION-QUEUE                         INKCS005
00641                   PERFORM 2110-GET-NEXT-LINE                      INKCS005
00642                   PERFORM 4000-BUILD-INITIAL-PANEL                INKCS005
00643                   IF ASC-INT-APPL-FORMAT-IND EQUAL PC-2 AND       INKCS005
00644                      DP020-MSG-NUMBER NOT = PC-TSYMSG-00070       INKCS005
00645                      IF (ASC-INVALID-ITM-IND = PC-Y OR            INKCS005
00646                          ASC-INVALID-REC-IND = PC-Y)              INKCS005
00647                         MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER  INKCS005
00648                         SET DP020-MSG-WARNING TO TRUE             INKCS005
00649                      ELSE                                         INKCS005
00650                         MOVE PC-TSYMSG-00116 TO                   INKCS005
00651                                      DP020-MSG-NUMBER             INKCS005
00652                         SET DP020-MSG-WARNING TO TRUE             INKCS005
00653                      END-IF                                       INKCS005
00654                   END-IF                                          INKCS005
00655                   PERFORM 3200-RESET-ATTRIBUTES                   INKCS005
00656                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            INKCS005
00657               ELSE                                                INKCS005
00658 *                 --- BOTTOM OF LIST ---                          INKCS005
00659                   MOVE PC-TSYMSG-00070                            INKCS005
00660                                    TO DP020-MSG-NUMBER            INKCS005
00661                   SET DP020-MSG-INFORMATIONAL                     INKCS005
00662                                    TO TRUE                        INKCS005
00663               END-IF                                              INKCS005
00664                                                                   INKCS005
00665          WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             INKCS005
00666               IF  ASC-USE-SELECTION-QUEUE                         INKCS005
00667                   PERFORM 2120-GET-PREV-LINE                      INKCS005
00668                   PERFORM 4000-BUILD-INITIAL-PANEL                INKCS005
00669                   IF ASC-INT-APPL-FORMAT-IND EQUAL PC-2 AND       INKCS005
00670                      DP020-MSG-NUMBER NOT =  PC-TSYMSG-00069      INKCS005
00671                      IF (ASC-INVALID-ITM-IND = PC-Y OR            INKCS005
00672                          ASC-INVALID-REC-IND = PC-Y)              INKCS005
00673                         MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER  INKCS005
00674                         SET DP020-MSG-WARNING TO TRUE             INKCS005
00675                      ELSE                                         INKCS005
00676                         MOVE PC-TSYMSG-00116 TO                   INKCS005
00677                                  DP020-MSG-NUMBER                 INKCS005
00678                         SET DP020-MSG-WARNING TO TRUE             INKCS005
00679                      END-IF                                       INKCS005
00680                   END-IF                                          INKCS005
00681                   PERFORM 3200-RESET-ATTRIBUTES                   INKCS005
00682                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            INKCS005
00683               ELSE                                                INKCS005
00684 *                 --- TOP OF LIST ---                             INKCS005
00685                   MOVE PC-TSYMSG-00069                            INKCS005
00686                                    TO DP020-MSG-NUMBER            INKCS005
00687                   SET DP020-MSG-INFORMATIONAL                     INKCS005
00688                                    TO TRUE                        INKCS005
00689               END-IF                                              INKCS005
00690                                                                   INKCS005
00691          WHEN OTHER                                               INKCS005
00692               IF ASC-INT-APPL-FORMAT-IND NOT EQUAL PC-2           INKCS005
00693                  PERFORM 2200-MOVE-SCREEN-TO-COMMAREA             INKCS005
00694                  PERFORM 3000-EDIT-DATA-IN-COMMAREA               INKCS005
00695                  IF  PS-NO-ERROR                                  INKCS005
00696                      SET DP030-CONTINUE-GO                        INKCS005
00697                                   TO TRUE                         INKCS005
00698                      PERFORM 2100-CHECK-FUNCTION-KEY              INKCS005
00699                  ELSE                                             INKCS005
00700                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         INKCS005
00701                      SET DP030-OVERRIDE-GO                        INKCS005
00702                                   TO TRUE                         INKCS005
00703                  END-IF                                           INKCS005
00704               ELSE                                                INKCS005
00705                  IF (ASC-INVALID-ITM-IND = PC-Y OR                INKCS005
00706                      ASC-INVALID-REC-IND = PC-Y)                  INKCS005
00707                     MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER      INKCS005
00708                     SET DP020-MSG-WARNING TO TRUE                 INKCS005
00709                  ELSE                                             INKCS005
00710                     MOVE PC-TSYMSG-00116 TO DP020-MSG-NUMBER      INKCS005
00711                     SET DP020-MSG-WARNING TO TRUE                 INKCS005
00712                  END-IF                                           INKCS005
00713               END-IF                                              INKCS005
00714                                                                   INKCS005
00715      END-EVALUATE.                                                INKCS005
00716                                                                   INKCS005
00717 *----------------------------------------------------------------*INKCS005
00718 * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *INKCS005
00719 * FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *INKCS005
00720 * FROM THE CICS ARCHITECTURE API.                                *INKCS005
00721 *----------------------------------------------------------------*INKCS005
00722                                                                   INKCS005
00723  2100-CHECK-FUNCTION-KEY.                                         INKCS005
00724                                                                   INKCS005
00725      EVALUATE TRUE                                                INKCS005
00726          WHEN DP020-SRC-AID = DP016-ENTER                         INKCS005
00727               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                INKCS005
00728                                                                   INKCS005
00729          WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              INKCS005
00730               IF  ASC-PROTECT-ENTRY                               INKCS005
00731                   MOVE PC-TSYMSG-00548                            INKCS005
00732                                    TO  DP020-MSG-NUMBER           INKCS005
00733                   SET DP020-MSG-WARNING                           INKCS005
00734                                    TO  TRUE                       INKCS005
00735               ELSE                                                INKCS005
00736                   SET DP030-CONTINUE-GO TO TRUE                   INKCS005
00737                   PERFORM 5000-BEGIN-UPDATE-PROCESS               INKCS005
00738                   IF  PS-NO-ERROR                                 INKCS005
00739 *             --- UPDATES SUCCESSFUL ---                          INKCS005
00740                       MOVE PC-TSYMSG-00059                        INKCS005
00741                                    TO DP020-MSG-NUMBER            INKCS005
00742                       SET DP020-MSG-INFORMATIONAL                 INKCS005
00743                                    TO TRUE                        INKCS005
00744                   END-IF                                          INKCS005
00745               END-IF                                              INKCS005
00746               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                INKCS005
00747                                                                   INKCS005
00748          WHEN OTHER                                               INKCS005
00749               SET DP013-NO-ROLLBACK                               INKCS005
00750                   DP013-XCTL-DISPLAY-RESTART                      INKCS005
00751                   DP013-CICS-ABEND  TO TRUE                       INKCS005
00752               MOVE '2000-PROCESS-PANEL'                           INKCS005
00753                                    TO DP013-PARAGRAPH             INKCS005
00754               MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'     INKCS005
00755                                    TO DP013-MESSAGE-TEXT (1)      INKCS005
00756               PERFORM DP013-0000-PROCESS-ABEND                    INKCS005
00757      END-EVALUATE.                                                INKCS005
00758                                                                   INKCS005
00759 *----------------------------------------------------------------*INKCS005
00760 *    RETRIEVE THE NEXT KEY FOR PROCESSING.                       *INKCS005
00761 *----------------------------------------------------------------*INKCS005
00762                                                                   INKCS005
00763  2110-GET-NEXT-LINE.                                              INKCS005
00764                                                                   INKCS005
00765      ADD +1                        TO  ASC-SEL-SUB.               INKCS005
00766      IF  ASC-SEL-SUB > IN003-MAX-ITEMS                            INKCS005
00767          ADD +1                    TO  ASC-SEL-ITEM               INKCS005
00768          MOVE +1                   TO  ASC-SEL-SUB                INKCS005
00769      END-IF.                                                      INKCS005
00770                                                                   INKCS005
00771      IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                INKCS005
00772          PERFORM 9100-READ-SEL-QUEUE                              INKCS005
00773          IF  IN003-ITEM (ASC-SEL-SUB) > ZERO                      INKCS005
00774              MOVE IN003-INV-LINE-NBR (ASC-SEL-SUB)                INKCS005
00775                                    TO  ASC-INV-LINE-NBR           INKCS005
00776              MOVE IN003-SCAN-LINE-NBR (ASC-SEL-SUB)               INKCS005
00777                                    TO  ASC-SCAN-LINE-NBR          INKCS005
00778              IF  IN003-UPD (ASC-SEL-SUB)                          INKCS005
00779                  SET ASC-PROTECT-ENTRY                            INKCS005
00780                                    TO  TRUE                       INKCS005
00781              ELSE                                                 INKCS005
00782                  SET IN003-INQ (ASC-SEL-SUB)                      INKCS005
00783                      ASC-DONT-PROTECT-ENTRY                       INKCS005
00784                                    TO  TRUE                       INKCS005
00785                  PERFORM 9200-REWRITE-SEL-QUEUE                   INKCS005
00786              END-IF                                               INKCS005
00787          ELSE                                                     INKCS005
00788              SUBTRACT +1 FROM ASC-SEL-SUB                         INKCS005
00789 *            --- BOTTOM OF LIST ---                               INKCS005
00790              MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER           INKCS005
00791              SET DP020-MSG-INFORMATIONAL                          INKCS005
00792                                    TO  TRUE                       INKCS005
00793          END-IF                                                   INKCS005
00794      ELSE                                                         INKCS005
00795          SUBTRACT +1 FROM ASC-SEL-ITEM                            INKCS005
00796          MOVE IN003-MAX-ITEMS      TO  ASC-SEL-SUB                INKCS005
00797          MOVE PC-TSYMSG-00070      TO  DP020-MSG-NUMBER           INKCS005
00798          SET DP020-MSG-INFORMATIONAL                              INKCS005
00799                                    TO  TRUE                       INKCS005
00800      END-IF.                                                      INKCS005
00801                                                                   INKCS005
00802 *----------------------------------------------------------------*INKCS005
00803 *  GET THE MESSAGE NUMBER (KEY) OF THE PREVIOUS SELECTED         *INKCS005
00804 *  OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.           *INKCS005
00805 *----------------------------------------------------------------*INKCS005
00806                                                                   INKCS005
00807  2120-GET-PREV-LINE.                                              INKCS005
00808                                                                   INKCS005
00809      SUBTRACT +1 FROM ASC-SEL-SUB.                                INKCS005
00810      IF  ASC-SEL-SUB < +1                                         INKCS005
00811          SUBTRACT +1 FROM ASC-SEL-ITEM                            INKCS005
00812          MOVE IN003-MAX-ITEMS      TO ASC-SEL-SUB                 INKCS005
00813      END-IF.                                                      INKCS005
00814                                                                   INKCS005
00815      IF  ASC-SEL-ITEM > ZERO                                      INKCS005
00816          PERFORM 9100-READ-SEL-QUEUE                              INKCS005
00817          MOVE IN003-INV-LINE-NBR (ASC-SEL-SUB)                    INKCS005
00818                                    TO ASC-INV-LINE-NBR            INKCS005
00819          MOVE IN003-SCAN-LINE-NBR (ASC-SEL-SUB)                   INKCS005
00820                                    TO ASC-SCAN-LINE-NBR           INKCS005
00821          IF  IN003-UPD (ASC-SEL-SUB)                              INKCS005
00822              SET ASC-PROTECT-ENTRY TO  TRUE                       INKCS005
00823          ELSE                                                     INKCS005
00824              SET ASC-DONT-PROTECT-ENTRY                           INKCS005
00825                                    TO  TRUE                       INKCS005
00826          END-IF                                                   INKCS005
00827      ELSE                                                         INKCS005
00828          MOVE +1                   TO ASC-SEL-ITEM                INKCS005
00829                                       ASC-SEL-SUB                 INKCS005
00830 *        --- TOP OF LIST ---                                      INKCS005
00831          MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            INKCS005
00832          SET DP020-MSG-INFORMATIONAL                              INKCS005
00833                                    TO TRUE                        INKCS005
00834      END-IF.                                                      INKCS005
00835 /                                                                 INKCS005
00836 *----------------------------------------------------------------*INKCS005
00837 * MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *INKCS005
00838 * IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *INKCS005
00839 * THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *INKCS005
00840 *----------------------------------------------------------------*INKCS005
00841                                                                   INKCS005
00842  2200-MOVE-SCREEN-TO-COMMAREA.                                    INKCS005
00843                                                                   INKCS005
R21732     IF  AISKUL > ZERO                                                    
R21732         MOVE AISKUI               TO  ASC-SKU                            
R21732         IF  ASC-SKU      EQUAL SPACES                                    
R21732             SET ASC-SKU-NOT-ENTERED                                      
R21732                 ASC-SKU-NOT-RENUMBERED                                   
R21732                                   TO  TRUE                               
R21732             MOVE SPACE            TO  ASC-SKU                            
R21732         ELSE                                                             
R21732             SET ASC-SKU-ENTERED   TO  TRUE                               
R21732         END-IF                                                           
R21732     ELSE                                                                 
R21732         IF  AISKUF = DP015-ERASE-EOF                                     
R21732             SET ASC-SKU-NOT-ENTERED                                      
R21732                 ASC-SKU-NOT-RENUMBERED                                   
R21732                                   TO  TRUE                               
R21732             MOVE SPACE            TO  ASC-SKU                            
R21732         END-IF                                                           
R21732     END-IF.                                                              
                                                                                
00886                                                                   INKCS005
00887      IF  AIUPCL > ZERO                                            INKCS005
00888          MOVE AIUPCI               TO  ASC-UPC-NBR-X              INKCS005
00889          IF  ASC-UPC-NBR-X EQUAL SPACES                           INKCS005
00890              SET ASC-UPC-NOT-ENTERED                              INKCS005
00891                                    TO  TRUE                       INKCS005
00892              MOVE ZERO             TO  ASC-UPC-NBR                INKCS005
00893          ELSE                                                     INKCS005
00894              SET ASC-UPC-ENTERED   TO  TRUE                       INKCS005
00895          END-IF                                                   INKCS005
00896      ELSE                                                         INKCS005
00897          IF  AIUPCF = DP015-ERASE-EOF                             INKCS005
00898              SET ASC-UPC-NOT-ENTERED                              INKCS005
00899                                    TO  TRUE                       INKCS005
00900              MOVE ZERO             TO  ASC-UPC-NBR                INKCS005
00901          END-IF                                                   INKCS005
00902      END-IF.                                                      INKCS005
00903                                                                   INKCS005
00904      IF (ASC-SKU-ENTERED                                          INKCS005
00905      OR  ASC-UPC-ENTERED)                                         INKCS005
00906      AND IN001-SCANNING-STORE                                     INKCS005
00907      AND (IN001-AREA-NBR LESS THAN PC-9000                        INKCS005
00908      OR   IN001-AREA-NBR GREATER   PC-9999)                       INKCS005
00909          MOVE ZERO                 TO  ASC-INV-PR-AMT             INKCS005
00910      END-IF.                                                      INKCS005
00911                                                                   INKCS005
00912      IF  AIQTYL > ZERO                                            INKCS005
00913          SET PS-QTY-ENTERED        TO  TRUE                       INKCS005
00915          MOVE AIQTYI               TO  ASC-INV-QTY-X              INKCS005
00916      ELSE                                                         INKCS005
00917          IF  AIQTYF = DP015-ERASE-EOF                             INKCS005
00918              MOVE ZERO             TO  ASC-INV-QTY                INKCS005
00919          END-IF                                                   INKCS005
00920      END-IF.                                                      INKCS005
00921                                                                   INKCS005
00922      IF  AIPRICEL > ZERO                                          INKCS005
00923          MOVE AIPRICEI             TO  ASC-INV-PR-AMT-X           INKCS005
00924          SET PS-PRICE-ENTERED      TO  TRUE                       INKCS005
00925      ELSE                                                         INKCS005
00926          IF  AIPRICEF = DP015-ERASE-EOF                           INKCS005
00927              MOVE ZERO             TO  ASC-INV-PR-AMT             INKCS005
00928              SET ASC-PRICE-NOT-ENTERED                            INKCS005
00929                                    TO  TRUE                       INKCS005
00930          END-IF                                                   INKCS005
00931      END-IF.                                                      INKCS005
00932 /                                                                 INKCS005
00933 *----------------------------------------------------------------*INKCS005
00934 * PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *INKCS005
00935 * IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *INKCS005
00936 * APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *INKCS005
00937 *----------------------------------------------------------------*INKCS005
00938                                                                   INKCS005
00939  3000-EDIT-DATA-IN-COMMAREA.                                      INKCS005
00940                                                                   INKCS005
      *    *********************************************************            
      *    **  GET THE STORE'S PLANNED INVENTORY DATE FROM TINVPAR.             
      *    **  THIS DATE WILL BE USED TO GET STATUS AND PRICE INFO              
      *    **  FROM TUPCPLS.                                                    
      *    *********************************************************            
JS1099     PERFORM 5570-SELECT-TINVPAR.                                         
00941      IF  ASC-PROTECT-ENTRY                                        INKCS005
00942          SET DP030-SET-CURSOR-TRAILER                             INKCS005
00943                                    TO  TRUE                       INKCS005
00944      ELSE                                                         INKCS005
00945          PERFORM 3001-REAL-VALIDATION                             INKCS005
00946      END-IF.                                                      INKCS005
00947                                                                   INKCS005
00948  3001-REAL-VALIDATION.                                            INKCS005
00949                                                                   INKCS005
00950      PERFORM 3200-RESET-ATTRIBUTES.                               INKCS005
00951                                                                   INKCS005
00952      IF (PS-PRICE-ENTERED                                         INKCS005
00953      OR  ASC-PRICE-ERROR)                                         INKCS005
00954          SET ASC-RESET-PRICE                                      INKCS005
00955              ASC-PRICE-WAS-ENTERED TO  TRUE                       INKCS005
00956          MOVE ASC-INV-PR-AMT-X     TO  DP010I-UNEDITED-FIELD      INKCS005
00957          MOVE PC-9                 TO  DP010I-MAXIMUM-DIGITS      INKCS005
00958          MOVE PC-2                 TO  DP010I-MAXIMUM-DECIMALS    INKCS005
00959          SET DP010I-NEGATIVE-NOT-ALLOWED                          INKCS005
00960                                    TO  TRUE                       INKCS005
263126         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263126              USING DP010I-NUMERIC-EDIT-AREA                              
00962                                                                   INKCS005
00963          IF  DP010I-ERROR-DETECTED                                INKCS005
00964              SET PS-WARNING        TO  TRUE                       INKCS005
00965              SET ASC-PRICE-ERROR   TO  TRUE                       INKCS005
00966              SET DP020-MSG-FATAL   TO  TRUE                       INKCS005
00967              MOVE PC-TSYMSG-00008  TO  DP020-MSG-NUMBER           INKCS005
00968              MOVE DP015-UNP-ALP-BRT-OFF                           INKCS005
00969                                    TO  ASC-PR-AMT-ATTRIBUTE       INKCS005
00970              MOVE DP015-RED        TO  ASC-PR-AMT-COLOR           INKCS005
00971              MOVE DP015-REVERSE    TO  ASC-PR-AMT-HILIGHT         INKCS005
00972              MOVE -1               TO  AIPRICEL                   INKCS005
00973          ELSE                                                     INKCS005
00974              MOVE DP010I-NUMERIC-FIELD                            INKCS005
00975                                    TO  ASC-INV-PR-AMT             INKCS005
00976              IF  ASC-INV-PR-AMT NOT GREATER THAN ZERO             INKCS005
00977                  PERFORM 5010-SET-ENTER-PRICE                     INKCS005
00978              ELSE                                                 INKCS005
00979                  EVALUATE TRUE                                    INKCS005
00980                  WHEN ASC-INV-PR-AMT GREATER PC-MAX-PRICE         INKCS005
00981                      MOVE PC-TSYMSG-00686                         INKCS005
00982                                    TO  DP020-MSG-NUMBER           INKCS005
00983                      SET ASC-ENTER-PRICE                          INKCS005
00984                          ASC-PRICE-ERROR                          INKCS005
00985                          DP020-MSG-FATAL                          INKCS005
00986                          PS-ERROR  TO  TRUE                       INKCS005
00987                      MOVE DP015-UNP-ALP-BRT-OFF                   INKCS005
00988                                    TO  ASC-PR-AMT-ATTRIBUTE       INKCS005
00989                      MOVE DP015-RED                               INKCS005
00990                                    TO  ASC-PR-AMT-COLOR           INKCS005
00991                      MOVE DP015-REVERSE                           INKCS005
00992                                    TO  ASC-PR-AMT-HILIGHT         INKCS005
00993                      MOVE -1       TO  AIPRICEL                   INKCS005
00994                                                                   INKCS005
00995                  WHEN ASC-INV-PR-AMT LESS PC-TWENTY-ONE-CENTS     INKCS005
00996                      MOVE PC-TSYMSG-00688                         INKCS005
00997                                    TO  DP020-MSG-NUMBER           INKCS005
00998                      SET ASC-ENTER-PRICE                          INKCS005
00999                          ASC-PRICE-ERROR                          INKCS005
01000                          DP020-MSG-FATAL                          INKCS005
01001                          PS-ERROR  TO  TRUE                       INKCS005
01002                      MOVE DP015-UNP-ALP-BRT-OFF                   INKCS005
01003                                    TO  ASC-PR-AMT-ATTRIBUTE       INKCS005
01004                      MOVE DP015-RED                               INKCS005
01005                                    TO  ASC-PR-AMT-COLOR           INKCS005
01006                      MOVE DP015-REVERSE                           INKCS005
01007                                    TO  ASC-PR-AMT-HILIGHT         INKCS005
01008                      MOVE -1       TO  AIPRICEL                   INKCS005
01009                  END-EVALUATE                                     INKCS005
01010                                                                   INKCS005
01011              END-IF                                               INKCS005
01012          END-IF                                                   INKCS005
01013      ELSE                                                         INKCS005
01014          IF  ASC-ENTER-PRICE                                      INKCS005
01015              PERFORM 5010-SET-ENTER-PRICE                         INKCS005
01016          END-IF                                                   INKCS005
01017      END-IF.                                                      INKCS005
01018                                                                   INKCS005
01024      IF (PS-QTY-ENTERED                                           INKCS005
01025      OR  ASC-QTY-ERROR)                                           INKCS005
01026          MOVE ASC-INV-QTY          TO  DP010I-UNEDITED-FIELD      INKCS005
01027          MOVE PC-7                 TO  DP010I-MAXIMUM-DIGITS      INKCS005
01028          MOVE ZERO                 TO  DP010I-MAXIMUM-DECIMALS    INKCS005
01029          SET DP010I-NEGATIVE-NOT-ALLOWED                          INKCS005
01030                                    TO  TRUE                       INKCS005
263126         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263126              USING DP010I-NUMERIC-EDIT-AREA                              
01032                                                                   INKCS005
01033          IF  DP010I-ERROR-DETECTED                                INKCS005
01034              SET PS-ERROR          TO  TRUE                       INKCS005
01035              SET ASC-QTY-ERROR     TO  TRUE                       INKCS005
01036              SET DP020-MSG-FATAL   TO  TRUE                       INKCS005
01037              MOVE PC-TSYMSG-00008  TO  DP020-MSG-NUMBER           INKCS005
01038              MOVE DP015-UNP-ALP-BRT-OFF                           INKCS005
01039                                    TO  ASC-INV-QTY-ATTRIBUTE      INKCS005
01040              MOVE DP015-RED        TO  ASC-INV-QTY-COLOR          INKCS005
01041              MOVE DP015-REVERSE    TO  ASC-INV-QTY-HILIGHT        INKCS005
01042              MOVE -1               TO  AIQTYL                     INKCS005
01043          ELSE                                                     INKCS005
01044              SET  ASC-QTY-ENTERED  TO  TRUE                       INKCS005
01045              MOVE DP010I-NUMERIC-FIELD                            INKCS005
01046                                    TO  ASC-INV-QTY                INKCS005
01047          END-IF                                                   INKCS005
01048      END-IF.                                                      INKCS005
01049                                                                   INKCS005
01050      IF (ASC-ORIG-INV-QTY EQUAL ZERO                              INKCS005
01051      AND ASC-INV-QTY      EQUAL ZERO)                             INKCS005
01052          SET PS-ERROR              TO  TRUE                       INKCS005
01053          SET DP020-MSG-FATAL       TO  TRUE                       INKCS005
01054          MOVE PC-TSYMSG-00007      TO  DP020-MSG-NUMBER           INKCS005
01055          MOVE DP015-UNP-ALP-BRT-OFF                               INKCS005
01056                                    TO  ASC-INV-QTY-ATTRIBUTE      INKCS005
01057          MOVE DP015-RED            TO  ASC-INV-QTY-COLOR          INKCS005
01058          MOVE DP015-REVERSE        TO  ASC-INV-QTY-HILIGHT        INKCS005
01059          MOVE -1                   TO  AIQTYL                     INKCS005
01060      END-IF.                                                      INKCS005
01061                                                                   INKCS005
01066      IF (ASC-SKU-ENTERED                                          INKCS005
01067      OR  ASC-SKU-ERROR)                                           INKCS005
01068          PERFORM 3020-VALIDATE-SKU                                INKCS005
01069      END-IF.                                                      INKCS005
01070                                                                   INKCS005
01062      IF (ASC-UPC-ENTERED                                          INKCS005
01063      OR  ASC-UPC-ERROR)                                           INKCS005
01064          PERFORM 3010-VALIDATE-UPC                                INKCS005
01065      END-IF.                                                      INKCS005
                                                                                
01071      IF (ASC-PRICE-ERROR                                          INKCS005
01072      OR  ASC-QTY-ERROR)                                           INKCS005
01073          CONTINUE                                                 INKCS005
01074      ELSE                                                         INKCS005
01075          PERFORM 3005-CHECK-EXTENDED                              INKCS005
01076      END-IF.                                                      INKCS005
01077                                                                   INKCS005
01078      IF (ASC-UPC-ERROR                                            INKCS005
01079      OR  ASC-SKU-ERROR)                                           INKCS005
01080          CONTINUE                                                 INKCS005
01081      ELSE                                                         INKCS005
01082          IF ((ASC-UPC-NBR NOT EQUAL ASC-ORIG-UPC-NBR              INKCS005
01083          AND  ASC-UPC-NBR GREATER THAN ZERO)                      INKCS005
01084          AND (ASC-SKU-NBR NOT EQUAL ASC-ORIG-SKU-NBR              INKCS005
01085          AND  ASC-SKU-NBR GREATER THAN ZERO)                      INKCS005
01086          AND (ASC-INVALID-ITM-IND EQUAL 'Y'))                     INKCS005
J28545                                                                          
J28545           IF ASC-UPC-ENTERED                                             
J28545           AND ASC-SKU-ENTERED                                            
J28545             IF IN400-PV-SKU-IN-NUM NOT EQUAL IN400-PRC-SKU-OUT           
J28545                 MOVE DP015-UNP-ALP-BRT-OFF                       INKCS005
J28545                                         TO  AISKUA               INKCS005
J28545                 MOVE DP015-RED          TO  AISKUC               INKCS005
J28545                 MOVE DP015-REVERSE      TO  AISKUH               INKCS005
J28545                 MOVE -1                 TO  AISKUL               INKCS005
J28545                 SET PS-ERROR          TO  TRUE                       INKC
J28545                 SET DP020-MSG-FATAL   TO  TRUE                       INKC
J28545                 MOVE PC-TSYMSG-00547  TO  DP020-MSG-NUMBER           INKC
J28545             END-IF                                                       
J28545             IF IN400-PV-UPC-NBR-IN-NUM NOT EQUAL                         
J28545                                        IN400-PRC-UPC-OUT                 
J28545                 MOVE DP015-UNP-ALP-BRT-OFF                       INKCS005
J28545                                         TO  AIUPCA               INKCS005
J28545                 MOVE DP015-RED          TO  AIUPCC               INKCS005
J28545                 MOVE DP015-REVERSE      TO  AIUPCH               INKCS005
J28545                 MOVE -1                 TO  AIUPCL               INKCS005
J28545                 SET PS-ERROR          TO  TRUE                       INKC
J28545                 SET DP020-MSG-FATAL   TO  TRUE                       INKC
J28545                 MOVE PC-TSYMSG-00547  TO  DP020-MSG-NUMBER           INKC
J28545             END-IF                                                       
J28545           END-IF                                                         
01095          END-IF                                                   INKCS005
01096      END-IF.                                                      INKCS005
01097                                                                   INKCS005
01098      IF (ASC-INVALID-ITM-IND EQUAL PC-Y                           INKCS005
01099      AND NOT ASC-SKU-ERROR                                        INKCS005
01100      AND NOT ASC-UPC-ERROR)                                       INKCS005
01101          IF (ASC-SKU-NBR NOT GREATER THAN ZERO                    INKCS005
01102          AND ASC-UPC-NBR NOT GREATER THAN ZERO)                   INKCS005
01103                                                                   INKCS005
W21732             MOVE DP015-RED        TO  AISKUC                     INKCS005
01107                                        AIUPCC                     INKCS005
W21732             MOVE DP015-REVERSE    TO  AISKUH                     INKCS005
01111                                        AIUPCH                     INKCS005
W21732             MOVE DP015-UNP-ALP-NOR-OFF                           INKCS005
W21732                                   TO  AISKUA                     INKCS005
01116                                        AIUPCA                     INKCS005
01117              SET PS-ERROR          TO  TRUE                       INKCS005
01118              SET DP020-MSG-FATAL   TO  TRUE                       INKCS005
01119              MOVE PC-TSYMSG-00007  TO  DP020-MSG-NUMBER           INKCS005
W21732             MOVE -1               TO  AISKUL                     INKCS005
01121          END-IF                                                   INKCS005
01122      END-IF.                                                      INKCS005
01123                                                                   INKCS005
01124      SET DP030-SET-CURSOR-APPL-1   TO  TRUE.                      INKCS005
01125      IF  PS-NO-ERROR                                              INKCS005
01126          EVALUATE TRUE                                            INKCS005
01127                  WHEN ASC-INVALID-ITM-IND EQUAL PC-Y              INKCS005
W21732                      MOVE -1      TO  AISKUL                     INKCS005
01129                                                                   INKCS005
01130                  WHEN ASC-ORIG-INV-PR-AMT EQUAL ZERO              INKCS005
01131                  AND  ASC-INV-PR-AMT      EQUAL ZERO              INKCS005
01132                      MOVE -1       TO  AIPRICEL                   INKCS005
01133                                                                   INKCS005
01134                  WHEN ASC-ORIG-INV-QTY EQUAL ZERO                 INKCS005
01135                  AND  ASC-INV-QTY      EQUAL ZERO                 INKCS005
01136                      MOVE -1       TO  AIQTYL                     INKCS005
01137                                                                   INKCS005
01138                  WHEN ASC-ORIG-INV-QTY EQUAL ZERO                 INKCS005
01139                      MOVE -1       TO  AIQTYL                     INKCS005
01140                                                                   INKCS005
01141                  WHEN ASC-ORIG-INV-PR-AMT EQUAL ZERO              INKCS005
01142                      MOVE -1       TO  AIPRICEL                   INKCS005
01143                                                                   INKCS005
01144                  WHEN OTHER                                       INKCS005
01145                       SET DP030-SET-CURSOR-TRAILER                INKCS005
01146                                    TO  TRUE                       INKCS005
01147              END-EVALUATE                                         INKCS005
01148      END-IF.                                                      INKCS005
01149                                                                   INKCS005
01150      IF  ASC-PR-AMT-COLOR EQUAL DP015-BLUE                        INKCS005
01151          SET ASC-RESET-PRICE                                      INKCS005
01152              ASC-PRICE-NOT-ENTERED TO  TRUE                       INKCS005
01153      END-IF.                                                      INKCS005
01154                                                                   INKCS005
01155 *----------------------------------------------------------------*INKCS005
01156 *    SEE IF THE EXTENDED AMOUNT EXCEEDS THE TARGET COLUMN SIZE.  *INKCS005
01157 *----------------------------------------------------------------*INKCS005
01158                                                                   INKCS005
01159  3005-CHECK-EXTENDED.                                             INKCS005
01160                                                                   INKCS005
01161      IF  ASC-INV-QTY EQUAL ZERO                                   INKCS005
01162          MOVE ASC-ORIG-INV-QTY     TO  ADJDTL-ADJ-QTY             INKCS005
01163      ELSE                                                         INKCS005
01164          MOVE ASC-INV-QTY          TO  ADJDTL-ADJ-QTY             INKCS005
01165      END-IF.                                                      INKCS005
01166                                                                   INKCS005
01167      IF (ASC-INV-PR-AMT EQUAL ZERO                                INKCS005
01168      AND NOT ASC-ENTER-PRICE)                                     INKCS005
01169          MOVE ASC-ORIG-INV-PR-AMT  TO  ADJDTL-ADJ-UNIT-PR-AMT     INKCS005
01170      ELSE                                                         INKCS005
01171          MOVE ASC-INV-PR-AMT       TO  ADJDTL-ADJ-UNIT-PR-AMT     INKCS005
01172      END-IF.                                                      INKCS005
01173                                                                   INKCS005
01174      COMPUTE PV-ADJ-EXTD-AMT     = ADJDTL-ADJ-UNIT-PR-AMT         INKCS005
01175                                  * ADJDTL-ADJ-QTY.                INKCS005
01176                                                                   INKCS005
01177      IF  PV-ADJ-EXTD-AMT GREATER THAN PC-MAX-EXTD-AMT             INKCS005
W21732         IF (AISKUL  EQUAL -1                                     INKCS005
01179          OR  AIUPCL  EQUAL -1)                                    INKCS005
01180              CONTINUE                                             INKCS005
01181          ELSE                                                     INKCS005
01182              MOVE PC-TSYMSG-00686  TO  DP020-MSG-NUMBER           INKCS005
01183              SET DP020-MSG-FATAL                                  INKCS005
01184                  PS-ERROR          TO  TRUE                       INKCS005
01185          END-IF                                                   INKCS005
01186                                                                   INKCS005
01187          IF  PS-PRICE-ENTERED                                     INKCS005
01188          OR (ASC-INV-PR-AMT GREATER THAN ZERO                     INKCS005
01189          AND ASC-PR-AMT-COLOR NOT EQUAL DP015-BLUE)               INKCS005
01190              MOVE DP015-UNP-ALP-BRT-OFF                           INKCS005
01191                                    TO  ASC-PR-AMT-ATTRIBUTE       INKCS005
01192              MOVE DP015-RED        TO  ASC-PR-AMT-COLOR           INKCS005
01193              MOVE DP015-REVERSE    TO  ASC-PR-AMT-HILIGHT         INKCS005
01194              MOVE -1               TO  AIPRICEL                   INKCS005
01195          END-IF                                                   INKCS005
01196                                                                   INKCS005
01197          IF  PS-QTY-ENTERED                                       INKCS005
01198          OR (ASC-INV-QTY GREATER THAN ZERO                        INKCS005
01199          AND ASC-INV-QTY-COLOR NOT EQUAL DP015-BLUE)              INKCS005
01200              MOVE DP015-UNP-ALP-BRT-OFF                           INKCS005
01201                                    TO  ASC-INV-QTY-ATTRIBUTE      INKCS005
01202              MOVE DP015-RED        TO  ASC-INV-QTY-COLOR          INKCS005
01203              MOVE DP015-REVERSE    TO  ASC-INV-QTY-HILIGHT        INKCS005
01204              MOVE -1               TO  AIQTYL                     INKCS005
01205          END-IF                                                   INKCS005
01206      END-IF.                                                      INKCS005
01207                                                                   INKCS005
01208 *----------------------------------------------------------------*INKCS005
01209 *    UPC NUMBER WAS ENTERED.  VALIDATE THE CHECK DIGIT FIRST,    *INKCS005
01210 *    AND IF OK, CHECK THE UPCSKU TABLE.                          *INKCS005
01211 *----------------------------------------------------------------*INKCS005
01212                                                                   INKCS005
01213  3010-VALIDATE-UPC.                                               INKCS005
01214                                                                   INKCS005
01215      SET ASC-UPC-NOT-ENTERED       TO  TRUE.                      INKCS005
01216      SET ASC-SKU-NOT-RENUMBERED    TO  TRUE.                      INKCS005
01217      MOVE ASC-UPC-NBR              TO  DP010I-UNEDITED-FIELD.     INKCS005
01218      MOVE PC-15                    TO  DP010I-MAXIMUM-DIGITS.     INKCS005
01219      MOVE ZERO                     TO  DP010I-MAXIMUM-DECIMALS.   INKCS005
01220      SET DP010I-NEGATIVE-NOT-ALLOWED                              INKCS005
01221                                    TO  TRUE.                      INKCS005
263126     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
263126          USING DP010I-NUMERIC-EDIT-AREA.                                 
01223                                                                   INKCS005
01224      IF  DP010I-ERROR-DETECTED                                    INKCS005
01225          PERFORM 3013-SET-UPC-ERROR                               INKCS005
01226          MOVE PC-TSYMSG-00008      TO  DP020-MSG-NUMBER           INKCS005
01227      ELSE                                                         INKCS005
01228          IF  DP010I-NUM-FIELD-15-DIG-2-DEC EQUAL ZERO             INKCS005
01229              MOVE SPACES           TO  ASC-UPC-NBR-X              INKCS005
01230          ELSE                                                     INKCS005
01231              MOVE DP010I-NUM-FIELD-15-DIG-2-DEC                   INKCS005
01232                                    TO  ASC-UPC-NBR                INKCS005
01233              PERFORM 3011-CONTINUE-UPC-VALIDATE                   INKCS005
01234          END-IF                                                   INKCS005
01235      END-IF.                                                      INKCS005
01236                                                                   INKCS005
01237 *----------------------------------------------------------------*INKCS005
01238 *    PASSED THE NUMERIC CHECK, VALIDATE CHECK DIGIT AND          *INKCS005
01239 *    EXISTANCE OF THE UPC.                                       *INKCS005
01240 *----------------------------------------------------------------*INKCS005
01241                                                                   INKCS005
01242  3011-CONTINUE-UPC-VALIDATE.                                      INKCS005
01243                                                                   INKCS005
X28545     MOVE ASC-UPC-NBR                   TO DP040I-UPC-CODE.       INKCS005
X28545     SET DP040I-COMP-CHECK-DIGIT-OPTION TO TRUE.                  INKCS005
X28545                                                                  INKCS005
X28545     CALL DP040I-UPC-CHECK-DIGIT-WO-IUPC                          INKCS005
X28545                            USING  DP040I-UPC-CHECK-DIGIT-PARMS.  INKCS005
X28545                                                                  INKCS005
X28545     IF  DP040I-UPC-CHECK-DIGIT = DP040I-COMPUTED-UPC-CHK-DIGIT   INKCS005
                                                                                
J28545*  PRICING                                                                
J28545       SET IN400-PV-UPC-NBR-LOOKUP TO TRUE                                
X28545*****  SET ASC-UPC-ENTERED         TO TRUE                                
J28545       MOVE ASC-UPC-NBR            TO IN400-PV-UPC-NBR-IN                 
J28545       MOVE INVPAR-PLND-INV-DTE    TO IN400-PV-EFF-DTE-IN                 
J28545       MOVE INVPAR-LOC-NBR         TO IN400-PV-LOC-IN-NUM                 
J28545       PERFORM IN400-LOOKUP-RETAIL                                        
J28545                                                                          
J28545       MOVE IN400-PRC-UPC-OUT      TO ASC-UPC-NBR                 INKCS005
J28545                                                                          
J28545       EVALUATE TRUE                                                      
J28545         WHEN IN400-PV-FOUND                                              
J28545           MOVE IN400-PRC-UPC-OUT  TO ASC-UPC-NBR                         
32318            IF IN400-ATT-PLU-DWNLD-IND EQUAL 'N'                           
32318              PERFORM 3013-SET-UPC-ERROR                           INKCS005
32318              MOVE PC-TSYMSG-03549  TO DP020-MSG-NUMBER            INKCS005
32318              MOVE DP040I-COMPUTED-UPC-CHK-DIGIT                   INKCS005
32318                                    TO DP020-MSG-TEXT              INKCS005
32318            ELSE                                                           
J28545             MOVE IN400-PRC-SKU-OUT      TO  PV-SKU                       
J28545             MOVE PV-SKU                 TO  ASC-SKU                      
J28545             IF IN400-PS-RENUMBER-SKU                                     
J28545                 SET ASC-SKU-RENUMBERED                                   
J28545                     PS-SKU-RENUMBERED   TO  TRUE                         
J28545                 MOVE IN400-PRC-SKU-OUT  TO  PV-SKU                       
J28545                 MOVE PV-SKU             TO  PV-RSKU-NBR                  
J28545                                             ASC-RSKU-NBR                 
J28545                 SET DP020-MSG-INFORMATIONAL TO TRUE                      
J28545                 MOVE IN400-PRC-SKU-OUT                                   
J28545                                      TO DP020-MSG-TEXT                   
J28545                 MOVE PC-TSYMSG-00453 TO DP020-MSG-NUMBER                 
J28545                 IF IN400-PRC-UNIT-RTL-OUT NOT > ZERO                     
J28545                     PERFORM 3012-PRICE-ERROR                             
J28545                 ELSE                                                     
J28545                     MOVE IN400-PRC-UNIT-RTL-OUT                          
J28545                                       TO ASC-INV-PR-AMT                  
J28545                     PERFORM 3040-CONTINUE-CHECK                          
J28545                 END-IF                                                   
J28545             END-IF                                                       
J28545             IF IN400-PV-DUMMY-UPC                                        
X28545                 MOVE IN400-ATT-UPC-OUT  TO ASC-UPC-NBR                   
X28545                 MOVE IN400-ATT-SKU-OUT  TO PV-SKU                        
X28545                 MOVE PV-SKU             TO ASC-SKU                       
X28545*******          IF ASC-PRICE-NOT-ENTERED                                 
X28545                 IF  ASC-INV-PR-AMT NOT GREATER THAN ZERO         INKCS005
J28545                     PERFORM 5010-SET-ENTER-PRICE                         
J28545                 END-IF                                                   
J28545             END-IF                                                       
J28545             IF IN400-PS-STR-FOUND                                        
J28545                 IF IN400-PV-UPC-NBR-IN-NUM = IN400-PRC-UPC-OUT           
J28545                     IF IN400-PRC-UNIT-RTL-OUT NOT > ZERO                 
J28545                         PERFORM 5010-SET-ENTER-PRICE                     
J28545                     ELSE                                                 
J28545                         PERFORM 3040-CONTINUE-CHECK                      
J28545                     END-IF                                               
J28545                 ELSE                                                     
J28545                     PERFORM 3013-SET-UPC-ERROR                   INKCS005
J28545                     SET DP020-MSG-INFORMATIONAL TO TRUE                  
J28545                     MOVE IN400-PRC-SKU-OUT                               
J28545                                      TO DP020-MSG-TEXT                   
J28545                     MOVE PC-TSYMSG-00453 TO DP020-MSG-NUMBER             
J28545                 END-IF                                                   
J28545             END-IF                                                       
32318            END-IF                                                         
J28545         WHEN IN400-PV-SQL-ERROR                                          
J28545             MOVE IN400-PV-RETURN-RSN                             INKCS005
J28545                             TO DP013-MESSAGE-TEXT (1)            INKCS005
J28545             MOVE IN400-PV-PARAGRAPH                              INKCS005
J28545                                 TO DP013-MESSAGE-TEXT (2)        INKCS005
J28545             MOVE SQLCA            TO DP013-SQLCA                 INKCS005
J28545             MOVE '3011-CONTINUE-UPC-VALIDATE'                    INKCS005
J28545                             TO DP013-MESSAGE-TEXT (3)            INKCS005
J28545             SET DP013-DB2-ABEND                                  INKCS005
J28545                 DP013-XCTL-DISPLAY-RESTART                       INKCS005
J28545                             TO TRUE                              INKCS005
J28545             PERFORM DP013-0000-PROCESS-ABEND                     INKCS005
J28545         WHEN IN400-PV-NOT-FOUND                                          
J28545             IF IN400-PS-DUMMY-SKU                                        
J28545                 IF ASC-PRICE-NOT-ENTERED                                 
J28545                     PERFORM 3012-PRICE-ERROR                             
J28545                 END-IF                                                   
J28545             ELSE                                                         
J28545                 MOVE IN400-PV-UPC-NBR-IN TO ASC-UPC-NBR                  
J28545                 PERFORM 3013-SET-UPC-ERROR                               
J28545                 MOVE DP015-UNP-ALP-BRT-OFF                               
J28545                             TO ASC-PR-AMT-ATTRIBUTE                      
J28545                 MOVE DP015-RED                                           
J28545                             TO ASC-PR-AMT-COLOR                          
J28545                 MOVE DP015-REVERSE                                       
J28545                             TO ASC-PR-AMT-HILIGHT                        
J28545             END-IF                                                       
J28545         END-EVALUATE                                                     
J28545                                                                          
X28545     ELSE                                                         INKCS005
X28545         PERFORM 3013-SET-UPC-ERROR                               INKCS005
X28545         MOVE PC-TSYMSG-00474      TO  DP020-MSG-NUMBER           INKCS005
X28545         MOVE DP040I-COMPUTED-UPC-CHK-DIGIT                       INKCS005
X28545                                   TO  DP020-MSG-TEXT             INKCS005
X28545     END-IF.                                                      INKCS005
X28545                                                                  INKCS005
J28545*----------------------------------------------------------------*INKCS005
J28545*    SET THE ERROR FLAGS FOR THE UPC NUMBER.                     *INKCS005
J28545*----------------------------------------------------------------*INKCS005
J28545 3012-PRICE-ERROR.                                                        
J28545                                                                          
J28545     MOVE PC-TSYMSG-00688        TO DP020-MSG-NUMBER                      
J28545     SET ASC-ENTER-PRICE                                                  
J28545         ASC-PRICE-ERROR                                                  
J28545         DP020-MSG-FATAL                                                  
J28545         PS-ERROR                TO  TRUE                                 
J28545     MOVE DP015-UNP-ALP-BRT-OFF  TO  ASC-PR-AMT-ATTRIBUTE                 
J28545     MOVE DP015-RED              TO  ASC-PR-AMT-COLOR                     
J28545     MOVE DP015-REVERSE          TO  ASC-PR-AMT-HILIGHT                   
J28545     MOVE -1                     TO  AIPRICEL.                            
01322 *----------------------------------------------------------------*INKCS005
01323 *    SET THE ERROR FLAGS FOR THE UPC NUMBER.                     *INKCS005
01324 *----------------------------------------------------------------*INKCS005
01325                                                                   INKCS005
01326  3013-SET-UPC-ERROR.                                              INKCS005
01327                                                                   INKCS005
01328      SET PS-ERROR                                                 INKCS005
01329          ASC-UPC-ERROR                                            INKCS005
01330          DP020-MSG-FATAL           TO  TRUE.                      INKCS005
01331      MOVE PC-TSYMSG-00100          TO  DP020-MSG-NUMBER.          INKCS005
01332      MOVE DP015-UNP-ALP-BRT-OFF    TO  AIUPCA.                    INKCS005
01333      MOVE DP015-RED                TO  AIUPCC.                    INKCS005
01334      MOVE DP015-REVERSE            TO  AIUPCH.                    INKCS005
01335      MOVE -1                       TO  AIUPCL.                    INKCS005
01336 /                                                                 INKCS005
01337 *----------------------------------------------------------------*INKCS005
01338 *    ENSURE THE SKU EXISTS.                                      *INKCS005
01339 *----------------------------------------------------------------*INKCS005
01340 *                                                                 INKCS005
01341  3020-VALIDATE-SKU.                                               INKCS005
01342                                                                   INKCS005
01343      SET ASC-SKU-NOT-ENTERED       TO  TRUE.                      INKCS005
01344      SET ASC-SKU-NOT-RENUMBERED    TO  TRUE.                      INKCS005
01379                                                                   INKCS005
W21732     MOVE ASC-SKU                  TO  DP010I-UNEDITED-FIELD.     INKCS005
W21732     MOVE PC-8                     TO  DP010I-MAXIMUM-DIGITS.     INKCS005
01382      MOVE ZERO                     TO  DP010I-MAXIMUM-DECIMALS.   INKCS005
01383      SET DP010I-NEGATIVE-NOT-ALLOWED                              INKCS005
01384                                    TO  TRUE.                      INKCS005
263126     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
263126          USING DP010I-NUMERIC-EDIT-AREA.                                 
01386                                                                   INKCS005
01387      IF  DP010I-ERROR-DETECTED                                    INKCS005
01388          PERFORM 3025-SET-SKU-ERROR                               INKCS005
01389          MOVE PC-TSYMSG-00008      TO  DP020-MSG-NUMBER           INKCS005
01390      ELSE                                                         INKCS005
01391 *        IF  DP010I-NUMERIC-FIELD EQUAL ZERO                      INKCS005
01392 *            MOVE SPACES           TO  ASC-SEQ-NBR                INKCS005
01393 *        ELSE                                                     INKCS005
01394              MOVE DP010I-NUMERIC-FIELD                            INKCS005
01395                                    TO  PV-WORK-NBR                INKCS005
W21732             MOVE PV-WORK-NBR-X    TO  ASC-SKU                    INKCS005
J28545                                       IN400-PV-SKU-IN-NUM                
01397 *        END-IF                                                   INKCS005
01398      END-IF.                                                      INKCS005
01399                                                                   INKCS005
01400      IF  ASC-SKU-ERROR                                            INKCS005
01401          CONTINUE                                                 INKCS005
01402      ELSE                                                         INKCS005
01403          PERFORM 3021-CONTINUE-SKU-VALIDATE                       INKCS005
01404      END-IF.                                                      INKCS005
01406 *----------------------------------------------------------------*INKCS005
01407 *    PASSED NUMERIC CHECK, NOW FILE VALIDATE.                    *INKCS005
01408 *----------------------------------------------------------------*INKCS005
01409                                                                   INKCS005
01410  3021-CONTINUE-SKU-VALIDATE.                                      INKCS005
J28545                                                                          
X28545**** SET ASC-SKU-NOT-ENTERED       TO  TRUE.                      INKCS005
X28545**** SET ASC-SKU-NOT-RENUMBERED    TO  TRUE.                      INKCS005
J28545                                                                  INKCS005
J28545*  PRICING                                                                
J28545     SET IN400-PV-SKU-LOOKUP TO TRUE                                      
J28545     MOVE ASC-SKU                TO IN400-PV-SKU-IN                       
J28545     MOVE INVPAR-PLND-INV-DTE    TO IN400-PV-EFF-DTE-IN.                  
J28545     MOVE INVPAR-LOC-NBR         TO IN400-PV-LOC-IN-NUM                   
J28545     PERFORM IN400-LOOKUP-RETAIL.                                         
J28545                                                                          
J28545     IF IN400-PV-FOUND                                                    
J28545         EVALUATE TRUE                                                    
J28545           WHEN IN400-PS-DUMMY-SKU                                        
X28545*******      IF ASC-PRICE-NOT-ENTERED                                     
X28545             IF  ASC-INV-PR-AMT NOT GREATER THAN ZERO             INKCS005
J28545                   PERFORM 5010-SET-ENTER-PRICE                           
J28545             END-IF                                                       
J28545                                                                          
J28545           WHEN IN400-PS-STR-FOUND                                        
32318              IF IN400-ATT-PLU-DWNLD-IND EQUAL 'N'                         
32318                PERFORM 3025-SET-SKU-ERROR                                 
32318                MOVE PC-TSYMSG-03549  TO DP020-MSG-NUMBER          INKCS005
32318              ELSE                                                         
J28545               SET ASC-SKU-ENTERED           TO TRUE                      
J28545*              IF IN400-PV-SKU-IN-NUM NOT = IN400-PRC-SKU-OUT             
J28545               IF IN400-PS-RENUMBER-SKU                                   
J28545                   SET DP020-MSG-INFORMATIONAL TO TRUE                    
J28545                   MOVE IN400-PRC-SKU-OUT                                 
J28545                                      TO DP020-MSG-TEXT                   
J28545                   MOVE PC-TSYMSG-00453 TO DP020-MSG-NUMBER               
J28545                   SET ASC-SKU-RENUMBERED                         INKCS005
J28545                       PS-SKU-RENUMBERED TO TRUE                  INKCS005
J28545               END-IF                                                     
J28545               IF IN400-PRC-UNIT-RTL-OUT NOT >  ZERO                      
J28545                   PERFORM 5010-SET-ENTER-PRICE                           
J28545               ELSE                                                       
J28545                   PERFORM 3040-CONTINUE-CHECK                            
J28545               END-IF                                                     
32318              END-IF                                                       
J28545         END-EVALUATE                                                     
J28545                                                                          
J28545     ELSE                                                                 
J28545         EVALUATE TRUE                                                    
J28545            WHEN IN400-PV-SQL-ERROR                                       
J28545               MOVE IN400-PV-RETURN-RSN                           INKCS005
J28545                               TO DP013-MESSAGE-TEXT (1)          INKCS005
J28545               MOVE IN400-PV-PARAGRAPH                            INKCS005
J28545                                   TO DP013-MESSAGE-TEXT (2)      INKCS005
J28545               MOVE SQLCA          TO DP013-SQLCA                 INKCS005
J28545               MOVE '3021-CONTINUE-SKU-VALIDATE'                  INKCS005
J28545                               TO DP013-MESSAGE-TEXT (3)          INKCS005
J28545               SET DP013-DB2-ABEND                                INKCS005
J28545                   DP013-XCTL-DISPLAY-RESTART                     INKCS005
J28545                               TO TRUE                            INKCS005
J28545               PERFORM DP013-0000-PROCESS-ABEND                   INKCS005
J28545                                                                          
J28545            WHEN IN400-PV-NOT-FOUND                                       
J28545               PERFORM 3025-SET-SKU-ERROR                                 
J28545         END-EVALUATE                                                     
J28545     END-IF.                                                              
J28545                                                                          
01449 /                                                                 INKCS005
01450 *----------------------------------------------------------------*INKCS005
01451 *    COMMON ROUTINE TO SET SKU ERROR FLAGS.                      *INKCS005
01452 *----------------------------------------------------------------*INKCS005
01453                                                                   INKCS005
01454  3025-SET-SKU-ERROR.                                              INKCS005
01455                                                                   INKCS005
01456      SET PS-ERROR                                                 INKCS005
01457          ASC-SKU-ERROR                                            INKCS005
01458          DP020-MSG-FATAL           TO  TRUE.                      INKCS005
J28545     MOVE IN400-PV-SKU-IN          TO  ASC-SKU                            
01460      MOVE PC-TSYMSG-00073          TO  DP020-MSG-NUMBER.          INKCS005
W21732     MOVE DP015-UNP-ALP-BRT-OFF    TO  AISKUA                     INKCS005
J28545                                       AIPRICEA.                          
W21732     MOVE DP015-RED                TO  AISKUC                     INKCS005
J28545                                       AIPRICEC.                          
W21732     MOVE DP015-REVERSE            TO  AISKUH                     INKCS005
J28545                                       AIPRICEH.                          
W21732     MOVE -1                       TO  AISKUL.                    INKCS005
01471                                                                   INKCS005
J28545     MOVE DP015-UNP-ALP-BRT-OFF  TO ASC-PR-AMT-ATTRIBUTE                  
J28545     MOVE DP015-RED              TO ASC-PR-AMT-COLOR                      
J28545     MOVE DP015-REVERSE          TO ASC-PR-AMT-HILIGHT.                   
J28545*    MOVE DP015-ASK-NOR-OFF        TO  AIPRICEA.                  INKCS005
J28545*    MOVE DP015-BLUE               TO  AIPRICEC.                  INKCS005
J28545*    MOVE DP015-HL-OFF             TO  AIPRICEH.                  INKCS005
01476 /                                                                 INKCS005
01477 *----------------------------------------------------------------*INKCS005
01478 *                                                                 INKCS005
01479 *                                                                 INKCS005
01480 *----------------------------------------------------------------*INKCS005
01481                                                                   INKCS005
01482  3040-CONTINUE-CHECK.                                             INKCS005
01483                                                                   INKCS005
01484      IF  IN001-SCANNING-STORE                                     INKCS005
J32318**** AND (IN001-AREA-NBR LESS THAN PC-9000                        INKCS005
J32318**** OR   IN001-AREA-NBR GREATER   PC-9999)                       INKCS005
01487                                                                   INKCS005
J28545         IF IN400-PS-DUMMY-SKU                                    INKCS005
J28545             PERFORM 5010-SET-ENTER-PRICE                         INKCS005
J28545         ELSE                                                             
J28545             IF IN400-PRC-STATUS-OUT EQUAL PC-30                  INKCS005
J28545                 PERFORM 3050-CHECK-RED-YELLOW-PRICES                     
J28545             ELSE                                                         
J28545                 IF IN400-PRC-UNIT-RTL-OUT GREATER THAN ZERO      INKCS005
J28545                     MOVE IN400-PRC-UNIT-RTL-OUT                          
J28545                                         TO ASC-INV-PR-AMT                
J28545                     PERFORM 5020-RESET-ENTER-PRICE               INKCS005
J28545                 ELSE                                                     
J28545                     PERFORM 5010-SET-ENTER-PRICE                 INKCS005
J28545                 END-IF                                           INKCS005
J28545             END-IF                                               INKCS005
J28545         END-IF                                                   INKCS005
J28545     END-IF.                                                      INKCS005
J28545                                                                          
J28545*----------------------------------------------------------------         
J28545*  WHEN AN ITEM IS FIRST PUT ON CLEARANCE, THE PRICE IS CHANGED           
J28545*  AND THE STATUS IS CHANGED TO '30'.  THE STATUS CHANGE DATE             
J28545*  AND THE RETAIL CHANGE DATE ARE ALSO UPDATED.  THE ITEM IS NOW          
J28545*  A YELLOW TICKET ITEM. THE SYSTEM WILL GET THE PRICE FOR THESE          
J28545*  AND THEN IT CAN BE CHANGED.                                            
J28545*  WHEN THE ITEM GOES TO RED, THE RETAIL CHANGE DATE IS UPDATED           
J28545*  WHEN THE NEW PRICE IS ENTERED.                                         
J28545*  RED TICKET ITEMS REQUIRE THE PRICE TO BE ENTERED.                      
J28545*----------------------------------------------------------------         
J28545 3050-CHECK-RED-YELLOW-PRICES.                                            
J28545     IF IN400-PRC-UPC-CHG-DTE-OUT =                                       
J28545                      IN400-PRC-STAT-CHG-DTE-OUT                          
J28545*  YELLOW TICKET ITEM                                                     
J28545         MOVE IN400-PRC-UNIT-RTL-OUT                                      
J28545                                 TO ASC-INV-PR-AMT                        
J28545     ELSE                                                                 
J28545*  RED TICKET ITEM, REQUIRES PRICE ENTRY                                  
J28545         PERFORM 5010-SET-ENTER-PRICE                             INKCS005
J28545     END-IF.                                                      INKCS005
01507 /                                                                 INKCS005
01508 *----------------------------------------------------------------*INKCS005
01509 *    RESET THE DATA ENTERABLE FIELDS ATTRIBUTE, HIGHLIGHT, AND   *INKCS005
01510 *    COLOR BYTES.                                                *INKCS005
01511 *----------------------------------------------------------------*INKCS005
01512                                                                   INKCS005
01513  3200-RESET-ATTRIBUTES.                                           INKCS005
01514                                                                   INKCS005
01515      IF  ASC-INVALID-ITM-IND EQUAL PC-Y  AND                      INKCS005
01516               ASC-INT-APPL-FORMAT-IND NOT = PC-2                  INKCS005
W21732         MOVE DP015-UNP-ALP-NOR-OFF                               INKCS005
W21732                                   TO AISKUA                      INKCS005
01521                                       AIUPCA                      INKCS005
W21732         MOVE DP015-GREEN          TO AISKUC                      INKCS005
W21732                                      AIUPCC                      INKCS005
W21732         MOVE DP015-UNDERLINE      TO AISKUH                      INKCS005
W21732                                      AIUPCH                      INKCS005
01530      ELSE                                                         INKCS005
W21732         MOVE DP015-ASK-NOR-OFF    TO AISKUA                      INKCS005
01534                                       AIUPCA                      INKCS005
W21732         MOVE DP015-BLUE           TO AISKUC                      INKCS005
01539                                       AIUPCC                      INKCS005
W21732         MOVE DP015-HL-OFF         TO AISKUH                      INKCS005
01543                                       AIUPCH                      INKCS005
01544      END-IF.                                                      INKCS005
01545                                                                   INKCS005
01546      IF (ASC-ORIG-INV-PR-AMT EQUAL ZERO                           INKCS005
01547      AND ASC-INV-PR-AMT EQUAL ZERO)                               INKCS005
01548      AND ASC-INT-APPL-FORMAT-IND NOT = PC-2                       INKCS005
01549          MOVE DP015-UNP-ALP-BRT-OFF                               INKCS005
01550                                    TO  ASC-PR-AMT-ATTRIBUTE       INKCS005
01551          MOVE DP015-GREEN          TO  ASC-PR-AMT-COLOR           INKCS005
01552          MOVE DP015-UNDERLINE      TO  ASC-PR-AMT-HILIGHT         INKCS005
01553      ELSE                                                         INKCS005
01554          MOVE DP015-ASK-NOR-OFF    TO  ASC-PR-AMT-ATTRIBUTE       INKCS005
01555          MOVE DP015-BLUE           TO  ASC-PR-AMT-COLOR           INKCS005
01556          MOVE DP015-HL-OFF         TO  ASC-PR-AMT-HILIGHT         INKCS005
01557      END-IF.                                                      INKCS005
01558                                                                   INKCS005
01559      IF (ASC-ORIG-INV-QTY EQUAL ZERO                              INKCS005
01560      AND ASC-ORIG-INV-QTY EQUAL ZERO)                             INKCS005
01561      AND ASC-INT-APPL-FORMAT-IND NOT = PC-2                       INKCS005
01562          MOVE DP015-UNP-ALP-BRT-OFF                               INKCS005
01563                                    TO  ASC-INV-QTY-ATTRIBUTE      INKCS005
01564          MOVE DP015-GREEN          TO  ASC-INV-QTY-COLOR          INKCS005
01565          MOVE DP015-UNDERLINE      TO  ASC-INV-QTY-HILIGHT        INKCS005
01566      ELSE                                                         INKCS005
01567          MOVE DP015-ASK-NOR-OFF    TO  ASC-INV-QTY-ATTRIBUTE      INKCS005
01568          MOVE DP015-BLUE           TO  ASC-INV-QTY-COLOR          INKCS005
01569          MOVE DP015-HL-OFF         TO  ASC-INV-QTY-HILIGHT        INKCS005
01570      END-IF.                                                      INKCS005
01571                                                                   INKCS005
01572      MOVE ASC-PR-AMT-COLOR         TO  AIPRICEC.                  INKCS005
01573      MOVE ASC-PR-AMT-HILIGHT       TO  AIPRICEH.                  INKCS005
01574      MOVE ASC-PR-AMT-ATTRIBUTE     TO  AIPRICEA.                  INKCS005
01575      MOVE ASC-INV-QTY-COLOR        TO  AIQTYC.                    INKCS005
01576      MOVE ASC-INV-QTY-HILIGHT      TO  AIQTYH.                    INKCS005
01577      MOVE ASC-INV-QTY-ATTRIBUTE    TO  AIQTYA.                    INKCS005
01578                                                                   INKCS005
01579      IF (ASC-INVALID-ITM-IND EQUAL PC-Y                           INKCS005
01580      OR  ASC-INVALID-REC-IND EQUAL PC-Y)                          INKCS005
01581          CONTINUE                                                 INKCS005
01582      ELSE                                                         INKCS005
01583          SET ASC-PROTECT-ENTRY     TO  TRUE                       INKCS005
01584      END-IF.                                                      INKCS005
01585                                                                   INKCS005
01587 *----------------------------------------------------------------*INKCS005
01588 *    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *INKCS005
01589 *    ENTRY.                                                      *INKCS005
01590 *----------------------------------------------------------------*INKCS005
01591                                                                   INKCS005
01592  4000-BUILD-INITIAL-PANEL.                                        INKCS005
01593                                                                   INKCS005
01594      INITIALIZE ASC-SCREEN-ENTERABLE-FIELDS.                      INKCS005
01595      MOVE IN001-STORE-NBR          TO  ASC-STORE-NBR.             INKCS005
01596      MOVE IN001-AREA-NBR           TO  ASC-AREA-NBR.              INKCS005
01597                                                                   INKCS005
01598      PERFORM 4100-GET-TINVDTL.                                    INKCS005
01599      IF SQLCODE = ZERO                                            INKCS005
01600         IF INVDTL-INVALID-ITM-IND = 'N' AND                       INKCS005
01601            INVDTL-INVALID-REC-IND = 'N' AND                       INKCS005
01602            ASC-INT-APPL-FORMAT-IND = PC-2                         INKCS005
01603              MOVE SPACES TO ASC-ORIG-SKU-NBR                      INKCS005
01604                             ASC-SKU-NBR                           INKCS005
01605              MOVE ZEROES TO ASC-ORIG-INV-QTY                      INKCS005
01606                             ASC-INV-QTY                           INKCS005
01607                             ASC-ORIG-INV-PR-AMT                   INKCS005
01608                             ASC-INV-PR-AMT                        INKCS005
01609                             ASC-UPC-NBR                           INKCS005
01610                             ASC-ORIG-UPC-NBR                      INKCS005
01611              MOVE INVDTL-INVALID-ITM-IND                          INKCS005
01612                                        TO  ASC-INVALID-ITM-IND    INKCS005
01613              MOVE INVDTL-INVALID-REC-IND                          INKCS005
01614                                        TO  ASC-INVALID-REC-IND    INKCS005
01615                                                                   INKCS005
01616          ELSE                                                     INKCS005
W21732             IF (INVDTL-REC-SKU-NBR   NOT GREATER THAN ZERO       INKCS005
W21732             AND INVDTL-CORR-SKU-NBR  NOT GREATER THAN ZERO)      INKCS005
01619                  MOVE SPACES           TO  ASC-ORIG-SKU-NBR       INKCS005
01620              ELSE                                                 INKCS005
W21732                 MOVE INVDTL-REC-SKU-NBR                          INKCS005
W21732                                       TO  ASC-OSKU-NBR           INKCS005
01627                  IF  ASC-ORIG-SKU-NBR NOT GREATER THAN ZERO       INKCS005
01628                      MOVE SPACES       TO  ASC-ORIG-SKU-NBR       INKCS005
01629                  END-IF                                           INKCS005
W21732                 IF  INVDTL-CORR-SKU-NBR  GREATER THAN ZERO       INKCS005
W21732                     MOVE INVDTL-CORR-SKU-NBR                     INKCS005
W21732                                       TO  PV-SKU                 INKCS005
W21732                     MOVE PV-SKU       TO  ASC-SKU                INKCS005
01637                  END-IF                                           INKCS005
01638              END-IF                                               INKCS005
01639                                                                   INKCS005
01640              MOVE INVDTL-REC-UPC-NBR   TO  ASC-ORIG-UPC-NBR       INKCS005
01641              IF  INVDTL-CORR-UPC-NBR GREATER THAN ZERO            INKCS005
01642                  MOVE INVDTL-CORR-UPC-NBR  TO  ASC-UPC-NBR        INKCS005
01643              END-IF                                               INKCS005
01644                                                                   INKCS005
01645              MOVE INVDTL-REC-QTY       TO  ASC-ORIG-INV-QTY       INKCS005
01646              IF  INVDTL-CORR-QTY GREATER THAN ZERO                INKCS005
01647                  MOVE INVDTL-CORR-QTY  TO  ASC-INV-QTY            INKCS005
01648              END-IF                                               INKCS005
01649                                                                   INKCS005
01650              MOVE INVDTL-REC-PR-AMT    TO  ASC-ORIG-INV-PR-AMT    INKCS005
01651              IF  INVDTL-CORR-PR-AMT GREATER THAN ZERO             INKCS005
01652                  MOVE INVDTL-CORR-PR-AMT TO ASC-INV-PR-AMT        INKCS005
01653              END-IF                                               INKCS005
01654                                                                   INKCS005
01655              MOVE INVDTL-INVALID-ITM-IND                          INKCS005
01656                                        TO  ASC-INVALID-ITM-IND    INKCS005
01657              MOVE INVDTL-INVALID-REC-IND                          INKCS005
01658                                        TO  ASC-INVALID-REC-IND    INKCS005
01659                                                                   INKCS005
01660              IF (ASC-INVALID-ITM-IND EQUAL PC-Y                   INKCS005
01661              OR  ASC-INVALID-REC-IND EQUAL PC-Y)                  INKCS005
01662              AND ASC-INT-APPL-FORMAT-IND NOT EQUAL PC-2           INKCS005
01663                  SET DP030-SET-CURSOR-APPL-1                      INKCS005
01664                                        TO  TRUE                   INKCS005
01665                  IF  ASC-INVALID-ITM-IND EQUAL PC-Y               INKCS005
W21732                     MOVE -1           TO  AISKUL                 INKCS005
01667                  ELSE                                             INKCS005
01668                      IF  ASC-ORIG-INV-QTY EQUAL ZERO              INKCS005
01669                          MOVE -1       TO  AIQTYL                 INKCS005
01670                      ELSE                                         INKCS005
01671                          MOVE -1       TO  AIPRICEL               INKCS005
01672                      END-IF                                       INKCS005
01673                  END-IF                                           INKCS005
01674              ELSE                                                 INKCS005
01675                  SET DP030-SET-CURSOR-TRAILER                     INKCS005
01676                      ASC-PROTECT-ENTRY TO  TRUE                   INKCS005
01677              END-IF                                               INKCS005
01678                                                                   INKCS005
01679          END-IF                                                   INKCS005
01680                                                                   INKCS005
01681      END-IF.                                                      INKCS005
01682                                                                   INKCS005
01683 *----------------------------------------------------------------*INKCS005
01684 * SELECT A ROW FROM THE DB2 TINVDTL TABLE.                       *INKCS005
01685 *----------------------------------------------------------------*INKCS005
01686                                                                   INKCS005
01687  4100-GET-TINVDTL.                                                INKCS005
01688                                                                   INKCS005
W26600         MOVE ASC-STORE-NBR         TO PV-STORE-NBR-X.                    
W26600         MOVE PV-STORE-NBR-9        TO INVDTL-LOC-NBR.                    
W21732         MOVE ASC-AREA-NBR          TO INVDTL-AREA-NBR.                   
W21732         MOVE ASC-INV-LINE-NBR      TO INVDTL-INV-LINE-NBR.               
W21732         MOVE ASC-SCAN-LINE-NBR     TO INVDTL-SCAN-LINE-NBR.              
W21732                                                                          
01689          EXEC SQL                                                 INKCS005
01690               SELECT                                              INKCS005
01691                      REC_UPC_NBR                                  INKCS005
W21732                   , REC_SKU_NBR                                  INKCS005
01695                    , REC_QTY                                      INKCS005
01696                    , REC_PR_AMT                                   INKCS005
01697                    , CORR_UPC_NBR                                 INKCS005
W21732                   , CORR_SKU_NBR                                 INKCS005
01701                    , CORR_QTY                                     INKCS005
01702                    , CORR_PR_AMT                                  INKCS005
01703                    , INVALID_ITM_IND                              INKCS005
01704                    , INVALID_REC_IND                              INKCS005
01705              INTO                                                 INKCS005
01706                     :INVDTL-REC-UPC-NBR                           INKCS005
W21732                  , :INVDTL-REC-SKU-NBR                           INKCS005
01710                   , :INVDTL-REC-QTY                               INKCS005
01711                   , :INVDTL-REC-PR-AMT                            INKCS005
01712                   , :INVDTL-CORR-UPC-NBR                          INKCS005
W21732                  , :INVDTL-CORR-SKU-NBR                          INKCS005
01716                   , :INVDTL-CORR-QTY                              INKCS005
01717                   , :INVDTL-CORR-PR-AMT                           INKCS005
01718                   , :INVDTL-INVALID-ITM-IND                       INKCS005
01719                   , :INVDTL-INVALID-REC-IND                       INKCS005
01720              FROM                                                 INKCS005
01721                     TINVDTL                                       INKCS005
01722              WHERE                                                INKCS005
W26600                     LOC_NBR      =  :INVDTL-LOC-NBR              INKCS005
01724               AND                                                 INKCS005
W21732                     AREA_NBR     =  :INVDTL-AREA-NBR             INKCS005
01726               AND                                                 INKCS005
W21732                     INV_LINE_NBR  = :INVDTL-INV-LINE-NBR         INKCS005
01728               AND                                                 INKCS005
W21732                     SCAN_LINE_NBR = :INVDTL-SCAN-LINE-NBR        INKCS005
01730          END-EXEC.                                                INKCS005
01731                                                                   INKCS005
01732          EVALUATE TRUE                                            INKCS005
01733              WHEN SQLCODE = ZERO                                  INKCS005
01734              WHEN SQLCODE = +100                                  INKCS005
01735                   CONTINUE                                        INKCS005
01736              WHEN SQLCODE = -904                                  INKCS005
01737              WHEN SQLCODE = -913                                  INKCS005
01738                   PERFORM 9900-SOFT-ABORT                         INKCS005
01739              WHEN SQLWARN0 NOT = SPACES                           INKCS005
01740              WHEN SQLCODE NOT EQUAL ZERO                          INKCS005
01741                  MOVE '4100-GET-TINVDTL'                          INKCS005
01742                                    TO DP013-PARAGRAPH             INKCS005
01743                  MOVE 'SELECT INVALID DETAIL'                     INKCS005
01744                                    TO DP013-MESSAGE-TEXT (1)      INKCS005
01745                  MOVE SQLCA        TO DP013-SQLCA                 INKCS005
01746                  MOVE 'TINVDTL'    TO DP013-DB2-TABLE-NAME (1)    INKCS005
01747                  SET DP013-DB2-ABEND                              INKCS005
01748                      DP013-XCTL-DISPLAY-RESTART                   INKCS005
01749                                    TO TRUE                        INKCS005
01750                  PERFORM DP013-0000-PROCESS-ABEND                 INKCS005
01751          END-EVALUATE.                                            INKCS005
01752 /                                                                 INKCS005
01753 *----------------------------------------------------------------*INKCS005
01754 *    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *INKCS005
01755 *----------------------------------------------------------------*INKCS005
01756                                                                   INKCS005
01757  4400-MOVE-COMMAREA-TO-SCREEN.                                    INKCS005
01758                                                                   INKCS005
01759      IF  PS-SOFT-ABORT                                            INKCS005
01760          MOVE PC-TSYMSG-00551      TO  DP020-MSG-NUMBER           INKCS005
01761      END-IF.                                                      INKCS005
W26600     MOVE IN001-STORE-NBR          TO  ASTRNBRO.                  INKCS005
01762      MOVE IN001-STORE-NAME         TO  ASTRNAMO.                  INKCS005
01763      MOVE ASC-AREA-NBR             TO  AAREAO.                    INKCS005
01764      MOVE ASC-SCAN-LINE-NBR        TO  ALINEO.                    INKCS005
01765                                                                   INKCS005
W21732     MOVE ASC-OSKU-NBR             TO  AOSKUO.                    INKCS005
01769      MOVE ASC-ORIG-UPC-NBR         TO  AOUPCO.                    INKCS005
01770      MOVE ASC-ORIG-INV-QTY         TO  AOQTYO.                    INKCS005
01771      MOVE ASC-ORIG-INV-PR-AMT      TO  AOPRICEO.                  INKCS005
01772                                                                   INKCS005
W21732     MOVE ASC-SKU                  TO  AISKUO.                    INKCS005
01776                                                                   INKCS005
01777      IF  ASC-UPC-NBR NUMERIC                                      INKCS005
01778          MOVE ASC-UPC-NBR          TO  AIUPCO                     INKCS005
01779      END-IF.                                                      INKCS005
01780                                                                   INKCS005
01781      IF  ASC-INV-QTY NUMERIC                                      INKCS005
01782          MOVE ASC-INV-QTY          TO  AIQTYO                     INKCS005
01783      END-IF.                                                      INKCS005
01784                                                                   INKCS005
01785      IF  ASC-INV-PR-AMT NUMERIC                                   INKCS005
01786          MOVE ASC-INV-PR-AMT       TO  AIPRICEO                   INKCS005
01787      END-IF.                                                      INKCS005
01788                                                                   INKCS005
01789      IF  ASC-PROTECT-ENTRY                                        INKCS005
01790          MOVE DP015-BLUE           TO  AIPRICEC                   INKCS005
01791                                        AIQTYC                     INKCS005
W21732                                       AISKUC                     INKCS005
01795                                        AIUPCC                     INKCS005
01796          MOVE DP015-HL-OFF         TO  AIPRICEH                   INKCS005
01797                                        AIQTYH                     INKCS005
W21732                                       AISKUH                     INKCS005
01801                                        AIUPCH                     INKCS005
01802          MOVE DP015-ASK-NOR-OFF    TO  AIPRICEA                   INKCS005
01803                                        AIQTYA                     INKCS005
W21732                                       AISKUA                     INKCS005
01807                                        AIUPCA                     INKCS005
01808          SET DP030-SET-CURSOR-TRAILER                             INKCS005
01809                                    TO  TRUE                       INKCS005
01810      ELSE                                                         INKCS005
01811          MOVE ASC-PR-AMT-COLOR     TO  AIPRICEC                   INKCS005
01812          MOVE ASC-PR-AMT-HILIGHT   TO  AIPRICEH                   INKCS005
01813          MOVE ASC-PR-AMT-ATTRIBUTE TO  AIPRICEA                   INKCS005
01814          MOVE ASC-INV-QTY-COLOR    TO  AIQTYC                     INKCS005
01815          MOVE ASC-INV-QTY-HILIGHT  TO  AIQTYH                     INKCS005
01816          MOVE ASC-INV-QTY-ATTRIBUTE TO AIQTYA                     INKCS005
01817      END-IF.                                                      INKCS005
01818 /                                                                 INKCS005
01819 *----------------------------------------------------------------*INKCS005
01820 * APPLY THE CHANGES TO THE TINVDTL TABLE.                        *INKCS005
01821 *----------------------------------------------------------------*INKCS005
01822                                                                   INKCS005
01823  5000-BEGIN-UPDATE-PROCESS.                                       INKCS005
01824                                                                   INKCS005
J28545     IF  ASC-INVALID-ITM-IND NOT EQUAL PC-Y                       INKCS005
J28545         IF ASC-SKU-NBR <= SPACES                                         
J28545             MOVE ASC-ORIG-SKU-NBR TO  ASC-SKU-NBR                        
J28545                                       IN400-PV-SKU-IN                    
J28545         END-IF                                                           
J28545         IF (ASC-SKU       NOT GREATER THAN SPACES                INKCS005
J28545         AND ASC-OSKU-NBR  NOT GREATER THAN SPACES)               INKCS005
J28545             IF  ASC-UPC-NBR GREATER THAN ZERO                    INKCS005
J28545                 MOVE ASC-UPC-NBR  TO  IN400-PV-UPC-NBR-IN        INKCS005
J28545                                       PV-WORK-UPC                INKCS005
J28545             ELSE                                                 INKCS005
J28545                 MOVE ASC-ORIG-UPC-NBR                            INKCS005
J28545                                   TO  IN400-PV-UPC-NBR-IN        INKCS005
J28545                                       PV-WORK-UPC                INKCS005
J28545             END-IF                                               INKCS005
J28545                                                                  INKCS005
J28545             SET IN400-PV-SKU-LOOKUP      TO TRUE                         
J28545             MOVE ASC-SKU                 TO IN400-PV-SKU-IN              
J28545             MOVE INVPAR-PLND-INV-DTE     TO IN400-PV-EFF-DTE-IN          
J28545             MOVE INVPAR-LOC-NBR          TO IN400-PV-LOC-IN-NUM          
J28545             IF IN400-PV-DUMMY-SKU                                        
J28545                 IF  IN400-PV-NOT-FOUND                           INKCS005
J28545                     MOVE PC-NINES TO  ASC-SKU-NBR                INKCS005
J28545                     SET DP020-MSG-WARNING                        INKCS005
J28545                                   TO  TRUE                       INKCS005
J28545                 ELSE                                             INKCS005
J28545                     MOVE PV-UPC-SKU                              INKCS005
J28545                                   TO  ASC-SKU                    INKCS005
J28545                 END-IF                                           INKCS005
J28545             END-IF                                               INKCS005
J28545         END-IF                                                   INKCS005
J28545     END-IF.                                                      INKCS005
01875                                                                   INKCS005
01876      IF  PS-NO-ERROR                                              INKCS005
01877          PERFORM 5100-PREPARE-DATA                                INKCS005
01878          SET DP020-MSG-WARNING     TO  TRUE                       INKCS005
01879      END-IF.                                                      INKCS005
01880                                                                   INKCS005
01881 *----------------------------------------------------------------*INKCS005
01882 *    DUE TO THE ENTRY MADE BY THE OPERATOR, THE PRICE MUST BE    *INKCS005
01883 *    ENTERED.                                                    *INKCS005
01884 *----------------------------------------------------------------*INKCS005
01885                                                                   INKCS005
01886  5010-SET-ENTER-PRICE.                                            INKCS005
01887                                                                   INKCS005
01888      IF ((PS-PRICE-ENTERED                                        INKCS005
01889      AND ASC-INV-PR-AMT GREATER THAN ZERO)                        INKCS005
01890                                                                   INKCS005
01891      OR                                                           INKCS005
01892         (NOT IN001-SCANNING-STORE                                 INKCS005
01893      AND (ASC-INV-PR-AMT GREATER THAN ZERO                        INKCS005
01894       OR  ASC-ORIG-INV-PR-AMT GREATER THAN ZERO))                 INKCS005
01895                                                                   INKCS005
01896      OR                                                           INKCS005
01897         (IN001-SCANNING-STORE                                     INKCS005
01898      AND (IN001-AREA-NBR GREATER THAN PC-8999                     INKCS005
01899      AND  IN001-AREA-NBR LESS THAN PC-10000)                      INKCS005
01900      AND (ASC-INV-PR-AMT GREATER THAN ZERO                        INKCS005
01901       OR  ASC-ORIG-INV-PR-AMT GREATER THAN ZERO)))                INKCS005
01902                                                                   INKCS005
01903          CONTINUE                                                 INKCS005
01904      ELSE                                                         INKCS005
01905          SET ASC-ENTER-PRICE                                      INKCS005
01906              DP020-MSG-FATAL                                      INKCS005
01907              PS-WARNING            TO  TRUE                       INKCS005
01908                                                                   INKCS005
01909          MOVE DP015-UNP-ALP-BRT-OFF TO ASC-PR-AMT-ATTRIBUTE       INKCS005
01910          MOVE DP015-RED            TO  ASC-PR-AMT-COLOR           INKCS005
01911          MOVE DP015-REVERSE        TO  ASC-PR-AMT-HILIGHT         INKCS005
01912          MOVE -1                   TO  AIPRICEL                   INKCS005
           END-IF.                                                              
01913                                                                   INKCS005
01918                                                                   INKCS005
01919 *----------------------------------------------------------------*INKCS005
01920 *    DUE TO THE ENTRY MADE BY THE OPERATOR, THE PRICE MUST BE    *INKCS005
01921 *    ENTERED.                                                    *INKCS005
01922 *----------------------------------------------------------------*INKCS005
01923                                                                   INKCS005
01924  5020-RESET-ENTER-PRICE.                                          INKCS005
01925                                                                   INKCS005
01926      SET ASC-RESET-PRICE                                          INKCS005
01927          ASC-PRICE-NOT-ENTERED     TO  TRUE.                      INKCS005
01928      IF  PS-WARNING                                               INKCS005
01929          SET DP020-MSG-INFORMATIONAL                              INKCS005
01930              PS-NO-ERROR           TO  TRUE                       INKCS005
01931          MOVE ZERO                 TO  DP020-MSG-NUMBER           INKCS005
01932      END-IF.                                                      INKCS005
01933                                                                   INKCS005
01934      MOVE DP015-ASK-NOR-OFF        TO  ASC-PR-AMT-ATTRIBUTE.      INKCS005
01935      MOVE DP015-BLUE               TO  ASC-PR-AMT-COLOR.          INKCS005
01936      MOVE DP015-HL-OFF             TO  ASC-PR-AMT-HILIGHT.        INKCS005
01937      MOVE ZERO                     TO  AIPRICEL.                  INKCS005
01938                                                                   INKCS005
01957 *----------------------------------------------------------------*INKCS005
01958 *    PREPARE THE HOST VARIABLES, BEGIN THE TABLE UPDATES.        *INKCS005
01959 *----------------------------------------------------------------*INKCS005
01960                                                                   INKCS005
01961  5100-PREPARE-DATA.                                               INKCS005
01962                                                                   INKCS005
01963      IF (ASC-SKU-NBR EQUAL ASC-ORIG-SKU-NBR                       INKCS005
01964      AND ASC-UPC-NBR EQUAL ASC-ORIG-UPC-NBR)                      INKCS005
W21732         MOVE ZERO                 TO  INVDTL-CORR-SKU-NBR        INKCS005
01968      ELSE                                                         INKCS005
W21732         MOVE ASC-SKU              TO  PV-SKU                     INKCS005
W21732         MOVE PV-SKU               TO  INVDTL-CORR-SKU-NBR        INKCS005
01972      END-IF.                                                      INKCS005
01973                                                                   INKCS005
01974      IF  ASC-UPC-NBR EQUAL ASC-ORIG-UPC-NBR                       INKCS005
01975          MOVE ZERO                 TO  INVDTL-CORR-UPC-NBR        INKCS005
01976      ELSE                                                         INKCS005
01977          MOVE ASC-UPC-NBR          TO  INVDTL-CORR-UPC-NBR        INKCS005
01978      END-IF.                                                      INKCS005
01979                                                                   INKCS005
01980      IF  ASC-INV-QTY NOT EQUAL ASC-ORIG-INV-QTY                   INKCS005
01981          MOVE ASC-INV-QTY          TO  INVDTL-CORR-QTY            INKCS005
01982      ELSE                                                         INKCS005
01983          MOVE ZERO                 TO  INVDTL-CORR-QTY            INKCS005
01984      END-IF.                                                      INKCS005
01985                                                                   INKCS005
01986      MOVE ASC-INV-PR-AMT           TO  INVDTL-CORR-PR-AMT.        INKCS005
01987                                                                   INKCS005
01988      MOVE PC-N                     TO  INVDTL-INVALID-ITM-IND     INKCS005
01989                                        INVDTL-INVALID-REC-IND.    INKCS005
01990                                                                   INKCS005
01991      PERFORM 5200-UPDATE-TINVDTL-ROW.                             INKCS005
01992      PERFORM 5300-UPDATE-TINVLOC.                                 INKCS005
01993      PERFORM 5400-PREPARE-TADJDTL-ROW.                            INKCS005
01994      PERFORM 5600-DB2-COMMIT.                                     INKCS005
01995                                                                   INKCS005
01996      IF  ASC-USE-SELECTION-QUEUE                                  INKCS005
01997          PERFORM 9000-UPDATE-SELECTION-QUEUE                      INKCS005
01998          SET ASC-PROTECT-ENTRY     TO  TRUE                       INKCS005
01999      END-IF.                                                      INKCS005
02000                                                                   INKCS005
02001 *----------------------------------------------------------------*INKCS005
02002 *  UPDATE THE ROW ON THE DB2 TABLE.                              *INKCS005
02003 *----------------------------------------------------------------*INKCS005
02004                                                                   INKCS005
02005  5200-UPDATE-TINVDTL-ROW.                                         INKCS005
02006                                                                   INKCS005
W26600        MOVE ASC-STORE-NBR         TO PV-STORE-NBR-X.                     
W26600        MOVE PV-STORE-NBR-9        TO INVDTL-LOC-NBR.                     
W21732        MOVE ASC-AREA-NBR          TO INVDTL-AREA-NBR.                    
W21732        MOVE ASC-INV-LINE-NBR      TO INVDTL-INV-LINE-NBR.                
W21732        MOVE ASC-SCAN-LINE-NBR     TO INVDTL-SCAN-LINE-NBR.               
W21732                                                                          
02007          EXEC SQL                                                 INKCS005
02008               UPDATE                                              INKCS005
02009                      TINVDTL                                      INKCS005
02010                 SET                                               INKCS005
W21732                     CORR_SKU_NBR    =  :INVDTL-CORR-SKU-NBR      INKCS005
02014                    , CORR_UPC_NBR    =  :INVDTL-CORR-UPC-NBR      INKCS005
02015                    , CORR_QTY        =  :INVDTL-CORR-QTY          INKCS005
02016                    , CORR_PR_AMT     =  :INVDTL-CORR-PR-AMT       INKCS005
02017                    , INVALID_ITM_IND =  :INVDTL-INVALID-ITM-IND   INKCS005
02018                    , INVALID_REC_IND =  :INVDTL-INVALID-REC-IND   INKCS005
02019                    , CHG_ID_NBR      =  :DP020-USERID             INKCS005
02020                    , CHG_TMST        =   CURRENT TIMESTAMP        INKCS005
02021              WHERE                                                INKCS005
W26600                     LOC_NBR         =  :INVDTL-LOC-NBR           INKCS005
W21732               AND   AREA_NBR        =  :INVDTL-AREA-NBR          INKCS005
W21732               AND   INV_LINE_NBR    =  :INVDTL-INV-LINE-NBR      INKCS005
W21732               AND   SCAN_LINE_NBR   =  :INVDTL-SCAN-LINE-NBR     INKCS005
02026          END-EXEC.                                                INKCS005
02027                                                                   INKCS005
02028          EVALUATE TRUE                                            INKCS005
02029              WHEN SQLCODE = ZERO                                  INKCS005
02030                  CONTINUE                                         INKCS005
02031              WHEN SQLCODE = -904                                  INKCS005
02032              WHEN SQLCODE = -913                                  INKCS005
02033                   PERFORM 9900-SOFT-ABORT                         INKCS005
02034              WHEN SQLWARN0 NOT = SPACES                           INKCS005
02035              WHEN SQLCODE < ZERO                                  INKCS005
02036              WHEN SQLCODE > ZERO                                  INKCS005
02037                  MOVE '5200-UPDATE-TINVDTL-ROW'                   INKCS005
02038                                    TO DP013-PARAGRAPH             INKCS005
02039                  MOVE 'UPDATE A ROW ON THE TINVDTL TABLE'         INKCS005
02040                                    TO DP013-MESSAGE-TEXT(1)       INKCS005
02041                  MOVE SQLCA        TO DP013-SQLCA                 INKCS005
02042                  MOVE 'TINVDTL'    TO DP013-DB2-TABLE-NAME (1)    INKCS005
02043                  SET DP013-DB2-ABEND                              INKCS005
02044                      DP013-XCTL-DISPLAY-RESTART TO TRUE           INKCS005
02045                  PERFORM DP013-0000-PROCESS-ABEND                 INKCS005
02046          END-EVALUATE.                                            INKCS005
02047 /                                                                 INKCS005
02048 *----------------------------------------------------------------*INKCS005
02049 *    BEGIN THE UPDATE PROCESS FOR THE PHYSICAL LOCATION TABLE.   *INKCS005
02050 *----------------------------------------------------------------*INKCS005
02051                                                                   INKCS005
02052  5300-UPDATE-TINVLOC.                                             INKCS005
02053                                                                   INKCS005
W26600     MOVE ASC-STORE-NBR            TO  PV-STORE-NBR-X.            INKCS005
W26600     MOVE PV-STORE-NBR-9           TO  INVLOC-LOC-NBR.            INKCS005
02055      MOVE ASC-AREA-NBR             TO  INVLOC-AREA-NBR.           INKCS005
02056      PERFORM 5310-READ-TINVLOC-ROW.                               INKCS005
02057                                                                   INKCS005
02058      IF  ASC-INVALID-ITM-IND EQUAL PC-Y                           INKCS005
02059          ADD 1                     TO  INVLOC-TOT-ITM-CORR-QTY    INKCS005
02060      END-IF.                                                      INKCS005
02061                                                                   INKCS005
02062      IF  ASC-INVALID-REC-IND EQUAL PC-Y                           INKCS005
02063          ADD 1                     TO  INVLOC-TOT-REC-CORR-QTY    INKCS005
02064      END-IF.                                                      INKCS005
02065                                                                   INKCS005
02066      PERFORM 5320-UPDATE-TINVLOC-ROW.                             INKCS005
02067                                                                   INKCS005
02068 *----------------------------------------------------------------*INKCS005
02069 *    READ THE TINVLOC TABLE.                                     *INKCS005
02070 *----------------------------------------------------------------*INKCS005
02071                                                                   INKCS005
02072  5310-READ-TINVLOC-ROW.                                           INKCS005
02073                                                                   INKCS005
02074          EXEC SQL                                                 INKCS005
02075               SELECT                                              INKCS005
02076                     TOT_REC_CORR_QTY                              INKCS005
02077                   , TOT_ITM_CORR_QTY                              INKCS005
02078               INTO                                                INKCS005
02079                    :INVLOC-TOT-REC-CORR-QTY                       INKCS005
02080                   ,:INVLOC-TOT-ITM-CORR-QTY                       INKCS005
02081               FROM                                                INKCS005
02082                     TINVLOC                                       INKCS005
02083               WHERE                                               INKCS005
W26600                    LOC_NBR           =  :INVLOC-LOC-NBR          INKCS005
02085                AND                                                INKCS005
02086                     AREA_NBR            =  :INVLOC-AREA-NBR       INKCS005
02087          END-EXEC.                                                INKCS005
02088                                                                   INKCS005
02089          EVALUATE TRUE                                            INKCS005
02090              WHEN SQLCODE = ZERO                                  INKCS005
02091                  CONTINUE                                         INKCS005
02092              WHEN SQLCODE = -904                                  INKCS005
02093              WHEN SQLCODE = -913                                  INKCS005
02094                   PERFORM 9900-SOFT-ABORT                         INKCS005
02095              WHEN SQLWARN0 NOT = SPACES                           INKCS005
02096              WHEN SQLCODE < ZERO                                  INKCS005
02097              WHEN SQLCODE > ZERO                                  INKCS005
02098                  MOVE '5310-READ-TINVLOC-ROW'                     INKCS005
02099                                    TO DP013-PARAGRAPH             INKCS005
02100                  MOVE 'READ A ROW ON THE TINVLOC TABLE'           INKCS005
02101                                    TO DP013-MESSAGE-TEXT(1)       INKCS005
02102                  MOVE SQLCA        TO DP013-SQLCA                 INKCS005
02103                  MOVE 'TINVLOC'    TO DP013-DB2-TABLE-NAME (1)    INKCS005
02104                  SET DP013-DB2-ABEND                              INKCS005
02105                      DP013-XCTL-DISPLAY-RESTART TO TRUE           INKCS005
02106                  PERFORM DP013-0000-PROCESS-ABEND                 INKCS005
02107          END-EVALUATE.                                            INKCS005
02108                                                                   INKCS005
02109 *----------------------------------------------------------------*INKCS005
02110 *    UPDATE THE PHYSICAL LOCATION ROW.                           *INKCS005
02111 *----------------------------------------------------------------*INKCS005
02112                                                                   INKCS005
02113  5320-UPDATE-TINVLOC-ROW.                                         INKCS005
02114                                                                   INKCS005
02115          EXEC SQL                                                 INKCS005
02116               UPDATE                                              INKCS005
02117                      TINVLOC                                      INKCS005
02118                 SET                                               INKCS005
02119                      TOT_REC_CORR_QTY = :INVLOC-TOT-REC-CORR-QTY  INKCS005
02120                    , TOT_ITM_CORR_QTY = :INVLOC-TOT-ITM-CORR-QTY  INKCS005
02121                    , CHG_TMST         =  CURRENT TIMESTAMP        INKCS005
02122              WHERE                                                INKCS005
W26600                     LOC_NBR       =  :INVLOC-LOC-NBR             INKCS005
02124                AND                                                INKCS005
02125                      AREA_NBR        =  :INVLOC-AREA-NBR          INKCS005
02126          END-EXEC.                                                INKCS005
02127                                                                   INKCS005
02128          EVALUATE TRUE                                            INKCS005
02129              WHEN SQLCODE = ZERO                                  INKCS005
02130                  CONTINUE                                         INKCS005
02131              WHEN SQLCODE = -904                                  INKCS005
02132              WHEN SQLCODE = -913                                  INKCS005
02133                   PERFORM 9900-SOFT-ABORT                         INKCS005
02134              WHEN SQLWARN0 NOT = SPACES                           INKCS005
02135              WHEN SQLCODE < ZERO                                  INKCS005
02136              WHEN SQLCODE > ZERO                                  INKCS005
02137                  MOVE '5320-UPDATE-TINVLOC-ROW'                   INKCS005
02138                                    TO DP013-PARAGRAPH             INKCS005
02139                  MOVE 'UPDATE A ROW ON THE TINVLOC TABLE'         INKCS005
02140                                    TO DP013-MESSAGE-TEXT(1)       INKCS005
02141                  MOVE SQLCA        TO DP013-SQLCA                 INKCS005
02142                  MOVE 'TINVLOC'    TO DP013-DB2-TABLE-NAME (1)    INKCS005
02143                  SET DP013-DB2-ABEND                              INKCS005
02144                      DP013-XCTL-DISPLAY-RESTART TO TRUE           INKCS005
02145                  PERFORM DP013-0000-PROCESS-ABEND                 INKCS005
02146          END-EVALUATE.                                            INKCS005
02147 /                                                                 INKCS005
02148 *----------------------------------------------------------------*INKCS005
02149 *    PREPARE THE ADJUSTMENT DETAIL HOST VARIABLES.               *INKCS005
02150 *----------------------------------------------------------------*INKCS005
02151                                                                   INKCS005
02152  5400-PREPARE-TADJDTL-ROW.                                        INKCS005
02153                                                                   INKCS005
W26600     MOVE ASC-STORE-NBR            TO  PV-STORE-NBR-X.                    
W26600     MOVE PV-STORE-NBR-9           TO  ADJDTL-LOC-NBR.                    
                                                                                
02155      MOVE ASC-AREA-NBR             TO  ADJDTL-AREA-NBR.           INKCS005
02156      MOVE PC-CO                    TO  ADJDTL-ADJ-TYPE-CDE.       INKCS005
02157      MOVE PC-CORRECTION            TO  ADJDTL-ADJ-RSN-TXT.        INKCS005
02158                                                                   INKCS005
02159      IF  ASC-SKU-RENUMBERED                                       INKCS005
W21732         MOVE ASC-RSKU-NBR         TO  PV-SKU                     INKCS005
W21732         MOVE PV-SKU               TO  ADJDTL-SKU-NBR             INKCS005
02163      ELSE                                                         INKCS005
W21732         MOVE ASC-SKU              TO  PV-SKU                     INKCS005
W21732         MOVE PV-SKU               TO  ADJDTL-SKU-NBR             INKCS005
02167      END-IF.                                                      INKCS005
02168                                                                   INKCS005
RONNA**    FIX FOR CORPORATE INVALID                                            
RONNA**    A CORPORATE INVALID IS WHEN THE UPC IS A DUMMY KOHLS UPC             
RONNA**    OR THE AREA IS 9000-999 AND THE PRICE IS ZERO.                       
RONNA**    THIS ASSUMES THAT THE CORP INVALID HAS A KOHLS DUMMY UPC             
RONNA      IF ASC-INVALID-ITM-IND = PC-N AND                                    
RONNA         ASC-INVALID-REC-IND = PC-Y                                        
RONNA          MOVE ASC-ORIG-UPC-NBR     TO  ADJDTL-UPC-NBR                     
RONNA                                        PV-WORK-UPC                        
RONNA          IF PV-KOHLS-UPC                                                  
RONNA              MOVE PV-UPC-SKU       TO  ADJDTL-SKU-NBR                     
RONNA          ELSE                                                             
RONNA              MOVE ASC-OSKU-NBR     TO  ADJDTL-SKU-NBR                     
RONNA      ELSE                                                                 
25248          MOVE ASC-UPC-NBR          TO  ADJDTL-UPC-NBR.                    
25248                                                                           
02169      IF  INVDTL-CORR-QTY EQUAL ZERO                               INKCS005
02170          MOVE ASC-ORIG-INV-QTY     TO  ADJDTL-ADJ-QTY             INKCS005
02171      ELSE                                                         INKCS005
02172          MOVE INVDTL-CORR-QTY      TO  ADJDTL-ADJ-QTY             INKCS005
02173      END-IF.                                                      INKCS005
02174                                                                   INKCS005
02175      IF  INVDTL-CORR-PR-AMT EQUAL ZERO                            INKCS005
02176          MOVE ASC-ORIG-INV-PR-AMT  TO  ADJDTL-ADJ-UNIT-PR-AMT     INKCS005
02177      ELSE                                                         INKCS005
02178          MOVE INVDTL-CORR-PR-AMT   TO  ADJDTL-ADJ-UNIT-PR-AMT     INKCS005
02179      END-IF.                                                      INKCS005
02180                                                                   INKCS005
02181      COMPUTE ADJDTL-ADJ-EXTD-AMT = ADJDTL-ADJ-UNIT-PR-AMT         INKCS005
02182                                  * ADJDTL-ADJ-QTY.                INKCS005
02183      MOVE ZERO                     TO  ADJDTL-DKEY-NBR.           INKCS005
02184      MOVE DP020-USERID             TO  ADJDTL-CRE-ID-NBR.         INKCS005
02185                                                                   INKCS005
02186      PERFORM 5410-INSERT-TADJDTL-ROW.                             INKCS005
02187                                                                   INKCS005
02188 *----------------------------------------------------------------*INKCS005
02189 *    INSERT THE ADJUSTMENT DETAIL ROW.                           *INKCS005
02190 *----------------------------------------------------------------*INKCS005
02191                                                                   INKCS005
02192  5410-INSERT-TADJDTL-ROW.                                         INKCS005
02193                                                                   INKCS005
02194          EXEC SQL                                                 INKCS005
02195               INSERT                                              INKCS005
02196               INTO  TADJDTL                                       INKCS005
W26600                   (LOC_NBR                                               
02198                   , AREA_NBR                                      INKCS005
W21732                  , SKU_NBR                                       INKCS005
25248                   , UPC_NBR                                       INKCS005
02202                   , CRE_TMST                                      INKCS005
02203                   , ADJ_RSN_TXT                                   INKCS005
02204                   , ADJ_TYPE_CDE                                  INKCS005
02205                   , ADJ_UNIT_PR_AMT                               INKCS005
02206                   , ADJ_QTY                                       INKCS005
02207                   , ADJ_EXTD_AMT                                  INKCS005
02208                   , DKEY_NBR                                      INKCS005
02209                   , CRE_ID_NBR)                                   INKCS005
02210              VALUES                                               INKCS005
W26600                   (:ADJDTL-LOC-NBR                                       
02212                   , :ADJDTL-AREA-NBR                              INKCS005
W21732                  , :ADJDTL-SKU-NBR                               INKCS005
25248                   , :ADJDTL-UPC-NBR                               INKCS005
02216                   ,  CURRENT TIMESTAMP                            INKCS005
02217                   , :ADJDTL-ADJ-RSN-TXT                           INKCS005
02218                   , :ADJDTL-ADJ-TYPE-CDE                          INKCS005
02219                   , :ADJDTL-ADJ-UNIT-PR-AMT                       INKCS005
02220                   , :ADJDTL-ADJ-QTY                               INKCS005
02221                   , :ADJDTL-ADJ-EXTD-AMT                          INKCS005
02222                   , :ADJDTL-DKEY-NBR                              INKCS005
02223                   , :ADJDTL-CRE-ID-NBR)                           INKCS005
02224          END-EXEC.                                                INKCS005
02225                                                                   INKCS005
02226          EVALUATE TRUE                                            INKCS005
02227              WHEN SQLCODE = ZERO                                  INKCS005
02228                  CONTINUE                                         INKCS005
02229              WHEN SQLCODE = -904                                  INKCS005
02230              WHEN SQLCODE = -913                                  INKCS005
02231                   PERFORM 9900-SOFT-ABORT                         INKCS005
02232              WHEN SQLWARN0 NOT = SPACES                           INKCS005
02233              WHEN SQLCODE < ZERO                                  INKCS005
02234              WHEN SQLCODE > ZERO                                  INKCS005
02235                  MOVE '5410-INSERT-TADJDTL-ROW'                   INKCS005
02236                                    TO DP013-PARAGRAPH             INKCS005
02237                  MOVE 'INSERT A ROW ON THE TADJDTL TABLE'         INKCS005
02238                                    TO DP013-MESSAGE-TEXT(1)       INKCS005
02239                  MOVE SQLCA        TO DP013-SQLCA                 INKCS005
02240                  MOVE 'TADJDTL'    TO DP013-DB2-TABLE-NAME (1)    INKCS005
02241                  SET DP013-DB2-ABEND                              INKCS005
02242                      DP013-XCTL-DISPLAY-RESTART TO TRUE           INKCS005
02243                  PERFORM DP013-0000-PROCESS-ABEND                 INKCS005
02244          END-EVALUATE.                                            INKCS005
02245 /                                                                 INKCS005
02038 *----------------------------------------------------------------*INKCS003
02039 *    SELECT PLANNED INVENTORY DATE FROM TINVPAR                   INKCS003
02040 *----------------------------------------------------------------*INKCS003
       5570-SELECT-TINVPAR.                                             INKUT102
JS1099     INITIALIZE DCLTINVPAR.                                               
JS1099                                                                          
W26600     MOVE IN001-STORE-NBR TO PV-STORE-NBR-X.                              
W26600     MOVE PV-STORE-NBR-9  TO  INVPAR-LOC-NBR.                             
JKB        MOVE IN001-INV-ID    TO  PV-INV-ID.                                  
JKB                                                                             
JS1099     EXEC SQL                                                             
W28545       SELECT   A.PLND_INV_DTE                                            
W28545         INTO  :INVPAR-PLND-INV-DTE                                       
W28545         FROM   TINVPAR A                                                 
W28545               ,TINCNTL B                                                 
W28545       WHERE A.INV_ID = B.INV_ID                                          
W28545         AND A.INV_ID = :PV-INV-ID                                        
W28545         AND B.ACTV_IND = 'Y'                                             
W28545         AND A.ACTL_FIN_BK_DTE = :PC-NULL-DATE                            
W33304         AND A.LOC_INV_STAT_CDE = 'IN'                                    
W28545         AND A.LOC_NBR = :INVPAR-LOC-NBR                                  
JS1099     END-EXEC.                                                            
JS1099                                                                          
JS1099     EVALUATE SQLCODE                                                     
JS1099         WHEN +0                                                          
JS1099             CONTINUE                                                     
IN2001             MOVE INVPAR-PLND-INV-DTE TO PV-DB2-PLND-INV-DTE              
JS0999         WHEN OTHER                                                       
ABEND              MOVE '5570-SELECT-INVPAR  '  TO DP013-PARAGRAPH      INKCS003
ABEND              MOVE 'SELECT TINVPAR' TO DP013-MESSAGE-TEXT (1)      INKCS003
ABEND              MOVE SQLCA        TO DP013-SQLCA                     INKCS003
ABEND              MOVE 'TINVPAR'    TO DP013-DB2-TABLE-NAME (1)        INKCS003
ABEND              SET DP013-DB2-ABEND                                  INKCS003
ABEND                  DP013-XCTL-DISPLAY-RESTART                       INKCS003
ABEND                     TO TRUE                                       INKCS003
ABEND              PERFORM DP013-0000-PROCESS-ABEND                     INKCS003
           END-EVALUATE.                                                        
                                                                                
                                                                        INKUT102
02576 *----------------------------------------------------------------*INKCS005
02577 * DB2 COMMIT                                                     *INKCS005
02578 *----------------------------------------------------------------*INKCS005
02579                                                                   INKCS005
02580  5600-DB2-COMMIT.                                                 INKCS005
02581                                                                   INKCS005
02582      EXEC SQL                                                     INKCS005
02583           COMMIT                                                  INKCS005
02584      END-EXEC.                                                    INKCS005
02585                                                                   INKCS005
02586 /                                                                 INKCS005
02587 *----------------------------------------------------------------*INKCS005
02588 * RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *INKCS005
02589 * OBJECT WAS UPDATED.                                            *INKCS005
02590 *----------------------------------------------------------------*INKCS005
02591                                                                   INKCS005
02592  9000-UPDATE-SELECTION-QUEUE.                                     INKCS005
02593                                                                   INKCS005
02594      PERFORM 9100-READ-SEL-QUEUE.                                 INKCS005
02595      SET IN003-UPD (ASC-SEL-SUB) TO TRUE.                         INKCS005
02596      PERFORM 9200-REWRITE-SEL-QUEUE.                              INKCS005
02597 /                                                                 INKCS005
02598 *----------------------------------------------------------------*INKCS005
02599 *    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *INKCS005
02600 *    AND THE ERROR SWITCHES.                                     *INKCS005
02601 *----------------------------------------------------------------*INKCS005
02602                                                                   INKCS005
02603  9900-SOFT-ABORT.                                                 INKCS005
02604                                                                   INKCS005
02605      SET PS-ERROR                                                 INKCS005
02606          PS-SOFT-ABORT           TO  TRUE.                        INKCS005
02607      SET DP020-MSG-FATAL         TO  TRUE.                        INKCS005
02608      MOVE PC-TSYMSG-00551        TO  DP020-MSG-NUMBER.            INKCS005
02609 /                                                                 INKCS005
02610 *----------------------------------------------------------------*INKCS005
02611 * READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *INKCS005
02612 *----------------------------------------------------------------*INKCS005
02613                                                                   INKCS005
02614  9100-READ-SEL-QUEUE.                                             INKCS005
02615                                                                   INKCS005
02616      EXEC CICS                                                    INKCS005
02617          READQ TS                                                 INKCS005
02618              QUEUE (ASC-SEL-QUEUE-NAME)                           INKCS005
02619              INTO  (IN003-SELECTED-LINES)                         INKCS005
02620              ITEM  (ASC-SEL-ITEM)                                 INKCS005
02621              RESP  (PV-CICS-RESPONSE)                             INKCS005
02622      END-EXEC.                                                    INKCS005
02623                                                                   INKCS005
02624      IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   INKCS005
02625          CONTINUE                                                 INKCS005
02626      ELSE                                                         INKCS005
02627          SET DP013-LOGIC-ABEND                                    INKCS005
02628              DP013-NO-ROLLBACK     TO TRUE                        INKCS005
02629          MOVE '9100-READ-SEL-QUEUE'                               INKCS005
02630                                    TO DP013-PARAGRAPH             INKCS005
02631          MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   INKCS005
02632                                    TO DP013-MESSAGE-TEXT (1)      INKCS005
02633          PERFORM DP013-0000-PROCESS-ABEND                         INKCS005
02634      END-IF.                                                      INKCS005
02635                                                                   INKCS005
02636 *----------------------------------------------------------------*INKCS005
02637 * UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *INKCS005
02638 *----------------------------------------------------------------*INKCS005
02639                                                                   INKCS005
02640  9200-REWRITE-SEL-QUEUE.                                          INKCS005
02641                                                                   INKCS005
02642      EXEC CICS                                                    INKCS005
02643           WRITEQ TS                                               INKCS005
02644               QUEUE  (ASC-SEL-QUEUE-NAME)                         INKCS005
02645               FROM   (IN003-SELECTED-LINES)                       INKCS005
02646               ITEM   (ASC-SEL-ITEM)                               INKCS005
02647               RESP   (PV-CICS-RESPONSE)                           INKCS005
02648               REWRITE                                             INKCS005
02649      END-EXEC.                                                    INKCS005
02650                                                                   INKCS005
02651      IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               INKCS005
02652          SET DP013-CICS-ABEND                                     INKCS005
02653              DP013-NO-ROLLBACK     TO TRUE                        INKCS005
02654          MOVE '9200-REWRITE-SEL-QUEUE'                            INKCS005
02655                                    TO DP013-PARAGRAPH             INKCS005
02656          MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   INKCS005
02657                                    TO DP013-MESSAGE-TEXT (1)      INKCS005
02658          PERFORM DP013-0000-PROCESS-ABEND                         INKCS005
02659      END-IF.                                                      INKCS005
02660 /                                                                 INKCS005
02661 *----------------------------------------------------------------*INKCS005
02662 *    ABEND PROCESSOR MODULE                                      *INKCS005
02663 *----------------------------------------------------------------*INKCS005
02664                                                                   INKCS005
02665      COPY DPPD013.                                                INKCS005
J28545                                                                  INKCS005
28545 *-----------------------------------------------------------------        
28545 *  INWS400 - COMMON PRICE LOOKUP MODULE PROCEDURE DEFINITION              
28545 *-----------------------------------------------------------------        
J28545     COPY INPD400.                                                        
