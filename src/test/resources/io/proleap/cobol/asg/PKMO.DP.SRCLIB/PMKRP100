000100*----------------------------------------------------------       00010065
000200 IDENTIFICATION DIVISION.                                         00020065
000300*----------------------------------------------------------       00030065
000400 PROGRAM-ID.             PMKRP100.                                00040065
000500 AUTHOR.                 ALEXIS KEIKER.                           00050065
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060065
000700 DATE-WRITTEN.           APRIL 2003.                              00070065
000800 DATE-COMPILED.                                                   00080065
000900*----------------------------------------------------------       00090065
001000*          PMKRP100 - PROMO ITEM SALES RESULTS SUMMARY            00100065
001010*                               BY AD PAGE                        00110065
001020*----------------------------------------------------------       00120065
001021* THIS PROGRAM WILL PRODUCE EITHER A FORECAST ONLY REPORT         00130065
001022* OR AN ACTUAL/FORECAST REPORT. THIS PROGRAM WILL READ            00140088
001023* IN A SORTED INPUT FILE CREATED FROM PROGRAM PMKUT100.           00150088
001024* IT WILL THEN REPORT EACH PROMO ITEMS SALE RESULTS.  IF          00160088
001025* IT IS A FORECAST ONLY REPORT THEN THE INPUT FILE WOULD          00170088
001026* HAVE AN 'F' IN THE SLS TYP CDE OF THE FILE.  THIS MEANS         00180088
001027* ONLY FORECASTED INFORMATION WILL BE REPORTED.  IF IT HAS        00190088
001028* AN 'A' IN THE SLS TYP CDE OF THE FILE, IT WILL REPORT ON        00200088
001029* ACTUALS AND FORECASTS.                                          00210088
001030*----------------------------------------------------------       00220065
001031* HISTORY LOG:                                                    00230065
001032*----------------------------------------------------------       00240065
001033* DATE:                                                           00250065
001034* WR/IR#:                                                         00260065
001035* PROGRAMMER:                                                     00270065
001036* DESCRIPTION:                                                    00280065
001037*                                                                 00290065
PM3403* 04/20/2012 - PMO 3403 (LARGE RETAIL PROJECT).                   00300099
PM3403*   EXPAND UNIT RETAIL FIELDS TO ALLOW FOR AMT > 9999.99          00310099
001037*                                                                 00320099
PGNBR * DATE: 07/25/2014                                                00321099
PGNBR * WR/IR#: PRB 47935                                               00322099
PGNBR * PROGRAMMER: COGNIZANT                                           00323099
PGNBR * DESCRIPTION: MODIFIED THE PROGRAM TO PROCESS THE PROMO ITEMS AS 00324099
PGNBR *              3 CATEGORIES ADVERTISED,ADVERTISED WITH NO PAGE    00325099
PGNBR *              AND UNADVERTISED VS 2 CATEGORIES ADV & UNADV       00326099
PGNBR *                                                                 00327099
001040*----------------------------------------------------------       00330065
001050 ENVIRONMENT DIVISION.                                            00340065
001060*----------------------------------------------------------       00350065
001070 CONFIGURATION SECTION.                                           00360065
001080 SOURCE-COMPUTER. IBM-3090.                                       00370065
001090 OBJECT-COMPUTER. IBM-3090.                                       00380065
001100                                                                  00390065
001200 INPUT-OUTPUT SECTION.                                            00400065
001300                                                                  00410065
001400 FILE-CONTROL.                                                    00420065
001500                                                                  00430065
001600     SELECT PROMO-ITM-SUMM-FILE                                   00440065
001700            ASSIGN TO INP01.                                      00450065
001800                                                                  00460065
001900     SELECT PROMO-ITM-SUMM-REPORT                                 00470065
002000            ASSIGN TO RPT01.                                      00480065
002100                                                                  00490065
002200*----------------------------------------------------------       00500065
002300 DATA DIVISION.                                                   00510065
002400*----------------------------------------------------------       00520065
002500 FILE SECTION.                                                    00530065
002600                                                                  00540065
002700 FD  PROMO-ITM-SUMM-FILE                                          00550065
002800     RECORDING MODE F                                             00560065
002900     BLOCK CONTAINS 0 RECORDS                                     00570065
003000     LABEL RECORDS ARE OMITTED.                                   00580065
003100 01  PROMO-ITM-SUMM-RECORD            PIC X(750).                 00590065
003200                                                                  00600065
003300 FD  PROMO-ITM-SUMM-REPORT                                        00610065
003400     RECORDING MODE F                                             00620065
003500     BLOCK CONTAINS 0 RECORDS                                     00630065
003600     LABEL RECORDS ARE OMITTED.                                   00640065
003700 01  PROMO-ITM-SUMM-RPT-LINE          PIC X(250).                 00650065
003800                                                                  00660065
003900 WORKING-STORAGE SECTION.                                         00670065
004000*----------------------------------------------------------       00680065
004100* CD- CONTROL DATES (DATES ACCEPTED INTO THE PROGRAM)             00690065
004200*----------------------------------------------------------       00700065
004300 01  CD-CONTROL-DATES.                                            00710065
004400     05  CD-CPU-DATE.                                             00720065
004500         10  CD-CPU-YR                PIC 9(02)  VALUE ZEROES.    00730065
004510         10  CD-CPU-MO                PIC 9(02)  VALUE ZEROES.    00740065
004520         10  CD-CPU-DY                PIC 9(02)  VALUE ZEROES.    00750065
004530                                                                  00760065
004540     05  CD-CPU-DATE-GREG.                                        00770065
004550         10  CD-CPU-MM                PIC 9(02)  VALUE ZEROES.    00780065
004560         10  CD-CPU-DD                PIC 9(02)  VALUE ZEROES.    00790065
004570         10  CD-CPU-YY                PIC 9(02)  VALUE ZEROES.    00800065
004580                                                                  00810065
004590     05  CD-CPU-DATE-ISO              PIC X(10)  VALUE SPACES.    00820065
004591                                                                  00830065
004592*----------------------------------------------------------       00840065
004593* CT- CONTROL TIMES (TIMES ACCEPTED INTO THE PROGRAM)             00850065
004594*----------------------------------------------------------       00860065
004595 01  CT-CONTROL-TIMES.                                            00870065
004596     05  CT-CPU-TIME.                                             00880065
004597         10  CT-CPU-HR                PIC 9(02)  VALUE ZEROES.    00890065
004598         10  CT-CPU-MIN               PIC 9(02)  VALUE ZEROES.    00900065
004599         10  CT-CPU-SEC               PIC 9(02)  VALUE ZEROES.    00910065
004600         10  CT-CPU-HSEC              PIC 9(02)  VALUE ZEROES.    00920065
004601                                                                  00930065
004602*----------------------------------------------------------       00940065
004603* PC- PROGRAM CONSTANTS                                           00950065
004604*----------------------------------------------------------       00960065
004605 01  PC-PROGRAM-CONSTANTS.                                        00970065
004606     05  PC-MAX-LINE-CNT              PIC S9(04) VALUE +78 COMP.  00980065
004607     05  PC-SUB-1                     PIC 9(01)  VALUE 1.         00990065
004608     05  PC-SUB-2                     PIC 9(01)  VALUE 2.         01000065
004622     05  PC-DEFAULT-BEG-HR            PIC 9(02)  VALUE 0.         01010065
004623     05  PC-DEFAULT-BEG-MIN           PIC 9(02)  VALUE 0.         01020065
004624     05  PC-DEFAULT-END-HR            PIC 9(02)  VALUE 23.        01030065
004630     05  PC-DEFAULT-END-MIN           PIC 9(02)  VALUE 59.        01040065
004640     05  PC-CHAR-BUY                  PIC X(03)  VALUE 'BUY'.     01050065
004650     05  PC-CHAR-GET                  PIC X(03)  VALUE 'GET'.     01060065
004660     05  PC-CHAR-OFF                  PIC X(03)  VALUE 'OFF'.     01070065
004670     05  PC-CHAR-EFFECTIVE            PIC X(09)  VALUE            01080065
004680                                          'EFFECTIVE'.            01090065
004690     05  PC-FORECAST-RSLT             PIC X(36)  VALUE            01100069
004700         'FORECAST ONLY RESULTS (IN THOUSANDS)'.                  01110069
004800     05  PC-ACTUAL-RSLT               PIC X(36)  VALUE            01120069
004900         'ACTUAL RESULTS (IN THOUSANDS)       '.                  01130069
005000     05  PC-PERCENT-SIGN              PIC X(01)  VALUE '%'.       01140065
005100     05  PC-DOLLAR-SIGN               PIC X(01)  VALUE '$'.       01150065
005200     05  PC-FRONT-PAR                 PIC X(01)  VALUE '('.       01160065
005300     05  PC-BACK-PAR                  PIC X(01)  VALUE ')'.       01170065
005400     05  PC-ONE-LINE                  PIC S9(04) VALUE +1 COMP.   01180065
005500     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE            01190065
005600                                                 'PMKRP100'.      01200065
005700     05  PC-COLON                     PIC X(01)  VALUE ':'.       01210065
005800     05  PC-DASH                      PIC X(01)  VALUE '-'.       01220065
005900     05  PC-ALL-DAY                   PIC X(07)  VALUE            01230065
006000                                                 'ALL DAY'.       01240065
006100     05  PC-PROMO-ITEMS-ON-PAGE       PIC X(37)  VALUE            01250065
006200          'PROMO ITEMS ON PAGE:                 '.                01260065
PGNBR      05  PC-PROMO-ITEMS-NO-PAGE       PIC X(37)  VALUE            01261099
PGNBR           'ADVERTISED PROMO ITEMS WITH NO PAGE: '.                01262099
006300     05  PC-TIER-ACT-TITLE            PIC X(24)  VALUE            01270065
006400          ' TIERED ACTUAL RESULTS: '.                             01280065
006500     05  PC-PROMO-ITEMS-UNADV         PIC X(37)  VALUE            01290065
006600          'UNADVERTISED                         '.                01300065
006700     05  PC-PROMO-ITEMS-ADMIN         PIC X(37)  VALUE            01310065
006800          'ADMIN TIER PRICING - MDSE NOT ON SALE'.                01320065
006900     05  PC-TOTAL                     PIC X(21)  VALUE            01330065
007000          'TOTAL:               '.                                01340065
007100     05  PC-TOTAL-FOR-PAGE            PIC X(18)  VALUE            01350065
007200          'TOTAL FOR PAGE:   '.                                   01360065
007300     05  PC-ADV-TOTAL                 PIC X(18)  VALUE            01370065
007400          'ADVERTISED TOTAL: '.                                   01380065
PGNBR      05  PC-ADVNO-TOTAL               PIC X(32)  VALUE            01381099
PGNBR           'ADVERTISED WITH NO PAGE TOTAL: '.                      01382099
007500     05  PC-UNADV-TOTAL               PIC X(20)  VALUE            01390065
007600          'UNADVERTISED TOTAL: '.                                 01400065
007700     05  PC-ADMIN-TOTAL               PIC X(20)  VALUE            01410065
007800          'ADMIN TIERED TOTAL: '.                                 01420065
007900     05  PC-PROMOTION-TOTAL           PIC X(18)  VALUE            01430065
008000          'PROMOTION TOTAL:  '.                                   01440065
008100                                                                  01450065
008200*----------------------------------------------------------       01460065
008300* PS- PROGRAM SWITCHES                                            01470065
008400*----------------------------------------------------------       01480065
008500 01  PS-PROGRAM-SWITCHES.                                         01490065
008600     05  PS-SALES-RESULTS-SW          PIC X(01)  VALUE 'Y'.       01500065
008700         88  PS-EOF-SALES-RESULTS                VALUE 'N'.       01510065
008800         88  PS-NOT-EOF-SALES-RESULTS            VALUE 'Y'.       01520065
008900     05  PS-FIRST-TIME-SW             PIC X(01)  VALUE 'Y'.       01530065
009000         88  PS-NOT-FIRST-TIME                   VALUE 'N'.       01540065
009100         88  PS-FIRST-TIME                       VALUE 'Y'.       01550065
009200     05  PS-ADMIN-HEADER-SW           PIC X(01)  VALUE 'Y'.       01560065
009300         88  PS-NO-ADMIN-HEADER                  VALUE 'N'.       01570065
009400         88  PS-ADMIN-HEADER                     VALUE 'Y'.       01580065
009500     05  PS-PAGE-SECTION-TTL-SW       PIC X(01)  VALUE 'Y'.       01590065
009600         88  PS-PAGE-SECTION-TTL                 VALUE 'N'.       01600065
009700         88  PS-NO-PAGE-TTL                      VALUE 'Y'.       01610065
009800     05  PS-ADV-PROMO-TTL-SW          PIC X(01)  VALUE 'Y'.       01620065
009900         88  PS-ADV-PROMO-TTL                    VALUE 'N'.       01630065
010000         88  PS-NO-ADV-PROMO-TTL                 VALUE 'Y'.       01640065
PGNBR      05  PS-ADV-NOPGE-TTL-SW          PIC X(01)  VALUE 'Y'.       01641099
PGNBR          88  PS-ADV-NOPGE-TTL                    VALUE 'N'.       01642099
PGNBR          88  PS-NO-ADV-NOPGE-TTL                 VALUE 'Y'.       01643099
010100     05  PS-UNADV-PROMO-TTL-SW        PIC X(01)  VALUE 'Y'.       01650065
010200         88  PS-UNADV-PROMO-TTL                  VALUE 'N'.       01660065
010300         88  PS-NO-UNADV-PROMO-TTL               VALUE 'Y'.       01670065
010400     05  PS-ADMIN-TIER-TTL-SW         PIC X(01)  VALUE 'Y'.       01680065
010500         88  PS-ADMIN-TIER-TTL                   VALUE 'N'.       01690065
010600         88  PS-NO-ADMIN-TIER-TTL                VALUE 'Y'.       01700065
010700     05  PS-TOT-PROMO-TTL-SW          PIC X(01)  VALUE 'Y'.       01710065
010800         88  PS-TOT-PROMO-TTL                    VALUE 'N'.       01720065
010900         88  PS-NO-TOT-PROMO-TTL                 VALUE 'Y'.       01730065
011000     05  PS-BLANK-LINE-SW             PIC X(01)  VALUE 'Y'.       01740065
011100         88  PS-BLANK-LINE                       VALUE 'N'.       01750065
011200         88  PS-NO-BLANK-LINE                    VALUE 'Y'.       01760065
PGNBR      05  PS-REC-TYPE-FLAG             PIC X(01)  VALUE '0'.       01761099
PGNBR          88  PS-ADVNOPG-FLAG                     VALUE '1'.       01762099
PGNBR          88  PS-ADVPG-FLAG                       VALUE '2'.       01763099
PGNBR          88  PS-NOADV-FLAG                       VALUE '3'.       01764099
PGNBR      05  PS-HOLD-REC-TYPE-FLAG        PIC X(01)  VALUE '0'.       01765099
PGNBR          88  PS-HOLD-ADVNOPG-FLAG                VALUE '1'.       01766099
PGNBR          88  PS-HOLD-ADVPG-FLAG                  VALUE '2'.       01767099
PGNBR          88  PS-HOLD-NOADV-FLAG                  VALUE '3'.       01768099
PGNBR      05  PS-EOF-REC-TYPE-FLAG         PIC X(01)  VALUE '0'.       01769099
PGNBR          88  PS-NO-EOF-REC-TYPE                  VALUE '0'.       01769199
PGNBR          88  PS-EOF-ADVNOPG                      VALUE '1'.       01769299
PGNBR          88  PS-EOF-ADVPG                        VALUE '2'.       01769399
PGNBR          88  PS-EOF-NOADV                        VALUE '3'.       01769499
011300                                                                  01770065
011400*----------------------------------------------------------       01780065
011500* PV- PROGRAM VARIABLES                                           01790065
011600*----------------------------------------------------------       01800065
011700 01  PV-PROGRAM-VARIABLES.                                        01810065
011800     05  PV-ADVANCE-LINES             PIC S9(04) VALUE +1 COMP.   01820065
011900     05  PV-SAVE-LINE-AMT             PIC S9(04) VALUE +1 COMP.   01830065
012000     05  PV-LINE-CNT                  PIC S9(04) VALUE +0 COMP.   01840065
012010     05  PV-VAR-IDX                   PIC S9(04) VALUE +0.        01850082
012100     05  PV-PAGE-CNT                  PIC 9(05)  VALUE 0.         01860065
012200     05  PV-PARAGRAPH-NAME            PIC X(30)  VALUE SPACE.     01870065
012300     05  PV-OPERATION-MSG-1           PIC X(40)  VALUE SPACES.    01880065
012400     05  PV-OPERATION-MSG-2           PIC X(40)  VALUE SPACES.    01890065
012500     05  PV-SAVE-VAR                  PIC X(60)  VALUE SPACES.    01900086
012600     05  PV-SAVE-NUM                  PIC 9(02)  VALUE 0.         01910065
012700     05  PV-SAVE-LENGTH               PIC 9(02)  VALUE 0.         01920065
012710     05  PV-CHAR-LENGTH               PIC 9(02)  VALUE 0.         01930085
012800     05  PV-SUBSCRIPT                 PIC 9(02)  VALUE 0.         01940065
012900     05  PV-PROMO-NM-LENGTH           PIC 9(02)  VALUE 0.         01950065
013000     05  PV-AD-EVNT-NM-LENGTH         PIC 9(02)  VALUE 0.         01960065
013100     05  PV-AD-EVNT-NBR-LENGTH        PIC 9(02)  VALUE 0.         01970065
013200                                                                  01980065
013300     05  PV-TIER-ITM-DESC.                                        01990065
013400         10  FILLER                   PIC X(01)  VALUE SPACES.    02000065
013500         10  PV-TIER-ITM-DESC-1       PIC X(39)  VALUE SPACES.    02010065
013600     05  PV-THRS-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    02020065
013700     05  PV-THRS-AMT-NUM-X REDEFINES                              02030065
013800         PV-THRS-AMT-NUM              PIC 9(10).                  02040065
013900     05  PV-DISC-PCT-NUM              PIC 9(03)V9(03) VALUE 0.    02050065
014000     05  PV-DISC-PCT-NUM-X REDEFINES                              02060065
014100         PV-DISC-PCT-NUM              PIC 9(06).                  02070065
014200     05  PV-DISC-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    02080065
014300     05  PV-DISC-AMT-NUM-X REDEFINES                              02090065
014400         PV-DISC-AMT-NUM              PIC 9(10).                  02100065
014500     05  PV-SAVE-THRS-AMT.                                        02110065
014600         10  PV-SAVE-THRS-AMT-1       PIC 9(08)  VALUE 0.         02120065
014700         10  PV-SAVE-THRS-AMT-2       PIC 9(02)  VALUE 0.         02130065
014800     05  PV-SAVE-DISC-PCT.                                        02140065
014900         10  PV-SAVE-DISC-PCT-1       PIC 9(03)  VALUE 0.         02150065
015000         10  PV-SAVE-DISC-PCT-2       PIC 9(03)  VALUE 0.         02160065
015100     05  PV-SAVE-DISC-AMT.                                        02170065
015200         10  PV-SAVE-DISC-AMT-1       PIC 9(08)  VALUE 0.         02180065
015300         10  PV-SAVE-DISC-AMT-2       PIC 9(02)  VALUE 0.         02190065
015400     05  PV-THRS-AMT-CHAR             PIC X(08)  VALUE SPACES.    02200065
015500     05  PV-DISC-PCT-CHAR             PIC X(03)  VALUE SPACES.    02210065
015600     05  PV-DISC-AMT-CHAR             PIC X(08)  VALUE SPACES.    02220065
015700     05  PV-THRS-QTY-CHAR             PIC X(05)  VALUE SPACES.    02230065
015800     05  PV-POINTER-FIELD             PIC S9(03) VALUE +0.        02240065
015900     05  PV-LAST-ADEVNT-ID            PIC 9(10)  VALUE 0.         02250065
016000     05  PV-LAST-PROMO-ID             PIC 9(10)  VALUE 0.         02260065
016100     05  PV-TIER-PRICG-ID             PIC 9(10)  VALUE 0.         02270065
016200     05  PV-AD-PG-NBR                 PIC 9(03)  VALUE 0.         02280065
016300     05  PV-SAVE-ADMIN-ID             PIC 9(10)  VALUE 0.         02290065
016400     05  PV-ROUND-TO-WHOLE-DOLLARS    PIC S9(09) VALUE +0.        02300065
016500     05  PV-ROUND-TO-TENTHS           PIC S9(09)V9 VALUE +0.      02310065
016510     05  PV-ROUND-TO-HDRTHS           PIC S9(09)V99 VALUE +0.     02320074
016600     05  PV-ROUND-VOL-PCT             PIC 9(09)V9 VALUE 0.        02330065
016700     05  PV-TRUNCAT-VOL-PCT           PIC 9(04)V9 VALUE 0.        02340065
016800     05  PV-TRUNCAT-VOL-PCT-X REDEFINES                           02350065
016900         PV-TRUNCAT-VOL-PCT           PIC 9(05).                  02360065
017000     05  PV-NUM-VOL-PCT.                                          02370065
017100         10  PV-NUM-VOL-PCT-1         PIC 9(04)  VALUE 0.         02380065
017200         10  PV-NUM-VOL-PCT-2         PIC 9(01)  VALUE 0.         02390065
017300     05  PV-CHAR-VOL-PCT REDEFINES                                02400065
017400         PV-NUM-VOL-PCT.                                          02410065
017500         10  PV-CHAR-VOL-PCT-1        PIC X(04).                  02420065
017600         10  PV-CHAR-VOL-PCT-2        PIC X(01).                  02430065
017700     05  PV-FINAL-VOL-PCT.                                        02440065
017710         10  PV-FINAL-VOL-PCT-1       PIC X(01)  VALUE SPACES.    02450066
017800         10  PV-FINAL-VOL-PCT-2       PIC X(01)  VALUE SPACES.    02460065
017900         10  PV-FINAL-VOL-PCT-3       PIC X(01)  VALUE SPACES.    02470065
018000         10  PV-FINAL-VOL-PCT-4       PIC X(01)  VALUE SPACES.    02480065
018100         10  PV-FINAL-VOL-PCT-5       PIC X(01)  VALUE SPACES.    02490065
018110         10  FILLER                   PIC X(01)  VALUE '.'.       02500065
018120         10  PV-FINAL-VOL-PCT-6       PIC X(01)  VALUE SPACES.    02510065
018130         10  PV-FINAL-VOL-PCT-7       PIC X(01)  VALUE SPACES.    02520065
018140     05  PV-SEP-VOL-PCT.                                          02530065
018141         10  PV-SEP-VOL-PCT-1         PIC 9(01)  VALUE 0.         02540065
018150         10  PV-SEP-VOL-PCT-2         PIC 9(01)  VALUE 0.         02550065
018160         10  PV-SEP-VOL-PCT-3         PIC 9(01)  VALUE 0.         02560065
018170         10  PV-SEP-VOL-PCT-4         PIC 9(01)  VALUE 0.         02570065
018180         10  PV-SEP-VOL-PCT-5         PIC 9(01)  VALUE 0.         02580065
018190     05  PV-VOL-PCT-CHG               PIC S9(09)V9999 VALUE +0    02590065
018191                                                     COMP-3.      02600065
018192     05  PV-MU-PCT                    PIC S9(09)V9999 VALUE +0    02610065
018193                                                     COMP-3.      02620065
018194     05  PV-SELL-THRU-PCT             PIC S9(09)V9999 VALUE +0    02630065
018195                                                     COMP-3.      02640065
018196     05  PV-RPT-LINE                  PIC X(250) VALUE SPACES.    02650065
018197     05  PV-PROMO-STRT-TMST.                                      02660065
018198         10  PV-PROMO-STRT-DTE.                                   02670065
018199             15  PV-PM-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    02680065
018200             15  PV-PM-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    02690065
018210             15  FILLER               PIC X(01)  VALUE SPACES.    02700065
018220             15  PV-PM-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    02710065
018230             15  FILLER               PIC X(01)  VALUE SPACES.    02720065
018240             15  PV-PM-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    02730065
018250         10  FILLER                   PIC X(01)  VALUE SPACES.    02740065
018260         10  PV-PROMO-STRT-TM.                                    02750065
018270             15  PV-PM-STRT-TM-HH     PIC X(02)  VALUE SPACES.    02760065
018280             15  FILLER               PIC X(01)  VALUE SPACES.    02770065
018290             15  PV-PM-STRT-TM-MM     PIC X(02)  VALUE SPACES.    02780065
018300             15  FILLER               PIC X(01)  VALUE SPACES.    02790065
018400             15  PV-PM-STRT-TM-SS     PIC X(02)  VALUE SPACES.    02800065
018500                                                                  02810065
018600     05  PV-PROMO-END-TMST.                                       02820065
018700         10  PV-PROMO-END-DTE.                                    02830065
018800             15  PV-PM-END-DTE-CC     PIC X(02)  VALUE SPACES.    02840065
018900             15  PV-PM-END-DTE-YY     PIC X(02)  VALUE SPACES.    02850065
019000             15  FILLER               PIC X(01)  VALUE SPACES.    02860065
019100             15  PV-PM-END-DTE-MM     PIC X(02)  VALUE SPACES.    02870065
019200             15  FILLER               PIC X(01)  VALUE SPACES.    02880065
019300             15  PV-PM-END-DTE-DD     PIC X(02)  VALUE SPACES.    02890065
019400         10  FILLER                   PIC X(01)  VALUE SPACES.    02900065
019500         10  PV-PROMO-END-TM.                                     02910065
019600             15  PV-PM-END-TM-HH      PIC X(02)  VALUE SPACES.    02920065
019700             15  FILLER               PIC X(01)  VALUE SPACES.    02930065
019800             15  PV-PM-END-TM-MM      PIC X(02)  VALUE SPACES.    02940065
019900             15  FILLER               PIC X(01)  VALUE SPACES.    02950065
020000             15  PV-PM-END-TM-SS      PIC X(02)  VALUE SPACES.    02960065
020100                                                                  02970065
020200     05  PV-PROMO-ITM-STRT-TMST.                                  02980065
020300         10  PV-PROMO-ITM-STRT-DTE.                               02990065
020400             15  PV-PI-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    03000065
020500             15  PV-PI-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    03010065
020600             15  FILLER               PIC X(01)  VALUE SPACES.    03020065
020700             15  PV-PI-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    03030065
020800             15  FILLER               PIC X(01)  VALUE SPACES.    03040065
020900             15  PV-PI-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    03050065
021000         10  FILLER                   PIC X(01)  VALUE SPACES.    03060065
021100         10  PV-PROMO-ITM-STRT-TM.                                03070065
021200             15  PV-PI-STRT-TM-HH     PIC X(02)  VALUE SPACES.    03080065
021300             15  FILLER               PIC X(01)  VALUE SPACES.    03090065
021400             15  PV-PI-STRT-TM-MM     PIC X(02)  VALUE SPACES.    03100065
021500             15  FILLER               PIC X(01)  VALUE SPACES.    03110065
021600             15  PV-PI-STRT-TM-SS     PIC X(02)  VALUE SPACES.    03120065
021700                                                                  03130065
021800     05  PV-PROMO-ITM-END-TMST.                                   03140065
021900         10  PV-PROMO-ITM-END-DTE.                                03150065
022000             15  PV-PI-END-DTE-CC     PIC X(02)  VALUE SPACES.    03160065
022010             15  PV-PI-END-DTE-YY     PIC X(02)  VALUE SPACES.    03170065
022020             15  FILLER               PIC X(01)  VALUE SPACES.    03180065
022030             15  PV-PI-END-DTE-MM     PIC X(02)  VALUE SPACES.    03190065
022040             15  FILLER               PIC X(01)  VALUE SPACES.    03200065
022050             15  PV-PI-END-DTE-DD     PIC X(02)  VALUE SPACES.    03210065
022060         10  FILLER                   PIC X(01)  VALUE SPACES.    03220065
022070         10  PV-PROMO-ITM-END-TM.                                 03230065
022080             15  PV-PI-END-TM-HH      PIC X(02)  VALUE SPACES.    03240065
022090             15  FILLER               PIC X(01)  VALUE SPACES.    03250065
022091             15  PV-PI-END-TM-MM      PIC X(02)  VALUE SPACES.    03260065
022092             15  FILLER               PIC X(01)  VALUE SPACES.    03270065
022093             15  PV-PI-END-TM-SS      PIC X(02)  VALUE SPACES.    03280065
022094                                                                  03290065
022095     05  PV-PM-ITM-EFF-STRT-DTE.                                  03300065
022096         10  PV-EFF-STRT-DTE-MM       PIC X(02)  VALUE SPACES.    03310065
022097         10  FILLER                   PIC X(01)  VALUE '/'.       03320065
022098         10  PV-EFF-STRT-DTE-DD       PIC X(02)  VALUE SPACES.    03330065
022099         10  FILLER                   PIC X(01)  VALUE '/'.       03340065
022100         10  PV-EFF-STRT-DTE-YY       PIC X(02)  VALUE SPACES.    03350065
022101                                                                  03360065
022102     05  PV-PM-ITM-EFF-END-DTE.                                   03370065
022103         10  PV-EFF-END-DTE-MM        PIC X(02)  VALUE SPACES.    03380065
022104         10  FILLER                   PIC X(01)  VALUE '/'.       03390065
022105         10  PV-EFF-END-DTE-DD        PIC X(02)  VALUE SPACES.    03400065
022106         10  FILLER                   PIC X(01)  VALUE '/'.       03410065
022107         10  PV-EFF-END-DTE-YY        PIC X(02)  VALUE SPACES.    03420065
022108                                                                  03430065
022109     05  PV-EFF-DTE-LAYOUT.                                       03440065
022110         10  FILLER                   PIC X(02)  VALUE SPACES.    03450065
022111         10  PV-OPEN-PARENTH          PIC X(01)  VALUE SPACES.    03460065
022112         10  PV-EFF-STRT-DTE          PIC X(08)  VALUE SPACES.    03470065
022113         10  PV-DTE-DASH              PIC X(01)  VALUE SPACES.    03480065
022114         10  PV-EFF-END-DTE           PIC X(08)  VALUE SPACES.    03490065
022115         10  PV-CLOSE-PARENTH         PIC X(01)  VALUE SPACES.    03500065
022116                                                                  03510065
022117     05  PV-ADMIN-TIER-TOTALS.                                    03520065
022118         10  PV-TTL-SLS-RTL-AMT       PIC S9(09)V9(02) COMP-3     03530065
022119                                                 VALUE +0.        03540065
022120         10  PV-TTL-SLS-UNT-QTY       PIC S9(09)V9(02) COMP-3     03550065
022121                                                 VALUE +0.        03560065
022122         10  PV-TTL-MKDN-RTL-AMT      PIC S9(09)V9(02) COMP-3     03570065
022123                                                 VALUE +0.        03580065
022124         10  PV-TTL-SLS-COST-AMT      PIC S9(09)V9(02) COMP-3     03590065
022125                                                 VALUE +0.        03600065
022126                                                                  03610065
022127     05  PV-VARIABLE-OUTPUT-FIELD.                                03620065
022128         10  PV-BIT-VARIABLE          PIC X(01)  VALUE SPACES     03630065
022129                                       OCCURS 61 TIMES            03640086
022130                                       INDEXED BY                 03650065
022131                                       PV-BIT-IDX.                03660065
022132                                                                  03670065
022133     05  PV-VER-AD-VARIABLE.                                      03680082
022134         10  PV-PARENTHESES           PIC X(01)  VALUE SPACES.    03690082
022135         10  PV-VERSION-AD            PIC X(59)  VALUE SPACES.    03700082
022136                                                                  03710082
022137     05  PV-HEADER-DTE-TM.                                        03720065
022138         10  PV-BEG-DAY-ALPHA         PIC X(10).                  03730065
022139         10  PV-BEG-DATE              PIC X(08).                  03740065
022140         10  FILLER                   PIC X(02)  VALUE SPACES.    03750065
022141         10  PV-BEG-TIME.                                         03760065
022142             15  PV-BEG-HR-TIME       PIC 9(02).                  03770065
022143             15  PV-BEG-TIME-COLON    PIC X(01).                  03780065
022144             15  PV-BEG-MIN-TIME      PIC 9(02).                  03790065
022145             15  FILLER               PIC X(02)  VALUE SPACES.    03800065
022146         10  FILLER                   PIC X(11)  VALUE            03810065
022147                                      '   THROUGH '.              03820065
022148         10  PV-END-DAY-ALPHA         PIC X(10).                  03830065
022149         10  PV-END-DATE              PIC X(08).                  03840065
022150         10  FILLER                   PIC X(02)  VALUE SPACES.    03850065
022151         10  PV-END-TIME.                                         03860065
022152             15  PV-END-HR-TIME       PIC 9(02).                  03870065
022153             15  PV-END-TIME-COLON    PIC X(01).                  03880065
022154             15  PV-END-MIN-TIME      PIC 9(02).                  03890065
022155             15  FILLER               PIC X(02).                  03900065
022156         10  FILLER                   PIC X(22)  VALUE SPACES.    03910065
022157                                                                  03920065
022158*----------------------------------------------------------       03930065
022159* PA- PROGRAM ACCUMULATORS                                        03940065
022160*----------------------------------------------------------       03950065
022161 01  PA-PROGRAM-ACCUMULATORS.                                     03960065
022162     05  PA-CNT-ADV-TOT               PIC 9(09)  VALUE ZEROES.    03970065
PGNBR      05  PA-CNT-ADVNO-TOT             PIC 9(09)  VALUE ZEROES.    03971099
022163     05  PA-CNT-UNADV-TOT             PIC 9(09)  VALUE ZEROES.    03980065
022164     05  PA-CNT-ADMIN-TOT             PIC 9(09)  VALUE ZEROES.    03990065
022170     05  PA-CNT-SPACES-1              PIC 9(09)  VALUE ZEROES.    04000065
022180     05  PA-CNT-POS-1                 PIC 9(09)  VALUE ZEROES.    04010065
022190     05  PA-CNT-SPACES-2              PIC 9(09)  VALUE ZEROES.    04020065
022200     05  PA-CNT-SPACES                PIC 9(09)  VALUE ZEROES.    04030065
022300     05  PA-CNT-POS-2                 PIC 9(09)  VALUE ZEROES.    04040065
022310     05  PA-COUNT-CHAR                PIC 9(09)  VALUE ZEROES.    04050082
022400                                                                  04060065
022500*----------------------------------------------------------       04070065
022600* TBL- TABLE VARIABLES                                            04080065
022700*----------------------------------------------------------       04090065
022800* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  04100065
022900*    OCCURRENCE CONTAINS FORECAST FIGURES                         04110065
023000 01  TBL-SECT-TOTAL-TABLE.                                        04120065
023100     05  TBL-STOT-LINE-01 OCCURS 02 TIMES                         04130065
023200                           INDEXED BY TBL-STOT-INDX.              04140065
023300         10  TBL-STOT-TOT-SALE-AMT    PIC S9(09)V9(02) COMP-3.    04150065
023400         10  TBL-STOT-TOT-MD-AMT      PIC S9(09)V9(02) COMP-3.    04160065
023500         10  TBL-STOT-TOT-SLS-UNT-QTY                             04170065
023600                                      PIC S9(09)V9(02) COMP-3.    04180065
023700         10  TBL-STOT-TOT-EOH-INV-QTY                             04190065
023800                                      PIC S9(09)V9(02) COMP-3.    04200065
023900         10  TBL-STOT-PREP-UNT-QTY    PIC S9(09)V9(02) COMP-3.    04210065
024000         10  TBL-STOT-TOT-SLS-COST-AMT                            04220065
024100                                      PIC S9(09)V9(02) COMP-3.    04230065
024200                                                                  04240065
024300* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  04250065
024400*    OCCURRENCE CONTAINS FORECAST FIGURES                         04260065
024500 01  TBL-PROMO-TOTAL-TABLE.                                       04270065
024600     05  TBL-PMTOT-LINE-01 OCCURS 02 TIMES                        04280065
024700                          INDEXED BY TBL-PMTOT-INDX.              04290065
024800         10  TBL-PMTOT-TOT-SALE-AMT   PIC S9(09)V9(02) COMP-3.    04300065
024900         10  TBL-PMTOT-TOT-MD-AMT     PIC S9(09)V9(02) COMP-3.    04310065
025000         10  TBL-PMTOT-TOT-SLS-UNT-QTY                            04320065
025100                                      PIC S9(09)V9(02) COMP-3.    04330065
025200         10  TBL-PMTOT-TOT-EOH-INV-QTY                            04340065
025300                                      PIC S9(09)V9(02) COMP-3.    04350065
025400         10  TBL-PMTOT-PREP-UNT-QTY   PIC S9(09)V9(02) COMP-3.    04360065
025500         10  TBL-PMTOT-TOT-SLS-COST-AMT                           04370065
025600                                      PIC S9(09)V9(02) COMP-3.    04380065
025700                                                                  04390065
025800*----------------------------------------------------------       04400065
025900* ABEND- ABEND VARIABLES                                          04410065
026000*----------------------------------------------------------       04420065
026100 01  ABEND-CODE                       PIC S9(04) VALUE +0 COMP.   04430065
026200     88  ABEND-4001-WRITE-ERROR                  VALUE +4001.     04440065
026300     88  ABEND-4002-READ-ERROR                   VALUE +4002.     04450065
026400     88  ABEND-4003-CTRL-CARD-ERROR              VALUE +4003.     04460065
026500     88  ABEND-4004-TABLE-ERROR                  VALUE +4004.     04470065
026600     88  ABEND-4005-OPEN-ERROR                   VALUE +4005.     04480065
026700     88  ABEND-4006-CLOSE-ERROR                  VALUE +4006.     04490065
026800     88  ABEND-4007-SEQUENCE-ERROR               VALUE +4007.     04500065
026900     88  ABEND-4008-DATA-ERROR                   VALUE +4008.     04510065
027000     88  ABEND-4009-KEY-DATA-ERROR               VALUE +4009.     04520065
027300     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     04530065
027400     88  ABEND-4019-DATE-ROUTINE-ERROR           VALUE +4019.     04540065
027500     88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     04550065
027600                                                                  04560065
027700 01  END-OF-REPORT-LINE.                                          04570065
027800     05  FILLER                       PIC X(25)  VALUE            04580065
027900         ' ** END OF REPORT **     '.                             04590065
028000                                                                  04600065
028100*----------------------------------------------------------       04610065
028200* HD- HEADER INFO                                                 04620065
028300*----------------------------------------------------------       04630065
028400 01  HEADER-01.                                                   04640065
028500     05  FILLER                       PIC X(93) VALUE SPACES.     04650070
028600     05  FILLER                       PIC X(34)                   04660069
028700         VALUE 'PROMO ITEM SUMMARY - BY AD PAGE - '.              04670069
028800     05  HDR-01-TITLE                 PIC X(36)  VALUE SPACES.    04680069
028900     05  FILLER                       PIC X(87) VALUE SPACES.     04690070
029000                                                                  04700065
029100 01  HEADER-02.                                                   04710065
029200     05  FILLER                       PIC X(12)  VALUE            04720096
029300                                      ' AD EVENT : '.             04730096
029400     05  HDR-02-ADEVNT-STRING         PIC X(239) VALUE SPACES.    04740065
029500                                                                  04750065
029600 01  HEADER-03.                                                   04760065
029700     05  FILLER                       PIC X(12)  VALUE            04770065
029800                                      ' PROMOTION: '.             04780065
029900     05  HDR-03-PROMO-STRING          PIC X(238) VALUE SPACES.    04790065
030000                                                                  04800065
030100 01  HEADER-04.                                                   04810065
030200     05  FILLER                       PIC X(45)  VALUE            04820065
030300         '                                             '.         04830065
030400     05  FILLER                       PIC X(45)  VALUE            04840065
030500         '       AD            SALES VOLUME       VOL %'.         04850065
030600     05  FILLER                       PIC X(45)  VALUE            04860065
030700         '            MARKDOWN $              UNITS SOL'.         04870065
030800     05  FILLER                       PIC X(45)  VALUE            04880065
030900         'D              PREP UNITS       SELL         '.         04890096
031000     05  FILLER                       PIC X(45)  VALUE            04900065
031100         '   TOTAL COST         MARKUP %        RETAIL '.         04910065
031200     05  FILLER                       PIC X(25)  VALUE            04920065
031210         'PRICE       PROMO PRICE  '.                             04930065
031220                                                                  04940065
031230 01  HEADER-05.                                                   04950065
031240     05  FILLER                       PIC X(45)  VALUE            04960065
031250         ' PROMO ITEM DESCRIPTION                      '.         04970065
031260     05  FILLER                       PIC X(45)  VALUE            04980065
031270         '      SPACE         ACT        FCST      CHG '.         04990065
031280     05  FILLER                       PIC X(45)  VALUE            05000065
031290         '          ACT        FCST         ACT        '.         05010065
031300     05  FILLER                       PIC X(45)  VALUE            05020065
031400         'FCST         ACT        FCST   THRU %        '.         05030096
031500     05  FILLER                       PIC X(45)  VALUE            05040065
031600         ' ACT        FCST     ACT    FCST       MIN   '.         05050065
031700     05  FILLER                       PIC X(25)  VALUE            05060065
031800         '   MAX      MIN      MAX '.                             05070065
031900                                                                  05080065
032000                                                                  05090065
032100*----------------------------------------------------------       05100065
032200* DTL- DETAIL INFO                                                05110065
032300*----------------------------------------------------------       05120065
032400 01  DETAIL-HEADER-01.                                            05130065
032500     05  DTL-HDR-01-PAGE.                                         05140065
032600         10  DTL-HDR-01-PM-ITM-PAGE.                              05150065
032700             15  FILLER               PIC X(01).                  05160065
032800             15  DTL-HDR-01-PM-ITM-PAGE-TITLE                     05170065
032900                                      PIC X(21).                  05180065
033000             15  DTL-HDR-01-PM-ITM-PAGE-NBR                       05190065
033100                                      PIC ZZ9.                    05200065
033200             15  FILLER               PIC X(13).                  05210065
033300         10  DTL-HDR-01-NO-PAGE REDEFINES                         05220065
033400             DTL-HDR-01-PM-ITM-PAGE .                             05230065
033500             15  FILLER               PIC X(01).                  05240065
033600             15  DTL-HDR-01-HEADING-TITLE                         05250065
033700                                      PIC X(37).                  05260065
033800     05  FILLER                       PIC X(212) VALUE SPACES.    05270065
033900                                                                  05280065
034000 01  DETAIL-HEADER-02.                                            05290065
034100     05  DTL-HDR-02-ADMIN-TIER.                                   05300065
034200         10  FILLER                   PIC X(01)  VALUE SPACES.    05310065
034300         10  DTL-HDR-02-PM-ITM-DESC   PIC X(40)  VALUE SPACES.    05320065
034400     05  FILLER                       PIC X(209) VALUE SPACES.    05330065
034500                                                                  05340065
034600 01  DETAIL-VARIABLE.                                             05350065
034700     05  FILLER                       PIC X(01)  VALUE SPACES.    05360065
034800     05  DTL-VAR-VOL-PCT-CHG          PIC ZZZ9.9.                 05370096
034810     05  DTL-VAR-VOL-PCT-CHG1 REDEFINES                           05380096
034820         DTL-VAR-VOL-PCT-CHG          PIC ZZZZ.Z.                 05390096
034900     05  FILLER                       PIC X(01)  VALUE SPACES.    05400065
035000                                                                  05410065
035100 01  DETAIL-01.                                                   05420065
035200     05  FILLER                       PIC X(01)  VALUE SPACES.    05430065
035300     05  DTL-01-PMITEM-DESC           PIC X(50).                  05440065
035400     05  FILLER                       PIC X(01)  VALUE SPACES.    05450065
035500     05  DTL-01-AD-SPC-CDE            PIC X(04).                  05460065
035600     05  FILLER                       PIC X(02)  VALUE SPACES.    05470071
035700     05  DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZ9.99.             05480094
035710     05  DTL-01-ACTL-SLS-RTL-AMT1 REDEFINES                       05490096
035720         DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             05500096
035800     05  FILLER                       PIC X(02)  VALUE SPACES.    05510071
035900     05  DTL-01-FCST-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             05520071
036000     05  FILLER                       PIC X(02)  VALUE SPACES.    05530065
036100     05  DTL-01-VOL-PCT-CHG           PIC X(08)  VALUE SPACES.    05540065
036200     05  DTL-01-VOL-PCT-SIGN          PIC X(01)  VALUE SPACES.    05550065
036300     05  FILLER                       PIC X(02)  VALUE SPACES.    05560071
036400     05  DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZ9.99.             05570094
036410     05  DTL-01-ACTL-MD-AMT1 REDEFINES                            05580096
036420         DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZZ.ZZ.             05590096
036500     05  FILLER                       PIC X(02)  VALUE SPACES.    05600071
036600     05  DTL-01-FCST-MD-AMT           PIC ZZZ,ZZZ.ZZ.             05610071
036700     05  FILLER                       PIC X(02)  VALUE SPACES.    05620071
036800     05  DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZ9.99.             05630094
036801     05  DTL-01-ACTL-UNT-SLD-QTY1 REDEFINES                       05640096
036802         DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             05650096
036803     05  FILLER                       PIC X(02)  VALUE SPACES.    05660071
036804     05  DTL-01-FCST-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             05670071
036805     05  FILLER                       PIC X(02)  VALUE SPACES.    05680071
036806     05  DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZ9.99.             05690094
036807     05  DTL-01-ACTL-PREP-UNT-QTY1 REDEFINES                      05700096
036808         DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             05710096
036809     05  FILLER                       PIC X(02)  VALUE SPACES.    05720071
036810     05  DTL-01-FCST-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             05730071
036811     05  FILLER                       PIC X(03)  VALUE SPACES.    05740065
036812     05  DTL-01-SELL-THRU-PCT         PIC ZZ9.9.                  05750094
036813     05  DTL-01-SELL-THRU-PCT1 REDEFINES                          05760096
036814         DTL-01-SELL-THRU-PCT         PIC ZZZ.Z.                  05770096
036815     05  DTL-O1-SELL-PCT-SIGN         PIC X(01)  VALUE SPACES.    05780065
036816     05  FILLER                       PIC X(02)  VALUE SPACES.    05790071
036820     05  DTL-01-ACTL-COST-AMT         PIC ZZZ,ZZ9.99.             05800099
036821     05  DTL-01-ACTL-COST-AMT1 REDEFINES                          05810096
036822         DTL-01-ACTL-COST-AMT         PIC ZZZ,ZZZ.ZZ.             05820096
036830     05  FILLER                       PIC X(02)  VALUE SPACES.    05830071
036840     05  DTL-01-FCST-COST-AMT         PIC ZZZ,ZZZ.ZZ.             05840071
036850     05  FILLER                       PIC X(03)  VALUE SPACES.    05850065
036860     05  DTL-01-ACTL-MU-PCT           PIC ZZ9.9.                  05860094
036861     05  DTL-01-ACTL-MU-PCT1 REDEFINES                            05870096
036862         DTL-01-ACTL-MU-PCT           PIC ZZZ.Z.                  05880096
036870     05  DTL-01-ACTL-PCT-SIGN         PIC X(01)  VALUE SPACES.    05890065
PM3403*    05  FILLER                       PIC X(02)  VALUE SPACES.    05900099
PM3403     05  FILLER                       PIC X(01)  VALUE SPACES.    05910099
036890     05  DTL-01-FCST-MU-PCT           PIC ZZ9.9.                  05920099
036891     05  DTL-01-FCST-MU-PCT1 REDEFINES                            05930099
036892         DTL-01-FCST-MU-PCT           PIC ZZZ.Z.                  05940099
036900     05  DTL-01-FCST-PCT-SIGN         PIC X(01)  VALUE SPACES.    05950065
PM3403     05  FILLER                       PIC X(01)  VALUE SPACES.    05960099
PM3403     05  DTL-01-MIN-RTL-PRC           PIC ZZZZZ.ZZ.               05970099
037200     05  FILLER                       PIC X(01)  VALUE SPACES.    05980065
037300     05  DTL-01-RTL-DASH              PIC X(01)  VALUE SPACES.    05990065
PM3403*    05  DTL-01-MAX-RTL-PRC           PIC ZZZZ.ZZ.                06000099
PM3403*    05  FILLER                       PIC X(02)  VALUE SPACES.    06010099
PM3403     05  DTL-01-MAX-RTL-PRC           PIC ZZZZZ.ZZ.               06020099
PM3403     05  FILLER                       PIC X(01)  VALUE SPACES.    06030099
PM3403     05  DTL-01-MIN-PROMO-PRC         PIC ZZZZZ.ZZ.               06040099
037610     05  FILLER                       PIC X(01)  VALUE SPACES.    06050065
037620     05  DTL-01-PRM-DASH              PIC X(01)  VALUE SPACES.    06060065
PM3403*    05  DTL-01-MAX-PROMO-PRC         PIC ZZZZ.ZZ.                06070099
PM3403*    05  FILLER                       PIC X(01)  VALUE SPACES.    06080099
PM3403     05  DTL-01-MAX-PROMO-PRC         PIC ZZZZZ.ZZ.               06090099
037650                                                                  06100065
037660 01  DETAIL-02.                                                   06110065
037670     05  FILLER                       PIC X(01)  VALUE SPACES.    06120065
037680     05  DTL-02-DTES.                                             06130076
037681         10  DTL-02-EFF-DTES          PIC X(36)  VALUE SPACES.    06140076
037682         10  FILLER                   PIC X(26)  VALUE SPACES.    06150082
037683     05  DTL-02-VERSIONS                                          06160076
037684         REDEFINES DTL-02-DTES.                                   06170079
037685         10  FILLER                   PIC X(02).                  06180081
037686         10  DTL-01-VERSION-AD        PIC X(60).                  06190082
037690     05  FILLER                       PIC X(205) VALUE SPACES.    06200076
037700                                                                  06210065
037710 01  DETAIL-PMPG-TOTALS.                                          06220065
037720     05  DTL-PROMO-PAGE.                                          06230065
037730         10  DTL-PAGE-TITLE.                                      06240065
037740             15  FILLER               PIC X(01).                  06250065
037750             15  DTL-PG-PAGE-TITLE    PIC X(16).                  06260065
037760             15  DTL-PG-PAGE-NBR      PIC ZZ9.                    06270065
037770          10 DTL-PROMO-TITLE REDEFINES                            06280065
037780             DTL-PAGE-TITLE.                                      06290065
037790             15  FILLER               PIC X(01).                  06300065
037800             15  DTL-PM-PROMO-TITLE   PIC X(19).                  06310065
037801     05  FILLER                       PIC X(38)  VALUE SPACES.    06320071
037802     05  DTL-PMPG-ACTL-TOT-SLS-AMT    PIC ZZZ,ZZ9.99.             06330094
037803     05  DTL-PMPG-ACTL-TOT-SLS-AMT1 REDEFINES                     06340096
037804         DTL-PMPG-ACTL-TOT-SLS-AMT    PIC ZZZ,ZZZ.ZZ.             06350096
037805     05  FILLER                       PIC X(02)  VALUE SPACES.    06360071
037806     05  DTL-PMPG-FCST-TOT-SLS-AMT    PIC ZZZ,ZZZ.ZZ.             06370071
037807     05  FILLER                       PIC X(02)  VALUE SPACES.    06380065
037808     05  DTL-PMPG-TOT-VOL-PCT-CHG     PIC X(08)  VALUE SPACES.    06390065
037809     05  DTL-PMPG-VOL-PCT-SIGN        PIC X(01)  VALUE SPACES.    06400065
037810     05  FILLER                       PIC X(02)  VALUE SPACES.    06410071
037811     05  DTL-PMPG-TOT-ACTL-MD-AMT     PIC ZZZ,ZZ9.99.             06420094
037812     05  DTL-PMPG-TOT-ACTL-MD-AMT1 REDEFINES                      06430096
037813         DTL-PMPG-TOT-ACTL-MD-AMT     PIC ZZZ,ZZZ.ZZ.             06440096
037814     05  FILLER                       PIC X(02)  VALUE SPACES.    06450071
037815     05  DTL-PMPG-TOT-FCST-MD-AMT     PIC ZZZ,ZZZ.ZZ.             06460071
037816     05  FILLER                       PIC X(02)  VALUE SPACES.    06470071
037817     05  DTL-PMPG-TOT-ACTL-UNT-QTY    PIC ZZZ,ZZ9.99.             06480094
037818     05  DTL-PMPG-TOT-ACTL-UNT-QTY1 REDEFINES                     06490096
037819         DTL-PMPG-TOT-ACTL-UNT-QTY    PIC ZZZ,ZZZ.ZZ.             06500096
037820     05  FILLER                       PIC X(02)  VALUE SPACES.    06510071
037821     05  DTL-PMPG-TOT-FCST-UNT-QTY    PIC ZZZ,ZZZ.ZZ.             06520071
037822     05  FILLER                       PIC X(02)  VALUE SPACES.    06530071
037823     05  DTL-PMPG-TOT-ACTL-PREP-QTY   PIC ZZZ,ZZ9.99.             06540094
037824     05  DTL-PMPG-TOT-ACTL-PREP-QTY1 REDEFINES                    06550096
037825         DTL-PMPG-TOT-ACTL-PREP-QTY   PIC ZZZ,ZZZ.ZZ.             06560096
037826     05  FILLER                       PIC X(02)  VALUE SPACES.    06570071
037827     05  DTL-PMPG-TOT-FCST-PREP-QTY   PIC ZZZ,ZZZ.ZZ.             06580071
037828     05  FILLER                       PIC X(03)  VALUE SPACES.    06590065
037829     05  DTL-PMPG-TOT-SELL-THRU-PCT   PIC ZZ9.9.                  06600094
037830     05  DTL-PMPG-TOT-SELL-THRU-PCT1 REDEFINES                    06610096
037831         DTL-PMPG-TOT-SELL-THRU-PCT   PIC ZZZ.Z.                  06620096
037832     05  DTL-PMPG-SELL-PCT-SIGN       PIC X(01)  VALUE SPACES.    06630065
037833     05  FILLER                       PIC X(02)  VALUE SPACES.    06640071
037834     05  DTL-PMPG-TOT-ACTL-COST-AMT   PIC ZZZ,ZZ9.99.             06650094
037835     05  DTL-PMPG-TOT-ACTL-COST-AMT1 REDEFINES                    06660096
037836         DTL-PMPG-TOT-ACTL-COST-AMT   PIC ZZZ,ZZZ.ZZ.             06670096
037837     05  FILLER                       PIC X(02)  VALUE SPACES.    06680071
037838     05  DTL-PMPG-TOT-FCST-COST-AMT   PIC ZZZ,ZZZ.ZZ.             06690071
037839     05  FILLER                       PIC X(03)  VALUE SPACES.    06700065
037840     05  DTL-PMPG-TOT-ACTL-MU-PCT     PIC ZZ9.9.                  06710094
037841     05  DTL-PMPG-TOT-ACTL-MU-PCT1 REDEFINES                      06720096
037842         DTL-PMPG-TOT-ACTL-MU-PCT     PIC ZZZ.Z.                  06730096
037843     05  DTL-PMPG-ACTL-PCT-SIGN       PIC X(01)  VALUE SPACES.    06740065
037844     05  FILLER                       PIC X(02)  VALUE SPACES.    06750065
037845     05  DTL-PMPG-TOT-FCST-MU-PCT     PIC ZZ9.9.                  06760099
037846     05  DTL-PMPG-TOT-FCST-MU-PCT1 REDEFINES                      06770099
037847         DTL-PMPG-TOT-FCST-MU-PCT     PIC ZZZ.Z.                  06780099
037848     05  DTL-PMPG-FCST-PCT-SIGN       PIC X(01)  VALUE SPACES.    06790065
037849     05  FILLER                       PIC X(37)  VALUE SPACES.    06800065
037850                                                                  06810065
037851 01  DETAIL-ADV-TOTALS.                                           06820065
037852     05  DTL-ADV.                                                 06830065
037853         10  DTL-ADV-TITLE.                                       06840065
037854             15  FILLER               PIC X(01).                  06850065
037855             15  DTL-ADV-PM-TITLE     PIC X(18).                  06860065
037856     05  FILLER                       PIC X(39)  VALUE SPACES.    06870071
037857     05  DTL-ADV-TOT-ACTL-SLS-AMT     PIC ZZZ,ZZ9.99.             06880094
037858     05  DTL-ADV-TOT-ACTL-SLS-AMT1 REDEFINES                      06890096
037859         DTL-ADV-TOT-ACTL-SLS-AMT     PIC ZZZ,ZZZ.ZZ.             06900099
037860     05  FILLER                       PIC X(02)  VALUE SPACES.    06910071
037870     05  DTL-ADV-TOT-FCST-SLS-AMT     PIC ZZZ,ZZZ.ZZ.             06920071
037871     05  FILLER                       PIC X(02)  VALUE SPACES.    06930065
037872     05  DTL-ADV-TOT-VOL-PCT-CHG      PIC X(08)  VALUE SPACES.    06940065
037873     05  DTL-ADV-VOL-PCT-SIGN         PIC X(01)  VALUE SPACES.    06950065
037874     05  FILLER                       PIC X(02)  VALUE SPACES.    06960071
037875     05  DTL-ADV-TOT-ACTL-MD-AMT      PIC ZZZ,ZZ9.99.             06970094
037876     05  DTL-ADV-TOT-ACTL-MD-AMT1 REDEFINES                       06980096
037877         DTL-ADV-TOT-ACTL-MD-AMT      PIC ZZZ,ZZZ.ZZ.             06990096
037878     05  FILLER                       PIC X(02)  VALUE SPACES.    07000071
037879     05  DTL-ADV-TOT-FCST-MD-AMT      PIC ZZZ,ZZZ.ZZ.             07010071
037880     05  FILLER                       PIC X(02)  VALUE SPACES.    07020071
037881     05  DTL-ADV-TOT-ACTL-UNT-QTY     PIC ZZZ,ZZ9.99.             07030094
037882     05  DTL-ADV-TOT-ACTL-UNT-QTY1 REDEFINES                      07040096
037883         DTL-ADV-TOT-ACTL-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             07050096
037884     05  FILLER                       PIC X(02)  VALUE SPACES.    07060071
037885     05  DTL-ADV-TOT-FCST-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             07070071
037886     05  FILLER                       PIC X(02)  VALUE SPACES.    07080071
037887     05  DTL-ADV-TOT-ACTL-PREP-QTY    PIC ZZZ,ZZ9.99.             07090095
037888     05  DTL-ADV-TOT-ACTL-PREP-QTY1 REDEFINES                     07100096
037889         DTL-ADV-TOT-ACTL-PREP-QTY    PIC ZZZ,ZZZ.ZZ.             07110096
037890     05  FILLER                       PIC X(02)  VALUE SPACES.    07120071
037891     05  DTL-ADV-TOT-FCST-PREP-QTY    PIC ZZZ,ZZZ.ZZ.             07130071
037892     05  FILLER                       PIC X(03)  VALUE SPACES.    07140072
037893     05  DTL-ADV-TOT-SELL-THRU-PCT    PIC ZZ9.9.                  07150095
037894     05  DTL-ADV-TOT-SELL-THRU-PCT1 REDEFINES                     07160096
037895         DTL-ADV-TOT-SELL-THRU-PCT    PIC ZZZ.Z.                  07170096
037896     05  DTL-ADV-SELL-PCT-SIGN        PIC X(01)  VALUE SPACES.    07180065
037897     05  FILLER                       PIC X(02)  VALUE SPACES.    07190071
037898     05  DTL-ADV-TOT-ACTL-COST-AMT    PIC ZZZ,ZZ9.99.             07200095
037899     05  DTL-ADV-TOT-ACTL-COST-AMT1 REDEFINES                     07210096
037900         DTL-ADV-TOT-ACTL-COST-AMT    PIC ZZZ,ZZZ.ZZ.             07220096
037901     05  FILLER                       PIC X(02)  VALUE SPACES.    07230071
037902     05  DTL-ADV-TOT-FCST-COST-AMT    PIC ZZZ,ZZZ.ZZ.             07240071
037903     05  FILLER                       PIC X(03)  VALUE SPACES.    07250065
037904     05  DTL-ADV-TOT-ACTL-MU-PCT      PIC ZZ9.9.                  07260095
037905     05  DTL-ADV-TOT-ACTL-MU-PCT1 REDEFINES                       07270096
037906         DTL-ADV-TOT-ACTL-MU-PCT      PIC ZZZ.Z.                  07280096
037907     05  DTL-ADV-ACTL-PCT-SIGN        PIC X(01)  VALUE SPACES.    07290065
037908     05  FILLER                       PIC X(02)  VALUE SPACES.    07300065
037909     05  DTL-ADV-TOT-FCST-MU-PCT      PIC ZZ9.9.                  07310099
037910     05  DTL-ADV-TOT-FCST-MU-PCT1 REDEFINES                       07320099
037911         DTL-ADV-TOT-FCST-MU-PCT      PIC ZZZ.Z.                  07330099
037912     05  DTL-ADV-FCST-PCT-SIGN        PIC X(01)  VALUE SPACES.    07340065
037913     05  FILLER                       PIC X(37)  VALUE SPACES.    07350065
037914                                                                  07360065
PGNBR  01  DETAIL-ADVNO-TOTALS.                                         07361099
PGNBR      05  DTL-ADVNO.                                               07362099
PGNBR          10  DTL-ADVNO-TITLE.                                     07363099
PGNBR              15  FILLER               PIC X(01).                  07364099
PGNBR              15  DTL-ADVNO-PM-TITLE   PIC X(32).                  07365099
PGNBR      05  FILLER                       PIC X(25)  VALUE SPACES.    07366099
PGNBR      05  DTL-ADVNO-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZ9.99.             07367099
PGNBR      05  DTL-ADVNO-TOT-ACTL-SLS-AMT1  REDEFINES                   07368099
PGNBR          DTL-ADVNO-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             07369099
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07369199
PGNBR      05  DTL-ADVNO-TOT-FCST-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             07369299
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07369399
PGNBR      05  DTL-ADVNO-TOT-VOL-PCT-CHG    PIC X(08)  VALUE SPACES.    07369499
PGNBR      05  DTL-ADVNO-VOL-PCT-SIGN       PIC X(01)  VALUE SPACES.    07369599
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07369699
PGNBR      05  DTL-ADVNO-TOT-ACTL-MD-AMT    PIC ZZZ,ZZ9.99.             07369799
PGNBR      05  DTL-ADVNO-TOT-ACTL-MD-AMT1 REDEFINES                     07369899
PGNBR          DTL-ADVNO-TOT-ACTL-MD-AMT    PIC ZZZ,ZZZ.ZZ.             07369999
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07370099
PGNBR      05  DTL-ADVNO-TOT-FCST-MD-AMT    PIC ZZZ,ZZZ.ZZ.             07370199
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07370299
PGNBR      05  DTL-ADVNO-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZ9.99.             07370399
PGNBR      05  DTL-ADVNO-TOT-ACTL-UNT-QTY1 REDEFINES                    07370499
PGNBR          DTL-ADVNO-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             07370599
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07370699
PGNBR      05  DTL-ADVNO-TOT-FCST-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             07370799
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07370899
PGNBR      05  DTL-ADVNO-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZ9.99.             07370999
PGNBR      05  DTL-ADVNO-TOT-ACTL-PREP-QTY1 REDEFINES                   07371099
PGNBR          DTL-ADVNO-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             07371199
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07371299
PGNBR      05  DTL-ADVNO-TOT-FCST-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             07371399
PGNBR      05  FILLER                       PIC X(03)  VALUE SPACES.    07371499
PGNBR      05  DTL-ADVNO-TOT-SELL-THRU-PCT  PIC ZZ9.9.                  07371599
PGNBR      05  DTL-ADVNO-TOT-SELL-THRU-PCT1 REDEFINES                   07371699
PGNBR          DTL-ADVNO-TOT-SELL-THRU-PCT  PIC ZZZ.Z.                  07371799
PGNBR      05  DTL-ADVNO-SELL-PCT-SIGN      PIC X(01)  VALUE SPACES.    07371899
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07371999
PGNBR      05  DTL-ADVNO-TOT-ACTL-COST-AMT  PIC ZZZ,ZZ9.99.             07372099
PGNBR      05  DTL-ADVNO-TOT-ACTL-COST-AMT1 REDEFINES                   07372199
PGNBR          DTL-ADVNO-TOT-ACTL-COST-AMT  PIC ZZZ,ZZZ.ZZ.             07372299
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07372399
PGNBR      05  DTL-ADVNO-TOT-FCST-COST-AMT  PIC ZZZ,ZZZ.ZZ.             07372499
PGNBR      05  FILLER                       PIC X(03)  VALUE SPACES.    07372599
PGNBR      05  DTL-ADVNO-TOT-ACTL-MU-PCT    PIC ZZ9.9.                  07372699
PGNBR      05  DTL-ADVNO-TOT-ACTL-MU-PCT1 REDEFINES                     07372799
PGNBR          DTL-ADVNO-TOT-ACTL-MU-PCT    PIC ZZZ.Z.                  07372899
PGNBR      05  DTL-ADVNO-ACTL-PCT-SIGN      PIC X(01)  VALUE SPACES.    07372999
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07373099
PGNBR      05  DTL-ADVNO-TOT-FCST-MU-PCT    PIC ZZ9.9.                  07373199
PGNBR      05  DTL-ADVNO-TOT-FCST-MU-PCT1 REDEFINES                     07373299
PGNBR          DTL-ADVNO-TOT-FCST-MU-PCT    PIC ZZZ.Z.                  07373399
PGNBR      05  DTL-ADVNO-FCST-PCT-SIGN      PIC X(01)  VALUE SPACES.    07373499
PGNBR      05  FILLER                       PIC X(37)  VALUE SPACES.    07373599
PGNBR                                                                   07373699
037915 01  DETAIL-UNADV-TOTALS.                                         07374065
037920     05  DTL-UNADV.                                               07380065
037921         10  DTL-UNADV-TITLE.                                     07390065
037922             15  FILLER               PIC X(01).                  07400065
037923             15  DTL-UNADV-PM-TITLE   PIC X(20).                  07410065
037924     05  FILLER                       PIC X(37)  VALUE SPACES.    07420071
037925     05  DTL-UNADV-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZ9.99.             07430094
037926     05  DTL-UNADV-TOT-ACTL-SLS-AMT1 REDEFINES                    07440096
037927         DTL-UNADV-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             07450096
037928     05  FILLER                       PIC X(02)  VALUE SPACES.    07460071
037929     05  DTL-UNADV-TOT-FCST-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             07470071
037930     05  FILLER                       PIC X(02)  VALUE SPACES.    07480065
037931     05  DTL-UNADV-TOT-VOL-PCT-CHG    PIC X(08)  VALUE SPACES.    07490065
037932     05  DTL-UNADV-VOL-PCT-SIGN       PIC X(01)  VALUE SPACES.    07500065
037940     05  FILLER                       PIC X(02)  VALUE SPACES.    07510071
037941     05  DTL-UNADV-TOT-ACTL-MD-AMT    PIC ZZZ,ZZ9.99.             07520094
037942     05  DTL-UNADV-TOT-ACTL-MD-AMT1 REDEFINES                     07530096
037943         DTL-UNADV-TOT-ACTL-MD-AMT    PIC ZZZ,ZZZ.ZZ.             07540096
037944     05  FILLER                       PIC X(02)  VALUE SPACES.    07550071
037945     05  DTL-UNADV-TOT-FCST-MD-AMT    PIC ZZZ,ZZZ.ZZ.             07560071
037946     05  FILLER                       PIC X(02)  VALUE SPACES.    07570071
037947     05  DTL-UNADV-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZ9.99.             07580094
037948     05  DTL-UNADV-TOT-ACTL-UNT-QTY1 REDEFINES                    07590096
037949         DTL-UNADV-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             07600096
037950     05  FILLER                       PIC X(02)  VALUE SPACES.    07610071
037951     05  DTL-UNADV-TOT-FCST-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             07620071
037952     05  FILLER                       PIC X(02)  VALUE SPACES.    07630071
037953     05  DTL-UNADV-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZ9.99.             07640094
037954     05  DTL-UNADV-TOT-ACTL-PREP-QTY1 REDEFINES                   07650096
037955         DTL-UNADV-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             07660096
037956     05  FILLER                       PIC X(02)  VALUE SPACES.    07670071
037957     05  DTL-UNADV-TOT-FCST-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             07680071
037958     05  FILLER                       PIC X(03)  VALUE SPACES.    07690065
037959     05  DTL-UNADV-TOT-SELL-THRU-PCT  PIC ZZ9.9.                  07700094
037960     05  DTL-UNADV-TOT-SELL-THRU-PCT1 REDEFINES                   07710096
037961         DTL-UNADV-TOT-SELL-THRU-PCT  PIC ZZZ.Z.                  07720096
037962     05  DTL-UNADV-SELL-PCT-SIGN      PIC X(01)  VALUE SPACES.    07730065
037963     05  FILLER                       PIC X(02)  VALUE SPACES.    07740071
037964     05  DTL-UNADV-TOT-ACTL-COST-AMT  PIC ZZZ,ZZ9.99.             07750094
037965     05  DTL-UNADV-TOT-ACTL-COST-AMT1 REDEFINES                   07760096
037966         DTL-UNADV-TOT-ACTL-COST-AMT  PIC ZZZ,ZZZ.ZZ.             07770096
037967     05  FILLER                       PIC X(02)  VALUE SPACES.    07780071
037968     05  DTL-UNADV-TOT-FCST-COST-AMT  PIC ZZZ,ZZZ.ZZ.             07790071
037969     05  FILLER                       PIC X(03)  VALUE SPACES.    07800065
037970     05  DTL-UNADV-TOT-ACTL-MU-PCT    PIC ZZ9.9.                  07810094
037971     05  DTL-UNADV-TOT-ACTL-MU-PCT1 REDEFINES                     07820096
037972         DTL-UNADV-TOT-ACTL-MU-PCT    PIC ZZZ.Z.                  07830096
037973     05  DTL-UNADV-ACTL-PCT-SIGN      PIC X(01)  VALUE SPACES.    07840065
037974     05  FILLER                       PIC X(02)  VALUE SPACES.    07850065
037975     05  DTL-UNADV-TOT-FCST-MU-PCT    PIC ZZ9.9.                  07860099
037976     05  DTL-UNADV-TOT-FCST-MU-PCT1 REDEFINES                     07870099
037977         DTL-UNADV-TOT-FCST-MU-PCT    PIC ZZZ.Z.                  07880099
037978     05  DTL-UNADV-FCST-PCT-SIGN      PIC X(01)  VALUE SPACES.    07890065
037979     05  FILLER                       PIC X(37)  VALUE SPACES.    07900065
037980                                                                  07910065
037981 01  DETAIL-ATLVL-TOTALS.                                         07920065
037982     05  DTL-ATLVL.                                               07930065
037983         10  DTL-ATLVL-TITLE.                                     07940065
037984             15  FILLER               PIC X(01).                  07950065
037985             15  DTL-ATLVL-PM-TITLE   PIC X(20).                  07960065
037990     05  FILLER                       PIC X(37)  VALUE SPACES.    07970071
038000     05  DTL-ATLVL-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZ9.99.             07980094
038001     05  DTL-ATLVL-TOT-ACTL-SLS-AMT1 REDEFINES                    07990096
038002         DTL-ATLVL-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             08000096
038010     05  FILLER                       PIC X(25)  VALUE SPACES.    08010071
038020     05  DTL-ATLVL-TOT-ACTL-MD-AMT    PIC ZZZ,ZZ9.99.             08020094
038021     05  DTL-ATLVL-TOT-ACTL-MD-AMT1 REDEFINES                     08030096
038022         DTL-ATLVL-TOT-ACTL-MD-AMT    PIC ZZZ,ZZZ.ZZ.             08040096
038023     05  FILLER                       PIC X(14)  VALUE SPACES.    08050071
038024     05  DTL-ATLVL-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZ9.99.             08060094
038025     05  DTL-ATLVL-TOT-ACTL-UNT-QTY1 REDEFINES                    08070096
038026         DTL-ATLVL-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             08080096
038027     05  FILLER                       PIC X(14)  VALUE SPACES.    08090071
038028     05  DTL-ATLVL-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZ9.99.             08100094
038029     05  DTL-ATLVL-TOT-ACTL-PREP-QTY1 REDEFINES                   08110096
038030         DTL-ATLVL-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             08120096
038031     05  FILLER                       PIC X(23)  VALUE SPACES.    08130071
038032     05  DTL-ATLVL-TOT-ACTL-COST-AMT  PIC ZZZ,ZZ9.99.             08140094
038033     05  DTL-ATLVL-TOT-ACTL-COST-AMT1 REDEFINES                   08150096
038034         DTL-ATLVL-TOT-ACTL-COST-AMT  PIC ZZZ,ZZZ.ZZ.             08160096
038035     05  FILLER                       PIC X(15)  VALUE SPACES.    08170065
038036     05  DTL-ATLVL-TOT-ACTL-MU-PCT    PIC ZZ9.9.                  08180094
038037     05  DTL-ATLVL-TOT-ACTL-MU-PCT1 REDEFINES                     08190096
038038         DTL-ATLVL-TOT-ACTL-MU-PCT    PIC ZZZ.Z.                  08200096
038039     05  DTL-ATLVL-ACTL-PCT-SIGN      PIC X(01)  VALUE SPACES.    08210065
038040     05  FILLER                       PIC X(46)  VALUE SPACES.    08220065
038041                                                                  08230065
038042 01  DETAIL-ADMIN-TOTALS.                                         08240065
038043     05  DTL-ADMIN.                                               08250065
038044         10  DTL-ADMIN-TITLE.                                     08260065
038045             15  FILLER               PIC X(01).                  08270065
038046             15  DTL-ADMIN-PM-TITLE   PIC X(20).                  08280065
038047     05  FILLER                       PIC X(37)  VALUE SPACES.    08290071
038048     05  DTL-ADMIN-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZ9.99.             08300094
038049     05  DTL-ADMIN-TOT-ACTL-SLS-AMT1 REDEFINES                    08310096
038050         DTL-ADMIN-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             08320096
038051     05  FILLER                       PIC X(25)  VALUE SPACES.    08330071
038052     05  DTL-ADMIN-TOT-ACTL-MD-AMT    PIC ZZZ,ZZ9.99.             08340094
038053     05  DTL-ADMIN-TOT-ACTL-MD-AMT1 REDEFINES                     08350096
038054         DTL-ADMIN-TOT-ACTL-MD-AMT    PIC ZZZ,ZZZ.ZZ.             08360096
038055     05  FILLER                       PIC X(14)  VALUE SPACES.    08370071
038056     05  DTL-ADMIN-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZ9.99.             08380094
038057     05  DTL-ADMIN-TOT-ACTL-UNT-QTY1 REDEFINES                    08390096
038058         DTL-ADMIN-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             08400096
038059     05  FILLER                       PIC X(14)  VALUE SPACES.    08410071
038060     05  DTL-ADMIN-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZ9.99.             08420094
038061     05  DTL-ADMIN-TOT-ACTL-PREP-QTY1 REDEFINES                   08430096
038062         DTL-ADMIN-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             08440096
038063     05  FILLER                       PIC X(23)  VALUE SPACES.    08450071
038064     05  DTL-ADMIN-TOT-ACTL-COST-AMT  PIC ZZZ,ZZ9.99.             08460094
038065     05  DTL-ADMIN-TOT-ACTL-COST-AMT1 REDEFINES                   08470096
038066         DTL-ADMIN-TOT-ACTL-COST-AMT  PIC ZZZ,ZZZ.ZZ.             08480096
038067     05  FILLER                       PIC X(15)  VALUE SPACES.    08490065
038068     05  DTL-ADMIN-TOT-ACTL-MU-PCT    PIC ZZ9.9.                  08500094
038069     05  DTL-ADMIN-TOT-ACTL-MU-PCT1 REDEFINES                     08510096
038070         DTL-ADMIN-TOT-ACTL-MU-PCT    PIC ZZZ.Z.                  08520096
038071     05  DTL-ADMIN-ACTL-PCT-SIGN      PIC X(01)  VALUE SPACES.    08530065
038072     05  FILLER                       PIC X(46)  VALUE SPACES.    08540065
038073                                                                  08550065
038079*----------------------------------------------------------       08560065
038080* COPYBOOK FOR THE PROMO ITEM SUMMARY EXTRACT - INPUT             08570065
038081*----------------------------------------------------------       08580065
038082     COPY PMRD100.                                                08590065
038083                                                                  08600065
038084*----------------------------------------------------------       08610065
038085*  DATE VALIDATION CALLING PARAMETER LIST                         08620065
038086*----------------------------------------------------------       08630065
038087     COPY DPWS500.                                                08640065
038088                                                                  08650065
038089*----------------------------------------------------------       08660065
038090*  STANDARD HEADER LINE - KOHLS 250 COL                           08670065
038091*----------------------------------------------------------       08680065
038092     COPY DPWS250O.                                               08690065
038093     EJECT                                                        08700065
038094                                                                  08710065
038095*----------------------------------------------------------       08720065
038096 PROCEDURE DIVISION.                                              08730065
038097*----------------------------------------------------------       08740065
038098 0000-MAINLINE.                                                   08750065
038099                                                                  08760065
038100     PERFORM 1000-INITIALIZATION.                                 08770065
038200                                                                  08780065
038300     PERFORM 2000-PROCESS-SALES-RESULTS                           08790065
038400             UNTIL PS-EOF-SALES-RESULTS.                          08800065
038500                                                                  08810065
038600     PERFORM 3000-END-OF-JOB-ROUTINE.                             08820065
038700                                                                  08830065
038800     GOBACK.                                                      08840065
038900                                                                  08850065
039000*0000-EXIT.                                                       08860065
039100 EJECT.                                                           08870065
039200                                                                  08880065
039300*----------------------------------------------------------       08890065
039400* 1000-INITIALIZATION.                                            08900065
039500*     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      08910065
039600*     FILES, READS INPUT FILES, AND PROCESSES ANY INPUT FILE      08920065
039700*     PARAMETERS IT MAY NEED TO USE TO READ AND PROCESS           08930065
039800*     ANY OF THE RECORDS FROM THE INPUT FILE.                     08940065
039900*----------------------------------------------------------       08950065
040000 1000-INITIALIZATION.                                             08960065
040100                                                                  08970065
040200     INITIALIZE PM100-PROMO-ITM-SUMM                              08980065
040300                TBL-SECT-TOTAL-TABLE                              08990065
040400                TBL-PROMO-TOTAL-TABLE.                            09000065
040500                                                                  09010065
040600     SET PS-FIRST-TIME TO TRUE.                                   09020065
040700                                                                  09030065
040710     OPEN INPUT PROMO-ITM-SUMM-FILE                               09040065
040720         OUTPUT PROMO-ITM-SUMM-REPORT.                            09050065
040721                                                                  09060065
040722     ACCEPT CD-CPU-DATE FROM DATE.                                09070065
040723     MOVE CD-CPU-YR                  TO CD-CPU-YY.                09080065
040724     MOVE CD-CPU-MO                  TO CD-CPU-MM.                09090065
040725     MOVE CD-CPU-DY                  TO CD-CPU-DD.                09100065
040726                                                                  09110065
040727     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              09120065
040728     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     09130065
040729     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     09140065
040730     SET DPG52-LK-DTE-GREG           TO TRUE.                     09150065
040740     MOVE CD-CPU-DATE-GREG           TO DPG52-LK-DATE-INPUT.      09160065
040750     MOVE 'INVALID CONVERT OF CURRENT DATE FROM CPU'              09170065
040760                                     TO PV-OPERATION-MSG-1.       09180065
040770                                                                  09190065
040780     PERFORM 9100-CALENDAR-ROUTINE.                               09200065
040790                                                                  09210065
040800     MOVE DPG55-DB2-ISO-DATE-FMT     TO CD-CPU-DATE-ISO.          09220065
040900                                                                  09230065
041000     ACCEPT CT-CPU-TIME FROM TIME.                                09240065
041100     MOVE CT-CPU-HR                  TO DP250O-RUN-HOUR.          09250065
041200     MOVE CT-CPU-MIN                 TO DP250O-RUN-MINUTE.        09260065
041300     MOVE CD-CPU-MO                  TO DP250O-RUN-MONTH.         09270065
041400     MOVE CD-CPU-DY                  TO DP250O-RUN-DAY.           09280065
041500     MOVE CD-CPU-YR                  TO DP250O-RUN-YEAR.          09290065
041600     MOVE PC-CURRENT-PROGRAM-NAME    TO DP250O-PROGRAM-NAME.      09300065
041700                                                                  09310065
041800     PERFORM 8000-READ-SALES-RESULTS.                             09320065
041900                                                                  09330065
042000     IF PS-EOF-SALES-RESULTS                                      09340065
042100        DISPLAY 'NO PROMO ITEMS TO REPORT ON'                     09350065
042200     ELSE                                                         09360065
042300        SET PS-ADMIN-HEADER TO TRUE                               09370065
042400        EVALUATE TRUE                                             09380065
042500          WHEN PM100-ACTUAL                                       09390065
042600               MOVE PC-ACTUAL-RSLT   TO HDR-01-TITLE              09400065
042700          WHEN PM100-FORECAST                                     09410065
042800               MOVE PC-FORECAST-RSLT TO HDR-01-TITLE              09420065
042900          WHEN OTHER                                              09430065
043000               DISPLAY 'PM100-FCST-ACTUAL-IND: '                  09440065
043100                              PM100-FCST-ACTUAL-IND               09450065
043200               SET ABEND-4444-FORCED-ABEND TO TRUE                09460065
043300               MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME    09470065
043400               MOVE 'NOT A VALID FORECAST/ACTUAL IND'             09480065
043500                                       TO PV-OPERATION-MSG-1      09490065
043600               PERFORM 9800-ABEND                                 09500065
043700        END-EVALUATE                                              09510065
043800     END-IF.                                                      09520065
043900                                                                  09530065
044000*1000-EXIT.                                                       09540065
044100 EJECT.                                                           09550065
044200                                                                  09560065
044300*----------------------------------------------------------       09570065
044400* 2000-PROCESS-SALES-RESULTS.                                     09580065
044500*     PROCESSES THE SALES RESULTS FILE AND CREATES A              09590065
044600*     A REPORT. THIS REPORT BREAKS BY AD EVENT/PROMOTION.         09600065
044700*     WITHIN EACH PROMOTION THE REPORT MAY HAVE A                 09610065
044800*     ADVERTISED PROMOTION SECTION WHERE IT ALSO BREAKS           09620065
044900*     EACH AD PAGE NUMBER.  IT MAY HAVE AN UNADVERTISED           09630065
045000*     SECTION, AND IT MAY HAVE AN ADMIN TIERED PRICING            09640065
045100*     SECTION.                                                    09650065
045200*----------------------------------------------------------       09660065
045300 2000-PROCESS-SALES-RESULTS.                                      09670065
045400                                                                  09680065
045500     EVALUATE TRUE                                                09690065
045600       WHEN (PM100-AD-EVNT-ID IS NOT = PV-LAST-ADEVNT-ID)         09700065
045700         OR (PM100-PROMO-ID IS NOT = PV-LAST-PROMO-ID)            09710065
045800            IF PS-NOT-FIRST-TIME                                  09720065
045900               IF PS-ADMIN-TIER-TTL                               09730065
046000                  PERFORM 3140-PROCESS-ATIER-LVLS-TTL             09740065
046100                  PERFORM 3150-PROCESS-ADMIN-TIER-TTL             09750065
046200                  ADD 1             TO PA-CNT-ADMIN-TOT           09760065
046300               ELSE                                               09770065
046400                  IF PS-UNADV-PROMO-TTL                           09780065
046500                     PERFORM 3130-PROCESS-UNADV-PROMO-TTL         09790065
046600                     ADD 1          TO PA-CNT-UNADV-TOT           09800065
046700                  ELSE                                            09810065
046710                     IF PS-ADV-PROMO-TTL                          09820065
046720                        PERFORM 3110-PROCESS-PAGE-TTL             09830065
046730                        PERFORM 3120-PROCESS-ADV-PROMO-TTL        09840065
046740                        ADD 1       TO PA-CNT-ADV-TOT             09850065
PGNBR                      ELSE                                         09851099
PGNBR                         IF PS-ADV-NOPGE-TTL                       09852099
PGNBR                            PERFORM 3030-PROCESS-ADV-NOPGE-TTL     09853099
PGNBR                            ADD 1          TO PA-CNT-ADVNO-TOT     09854099
PGNBR                         END-IF                                    09855099
046750                     END-IF                                       09860065
046760                  END-IF                                          09870065
046770               END-IF                                             09880065
046780               SET PS-TOT-PROMO-TTL TO TRUE                       09890065
046790               PERFORM 3100-SELECT-TOTAL-LINES                    09900065
046791               PERFORM 2010-SET-TTL-PRINT-SW-OFF                  09910065
046792               INITIALIZE TBL-SECT-TOTAL-TABLE                    09920065
046793                          TBL-PROMO-TOTAL-TABLE                   09930065
046794               SET PS-ADMIN-HEADER TO TRUE                        09940065
046795            END-IF                                                09950065
046796            PERFORM 2300-FORMAT-HEADING-FIELDS                    09960065
046797            PERFORM 2100-ADEVNT-PROMO-HDR-BREAK                   09970065
046798            PERFORM 2400-CREATE-HEADING-FIELDS                    09980065
046799            PERFORM 3500-PROCESS-PAGE-HEADER                      09990065
046800            PERFORM 3400-PROCESS-DETAIL-HEADER                    10000065
046900            MOVE PM100-AD-EVNT-ID TO PV-LAST-ADEVNT-ID            10010065
047000            MOVE PM100-PROMO-ID   TO PV-LAST-PROMO-ID             10020065
047100            MOVE PM100-AD-PG-NBR  TO PV-AD-PG-NBR                 10030065
047200            SET PS-NOT-FIRST-TIME TO TRUE                         10040065
047300            INITIALIZE PV-SAVE-ADMIN-ID                           10050065
PGNBR        WHEN PS-EOF-REC-TYPE-FLAG = 2                              10071099
047600            PERFORM 3110-PROCESS-PAGE-TTL                         10080065
PGNBR             PERFORM 3120-PROCESS-ADV-PROMO-TTL                    10081099
PGNBR             ADD 1               TO PA-CNT-ADV-TOT                 10082099
047700            INITIALIZE TBL-SECT-TOTAL-TABLE                       10090065
047800            MOVE PM100-AD-PG-NBR TO PV-AD-PG-NBR                  10100065
047900            PERFORM 3400-PROCESS-DETAIL-HEADER                    10110065
PGNBR        WHEN PS-EOF-REC-TYPE-FLAG = 1                              10111099
PGNBR             PERFORM 3030-PROCESS-ADV-NOPGE-TTL                    10112099
PGNBR             ADD 1               TO PA-CNT-ADVNO-TOT               10113099
PGNBR             INITIALIZE TBL-SECT-TOTAL-TABLE                       10114099
PGNBR             MOVE PM100-AD-PG-NBR TO PV-AD-PG-NBR                  10116099
PGNBR             PERFORM 3400-PROCESS-DETAIL-HEADER                    10118099
048000       WHEN (PM100-AD-PG-NBR IS NOT = PV-AD-PG-NBR)               10120065
PGNBR         AND (PM100-PROMO-ITM-ADV-IND = 'Y')                       10130099
048200            PERFORM 3110-PROCESS-PAGE-TTL                         10140065
048320            INITIALIZE TBL-SECT-TOTAL-TABLE                       10170065
048330            MOVE PM100-AD-PG-NBR   TO PV-AD-PG-NBR                10180065
048340            PERFORM 3400-PROCESS-DETAIL-HEADER                    10190065
048350       WHEN (PM100-PROMO-ITM-ADV-IND = 'A')                       10200065
048360        AND (PS-ADMIN-HEADER)                                     10210065
048370            IF PS-UNADV-PROMO-TTL                                 10220065
048380               PERFORM 3130-PROCESS-UNADV-PROMO-TTL               10230065
048390               ADD 1              TO PA-CNT-UNADV-TOT             10240065
048400            ELSE                                                  10250065
PGNBR                IF PS-ADV-PROMO-TTL                                10251099
048500               PERFORM 3110-PROCESS-PAGE-TTL                      10260065
048600               PERFORM 3120-PROCESS-ADV-PROMO-TTL                 10270065
048700               ADD 1              TO PA-CNT-ADV-TOT               10280065
PGNBR                ELSE                                               10281099
PGNBR                   IF PS-ADV-NOPGE-TTL                             10282099
PGNBR                      PERFORM 3030-PROCESS-ADV-NOPGE-TTL           10283099
PGNBR                      ADD 1              TO PA-CNT-ADVNO-TOT       10284099
PGNBR                   END-IF                                          10285099
PGNBR                END-IF                                             10286099
048800            END-IF                                                10290065
048900            INITIALIZE TBL-SECT-TOTAL-TABLE                       10300065
049000            SET PS-NO-ADMIN-HEADER TO TRUE                        10310065
049100            PERFORM 3400-PROCESS-DETAIL-HEADER                    10320065
049200     END-EVALUATE.                                                10330065
PGNBR                                                                   10331099
PGNBR      SET PS-NO-EOF-REC-TYPE TO TRUE.                              10332099
PGNBR                                                                   10333099
049300     PERFORM 2200-PROCESS-DETAIL.                                 10340065
049400                                                                  10350065
049500     PERFORM 8000-READ-SALES-RESULTS.                             10360065
049600                                                                  10370065
049700*2000-EXIT.                                                       10380065
049800 EJECT.                                                           10390065
049900                                                                  10400065
050000*----------------------------------------------------------       10410065
050100* 2010-SET-TTL-PRINT-VARIABLES.                                   10420065
050200*     SET ALL THE PRINT SWITCHES TO OFF.                          10430065
050300*----------------------------------------------------------       10440065
050400 2010-SET-TTL-PRINT-SW-OFF.                                       10450065
050500                                                                  10460065
050600     SET PS-NO-PAGE-TTL         TO TRUE.                          10470065
050700     SET PS-NO-ADV-PROMO-TTL    TO TRUE.                          10480065
PGNBR      SET PS-NO-ADV-NOPGE-TTL    TO TRUE.                          10481099
050800     SET PS-NO-UNADV-PROMO-TTL  TO TRUE.                          10490065
050900     SET PS-NO-ADMIN-TIER-TTL   TO TRUE.                          10500065
051000     SET PS-NO-TOT-PROMO-TTL    TO TRUE.                          10510065
051100                                                                  10520065
051200     MOVE ZEROES                TO PA-CNT-ADV-TOT                 10530065
PGNBR                                    PA-CNT-ADVNO-TOT               10531099
051300                                   PA-CNT-UNADV-TOT               10540065
051400                                   PA-CNT-ADMIN-TOT.              10550065
051500                                                                  10560065
051600*2010-EXIT.                                                       10570065
051700 EJECT.                                                           10580065
051800                                                                  10590065
051900*----------------------------------------------------------       10600065
052000* 2100-ADEVNT-PROMO-HDR-BREAK.                                    10610065
052100*     WHEN AN ADEVENT ID/PROMO ID CHANGE, GIVE THE NEW            10620065
052200*     START/END DATES.                                            10630065
052300*----------------------------------------------------------       10640065
052400 2100-ADEVNT-PROMO-HDR-BREAK.                                     10650065
052500                                                                  10660065
052600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              10670065
052700     SET DPG51-ACTUAL-CALENDAR-ONLY      TO TRUE.                 10680065
052800     SET DPG51-DO-NOT-INCR-DECR-DATE     TO TRUE.                 10690065
052900     SET DPG52-LK-DTE-ISO-FMT            TO TRUE.                 10700065
053000     MOVE PM100-PROMO-STRT-TMST          TO PV-PROMO-STRT-TMST.   10710065
053100     MOVE PM100-PROMO-END-TMST           TO PV-PROMO-END-TMST.    10720065
053110     MOVE PV-PROMO-STRT-DTE              TO DPG52-LK-DATE-INPUT.  10730065
053111     MOVE 'INVALID PROMO BEGINNING DATE' TO PV-OPERATION-MSG-1.   10740065
053112                                                                  10750065
053113     PERFORM 9100-CALENDAR-ROUTINE.                               10760065
053114                                                                  10770065
053115     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-BEG-DAY-ALPHA.              10780065
053116     MOVE DPG55-GREG-DATE-FMT   TO PV-BEG-DATE.                   10790065
053117                                                                  10800065
053118     IF (PV-PM-STRT-TM-HH =                                       10810065
053119         PC-DEFAULT-BEG-HR AND                                    10820065
053120         PV-PM-STRT-TM-MM =                                       10830065
053130         PC-DEFAULT-BEG-MIN)                                      10840065
053140         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  10850065
053150* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 10860065
053160            MOVE SPACES         TO PV-BEG-TIME                    10870065
053170            MOVE PV-PM-STRT-TM-HH                                 10880065
053180                                TO PV-BEG-HR-TIME                 10890065
053190            MOVE PC-COLON       TO PV-BEG-TIME-COLON              10900065
053200            MOVE PV-PM-STRT-TM-MM                                 10910065
053300                                TO PV-BEG-MIN-TIME                10920065
053400         ELSE                                                     10930065
053500            MOVE PC-ALL-DAY     TO PV-BEG-TIME                    10940065
053600         END-IF                                                   10950065
053700     ELSE                                                         10960065
053800* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 10970065
053900        MOVE SPACES             TO PV-BEG-TIME                    10980065
054000        MOVE PV-PM-STRT-TM-HH                                     10990065
054100                                TO PV-BEG-HR-TIME                 11000065
054200        MOVE PC-COLON           TO PV-BEG-TIME-COLON              11010065
054300        MOVE PV-PM-STRT-TM-MM                                     11020065
054400                                TO PV-BEG-MIN-TIME                11030065
054500     END-IF.                                                      11040065
054600                                                                  11050065
054700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11060065
054800     SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                    11070065
054900     SET DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                    11080065
055000     SET DPG52-LK-DTE-ISO-FMT         TO TRUE.                    11090065
055100     MOVE PV-PROMO-END-DTE            TO DPG52-LK-DATE-INPUT.     11100065
055200     MOVE 'INVALID PROMO ENDING DATE' TO PV-OPERATION-MSG-1.      11110065
055300                                                                  11120065
055400     PERFORM 9100-CALENDAR-ROUTINE.                               11130065
055500                                                                  11140065
055600     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-END-DAY-ALPHA.              11150065
055700     MOVE DPG55-GREG-DATE-FMT   TO PV-END-DATE.                   11160065
055800                                                                  11170065
055900     IF (PV-PM-END-TM-HH =                                        11180065
056000         PC-DEFAULT-END-HR AND                                    11190065
056100         PV-PM-END-TM-MM =                                        11200065
056200         PC-DEFAULT-END-MIN)                                      11210065
056300         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  11220065
056400* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 11230065
056500            MOVE SPACES         TO PV-END-TIME                    11240065
056600            MOVE PV-PM-END-TM-HH                                  11250065
056700                                TO PV-END-HR-TIME                 11260065
056800            MOVE PC-COLON       TO PV-END-TIME-COLON              11270065
056900            MOVE PV-PM-END-TM-MM                                  11280065
057000                                TO PV-END-MIN-TIME                11290065
057100         ELSE                                                     11300065
057200            MOVE PC-ALL-DAY     TO PV-END-TIME                    11310065
057300         END-IF                                                   11320065
057400      ELSE                                                        11330065
057500* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 11340065
057600         MOVE SPACES            TO PV-END-TIME                    11350065
057700         MOVE PV-PM-END-TM-HH                                     11360065
057800                                TO PV-END-HR-TIME                 11370065
057900         MOVE PC-COLON          TO PV-END-TIME-COLON              11380065
058000         MOVE PV-PM-END-TM-MM                                     11390065
058100                                TO PV-END-MIN-TIME                11400065
058200     END-IF.                                                      11410065
058300                                                                  11420065
058400*2100-EXIT.                                                       11430065
058500 EJECT.                                                           11440065
058600                                                                  11450065
058700*----------------------------------------------------------       11460065
058800* 2200-PROCESS-DETAIL.                                            11470065
058900*     PROCESS REPORT DETAIL LINES.                                11480065
059000*----------------------------------------------------------       11490065
059100 2200-PROCESS-DETAIL.                                             11500065
059200                                                                  11510065
059300     MOVE SPACES                TO DETAIL-01                      11520065
059400                                   DETAIL-02                      11530065
059500                                   DETAIL-VARIABLE.               11540065
059600                                                                  11550065
059700*** WHEN THE RECORD IS ADMIN TIERED OR TIERED PRICING             11560065
059800*** SET UP THE DETAIL LINES DIFFERENTLY.                          11570065
059900     IF PM100-ADMN-TIER-PRICG OR PM100-TIER-PRICG                 11580065
060000        PERFORM 2210-CREATE-TIER-DESC                             11590065
060100        MOVE PV-TIER-ITM-DESC   TO DTL-01-PMITEM-DESC             11600065
060200        IF PM100-TIER-PRICG-ID NOT = PV-TIER-PRICG-ID             11610065
060210           AND PM100-ADMN-TIER-PRICG                              11620065
060220           MOVE SPACES                  TO DETAIL-HEADER-02       11630065
060230           IF PV-SAVE-ADMIN-ID NOT = 0                            11640065
060240              PERFORM 3140-PROCESS-ATIER-LVLS-TTL                 11650065
060250           END-IF                                                 11660065
060260           INITIALIZE PV-ADMIN-TIER-TOTALS                        11670065
060270           MOVE PM100-TIER-PRICG-ID  TO PV-SAVE-ADMIN-ID          11680065
060280           MOVE PM100-PROMO-ITM-DESC TO DTL-HDR-02-PM-ITM-DESC    11690065
060290           MOVE 2                    TO PV-ADVANCE-LINES          11700065
060300                                        PV-SAVE-LINE-AMT          11710065
060400           ADD PV-ADVANCE-LINES      TO PV-LINE-CNT               11720065
060500           PERFORM 3200-CHECK-MAX-LINE-CNT                        11730065
060600           MOVE DETAIL-HEADER-02     TO PV-RPT-LINE               11740065
060700           PERFORM 8200-WRITE-RPT-LINE                            11750065
060800           MOVE PM100-TIER-PRICG-ID  TO PV-TIER-PRICG-ID          11760065
060900        END-IF                                                    11770065
060910*** KEEP A RUNNING TOTAL OF ALL LEVELS OF ONE ADMIN               11780065
060920*** TIERED GROUP.                                                 11790065
060930        IF PM100-ADMN-TIER-PRICG                                  11800065
060940           ADD PM100-ACTL-SLS-RTL-AMT  TO PV-TTL-SLS-RTL-AMT      11810065
060950           ADD PM100-ACTL-MKDN-RTL-AMT TO PV-TTL-MKDN-RTL-AMT     11820065
060960           ADD PM100-ACTL-SLS-UNT-QTY  TO PV-TTL-SLS-UNT-QTY      11830065
060970           ADD PM100-ACTL-SLS-COST-AMT TO PV-TTL-SLS-COST-AMT     11840065
060980        END-IF                                                    11850065
060990     ELSE                                                         11860065
061000        MOVE PM100-PROMO-ITM-DESC   TO DTL-01-PMITEM-DESC         11870065
061100        MOVE PM100-AD-SP-CDE        TO DTL-01-AD-SPC-CDE          11880065
061110     END-IF.                                                      11890065
061120                                                                  11900065
061130*** THIS IS PROCESSED FOR ACTUAL REPORTS ONLY.                    11910065
061140     IF PM100-ACTUAL                                              11920065
061160        MOVE PM100-ACTL-SLS-RTL-AMT  TO DTL-01-ACTL-SLS-RTL-AMT   11930096
061177        MOVE PM100-ACTL-MKDN-RTL-AMT TO DTL-01-ACTL-MD-AMT        11940096
061300        MOVE PM100-ACTL-SLS-UNT-QTY  TO DTL-01-ACTL-UNT-SLD-QTY   11950096
061900        MOVE PM100-ACTL-SLS-COST-AMT TO DTL-01-ACTL-COST-AMT      11960096
062010                                                                  11970075
062100        IF PM100-SMPL-PRICG OR PM100-ADMN-TIER-PRICG              11980073
062320           ADD PM100-ACTL-SLS-RTL-AMT  TO                         11990073
062330                              TBL-STOT-TOT-SALE-AMT(PC-SUB-1)     12000073
062340                              TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)    12010073
062350           ADD PM100-ACTL-MKDN-RTL-AMT TO                         12020073
062360                              TBL-STOT-TOT-MD-AMT(PC-SUB-1)       12030074
062370                              TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)      12040074
062380           ADD PM100-ACTL-SLS-UNT-QTY  TO                         12050073
062390                              TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)  12060074
062391                              TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1) 12070074
062392           ADD PM100-ACTL-SLS-COST-AMT TO                         12080073
062393                              TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1) 12090073
062394                              TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1)12100073
062395        END-IF                                                    12110073
062400*** THIS IS PROCESSED FOR ACTUAL SIMPLE PRICING RECORDS           12120065
062500*** ONLY.                                                         12130065
062600        IF PM100-SMPL-PRICG                                       12140065
062700           IF PM100-PROMO-REG-TYP-CDE = 'U '                      12150065
062800              PERFORM 2220-FORMAT-PROMO-ITM-DTES                  12160065
062900              MOVE PV-PM-ITM-EFF-STRT-DTE TO PV-EFF-STRT-DTE      12170065
063000              MOVE PV-PM-ITM-EFF-END-DTE  TO PV-EFF-END-DTE       12180065
063100              MOVE PC-DASH                TO PV-DTE-DASH          12190065
063200              MOVE PC-FRONT-PAR           TO PV-OPEN-PARENTH      12200065
063300              MOVE PC-BACK-PAR            TO PV-CLOSE-PARENTH     12210065
063400              MOVE PV-EFF-DTE-LAYOUT      TO DTL-02-EFF-DTES      12220065
063500           END-IF                                                 12230065
063600           ADD PM100-ACTL-EOH-INV-QTY TO                          12240065
063700                              TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1)  12250065
063800                              TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) 12260065
063810                                                                  12270075
064000           MOVE PM100-ACTL-PREP-UNT-QTY                           12280096
064100                                    TO DTL-01-ACTL-PREP-UNT-QTY   12290096
064300           ADD PM100-ACTL-PREP-UNT-QTY TO                         12300065
064400                                TBL-STOT-PREP-UNT-QTY(PC-SUB-1)   12310065
064500                                TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)  12320065
064510                                                                  12330075
064600           MOVE ZEROES              TO PV-ROUND-TO-TENTHS         12340065
064700           ADD PM100-ACTL-TOT-MKUP-PCT                            12350065
064800                                    TO PV-ROUND-TO-TENTHS ROUNDED 12360065
064900           MOVE PV-ROUND-TO-TENTHS  TO DTL-01-ACTL-MU-PCT         12370065
064910           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       12380097
065000                                                                  12390065
065600           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          12400065
065700           ADD PM100-SELL-THRU-PCT TO PV-ROUND-TO-TENTHS ROUNDED  12410065
065800           MOVE PV-ROUND-TO-TENTHS TO DTL-01-SELL-THRU-PCT        12420065
065810           MOVE PC-PERCENT-SIGN    TO DTL-O1-SELL-PCT-SIGN        12430097
066400                                                                  12440065
066410           IF PM100-FCST-SLS-RTL-AMT = ZEROES                     12450097
066420              MOVE SPACES          TO DETAIL-VARIABLE             12460097
066430              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          12470097
066440              MOVE SPACES           TO DTL-01-VOL-PCT-SIGN        12480097
066450           ELSE                                                   12490097
066500              MOVE ZEROES           TO PV-ROUND-TO-TENTHS         12500097
066600              ADD PM100-VOL-PCT-CHG TO PV-ROUND-TO-TENTHS ROUNDED 12510097
066700              IF PM100-VOL-PCT-CHG < 0                            12520097
066800                 PERFORM 9000-ADD-PARENTH-TO-NEG-PCT              12530097
066900                 MOVE PV-FINAL-VOL-PCT    TO DTL-01-VOL-PCT-CHG   12540097
067000              ELSE                                                12550097
067100                 MOVE PV-ROUND-TO-TENTHS  TO DTL-VAR-VOL-PCT-CHG  12560097
067110                 MOVE DETAIL-VARIABLE     TO DTL-01-VOL-PCT-CHG   12570097
067120              END-IF                                              12580097
067121              MOVE PC-PERCENT-SIGN        TO DTL-01-VOL-PCT-SIGN  12590097
067143           END-IF                                                 12600065
067144        END-IF                                                    12610065
067145     END-IF.                                                      12620065
067146                                                                  12630065
067147*** THIS IS PROCESSED FOR ALL SIMPLE PRICING RECORD IN            12640065
067148*** ACTUAL AND FORECAST REPORTS.                                  12650065
067149     IF PM100-SMPL-PRICG                                          12660065
067150        MOVE PM100-MIN-UNT-REG-RTL-AMT TO DTL-01-MIN-RTL-PRC      12670065
067160        MOVE PM100-MAX-UNT-REG-RTL-AMT TO DTL-01-MAX-RTL-PRC      12680065
067170        MOVE PM100-MIN-UNT-PRM-RTL-AMT TO DTL-01-MIN-PROMO-PRC    12690065
067180        MOVE PM100-MAX-UNT-PRM-RTL-AMT TO DTL-01-MAX-PROMO-PRC    12700065
067190        IF PM100-MIN-UNT-REG-RTL-AMT NOT = 0 AND                  12710065
067200           PM100-MAX-UNT-REG-RTL-AMT NOT = 0                      12720065
067210           MOVE PC-DASH                TO DTL-01-RTL-DASH         12730065
067220        END-IF                                                    12740065
067230        IF PM100-MIN-UNT-PRM-RTL-AMT NOT = 0 AND                  12750065
067240           PM100-MAX-UNT-PRM-RTL-AMT NOT = 0                      12760065
067250           MOVE PC-DASH                TO DTL-01-PRM-DASH         12770065
067260        END-IF                                                    12780065
067261                                                                  12790075
067280        MOVE PM100-FCST-SLS-RTL-AMT  TO DTL-01-FCST-SLS-RTL-AMT   12800096
067300        ADD PM100-FCST-SLS-RTL-AMT   TO                           12810096
067400                               TBL-STOT-TOT-SALE-AMT(PC-SUB-2)    12820065
067500                               TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)   12830065
067510                                                                  12840075
067700        MOVE PM100-FCST-MKDN-RTL-AMT TO DTL-01-FCST-MD-AMT        12850096
067900        ADD PM100-FCST-MKDN-RTL-AMT  TO                           12860096
068000                                   TBL-STOT-TOT-MD-AMT(PC-SUB-2)  12870065
068100                                   TBL-PMTOT-TOT-MD-AMT(PC-SUB-2) 12880065
068110                                                                  12890075
068300        MOVE PM100-FCST-SLS-UNT-QTY  TO DTL-01-FCST-UNT-SLD-QTY   12900096
068500        ADD PM100-FCST-SLS-UNT-QTY   TO                           12910096
068600                            TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)    12920065
068700                            TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2)   12930065
068710                                                                  12940075
068900        MOVE PM100-FCST-PROJD-UNT-QTY                             12950096
069000                                     TO DTL-01-FCST-PREP-UNT-QTY  12960096
069200        ADD PM100-FCST-PROJD-UNT-QTY TO                           12970065
069300                                  TBL-STOT-PREP-UNT-QTY(PC-SUB-2) 12980065
069400                                  TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)12990065
069410                                                                  13000075
069600        MOVE PM100-FCST-SLS-COST-AMT TO DTL-01-FCST-COST-AMT      13010096
069800        ADD PM100-FCST-SLS-COST-AMT  TO                           13020096
069900                              TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2) 13030065
070000                              TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2)13040065
070100                                                                  13050065
070110        IF PM100-FCST-SLS-RTL-AMT = ZEROES                        13060097
070120           CONTINUE                                               13070097
070130        ELSE                                                      13080097
070200           MOVE ZEROES                 TO PV-ROUND-TO-TENTHS      13090097
070300           ADD PM100-FCST-TOT-MKUP-PCT TO                         13100097
070310                                 PV-ROUND-TO-TENTHS ROUNDED       13110097
070400           MOVE PV-ROUND-TO-TENTHS     TO DTL-01-FCST-MU-PCT      13120097
070900           MOVE PC-PERCENT-SIGN        TO DTL-01-FCST-PCT-SIGN    13130097
071000        END-IF                                                    13140065
071100     END-IF.                                                      13150065
071200                                                                  13160065
071300     MOVE 1                     TO PV-ADVANCE-LINES               13170065
071400                                   PV-SAVE-LINE-AMT.              13180065
071500     ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   13190065
071600     PERFORM 3200-CHECK-MAX-LINE-CNT.                             13200065
071700     MOVE DETAIL-01             TO PV-RPT-LINE.                   13210065
071710     PERFORM 8200-WRITE-RPT-LINE.                                 13220065
071720                                                                  13230065
071730     IF PM100-PROMO-REG-TYP-CDE = 'U '                            13240065
071740        MOVE 1                     TO PV-ADVANCE-LINES            13250065
071750        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 13260065
071760        MOVE DETAIL-02             TO PV-RPT-LINE                 13270065
071770        PERFORM 8200-WRITE-RPT-LINE                               13280065
071780     END-IF.                                                      13290065
071781                                                                  13300077
071782     IF PM100-AD-VERSION(PC-SUB-1) NOT = SPACES                   13310077
071783        MOVE SPACES TO PV-VERSION-AD                              13320090
071790        PERFORM 2230-CREATE-VERSION-DATA                          13330077
071791        MOVE 1                     TO PV-ADVANCE-LINES            13340077
071792        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 13350077
071793        MOVE DETAIL-02             TO PV-RPT-LINE                 13360077
071794        PERFORM 8200-WRITE-RPT-LINE                               13370077
071795     END-IF.                                                      13380077
071796                                                                  13390077
071800*2200-EXIT.                                                       13400065
071900 EJECT.                                                           13410065
072000                                                                  13420065
072100*----------------------------------------------------------       13430065
072200* 2210-CREATE-TIER-DESC.                                          13440065
072300*     CREATE THE PROMO ITEM DESCRIPTION FIELD FOR TIERED          13450065
072400*     AND ADMIN TIERED RECORDS.                                   13460065
072500*----------------------------------------------------------       13470065
072600 2210-CREATE-TIER-DESC.                                           13480065
072700                                                                  13490065
072800     INITIALIZE PA-CNT-POS-1                                      13500065
072900                PA-CNT-POS-2                                      13510065
073000                PA-CNT-SPACES-1                                   13520065
073100                PA-CNT-SPACES-2                                   13530065
073200                PV-TIER-ITM-DESC.                                 13540065
073300                                                                  13550065
073400     EVALUATE TRUE                                                13560065
073500         WHEN PM100-TIER-PRICG-TYP-CDE = 'TAP'                    13570065
073600              MOVE PM100-TIER-THRS-AMT TO PV-THRS-AMT-NUM         13580065
073700              MOVE PV-THRS-AMT-NUM-X   TO PV-SAVE-THRS-AMT        13590065
073800              MOVE PV-SAVE-THRS-AMT-1  TO PV-THRS-AMT-CHAR        13600065
073900              INSPECT PV-THRS-AMT-CHAR REPLACING                  13610065
074000                      LEADING ZERO BY " "                         13620065
074100              INSPECT PV-THRS-AMT-CHAR                            13630065
074200                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         13640065
074300              COMPUTE PA-CNT-POS-1 = 8 - PA-CNT-SPACES-1          13650065
074400              ADD +1 TO PA-CNT-SPACES-1                           13660065
074500              MOVE PM100-TIER-DISC-PCT TO PV-DISC-PCT-NUM         13670065
074600              MOVE PV-DISC-PCT-NUM-X   TO PV-SAVE-DISC-PCT        13680065
074700              MOVE PV-SAVE-DISC-PCT-1  TO PV-DISC-PCT-CHAR        13690065
074800              INSPECT PV-DISC-PCT-CHAR REPLACING                  13700065
074900                      LEADING ZERO BY " "                         13710065
075000              INSPECT PV-DISC-PCT-CHAR                            13720065
075100                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         13730065
075200              COMPUTE PA-CNT-POS-2 = 3 - PA-CNT-SPACES-2          13740065
075300              ADD +1 TO PA-CNT-SPACES-2                           13750065
075400              MOVE +1 TO PV-POINTER-FIELD                         13760065
075500              STRING PC-CHAR-BUY DELIMITED BY " "                 13770065
075600                     " " DELIMITED BY SIZE                        13780065
075700                     PC-DOLLAR-SIGN DELIMITED BY " "              13790065
075800                     PV-THRS-AMT-CHAR                             13800065
075900                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           13810065
076000                     "," DELIMITED BY SIZE                        13820065
076100                     " " DELIMITED BY SIZE                        13830065
076200                     PC-CHAR-GET DELIMITED BY " "                 13840065
076300                     " " DELIMITED BY SIZE                        13850065
076400                     PV-DISC-PCT-CHAR                             13860065
076500                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           13870065
076600                     PC-PERCENT-SIGN DELIMITED BY " "             13880065
076700                     " " DELIMITED BY SIZE                        13890065
076800                     PC-CHAR-OFF DELIMITED BY " "                 13900065
076900              INTO PV-TIER-ITM-DESC-1                             13910065
077000              WITH POINTER PV-POINTER-FIELD                       13920065
077100         WHEN PM100-TIER-PRICG-TYP-CDE = 'TQP'                    13930065
077200              MOVE PM100-TIER-THRS-QTY TO PV-THRS-QTY-CHAR        13940065
077300              INSPECT PV-THRS-QTY-CHAR REPLACING                  13950065
077400                      LEADING ZERO BY " "                         13960065
077500              INSPECT PV-THRS-QTY-CHAR                            13970065
077600                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         13980065
077700              COMPUTE PA-CNT-POS-1 = 5 - PA-CNT-SPACES-1          13990065
077800              ADD +1 TO PA-CNT-SPACES-1                           14000065
077900              MOVE PM100-TIER-DISC-PCT TO PV-DISC-PCT-NUM         14010065
078000              MOVE PV-DISC-PCT-NUM-X   TO PV-SAVE-DISC-PCT        14020065
078100              MOVE PV-SAVE-DISC-PCT-1  TO PV-DISC-PCT-CHAR        14030065
078200              INSPECT PV-DISC-PCT-CHAR REPLACING                  14040065
078300                      LEADING ZERO BY " "                         14050065
078400              INSPECT PV-DISC-PCT-CHAR                            14060065
078500                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         14070065
078600              COMPUTE PA-CNT-POS-2 = 3 - PA-CNT-SPACES-2          14080065
078700              ADD +1 TO PA-CNT-SPACES-2                           14090065
078800              MOVE +1 TO PV-POINTER-FIELD                         14100065
078900              STRING PC-CHAR-BUY DELIMITED BY " "                 14110065
079000                     " " DELIMITED BY SIZE                        14120065
079100                     PV-THRS-QTY-CHAR                             14130065
079200                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           14140065
079300                     "," DELIMITED BY SIZE                        14150065
079400                     " " DELIMITED BY SIZE                        14160065
079500                     PC-CHAR-GET DELIMITED BY " "                 14170065
079600                     " " DELIMITED BY SIZE                        14180065
079700                     PV-DISC-PCT-CHAR                             14190065
079800                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           14200065
079900                     PC-PERCENT-SIGN DELIMITED BY " "             14210065
079910                     " " DELIMITED BY SIZE                        14220065
079920                     PC-CHAR-OFF DELIMITED BY " "                 14230065
079930              INTO PV-TIER-ITM-DESC-1                             14240065
079940              WITH POINTER PV-POINTER-FIELD                       14250065
079950         WHEN PM100-TIER-PRICG-TYP-CDE = 'TQA'                    14260065
079960              MOVE PM100-TIER-THRS-QTY TO PV-THRS-QTY-CHAR        14270065
079970              INSPECT PV-THRS-QTY-CHAR REPLACING                  14280065
079980                      LEADING ZERO BY " "                         14290065
079981              INSPECT PV-THRS-QTY-CHAR                            14300065
079982                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         14310065
079983              COMPUTE PA-CNT-POS-1 = 5 - PA-CNT-SPACES-1          14320065
079984              ADD +1 TO PA-CNT-SPACES-1                           14330065
079985              MOVE PM100-TIER-DISC-AMT TO PV-DISC-AMT-NUM         14340065
079986              MOVE PV-DISC-AMT-NUM-X   TO PV-SAVE-DISC-AMT        14350065
079987              MOVE PV-SAVE-DISC-AMT-1  TO PV-DISC-AMT-CHAR        14360065
079988              INSPECT PV-DISC-AMT-CHAR REPLACING                  14370065
079989                      LEADING ZERO BY " "                         14380065
079990              INSPECT PV-DISC-AMT-CHAR                            14390065
080000                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         14400065
080001              COMPUTE PA-CNT-POS-2 = 8 - PA-CNT-SPACES-2          14410065
080002              ADD +1 TO PA-CNT-SPACES-2                           14420065
080003              MOVE +1 TO PV-POINTER-FIELD                         14430065
080004              STRING PC-CHAR-BUY DELIMITED BY " "                 14440065
080005                     " " DELIMITED BY SIZE                        14450065
080006                     PV-THRS-QTY-CHAR                             14460065
080007                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           14470065
080008                     "," DELIMITED BY SIZE                        14480065
080009                     " " DELIMITED BY SIZE                        14490065
080010                     PC-CHAR-GET DELIMITED BY " "                 14500065
080011                     " " DELIMITED BY SIZE                        14510065
080012                     PC-DOLLAR-SIGN DELIMITED BY " "              14520065
080013                     PV-DISC-AMT-CHAR                             14530065
080014                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           14540065
080015                     " " DELIMITED BY SIZE                        14550065
080016                     PC-CHAR-OFF DELIMITED BY " "                 14560065
080017              INTO PV-TIER-ITM-DESC-1                             14570065
080018              WITH POINTER PV-POINTER-FIELD                       14580065
080019         WHEN PM100-TIER-PRICG-TYP-CDE = 'TAA'                    14590065
080020              MOVE PM100-TIER-THRS-AMT TO PV-THRS-AMT-NUM         14600065
080021              MOVE PV-THRS-AMT-NUM-X   TO PV-SAVE-THRS-AMT        14610065
080022              MOVE PV-SAVE-THRS-AMT-1  TO PV-THRS-AMT-CHAR        14620065
080023              INSPECT PV-THRS-AMT-CHAR REPLACING                  14630065
080024                      LEADING ZERO BY " "                         14640065
080025              INSPECT PV-THRS-AMT-CHAR                            14650065
080026                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         14660065
080027              COMPUTE PA-CNT-POS-1 = 8 - PA-CNT-SPACES-1          14670065
080028              ADD +1 TO PA-CNT-SPACES-1                           14680065
080029              MOVE PM100-TIER-DISC-AMT TO PV-DISC-AMT-NUM         14690065
080030              MOVE PV-DISC-AMT-NUM-X   TO PV-SAVE-DISC-AMT        14700065
080031              MOVE PV-SAVE-DISC-AMT-1  TO PV-DISC-AMT-CHAR        14710065
080032              INSPECT PV-DISC-AMT-CHAR REPLACING                  14720065
080033                      LEADING ZERO BY " "                         14730065
080034              INSPECT PV-DISC-AMT-CHAR                            14740065
080035                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         14750065
080036              COMPUTE PA-CNT-POS-2 = 8 - PA-CNT-SPACES-2          14760065
080037              ADD +1 TO PA-CNT-SPACES-2                           14770065
080038              MOVE +1 TO PV-POINTER-FIELD                         14780065
080039              STRING PC-CHAR-BUY DELIMITED BY " "                 14790065
080040                     " " DELIMITED BY SIZE                        14800065
080041                     PC-DOLLAR-SIGN DELIMITED BY " "              14810065
080042                     PV-THRS-AMT-CHAR                             14820065
080043                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           14830065
080044                     "," DELIMITED BY SIZE                        14840065
080045                     " " DELIMITED BY SIZE                        14850065
080046                     PC-CHAR-GET DELIMITED BY " "                 14860065
080047                     " " DELIMITED BY SIZE                        14870065
080048                     PC-DOLLAR-SIGN DELIMITED BY " "              14880065
080049                     PV-DISC-AMT-CHAR                             14890065
080050                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           14900065
080051                     " " DELIMITED BY SIZE                        14910065
080052                     PC-CHAR-OFF DELIMITED BY " "                 14920065
080053              INTO PV-TIER-ITM-DESC-1                             14930065
080054              WITH POINTER PV-POINTER-FIELD                       14940065
080055     END-EVALUATE.                                                14950065
080056                                                                  14960065
080057*2210-EXIT.                                                       14970065
080058 EJECT.                                                           14980065
080059                                                                  14990065
080060*----------------------------------------------------------       15000065
080061* 2220-FORMAT-PROMO-ITM-DTES.                                     15010065
080062*     IF THE PROMO ITEM IS ATTACHED TO AN UNADVERTISED            15020065
080063*     PROMOTION, THE PROMO ITEM EFFECTIVE DATES NEED              15030065
080064*     TO BE INCLUDED IN THE REPORTS.                              15040065
080065*----------------------------------------------------------       15050065
080066 2220-FORMAT-PROMO-ITM-DTES.                                      15060065
080067                                                                  15070065
080068     MOVE PM100-PROMO-ITM-STRT-TMST TO PV-PROMO-ITM-STRT-TMST.    15080065
080069     MOVE PM100-PROMO-ITM-END-TMST  TO PV-PROMO-ITM-END-TMST.     15090065
080070     MOVE PV-PI-STRT-DTE-YY         TO PV-EFF-STRT-DTE-YY.        15100065
080071     MOVE PV-PI-STRT-DTE-MM         TO PV-EFF-STRT-DTE-MM.        15110065
080072     MOVE PV-PI-STRT-DTE-DD         TO PV-EFF-STRT-DTE-DD.        15120065
080073     MOVE PV-PI-END-DTE-YY          TO PV-EFF-END-DTE-YY.         15130065
080074     MOVE PV-PI-END-DTE-MM          TO PV-EFF-END-DTE-MM.         15140065
080075     MOVE PV-PI-END-DTE-DD          TO PV-EFF-END-DTE-DD.         15150065
080076                                                                  15160065
080077*2220-EXIT.                                                       15170065
080078 EJECT.                                                           15180065
080079                                                                  15190065
080080*----------------------------------------------------------       15200077
080081* 2230-CREATE-VERSION-DATA.                                       15210077
080082*     CREATE THE VERSION DATA IF THE PROMO ITEM HAS SPECIFIC      15220077
080083*     VERSIONS THAT IT IS IN.                                     15230077
080084*----------------------------------------------------------       15240077
080085 2230-CREATE-VERSION-DATA.                                        15250077
080086                                                                  15260077
080087     INITIALIZE PV-CHAR-LENGTH.                                   15270084
080088     MOVE +1 TO PV-POINTER-FIELD.                                 15280082
080090     PERFORM                                                      15290083
080091       VARYING PV-VAR-IDX FROM 1 BY 1                             15300083
080100         UNTIL PM100-AD-VERSION(PV-VAR-IDX) = SPACES              15310083
080110            OR PV-VAR-IDX > 15                                    15320083
080114              STRING PM100-AD-VERSION(PV-VAR-IDX) DELIMITED BY " "15330083
080115              "," DELIMITED BY SIZE                               15340083
080116              " " DELIMITED BY SIZE                               15350083
080200          INTO PV-VERSION-AD                                      15360082
080210          WITH POINTER PV-POINTER-FIELD                           15370083
080220     END-PERFORM.                                                 15380083
080233                                                                  15390077
080234     MOVE PC-FRONT-PAR          TO PV-PARENTHESES.                15400086
080235     MOVE PV-VERSION-AD         TO PV-SAVE-VAR.                   15410084
080236     MOVE 61                    TO PV-SAVE-NUM.                   15420086
080237     PERFORM 2310-COUNT-FIELD-LENGTH.                             15430084
080238     MOVE PV-SAVE-LENGTH        TO PV-CHAR-LENGTH.                15440084
080239                                                                  15450084
080240     MOVE PC-BACK-PAR          TO PV-VERSION-AD(PV-CHAR-LENGTH:1).15460084
080241     MOVE PV-VER-AD-VARIABLE   TO DTL-01-VERSION-AD.              15470082
080242                                                                  15480082
080243*2230-EXIT.                                                       15490077
080244 EJECT.                                                           15500077
080245                                                                  15510077
080246*----------------------------------------------------------       15520065
080247* 2300-FORMAT-HEADING-FIELDS.                                     15530065
080248*     FORMAT THE AD EVENT TITLES AND THE PROMOTION TITLES.        15540065
080249*----------------------------------------------------------       15550065
080250 2300-FORMAT-HEADING-FIELDS.                                      15560065
080251                                                                  15570065
080252     MOVE PM100-AD-EVNT-NBR-TXT TO PV-SAVE-VAR.                   15580065
080253     MOVE 16                    TO PV-SAVE-NUM.                   15590065
080254     PERFORM 2310-COUNT-FIELD-LENGTH.                             15600065
080255     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NBR-LENGTH.         15610065
080256                                                                  15620065
080257     MOVE PM100-AD-EVNT-NM      TO PV-SAVE-VAR.                   15630065
080258     MOVE 41                    TO PV-SAVE-NUM.                   15640065
080259     PERFORM 2310-COUNT-FIELD-LENGTH.                             15650065
080260     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NM-LENGTH.          15660065
080261                                                                  15670065
080262     MOVE PM100-PROMO-NM        TO PV-SAVE-VAR.                   15680065
080263     MOVE 41                    TO PV-SAVE-NUM.                   15690065
080264     PERFORM 2310-COUNT-FIELD-LENGTH.                             15700065
080265     MOVE PV-SAVE-LENGTH        TO PV-PROMO-NM-LENGTH.            15710065
080266                                                                  15720065
080267*2300-EXIT.                                                       15730065
080268 EJECT.                                                           15740065
080269                                                                  15750065
080270*----------------------------------------------------------       15760065
080271* 2310-COUNT-FIELD-LENGTH.                                        15770065
080272*     COUNTS THE ACTUAL FIELD'S LENGTH.                           15780065
080273*----------------------------------------------------------       15790065
080274 2310-COUNT-FIELD-LENGTH.                                         15800065
080275                                                                  15810065
080276     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         15820065
080277     MOVE PV-SAVE-VAR    TO PV-VARIABLE-OUTPUT-FIELD.             15830065
080278                                                                  15840065
080279     MOVE PV-SAVE-NUM TO PV-SUBSCRIPT.                            15850065
080280                                                                  15860065
080281     PERFORM                                                      15870065
080282        VARYING PV-BIT-IDX FROM PV-SAVE-NUM BY -1                 15880065
080283        UNTIL PV-BIT-VARIABLE(PV-BIT-IDX) NOT = SPACES            15890065
080284               OR PV-BIT-IDX = 1                                  15900065
080285        SUBTRACT 1 FROM PV-SUBSCRIPT                              15910065
080286     END-PERFORM.                                                 15920065
080287                                                                  15930065
080288     MOVE PV-SUBSCRIPT TO PV-SAVE-LENGTH.                         15940065
080289                                                                  15950065
080290*2310-EXIT.                                                       15960065
080291 EJECT.                                                           15970065
080292                                                                  15980065
080293*----------------------------------------------------------       15990065
080294* 2400-CREATE-HEADING-FIELDS.                                     16000065
080295*     CREATE THE AD EVENT AND THE PROMO HEADINGS.                 16010065
080296*----------------------------------------------------------       16020065
080297 2400-CREATE-HEADING-FIELDS.                                      16030065
080298                                                                  16040065
080299     MOVE SPACES          TO HDR-02-ADEVNT-STRING                 16050065
080300                             HDR-03-PROMO-STRING.                 16060065
080301                                                                  16070065
080302     MOVE +1 TO PV-POINTER-FIELD.                                 16080065
080303     STRING PM100-AD-EVNT-NBR-TXT(1:PV-AD-EVNT-NBR-LENGTH)        16090065
080304            " " DELIMITED BY SIZE                                 16100065
080305            PM100-AD-EVNT-NM(1:PV-AD-EVNT-NM-LENGTH)              16110065
080306            " " DELIMITED BY SIZE                                 16120065
080307       INTO HDR-02-ADEVNT-STRING                                  16130065
080308       WITH POINTER PV-POINTER-FIELD.                             16140065
080309                                                                  16150065
080310     MOVE +1 TO PV-POINTER-FIELD.                                 16160065
080311     STRING PM100-PROMO-NM(1:PV-PROMO-NM-LENGTH)                  16170065
080312            " " DELIMITED BY SIZE                                 16180065
080313            " " DELIMITED BY SIZE                                 16190065
080314            " " DELIMITED BY SIZE                                 16200065
080315            PC-CHAR-EFFECTIVE DELIMITED BY " "                    16210065
080316            ":" DELIMITED BY SIZE                                 16220065
080317            " " DELIMITED BY SIZE                                 16230065
080318            PV-HEADER-DTE-TM(1:87)                                16240065
080319            " " DELIMITED BY SIZE                                 16250065
080320       INTO HDR-03-PROMO-STRING                                   16260065
080321       WITH POINTER PV-POINTER-FIELD.                             16270065
080322                                                                  16280065
080323*2400-EXIT.                                                       16290065
080324 EJECT.                                                           16300065
080325                                                                  16310065
080326*----------------------------------------------------------       16320065
080327* 3000-END-OF-JOB-ROUTINE.                                        16330065
080328*     PERFORMS THE FINAL PROCESSING OF THE PROGRAM.               16340065
080329*     WRITES OUT THE CLOSING LINES OF THE REPORT, CLOSES          16350065
080330*     ANY FILES, AND DISPLAYS ANY NECESSARY STATISTICS.           16360065
080331*----------------------------------------------------------       16370065
080332 3000-END-OF-JOB-ROUTINE.                                         16380065
080333                                                                  16390065
080334*** WRITE OUT THE LAST SECTION'S TOTAL                            16400065
080335     IF PS-NOT-FIRST-TIME                                         16410065
080336        IF PS-ADMIN-TIER-TTL                                      16420065
080337           PERFORM 3140-PROCESS-ATIER-LVLS-TTL                    16430065
080338           PERFORM 3150-PROCESS-ADMIN-TIER-TTL                    16440065
080339           ADD 1           TO PA-CNT-ADMIN-TOT                    16450065
080340        ELSE                                                      16460065
080341           IF PS-UNADV-PROMO-TTL                                  16470065
080342              PERFORM 3130-PROCESS-UNADV-PROMO-TTL                16480065
080343              ADD 1        TO PA-CNT-UNADV-TOT                    16490065
080344           ELSE                                                   16500065
080350              IF PS-ADV-PROMO-TTL                                 16510065
080360                 PERFORM 3110-PROCESS-PAGE-TTL                    16520065
080370                 PERFORM 3120-PROCESS-ADV-PROMO-TTL               16530065
080380                 ADD 1     TO PA-CNT-ADV-TOT                      16540065
PGNBR               ELSE                                                16541099
PGNBR                  IF PS-ADV-NOPGE-TTL                              16542099
PGNBR                     PERFORM 3030-PROCESS-ADV-NOPGE-TTL            16543099
PGNBR                     ADD 1          TO PA-CNT-ADVNO-TOT            16544099
PGNBR                  END-IF                                           16545099
080390              END-IF                                              16550065
080400           END-IF                                                 16560065
080500        END-IF                                                    16570065
080600        SET PS-TOT-PROMO-TTL TO TRUE                              16580065
080610        PERFORM 3100-SELECT-TOTAL-LINES                           16590065
080611                                                                  16600065
080612        MOVE 2                     TO PV-ADVANCE-LINES            16610065
080613                                      PV-SAVE-LINE-AMT            16620065
080614        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 16630065
080615        PERFORM 3200-CHECK-MAX-LINE-CNT                           16640065
080616        MOVE END-OF-REPORT-LINE    TO PV-RPT-LINE                 16650065
080617        PERFORM 8200-WRITE-RPT-LINE                               16660065
080618     END-IF.                                                      16670065
080619                                                                  16680065
080620                                                                  16690065
080630     CLOSE PROMO-ITM-SUMM-FILE                                    16700065
080640           PROMO-ITM-SUMM-REPORT.                                 16710065
080650                                                                  16720065
080660*3000-EXIT.                                                       16730065
080670 EJECT.                                                           16740065
080680                                                                  16750065
080690*----------------------------------------------------------       16760065
080700* 3100-SELECT-TOTAL-LINES.                                        16770065
080800*     SELECTS WHICH TOTAL LINES TO PROCESS IN THE REPORT.         16780065
080900*----------------------------------------------------------       16790065
081000 3100-SELECT-TOTAL-LINES.                                         16800065
081100                                                                  16810065
081200     SET PS-BLANK-LINE       TO TRUE.                             16820065
081300     MOVE 1                  TO PV-ADVANCE-LINES.                 16830065
081400     ADD  PV-ADVANCE-LINES   TO PV-LINE-CNT.                      16840065
081500     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         16850065
081600     MOVE SPACES             TO PV-RPT-LINE.                      16860065
081700     PERFORM 8200-WRITE-RPT-LINE.                                 16870065
081800     SET PS-NO-BLANK-LINE    TO TRUE.                             16880065
081900                                                                  16890065
082000     IF PS-ADV-PROMO-TTL                                          16900065
082100        PERFORM 3120-PROCESS-ADV-PROMO-TTL                        16910065
082200     END-IF.                                                      16920065
082300                                                                  16930065
PGNBR      IF PS-ADV-NOPGE-TTL                                          16931099
PGNBR         PERFORM 3030-PROCESS-ADV-NOPGE-TTL                        16932099
PGNBR      END-IF.                                                      16933099
PGNBR                                                                   16934099
082400     IF PS-UNADV-PROMO-TTL                                        16940065
082500        PERFORM 3130-PROCESS-UNADV-PROMO-TTL                      16950065
082600     END-IF.                                                      16960065
082700                                                                  16970065
082800     IF PS-ADMIN-TIER-TTL                                         16980065
082900        PERFORM 3150-PROCESS-ADMIN-TIER-TTL                       16990065
083000     END-IF.                                                      17000065
083100                                                                  17010065
083200     IF PS-TOT-PROMO-TTL                                          17020065
083300        PERFORM 3160-PROCESS-PROMOTION-TTL                        17030065
083400     END-IF.                                                      17040065
083500                                                                  17050065
083600*3100-EXIT.                                                       17060065
083700 EJECT.                                                           17070065
083800                                                                  17080065
083900*----------------------------------------------------------       17090065
084000* 3110-PROCESS-PAGE-TTL.                                          17100065
084100*     PROCESS THE PAGE/SECTION TOTAL OF THE REPORT.               17110065
084200*----------------------------------------------------------       17120065
084300 3110-PROCESS-PAGE-TTL.                                           17130065
084400                                                                  17140065
084500     MOVE SPACES                TO DETAIL-PMPG-TOTALS             17150065
084600                                   DETAIL-VARIABLE.               17160065
084700                                                                  17170065
084800     MOVE PC-TOTAL-FOR-PAGE     TO DTL-PG-PAGE-TITLE.             17180065
084900     MOVE PV-AD-PG-NBR          TO DTL-PG-PAGE-NBR.               17190065
085000                                                                  17200065
085100*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                17210065
085200     IF PM100-ACTUAL                                              17220065
085400        MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                      17230097
085500                                TO DTL-PMPG-ACTL-TOT-SLS-AMT      17240097
085700                                                                  17250065
085800        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               17260065
085900           CONTINUE                                               17270065
086000        ELSE                                                      17280065
086100           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       17290093
086110                  ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -             17300093
086200                   TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /             17310093
086300                   TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100        17320093
086400                   ON SIZE ERROR                                  17330065
086500                   MOVE 0 TO PV-VOL-PCT-CHG                       17340065
086600           END-COMPUTE                                            17350065
086700           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          17360065
086800           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  17370065
086900           IF PV-VOL-PCT-CHG < 0                                  17380065
087000              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 17390065
087100              MOVE PV-FINAL-VOL-PCT TO DTL-PMPG-TOT-VOL-PCT-CHG   17400065
087200           ELSE                                                   17410065
087300              MOVE PV-ROUND-TO-TENTHS                             17420065
087400                                    TO DTL-VAR-VOL-PCT-CHG        17430065
087500              MOVE DETAIL-VARIABLE  TO DTL-PMPG-TOT-VOL-PCT-CHG   17440065
087600           END-IF                                                 17450065
087610           MOVE PC-PERCENT-SIGN     TO DTL-PMPG-VOL-PCT-SIGN      17460097
088200        END-IF                                                    17470065
088300                                                                  17480065
088340        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        17490091
088350                (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             17500091
088360                (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +             17510091
088370                 TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       17520091
088380                 ON SIZE ERROR                                    17530091
088390                 MOVE 0 TO PV-SELL-THRU-PCT                       17540091
088391        END-COMPUTE                                               17550091
089100        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          17560065
089200        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  17570065
089300        MOVE PV-ROUND-TO-TENTHS    TO DTL-PMPG-TOT-SELL-THRU-PCT  17580065
089700        MOVE PC-PERCENT-SIGN       TO DTL-PMPG-SELL-PCT-SIGN      17590097
089900                                                                  17600065
090100        MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                        17610097
090200                                   TO DTL-PMPG-TOT-ACTL-MD-AMT    17620097
090310                                                                  17630075
090500        MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   17640097
090510                                   TO DTL-PMPG-TOT-ACTL-UNT-QTY   17650097
090521                                                                  17660075
090540        MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                      17670097
090550                                TO DTL-PMPG-TOT-ACTL-PREP-QTY     17680097
090561                                                                  17690075
090570        MOVE ZEROES                TO PV-ROUND-TO-HDRTHS          17700074
090580        MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)                  17710098
090590                                   TO DTL-PMPG-TOT-ACTL-COST-AMT  17720097
090700                                                                  17730065
090800        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               17740065
090910           MOVE ZEROES             TO PV-MU-PCT                   17750097
090920           MOVE PV-MU-PCT          TO DTL-PMPG-TOT-ACTL-MU-PCT    17760097
090930           MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      17770097
091000        ELSE                                                      17780065
091100           COMPUTE PV-MU-PCT ROUNDED =                            17790065
091200                   ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -            17800065
091300                    TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/         17810065
091400                    TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100        17820065
091500                    ON SIZE ERROR                                 17830065
091600                    MOVE 0 TO PV-MU-PCT                           17840065
091700           END-COMPUTE                                            17850065
091710                                                                  17860075
091800           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          17870065
091900           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  17880065
092000           MOVE PV-ROUND-TO-TENTHS TO DTL-PMPG-TOT-ACTL-MU-PCT    17890065
092400           MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      17900097
092600        END-IF                                                    17910065
092700     END-IF.                                                      17920065
092800                                                                  17930065
092900*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            17940065
093100     MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                         17950097
093200                                TO DTL-PMPG-FCST-TOT-SLS-AMT.     17960097
093310                                                                  17970075
093500     MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                           17980097
093600                                TO DTL-PMPG-TOT-FCST-MD-AMT.      17990097
093710                                                                  18000075
093900     MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      18010097
094000                                TO DTL-PMPG-TOT-FCST-UNT-QTY.     18020097
094110                                                                  18030075
094300     MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                         18040097
094400                                TO DTL-PMPG-TOT-FCST-PREP-QTY.    18050097
094500                                                                  18060097
094800     MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2)                     18070097
094900                                TO DTL-PMPG-TOT-FCST-COST-AMT.    18080097
095100                                                                  18090065
095200     IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  18100065
095300         CONTINUE                                                 18110065
095400     ELSE                                                         18120065
095500         COMPUTE PV-MU-PCT ROUNDED =                              18130065
095600                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              18140065
095700                 TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/            18150065
095800                 TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100           18160065
095900                 ON SIZE ERROR                                    18170065
096000                 MOVE 0 TO PV-MU-PCT                              18180065
096100         END-COMPUTE                                              18190065
096200         MOVE ZEROES            TO PV-ROUND-TO-TENTHS             18200065
096300         ADD PV-MU-PCT          TO PV-ROUND-TO-TENTHS ROUNDED     18210065
096400         MOVE PV-ROUND-TO-TENTHS                                  18220065
096500                                TO DTL-PMPG-TOT-FCST-MU-PCT       18230065
096900         MOVE PC-PERCENT-SIGN   TO DTL-PMPG-FCST-PCT-SIGN         18240097
097100     END-IF.                                                      18250065
097200                                                                  18260065
097300     MOVE 1                         TO PV-ADVANCE-LINES.          18270065
097400     ADD PV-ADVANCE-LINES           TO PV-LINE-CNT.               18280065
097500     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         18290065
097600     MOVE DETAIL-PMPG-TOTALS        TO PV-RPT-LINE.               18300065
097700     PERFORM 8200-WRITE-RPT-LINE.                                 18310065
097800                                                                  18320065
097900*3110-EXIT.                                                       18330065
098000 EJECT.                                                           18340065
098100                                                                  18350065
098200*----------------------------------------------------------       18360065
098300* 3120-PROCESS-ADV-PROMO-TTL.                                     18370065
098400*     PROCESS THE ADVERTISED PROMOTION TOTAL OF THE REPORT.       18380065
098500*----------------------------------------------------------       18390065
098600 3120-PROCESS-ADV-PROMO-TTL.                                      18400065
098700                                                                  18410065
098800*** CHECKS TO SEE IF THE ADVERTISED TOTALS HAS BEEN               18420065
098900*** PROCESSED YET, IF IT HASN'T IT WILL PROCESS IT.               18430065
099000*** IF IT HAS THEN IT WILL JUST WRITE OUT THE LINE                18440065
099100*** THAT WAS SAVED FROM THE LAST PROCESSING.                      18450065
099200     IF PA-CNT-ADV-TOT = 0                                        18460065
099300        MOVE SPACES                TO DETAIL-ADV-TOTALS           18470065
099400                                      DETAIL-VARIABLE             18480065
099500        MOVE PC-ADV-TOTAL          TO DTL-ADV-PM-TITLE            18490065
099600        IF PM100-ACTUAL                                           18500065
099800           MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)                  18510097
099900                                   TO DTL-ADV-TOT-ACTL-SLS-AMT    18520097
100100                                                                  18530065
100200           IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES           18540065
100300              CONTINUE                                            18550065
100400           ELSE                                                   18560065
100500              COMPUTE PV-VOL-PCT-CHG ROUNDED =                    18570093
100510                     ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -         18580093
100600                      TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) /         18590093
100700                      TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * -100    18600093
100800                      ON SIZE ERROR                               18610065
100900                      MOVE 0 TO PV-VOL-PCT-CHG                    18620065
101000              END-COMPUTE                                         18630065
101100              MOVE ZEROES          TO PV-ROUND-TO-TENTHS          18640065
101200              ADD PV-VOL-PCT-CHG   TO PV-ROUND-TO-TENTHS ROUNDED  18650065
101300              IF PV-VOL-PCT-CHG < 0                               18660065
101400                 PERFORM 9000-ADD-PARENTH-TO-NEG-PCT              18670065
101500                 MOVE PV-FINAL-VOL-PCT                            18680065
101600                                   TO DTL-ADV-TOT-VOL-PCT-CHG     18690065
101700              ELSE                                                18700065
101800                 MOVE PV-ROUND-TO-TENTHS                          18710065
101900                                   TO DTL-VAR-VOL-PCT-CHG         18720065
102000                 MOVE DETAIL-VARIABLE                             18730065
102100                                   TO DTL-ADV-TOT-VOL-PCT-CHG     18740065
102200              END-IF                                              18750065
102600              MOVE PC-PERCENT-SIGN TO DTL-ADV-VOL-PCT-SIGN        18760097
102630           END-IF                                                 18770065
102631                                                                  18780065
102635           COMPUTE PV-SELL-THRU-PCT ROUNDED =                     18790091
102636                   (TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /         18800091
102637                   (TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) +         18810091
102638                    TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100   18820091
102639                    ON SIZE ERROR                                 18830091
102640                    MOVE 0 TO PV-SELL-THRU-PCT                    18840091
102641           END-COMPUTE                                            18850091
102643           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          18860065
102644           ADD PV-SELL-THRU-PCT    TO PV-ROUND-TO-TENTHS ROUNDED  18870065
102650           MOVE PV-ROUND-TO-TENTHS TO DTL-ADV-TOT-SELL-THRU-PCT   18880065
102700           MOVE PC-PERCENT-SIGN    TO DTL-ADV-SELL-PCT-SIGN       18890097
102810                                                                  18900075
103000           MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)                    18910098
103100                                   TO DTL-ADV-TOT-ACTL-MD-AMT     18920098
103210                                                                  18930075
103400           MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)               18940098
103500                                   TO DTL-ADV-TOT-ACTL-UNT-QTY    18950098
103610                                                                  18960075
103800           MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)                  18970098
103900                                   TO DTL-ADV-TOT-ACTL-PREP-QTY   18980098
104010                                                                  18990075
104200           MOVE TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1)              19000098
104300                                   TO DTL-ADV-TOT-ACTL-COST-AMT   19010098
104500                                                                  19020065
104600           IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES           19030065
104710              MOVE ZEROES             TO PV-MU-PCT                19040097
104720              MOVE PV-MU-PCT          TO DTL-ADV-TOT-ACTL-MU-PCT  19050097
104730              MOVE PC-PERCENT-SIGN    TO DTL-ADV-ACTL-PCT-SIGN    19060097
104800           ELSE                                                   19070065
104900              COMPUTE PV-MU-PCT ROUNDED =                         19080065
105000                      ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) -        19090065
105100                       TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1))/     19100065
105200                       TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) * 100    19110065
105300                       ON SIZE ERROR                              19120065
105400                       MOVE 0 TO PV-MU-PCT                        19130065
105500              END-COMPUTE                                         19140065
105600              MOVE ZEROES          TO PV-ROUND-TO-TENTHS          19150065
105700              ADD PV-MU-PCT        TO PV-ROUND-TO-TENTHS ROUNDED  19160074
105800              MOVE PV-ROUND-TO-TENTHS                             19170065
105900                                   TO DTL-ADV-TOT-ACTL-MU-PCT     19180065
106300              MOVE PC-PERCENT-SIGN TO DTL-ADV-ACTL-PCT-SIGN       19190097
106500           END-IF                                                 19200065
106600        END-IF                                                    19210065
106700                                                                  19220065
106900        MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)                     19230098
107000                                TO DTL-ADV-TOT-FCST-SLS-AMT       19240098
107110                                                                  19250075
107300        MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-2)                       19260098
107400                                TO DTL-ADV-TOT-FCST-MD-AMT        19270098
107510                                                                  19280075
107700        MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                  19290098
107800                                TO DTL-ADV-TOT-FCST-UNT-QTY       19300098
107910                                                                  19310075
108100        MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)                     19320098
108200                                TO DTL-ADV-TOT-FCST-PREP-QTY      19330098
108400                                                                  19340075
108600        MOVE TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2)                 19350098
108700                                TO DTL-ADV-TOT-FCST-COST-AMT      19360098
108900                                                                  19370065
109000        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              19380065
109100           CONTINUE                                               19390065
109200        ELSE                                                      19400065
109300           COMPUTE PV-MU-PCT ROUNDED =                            19410065
109400                   ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -           19420065
109500                     TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2))/       19430065
109600                     TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * 100      19440065
109700                     ON SIZE ERROR                                19450065
109800                     MOVE 0 TO PV-MU-PCT                          19460065
109900           END-COMPUTE                                            19470065
110000           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          19480065
110100           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  19490065
110200           MOVE PV-ROUND-TO-TENTHS                                19500065
110300                                   TO DTL-ADV-TOT-FCST-MU-PCT     19510065
110700           MOVE PC-PERCENT-SIGN    TO DTL-ADV-FCST-PCT-SIGN       19520097
110900        END-IF                                                    19530065
111000     END-IF.                                                      19540065
111100                                                                  19550065
111200     MOVE 1                     TO PV-ADVANCE-LINES.              19560065
111300     ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   19570065
111400     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         19580065
111500     MOVE DETAIL-ADV-TOTALS     TO PV-RPT-LINE.                   19590065
111600     PERFORM 8200-WRITE-RPT-LINE.                                 19600065
111700                                                                  19610065
111800*3120-EXIT.                                                       19620065
111900 EJECT.                                                           19630065
112000                                                                  19640065
112100*----------------------------------------------------------       19650065
112200* 3130-PROCESS-UNADV-PROMO-TTL.                                   19660065
112300*     PROCESS THE UNADVERTISED PROMOTION TOTAL OF THE REPORT.     19670065
112400*----------------------------------------------------------       19680065
112500 3130-PROCESS-UNADV-PROMO-TTL.                                    19690065
112600                                                                  19700065
112700*** CHECKS TO SEE IF THE UNADVERTISED TOTALS HAS BEEN             19710065
112800*** PROCESSED YET, IF IT HASN'T IT WILL PROCESS IT.               19720065
112900*** IF IT HAS THEN IT WILL JUST WRITE OUT THE LINE                19730065
113000*** THAT WAS SAVED FROM THE LAST PROCESSING.                      19740065
113100     IF PA-CNT-UNADV-TOT = 0                                      19750065
113200        MOVE SPACES               TO DETAIL-UNADV-TOTALS          19760065
113300                                     DETAIL-VARIABLE              19770065
113400        MOVE PC-UNADV-TOTAL       TO DTL-UNADV-PM-TITLE           19780065
113500        IF PM100-ACTUAL                                           19790065
113700           MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                   19800098
113800                                   TO DTL-UNADV-TOT-ACTL-SLS-AMT  19810098
114000                                                                  19820065
114100           IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES            19830065
114200              CONTINUE                                            19840065
114300           ELSE                                                   19850065
114400              COMPUTE PV-VOL-PCT-CHG ROUNDED =                    19860093
114410                     ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -          19870093
114500                      TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /          19880093
114600                      TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100     19890093
114700                      ON SIZE ERROR                               19900065
114800                      MOVE 0 TO PV-VOL-PCT-CHG                    19910065
114900              END-COMPUTE                                         19920065
115000              MOVE ZEROES          TO PV-ROUND-TO-TENTHS          19930065
115100              ADD PV-VOL-PCT-CHG   TO PV-ROUND-TO-TENTHS ROUNDED  19940065
115200              IF PV-VOL-PCT-CHG < 0                               19950065
115300                 PERFORM 9000-ADD-PARENTH-TO-NEG-PCT              19960065
115400                 MOVE PV-FINAL-VOL-PCT                            19970065
115500                                   TO DTL-UNADV-TOT-VOL-PCT-CHG   19980065
115600              ELSE                                                19990065
115700                 MOVE PV-ROUND-TO-TENTHS                          20000065
115800                                   TO DTL-VAR-VOL-PCT-CHG         20010065
115900                 MOVE DETAIL-VARIABLE                             20020065
116000                                   TO DTL-UNADV-TOT-VOL-PCT-CHG   20030065
116100              END-IF                                              20040065
116410              MOVE PC-PERCENT-SIGN TO DTL-UNADV-VOL-PCT-SIGN      20050097
116440           END-IF                                                 20060065
116450                                                                  20070065
116460           COMPUTE PV-SELL-THRU-PCT ROUNDED =                     20080091
116470                   (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /          20090091
116480                   (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +          20100091
116490                    TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100    20110091
116500                    ON SIZE ERROR                                 20120091
116600                    MOVE 0 TO PV-SELL-THRU-PCT                    20130091
116700           END-COMPUTE                                            20140091
116800           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          20150065
116900           ADD PV-SELL-THRU-PCT    TO PV-ROUND-TO-TENTHS ROUNDED  20160065
117000           MOVE PV-ROUND-TO-TENTHS TO DTL-UNADV-TOT-SELL-THRU-PCT 20170065
117500           MOVE PC-PERCENT-SIGN    TO DTL-UNADV-SELL-PCT-SIGN     20180097
117601                                                                  20190075
117620           MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                     20200098
117630                                   TO DTL-UNADV-TOT-ACTL-MD-AMT   20210098
117641                                                                  20220075
117660           MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                20230098
117670                                   TO DTL-UNADV-TOT-ACTL-UNT-QTY  20240098
117681                                                                  20250075
117691           MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                   20260098
117692                                   TO DTL-UNADV-TOT-ACTL-PREP-QTY 20270098
117694                                                                  20280075
117696           MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)               20290098
117697                                   TO DTL-UNADV-TOT-ACTL-COST-AMT 20300098
117699                                                                  20310065
117700           IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES            20320065
117702              MOVE ZEROES             TO PV-MU-PCT                20330097
117703              MOVE PV-MU-PCT          TO DTL-UNADV-TOT-ACTL-MU-PCT20340097
117704              MOVE PC-PERCENT-SIGN    TO DTL-UNADV-ACTL-PCT-SIGN  20350097
117705           ELSE                                                   20360065
117706              COMPUTE PV-MU-PCT ROUNDED =                         20370065
117707                      ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -         20380065
117708                       TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/      20390065
117709                       TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100     20400065
117710                       ON SIZE ERROR                              20410065
117711                       MOVE 0 TO PV-MU-PCT                        20420065
117712              END-COMPUTE                                         20430065
117713              MOVE ZEROES          TO PV-ROUND-TO-TENTHS          20440065
117714              ADD PV-MU-PCT        TO PV-ROUND-TO-TENTHS ROUNDED  20450065
117715              MOVE PV-ROUND-TO-TENTHS                             20460065
117716                                   TO DTL-UNADV-TOT-ACTL-MU-PCT   20470065
117720              MOVE PC-PERCENT-SIGN TO DTL-UNADV-ACTL-PCT-SIGN     20480097
117723           END-IF                                                 20490065
117724        END-IF                                                    20500065
117725                                                                  20510065
117727        MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                      20520098
117728                                TO DTL-UNADV-TOT-FCST-SLS-AMT     20530098
117730                                                                  20540075
117732        MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                        20550098
117733                                TO DTL-UNADV-TOT-FCST-MD-AMT      20560098
117735                                                                  20570075
117737        MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                   20580098
117738                                TO DTL-UNADV-TOT-FCST-UNT-QTY     20590098
117740                                                                  20600075
117742        MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                      20610098
117743                                TO DTL-UNADV-TOT-FCST-PREP-QTY    20620098
117745                                                                  20630075
117747        MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2)                  20640098
117748                                TO DTL-UNADV-TOT-FCST-COST-AMT    20650098
117750                                                                  20660065
117751        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               20670065
117752           CONTINUE                                               20680065
117753        ELSE                                                      20690065
117754           COMPUTE PV-MU-PCT ROUNDED =                            20700065
117755                   ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -            20710065
117756                     TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/        20720065
117757                     TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100       20730065
117758                     ON SIZE ERROR                                20740065
117759                     MOVE 0 TO PV-MU-PCT                          20750065
117760           END-COMPUTE                                            20760065
117761                                                                  20770075
117762           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          20780065
117763           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  20790065
117764           MOVE PV-ROUND-TO-TENTHS                                20800065
117765                                   TO DTL-UNADV-TOT-FCST-MU-PCT   20810065
117769           MOVE PC-PERCENT-SIGN    TO DTL-UNADV-FCST-PCT-SIGN     20820097
117771        END-IF                                                    20830065
117772     END-IF.                                                      20840065
117773                                                                  20850065
117774     MOVE 1                      TO PV-ADVANCE-LINES.             20860065
117775     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  20870065
117776     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         20880065
117777     MOVE DETAIL-UNADV-TOTALS    TO PV-RPT-LINE.                  20890065
117778     PERFORM 8200-WRITE-RPT-LINE.                                 20900065
117780                                                                  20910065
117781*3130-EXIT.                                                       20920065
117782 EJECT.                                                           20930065
117783                                                                  20940065
PGNBR *----------------------------------------------------------       20941099
PGNBR * 3030-PROCESS-ADV-NOPGE-TTL.                                     20942099
PGNBR *     PROCESS THE ADVERTISED PROMO WITH NO PAGE TOTAL.            20943099
PGNBR *----------------------------------------------------------       20944099
PGNBR  3030-PROCESS-ADV-NOPGE-TTL.                                      20945099
PGNBR                                                                   20946099
PGNBR *** CHECKS TO SEE IF THE ADVERTISED WITH NO PAGE TOTALS HAS BEEN  20947099
PGNBR *** PROCESSED YET, IF IT HASN'T IT WILL PROCESS IT.               20948099
PGNBR *** IF IT HAS THEN IT WILL JUST WRITE OUT THE LINE                20949099
PGNBR *** THAT WAS SAVED FROM THE LAST PROCESSING.                      20949199
PGNBR      IF PA-CNT-ADVNO-TOT = 0                                      20949299
PGNBR         MOVE SPACES               TO DETAIL-ADVNO-TOTALS          20949399
PGNBR                                      DETAIL-VARIABLE              20949499
PGNBR         MOVE PC-ADVNO-TOTAL       TO DTL-ADVNO-PM-TITLE           20949599
PGNBR         IF PM100-ACTUAL                                           20949699
PGNBR            MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                   20949799
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-SLS-AMT  20949899
PGNBR                                                                   20949999
PGNBR            IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES            20950099
PGNBR               CONTINUE                                            20950199
PGNBR            ELSE                                                   20950299
PGNBR               COMPUTE PV-VOL-PCT-CHG ROUNDED =                    20950399
PGNBR                      ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -          20950499
PGNBR                       TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /          20950599
PGNBR                       TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100     20950699
PGNBR                       ON SIZE ERROR                               20950799
PGNBR                       MOVE 0 TO PV-VOL-PCT-CHG                    20950899
PGNBR               END-COMPUTE                                         20950999
PGNBR               MOVE ZEROES          TO PV-ROUND-TO-TENTHS          20951099
PGNBR               ADD PV-VOL-PCT-CHG   TO PV-ROUND-TO-TENTHS ROUNDED  20951199
PGNBR               IF PV-VOL-PCT-CHG < 0                               20951299
PGNBR                  PERFORM 9000-ADD-PARENTH-TO-NEG-PCT              20951399
PGNBR                  MOVE PV-FINAL-VOL-PCT                            20951499
PGNBR                                    TO DTL-ADVNO-TOT-VOL-PCT-CHG   20951599
PGNBR               ELSE                                                20951699
PGNBR                  MOVE PV-ROUND-TO-TENTHS                          20951799
PGNBR                                    TO DTL-VAR-VOL-PCT-CHG         20951899
PGNBR                  MOVE DETAIL-VARIABLE                             20951999
PGNBR                                    TO DTL-ADVNO-TOT-VOL-PCT-CHG   20952099
PGNBR               END-IF                                              20952199
PGNBR               MOVE PC-PERCENT-SIGN TO DTL-ADVNO-VOL-PCT-SIGN      20952299
PGNBR            END-IF                                                 20952399
PGNBR                                                                   20952499
PGNBR            COMPUTE PV-SELL-THRU-PCT ROUNDED =                     20952599
PGNBR                    (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /          20952699
PGNBR                    (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +          20952799
PGNBR                     TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100    20952899
PGNBR                     ON SIZE ERROR                                 20952999
PGNBR                     MOVE 0 TO PV-SELL-THRU-PCT                    20953099
PGNBR            END-COMPUTE                                            20953199
PGNBR            MOVE ZEROES             TO PV-ROUND-TO-TENTHS          20953299
PGNBR            ADD PV-SELL-THRU-PCT    TO PV-ROUND-TO-TENTHS ROUNDED  20953399
PGNBR            MOVE PV-ROUND-TO-TENTHS TO DTL-ADVNO-TOT-SELL-THRU-PCT 20953499
PGNBR            MOVE PC-PERCENT-SIGN    TO DTL-ADVNO-SELL-PCT-SIGN     20953599
PGNBR                                                                   20953699
PGNBR            MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                     20953799
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-MD-AMT   20953899
PGNBR                                                                   20953999
PGNBR            MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                20954099
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-UNT-QTY  20954199
PGNBR                                                                   20954299
PGNBR            MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                   20954399
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-PREP-QTY 20954499
PGNBR                                                                   20954599
PGNBR            MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)               20954699
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-COST-AMT 20954799
PGNBR                                                                   20954899
PGNBR            IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES            20954999
PGNBR               MOVE ZEROES             TO PV-MU-PCT                20955099
PGNBR               MOVE PV-MU-PCT          TO DTL-ADVNO-TOT-ACTL-MU-PCT20955199
PGNBR               MOVE PC-PERCENT-SIGN    TO DTL-ADVNO-ACTL-PCT-SIGN  20955299
PGNBR            ELSE                                                   20955399
PGNBR               COMPUTE PV-MU-PCT ROUNDED =                         20955499
PGNBR                       ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -         20955599
PGNBR                        TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/      20955699
PGNBR                        TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100     20955799
PGNBR                        ON SIZE ERROR                              20955899
PGNBR                        MOVE 0 TO PV-MU-PCT                        20955999
PGNBR               END-COMPUTE                                         20956099
PGNBR               MOVE ZEROES          TO PV-ROUND-TO-TENTHS          20956199
PGNBR               ADD PV-MU-PCT        TO PV-ROUND-TO-TENTHS ROUNDED  20956299
PGNBR               MOVE PV-ROUND-TO-TENTHS                             20956399
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-MU-PCT   20956499
PGNBR               MOVE PC-PERCENT-SIGN TO DTL-ADVNO-ACTL-PCT-SIGN     20956599
PGNBR            END-IF                                                 20956699
PGNBR         END-IF                                                    20956799
PGNBR                                                                   20956899
PGNBR         MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                      20956999
PGNBR                                 TO DTL-ADVNO-TOT-FCST-SLS-AMT     20957099
PGNBR                                                                   20957199
PGNBR         MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                        20957299
PGNBR                                 TO DTL-ADVNO-TOT-FCST-MD-AMT      20957399
PGNBR                                                                   20957499
PGNBR         MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                   20957599
PGNBR                                 TO DTL-ADVNO-TOT-FCST-UNT-QTY     20957699
PGNBR                                                                   20957799
PGNBR         MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                      20957899
PGNBR                                 TO DTL-ADVNO-TOT-FCST-PREP-QTY    20957999
PGNBR                                                                   20958099
PGNBR         MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2)                  20958199
PGNBR                                 TO DTL-ADVNO-TOT-FCST-COST-AMT    20958299
PGNBR                                                                   20958399
PGNBR         IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               20958499
PGNBR            CONTINUE                                               20958599
PGNBR         ELSE                                                      20958699
PGNBR            COMPUTE PV-MU-PCT ROUNDED =                            20958799
PGNBR                    ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -            20958899
PGNBR                      TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/        20958999
PGNBR                      TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100       20959099
PGNBR                      ON SIZE ERROR                                20959199
PGNBR                      MOVE 0 TO PV-MU-PCT                          20959299
PGNBR            END-COMPUTE                                            20959399
PGNBR                                                                   20959499
PGNBR            MOVE ZEROES             TO PV-ROUND-TO-TENTHS          20959599
PGNBR            ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  20959699
PGNBR            MOVE PV-ROUND-TO-TENTHS                                20959799
PGNBR                                    TO DTL-ADVNO-TOT-FCST-MU-PCT   20959899
PGNBR            MOVE PC-PERCENT-SIGN    TO DTL-ADVNO-FCST-PCT-SIGN     20959999
PGNBR         END-IF                                                    20960099
PGNBR      END-IF.                                                      20960199
PGNBR                                                                   20960299
PGNBR      MOVE 1                      TO PV-ADVANCE-LINES.             20960399
PGNBR      ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  20960499
PGNBR      PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         20960599
PGNBR      MOVE DETAIL-ADVNO-TOTALS    TO PV-RPT-LINE.                  20960699
PGNBR      PERFORM 8200-WRITE-RPT-LINE.                                 20960799
PGNBR                                                                   20960899
PGNBR *3030-EXIT.                                                       20960999
PGNBR  EJECT.                                                           20961099
PGNBR                                                                   20961199
117784*----------------------------------------------------------       20961265
117785* 3140-PROCESS-ATIER-LVLS-TTL.                                    20962065
117786*     PROCESS THE TOTAL OF THE LEVELS WITHIN ONE ADMIN TIERED     20970065
117787*     GROUP. ADMIN TIERED IS ONLY USED IN THE ACTUAL              20980065
117788*     REPORTS.                                                    20990065
117789*----------------------------------------------------------       21000065
117790 3140-PROCESS-ATIER-LVLS-TTL.                                     21010065
117791                                                                  21020065
117792     MOVE SPACES                TO DETAIL-ATLVL-TOTALS.           21030065
117793     MOVE PC-TOTAL              TO DTL-ATLVL-PM-TITLE.            21040065
117794                                                                  21050065
117796     MOVE PV-TTL-SLS-RTL-AMT    TO DTL-ATLVL-TOT-ACTL-SLS-AMT.    21060098
117800     MOVE PV-TTL-MKDN-RTL-AMT   TO DTL-ATLVL-TOT-ACTL-MD-AMT.     21070098
117804     MOVE PV-TTL-SLS-UNT-QTY    TO DTL-ATLVL-TOT-ACTL-UNT-QTY.    21080098
117808     MOVE PV-TTL-SLS-COST-AMT   TO DTL-ATLVL-TOT-ACTL-COST-AMT.   21090098
117810                                                                  21100065
117811     MOVE 1                     TO PV-ADVANCE-LINES.              21110065
117812     ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   21120065
117813     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         21130065
117814     MOVE DETAIL-ATLVL-TOTALS   TO PV-RPT-LINE.                   21140065
117815     PERFORM 8200-WRITE-RPT-LINE.                                 21150065
117816                                                                  21160065
117817*3140-EXIT.                                                       21170065
117818 EJECT.                                                           21180065
117819                                                                  21190065
117820*----------------------------------------------------------       21200065
117821* 3150-PROCESS-ADMIN-TIER-TTL.                                    21210065
117822*     PROCESS THE ADMIN TIERED PRICING TOTAL OF THE REPORT.       21220065
117823*     ADMIN TIERED IS USED ONLY IN THE ACTUAL REPORTS.            21230065
117824*----------------------------------------------------------       21240065
117825 3150-PROCESS-ADMIN-TIER-TTL.                                     21250065
117826                                                                  21260065
117827*** CHECKS TO SEE IF THE ADMIN TIERED TOTALS HAS BEEN             21270065
117828*** PROCESSED YET, IF IT HASN'T IT WILL PROCESS IT.               21280065
117829*** IF IT HAS THEN IT WILL JUST WRITE OUT THE LINE                21290065
117830*** THAT WAS SAVED FROM THE LAST PROCESSING.                      21300065
117840     IF PA-CNT-ADMIN-TOT = 0                                      21310065
117841        MOVE SPACES             TO DETAIL-ADMIN-TOTALS            21320065
117842                                   DETAIL-VARIABLE                21330065
117843        MOVE PC-ADMIN-TOTAL        TO DTL-ADMIN-PM-TITLE          21340098
117844                                                                  21350065
117846        MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                      21360098
117847                                   TO DTL-ADMIN-TOT-ACTL-SLS-AMT  21370098
117849                                                                  21380065
117851        MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                        21390098
117852                                   TO DTL-ADMIN-TOT-ACTL-MD-AMT   21400098
117854                                                                  21410075
117856        MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   21420098
117857                                   TO DTL-ADMIN-TOT-ACTL-UNT-QTY  21430098
117859                                                                  21440075
117861        MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)                  21450098
117862                                   TO DTL-ADMIN-TOT-ACTL-COST-AMT 21460098
117880     END-IF.                                                      21470065
117890                                                                  21480065
117900     MOVE 1                     TO PV-ADVANCE-LINES.              21490065
117910     ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   21500065
117920     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         21510065
117930     MOVE DETAIL-ADMIN-TOTALS   TO PV-RPT-LINE.                   21520065
117940     PERFORM 8200-WRITE-RPT-LINE.                                 21530065
117950                                                                  21540065
117960*3150-EXIT.                                                       21550065
117961 EJECT.                                                           21560065
117962                                                                  21570065
117963*----------------------------------------------------------       21580065
117964* 3160-PROCESS-PROMOTION-TTL.                                     21590065
117965*     PROCESS THE COMPLETE PROMOTION TOTAL.                       21600065
117966*----------------------------------------------------------       21610065
117967 3160-PROCESS-PROMOTION-TTL.                                      21620065
117968                                                                  21630065
117969     MOVE SPACES                TO DETAIL-PMPG-TOTALS             21640065
117970                                   DETAIL-VARIABLE.               21650065
117980                                                                  21660065
117990     MOVE PC-PROMOTION-TOTAL    TO DTL-PM-PROMO-TITLE.            21670065
118000                                                                  21680065
118010*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                21690065
118020     IF PM100-ACTUAL                                              21700065
118022        MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)                     21710098
118023                                TO DTL-PMPG-ACTL-TOT-SLS-AMT      21720098
118025                                                                  21730065
118026        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              21740065
118027           CONTINUE                                               21750065
118028        ELSE                                                      21760065
118029           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       21770093
118030                  ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -            21780093
118031                   TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) /            21790093
118032                   TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * -100       21800093
118033                   ON SIZE ERROR                                  21810065
118034                   MOVE 0 TO PV-VOL-PCT-CHG                       21820065
118035           END-COMPUTE                                            21830065
118036           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          21840065
118037           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  21850065
118038           IF PV-VOL-PCT-CHG < 0                                  21860065
118039              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 21870065
118040              MOVE PV-FINAL-VOL-PCT TO DTL-PMPG-TOT-VOL-PCT-CHG   21880065
118041           ELSE                                                   21890065
118042              MOVE PV-ROUND-TO-TENTHS                             21900065
118043                                    TO DTL-VAR-VOL-PCT-CHG        21910065
118044              MOVE DETAIL-VARIABLE  TO DTL-PMPG-TOT-VOL-PCT-CHG   21920065
118045           END-IF                                                 21930065
118049           MOVE PC-PERCENT-SIGN     TO DTL-PMPG-VOL-PCT-SIGN      21940097
118051        END-IF                                                    21950065
118060                                                                  21960065
118064        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        21970091
118065                (TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /            21980091
118066                (TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) +            21990091
118067                 TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100      22000091
118068                 ON SIZE ERROR                                    22010091
118069                 MOVE 0 TO PV-SELL-THRU-PCT                       22020091
118070        END-COMPUTE                                               22030091
118072        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          22040065
118073        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  22050065
118074        MOVE PV-ROUND-TO-TENTHS    TO DTL-PMPG-TOT-SELL-THRU-PCT  22060065
118080        MOVE PC-PERCENT-SIGN       TO DTL-PMPG-SELL-PCT-SIGN      22070097
118082                                                                  22080075
118084        MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)                       22090098
118085                                   TO DTL-PMPG-TOT-ACTL-MD-AMT    22100098
118087                                                                  22110075
118089        MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)                  22120098
118090                                   TO DTL-PMPG-TOT-ACTL-UNT-QTY   22130098
118092                                                                  22140075
118094        MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)                     22150098
118095                                   TO DTL-PMPG-TOT-ACTL-PREP-QTY  22160098
118097                                                                  22170075
118099        MOVE TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1)                 22180098
118100                                   TO DTL-PMPG-TOT-ACTL-COST-AMT  22190098
118102                                                                  22200065
118103        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES              22210065
118105           MOVE ZEROES             TO PV-MU-PCT                   22220097
118106           MOVE PV-MU-PCT          TO DTL-PMPG-TOT-ACTL-MU-PCT    22230097
118107           MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      22240097
118108        ELSE                                                      22250065
118109           COMPUTE PV-MU-PCT ROUNDED =                            22260065
118110                   ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) -           22270065
118111                    TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1))/        22280065
118112                    TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) * 100       22290065
118113                    ON SIZE ERROR                                 22300065
118114                    MOVE 0 TO PV-MU-PCT                           22310065
118115           END-COMPUTE                                            22320065
118116           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          22330065
118117           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  22340065
118118           MOVE PV-ROUND-TO-TENTHS TO DTL-PMPG-TOT-ACTL-MU-PCT    22350065
118122           MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      22360097
118124        END-IF                                                    22370065
118125     END-IF.                                                      22380065
118126                                                                  22390065
118127*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            22400065
118129     MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)                        22410098
118130                                TO DTL-PMPG-FCST-TOT-SLS-AMT.     22420098
118132                                                                  22430075
118134     MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-2)                          22440098
118135                                TO DTL-PMPG-TOT-FCST-MD-AMT.      22450098
118137                                                                  22460075
118139     MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                     22470098
118140                                TO DTL-PMPG-TOT-FCST-UNT-QTY.     22480098
118142                                                                  22490075
118144     MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)                        22500098
118145                                TO DTL-PMPG-TOT-FCST-PREP-QTY.    22510098
118147                                                                  22520075
118149     MOVE TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2)                    22530098
118150                                TO DTL-PMPG-TOT-FCST-COST-AMT.    22540098
118152                                                                  22550065
118153     IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                 22560065
118154         CONTINUE                                                 22570065
118155     ELSE                                                         22580065
118156         COMPUTE PV-MU-PCT ROUNDED =                              22590065
118157                 ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -             22600065
118158                 TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2))/           22610065
118159                 TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * 100          22620065
118160                 ON SIZE ERROR                                    22630065
118161                 MOVE 0 TO PV-MU-PCT                              22640065
118162         END-COMPUTE                                              22650065
118163         MOVE ZEROES            TO PV-ROUND-TO-TENTHS             22660065
118164         ADD PV-MU-PCT          TO PV-ROUND-TO-TENTHS ROUNDED     22670074
118165         MOVE PV-ROUND-TO-TENTHS                                  22680065
118166                                TO DTL-PMPG-TOT-FCST-MU-PCT       22690065
118170         MOVE PC-PERCENT-SIGN   TO DTL-PMPG-FCST-PCT-SIGN         22700097
118172     END-IF.                                                      22710065
118173                                                                  22720065
118174     MOVE 1                        TO PV-ADVANCE-LINES.           22730065
118175     ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                22740065
118176     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         22750065
118177     MOVE DETAIL-PMPG-TOTALS       TO PV-RPT-LINE.                22760065
118178     PERFORM 8200-WRITE-RPT-LINE.                                 22770065
118179                                                                  22780065
118180*3160-EXIT.                                                       22790065
118181 EJECT.                                                           22800065
118182                                                                  22810065
118183*----------------------------------------------------------       22820065
118184* 3200-CHECK-MAX-LINE-CNT.                                        22830065
118185*     CHECKS TO SEE IF IT HAS REACHED THE MAXIMUM AMOUNT          22840065
118190*     OF LINES FOR THE PAGE. WRITES OUT ALL HEADERS.              22850065
118191*----------------------------------------------------------       22860065
118192 3200-CHECK-MAX-LINE-CNT.                                         22870065
118193                                                                  22880065
118194     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             22890065
118195         PERFORM 3500-PROCESS-PAGE-HEADER                         22900065
118196         PERFORM 3400-PROCESS-DETAIL-HEADER                       22910065
118197         MOVE 1                  TO PV-ADVANCE-LINES              22920065
118198         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   22930065
118199     END-IF.                                                      22940065
118200                                                                  22950065
118300*3200-EXIT.                                                       22960065
118301 EJECT.                                                           22970065
118302                                                                  22980065
118303*----------------------------------------------------------       22990065
118304* 3300-CHECK-LNE-CNT-FOR-TTLS.                                    23000065
118305*     CHECKS TO SEE IF IT HAS REACHED THE MAXIMUM AMOUNT          23010065
118306*     OF LINES FOR THE PAGE. WRITES OUT ALL HEADERS.              23020065
118307*----------------------------------------------------------       23030065
118308 3300-CHECK-LNE-CNT-FOR-TTLS.                                     23040065
118309                                                                  23050065
118310     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             23060065
118311         PERFORM 3500-PROCESS-PAGE-HEADER                         23070065
118312         IF PS-BLANK-LINE                                         23080065
118313            MOVE 1                  TO PV-ADVANCE-LINES           23090065
118314            ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                23100065
118315         ELSE                                                     23110065
118316            MOVE 2                  TO PV-ADVANCE-LINES           23120065
118317            ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                23130065
118318     END-IF.                                                      23140065
118319                                                                  23150065
118320*3300-EXIT.                                                       23160065
118321 EJECT.                                                           23170065
118322                                                                  23180065
118323*----------------------------------------------------------       23190065
118324* 3400-PROCESS-DETAIL-HEADER.                                     23200065
118325*     PROCESS REPORT DETAIL HEADER LINES.                         23210065
118326*----------------------------------------------------------       23220065
118327 3400-PROCESS-DETAIL-HEADER.                                      23230065
118328                                                                  23240065
118329     MOVE SPACES                 TO DTL-HDR-01-PAGE.              23250065
118330     EVALUATE TRUE                                                23260065
118331         WHEN PM100-AD-PG-NBR NOT = 0 AND                         23270065
118332              PM100-PROMO-ITM-ADV-IND = 'Y'                       23280065
118333              MOVE PC-PROMO-ITEMS-ON-PAGE                         23290065
118334                                 TO DTL-HDR-01-PM-ITM-PAGE-TITLE  23300065
118335              MOVE PM100-AD-PG-NBR                                23310065
118336                                 TO DTL-HDR-01-PM-ITM-PAGE-NBR    23320065
118337              SET PS-PAGE-SECTION-TTL TO TRUE                     23330065
118338              SET PS-ADV-PROMO-TTL    TO TRUE                     23340065
PGNBR          WHEN PM100-AD-PG-NBR = 0 AND                             23341099
PGNBR               PM100-PROMO-ITM-ADV-IND = 'Y'                       23342099
PGNBR               MOVE PC-PROMO-ITEMS-NO-PAGE                         23343099
PGNBR                                  TO DTL-HDR-01-HEADING-TITLE      23344099
PGNBR               SET PS-ADV-NOPGE-TTL    TO TRUE                     23345099
118339         WHEN PM100-AD-PG-NBR = 0 AND                             23350065
118340              PM100-PROMO-ITM-ADV-IND = 'N'                       23360065
118341              MOVE PC-PROMO-ITEMS-UNADV                           23370065
118342                                 TO DTL-HDR-01-HEADING-TITLE      23380065
118343              SET PS-UNADV-PROMO-TTL  TO TRUE                     23390065
118344         WHEN OTHER                                               23400065
118345              MOVE PC-PROMO-ITEMS-ADMIN                           23410065
118346                                 TO DTL-HDR-01-HEADING-TITLE      23420065
118347              SET PS-ADMIN-TIER-TTL   TO TRUE                     23430065
118348     END-EVALUATE.                                                23440065
118349                                                                  23450065
118350     MOVE 2                      TO PV-ADVANCE-LINES              23460065
118351                                    PV-SAVE-LINE-AMT.             23470065
118352     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  23480065
118353     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             23490065
118354         PERFORM 3500-PROCESS-PAGE-HEADER                         23500065
118355         MOVE PV-SAVE-LINE-AMT   TO PV-ADVANCE-LINES              23510065
118356         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   23520065
118357     END-IF.                                                      23530065
118358     MOVE DETAIL-HEADER-01       TO PV-RPT-LINE.                  23540065
118359     PERFORM 8200-WRITE-RPT-LINE.                                 23550065
118360                                                                  23560065
118361*3400-EXIT.                                                       23570065
118362 EJECT.                                                           23580065
118363                                                                  23590065
118364*----------------------------------------------------------       23600065
118365* 3500-PROCESS-PAGE-HEADER.                                       23610065
118366*     PROCESS REPORT PAGE HEADERS.                                23620065
118367*----------------------------------------------------------       23630065
118368 3500-PROCESS-PAGE-HEADER.                                        23640065
118369                                                                  23650065
118370     MOVE ZEROES                 TO PV-LINE-CNT.                  23660065
118371     ADD 1                       TO PV-PAGE-CNT.                  23670065
118372     MOVE PV-PAGE-CNT            TO DP250O-PAGE-NUMBER.           23680065
118373     MOVE 1                      TO DP250O-REPORT-NUMBER.         23690065
118374                                                                  23700065
118375     MOVE DP250O-STANDRD-HEADER-250-COLS                          23710065
118376                                 TO PV-RPT-LINE.                  23720065
118377     PERFORM 8100-WRITE-SLS-RPT-NEW-PAGE.                         23730065
118378                                                                  23740065
118379     MOVE HEADER-01              TO PV-RPT-LINE.                  23750065
118380     MOVE 2                      TO PV-ADVANCE-LINES.             23760065
118381     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  23770065
118382     PERFORM 8200-WRITE-RPT-LINE.                                 23780065
118383                                                                  23790065
118384     MOVE HEADER-02              TO PV-RPT-LINE.                  23800065
118385     MOVE 1                      TO PV-ADVANCE-LINES.             23810065
118386     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  23820065
118387     PERFORM 8200-WRITE-RPT-LINE.                                 23830065
118388                                                                  23840065
118389     MOVE HEADER-03              TO PV-RPT-LINE.                  23850065
118390     MOVE 1                      TO PV-ADVANCE-LINES.             23860065
118391     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  23870065
118392     PERFORM 8200-WRITE-RPT-LINE.                                 23880065
118393                                                                  23890065
118399     MOVE HEADER-04              TO PV-RPT-LINE.                  23900065
118400     MOVE 2                      TO PV-ADVANCE-LINES.             23910065
118401     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  23920065
118402     PERFORM 8200-WRITE-RPT-LINE                                  23930065
118403                                                                  23940065
118404     MOVE HEADER-05              TO PV-RPT-LINE.                  23950065
118405     MOVE 1                      TO PV-ADVANCE-LINES.             23960065
118410     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  23970065
118411     PERFORM 8200-WRITE-RPT-LINE.                                 23980065
118412                                                                  23990065
118413*3500-EXIT.                                                       24000065
118414 EJECT.                                                           24010065
118415                                                                  24020065
118416*----------------------------------------------------------       24030065
118417* 8000-READ-SALES-RESULTS.                                        24040065
118418*     READ SALES RESULTS INPUT RECORDS.                           24050065
118419*----------------------------------------------------------       24060065
118420 8000-READ-SALES-RESULTS.                                         24070065
118430                                                                  24080065
118431     READ PROMO-ITM-SUMM-FILE INTO PM100-PROMO-ITM-SUMM           24090065
118432          AT END                                                  24100065
PGNBR              SET PS-EOF-SALES-RESULTS TO TRUE.                    24110099
PGNBR      EVALUATE TRUE                                                24111099
PGNBR         WHEN PM100-PROMO-ITM-ADV-IND  = 'Y' AND                   24112099
PGNBR              PM100-AD-PG-NBR = 0                                  24113099
PGNBR              SET PS-ADVNOPG-FLAG TO TRUE                          24114099
PGNBR         WHEN PM100-PROMO-ITM-ADV-IND  = 'Y' AND                   24115099
PGNBR              PM100-AD-PG-NBR > 0                                  24116099
PGNBR              SET PS-ADVPG-FLAG TO TRUE                            24117099
PGNBR         WHEN PM100-PROMO-ITM-ADV-IND  = 'N'                       24118099
PGNBR              SET PS-NOADV-FLAG TO TRUE                            24119099
PGNBR         WHEN OTHER                                                24119199
PGNBR              CONTINUE                                             24119299
PGNBR      END-EVALUATE                                                 24119399
PGNBR                                                                   24119499
PGNBR      IF PS-HOLD-REC-TYPE-FLAG NOT = 0                             24119599
PGNBR         IF PS-REC-TYPE-FLAG NOT = PS-HOLD-REC-TYPE-FLAG           24119699
PGNBR            EVALUATE PS-HOLD-REC-TYPE-FLAG                         24119799
PGNBR               WHEN  '1'                                           24119899
PGNBR                     SET PS-EOF-ADVNOPG TO TRUE                    24119999
PGNBR               WHEN  '2'                                           24120099
PGNBR                     SET PS-EOF-ADVPG TO TRUE                      24120199
PGNBR               WHEN  '3'                                           24120299
PGNBR                     SET PS-EOF-NOADV TO TRUE                      24120399
PGNBR               WHEN  OTHER                                         24120499
PGNBR                     CONTINUE                                      24120599
PGNBR            END-EVALUATE                                           24120699
PGNBR         END-IF                                                    24120799
PGNBR      END-IF                                                       24120899
PGNBR                                                                   24120999
PGNBR      MOVE PS-REC-TYPE-FLAG TO  PS-HOLD-REC-TYPE-FLAG.             24121099
PGNBR *    END-READ.                                                    24122099
118435                                                                  24130065
118436*8000-EXIT.                                                       24140065
118437 EJECT.                                                           24150065
118438                                                                  24160065
118439*----------------------------------------------------------       24170065
118440* 8100-WRITE-SLS-RPT-NEW-PAGE.                                    24180065
118441*     WRITES NEW PAGE.                                            24190065
118442*----------------------------------------------------------       24200065
118443 8100-WRITE-SLS-RPT-NEW-PAGE.                                     24210065
118444                                                                  24220065
118445     WRITE PROMO-ITM-SUMM-RPT-LINE                                24230065
118446           FROM PV-RPT-LINE                                       24240065
118447           AFTER ADVANCING PAGE.                                  24250065
118448                                                                  24260065
118449     ADD 2            TO PV-LINE-CNT.                             24270065
118450                                                                  24280065
118451*8100-EXIT.                                                       24290065
118452 EJECT.                                                           24300065
118453                                                                  24310065
118454*----------------------------------------------------------       24320065
118455* 8200-WRITE-RPT-LINE.                                            24330065
118456*     WRITES OUT A LINE ON THE REPORT.                            24340065
118457*----------------------------------------------------------       24350065
118458 8200-WRITE-RPT-LINE.                                             24360065
118459                                                                  24370065
118460     WRITE PROMO-ITM-SUMM-RPT-LINE                                24380065
118461           FROM PV-RPT-LINE                                       24390065
118462           AFTER ADVANCING PV-ADVANCE-LINES.                      24400065
118463                                                                  24410065
118464*8200-EXIT.                                                       24420065
118465 EJECT.                                                           24430065
118466                                                                  24440065
118479*----------------------------------------------------------       24450065
118480* 9000-ADD-PARENTH-TO-NEG-PCT.                                    24460065
118481*     PUTS PARENTHESES AROUND A NEGATIVE PERCENT FOR THE          24470065
118482*     VOLUME PERCETN CHANGE FIELD.                                24480065
118483*----------------------------------------------------------       24490065
118484 9000-ADD-PARENTH-TO-NEG-PCT.                                     24500065
118485                                                                  24510065
118486     INITIALIZE PV-ROUND-VOL-PCT                                  24520065
118487                PV-TRUNCAT-VOL-PCT                                24530065
118488                PV-NUM-VOL-PCT                                    24540065
118489                PV-FINAL-VOL-PCT                                  24550065
118490                PV-SEP-VOL-PCT                                    24560065
118491                PA-CNT-SPACES.                                    24570065
118492                                                                  24580065
118493     MOVE PV-ROUND-TO-TENTHS      TO PV-ROUND-VOL-PCT.            24590065
118494     MOVE PV-ROUND-VOL-PCT        TO PV-TRUNCAT-VOL-PCT.          24600065
118495     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-NUM-VOL-PCT.              24610065
118496     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-SEP-VOL-PCT.              24620065
118497     INSPECT PV-CHAR-VOL-PCT-1 REPLACING                          24630065
118498             LEADING ZERO BY " ".                                 24640065
118499     INSPECT PV-CHAR-VOL-PCT-1                                    24650065
118500            TALLYING PA-CNT-SPACES FOR ALL " ".                   24660065
118501     EVALUATE TRUE                                                24670065
118502         WHEN PA-CNT-SPACES = 0                                   24680065
118503              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-1         24690065
118504              MOVE PV-SEP-VOL-PCT-1 TO PV-FINAL-VOL-PCT-2         24700065
118505              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         24710065
118506              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         24720065
118507              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         24730065
118508              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         24740065
118509         WHEN PA-CNT-SPACES = 1                                   24750065
118510              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-2         24760065
118511              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         24770065
118512              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         24780065
118513              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         24790065
118514              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         24800065
118515         WHEN PA-CNT-SPACES = 2                                   24810065
118516              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-3         24820065
118517              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         24830065
118518              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         24840065
118519              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         24850065
118520         WHEN PA-CNT-SPACES = 3                                   24860065
118521              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-4         24870065
118522              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         24880065
118523              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         24890065
118524         WHEN PA-CNT-SPACES = 4                                   24900065
118525              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-5         24910065
118526              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         24920065
118527     END-EVALUATE.                                                24930065
118528     MOVE PC-BACK-PAR               TO PV-FINAL-VOL-PCT-7.        24940065
118529                                                                  24950065
118530                                                                  24960065
118531*9000-EXIT.                                                       24970065
118532 EJECT.                                                           24980065
118533                                                                  24990065
118534*----------------------------------------------------------       25000065
118535* 9100-CALENDAR-ROUTINE.                                          25010065
118536*     CALLS THE DATE ROUTINE WITH SPECIFIED PARAMETERS.           25020065
118537*----------------------------------------------------------       25030065
118538 9100-CALENDAR-ROUTINE.                                           25040065
118539                                                                  25050065
118540     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          25060065
118541                                             DPG53 DPG54          25070065
118542                                             DPG55 DPG56.         25080065
118543     EVALUATE TRUE                                                25090065
118544         WHEN DPG54-NO-ERROR                                      25100065
118545             CONTINUE                                             25110065
118546         WHEN DPG54-WARNING-ERROR                                 25120065
118547             DISPLAY '** WARNING - PROGRAM '                      25130065
118548                      PC-CURRENT-PROGRAM-NAME ' **'               25140065
118549             DISPLAY '** 9100-CALENDAR-ROUTINE'                   25150065
118550             DISPLAY '** CALL TO DPKUT500 RETURNED WARNING ERROR' 25160065
118551             DISPLAY '** DPG54-ERROR-MESSAGE: '                   25170065
118560             DISPLAY '** ' DPG54-ERROR-MESSAGE                    25180065
118570             DISPLAY '** DPG51: ' DPG51                           25190065
118580             DISPLAY '** DPG52: ' DPG52                           25200065
118590             DISPLAY '** PLEASE INVESTIGATE FURTHER **'           25210065
118600         WHEN DPG54-SEVERE-ERROR                                  25220065
118700             DISPLAY '** ABEND - PROGRAM '                        25230065
118800                      PC-CURRENT-PROGRAM-NAME ' **'               25240065
118900             DISPLAY '** 9100-CALENDAR-ROUTINE'                   25250065
119000             DISPLAY '** CALL TO DPKUT500 RETURNED SEVERE ERROR'  25260065
119100             IF DPG54-CALENDAR-TYPE-INVALID                       25270065
119200                DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'          25280065
119300                DISPLAY '** DPG51-CALENDAR-TYPE: '                25290065
119400                         DPG51-CALENDAR-TYPE                      25300065
119500             END-IF                                               25310065
119600             IF DPG54-DATE-INVALID                                25320065
119700                DISPLAY '** DPG54-DATE-INVALID'                   25330065
119800                DISPLAY '** DPG52-LK-DATE-INPUT: '                25340065
119900                         DPG52-LK-DATE-INPUT                      25350065
120000             END-IF                                               25360065
120100             IF DPG54-INCR-DECR-INVALID                           25370065
120200                DISPLAY '** DPG54-INCR-DECR-INVALID'              25380065
120300                DISPLAY '** DPG51-INCREMENT-DECREMENT-FLAG: '     25390065
120400                         DPG51-INCREMENT-DECREMENT-FLAG           25400065
120500             END-IF                                               25410065
120600             MOVE DPG54-ERROR-MESSAGE                             25420065
120700                                 TO PV-OPERATION-MSG-2            25430065
120800             SET ABEND-4019-DATE-ROUTINE-ERROR TO TRUE            25440065
120900             PERFORM 9800-ABEND                                   25450065
121000     END-EVALUATE.                                                25460065
121100                                                                  25470065
121200*9100-EXIT.                                                       25480065
121300 EJECT.                                                           25490065
121400                                                                  25500065
121500*----------------------------------------------------------       25510065
121600* 9800-ABEND.                                                     25520065
121700*     PERFORMS A NON-SQL-ABEND.                                   25530065
121800*----------------------------------------------------------       25540065
121900 9800-ABEND.                                                      25550065
122000                                                                  25560065
122100     DISPLAY '** ABEND           **'.                             25570065
122200     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  25580065
122300     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        25590065
122400     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       25600065
122500     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       25610065
122600                                                                  25620065
122700     CALL 'ILBOABN0' USING ABEND-CODE.                            25630065
