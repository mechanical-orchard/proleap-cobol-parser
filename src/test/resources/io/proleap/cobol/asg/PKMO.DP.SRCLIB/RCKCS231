000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    RCKCS231.                                         00040000
000500 AUTHOR.        M. FURLICK - STRATAGEM.                           00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  03/94.                                            00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    E231 - STORE VERIFICATION                                  * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES A LIST OF THE LINES FOR A SPECIFIC  * 00130000
001400*    STORE.  THE RECEIVED QUANTITIES MAY BE UPDATED.            * 00140000
001500*                                                               * 00150000
001600*    DC-XXX: SET PURITM AND PURCHS BACK TO 'IP' IF:             * 00160000
001700*               THE CURRENT STATUS IS 'CM' AND                  * 00170000
001800*                   RECDIS AP-VERIFY-COUNT HAS BEEN ADJUSTED    * 00180000
001900*                   AND IS NOW LESS THAN PURITM UNIT QUANTITY.  * 00190000
002000*            BY M. FURLICK 7/02/94.                             * 00200000
002100*                                                               * 00210000
002200*---------------------------------------------------------------* 00220000
002210* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00221049
002220* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00222050
002230* MAKING THE CALL DYNAMIC VS STATIC.                              00223050
002240*---------------------------------------------------------------* 00224050
002300/                                                                 00230000
002400 ENVIRONMENT DIVISION.                                            00240000
002500                                                                  00250000
002600 DATA DIVISION.                                                   00260000
002700                                                                  00270000
002800 WORKING-STORAGE SECTION.                                         00280000
002900                                                                  00290000
003000 01  PA-PROGRAM-ACCUMULATORS.                                     00300050
003100     05  PA-FCSE-QTY                  PIC S9(9) VALUE +0.         00310008
003200     05  PA-ODD-QTY                   PIC S9(9) VALUE +0.         00320008
003300     05  PA-TOT-QTY                   PIC S9(9) VALUE +0.         00330008
003400     05  PA-UPDATE-TO-QTY             PIC S9(9) VALUE +0.         00340008
003500     05  PA-UPDATE-FROM-QTY           PIC S9(9) VALUE +0.         00350008
003600     05  PA-UPDATE-DIFF-QTY           PIC S9(9) VALUE +0.         00360008
003700                                                                  00370008
003800 01  PC-PROGRAM-CONSTANTS.                                        00380008
003900     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00390008
004000                                                    'RC231A  '.   00400008
004100     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00410008
004200                                                    'RCKM231 '.   00420008
004300     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00430008
004400                                                    'RCKCS231'.   00440008
004500     05  PC-AUDIT-RTN                   PIC  X(08)  VALUE         00450008
004600                                                    'RCKCS290'.   00460008
004700     05  PC-AUDIT-RTN-LENGTH            PIC S9(04)  VALUE  +300   00470008
004800                                                    COMP SYNC.    00480008
004900     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00490008
005000     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00500008
005100     05  PC-VRFY-ADJ-QUEUE-SEQ          PIC 9     VALUE 6.        00510008
005200     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +12     00520000
005300                                                    COMP SYNC.    00530000
005400     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00540000
005500                                                    COMP SYNC.    00550000
005600     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00560000
005700                                                    +1000000      00570000
005800                                                    COMP-3.       00580000
005900     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00590000
006000                                                    COMP SYNC.    00600000
006100     05  PC-9999                        PIC S9(04)  VALUE 9999    00610000
006200                                                    COMP.         00620000
006300     05  PC-01                       PIC  X(02)  VALUE '01'.      00630000
006400     05  PC-4                        PIC  9(01)  VALUE 4.         00640000
006500     05  PC-5                        PIC  9(01)  VALUE 5.         00650000
006600     05  PC-A                        PIC  X(01)  VALUE 'A'.       00660000
006700     05  PC-I                        PIC  X(01)  VALUE 'I'.       00670000
006800     05  PC-AC                       PIC  X(02)  VALUE 'AC'.      00680000
006900     05  PC-CA                       PIC  X(02)  VALUE 'CA'.      00690000
007000     05  PC-CB                       PIC  X(02)  VALUE 'CB'.      00700000
007100     05  PC-CM                       PIC  X(02)  VALUE 'CM'.      00710000
007200     05  PC-RV                       PIC  X(02)  VALUE 'RV'.      00720000
007300     05  PC-CP                       PIC  X(02)  VALUE 'CP'.      00730000
007400     05  PC-P2                       PIC  X(02)  VALUE 'P2'.      00740000
007500     05  PC-VE                       PIC  X(02)  VALUE 'VE'.      00750000
007600     05  PC-P2L                      PIC  X(08)  VALUE 'P2L'.     00760000
007700     05  PC-CASE                     PIC  X(08)  VALUE 'CASE'.    00770000
007800     05  PC-P2LCASE                  PIC  X(08)  VALUE 'P2L/CASE'.00780000
007900     05  PC-MANUAL                   PIC  X(08)  VALUE 'MANUAL'.  00790000
008000     05  PC-DISPLAY-PO                PIC 9(8)   VALUE ZEROS.     00800000
008100     05  PC-DISPLAY-RCVR              PIC 9(4)   VALUE ZEROS.     00810023
008200     05  PC-DISPLAY-LINE              PIC 9(4)   VALUE ZEROS.     00820023
008300     05  PC-DISPLAY-STORE             PIC 9(4)   VALUE ZEROS.     00830023
008400     05  PC-DISPLAY-OPER              PIC 9(4)   VALUE ZEROS.     00840023
008500     05  PC-DISPLAY-SQL-CODE          PIC 9999-  VALUE ZEROS.     00850023
008600     05  PC-DISPLAY-CICS-RESP         PIC 999999999-              00860023
008700                                                 VALUE ZEROS.     00870023
008800     05  PC-DB2-DEFAULT-TMST          PIC X(26)  VALUE            00880036
008900         '9999-09-09-09.09.09.999999'.                            00890036
009000                                                                  00900023
009100     05  PC-AUTOVE-MODULE           PIC  X(08) VALUE 'RCKUT127'.  00910023
009200     05  PC-AUTOVE-MODULE-LENGTH    PIC S9(04) VALUE  +400        00920023
009300                                                    COMP SYNC.    00930023
009400                                                                  00940000
009500     05  PC-TSYMSG-NUMBERS.                                       00950000
009600         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00960000
009700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00970000
009800         10  PC-TSYMSG-00045            PIC 9(5)  VALUE 00045.    00980000
009900*            INVALID FUNCTION KEY                                 00990000
010000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01000000
010100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01010000
010200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01020000
010300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01030000
010400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01040000
010500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01050000
010600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01060000
010700         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01070000
010800         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01080000
010900         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01090000
011000         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01100000
011100         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01110000
011200         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01120000
011300         10  PC-TSYMSG-01264          PIC 9(5)  VALUE 01264.      01130000
011400*            ADJUSTMENT WILL CREATE PACK-BY-STORE OVERAGE,        01140000
011500*            PRESS F2 TO CONFIRM                                  01150000
011600*                                                                 01160000
011700         10  PC-TSYMSG-01817          PIC 9(5)  VALUE 01817.      01170000
011800*            F2 TO CONFIRM THE UPDATE OF A STORE WITH A SOURCE    01180000
011900*            OTHER THAN MANUAL.                                   01190000
012000         10  PC-TSYMSG-02773            PIC  9(05)  VALUE 02773.  01200000
012100*         SMOOTHING EXISTS FOR STORE - UNABLE TO UPDATE UNIT QTY  01210000
012200*                                                                 01220000
012300         10  PC-TSYMSG-02875          PIC 9(05)  VALUE 02875.     01230000
012400*            PROBLEM ENCOUNTED WITH UNITS WORKED PROCESSING -     01240000
012500*            CONTACT HELP DESK                                    01250000
012600*                                                                 01260000
012700         10  PC-TSYMSG-03180          PIC 9(05)  VALUE 03180.     01270014
012800*            AUTO VERIFICATION PURCHASE ORDER - CANNOT UPDATE     01280014
012900*            STORE ALLOCATIONS                                    01290014
013000         10  PC-TSYMSG-03233            PIC  9(05)  VALUE 03233.  01300036
013100*                                                                 01310014
013200*----------------------------------------------------------------*01320014
013300* INCLUDED PROGRAM CONSTANTS PC-000 AND PC-999.      WR # 21361  *01330014
013400*----------------------------------------------------------------*01340014
013500     05  PC-000                       PIC X(03) VALUE '000'.      01350014
013600     05  PC-999                       PIC X(03) VALUE '999'.      01360014
013700*----------------------------------------------------------------*01370014
013800* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01380014
013900*----------------------------------------------------------------*01390014
014000 01  PS-PROGRAM-SWITCHES.                                         01400014
014100     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01410000
014200         88  PS-NO-ERROR                            VALUE 'Y'.    01420000
014300         88  PS-ERROR                               VALUE 'N'.    01430000
014400     05  PS-STORE-REC-SW                PIC  X(01)  VALUE 'N'.    01440000
014500         88  PS-STORE-REC                           VALUE 'Y'.    01450000
014600         88  PS-NO-STORE-REC                        VALUE 'N'.    01460000
014700     05  PS-DATA-OK-SW                  PIC  X(01)  VALUE 'N'.    01470000
014800         88  PS-DATA-OK                             VALUE 'Y'.    01480000
014900         88  PS-DATA-NOT-OK                         VALUE 'N'.    01490000
015000     05  PS-RECITM-UPDATE-SW            PIC  X(01)  VALUE 'N'.    01500000
015100         88  PS-RECITM-UPDATED                      VALUE 'Y'.    01510000
015200         88  PS-RECITM-NOT-UPDATED                  VALUE 'N'.    01520000
015300     05  PS-RECDVS-SW                   PIC  X(01)  VALUE 'N'.    01530000
015400         88  PS-MORE-RECDVS                         VALUE 'Y'.    01540000
015500         88  PS-NO-MORE-RECDVS                      VALUE 'N'.    01550000
015600     05  PS-ALL-LINES-PROTECTED-SW      PIC  X(01)  VALUE 'N'.    01560000
015700         88  PS-ALL-LINES-PROTECTED                 VALUE 'Y'.    01570000
015800         88  PS-ALL-LINES-NOT-PROTECTED             VALUE 'N'.    01580000
015900     05  PS-UPDATE-SW                 PIC  X    VALUE 'N'.        01590000
016000         88  PS-NO-UPDATES-DONE                 VALUE 'N'.        01600000
016100         88  PS-UPDATES-DONE                    VALUE 'Y'.        01610000
016200     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        01620000
016300         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        01630000
016400         88  PS-NEXT-SCREEN                     VALUE 'Y'.        01640000
016500     05  PS-SMOOTHED-STORE-SW         PIC  X    VALUE 'N'.        01650000
016600         88  PS-NO-SMOOTHED-STORE               VALUE 'N'.        01660000
016700         88  PS-SMOOTHED-STORE                  VALUE 'Y'.        01670000
016800     05  PS-UNITS-WORKED-ERROR-SW     PIC X(01)  VALUE 'N'.       01680000
016900         88  PS-UNITS-WORKED-ERROR               VALUE 'Y'.       01690000
017000         88  PS-NO-UNITS-WORKED-ERROR            VALUE 'N'.       01700000
017100     05  PS-FIRST-TIME-UPDATE-SW      PIC X(01)  VALUE 'Y'.       01710000
017200         88 PS-FIRST-TIME-UPDATE                 VALUE 'Y'.       01720000
017300         88 PS-NOT-FIRST-TIME-UPDATE             VALUE 'N'.       01730000
017400     05  PS-TRECDIS-VE-UPDATE-SW       PIC X(01)  VALUE 'N'.      01740000
017500         88  PS-TRECDIS-VE-UPDATE-DONE            VALUE 'Y'.      01750000
017600         88  PS-TRECDIS-VE-UPDATE-NOT-DONE        VALUE 'N'.      01760000
017700     05  PS-CHECK-FOR-RMS-PO-SW        PIC X(01)  VALUE 'N'.      01770000
017800         88  PS-CHECKED-FOR-RMS-PO                VALUE 'Y'.      01780000
017900     05  PS-RMS-PO-SW                  PIC X(01)  VALUE 'N'.      01790008
018000         88  PS-RMS-PO                            VALUE 'Y'.      01800000
018100         88  PS-NO-RMS-PO                         VALUE 'N'.      01810000
018200     05  PS-PBS-ERROR-CARTONS-SW       PIC X(01)  VALUE 'N'.      01820039
018300         88  PS-PBS-ERROR-CARTONS-NO              VALUE 'N'.      01830039
018400         88  PS-PBS-ERROR-CARTONS-YES             VALUE 'Y'.      01840039
018500     05  PS-ACTIVE-PBS-UCC128-SW       PIC X(01)  VALUE 'N'.      01850039
018600         88  PS-ACTIVE-PBS-UCC128-NO              VALUE 'N'.      01860039
018700         88  PS-ACTIVE-PBS-UCC128-YES             VALUE 'Y'.      01870039
018800*----------------------------------------------------------------*01880039
018900*  INCLUDED PROGRAM SWITCHES FOR XLKUT001       **   WR # 21361  *01890039
019000*----------------------------------------------------------------*01900039
019100     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        01910039
019200         88  PS-CALL-API-NO                     VALUE 'N'.        01920039
019300         88  PS-CALL-API-YES                    VALUE 'Y'.        01930039
019400*----------------------------------------------------------------*01940039
019500* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01950039
019600*----------------------------------------------------------------*01960039
019700*                                                                 01970039
019800 01  DK-DB2-KEYS.                                                 01980039
019900     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    01990039
020000     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    02000039
020100     05  DK-STR-NBR                   PIC S9(4) COMP VALUE +0.    02010039
020200*                                                                 02020039
020300 01  PV-PROGRAM-VARIABLES.                                        02030039
020400     05  PV-SUB                         PIC S9(04)  VALUE +0      02040039
020500                                                    COMP SYNC.    02050039
020600     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02060039
020700                                                    COMP SYNC.    02070039
020800     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      02080039
020900                                                    COMP SYNC.    02090039
021000     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02100039
021100                                                    COMP-3.       02110039
021200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02120039
021300                                                    COMP-3.       02130039
021400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02140039
021500                                                    COMP-3.       02150039
021600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02160039
021700                                                    COMP-3.       02170039
021800     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02180039
021900                                                    COMP SYNC.    02190039
022000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02200039
022100                                                    COMP SYNC.    02210039
022200     05  PV-ITEM                        PIC S9(04)  VALUE +0      02220039
022300                                                    COMP SYNC.    02230039
022400     05  PV-VRFY-ITEM                   PIC S9(4) VALUE ZERO      02240039
022500                                                    COMP SYNC.    02250039
022600     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02260039
022700                                                    COMP SYNC.    02270039
022800     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02280039
022900                                                    COMP SYNC.    02290039
023000     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02300039
023100                                                    COMP SYNC.    02310039
023200     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02320039
023300                                                    COMP SYNC.    02330039
023400     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02340039
023500                                                    COMP SYNC.    02350039
023600     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02360039
023700                                                    COMP SYNC.    02370039
023800     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02380039
023900                                                    COMP SYNC.    02390039
024000     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02400039
024100                                                    COMP SYNC.    02410039
024200     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02420039
024300                                                    COMP SYNC.    02430039
024400     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02440039
024500                                                    COMP SYNC.    02450039
024600     05  PV-ORD-LNE-NBR                 PIC S9(09)  COMP VALUE 0. 02460039
024700     05  PV-START-ITEM-REQUEST          PIC  X(05).               02470039
024800     05  PV-DB2-COUNT                   PIC S9(9)   VALUE +0      02480039
024900                                                    COMP-3.       02490039
025000     05  PV-DEPT-NBR-KEY                PIC S9(4)   VALUE +0      02500000
025100                                                    COMP-3.       02510000
025200     05  PV-DEPT-NBR-X.                                           02520000
025300         10  PV-DEPT-NBR                PIC  9(03).               02530000
025400                                                                  02540008
025500     05  PV-V1-MSG.                                               02550000
025600         10  FILLER                  PIC X(5)    VALUE 'ACTL '.   02560000
025700         10  FILLER                  PIC X(4)    VALUE 'P2L/'.    02570000
025800         10  PV-V1-P2L-UNITS         PIC 99999   VALUE 0.         02580000
025900         10  FILLER                  PIC X(7)    VALUE '  CASE/'. 02590000
026000         10  PV-V1-CASE-UNITS        PIC 99999   VALUE 0.         02600000
026100     05  PV-V2-MSG.                                               02610000
026200         10  FILLER                  PIC X(5)    VALUE 'ACTL '.   02620000
026300         10  FILLER                  PIC X(4)    VALUE 'P2L/'.    02630000
026400         10  PV-V2-P2L-UNITS         PIC 99999   VALUE 0.         02640000
026500     05  PV-V3-MSG.                                               02650000
026600         10  FILLER                  PIC X(5)    VALUE 'ACTL '.   02660000
026700         10  FILLER                  PIC X(5)    VALUE 'CASE/'.   02670000
026800         10  PV-V3-CASE-UNITS        PIC 99999   VALUE 0.         02680000
026900     05  PV-V4-MSG.                                               02690000
027000         10  FILLER                  PIC X(5)    VALUE 'ACTL '.   02700000
027100         10  FILLER                  PIC X(7)    VALUE 'MANUAL/'. 02710000
027200         10  PV-V4-MANUAL-UNITS      PIC 99999   VALUE 0.         02720000
027300     05  PV-NV1-MSG.                                              02730000
027400         10  FILLER                  PIC X(5)    VALUE 'PKSL '.   02740000
027500         10  FILLER                  PIC X(4)    VALUE 'P2L/'.    02750000
027600         10  PV-NV1-P2L-UNITS        PIC 99999   VALUE 0.         02760000
027700         10  FILLER                  PIC X(7)    VALUE '  CASE/'. 02770000
027800         10  PV-NV1-CASE-UNITS       PIC 99999   VALUE 0.         02780000
027900     05  PV-NV2-MSG.                                              02790000
028000         10  FILLER                  PIC X(5)    VALUE 'PKSL '.   02800000
028100         10  FILLER                  PIC X(4)    VALUE 'P2L/'.    02810000
028200         10  PV-NV2-P2L-UNITS        PIC 99999   VALUE 0.         02820000
028300     05  PV-NV3-MSG.                                              02830000
028400         10  FILLER                  PIC X(5)    VALUE 'PKSL '.   02840000
028500         10  FILLER                  PIC X(5)    VALUE 'CASE/'.   02850000
028600         10  PV-NV3-CASE-UNITS       PIC 99999   VALUE 0.         02860000
028700     05  PV-NV4-MSG.                                              02870000
028800         10  FILLER                  PIC X(5)    VALUE 'PKSL '.   02880000
028900         10  FILLER                  PIC X(7)    VALUE 'MANUAL/'. 02890000
029000         10  PV-NV4-MANUAL-UNITS     PIC 99999   VALUE 0.         02900000
029100     05  PV-CLASS-SKU.                                            02910000
029200         10  PV-CS-CLASS                PIC X(02).                02920000
029300         10  FILLER                     PIC X(01)   VALUE SPACE.  02930000
029400         10  PV-CS-SKU                  PIC X(08).                02940000
029500     05  PV-WORK-QTY-X.                                           02950000
029600         10  PV-WORK-QTY                PIC 9(05).                02960000
029700     05  PV-ENT-ID                      PIC 9(08).                02970000
029800     05  PV-DB2-CURRENT-TMST            PIC X(26).                02980000
029900     05  PV-RCPT-DISTR-UPD-CDE          PIC X(01).                02990000
030000     05  PV-CURRENT-TIMESTAMP           PIC X(26).                03000000
030100     05  PV-DISPLAY-NO-ZERO             PIC Z(5).                 03010000
030200     05  PV-DISPLAY-ZERO                PIC Z(4)9.                03020000
030300     05  PV-NOT-SELECTED                PIC S9(09) VALUE +0.      03030000
030400     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 03040000
030500     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 03050000
030600     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03060000
030700                                                     COMP SYNC.   03070000
030800     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     03080000
030900                                                    COMP SYNC.    03090000
031000     05  PV-CURR-OPER-UNT-ID          PIC S9(4)  COMP             03100000
031100                                                 VALUE ZERO.      03110000
031200     05  PV-XLT00010-TYPE-CODE        PIC X(2)   VALUE SPACES.    03120032
031300         88  PV-XLT00010-TYPE-DC                 VALUE 'DC'.      03130032
031400     05  PV-PCKCS756                  PIC X(08)  VALUE 'PCKCS756'.03140000
031500     05  PV-TMST                      PIC X(26).                  03150000
031600     05  FILLER REDEFINES PV-TMST.                                03160000
031700         10  PV-CCYY                  PIC X(04).                  03170000
031800         10  FILLER                   PIC X(01).                  03180000
031900         10  PV-MM                    PIC X(02).                  03190000
032000         10  FILLER                   PIC X(01).                  03200000
032100         10  PV-DD                    PIC X(02).                  03210000
032200         10  FILLER                   PIC X(01).                  03220000
032300         10  PV-HH                    PIC X(02).                  03230000
032400         10  FILLER                   PIC X(01).                  03240000
032500         10  PV-MIN                   PIC X(02).                  03250000
032600         10  FILLER                   PIC X(01).                  03260000
032700         10  PV-SEC                   PIC X(02).                  03270000
032800         10  FILLER                   PIC X(01).                  03280000
032900         10  FILLER                   PIC X(06).                  03290000
033000                                                                  03300000
033100*----------------------------------------------------------------*03310000
033200*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.    *03320000
033300*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE            *03330000
033400*   APPLICATION-SPECIFIC COMMAREA.                               *03340000
033500*----------------------------------------------------------------*03350000
033600*----------------------------------------------------------------*03360000
033700*                                                **   WR # 21361 *03370008
033800* CHANGE THE STRUCTURE OF LQW TO MATCH WITH ASC STRUCTURE        *03380000
033900* LQW-CLASS-SKU CHANGED FROM PIC  X(06) TP PIC X(11).            *03390008
034000*----------------------------------------------------------------*03400000
034100 01  LQW-LIST-QUEUE-WORK-AREA.                                    03410000
034200     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03420000
034300     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           03430000
034400                                        INDEXED BY LQW-IDX.       03440000
034500         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03450000
034600         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03460000
034700         10  LQW-SELECTED-SW            PIC  X(01).               03470000
034800             88  LQW-SELECT                         VALUE 'S'.    03480000
034900             88  LQW-DESELECT                       VALUE ' '.    03490000
035000         10  LQW-UPDATE-SW              PIC  X(01).               03500000
035100             88  LQW-UPDATE                         VALUE 'Y'.    03510000
035200             88  LQW-UPDATE-NO                      VALUE 'N'.    03520000
035300         10  LQW-MANUAL-SW              PIC  X(01).               03530000
035400             88  LQW-MANUAL                         VALUE 'Y'.    03540000
035500             88  LQW-MANUAL-NO                      VALUE 'N'.    03550000
035600         10  LQW-ITEM-QTY               PIC  9(05).               03560000
035700         10  LQW-ORD-LNE-NBR            PIC S9(09)  COMP.         03570000
035800         10  LQW-STATUS-CDE             PIC  X(02).               03580000
035900         10  LQW-VRFD-USR-ID            PIC  X(08).               03590000
036000         10  LQW-CLASS-SKU              PIC  X(11).               03600000
036100         10  LQW-EXPTED-ITM-QTY         PIC S9(05)  COMP-3.       03610000
036200         10  LQW-ACTUAL-ITM-QTY         PIC S9(05)  COMP-3.       03620000
036300         10  LQW-VERIFY-ITM-QTY         PIC S9(05)  COMP-3.       03630000
036400         10  LQW-VERIFY-MESSAGE         PIC X(27)   VALUE SPACES. 03640000
036500         10  LQW-PACK-BY-ST-OVERAGE-SW                            03650000
036600                                      PIC X(01).                  03660000
036700             88  LQW-PACK-BY-ST-OVERAGE                           03670000
036800                                      VALUE 'Y'.                  03680000
036900             88  LQW-NO-PACK-BY-ST-OVERAGE                        03690000
037000                                      VALUE 'N'.                  03700000
037100*DC-XXX                                                           03710000
037200         10  LQW-PURITM-UNT-QTY         PIC S9(09)  COMP.         03720000
037300         10  LQW-PURITM-STATUS-CDE      PIC  X(02).               03730000
037400         10  LQW-PURCHS-STATUS-CDE      PIC  X(02).               03740000
037500         10  LQW-SEL-ZERO-SW            PIC X(01).                03750000
037600             88  LQW-SEL-ZERO-YES           VALUE 'Y'.            03760000
037700             88  LQW-SEL-ZERO-NO            VALUE 'N'.            03770000
037800         10  LQW-CAN-UPDATE-SW          PIC X(01).                03780036
037900*DC-XXX                                                           03790000
038000/                                                                 03800000
038100*----------------------------------------------------------------*03810000
038200*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        03820008
038300*----------------------------------------------------------------*03830000
038400*---------------------------------------------------------------* 03840000
038500*    RECORD LAYOUT FOR THE SELECTION TEMP STORAGE QUEUE.        * 03850000
038600*---------------------------------------------------------------* 03860000
038700                                                                  03870000
038800     COPY RCWS026.                                                03880000
038900                                                                  03890000
039000                                                                  03900008
039100******************************************************************03910008
039200*  TEMPORARY STORAGE QUEUE - STORE UNIT ADJUSTMENTS TO BE SENT    03920008
039300*  TO RMS PO BY PCKCS759.                                         03930008
039400******************************************************************03940008
039500     COPY PCWS241.                                                03950008
039600/                                                                 03960000
039700*---------------------------------------------------------------* 03970000
039800*  RECORD LAYOUT 'INSERT AUDIT MODULE'  RCKCS290                * 03980000
039900*---------------------------------------------------------------* 03990000
040000                                                                  04000000
040100     COPY RCWS031.                                                04010000
040200                                                                  04020000
040300/                                                                 04030000
040400***************************************************************** 04040012
040500*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 04050012
040600*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 04060012
040700***************************************************************** 04070012
040800     COPY RCWS040.                                                04080012
040900/                                                                 04090012
041000*---------------------------------------------------------------* 04100000
041100*    MAP LAYOUT                                                 * 04110000
041200*---------------------------------------------------------------* 04120000
041300                                                                  04130000
041400     COPY RCKM231.                                                04140000
041500*                                                                 04150000
041600*----------------------------------------------------------------*04160000
041700*                                                    WR # 21361  *04170008
041800* CHANGED THE STRUCTURE OF MR-CLASS-SKU FROM X(06) TO X(11)      *04180000
041900*----------------------------------------------------------------*04190000
042000 01  MR-OCCURS-LAYOUT                   REDEFINES  RC231AO.       04200000
042100** CHG0094517  CHANGED FILLER FROM 128 TO 129 BECAUSE OF PO EXPAND04210048
042200     05  FILLER                         PIC X(129).               04220048
042300     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          04230000
042400         10  MR-SELECTL                 PIC S9(04) COMP.          04240000
042500         10  MR-SELECTA                 PIC  X(01).               04250000
042600         10  MR-SELECTC                 PIC  X(01).               04260000
042700         10  MR-SELECTH                 PIC  X(01).               04270000
042800         10  MR-SELECTI                 PIC  X(01).               04280000
042900                                                                  04290000
043000         10  MR-ITEM-QTYL               PIC S9(04) COMP.          04300000
043100         10  MR-ITEM-QTYA               PIC  X(01).               04310000
043200         10  MR-ITEM-QTYC               PIC  X(01).               04320000
043300         10  MR-ITEM-QTYH               PIC  X(01).               04330000
043400         10  MR-ITEM-QTY-X.                                       04340000
043500             15  MR-ITEM-QTY-I          PIC  9(05).               04350000
043600                                                                  04360000
043700         10  MR-ORD-LNE-NBRL            PIC S9(04) COMP.          04370000
043800         10  MR-ORD-LNE-NBRA            PIC  X(01).               04380000
043900         10  MR-ORD-LNE-NBRC            PIC  X(01).               04390000
044000         10  MR-ORD-LNE-NBRH            PIC  X(01).               04400000
044100         10  MR-ORD-LNE-NBR-X.                                    04410000
044200             15  MR-ORD-LNE-NBR         PIC   ZZZ9.               04420000
044300                                                                  04430000
044400         10  MR-STATUS-CDEL              PIC S9(04) COMP.         04440000
044500         10  MR-STATUS-CDEA              PIC  X(01).              04450000
044600         10  MR-STATUS-CDEC              PIC  X(01).              04460000
044700         10  MR-STATUS-CDEH              PIC  X(01).              04470000
044800         10  MR-STATUS-CDE               PIC  X(02).              04480000
044900                                                                  04490000
045000         10  MR-CLASS-SKUL              PIC S9(04) COMP.          04500000
045100         10  MR-CLASS-SKUA              PIC  X(01).               04510000
045200         10  MR-CLASS-SKUC              PIC  X(01).               04520000
045300         10  MR-CLASS-SKUH              PIC  X(01).               04530000
045400         10  MR-CLASS-SKU               PIC  X(11).               04540000
045500                                                                  04550000
045600         10  MR-EXPTED-QTYL             PIC S9(04) COMP.          04560000
045700         10  MR-EXPTED-QTYA             PIC  X(01).               04570000
045800         10  MR-EXPTED-QTYC             PIC  X(01).               04580000
045900         10  MR-EXPTED-QTYH             PIC  X(01).               04590000
046000         10  MR-EXPTED-QTY-X.                                     04600000
046100             15  MR-EXPTED-QTY          PIC  ZZZZ9.               04610000
046200                                                                  04620000
046300         10  MR-ACTUAL-QTYL             PIC S9(04) COMP.          04630000
046400         10  MR-ACTUAL-QTYA             PIC  X(01).               04640000
046500         10  MR-ACTUAL-QTYC             PIC  X(01).               04650000
046600         10  MR-ACTUAL-QTYH             PIC  X(01).               04660000
046700         10  MR-ACTUAL-QTY-X.                                     04670000
046800             15  MR-ACTUAL-QTY          PIC  ZZZZ9.               04680000
046900                                                                  04690000
047000         10  MR-VERIFY-QTYL             PIC S9(04) COMP.          04700000
047100         10  MR-VERIFY-QTYA             PIC  X(01).               04710000
047200         10  MR-VERIFY-QTYC             PIC  X(01).               04720000
047300         10  MR-VERIFY-QTYH             PIC  X(01).               04730000
047400         10  MR-VERIFY-QTY-X.                                     04740000
047500             15  MR-VERIFY-QTY          PIC  ZZZZ9.               04750000
047600                                                                  04760000
047700         10  MR-VERIFY-MSGL             PIC S9(04) COMP.          04770000
047800         10  MR-VERIFY-MSGA             PIC  X(01).               04780000
047900         10  MR-VERIFY-MSGC             PIC  X(01).               04790000
048000         10  MR-VERIFY-MSGH             PIC  X(01).               04800000
048100         10  MR-VERIFY-MSG              PIC  X(27).               04810000
048200/                                                                 04820000
048300*----------------------------------------------------------------*04830000
048400* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *04840008
048500*----------------------------------------------------------------*04850000
048600*---------------------------------------------------------------* 04860000
048700*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04870000
048800*---------------------------------------------------------------* 04880000
048900                                                                  04890000
049000     COPY DPWS015.                                                04900000
049100                                                                  04910000
049200*---------------------------------------------------------------* 04920000
049300*    FUNCTION KEYS COPYBOOK.                                    * 04930000
049400*---------------------------------------------------------------* 04940000
049500                                                                  04950000
049600     COPY DPWS016.                                                04960000
049700                                                                  04970000
049800*---------------------------------------------------------------* 04980000
049900*    NUMERIC EDIT LAYOUT.                                       * 04990000
050000*---------------------------------------------------------------* 05000000
050100                                                                  05010000
050200     COPY DPWS010I.                                               05020000
050300/                                                                 05030000
050400******************************************************************05040050
050500** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **05050050
050510** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **05051050
050600******************************************************************05060050
050700                                                                  05070000
050800     COPY DPWS030.                                                05080000
050810     COPY DPWS930.                                                05081050
050900/                                                                 05090000
051000*---------------------------------------------------------------* 05100000
051100*    STANDARD COMMAREA.                                         * 05110000
051200*---------------------------------------------------------------* 05120000
051300                                                                  05130000
051400     COPY DPWS020.                                                05140000
051500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05150000
051600                                                                  05160000
051700         10  INTER-APPL-COMM-AREA       PIC X(200).               05170000
051800     COPY RCWS012.                                                05180000
051900*---------------------------------------------------------------* 05190000
052000*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05200000
052100*---------------------------------------------------------------* 05210000
052200         10  ASC-SPECIFIC-COMMAREA.                               05220000
052300             15  ASC-LIST-KEYS.                                   05230000
052400                 20  ASC-OPER-UNT-ID                 PIC S9(04)   05240000
052500                                                     COMP.        05250000
052600                 20  ASC-FCLTY-ID                    PIC S9(04)   05260000
052700                                                     COMP.        05270000
052800                 20  ASC-PO-NBR                      PIC S9(09)   05280000
052900                                                     COMP.        05290000
053000                 20  ASC-STR-NBR                     PIC S9(04)   05300000
053100                                                     COMP.        05310000
053200                 20  ASC-REC-SEQ-NBR                 PIC S9(09)   05320000
053300                                                     COMP.        05330000
053400                 20  ASC-ORD-LNE-NBR-LOW             PIC S9(09)   05340000
053500                                                     COMP.        05350000
053600                 20  ASC-ORD-LNE-NBR-HIGH            PIC S9(09)   05360000
053700                                                     COMP.        05370000
053800                 20  ASC-ENT-ID                      PIC S9(09)   05380000
053900                                                     COMP.        05390000
054000                 20  ASC-DEPT-NBR                    PIC  X(03).  05400000
054100                                                                  05410000
054200             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05420000
054300                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05430000
054400                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05440000
054500                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05450000
054600                                                                  05460000
054700                 20  ASC-ITEM-ARRAY.                              05470000
054800                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        05480000
054900                         30  ASC-LIST-ITEM-NUMBER                 05490000
055000                                                     PIC S9(09)   05500000
055100                                                     COMP-3.      05510000
055200                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05520000
055300                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05530000
055400                             88  ASC-TEMP-SELECT     VALUE 'S'.   05540000
055500                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05550000
055600                             88  ASC-TEMP-END        VALUE 'E'.   05560000
055700                         30  ASC-SELECTED-SW         PIC  X(01).  05570000
055800                             88  ASC-NO-SELECT       VALUE ' '.   05580000
055900                             88  ASC-SELECT          VALUE 'S'.   05590000
056000                             88  ASC-BEGIN           VALUE 'B'.   05600000
056100                             88  ASC-END             VALUE 'E'.   05610000
056200                         30  ASC-UPDATE-SW           PIC  X(01).  05620000
056300                             88  ASC-UPDATE-YES      VALUE 'Y'.   05630000
056400                             88  ASC-UPDATE-NO       VALUE 'N'.   05640000
056500                         30  ASC-MANUAL-SW           PIC  X(01).  05650000
056600                             88  ASC-MANUAL-YES      VALUE 'Y'.   05660000
056700                             88  ASC-MANUAL-NO       VALUE 'N'.   05670000
056800                         30  ASC-ITEM-QTY-X.                      05680000
056900                             35  ASC-ITEM-QTY        PIC  9(05).  05690000
057000                         30  ASC-ORD-LNE-NBR         PIC S9(09)   05700000
057100                                                          COMP.   05710000
057200                         30  ASC-STATUS-CDE          PIC  X(02).  05720000
057300                             88  ASC-STATUS-VRFD     VALUE 'VE'.  05730000
057400                         30  ASC-VRFD-USR-ID         PIC  X(08).  05740000
057500*----------------------------------------------------------------*05750000
057600*                                             WR # 21361         *05760008
057700* CHANGED THE STRUCTURE OF ASC TO MATCH THE APPL COMMAREA.       *05770000
057800* ASC-CLASS-SKU FIELD IS INCREASED FROM X(06) TO X(11).          *05780000
057900*----------------------------------------------------------------*05790000
058000                         30  ASC-CLASS-SKU           PIC  X(11).  05800000
058100*----------------------------------------------------------------*05810000
058200* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *05820008
058300*----------------------------------------------------------------*05830000
058400                         30  ASC-EXPTED-ITM-QTY      PIC S9(05)   05840000
058500                                                          COMP-3. 05850000
058600                         30  ASC-ACTUAL-ITM-QTY      PIC S9(05)   05860000
058700                                                          COMP-3. 05870000
058800                         30  ASC-VERIFY-ITM-QTY      PIC S9(05)   05880000
058900                                                          COMP-3. 05890000
059000                         30  ASC-VERIFY-MESSAGE      PIC X(27).   05900000
059100                         30  ASC-PACK-BY-ST-OVERAGE-SW            05910000
059200                                                     PIC X(01).   05920000
059300                             88  ASC-PACK-BY-ST-OVERAGE           05930000
059400                                                     VALUE 'Y'.   05940000
059500                             88  ASC-NO-PACK-BY-ST-OVERAGE        05950000
059600                                                     VALUE 'N'.   05960000
059700*DC-XXX                                                           05970000
059800                         30  ASC-PURITM-UNT-QTY      PIC S9(09)   05980000
059900                                                          COMP.   05990000
060000                         30  ASC-PURITM-STATUS-CDE   PIC  X(02).  06000000
060100                         30  ASC-PURCHS-STATUS-CDE   PIC  X(02).  06010000
060200                         30  ASC-SEL-ZERO-SW    PIC X(01).        06020000
060300                             88  ASC-SEL-ZERO-YES   VALUE 'Y'.    06030000
060400                             88  ASC-SEL-ZERO-NO    VALUE 'N'.    06040000
060500                         30  ASC-UPDATE-ALLOWED-SW   PIC X(01).   06050036
060600                             88  ASC-UPDATE-ALLOWED  VALUE 'Y'.   06060036
060700                             88  ASC-NO-UPDATE-ALLOWED            06070036
060800                                                     VALUE 'N'.   06080038
060900*DC-XXX                                                           06090000
061000                                                                  06100000
061100             15  ASC-BLK-SUB                         PIC S9(04)   06110000
061200                                                          COMP    06120000
061300                                                          SYNC.   06130000
061400             15  ASC-ITEM-SUB                        PIC S9(04)   06140000
061500                                                          COMP    06150000
061600                                                          SYNC.   06160000
061700             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   06170000
061800                                                          COMP-3. 06180000
061900             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   06190000
062000                                                          COMP-3. 06200000
062100             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   06210000
062200                                                          COMP-3. 06220000
062300             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   06230000
062400                                                          COMP-3. 06240000
062500             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   06250000
062600                                                          COMP-3. 06260000
062700             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   06270000
062800                                                          COMP    06280000
062900                                                          SYNC.   06290000
063000             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   06300000
063100                                                          COMP-3. 06310000
063200             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   06320000
063300                                                          COMP-3. 06330000
063400                                                                  06340000
063500             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  06350000
063600                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   06360000
063700                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   06370000
063800             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  06380000
063900                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   06390000
064000                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   06400000
064100             15  ASC-AREA-ASTERISK-SW                PIC  X(01).  06410000
064200                 88  ASC-AREA-ASTERISK               VALUE 'Y'.   06420000
064300             15  ASC-DISPLAY-COMPLETE-SW             PIC  X(01).  06430000
064400                 88  ASC-DISPLAY-COMPLETE            VALUE 'Y'.   06440000
064500             15  ASC-VERIFY-SW                       PIC  X(01).  06450000
064600                 88  ASC-CAN-VERIFY                  VALUE 'Y'.   06460000
064700                 88  ASC-CANT-VERIFY                 VALUE 'N'.   06470000
064800                                                                  06480000
064900             15  ASC-CAN-UPDATE-SW                   PIC X.       06490000
065000                 88  ASC-CAN-UPDATE                  VALUE 'Y'.   06500000
065100                 88  ASC-CANT-UPDATE                 VALUE 'N'.   06510000
065200                                                                  06520000
065300             15  ASC-LIST-QUEUE-NAME.                             06530000
065400                 20  ASC-LIST-TERM-ID                PIC  X(04).  06540000
065500                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   06550000
065600                                                          COMP-3. 06560000
065700                 20  ASC-LIST-SEQ                    PIC  9(01).  06570000
065800             15  ASC-SEL-QUEUE-NAME.                              06580000
065900                 20  ASC-SEL-TERM-ID                 PIC  X(04).  06590000
066000                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   06600000
066100                                                          COMP-3. 06610000
066200                 20  ASC-SEL-SEQ                     PIC  9(01).  06620000
066300                                                                  06630000
066400             15  ASC-FCLTY-NME                       PIC  X(25).  06640000
066500             15  ASC-ENT-NAME-DESC                   PIC  X(30).  06650000
066600             15  ASC-CURSOR-SW                       PIC  X(01).  06660000
066700                 88  ASC-NO-CURSOR                   VALUE 'Z'.   06670000
066800                 88  ASC-SYSTEM-ID-CURSOR            VALUE 'S'.   06680000
066900                 88  ASC-MESSAGE-NUMBER-CURSOR       VALUE 'N'.   06690000
067000                 88  ASC-MESSAGE-TEXT-CURSOR         VALUE 'T'.   06700000
067100             15  ASC-START-ITEM-REQUEST.                          06710000
067200                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  06720000
067300             15  ASC-HOLD-RECITM-STATUS-CDE          PIC  X(02).  06730000
067400             15  ASC-CONFIRM-SWITCH                  PIC X.       06740000
067500                 88  ASC-CONFIRMED                   VALUE 'Y'.   06750000
067600                 88  ASC-NOT-CONFIRMED               VALUE 'N'.   06760000
067700             15  ASC-OVERAGE-SW                      PIC X.       06770000
067800                 88  ASC-OVERAGE               VALUE 'Y'.         06780000
067900                 88  ASC-NO-OVERAGE            VALUE 'N'.         06790000
068000             15  ASC-PACK-BY-ST-SW              PIC X(01).        06800000
068100                 88  ASC-PACK-BY-STORE          VALUE 'Y'.        06810000
068200                 88  ASC-NOT-PACK-BY-STORE      VALUE 'N'.        06820000
068300             15  ASC-CONFIRM-UPDATE-SW          PIC X(01).        06830000
068400                 88  ASC-CONFIRM-UPDATE         VALUE 'Y'.        06840000
068500                 88  ASC-DONT-CONFIRM-UPDATE    VALUE 'N'.        06850000
068600             15  ASC-RANGE-CHECK-SW             PIC X(01).        06860000
068700                 88  ASC-RANGE-ON               VALUE 'Y'.        06870000
068800                 88  ASC-RANGE-OFF              VALUE 'N'.        06880000
068900             15  ASC-VERIFY-SW                  PIC X.            06890036
069000                 88  ASC-VERIFY-OK              VALUE 'N'.        06900036
069100                 88  ASC-STOP-VERIFY            VALUE 'Y'.        06910036
069200             15  ASC-AUTO-VE-SW                 PIC X(01).        06920013
069300                 88  ASC-AUTO-VE-YES            VALUE 'Y'.        06930013
069400                 88  ASC-AUTO-VE-NO             VALUE 'N'.        06940013
069500             15  ASC-PBS-UPDATE-SW              PIC X(01).        06950040
069600                 88  ASC-PBS-UPDATE-YES         VALUE 'Y'.        06960040
069700                 88  ASC-PBS-UPDATE-NO          VALUE 'N'.        06970040
069800             15  ASC-VRFY-ADJ-QUEUE-NAME.                         06980008
069900                 20  ASC-VRFY-ADJ-TERM-ID            PIC X(4).    06990008
070000                 20  ASC-VRFY-ADJ-TASK-NUMBER        PIC S9(5)    07000008
070100                                                      COMP-3.     07010008
070200                 20  ASC-VRFY-ADJ-SEQ                PIC 9.       07020008
070300             15  ASC-HOLD-INTER-APPL                 PIC X(200).  07030000
070400/                                                                 07040000
070500*---------------------------------------------------------------* 07050000
070600*    ABEND DROCESSING COPYBOOK.                                 * 07060000
070700*---------------------------------------------------------------* 07070000
070800                                                                  07080000
070900     COPY DPWS013.                                                07090000
071000                                                                  07100000
071100*---------------------------------------------------------------* 07110028
071200*    RECORD LAYOUT FOR CALCULATING UNITS FOR AN ORDER.          * 07120028
071300*---------------------------------------------------------------* 07130028
071400     COPY RCWS074.                                                07140028
071500                                                                  07150028
071600/                                                                 07160000
071700******************************************************************07170000
071800*  COMMAREA LAYOUT FOR THE UNITS WORKED MODULE (PCKCS756)        *07180000
071900******************************************************************07190000
072000                                                                  07200000
072100     COPY PCWS238.                                                07210000
072200/                                                                 07220000
072300*---------------------------------------------------------------* 07230000
072400*                                                **   WR # 21361* 07240008
072500*  RECORD LAYOUT FOR LOGISTICS DOMAIN ITEM ACCESS MODULE        * 07250000
072600*---------------------------------------------------------------* 07260000
072700     COPY XLWS001.                                                07270000
072800*----------------------------------------------------------------*07280000
072900*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        07290008
073000*----------------------------------------------------------------*07300000
073100*---------------------------------------------------------------* 07310000
073200*    DB2 AREA FOR RECEIPT HEADER TABLE                          * 07320000
073300*---------------------------------------------------------------* 07330000
073400     EXEC SQL                                                     07340000
073500          INCLUDE TRECEIV                                         07350000
073600     END-EXEC.                                                    07360000
073700*---------------------------------------------------------------* 07370000
073800*    DB2 AREA FOR DISTRIBUTION HEADER TABLE                     * 07380000
073900*---------------------------------------------------------------* 07390000
074000     EXEC SQL                                                     07400000
074100          INCLUDE TDISTHD                                         07410000
074200     END-EXEC.                                                    07420000
074300*---------------------------------------------------------------* 07430000
074400*    DB2 AREA FOR DISTRIBUTION DETAIL TABLE                     * 07440000
074500*---------------------------------------------------------------* 07450000
074600     EXEC SQL                                                     07460000
074700          INCLUDE TDISTDT                                         07470000
074800     END-EXEC.                                                    07480000
074900*---------------------------------------------------------------* 07490000
075000*    DB2 AREA FOR RECEIPT ITEM TABLE                            * 07500000
075100*---------------------------------------------------------------* 07510000
075200     EXEC SQL                                                     07520000
075300          INCLUDE TRECITM                                         07530000
075400     END-EXEC.                                                    07540000
075500*---------------------------------------------------------------* 07550000
075600*    DB2 AREA FOR RECDVS TABLE                                  * 07560000
075700*---------------------------------------------------------------* 07570000
075800     EXEC SQL                                                     07580000
075900          INCLUDE TRECDVS                                         07590000
076000     END-EXEC.                                                    07600000
076100*---------------------------------------------------------------* 07610000
076200*    DB2 AREA FOR RECEIPT DISTRIBUTION TABLE                    * 07620000
076300*---------------------------------------------------------------* 07630000
076400     EXEC SQL                                                     07640000
076500          INCLUDE TRECDIS                                         07650000
076600     END-EXEC.                                                    07660000
076700*---------------------------------------------------------------* 07670000
076800*    DB2 AREA FOR VENDOR NAME TABLE                             * 07680000
076900*---------------------------------------------------------------* 07690000
077000     EXEC SQL                                                     07700000
077100          INCLUDE TENTNME                                         07710000
077200     END-EXEC.                                                    07720000
077300*---------------------------------------------------------------* 07730000
077400*    DB2 AREA FOR PURCHASE HEADER TABLE                         * 07740000
077500*---------------------------------------------------------------* 07750000
077600     EXEC SQL                                                     07760000
077700          INCLUDE TPURCHS                                         07770000
077800     END-EXEC.                                                    07780000
077900*---------------------------------------------------------------* 07790000
078000*    DB2 AREA FOR PURCHASE ITEM TABLE                           * 07800000
078100*---------------------------------------------------------------* 07810000
078200     EXEC SQL                                                     07820000
078300          INCLUDE TPURITM                                         07830000
078400     END-EXEC.                                                    07840000
078500/                                                                 07850000
078600*---------------------------------------------------------------* 07860000
078700*    DB2 AREA FOR XLT_LOC DATABASE                              * 07870032
078800*---------------------------------------------------------------* 07880000
078900     EXEC SQL                                                     07890000
079000          INCLUDE XLT00010                                        07900032
079100     END-EXEC.                                                    07910000
079200/                                                                 07920000
079300*---------------------------------------------------------------* 07930041
079400*    DB2 AREA FOR SUT00028 - SUT_OTBND_UPC - OUTBOUND CART. UPC * 07940041
079500*---------------------------------------------------------------* 07950041
079600     EXEC SQL                                                     07960000
079700          INCLUDE SUT00028                                        07970000
079800     END-EXEC.                                                    07980000
079900                                                                  07990041
080000*---------------------------------------------------------------* 08000041
080100*    DB2 AREA FOR SUT00024 - SUT_OTBND_CART - OUTBOUND CARTON   * 08010041
080200*---------------------------------------------------------------* 08020041
080300     EXEC SQL                                                     08030000
080400          INCLUDE SUT00024                                        08040000
080500     END-EXEC.                                                    08050000
080600                                                                  08060041
080700*---------------------------------------------------------------* 08070041
080800*    DB2 AREA FOR TSHPUNT - INBOUND CARTON                      * 08080041
080900*---------------------------------------------------------------* 08090041
081000     EXEC SQL                                                     08100041
081100          INCLUDE TSHPUNT                                         08110041
081200     END-EXEC.                                                    08120041
081300                                                                  08130041
081400*---------------------------------------------------------------* 08140042
081500*    DB2 AREA FOR TINPKSU - INBOUND PACKSLIP SHIP UNIT          * 08150042
081600*---------------------------------------------------------------* 08160042
081700     EXEC SQL                                                     08170042
081800          INCLUDE TINPKSU                                         08180042
081900     END-EXEC.                                                    08190042
082000                                                                  08200042
082100*---------------------------------------------------------------* 08210042
082200*    DB2 AREA FOR TPKSLIP - PACKSLIP                            * 08220042
082300*---------------------------------------------------------------* 08230042
082400     EXEC SQL                                                     08240042
082500          INCLUDE TPKSLIP                                         08250042
082600     END-EXEC.                                                    08260042
082700                                                                  08270042
082800*---------------------------------------------------------------* 08280041
082900*    DB2 AREA FOR TSHUNLO - INBOUND CARTON LOCATION             * 08290041
083000*---------------------------------------------------------------* 08300041
083100     EXEC SQL                                                     08310041
083200          INCLUDE TSHUNLO                                         08320041
083300     END-EXEC.                                                    08330041
083400                                                                  08340045
083500*---------------------------------------------------------------* 08350008
083600*    DB2 AREA FOR THE PO/RMS ROLLOUT CONTROL TABLE              * 08360000
083700*    (POT_RMS_RLOUT_CTL)                                        * 08370000
083800*---------------------------------------------------------------* 08380000
083900     EXEC SQL                                                     08390000
084000          INCLUDE POT00006                                        08400000
084100     END-EXEC.                                                    08410000
084200*                                                                 08420000
084300*---------------------------------------------------------------* 08430000
084400*    DB2 AREA FOR COMMUNICATIONS                                * 08440000
084500*---------------------------------------------------------------* 08450000
084600     EXEC SQL                                                     08460000
084700          INCLUDE SQLCA                                           08470000
084800     END-EXEC.                                                    08480000
084900                                                                  08490000
085000*---------------------------------------------------------------* 08500000
085100*    TRECITM CURSOR DECLARATION.                                * 08510000
085200* ADDED ITM-NBR TO LIST-CSR DECLARATION     WR/IR# 21361        * 08520008
085300*---------------------------------------------------------------* 08530008
085400                                                                  08540000
085500     EXEC SQL                                                     08550000
085600          DECLARE LIST-CSR CURSOR                                 08560000
085700          FOR SELECT                                              08570000
085800                A.STATUS_CDE                                      08580000
085900              , A.ML_POST_TMST                                    08590000
086000              , A.FS_POST_TMST                                    08600000
086100              , B.ORD_LNE_NBR                                     08610000
086200              , B.STATUS_CDE                                      08620000
086300              , B.VRFD_USR_ID                                     08630000
086400              , C.EXPTED_ITM_QTY                                  08640000
086500              , C.VERIFY_ITM_QTY                                  08650000
086600              , C.AP_VERIFY_ITM_QTY                               08660000
086700              , C.AP_PRC_CDE                                      08670000
086800              , D.DEPT_NBR                                        08680000
086900              , D.ENT_ID                                          08690000
087000              , D.STATUS_CDE                                      08700000
087100              , E.CL_NBR                                          08710000
087200              , E.SKU_SEQ_NBR                                     08720000
087300              , E.UNT_QTY                                         08730000
087400              , E.STATUS_CDE                                      08740000
087500              , E.ITM_NBR                                         08750000
087600          FROM                                                    08760000
087700                  TRECEIV  A                                      08770000
087800              ,   TRECITM  B                                      08780000
087900              ,   TRECDIS  C                                      08790000
088000              ,   TPURCHS  D                                      08800000
088100              ,   TPURITM  E                                      08810000
088200          WHERE                                                   08820000
088300                A.ORD_NBR          =  :ASC-PO-NBR                 08830000
088400           AND  A.ORD_NBR          =  B.ORD_NBR                   08840000
088500           AND  A.ORD_NBR          =  C.ORD_NBR                   08850000
088600           AND  A.ORD_NBR          =  D.PO_NBR                    08860000
088700           AND  A.ORD_NBR          =  E.PO_NBR                    08870000
088800*                                                                 08880000
088900           AND  A.VER_STATUS_CDE   =  :PC-A                       08890000
089000           AND  B.VER_STATUS_CDE   =  :PC-A                       08900000
089200           AND  D.VER_STATUS_CDE   =  :PC-A                       08920000
089300           AND  E.VER_STATUS_CDE   =  :PC-A                       08930000
089400*                                                                 08940000
089500           AND  A.OPER_UNT_ID      =  :ASC-OPER-UNT-ID            08950000
089600           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               08960000
089700           AND  A.OPER_UNT_ID      =  C.OPER_UNT_ID               08970000
089800           AND  A.FCLTY_ID         =  :ASC-FCLTY-ID               08980000
089900           AND  A.FCLTY_ID         =  B.FCLTY_ID                  08990000
090000           AND  A.FCLTY_ID         =  C.FCLTY_ID                  09000000
090100*                                                                 09010000
090200           AND  C.STR_NBR          =  :ASC-STR-NBR                09020000
090300           AND  A.REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR            09030000
090400           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               09040000
090500           AND  A.REC_SEQ_NBR      =  C.REC_SEQ_NBR               09050000
090600           AND  E.APP_PO_LNE_NBR   =  B.ORD_LNE_NBR               09060000
090700           AND  C.ORD_LNE_NBR      =  B.ORD_LNE_NBR               09070000
090800           AND  B.ORD_LNE_NBR BETWEEN :ASC-ORD-LNE-NBR-LOW        09080000
090900                                 AND  :ASC-ORD-LNE-NBR-HIGH       09090000
091000          ORDER BY                                                09100000
091100                B.ORD_LNE_NBR                                     09110000
091200     END-EXEC.                                                    09120000
091300/                                                                 09130000
091400******************************************************************09140000
091500*    DB2 CURSOR DEFINITION FOR RETRIEVAL RECDVS ROWS              09150000
091600******************************************************************09160000
091700     EXEC SQL                                                     09170000
091800          DECLARE RECDVS-CURSOR CURSOR FOR                        09180000
091900          SELECT                                                  09190000
092000                  VRFY_SRC_CDE                                    09200000
092100                , VRFY_ITM_QTY                                    09210000
092200            FROM                                                  09220000
092300                  TRECDVS                                         09230000
092400            WHERE                                                 09240000
092500                  ORD_NBR          = :ASC-PO-NBR                  09250000
092600              AND REC_SEQ_NBR      = :ASC-REC-SEQ-NBR             09260000
092700              AND ORD_LNE_NBR      = :PV-ORD-LNE-NBR              09270000
092800              AND STR_NBR          = :ASC-STR-NBR                 09280000
092900              AND VER_STAT_CDE     = 'A'                          09290000
093000              AND VRFY_SRC_CDE     IN ('P2','CP')                 09300000
093100     END-EXEC.                                                    09310000
093200 LINKAGE SECTION.                                                 09320000
093300                                                                  09330000
093400 01  DFHCOMMAREA.                                                 09340000
093500     05  FILLER                         OCCURS  1 TO 4072 TIMES   09350000
093600                                        DEPENDING ON EIBCALEN.    09360000
093700         10  FILLER                     PIC X.                    09370000
093800                                                                  09380000
093900 PROCEDURE DIVISION.                                              09390000
094000******************************************************************09400000
094100**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09410000
094200**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09420000
094300**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09430000
094400******************************************************************09440000
094500                                                                  09450000
094600 0000-MAIN-MODULE.                                                09460000
094700                                                                  09470000
094800     INITIALIZE DP030-CICS-API-FIELDS.                            09480000
094900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09490000
095000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09500000
095100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09510000
095200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09520000
095300                                                                  09530000
095400     MOVE LENGTH OF RC231AI        TO DP030-MAP-LENGTH (1).       09540000
095500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09550000
095600     PERFORM 0001-CALL-CICS-ARCH-API.                             09560000
095700                                                                  09570000
095800     EXEC SQL                                                     09580000
095900          SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP            09590000
096000     END-EXEC.                                                    09600000
096100                                                                  09610000
096200     PERFORM 1000-CONTROL-PROCESSING                              09620000
096300                                                                  09630000
096400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09640000
096500     PERFORM 0001-CALL-CICS-ARCH-API.                             09650000
096600                                                                  09660000
096700*----------------------------------------------------------------*09670000
096800*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *09680000
096900*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *09690000
097000*----------------------------------------------------------------*09700000
097100                                                                  09710000
097200 0001-CALL-CICS-ARCH-API.                                         09720000
097300                                                                  09730000
097410     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09741050
097500                                    DFHCOMMAREA                   09750050
097600                                    DP030-CICS-API-FIELDS         09760050
097700                                    DP020-STANDARD-COMMAREA       09770050
097800                                    RC231AI.                      09780050
097900                                                                  09790000
098000     IF  DP030-RC-CALL-SUCCESSFUL                                 09800000
098100         CONTINUE                                                 09810000
098200     ELSE                                                         09820000
098300         SET DP013-NO-ROLLBACK                                    09830000
098400             DP013-XCTL-DISPLAY-RESTART                           09840000
098500             DP013-CICS-ABEND      TO TRUE                        09850000
098600         MOVE '0001-CALL-CICS-ARCH-API'                           09860000
098700                                   TO DP013-PARAGRAPH             09870000
098720         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O09872050
098730-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09873050
099000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09900000
099100         PERFORM DP013-0000-PROCESS-ABEND                         09910000
099200     END-IF.                                                      09920000
099300                                                                  09930000
099400*----------------------------------------------------------------*09940000
099500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09950000
099600* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09960000
099700*                                                                *09970000
099800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09980000
099900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09990000
100000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10000000
100100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10010000
100200*----------------------------------------------------------------*10020000
100300                                                                  10030000
100400 1000-CONTROL-PROCESSING.                                         10040000
100500                                                                  10050000
100600     EVALUATE TRUE                                                10060000
100700         WHEN DP020-NEXT-ACT-INITIAL                              10070000
100800              INITIALIZE ASC-SPECIFIC-COMMAREA                    10080000
100900              MOVE EIBTRMID        TO ASC-LIST-TERM-ID            10090000
101000                                      ASC-SEL-TERM-ID             10100000
101100                                      ASC-VRFY-ADJ-TERM-ID        10110008
101200              MOVE DP020-SRC-TASK-NUMBER                          10120000
101300                                   TO ASC-LIST-TASK-NUMBER        10130000
101400                                      ASC-SEL-TASK-NUMBER         10140000
101500                                      ASC-VRFY-ADJ-TASK-NUMBER    10150008
101600              MOVE PC-LIST-QUEUE-SEQ                              10160000
101700                                   TO ASC-LIST-SEQ                10170000
101800              MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                10180000
101900              MOVE PC-VRFY-ADJ-QUEUE-SEQ TO ASC-VRFY-ADJ-SEQ      10190008
102000                                                                  10200000
102100              MOVE INTER-APPL-COMM-AREA                           10210000
102200                                   TO ASC-HOLD-INTER-APPL         10220000
102300              SET ASC-NO-OVERAGE TO TRUE                          10230000
102400              SET ASC-NOT-CONFIRMED TO TRUE                       10240000
102500              PERFORM 4100-PREPARE-CURSOR                         10250000
102600              INITIALIZE PV-DB2-COUNT                             10260000
102700              PERFORM 3200-RESET-ATTRIBUTES                       10270010
102800              PERFORM 4000-BUILD-INITIAL-PANEL                    10280000
102900              IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                 10290000
103000                  SET DP020-NEXT-ACT-APPL-ERROR TO TRUE           10300000
103100              END-IF                                              10310000
103200                                                                  10320000
103300         WHEN DP020-NEXT-ACT-READ-MAP                             10330000
103400              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       10340000
103500                                   TO PV-TOP-ITEM                 10350000
103600              PERFORM 2000-PROCESS-PANEL                          10360000
103700                                                                  10370000
103800         WHEN DP020-NEXT-ACT-RETURN                               10380000
103900              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       10390000
104000                                   TO PV-TOP-ITEM                 10400000
104100              MOVE ZERO            TO ASC-ITEM-AT-TOP-OF-PANEL    10410000
104200              MOVE ASC-HOLD-INTER-APPL                            10420000
104300                                   TO INTER-APPL-COMM-AREA        10430000
104400              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  10440000
104500              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10450000
104600                                                                  10460000
104700         WHEN OTHER                                               10470000
104800              SET DP013-LOGIC-ABEND TO TRUE                       10480000
104900              SET DP013-NO-ROLLBACK TO TRUE                       10490000
105000              MOVE '1000-CONTROL-PROCESSING'                      10500000
105100                                   TO DP013-PARAGRAPH             10510000
105200              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   10520000
105300                                   TO DP013-MESSAGE-TEXT(1)       10530000
105400              PERFORM DP013-0000-PROCESS-ABEND                    10540000
105500     END-EVALUATE.                                                10550000
105600                                                                  10560000
105700/                                                                 10570000
105800*----------------------------------------------------------------*10580000
105900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10590000
106000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10600000
106100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10610000
106200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10620000
106300* FUNCTION KEYS CAN GET THIS FAR.                                *10630000
106400*----------------------------------------------------------------*10640000
106500                                                                  10650000
106600 2000-PROCESS-PANEL.                                              10660000
106700     SET PS-NEXT-SCREEN TO TRUE.                                  10670000
106800                                                                  10680000
106900     MOVE ASC-HOLD-INTER-APPL     TO INTER-APPL-COMM-AREA.        10690000
107000                                                                  10700000
107100     EVALUATE TRUE                                                10710000
107200         WHEN DP020-SRC-AID = DP016-CLEAR                         10720000
107300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10730000
107400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10740000
107500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10750000
107600                                                                  10760000
107700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10770000
107800             PERFORM 2050-DELETE-LIST-QUEUE                       10780000
107900             SET ASC-NO-OVERAGE TO TRUE                           10790000
108000             SET ASC-DONT-CONFIRM-UPDATE TO TRUE                  10800000
108100             PERFORM 4000-BUILD-INITIAL-PANEL                     10810000
108200                                                                  10820000
108300         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    10830000
108400             PERFORM 2140-DESELECT-ALL-ITEMS                      10840000
108500             PERFORM 3200-RESET-ATTRIBUTES                        10850000
108600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10860000
108700                                                                  10870000
108800         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  10880000
108900         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               10890000
109000             PERFORM 3200-RESET-ATTRIBUTES                        10900000
109100             PERFORM 2150-SELECT-ALL-ITEMS                        10910000
109200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10920000
109300                                                                  10930000
109400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10940000
109500            SET DP030-OVERRIDE-GO                                 10950000
109600                DP020-MSG-WARNING                                 10960000
109700                TO TRUE                                           10970000
109800            MOVE PC-TSYMSG-00045                                  10980000
109900                TO DP020-MSG-NUMBER                               10990000
110000                                                                  11000000
110100         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             11010000
110200            SET DP030-OVERRIDE-GO                                 11020000
110300                DP020-MSG-WARNING                                 11030000
110400                TO TRUE                                           11040000
110500            MOVE PC-TSYMSG-00045                                  11050000
110600                TO DP020-MSG-NUMBER                               11060000
110700                                                                  11070000
110800         WHEN (DP020-FK-CONFIRM(DP020-SRC-AID)                    11080000
110900               AND ASC-NOT-CONFIRMED)                             11090000
111000            SET DP030-OVERRIDE-GO                                 11100000
111100                DP020-MSG-WARNING                                 11110000
111200                TO TRUE                                           11120000
111300            MOVE PC-TSYMSG-00045                                  11130000
111400                TO DP020-MSG-NUMBER                               11140000
111500                                                                  11150000
111600         WHEN OTHER                                               11160000
111700              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                11170000
111800                  PERFORM 3000-EDIT-DATA-IN-COMMAREA              11180000
111900                  IF  PS-NO-ERROR                                 11190000
112000                      SET DP030-CONTINUE-GO                       11200000
112100                                 TO TRUE                          11210000
112200                      PERFORM 2100-CHECK-FUNCTION-KEY             11220000
112300                  ELSE                                            11230000
112400                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        11240000
112500                      SET DP030-OVERRIDE-GO                       11250000
112600                                 TO TRUE                          11260000
112700                  END-IF                                          11270000
112800     END-EVALUATE.                                                11280000
112900 EJECT                                                            11290000
113000*----------------------------------------------------------------*11300000
113100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11310000
113200*----------------------------------------------------------------*11320000
113300 2050-DELETE-LIST-QUEUE.                                          11330000
113400                                                                  11340000
113500     EXEC CICS                                                    11350000
113600         DELETEQ TS                                               11360000
113700             QUEUE (ASC-LIST-QUEUE-NAME)                          11370000
113800             RESP  (PV-CICS-RESP)                                 11380000
113900     END-EXEC.                                                    11390000
114000                                                                  11400000
114100     IF (PV-CICS-RESP = DFHRESP(NORMAL)                           11410000
114200     OR  PV-CICS-RESP = DFHRESP(QIDERR))                          11420000
114300         CONTINUE                                                 11430000
114400     ELSE                                                         11440000
114500         SET DP013-CICS-ABEND      TO TRUE                        11450000
114600         SET DP013-NO-ROLLBACK     TO TRUE                        11460000
114700                                                                  11470000
114800         MOVE '2050-DELETE-LIST-QUEUE'                            11480000
114900                                   TO DP013-PARAGRAPH             11490000
115000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11500000
115100                                   TO DP013-MESSAGE-TEXT (1)      11510000
115200         PERFORM DP013-0000-PROCESS-ABEND                         11520000
115300     END-IF.                                                      11530000
115400                                                                  11540000
115500     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11550000
115600/                                                                 11560000
115700*----------------------------------------------------------------*11570000
115800* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11580000
115900* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11590000
116000* CICS ARCHITECTURE API.                                         *11600000
116100*----------------------------------------------------------------*11610000
116200                                                                  11620000
116300 2100-CHECK-FUNCTION-KEY.                                         11630000
116400                                                                  11640000
116500     SET PS-NEXT-SCREEN TO TRUE.                                  11650000
116600     EVALUATE TRUE                                                11660000
116700                                                                  11670000
116800         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               11680036
116900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11690036
117000               IF ASC-STOP-VERIFY                                 11700036
117100                  MOVE PC-TSYMSG-03233                            11710036
117200                          TO  DP020-MSG-NUMBER                    11720036
117300                  SET PS-ERROR                                    11730036
117400                      DP030-OVERRIDE-GO                           11740036
117500                      DP020-MSG-WARNING TO TRUE                   11750036
117600                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            11760036
117700               ELSE                                               11770036
117800                 IF ASC-CONFIRM-UPDATE                            11780036
117900                    SET ASC-CONFIRMED TO TRUE                     11790036
118000                    MOVE PC-TSYMSG-01817                          11800036
118100                    TO  DP020-MSG-NUMBER                          11810036
118200                    SET PS-ERROR                                  11820036
118300                    DP030-OVERRIDE-GO                             11830036
118400                    DP020-MSG-FATAL TO TRUE                       11840036
118500                 ELSE                                             11850036
118600                   IF ASC-PACK-BY-STORE                           11860036
118700                        PERFORM 5050-PREPARE-TO-ADJUST            11870036
118800                        IF ASC-OVERAGE                            11880036
118900                            SET ASC-CONFIRMED                     11890036
119000                                 TO TRUE                          11900036
119100                             MOVE PC-TSYMSG-01264                 11910036
119200                             TO  DP020-MSG-NUMBER                 11920036
119300                              SET PS-ERROR                        11930036
119400                              DP030-OVERRIDE-GO                   11940036
119500                              DP020-MSG-FATAL                     11950036
119600                                       TO TRUE                    11960036
119700                        ELSE                                      11970036
119800                          SET ASC-NO-OVERAGE TO TRUE              11980036
119900                          SET ASC-CONFIRMED TO TRUE               11990036
120000                          PERFORM 5055-ADJUST-UPDATE              12000036
120100                          IF  NOT PS-ERROR                        12010036
120200                              MOVE PC-TSYMSG-00059                12020036
120300                                   TO  DP020-MSG-NUMBER           12030036
120400                              SET DP020-MSG-INFORMATIONAL         12040036
120500                                   TO  TRUE                       12050036
120600                              MOVE ASC-ITEM-AT-TOP-OF-PANEL       12060036
120700                                   TO  PV-TOP-ITEM                12070036
120800                              MOVE ZERO                           12080036
120900                                   TO  ASC-ITEM-AT-TOP-OF-PANEL   12090036
121000                              DIVIDE PV-TOP-ITEM                  12100036
121100                                   BY PC-ITEMS-PER-PANEL          12110036
121200                              GIVING PV-BLOCK-NUMBER              12120036
121300                              REMAINDER PV-REMAINDER              12130036
121400                              IF  PV-REMAINDER > ZERO             12140036
121500                                  ADD +1 TO PV-BLOCK-NUMBER       12150036
121600                              END-IF                              12160036
121700                                                                  12170036
121800                             MOVE +1    TO ASC-BLK-SUB            12180036
121900                             PERFORM 4410-READ-TEMP-STORAGE       12190036
122000                             ADD +1     TO ASC-BLK-SUB            12200036
122100                                           PV-BLOCK-NUMBER        12210036
122200                             PERFORM 4410-READ-TEMP-STORAGE       12220036
122300                             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN 12230036
122400                             PERFORM 3200-RESET-ATTRIBUTES        12240036
122500                          END-IF                                  12250036
122600                        END-IF                                    12260036
122700                   ELSE                                           12270036
122800                        SET ASC-NO-OVERAGE TO TRUE                12280036
122900                        PERFORM 5055-ADJUST-UPDATE                12290036
123000                        IF  NOT PS-ERROR                          12300036
123100                            MOVE PC-TSYMSG-00059                  12310036
123200                                          TO  DP020-MSG-NUMBER    12320036
123300                            SET DP020-MSG-INFORMATIONAL           12330036
123400                                          TO  TRUE                12340036
123500                            MOVE ASC-ITEM-AT-TOP-OF-PANEL         12350036
123600                                          TO  PV-TOP-ITEM         12360036
123700                            MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL12370036
123800                                                                  12380036
123900                            DIVIDE PV-TOP-ITEM BY                 12390036
124000                                      PC-ITEMS-PER-PANEL          12400036
124100                                      GIVING PV-BLOCK-NUMBER      12410036
124200                                      REMAINDER PV-REMAINDER      12420036
124300                            IF  PV-REMAINDER > ZERO               12430036
124400                                ADD +1 TO PV-BLOCK-NUMBER         12440036
124500                            END-IF                                12450036
124600                                                                  12460036
124700                            MOVE +1    TO ASC-BLK-SUB             12470036
124800                            PERFORM 4410-READ-TEMP-STORAGE        12480036
124900                            ADD +1     TO ASC-BLK-SUB             12490036
125000                                          PV-BLOCK-NUMBER         12500036
125100                            PERFORM 4410-READ-TEMP-STORAGE        12510036
125200                            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN  12520036
125300                        END-IF                                    12530036
125400                   END-IF                                         12540036
125500                 END-IF                                           12550036
125600               END-IF                                             12560036
125700             ELSE                                                 12570036
125800                 SET DP030-OVERRIDE-GO                            12580036
125900                                   TO TRUE                        12590036
126000                 MOVE PC-TSYMSG-00057                             12600036
126100                                   TO DP020-MSG-NUMBER            12610036
126200                 SET DP020-MSG-WARNING                            12620036
126300                                   TO TRUE                        12630036
126400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12640036
126500             END-IF                                               12650036
126600                                                                  12660000
126700         WHEN  DP020-FK-CONFIRM(DP020-SRC-AID)                    12670000
126800            SET ASC-NO-OVERAGE TO TRUE                            12680000
126900            IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO                12690000
127000                 SET ASC-NO-TSQ-UPDATE                            12700000
127100                                TO TRUE                           12710000
127200                 SET DP030-OVERRIDE-GO                            12720000
127300                      DP020-MSG-WARNING                           12730000
127400                                 TO TRUE                          12740000
127500                 MOVE PC-TSYMSG-00057                             12750000
127600                                 TO DP020-MSG-NUMBER              12760000
127700                 PERFORM 3200-RESET-ATTRIBUTES                    12770000
127800            ELSE                                                  12780000
127900                  IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          12790000
128000                      IF ASC-CONFIRMED                            12800000
128100                          SET ASC-DONT-CONFIRM-UPDATE TO TRUE     12810000
128200                          MOVE ASC-NUMBER-OF-SELECTED-ITEMS       12820000
128300                            TO RC012-NUMBER-OF-SELECTED-ITEMS     12830000
128400                          MOVE ASC-PO-NBR                         12840000
128500                             TO RC012-PO-NBR                      12850000
128600                          MOVE ASC-STR-NBR                        12860000
128700                              TO RC012-STR-NBR                    12870000
128800                          PERFORM 5055-ADJUST-UPDATE              12880000
128900                          IF  NOT PS-ERROR                        12890000
129000                              MOVE PC-TSYMSG-00059                12900000
129100                                            TO  DP020-MSG-NUMBER  12910000
129200                              SET DP020-MSG-INFORMATIONAL         12920000
129300                                            TO  TRUE              12930000
129400                          END-IF                                  12940000
129500                          MOVE ASC-ITEM-AT-TOP-OF-PANEL           12950000
129600                                        TO  PV-TOP-ITEM           12960000
129700                          MOVE ZERO  TO  ASC-ITEM-AT-TOP-OF-PANEL 12970000
129800                          DIVIDE PV-TOP-ITEM BY                   12980000
129900                                    PC-ITEMS-PER-PANEL            12990000
130000                                    GIVING PV-BLOCK-NUMBER        13000000
130100                                    REMAINDER PV-REMAINDER        13010000
130200                          IF  PV-REMAINDER > ZERO                 13020000
130300                              ADD +1 TO PV-BLOCK-NUMBER           13030000
130400                          END-IF                                  13040000
130500                                                                  13050000
130600                          MOVE +1    TO ASC-BLK-SUB               13060000
130700                          PERFORM 4410-READ-TEMP-STORAGE          13070000
130800                          ADD +1     TO ASC-BLK-SUB               13080000
130900                                        PV-BLOCK-NUMBER           13090000
131000                          PERFORM 4410-READ-TEMP-STORAGE          13100000
131100                          PERFORM 3200-RESET-ATTRIBUTES           13110017
131200                          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN    13120000
131300                          SET ASC-NOT-CONFIRMED TO TRUE           13130000
131400                      ELSE                                        13140000
131500                         SET DP030-OVERRIDE-GO                    13150000
131600                             DP020-MSG-WARNING                    13160000
131700                             TO TRUE                              13170000
131800                         MOVE PC-TSYMSG-00045                     13180000
131900                             TO DP020-MSG-NUMBER                  13190000
132000                     END-IF                                       13200000
132100                  END-IF                                          13210000
132200            END-IF                                                13220000
132300                                                                  13230000
132400         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  13240000
132500             MOVE +1               TO PV-TOP-ITEM                 13250000
132600             PERFORM 3200-RESET-ATTRIBUTES                        13260017
132700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13270000
132800                                                                  13280000
132900         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   13290000
133000             PERFORM 2110-BROWSE-BACKWARD                         13300000
133100             PERFORM 3200-RESET-ATTRIBUTES                        13310017
133200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13320000
133300                                                                  13330000
133400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   13340000
133500             PERFORM 2120-BROWSE-FORWARD                          13350000
133600             PERFORM 3200-RESET-ATTRIBUTES                        13360017
133700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13370000
133800                                                                  13380000
133900         WHEN DP020-SRC-AID = DP016-ENTER                         13390000
134000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   13400000
134100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13410000
134200             SET ASC-DONT-CONFIRM-UPDATE TO TRUE                  13420000
134300                                                                  13430000
134400         WHEN OTHER                                               13440000
134500             SET DP013-NO-ROLLBACK                                13450000
134600                 DP013-XCTL-DISPLAY-RESTART                       13460000
134700                 DP013-CICS-ABEND  TO TRUE                        13470000
134800             MOVE '2100-CHECK-FUNCTION-KEY'                       13480000
134900                                   TO DP013-PARAGRAPH             13490000
135000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13500000
135100                                   TO DP013-MESSAGE-TEXT (1)      13510000
135200             PERFORM DP013-0000-PROCESS-ABEND                     13520000
135300     END-EVALUATE.                                                13530000
135400                                                                  13540000
135500*----------------------------------------------------------------*13550000
135600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *13560000
135700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *13570000
135800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *13580000
135900*    MESSAGE.                                                    *13590000
136000*----------------------------------------------------------------*13600000
136100                                                                  13610000
136200 2110-BROWSE-BACKWARD.                                            13620000
136300                                                                  13630000
136400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    13640000
136500         GIVING PV-TOP-ITEM.                                      13650000
136600                                                                  13660000
136700     IF  ((PV-TOP-ITEM < +1)                                      13670000
136800       OR (PV-TOP-ITEM = +1))                                     13680000
136900         MOVE +1                   TO PV-TOP-ITEM                 13690000
137000*        -- TOP OF LIST --                                        13700000
137100         IF ASC-OVERAGE                                           13710000
137200             MOVE PC-TSYMSG-01264                                 13720000
137300                      TO DP020-MSG-NUMBER                         13730000
137400            SET DP020-MSG-FATAL                                   13740000
137500                                 TO TRUE                          13750000
137600         ELSE                                                     13760000
137700             MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER          13770000
137800             SET DP020-MSG-INFORMATIONAL                          13780000
137900                                 TO TRUE                          13790000
138000     END-IF.                                                      13800000
138100                                                                  13810000
138200/                                                                 13820000
138300*----------------------------------------------------------------*13830000
138400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *13840000
138500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *13850000
138600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *13860000
138700*----------------------------------------------------------------*13870000
138800                                                                  13880000
138900 2120-BROWSE-FORWARD.                                             13890000
139000                                                                  13900000
139100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              13910000
139200         GIVING PV-TOP-ITEM.                                      13920000
139300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   13930000
139400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13940000
139500                                   TO PV-TOP-ITEM                 13950000
139600*        -- BOTTOM OF LIST --                                     13960000
139700         IF ASC-OVERAGE                                           13970000
139800             MOVE PC-TSYMSG-01264                                 13980000
139900                      TO DP020-MSG-NUMBER                         13990000
140000            SET DP020-MSG-FATAL                                   14000000
140100                                 TO TRUE                          14010000
140200         ELSE                                                     14020000
140300             MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER          14030000
140400             SET DP020-MSG-INFORMATIONAL                          14040000
140500                                 TO TRUE                          14050000
140600     ELSE                                                         14060000
140700         COMPUTE PV-BOTTOM-ITEM =                                 14070000
140800             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 14080000
140900         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            14090000
141000*            -- BOTTOM OF LIST --                                 14100000
141100             IF ASC-OVERAGE                                       14110000
141200                 MOVE PC-TSYMSG-01264                             14120000
141300                          TO DP020-MSG-NUMBER                     14130000
141400                SET DP020-MSG-FATAL                               14140000
141500                                     TO TRUE                      14150000
141600             ELSE                                                 14160000
141700                 MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER      14170000
141800                 SET DP020-MSG-INFORMATIONAL                      14180000
141900                                     TO TRUE                      14190000
142000         END-IF                                                   14200000
142100     END-IF.                                                      14210000
142200/                                                                 14220000
142300*----------------------------------------------------------------*14230000
142400*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *14240000
142500*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *14250000
142600*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *14260000
142700*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *14270000
142800*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *14280000
142900*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *14290000
143000*----------------------------------------------------------------*14300000
143100                                                                  14310000
143200 2130-CHECK-FOR-JUMP-BROWSE.                                      14320000
143300                                                                  14330000
143400     SET PS-NO-ERROR               TO TRUE.                       14340000
143500     IF  ASC-START-ITEM-REQUEST = SPACE                           14350000
143600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14360000
143700                                   TO PV-TOP-ITEM                 14370000
143800     ELSE                                                         14380000
143900         MOVE ASC-START-ITEM-REQUEST                              14390000
144000                                   TO DP010I-UNEDITED-FIELD       14400000
144100                                      PV-START-ITEM-REQUEST       14410000
144200         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       14420000
144300         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     14430000
144400         SET DP010I-NEGATIVE-NOT-ALLOWED                          14440000
144500                                   TO TRUE                        14450000
144610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14461049
144620              USING DP010I-NUMERIC-EDIT-AREA                      14462049
144700                                                                  14470000
144800         IF  NOT DP010I-ERROR-DETECTED                            14480000
144900             MOVE DP010I-NUMERIC-FIELD                            14490000
145000                                   TO  ASC-START-ITEM-REQUEST-N   14500000
145100             IF  ASC-START-ITEM-REQUEST-N > ZERO                  14510000
145200                 IF  ASC-START-ITEM-REQUEST-N >                   14520000
145300                                          ASC-NUMBER-OF-ITEMS-READ14530000
145400                     MOVE SPACE TO ASC-START-ITEM-REQUEST         14540000
145500                     COMPUTE PV-TOP-ITEM =                        14550000
145600                             ASC-NUMBER-OF-ITEMS-READ             14560000
145700                             - PC-ITEMS-PER-PANEL + 1             14570000
145800                     IF  PV-TOP-ITEM < +1                         14580000
145900                         MOVE +1   TO PV-TOP-ITEM                 14590000
146000                         MOVE PC-TSYMSG-00070                     14600000
146100                                   TO DP020-MSG-NUMBER            14610000
146200                         SET DP020-MSG-INFORMATIONAL              14620000
146300                                   TO TRUE                        14630000
146400                     END-IF                                       14640000
146500                 ELSE                                             14650000
146600                     MOVE ASC-START-ITEM-REQUEST-N                14660000
146700                                   TO PV-TOP-ITEM                 14670000
146800                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      14680000
146900                     COMPUTE PV-BOTTOM-ITEM =                     14690000
147000                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     14700000
147100                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ14710000
147200*                        -- BOTTOM OF LIST --                     14720000
147300                         MOVE PC-TSYMSG-00070                     14730000
147400                                   TO DP020-MSG-NUMBER            14740000
147500                         SET DP020-MSG-INFORMATIONAL              14750000
147600                                   TO TRUE                        14760000
147700                     END-IF                                       14770000
147800                 END-IF                                           14780000
147900             ELSE                                                 14790000
148000*                --- VALUE OUT OF RANGE ----                      14800000
148100                 MOVE PC-TSYMSG-00101                             14810000
148200                                   TO DP020-MSG-NUMBER            14820000
148300                 MOVE -1           TO ASTRTITL                    14830000
148400                 SET DP030-SET-CURSOR-APPL-1                      14840000
148500                                   TO TRUE                        14850000
148600                 MOVE DP015-REVERSE                               14860000
148700                                   TO ASTRTITH                    14870000
148800                 MOVE DP015-RED    TO ASTRTITC                    14880000
148900                 MOVE DP015-UNP-NUM-BRT-OFF                       14890000
149000                                   TO ASTRTITA                    14900000
149100                 SET DP020-MSG-FATAL                              14910000
149200                                   TO TRUE                        14920000
149300                 SET PS-ERROR      TO TRUE                        14930000
149400             END-IF                                               14940000
149500                                                                  14950000
149600         ELSE                                                     14960000
149700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14970000
149800             MOVE -1               TO ASTRTITL                    14980000
149900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14990000
150000             MOVE DP015-REVERSE    TO ASTRTITH                    15000000
150100             MOVE DP015-RED        TO ASTRTITC                    15010000
150200             MOVE DP015-UNP-NUM-BRT-OFF                           15020000
150300                                   TO ASTRTITA                    15030000
150400             SET DP020-MSG-FATAL   TO TRUE                        15040000
150500             SET PS-ERROR          TO TRUE                        15050000
150600         END-IF                                                   15060000
150700     END-IF.                                                      15070000
150800/                                                                 15080000
150900*----------------------------------------------------------------*15090000
151000*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *15100000
151100*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *15110000
151200*----------------------------------------------------------------*15120000
151300                                                                  15130000
151400 2140-DESELECT-ALL-ITEMS.                                         15140000
151500                                                                  15150000
151600     MOVE +1                       TO ASC-BLK-SUB.                15160000
151700                                                                  15170000
151800     PERFORM 2141-CLEAR-SELECTED-INDS                             15180000
151900         VARYING ASC-ITEM-SUB                                     15190000
152000         FROM 1 BY 1                                              15200000
152100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15210000
152200                                                                  15220000
152300     ADD +1                        TO ASC-BLK-SUB.                15230000
152400                                                                  15240000
152500     PERFORM 2141-CLEAR-SELECTED-INDS                             15250000
152600         VARYING ASC-ITEM-SUB                                     15260000
152700         FROM 1 BY 1                                              15270000
152800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15280000
152900                                                                  15290000
153000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15300000
153100                                   TO PV-LIST-ITEM-NUMBER.        15310000
153200                                                                  15320000
153300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15330000
153400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15340000
153500                                                                  15350000
153600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15360000
153700        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      15370000
153800         MOVE +1                   TO ASC-BLK-SUB                 15380000
153900                                                                  15390000
154000         PERFORM 5100-WRITE-TEMP-STORAGE                          15400000
154100                                                                  15410000
154200         MOVE +1                   TO PV-BLOCK-NUMBER             15420000
154300                                                                  15430000
154400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15440000
154500             PV-FIRST-BLOCK-IN-ARRAY - 1                          15450000
154600                                                                  15460000
154700         PERFORM                                                  15470000
154800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15480000
154900                                                                  15490000
155000             PERFORM 4410-READ-TEMP-STORAGE                       15500000
155100                                                                  15510000
155200             PERFORM 2141-CLEAR-SELECTED-INDS                     15520000
155300                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 15530000
155400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15540000
155500                                                                  15550000
155600             PERFORM 5100-WRITE-TEMP-STORAGE                      15560000
155700                                                                  15570000
155800             ADD +1                TO PV-BLOCK-NUMBER             15580000
155900                                                                  15590000
156000         END-PERFORM                                              15600000
156100                                                                  15610000
156200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15620000
156300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15630000
156400                                                                  15640000
156500         PERFORM                                                  15650000
156600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15660000
156700                   ASC-HIGHEST-BLOCK-WRITTEN                      15670000
156800                                                                  15680000
156900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15690000
157000                                   TO PV-BLOCK-NUMBER             15700000
157100                                                                  15710000
157200             PERFORM 4410-READ-TEMP-STORAGE                       15720000
157300                                                                  15730000
157400             PERFORM 2141-CLEAR-SELECTED-INDS                     15740000
157500                 VARYING ASC-ITEM-SUB                             15750000
157600                 FROM 1 BY 1                                      15760000
157700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15770000
157800                                                                  15780000
157900             PERFORM 5100-WRITE-TEMP-STORAGE                      15790000
158000                                                                  15800000
158100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15810000
158200                                                                  15820000
158300         END-PERFORM                                              15830000
158400                                                                  15840000
158500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15850000
158600                                   TO PV-BLOCK-NUMBER             15860000
158700                                                                  15870000
158800         PERFORM 4410-READ-TEMP-STORAGE                           15880000
158900     END-IF.                                                      15890000
159000                                                                  15900000
159100     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 15910000
159200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.15920000
159300     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  15930000
159400                                                                  15940000
159500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15950000
159600                                                                  15960000
159700/                                                                 15970000
159800*----------------------------------------------------------------*15980000
159900*    MARK EACH ITEM AS BEING NOT SELECTED.                       *15990000
160000*----------------------------------------------------------------*16000000
160100                                                                  16010000
160200 2141-CLEAR-SELECTED-INDS.                                        16020000
160300                                                                  16030000
160400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16040000
160500             NOT EQUAL ZERO                                       16050000
160600         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16060000
160700             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16070000
160800                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    16080000
160900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16090000
161000                                   TO TRUE                        16100000
161100         END-IF                                                   16110000
161200     END-IF.                                                      16120000
161300                                                                  16130000
161400/                                                                 16140000
161500*----------------------------------------------------------------*16150000
161600*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *16160000
161700*  FOR ALL ITEMS.                                                *16170000
161800*----------------------------------------------------------------*16180000
161900                                                                  16190000
162000 2150-SELECT-ALL-ITEMS.                                           16200000
162100                                                                  16210000
162200     MOVE +1                       TO ASC-BLK-SUB.                16220000
162300                                                                  16230000
162400     PERFORM 2151-SET-SELECTED-INDS                               16240000
162500         VARYING ASC-ITEM-SUB                                     16250000
162600         FROM 1 BY 1                                              16260000
162700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16270000
162800                                                                  16280000
162900     ADD +1                        TO ASC-BLK-SUB.                16290000
163000                                                                  16300000
163100     PERFORM 2151-SET-SELECTED-INDS                               16310000
163200         VARYING ASC-ITEM-SUB                                     16320000
163300         FROM 1 BY 1                                              16330000
163400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16340000
163500                                                                  16350000
163600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16360000
163700                                   TO PV-LIST-ITEM-NUMBER.        16370000
163800                                                                  16380000
163900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16390000
164000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16400000
164100                                                                  16410000
164200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16420000
164300        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    16430000
164400         MOVE +1                   TO ASC-BLK-SUB                 16440000
164500                                                                  16450000
164600         PERFORM 5100-WRITE-TEMP-STORAGE                          16460000
164700                                                                  16470000
164800         MOVE +1                   TO PV-BLOCK-NUMBER             16480000
164900                                                                  16490000
165000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16500000
165100             PV-FIRST-BLOCK-IN-ARRAY - 1                          16510000
165200                                                                  16520000
165300         PERFORM                                                  16530000
165400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16540000
165500                                                                  16550000
165600             PERFORM 4410-READ-TEMP-STORAGE                       16560000
165700                                                                  16570000
165800             PERFORM 2151-SET-SELECTED-INDS                       16580000
165900                 VARYING ASC-ITEM-SUB                             16590000
166000                 FROM 1 BY 1                                      16600000
166100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16610000
166200                                                                  16620000
166300             PERFORM 5100-WRITE-TEMP-STORAGE                      16630000
166400                                                                  16640000
166500             ADD +1                TO PV-BLOCK-NUMBER             16650000
166600                                                                  16660000
166700         END-PERFORM                                              16670000
166800                                                                  16680000
166900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16690000
167000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16700000
167100                                                                  16710000
167200         PERFORM                                                  16720000
167300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16730000
167400                   ASC-HIGHEST-BLOCK-WRITTEN                      16740000
167500                                                                  16750000
167600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16760000
167700                                   TO PV-BLOCK-NUMBER             16770000
167800                                                                  16780000
167900             PERFORM 4410-READ-TEMP-STORAGE                       16790000
168000                                                                  16800000
168100             PERFORM 2151-SET-SELECTED-INDS                       16810000
168200                 VARYING ASC-ITEM-SUB                             16820000
168300                 FROM 1 BY 1                                      16830000
168400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16840000
168500                                                                  16850000
168600             PERFORM 5100-WRITE-TEMP-STORAGE                      16860000
168700                                                                  16870000
168800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16880000
168900                                                                  16890000
169000         END-PERFORM                                              16900000
169100                                                                  16910000
169200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16920000
169300                                   TO PV-BLOCK-NUMBER             16930000
169400                                                                  16940000
169500         PERFORM 4410-READ-TEMP-STORAGE                           16950000
169600     END-IF.                                                      16960000
169700                                                                  16970000
169800                                                                  16980000
169900     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             16990000
170000                       ASC-NUMBER-OF-SELECTED-ITEMS.              17000000
170100     SUBTRACT PV-NOT-SELECTED  FROM                               17010000
170200                       ASC-NUMBER-OF-SELECTED-ITEMS.              17020000
170300                                                                  17030000
170400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17040000
170500                                                                  17050000
170600/                                                                 17060000
170700*----------------------------------------------------------------*17070000
170800*    MARK EACH ITEM AS BEING SELECTED.                           *17080000
170900*----------------------------------------------------------------*17090000
171000                                                                  17100000
171100 2151-SET-SELECTED-INDS.                                          17110000
171200                                                                  17120000
171300     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17130000
171400             NOT EQUAL ZERO                                       17140000
171500         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17150000
171600             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17160000
171700                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        17170000
171800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17180000
171900                               TO  TRUE                           17190000
172000         END-IF                                                   17200000
172100         IF   DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              17210000
172200              IF  ASC-STATUS-VRFD (ASC-BLK-SUB ASC-ITEM-SUB)      17220000
172300                  SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)     17230000
172400                      ASC-TEMP-NO-SELECT                          17240000
172500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17250000
172600                               TO TRUE                            17260000
172700                  ADD  1  TO  PV-NOT-SELECTED                     17270000
172800              ELSE                                                17280000
172900                  MOVE  ZEROES TO ASC-ITEM-QTY                    17290000
173000                              (ASC-BLK-SUB ASC-ITEM-SUB)          17300000
173100                  SET ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB) 17310000
173200                               TO  TRUE                           17320000
173300             END-IF                                               17330000
173400         END-IF                                                   17340000
173500     END-IF.                                                      17350000
173600                                                                  17360000
173700*----------------------------------------------------------------*17370000
173800*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *17380000
173900*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *17390000
174000*----------------------------------------------------------------*17400000
174100                                                                  17410000
174200 2200-MOVE-SCREEN-TO-COMMAREA.                                    17420000
174300                                                                  17430000
174400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             17440000
174500     MOVE +1                       TO PV-SUB.                     17450000
174600                                                                  17460000
174700     IF  ASTRTITL > ZERO                                          17470000
174800         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          17480000
174900     ELSE                                                         17490000
175000         IF  ASTRTITF EQUAL DP015-ERASE-EOF                       17500000
175100             INITIALIZE ASC-START-ITEM-REQUEST                    17510000
175200         END-IF                                                   17520000
175300     END-IF.                                                      17530000
175400                                                                  17540000
175500     PERFORM 3100-SET-SUBSCRIPTS.                                 17550000
175600                                                                  17560000
175700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          17570000
175800         VARYING PV-SUB                                           17580000
175900         FROM 1 BY 1                                              17590000
176000         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      17600000
176100                                                                  17610000
176200******************************************************************17620000
176300** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**17630000
176400******************************************************************17640000
176500                                                                  17650000
176600 2210-MOVE-LINES-TO-COMMAREA.                                     17660000
176700                                                                  17670000
176800     IF  MR-SELECTL (PV-SUB) > ZERO                               17680000
176900         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             17690000
177000         MOVE MR-SELECTI (PV-SUB)                                 17700000
177100                                   TO ASC-TEMP-SELECTED-SW        17710000
177200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17720000
177300     ELSE                                                         17730000
177400         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                17740000
177500                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     17750000
177600                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        17760000
177700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17770000
177800         END-IF                                                   17780000
177900     END-IF.                                                      17790000
178000                                                                  17800000
178100     IF  MR-ITEM-QTYL (PV-SUB) > ZERO                             17810000
178200         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             17820000
178300         MOVE MR-ITEM-QTY-I (PV-SUB)                              17830000
178400                                   TO ASC-ITEM-QTY-X              17840000
178500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17850000
178600     ELSE                                                         17860000
178700         IF  MR-ITEM-QTYA (PV-SUB) = DP015-ERASE-EOF              17870000
178800                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     17880000
178900                 MOVE ZERO         TO  ASC-ITEM-QTY               17890000
179000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17900000
179100                                       PV-DISPLAY-NO-ZERO         17910000
179200                 MOVE PV-DISPLAY-NO-ZERO                          17920000
179300                                    TO MR-ITEM-QTY-X (PV-SUB)     17930000
179400         END-IF                                                   17940000
179500     END-IF.                                                      17950000
179600                                                                  17960000
179700     ADD +1                        TO ASC-ITEM-SUB.               17970000
179800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        17980000
179900         ADD +1                    TO ASC-BLK-SUB                 17990000
180000         MOVE +1                   TO ASC-ITEM-SUB                18000000
180100     END-IF.                                                      18010000
180200                                                                  18020000
180300*----------------------------------------------------------------*18030000
180400*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *18040000
180500*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *18050000
180600*----------------------------------------------------------------*18060000
180700                                                                  18070000
180800 3000-EDIT-DATA-IN-COMMAREA.                                      18080000
180900                                                                  18090000
181000     SET PS-NO-ERROR               TO TRUE.                       18100000
181100                                                                  18110021
181200* REMOVED DMH - 1/20/04 - BEGIN                                   18120021
181300*    IF ASC-AUTO-VE-YES                                           18130021
181400*       CONTINUE                                                  18140021
181500*    ELSE                                                         18150021
181600*       PERFORM 3200-RESET-ATTRIBUTES                             18160021
181700*    END-IF.                                                      18170021
181800* REMOVED DMH - 1/20/04 - END                                     18180021
181900                                                                  18190021
182000     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     18200000
182100**                                                                18210000
182200* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              18220000
182300* EDITTING IS DONE FROM THE BOTTOM UP.                            18230000
182400**                                                                18240000
182500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       18250000
182600         ASC-ITEMS-DISPLAYED - 1.                                 18260000
182700     PERFORM 3100-SET-SUBSCRIPTS.                                 18270000
182800     SET PS-NO-SMOOTHED-STORE     TO TRUE.                        18280000
182900     SET ASC-VERIFY-OK            TO TRUE.                        18290036
183000     PERFORM 3300-EDIT-SELECTIONS                                 18300000
183100         VARYING PV-SUB                                           18310000
183200         FROM PV-SUB BY -1                                        18320000
183300         UNTIL PV-SUB < +1.                                       18330000
183400                                                                  18340000
183500     IF  PS-NO-ERROR                                              18350000
183600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        18360000
183700     END-IF.                                                      18370000
183800                                                                  18380000
183900     IF  ((PS-NO-ERROR)                                           18390000
184000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   18400000
184100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    18410000
184200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  18420000
184300     END-IF.                                                      18430000
184400/                                                                 18440000
184500*----------------------------------------------------------------*18450000
184600*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *18460000
184700*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*18470000
184800*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *18480000
184900*                                                                *18490000
185000*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *18500000
185100*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *18510000
185200*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *18520000
185300*    US IN THE 2ND BLOCK OF THE ARRAY.                           *18530000
185400*----------------------------------------------------------------*18540000
185500                                                                  18550000
185600 3100-SET-SUBSCRIPTS.                                             18560000
185700                                                                  18570000
185800     COMPUTE ASC-ITEM-SUB =                                       18580000
185900         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        18590000
186000                                                                  18600000
186100     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         18610000
186200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            18620000
186300                                                                  18630000
186400         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               18640000
186500     ELSE                                                         18650000
186600         MOVE +1                     TO ASC-BLK-SUB               18660000
186700     END-IF.                                                      18670000
186800                                                                  18680000
186900*----------------------------------------------------------------*18690000
187000*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *18700000
187100*----------------------------------------------------------------*18710000
187200                                                                  18720000
187300                                                                  18730000
187400 3200-RESET-ATTRIBUTES.                                           18740000
187500                                                                  18750000
187600     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   18760000
187700     MOVE DP015-GREEN              TO ASTRTITC.                   18770000
187800     MOVE DP015-UNDERLINE          TO ASTRTITH.                   18780000
187900     SET PS-ALL-LINES-PROTECTED    TO TRUE.                       18790000
188000                                                                  18800000
188100     PERFORM                                                      18810000
188200         VARYING PV-SUB                                           18820000
188300         FROM 1 BY 1                                              18830000
188400         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                       18840000
188500                                                                  18850000
188600         IF MR-ITEM-QTYA (PV-SUB) = DP015-ASK-DRK-OFF             18860000
188700              CONTINUE                                            18870000
188800         ELSE                                                     18880000
188900             IF ASC-OVERAGE                                       18890000
189000                 IF MR-ITEM-QTYC (PV-SUB) = DP015-YELLOW          18900000
189100                     MOVE DP015-PRO-NOR-OFF                       18910000
189200                                     TO MR-SELECTA  (PV-SUB)      18920000
189300                     MOVE DP015-PRO-NOR-OFF                       18930000
189400                                     TO MR-ITEM-QTYA (PV-SUB)     18940000
189500                     MOVE DP015-UNDERLINE                         18950000
189600                                     TO MR-SELECTH  (PV-SUB)      18960000
189700                                        MR-ITEM-QTYH (PV-SUB)     18970000
189800                     MOVE DP015-BLUE                              18980000
189900                                     TO MR-SELECTC  (PV-SUB)      18990000
190000                 ELSE                                             19000000
190100                     MOVE DP015-PRO-NOR-OFF                       19010000
190200                                     TO MR-SELECTA  (PV-SUB)      19020000
190300                     MOVE SPACE      TO MR-SELECTI  (PV-SUB)      19030000
190400                     MOVE DP015-PRO-NOR-OFF                       19040000
190500                                     TO MR-ITEM-QTYA (PV-SUB)     19050000
190600                     IF MR-ITEM-QTYC (PV-SUB) =                   19060000
190700                                        DP015-GREEN               19070000
190800                          MOVE DP015-BLUE                         19080000
190900                                         TO MR-ITEM-QTYC (PV-SUB) 19090000
191000                          ELSE                                    19100000
191100                             CONTINUE                             19110000
191200                     END-IF                                       19120000
191300                     MOVE DP015-BLUE                              19130000
191400                                      TO MR-SELECTC  (PV-SUB)     19140000
191500                     MOVE DP015-UNDERLINE                         19150000
191600                                       TO MR-SELECTH  (PV-SUB)    19160000
191700                                            MR-ITEM-QTYH (PV-SUB) 19170000
191800                     END-IF                                       19180000
191900             ELSE                                                 19190000
192000                     MOVE DP015-UNP-ALP-NOR-OFF                   19200000
192100                                     TO MR-SELECTA  (PV-SUB)      19210000
192200                     MOVE DP015-UNP-NUM-NOR-OFF                   19220000
192300                                     TO MR-ITEM-QTYA (PV-SUB)     19230000
192400                     MOVE DP015-GREEN                             19240000
192500                                     TO MR-SELECTC  (PV-SUB)      19250000
192600                                        MR-ITEM-QTYC (PV-SUB)     19260000
192700                     MOVE DP015-BLUE                              19270000
192800                                     TO MR-ORD-LNE-NBRC (PV-SUB)  19280000
192900                     MOVE DP015-UNDERLINE                         19290000
193000                                     TO MR-SELECTH   (PV-SUB)     19300000
193100                                        MR-ITEM-QTYH (PV-SUB)     19310000
193200             END-IF                                               19320000
193300        END-IF                                                    19330000
193400     END-PERFORM.                                                 19340000
193500                                                                  19350000
193600*----------------------------------------------------------------*19360000
193700*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *19370000
193800*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *19380000
193900*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *19390000
194000*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *19400000
194100*----------------------------------------------------------------*19410000
194200                                                                  19420000
194300 3300-EDIT-SELECTIONS.                                            19430000
194400                                                                  19440000
194500     EVALUATE TRUE                                                19450000
194600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19460000
194700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         19470000
194800               IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      19480000
194900                   CONTINUE                                       19490000
195000               ELSE                                               19500000
195100                 IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)         19510000
195200                    IF ASC-MANUAL-NO (ASC-BLK-SUB ASC-ITEM-SUB)   19520000
195300                        SET ASC-CONFIRM-UPDATE TO TRUE            19530000
195400                    END-IF                                        19540000
195500                    IF ASC-NO-UPDATE-ALLOWED                      19550036
195600                                  (ASC-BLK-SUB ASC-ITEM-SUB)      19560036
195700                       SET ASC-STOP-VERIFY   TO TRUE              19570036
195800                    END-IF                                        19580036
195900                 END-IF                                           19590000
196000                 IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)         19600000
196100                     PERFORM 7000-COUNT-SMOOTHED-CTNS             19610000
196200                     IF PV-DB2-COUNT > 0                          19620000
196300                         SET PS-SMOOTHED-STORE  TO TRUE           19630000
196400                         SET PS-ERROR           TO TRUE           19640000
196500                         MOVE PC-TSYMSG-02773                     19650000
196600                                 TO DP020-MSG-NUMBER              19660000
196700                         SET PS-ERROR                             19670000
196800                             DP020-MSG-FATAL                      19680000
196900                             DP030-SET-CURSOR-APPL-1              19690000
197000                                            TO TRUE               19700000
197100                         MOVE -1            TO MR-SELECTL (PV-SUB)19710000
197200                         MOVE DP015-RED     TO MR-SELECTC (PV-SUB)19720000
197300                         MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)19730000
197400                     END-IF                                       19740000
197500                 END-IF                                           19750000
197600               END-IF                                             19760000
197700                                                                  19770010
197800                 IF (DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID) OR     19780010
197900                     DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)) AND   19790011
198000                       ASC-AUTO-VE-YES                            19800016
198100                        IF  ASC-PBS-UPDATE-YES                    19810046
198200                            CONTINUE                              19820046
198300                        ELSE                                      19830046
198400                            SET PS-ERROR           TO TRUE        19840046
198500                            MOVE PC-TSYMSG-03180                  19850046
198600                                    TO DP020-MSG-NUMBER           19860046
198700                            SET PS-ERROR                          19870046
198800                                DP020-MSG-FATAL                   19880046
198900                                DP030-SET-CURSOR-APPL-1           19890046
199000                                                TO TRUE           19900046
199100                        MOVE -1            TO MR-SELECTL (PV-SUB) 19910011
199200                        MOVE DP015-RED     TO MR-SELECTC (PV-SUB) 19920011
199300                        MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB) 19930011
199400                        END-IF                                    19940046
199500                 END-IF                                           19950046
199600                                                                  19960010
199700         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         19970000
199800             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        19980000
199900                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   19990000
200000                 MOVE ASC-TEMP-SELECTED-SW                        20000000
200100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20010000
200200                                TO ASC-SELECTED-SW                20020000
200300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20030000
200400                 IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)         20040000
200500                    IF ASC-MANUAL-NO (ASC-BLK-SUB ASC-ITEM-SUB)   20050000
200600                        SET ASC-CONFIRM-UPDATE TO TRUE            20060000
200700                    END-IF                                        20070000
200800                    IF ASC-NO-UPDATE-ALLOWED                      20080036
200900                                  (ASC-BLK-SUB ASC-ITEM-SUB)      20090036
201000                       SET ASC-STOP-VERIFY   TO TRUE              20100036
201100                    END-IF                                        20110036
201200                 END-IF                                           20120000
201300                 IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)         20130000
201400                     PERFORM 7000-COUNT-SMOOTHED-CTNS             20140000
201500                     IF PV-DB2-COUNT > 0                          20150000
201600                         SET PS-SMOOTHED-STORE  TO TRUE           20160000
201700                         SET PS-ERROR           TO TRUE           20170000
201800                         MOVE PC-TSYMSG-02773                     20180000
201900                                 TO DP020-MSG-NUMBER              20190000
202000                         SET PS-ERROR                             20200000
202100                             DP020-MSG-FATAL                      20210000
202200                             DP030-SET-CURSOR-APPL-1              20220000
202300                                            TO TRUE               20230000
202400                         MOVE -1            TO MR-SELECTL (PV-SUB)20240000
202500                         MOVE DP015-RED     TO MR-SELECTC (PV-SUB)20250000
202600                         MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)20260000
202700                     END-IF                                       20270000
202800                 END-IF                                           20280000
202900             END-IF                                               20290000
203000                                                                  20300000
203100                 IF (DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID) OR     20310012
203200                     DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)) AND   20320012
203300                       ASC-AUTO-VE-YES                            20330016
203400                        IF ASC-PBS-UPDATE-YES                     20340046
203500                            CONTINUE                              20350046
203600                        ELSE                                      20360046
203700                            SET PS-ERROR           TO TRUE        20370046
203800                            MOVE PC-TSYMSG-03180                  20380046
203900                                    TO DP020-MSG-NUMBER           20390046
204000                            SET PS-ERROR                          20400046
204100                                DP020-MSG-FATAL                   20410046
204200                                DP030-SET-CURSOR-APPL-1           20420046
204300                                            TO TRUE               20430012
204400                        MOVE -1            TO MR-SELECTL (PV-SUB) 20440012
204500                        MOVE DP015-RED     TO MR-SELECTC (PV-SUB) 20450012
204600                        MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB) 20460012
204700                        END-IF                                    20470046
204800                 END-IF                                           20480046
204900                                                                  20490046
205000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20500046
205100                 = SPACE                                          20510046
205200             EVALUATE TRUE                                        20520046
205300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       20530046
205400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS20540046
205500                     MOVE SPACE TO ASC-SELECTED-SW                20550046
205600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20560046
205700                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        20570046
205800                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    20580046
205900                     MOVE SPACE TO ASC-SELECTED-SW                20590046
206000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20600046
206100                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          20610046
206200                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      20620000
206300                     MOVE SPACE TO ASC-SELECTED-SW                20630000
206400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20640000
206500             END-EVALUATE                                         20650000
206600                                                                  20660000
206700         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           20670000
206800             SET ASC-RANGE-ON TO TRUE                             20680000
206900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20690000
207000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    20700000
207100             END-IF                                               20710000
207200             IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)             20720000
207300                IF ASC-MANUAL-NO (ASC-BLK-SUB ASC-ITEM-SUB)       20730000
207400                     SET ASC-CONFIRM-UPDATE TO TRUE               20740000
207500                END-IF                                            20750000
207600                IF ASC-NO-UPDATE-ALLOWED                          20760037
207700                              (ASC-BLK-SUB ASC-ITEM-SUB)          20770037
207800                   SET ASC-STOP-VERIFY   TO TRUE                  20780037
207900                END-IF                                            20790037
208000             END-IF                                               20800000
208100             PERFORM 3310-EDIT-RANGE                              20810000
208200                                                                  20820000
208300         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             20830000
208400             SET ASC-RANGE-OFF TO TRUE                            20840000
208500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20850000
208600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    20860000
208700             END-IF                                               20870000
208800             IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)             20880000
208900                IF ASC-MANUAL-NO (ASC-BLK-SUB ASC-ITEM-SUB)       20890000
209000                     SET ASC-CONFIRM-UPDATE TO TRUE               20900000
209100                END-IF                                            20910000
209200                IF ASC-NO-UPDATE-ALLOWED                          20920036
209300                              (ASC-BLK-SUB ASC-ITEM-SUB)          20930036
209400                   SET ASC-STOP-VERIFY   TO TRUE                  20940036
209500                END-IF                                            20950036
209600             END-IF                                               20960000
209700             PERFORM 3310-EDIT-RANGE                              20970000
209800                                                                  20980000
209900         WHEN OTHER                                               20990000
210000             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           21000000
210100             SET DP020-MSG-FATAL    TO TRUE                       21010000
210200             MOVE -1                TO MR-SELECTL (PV-SUB)        21020000
210300             SET DP030-SET-CURSOR-APPL-1                          21030000
210400                                    TO TRUE                       21040000
210500             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        21050000
210600             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        21060000
210700             SET PS-ERROR TO TRUE                                 21070000
210800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21080000
210900                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     21090000
211000                 MOVE SPACE         TO ASC-SELECTED-SW            21100000
211100                                        (ASC-BLK-SUB ASC-ITEM-SUB)21110000
211200             END-IF                                               21120000
211300                                                                  21130000
211400     END-EVALUATE.                                                21140000
211500                                                                  21150000
211600     IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                    21160000
211700     OR  ASC-BEGIN  (ASC-BLK-SUB ASC-ITEM-SUB)                    21170000
211800     OR  ASC-RANGE-ON                                             21180000
211900         MOVE ASC-ITEM-QTY-X  (ASC-BLK-SUB ASC-ITEM-SUB)          21190000
212000                                    TO  PV-WORK-QTY-X             21200000
212100         PERFORM 3320-VALIDATE-QUANTITY                           21210000
212200     END-IF.                                                      21220000
212300                                                                  21230000
212400     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 21240000
212500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               21250000
212600     IF  ASC-ITEM-SUB < 1                                         21260000
212700         SUBTRACT +1 FROM ASC-BLK-SUB                             21270000
212800         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                21280000
212900     END-IF.                                                      21290000
213000                                                                  21300000
213100*----------------------------------------------------------------*21310000
213200*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *21320000
213300*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *21330000
213400*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *21340000
213500*  THE ENDING.                                                   *21350000
213600*----------------------------------------------------------------*21360000
213700                                                                  21370000
213800 3310-EDIT-RANGE.                                                 21380000
213900                                                                  21390000
214000     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                21400000
214100         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   21410000
214200             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)21420000
214300                                   TO ASC-SELECTED-SW             21430000
214400                                        (ASC-BLK-SUB ASC-ITEM-SUB)21440000
214500             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 21450000
214600         ELSE                                                     21460000
214700             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     21470000
214800                 CONTINUE                                         21480000
214900             ELSE                                                 21490000
215000*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        21500000
215100                 MOVE PC-TSYMSG-00054                             21510000
215200                                   TO DP020-MSG-NUMBER            21520000
215300                 SET DP020-MSG-FATAL                              21530000
215400                                   TO TRUE                        21540000
215500                 MOVE -1           TO MR-SELECTL (PV-SUB)         21550000
215600                 SET DP030-SET-CURSOR-APPL-1                      21560000
215700                                   TO TRUE                        21570000
215800                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         21580000
215900                 MOVE DP015-UNDERLINE                             21590000
216000                                   TO MR-SELECTH (PV-SUB)         21600000
216100                 SET PS-ERROR      TO TRUE                        21610000
216200             END-IF                                               21620000
216300         END-IF                                                   21630000
216400     ELSE                                                         21640000
216500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     21650000
216600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 21660000
216700                                   TO ASC-SELECTED-SW             21670000
216800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21680000
216900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   21690000
217000         ELSE                                                     21700000
217100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       21710000
217200                 CONTINUE                                         21720000
217300             ELSE                                                 21730000
217400*                -- ONLY ONE END-OF-RANGE ALLOWED --              21740000
217500                 MOVE PC-TSYMSG-00055                             21750000
217600                                   TO DP020-MSG-NUMBER            21760000
217700                 SET DP020-MSG-FATAL                              21770000
217800                                   TO TRUE                        21780000
217900                 MOVE -1           TO MR-SELECTL (PV-SUB)         21790000
218000                 SET DP030-SET-CURSOR-APPL-1                      21800000
218100                                   TO TRUE                        21810000
218200                 SET PS-ERROR      TO TRUE                        21820000
218300             END-IF                                               21830000
218400         END-IF                                                   21840000
218500     END-IF.                                                      21850000
218600                                                                  21860000
218700 3320-VALIDATE-QUANTITY.                                          21870000
218800                                                                  21880000
218900     MOVE PV-WORK-QTY-X          TO  DP010I-UNEDITED-FIELD.       21890000
219000     MOVE PC-5                   TO  DP010I-MAXIMUM-DIGITS.       21900000
219100     MOVE ZERO                   TO  DP010I-MAXIMUM-DECIMALS.     21910000
219200     SET DP010I-NEGATIVE-NOT-ALLOWED                              21920000
219300                                 TO  TRUE.                        21930000
219410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             21941049
219420          USING DP010I-NUMERIC-EDIT-AREA.                         21942049
219500                                                                  21950000
219600     IF  DP010I-ERROR-DETECTED                                    21960000
219700         MOVE PC-TSYMSG-00008    TO  DP020-MSG-NUMBER             21970000
219800         SET DP020-MSG-FATAL                                      21980000
219900             PS-ERROR            TO  TRUE                         21990000
220000         MOVE -1                 TO  MR-ITEM-QTYL (PV-SUB)        22000000
220100         MOVE DP015-RED          TO  MR-ITEM-QTYC (PV-SUB)        22010000
220200         MOVE DP015-REVERSE      TO  MR-ITEM-QTYH (PV-SUB)        22020000
220300         SET DP030-SET-CURSOR-APPL-1                              22030000
220400                                 TO  TRUE                         22040000
220500     ELSE                                                         22050000
220600         MOVE DP010I-NUMERIC-FIELD                                22060000
220700                                 TO  ASC-ITEM-QTY                 22070000
220800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22080000
220900                                     MR-ITEM-QTY-X(PV-SUB)        22090000
221000     END-IF.                                                      22100000
221100                                                                  22110000
221200*----------------------------------------------------------------*22120000
221300*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *22130000
221400*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *22140000
221500*----------------------------------------------------------------*22150000
221600                                                                  22160000
221700 3400-CHECK-RANGE-SEQUENCE.                                       22170000
221800                                                                  22180000
221900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       22190000
222000       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      22200000
222100       AND  ASC-START-OF-SELECTED-RANGE >                         22210000
222200                                         ASC-END-OF-SELECTED-RANGE22220000
222300*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                22230000
222400         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 22240000
222500         SET DP020-MSG-FATAL TO TRUE                              22250000
222600         SET PS-ERROR TO TRUE                                     22260000
222700         PERFORM 3410-POSITION-AT-ERROR                           22270000
222800     END-IF.                                                      22280000
222900                                                                  22290000
223000*----------------------------------------------------------------*22300000
223100*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *22310000
223200*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *22320000
223300*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *22330000
223400*----------------------------------------------------------------*22340000
223500                                                                  22350000
223600 3410-POSITION-AT-ERROR.                                          22360000
223700                                                                  22370000
223800     SET DP030-SET-CURSOR-APPL-1                                  22380000
223900                                   TO TRUE.                       22390000
224000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 22400000
224100                    - PV-TOP-ITEM + 1.                            22410000
224200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22420000
224300         CONTINUE                                                 22430000
224400     ELSE                                                         22440000
224500         MOVE -1                   TO MR-SELECTL (PV-SUB)         22450000
224600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         22460000
224700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         22470000
224800     END-IF.                                                      22480000
224900*                                                                 22490000
225000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   22500000
225100                    - PV-TOP-ITEM + 1.                            22510000
225200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22520000
225300         CONTINUE                                                 22530000
225400     ELSE                                                         22540000
225500         MOVE -1                   TO MR-SELECTL (PV-SUB)         22550000
225600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         22560000
225700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         22570000
225800     END-IF.                                                      22580000
225900/                                                                 22590000
226000*----------------------------------------------------------------*22600000
226100*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *22610000
226200*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *22620000
226300*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *22630000
226400*----------------------------------------------------------------*22640000
226500                                                                  22650000
226600 3500-MARK-RANGE-AS-SELECTED.                                     22660000
226700                                                                  22670000
226800     MOVE +1                       TO  ASC-BLK-SUB.               22680000
226900     PERFORM 3510-MARK-SELECTED-INDS                              22690000
227000         VARYING ASC-ITEM-SUB                                     22700000
227100         FROM 1 BY 1                                              22710000
227200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22720000
227300                                                                  22730000
227400     ADD +1                        TO ASC-BLK-SUB.                22740000
227500     PERFORM 3510-MARK-SELECTED-INDS                              22750000
227600         VARYING ASC-ITEM-SUB                                     22760000
227700         FROM 1 BY 1                                              22770000
227800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22780000
227900                                                                  22790000
228000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               22800000
228100                                   TO  PV-LIST-ITEM-NUMBER.       22810000
228200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            22820000
228300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         22830000
228400               PC-ITEMS-PER-PANEL).                               22840000
228500                                                                  22850000
228600     MOVE ASC-START-OF-SELECTED-RANGE                             22860000
228700                                   TO PV-START-OF-SELECTED-RANGE. 22870000
228800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            22880000
228900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  22890000
229000               PC-ITEMS-PER-PANEL).                               22900000
229100                                                                  22910000
229200     MOVE ASC-END-OF-SELECTED-RANGE                               22920000
229300                                   TO  PV-END-OF-SELECTED-RANGE.  22930000
229400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             22940000
229500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    22950000
229600               PC-ITEMS-PER-PANEL).                               22960000
229700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             22970000
229800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             22980000
229900                                                                  22990000
230000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    23000000
230100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        23010000
230200         MOVE +1                   TO ASC-BLK-SUB                 23020000
230300         PERFORM 5100-WRITE-TEMP-STORAGE                          23030000
230400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23040000
230500             PV-FIRST-BLOCK-IN-ARRAY - 1                          23050000
230600                                                                  23060000
230700         PERFORM                                                  23070000
230800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      23080000
230900                   PV-PREV-BLOCK-IN-ARRAY                         23090000
231000             MOVE PV-FIRST-BLOCK-IN-RANGE                         23100000
231100                                   TO PV-BLOCK-NUMBER             23110000
231200             PERFORM 4410-READ-TEMP-STORAGE                       23120000
231300             PERFORM 3510-MARK-SELECTED-INDS                      23130000
231400                 VARYING ASC-ITEM-SUB                             23140000
231500                 FROM 1 BY 1                                      23150000
231600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23160000
231700             PERFORM 5100-WRITE-TEMP-STORAGE                      23170000
231800             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     23180000
231900         END-PERFORM                                              23190000
232000                                                                  23200000
232100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         23210000
232200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     23220000
232300         PERFORM                                                  23230000
232400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       23240000
232500                   PV-LAST-BLOCK-IN-RANGE                         23250000
232600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          23260000
232700                                   TO PV-BLOCK-NUMBER             23270000
232800             PERFORM 4410-READ-TEMP-STORAGE                       23280000
232900             PERFORM 3510-MARK-SELECTED-INDS                      23290000
233000                 VARYING ASC-ITEM-SUB                             23300000
233100                 FROM 1 BY 1                                      23310000
233200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23320000
233300             PERFORM 5100-WRITE-TEMP-STORAGE                      23330000
233400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      23340000
233500         END-PERFORM                                              23350000
233600                                                                  23360000
233700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             23370000
233800                                   TO PV-BLOCK-NUMBER             23380000
233900         PERFORM 4410-READ-TEMP-STORAGE                           23390000
234000     END-IF.                                                      23400000
234100                                                                  23410000
234200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 23420000
234300                                      ASC-END-OF-SELECTED-RANGE.  23430000
234400/                                                                 23440000
234500*----------------------------------------------------------------*23450000
234600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *23460000
234700*----------------------------------------------------------------*23470000
234800                                                                  23480000
234900 3510-MARK-SELECTED-INDS.                                         23490000
235000                                                                  23500000
235100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         23510000
235200                                ASC-ITEM-SUB) >                   23520000
235300         ASC-START-OF-SELECTED-RANGE)                             23530000
235400     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         23540000
235500                                ASC-ITEM-SUB) =                   23550000
235600         ASC-START-OF-SELECTED-RANGE)                             23560000
235700                                                                  23570000
235800         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     23580000
235900                                    ASC-ITEM-SUB) <               23590000
236000             ASC-END-OF-SELECTED-RANGE)                           23600000
236100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     23610000
236200                                    ASC-ITEM-SUB) =               23620000
236300             ASC-END-OF-SELECTED-RANGE)                           23630000
236400                                                                  23640000
236500             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          23650000
236600                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   23660000
236700                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   23670000
236800                               TO TRUE                            23680000
236900                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              23690000
237000                               TO TRUE                            23700000
237100                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    23710000
237200             END-IF                                               23720000
237300         END-IF                                                   23730000
237400     END-IF.                                                      23740000
237500/                                                                 23750000
237600*----------------------------------------------------------------*23760000
237700*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *23770000
237800*    INITIALIZE ALL COUNTERS AND FLAGS.                          *23780000
237900*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *23790000
238000*    DISPLAY THE PANEL TO USER.                                  *23800000
238100*----------------------------------------------------------------*23810000
238200                                                                  23820000
238300 4000-BUILD-INITIAL-PANEL.                                        23830000
238400                                                                  23840000
238500     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            23850000
238600                                 ASC-BLOCK-ENTRIES (2).           23860000
238700     MOVE +1                 TO ASC-BLK-SUB.                      23870000
238800     SET ASC-ITEMS-LEFT-ON-DB                                     23880000
238900         ASC-CAN-VERIFY      TO TRUE.                             23890000
239000                                                                  23900000
239100     MOVE +0                 TO ASC-ITEM-SUB                      23910000
239200                                ASC-NUMBER-OF-ITEMS-READ          23920000
239300                                ASC-NUMBER-OF-SELECTED-ITEMS      23930000
239400                                ASC-HIGHEST-BLOCK-WRITTEN         23940000
239500                                ASC-START-OF-SELECTED-RANGE       23950000
239600                                ASC-END-OF-SELECTED-RANGE         23960000
239700                                ASC-ITEM-AT-TOP-OF-PANEL.         23970000
239800     PERFORM 4010-OPEN-CURSOR.                                    23980000
239900                                                                  23990000
240000     PERFORM 4300-READ-ITEMS-FROM-DB.                             24000000
240100                                                                  24010000
240200     PERFORM 4020-CLOSE-CURSOR.                                   24020000
240300                                                                  24030000
240400     MOVE +1                   TO  PV-TOP-ITEM.                   24040000
240500     MOVE SPACE                TO  ASC-START-ITEM-REQUEST.        24050000
240600     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          24060000
240700         SET DP020-FK-RETURN (DP020-SRC-AID)                      24070000
240800             DP020-MSG-FATAL   TO  TRUE                           24080000
240900         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               24090000
241000     ELSE                                                         24100000
241100         SET DP030-SET-CURSOR-APPL-1                              24110000
241200                               TO TRUE                            24120000
241300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     24130000
241400     END-IF.                                                      24140000
241500/                                                                 24150000
241600*----------------------------------------------------------------*24160000
241700* OPEN THE CURSOR.                                               *24170000
241800*----------------------------------------------------------------*24180000
241900                                                                  24190000
242000 4010-OPEN-CURSOR.                                                24200000
242100                                                                  24210000
242200     EXEC SQL                                                     24220000
242300          OPEN LIST-CSR                                           24230000
242400     END-EXEC.                                                    24240000
242500                                                                  24250000
242600     EVALUATE TRUE                                                24260000
242700         WHEN SQLCODE = ZERO                                      24270000
242800         WHEN SQLCODE = +100                                      24280000
242900              CONTINUE                                            24290000
243000         WHEN SQLCODE = -904                                      24300000
243100         WHEN SQLCODE = -911                                      24310000
243200         WHEN SQLCODE = -913                                      24320000
243300              PERFORM 9900-SOFT-ABORT                             24330000
243400         WHEN SQLWARN0 NOT = SPACES                               24340000
243500         WHEN SQLCODE < ZERO                                      24350000
243600         WHEN SQLCODE > ZERO                                      24360000
243700              MOVE '4010-OPEN-CURSOR'                             24370000
243800                                   TO  DP013-PARAGRAPH            24380000
243900              MOVE 'OPEN LIST CURSOR - '                          24390000
244000                                   TO  DP013-MESSAGE-TEXT (1)     24400000
244100              MOVE SQLCA           TO  DP013-SQLCA                24410000
244200              MOVE 'TRECEIV '      TO  DP013-DB2-TABLE-NAME (1)   24420000
244300              MOVE 'TRECITM '      TO  DP013-DB2-TABLE-NAME (2)   24430000
244400              SET DP013-DB2-ABEND                                 24440000
244500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              24450000
244600                 PERFORM DP013-0000-PROCESS-ABEND                 24460000
244700         END-EVALUATE.                                            24470000
244800/                                                                 24480000
244900*----------------------------------------------------------------*24490000
245000* CLOSE THE TRECITM CURSOR.                                      *24500000
245100*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *24510000
245200*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *24520000
245300*   USER.                                                        *24530000
245400*----------------------------------------------------------------*24540000
245500                                                                  24550000
245600 4020-CLOSE-CURSOR.                                               24560000
245700                                                                  24570000
245800     EXEC SQL                                                     24580000
245900          CLOSE LIST-CSR                                          24590000
246000     END-EXEC.                                                    24600000
246100                                                                  24610000
246200     EVALUATE TRUE                                                24620000
246300         WHEN SQLCODE = ZERO                                      24630000
246400             CONTINUE                                             24640000
246500         WHEN SQLCODE = -904                                      24650000
246600         WHEN SQLCODE = -911                                      24660000
246700         WHEN SQLCODE = -913                                      24670000
246800              PERFORM 9900-SOFT-ABORT                             24680000
246900         WHEN SQLWARN0 NOT = SPACES                               24690000
247000         WHEN SQLCODE < ZERO                                      24700000
247100         WHEN SQLCODE > ZERO                                      24710000
247200             MOVE '4020-CLOSE-CURSOR'                             24720000
247300                               TO DP013-PARAGRAPH                 24730000
247400             MOVE 'CLOSE LIST CURSOR '                            24740000
247500                               TO DP013-MESSAGE-TEXT (1)          24750000
247600             MOVE SQLCA        TO DP013-SQLCA                     24760000
247700             MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)        24770000
247800             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        24780000
247900             SET DP013-DB2-ABEND                                  24790000
248000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               24800000
248100             PERFORM DP013-0000-PROCESS-ABEND                     24810000
248200     END-EVALUATE.                                                24820000
248300/                                                                 24830000
248400 4030-OPEN-TRECDVS.                                               24840000
248500                                                                  24850000
248600     EXEC SQL                                                     24860000
248700          OPEN RECDVS-CURSOR                                      24870000
248800     END-EXEC                                                     24880000
248900                                                                  24890000
249000     EVALUATE TRUE                                                24900000
249100         WHEN SQLCODE = ZERO                                      24910000
249200              CONTINUE                                            24920000
249300         WHEN SQLCODE = -904                                      24930000
249400         WHEN SQLCODE = -911                                      24940000
249500         WHEN SQLCODE = -913                                      24950000
249600             PERFORM 9900-SOFT-ABORT                              24960000
249700         WHEN SQLWARN0 NOT = SPACES                               24970000
249800         WHEN SQLCODE      NOT = ZERO                             24980000
249900              MOVE '4030-OPEN-TRECDVS'                            24990000
250000                             TO DP013-PARAGRAPH                   25000000
250100              MOVE 'UNSUCCESSFUL RECDVS CURSOR OPEN'              25010000
250200                             TO DP013-MESSAGE-TEXT (1)            25020000
250300              MOVE SQLCA         TO DP013-SQLCA                   25030000
250400              MOVE 'TRECDVS' TO DP013-DB2-TABLE-NAME (1)          25040000
250500              SET DP013-XCTL-DISPLAY-RESTART                      25050000
250600                  DP013-DB2-ABEND                                 25060000
250700                             TO TRUE                              25070000
250800                                                                  25080000
250900              PERFORM DP013-0000-PROCESS-ABEND                    25090000
251000     END-EVALUATE.                                                25100000
251100/                                                                 25110000
251200 4040-FETCH-RECDVS.                                               25120000
251300                                                                  25130000
251400     EXEC SQL                                                     25140000
251500           FETCH RECDVS-CURSOR                                    25150000
251600            INTO :RECDVS-VRFY-SRC-CDE                             25160000
251700                ,:RECDVS-VRFY-ITM-QTY                             25170000
251800     END-EXEC.                                                    25180000
251900                                                                  25190000
252000     EVALUATE TRUE                                                25200000
252100         WHEN SQLCODE = ZERO                                      25210000
252200             CONTINUE                                             25220000
252300         WHEN SQLCODE = +100                                      25230000
252400             SET PS-NO-MORE-RECDVS  TO TRUE                       25240000
252500         WHEN SQLCODE = -904                                      25250000
252600         WHEN SQLCODE = -911                                      25260000
252700         WHEN SQLCODE = -913                                      25270000
252800             PERFORM 9900-SOFT-ABORT                              25280000
252900         WHEN SQLWARN0 NOT = SPACES                               25290000
253000         WHEN SQLCODE  NOT = ZERO                                 25300000
253100              MOVE '4040-FETCH-RECDVS'                            25310000
253200                                 TO DP013-PARAGRAPH               25320000
253300              MOVE 'UNSUCCESSFUL FETCH OF RECDVS CURSOR'          25330000
253400                                 TO DP013-MESSAGE-TEXT (1)        25340000
253500              MOVE SQLCA         TO DP013-SQLCA                   25350000
253600              MOVE 'TRECDVS'     TO DP013-DB2-TABLE-NAME (1)      25360000
253700              SET DP013-DB2-ABEND                                 25370000
253800                  DP013-XCTL-DISPLAY-RESTART                      25380000
253900                                 TO TRUE                          25390000
254000                                                                  25400000
254100              PERFORM DP013-0000-PROCESS-ABEND                    25410000
254200     END-EVALUATE.                                                25420000
254300/                                                                 25430000
254400 4050-CLOSE-TRECDVS.                                              25440000
254500                                                                  25450000
254600     EXEC SQL                                                     25460000
254700          CLOSE RECDVS-CURSOR                                     25470000
254800     END-EXEC.                                                    25480000
254900                                                                  25490000
255000     EVALUATE TRUE                                                25500000
255100         WHEN SQLCODE = ZERO                                      25510000
255200              CONTINUE                                            25520000
255300         WHEN SQLCODE = -904                                      25530000
255400         WHEN SQLCODE = -911                                      25540000
255500         WHEN SQLCODE = -913                                      25550000
255600             PERFORM 9900-SOFT-ABORT                              25560000
255700         WHEN SQLWARN0 NOT = SPACES                               25570000
255800         WHEN SQLCODE  NOT = ZERO                                 25580000
255900              MOVE '4050-CLOSE-TRECDVS'                           25590000
256000                                 TO DP013-PARAGRAPH               25600000
256100              MOVE 'UNSUCCESSFUL RECDVS CURSOR CLOSE'             25610000
256200                                 TO DP013-MESSAGE-TEXT (1)        25620000
256300              MOVE SQLCA         TO DP013-SQLCA                   25630000
256400              MOVE 'TRECDVS '    TO DP013-DB2-TABLE-NAME (1)      25640000
256500              SET DP013-DB2-ABEND                                 25650000
256600                  DP013-XCTL-DISPLAY-RESTART                      25660000
256700                                 TO TRUE                          25670000
256800                                                                  25680000
256900              PERFORM DP013-0000-PROCESS-ABEND                    25690000
257000     END-EVALUATE.                                                25700000
257100/                                                                 25710000
257200*----------------------------------------------------------------*25720000
257300*    SET UP THE HOST VARIABLES.                                  *25730000
257400*----------------------------------------------------------------*25740000
257500                                                                  25750000
257600 4100-PREPARE-CURSOR.                                             25760000
257700                                                                  25770000
257800     MOVE RC012-OPER-UNT-ID       TO  ASC-OPER-UNT-ID.            25780000
257900     MOVE RC012-FCLTY-ID          TO  ASC-FCLTY-ID.               25790000
258000     MOVE RC012-PO-NBR            TO  ASC-PO-NBR.                 25800000
258100                                                                  25810000
258200     MOVE RC012-STR-NBR           TO  ASC-STR-NBR.                25820000
258300     MOVE RC012-REC-SEQ-NBR       TO  ASC-REC-SEQ-NBR.            25830000
258400     MOVE RC012-FCLTY-NME         TO  ASC-FCLTY-NME.              25840000
258500     MOVE RC012-PACK-BY-ST-SW     TO  ASC-PACK-BY-ST-SW           25850000
258600                                                                  25860000
258700     IF  RC012-PO-LNE-NBR GREATER THAN ZERO                       25870000
258800         MOVE RC012-PO-LNE-NBR    TO  ASC-ORD-LNE-NBR-LOW         25880000
258900                                      ASC-ORD-LNE-NBR-HIGH        25890000
259000     ELSE                                                         25900000
259100         MOVE ZERO                TO  ASC-ORD-LNE-NBR-LOW         25910000
259200         MOVE PC-9999             TO  ASC-ORD-LNE-NBR-HIGH        25920000
259300     END-IF.                                                      25930000
259400                                                                  25940000
259500     PERFORM 4150-CALL-AUTOVE-MODULE.                             25950012
259600                                                                  25960039
259700* DMH  6/17/2004 - BEGIN                                          25970040
259800                                                                  25980040
259900     IF  ASC-AUTO-VE-YES  AND                                     25990040
260000         ASC-PACK-BY-STORE                                        26000040
260100         SET  ASC-PBS-UPDATE-NO   TO  TRUE                        26010040
260200         PERFORM 4160-CHECK-FOR-PBS-CARTONS                       26020040
260300         IF  (PS-ACTIVE-PBS-UCC128-NO)  OR                        26030040
260400             (PS-ACTIVE-PBS-UCC128-YES  AND                       26040040
260500              PS-PBS-ERROR-CARTONS-YES)                           26050040
260600             SET  ASC-PBS-UPDATE-YES  TO  TRUE                    26060040
260700         ELSE                                                     26070040
260800             SET  ASC-PBS-UPDATE-NO   TO  TRUE                    26080040
260900         END-IF                                                   26090040
261000     END-IF.                                                      26100040
261100                                                                  26110040
261200* DMH  6/17/2004 - END                                            26120040
261300                                                                  26130040
261400/                                                                 26140000
261500*----------------------------------------------------------------*26150012
261600*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          26160012
261700*----------------------------------------------------------------*26170012
261800 4150-CALL-AUTOVE-MODULE.                                         26180012
261900                                                                  26190012
262000     INITIALIZE RC040-FIELDS.                                     26200012
262100     MOVE ASC-OPER-UNT-ID     TO RC040-SIGNON-LOCATION.           26210034
262200     MOVE ASC-PO-NBR          TO RC040-PO-NBR.                    26220031
262300     MOVE ASC-REC-SEQ-NBR     TO RC040-PO-RCVR.                   26230031
262400     MOVE DP020-USERID        TO RC040-USER-ID.                   26240031
262500     MOVE 'RCKCS231'          TO RC040-CALLING-PROGRAM.           26250031
262600                                                                  26260012
262700     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  26270012
262800                                        RC040-COMMAREA            26280012
262900                                        RC040-FIELDS.             26290012
263000                                                                  26300012
263100     EVALUATE TRUE                                                26310012
263200         WHEN RC040-SUCCESSFUL                                    26320012
263300              IF RC040-AUTO-VE-YES                                26330022
263400                 SET ASC-AUTO-VE-YES        TO TRUE               26340022
263500                 END-IF                                           26350022
263600                                                                  26360022
263700         WHEN RC040-INVALID-SQL                                   26370022
263800         WHEN RC040-DATABASE-BUSY                                 26380022
263900              MOVE ASC-PO-NBR             TO  PC-DISPLAY-PO       26390023
264000              MOVE ASC-REC-SEQ-NBR        TO  PC-DISPLAY-RCVR     26400023
264100              MOVE ASC-STR-NBR            TO  PC-DISPLAY-STORE    26410023
264200                 STRING ' RCKCS231 - CALL TO RCKUT127 - '         26420026
264300                   '4150-CALL-AUTOVE-MODULE '                     26430026
264400                        ' RETURN MESSAGE - '                      26440026
264500                        RC040-SUCCESS-IND     DELIMITED BY SIZE   26450012
264600                                         INTO PV-CICS-MSG-AREA    26460014
264700                    MOVE LENGTH OF PV-CICS-MSG-AREA2              26470012
264800                                        TO PV-COMMAREA-LENGTH     26480012
264900                 PERFORM 9700-WRITE-TO-CICS-LOG                   26490027
265000                                                                  26500027
265100                 INITIALIZE PV-CICS-MSG-AREA                      26510023
265200                 STRING ' RCKCS231 - CALL TO RCKUT127 - '         26520026
265300                         PC-DISPLAY-PO '-'                        26530023
265400                         PC-DISPLAY-RCVR '-'                      26540023
265500                        '  STORE-'                                26550023
265600                         PC-DISPLAY-STORE     DELIMITED BY SIZE   26560025
265700                                         INTO PV-CICS-MSG-AREA    26570023
265800                    MOVE LENGTH OF PV-CICS-MSG-AREA2              26580023
265900                                        TO PV-COMMAREA-LENGTH     26590023
266000                 PERFORM 9700-WRITE-TO-CICS-LOG                   26600027
266100                                                                  26610023
266200                 INITIALIZE PV-CICS-MSG-AREA                      26620023
266300                 MOVE RC040-CRA-RET-MSG TO PV-CICS-MSG-AREA       26630023
266400                 PERFORM 9700-WRITE-TO-CICS-LOG                   26640027
266500                 PERFORM 9900-SOFT-ABORT                          26650023
266600                                                                  26660023
266700         WHEN OTHER                                               26670023
266800              MOVE ASC-PO-NBR             TO  PC-DISPLAY-PO       26680023
266900              MOVE ASC-REC-SEQ-NBR        TO  PC-DISPLAY-RCVR     26690023
267000              MOVE ASC-STR-NBR            TO  PC-DISPLAY-STORE    26700023
267100              STRING ' RCKCS231 - CALL TO RCKUT127 (OTHER) - '    26710027
267200               '4150-CALL-AUTOVE-MODULE '                         26720026
267300                    ' RETURN MESSAGE - '                          26730026
267400                    RC040-SUCCESS-IND     DELIMITED BY SIZE       26740026
267500                                         INTO RC040-CRA-RET-MSG   26750026
267600              PERFORM 9700-WRITE-TO-CICS-LOG                      26760027
267700                                                                  26770027
267800                 INITIALIZE PV-CICS-MSG-AREA                      26780026
267900                 STRING ' RCKCS231 - CALL TO RCKUT127 - '         26790026
268000                         PC-DISPLAY-PO '-'                        26800026
268100                         PC-DISPLAY-RCVR '-'                      26810026
268200                        '  STORE-'                                26820026
268300                         PC-DISPLAY-STORE     DELIMITED BY SIZE   26830026
268400                                         INTO PV-CICS-MSG-AREA    26840026
268500                    MOVE LENGTH OF PV-CICS-MSG-AREA2              26850026
268600                                        TO PV-COMMAREA-LENGTH     26860026
268700             PERFORM 9700-WRITE-TO-CICS-LOG                       26870027
268800             PERFORM 9900-SOFT-ABORT                              26880027
268900                                                                  26890026
269000     END-EVALUATE.                                                26900026
269100                                                                  26910039
269200                                                                  26920039
269300* DMH  6/17/2004 - BEGIN                                          26930039
269400*----------------------------------------------------------------*26940039
269500* FOR AUTOVE PBS ORDERS - CHECK TO SEE IF CAN UPDATE STORE QTY    26950039
269600* CAN UPDATE PBS STORE UNIT QTY WHEN THE FOLLOWING IS TRUE        26960039
269700* -- NO USEABLE UCC128 DATA     (4170-CHECK-TSHPUNT)              26970039
269800* -- NO PBS ERROR CARTONS       (4175-CHECK-TSHUNLO)              26980039
269900*----------------------------------------------------------------*26990039
270000                                                                  27000039
270100 4160-CHECK-FOR-PBS-CARTONS.                                      27010039
270200     SET  PS-PBS-ERROR-CARTONS-NO                                 27020039
270300          PS-ACTIVE-PBS-UCC128-NO  TO  TRUE.                      27030039
270400                                                                  27040039
270500     MOVE ASC-PO-NBR       TO  DK-PO-NBR.                         27050039
270600     MOVE ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                    27060039
270700     MOVE ASC-STR-NBR      TO  DK-STR-NBR.                        27070039
270800     PERFORM 4170-CHECK-TSHPUNT.                                  27080039
270900                                                                  27090039
271000                                                                  27100039
271100*----------------------------------------------------------------*27110039
271200* CHECK TSHPUNT FOR ACTIVE CARTONS - ACTIVE UCC128 DATA FOR PBS   27120039
271300*----------------------------------------------------------------*27130039
271400 4170-CHECK-TSHPUNT.                                              27140039
271500                                                                  27150039
271600     EXEC SQL                                                     27160039
271700             SELECT C.SHIPT_UNT_ID                                27170039
271800             INTO :SHPUNT-SHIPT-UNT-ID                            27180039
271900             FROM  TPKSLIP A,                                     27190039
272000                   TINPKSU B,                                     27200039
272100                   TSHPUNT C                                      27210039
272200             WHERE A.PO_NBR           = :DK-PO-NBR                27220039
272300               AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR           27230039
272400               AND A.VER_STAT_CDE     = 'A'                       27240039
272500               AND A.PO_NBR           =  B.PO_NBR                 27250039
272600               AND A.SEQ_NBR          =  B.SEQ_NBR                27260039
272700               AND B.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID           27270039
272800               AND C.DEST_OPER_UNT_ID = :DK-STR-NBR               27280039
272900     END-EXEC.                                                    27290039
273000     EVALUATE TRUE                                                27300039
273100         WHEN SQLCODE = ZERO                                      27310039
273200         WHEN SQLCODE = -811                                      27320039
273300              SET  PS-ACTIVE-PBS-UCC128-YES  TO  TRUE             27330039
273400              PERFORM 4175-CHECK-TSHUNLO                          27340039
273500                                                                  27350039
273600         WHEN SQLCODE = +100                                      27360039
273700              SET  PS-ACTIVE-PBS-UCC128-NO  TO TRUE               27370039
273800                                                                  27380039
273900         WHEN SQLCODE = -904                                      27390039
274000         WHEN SQLCODE = -911                                      27400039
274100         WHEN SQLCODE = -913                                      27410039
274200              PERFORM 9900-SOFT-ABORT                             27420039
274300                                                                  27430039
274400         WHEN SQLWARN0 NOT = SPACES                               27440039
274500         WHEN SQLCODE NOT EQUAL ZERO                              27450039
274600              MOVE '4170-CHECK-TSHPUNT '  TO DP013-PARAGRAPH      27460039
274700              MOVE 'SELECT TSHPUNT '     TO DP013-MESSAGE-TEXT (1)27470039
274800              MOVE SQLCA           TO DP013-SQLCA                 27480039
274900              MOVE 'TSHPUNT '      TO DP013-DB2-TABLE-NAME (1)    27490039
275000              SET DP013-DB2-ABEND  TO TRUE                        27500039
275100              PERFORM DP013-0000-PROCESS-ABEND                    27510039
275200     END-EVALUATE.                                                27520039
275300                                                                  27530039
275400*----------------------------------------------------------------*27540039
275500* CHECK TSHUNLO FOR PBS ERRORS                                    27550039
275600*----------------------------------------------------------------*27560039
275700 4175-CHECK-TSHUNLO.                                              27570039
275800                                                                  27580039
275900     EXEC SQL                                                     27590039
276000          SELECT D.SCN_LOC_ID                                     27600039
276100            INTO :SHUNLO-SCN-LOC-ID                               27610039
276200            FROM  TPKSLIP A,                                      27620039
276300                  TINPKSU B,                                      27630039
276400                  TSHPUNT C,                                      27640039
276500                  TSHUNLO D                                       27650039
276600             WHERE A.PO_NBR           = :DK-PO-NBR                27660039
276700               AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR           27670039
276800               AND A.VER_STAT_CDE     = 'A'                       27680039
276900               AND A.PO_NBR           =  B.PO_NBR                 27690039
277000               AND A.SEQ_NBR          =  B.SEQ_NBR                27700039
277100               AND B.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID           27710039
277200               AND C.SHIPT_UNT_ID     =  D.SHIPT_UNT_ID           27720039
277300               AND C.DEST_OPER_UNT_ID = :DK-STR-NBR               27730039
277400               AND C.ACTV_IND         = 'A'                       27740039
277500               AND D.SCN_LOC_ID    IN ('PBSA', 'PBSB', 'PBSC',    27750039
277600                                      'PBSD', 'PBSE')             27760039
277700     END-EXEC.                                                    27770039
277800                                                                  27780039
277900     EVALUATE TRUE                                                27790039
278000         WHEN SQLCODE = ZERO                                      27800039
278100         WHEN SQLCODE = -811                                      27810039
278200             SET PS-PBS-ERROR-CARTONS-YES  TO  TRUE               27820039
278300                                                                  27830039
278400         WHEN SQLCODE = +100                                      27840039
278500             SET PS-PBS-ERROR-CARTONS-NO   TO  TRUE               27850039
278600                                                                  27860039
278700         WHEN SQLCODE = -904                                      27870039
278800         WHEN SQLCODE = -911                                      27880039
278900         WHEN SQLCODE = -913                                      27890039
279000              PERFORM 9900-SOFT-ABORT                             27900039
279100                                                                  27910039
279200         WHEN SQLWARN0 NOT = SPACES                               27920039
279300         WHEN SQLCODE NOT EQUAL ZERO                              27930039
279400              MOVE '4175-CHECK-TSHUNLO '  TO DP013-PARAGRAPH      27940039
279500              MOVE 'SELECT TSHUNLO '     TO DP013-MESSAGE-TEXT (1)27950039
279600              MOVE SQLCA           TO DP013-SQLCA                 27960039
279700              MOVE 'TSHUNLO '      TO DP013-DB2-TABLE-NAME (1)    27970039
279800              SET DP013-DB2-ABEND  TO TRUE                        27980039
279900              PERFORM DP013-0000-PROCESS-ABEND                    27990039
280000     END-EVALUATE.                                                28000039
280100                                                                  28010039
280200                                                                  28020039
280300* DMH  6/17/2004 - END                                            28030039
280400                                                                  28040039
280500                                                                  28050039
280600*----------------------------------------------------------------*28060039
280700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *28070000
280800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *28080000
280900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *28090000
281000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *28100000
281100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *28110000
281200*                                                                *28120000
281300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *28130000
281400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *28140000
281500*    UPON INITIALIZATION.                                        *28150000
281600*----------------------------------------------------------------*28160000
281700                                                                  28170000
281800*----------------------------------------------------------------*28180000
281900*                                               **   WR # 21361  *28190008
282000* ADDED CODE TO CHECK DUMMY SKU                                  *28200000
282100* ADDED CODE TO INCLUDE XLKUT001 LOGIC.                          *28210000
282200*----------------------------------------------------------------*28220000
282300 4300-READ-ITEMS-FROM-DB.                                         28230000
282400                                                                  28240000
282500     PERFORM                                                      28250000
282600         VARYING PV-READ-COUNT                                    28260000
282700         FROM 1 BY 1                                              28270000
282800         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    28280000
282900            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         28290000
283000                                                                  28300000
283100         PERFORM 4310-FETCH                                       28310000
283200                                                                  28320000
283300         IF  ASC-ITEMS-LEFT-ON-DB                                 28330000
283400             PERFORM 4315-LOAD-ASC-MAP-FIELDS                     28340008
283500         END-IF                                                   28350008
283600                                                                  28360008
283700         IF  ASC-ITEMS-LEFT-ON-DB                                 28370000
283800                                                                  28380000
283900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                28390000
284000                 ADD +1            TO  ASC-ITEM-SUB               28400000
284100             ELSE                                                 28410000
284200                 ADD +1            TO  ASC-BLK-SUB                28420000
284300                 MOVE +1           TO  ASC-ITEM-SUB               28430000
284400                                                                  28440000
284500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         28450000
284600                     MOVE +1       TO  ASC-BLK-SUB                28460000
284700                     SET ASC-BLOCK-MODIFIED (1)                   28470000
284800                                   TO  TRUE                       28480000
284900                     PERFORM 5100-WRITE-TEMP-STORAGE              28490000
285000                     MOVE ASC-BLOCK-ENTRIES                       28500000
285100                               (PC-MAX-BLOCKS-IN-ARRAY)           28510000
285200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 28520000
285300                     ADD +1        TO  ASC-BLK-SUB                28530000
285400                     INITIALIZE ASC-BLOCK-ENTRIES(ASC-BLK-SUB)    28540000
285500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      28550000
285600                                   TO  TRUE                       28560000
285700                 END-IF                                           28570000
285800             END-IF                                               28580000
285900                                                                  28590000
286000                 ADD +1            TO ASC-NUMBER-OF-ITEMS-READ    28600000
286100                 MOVE ASC-NUMBER-OF-ITEMS-READ                    28610000
286200                                   TO  ASC-LIST-ITEM-NUMBER       28620000
286300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28630000
286400                 MOVE RECITM-ORD-LNE-NBR                          28640000
286500                                   TO  ASC-ORD-LNE-NBR            28650000
286600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28660000
286700                 MOVE RECITM-STATUS-CDE                           28670000
286800                                   TO  ASC-STATUS-CDE             28680000
286900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28690000
287000                 MOVE RECITM-VRFD-USR-ID                          28700000
287100                                   TO  ASC-VRFD-USR-ID            28710000
287200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28720000
287300             END-IF                                               28730000
287400                 MOVE RECDIS-EXPTED-ITM-QTY                       28740000
287500                                   TO  ASC-EXPTED-ITM-QTY         28750000
287600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28760000
287700                 IF RECITM-STATUS-CDE = PC-VE                     28770000
287800                     MOVE RECDIS-VERIFY-ITM-QTY                   28780000
287900                                   TO  ASC-ACTUAL-ITM-QTY         28790000
288000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28800000
288100                     MOVE RECDIS-AP-VERIFY-ITM-QTY                28810000
288200                                   TO  ASC-VERIFY-ITM-QTY         28820000
288300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28830000
288400                 ELSE                                             28840000
288500                     IF ASC-AUTO-VE-YES                           28850028
288600                                                                  28860047
288700* DMH - 6/17/2004 - BEGIN                                         28870047
288800**** IF PBS AND NO VALID UCC128 - GET ACTUAL FROM RECDIS          28880047
288900                        IF  ASC-PACK-BY-STORE  AND                28890047
289000                            ASC-PBS-UPDATE-YES                    28900047
289100                             MOVE RECDIS-VERIFY-ITM-QTY           28910047
289200                                   TO  ASC-ACTUAL-ITM-QTY         28920047
289300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28930047
289400                        ELSE                                      28940047
289500* DMH - 6/17/2004 - END                                           28950047
289600                                                                  28960047
289700                             PERFORM 4350-CALL-RCKUT128           28970047
289800                             MOVE RC074-TOTAL-ACTL-ITM-QTY        28980047
289900                                   TO  ASC-ACTUAL-ITM-QTY         28990028
290000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29000028
290100                        END-IF                                    29010047
290200                     ELSE                                         29020028
290300                         MOVE RECDIS-VERIFY-ITM-QTY               29030028
290400                                   TO  ASC-ACTUAL-ITM-QTY         29040000
290500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29050000
290600                     END-IF                                       29060028
290700                     MOVE ZEROES TO                               29070000
290800                                     ASC-VERIFY-ITM-QTY           29080000
290900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   29090000
291000                 END-IF                                           29100000
291100                 MOVE PURITM-UNT-QTY                              29110000
291200                                   TO  ASC-PURITM-UNT-QTY         29120000
291300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29130000
291400                 MOVE PURITM-STATUS-CDE                           29140000
291500                                   TO  ASC-PURITM-STATUS-CDE      29150000
291600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29160000
291700                 MOVE PURCHS-STATUS-CDE                           29170000
291800                                   TO  ASC-PURCHS-STATUS-CDE      29180000
291900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29190000
292000                 MOVE PURITM-CL-NBR                               29200000
292100                                   TO  PV-CS-CLASS                29210000
292200                 MOVE PV-CLASS-SKU TO  ASC-CLASS-SKU              29220000
292300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29230000
292400                 MOVE RECITM-STATUS-CDE                           29240000
292500                                  TO  ASC-HOLD-RECITM-STATUS-CDE  29250000
292600                 SET ASC-UPDATE-YES                               29260000
292700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     29270000
292800                                         TO TRUE                  29280000
292900                 IF RECEIV-ML-POST-TMST < PV-DB2-CURRENT-TMST OR  29290000
293000                    RECEIV-FS-POST-TMST < PV-DB2-CURRENT-TMST     29300000
293100                           SET ASC-UPDATE-NO                      29310000
293200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29320000
293300                               ASC-CANT-UPDATE                    29330000
293400                                 TO TRUE                          29340000
293500                 END-IF                                           29350000
293600                                                                  29360039
293700     END-PERFORM.                                                 29370000
293800                                                                  29380000
293900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          29390000
294000         MOVE +1               TO ASC-BLK-SUB                     29400000
294100         PERFORM 5100-WRITE-TEMP-STORAGE                          29410000
294200         ADD +1                TO ASC-BLK-SUB                     29420000
294300         PERFORM 5100-WRITE-TEMP-STORAGE                          29430000
294400                                                                  29440000
294500         MOVE 1                TO ASC-BLK-SUB                     29450000
294600                                  PV-BLOCK-NUMBER                 29460000
294700         PERFORM 4410-READ-TEMP-STORAGE                           29470000
294800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             29480000
294900             MOVE 2            TO ASC-BLK-SUB                     29490000
295000                                  PV-BLOCK-NUMBER                 29500000
295100             PERFORM 4410-READ-TEMP-STORAGE                       29510000
295200         END-IF                                                   29520000
295300                                                                  29530000
295400         PERFORM 4320-GET-VENDOR-NAME                             29540000
295500     END-IF.                                                      29550000
295600/                                                                 29560000
295700 4315-LOAD-ASC-MAP-FIELDS.                                        29570008
295800     IF PURITM-ITM-NBR < 0                                        29580000
295900         MOVE '4300-READ-ITEMS-FROM-DB'                           29590000
296000                             TO DP013-PARAGRAPH                   29600000
296100         MOVE 'PURITM-ITM-NBR < 0     '                           29610008
296200                             TO DP013-MESSAGE-TEXT (1)            29620000
296300         MOVE SQLCA       TO DP013-SQLCA                          29630000
296400         SET DP013-DB2-ABEND                                      29640000
296500                          TO TRUE                                 29650000
296600         PERFORM DP013-0000-PROCESS-ABEND                         29660000
296700     END-IF                                                       29670000
296800                                                                  29680000
296900     IF PURITM-ITM-NBR = 0                                        29690000
297000         IF PURITM-SKU-SEQ-NBR = PC-000                           29700000
297100             MOVE '00000000' TO PV-CS-SKU                         29710000
297200         ELSE                                                     29720000
297300             IF PURITM-SKU-SEQ-NBR = PC-999                       29730000
297400                 MOVE '99999999' TO PV-CS-SKU                     29740000
297500             ELSE                                                 29750000
297600                 MOVE '4300-READ-ITEMS-FROM-DB'                   29760000
297700                               TO DP013-PARAGRAPH                 29770000
297800                 MOVE 'PURITM-ITM-NBR = 0     '                   29780008
297900                               TO DP013-MESSAGE-TEXT (1)          29790000
298000                 MOVE SQLCA      TO DP013-SQLCA                   29800000
298100                 SET DP013-DB2-ABEND                              29810000
298200                               TO TRUE                            29820000
298300                 PERFORM DP013-0000-PROCESS-ABEND                 29830000
298400               END-IF                                             29840000
298500         END-IF                                                   29850000
298600     END-IF                                                       29860000
298700                                                                  29870000
298800     IF PURITM-ITM-NBR > 0 AND                                    29880000
298900            PS-CALL-API-YES    AND                                29890000
299000            ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                29900000
299100             (PURITM-SKU-SEQ-NBR NOT = PC-999))                   29910000
299200                                                                  29920000
299300         INITIALIZE XL001-ITEM-COMMAREA                           29930000
299400         MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR               29940000
299500                                                                  29950000
299600         SET  XL001-BY-ITEM                                       29960000
299700              XL001-SELECT-SKU TO TRUE                            29970000
299800                                                                  29980000
299900         CALL XL001-VSM-PGM USING  DFHEIBLK                       29990000
300000                                   XL001-COMMAREA                 30000000
300100                                   XL001-ITEM-COMMAREA            30010000
300200                                                                  30020000
300300         EVALUATE TRUE                                            30030000
300400                                                                  30040000
300500             WHEN XL001-SKU-SQLCODE = +0                          30050000
300600                 MOVE XL001-SKU-NBR    TO  PV-CS-SKU              30060000
300700                                                                  30070000
300800             WHEN XL001-SKU-SQLCODE = +100                        30080000
300900                 MOVE SPACES      TO  PV-CS-SKU                   30090000
301000                                                                  30100000
301100             WHEN XL001-SKU-CONTENTION                            30110008
301200                 MOVE '7020-SELECT-SKU-BY-ITM'                    30120000
301300                                       TO DP013-PARAGRAPH         30130000
301400                 MOVE 'SKU CONTENTION' TO DP013-MESSAGE-TEXT (1)  30140000
301500                 MOVE XL001-SQLCA TO DP013-SQLCA                  30150000
301600                 MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (1)     30160008
301700                 SET DP013-DB2-ABEND   TO TRUE                    30170000
301800                 PERFORM DP013-0000-PROCESS-ABEND                 30180000
301900                                                                  30190000
302000             WHEN OTHER                                           30200000
302100                 MOVE '7020-SELECT-SKU-BY-ITM'                    30210000
302200                                       TO DP013-PARAGRAPH         30220000
302300                 MOVE 'INVALID RETURN'                            30230000
302400                                       TO DP013-MESSAGE-TEXT (1)  30240000
302500                 MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (1)     30250008
302600                 MOVE XL001-SQLCA TO DP013-SQLCA                  30260000
302700                 SET DP013-DB2-ABEND   TO TRUE                    30270000
302800                 PERFORM DP013-0000-PROCESS-ABEND                 30280000
302900         END-EVALUATE                                             30290000
303000     ELSE                                                         30300008
303100         MOVE SPACES      TO  PV-CS-SKU                           30310008
303200     END-IF.                                                      30320000
303300/                                                                 30330000
303400*----------------------------------------------------------------*30340000
303500* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *30350008
303600*----------------------------------------------------------------*30360000
303700*----------------------------------------------------------------*30370000
303800*    FETCH THE CURSOR.                                           *30380000
303900*----------------------------------------------------------------*30390000
304000                                                                  30400000
304100*----------------------------------------------------------------*30410000
304200* INCLUDED PURITM-ITM-NBR IN THE FETCH               WR # 21361  *30420008
304300* IF THE SQL STATEMENT IS SUCCESSFUL, THEN SET PS-CALL-API-YES   *30430000
304400* TO TRUE.                                                       *30440000
304500*----------------------------------------------------------------*30450000
304600 4310-FETCH.                                                      30460000
304700                                                                  30470000
304800     SET PS-CALL-API-NO      TO TRUE                              30480000
304900                                                                  30490000
305000     EXEC SQL                                                     30500000
305100          FETCH                                                   30510000
305200                LIST-CSR                                          30520000
305300          INTO                                                    30530000
305400                :RECEIV-STATUS-CDE                                30540000
305500              , :RECEIV-ML-POST-TMST                              30550000
305600              , :RECEIV-FS-POST-TMST                              30560000
305700              , :RECITM-ORD-LNE-NBR                               30570000
305800              , :RECITM-STATUS-CDE                                30580000
305900              , :RECITM-VRFD-USR-ID                               30590000
306000              , :RECDIS-EXPTED-ITM-QTY                            30600000
306100              , :RECDIS-VERIFY-ITM-QTY                            30610000
306200              , :RECDIS-AP-VERIFY-ITM-QTY                         30620000
306300              , :RECDIS-AP-PRC-CDE                                30630000
306400              , :PURCHS-DEPT-NBR                                  30640000
306500              , :PURCHS-ENT-ID                                    30650000
306600              , :PURCHS-STATUS-CDE                                30660000
306700              , :PURITM-CL-NBR                                    30670000
306800              , :PURITM-SKU-SEQ-NBR                               30680000
306900              , :PURITM-UNT-QTY                                   30690000
307000              , :PURITM-STATUS-CDE                                30700000
307100              , :PURITM-ITM-NBR                                   30710000
307200     END-EXEC.                                                    30720000
307300                                                                  30730000
307400     EVALUATE TRUE                                                30740000
307500         WHEN SQLCODE = ZERO                                      30750000
307600              SET PS-CALL-API-YES     TO TRUE                     30760000
307700         WHEN SQLCODE = +100                                      30770000
307800              CONTINUE                                            30780000
307900         WHEN SQLCODE = -904                                      30790000
308000         WHEN SQLCODE = -911                                      30800000
308100         WHEN SQLCODE = -913                                      30810000
308200              PERFORM 9900-SOFT-ABORT                             30820000
308300         WHEN SQLWARN0 NOT = SPACE                                30830000
308400         WHEN SQLCODE NOT = ZERO                                  30840000
308500              MOVE '4310-FETCH-CURSOR'                            30850000
308600                               TO DP013-PARAGRAPH                 30860000
308700              MOVE 'FETCH LIST CURSOR'                            30870000
308800                               TO DP013-MESSAGE-TEXT (1)          30880000
308900              MOVE SQLCA       TO DP013-SQLCA                     30890000
309000              SET DP013-DB2-ABEND                                 30900000
309100                               TO TRUE                            30910000
309200              PERFORM DP013-0000-PROCESS-ABEND                    30920000
309300     END-EVALUATE.                                                30930000
309400                                                                  30940000
309500     IF  SQLCODE EQUAL +100                                       30950000
309600         SET ASC-NO-ITEMS-LEFT-ON-DB                              30960000
309700             PS-STORE-REC      TO  TRUE                           30970000
309800     END-IF.                                                      30980000
309900/                                                                 30990000
310000*----------------------------------------------------------------*31000000
310100* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *31010008
310200*----------------------------------------------------------------*31020000
310300*----------------------------------------------------------------*31030000
310400*    GET THE VENDOR NAME.                                        *31040000
310500*----------------------------------------------------------------*31050000
310600                                                                  31060000
310700 4320-GET-VENDOR-NAME.                                            31070000
310800                                                                  31080000
310900     MOVE PURCHS-ENT-ID             TO  ASC-ENT-ID.               31090000
311000     MOVE PURCHS-DEPT-NBR           TO  ASC-DEPT-NBR.             31100000
311100                                                                  31110000
311200     EXEC SQL                                                     31120000
311300          SELECT                                                  31130000
311400                ENT_NAME_DESC                                     31140000
311500          INTO                                                    31150000
311600                :ENTNME-ENT-NAME-DESC                             31160000
311700          FROM                                                    31170000
311800                TENTNME                                           31180000
311900          WHERE                                                   31190000
312000                ENT_ID            =  :ASC-ENT-ID                  31200000
312100           AND  TYPE_CDE          =  :PC-01                       31210000
312200     END-EXEC.                                                    31220000
312300                                                                  31230000
312400     EVALUATE TRUE                                                31240000
312500         WHEN SQLCODE = ZERO                                      31250000
312600              MOVE ENTNME-ENT-NAME-DESC                           31260000
312700                                    TO  ASC-ENT-NAME-DESC         31270000
312800         WHEN SQLCODE = +100                                      31280000
312900              MOVE ASC-ENT-ID       TO  PV-ENT-ID                 31290000
313000              STRING 'VENDOR NOT FOUND: '                         31300000
313100                      PV-ENT-ID  DELIMITED BY SIZE                31310000
313200                                  INTO  ASC-ENT-NAME-DESC         31320000
313300         WHEN SQLWARN0 NOT = SPACE                                31330000
313400         WHEN SQLCODE NOT = ZERO                                  31340000
313500              MOVE '4320-GET-VENDOR-NAME'                         31350000
313600                               TO DP013-PARAGRAPH                 31360000
313700              MOVE 'SELECT TRECITM'                               31370000
313800                               TO DP013-MESSAGE-TEXT (1)          31380000
313900              MOVE SQLCA       TO DP013-SQLCA                     31390000
314000              SET DP013-DB2-ABEND                                 31400000
314100                               TO TRUE                            31410000
314200              PERFORM DP013-0000-PROCESS-ABEND                    31420000
314300     END-EVALUATE.                                                31430000
314400                                                                  31440028
314500 4350-CALL-RCKUT128.                                              31450028
314600     INITIALIZE RC074-FIELDS.                                     31460028
314700     MOVE ASC-OPER-UNT-ID     TO RC074-OPER-UNT-ID.               31470028
314800     MOVE ASC-FCLTY-ID        TO RC074-FCLTY-ID.                  31480028
314900     MOVE ASC-PO-NBR          TO RC074-PO-NBR.                    31490028
315000     MOVE ASC-REC-SEQ-NBR     TO RC074-RCVR-SEQ-NBR.              31500028
315100     MOVE RECITM-ORD-LNE-NBR  TO RC074-LINE-NBR.                  31510028
315200     MOVE ASC-STR-NBR         TO RC074-STR-NBR.                   31520035
315300     SET RC074-UNIT-QTY-YES   TO TRUE.                            31530028
315400                                                                  31540028
315500     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 31550028
315600                                         RC074-COMMAREA           31560028
315700                                         RC074-FIELDS.            31570028
315800                                                                  31580028
315900     EVALUATE TRUE                                                31590028
316000         WHEN RC074-SUCCESSFUL                                    31600028
316100             CONTINUE                                             31610028
316200         WHEN OTHER                                               31620028
316300             MOVE '4350-CALL-RCKUT128'                            31630028
316400                                 TO DP013-PARAGRAPH               31640028
316500             STRING                                               31650028
316600                  'UNSUCCESSFUL CALL TO RCKUT128 '                31660028
316700                  'SUCCESS-IND = '                                31670028
316800                  RC074-SUCCESS-IND                               31680028
316900                               DELIMITED BY SIZE                  31690028
317000                               INTO DP013-MESSAGE-TEXT (1)        31700028
317100             MOVE RC074-CRA-RET-MSG                               31710028
317200                                 TO DP013-MESSAGE-TEXT (2)        31720028
317300             MOVE RC074-SQLCA    TO DP013-SQLCA                   31730028
317400             SET DP013-DB2-ABEND                                  31740028
317500                 DP013-XCTL-DISPLAY-RESTART                       31750028
317600                                 TO TRUE                          31760028
317700             PERFORM DP013-0000-PROCESS-ABEND                     31770028
317800     END-EVALUATE.                                                31780028
317900                                                                  31790028
318000/                                                                 31800000
318100*----------------------------------------------------------------*31810000
318200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *31820000
318300*----------------------------------------------------------------*31830000
318400                                                                  31840000
318500 4400-MOVE-COMMAREA-TO-SCREEN.                                    31850000
318600                                                                  31860000
318700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             31870000
318800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          31880000
318900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          31890000
319000             MOVE +1    TO ASC-BLK-SUB                            31900000
319100             PERFORM 5100-WRITE-TEMP-STORAGE                      31910000
319200             ADD +1     TO ASC-BLK-SUB                            31920000
319300             PERFORM 5100-WRITE-TEMP-STORAGE                      31930000
319400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             31940000
319500                 GIVING PV-BLOCK-NUMBER                           31950000
319600                 REMAINDER PV-REMAINDER                           31960000
319700             IF  PV-REMAINDER > ZERO                              31970000
319800                 ADD +1 TO PV-BLOCK-NUMBER                        31980000
319900             END-IF                                               31990000
320000             MOVE +1    TO ASC-BLK-SUB                            32000000
320100             PERFORM 4410-READ-TEMP-STORAGE                       32010000
320200             ADD +1     TO ASC-BLK-SUB                            32020000
320300                           PV-BLOCK-NUMBER                        32030000
320400             PERFORM 4410-READ-TEMP-STORAGE                       32040000
320500     END-IF.                                                      32050000
320600                                                                  32060000
320700     MOVE +1            TO ASC-BLK-SUB.                           32070000
320800     COMPUTE ASC-ITEM-SUB =                                       32080000
320900         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              32090000
321000         + PC-ITEMS-PER-PANEL).                                   32100000
321100                                                                  32110000
321200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        32120000
321300         ADD +1         TO ASC-BLK-SUB                            32130000
321400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            32140000
321500     END-IF.                                                      32150000
321600                                                                  32160000
321700     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           32170000
321800         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                32180000
321900     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        32190000
322000* BJ                                                              32200000
322100     SET PS-ALL-LINES-PROTECTED TO TRUE.                          32210000
322200     PERFORM 4420-FORMAT-LIST-LINES                               32220000
322300         VARYING PV-SUB                                           32230000
322400         FROM PC-ITEMS-PER-PANEL BY -1                            32240000
322500         UNTIL PV-SUB < +1.                                       32250000
322600                                                                  32260000
322700*  BJ                                                             32270000
322800     IF PS-ALL-LINES-PROTECTED                                    32280000
322900         MOVE -1                   TO ASTRTITL                    32290000
323000     END-IF.                                                      32300000
323100                                                                  32310000
323200     COMPUTE ASC-ITEMS-DISPLAYED =                                32320000
323300         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          32330000
323400     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL.   32340000
323500     IF  PS-NO-ERROR                                              32350000
323600         MOVE PV-TOP-ITEM          TO ASTRTITO                    32360000
323700     END-IF.                                                      32370000
323800     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    32380000
323900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    32390000
324000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            32400000
324100                                   TO ASELITO.                    32410000
324200     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     32420000
324300                                                                  32430000
324400     IF  DP020-MSG-NUMBER-X = SPACE                               32440000
324500         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  32450000
324600*            --- MORE ITEMS TO DISPLAY ----                       32460000
324700             IF ASC-OVERAGE                                       32470000
324800                 MOVE PC-TSYMSG-01264                             32480000
324900                          TO DP020-MSG-NUMBER                     32490000
325000                SET DP020-MSG-FATAL                               32500000
325100                                     TO TRUE                      32510000
325200             ELSE                                                 32520000
325300                 MOVE PC-TSYMSG-00279    TO DP020-MSG-NUMBER      32530000
325400                 SET DP020-MSG-INFORMATIONAL                      32540000
325500                                     TO TRUE                      32550000
325600             END-IF                                               32560000
325700        ELSE                                                      32570000
325800             IF ASC-OVERAGE                                       32580000
325900                 MOVE PC-TSYMSG-01264                             32590000
326000                          TO DP020-MSG-NUMBER                     32600000
326100                SET DP020-MSG-FATAL                               32610000
326200                                     TO TRUE                      32620000
326300             ELSE                                                 32630000
326400                 MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER      32640000
326500                 SET DP020-MSG-INFORMATIONAL                      32650000
326600                                     TO TRUE                      32660000
326700             END-IF                                               32670000
326800         END-IF                                                   32680000
326900     END-IF.                                                      32690000
327000                                                                  32700000
327100     MOVE ASC-PO-NBR               TO  ARCVNBRO.                  32710000
327200     MOVE ASC-REC-SEQ-NBR          TO  ARCVSEQO.                  32720000
327300     MOVE ASC-OPER-UNT-ID          TO  AOPERO.                    32730000
327400     MOVE ASC-FCLTY-ID             TO  AFCLTYO.                   32740000
327500     MOVE ASC-FCLTY-NME            TO  AFCLNAMO.                  32750000
327600     MOVE ASC-STR-NBR              TO  ASTOREO.                   32760000
327700     MOVE ASC-DEPT-NBR             TO  ADEPTO.                    32770000
327800                                                                  32780000
327900*----------------------------------------------------------------*32790000
328000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *32800000
328100*----------------------------------------------------------------*32810000
328200                                                                  32820000
328300 4410-READ-TEMP-STORAGE.                                          32830000
328400                                                                  32840000
328500     EXEC CICS                                                    32850000
328600         READQ TS                                                 32860000
328700             QUEUE (ASC-LIST-QUEUE-NAME)                          32870000
328800             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32880000
328900             ITEM  (PV-BLOCK-NUMBER)                              32890000
329000             RESP  (PV-CICS-RESP)                                 32900000
329100     END-EXEC.                                                    32910000
329200                                                                  32920000
329300     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       32930000
329400       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     32940000
329500         CONTINUE                                                 32950000
329600     ELSE                                                         32960000
329700         SET DP013-CICS-ABEND     TO TRUE                         32970000
329800         SET DP013-NO-ROLLBACK    TO TRUE                         32980000
329900         MOVE '4410-READ-TEMP-STORAGE'                            32990000
330000                                  TO DP013-PARAGRAPH              33000000
330100         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      33010000
330200                                  TO DP013-MESSAGE-TEXT(1)        33020000
330300         PERFORM DP013-0000-PROCESS-ABEND                         33030000
330400     END-IF.                                                      33040000
330500                                                                  33050000
330600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             33060000
330700                                                                  33070000
330800     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         33080000
330900         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               33090000
331000     END-IF.                                                      33100000
331100/                                                                 33110000
331200*----------------------------------------------------------------*33120000
331300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *33130000
331400*----------------------------------------------------------------*33140000
331500                                                                  33150000
331600 4420-FORMAT-LIST-LINES.                                          33160000
331700                                                                  33170000
331800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      33180000
331900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                33190000
332000         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA         (PV-SUB)   33200000
332100                                    MR-ITEM-QTYA       (PV-SUB)   33210000
332200         MOVE DP015-HL-OFF         TO MR-SELECTH       (PV-SUB)   33220000
332300                                      MR-ITEM-QTYH     (PV-SUB)   33230000
332400         MOVE SPACE              TO MR-SELECTI         (PV-SUB)   33240000
332500                                    MR-ORD-LNE-NBR-X   (PV-SUB)   33250000
332600                                    MR-STATUS-CDE      (PV-SUB)   33260000
332700                                    MR-CLASS-SKU       (PV-SUB)   33270000
332800                                    MR-EXPTED-QTY-X    (PV-SUB)   33280000
332900                                    MR-ACTUAL-QTY-X    (PV-SUB)   33290000
333000                                    MR-VERIFY-QTY-X    (PV-SUB)   33300000
333100                                    MR-VERIFY-MSG      (PV-SUB)   33310000
333200     ELSE                                                         33320000
333300         IF ASC-UPDATE-NO (ASC-BLK-SUB ASC-ITEM-SUB)              33330000
333400             MOVE DP015-ASK-DRK-OFF TO MR-SELECTA (PV-SUB)        33340000
333500                                       MR-ITEM-QTYA (PV-SUB)      33350000
333600         ELSE                                                     33360000
333700             MOVE -1                TO MR-SELECTL (PV-SUB)        33370000
333800             SET PS-ALL-LINES-NOT-PROTECTED TO TRUE               33380000
333900         END-IF                                                   33390000
334000         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33400000
334100                                                   > SPACE        33410000
334200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 33420000
334300                                 TO MR-SELECTI (PV-SUB)           33430000
334400         ELSE                                                     33440000
334500             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33450000
334600                                 TO MR-SELECTI (PV-SUB)           33460000
334700         END-IF                                                   33470000
334800                                                                  33480000
334900         IF  DP030-SET-CURSOR-TRAILER                             33490000
335000             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)33500000
335100                 > SPACE)                                         33510000
335200               OR (PV-SUB = 1))                                   33520000
335300                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             33530000
335400             END-IF                                               33540000
335500         END-IF                                                   33550000
335600                                                                  33560000
335700*12/29 - BEGIN                                                    33570000
335800         IF  ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)          33580000
335900             MOVE ASC-ITEM-QTY(ASC-BLK-SUB ASC-ITEM-SUB)          33590000
336000                                   TO PV-DISPLAY-ZERO             33600000
336100             MOVE PV-DISPLAY-ZERO                                 33610000
336200                                   TO MR-ITEM-QTY-X (PV-SUB)      33620000
336300             MOVE DP015-UNP-ALP-NOR-MDT                           33630000
336400                                   TO MR-ITEM-QTYA  (PV-SUB)      33640000
336500         ELSE                                                     33650000
336600             MOVE ASC-ITEM-QTY(ASC-BLK-SUB ASC-ITEM-SUB)          33660000
336700                                   TO PV-DISPLAY-NO-ZERO          33670000
336800             MOVE PV-DISPLAY-NO-ZERO                              33680000
336900                                   TO MR-ITEM-QTY-X (PV-SUB)      33690000
337000         END-IF                                                   33700000
337100*12/29 - END                                                      33710000
337200                                                                  33720000
337300         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           33730000
337400             MOVE ASC-ORD-LNE-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)     33740000
337500                                 TO MR-ORD-LNE-NBR     (PV-SUB)   33750000
337600                                    PV-ORD-LNE-NBR                33760000
337700             MOVE ASC-STATUS-CDE   (ASC-BLK-SUB ASC-ITEM-SUB)     33770000
337800                                 TO MR-STATUS-CDE     (PV-SUB)    33780000
337900             MOVE ASC-CLASS-SKU    (ASC-BLK-SUB ASC-ITEM-SUB)     33790000
338000                                 TO MR-CLASS-SKU      (PV-SUB)    33800000
338100             MOVE ASC-EXPTED-ITM-QTY(ASC-BLK-SUB ASC-ITEM-SUB)    33810000
338200                                 TO MR-EXPTED-QTY     (PV-SUB)    33820000
338300             SET ASC-UPDATE-ALLOWED (ASC-BLK-SUB ASC-ITEM-SUB)    33830036
338400                                 TO TRUE                          33840036
338500             IF ASC-STATUS-CDE   (ASC-BLK-SUB ASC-ITEM-SUB)       33850000
338600                      = PC-VE                                     33860000
338700                  MOVE                                            33870000
338800                    ASC-VERIFY-ITM-QTY(ASC-BLK-SUB ASC-ITEM-SUB)  33880000
338900                              TO MR-VERIFY-QTY     (PV-SUB)       33890000
339000                  MOVE                                            33900000
339100                  ASC-ACTUAL-ITM-QTY(ASC-BLK-SUB ASC-ITEM-SUB)    33910000
339200                                 TO MR-ACTUAL-QTY     (PV-SUB)    33920000
339300                  PERFORM 4422-CREATE-VE-MSG                      33930000
339400             ELSE                                                 33940000
339500                  MOVE                                            33950000
339600                      SPACES TO MR-VERIFY-QTY-X   (PV-SUB)        33960000
339700                  MOVE                                            33970000
339800                  ASC-ACTUAL-ITM-QTY(ASC-BLK-SUB ASC-ITEM-SUB)    33980000
339900                                 TO MR-ACTUAL-QTY     (PV-SUB)    33990000
340000                  PERFORM 4423-CREATE-NVE-MSG                     34000000
340100             END-IF                                               34010000
340200*12/30 - BEGIN                                                    34020000
340300*12/30       IF  MR-ITEM-QTYC(PV-SUB) NOT EQUAL DP015-RED         34030000
340400*12/30           MOVE ASC-ITEM-QTY  (ASC-BLK-SUB ASC-ITEM-SUB)    34040000
340500*12/30                           TO MR-ITEM-QTY-O     (PV-SUB)    34050000
340600*12/30       END-IF                                               34060000
340700             IF  MR-ITEM-QTYC(PV-SUB) NOT EQUAL DP015-RED         34070000
340800                 IF  ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)  34080000
340900                     MOVE ASC-ITEM-QTY                            34090000
341000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  34100000
341100                                   TO PV-DISPLAY-ZERO             34110000
341200                     MOVE PV-DISPLAY-ZERO                         34120000
341300                                   TO MR-ITEM-QTY-X (PV-SUB)      34130000
341400                     MOVE DP015-UNP-ALP-NOR-MDT                   34140000
341500                                   TO MR-ITEM-QTYA (PV-SUB)       34150000
341600                 ELSE                                             34160000
341700                     MOVE ASC-ITEM-QTY (ASC-BLK-SUB ASC-ITEM-SUB) 34170000
341800                                   TO  PV-DISPLAY-NO-ZERO         34180000
341900                     MOVE PV-DISPLAY-NO-ZERO                      34190000
342000                                   TO MR-ITEM-QTY-X     (PV-SUB)  34200000
342100                 END-IF                                           34210000
342200             END-IF                                               34220000
342300*12/30 - END                                                      34230000
342400             IF ASC-NO-OVERAGE                                    34240000
342500                 CONTINUE                                         34250000
342600             ELSE                                                 34260000
342700                 IF ASC-PACK-BY-ST-OVERAGE                        34270000
342800                                    (ASC-BLK-SUB ASC-ITEM-SUB)    34280000
342900                      IF ASC-SELECT                               34290000
343000                                    (ASC-BLK-SUB ASC-ITEM-SUB)    34300000
343100                           MOVE DP015-YELLOW                      34310000
343200                                  TO MR-ORD-LNE-NBRC  (PV-SUB)    34320000
343300                                     MR-ITEM-QTYC     (PV-SUB)    34330000
343400                      END-IF                                      34340000
343500                      MOVE DP015-BLUE                             34350000
343600                                  TO MR-SELECTC      (PV-SUB)     34360000
343700                      MOVE DP015-PRO-NOR-OFF                      34370000
343800                                  TO MR-SELECTA  (PV-SUB)         34380000
343900                 ELSE                                             34390000
344000                     MOVE DP015-BLUE                              34400000
344100                                  TO MR-ORD-LNE-NBRC (PV-SUB)     34410000
344200                     MOVE DP015-BLUE                              34420000
344300                                  TO MR-ITEM-QTYC    (PV-SUB)     34430000
344400                     MOVE DP015-BLUE                              34440000
344500                                  TO MR-SELECTC      (PV-SUB)     34450000
344600                     MOVE DP015-PRO-NOR-OFF                       34460000
344700                                  TO MR-SELECTA  (PV-SUB)         34470000
344800                     MOVE SPACE  TO MR-SELECTI  (PV-SUB)          34480000
344900                     MOVE DP015-PRO-NOR-OFF                       34490000
345000                           TO MR-ITEM-QTYA (PV-SUB)               34500000
345100                 END-IF                                           34510000
345200             END-IF                                               34520030
345300             IF ASC-OVERAGE                                       34530000
345400                  CONTINUE                                        34540000
345500             ELSE                                                 34550000
345600                  SET  ASC-NO-PACK-BY-ST-OVERAGE                  34560000
345700                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE         34570000
345800             END-IF                                               34580000
345900             IF ASC-UPDATE-NO (ASC-BLK-SUB ASC-ITEM-SUB)          34590000
346000                 MOVE DP015-ASK-DRK-OFF TO MR-SELECTA (PV-SUB)    34600000
346100                                           MR-ITEM-QTYA (PV-SUB)  34610000
346200             END-IF                                               34620000
346300         END-IF                                                   34630013
346400         IF ASC-AUTO-VE-YES                                       34640015
346500                                                                  34650044
346600* DMH - 6/17/2004 - BEGIN                                         34660040
346700             IF  ASC-PACK-BY-STORE                                34670040
346800                 IF  ASC-PBS-UPDATE-YES                           34680040
346900                     CONTINUE                                     34690040
347000                 ELSE                                             34700040
347100                     MOVE DP015-ASK-DRK-OFF                       34710040
347200                                        TO MR-ITEM-QTYA (PV-SUB)  34720040
347300                 END-IF                                           34730040
347400             ELSE                                                 34740040
347500* DMH - 6/17/2004 - END                                           34750040
347600                                                                  34760040
347700                 MOVE DP015-ASK-DRK-OFF TO MR-ITEM-QTYA (PV-SUB)  34770040
347800             END-IF                                               34780040
347900         END-IF                                                   34790040
348000     END-IF.                                                      34800000
348100                                                                  34810000
348200     SUBTRACT +1 FROM ASC-ITEM-SUB                                34820000
348300     IF  ASC-ITEM-SUB < + 1                                       34830000
348400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  34840000
348500         MOVE +1                 TO ASC-BLK-SUB                   34850000
348600     END-IF.                                                      34860000
348700                                                                  34870000
348800 4422-CREATE-VE-MSG.                                              34880000
348900******************************************************************34890000
349000** CREATE THE VARIABLE MESSAGE LINE FOR VERIFIED LINES          **34900000
349100******************************************************************34910000
349200     EVALUATE ASC-VRFD-USR-ID (ASC-BLK-SUB ASC-ITEM-SUB)          34920000
349300        WHEN PC-P2L                                               34930000
349400            MOVE ASC-ACTUAL-ITM-QTY    (ASC-BLK-SUB ASC-ITEM-SUB) 34940000
349500              TO PV-V2-P2L-UNITS                                  34950000
349600            MOVE PV-V2-MSG TO MR-VERIFY-MSG (PV-SUB)              34960000
349700            SET ASC-MANUAL-NO (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE  34970000
349800        WHEN PC-CASE                                              34980000
349900            MOVE ASC-ACTUAL-ITM-QTY    (ASC-BLK-SUB ASC-ITEM-SUB) 34990000
350000              TO PV-V3-CASE-UNITS                                 35000000
350100            MOVE PV-V3-MSG TO MR-VERIFY-MSG (PV-SUB)              35010000
350200            SET ASC-MANUAL-NO (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE  35020000
350300        WHEN PC-P2LCASE                                           35030000
350400            MOVE 0 TO PV-V1-P2L-UNITS                             35040000
350500                      PV-V1-CASE-UNITS                            35050000
350600            SET PS-MORE-RECDVS TO TRUE                            35060000
350700            PERFORM 4030-OPEN-TRECDVS                             35070000
350800            PERFORM 4450-PROCESS-TRECDVS UNTIL PS-NO-MORE-RECDVS  35080000
350900            PERFORM 4050-CLOSE-TRECDVS                            35090000
351000            SET ASC-MANUAL-NO (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE  35100000
351100        WHEN OTHER                                                35110000
351200            MOVE ASC-ACTUAL-ITM-QTY    (ASC-BLK-SUB ASC-ITEM-SUB) 35120000
351300              TO PV-V4-MANUAL-UNITS                               35130000
351400            MOVE PV-V4-MSG TO MR-VERIFY-MSG (PV-SUB)              35140000
351500            SET ASC-MANUAL-YES (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE 35150000
351600     END-EVALUATE.                                                35160000
351700******************************************************************35170000
351800** CREATE THE VARIABLE MESSAGE LINE FOR NON VERIFIED LINES      **35180000
351900******************************************************************35190000
352000 4423-CREATE-NVE-MSG.                                             35200000
352100     PERFORM 5650-SELECT-DISTHD.                                  35210000
352200     IF SQLCODE = 0                                               35220000
352300        IF DISTHD-VRFD-TMST = PC-DB2-DEFAULT-TMST AND             35230036
352400           DISTHD-TOT-CART-CNT > 0                                35240036
352500            SET ASC-NO-UPDATE-ALLOWED                             35250036
352600                              (ASC-BLK-SUB ASC-ITEM-SUB)          35260036
352700                     TO TRUE                                      35270036
352800        END-IF                                                    35280036
352900        IF DISTHD-TOT-CART-CNT > 0                                35290000
353000            IF (DISTDT-P2L-SPLT-UNT-QTY > 0 AND                   35300000
353100               (DISTDT-FCSE-SPLT-UNT-QTY > 0 OR                   35310000
353200               DISTDT-INPK-SPLT-UNT-QTY > 0))                     35320000
353300               MOVE DISTDT-P2L-SPLT-UNT-QTY TO                    35330000
353400                    PV-NV1-P2L-UNITS                              35340000
353500               MOVE DISTDT-FCSE-SPLT-UNT-QTY TO                   35350000
353600                    PV-NV1-CASE-UNITS                             35360000
353700               MOVE PV-NV1-MSG TO MR-VERIFY-MSG (PV-SUB)          35370000
353800               SET ASC-MANUAL-NO (ASC-BLK-SUB ASC-ITEM-SUB)       35380000
353900                 TO TRUE                                          35390000
354000            ELSE                                                  35400000
354100               IF DISTDT-P2L-SPLT-UNT-QTY > 0 AND                 35410000
354200                  DISTDT-FCSE-SPLT-UNT-QTY = 0 AND                35420000
354300                  DISTDT-INPK-SPLT-UNT-QTY = 0                    35430000
354400                  MOVE DISTDT-P2L-SPLT-UNT-QTY TO                 35440000
354500                       PV-NV2-P2L-UNITS                           35450000
354600                  MOVE PV-NV2-MSG TO MR-VERIFY-MSG (PV-SUB)       35460000
354700                  SET ASC-MANUAL-NO (ASC-BLK-SUB ASC-ITEM-SUB)    35470000
354800                  TO TRUE                                         35480000
354900               ELSE                                               35490000
355000                  IF (DISTDT-P2L-SPLT-UNT-QTY = 0 AND             35500000
355100                     (DISTDT-FCSE-SPLT-UNT-QTY > 0 OR             35510000
355200                     DISTDT-INPK-SPLT-UNT-QTY > 0))               35520000
355300                     MOVE DISTDT-FCSE-SPLT-UNT-QTY TO             35530000
355400                          PV-NV3-CASE-UNITS                       35540000
355500                     MOVE PV-NV3-MSG TO MR-VERIFY-MSG (PV-SUB)    35550000
355600                     SET ASC-MANUAL-NO (ASC-BLK-SUB ASC-ITEM-SUB) 35560000
355700                     TO TRUE                                      35570000
355800                  END-IF                                          35580000
355900               END-IF                                             35590000
356000            END-IF                                                35600000
356100        END-IF                                                    35610000
356200     END-IF.                                                      35620000
356300     IF (SQLCODE = +100 OR                                        35630000
356400        (SQLCODE = 0 AND DISTHD-TOT-CART-CNT = 0) OR              35640000
356500        (SQLCODE = 0 AND DISTDT-P2L-SPLT-UNT-QTY = 0 AND          35650000
356600                     DISTDT-FCSE-SPLT-UNT-QTY = 0 AND             35660000
356700                     DISTDT-INPK-SPLT-UNT-QTY = 0))               35670000
356800        MOVE ASC-ACTUAL-ITM-QTY  (ASC-BLK-SUB ASC-ITEM-SUB)       35680000
356900          TO PV-NV4-MANUAL-UNITS                                  35690000
357000          MOVE PV-NV4-MSG TO MR-VERIFY-MSG (PV-SUB)               35700000
357100          SET ASC-MANUAL-YES (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE   35710000
357200     END-IF.                                                      35720000
357300******************************************************************35730000
357400** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **35740000
357500** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **35750000
357600** ISSUE A WARNING.                                             **35760000
357700******************************************************************35770000
357800                                                                  35780000
357900 4430-CHECK-FOR-BEGIN-AND-END.                                    35790000
358000                                                                  35800000
358100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       35810000
358200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     35820000
358300*            -- NO END-OF-RANGE SPECFIED ---                      35830000
358400             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            35840000
358500             SET DP020-MSG-WARNING TO TRUE                        35850000
358600             PERFORM 4431-POSITION-AT-WARNING                     35860000
358700         END-IF                                                   35870000
358800     ELSE                                                         35880000
358900         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     35890000
359000*            -- NO BEGINNING-OF-RANGE SPECFIED ---                35900000
359100             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            35910000
359200             SET DP020-MSG-WARNING TO TRUE                        35920000
359300             PERFORM 4431-POSITION-AT-WARNING                     35930000
359400         END-IF                                                   35940000
359500     END-IF.                                                      35950000
359600******************************************************************35960000
359700** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **35970000
359800** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **35980000
359900** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **35990000
360000** POSITION THE CURSOR THERE.                                   **36000000
360100******************************************************************36010000
360200                                                                  36020000
360300 4431-POSITION-AT-WARNING.                                        36030000
360400                                                                  36040000
360500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 36050000
360600                    - PV-TOP-ITEM + 1.                            36060000
360700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      36070000
360800         CONTINUE                                                 36080000
360900     ELSE                                                         36090000
361000         SET DP030-SET-CURSOR-APPL-1                              36100000
361100                                   TO TRUE                        36110000
361200         MOVE -1                   TO MR-SELECTL (PV-SUB)         36120000
361300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         36130000
361400         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         36140000
361500     END-IF.                                                      36150000
361600                                                                  36160000
361700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   36170000
361800                    - PV-TOP-ITEM + 1.                            36180000
361900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      36190000
362000         CONTINUE                                                 36200000
362100     ELSE                                                         36210000
362200         SET DP030-SET-CURSOR-APPL-1                              36220000
362300                                   TO TRUE                        36230000
362400         MOVE -1                   TO MR-SELECTL (PV-SUB)         36240000
362500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         36250000
362600         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         36260000
362700     END-IF.                                                      36270000
362800/                                                                 36280000
362900 4450-PROCESS-TRECDVS.                                            36290000
363000                                                                  36300000
363100         PERFORM 4040-FETCH-RECDVS.                               36310000
363200                                                                  36320000
363300         IF PS-NO-MORE-RECDVS                                     36330000
363400             MOVE PV-V1-MSG TO MR-VERIFY-MSG (PV-SUB)             36340000
363500         ELSE                                                     36350000
363600            IF RECDVS-VRFY-SRC-CDE = PC-CP                        36360000
363700                MOVE RECDVS-VRFY-ITM-QTY TO PV-V1-CASE-UNITS      36370000
363800            ELSE                                                  36380000
363900                IF RECDVS-VRFY-SRC-CDE = PC-P2                    36390000
364000                   MOVE RECDVS-VRFY-ITM-QTY TO PV-V1-P2L-UNITS    36400000
364100                END-IF                                            36410000
364200            END-IF                                                36420000
364300         END-IF.                                                  36430000
364400*----------------------------------------------------------------*36440000
364500*                                                                *36450000
364600*    ENSURE EACH SELECTED ITEM HAS A STATUS CODE OF CM.  IF SO,  *36460000
364700*    UPDATE THE VERIFIED ITEM QUANTITY AND THE AP VERIFIED ITEM  *36470000
364800*    QUANTITY ON TRECDIS; SET THE STATUS TO VE                   *36480000
364900*    NEXT, CHECK IF ALL TRECITM ROWS FOR THIS RECEIVER HAVE A    *36490000
365000*    VE STATUS CODE.  IF SO, UPDATE THE TRECEIV ROW TO A STATUS  *36500000
365100*    OF VE.                                                      *36510000
365200*                                                                *36520000
365300*----------------------------------------------------------------*36530000
365400                                                                  36540000
365500 5050-PREPARE-TO-ADJUST.                                          36550000
365600                                                                  36560000
365700     MOVE +1                   TO  ASC-BLK-SUB.                   36570000
365800     PERFORM 5100-WRITE-TEMP-STORAGE.                             36580000
365900     ADD +1                    TO  ASC-BLK-SUB.                   36590000
366000     PERFORM 5100-WRITE-TEMP-STORAGE.                             36600000
366100                                                                  36610000
366200     PERFORM 5400-PROCESS-TRECDIS                                 36620000
366300             VARYING PV-ITEM                                      36630000
366400             FROM 1 BY 1                                          36640000
366500             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     36650000
366600                                                                  36660000
366700     INITIALIZE ASC-BLOCK-ENTRIES (1)                             36670000
366800                ASC-BLOCK-ENTRIES (2).                            36680000
366900     MOVE +1             TO ASC-BLK-SUB                           36690000
367000                            PV-TOP-ITEM.                          36700000
367100                                                                  36710000
367200     MOVE ZERO           TO ASC-ITEM-SUB                          36720000
367300                            ASC-START-OF-SELECTED-RANGE           36730000
367400                            ASC-END-OF-SELECTED-RANGE             36740000
367500                            ASC-ITEM-AT-TOP-OF-PANEL.             36750000
367600                                                                  36760000
367700     PERFORM 4410-READ-TEMP-STORAGE.                              36770000
367800     PERFORM 3200-RESET-ATTRIBUTES.                               36780017
367900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        36790000
368000                                                                  36800000
368100/                                                                 36810000
368200*----------------------------------------------------------------*36820000
368300*                                                                *36830000
368400*    ENSURE EACH SELECTED ITEM HAS A STATUS CODE OF CM.  IF SO,  *36840000
368500*    UPDATE THE VERIFIED ITEM QUANTITY AND THE AP VERIFIED ITEM  *36850000
368600*    QUANTITY ON TRECDIS; SET THE STATUS TO VE                   *36860000
368700*    NEXT, CHECK IF ALL TRECITM ROWS FOR THIS RECEIVER HAVE A    *36870000
368800*    VE STATUS CODE.  IF SO, UPDATE THE TRECEIV ROW TO A STATUS  *36880000
368900*    OF VE.                                                      *36890000
369000*                                                                *36900000
369100*----------------------------------------------------------------*36910000
369200                                                                  36920000
369300 5055-ADJUST-UPDATE.                                              36930000
369400                                                                  36940000
369500     MOVE +1                   TO  ASC-BLK-SUB.                   36950000
369600     PERFORM 5100-WRITE-TEMP-STORAGE.                             36960000
369700     ADD +1                    TO  ASC-BLK-SUB.                   36970000
369800     PERFORM 5100-WRITE-TEMP-STORAGE.                             36980000
369900                                                                  36990000
370000     PERFORM 5405-PROCESS-TRECDIS                                 37000000
370100             VARYING PV-ITEM                                      37010000
370200             FROM 1 BY 1                                          37020000
370300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     37030000
370400/                                                                 37040000
370500*----------------------------------------------------------------*37050000
370600*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *37060000
370700*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *37070000
370800*----------------------------------------------------------------*37080000
370900                                                                  37090000
371000 5100-WRITE-TEMP-STORAGE.                                         37100000
371100                                                                  37110000
371200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     37120000
371300                                   TO PV-LIST-ITEM-NUMBER.        37130000
371400     COMPUTE PV-BLOCK-NUMBER =                                    37140000
371500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    37150000
371600                                                                  37160000
371700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             37170000
371800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             37180000
371900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      37190000
372000             PERFORM 5105-REWRITE-ASC-LISTQ                       37200000
372100         END-IF                                                   37210000
372200     ELSE                                                         37220000
372300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       37230000
372400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            37240000
372500         PERFORM 5110-WRITE-ASC-LISTQ                             37250000
372600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   37260000
372700     END-IF.                                                      37270000
372800                                                                  37280000
372900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             37290000
373000                                                                  37300000
373100******************************************************************37310000
373200** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **37320000
373300** SPECIFIC COMMAREA.                                           **37330000
373400******************************************************************37340000
373500                                                                  37350000
373600 5105-REWRITE-ASC-LISTQ.                                          37360000
373700                                                                  37370000
373800     EXEC CICS                                                    37380000
373900         WRITEQ TS                                                37390000
374000             QUEUE (ASC-LIST-QUEUE-NAME)                          37400000
374100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               37410000
374200             ITEM  (PV-BLOCK-NUMBER)                              37420000
374300             REWRITE                                              37430000
374400             RESP  (PV-CICS-RESP)                                 37440000
374500     END-EXEC.                                                    37450000
374600                                                                  37460000
374700     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           37470000
374800         CONTINUE                                                 37480000
374900     ELSE                                                         37490000
375000         SET DP013-CICS-ABEND            TO TRUE                  37500000
375100         SET DP013-NO-ROLLBACK           TO TRUE                  37510000
375200         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       37520000
375300         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     37530000
375400                                         TO DP013-MESSAGE-TEXT(1) 37540000
375500         PERFORM DP013-0000-PROCESS-ABEND                         37550000
375600     END-IF.                                                      37560000
375700                                                                  37570000
375800******************************************************************37580000
375900** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **37590000
376000** SPECIFIC COMMAREA.                                           **37600000
376100******************************************************************37610000
376200                                                                  37620000
376300 5110-WRITE-ASC-LISTQ.                                            37630000
376400                                                                  37640000
376500     EXEC CICS                                                    37650000
376600         WRITEQ TS                                                37660000
376700             QUEUE (ASC-LIST-QUEUE-NAME)                          37670000
376800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               37680000
376900             ITEM  (PV-BLOCK-NUMBER)                              37690000
377000             RESP  (PV-CICS-RESP)                                 37700000
377100     END-EXEC.                                                    37710000
377200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      37720000
377300         SET DP013-CICS-ABEND      TO TRUE                        37730000
377400         SET DP013-NO-ROLLBACK     TO TRUE                        37740000
377500         MOVE '5110-WRITE-ASC-LISTQ'                              37750000
377600                                   TO DP013-PARAGRAPH             37760000
377700         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           37770000
377800                                   TO DP013-MESSAGE-TEXT(1)       37780000
377900         PERFORM DP013-0000-PROCESS-ABEND                         37790000
378000     END-IF.                                                      37800000
378100/                                                                 37810000
378200*----------------------------------------------------------------*37820000
378300*    CHECK FOR OVERAGE BEFORE UPDATING.                          *37830000
378400*----------------------------------------------------------------*37840000
378500                                                                  37850000
378600 5400-PROCESS-TRECDIS.                                            37860000
378700                                                                  37870000
378800     PERFORM 6112-READ-LIST-QUEUE.                                37880000
378900                                                                  37890000
379000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       37900000
379100         PERFORM                                                  37910000
379200         VARYING LQW-IDX                                          37920000
379300         FROM 1 BY 1                                              37930000
379400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            37940000
379500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          37950000
379600                                                                  37960000
379700             IF  LQW-SELECT (LQW-IDX)                             37970000
379800                 MOVE LQW-ORD-LNE-NBR(LQW-IDX)                    37980000
379900                              TO  RECDIS-ORD-LNE-NBR              37990000
380000                 PERFORM 5410-SELECT-RECDIS                       38000000
380100                 IF LQW-ITEM-QTY (LQW-IDX) >                      38010000
380200                                RECDIS-EXPTED-ITM-QTY             38020000
380300                      SET  LQW-PACK-BY-ST-OVERAGE (LQW-IDX)       38030000
380400                                  TO TRUE                         38040000
380500                      SET  ASC-OVERAGE TO TRUE                    38050000
380600                 END-IF                                           38060000
380700*DC-XXX                                                           38070000
380800                                                                  38080000
380900                 MOVE LQW-SELECTED-SW (LQW-IDX)                   38090000
381000                              TO  LQW-TEMP-SELECTED-SW (LQW-IDX)  38100000
381100             END-IF                                               38110000
381200         END-PERFORM                                              38120000
381300     END-IF.                                                      38130000
381400                                                                  38140000
381500     MOVE PV-ITEM                TO  PV-SAVE-ITEM.                38150000
381600     PERFORM 6111-WRITE-LIST-QUEUE.                               38160000
381700/                                                                 38170000
381800*----------------------------------------------------------------*38180000
381900*    UPDATE TRECDIS FOR EACH SELECTED ITEM.                      *38190000
382000*----------------------------------------------------------------*38200000
382100                                                                  38210000
382200 5405-PROCESS-TRECDIS.                                            38220000
382300                                                                  38230000
382400     PERFORM 6112-READ-LIST-QUEUE.                                38240000
382500                                                                  38250000
382600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       38260000
382700         PERFORM                                                  38270000
382800         VARYING LQW-IDX                                          38280000
382900         FROM 1 BY 1                                              38290000
383000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            38300000
383100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          38310000
383200                                                                  38320000
383300             IF  LQW-SELECT (LQW-IDX)                             38330000
383400                 MOVE LQW-ORD-LNE-NBR(LQW-IDX)                    38340000
383500                              TO  RECDIS-ORD-LNE-NBR              38350000
383600                 PERFORM 5410-SELECT-RECDIS                       38360000
383700                 PERFORM 5505-ADD-TO-RECD-AUDIT-BEFORE            38370000
383800                 IF LQW-STATUS-CDE(LQW-IDX) = PC-VE               38380000
383900                     SET PS-TRECDIS-VE-UPDATE-DONE TO TRUE        38390000
384000                     MOVE LQW-ACTUAL-ITM-QTY(LQW-IDX)             38400000
384100                              TO  PA-UPDATE-FROM-QTY              38410000
384200                     MOVE LQW-ITEM-QTY (LQW-IDX)                  38420000
384300                              TO  RECDIS-VERIFY-ITM-QTY           38430000
384400                                  LQW-ACTUAL-ITM-QTY(LQW-IDX)     38440000
384500                                  RECDIS-AP-VERIFY-ITM-QTY        38450000
384600                                  LQW-VERIFY-ITM-QTY(LQW-IDX)     38460000
384700                                  PA-UPDATE-TO-QTY                38470000
384800                     SUBTRACT PA-UPDATE-FROM-QTY                  38480000
384900                         FROM PA-UPDATE-TO-QTY                    38490000
385000                       GIVING PA-UPDATE-DIFF-QTY                  38500000
385100                 ELSE                                             38510000
385200                     SET PS-TRECDIS-VE-UPDATE-NOT-DONE TO TRUE    38520000
385300                     MOVE LQW-ITEM-QTY (LQW-IDX)                  38530000
385400                              TO  RECDIS-VERIFY-ITM-QTY           38540000
385500                                  LQW-ACTUAL-ITM-QTY(LQW-IDX)     38550000
385600                 END-IF                                           38560000
385700                 PERFORM 5500-UPDATE-TRECDIS                      38570000
385800                 IF PS-RECITM-NOT-UPDATED                         38580000
385900                     PERFORM 5600-UPDATE-TRECITM                  38590000
386000                 END-IF                                           38600000
386100                 IF  PA-UPDATE-DIFF-QTY NOT EQUAL TO ZERO         38610000
386200                 AND PS-TRECDIS-VE-UPDATE-DONE                    38620000
386300                     PERFORM 6150-WRITE-VRFY-ADJ-QUEUE            38630008
386400                     PERFORM 7500-PROCESS-UNITS-WORK              38640000
386500                 END-IF                                           38650000
386600*DC-XXX                                                           38660000
386700                 IF  LQW-PURITM-UNT-QTY (LQW-IDX) NOT EQUAL ZERO  38670000
386800                     AND LQW-STATUS-CDE (LQW-IDX) = 'VE'          38680000
386900                     PERFORM 5800-CHECK-PO-STATUS                 38690000
387000                 END-IF                                           38700000
387100*DC-XXX                                                           38710000
387200                                                                  38720000
387300                 SET LQW-DESELECT (LQW-IDX)                       38730000
387400                              TO  TRUE                            38740000
387500                 SET LQW-SEL-ZERO-NO (LQW-IDX)                    38750000
387600                              TO  TRUE                            38760000
387700                 MOVE LQW-SELECTED-SW (LQW-IDX)                   38770000
387800                              TO  LQW-TEMP-SELECTED-SW (LQW-IDX)  38780000
387900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    38790000
388000             END-IF                                               38800000
388100         END-PERFORM                                              38810000
388200     END-IF.                                                      38820000
388300                                                                  38830000
388400     MOVE PV-ITEM                TO  PV-SAVE-ITEM.                38840000
388500     PERFORM 6111-WRITE-LIST-QUEUE.                               38850000
388600/                                                                 38860000
388700 5410-SELECT-RECDIS.                                              38870000
388800                                                                  38880000
388900     EXEC SQL                                                     38890000
389000         SELECT ORD_NBR,                                          38900000
389100                ORD_LNE_NBR,                                      38910000
389200                REC_SEQ_NBR,                                      38920000
389300                OPER_UNT_ID,                                      38930000
389400                FCLTY_ID,                                         38940000
389500                CRE_TMST,                                         38950000
389600                CRE_UID,                                          38960000
389700                VER_STATUS_CDE,                                   38970000
389800                EXPTED_ITM_QTY,                                   38980000
389900                VERIFY_ITM_QTY,                                   38990000
390000                AP_VERIFY_ITM_QTY,                                39000000
390100                STR_NBR,                                          39010000
390200                STR_FCLTY_ID,                                     39020000
390300                PLAN_ITM_QTY,                                     39030000
390400                AP_PRC_CDE,                                       39040000
390500                AP_PRC_DTE,                                       39050000
390600                CURRENT TIMESTAMP                                 39060000
390700          INTO      :RECDIS-ORD-NBR,                              39070000
390800                :RECDIS-ORD-LNE-NBR,                              39080000
390900                :RECDIS-REC-SEQ-NBR,                              39090000
391000                :RECDIS-OPER-UNT-ID,                              39100000
391100                :RECDIS-FCLTY-ID,                                 39110000
391200                :RECDIS-CRE-TMST,                                 39120000
391300                :RECDIS-CRE-UID,                                  39130000
391400                :RECDIS-VER-STATUS-CDE,                           39140000
391500                :RECDIS-EXPTED-ITM-QTY,                           39150000
391600                :RECDIS-VERIFY-ITM-QTY,                           39160000
391700                :RECDIS-AP-VERIFY-ITM-QTY,                        39170000
391800                :RECDIS-STR-NBR,                                  39180000
391900                :RECDIS-STR-FCLTY-ID,                             39190000
392000                :RECDIS-PLAN-ITM-QTY,                             39200000
392100                :RECDIS-AP-PRC-CDE,                               39210000
392200                :RECDIS-AP-PRC-DTE,                               39220000
392300                :PV-CURRENT-TIMESTAMP                             39230000
392400           FROM TRECDIS                                           39240000
392500         WHERE   ORD_NBR             =  :ASC-PO-NBR               39250000
392600          AND    ORD_LNE_NBR         =  :RECDIS-ORD-LNE-NBR       39260000
392700          AND    REC_SEQ_NBR         =  :ASC-REC-SEQ-NBR          39270000
392800          AND    OPER_UNT_ID         =  :ASC-OPER-UNT-ID          39280000
392900          AND    FCLTY_ID            =  :ASC-FCLTY-ID             39290000
393100          AND    STR_NBR             =  :ASC-STR-NBR              39310000
393200     END-EXEC                                                     39320000
393300                                                                  39330000
393400     EVALUATE TRUE                                                39340000
393500         WHEN SQLCODE = ZERO                                      39350000
393600             SET PS-DATA-OK TO TRUE                               39360000
393700         WHEN SQLCODE = +100                                      39370000
393800              CONTINUE                                            39380000
393900         WHEN SQLCODE = -904                                      39390000
394000         WHEN SQLCODE = -911                                      39400000
394100         WHEN SQLCODE = -913                                      39410000
394200             PERFORM 9900-SOFT-ABORT                              39420000
394300         WHEN SQLWARN0 NOT = SPACES                               39430000
394400         WHEN SQLCODE      NOT = ZERO                             39440000
394500              MOVE '5410-SELECT-RECDIS'                           39450000
394600                             TO DP013-PARAGRAPH                   39460000
394700              MOVE 'UNSUCCESSFUL SELECT OF TRECDIS'               39470000
394800                             TO DP013-MESSAGE-TEXT (1)            39480000
394900              MOVE SQLCA         TO DP013-SQLCA                   39490000
395000              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          39500000
395100              SET DP013-DB2-ABEND                                 39510000
395200                  DP013-XCTL-DISPLAY-RESTART                      39520000
395300                             TO TRUE                              39530000
395400              PERFORM DP013-0000-PROCESS-ABEND                    39540000
395500     END-EVALUATE.                                                39550000
395600/                                                                 39560000
395700 5500-UPDATE-TRECDIS.                                             39570000
395800                                                                  39580000
395900     EXEC SQL                                                     39590000
396000          UPDATE TRECDIS                                          39600000
396100          SET    VERIFY_ITM_QTY      =  :RECDIS-VERIFY-ITM-QTY    39610000
396200              ,  AP_VERIFY_ITM_QTY   =  :RECDIS-AP-VERIFY-ITM-QTY 39620000
396300          WHERE                                                   39630000
396400                 ORD_NBR             =  :ASC-PO-NBR               39640000
396500          AND    ORD_LNE_NBR         =  :RECDIS-ORD-LNE-NBR       39650000
396600          AND    REC_SEQ_NBR         =  :ASC-REC-SEQ-NBR          39660000
396700          AND    OPER_UNT_ID         =  :ASC-OPER-UNT-ID          39670000
396800          AND    FCLTY_ID            =  :ASC-FCLTY-ID             39680000
397000          AND    STR_NBR             =  :ASC-STR-NBR              39700000
397100     END-EXEC.                                                    39710000
397200                                                                  39720000
397300     EVALUATE TRUE                                                39730000
397400         WHEN SQLCODE = ZERO                                      39740000
397500              CONTINUE                                            39750000
397600         WHEN SQLCODE = -904                                      39760000
397700         WHEN SQLCODE = -911                                      39770000
397800         WHEN SQLCODE = -913                                      39780000
397900              SET PS-UPDATES-DONE TO TRUE                         39790000
398000              PERFORM 9900-SOFT-ABORT                             39800000
398100         WHEN SQLWARN0 NOT = SPACE                                39810000
398200         WHEN SQLCODE NOT = ZERO                                  39820000
398300              MOVE '5500-UPDATE-TRECDIS'                          39830000
398400                               TO DP013-PARAGRAPH                 39840000
398500              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            39850000
398600                               TO DP013-MESSAGE-TEXT (1)          39860000
398700              MOVE SQLCA       TO DP013-SQLCA                     39870000
398800              SET DP013-DB2-ABEND                                 39880000
398900                               TO TRUE                            39890000
399000              PERFORM DP013-0000-PROCESS-ABEND                    39900000
399100     END-EVALUATE.                                                39910000
399200/                                                                 39920000
399300 5505-ADD-TO-RECD-AUDIT-BEFORE.                                   39930000
399400     IF  PS-DATA-OK                                               39940000
399500         MOVE 'D'                     TO RC031-TABLE-TO-AUDIT     39950000
399600         MOVE 'B'                     TO RC031-AUD-TYP-CDE        39960000
399700         MOVE 'U'                     TO RC031-AUD-FUNC-CDE       39970000
399800         MOVE ASC-OPER-UNT-ID         TO RC031-OPER-UNT-ID        39980000
399900         MOVE ASC-FCLTY-ID            TO RC031-FCLTY-ID           39990000
400000         MOVE ASC-PO-NBR              TO RC031-PO-NBR             40000000
400100         MOVE ASC-REC-SEQ-NBR         TO RC031-REC-SEQ-NBR        40010000
400200         MOVE RECDIS-ORD-LNE-NBR      TO RC031-PO-LNE-NBR         40020000
400300         MOVE ASC-STR-NBR             TO RC031-STR-NBR            40030000
400400         MOVE PC-CURRENT-PROGRAM-NAME TO RC031-UPD-PGM-ID         40040000
400500         MOVE DP020-USERID            TO RC031-UPD-UID            40050000
400600         MOVE PV-CURRENT-TIMESTAMP    TO RC031-UPD-TMST           40060000
400700                                                                  40070000
400800         EXEC CICS                                                40080000
400900              LINK PROGRAM  (PC-AUDIT-RTN)                        40090000
401000              COMMAREA (RC031-FIELDS)                             40100000
401100              LENGTH   (PC-AUDIT-RTN-LENGTH)                      40110000
401200         END-EXEC                                                 40120000
401300                                                                  40130000
401400         EVALUATE TRUE                                            40140000
401500             WHEN RC031-CALL-SUCCESSFUL                           40150000
401600                 CONTINUE                                         40160000
401700             WHEN OTHER                                           40170000
401800                 MOVE '5505-ADD-TO-RECD-AUDIT-BEFORE'             40180000
401900                                     TO DP013-PARAGRAPH           40190000
402000                 MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'            40200000
402100                                     TO DP013-MESSAGE-TEXT (1)    40210000
402200                 MOVE RC031-RETURN-DESC                           40220000
402300                                     TO DP013-MESSAGE-TEXT (2)    40230000
402400                 MOVE RC031-SQLCA    TO DP013-SQLCA               40240000
402500                 SET DP013-DB2-ABEND                              40250000
402600                     DP013-XCTL-DISPLAY-RESTART                   40260000
402700                                     TO TRUE                      40270000
402800                 PERFORM DP013-0000-PROCESS-ABEND                 40280000
402900         END-EVALUATE                                             40290000
403000     END-IF.                                                      40300000
403100/                                                                 40310000
403200 5600-UPDATE-TRECITM.                                             40320000
403300                                                                  40330000
403400     SET PS-DATA-OK          TO  TRUE.                            40340000
403500     PERFORM 5610-SELECT-TRECITM.                                 40350000
403600     IF RECITM-RCPT-DISTR-UPD-CDE = 'U'                           40360000
403700     OR RECITM-RCPT-DISTR-UPD-CDE = 'A'                           40370000
403800         CONTINUE                                                 40380000
403900     ELSE                                                         40390000
404000         PERFORM 5610-PROCESS-TRECITM                             40400000
404100         SET PS-RECITM-UPDATED TO TRUE                            40410000
404200     END-IF.                                                      40420000
404300                                                                  40430000
404400 5610-PROCESS-TRECITM.                                            40440000
404500     MOVE 'I'                 TO RC031-TABLE-TO-AUDIT.            40450000
404600     MOVE 'B'                 TO RC031-AUD-TYP-CDE.               40460000
404700     MOVE 'U'                 TO RC031-AUD-FUNC-CDE.              40470000
404800     MOVE ASC-OPER-UNT-ID     TO RC031-OPER-UNT-ID.               40480000
404900     MOVE ASC-FCLTY-ID        TO RC031-FCLTY-ID.                  40490000
405000     MOVE ASC-PO-NBR          TO RC031-PO-NBR.                    40500000
405100     MOVE ASC-REC-SEQ-NBR     TO RC031-REC-SEQ-NBR.               40510000
405200     MOVE RECDIS-ORD-LNE-NBR  TO RC031-PO-LNE-NBR.                40520000
405300     MOVE PC-CURRENT-PROGRAM-NAME                                 40530000
405400                              TO RC031-UPD-PGM-ID.                40540000
405500                                                                  40550000
405600     EXEC CICS                                                    40560000
405700          LINK PROGRAM  (PC-AUDIT-RTN)                            40570000
405800          COMMAREA (RC031-FIELDS)                                 40580000
405900          LENGTH   (PC-AUDIT-RTN-LENGTH)                          40590000
406000     END-EXEC.                                                    40600000
406100                                                                  40610000
406200     EVALUATE TRUE                                                40620000
406300         WHEN RC031-CALL-SUCCESSFUL                               40630000
406400             CONTINUE                                             40640000
406500         WHEN OTHER                                               40650000
406600             MOVE '5600-UPDATE-TRECITM'                           40660000
406700                                 TO DP013-PARAGRAPH               40670000
406800             MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                40680000
406900                                 TO DP013-MESSAGE-TEXT (1)        40690000
407000             MOVE RC031-RETURN-DESC                               40700000
407100                                 TO DP013-MESSAGE-TEXT (2)        40710000
407200             MOVE RC031-SQLCA    TO DP013-SQLCA                   40720000
407300             SET DP013-DB2-ABEND                                  40730000
407400                 DP013-XCTL-DISPLAY-RESTART                       40740000
407500                                 TO TRUE                          40750000
407600             PERFORM DP013-0000-PROCESS-ABEND                     40760000
407700     END-EVALUATE.                                                40770000
407800                                                                  40780000
407900     IF  PS-DATA-OK                                               40790000
408000         MOVE PC-A               TO                               40800000
408100                                       PV-RCPT-DISTR-UPD-CDE      40810000
408200         PERFORM 5620-UPDATE-TRECITM                              40820000
408300     END-IF.                                                      40830000
408400/                                                                 40840000
408500*----------------------------------------------------------------*40850000
408600*    GET THE CURRENT ROW FOR PROCESSING.                         *40860000
408700*----------------------------------------------------------------*40870000
408800                                                                  40880000
408900 5610-SELECT-TRECITM.                                             40890000
409000                                                                  40900000
409100     EXEC SQL                                                     40910000
409200          SELECT                                                  40920000
409300                ORD_NBR                                           40930000
409400              , ORD_LNE_NBR                                       40940000
409500              , REC_SEQ_NBR                                       40950000
409600              , OPER_UNT_ID                                       40960000
409700              , FCLTY_ID                                          40970000
409800              , CRE_TMST                                          40980000
409900              , CRE_UID                                           40990000
410000              , PO_VER_NBR                                        41000000
410100              , ITM_NBR                                           41010000
410200              , PRE_TKT_IND                                       41020000
410300              , TKT_FMT_ID                                        41030000
410400              , RTV_IND                                           41040000
410500              , STATUS_CDE                                        41050000
410600              , VER_STATUS_CDE                                    41060000
410700              , PKSL_ITM_QTY                                      41070000
410800              , DTL_CK_ITM_QTY                                    41080000
410900              , INNR_PACK_QTY                                     41090000
411000              , CASE_PACK_QTY                                     41100000
411100              , RTV_QTY                                           41110000
411200              , EXPTED_CART_CNT                                   41120000
411300              , ACTL_CART_CNT                                     41130000
411400              , MKING_APRON_TMST                                  41140000
411500              , UNT_COST_AMT                                      41150000
411600              , COLOR_DESC                                        41160000
411700              , SIZE_DESC                                         41170000
411800              , VEND_STYL_NAME                                    41180000
411900              , VEND_DESC                                         41190000
412000              , VERFYD_TMST                                       41200000
412100              , PKSL_NBR                                          41210000
412200              , REC_INV_LNE_NBR                                   41220000
412300              , DMG_ITM_QTY                                       41230000
412400              , UPD_TMST                                          41240000
412500              , UPD_UID                                           41250000
412600              , UPD_PGM_ID                                        41260000
412700              , RCPT_DISTR_UPD_CDE                                41270000
412800              , CURRENT TIMESTAMP                                 41280000
412900          INTO                                                    41290000
413000                :RECITM-ORD-NBR                                   41300000
413100              , :RECITM-ORD-LNE-NBR                               41310000
413200              , :RECITM-REC-SEQ-NBR                               41320000
413300              , :RECITM-OPER-UNT-ID                               41330000
413400              , :RECITM-FCLTY-ID                                  41340000
413500              , :RECITM-CRE-TMST                                  41350000
413600              , :RECITM-CRE-UID                                   41360000
413700              , :RECITM-PO-VER-NBR                                41370000
413800              , :RECITM-ITM-NBR                                   41380000
413900              , :RECITM-PRE-TKT-IND                               41390000
414000              , :RECITM-TKT-FMT-ID                                41400000
414100              , :RECITM-RTV-IND                                   41410000
414200              , :RECITM-STATUS-CDE                                41420000
414300              , :RECITM-VER-STATUS-CDE                            41430000
414400              , :RECITM-PKSL-ITM-QTY                              41440000
414500              , :RECITM-DTL-CK-ITM-QTY                            41450000
414600              , :RECITM-INNR-PACK-QTY                             41460000
414700              , :RECITM-CASE-PACK-QTY                             41470000
414800              , :RECITM-RTV-QTY                                   41480000
414900              , :RECITM-EXPTED-CART-CNT                           41490000
415000              , :RECITM-ACTL-CART-CNT                             41500000
415100              , :RECITM-MKING-APRON-TMST                          41510000
415200              , :RECITM-UNT-COST-AMT                              41520000
415300              , :RECITM-COLOR-DESC                                41530000
415400              , :RECITM-SIZE-DESC                                 41540000
415500              , :RECITM-VEND-STYL-NAME                            41550000
415600              , :RECITM-VEND-DESC                                 41560000
415700              , :RECITM-VERFYD-TMST                               41570000
415800              , :RECITM-PKSL-NBR                                  41580000
415900              , :RECITM-REC-INV-LNE-NBR                           41590000
416000              , :RECITM-DMG-ITM-QTY                               41600000
416100              , :RECITM-UPD-TMST                                  41610000
416200              , :RECITM-UPD-UID                                   41620000
416300              , :RECITM-UPD-PGM-ID                                41630000
416400              , :RECITM-RCPT-DISTR-UPD-CDE                        41640000
416500              , :PV-CURRENT-TIMESTAMP                             41650000
416600          FROM                                                    41660000
416700                TRECITM                                           41670000
416800          WHERE                                                   41680000
416900                 ORD_NBR             =  :ASC-PO-NBR               41690000
417000          AND    ORD_LNE_NBR         =  :RECDIS-ORD-LNE-NBR       41700000
417100          AND    REC_SEQ_NBR         =  :ASC-REC-SEQ-NBR          41710000
417200          AND    OPER_UNT_ID         =  :ASC-OPER-UNT-ID          41720000
417300          AND    FCLTY_ID            =  :ASC-FCLTY-ID             41730000
417400          AND    VER_STATUS_CDE      =  :PC-A                     41740000
417500     END-EXEC.                                                    41750000
417600                                                                  41760000
417700     EVALUATE TRUE                                                41770000
417800         WHEN SQLCODE = ZERO                                      41780000
417900              CONTINUE                                            41790000
418000         WHEN SQLCODE = +100                                      41800000
418100              SET PS-DATA-NOT-OK    TO  TRUE                      41810000
418200         WHEN SQLCODE = -904                                      41820000
418300         WHEN SQLCODE = -911                                      41830000
418400         WHEN SQLCODE = -913                                      41840000
418500              PERFORM 9900-SOFT-ABORT                             41850000
418600         WHEN SQLWARN0 NOT = SPACE                                41860000
418700         WHEN SQLCODE NOT = ZERO                                  41870000
418800              MOVE '5610-SELECT-TRECITM'                          41880000
418900                               TO DP013-PARAGRAPH                 41890000
419000              MOVE 'SELECT TRECITM'                               41900000
419100                               TO DP013-MESSAGE-TEXT (1)          41910000
419200              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        41920000
419300              MOVE SQLCA       TO DP013-SQLCA                     41930000
419400              SET DP013-DB2-ABEND                                 41940000
419500                               TO TRUE                            41950000
419600              PERFORM DP013-0000-PROCESS-ABEND                    41960000
419700     END-EVALUATE.                                                41970000
419800/                                                                 41980000
419900*----------------------------------------------------------------*41990000
420000*    UPDATE THE CURRENT ROW.                                     *42000000
420100*----------------------------------------------------------------*42010000
420200                                                                  42020000
420300 5620-UPDATE-TRECITM.                                             42030000
420400                                                                  42040000
420500     EXEC SQL                                                     42050000
420600          UPDATE                                                  42060000
420700                TRECITM                                           42070000
420800          SET   RCPT_DISTR_UPD_CDE =  :PV-RCPT-DISTR-UPD-CDE      42080000
420900          WHERE                                                   42090000
421000                 ORD_NBR             =  :ASC-PO-NBR               42100000
421100          AND    ORD_LNE_NBR         =  :RECDIS-ORD-LNE-NBR       42110000
421200          AND    REC_SEQ_NBR         =  :ASC-REC-SEQ-NBR          42120000
421300          AND    OPER_UNT_ID         =  :ASC-OPER-UNT-ID          42130000
421400          AND    FCLTY_ID            =  :ASC-FCLTY-ID             42140000
421500          AND    VER_STATUS_CDE      =  :PC-A                     42150000
421600     END-EXEC.                                                    42160000
421700                                                                  42170000
421800     EVALUATE TRUE                                                42180000
421900         WHEN SQLCODE = ZERO                                      42190000
422000              CONTINUE                                            42200000
422100         WHEN SQLCODE = -904                                      42210000
422200         WHEN SQLCODE = -911                                      42220000
422300         WHEN SQLCODE = -913                                      42230000
422400              SET PS-UPDATES-DONE TO TRUE                         42240000
422500              PERFORM 9900-SOFT-ABORT                             42250000
422600         WHEN SQLWARN0 NOT = SPACE                                42260000
422700         WHEN SQLCODE NOT = ZERO                                  42270000
422800              MOVE '5620-UPDATE-TRECITM'                          42280000
422900                               TO DP013-PARAGRAPH                 42290000
423000              MOVE 'UPDATE TRECITM STATUS CODE'                   42300000
423100                               TO DP013-MESSAGE-TEXT (1)          42310000
423200              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        42320000
423300              MOVE SQLCA       TO DP013-SQLCA                     42330000
423400              SET DP013-DB2-ABEND                                 42340000
423500                               TO TRUE                            42350000
423600              PERFORM DP013-0000-PROCESS-ABEND                    42360000
423700     END-EVALUATE.                                                42370000
423800/                                                                 42380000
423900                                                                  42390000
424000 5650-SELECT-DISTHD.                                              42400000
424100                                                                  42410000
424200     EXEC SQL                                                     42420000
424300         SELECT A.TOT_CART_CNT,                                   42430000
424400                A.VRFD_TMST,                                      42440036
424500                B.P2L_SPLT_UNT_QTY,                               42450000
424600                B.FCSE_SPLT_UNT_QTY,                              42460000
424700                B.INPK_SPLT_UNT_QTY                               42470000
424800          INTO                                                    42480000
424900               :DISTHD-TOT-CART-CNT,                              42490000
425000               :DISTHD-VRFD-TMST,                                 42500036
425100               :DISTDT-P2L-SPLT-UNT-QTY,                          42510000
425200               :DISTDT-FCSE-SPLT-UNT-QTY,                         42520000
425300               :DISTDT-INPK-SPLT-UNT-QTY                          42530000
425400           FROM TDISTHD A,                                        42540000
425500                TDISTDT B                                         42550000
425600         WHERE   A.ORD_NBR           =  :ASC-PO-NBR               42560000
425700          AND    A.ORD_NBR           =   B.ORD_NBR                42570000
425800          AND    A.ORD_LNE_NBR       =  :PV-ORD-LNE-NBR           42580000
425900          AND    A.ORD_LNE_NBR       =   B.ORD_LNE_NBR            42590000
426000          AND    A.RCVR_SEQ_NBR      =  :ASC-REC-SEQ-NBR          42600000
426100          AND    A.RCVR_SEQ_NBR      =   B.RCVR_SEQ_NBR           42610000
426200          AND    B.STR_NBR           =  :ASC-STR-NBR              42620000
426300     END-EXEC                                                     42630000
426400                                                                  42640000
426500     EVALUATE TRUE                                                42650000
426600         WHEN SQLCODE = ZERO                                      42660000
426700              CONTINUE                                            42670000
426800         WHEN SQLCODE = +100                                      42680000
426900              CONTINUE                                            42690000
427000         WHEN SQLCODE = -904                                      42700000
427100         WHEN SQLCODE = -911                                      42710000
427200         WHEN SQLCODE = -913                                      42720000
427300             PERFORM 9900-SOFT-ABORT                              42730000
427400         WHEN SQLWARN0 NOT = SPACES                               42740000
427500         WHEN SQLCODE      NOT = ZERO                             42750000
427600              MOVE '5650-SELECT-DIST ROWS'                        42760000
427700                             TO DP013-PARAGRAPH                   42770000
427800              MOVE 'UNSUCCESSFUL JOIN OF TDISTHD/TDISTDT'         42780000
427900                             TO DP013-MESSAGE-TEXT (1)            42790000
428000              MOVE SQLCA         TO DP013-SQLCA                   42800000
428100              MOVE 'TDISTHD' TO DP013-DB2-TABLE-NAME (1)          42810000
428200              SET DP013-DB2-ABEND                                 42820000
428300                  DP013-XCTL-DISPLAY-RESTART                      42830000
428400                             TO TRUE                              42840000
428500              PERFORM DP013-0000-PROCESS-ABEND                    42850000
428600     END-EVALUATE.                                                42860000
428700/                                                                 42870000
428800*DC-XXX FROM HERE THROUGH 5854                                    42880000
428900*----------------------------------------------------------------*42890000
429000*    SINCE THE RECEDIS VERIFY QUANTITY HAS CHANGED, WE MUST      *42900000
429100*    CHECK IF IT IS NOW LESS THAN PURITM.  IF SO, RESET THE      *42910000
429200*    STATUS CODE TO IP AND CHECK THE PURCHS ROW.                 *42920000
429300*----------------------------------------------------------------*42930000
429400                                                                  42940000
429500 5800-CHECK-PO-STATUS.                                            42950000
429600                                                                  42960000
429700     PERFORM 5820-GET-RECDIS-QTY.                                 42970000
429800                                                                  42980000
429900     IF (LQW-PURITM-UNT-QTY(LQW-IDX) > RECDIS-AP-VERIFY-ITM-QTY   42990000
430000     AND LQW-PURITM-STATUS-CDE(LQW-IDX) EQUAL PC-CM)              43000000
430100         MOVE PC-AC               TO  LQW-PURITM-STATUS-CDE       43010000
430200                                     (LQW-IDX)                    43020000
430300         PERFORM 5830-UPDATE-PURITM-STATUS                        43030000
430400         IF  LQW-PURCHS-STATUS-CDE(LQW-IDX) EQUAL PC-CM           43040000
430500             MOVE PC-AC           TO  LQW-PURCHS-STATUS-CDE       43050000
430600                                     (LQW-IDX)                    43060000
430700***          PERFORM 5850-UPDATE-PURCHS-STATUS                    43070009
430800         END-IF                                                   43080000
430900     ELSE                                                         43090000
431000         IF (LQW-PURITM-UNT-QTY(LQW-IDX) NOT GREATER              43100000
431100                                      RECDIS-AP-VERIFY-ITM-QTY    43110000
431200         AND LQW-PURITM-STATUS-CDE(LQW-IDX) NOT EQUAL PC-CM)      43120000
431300             MOVE PC-CM           TO  LQW-PURITM-STATUS-CDE       43130000
431400                                     (LQW-IDX)                    43140000
431500             PERFORM 5830-UPDATE-PURITM-STATUS                    43150000
431600             IF  LQW-PURCHS-STATUS-CDE(LQW-IDX) NOT EQUAL PC-CM   43160000
431700                 MOVE PC-CM       TO  LQW-PURCHS-STATUS-CDE       43170000
431800                                     (LQW-IDX)                    43180000
431900***              PERFORM 5850-UPDATE-PURCHS-STATUS                43190009
432000             END-IF                                               43200000
432100         END-IF                                                   43210000
432200     END-IF.                                                      43220000
432300/                                                                 43230000
432400 5820-GET-RECDIS-QTY.                                             43240000
432500                                                                  43250000
432600     EXEC SQL                                                     43260000
432700          SELECT                                                  43270000
432800                 SUM(C.AP_VERIFY_ITM_QTY)                         43280000
432900           INTO                                                   43290000
433000                 :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND           43300000
433100           FROM                                                   43310000
433200                 TRECEIV A                                        43320000
433300               , TRECITM B                                        43330000
433400               , TRECDIS C                                        43340000
433500           WHERE                                                  43350000
433600                 A.ORD_NBR         =  :ASC-PO-NBR                 43360000
433700            AND  A.ORD_NBR         =  B.ORD_NBR                   43370000
433800            AND  A.ORD_NBR         =  C.ORD_NBR                   43380000
433900            AND  B.ORD_LNE_NBR     =  :RECDIS-ORD-LNE-NBR         43390000
434000            AND  B.ORD_LNE_NBR     =  C.ORD_LNE_NBR               43400000
434100            AND  A.VER_STATUS_CDE  =  :PC-A                       43410000
434200            AND  B.VER_STATUS_CDE  =  :PC-A                       43420000
434400            AND  B.STATUS_CDE      =  :PC-VE                      43440000
434500            AND  A.REC_SEQ_NBR     =  B.REC_SEQ_NBR               43450000
434600            AND  A.REC_SEQ_NBR     =  C.REC_SEQ_NBR               43460000
434700     END-EXEC.                                                    43470000
434800                                                                  43480000
434900     EVALUATE TRUE                                                43490000
435000         WHEN SQLCODE = ZERO                                      43500000
435100         WHEN SQLCODE = +100                                      43510000
435200              CONTINUE                                            43520000
435300         WHEN SQLCODE = -904                                      43530000
435400         WHEN SQLCODE = -911                                      43540000
435500         WHEN SQLCODE = -913                                      43550000
435600              PERFORM 9900-SOFT-ABORT                             43560000
435700         WHEN SQLWARN0 NOT = SPACE                                43570000
435800         WHEN SQLCODE NOT = ZERO                                  43580000
435900              MOVE '5820-GET-RECDIS-QTY'                          43590000
436000                               TO DP013-PARAGRAPH                 43600000
436100              MOVE 'SUM RECDIS VERIFY QUANTITY'                   43610000
436200                               TO DP013-MESSAGE-TEXT (1)          43620000
436300              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        43630000
436400              MOVE SQLCA       TO DP013-SQLCA                     43640000
436500              SET DP013-DB2-ABEND                                 43650000
436600                               TO TRUE                            43660000
436700              PERFORM DP013-0000-PROCESS-ABEND                    43670000
436800     END-EVALUATE.                                                43680000
436900/                                                                 43690000
437000*----------------------------------------------------------------*43700000
437100*    TO UPDATE THE PURCHASE ITEM ROW, WE REALLY MAKE THE CURRENT *43710000
437200*    ROW INACTIVE AND INSERT A NEW ROW WITH AN ACTIVE STATUS.    *43720000
437300*                                                                *43730008
437400*    ** NOTE **                                                  *43740008
437500*    WE WILL NOT BE MAKING THE CURRENT ROW ACTIVE AND INSERTING  *43750008
437600*    A NEW ROW WITH AN ACTIVE STATUS FOR PUCHASE ITEM ROWS ON    *43760008
437700*    PURCHASE ORDERS THAT ARE IN RMS.                            *43770008
437800*----------------------------------------------------------------*43780000
437900                                                                  43790000
438000 5830-UPDATE-PURITM-STATUS.                                       43800000
438100                                                                  43810000
438200     PERFORM 5831-GET-PURITM.                                     43820000
438300     IF  SQLCODE EQUAL ZERO                                       43830000
438400     AND PURITM-STATUS-CDE NOT = PC-RV                            43840000
438500         MOVE LQW-PURITM-STATUS-CDE (LQW-IDX)                     43850000
438600                                    TO  PURITM-STATUS-CDE         43860000
438700         IF PURITM-STATUS-CDE = PC-AC                             43870000
438800             MOVE ASC-DEPT-NBR      TO PV-DEPT-NBR-X              43880008
438900             MOVE PV-DEPT-NBR       TO PV-DEPT-NBR-KEY            43890008
439000             SET PS-NO-RMS-PO       TO TRUE                       43900008
439100*** CHECK IF THIS IS AN RMS PO.  IF IT IS, WE DO NOT WANT TO      43910000
439200*** VERSION THE TPURITM ROWS; WE JUST WANT TO UPDATE THE ROW.     43920008
439300             PERFORM 5856-CHECK-FOR-RMS-PO                        43930000
439400             IF PV-DB2-COUNT > ZERO                               43940008
439500                 SET PS-RMS-PO      TO TRUE                       43950000
439600                 PERFORM 5834-ONLY-UPDATE-PURITM                  43960000
439700             ELSE                                                 43970000
439800                 PERFORM 5832-UPDATE-PURITM                       43980000
439900                 ADD 1              TO  PURITM-VER-NBR            43990000
440000                 PERFORM 5833-INSERT-PURITM                       44000000
440100             END-IF                                               44010000
440200         ELSE                                                     44020000
440300             PERFORM 5834-ONLY-UPDATE-PURITM                      44030000
440400         END-IF                                                   44040000
440500     END-IF.                                                      44050000
440600                                                                  44060000
440700 5831-GET-PURITM.                                                 44070000
440800                                                                  44080000
440900     EXEC SQL                                                     44090000
441000          SELECT                                                  44100000
441100                  PO_NBR                                          44110000
441200                , VER_NBR                                         44120000
441300                , PO_LNE_NBR                                      44130000
441400                , VER_STATUS_CDE                                  44140000
441500                , SKU_SEQ_NBR                                     44150000
441600                , CL_NBR                                          44160000
441700                , VEND_STYL_NAME                                  44170000
441800                , COLOR_DESC                                      44180000
441900                , SIZE_DESC                                       44190000
442000                , UM_IND                                          44200000
442100                , UNT_QTY                                         44210000
442200                , UNT_RTL_PR_AMT                                  44220000
442300                , UNT_COST_AMT                                    44230000
442400                , TOT_VAL_COST_AMT                                44240000
442500                , TOT_VAL_RTL_AMT                                 44250000
442600                , MU_PCT                                          44260000
442700                , CRE_TMST                                        44270000
442800                , LAST_UPD_TMST                                   44280000
442900                , ITM_NBR                                         44290000
443000                , SKU_DESC                                        44300000
443100                , COLOR_CDE                                       44310000
443200                , SIZE_CDE                                        44320000
443300                , AD_EVNT_DTE                                     44330000
443400                , STATUS_CDE                                      44340000
443500                , CRE_BY_UID                                      44350000
443600                , LAST_UPD_BY_UID                                 44360000
443700                , GP_RTL_AMT                                      44370000
443800                , GP_QTY                                          44380000
443900                , APP_PO_LNE_NBR                                  44390000
444000                , PIC_ITM_IND                                     44400000
444100                , PIC_PG_NBR                                      44410000
444200                , PRD_1ST_COST_AMT                                44420000
444300                , PO_PREPK_ID                                     44430000
444400                , PREPK_RATO_QTY                                  44440000
444500                , SHIP_TO_TMP_DC_IND                              44450000
444600                , RMS_PO_SKU_NBR                                  44460000
444700                , CNCLD_UNT_QTY                                   44470008
444800           INTO                                                   44480000
444900                  :PURITM-PO-NBR                                  44490000
445000                , :PURITM-VER-NBR                                 44500000
445100                , :PURITM-PO-LNE-NBR                              44510000
445200                , :PURITM-VER-STATUS-CDE                          44520000
445300                , :PURITM-SKU-SEQ-NBR                             44530000
445400                , :PURITM-CL-NBR                                  44540000
445500                , :PURITM-VEND-STYL-NAME                          44550000
445600                , :PURITM-COLOR-DESC                              44560000
445700                , :PURITM-SIZE-DESC                               44570000
445800                , :PURITM-UM-IND                                  44580000
445900                , :PURITM-UNT-QTY                                 44590000
446000                , :PURITM-UNT-RTL-PR-AMT                          44600000
446100                , :PURITM-UNT-COST-AMT                            44610000
446200                , :PURITM-TOT-VAL-COST-AMT                        44620000
446300                , :PURITM-TOT-VAL-RTL-AMT                         44630000
446400                , :PURITM-MU-PCT                                  44640000
446500                , :PURITM-CRE-TMST                                44650000
446600                , :PURITM-LAST-UPD-TMST                           44660000
446700                , :PURITM-ITM-NBR                                 44670000
446800                , :PURITM-SKU-DESC                                44680000
446900                , :PURITM-COLOR-CDE                               44690000
447000                , :PURITM-SIZE-CDE                                44700000
447100                , :PURITM-AD-EVNT-DTE                             44710000
447200                , :PURITM-STATUS-CDE                              44720000
447300                , :PURITM-CRE-BY-UID                              44730000
447400                , :PURITM-LAST-UPD-BY-UID                         44740000
447500                , :PURITM-GP-RTL-AMT                              44750000
447600                , :PURITM-GP-QTY                                  44760000
447700                , :PURITM-APP-PO-LNE-NBR                          44770000
447800                , :PURITM-PIC-ITM-IND                             44780000
447900                , :PURITM-PIC-PG-NBR                              44790000
448000                , :PURITM-PRD-1ST-COST-AMT                        44800000
448100                , :PURITM-PO-PREPK-ID                             44810000
448200                , :PURITM-PREPK-RATO-QTY                          44820000
448300                , :PURITM-SHIP-TO-TMP-DC-IND                      44830000
448400                , :PURITM-RMS-PO-SKU-NBR                          44840000
448500                , :PURITM-CNCLD-UNT-QTY                           44850008
448600           FROM                                                   44860000
448700                  TPURITM                                         44870000
448800          WHERE                                                   44880000
448900                  PO_NBR             =  :ASC-PO-NBR               44890000
449000           AND    APP_PO_LNE_NBR     =  :RECDIS-ORD-LNE-NBR       44900000
449100           AND    VER_STATUS_CDE     =  :PC-A                     44910000
449200     END-EXEC.                                                    44920000
449300                                                                  44930000
449400     EVALUATE TRUE                                                44940000
449500         WHEN SQLCODE = ZERO                                      44950000
449600         WHEN SQLCODE = +100                                      44960000
449700              CONTINUE                                            44970000
449800         WHEN SQLCODE = -904                                      44980000
449900         WHEN SQLCODE = -911                                      44990000
450000         WHEN SQLCODE = -913                                      45000000
450100              PERFORM 9900-SOFT-ABORT                             45010000
450200         WHEN SQLWARN0 NOT = SPACE                                45020000
450300         WHEN SQLCODE NOT = ZERO                                  45030000
450400              MOVE '5831-GET-PURITM'                              45040000
450500                               TO DP013-PARAGRAPH                 45050000
450600              MOVE 'SUM RECDIS VERIFY QUANTITY'                   45060000
450700                               TO DP013-MESSAGE-TEXT (1)          45070000
450800              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        45080000
450900              MOVE SQLCA       TO DP013-SQLCA                     45090000
451000              SET DP013-DB2-ABEND                                 45100000
451100                               TO TRUE                            45110000
451200              PERFORM DP013-0000-PROCESS-ABEND                    45120000
451300     END-EVALUATE.                                                45130000
451400/                                                                 45140000
451500 5832-UPDATE-PURITM.                                              45150000
451600                                                                  45160000
451700     EXEC SQL                                                     45170000
451800          UPDATE                                                  45180000
451900                 TPURITM                                          45190000
452000          SET    VER_STATUS_CDE   =  :PC-I                        45200000
452100          WHERE                                                   45210000
452200                 PO_NBR           =  :ASC-PO-NBR                  45220000
452300          AND    APP_PO_LNE_NBR   =  :RECDIS-ORD-LNE-NBR          45230000
452400          AND    VER_STATUS_CDE   =  :PC-A                        45240000
452500     END-EXEC.                                                    45250000
452600                                                                  45260000
452700     EVALUATE TRUE                                                45270000
452800         WHEN SQLCODE = ZERO                                      45280000
452900              CONTINUE                                            45290000
453000         WHEN SQLCODE = -904                                      45300000
453100         WHEN SQLCODE = -911                                      45310000
453200         WHEN SQLCODE = -913                                      45320000
453300              SET PS-UPDATES-DONE TO TRUE                         45330000
453400              PERFORM 9900-SOFT-ABORT                             45340000
453500         WHEN SQLWARN0 NOT = SPACE                                45350000
453600         WHEN SQLCODE NOT = ZERO                                  45360000
453700              MOVE '5832-UPDATE-PURITM'                           45370000
453800                               TO DP013-PARAGRAPH                 45380000
453900              MOVE 'SET CURRENT ROW TO INACTIVE'                  45390000
454000                               TO DP013-MESSAGE-TEXT (1)          45400000
454100              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        45410000
454200              MOVE SQLCA       TO DP013-SQLCA                     45420000
454300              SET DP013-DB2-ABEND                                 45430000
454400                               TO TRUE                            45440000
454500              PERFORM DP013-0000-PROCESS-ABEND                    45450000
454600     END-EVALUATE.                                                45460000
454700/                                                                 45470000
454800 5833-INSERT-PURITM.                                              45480000
454900                                                                  45490000
455000     EXEC SQL                                                     45500000
455100          INSERT                                                  45510000
455200           INTO   TPURITM                                         45520000
455300                 (PO_NBR                                          45530000
455400                , VER_NBR                                         45540000
455500                , PO_LNE_NBR                                      45550000
455600                , VER_STATUS_CDE                                  45560000
455700                , SKU_SEQ_NBR                                     45570000
455800                , CL_NBR                                          45580000
455900                , VEND_STYL_NAME                                  45590000
456000                , COLOR_DESC                                      45600000
456100                , SIZE_DESC                                       45610000
456200                , UM_IND                                          45620000
456300                , UNT_QTY                                         45630000
456400                , UNT_RTL_PR_AMT                                  45640000
456500                , UNT_COST_AMT                                    45650000
456600                , TOT_VAL_COST_AMT                                45660000
456700                , TOT_VAL_RTL_AMT                                 45670000
456800                , MU_PCT                                          45680000
456900                , CRE_TMST                                        45690000
457000                , LAST_UPD_TMST                                   45700000
457100                , ITM_NBR                                         45710000
457200                , SKU_DESC                                        45720000
457300                , COLOR_CDE                                       45730000
457400                , SIZE_CDE                                        45740000
457500                , AD_EVNT_DTE                                     45750000
457600                , STATUS_CDE                                      45760000
457700                , CRE_BY_UID                                      45770000
457800                , LAST_UPD_BY_UID                                 45780000
457900                , GP_RTL_AMT                                      45790000
458000                , GP_QTY                                          45800000
458100                , APP_PO_LNE_NBR                                  45810000
458200                , PIC_ITM_IND                                     45820000
458300                , PIC_PG_NBR                                      45830000
458400                , PRD_1ST_COST_AMT                                45840000
458500                , STAT_TMST                                       45850000
458600                , PO_PREPK_ID                                     45860000
458700                , PREPK_RATO_QTY                                  45870000
458800                , SHIP_TO_TMP_DC_IND                              45880000
458900                , RMS_PO_SKU_NBR                                  45890000
459000                , CNCLD_UNT_QTY                                   45900008
459100                  )                                               45910000
459200          VALUES                                                  45920000
459300                 (:PURITM-PO-NBR                                  45930000
459400                , :PURITM-VER-NBR                                 45940000
459500                , :PURITM-PO-LNE-NBR                              45950000
459600                , :PC-A                                           45960000
459700                , :PURITM-SKU-SEQ-NBR                             45970000
459800                , :PURITM-CL-NBR                                  45980000
459900                , :PURITM-VEND-STYL-NAME                          45990000
460000                , :PURITM-COLOR-DESC                              46000000
460100                , :PURITM-SIZE-DESC                               46010000
460200                , :PURITM-UM-IND                                  46020000
460300                , :PURITM-UNT-QTY                                 46030000
460400                , :PURITM-UNT-RTL-PR-AMT                          46040000
460500                , :PURITM-UNT-COST-AMT                            46050000
460600                , :PURITM-TOT-VAL-COST-AMT                        46060000
460700                , :PURITM-TOT-VAL-RTL-AMT                         46070000
460800                , :PURITM-MU-PCT                                  46080000
460900                , :PURITM-CRE-TMST                                46090000
461000                ,  CURRENT TIMESTAMP                              46100000
461100                , :PURITM-ITM-NBR                                 46110000
461200                , :PURITM-SKU-DESC                                46120000
461300                , :PURITM-COLOR-CDE                               46130000
461400                , :PURITM-SIZE-CDE                                46140000
461500                , :PURITM-AD-EVNT-DTE                             46150000
461600                , :PURITM-STATUS-CDE                              46160000
461700                , :PURITM-CRE-BY-UID                              46170000
461800                , :DP020-USERID                                   46180000
461900                , :PURITM-GP-RTL-AMT                              46190000
462000                , :PURITM-GP-QTY                                  46200000
462100                , :PURITM-APP-PO-LNE-NBR                          46210000
462200                , :PURITM-PIC-ITM-IND                             46220000
462300                , :PURITM-PIC-PG-NBR                              46230000
462400                , :PURITM-PRD-1ST-COST-AMT                        46240000
462500                , CURRENT TIMESTAMP                               46250000
462600                , :PURITM-PO-PREPK-ID                             46260000
462700                , :PURITM-PREPK-RATO-QTY                          46270000
462800                , :PURITM-SHIP-TO-TMP-DC-IND                      46280000
462900                , :PURITM-RMS-PO-SKU-NBR                          46290000
463000                , :PURITM-CNCLD-UNT-QTY                           46300008
463100                  )                                               46310000
463200     END-EXEC.                                                    46320000
463300                                                                  46330000
463400     EVALUATE TRUE                                                46340000
463500         WHEN SQLCODE = ZERO                                      46350000
463600              CONTINUE                                            46360000
463700         WHEN SQLCODE = -904                                      46370000
463800         WHEN SQLCODE = -911                                      46380000
463900         WHEN SQLCODE = -913                                      46390000
464000              SET PS-UPDATES-DONE TO TRUE                         46400000
464100              PERFORM 9900-SOFT-ABORT                             46410000
464200         WHEN SQLWARN0 NOT = SPACE                                46420000
464300         WHEN SQLCODE NOT = ZERO                                  46430000
464400              MOVE '5833-INSERT-PURITM'                           46440000
464500                               TO DP013-PARAGRAPH                 46450000
464600              MOVE 'INSERT NEW ROW IN TPURITM TABLE'              46460000
464700                               TO DP013-MESSAGE-TEXT (1)          46470000
464800              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        46480000
464900              MOVE SQLCA       TO DP013-SQLCA                     46490000
465000              SET DP013-DB2-ABEND                                 46500000
465100                               TO TRUE                            46510000
465200              PERFORM DP013-0000-PROCESS-ABEND                    46520000
465300     END-EVALUATE.                                                46530000
465400/                                                                 46540000
465500 5834-ONLY-UPDATE-PURITM.                                         46550000
465600                                                                  46560000
465700     EXEC SQL                                                     46570000
465800          UPDATE                                                  46580000
465900                 TPURITM                                          46590000
466000          SET    STATUS_CDE       =  :PURITM-STATUS-CDE           46600000
466100               , STAT_TMST        =  CURRENT TIMESTAMP            46610000
466200          WHERE                                                   46620000
466300                 PO_NBR           =  :ASC-PO-NBR                  46630000
466400          AND    APP_PO_LNE_NBR   =  :RECDIS-ORD-LNE-NBR          46640000
466500          AND    VER_STATUS_CDE   =  :PC-A                        46650000
466600     END-EXEC.                                                    46660000
466700                                                                  46670000
466800     EVALUATE TRUE                                                46680000
466900         WHEN SQLCODE = ZERO                                      46690000
467000              CONTINUE                                            46700000
467100         WHEN SQLCODE = -904                                      46710000
467200         WHEN SQLCODE = -911                                      46720000
467300         WHEN SQLCODE = -913                                      46730000
467400              SET PS-UPDATES-DONE TO TRUE                         46740000
467500              PERFORM 9900-SOFT-ABORT                             46750000
467600         WHEN SQLWARN0 NOT = SPACE                                46760000
467700         WHEN SQLCODE NOT = ZERO                                  46770000
467800              MOVE '5834-ONLY-UPDATE-PURITM'                      46780000
467900                               TO DP013-PARAGRAPH                 46790000
468000              MOVE 'SET CURRENT ROW TO INACTIVE'                  46800000
468100                               TO DP013-MESSAGE-TEXT (1)          46810000
468200              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        46820000
468300              MOVE SQLCA       TO DP013-SQLCA                     46830000
468400              SET DP013-DB2-ABEND                                 46840000
468500                               TO TRUE                            46850000
468600              PERFORM DP013-0000-PROCESS-ABEND                    46860000
468700     END-EVALUATE.                                                46870000
468800/                                                                 46880000
468900*----------------------------------------------------------------*46890000
469000*    HERE, WE CHECK IF ALL PURCHASE ITEM LINES ARE EQUAL TO      *46900000
469100*    'CM' 'CB' OR 'CA' IF WE ARE TRYING TO CHANGE THE PURCHASE   *46910000
469200*    HEADER TO 'CM'.  OTHERWISE, JUST UPDATE THE PO HEADER TO    *46920000
469300*    A STATUS OF 'AC' WITH NO CHECK ON PURITM.                   *46930000
469400*                                                                *46940000
469500* ** 06/02/2003 CHANGE **                                        *46950000
469600*    CHECK IF THIS IS AN RMS PO.  IF IT IS, WE DO NOT WANT TO    *46960008
469700*    UPDATE THE PURCHASE ORDER TABLE.  THIS TABLE WILL GET       *46970000
469800*    UPDATED THROUGH AN RMS PROCESS.                             *46980000
469900*----------------------------------------------------------------*46990000
470000                                                                  47000000
470100 5850-UPDATE-PURCHS-STATUS.                                       47010000
470200                                                                  47020000
470300     IF  LQW-PURCHS-STATUS-CDE (LQW-IDX) EQUAL PC-CM              47030000
470400         PERFORM 5851-COUNT-PO-LINE-ROWS                          47040000
470500         IF  PV-DB2-COUNT EQUAL ZERO                              47050000
470600             IF  PS-RMS-PO                                        47060000
470700                 CONTINUE                                         47070000
470800             ELSE                                                 47080000
470900                 IF  PS-CHECKED-FOR-RMS-PO                        47090000
471000                     PERFORM 5852-GET-TPURCHS-STATUS              47100008
471100                     MOVE LQW-PURCHS-STATUS-CDE (LQW-IDX)         47110000
471200                                       TO  PURCHS-STATUS-CDE      47120000
471300                     PERFORM 5855-ONLY-UPDATE-PURCHS-STATUS       47130000
471400                 ELSE                                             47140000
471500                     MOVE ASC-DEPT-NBR TO PV-DEPT-NBR-X           47150008
471600                     MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY         47160008
471700                     SET PS-NO-RMS-PO  TO TRUE                    47170008
471800                     PERFORM 5856-CHECK-FOR-RMS-PO                47180000
471900                     IF  PV-DB2-COUNT = ZERO                      47190000
472000                         PERFORM 5852-GET-TPURCHS-STATUS          47200000
472100                         MOVE LQW-PURCHS-STATUS-CDE (LQW-IDX)     47210000
472200                                       TO  PURCHS-STATUS-CDE      47220000
472300                         PERFORM 5855-ONLY-UPDATE-PURCHS-STATUS   47230000
472400                     END-IF                                       47240000
472500                 END-IF                                           47250000
472600             END-IF                                               47260000
472700         ELSE                                                     47270000
472800             IF  PS-RMS-PO                                        47280000
472900                 CONTINUE                                         47290000
473000             ELSE                                                 47300000
473100                 IF  PS-CHECKED-FOR-RMS-PO                        47310000
473200                     MOVE PC-AC TO PURCHS-STATUS-CDE              47320000
473300                                   LQW-PURCHS-STATUS-CDE (LQW-IDX)47330000
473400                 ELSE                                             47340000
473500                     MOVE ASC-DEPT-NBR TO PV-DEPT-NBR-X           47350008
473600                     MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY         47360008
473700                     SET PS-NO-RMS-PO  TO TRUE                    47370008
473800                     PERFORM 5856-CHECK-FOR-RMS-PO                47380000
473900                     IF  PV-DB2-COUNT = ZERO                      47390000
474000                         MOVE PC-AC                               47400008
474100                                TO PURCHS-STATUS-CDE              47410008
474200                                   LQW-PURCHS-STATUS-CDE (LQW-IDX)47420000
474300                     END-IF                                       47430000
474400                 END-IF                                           47440000
474500             END-IF                                               47450000
474600         END-IF                                                   47460000
474700     ELSE                                                         47470000
474800         IF  PS-RMS-PO                                            47480000
474900             CONTINUE                                             47490000
475000         ELSE                                                     47500000
475100             IF  PS-CHECKED-FOR-RMS-PO                            47510000
475200                 PERFORM 5852-GET-TPURCHS-STATUS                  47520000
475300                 MOVE LQW-PURCHS-STATUS-CDE (LQW-IDX)             47530000
475400                                   TO  PURCHS-STATUS-CDE          47540000
475500                 PERFORM 5853-UPDATE-PURCHS-STATUS                47550000
475600                 ADD 1             TO  PURCHS-VER-NBR             47560000
475700                 PERFORM 5854-INSERT-PURCHS                       47570000
475800             ELSE                                                 47580000
475900                 MOVE ASC-DEPT-NBR TO PV-DEPT-NBR-X               47590008
476000                 MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY             47600008
476100                 SET PS-NO-RMS-PO  TO TRUE                        47610008
476200                 PERFORM 5856-CHECK-FOR-RMS-PO                    47620000
476300                 IF  PV-DB2-COUNT = ZERO                          47630000
476400                     PERFORM 5852-GET-TPURCHS-STATUS              47640000
476500                     MOVE LQW-PURCHS-STATUS-CDE (LQW-IDX)         47650000
476600                                   TO  PURCHS-STATUS-CDE          47660000
476700                     PERFORM 5853-UPDATE-PURCHS-STATUS            47670000
476800                     ADD 1         TO  PURCHS-VER-NBR             47680000
476900                     PERFORM 5854-INSERT-PURCHS                   47690000
477000                 END-IF                                           47700000
477100             END-IF                                               47710000
477200         END-IF                                                   47720000
477300     END-IF.                                                      47730000
477400                                                                  47740000
477500 5851-COUNT-PO-LINE-ROWS.                                         47750000
477600                                                                  47760000
477700     MOVE ZERO            TO  PV-DB2-COUNT.                       47770000
477800     EXEC SQL                                                     47780000
477900          SELECT                                                  47790000
478000                COUNT(*)                                          47800000
478100          INTO                                                    47810000
478200                :PV-DB2-COUNT :PV-NULL-IND                        47820000
478300          FROM                                                    47830000
478400                TPURITM                                           47840000
478500          WHERE                                                   47850000
478600                PO_NBR             =  :ASC-PO-NBR                 47860000
478700          AND   VER_STATUS_CDE     =  :PC-A                       47870000
478800           AND (STATUS_CDE        ^=  :PC-CB                      47880000
478900           AND  STATUS_CDE        ^=  :PC-CA)                     47890000
479000     END-EXEC.                                                    47900000
479100                                                                  47910000
479200     EVALUATE TRUE                                                47920000
479300         WHEN SQLCODE = ZERO                                      47930000
479400         WHEN SQLCODE = +100                                      47940000
479500              CONTINUE                                            47950000
479600         WHEN SQLCODE = -904                                      47960000
479700         WHEN SQLCODE = -911                                      47970000
479800         WHEN SQLCODE = -913                                      47980000
479900              PERFORM 9900-SOFT-ABORT                             47990000
480000         WHEN SQLWARN0 NOT = SPACE                                48000000
480100         WHEN SQLCODE NOT = ZERO                                  48010000
480200              MOVE '5851-COUNT-PO-LINE-ROWS'                      48020000
480300                               TO DP013-PARAGRAPH                 48030000
480400              MOVE 'COUNT NUMBER OF "CM", "CB", "CA" STATUS ROWS' 48040000
480500                               TO DP013-MESSAGE-TEXT (1)          48050000
480600              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        48060000
480700              MOVE SQLCA       TO DP013-SQLCA                     48070000
480800              SET DP013-DB2-ABEND                                 48080000
480900                               TO TRUE                            48090000
481000              PERFORM DP013-0000-PROCESS-ABEND                    48100000
481100     END-EVALUATE.                                                48110000
481200                                                                  48120000
481300 5852-GET-TPURCHS-STATUS.                                         48130000
481400                                                                  48140000
481500     EXEC SQL                                                     48150000
481600          SELECT                                                  48160000
481700                  PO_NBR                                          48170000
481800                , VER_NBR                                         48180000
481900                , VER_STATUS_CDE                                  48190000
482000                , PO_TYP_CDE                                      48200000
482100                , PO_CATEG_CDE                                    48210000
482200                , EDI_IND                                         48220000
482300                , TOT_UNT_QTY                                     48230000
482400                , TOT_VAL_COST_AMT                                48240000
482500                , TOT_VAL_RTL_AMT                                 48250000
482600                , TOT_MU_PCT                                      48260000
482700                , TOT_SKUS_QTY                                    48270000
482800                , IMPRT_AGNT_PO_NBR                               48280000
482900                , IMPRT_ORD_OFF_NAME                              48290000
483000                , IMPRT_VEND_NAME                                 48300000
483100                , IMPRT_FCTRY_NAME                                48310000
483200                , IMPRT_CNTRY_NAME                                48320000
483300                , VEND_CNTRY_NAME                                 48330000
483400                , NEW_STR_PO_IND                                  48340000
483500                , IMPRT_PO_IND                                    48350000
483600                , IMPRT_AGNT_PO_IND                               48360000
483700                , STATUS_TMST                                     48370000
483800                , LAST_UPD_TMST                                   48380000
483900                , EDI_REXMIT_IND                                  48390000
484000                , EDI_REXMIT_TMST                                 48400000
484100                , DIR_STR_IND                                     48410000
484200                , LAST_UPD_BY_UID                                 48420000
484300                , APP_BY_UID                                      48430000
484400                , OTB_PER_NBR                                     48440000
484500                , DEPT_NBR                                        48450000
484600                , ENT_ID                                          48460000
484700                , STATUS_CDE                                      48470000
484800                , CRE_BY_UID                                      48480000
484900                , REJ_CT                                          48490000
485000                , REJ_UID                                         48500000
485100                , ORD_DTE                                         48510000
485200                , REVISION_CT                                     48520000
485300                , ADR_SEQ_NBR                                     48530000
485400                , DEST_KNOWN_IND                                  48540000
485500                , RLSE_IND                                        48550000
485600                , RLSE_DTE                                        48560000
485700                , PLCMNT_CNTRY_CDE                                48570000
485800                , PROD_CNTRY_CDE                                  48580000
485900                , UNT_PER_CBMT_QTY                                48590000
486000                , CRE_TMST                                        48600000
486100                , PRG_LAST_ACTVY_DTE                              48610000
486200                , PKGNG_CDE                                       48620000
486300                , SEASET_YR                                       48630000
486400                , SEASET_SHRT_NM                                  48640000
486500                , QTA_CTG_CDE                                     48650000
486600                , PO_IN_RMS_IND                                   48660000
486700                , RMS_PO_UPD_TMST                                 48670000
486800                , DUP_SKU_IND                                     48680000
486900                , ORIG_PKGNG_CDE                                  48690000
487000           INTO                                                   48700000
487100                 :PURCHS-PO-NBR                                   48710000
487200                ,:PURCHS-VER-NBR                                  48720000
487300                ,:PURCHS-VER-STATUS-CDE                           48730000
487400                ,:PURCHS-PO-TYP-CDE                               48740000
487500                ,:PURCHS-PO-CATEG-CDE                             48750000
487600                ,:PURCHS-EDI-IND                                  48760000
487700                ,:PURCHS-TOT-UNT-QTY                              48770000
487800                ,:PURCHS-TOT-VAL-COST-AMT                         48780000
487900                ,:PURCHS-TOT-VAL-RTL-AMT                          48790000
488000                ,:PURCHS-TOT-MU-PCT                               48800000
488100                ,:PURCHS-TOT-SKUS-QTY                             48810000
488200                ,:PURCHS-IMPRT-AGNT-PO-NBR                        48820000
488300                ,:PURCHS-IMPRT-ORD-OFF-NAME                       48830000
488400                ,:PURCHS-IMPRT-VEND-NAME                          48840000
488500                ,:PURCHS-IMPRT-FCTRY-NAME                         48850000
488600                ,:PURCHS-IMPRT-CNTRY-NAME                         48860000
488700                ,:PURCHS-VEND-CNTRY-NAME                          48870000
488800                ,:PURCHS-NEW-STR-PO-IND                           48880000
488900                ,:PURCHS-IMPRT-PO-IND                             48890000
489000                ,:PURCHS-IMPRT-AGNT-PO-IND                        48900000
489100                ,:PURCHS-STATUS-TMST                              48910000
489200                ,:PURCHS-LAST-UPD-TMST                            48920000
489300                ,:PURCHS-EDI-REXMIT-IND                           48930000
489400                ,:PURCHS-EDI-REXMIT-TMST                          48940000
489500                ,:PURCHS-DIR-STR-IND                              48950000
489600                ,:PURCHS-LAST-UPD-BY-UID                          48960000
489700                ,:PURCHS-APP-BY-UID                               48970000
489800                ,:PURCHS-OTB-PER-NBR                              48980000
489900                ,:PURCHS-DEPT-NBR                                 48990000
490000                ,:PURCHS-ENT-ID                                   49000000
490100                ,:PURCHS-STATUS-CDE                               49010000
490200                ,:PURCHS-CRE-BY-UID                               49020000
490300                ,:PURCHS-REJ-CT                                   49030000
490400                ,:PURCHS-REJ-UID                                  49040000
490500                ,:PURCHS-ORD-DTE                                  49050000
490600                ,:PURCHS-REVISION-CT                              49060000
490700                ,:PURCHS-ADR-SEQ-NBR                              49070000
490800                ,:PURCHS-DEST-KNOWN-IND                           49080000
490900                ,:PURCHS-RLSE-IND                                 49090000
491000                ,:PURCHS-RLSE-DTE                                 49100000
491100                ,:PURCHS-PLCMNT-CNTRY-CDE                         49110000
491200                ,:PURCHS-PROD-CNTRY-CDE                           49120000
491300                ,:PURCHS-UNT-PER-CBMT-QTY                         49130000
491400                ,:PURCHS-CRE-TMST                                 49140000
491500                ,:PURCHS-PRG-LAST-ACTVY-DTE                       49150000
491600                ,:PURCHS-PKGNG-CDE                                49160000
491700                ,:PURCHS-SEASET-YR                                49170000
491800                ,:PURCHS-SEASET-SHRT-NM                           49180000
491900                ,:PURCHS-QTA-CTG-CDE                              49190000
492000                ,:PURCHS-PO-IN-RMS-IND                            49200000
492100                ,:PURCHS-RMS-PO-UPD-TMST                          49210000
492200                ,:PURCHS-DUP-SKU-IND                              49220000
492300                ,:PURCHS-ORIG-PKGNG-CDE                           49230000
492400          FROM                                                    49240000
492500                 TPURCHS                                          49250000
492600          WHERE                                                   49260000
492700                PO_NBR             =  :ASC-PO-NBR                 49270000
492800          AND   VER_STATUS_CDE     =  :PC-A                       49280000
492900     END-EXEC.                                                    49290000
493000                                                                  49300000
493100     EVALUATE TRUE                                                49310000
493200         WHEN SQLCODE = ZERO                                      49320000
493300         WHEN SQLCODE = +100                                      49330000
493400              CONTINUE                                            49340000
493500         WHEN SQLCODE = -904                                      49350000
493600         WHEN SQLCODE = -911                                      49360000
493700         WHEN SQLCODE = -913                                      49370000
493800              PERFORM 9900-SOFT-ABORT                             49380000
493900         WHEN SQLWARN0 NOT = SPACE                                49390000
494000         WHEN SQLCODE NOT = ZERO                                  49400000
494100              MOVE '5852-GET-TPURCHS-STATUS'                      49410000
494200                               TO DP013-PARAGRAPH                 49420000
494300              MOVE 'GET THE PURCHASE HEADER'                      49430000
494400                               TO DP013-MESSAGE-TEXT (1)          49440000
494500              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        49450000
494600              MOVE SQLCA       TO DP013-SQLCA                     49460000
494700              SET DP013-DB2-ABEND                                 49470000
494800                               TO TRUE                            49480000
494900              PERFORM DP013-0000-PROCESS-ABEND                    49490000
495000     END-EVALUATE.                                                49500000
495100/                                                                 49510000
495200 5853-UPDATE-PURCHS-STATUS.                                       49520000
495300                                                                  49530000
495400     EXEC SQL                                                     49540000
495500          UPDATE                                                  49550000
495600                TPURCHS                                           49560000
495700           SET                                                    49570000
495800                VER_STATUS_CDE     =  :PC-I                       49580000
495900          WHERE                                                   49590000
496000                PO_NBR             =  :ASC-PO-NBR                 49600000
496100          AND   VER_STATUS_CDE     =  :PC-A                       49610000
496200     END-EXEC.                                                    49620000
496300                                                                  49630000
496400     EVALUATE TRUE                                                49640000
496500         WHEN SQLCODE = ZERO                                      49650000
496600         WHEN SQLCODE = +100                                      49660000
496700              CONTINUE                                            49670000
496800         WHEN SQLCODE = -904                                      49680000
496900         WHEN SQLCODE = -911                                      49690000
497000         WHEN SQLCODE = -913                                      49700000
497100              SET PS-UPDATES-DONE TO TRUE                         49710000
497200              PERFORM 9900-SOFT-ABORT                             49720000
497300         WHEN SQLWARN0 NOT = SPACE                                49730000
497400         WHEN SQLCODE NOT = ZERO                                  49740000
497500              MOVE '5853-UPDATE-PURCHS-STATUS'                    49750000
497600                               TO DP013-PARAGRAPH                 49760000
497700              MOVE 'GET THE PURCHASE HEADER'                      49770000
497800                               TO DP013-MESSAGE-TEXT (1)          49780000
497900              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        49790000
498000              MOVE SQLCA       TO DP013-SQLCA                     49800000
498100              SET DP013-DB2-ABEND                                 49810000
498200                               TO TRUE                            49820000
498300              PERFORM DP013-0000-PROCESS-ABEND                    49830000
498400     END-EVALUATE.                                                49840000
498500/                                                                 49850000
498600 5854-INSERT-PURCHS.                                              49860000
498700                                                                  49870000
498800     EXEC SQL                                                     49880000
498900          INSERT                                                  49890000
499000           INTO   TPURCHS                                         49900000
499100                 (PO_NBR                                          49910000
499200                , VER_NBR                                         49920000
499300                , VER_STATUS_CDE                                  49930000
499400                , PO_TYP_CDE                                      49940000
499500                , PO_CATEG_CDE                                    49950000
499600                , EDI_IND                                         49960000
499700                , TOT_UNT_QTY                                     49970000
499800                , TOT_VAL_COST_AMT                                49980000
499900                , TOT_VAL_RTL_AMT                                 49990000
500000                , TOT_MU_PCT                                      50000000
500100                , TOT_SKUS_QTY                                    50010000
500200                , IMPRT_AGNT_PO_NBR                               50020000
500300                , IMPRT_ORD_OFF_NAME                              50030000
500400                , IMPRT_VEND_NAME                                 50040000
500500                , IMPRT_FCTRY_NAME                                50050000
500600                , IMPRT_CNTRY_NAME                                50060000
500700                , VEND_CNTRY_NAME                                 50070000
500800                , NEW_STR_PO_IND                                  50080000
500900                , IMPRT_PO_IND                                    50090000
501000                , IMPRT_AGNT_PO_IND                               50100000
501100                , STATUS_TMST                                     50110000
501200                , LAST_UPD_TMST                                   50120000
501300                , EDI_REXMIT_IND                                  50130000
501400                , EDI_REXMIT_TMST                                 50140000
501500                , DIR_STR_IND                                     50150000
501600                , LAST_UPD_BY_UID                                 50160000
501700                , APP_BY_UID                                      50170000
501800                , OTB_PER_NBR                                     50180000
501900                , DEPT_NBR                                        50190000
502000                , ENT_ID                                          50200000
502100                , STATUS_CDE                                      50210000
502200                , CRE_BY_UID                                      50220000
502300                , REJ_CT                                          50230000
502400                , REJ_UID                                         50240000
502500                , ORD_DTE                                         50250000
502600                , REVISION_CT                                     50260000
502700                , ADR_SEQ_NBR                                     50270000
502800                , DEST_KNOWN_IND                                  50280000
502900                , RLSE_IND                                        50290000
503000                , RLSE_DTE                                        50300000
503100                , PLCMNT_CNTRY_CDE                                50310000
503200                , PROD_CNTRY_CDE                                  50320000
503300                , UNT_PER_CBMT_QTY                                50330000
503400                , CRE_TMST                                        50340000
503500                , PRG_LAST_ACTVY_DTE                              50350000
503600                , PKGNG_CDE                                       50360000
503700                , SEASET_YR                                       50370000
503800                , SEASET_SHRT_NM                                  50380000
503900                , QTA_CTG_CDE                                     50390000
504000                , PO_IN_RMS_IND                                   50400000
504100                , RMS_PO_UPD_TMST                                 50410000
504200                , DUP_SKU_IND                                     50420000
504300                , ORIG_PKGNG_CDE                                  50430000
504400                 )                                                50440000
504500         VALUES                                                   50450000
504600                (:PURCHS-PO-NBR                                   50460000
504700                ,:PURCHS-VER-NBR                                  50470000
504800                ,:PC-A                                            50480000
504900                ,:PURCHS-PO-TYP-CDE                               50490000
505000                ,:PURCHS-PO-CATEG-CDE                             50500000
505100                ,:PURCHS-EDI-IND                                  50510000
505200                ,:PURCHS-TOT-UNT-QTY                              50520000
505300                ,:PURCHS-TOT-VAL-COST-AMT                         50530000
505400                ,:PURCHS-TOT-VAL-RTL-AMT                          50540000
505500                ,:PURCHS-TOT-MU-PCT                               50550000
505600                ,:PURCHS-TOT-SKUS-QTY                             50560000
505700                ,:PURCHS-IMPRT-AGNT-PO-NBR                        50570000
505800                ,:PURCHS-IMPRT-ORD-OFF-NAME                       50580000
505900                ,:PURCHS-IMPRT-VEND-NAME                          50590000
506000                ,:PURCHS-IMPRT-FCTRY-NAME                         50600000
506100                ,:PURCHS-IMPRT-CNTRY-NAME                         50610000
506200                ,:PURCHS-VEND-CNTRY-NAME                          50620000
506300                ,:PURCHS-NEW-STR-PO-IND                           50630000
506400                ,:PURCHS-IMPRT-PO-IND                             50640000
506500                ,:PURCHS-IMPRT-AGNT-PO-IND                        50650000
506600                , CURRENT TIMESTAMP                               50660000
506700                , CURRENT TIMESTAMP                               50670000
506800                ,:PURCHS-EDI-REXMIT-IND                           50680000
506900                ,:PURCHS-EDI-REXMIT-TMST                          50690000
507000                ,:PURCHS-DIR-STR-IND                              50700000
507100                ,:DP020-USERID                                    50710000
507200                ,:PURCHS-APP-BY-UID                               50720000
507300                ,:PURCHS-OTB-PER-NBR                              50730000
507400                ,:PURCHS-DEPT-NBR                                 50740000
507500                ,:PURCHS-ENT-ID                                   50750000
507600                ,:PURCHS-STATUS-CDE                               50760000
507700                ,:PURCHS-CRE-BY-UID                               50770000
507800                ,:PURCHS-REJ-CT                                   50780000
507900                ,:PURCHS-REJ-UID                                  50790000
508000                ,:PURCHS-ORD-DTE                                  50800000
508100                ,:PURCHS-REVISION-CT                              50810000
508200                ,:PURCHS-ADR-SEQ-NBR                              50820000
508300                ,:PURCHS-DEST-KNOWN-IND                           50830000
508400                ,:PURCHS-RLSE-IND                                 50840000
508500                ,:PURCHS-RLSE-DTE                                 50850000
508600                ,:PURCHS-PLCMNT-CNTRY-CDE                         50860000
508700                ,:PURCHS-PROD-CNTRY-CDE                           50870000
508800                ,:PURCHS-UNT-PER-CBMT-QTY                         50880000
508900                ,:PURCHS-CRE-TMST                                 50890000
509000                ,:PURCHS-PRG-LAST-ACTVY-DTE                       50900000
509100                ,:PURCHS-PKGNG-CDE                                50910000
509200                ,:PURCHS-SEASET-YR                                50920000
509300                ,:PURCHS-SEASET-SHRT-NM                           50930000
509400                ,:PURCHS-QTA-CTG-CDE                              50940000
509500                ,:PURCHS-PO-IN-RMS-IND                            50950000
509600                ,:PURCHS-RMS-PO-UPD-TMST                          50960000
509700                ,:PURCHS-DUP-SKU-IND                              50970000
509800                ,:PURCHS-ORIG-PKGNG-CDE                           50980000
509900                 )                                                50990000
510000     END-EXEC.                                                    51000000
510100                                                                  51010000
510200     EVALUATE TRUE                                                51020000
510300         WHEN SQLCODE = ZERO                                      51030000
510400              CONTINUE                                            51040000
510500         WHEN SQLCODE = -904                                      51050000
510600         WHEN SQLCODE = -911                                      51060000
510700         WHEN SQLCODE = -913                                      51070000
510800              SET PS-UPDATES-DONE TO TRUE                         51080000
510900              PERFORM 9900-SOFT-ABORT                             51090000
511000         WHEN SQLWARN0 NOT = SPACE                                51100000
511100         WHEN SQLCODE NOT = ZERO                                  51110000
511200              MOVE '5854-INSERT-PURCHS'                           51120000
511300                               TO DP013-PARAGRAPH                 51130000
511400              MOVE 'INSERT PURCHASE HEADER'                       51140000
511500                               TO DP013-MESSAGE-TEXT (1)          51150000
511600              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        51160000
511700              MOVE SQLCA       TO DP013-SQLCA                     51170000
511800              SET DP013-DB2-ABEND                                 51180000
511900                               TO TRUE                            51190000
512000              PERFORM DP013-0000-PROCESS-ABEND                    51200000
512100     END-EVALUATE.                                                51210000
512200*DC-XXX TO HERE FROM 5800                                         51220000
512300/                                                                 51230000
512400 5855-ONLY-UPDATE-PURCHS-STATUS.                                  51240000
512500                                                                  51250000
512600     EXEC SQL                                                     51260000
512700          UPDATE                                                  51270000
512800                TPURCHS                                           51280000
512900           SET                                                    51290000
513000                VER_STATUS_CDE     =  :PC-A                       51300000
513100              , STATUS_TMST        =  (CURRENT TIMESTAMP)         51310000
513200              , LAST_UPD_TMST      =  (CURRENT TIMESTAMP)         51320000
513300              , STATUS_CDE         =  :PURCHS-STATUS-CDE          51330000
513400          WHERE                                                   51340000
513500                PO_NBR             =  :ASC-PO-NBR                 51350000
513600          AND   VER_STATUS_CDE     =  :PC-A                       51360000
513700     END-EXEC.                                                    51370000
513800                                                                  51380000
513900     EVALUATE TRUE                                                51390000
514000         WHEN SQLCODE = ZERO                                      51400000
514100         WHEN SQLCODE = +100                                      51410000
514200              CONTINUE                                            51420000
514300         WHEN SQLCODE = -904                                      51430000
514400         WHEN SQLCODE = -911                                      51440000
514500         WHEN SQLCODE = -913                                      51450000
514600              SET PS-UPDATES-DONE TO TRUE                         51460000
514700              PERFORM 9900-SOFT-ABORT                             51470000
514800         WHEN SQLWARN0 NOT = SPACE                                51480000
514900         WHEN SQLCODE NOT = ZERO                                  51490000
515000              MOVE '5855-ONLY-UPDATE-PURCHS-STATUS'               51500000
515100                               TO DP013-PARAGRAPH                 51510000
515200              MOVE 'GET THE PURCHASE HEADER'                      51520000
515300                               TO DP013-MESSAGE-TEXT (1)          51530000
515400              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        51540000
515500              MOVE SQLCA       TO DP013-SQLCA                     51550000
515600              SET DP013-DB2-ABEND                                 51560000
515700                               TO TRUE                            51570000
515800              PERFORM DP013-0000-PROCESS-ABEND                    51580000
515900     END-EVALUATE.                                                51590000
516000/                                                                 51600000
516100*----------------------------------------------------------------*51610000
516200*    CHECK TO SEE IF THIS DEPARTMENT HAS BEEN CONVERTED TO RMS.  *51620000
516300*    IF IT HAS, THE COUNT RETURNED FROM THIS FUNCTION WILL BE    *51630000
516400*    GREATER THAN ZERO AND WE CAN UPDATE TPURITM AND TPURCHS     *51640000
516500*    CORRECTLY.                                                  *51650000
516600*----------------------------------------------------------------*51660000
516700 5856-CHECK-FOR-RMS-PO.                                           51670000
516800                                                                  51680000
516900     INITIALIZE PV-DB2-COUNT.                                     51690000
517000                                                                  51700000
517100     EXEC SQL                                                     51710000
517200          SELECT                                                  51720000
517300                  COUNT(*)                                        51730000
517400           INTO                                                   51740000
517500                  :PV-DB2-COUNT :PV-NULL-IND                      51750000
517600           FROM                                                   51760000
517700                  POT_RMS_RLOUT_CTL                               51770000
517800          WHERE                                                   51780000
517900                  DEPT_NBR            = :PV-DEPT-NBR-KEY          51790000
518000           AND    PO_ENTR_IN_RMS_DTE <=  CURRENT_DATE             51800000
518100     END-EXEC.                                                    51810000
518200                                                                  51820000
518300     EVALUATE TRUE                                                51830000
518400         WHEN SQLCODE = ZERO                                      51840000
518500         WHEN SQLCODE = +100                                      51850000
518600              SET PS-CHECKED-FOR-RMS-PO                           51860000
518700                               TO TRUE                            51870008
518800         WHEN SQLWARN0 NOT = SPACE                                51880000
518900         WHEN SQLCODE = -904                                      51890000
519000         WHEN SQLCODE = -911                                      51900000
519100         WHEN SQLCODE = -913                                      51910000
519200              PERFORM 9900-SOFT-ABORT                             51920000
519300         WHEN SQLCODE NOT = ZERO                                  51930000
519400              MOVE '5856-CHECK-FOR-RMS-PO'                        51940000
519500                               TO DP013-PARAGRAPH                 51950000
519600              MOVE 'CHECK IF DEPT NBR CONVERTED FOR RMS'          51960000
519700                               TO DP013-MESSAGE-TEXT (1)          51970000
519800              STRING 'DEPARTMENT NUMBER: ' DELIMITED BY SIZE      51980000
519900                     PV-DEPT-NBR-X         DELIMITED BY SIZE      51990000
520000                             INTO DP013-MESSAGE-TEXT (2)          52000000
520100              MOVE 'POT_RMS_RLOUT_CTL'                            52010008
520200                               TO DP013-DB2-TABLE-NAME (1)        52020008
520300              MOVE SQLCA       TO DP013-SQLCA                     52030000
520400              SET DP013-DB2-ABEND                                 52040000
520500                               TO TRUE                            52050000
520600              PERFORM DP013-0000-PROCESS-ABEND                    52060000
520700     END-EVALUATE.                                                52070000
520800/                                                                 52080000
520900*----------------------------------------------------------------*52090000
521000*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *52100000
521100*----------------------------------------------------------------*52110000
521200                                                                  52120000
521300 6111-WRITE-LIST-QUEUE.                                           52130000
521400                                                                  52140000
521500     EXEC CICS                                                    52150000
521600         WRITEQ TS                                                52160000
521700             QUEUE (ASC-LIST-QUEUE-NAME)                          52170000
521800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     52180000
521900             ITEM  (PV-SAVE-ITEM)                                 52190000
522000             REWRITE                                              52200000
522100             RESP  (PV-CICS-RESP)                                 52210000
522200     END-EXEC.                                                    52220000
522300                                                                  52230000
522400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          52240000
522500         CONTINUE                                                 52250000
522600     ELSE                                                         52260000
522700         SET DP013-CICS-ABEND  TO  TRUE                           52270000
522800         SET DP013-NO-ROLLBACK TO  TRUE                           52280000
522900         MOVE '6111-WRITE-LIST-QUEUE'                             52290000
523000                               TO  DP013-PARAGRAPH                52300000
523100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  52310000
523200                               TO  DP013-MESSAGE-TEXT(1)          52320000
523300         PERFORM DP013-0000-PROCESS-ABEND                         52330000
523400     END-IF.                                                      52340000
523500/                                                                 52350000
523600*----------------------------------------------------------------*52360000
523700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*52370000
523800*----------------------------------------------------------------*52380000
523900                                                                  52390000
524000 6112-READ-LIST-QUEUE.                                            52400000
524100                                                                  52410000
524200     EXEC CICS                                                    52420000
524300         READQ TS                                                 52430000
524400             QUEUE (ASC-LIST-QUEUE-NAME)                          52440000
524500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     52450000
524600             ITEM  (PV-ITEM)                                      52460000
524700             RESP  (PV-CICS-RESP)                                 52470000
524800     END-EXEC.                                                    52480000
524900                                                                  52490000
525000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          52500000
525100         CONTINUE                                                 52510000
525200     ELSE                                                         52520000
525300         SET DP013-CICS-ABEND        TO TRUE                      52530000
525400         SET DP013-NO-ROLLBACK       TO TRUE                      52540000
525500         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           52550000
525600         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    52560000
525700                                     TO DP013-MESSAGE-TEXT(1)     52570000
525800         PERFORM DP013-0000-PROCESS-ABEND                         52580000
525900     END-IF.                                                      52590000
526000/                                                                 52600000
526100                                                                  52610008
526200******************************************************************52620008
526300* WRITE ENTRIES TO VERIFY ADJUSTMENT QUEUE                       *52630008
526400******************************************************************52640008
526500 6150-WRITE-VRFY-ADJ-QUEUE.                                       52650008
526600*                                                                 52660008
526700     MOVE  ASC-PO-NBR                                             52670008
526800                                       TO PC241-PO-NBR            52680008
526900     MOVE  LQW-ORD-LNE-NBR(LQW-IDX)                               52690008
527000                                       TO PC241-PO-LNE-NBR        52700008
527100     MOVE  ASC-REC-SEQ-NBR                                        52710008
527200                                       TO PC241-REC-SEQ-NBR       52720008
527300     MOVE  ASC-OPER-UNT-ID                                        52730008
527400                                       TO PC241-OPER-UNT-ID       52740008
527500     MOVE  ASC-FCLTY-ID                                           52750008
527600                                       TO PC241-FCLTY-ID          52760008
527700     MOVE  ASC-STR-NBR                                            52770008
527800                                       TO PC241-STR-NBR           52780008
527900     MOVE  PA-UPDATE-DIFF-QTY                                     52790008
528000                                       TO PC241-STR-ADJ-QTY       52800008
528100     ADD   1               TO PV-VRFY-ITEM                        52810008
528200*                                                                 52820008
528300     EXEC CICS WRITEQ TS                                          52830008
528400               QUEUE (ASC-VRFY-ADJ-QUEUE-NAME)                    52840008
528500               FROM  (PC241-FIELDS)                               52850008
528600               ITEM  (PV-VRFY-ITEM)                               52860008
528700               RESP  (PV-CICS-RESP)                               52870008
528800     END-EXEC.                                                    52880008
528900                                                                  52890008
529000     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       52900008
529100         SET DP013-CICS-ABEND                                     52910008
529200             DP013-NO-ROLLBACK   TO TRUE                          52920008
529300         MOVE '6150-WRITE-VRFY-ADJ-QUEUE'                         52930008
529400                                 TO DP013-PARAGRAPH               52940008
529500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE'        52950008
529600                                 TO DP013-MESSAGE-TEXT(1)         52960008
529700         PERFORM DP013-0000-PROCESS-ABEND                         52970008
529800     END-IF.                                                      52980008
529900                                                                  52990008
530000 7000-COUNT-SMOOTHED-CTNS.                                        53000000
530100                                                                  53010000
530200     MOVE ZERO                   TO PV-DB2-COUNT.                 53020000
530300     MOVE ASC-PO-NBR             TO DK-PO-NBR.                    53030000
530400     MOVE ASC-STR-NBR            TO DK-STR-NBR.                   53040000
530500     MOVE ASC-REC-SEQ-NBR        TO DK-REC-SEQ-NBR.               53050000
530600                                                                  53060000
530700     EXEC SQL                                                     53070000
530800         SELECT COUNT(DISTINCT(UPC.SHIPT_UNT_ID))                 53080000
530900         INTO :PV-DB2-COUNT                                       53090000
531000         FROM SUT_OTBND_UPC UPC                                   53100000
531100            , SUT_OTBND_CART UNT                                  53110000
531200         WHERE UPC.TRN_NBR              = :DK-PO-NBR              53120000
531300          AND  UPC.RCVR_SEQ_NBR         = :DK-REC-SEQ-NBR         53130000
531400          AND  UPC.SHIPT_UNT_ID         =  UNT.SHIPT_UNT_ID       53140000
531500          AND  UNT.DEST_LOC_NBR         =  :DK-STR-NBR            53150000
531600          AND  UNT.CART_SRC_CDE         =  'SMO'                  53160000
531700          AND  UNT.ACTV_IND             =  'Y'                    53170000
531800     END-EXEC.                                                    53180000
531900                                                                  53190000
532000     EVALUATE TRUE                                                53200000
532100         WHEN SQLCODE = ZERO                                      53210000
532200         WHEN SQLCODE = +100                                      53220000
532300             CONTINUE                                             53230000
532400         WHEN SQLCODE = -904                                      53240000
532500         WHEN SQLCODE = -913                                      53250000
532600         WHEN SQLCODE = -911                                      53260000
532700             PERFORM 9900-SOFT-ABORT                              53270000
532800         WHEN SQLWARN0 NOT = SPACES                               53280000
532900         WHEN SQLCODE < ZERO                                      53290000
533000         WHEN SQLCODE > ZERO                                      53300000
533100             MOVE '7000-COUNT-SMOOTHED-CTNS'                      53310000
533200                               TO DP013-PARAGRAPH                 53320000
533300             MOVE 'COUNT SMOOTHED CARTONS FOR PO/RCVR/STR'        53330000
533400                               TO DP013-MESSAGE-TEXT (1)          53340000
533500             MOVE SQLCA        TO DP013-SQLCA                     53350000
533600             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        53360000
533700             MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (2)        53370000
533800             SET DP013-DB2-ABEND                                  53380000
533900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               53390000
534000             PERFORM DP013-0000-PROCESS-ABEND                     53400000
534100     END-EVALUATE.                                                53410000
534200                                                                  53420000
534300/                                                                 53430000
534400******************************************************************53440000
534500* THIS PARAGRAPH WILL CONTROL THE PROCESSING ASSOCIATED TO THE   *53450000
534600* UNITS WORKED ROUTINE.                                           53460000
534700******************************************************************53470000
534800 7500-PROCESS-UNITS-WORK.                                         53480000
534900                                                                  53490000
535000     PERFORM 7600-RECEIV-PURITM-JOIN.                             53500000
535100     PERFORM 7800-UNITS-WORK-ROUTINE.                             53510000
535200                                                                  53520000
535300**   IF  PV-XLT00010-TYPE-DC                                      53530032
535400**       NEXT SENTENCE                                            53540000
535500**   ELSE                                                         53550008
535600**       MOVE 'Y'                   TO PC238-DIRECT-STORE-SW      53560000
535700**       PERFORM 7800-UNITS-WORK-ROUTINE                          53570000
535800**   END-IF.                                                      53580000
535900/                                                                 53590000
536000******************************************************************53600000
536100*  THIS PARAGRAPH WILL BE USED TO GET SOME FIELDS TO DETERMINE   *53610000
536200*  IF THE UNITS WORKED MODULE NEEDS TO BE CALLED (IF THE FULL-   *53620000
536300*  CASE TIMESTAMP IS A VALUE OTHER THAN 9'S, THEN THE LINE IS    *53630000
536400*  CONFIRMED AND THE UNITS WORKED MODULE WILL NEED TO BE CALLED  *53640000
536500*  FOR CONFIRMATION UNIT ADJUSTMENTS.  THE OTHER FIELDS ARE USED *53650000
536600*  BY THE MODULE TO DETERMINE THE RETAIL VALUE OF THE ADJUSTMENT *53660000
536700*  AND WHAT OPER UNIT AND PROCESS AREA THE ADJUSTMENT SHOULD BE  *53670000
536800*  POSTED TO WITHIN THE UNITS WORKED SYSTEM.                     *53680000
536900******************************************************************53690000
537000 7600-RECEIV-PURITM-JOIN.                                         53700000
537100                                                                  53710000
537200     EXEC SQL                                                     53720000
537300     SELECT A.CURR_OPER_UNT_ID,                                   53730000
537400            C.UNT_RTL_PR_AMT,                                     53740000
537500            D.LOC_TYP_CDE                                         53750033
537600         INTO :PV-CURR-OPER-UNT-ID                                53760000
537700         ,    :PURITM-UNT-RTL-PR-AMT                              53770000
537800         ,    :PV-XLT00010-TYPE-CODE                              53780032
537900         FROM                                                     53790000
538000             TRECEIV A                                            53800000
538100         ,   TRECITM B                                            53810000
538200         ,   TPURITM C                                            53820000
538300         ,   XLT_LOC D                                            53830032
538400         WHERE A.ORD_NBR          = :ASC-PO-NBR                   53840000
538500           AND A.REC_SEQ_NBR      = :ASC-REC-SEQ-NBR              53850000
538600           AND B.ORD_NBR          = A.ORD_NBR                     53860000
538700           AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR                 53870000
538800           AND B.ORD_LNE_NBR      = :RECDIS-ORD-LNE-NBR           53880000
538900           AND C.PO_NBR           = B.ORD_NBR                     53890000
539000           AND C.APP_PO_LNE_NBR   = B.ORD_LNE_NBR                 53900000
539100           AND C.VER_NBR          = B.PO_VER_NBR                  53910000
539200           AND D.LOC_NBR          = A.CURR_OPER_UNT_ID            53920032
539300     END-EXEC.                                                    53930000
539400*                                                                 53940000
539500     EVALUATE TRUE                                                53950000
539600         WHEN SQLCODE = ZERO                                      53960000
539700             CONTINUE                                             53970000
539800         WHEN SQLCODE = -904                                      53980000
539900         WHEN SQLCODE = -911                                      53990000
540000         WHEN SQLCODE = -913                                      54000000
540100             PERFORM 9900-SOFT-ABORT                              54010000
540200                                                                  54020000
540300         WHEN SQLWARN0 NOT = SPACES                               54030000
540400         WHEN SQLCODE < ZERO                                      54040000
540500         WHEN SQLCODE > ZERO                                      54050000
540600             MOVE '7600-RECEIV-PURITM-JOIN'                       54060000
540700                                  TO DP013-PARAGRAPH              54070000
540800             MOVE 'UNSUCCESSFUL JOIN OF 3 TABLES'                 54080000
540900                                  TO DP013-MESSAGE-TEXT (1)       54090000
541000             MOVE SQLCA      TO DP013-SQLCA                       54100000
541100             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)          54110000
541200             SET DP013-DB2-ABEND                                  54120000
541300                 DP013-NO-ROLLBACK                                54130000
541400                                  TO TRUE                         54140000
541500             PERFORM DP013-0000-PROCESS-ABEND                     54150000
541600     END-EVALUATE.                                                54160000
541700                                                                  54170000
541800******************************************************************54180000
541900* THIS PARAGRAPH WILL FORMAT ALL OF THE DATA NEEDED FOR THE      *54190000
542000* UNITS WORKED ROUTINE AND WILL THEN CALL THE ROUTINE AND        *54200000
542100* THE RESULTS RETURNED FROM THE ROUTINE.                         *54210000
542200******************************************************************54220000
542300 7800-UNITS-WORK-ROUTINE.                                         54230000
542400                                                                  54240000
542500     INITIALIZE PC238-COMM-AREA.                                  54250000
542600                                                                  54260000
542700     EXEC SQL                                                     54270000
542800         SET :PV-TMST =  CURRENT_TIMESTAMP                        54280000
542900     END-EXEC                                                     54290000
543000                                                                  54300000
543100     MOVE PV-TMST                 TO PC238-WRKD-TMST.             54310000
543200                                                                  54320000
543300     IF  PV-XLT00010-TYPE-DC                                      54330032
543400         NEXT SENTENCE                                            54340000
543500     ELSE                                                         54350008
543600         MOVE 'Y'                   TO PC238-DIRECT-STORE-SW      54360000
543700     END-IF.                                                      54370000
543800                                                                  54380000
543900     MOVE PV-CURR-OPER-UNT-ID     TO PC238-WRKD-OPER-UNT-ID.      54390000
544000     MOVE ASC-PO-NBR              TO PC238-PO-NBR.                54400000
544100     MOVE ASC-REC-SEQ-NBR         TO PC238-RCVR-SEQ-NBR.          54410000
544200     MOVE RECDIS-ORD-LNE-NBR      TO PC238-PO-LNE-NBR.            54420000
544300                                                                  54430000
544400     MOVE PA-UPDATE-DIFF-QTY      TO PC238-WRKD-UNT-QTY.          54440000
544500     MOVE PURITM-UNT-RTL-PR-AMT   TO PC238-UNT-RETAIL-PRC.        54450000
544600     SET  PC238-TRANS-VERIFY-ADJ  TO TRUE.                        54460000
544700     SET  PC238-MANUAL-VERIFY     TO TRUE.                        54470000
544800     MOVE ASC-VRFY-ADJ-QUEUE-NAME TO PC238-VRFY-ADJ-QUEUE-NAME.   54480008
544900     MOVE PV-VRFY-ITEM            TO PC238-TOT-QUEUE-ITEMS.       54490008
545000                                                                  54500000
545100************************************************                  54510000
545200*                                                                 54520000
545300*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    54530000
545400*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  54540000
545500*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  54550000
545600*    MOVE PC238-WRKD-OPER-UNT-ID                                  54560000
545700*                            TO PC-DISPLAY-OPER.                  54570000
545800*    STRING ' RCKCS231 - '      DELIMITED BY SIZE                 54580000
545900*           ' CALLING PCKCS756 WITH KEY INFO - '                  54590000
546000*                               DELIMITED BY SIZE                 54600000
546100*           PC-DISPLAY-PO       DELIMITED BY SIZE                 54610000
546200*           ' - '               DELIMITED BY SIZE                 54620000
546300*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 54630000
546400*           ' - '               DELIMITED BY SIZE                 54640000
546500*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 54650000
546600*           ' - '               DELIMITED BY SIZE                 54660000
546700*           PC-DISPLAY-OPER     DELIMITED BY SIZE                 54670000
546800*                        INTO PV-CICS-MSG-AREA.                   54680000
546900*    MOVE LENGTH OF PV-CICS-MSG-AREA                              54690000
547000*                          TO PV-COMMAREA-LENGTH.                 54700000
547100*    PERFORM 9700-WRITE-TO-CICS-LOG.                              54710000
547200*                                                                 54720000
547300************************************************                  54730000
547400                                                                  54740000
547500     MOVE LENGTH OF PC238-COMM-AREA                               54750000
547600                                  TO PV-COMMAREA-LENGTH.          54760000
547700                                                                  54770000
547800     EXEC CICS                                                    54780000
547900         LINK PROGRAM  (PV-PCKCS756)                              54790000
548000              COMMAREA (PC238-COMM-AREA)                          54800000
548100              LENGTH   (PV-COMMAREA-LENGTH)                       54810000
548200              RESP     (PV-CICS-RESPONSE)                         54820000
548300     END-EXEC.                                                    54830000
548400                                                                  54840000
548500************************************************                  54850000
548600*                                                                 54860000
548700*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    54870000
548800*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  54880000
548900*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  54890000
549000*    MOVE PC238-WRKD-OPER-UNT-ID                                  54900000
549100*                            TO PC-DISPLAY-OPER.                  54910000
549200*    STRING ' RCKCS231 - '      DELIMITED BY SIZE                 54920000
549300*           ' RETURN FROM PCKCS756 - '                            54930000
549400*                               DELIMITED BY SIZE                 54940000
549500*           PC-DISPLAY-PO       DELIMITED BY SIZE                 54950000
549600*           ' - '               DELIMITED BY SIZE                 54960000
549700*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 54970000
549800*           ' - '               DELIMITED BY SIZE                 54980000
549900*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 54990000
550000*           ' - '               DELIMITED BY SIZE                 55000000
550100*           PC238-MOD-SUCCESS-CDE                                 55010000
550200*                               DELIMITED BY SIZE                 55020000
550300*           ' - '               DELIMITED BY SIZE                 55030000
550400*           PC238-UNSUCCESSFUL-CDE                                55040000
550500*                               DELIMITED BY SIZE                 55050000
550600*                        INTO PV-CICS-MSG-AREA.                   55060000
550700*    MOVE LENGTH OF PV-CICS-MSG-AREA                              55070000
550800*                          TO PV-COMMAREA-LENGTH.                 55080000
550900*    PERFORM 9700-WRITE-TO-CICS-LOG.                              55090000
551000*                                                                 55100000
551100************************************************                  55110000
551200                                                                  55120000
551300     EVALUATE TRUE                                                55130000
551400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 55140000
551500              IF  PC238-MOD-UNSUCCESSFUL                          55150000
551600                  PERFORM 7810-MOD-UNSUCCESSFUL                   55160000
551700              END-IF                                              55170000
551800         WHEN OTHER                                               55180000
551900              MOVE PC238-PO-NBR       TO PC-DISPLAY-PO            55190000
552000              MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR          55200000
552100              MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE          55210000
552200              MOVE PC238-WRKD-OPER-UNT-ID                         55220000
552300                                      TO PC-DISPLAY-OPER          55230000
552400              MOVE PC238-BAD-SQL-CDE  TO PC-DISPLAY-SQL-CODE      55240000
552500              MOVE PV-CICS-RESPONSE   TO PC-DISPLAY-CICS-RESP     55250000
552600              SET PS-UNITS-WORKED-ERROR  TO TRUE                  55260000
552700              STRING ' RCKCS231 - '      DELIMITED BY SIZE        55270000
552800                     ' 7800-UNITS-WORK-ROUTINE '                  55280000
552900                                         DELIMITED BY SIZE        55290000
553000                     ' BAD CALL TO UNITS WORKED MODULE '          55300000
553100                                         DELIMITED BY SIZE        55310000
553200                     ' - CICS RESP '                              55320000
553300                                         DELIMITED BY SIZE        55330000
553400                     PC-DISPLAY-CICS-RESP                         55340000
553500                                         DELIMITED BY SIZE        55350000
553600                                      INTO PV-CICS-MSG-AREA       55360000
553700              MOVE LENGTH OF PV-CICS-MSG-AREA                     55370000
553800                                        TO PV-COMMAREA-LENGTH     55380000
553900              PERFORM 9700-WRITE-TO-CICS-LOG                      55390000
554000              MOVE SPACES TO PV-CICS-MSG-AREA                     55400000
554100              STRING ' RCKCS231 - '      DELIMITED BY SIZE        55410000
554200                     ' 7800-UNITS-WORK-ROUTINE '                  55420000
554300                                         DELIMITED BY SIZE        55430000
554400                     ' KEY INFO - '      DELIMITED BY SIZE        55440000
554500                     PC-DISPLAY-PO       DELIMITED BY SIZE        55450000
554600                     ' - '               DELIMITED BY SIZE        55460000
554700                     PC-DISPLAY-RCVR     DELIMITED BY SIZE        55470000
554800                     ' - '               DELIMITED BY SIZE        55480000
554900                     PC-DISPLAY-LINE     DELIMITED BY SIZE        55490000
555000                                  INTO PV-CICS-MSG-AREA           55500000
555100              MOVE LENGTH OF PV-CICS-MSG-AREA                     55510000
555200                                    TO PV-COMMAREA-LENGTH         55520000
555300              PERFORM 9700-WRITE-TO-CICS-LOG                      55530000
555400              PERFORM 9900-SOFT-ABORT                             55540000
555500     END-EVALUATE.                                                55550000
555600                                                                  55560000
555700******************************************************************55570000
555800* THIS PARAGRAPH WILL MANAGE THE DISPLAY OF INFORMATION TO CSSL  *55580000
555900* FOR WHEN THE UNITS WORKED ROUTINE WAS UNSUCCESSFUL.  THIS      *55590000
556000* PARAGRAPH WILL FORMAT A MESSAGE AND GET IT WRITTEN TO THE      *55600000
556100* CICS LOG AND THEN SOFT ABORT THE PROGRAM.                      *55610000
556200******************************************************************55620000
556300 7810-MOD-UNSUCCESSFUL.                                           55630000
556400                                                                  55640000
556500     MOVE PC238-PO-NBR              TO PC-DISPLAY-PO.             55650000
556600     MOVE PC238-RCVR-SEQ-NBR        TO PC-DISPLAY-RCVR.           55660000
556700     MOVE PC238-PO-LNE-NBR          TO PC-DISPLAY-LINE.           55670000
556800     MOVE PC238-WRKD-OPER-UNT-ID    TO PC-DISPLAY-OPER.           55680000
556900     MOVE PC238-BAD-SQL-CDE         TO PC-DISPLAY-SQL-CODE.       55690000
557000     SET  PS-UNITS-WORKED-ERROR     TO TRUE.                      55700000
557100     SET  PS-UPDATES-DONE           TO TRUE.                      55710000
557200                                                                  55720000
557300     IF  PC238-MOD-BAD-TMST                                       55730000
557400         STRING ' RCKCS231 - '      DELIMITED BY SIZE             55740000
557500                ' 7800-UNITS-WORK-ROUTINE '                       55750000
557600                                    DELIMITED BY SIZE             55760000
557700                ' BAD TIMESTAMP '   DELIMITED BY SIZE             55770000
557800                PC238-WRKD-TMST     DELIMITED BY SIZE             55780000
557900                             INTO PV-CICS-MSG-AREA                55790000
558000         MOVE LENGTH OF PV-CICS-MSG-AREA                          55800000
558100                               TO PV-COMMAREA-LENGTH              55810000
558200         PERFORM 9700-WRITE-TO-CICS-LOG                           55820000
558300         STRING ' RCKCS231 - '      DELIMITED BY SIZE             55830000
558400                ' 7800-UNITS-WORK-ROUTINE '                       55840000
558500                                    DELIMITED BY SIZE             55850000
558600                ' KEY INFO - '      DELIMITED BY SIZE             55860000
558700                PC-DISPLAY-PO       DELIMITED BY SIZE             55870000
558800                ' - '               DELIMITED BY SIZE             55880000
558900                PC-DISPLAY-RCVR     DELIMITED BY SIZE             55890000
559000                ' - '               DELIMITED BY SIZE             55900000
559100                PC-DISPLAY-LINE     DELIMITED BY SIZE             55910000
559200                             INTO PV-CICS-MSG-AREA                55920000
559300         MOVE LENGTH OF PV-CICS-MSG-AREA                          55930000
559400                               TO PV-COMMAREA-LENGTH              55940000
559500         PERFORM 9700-WRITE-TO-CICS-LOG                           55950000
559600         PERFORM 9900-SOFT-ABORT                                  55960000
559700     ELSE                                                         55970000
559800     IF  PC238-MOD-BAD-OPER                                       55980000
559900         STRING ' RCKCS231 - '      DELIMITED BY SIZE             55990000
560000                ' 7800-UNITS-WORK-ROUTINE '                       56000000
560100                                    DELIMITED BY SIZE             56010000
560200                ' BAD OPER UNIT '   DELIMITED BY SIZE             56020000
560300                PC-DISPLAY-OPER     DELIMITED BY SIZE             56030000
560400                             INTO PV-CICS-MSG-AREA                56040000
560500         MOVE LENGTH OF PV-CICS-MSG-AREA                          56050000
560600                               TO PV-COMMAREA-LENGTH              56060000
560700         PERFORM 9700-WRITE-TO-CICS-LOG                           56070000
560800         STRING ' RCKCS231 - '      DELIMITED BY SIZE             56080000
560900                ' 7800-UNITS-WORK-ROUTINE '                       56090000
561000                                    DELIMITED BY SIZE             56100000
561100                ' KEY INFO - '      DELIMITED BY SIZE             56110000
561200                PC-DISPLAY-PO       DELIMITED BY SIZE             56120000
561300                ' - '               DELIMITED BY SIZE             56130000
561400                PC-DISPLAY-RCVR     DELIMITED BY SIZE             56140000
561500                ' - '               DELIMITED BY SIZE             56150000
561600                PC-DISPLAY-LINE     DELIMITED BY SIZE             56160000
561700                             INTO PV-CICS-MSG-AREA                56170000
561800         MOVE LENGTH OF PV-CICS-MSG-AREA                          56180000
561900                               TO PV-COMMAREA-LENGTH              56190000
562000         PERFORM 9700-WRITE-TO-CICS-LOG                           56200000
562100         PERFORM 9900-SOFT-ABORT                                  56210000
562200     ELSE                                                         56220000
562300     IF  PC238-MOD-BAD-TRANS-TYPE                                 56230000
562400         STRING ' RCKCS231 - '      DELIMITED BY SIZE             56240000
562500                ' 7800-UNITS-WORK-ROUTINE '                       56250000
562600                                    DELIMITED BY SIZE             56260000
562700                ' BAD TRAN TYPE '   DELIMITED BY SIZE             56270000
562800                PC238-TRANS-TYPE-CDE                              56280000
562900                                    DELIMITED BY SIZE             56290000
563000                             INTO PV-CICS-MSG-AREA                56300000
563100         MOVE LENGTH OF PV-CICS-MSG-AREA                          56310000
563200                               TO PV-COMMAREA-LENGTH              56320000
563300         PERFORM 9700-WRITE-TO-CICS-LOG                           56330000
563400         STRING ' RCKCS231 - '      DELIMITED BY SIZE             56340000
563500                ' 7800-UNITS-WORK-ROUTINE '                       56350000
563600                                    DELIMITED BY SIZE             56360000
563700                ' KEY INFO - '      DELIMITED BY SIZE             56370000
563800                PC-DISPLAY-PO       DELIMITED BY SIZE             56380000
563900                ' - '               DELIMITED BY SIZE             56390000
564000                PC-DISPLAY-RCVR     DELIMITED BY SIZE             56400000
564100                ' - '               DELIMITED BY SIZE             56410000
564200                PC-DISPLAY-LINE     DELIMITED BY SIZE             56420000
564300                             INTO PV-CICS-MSG-AREA                56430000
564400         MOVE LENGTH OF PV-CICS-MSG-AREA                          56440000
564500                               TO PV-COMMAREA-LENGTH              56450000
564600         PERFORM 9700-WRITE-TO-CICS-LOG                           56460000
564700         PERFORM 9900-SOFT-ABORT                                  56470000
564800     ELSE                                                         56480000
564900     IF  PC238-MOD-BAD-PO                                         56490000
565000         STRING ' RCKCS231 - '      DELIMITED BY SIZE             56500000
565100                ' 7800-UNITS-WORK-ROUTINE '                       56510000
565200                                    DELIMITED BY SIZE             56520000
565300                ' BAD PO NUMBER '   DELIMITED BY SIZE             56530000
565400                PC-DISPLAY-PO       DELIMITED BY SIZE             56540000
565500                             INTO PV-CICS-MSG-AREA                56550000
565600         MOVE LENGTH OF PV-CICS-MSG-AREA                          56560000
565700                               TO PV-COMMAREA-LENGTH              56570000
565800         PERFORM 9700-WRITE-TO-CICS-LOG                           56580000
565900         STRING ' RCKCS231 - '      DELIMITED BY SIZE             56590000
566000                ' 7800-UNITS-WORK-ROUTINE '                       56600000
566100                                    DELIMITED BY SIZE             56610000
566200                ' KEY INFO - '      DELIMITED BY SIZE             56620000
566300                PC-DISPLAY-PO       DELIMITED BY SIZE             56630000
566400                ' - '               DELIMITED BY SIZE             56640000
566500                PC-DISPLAY-RCVR     DELIMITED BY SIZE             56650000
566600                ' - '               DELIMITED BY SIZE             56660000
566700                PC-DISPLAY-LINE     DELIMITED BY SIZE             56670000
566800                             INTO PV-CICS-MSG-AREA                56680000
566900         MOVE LENGTH OF PV-CICS-MSG-AREA                          56690000
567000                               TO PV-COMMAREA-LENGTH              56700000
567100         PERFORM 9700-WRITE-TO-CICS-LOG                           56710000
567200         PERFORM 9900-SOFT-ABORT                                  56720000
567300     ELSE                                                         56730000
567400     IF  PC238-MOD-BAD-RCVR                                       56740000
567500         STRING ' RCKCS231 - '      DELIMITED BY SIZE             56750000
567600                ' 7800-UNITS-WORK-ROUTINE '                       56760000
567700                                    DELIMITED BY SIZE             56770000
567800                ' BAD RCVR NBR  '   DELIMITED BY SIZE             56780000
567900                PC-DISPLAY-RCVR     DELIMITED BY SIZE             56790000
568000                             INTO PV-CICS-MSG-AREA                56800000
568100         MOVE LENGTH OF PV-CICS-MSG-AREA                          56810000
568200                               TO PV-COMMAREA-LENGTH              56820000
568300         PERFORM 9700-WRITE-TO-CICS-LOG                           56830000
568400         STRING ' RCKCS231 - '      DELIMITED BY SIZE             56840000
568500                ' 7800-UNITS-WORK-ROUTINE '                       56850000
568600                                    DELIMITED BY SIZE             56860000
568700                ' KEY INFO - '      DELIMITED BY SIZE             56870000
568800                PC-DISPLAY-PO       DELIMITED BY SIZE             56880000
568900                ' - '               DELIMITED BY SIZE             56890000
569000                PC-DISPLAY-RCVR     DELIMITED BY SIZE             56900000
569100                ' - '               DELIMITED BY SIZE             56910000
569200                PC-DISPLAY-LINE     DELIMITED BY SIZE             56920000
569300                             INTO PV-CICS-MSG-AREA                56930000
569400         MOVE LENGTH OF PV-CICS-MSG-AREA                          56940000
569500                               TO PV-COMMAREA-LENGTH              56950000
569600         PERFORM 9700-WRITE-TO-CICS-LOG                           56960000
569700         PERFORM 9900-SOFT-ABORT                                  56970000
569800     ELSE                                                         56980000
569900     IF  PC238-MOD-BAD-LINE                                       56990000
570000         STRING ' RCKCS231 - '      DELIMITED BY SIZE             57000000
570100                ' 7800-UNITS-WORK-ROUTINE '                       57010000
570200                                    DELIMITED BY SIZE             57020000
570300                ' BAD LINE NBR  '   DELIMITED BY SIZE             57030000
570400                PC-DISPLAY-LINE     DELIMITED BY SIZE             57040000
570500                             INTO PV-CICS-MSG-AREA                57050000
570600         MOVE LENGTH OF PV-CICS-MSG-AREA                          57060000
570700                               TO PV-COMMAREA-LENGTH              57070000
570800         PERFORM 9700-WRITE-TO-CICS-LOG                           57080000
570900         STRING ' RCKCS231 - '      DELIMITED BY SIZE             57090000
571000                ' 7800-UNITS-WORK-ROUTINE '                       57100000
571100                                    DELIMITED BY SIZE             57110000
571200                ' KEY INFO - '      DELIMITED BY SIZE             57120000
571300                PC-DISPLAY-PO       DELIMITED BY SIZE             57130000
571400                ' - '               DELIMITED BY SIZE             57140000
571500                PC-DISPLAY-RCVR     DELIMITED BY SIZE             57150000
571600                ' - '               DELIMITED BY SIZE             57160000
571700                PC-DISPLAY-LINE     DELIMITED BY SIZE             57170000
571800                             INTO PV-CICS-MSG-AREA                57180000
571900         MOVE LENGTH OF PV-CICS-MSG-AREA                          57190000
572000                               TO PV-COMMAREA-LENGTH              57200000
572100         PERFORM 9700-WRITE-TO-CICS-LOG                           57210000
572200         PERFORM 9900-SOFT-ABORT                                  57220000
572300     ELSE                                                         57230000
572400     IF  PC238-MOD-BAD-NO-SHIFT                                   57240000
572500         STRING ' RCKCS231 - '      DELIMITED BY SIZE             57250000
572600                ' 7800-UNITS-WORK-ROUTINE '                       57260000
572700                                    DELIMITED BY SIZE             57270000
572800                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             57280000
572900                PC238-WRKD-TMST     DELIMITED BY SIZE             57290000
573000                ' FOR OPER '        DELIMITED BY SIZE             57300000
573100                PC-DISPLAY-OPER     DELIMITED BY SIZE             57310000
573200                             INTO PV-CICS-MSG-AREA                57320000
573300         MOVE LENGTH OF PV-CICS-MSG-AREA                          57330000
573400                               TO PV-COMMAREA-LENGTH              57340000
573500         PERFORM 9700-WRITE-TO-CICS-LOG                           57350000
573600         STRING ' RCKCS231 - '      DELIMITED BY SIZE             57360000
573700                ' 7800-UNITS-WORK-ROUTINE '                       57370000
573800                                    DELIMITED BY SIZE             57380000
573900                ' KEY INFO - '      DELIMITED BY SIZE             57390000
574000                PC-DISPLAY-PO       DELIMITED BY SIZE             57400000
574100                ' - '               DELIMITED BY SIZE             57410000
574200                PC-DISPLAY-RCVR     DELIMITED BY SIZE             57420000
574300                ' - '               DELIMITED BY SIZE             57430000
574400                PC-DISPLAY-LINE     DELIMITED BY SIZE             57440000
574500                             INTO PV-CICS-MSG-AREA                57450000
574600         MOVE LENGTH OF PV-CICS-MSG-AREA                          57460000
574700                               TO PV-COMMAREA-LENGTH              57470000
574800         PERFORM 9700-WRITE-TO-CICS-LOG                           57480000
574900         PERFORM 9900-SOFT-ABORT                                  57490000
575000     ELSE                                                         57500000
575100         STRING ' RCKCS231 - '      DELIMITED BY SIZE             57510000
575200                ' 7800-UNITS-WORK-ROUTINE '                       57520000
575300                                    DELIMITED BY SIZE             57530000
575400                ' DB ERROR - SQL CODE '                           57540000
575500                                    DELIMITED BY SIZE             57550000
575600                PC-DISPLAY-SQL-CODE DELIMITED BY SIZE             57560000
575700                ' FUNC: '           DELIMITED BY SIZE             57570000
575800                PC238-BAD-TABLE-FUNCTION                          57580000
575900                                    DELIMITED BY SIZE             57590000
576000                ' TABLE: '          DELIMITED BY SIZE             57600000
576100                PC238-BAD-TABLE-NAME                              57610000
576200                                    DELIMITED BY SIZE             57620000
576300                             INTO PV-CICS-MSG-AREA                57630000
576400         MOVE LENGTH OF PV-CICS-MSG-AREA                          57640000
576500                               TO PV-COMMAREA-LENGTH              57650000
576600         PERFORM 9700-WRITE-TO-CICS-LOG                           57660000
576700         STRING ' RCKCS231 - '      DELIMITED BY SIZE             57670000
576800                ' 7800-UNITS-WORK-ROUTINE '                       57680000
576900                                    DELIMITED BY SIZE             57690000
577000                ' KEY INFO - '      DELIMITED BY SIZE             57700000
577100                PC-DISPLAY-PO       DELIMITED BY SIZE             57710000
577200                ' - '               DELIMITED BY SIZE             57720000
577300                PC-DISPLAY-RCVR     DELIMITED BY SIZE             57730000
577400                ' - '               DELIMITED BY SIZE             57740000
577500                PC-DISPLAY-LINE     DELIMITED BY SIZE             57750000
577600                             INTO PV-CICS-MSG-AREA                57760000
577700         MOVE LENGTH OF PV-CICS-MSG-AREA                          57770000
577800                               TO PV-COMMAREA-LENGTH              57780000
577900         PERFORM 9700-WRITE-TO-CICS-LOG                           57790000
578000         PERFORM 9900-SOFT-ABORT                                  57800000
578100     END-IF                                                       57810000
578200     END-IF                                                       57820000
578300     END-IF                                                       57830000
578400     END-IF                                                       57840000
578500     END-IF                                                       57850000
578600     END-IF                                                       57860000
578700     END-IF.                                                      57870000
578800/                                                                 57880000
578900*----------------------------------------------------------------*57890000
579000 9700-WRITE-TO-CICS-LOG.                                          57900000
579100                                                                  57910000
579200     EXEC CICS                                                    57920000
579300          WRITEQ TD                                               57930000
579400          QUEUE  ('CSSL')                                         57940000
579500          FROM  (PV-CICS-MSG-AREA)                                57950000
579600          LENGTH  (PV-COMMAREA-LENGTH)                            57960000
579700          RESP  (PV-CICS-RESP)                                    57970000
579800     END-EXEC.                                                    57980000
579900                                                                  57990000
580000     MOVE SPACES TO PV-CICS-MSG-AREA.                             58000000
580100                                                                  58010000
580200*----------------------------------------------------------------*58020000
580300*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *58030000
580400*    AND THE ERROR SWITCHES.                                     *58040000
580500*----------------------------------------------------------------*58050000
580600                                                                  58060000
580700 9900-SOFT-ABORT.                                                 58070000
580800     SET PS-ERROR         TO TRUE.                                58080000
580900     SET DP020-MSG-FATAL  TO TRUE.                                58090000
581000                                                                  58100000
581100     IF  PS-UNITS-WORKED-ERROR                                    58110000
581200         MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER                 58120000
581300     ELSE                                                         58130000
581400         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 58140000
581500     END-IF.                                                      58150000
581600                                                                  58160000
581700     IF PS-NO-NEXT-SCREEN                                         58170000
581800        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     58180000
581900     END-IF.                                                      58190000
582000*    IF PS-UPDATES-DONE AND SQLCODE = -913                        58200000
582100     IF PS-UPDATES-DONE                                           58210000
582200        PERFORM 9901-BACKUP                                       58220000
582300     END-IF.                                                      58230000
582400     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          58240000
582500     PERFORM 0001-CALL-CICS-ARCH-API.                             58250000
582600                                                                  58260000
582700 9901-BACKUP.                                                     58270000
582800     EXEC CICS SYNCPOINT                                          58280000
582900          ROLLBACK                                                58290000
583000     END-EXEC.                                                    58300000
583100/                                                                 58310000
583200*----------------------------------------------------------------*58320000
583300*    ABEND PROCESSOR MODULE                                      *58330000
583400*----------------------------------------------------------------*58340000
583500                                                                  58350000
583600     COPY DPPD013.                                                58360000
