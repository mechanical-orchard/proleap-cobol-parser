000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             MRKUT141.                                00050002
000600 AUTHOR.                 XXXXXXXXXXXXXXX.                         00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            09-XX-05.                                00080002
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*          CREATE TRANSFER RECORD INPUT                         * 00120000
001300*                                                               * 00130000
001400*  VERSION OF MRKUT003 FOR DD UPDATE JOBS                       * 00140002
001500*  RETRIEVES RECORDS, DOES NOT ASSIGN WEEK NUMBER, RETRIEVES    * 00150000
001600*  BASED ON RT_NBR                                              * 00160000
001700*                                                               * 00170000
001800*  THIS PROGRAM IS A VERSION OF MRKUT003.  IT WILL READ IN      * 00180000
001900*  A SEQUENTIAL INPUT FILE CREATED IN ANOTHER PROGRAM AND       * 00190000
002000*  UPDATE EACH RECORD.                                          * 00200000
002100*                                                               * 00210000
002200***************************************************************** 00220000
002300*  CHANGE MADE:                                                 * 00230000
002400*                                                               * 00240000
002500***************************************************************** 00250000
002600* CHANGED 06/21/93 BY CHRISTINE FOLEY                             00260000
002700*   WR# XXXXXXXXXXXX                                              00270000
002800*            ADDED CHECK FOR UCYCLE OF 5 TO CALCULATE FOR 4       00280000
002900*            WEEKS OF CPS.                                        00290000
003000*                                                                 00300000
003100*            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  00310000
003200*            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  00320000
003300***************************************************************** 00330000
003400* CHANGED 09/08/95 BY HOWARD MENDELSON                            00340000
003500*   WR# 2784                                                      00350000
003600*            EXTRACT HISTORY VALUES FROM TMRISHS AND ADD THE      00360000
003700*            VALUES TO THE TRANSFER RECORD.                       00370000
003800*                                                                 00380000
003900***************************************************************** 00390000
004000* CHANGED 10/31/95 BY HOWARD MENDELSON                            00400000
004100*   WR# 2784                                                      00410000
004200*            REMOVED ITEM STORE HISTORY OUTPUT FILE CODE          00420000
004300*                                                                 00430000
004400***************************************************************** 00440000
004500* CHANGED 12/14/95 BY HOWARD MENDELSON                            00450000
004600*   WR# 2916                                                      00460000
004700*            ADD CORPORATE STORE LOGIC                            00470000
004800*                                                                 00480000
004900***************************************************************** 00490000
005000* CHANGED 08/12/98 BY PAUL KEBER - STRATAGEM                      00500000
005100*   WR# 6041                                                      00510000
005200*            AS PART OF Y2K CHANGES, UPDATED PROGRAM TO ACCESS    00520000
005300*            THE NEW WEEKLY SALES TABLE - TSKSTWKS AND REPLACED   00530000
005400*            SALES_INDCT FIELD WITH NEW DATE FIELD FSCL_BOW_DTE.  00540000
005500*            PV-MIN-DATE AND PV-MAX-DATE WERE CHANGED TO PV-MIN-  00550000
005600*            BOW-DATE AND PV-MAX-BOW-DATE AND WERE FILLED WITH    00560000
005700*            NEW DATE ROUTINE CALLS.  PV-UCYCLE-MIN-DATE AND      00570000
005800*            PV-UCYCLE-MAX-DATE FIELDS WERE FILLED WITH NEW DATE  00580000
005900*            ROUTINE CALLS.                                       00590000
006000*                                                                 00600000
006100***************************************************************** 00610000
006200* CHANGED 10/19/98 BY PATRICK MCGRAW                              00620000
006300*            AS PART OF Y2K CHANGES, CHANGED PIVOT YEAR TO 80     00630000
006400*            FROM 88 IN ORDER TO HAVE UNIFORMITY IN THE MW SYSTEM 00640000
006500*            PROGRAMS.                                            00650000
006600***************************************************************** 00660000
006610* CHANGED 03/22/00 BY STEVE ROEGNER                               00670000
006620*            CHANGED THE PROGRAM TO USE DB2 TABLE TSKSTOO FOR ITS 00680000
006630*            ONORDER DATA FROM THE VSAM FILE PKMCIC.FS.ONORDER.   00690000
006631***************************************************************** 00700000
006632* CHANGED 08/13/02 BY LINDA FRIESS                                00710000
006633*            ADDED DISPLAY OF ITEM COUNT AT END OF PROGRAM.       00720000
006634***************************************************************** 00730000
006635* CHANGED 09/04/02 BY IBM GLOBAL SERVICES INDIA                   00740000
006636*                     WR # 21601 (NI-SKU PROJECT)                 00750000
006637*            DEPARTMENT, CLASS AND 8-DIGIT SKU ARE FETCHED FROM   00760000
006638*            FROM TSKXREF AND WRITTEN INTO OUTPUT.                00770000
006639***************************************************************** 00780000
006640* CHANGED 11/05/02 BY DON TOMLINSON                               00790000
006641*                    PIT: 505764 (NI-SKU PROJECT)                 00800000
006642*            PREVIOUS CHANGE REMOVED CODE THAT SHOULD NOT HAVE    00810000
006643*            BEEN REMOVED. PUT CODE BACK INTO PROGRAM. SEE        00820000
006644*            D100 PARAGRAPH.                                      00830000
006645***************************************************************** 00840000
006635* CHANGED 06/02/04 BY BOB FORD                                    00850000
006636*                     WR # 26363 (STORE NUMBER EXPANSION)         00860000
006637*            CHANGED PROGRAM TO HANDLE 5-DIGIT STORE NUMBERS.     00870000
006637*            REPLACED TSTR000 WITH XMT_LOC.                       00880000
006639***************************************************************** 00890000
006635* CHANGED 09/27/05 BY LINDA FRIESS                                00900002
006636*                     WR # 28751 (DD SPLIT)                       00910002
F06637*            CHANGED PARA. T155-UCYCLE-CALENDAR-ROUTINE TO ONLY   00920002
006637*            SUBTRACT 1 FROM TNOW-WN INSTEAD OF 2, SO THAT DATES  00930002
006637*            ARE CALCULATED BASED ON THE CURRENT WEEK INSTEAD OF  00940002
006637*            LAST WEEK.                                           00950002
006639***************************************************************** 00960002
006646 ENVIRONMENT DIVISION.                                            00970000
006647***************************************************************** 00980000
006648                                                                  00990000
006649 CONFIGURATION SECTION.                                           01000000
006650                                                                  01010000
006660 SOURCE-COMPUTER.        IBM-3090.                                01020000
006670 OBJECT-COMPUTER.        IBM-3090.                                01030000
006680                                                                  01040000
006690 INPUT-OUTPUT SECTION.                                            01050000
006700                                                                  01060000
006800 FILE-CONTROL.                                                    01070000
006900*                                                                 01080000
007000     SELECT IC-CONTROL-FILE    ASSIGN       TO INP01              01090000
007100                               ORGANIZATION IS INDEXED            01100000
007200                               ACCESS       IS RANDOM             01110000
007300                               RECORD KEY   IS ICCTL-KEY          01120000
007400                               FILE STATUS  IS PV-CONTROL-STATUS. 01130000
007500     SELECT BIM-FILE           ASSIGN       TO INP02              01140000
007600                               ORGANIZATION IS INDEXED            01150000
007700                               ACCESS       IS RANDOM             01160000
007800                               RECORD KEY   IS BIM-FILE-KEY       01170000
007900                               FILE STATUS  IS PV-BIM-STATUS.     01180000
008000     SELECT TRANSFER-RECORD-IN ASSIGN TO INP03.                   01190000
008100     SELECT TRANSFER-RECORD    ASSIGN TO OUT01.                   01200000
008200*                                                                 01210000
008300***************************************************************** 01220000
008400 DATA DIVISION.                                                   01230000
008500***************************************************************** 01240000
008600*                                                                 01250000
008700 FILE SECTION.                                                    01260000
008800*                                                                 01270000
008900 FD  IC-CONTROL-FILE.                                             01280000
009000 01  IC-CONTROL-REC.                                              01290000
009100     05  ICCTL-KEY                   PIC  X(21).                  01300000
009200     05  FILLER                      PIC  X(379).                 01310000
009300*                                                                 01320000
009400 FD  BIM-FILE.                                                    01330000
009500 01  BIM-REC.                                                     01340000
009600     05  BIM-FILE-KEY                PIC  X(07).                  01350000
009700     05  FILLER                      PIC  X(228).                 01360000
009800*                                                                 01370000
009900 FD  TRANSFER-RECORD-IN                                           01380000
010000     RECORDING MODE IS F                                          01390000
010100     LABEL RECORDS ARE STANDARD                                   01400000
010200     RECORD CONTAINS 1143 CHARACTERS                              01410000
010300     BLOCK CONTAINS 0  RECORDS.                                   01420000
010400 01  TRANSFER-REC-IN                 PIC  X(1143).                01430000
010500*                                                                 01440000
010600 FD  TRANSFER-RECORD                                              01450000
010700     RECORDING MODE IS F                                          01460000
010800     LABEL RECORDS ARE STANDARD                                   01470000
010900     RECORD CONTAINS 2900 CHARACTERS                              01480000
011000     BLOCK CONTAINS 0  RECORDS.                                   01490000
011100 01  TRANSFER-REC                    PIC  X(2900).                01500000
011200*                                                                 01510000
011300 WORKING-STORAGE SECTION.                                         01520000
011400*                                                                 01530000
011500 01  FILLER.                                                      01540000
011600     05  FILLER                      PIC  X(36)    VALUE          01550000
011700         ' ***** WORKING STORAGE PGM=MRKUT141 '.                  01560002
011800     05  FILLER                      PIC  X(10)    VALUE          01570000
011900         ' LOCATION='.                                            01580000
012000     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   01590000
012100     05  FILLER                      PIC  X(06)    VALUE          01600000
012200         ' *****'.                                                01610000
012300 EJECT                                                            01620000
012400 01  PROGRAM-SWITCHES.                                            01630000
012500     05  PS-EOF-TRANS-REC            PIC  X(01)    VALUE 'N'.     01640000
012600         88  EOF-TRANS-REC                         VALUE 'Y'.     01650000
012700     05  PS-NO-INPUT                 PIC  X(01)    VALUE 'N'.     01660000
012800         88  NO-INPUT                              VALUE 'Y'.     01670000
012900     05  PS-ROW-FOUND-SWITCH         PIC  X(01)    VALUE 'Y'.     01680000
013000         88  PS-ROW-FOUND                          VALUE 'Y'.     01690000
013100         88  PS-ROW-NOT-FOUND                      VALUE 'N'.     01700000
013200*                                                                 01710000
013300/                                                                 01720000
013400 01  PC-CONSTANTS.                                                01730000
013500     05  PC-PGRM-NAME                PIC  X(08)    VALUE          01740000
013600                                                  'MRKUT141'.     01750002
013700     05  PC-PLUS-1                   PIC S9(04)    VALUE +1       01760000
013800                                                   COMP SYNC.     01770000
013900     05  PC-NEG-1                    PIC S9(04)    VALUE -1       01780000
014000                                                   COMP SYNC.     01790000
014100     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     01800000
014200                                                   COMP SYNC.     01810000
014300     05  PC-01                       PIC  X(02)    VALUE '01'.    01820000
014400     05  PC-1                        PIC S9(03)    VALUE +1       01830000
014500                                                   COMP-3.        01840000
014600     05  PC-2                        PIC S9(03)    VALUE +2       01850000
014700                                                   COMP-3.        01860000
014800     05  PC-3                        PIC S9(03)    VALUE +3       01870000
014900                                                   COMP-3.        01880000
015000     05  PC-4                        PIC S9(03)    VALUE +4       01890000
015100                                                   COMP-3.        01900000
015200     05  PC-5                        PIC S9(03)    VALUE +5       01910000
015300                                                   COMP-3.        01920000
015400     05  PC-6                        PIC S9(03)    VALUE +6       01930000
015500                                                   COMP-3.        01940000
015600     05  PC-7                        PIC S9(03)    VALUE +7       01950000
015700                                                   COMP-3.        01960000
015800     05  PC-200                      PIC S9(03)    VALUE +200     01970000
015900                                                   COMP-3.        01980000
016000     05  PC-999                      PIC S9(03)    VALUE +999     01990000
016100                                                   COMP-3.        02000000
016200     05  PC-03                       PIC  X(02)    VALUE '03'.    02010000
016300     05  PC-13                       PIC  X(02)    VALUE '13'.    02020000
016400     05  PC-17                       PIC  X(02)    VALUE '17'.    02030000
016500     05  PC-19                       PIC  X(02)    VALUE '19'.    02040000
016600     05  PC-20                       PIC  X(02)    VALUE '20'.    02050000
016700     05  PC-52                       PIC  9(02)    VALUE  52.     02060000
016800     05  PC-1P                       PIC  S99V     VALUE +1       02070000
016900                                                   COMP-3.        02080000
017000     05  PC-2P                       PIC  S99V     VALUE +2       02090000
017100                                                   COMP-3.        02100000
017200     05  PC-3P                       PIC  S99V     VALUE +3       02110000
017300                                                   COMP-3.        02120000
017400     05  PC-4P                       PIC  S99V     VALUE +4       02130000
017500                                                   COMP-3.        02140000
017600     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     02150000
017700     05  PC-A0                       PIC  X(02)    VALUE 'A0'.    02160000
017800     05  PC-F2                       PIC  X(02)    VALUE 'F2'.    02170000
017900     05  PC-F4                       PIC  X(02)    VALUE 'F4'.    02180000
018000     05  PC-DECR-7-DAYS              PIC  9(05)    VALUE 00007.   02190000
018100     05  PC-DPT                      PIC  X(03)    VALUE 'DPT'.   02200000
018200     05  PC-BYR                      PIC  X(03)    VALUE 'BYR'.   02210000
018300     05  PC-RCD-TYPE                 PIC  X(03)    VALUE 'SYS'.   02220000
018400     05  PC-FLNAME-LENGTH            PIC S9(03)    VALUE +30      02230000
018500                                                   COMP-3.        02240000
018600     05  PC-PGM-DPKUT500             PIC  X(08)    VALUE          02250000
018700                                                   'DPKUT500'.    02260000
018800     05  PC-OPER-CO                  PIC  XX       VALUE '03'.    02270000
018900     05  PC-CORPORATE-STORE          PIC  9(05)    VALUE ZERO.    02280000
019000     05  PC-085                      PIC  9(03)    COMP-3         02290000
019100                                                   VALUE 085.     02300000
019200     05  PC-810                      PIC  9(03)    COMP-3         02310000
019300                                                   VALUE 810.     02320000
019400     05  PC-899                      PIC  9(03)    COMP-3         02330000
019500                                                   VALUE 899.     02340000
019600 EJECT                                                            02350000
019700*                                                                 02360000
019800 01  PV-NULL-INDICATORS.                                          02370000
019900     05  PV-SALES-UNIT-QTY-NULL      PIC S9(04)    VALUE +0       02380000
020000                                                   COMP SYNC.     02390000
019900     05  PV-NULL-HISTCPS-QTY         PIC S9(04)    VALUE +0       02400000
020000                                                   COMP SYNC.     02410000
020100     05  PV-NULL-SLS-QTY             PIC S9(04)    VALUE +0       02420000
020200                                                   COMP SYNC.     02430000
020300     05  PV-NULL-OO                  PIC S9(04)    VALUE +0       02440000
020400                                                   COMP SYNC.     02450000
020500*                                                                 02460000
020600 01  PV-ACCUMULATOR-FIELDS.                                       02470000
020610     05  PV-SYSTEM-INPUT-CNT         PIC S9(07)    VALUE ZERO     02480000
020620                                                   COMP-3.        02490000
020630     05  PV-TRANS-INPUT-CNT          PIC S9(07)    VALUE ZERO     02500000
020640                                                   COMP-3.        02510000
020650     05  PV-SYSTEM-OUTPUT-CNT        PIC S9(07)    VALUE ZERO     02520000
020660                                                   COMP-3.        02530000
020670     05  PV-ITEM-COUNT               PIC S9(07)    VALUE ZERO     02540000
020680                                                   COMP-3.        02550000
020690 EJECT                                                            02560000
020700*                                                                 02570000
020800 01  PV-MISC-FIELDS.                                              02580000
020900     05  PV-9-5                      PIC 9(05)    VALUE ZERO.     02590000
020900     05  PV-X-5 REDEFINES PV-9-5.                                 02600000
022300         10   FILLER                 PIC X(2).                    02610000
022300         10   PV-X-3                 PIC X(3).                    02620000
020900     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     02630000
021000                                                   COMP SYNC.     02640000
021100     05  PV-VSAM-STATUS              PIC  X(02)    VALUE SPACE.   02650000
021200         88   PV-NO-REC-FOUND                      VALUE '23'.    02660000
021300                                                                  02670000
021400     05  PV-CONTROL-STATUS           PIC  X(02)    VALUE SPACE.   02680000
021500         88  PV-CONTROL-SUCCESSFUL                 VALUE '00'.    02690000
021600         88  PV-CONTROL-VERIFY                     VALUE '97'.    02700000
021700     05  PV-BIM-STATUS               PIC  X(02)    VALUE SPACE.   02710000
021800         88  PV-BIM-SUCCESSFUL                     VALUE '00'.    02720000
021900         88  PV-BIM-VERIFY                         VALUE '97'.    02730000
022000                                                                  02740000
022100     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  02750000
022200     05  PV-MESSAGES.                                             02760000
022300         10   PV-PARAGRAPH-NAME-MSG.                              02770000
022400             15  FILLER              PIC  X(13)    VALUE          02780000
022500                                    'PARAGRAPH IS '.              02790000
022600             15  PV-PARAGRAPH-NAME   PIC  X(25).                  02800000
022700         10   PV-ERROR-FILE-MSG.                                  02810000
022800             15  FILLER              PIC  X(26)    VALUE          02820000
022900                   'ERROR HAS OCCURED FILE IS '.                  02830000
023000             15  PV-ERROR-FILE       PIC  X(19).                  02840000
023100         10   PV-ERROR-OPERATION-MSG.                             02850000
023200             15  FILLER              PIC  X(13)    VALUE          02860000
023300                   'OPERATION IS '.                               02870000
023400             15  PV-ERROR-OPERATION  PIC  X(19).                  02880000
023500         10   PV-ERROR-STATUS-MSG.                                02890000
023600             15  FILLER              PIC  X(10)    VALUE          02900000
023700                   'STATUS IS '.                                  02910000
023800             15  PV-ERROR-STATUS     PIC  X(20).                  02920000
023900         10   PV-NOT-FOUND-MSG.                                   02930000
024000             15  FILLER              PIC  X(12)    VALUE          02940000
024100                   'FILE KEY IS '.                                02950000
024200             15  PV-NOT-FOUND-KEY    PIC  X(21).                  02960000
024300     05  PC-DATE.                                                 02970000
024400         10  PC-MO                   PIC 9(2) VALUE ZEROES.       02980000
024500         10  FILLER                  PIC X(1) VALUE '/'.          02990000
024600         10  PC-DY                   PIC 9(2) VALUE ZEROES.       03000000
024700         10  FILLER                  PIC X(1) VALUE '/'.          03010000
024800         10  PC-YR                   PIC 9(2) VALUE ZEROES.       03020000
024900                                                                  03030000
025000     05  PV-TODAYS-DATE              PIC  X(08).                  03040000
025100     05  PV-TODAYS-WEEK              PIC  9(02).                  03050000
025200     05  PV-FIRST-DATE.                                           03060000
025300         10  PV-FIRST-MO             PIC  9(02).                  03070000
025400         10  FILLER                  PIC  X(01)    VALUE '/'.     03080000
025500         10  PV-FIRST-DY             PIC  9(02).                  03090000
025600         10  FILLER                  PIC  X(01)    VALUE '/'.     03100000
025700         10  PV-FIRST-YR             PIC  9(02).                  03110000
025800     05  PV-UCYCLE-MIN-DATE                        VALUE SPACES.  03120000
025900         10  PV-UCYCLE-MIN-CCYR      PIC  9(04).                  03130000
026000         10  FILLER                  PIC  X(06).                  03140000
025800     05  PV-UCYCLE5-MIN-DATE                       VALUE SPACES.  03150000
025900         10  PV-UCYCLE5-MIN-CCYR     PIC  9(04).                  03160000
026000         10  FILLER                  PIC  X(06).                  03170000
025800     05  PV-UCYCLE9-MIN-DATE                       VALUE SPACES.  03180000
025900         10  PV-UCYCLE9-MIN-CCYR     PIC  9(04).                  03190000
026000         10  FILLER                  PIC  X(06).                  03200000
026100     05  PV-UCYCLE-MIN-YR            PIC  9(02)    VALUE ZERO.    03210000
026200     05  PV-UCYCLE-MAX-DATE                        VALUE SPACES.  03220000
026300         10  PV-UCYCLE-MAX-CCYR      PIC  9(04).                  03230000
026400         10  FILLER                  PIC  X(06).                  03240000
026200     05  PV-UCYCLE5-MAX-DATE                       VALUE SPACES.  03250000
026300         10  PV-UCYCLE5-MAX-CCYR     PIC  9(04).                  03260000
026400         10  FILLER                  PIC  X(06).                  03270000
026200     05  PV-UCYCLE9-MAX-DATE                       VALUE SPACES.  03280000
026300         10  PV-UCYCLE9-MAX-CCYR     PIC  9(04).                  03290000
026400         10  FILLER                  PIC  X(06).                  03300000
026500     05  PV-UCYCLE-MAX-YR            PIC  9(02)    VALUE ZERO.    03310000
027200     05  PV-CURRENT-DATE.                                         03320000
027300         10  PV-CURRENT-DATE-CC      PIC  9(02)    VALUE ZERO.    03330000
027400         10  PV-CURRENT-DATE-YR      PIC  9(02)    VALUE ZERO.    03340000
027500         10  FILLER                  PIC  X(01)    VALUE '-'.     03350000
027600         10  PV-CURRENT-DATE-MO      PIC  9(02)    VALUE ZERO.    03360000
027700         10  FILLER                  PIC  X(01)    VALUE '-'.     03370000
027800         10  PV-CURRENT-DATE-DY      PIC  9(02)    VALUE ZERO.    03380000
027900     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE              03390000
028000                                     PIC  X(10).                  03400000
028100     05  PV-SUBSCRIPTS.                                           03410000
028200         10  PV-HIST-SUB             PIC  9(02)    VALUE ZERO.    03420000
028300         10  PV-CST-SUB              PIC  9(02)    VALUE ZERO.    03430000
028400         10  PV-BIM-SUB              PIC  9(02)    VALUE ZERO.    03440000
028500         10  PV-BIM-SUB2             PIC  9(02)    VALUE ZERO.    03450000
028600         10  PV-WBI-SUB              PIC  9(02)    VALUE ZERO.    03460000
028700         10  PV-MBI-SUB              PIC  9(02)    VALUE ZERO.    03470000
028800         10  PV-BPN-SUB              PIC S9(01)    COMP.          03480000
028900     05  PV-CALC-DAYS                PIC S9(03)    VALUE ZERO.    03490000
029000* ###                                                             03500000
029100     05  PV-CALC-DAYS-POSITIVE       PIC S9(03)    VALUE ZERO.    03510000
029200     05  PV-MIN-DATE-CALC-DAYS       PIC S9(03)    VALUE ZERO.    03520000
029300* ###                                                             03530000
029400     05  PV-MIN-DATE-CALC-DAYS-POSI  PIC S9(03)    VALUE ZEROS.   03540000
029500     05  PV-BYR-NAME                 PIC  X(30)    VALUE SPACES.  03550000
029600     05  PV-TSKSTWKS-MIN-DTE         PIC  X(10)    VALUE SPACES.  03560000
029700     05  PV-TSKSTWKS-MAX-DTE         PIC  X(10)    VALUE SPACES.  03570000
029800     05  PV-MIN-BOW-DATE             PIC  X(10)    VALUE SPACES.  03580000
029900     05  PV-MAX-BOW-DATE             PIC  X(10)    VALUE SPACES.  03590000
030000                                                                  03600000
031300                                                                  03610000
031400     05  PV-CPS-QTY                  PIC S9999999V COMP-3.        03620000
031500     05  PV-WN                       PIC S9(02)    VALUE ZEROES.  03630000
031600     05  PV-OO                       PIC S9(07)    COMP-3         03640000
031700                                                   VALUE ZEROES.  03650000
031900     05  PV-F4-NBR-FISCAL-WEEKS      PIC  9(02)    VALUE ZEROES.  03660000
032000     05  PV-F4-NBR-FISCAL-PERIOD-WKS PIC  9(02)    VALUE ZEROES.  03670000
032100*                                                                 03680000
032200     05  PV-PREV-FIELDS.                                          03690000
032300         10  PV-PREV-SORT-SKU.                                    03700000
032400             15  PV-PREV-DEPT       PIC  X(03)    VALUE SPACES.   03710000
032500             15  PV-PREV-CLASS      PIC  X(02)    VALUE SPACES.   03720000
032600             15  PV-PREV-VEND-NBR   PIC  X(03)    VALUE SPACES.   03730000
032700             15  PV-PREV-SKU        PIC S9(08)    COMP-3          03740000
032800                                                  VALUE ZEROES.   03750000
032900         10  PV-PREV-STORE          PIC S9(05)    VALUE ZEROES.   03760000
033000         10  PV-PREV-ITEM-NBR       PIC 9(15)     COMP-3 VALUE 0. 03770000
033100         10  PV-PREV-WEEK-NBR       PIC S99V      COMP-3 VALUE 0. 03780000
033200         10  PV-PREV-SEQ-NBR        PIC S99V      COMP-3 VALUE 0. 03790000
033300         10  PV-PREV-LFWM-QTY       PIC S9(6)V9   COMP-3 VALUE 0. 03800000
033400         10  PV-PREV-FWM-QTY        PIC S9(6)V9   COMP-3 VALUE 0. 03810000
033500*                                                                 03820000
033600 EJECT                                                            03830000
033700*                                                                 03840000
033800 01 PV-INPUT.                                                     03850000
033900     COPY MRRD017.                                                03860000
034000 EJECT                                                            03870000
034100 01 PV-OUTPUT.                                                    03880000
034200     COPY MRRD004O.                                               03890000
034300 EJECT                                                            03900000
034400     COPY DPWS024.                                                03910000
034500 EJECT                                                            03920000
034600     COPY DPWS500.                                                03930000
034700 EJECT                                                            03940000
034800     COPY MRRD001I.                                               03950000
034900 EJECT                                                            03960000
035000 01 PAN-BIM-FILE.                                                 03970000
035100     COPY IPFGBIC.                                                03980000
035200 EJECT                                                            03990000
035300 01  SYSTEM-RECORD.                                               04000000
035400     COPY ICI005C.                                                04010000
035500 EJECT                                                            04020000
035600     EXEC SQL                                                     04030000
035700         INCLUDE TMRISFL                                          04040000
035800     END-EXEC.                                                    04050000
035900 EJECT                                                            04060000
036000     EXEC SQL                                                     04070000
036100         INCLUDE TENTNME                                          04080000
036200     END-EXEC.                                                    04090000
036300 EJECT                                                            04100000
036400     EXEC SQL                                                     04110000
036500         INCLUDE TSKSTOO                                          04120000
036600     END-EXEC.                                                    04130000
036700 EJECT                                                            04140000
036800     EXEC SQL                                                     04150000
036900         INCLUDE XMT00001                                         04160000
037000     END-EXEC.                                                    04170000
037100 EJECT                                                            04180000
037200     EXEC SQL                                                     04190000
037300         INCLUDE TVNDDPT                                          04200000
037400     END-EXEC.                                                    04210000
037500 EJECT                                                            04220000
037600     EXEC SQL                                                     04230000
037700         INCLUDE TSKSTWKS                                         04240000
037800     END-EXEC.                                                    04250000
037900 EJECT                                                            04260000
038000     EXEC SQL                                                     04270000
038100         INCLUDE TSKST                                            04280000
038200     END-EXEC.                                                    04290000
038300 EJECT                                                            04300000
038400     EXEC SQL                                                     04310000
038500         INCLUDE TMRITST                                          04320000
038600     END-EXEC.                                                    04330000
038700 EJECT                                                            04340000
038800     EXEC SQL                                                     04350000
038900         INCLUDE TUPCSKU                                          04360000
039000     END-EXEC.                                                    04370000
039100 EJECT                                                            04380000
039200     EXEC SQL                                                     04390000
039300         INCLUDE TRSPBAR                                          04400000
039400     END-EXEC.                                                    04410000
039500 EJECT                                                            04420000
039600     EXEC SQL                                                     04430000
039700         INCLUDE TMDSEAR                                          04440000
039800     END-EXEC.                                                    04450000
039900 EJECT                                                            04460000
040000* DB2 COMMUNICATION AREA                                          04470000
040100*                                                                 04480000
040200     EXEC SQL                                                     04490000
040300         INCLUDE SQLCA                                            04500000
040400     END-EXEC.                                                    04510000
040500 EJECT                                                            04520000
040600* DB2 COMMUNICATION AREA2                                         04530000
040700*                                                                 04540000
040800     COPY SQLCA2.                                                 04550000
040900 EJECT                                                            04560000
041000*                                                                 04570000
041100*                                                                 04580000
041200 LINKAGE SECTION.                                                 04590000
041300*** DATABASE PCB AREA ***                                         04600000
041400*                                                                 04610000
041500*** DEBIT MASTER DATABASE                                         04620000
041600*                                                                 04630000
041700***************************************************************** 04640000
041800*PROCEDURE DIVISION.                                              04650000
041900***************************************************************** 04660000
042000 PROCEDURE DIVISION.                                              04670000
042100*                                                                 04680000
042200 A000-MAINLINE-PROCESSING.                                        04690000
042300*                                                                 04700000
042400     PERFORM A100-INITIALIZATION.                                 04710000
042500*                                                                 04720000
042600     PERFORM B000-PROCESS-SYSTEM-RECORD                           04730000
042700             UNTIL EOF-TRANS-REC.                                 04740000
042800*                                                                 04750000
042900     PERFORM Y100-END-ROUTINE.                                    04760000
043000*                                                                 04770000
043100     GOBACK.                                                      04780000
043200*                                                                 04790000
043300 EJECT                                                            04800000
043400******************************************************************04810000
043500** OPEN THE SYSTEM FILE AND ACCEPT CONTROL CARDS.                 04820000
043600** CALL CALENDAR ROUTINES TO RETRIEVE VALUES NEEDED IN PROGRAM    04830000
043700******************************************************************04840000
043800 A100-INITIALIZATION.                                             04850000
043900*                                                                 04860000
044000*    DISPLAY 'A100-INITIALIZATION'.                               04870000
044100*                                                                 04880000
044200     OPEN  INPUT IC-CONTROL-FILE                                  04890000
044300           INPUT BIM-FILE                                         04900000
044400           INPUT TRANSFER-RECORD-IN                               04910000
044500          OUTPUT TRANSFER-RECORD.                                 04920000
044600*                                                                 04930000
044700     IF  PV-CONTROL-SUCCESSFUL OR                                 04940000
044800         PV-CONTROL-VERIFY                                        04950000
044900        CONTINUE                                                  04960000
045000     ELSE                                                         04970000
045100        MOVE 'A100-INITIALIATION' TO PV-PARAGRAPH-NAME            04980000
045200        MOVE 'IC-CONTROL-FILE'    TO PV-ERROR-FILE                04990000
045300        MOVE 'OPENING INPUT FILE' TO PV-ERROR-OPERATION           05000000
045400        MOVE 'BAD-OPEN'           TO PV-ERROR-STATUS              05010000
045500        MOVE  PV-CONTROL-STATUS   TO PV-VSAM-STATUS               05020000
045600        MOVE  '//////////////'    TO PV-NOT-FOUND-KEY             05030000
045700        PERFORM Z999-VSAM-ERROR                                   05040000
045800        MOVE +4005                TO PV-ABEND-CODE                05050000
045900        CALL 'ILBOABN0'        USING PV-ABEND-CODE                05060000
046000     END-IF.                                                      05070000
046100*                                                                 05080000
046200     IF  PV-BIM-SUCCESSFUL OR                                     05090000
046300         PV-BIM-VERIFY                                            05100000
046400        CONTINUE                                                  05110000
046500     ELSE                                                         05120000
046600        MOVE 'A100-INITIALIATION' TO PV-PARAGRAPH-NAME            05130000
046700        MOVE 'BIM-FILE'           TO PV-ERROR-FILE                05140000
046800        MOVE 'OPENING INPUT FILE' TO PV-ERROR-OPERATION           05150000
046900        MOVE 'BAD-OPEN'           TO PV-ERROR-STATUS              05160000
047000        MOVE  PV-BIM-STATUS       TO PV-VSAM-STATUS               05170000
047100        MOVE  '//////////////'    TO PV-NOT-FOUND-KEY             05180000
047200        PERFORM Z999-VSAM-ERROR                                   05190000
047300        MOVE +4005                TO PV-ABEND-CODE                05200000
047400        CALL 'ILBOABN0'        USING PV-ABEND-CODE                05210000
047500     END-IF.                                                      05220000
047600*                                                                 05230000
047700     ACCEPT PARAMETER-INPUT-RECORD.                               05240000
047800*                                                                 05250000
047900*  ##Y2K                                                          05260000
048000                                                                  05270000
048100     ACCEPT DPG51-SYSTEM-DATE-N FROM DATE.                        05280000
048200     MOVE DPG51-SYSTEM-DATE-YR TO PV-CURRENT-DATE-YR              05290000
048300                                  PC-YR.                          05300000
048400     MOVE DPG51-SYSTEM-DATE-MO TO PV-CURRENT-DATE-MO              05310000
048500                                  PC-MO.                          05320000
048600     MOVE DPG51-SYSTEM-DATE-DY TO PV-CURRENT-DATE-DY              05330000
048700                                  PC-DY.                          05340000
048800*    DISPLAY 'PC-DATE: ' PC-DATE.                                 05350000
048900     MOVE PC-DATE TO DPG52-LK-DATE-INPUT.                         05360000
049000                                                                  05370000
049100* ***********GET FIRST FISCAL DATE FROM SYSTEM DATE **********    05380000
049200* *                                                               05390000
049300     MOVE SPACES              TO DPG51-INCREMENT-DECREMENT-FLAG.  05400000
049400     MOVE PC-F2               TO DPG51-CALENDAR-TYPE.             05410000
049500     SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           05420000
049600     PERFORM I000-CALENDAR-ROUTINE.                               05430000
049700     MOVE DPG56-FIRST-FD-GREG-FMT TO PV-TODAYS-DATE.              05440000
049800     MOVE DPG56-FISCAL-WEEK-NBR TO PV-TODAYS-WEEK.                05450000
049900*                                                                 05460000
050000     IF DPG51-SYSTEM-DATE-YR > 80                                 05470000
050100         MOVE PC-19           TO PV-CURRENT-DATE-CC               05480000
050200     ELSE                                                         05490000
050300         MOVE PC-20           TO PV-CURRENT-DATE-CC               05500000
050400     END-IF.                                                      05510000
050500*                                                                 05520000
050600     MOVE MR001I-S-SYS-ID   TO  S-SYS-ID.                         05530000
050700     MOVE PC-RCD-TYPE       TO  S-RCD-TYPE.                       05540000
050800     MOVE LOW-VALUES        TO  S-RCD-ID.                         05550000
050900     MOVE S-KEY             TO  ICCTL-KEY.                        05560000
051000     PERFORM R000-READ-CONTROL-FILE.                              05570000
051100*                                                                 05580000
051200     PERFORM T150-DATE-ROUTINE.                                   05590000
063400     MOVE PC-2 TO PV-BPN-SUB.                                     05600000
063500     PERFORM T155-UCYCLE-CALENDAR-ROUTINE.                        05610000
063600     MOVE PV-UCYCLE-MAX-DATE TO PV-UCYCLE5-MAX-DATE.              05620000
063700     MOVE PV-UCYCLE-MIN-DATE TO PV-UCYCLE5-MIN-DATE.              05630000
063400     MOVE PC-1 TO PV-BPN-SUB.                                     05640000
063500     PERFORM T155-UCYCLE-CALENDAR-ROUTINE.                        05650000
063600     MOVE PV-UCYCLE-MAX-DATE TO PV-UCYCLE9-MAX-DATE.              05660000
063700     MOVE PV-UCYCLE-MIN-DATE TO PV-UCYCLE9-MIN-DATE.              05670000
052800**                                                                05680000
052900     PERFORM R200-READ-TRANS-REC-IN.                              05690000
053000     IF EOF-TRANS-REC                                             05700000
053100         MOVE PC-Y             TO PS-NO-INPUT                     05710000
053200     ELSE                                                         05720000
053300         INITIALIZE PV-OUTPUT                                     05730000
053400         PERFORM D100-MOVE-TRANS-DATA                             05740000
053500         MOVE MR017-TR-SORT-FIELDS TO PV-PREV-FIELDS              05750000
053600*                                                                 05760000
053700         MOVE MR017-DEPT-NBR   TO VNDDPT-DEPT-NBR                 05770000
053800         MOVE MR017-VEND-NBR   TO VNDDPT-INHOUSE-NBR              05780000
053900         PERFORM T700-SELECT-VENDOR-NAME                          05790000
054000*                                                                 05800000
054100         MOVE MR017-DEPT-NBR   TO MDSEAR-DEPT-NBR                 05810000
054200         MOVE PC-DPT           TO MDSEAR-MDSELV-CDE               05820000
054300         PERFORM T800-SELECT-MDSEAR-DKEY                          05830000
054400         MOVE MDSEAR-DKEY      TO RSPBAR-MDSEAR-DKEY              05840000
054500         MOVE PC-BYR           TO RSPBAR-RSPLVL-CDE               05850000
054600         PERFORM T900-SELECT-BUYER-NAME                           05860000
054700*                                                                 05870000
054800         PERFORM T300-SELECT-PO-RECORD                            05880000
054900         PERFORM T000-SELECT-UPC-NUMBER                           05890000
055000         PERFORM C000-FORMAT-TRANSFER-REC                         05900000
055100     END-IF.                                                      05910000
055200*                                                                 05920000
055300 EJECT                                                            05930000
055400******************************************************************05940000
055500*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *05950000
055600*  SYSTEM RECORD.                                                *05960000
055700******************************************************************05970000
055800 B000-PROCESS-SYSTEM-RECORD.                                      05980000
055900*                                                                 05990000
056000*    DISPLAY 'B000-PROCESS-SYSTEM-RECORD'.                        06000000
056100*    DISPLAY ' CR DEPT:' MR017-DEPT-NBR 'PV DEPT:' PV-PREV-DEPT.  06010000
056200*    DISPLAY ' CR SKU:' MR017-SORT-SKU 'PV SKU:' PV-PREV-SKU.     06020000
056300*    DISPLAY ' CR STR:' MR017-STR-NBR 'PV STR:' PV-PREV-STORE.    06030000
056400*    DISPLAY ' CR WK:' MR017-WEEK-NBR 'PV WK:' PV-PREV-WEEK-NBR.  06040000
056500*                                                                 06050000
056600       IF MR017-DEPT-NBR = PV-PREV-DEPT                           06060000
056700         IF MR017-SORT-SKU = PV-PREV-SORT-SKU                     06070000
056800           IF MR017-STR-NBR = PV-PREV-STORE                       06080000
056900             PERFORM C100-ACCUM-FE-DETAIL                         06090000
057000           ELSE                                                   06100000
057100             PERFORM W000-WRITE-OUTPUT                            06110000
057200             PERFORM D100-MOVE-TRANS-DATA                         06120000
057300             PERFORM T300-SELECT-PO-RECORD                        06130000
057400             PERFORM C000-FORMAT-TRANSFER-REC                     06140000
057500           END-IF                                                 06150000
057600         ELSE                                                     06160000
057700                                                                  06170000
057800           PERFORM W000-WRITE-OUTPUT                              06180000
057900           PERFORM D100-MOVE-TRANS-DATA                           06190000
058000           MOVE MR017-DEPT-NBR       TO VNDDPT-DEPT-NBR           06200000
058100           MOVE MR017-VEND-NBR       TO VNDDPT-INHOUSE-NBR        06210000
058200*                                                                 06220000
058300           PERFORM T700-SELECT-VENDOR-NAME                        06230000
058400           PERFORM T000-SELECT-UPC-NUMBER                         06240000
058500           PERFORM T300-SELECT-PO-RECORD                          06250000
058600           PERFORM C000-FORMAT-TRANSFER-REC                       06260000
058700         END-IF                                                   06270000
058800       ELSE                                                       06280000
058900         PERFORM W000-WRITE-OUTPUT                                06290000
059000         PERFORM D100-MOVE-TRANS-DATA                             06300000
059100*                                                                 06310000
059200         MOVE MR017-DEPT-NBR       TO VNDDPT-DEPT-NBR             06320000
059300         MOVE MR017-VEND-NBR       TO VNDDPT-INHOUSE-NBR          06330000
059400         PERFORM T700-SELECT-VENDOR-NAME                          06340000
059500*                                                                 06350000
059600         MOVE MR017-DEPT-NBR       TO MDSEAR-DEPT-NBR             06360000
059700         MOVE PC-DPT               TO MDSEAR-MDSELV-CDE           06370000
059800         PERFORM T800-SELECT-MDSEAR-DKEY                          06380000
059900         MOVE MDSEAR-DKEY          TO RSPBAR-MDSEAR-DKEY          06390000
060000         MOVE PC-BYR               TO RSPBAR-RSPLVL-CDE           06400000
060100         PERFORM T900-SELECT-BUYER-NAME                           06410000
060200*                                                                 06420000
060300         PERFORM T000-SELECT-UPC-NUMBER                           06430000
060400         PERFORM T300-SELECT-PO-RECORD                            06440000
060500         PERFORM C000-FORMAT-TRANSFER-REC                         06450000
060600       END-IF.                                                    06460000
060700*                                                                 06470000
060800       MOVE MR017-TR-SORT-FIELDS TO PV-PREV-FIELDS.               06480000
060900       PERFORM R200-READ-TRANS-REC-IN.                            06490000
061000*                                                                 06500000
061100 EJECT                                                            06510000
061200******************************************************************06520000
061300*  MOVE VALUES TO OUTPUT FOR A REPLENISHMENT RUN(TYPE-CD = 1)    *06530000
061400******************************************************************06540000
061500 C000-FORMAT-TRANSFER-REC.                                        06550000
061600*                                                                 06560000
061700     PERFORM T100-SELECT-ONHAND-QTY.                              06570000
061800*                                                                 06580000
061900*    DISPLAY ' C000-FORMAT-TRANSFER-REC.'                         06590000
062000*    DISPLAY '  UCYCLE ' MR017-UCYCLE.                            06600000
062100*    DISPLAY 'PV-MAX-BOW-DATE ' PV-MAX-BOW-DATE.                  06610000
062200*    DISPLAY 'PV-MIN-BOW-DATE ' PV-MIN-BOW-DATE.                  06620000
062300*    DISPLAY 'PV-UCYCLE-MAX-DATE ' PV-UCYCLE-MAX-DATE.            06630000
062400*    DISPLAY 'PV-UCYCLE-MIN-DATE ' PV-UCYCLE-MIN-DATE.            06640000
062500                                                                  06650000
062600     IF MR017-UCYCLE = S-UCYCLE (3) AND                           06660000
062700       MR017-UCYCLE = PC-4                                        06670000
062800         MOVE PV-MAX-BOW-DATE TO PV-TSKSTWKS-MAX-DTE              06680000
062900         MOVE PV-MIN-BOW-DATE TO PV-TSKSTWKS-MIN-DTE              06690000
063000         PERFORM S600-SUM-CPS-QTY                                 06700000
063100     ELSE                                                         06710000
063200         IF MR017-UCYCLE = S-UCYCLE (2) AND                       06720000
063300           MR017-UCYCLE = PC-5                                    06730000
063400             MOVE PC-2                TO PV-BPN-SUB               06740000
063600             MOVE PV-UCYCLE5-MAX-DATE TO PV-TSKSTWKS-MAX-DTE      06750000
063700             MOVE PV-UCYCLE5-MIN-DATE TO PV-TSKSTWKS-MIN-DTE      06760000
063800             PERFORM S600-SUM-CPS-QTY                             06770000
063900         ELSE                                                     06780000
064000             MOVE PC-1                TO PV-BPN-SUB               06790000
064200             MOVE PV-UCYCLE9-MAX-DATE TO PV-TSKSTWKS-MAX-DTE      06800000
064300             MOVE PV-UCYCLE9-MIN-DATE TO PV-TSKSTWKS-MIN-DTE      06810000
064400             PERFORM S600-SUM-CPS-QTY                             06820000
064500         END-IF                                                   06830000
064600     END-IF.                                                      06840000
064700     MOVE SKSTWKS-SALES-UNIT-QTY TO PV-CPS-QTY.                   06850000
064800*                                                                 06860000
064900*    LOAD VALUES FROM THE TMRISHS TABLE                           06870000
065000*    TO HISTCPS, HISTOH, HISTDD, HISTMAD.                         06880000
065100*                                                                 06890000
065200     MOVE PC-1                TO PV-HIST-SUB.                     06900000
065300*                                                                 06910000
065400     PERFORM E000-LOAD-REPL-HIST                                  06920000
065500             VARYING PV-HIST-SUB                                  06930000
065600             FROM 1 BY 1                                          06940000
065700             UNTIL PV-HIST-SUB > PC-13.                           06950000
065800*                                                                 06960000
065900*    LOAD ZEROES TO HISTLYS                                       06970000
066000*                                                                 06980000
066100     MOVE PC-1 TO PV-HIST-SUB.                                    06990000
066200     PERFORM E300-LOAD-HISTLYS-QTY                                07000000
066300             UNTIL PV-HIST-SUB > PC-17.                           07010000
066400*                                                                 07020000
066500     MOVE MR017-PTAG     TO GBI-KEY-PTAG.                         07030000
066600     MOVE MR017-PTAG     TO BIM-FILE-KEY.                         07040000
066700     PERFORM R100-READ-BIM-FILE.                                  07050000
066800*                                                                 07060000
066900     PERFORM F000-FORMAT-TRAN-INPUT.                              07070000
067000*                                                                 07080000
067100     PERFORM H000-FORMAT-ROH-USER-AREA.                           07090000
067200*                                                                 07100000
067300*                                                                 07110000
067400******************************************************************07120000
067500*   ACCUMULATE MRISFE DETAIL                                      07130000
067600******************************************************************07140000
067700 C100-ACCUM-FE-DETAIL.                                            07150000
067800*                                                                 07160000
067900*    DISPLAY 'C100-ACCUM-FE-DETAIL'.                              07170000
068000*                                                                 07180000
068100     EVALUATE TRUE                                                07190000
068200     WHEN MR017-WEEK-NBR = PC-1P                                  07200000
068300      MOVE MR017-LFWM-QTY    TO MR004O-LFWM(1)                    07210000
068400      MOVE MR017-FWM-QTY     TO MR004O-FWM(1)                     07220000
068500     WHEN MR017-WEEK-NBR = PC-2P                                  07230000
068600      MOVE MR017-LFWM-QTY    TO MR004O-LFWM(2)                    07240000
068700      MOVE MR017-FWM-QTY     TO MR004O-FWM(2)                     07250000
068800     WHEN MR017-WEEK-NBR = PC-3P                                  07260000
068900      MOVE MR017-LFWM-QTY    TO MR004O-LFWM(3)                    07270000
069000      MOVE MR017-FWM-QTY     TO MR004O-FWM(3)                     07280000
069100     WHEN MR017-WEEK-NBR = PC-4P                                  07290000
069200      MOVE MR017-LFWM-QTY    TO MR004O-LFWM(4)                    07300000
069300      MOVE MR017-FWM-QTY     TO MR004O-FWM(4)                     07310000
069400     WHEN OTHER                                                   07320000
069500         CONTINUE                                                 07330000
069600     END-EVALUATE.                                                07340000
069700*                                                                 07350000
069800******************************************************************07360000
069900*   ACCUMULATE MRISFE DETAIL                                      07370000
070000******************************************************************07380000
070100 D100-MOVE-TRANS-DATA.                                            07390000
070200*                                                                 07400000
070300*    DISPLAY 'D100-MOVE-TRANS-DATA'.                              07410000
070400*                                                                 07420000
070500     MOVE MR017-UCYCLE           TO MR004O-UCYCLE.                07430000
070600     MOVE MR017-WN               TO MR004O-WN.                    07440000
070700     MOVE MR017-DN               TO MR004O-DN.                    07450000
070800     MOVE MR017-CADL             TO MR004O-CADL.                  07460000
070900*WR20601 FIX   PUT CODE BACK THAT WAS DELETED.  START             07470000
071000     MOVE MR017-IDFL             TO MR004O-IDFL.                  07480000
071100     MOVE MR017-HIDFL            TO MR004O-HIDFL.                 07490000
071200     MOVE MR017-LODFL            TO MR004O-LODFL.                 07500000
071300     MOVE MR017-NDFL             TO MR004O-NDFL.                  07510000
071400     MOVE MR017-MINSMK           TO MR004O-MINSMK.                07520000
071500     MOVE MR017-MAXSMK           TO MR004O-MAXSMK.                07530000
071600     MOVE MR017-DAMP             TO MR004O-DAMP.                  07540000
071700     MOVE MR017-TSL              TO MR004O-TSL.                   07550000
071800*WR20601 FIX   PUT CODE BACK THAT WAS DELETED.  END               07560000
071900     MOVE MR017-BYPDDU           TO MR004O-BYPDDU.                07570000
072000     MOVE MR017-BYPSCL           TO MR004O-BYPSCL.                07580000
072100     MOVE MR017-FRCDDU           TO MR004O-FRCDDU.                07590000
072200     MOVE MR017-BYPZSL           TO MR004O-BYPZSL.                07600000
072300     MOVE MR017-BYPTFP           TO MR004O-BYPTFP.                07610000
072400     MOVE MR017-BYPZOH           TO MR004O-BYPZOH.                07620000
072500     MOVE MR017-BYPBEF           TO MR004O-BYPBEF.                07630000
072600     MOVE MR017-BYPAFT           TO MR004O-BYPAFT.                07640000
072700     MOVE MR017-LUMPSW           TO MR004O-LUMPSW.                07650000
072800     MOVE MR017-MINBI            TO MR004O-MINBI.                 07660000
072900     MOVE MR017-DDFTSW           TO MR004O-DDFTSW.                07670000
073000     MOVE MR017-HIPCT            TO MR004O-HIPCT.                 07680000
073100     MOVE MR017-LOPCT            TO MR004O-LOPCT.                 07690000
073200     MOVE MR017-MINDD            TO MR004O-MINDD.                 07700000
073300     MOVE MR017-HIMADP           TO MR004O-HIMADP.                07710000
073400     MOVE MR017-LOMADP           TO MR004O-LOMADP.                07720000
073500     MOVE MR017-RT               TO MR004O-RT.                    07730000
073600     MOVE MR017-RTF              TO MR004O-RTF.                   07740000
073700     MOVE MR017-ZOPSW            TO MR004O-ZOPSW.                 07750000
073800     MOVE MR017-OUTLSW           TO MR004O-OUTLSW.                07760000
073900     MOVE MR017-ZSSTOCK          TO MR004O-ZSSTOCK.               07770000
074000     MOVE MR017-PACKSW           TO MR004O-PACKSW.                07780000
074100     MOVE MR017-DSER             TO MR004O-DSER.                  07790000
074200     MOVE MR017-PTAG             TO MR004O-PTAG.                  07800000
074300     MOVE MR017-LT               TO MR004O-LT.                    07810000
074400     MOVE MR017-ICOST            TO MR004O-ICOST.                 07820000
074500     MOVE MR017-OO               TO MR004O-OO.                    07830000
074600     MOVE MR017-COMSTK           TO MR004O-COMSTK.                07840000
074700     MOVE MR017-SPOQSW           TO MR004O-SPOQSW.                07850000
074800     MOVE MR017-SPOQ             TO MR004O-SPOQ.                  07860000
074900     MOVE MR017-INAME            TO MR004O-INAME.                 07870000
075000     MOVE MR017-DEPT-NBR         TO MR004O-H-DEPT.                07880000
075100     MOVE MR017-CLASS-NBR        TO MR004O-H-CLASS.               07890000
075200     MOVE MR017-SKU              TO MR004O-SKU.                   07900000
075300     MOVE MR017-UPC              TO MR004O-UPC.                   07910000
075400     MOVE MR017-FT               TO MR004O-FT.                    07920000
075500     MOVE MR017-OSTRAT           TO MR004O-OSTRAT.                07930000
075600     MOVE MR017-PACKSZ           TO MR004O-PACKSZ.                07940000
075700     MOVE MR017-IMIN             TO MR004O-IMIN.                  07950000
075800     MOVE MR017-IMAX             TO MR004O-IMAX.                  07960000
075900     MOVE MR017-CSTOCK           TO MR004O-CSTOCK.                07970000
076000     MOVE MR017-SSADJ            TO MR004O-SSADJ.                 07980000
076100     MOVE MR017-MINOUTL          TO MR004O-MINOUTL.               07990000
076200     MOVE MR017-MAXOUTL          TO MR004O-MAXOUTL.               08000000
076300     MOVE MR017-MAXOQP           TO MR004O-MAXOQP.                08010000
076400     MOVE MR017-FOQ              TO MR004O-FOQ.                   08020000
076500     MOVE MR017-TMIN             TO MR004O-TMIN.                  08030000
076600     MOVE MR017-USERMIN          TO MR004O-USERMIN.               08040000
076700     MOVE MR017-USERMAX          TO MR004O-USERMAX.               08050000
076800     MOVE MR017-DD               TO MR004O-DD.                    08060000
076900     MOVE MR017-DDI              TO MR004O-DDI.                   08070000
077000     MOVE MR017-LPP              TO MR004O-LPP.                   08080000
077100     MOVE MR017-MADSS            TO MR004O-MADSS.                 08090000
077200     MOVE MR017-FWMAD            TO MR004O-FWMAD.                 08100000
077300     MOVE MR017-TRNDP            TO MR004O-TRNDP.                 08110000
077400     MOVE MR017-MSDTS            TO MR004O-MSDTS.                 08120000
077500     MOVE MR017-MADTS            TO MR004O-MADTS.                 08130000
077600     MOVE MR017-LTVFACT          TO MR004O-LTVFACT.               08140000
077700     MOVE MR017-PCTZ             TO MR004O-PCTZ.                  08150000
077800     MOVE MR017-MADSTAT          TO MR004O-MADSTAT.               08160000
077900     MOVE MR017-DFLREG           TO MR004O-DFLREG.                08170000
078000     MOVE MR017-TSREG            TO MR004O-TSREG.                 08180000
078100     MOVE MR017-DIREG            TO MR004O-DIREG.                 08190000
078200     MOVE MR017-BYPREG           TO MR004O-BYPREG.                08200000
078300     MOVE MR017-LDD              TO MR004O-LDD.                   08210000
078400     MOVE MR017-LDDI             TO MR004O-LDDI.                  08220000
078500     MOVE MR017-LMADSS           TO MR004O-LMADSS.                08230000
078600     MOVE MR017-OUTSTAT          TO MR004O-OUTSTAT.               08240000
078700     MOVE MR017-LRTFCST          TO MR004O-LRTFCST.               08250000
078800     MOVE MR017-ORDSTAT          TO MR004O-ORDSTAT.               08260000
078900     MOVE MR017-DDUPRM           TO MR004O-DDUPRM.                08270000
079000     PERFORM D200-MOVE-CST-MIN-MAX                                08280000
079100        VARYING PV-CST-SUB                                        08290000
079200        FROM 1 BY 1                                               08300000
079300        UNTIL  PV-CST-SUB > PC-6.                                 08310000
079400                                                                  08320000
079500     MOVE MR017-FTJOPF           TO MR004O-FTJOPF.                08330000
079600     MOVE MR017-COST-UNIT-MSMT   TO MR004O-COST-UNIT-MSMT.        08340000
079700     MOVE MR017-RTL-UNIT-MSMT    TO MR004O-RTL-UNIT-MSMT.         08350000
079800     MOVE MR017-CUR-UNIT-RTL-AMT TO MR004O-CUR-UNIT-RTL-AMT.      08360000
079900     MOVE MR017-GR-RTL-AMT       TO MR004O-GR-RTL-AMT.            08370000
080000     MOVE MR017-GR-QTY           TO MR004O-GR-QTY.                08380000
080100     MOVE MR017-MERCH-DIV-CODE   TO MR004O-MERCH-DIV-CODE.        08390000
080200     MOVE MR017-DMM-NBR          TO MR004O-DMM-NBR.               08400000
080300     MOVE SPACES                 TO MR004O-SEQ-NBR.               08410000
080400*                                                                 08420000
080500******************************************************************08430000
080600 D200-MOVE-CST-MIN-MAX.                                           08440000
080700*                                                                 08450000
080800*    DISPLAY 'D200-MOVE-CST-MIN-MAX'.                             08460000
080900*                                                                 08470000
081000     MOVE MR017-CSTKMINT (PV-CST-SUB)                             08480000
081100                                 TO MR004O-CSTKMINT(PV-CST-SUB).  08490000
081200     MOVE MR017-CSTKMAXT (PV-CST-SUB)                             08500000
081300                                 TO MR004O-CSTKMAXT(PV-CST-SUB).  08510000
081400*                                                                 08520000
081500******************************************************************08530000
081600*  REPLENISHMENT QUANTITY FIELDS : CPS, OH, MAD, & DD.            08540000
081700*-----------------------------------------------------------------08550000
081800*  THERE ARE 13 OCCURANCES AND THE MAKEUP OF THESE SHOULD BE:     08560000
081900*        OCCURANCE 1  - TNOW-WN - 1                               08570000
082000*        OCCURANCE 2  - TNOW-WN - 2                               08580000
082100*        OCCURANCE 3  - TNOW-WN - 3                               08590000
082200*        OCCURANCE 4  - TNOW-WN - 4                               08600000
082300*        OCCURANCE 5  - TNOW-WN - 5                               08610000
082400*        OCCURANCE 6  - TNOW-WN - 6                               08620000
082500*        OCCURANCE 7  - TNOW-WN - 7                               08630000
082600*        OCCURANCE 8  - TNOW-WN - 8                               08640000
082700*        OCCURANCE 9  - TNOW-WN - 9                               08650000
082800*        OCCURANCE 10 - TNOW-WN - 10                              08660000
082900*        OCCURANCE 11 - TNOW-WN - 11                              08670000
083000*        OCCURANCE 12 - TNOW-WN - 12                              08680000
083100*        OCCURANCE 13 - TNOW-WN - 13                              08690000
083200******************************************************************08700000
083300*                                                                 08710000
083400*                                                                 08720000
083500 E000-LOAD-REPL-HIST.                                             08730000
083600*                                                                 08740000
083700*    DISPLAY 'E000-LOAD-REPL-HIST'.                               08750000
083800*                                                                 08760000
083900         MOVE MR017-HISTBPN(PV-HIST-SUB)                          08770000
084000                               TO  MR004O-HISTBPN(PV-HIST-SUB).   08780000
084100         MOVE MR017-HISTCPS(PV-HIST-SUB)                          08790000
084200                               TO  MR004O-HISTCPS(PV-HIST-SUB).   08800000
084300         MOVE MR017-HISTMAD(PV-HIST-SUB)                          08810000
084400                               TO  MR004O-HISTMAD(PV-HIST-SUB).   08820000
084500         MOVE MR017-HISTOH(PV-HIST-SUB)                           08830000
084600                               TO  MR004O-HISTOH(PV-HIST-SUB).    08840000
084700         MOVE MR017-HISTDD(PV-HIST-SUB)                           08850000
084800                               TO  MR004O-HISTDD(PV-HIST-SUB).    08860000
084900*                                                                 08870000
085000******************************************************************08880000
085100*  LAST YEAR SALES HISTORY QUANTITIES.                            08890000
085200*-----------------------------------------------------------------08900000
085300*  THERE ARE 17 OCCURANCES AND THE MAKEUP OF THESE SHOULD BE:     08910000
085400*        OCCURANCE 1 - TNOW-WN + 2                                08920000
085500*        OCCURANCE 2 - TNOW-WN + 1                                08930000
085600*        OCCURANCE 3 - TNOW-WN                                    08940000
085700*        OCCURANCE 4 - TNOW-WN  OR IF UCYCLE = 4, TOTAL OF WEEKS I08950000
085800*                                  THE PERIOD ( 4 OR 5 WEEKS)     08960000
085900*        OCCURANCE 5 - TNOW-WN - 1                                08970000
086000*        OCCURANCE 6 - TNOW-WN - 2                                08980000
086100*        OCCURANCE 7 - TNOW-WN - 3                                08990000
086200*        OCCURANCE 8 - TNOW-WN - 4                                09000000
086300*        OCCURANCE 9 - TNOW-WN - 5                                09010000
086400*        OCCURANCE 10 - TNOW-WN - 6                               09020000
086500*        OCCURANCE 11 - TNOW-WN - 7                               09030000
086600*        OCCURANCE 12 - TNOW-WN - 8                               09040000
086700*        OCCURANCE 13 - TNOW-WN - 9                               09050000
086800*        OCCURANCE 14 - TNOW-WN - 10                              09060000
086900*        OCCURANCE 15 - TNOW-WN - 11                              09070000
087000*        OCCURANCE 16 - TNOW-WN - 12                              09080000
087100*        OCCURANCE 17 - TNOW-WN - 13                              09090000
087200******************************************************************09100000
087300 E300-LOAD-HISTLYS-QTY.                                           09110000
087400*                                                                 09120000
087500*    DISPLAY 'E300-LOAD-HISTLYS-QTY'.                             09130000
087600*                                                                 09140000
087700        MOVE ZEROES         TO  MR004O-HISTLYS(PV-HIST-SUB).      09150000
087800        ADD PC-1            TO  PV-HIST-SUB.                      09160000
087900*                                                                 09170000
088000*                                                                 09180000
088100******************************************************************09190000
088200*  MOVE VALUES INTO THE TRANSFER-RECORD LAYOUT FOR OUTPUT         09200000
088300******************************************************************09210000
088400 F000-FORMAT-TRAN-INPUT.                                          09220000
088500*                                                                 09230000
088600*    DISPLAY 'F000-FORMAT-TRAN-INPUT'.                            09240000
088700*                                                                 09250000
088800*                                                                 09260000
088900     MOVE PC-1                        TO PV-BIM-SUB,              09270000
089000                                         PV-WBI-SUB,              09280000
089100                                         PV-MBI-SUB,              09290000
089200                                         PV-BIM-SUB2.             09300000
089300     PERFORM F100-MOVE-BIM-AMOUNTS VARYING PV-BIM-SUB             09310000
089400             FROM 1 BY 1 UNTIL PV-BIM-SUB > PC-52.                09320000
089500     PERFORM F200-MOVE-MTHLY-BIM   VARYING PV-BIM-SUB2            09330000
089600             FROM 1 BY 1 UNTIL PV-BIM-SUB2 > PC-13.               09340000
089700     MOVE PV-CPS-QTY                  TO MR004O-CPS.              09350000
089800     MOVE TSKST-ONHAND-QTY            TO MR004O-OH.               09360000
089900     MOVE PV-OO                       TO MR004O-OO.               09370000
090000*                                                                 09380000
090100     MOVE TUPCSKU-UPC-NBR             TO MR004O-UPC.              09390000
090200*                                                                 09400000
090300******************************************************************09410000
090400*  MOVE WEEKLY AMOUNTS FROM THE BIM FILE TO THE TRANSFER RECORD   09420000
090500******************************************************************09430000
090600 F100-MOVE-BIM-AMOUNTS.                                           09440000
090700*                                                                 09450000
090800*    DISPLAY 'F100-MOVE-BIM-AMOUNTS'.                             09460000
090900*                                                                 09470000
091000     MOVE GBI-BI-WEEK(PV-BIM-SUB)     TO MR004O-WBI(PV-WBI-SUB).  09480000
091100*                                                                 09490000
091200     ADD PC-PLUS-1                    TO PV-WBI-SUB.              09500000
091300*                                                                 09510000
091400******************************************************************09520000
091500*  MOVE MONTHLY AMOUNTS FROM THE BIM FILE TO THE TRANSFER RECORD  09530000
091600******************************************************************09540000
091700 F200-MOVE-MTHLY-BIM.                                             09550000
091800*                                                                 09560000
091900*    DISPLAY 'F100-MOVE-MTHLY-BIM  '.                             09570000
092000*                                                                 09580000
092100     MOVE GBI-BI-MNTH(PV-BIM-SUB2)    TO MR004O-MBI(PV-MBI-SUB).  09590000
092200*                                                                 09600000
092300     ADD PC-PLUS-1                    TO PV-MBI-SUB.              09610000
092400*                                                                 09620000
092500*                                                                 09630000
092600******************************************************************09640000
092700*   MOVE APPROPRIATE FIELDS TO THE HEADER USER AREA FOR OUTPUT    09650000
092800******************************************************************09660000
092900 H000-FORMAT-ROH-USER-AREA.                                       09670000
093000*                                                                 09680000
093100*    DISPLAY 'H000-FORMAT-ROH-USER-AREA'.                         09690000
093200*                                                                 09700000
093300*    MOVE DMIVDRNM                    TO MR004O-H-VENDOR-NAME.    09710000
093400     MOVE ENTNME-ENT-NAME-DESC        TO MR004O-H-VENDOR-NAME.    09720000
093500     MOVE MDSEAR-BYR-NBR              TO MR004O-H-BUYER-ID.       09730000
093600     MOVE PV-BYR-NAME                 TO MR004O-H-BUYER-NAME.     09740000
093700*                                                                 09750000
093800******************************************************************09760000
093900*  THIS PARAGRAPH CALLS THE CALENDAR ROUTINE                      09770000
094000******************************************************************09780000
094100 I000-CALENDAR-ROUTINE.                                           09790000
094200*                                                                 09800000
094300*    DISPLAY 'I000-CALENDAR-ROUTINE'.                             09810000
094400*                                                                 09820000
094500     CALL PC-PGM-DPKUT500 USING DPG51 DPG52                       09830000
094600                                DPG53 DPG54                       09840000
094700                                DPG55 DPG56.                      09850000
094800     EVALUATE TRUE                                                09860000
094900     WHEN DPG54-SEVERE-ERROR                                      09870000
095000         DISPLAY 'SEVERE ERROR IN CALENDAR ROUTINE'               09880000
095100         DISPLAY DPG54-ERROR-MESSAGE                              09890000
095200         DISPLAY 'INPUT DATE: '  DPG52-LK-DATE-INPUT              09900000
095300         CALL 'ILBOABN0'        USING PV-ABEND-CODE               09910000
095400     WHEN DPG54-WARNING-ERROR                                     09920000
095500         DISPLAY 'WARNING ERROR IN CALENDAR ROUTINE'              09930000
095600         DISPLAY DPG54-ERROR-MESSAGE                              09940000
095700     WHEN DPG54-NO-ERROR                                          09950000
095800         CONTINUE                                                 09960000
095900     END-EVALUATE.                                                09970000
096000*                                                                 09980000
096100******************************************************************09990000
096200* THIS SECTION READS THE VSAM SYSTEM RECORD                      *10000000
096300******************************************************************10010000
096400 R000-READ-CONTROL-FILE.                                          10020000
096500*                                                                 10030000
096600*    DISPLAY 'R000-READ-CONTROL-FILE'.                            10040000
096700*                                                                 10050000
096800      READ IC-CONTROL-FILE INTO  SYSTEM-RECORD                    10060000
096900                                KEY IS ICCTL-KEY.                 10070000
097000*                                                                 10080000
097100     IF  PV-CONTROL-SUCCESSFUL OR                                 10090000
097200         PV-CONTROL-VERIFY                                        10100000
097300*       DISPLAY 'BPN-1: ' S-BPN(1)                                10110000
097400*       DISPLAY 'BPN-2: ' S-BPN(2)                                10120000
097500*       DISPLAY 'BPN-3: ' S-BPN(3)                                10130000
097600*       DISPLAY 'BPN-4: ' S-BPN(4)                                10140000
097700*       DISPLAY 'BPN-5: ' S-BPN(5)                                10150000
097800*       DISPLAY 'BPN-6: ' S-BPN(6)                                10160000
097900        CONTINUE                                                  10170000
098000     ELSE                                                         10180000
098100        MOVE 'R000-READ-CONTROL-FILE' TO PV-PARAGRAPH-NAME        10190000
098200        MOVE 'IC-CONTROL-FILE'        TO PV-ERROR-FILE            10200000
098300        MOVE 'READING INPUT FILE'     TO PV-ERROR-OPERATION       10210000
098400        MOVE 'BAD-READ'               TO PV-ERROR-STATUS          10220000
098500        MOVE  PV-CONTROL-STATUS       TO PV-VSAM-STATUS           10230000
098600        MOVE  ICCTL-KEY               TO PV-NOT-FOUND-KEY         10240000
098700            IF PV-NO-REC-FOUND                                    10250000
098800               PERFORM Z999-VSAM-ERROR                            10260000
098900               MOVE +4002  TO        PV-ABEND-CODE                10270000
099000               CALL 'ILBOABN0' USING PV-ABEND-CODE                10280000
099100            ELSE                                                  10290000
099200               PERFORM Z999-VSAM-ERROR                            10300000
099300               MOVE +4008         TO PV-ABEND-CODE                10310000
099400               CALL 'ILBOABN0' USING PV-ABEND-CODE                10320000
099500            END-IF                                                10330000
099600     END-IF.                                                      10340000
099700*                                                                 10350000
099800     ADD PC-PLUS-1 TO PV-SYSTEM-INPUT-CNT.                        10360000
099900*                                                                 10370000
100000 EJECT                                                            10380000
100100******************************************************************10390000
100200* THIS SECTION READS THE VSAM SYSTEM RECORD                      *10400000
100300******************************************************************10410000
100400 R100-READ-BIM-FILE.                                              10420000
100500*                                                                 10430000
100600*    DISPLAY 'R100-READ-BIM-FILE'.                                10440000
100700*                                                                 10450000
100800     READ BIM-FILE        INTO  PAN-BIM-FILE                      10460000
100900                                KEY IS BIM-FILE-KEY.              10470000
101000*                                                                 10480000
101100     IF  PV-BIM-SUCCESSFUL OR                                     10490000
101200         PV-BIM-VERIFY                                            10500000
101300        CONTINUE                                                  10510000
101400     ELSE                                                         10520000
101500        MOVE  PV-BIM-STATUS       TO PV-VSAM-STATUS               10530000
101600        MOVE  SPACES              TO PV-NOT-FOUND-KEY             10540000
101700            IF PV-NO-REC-FOUND                                    10550000
101800               CONTINUE                                           10560000
101900*              DISPLAY '** MESSAGE IS '                           10570000
102000*              'RECORD NOT FOUND, STATUS IS ' PV-VSAM-STATUS      10580000
102100*              ' BIM KEY: ' GBI-KEY-PTAG                          10590000
102200            ELSE                                                  10600000
102300               MOVE 'R100-READ-BIM-FILE' TO PV-PARAGRAPH-NAME     10610000
102400               MOVE 'BIM-FILE'           TO PV-ERROR-FILE         10620000
102500               MOVE 'READING INPUT FILE' TO PV-ERROR-OPERATION    10630000
102600               MOVE 'BAD-READ'           TO PV-ERROR-STATUS       10640000
102700               MOVE  GBI-KEY-PTAG        TO PV-NOT-FOUND-KEY      10650000
102800               PERFORM Z999-VSAM-ERROR                            10660000
102900               MOVE +4008           TO PV-ABEND-CODE              10670000
103000               CALL 'ILBOABN0'   USING PV-ABEND-CODE              10680000
103100            END-IF                                                10690000
103200     END-IF.                                                      10700000
103300*                                                                 10710000
103400     ADD PC-PLUS-1 TO PV-SYSTEM-INPUT-CNT.                        10720000
103500*                                                                 10730000
103600 EJECT                                                            10740000
103700******************************************************************10750000
103800* THIS SECTION READS THE VSAM SYSTEM RECORD                      *10760000
103900******************************************************************10770000
104000 R200-READ-TRANS-REC-IN.                                          10780000
104100*                                                                 10790000
104200*    DISPLAY 'R200-READ-TRANS-REC-IN'.                            10800000
104300*                                                                 10810000
104400     READ TRANSFER-RECORD-IN INTO  PV-INPUT                       10820000
104500       AT END MOVE PC-Y TO PS-EOF-TRANS-REC.                      10830000
104600*                                                                 10840000
104700     ADD PC-PLUS-1 TO PV-TRANS-INPUT-CNT.                         10850000
104800*                                                                 10860000
104900 EJECT                                                            10870000
105000******************************************************************10880000
105100*  THIS PARAGRAPH SUMS THE CURRENT PERIOD SALES FOR LYS WHEN     *10890000
105200*  THE UCYCLE CODE = 4(MONTHLY)                                  *10900000
105300******************************************************************10910000
105400 S600-SUM-CPS-QTY.                                                10920000
105500*                                                                 10930000
105600*    DISPLAY 'S600-SUM-CPS-QTY'.                                  10940000
105700*                                                                 10950000
105800     MOVE 'S600'                   TO PGM-LOCATION.               10960000
105900     MOVE 'S600-SUM-CPS-QTY        '                              10970000
106000                                   TO PV-ABEND-PARAGRAPH.         10980000
106100                                                                  10990000
106100                                                                  11000000
106200     INITIALIZE SKSTWKS-SALES-UNIT-QTY.                           11010000
106300     MOVE MR017-ITEM-NBR TO SKSTWKS-ITEM-NMBR.                    11020000
106400     MOVE MR017-STR-NBR  TO SKSTWKS-STR-NBR.                      11030000
 06400*    MOVE MR017-STR-NBR  TO PV-9-5                                11040000
106400*    MOVE PV-X-3         TO SKSTWKS-STORE-NMBR.                   11050000
106500*    DISPLAY 'ITEM NBR: ' SKSTWKS-ITEM-NMBR.                      11060000
106600*    DISPLAY 'STORE NBR: ' SKSTWKS-STORE-NMBR.                    11070000
106700*    DISPLAY 'MIN WEEK: ' PV-TSKSTWKS-MIN-DTE.                    11080000
106800*    DISPLAY 'MAX WEEK: ' PV-TSKSTWKS-MAX-DTE.                    11090000
106900                                                                  11100000
107000*    DISPLAY 'MIN DATE: ' PV-TSKSTWKS-MIN-DTE                     11110004
107100*    DISPLAY 'MAX DATE: ' PV-TSKSTWKS-MAX-DTE                     11120004
107200*                                                                 11130000
107300     EXEC SQL                                                     11140000
107400         SELECT SUM(SALES_UNIT_QTY)                               11150000
107500           INTO :SKSTWKS-SALES-UNIT-QTY                           11160000
107600                :PV-NULL-HISTCPS-QTY                              11170000
107700           FROM TSKSTWKS                                          11180000
107800          WHERE FSCL_BOW_DTE BETWEEN :PV-TSKSTWKS-MIN-DTE         11190000
107900                               AND  :PV-TSKSTWKS-MAX-DTE          11200000
108000            AND ITEM_NMBR = :SKSTWKS-ITEM-NMBR                    11210000
108100            AND STR_NBR  = :SKSTWKS-STR-NBR                       11220000
108200     END-EXEC.                                                    11230000
108300                                                                  11240000
108400     EVALUATE TRUE                                                11250000
108500       WHEN SQLCODE         = ZERO                                11260000
108600       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    11270000
108700         CONTINUE                                                 11280000
108800       WHEN OTHER                                                 11290000
108900         DISPLAY PV-ABEND-PARAGRAPH                               11300000
109000         PERFORM Z999-SQL-ERROR                                   11310000
109100     END-EVALUATE.                                                11320000
109200*                                                                 11330000
109300******************************************************************11340000
109400* THIS PARAGRAPH SELECTS THE UPC NUMBER FOR OUTPUT               *11350000
109500******************************************************************11360000
109600 T000-SELECT-UPC-NUMBER.                                          11370000
109700*                                                                 11380000
109800*    DISPLAY 'T000-SELECT-UPC-NUMBER'.                            11390000
109900*                                                                 11400000
110000     MOVE 'T000'                   TO PGM-LOCATION.               11410000
110100     MOVE 'T000-SELECT-UPC-NUMBER'                                11420000
110200                                   TO PV-ABEND-PARAGRAPH.         11430000
110300     MOVE MR017-ITEM-NBR TO TUPCSKU-ITEM-NBR.                     11440000
110400     ADD  PC-1           TO PV-ITEM-COUNT.                        11450000
110500     MOVE PC-Y TO TUPCSKU-EDI-ORD-IND                             11460000
110600*                                                                 11470000
110700     EXEC SQL                                                     11480000
110800       SELECT UPC_NBR                                             11490000
110900         INTO :TUPCSKU-UPC-NBR                                    11500000
111000         FROM TUPCSKU                                             11510000
111100        WHERE ITEM_NBR = :TUPCSKU-ITEM-NBR                        11520000
111200          AND EDI_ORD_IND = :TUPCSKU-EDI-ORD-IND                  11530000
111300     END-EXEC.                                                    11540000
111400*                                                                 11550000
111500     EVALUATE TRUE                                                11560000
111600       WHEN SQLCODE         = ZERO                                11570000
111700         CONTINUE                                                 11580000
111800       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    11590000
111900         MOVE ZEROES TO TUPCSKU-UPC-NBR                           11600000
112000       WHEN OTHER                                                 11610000
112100         DISPLAY PV-ABEND-PARAGRAPH                               11620000
112200         DISPLAY 'ITEM NBR: ' TUPCSKU-ITEM-NBR                    11630000
112300         DISPLAY 'UPC NBR: ' TUPCSKU-UPC-NBR                      11640000
112400         PERFORM Z999-SQL-ERROR                                   11650000
112500     END-EVALUATE.                                                11660000
112600*                                                                 11670000
112700 EJECT                                                            11680000
112800******************************************************************11690000
112900*  THIS PARAGRAPH SELECTS THE ON-HAND QUANTITY FOR OUTPUT        *11700000
113000******************************************************************11710000
113100 T100-SELECT-ONHAND-QTY.                                          11720000
113200*                                                                 11730000
113300*    DISPLAY 'T100-SELECT-ONHAND-QTY'.                            11740000
113400*                                                                 11750000
113500     MOVE 'T100'                   TO PGM-LOCATION.               11760000
113600     MOVE 'T100-SELECT-ONHAND-QTY'                                11770000
113700                                   TO PV-ABEND-PARAGRAPH.         11780000
113800     MOVE MR017-ITEM-NBR TO TSKST-ITEM-NMBR.                      11790000
113900     MOVE MR017-STR-NBR  TO TSKST-LOC-NBR                         11800000
114000*                                                                 11810000
114100     IF MR017-STR-NBR EQUAL PC-CORPORATE-STORE                    11820000
114200         PERFORM T110-SUM-ONHAND-QTY                              11830000
114300     ELSE                                                         11840000
114400         PERFORM T120-SELECT-ONHAND-QTY                           11850000
114500     END-IF.                                                      11860000
114600*                                                                 11870000
114700******************************************************************11880000
114800*  THIS PARAGRAPH SUMS THE ON-HAND QUANTITY FOR THE CORPORATE STR*11890000
114900******************************************************************11900000
115000 T110-SUM-ONHAND-QTY.                                             11910000
115100*                                                                 11920000
115200*    DISPLAY 'T110-SUM-ONHAND-QTY'.                               11930000
115300*                                                                 11940000
115400     MOVE 'T110'                   TO PGM-LOCATION.               11950000
115500     MOVE 'T110-SUM-ONHAND-QTY'                                   11960000
115600                                   TO PV-ABEND-PARAGRAPH.         11970000
115700*                                                                 11980000
115800     EXEC SQL                                                     11990000
115900       SELECT SUM(ONHAND_QTY)                                     12000000
116000         INTO :TSKST-ONHAND-QTY                                   12010000
116100         FROM TSKST   A,                                          12020000
116200              TMRITST B                                           12030000
116300        WHERE ITEM_NMBR  = :TSKST-ITEM-NMBR                       12040000
116400          AND A.ITEM_NMBR  = B.ITEM_NBR                           12050000
116500          AND A.LOC_NBR    = B.STR_NBR                            12060000
116600          AND A.LOC_NBR    <>  0                                  12070000
116700          AND A.ONHAND_QTY > 0                                    12080000
116800     END-EXEC.                                                    12090000
116900*                                                                 12100000
117000     EVALUATE TRUE                                                12110000
117100       WHEN SQLCODE         = ZERO                                12120000
117200            IF TSKST-ONHAND-QTY < ZERO                            12130000
117300               MOVE ZERO TO TSKST-ONHAND-QTY                      12140000
117400            END-IF                                                12150000
117500       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    12160000
117600       WHEN SQLCODE         = -305                                12170000
117700         MOVE ZEROES        TO TSKST-ONHAND-QTY                   12180000
117800       WHEN OTHER                                                 12190000
117900         DISPLAY PV-ABEND-PARAGRAPH                               12200000
118000         PERFORM Z999-SQL-ERROR                                   12210000
118100     END-EVALUATE.                                                12220000
118200*                                                                 12230000
118300******************************************************************12240000
118400*  THIS PARAGRAPH SELECTS THE ON-HAND QUANTITY FOR OUTPUT        *12250000
118500******************************************************************12260000
118600 T120-SELECT-ONHAND-QTY.                                          12270000
118700*                                                                 12280000
118800*    DISPLAY 'T120-SELECT-ONHAND-QTY'.                            12290000
118900*                                                                 12300000
119000     MOVE 'T120'                   TO PGM-LOCATION.               12310000
119100     MOVE 'T120-SELECT-ONHAND-QTY'                                12320000
119200                                   TO PV-ABEND-PARAGRAPH.         12330000
119300*                                                                 12340000
119400     EXEC SQL                                                     12350000
119500       SELECT ONHAND_QTY                                          12360000
119600         INTO :TSKST-ONHAND-QTY                                   12370000
119700         FROM TSKST                                               12380000
119800        WHERE ITEM_NMBR  = :TSKST-ITEM-NMBR                       12390000
119900          AND LOC_NBR    = :TSKST-LOC-NBR                         12400000
120000     END-EXEC.                                                    12410000
120100*                                                                 12420000
120200     EVALUATE TRUE                                                12430000
120300       WHEN SQLCODE         = ZERO                                12440000
120400            IF TSKST-ONHAND-QTY < ZERO                            12450000
120500               MOVE ZERO TO TSKST-ONHAND-QTY                      12460000
120600            END-IF                                                12470000
120700       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    12480000
120800         MOVE ZEROES        TO TSKST-ONHAND-QTY                   12490000
120900       WHEN OTHER                                                 12500000
121000         DISPLAY PV-ABEND-PARAGRAPH                               12510000
121100         PERFORM Z999-SQL-ERROR                                   12520000
121200     END-EVALUATE.                                                12530000
121300*                                                                 12540000
121400 T150-DATE-ROUTINE.                                               12550000
121500******************************************************************12560000
121600*  THIS PARAGRAPH SELECTS THE SALES UNIT QUANTITY FOR OUTPUT     *12570000
121700******************************************************************12580000
121800*                                                                 12590000
121900*  THIS COMPARES S-TNOW-WN (THE INPUT WEEK #) TO THE SYSTEM RUN   12600000
122000*  DATE WEEK # IN THE F2 CALENDAR.                                12610000
122100*                                                                 12620000
122200*  IF THE INPUT WEEK # IS GREATER THAN THE RUN WEEK # THEN THE    12630000
122300*  INPUT IS FROM THE PREVIOUS YEAR.                               12640000
122400*                                                                 12650000
122500*  CALL THE CALENDAR ROUTINE TO GET THE FIRST DAY OF THE PREVIOUS 12660000
122600*  YEAR.                                                          12670000
122700*                                                                 12680000
122800******************************************************************12690000
122900                                                                  12700000
123000     MOVE PV-TODAYS-DATE TO PV-FIRST-DATE.                        12710000
123100                                                                  12720000
123200     IF S-TNOW-WN > PV-TODAYS-WEEK                                12730000
123300            MOVE '01'  TO  PV-FIRST-MO                            12740000
123400            MOVE '01'  TO  PV-FIRST-DY                            12750000
123500            MOVE PV-FIRST-DATE TO DPG52-LK-DATE-INPUT             12760000
123600                                                                  12770000
123700            MOVE PC-F2               TO DPG51-CALENDAR-TYPE       12780000
123800                                                                  12790000
123900            SET DPG52-LK-DTE-GREG-FMT TO TRUE                     12800000
124000                                                                  12810000
124100            MOVE SPACES TO DPG51-INCREMENT-DECREMENT-FLAG         12820000
124200                                                                  12830000
124300            PERFORM I000-CALENDAR-ROUTINE                         12840000
124400                                                                  12850000
124500            MOVE DPG56-FIRST-FD-GREG-FMT TO PV-FIRST-DATE         12860000
124600                                                                  12870000
124700     END-IF.                                                      12880000
124800                                                                  12890000
124900******************************************************************12900000
125000*                                                                 12910000
125100*  THE INPUT TO THIS ROUTINE IS EITHER THE FIRST DATE OF THE      12920000
125200*  CURRENT YEAR OR THE FIRST DATE OF THE PREVIOUS YEAR DEPENDING  12930000
125300*  ON THE PREVIOUS WEEK # COMPARISONS.                            12940000
125400*                                                                 12950000
125500*  THIS CALL TO THE CALENDAR ROUTINE WILL INCREMENT OUT THE # OF  12960000
125600*  WEEKS - 1 TO GIVE A WEEK NUMBER IN F2 FOR LATER CONVERSION.    12970000
125700******************************************************************12980000
125800                                                                  12990000
125900     MOVE PV-FIRST-DATE TO DPG52-LK-DATE-INPUT.                   13000000
126000                                                                  13010000
126100     SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           13020000
126200     MOVE PC-F2               TO DPG51-CALENDAR-TYPE.             13030000
126300                                                                  13040000
126400     COMPUTE DPG51-INCR-DECR-DAYS-9 = ( S-TNOW-WN - 1 ) * 7 +     13050000
126500                                      ( S-TNOW-DN - 1 ).          13060000
126600                                                                  13070000
126700     SET DPG51-INCREMENT-DATE TO TRUE.                            13080000
126800                                                                  13090000
126900     PERFORM I000-CALENDAR-ROUTINE.                               13100000
127000                                                                  13110000
127100     MOVE DPG55-GREG-DATE-FMT  TO PV-TODAYS-DATE.                 13120000
127200                                                                  13130000
127300******************************************************************13140000
127400* RETRIEVE THE NBR OF FISCAL PERIOD WEEKS FOR THE PREVIOUS MONTH  13150000
127500* IN THE F4 CALENDAR AND USE THE FIRST FISCAL PERIOD DATE AS THE  13160000
127600* MIN BOW DATE.                                                   13170000
127700******************************************************************13180000
127800                                                                  13190000
127900     MOVE DPG56-FIRST-FP-GREG-FMT                                 13200000
128000                        TO DPG52-LK-DATE-INPUT.                   13210000
128100                                                                  13220000
128200     SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           13230000
128300     MOVE PC-F4               TO DPG51-CALENDAR-TYPE.             13240000
128400                                                                  13250000
128500     MOVE PC-7   TO DPG51-INCR-DECR-DAYS-9.                       13260000
128600     SET DPG51-DECREMENT-DATE TO TRUE.                            13270000
128700                                                                  13280000
128800     PERFORM I000-CALENDAR-ROUTINE.                               13290000
128900                                                                  13300000
129000     MOVE DPG56-NBR-FISCAL-PERIOD-WEEKS                           13310000
129100                                TO PV-F4-NBR-FISCAL-PERIOD-WKS.   13320000
129200     MOVE DPG56-FIRST-FP-DB2-ISO-FMT                              13330000
129300                                TO PV-MIN-BOW-DATE.               13340000
129400                                                                  13350000
129500******************************************************************13360000
129600* RETRIEVE THE MAXIMUM BOW DATE AS AN OFFSET OF THE MIN BOW DATE  13370000
129700******************************************************************13380000
129800                                                                  13390000
129900     MOVE DPG56-FIRST-FP-DB2-ISO-FMT                              13400000
130000                              TO DPG52-LK-DATE-INPUT.             13410000
130100     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            13420000
130200     MOVE PC-A0               TO DPG51-CALENDAR-TYPE.             13430000
130300                                                                  13440000
130400     COMPUTE DPG51-INCR-DECR-DAYS-9 =                             13450000
130500           (PV-F4-NBR-FISCAL-PERIOD-WKS - 1 ) * 7.                13460000
130600                                                                  13470000
130700     SET DPG51-INCREMENT-DATE TO TRUE.                            13480000
130800                                                                  13490000
130900     PERFORM I000-CALENDAR-ROUTINE.                               13500000
131000                                                                  13510000
131100     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-MAX-BOW-DATE.              13520000
131200                                                                  13530000
131300******************************************************************13540000
131400* RETRIEVE THE MIN WEEK NUMBER TO BE USED FOR MONTHLY CPS SALES   13550000
131500******************************************************************13560000
131600***   THE NEXT DATE ROUTINE CALL IS COMMENTED OUT BECAUSE         13570000
131700***   IT IS NO LONGER NEEDED.                                     13580000
131800*                                                                 13590000
131900*    MOVE DPG56-FIRST-FP-GREG-FMT TO DPG52-LK-DATE-INPUT.         13600000
132000*    SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           13610000
132100*    MOVE PC-F4               TO DPG51-CALENDAR-TYPE.             13620000
132200*                                                                 13630000
132300*    MOVE ZEROES TO DPG51-INCR-DECR-DAYS-9.                       13640000
132400*    MOVE SPACES TO DPG51-INCREMENT-DECREMENT-FLAG.               13650000
132500*                                                                 13660000
132600*    PERFORM I000-CALENDAR-ROUTINE.                               13670000
132700*                                                                 13680000
132800*    MOVE DPG56-FISCAL-WEEK-NBR                                   13690000
132900*                               TO PV-MIN-WEEK.                   13700000
133000*    MOVE DPG56-FISCAL-YEAR-NBR TO PV-MIN-YR                      13710000
133100*                                  PV-MAX-YR                      13720000
133200*                                                                 13730000
133300******************************************************************13740000
133400*                                                                 13750000
133500*  THE INPUT TO THIS ROUTINE IS AN F2 WEEK NUMBER AND YEAR. THIS  13760000
133600*  IS TO BE CONVERTED TO THE F4 WEEK NUMBER FOR COMPARISON TO THE 13770000
133700*  SALES/HISTORY TABLE.                                           13780000
133800*                                                                 13790000
133900*  THE OUTPUT F4 WEEK NUMBER IS TO BE USED FOR THE CALCULATION OF 13800000
134000*  THE MINIMIUM AND MAXIMIUM WEEKS.                               13810000
134100******************************************************************13820000
134200***   THE NEXT DATE ROUTINE CALL IS COMMENTED OUT BECAUSE         13830000
134300***   PV-F4-NBR-FISCAL-WEEKS IS NO LONGER BEING USED.             13840000
134400*                                                                 13850000
134500*    MOVE PV-TODAYS-DATE       TO DPG52-LK-DATE-INPUT.            13860000
134600*                                                                 13870000
134700*    MOVE PC-F4                TO DPG51-CALENDAR-TYPE.            13880000
134800*                                                                 13890000
134900*    SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           13900000
135000*                                                                 13910000
135100*    MOVE SPACES TO DPG51-INCREMENT-DECREMENT-FLAG.               13920000
135200*                                                                 13930000
135300*    PERFORM I000-CALENDAR-ROUTINE.                               13940000
135400*                                                                 13950000
135500*    MOVE DPG56-NBR-FISCAL-WEEKS TO PV-F4-NBR-FISCAL-WEEKS.       13960000
135600*                                                                 13970000
135700******************************************************************13980000
135800*   END                                                           13990000
135900*                                                                 14000000
136000 T155-UCYCLE-CALENDAR-ROUTINE.                                    14010000
136100******************************************************************14020000
136200*                                                                *14030000
136300******************************************************************14040000
136400                                                                  14050000
136500*    DISPLAY 'T155-UCYCLE-CALENDAR-ROUTINE'.                      14060000
136600*    DISPLAY 'FIRST DATE: ' PV-FIRST-DATE                         14070000
136700     MOVE PV-FIRST-DATE TO DPG52-LK-DATE-INPUT.                   14080000
136800                                                                  14090000
136900     SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           14100000
137000     MOVE PC-A0               TO DPG51-CALENDAR-TYPE.             14110000
137100*    MOVE PC-F2               TO DPG51-CALENDAR-TYPE.             14120000
137200*                                                                 14130000
137300*    DISPLAY 'BPN: ' S-BPN(PV-BPN-SUB).                           14140000
137400*    DISPLAY 'BPN SUB: ' PV-BPN-SUB.                              14150000
137500*                                                                 14160000
137600*    DISPLAY 'PV-CALC-DAYS 'PV-CALC-DAYS.                         14170003
      ***                                                               14180003
      ***LF  SUBTRACT 1 FROM WEEK NBR (INSTEAD OF 2) TO BASE THE DATE   14190004
      ***LF  ON CURRENT WEEK                                            14200004
      ***                                                               14210003
137700     COMPUTE PV-CALC-DAYS = ((S-TNOW-WN - 1) * 7) +               14220001
137800                             (S-TNOW-DN - 1).                     14230000
137900                                                                  14240000
138000* *** ###                                                         14250000
138100     IF PV-CALC-DAYS IS NEGATIVE                                  14260000
138200* ***IF PV-CALC-DAYS <  0                                         14270000
138300       COMPUTE PV-CALC-DAYS-POSITIVE = ((PV-CALC-DAYS) * (-1))    14280000
138400       MOVE PV-CALC-DAYS-POSITIVE TO DPG51-INCR-DECR-DAYS-9       14290000
138500     ELSE                                                         14300000
138600       MOVE PV-CALC-DAYS TO DPG51-INCR-DECR-DAYS-9                14310000
138700     END-IF.                                                      14320000
138800                                                                  14330000
138900                                                                  14340000
139000     IF PV-CALC-DAYS > 0                                          14350000
139100         SET DPG51-INCREMENT-DATE TO TRUE                         14360000
139200     ELSE                                                         14370000
139300         SET DPG51-DECREMENT-DATE TO TRUE                         14380000
139400     END-IF.                                                      14390000
139500                                                                  14400000
139600     PERFORM I000-CALENDAR-ROUTINE.                               14410000
139700                                                                  14420000
139800     MOVE DPG55-1ST-WKDY-DB2ISO-FMT                               14430000
139900                                TO PV-UCYCLE-MAX-DATE.            14440000
140000                                                                  14450000
140100*****************************************************             14460000
140200***   THE NEXT DATE ROUTINE CALL IS COMMENTED OUT BECAUSE         14470000
140300***   IT IS NO LONGER NEEDED.                                     14480000
140400*    MOVE DPG55-GREG-DATE-FMT   TO DPG52-LK-DATE-INPUT.           14490000
140500*    SET DPG52-LK-DTE-GREG-FMT  TO TRUE.                          14500000
140600*    MOVE PC-F4                 TO DPG51-CALENDAR-TYPE.           14510000
140700*    MOVE SPACES TO DPG51-INCREMENT-DECREMENT-FLAG.               14520000
140800*    MOVE ZEROES TO DPG51-INCR-DECR-DAYS-9.                       14530000
140900*    PERFORM I000-CALENDAR-ROUTINE.                               14540000
141000*                                                                 14550000
141100*    MOVE DPG56-FISCAL-WEEK-NBR TO PV-UCYCLE-MAX-WK.              14560000
141200*    MOVE DPG56-FISCAL-YEAR-NBR TO PV-UCYCLE-MAX-YR.              14570000
141300*****************************************************             14580000
141400                                                                  14590000
141500     COMPUTE PV-MIN-DATE-CALC-DAYS =                              14600000
141600           ((S-BPN(PV-BPN-SUB) - 1) * 7 ) + (S-TNOW-DN - 1 ).     14610000
141700*    DISPLAY 'PV-MIN-DATE-CALC-DAYS 'PV-MIN-DATE-CALC-DAYS.       14620000
142800                                                                  14630000
142900     IF PV-MIN-DATE-CALC-DAYS > PV-CALC-DAYS                      14640000
143000*      GET THE NUMBER OF DAYS IN THE PREVIOUS FISCAL YEAR IN      14650000
143100*      ORDER TO SUBTRACT THAT NUMBER OF DAYS FROM PV-MIN-DATE-    14660000
143200*      CALC-DAYS TO GET THE CORRECT MINIMUM DATE CALC DAYS        14670000
143300         INITIALIZE            DPG51 DPG52                        14680000
143400                               DPG53 DPG54                        14690000
143500                               DPG55 DPG56                        14700000
143600         MOVE SPACES           TO DPG52-LK-DATE-INPUT             14710000
143700         MOVE PV-FIRST-YR      TO DPG52-FISCAL-PRD-YR             14720000
143800         MOVE 1                TO DPG52-FISCAL-PRD-PP             14730000
143900         SET DPG52-LK-DTE-FISC-PRD TO TRUE                        14740000
144000         MOVE PC-F4            TO DPG51-CALENDAR-TYPE             14750000
144100         SET DPG51-DECREMENT-DATE TO TRUE                         14760000
144200         MOVE 1                TO DPG51-INCR-DECR-FISCAL-PRD-9    14770000
144300         PERFORM I000-CALENDAR-ROUTINE                            14780000
144400         COMPUTE PV-MIN-DATE-CALC-DAYS = PV-MIN-DATE-CALC-DAYS -  14790000
144500           (DPG56-NBR-FISCAL-WEEKS * 7 )                          14800000
144600     END-IF.                                                      14810000
144700                                                                  14820000
144800         INITIALIZE            DPG51 DPG52                        14830000
144900                               DPG53 DPG54                        14840000
145000                               DPG55 DPG56.                       14850000
145100                                                                  14860000
145200     MOVE PV-FIRST-DATE TO DPG52-LK-DATE-INPUT.                   14870000
145300                                                                  14880000
145400     SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           14890000
145500     MOVE PC-A0               TO DPG51-CALENDAR-TYPE.             14900000
145600**   MOVE PC-F2               TO DPG51-CALENDAR-TYPE.             14910000
145700                                                                  14920000
145800* ###                                                             14930000
145900     IF PV-MIN-DATE-CALC-DAYS IS NEGATIVE                         14940000
146000        COMPUTE PV-MIN-DATE-CALC-DAYS-POSI =                      14950000
146100        ((PV-MIN-DATE-CALC-DAYS) * (-1))                          14960000
146200          MOVE PV-MIN-DATE-CALC-DAYS-POSI                         14970000
146300             TO DPG51-INCR-DECR-DAYS-9                            14980000
146400     ELSE                                                         14990000
146500        MOVE PV-MIN-DATE-CALC-DAYS TO DPG51-INCR-DECR-DAYS-9      15000000
146600     END-IF.                                                      15010000
146700                                                                  15020000
146800     IF PV-MIN-DATE-CALC-DAYS > 0                                 15030000
146900         SET DPG51-INCREMENT-DATE TO TRUE                         15040000
147000     ELSE                                                         15050000
147100         SET DPG51-DECREMENT-DATE TO TRUE                         15060000
147200     END-IF.                                                      15070000
147300                                                                  15080000
147400     PERFORM I000-CALENDAR-ROUTINE.                               15090000
147500                                                                  15100000
147600     MOVE DPG55-1ST-WKDY-DB2ISO-FMT                               15110000
147700                                TO PV-UCYCLE-MIN-DATE.            15120000
147800                                                                  15130000
147900*****************************************************             15140000
148000***   THE NEXT DATE ROUTINE CALL IS COMMENTED OUT BECAUSE         15150000
148100***   IT IS NO LONGER NEEDED.                                     15160000
148200*    MOVE DPG55-GREG-DATE-FMT TO DPG52-LK-DATE-INPUT.             15170000
148300*    SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           15180000
148400*    MOVE PC-F4               TO DPG51-CALENDAR-TYPE.             15190000
148500*    MOVE SPACES TO DPG51-INCREMENT-DECREMENT-FLAG.               15200000
148600*    MOVE ZEROES TO DPG51-INCR-DECR-DAYS-9.                       15210000
148700*    PERFORM I000-CALENDAR-ROUTINE.                               15220000
148800*                                                                 15230000
148900*    MOVE DPG56-FISCAL-WEEK-NBR TO PV-UCYCLE-MIN-WK.              15240000
149000*    MOVE DPG56-FISCAL-YEAR-NBR TO PV-UCYCLE-MIN-YR.              15250000
149100                                                                  15260000
149200*    IF PV-UCYCLE-MIN-YR >  PV-UCYCLE-MAX-YR                      15270000
149300*        MOVE PV-UCYCLE-MAX-YR TO PV-UCYCLE-MIN-YR                15280000
149400*    END-IF.                                                      15290000
149500*****************************************************             15300000
149600                                                                  15310000
149700 EJECT                                                            15320000
149800******************************************************************15330000
149900*  THIS PARAGRAPH SELECTS THE PO RECORD FOR ON-ORDER QUANTITY    *15340000
150000*  BASED ON SKU.                                                 *15350000
150100******************************************************************15360000
150200 T300-SELECT-PO-RECORD.                                           15370000
150300*                                                                 15380000
150400*    DISPLAY 'T300-SELECT-PO-RECORD'.                             15390000
150500*                                                                 15400000
150600     MOVE 'T300'                   TO PGM-LOCATION.               15410000
150700     MOVE 'T300-SELECT-PO-RECORD'                                 15420000
150800                                   TO PV-ABEND-PARAGRAPH.         15430000
150900*                                                                 15440000
151000*    DISPLAY 'ON-ORD-SKU: ' SKSTOO-SKU-SEQ-NBR.                   15450000
151100*                                                                 15460000
151500     IF MR017-STR-NBR EQUAL PC-CORPORATE-STORE                    15470000
151600        PERFORM T350-ACCUM-CORP-OO-TOTAL                          15480000
151700     ELSE                                                         15490000
151800        PERFORM T360-ACCUM-STORE-OO-TOTAL                         15500000
151900     END-IF.                                                      15510000
152000*                                                                 15520000
152100*                                                                 15530000
152200 EJECT                                                            15540000
152300******************************************************************15550000
152400*  THIS PARAGRAPH SELECTS THE TOTAL ONORDER AT THE CORP LEVEL    *15560000
152500******************************************************************15570000
152600 T350-ACCUM-CORP-OO-TOTAL.                                        15580000
152700*                                                                 15590000
152800     MOVE 'T350'                   TO PGM-LOCATION.               15600000
152900     MOVE 'T350-ACCUM-CORP-OO-TOTAL'                              15610000
153000                                   TO PV-ABEND-PARAGRAPH.         15620000
153100     MOVE ZEROS               TO PV-OO                            15630000
153200     MOVE MR017-ITEM-NBR TO SKSTOO-ITM-NBR.                       15640000
153300     EXEC SQL                                                     15650000
153400        SELECT SUM(ONORD_UNT_QTY)                                 15660000
153500        INTO :PV-OO:PV-NULL-OO                                    15670000
153600        FROM TSKSTOO A                                            15680000
153700            , XMT_LOC B                                           15690000
153800        WHERE A.STR_NBR    =   B.LOC_NBR                          15700000
153900        AND B.LOC_TYP_CDE  =   'DS'                               15710000
154000        AND A.ITM_NBR          =   :SKSTOO-ITM-NBR                15720000
154100     END-EXEC.                                                    15730000
154200*                                                                 15740000
154300     EVALUATE TRUE                                                15750000
154400       WHEN SQLCODE         = ZERO                                15760000
154500         CONTINUE                                                 15770000
154600       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    15780000
154700          IF PV-NULL-OO = -1                                      15790000
154800             MOVE 0 TO PV-OO                                      15800000
154900          END-IF                                                  15810000
155000       WHEN OTHER                                                 15820000
155100         DISPLAY '**** ABEND ****'                                15830000
155200         DISPLAY '**** PROGRAM   = MRKUT141 ****'                 15840002
155300         DISPLAY '**** PARAGRAPH = T350-ACCUM-  '                 15850000
155400         DISPLAY '**** INVALID SELECT SUM ON TSKSTOO    '         15860000
155500         DISPLAY '**** ITEM-NBR  = ' MR017-ITEM-NBR               15870000
155600         DISPLAY PV-ABEND-PARAGRAPH                               15880000
155700         PERFORM Z999-SQL-ERROR                                   15890000
155800     END-EVALUATE.                                                15900000
155900 EJECT                                                            15910000
156000******************************************************************15920000
156100*  THIS PARAGRAPH SELECTS THE TOTAL ONORDER AT THE STORE LEVEL   *15930000
156200******************************************************************15940000
156300 T360-ACCUM-STORE-OO-TOTAL.                                       15950000
156400*                                                                 15960000
156500     MOVE 'T360'                   TO PGM-LOCATION.               15970000
156600     MOVE 'T360-ACCUM-STORE-OO-TOTAL'                             15980000
156700                                   TO PV-ABEND-PARAGRAPH.         15990000
156800     MOVE ZEROS               TO PV-OO                            16000000
156900     MOVE MR017-ITEM-NBR TO SKSTOO-ITM-NBR.                       16010000
157000     MOVE MR017-STR-NBR TO  XMT00001-LOC-NBR                      16020000
157100     EXEC SQL                                                     16030000
157200        SELECT SUM(ONORD_UNT_QTY)                                 16040000
157300        INTO :PV-OO:PV-NULL-OO                                    16050000
157400        FROM TSKSTOO A,                                           16060000
157500             XMT_LOC B                                            16070000
157600        WHERE A.STR_NBR    =   B.LOC_NBR                          16080000
157700        AND B.LOC_TYP_CDE  =   'DS'                               16090000
157800        AND B.LOC_NBR      =   :XMT00001-LOC-NBR                  16100000
157900        AND A.ITM_NBR      =   :SKSTOO-ITM-NBR                    16110000
158000     END-EXEC.                                                    16120000
158100*                                                                 16130000
158200     EVALUATE TRUE                                                16140000
158300       WHEN SQLCODE         = ZERO                                16150000
158400         CONTINUE                                                 16160000
158500       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    16170000
158600          IF PV-NULL-OO = -1                                      16180000
158700             MOVE 0 TO PV-OO                                      16190000
158800          END-IF                                                  16200000
158900       WHEN OTHER                                                 16210000
159000         DISPLAY '**** ABEND ****'                                16220000
159100         DISPLAY '**** PROGRAM   = MRKUT141 ****'                 16230002
159200         DISPLAY '**** PARAGRAPH = T360-ACCUM-  '                 16240000
159300         DISPLAY '**** INVALID SELECT SUM ON TSKSTOO    '         16250000
159400         DISPLAY '**** ITEM-NBR  = ' MR017-ITEM-NBR               16260000
159500         DISPLAY PV-ABEND-PARAGRAPH                               16270000
159600         PERFORM Z999-SQL-ERROR                                   16280000
159700     END-EVALUATE.                                                16290000
159800 EJECT                                                            16300000
159900                                                                  16310000
160000*  THIS PARAGRAPH SELECTS THE VENDOR NAME FOR OUTPUT             *16320000
160100******************************************************************16330000
160200 T700-SELECT-VENDOR-NAME.                                         16340000
160300*                                                                 16350000
160400*    DISPLAY 'T700-SELECT-VENDOR-NAME'.                           16360000
160500*                                                                 16370000
160600     MOVE 'T700'                   TO PGM-LOCATION.               16380000
160700     MOVE 'T700-SELECT-VENDOR-NAME'                               16390000
160800                                   TO PV-ABEND-PARAGRAPH.         16400000
160900*                                                                 16410000
161000     MOVE PC-01  TO ENTNME-TYPE-CDE                               16420000
161100     EXEC SQL                                                     16430000
161200         SELECT A.ENT_NAME_DESC                                   16440000
161300           INTO :ENTNME-ENT-NAME-DESC                             16450000
161400           FROM TENTNME A,                                        16460000
161500                TVNDDPT B                                         16470000
161600           WHERE A.ENT_ID          = B.ENT_ID                     16480000
161700             AND B.DEPT_NBR        = :VNDDPT-DEPT-NBR             16490000
161800             AND B.INHOUSE_NBR     = :VNDDPT-INHOUSE-NBR          16500000
161900             AND A.TYPE_CDE        = :ENTNME-TYPE-CDE             16510000
162000     END-EXEC.                                                    16520000
162100*                                                                 16530000
162200     EVALUATE TRUE                                                16540000
162300       WHEN SQLCODE = ZEROS                                       16550000
162400         MOVE PC-FLNAME-LENGTH   TO DP024-FLNAME-LENGTH           16560000
162500         MOVE RSPBAR-WORKER-FIR-NAME                              16570000
162600                                 TO DP024-FNAME                   16580000
162700         MOVE RSPBAR-WORKER-LAST-NAME                             16590000
162800                                 TO DP024-LNAME                   16600000
162900         PERFORM DP024-0000-FORMAT-NAME                           16610000
163000         MOVE DP024-FLNAME       TO PV-BYR-NAME                   16620000
163100       WHEN SQLCODE = PC-ROW-NOT-FOUND                            16630000
163200         MOVE SPACES             TO PV-BYR-NAME                   16640000
163300       WHEN OTHER                                                 16650000
163400         DISPLAY PV-ABEND-PARAGRAPH                               16660000
163500         DISPLAY 'MDSEAR-DKEY: '                                  16670000
163600                  MDSEAR-DKEY                                     16680000
163700         DISPLAY 'PC-BUYER  : '                                   16690000
163800                  PC-BYR                                          16700000
163900         DISPLAY 'PV-CURRENT-DATE-R: '                            16710000
164000                  PV-CURRENT-DATE-R                               16720000
164100         PERFORM Z999-SQL-ERROR                                   16730000
164200     END-EVALUATE.                                                16740000
164300*                                                                 16750000
164400 EJECT                                                            16760000
164500******************************************************************16770000
164600*  THIS PARAGRAPH SELECTS THE BUYER NUMBER FOR OUTPUT AND THE    *16780000
164700*  DKEY TO RETRIEVE THE BUYER NAME                               *16790000
164800******************************************************************16800000
164900 T800-SELECT-MDSEAR-DKEY.                                         16810000
165000*                                                                 16820000
165100*    DISPLAY 'T800-SELECT-MDSEAR-DKEY'.                           16830000
165200*                                                                 16840000
165300     MOVE 'T800'                   TO PGM-LOCATION.               16850000
165400     MOVE 'T800-SELECT-MDSEAR-DKEY'                               16860000
165500                                   TO PV-ABEND-PARAGRAPH.         16870000
165600     MOVE PC-OPER-CO TO  MDSEAR-OPERCO-NBR                        16880000
165700*                                                                 16890000
165800     EXEC SQL                                                     16900000
165900         SELECT  MDSEAR_DKEY,                                     16910000
166000                 BYR_NBR                                          16920000
166100           INTO  :MDSEAR-DKEY,                                    16930000
166200                 :MDSEAR-BYR-NBR                                  16940000
166300           FROM TMDSEAR                                           16950000
166400          WHERE DEPT_NBR   = :MDSEAR-DEPT-NBR                     16960000
166500            AND MDSELV_CDE = :MDSEAR-MDSELV-CDE                   16970000
166600            AND OPERCO_NBR = :MDSEAR-OPERCO-NBR                   16980000
166700            AND :PV-CURRENT-DATE-R BETWEEN                        16990000
166800                STRT_DTE AND END_DTE                              17000000
166900     END-EXEC.                                                    17010000
167000*                                                                 17020000
167100     EVALUATE TRUE                                                17030000
167200       WHEN SQLCODE         = ZERO                                17040000
167300         CONTINUE                                                 17050000
167400       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    17060000
167500         MOVE ZEROES TO MDSEAR-DKEY                               17070000
167600         MOVE SPACES TO MDSEAR-BYR-NBR                            17080000
167700       WHEN OTHER                                                 17090000
167800         DISPLAY '**** ABEND ****'                                17100000
167900         DISPLAY '**** PROGRAM   = MRKUT141 ****'                 17110002
168000         DISPLAY '**** PARAGRAPH = T800-SELECT  '                 17120000
168100         DISPLAY '**** INVALID SELECT ON TMDSEAR TABLE     '      17130000
168200         DISPLAY '**** DEPT-NBR  = ' MDSEAR-DEPT-NBR              17140000
168300         DISPLAY '**** MDSELV-CDE = ' MDSEAR-MDSELV-CDE           17150000
168400         DISPLAY '**** PROCESS DTE = ' PV-CURRENT-DATE-R          17160000
168500         DISPLAY PV-ABEND-PARAGRAPH                               17170000
168600         PERFORM Z999-SQL-ERROR                                   17180000
168700     END-EVALUATE.                                                17190000
168800*                                                                 17200000
168900 EJECT                                                            17210000
169000******************************************************************17220000
169100*  RETRIEVES THE BUYER   NAME.                                   *17230000
169200******************************************************************17240000
169300*                                                                 17250000
169400 T900-SELECT-BUYER-NAME.                                          17260000
169500*                                                                 17270000
169600*    DISPLAY 'T900-SELECT-BUYER-NAME'.                            17280000
169700*                                                                 17290000
169800     MOVE 'T900'                 TO PGM-LOCATION.                 17300000
169900     MOVE 'T900-GET-BUYER-NAME       '                            17310000
170000                                 TO PV-ABEND-PARAGRAPH.           17320000
170100*                                                                 17330000
170200     EXEC SQL                                                     17340000
170300         SELECT WORKER_FIR_NAME,                                  17350000
170400                WORKER_LAST_NAME                                  17360000
170500           INTO :RSPBAR-WORKER-FIR-NAME,                          17370000
170600                :RSPBAR-WORKER-LAST-NAME                          17380000
170700           FROM TRSPBAR                                           17390000
170800           WHERE MDSEAR_DKEY       = :RSPBAR-MDSEAR-DKEY          17400000
170900             AND RSPLVL_CDE        = :RSPBAR-RSPLVL-CDE           17410000
171000             AND :PV-CURRENT-DATE-R BETWEEN                       17420000
171100                 WORKER_STRT_DTE AND WORKER_END_DTE               17430000
171200     END-EXEC.                                                    17440000
171300*                                                                 17450000
171400     EVALUATE TRUE                                                17460000
171500       WHEN SQLCODE = ZEROS                                       17470000
171600         MOVE PC-FLNAME-LENGTH   TO DP024-FLNAME-LENGTH           17480000
171700         MOVE RSPBAR-WORKER-FIR-NAME                              17490000
171800                                 TO DP024-FNAME                   17500000
171900         MOVE RSPBAR-WORKER-LAST-NAME                             17510000
172000                                 TO DP024-LNAME                   17520000
172100         PERFORM DP024-0000-FORMAT-NAME                           17530000
172200         MOVE DP024-FLNAME       TO PV-BYR-NAME                   17540000
172300       WHEN SQLCODE = PC-ROW-NOT-FOUND                            17550000
172400         MOVE SPACES             TO PV-BYR-NAME                   17560000
172500       WHEN OTHER                                                 17570000
172600         DISPLAY PV-ABEND-PARAGRAPH                               17580000
172700         DISPLAY 'MDSEAR-DKEY: '                                  17590000
172800                  MDSEAR-DKEY                                     17600000
172900         DISPLAY 'PC-BUYER  : '                                   17610000
173000                  PC-BYR                                          17620000
173100         DISPLAY 'PV-CURRENT-DATE-R: '                            17630000
173200                  PV-CURRENT-DATE-R                               17640000
173300         PERFORM Z999-SQL-ERROR                                   17650000
173400     END-EVALUATE.                                                17660000
173500 EJECT                                                            17670000
173600******************************************************************17680000
173700*     WRITES THE INPUT TRANSFER RECORD TO BE USED IN THE         *17690000
173800*     REPLENISHMENT SYSTEM                                       *17700000
173900******************************************************************17710000
174000 W000-WRITE-OUTPUT.                                               17720000
174100*                                                                 17730000
174200*    DISPLAY 'W000-WRITE'.                                        17740000
174300     MOVE 'W000'                  TO PGM-LOCATION.                17750000
174400     MOVE 'W000-WRITE-SYSTEM-RECORD   '                           17760000
174500                                  TO PV-ABEND-PARAGRAPH.          17770000
174600*                                                                 17780000
174700     WRITE TRANSFER-REC           FROM PV-OUTPUT.                 17790000
174800*                                                                 17800000
174900     ADD PC-PLUS-1 TO PV-SYSTEM-OUTPUT-CNT.                       17810000
175000*                                                                 17820000
175100 EJECT                                                            17830000
175200******************************************************************17840000
175300*   CLOSES FILES AND DISPLAYS MESSAGES.                          *17850000
175400******************************************************************17860000
175500 Y100-END-ROUTINE.                                                17870000
175600*                                                                 17880000
175700     IF NO-INPUT                                                  17890000
175800         CONTINUE                                                 17900000
175900     ELSE                                                         17910000
176000         PERFORM W000-WRITE-OUTPUT                                17920000
176100     END-IF.                                                      17930000
176200*                                                                 17940000
176300     CLOSE  IC-CONTROL-FILE                                       17950000
176400            BIM-FILE                                              17960000
176500            TRANSFER-RECORD-IN                                    17970000
176600            TRANSFER-RECORD.                                      17980000
176700                                                                  17990000
176800     IF NOT (PV-CONTROL-SUCCESSFUL OR                             18000000
176900             PV-CONTROL-VERIFY)                                   18010000
177000        MOVE 'Y100-END-ROUTINE'   TO PV-PARAGRAPH-NAME            18020000
177100        MOVE 'IC-CONTROL-FILE'    TO PV-ERROR-FILE                18030000
177200        MOVE 'CLOSING INPUT FILE' TO PV-ERROR-OPERATION           18040000
177300        MOVE 'BAD-CLOSE'          TO PV-ERROR-STATUS              18050000
177400        MOVE  PV-CONTROL-STATUS   TO PV-VSAM-STATUS               18060000
177500        MOVE  '//////////////'    TO PV-NOT-FOUND-KEY             18070000
177600        PERFORM Z999-VSAM-ERROR                                   18080000
177700        MOVE +4006              TO PV-ABEND-CODE                  18090000
177800        CALL 'ILBOABN0'        USING PV-ABEND-CODE                18100000
177900     END-IF.                                                      18110000
178000                                                                  18120000
178100     IF NOT (PV-BIM-SUCCESSFUL OR                                 18130000
178200             PV-BIM-VERIFY)                                       18140000
178300        MOVE 'Y100-END-ROUTINE'   TO PV-PARAGRAPH-NAME            18150000
178400        MOVE 'BIM-FILE'           TO PV-ERROR-FILE                18160000
178500        MOVE 'CLOSING INPUT FILE' TO PV-ERROR-OPERATION           18170000
178600        MOVE 'BAD-CLOSE'          TO PV-ERROR-STATUS              18180000
178700        MOVE  PV-BIM-STATUS       TO PV-VSAM-STATUS               18190000
178800        MOVE  '//////////////'    TO PV-NOT-FOUND-KEY             18200000
178900        PERFORM Z999-VSAM-ERROR                                   18210000
179000        MOVE +4006              TO PV-ABEND-CODE                  18220000
179100        CALL 'ILBOABN0'        USING PV-ABEND-CODE                18230000
179200     END-IF.                                                      18240000
179300*                                                                 18250000
179400*** DISPLAY COUNT OF ITEMS PROCESSED.  (DIVIDE COUNT BY 2 TO      18260000
179500*** ELIMINATE CORPORATE RECORDS, FOR ALL SYSTEMS EXCEPT 02.)      18270000
179600*                                                                 18280000
179700     IF MR001I-S-SYS-ID EQUAL '02'                                18290000
179800        CONTINUE                                                  18300000
179900     ELSE                                                         18310000
179901        COMPUTE PV-ITEM-COUNT = PV-ITEM-COUNT / 2                 18320000
179902     END-IF.                                                      18330000
179903     DISPLAY '*******************************'.                   18340000
179904     DISPLAY '*  TOTAL ITEMS: ' PV-ITEM-COUNT.                    18350000
179905     DISPLAY '*******************************'.                   18360000
179906*                                                                 18370000
179907 EJECT                                                            18380000
179908******************************************************************18390000
179909*     VSAM WARNING OR ERROR PROCESSING                           *18400000
179910*                                                                *18410000
179920******************************************************************18420000
179930                                                                  18430000
179940 Z999-VSAM-ERROR.                                                 18440000
179950*---------------                                                  18450000
179960*                                                                 18460000
179970*    DISPLAY 'Z999-VSAM-ERROR'.                                   18470000
179980     DISPLAY '**   ABEND   **'.                                   18480000
179990     DISPLAY 'PROGRAM NAME = ' PC-PGRM-NAME.                      18490000
180000     DISPLAY PV-PARAGRAPH-NAME-MSG.                               18500000
180100     DISPLAY PV-ERROR-FILE-MSG.                                   18510000
180200     DISPLAY PV-ERROR-OPERATION-MSG.                              18520000
180300     DISPLAY PV-ERROR-STATUS-MSG.                                 18530000
180400     DISPLAY PV-NOT-FOUND-MSG                                     18540000
180500     DISPLAY 'VSAM STATUS = ' PV-VSAM-STATUS.                     18550000
180600     DISPLAY '***************'.                                   18560000
180700*                                                                 18570000
180800 EJECT                                                            18580000
180900******************************************************************18590000
181000*     SQL WARNING OR ERROR PROCESSING                            *18600000
181100*                                                                *18610000
181200******************************************************************18620000
181300                                                                  18630000
181400 Z999-SQL-ERROR.                                                  18640000
181500*---------------                                                  18650000
181600                                                                  18660000
181700     MOVE SQLCODE    TO SQLCODE2.                                 18670000
181800     MOVE SQLERRD(3) TO SQLERRD3.                                 18680000
181900     DISPLAY '** ABEND **       ** = SQLERROR'.                   18690000
182000     DISPLAY '** PROGRAM        ** = MRKUT141'.                   18700002
182100     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  18710000
182200     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  18720000
182300     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   18730000
182400     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  18740000
182500     MOVE +4013 TO PV-ABEND-CODE.                                 18750000
182600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         18760000
182700*                                                                 18770000
182800******************************************************************18780000
182900     COPY DPPD024.                                                18790000
183000 EJECT                                                            18800000
183100******************************************************************18810000
183200******************************************************************18820000
