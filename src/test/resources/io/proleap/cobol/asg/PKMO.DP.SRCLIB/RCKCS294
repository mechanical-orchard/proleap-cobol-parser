000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKCS294.                                         00020001
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  02-05-94                                          00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*    THIS IS A COPY OF PROGRAM RCKCS215 USED TO LIMIT THE         00080000
000900*    SECURITY.                                                    00090000
001000*    IT HAS BEEN RENAMED RCKCS294, BY SCOTT VANG.                 00100001
001100******************************************************************00110000
001200*    E294 - PACK SLIP LINE SUMMARY LIST                           00120001
001300*                                                                 00130000
001400*    DISPLAY A LIST OF PACK SLIP LINES BASED ON CRITERIA SPECIFIED00140000
001500*                                                                 00150000
001600*    THE DP030-OVERRIDE-APPL-ERROR SWITCH IS SET TO TRUE WHEN     00160000
001700*        ENTERING THE PROGRAM IN ORDER TO GIVE CONTROL BACK TO THE00170000
001800*        LIST WHEN A NEXT-ACT-APPL-ERROR IS SENT BACK FROM THE    00180000
001900*        UPDATE.  THE DP030-RC-APPL-ERROR IS CHECKED TO DETERMINE 00190000
002000*        IF A NEXT-ACT-APPL-ERROR IS BEING RETURNED TO THE LIST.  00200000
002100*                                                                 00210000
002200*    DC-154: DISABLE THE F13, F15, F16, AND F23 KEYS IF:          00220000
002300*               THE RECEIVER HAS A STATUS OF 'CM' OR 'VE', OR     00230000
002400*               ANY OF THE RECEIPT LINES ARE VERIFIED ('VE').     00240000
002500*            BY M. FURLICK 6/23/94.                               00250000
002600*                                                                 00260000
002700******************************************************************00270000
002710* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00271014
002720* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00272015
002730* MAKING THE CALL DYNAMIC VS STATIC.                              00273015
002740*---------------------------------------------------------------* 00274015
002800 ENVIRONMENT DIVISION.                                            00280000
002900 DATA DIVISION.                                                   00290000
003000 WORKING-STORAGE SECTION.                                         00300000
003100                                                                  00310000
003200 01  PC-PROGRAM-CONSTANTS.                                        00320000
003300     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC294A  '. 00330001
003400     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM294 '. 00340001
003500     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS294'. 00350001
003600     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00360000
003700     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00370000
003800     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +6          00380000
003900                                                COMP SYNC.        00390000
004000     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00400000
004100                                                COMP SYNC.        00410000
004200     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00420000
004300                                                COMP SYNC.        00430000
004400     05  PC-MAX-RETRIES               PIC S9(4) VALUE +3          00440000
004500                                                COMP SYNC.        00450000
004600     05  PC-INQ                       PIC X(03) VALUE 'INQ'.      00460000
004700     05  PC-UPD                       PIC X(03) VALUE 'UPD'.      00470000
004800     05  PC-DEL                       PIC X(03) VALUE 'DEL'.      00480000
004900     05  PC-ERR                       PIC X(03) VALUE 'ERR'.      00490000
005000     05  PC-0                         PIC 9(04) COMP VALUE 0.     00500000
005100     05  PC-01                        PIC X(02) VALUE '01'.       00510000
005200     05  PC-VE                        PIC X(02) VALUE 'VE'.       00520000
005300     05  PC-CM                        PIC X(02) VALUE 'CM'.       00530000
005400     05  PC-AC                        PIC X(02) VALUE 'AC'.       00540000
005500     05  PC-M                         PIC X(01) VALUE 'M'.        00550003
005600     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00560000
005700     05  PC-INACTIVE                  PIC X(01) VALUE 'I'.        00570000
005800     05  PC-INTER-APPL-CODES.                                     00580000
005900         10  PC-INTER-APPL-LIST       PIC X(01) VALUE '1'.        00590000
006000         10  PC-INTER-APPL-MAINT      PIC X(01) VALUE '2'.        00600000
006100                                                                  00610000
006200     05  PC-TSYMSG-NUMBERS.                                       00620000
006300         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00630000
006400*            INVALID VALUE                                        00640000
006500         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00650000
006600*            MUST BE NUMERIC                                      00660000
006700         10  PC-TSYMSG-00050          PIC 9(5)  VALUE 00050.      00670000
006800*            NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  00680000
006900         10  PC-TSYMSG-00047          PIC 9(5)  VALUE 00047.      00690000
007000*            ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNTION  00700000
007100         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      00710000
007200*            NO END OF RANGE HAS BEEN SPECIFIED                   00720000
007300         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      00730000
007400*            END OF RANGE PRECEDES START OF RANGE                 00740000
007500         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      00750000
007600*            NO START OF RANGE HAS BEEN SPECIFIED                 00760000
007700         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      00770000
007800*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   00780000
007900         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      00790000
008000*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     00800000
008100         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      00810000
008200*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       00820000
008300         10  PC-TSYMSG-00059          PIC 9(5)  VALUE 00059.      00830000
008400*            UPDATE(S) SUCCESSFUL                                 00840000
008500         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      00850000
008600*            TOP OF LIST                                          00860000
008700         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      00870000
008800*            BOTTOM OF LIST                                       00880000
008900         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      00890000
009000*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      00900000
009100         10  PC-TSYMSG-00148          PIC 9(5)  VALUE 00148.      00910000
009200*            DATA DOES NOT EXIST                                  00920000
009300         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      00930000
009400*            MORE ITEMS TO DISPLAY                                00940000
009500         10  PC-TSYMSG-00734          PIC 9(5)  VALUE 00734.      00950000
009600*            UPDATE FUNCTION INVALID WITH RECEIVER STATUS         00960000
009700         10  PC-TSYMSG-00735          PIC 9(5)  VALUE 00735.      00970000
009800*            STORE DISTRO NOT ALLOWED UNLESS PACK SLIP ASSIGNED.  00980000
009900         10  PC-TSYMSG-00815          PIC 9(5)  VALUE 00815.      00990000
010000*       OPERATING UNIT AND FACILITY ID REQUIRED FOR THIS FUNCTION 01000000
010100         10  PC-TSYMSG-00966          PIC 9(5)  VALUE 00966.      01010000
010200*            INVALID FUNCTION FOR RECEIVER/RECEIPT ITEM STATUS    01020000
010300                                                                  01030000
010400 01  PS-PROGRAM-SWITCHES.                                         01040000
010500     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        01050000
010600         88  PS-NO-ERROR                        VALUE 'N'.        01060000
010700         88  PS-ERROR                           VALUE 'Y'.        01070000
010800     05  PS-SEARCH-STYLE-SW           PIC  X    VALUE 'N'.        01080000
010900         88  PS-INVALID-SEARCH-STYLE            VALUE 'N'.        01090000
011000         88  PS-VALID-SEARCH-STYLE              VALUE 'Y'.        01100000
011100     05  PS-WRITE-LIST-QUEUE-SW       PIC  X    VALUE 'N'.        01110000
011200         88  PS-DONT-WRITE-LIST-QUEUE           VALUE 'N'.        01120000
011300         88  PS-WRITE-LIST-QUEUE                VALUE 'Y'.        01130000
011400                                                                  01140000
011500 01  DK-DB2-KEYS.                                                 01150000
011600     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    01160000
011700     05  DK-PKSL-NBR                  PIC X(10) VALUE SPACES.     01170000
011800     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    01180000
011900     05  DK-STR-DEST-NBR              PIC S9(4) COMP VALUE +0.    01190000
012000     05  DK-SEQ-NBR-B                 PIC S9(4) COMP VALUE +0.    01200000
012100     05  DK-SEQ-NBR-E                 PIC S9(4) COMP VALUE        01210000
012200                                                +9999.            01220000
012300     05  DK-OPER-UNT-ID               PIC S9(4) COMP VALUE +0.    01230000
012400     05  DK-FCLTY-ID                  PIC S9(4) COMP VALUE +0.    01240000
012500     05  DK-ORD-LNE-NBR               PIC S9(9) COMP VALUE +0.    01250000
012600     05  DK-PREPK-ID                  PIC S9(9) COMP VALUE +0.    01260010
012700                                                                  01270000
012800 01  PV-PROGRAM-VARIABLES.                                        01280000
012900     05  PV-SUB                       PIC S9(4) VALUE ZERO        01290000
013000                                                COMP SYNC.        01300000
013100     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        01310000
013200                                                COMP SYNC.        01320000
013300     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        01330000
013400                                                COMP-3.           01340000
013500     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        01350000
013600                                                COMP-3.           01360000
013700     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        01370000
013800                                                COMP-3.           01380000
013900     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        01390000
014000                                                COMP-3.           01400000
014100     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        01410000
014200                                                COMP-3.           01420000
014300     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        01430000
014400                                                COMP-3.           01440000
014500     05  PV-TEMP-BLOCK-NUMBER         PIC S9(9) VALUE ZERO        01450000
014600                                                COMP-3.           01460000
014700     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        01470000
014800                                                COMP SYNC.        01480000
014900     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        01490000
015000                                                COMP SYNC.        01500000
015100     05  PV-ITEM                      PIC S9(4) VALUE ZERO        01510000
015200                                                COMP SYNC.        01520000
015300     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        01530000
015400                                                COMP SYNC.        01540000
015500     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        01550000
015600                                                COMP SYNC.        01560000
015700     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        01570000
015800                                                COMP SYNC.        01580000
015900     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        01590000
016000                                                COMP SYNC.        01600000
016100     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        01610000
016200                                                COMP SYNC.        01620000
016300     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01630000
016400                                                COMP SYNC.        01640000
016500     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01650000
016600                                                COMP SYNC.        01660000
016700     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        01670000
016800                                                COMP SYNC.        01680000
016900     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        01690000
017000                                                COMP SYNC.        01700000
017100     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        01710000
017200                                                COMP SYNC.        01720000
017300     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        01730000
017400                                                COMP SYNC.        01740000
017500     05  PV-SQL-SUB                   PIC S9(4) VALUE ZERO        01750000
017600                                                COMP SYNC.        01760000
017700     05  PV-RETRY-COUNTER             PIC S9(4) VALUE ZERO        01770000
017800                                                COMP SYNC.        01780000
017900     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        01790000
018000                                                COMP SYNC.        01800000
018100     05  PV-DB2-COUNT                 PIC S9(9) VALUE ZERO        01810000
018200                                                COMP-3.           01820000
018300     05  PV-DB2-CURSOR-FIELDS.                                    01830000
018400         10  PV-PKSL-LNE-NBR          PIC S9(9) VALUE ZERO        01840000
018500                                                COMP SYNC.        01850000
018600         10  PV-PKSL-ITM-QTY          PIC S9(9) VALUE ZERO        01860000
018700                                                COMP SYNC.        01870000
018800         10  PV-VEND-STYL-NAME        PIC X(20) VALUE SPACES.     01880000
018900         10  PV-UNT-COST-AMT          PIC S9(4)V9(3)              01890000
019000                                                VALUE ZERO        01900000
019100                                                COMP-3.           01910000
019200         10  PV-COLOR-DESC            PIC X(25) VALUE SPACES.     01920000
019300         10  PV-VEND-DESC             PIC X(25) VALUE SPACES.     01930000
019400         10  PV-SIZE-DESC             PIC X(25) VALUE SPACES.     01940000
019500         10  PV-PKSL-STAT-CDE         PIC X(02) VALUE SPACES.     01950000
019600         10  PV-SEQ-NBR               PIC S9(4) VALUE ZERO        01960000
019700                                                COMP.             01970000
019800         10  PV-TROUBLE-DESC.                                     01980000
019900             15  PV-TROUBLE-PLUS      PIC X(01) VALUE SPACES.     01990000
020000             15  FILLER               PIC X(01) VALUE SPACES.     02000000
020100             15  PV-TROUBLE           PIC X(10) VALUE SPACES.     02010000
020200 01  LQW-LIST-QUEUE-WORK-AREA.                                    02020000
020300     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     02030000
020400     05  LQW-ITEM-ENTRIES             OCCURS 6 TIMES              02040000
020500                                      INDEXED BY LQW-IDX.         02050000
020600         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          02060000
020700         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  02070000
020800         10  LQW-SELECTED-SW          PIC X(01).                  02080000
020900             88  LQW-SELECT                      VALUE 'S'.       02090000
021000             88  LQW-DESELECT                    VALUE ' '.       02100000
021100         10  LQW-ACTION               PIC X(03).                  02110000
021200         10  LQW-PKSL-LNE-NBR         PIC 9(04).                  02120000
021300         10  LQW-VEND-STYL-NAME       PIC X(20).                  02130000
021400         10  LQW-PKSL-ITM-QTY         PIC 9(06).                  02140000
021500         10  LQW-UNT-COST-AMT         PIC 9(4)V9(3).              02150000
021600         10  LQW-COLOR-DESC           PIC X(25).                  02160000
021700         10  LQW-VEND-DESC            PIC X(25).                  02170000
021800         10  LQW-TROUBLE              PIC X(12).                  02180000
021900         10  LQW-SIZE-DESC            PIC X(25).                  02190000
022000                                                                  02200000
022100******************************************************************02210000
022200*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02220000
022300******************************************************************02230000
022400     COPY RCWS013.                                                02240000
022500                                                                  02250000
022600******************************************************************02260000
022700*    BMS MAP                                                      02270000
022800******************************************************************02280000
022900     COPY RCKM294.                                                02290001
023000                                                                  02300000
023100 01  MR-OCCURS-LAYOUT                 REDEFINES RC294AO.          02310001
023200** CHG0094517  CHANGED FILLER LENGTH FROM 147 TO 148              02320015
023300     05  FILLER                       PIC X(148).                 02330012
023400     05  MR-SCROLL-AREA               OCCURS 6 TIMES.             02340000
023500         10  MR-SELECTL               PIC S9(4) COMP.             02350000
023600         10  MR-SELECTA               PIC X.                      02360000
023700         10  MR-SELECTC               PIC X.                      02370000
023800         10  MR-SELECTH               PIC X.                      02380000
023900         10  MR-SELECTI               PIC X.                      02390000
024000                                                                  02400000
024100         10  MR-ACTIONL               PIC S9(4) COMP.             02410000
024200         10  MR-ACTIONA               PIC X.                      02420000
024300         10  MR-ACTIONC               PIC X.                      02430000
024400         10  MR-ACTIONH               PIC X.                      02440000
024500         10  MR-ACTION                PIC XXX.                    02450000
024600                                                                  02460000
024700         10  MR-PKSL-LNE-NBR-L        PIC S9(4) COMP.             02470000
024800         10  MR-PKSL-LNE-NBR-A        PIC X.                      02480000
024900         10  MR-PKSL-LNE-NBR-C        PIC X.                      02490000
025000         10  MR-PKSL-LNE-NBR-H        PIC X.                      02500000
025100         10  MR-PKSL-LNE-NBR          PIC X(04).                  02510000
025200                                                                  02520000
025300         10  MR-VEND-STYL-NAME-L      PIC S9(4) COMP.             02530000
025400         10  MR-VEND-STYL-NAME-A      PIC X.                      02540000
025500         10  MR-VEND-STYL-NAME-C      PIC X.                      02550000
025600         10  MR-VEND-STYL-NAME-H      PIC X.                      02560000
025700         10  MR-VEND-STYL-NAME        PIC X(20).                  02570000
025800                                                                  02580000
025900         10  MR-PKSL-ITM-QTY-L        PIC S9(4) COMP.             02590000
026000         10  MR-PKSL-ITM-QTY-A        PIC X.                      02600000
026100         10  MR-PKSL-ITM-QTY-C        PIC X.                      02610000
026200         10  MR-PKSL-ITM-QTY-H        PIC X.                      02620000
026300         10  MR-PKSL-ITM-QTY.                                     02630000
026400             15  MR-PKSL-ITM-QTY-EDITTED                          02640000
026500                                      PIC ZZZ,ZZ9.                02650000
026600                                                                  02660000
026700         10  MR-UNT-COST-AMT-L        PIC S9(4) COMP.             02670000
026800         10  MR-UNT-COST-AMT-A        PIC X.                      02680000
026900         10  MR-UNT-COST-AMT-C        PIC X.                      02690000
027000         10  MR-UNT-COST-AMT-H        PIC X.                      02700000
027100         10  MR-UNT-COST-AMT.                                     02710000
027200             15  MR-UNT-COST-AMT-EDITTED                          02720000
027300                                      PIC ZZZZ.999.               02730000
027400                                                                  02740000
027500         10  MR-COLOR-DESC-L          PIC S9(4) COMP.             02750000
027600         10  MR-COLOR-DESC-A          PIC X.                      02760000
027700         10  MR-COLOR-DESC-C          PIC X.                      02770000
027800         10  MR-COLOR-DESC-H          PIC X.                      02780000
027900         10  MR-COLOR-DESC            PIC X(25).                  02790000
028000                                                                  02800000
028100         10  MR-VEND-DESC-L           PIC S9(4) COMP.             02810000
028200         10  MR-VEND-DESC-A           PIC X.                      02820000
028300         10  MR-VEND-DESC-C           PIC X.                      02830000
028400         10  MR-VEND-DESC-H           PIC X.                      02840000
028500         10  MR-VEND-DESC             PIC X(25).                  02850000
028600                                                                  02860000
028700         10  MR-TROUBLE-L             PIC S9(4) COMP.             02870000
028800         10  MR-TROUBLE-A             PIC X.                      02880000
028900         10  MR-TROUBLE-C             PIC X.                      02890000
029000         10  MR-TROUBLE-H             PIC X.                      02900000
029100         10  MR-TROUBLE               PIC X(12).                  02910000
029200                                                                  02920000
029300         10  MR-SIZE-DESC-L           PIC S9(4) COMP.             02930000
029400         10  MR-SIZE-DESC-A           PIC X.                      02940000
029500         10  MR-SIZE-DESC-C           PIC X.                      02950000
029600         10  MR-SIZE-DESC-H           PIC X.                      02960000
029700         10  MR-SIZE-DESC             PIC X(25).                  02970000
029800                                                                  02980000
029900                                                                  02990000
030000******************************************************************03000000
030100*    BMS ATTRIBUTES                                               03010000
030200******************************************************************03020000
030300     COPY DPWS015.                                                03030000
030400                                                                  03040000
030500******************************************************************03050000
030600*    FUNCTION KEYS                                                03060000
030700******************************************************************03070000
030800     COPY DPWS016.                                                03080000
030900                                                                  03090000
031000******************************************************************03100000
031100*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   03110000
031200******************************************************************03120000
031300     COPY DPWS010I.                                               03130000
031400                                                                  03140000
031500******************************************************************03150000
031600*    PARAMETER LIST FOR CICS API                                  03160000
031700******************************************************************03170000
031800     COPY DPWS030.                                                03180000
031810     COPY DPWS930.                                                03181015
031900                                                                  03190000
032000******************************************************************03200000
032100*    GLOBAL COMMUNICATION AREA                                    03210000
032200******************************************************************03220000
032300     COPY DPWS020.                                                03230000
032400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03240000
032500                                                                  03250000
032600******************************************************************03260000
032700*    INTER-APPLICATION COMMUNICATION AREA                         03270000
032800*    RCWS012 = INPUT FROM PACK SLIP HEADER MAINTENANCE PROGRAM    03280000
032900******************************************************************03290000
033000         10  INTER-APPL-COMM-AREA       PIC X(200).               03300000
033100     COPY RCWS012.                                                03310000
033200     COPY RCWS015.                                                03320000
033300                                                                  03330000
033400******************************************************************03340000
033500*    APPLICATION SPECIFIC COMMUNICATION AREA                      03350000
033600******************************************************************03360000
033700         10  ASC-SPECIFIC-COMMAREA.                               03370000
033800             15  ASC-LIST-KEYS.                                   03380000
033900                 20  ASC-KEY-SEARCH-STYLE       PIC X(20).        03390000
034000** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  03400012
034100                 20  ASC-KEY-PO-NBR             PIC 9(08).        03410012
034200                 20  ASC-KEY-PKSL-NBR           PIC X(10).        03420000
034300                 20  ASC-KEY-VENDOR-NAME        PIC X(30).        03430000
034400                 20  ASC-KEY-REC-SEQ-NBR        PIC 9(04).        03440000
034500                 20  ASC-KEY-STR-DEST-NBR       PIC 9(04).        03450000
034600                 20  ASC-KEY-SEQ-NBR            PIC S9(04) COMP.  03460000
034700                 20  ASC-KEY-OPER-UNT-ID        PIC 9(04).        03470000
034800                 20  ASC-KEY-FCLTY-ID           PIC 9(04).        03480000
034900                 20  ASC-KEY-PRO-NBR            PIC X(16).        03490000
035000                 20  ASC-KEY-BOL-NBR            PIC X(16).        03500000
035100                 20  ASC-KEY-PKSL-STAT-CDE      PIC X(02).        03510000
035200             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               03520000
035300                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       03530000
035400                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03540000
035500                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03550000
035600                                                                  03560000
035700                 20  ASC-ITEM-ARRAY.                              03570000
035800                     25  ASC-ITEM-ENTRIES  OCCURS 6 TIMES.        03580000
035900                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    03590000
036000                                                     COMP-3.      03600000
036100                         30  ASC-TEMP-SELECTED-SW    PIC X.       03610000
036200                             88  ASC-VALID-SELECT    VALUE ' '    03620000
036300                                                           'S'    03630000
036400                                                           'B'    03640000
036500                                                           'E'.   03650000
036600                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03660000
036700                             88  ASC-TEMP-SELECT     VALUE 'S'.   03670000
036800                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03680000
036900                             88  ASC-TEMP-END        VALUE 'E'.   03690000
037000                         30  ASC-SELECTED-SW         PIC  X.      03700000
037100                             88  ASC-NO-SELECT       VALUE ' '.   03710000
037200                             88  ASC-SELECT          VALUE 'S'.   03720000
037300                             88  ASC-BEGIN           VALUE 'B'.   03730000
037400                             88  ASC-END             VALUE 'E'.   03740000
037500                         30  ASC-ACTION              PIC XXX.     03750000
037600                         30  ASC-PKSL-LNE-NBR.                    03760000
037700                             35  ASC-PKSL-LNE-NBR-N  PIC 9(04).   03770000
037800                         30  ASC-VEND-STYL-NAME      PIC X(20).   03780000
037900                         30  ASC-PKSL-ITM-QTY.                    03790000
038000                             35  ASC-PKSL-ITM-QTY-N  PIC 9(06).   03800000
038100                         30  ASC-UNT-COST-AMT.                    03810000
038200                             35  ASC-UNT-COST-AMT-N  PIC          03820000
038300                                                     9(4)V9(3).   03830000
038400                         30  ASC-COLOR-DESC          PIC X(25).   03840000
038500                         30  ASC-VEND-DESC           PIC X(25).   03850000
038600                         30  ASC-TROUBLE             PIC X(12).   03860000
038700                         30  ASC-SIZE-DESC           PIC X(25).   03870000
038800                                                                  03880000
038900             15  ASC-BLK-SUB                         PIC S9(4)    03890000
039000                                                     COMP SYNC.   03900000
039100             15  ASC-ITEM-SUB                        PIC S9(4)    03910000
039200                                                     COMP SYNC.   03920000
039300             15  ASC-SEL-SUB                         PIC S9(4)    03930000
039400                                                     COMP.        03940000
039500             15  ASC-SEL-ITEM                        PIC S9(4)    03950000
039600                                                     COMP.        03960000
039700             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    03970000
039800                                                     COMP-3.      03980000
039900             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    03990000
040000                                                     COMP-3.      04000000
040100             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(5)    04010000
040200                                                     COMP-3.      04020000
040300             15  ASC-ITEMS-DISPLAYED                 PIC S999     04030000
040400                                                     COMP-3.      04040000
040500             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    04050000
040600                                                     COMP-3.      04060000
040700             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    04070000
040800                                                     COMP-3.      04080000
040900             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    04090000
041000                                                     COMP SYNC.   04100000
041100             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    04110000
041200                                                     COMP-3.      04120000
041300             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    04130000
041400                                                     COMP-3.      04140000
041500             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       04150000
041600                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   04160000
041700                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   04170000
041800             15  ASC-LIST-QUEUE-NAME.                             04180000
041900                 20  ASC-LIST-TERM-ID                PIC X(4).    04190000
042000                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    04200000
042100                                                     COMP-3.      04210000
042200                 20  ASC-LIST-SEQ                    PIC 9.       04220000
042300             15  ASC-SEL-QUEUE-NAME-IN               PIC X(8).    04230000
042400             15  ASC-SEL-QUEUE-NAME-OUT.                          04240000
042500                 20  ASC-SEL-TERM-ID                 PIC X(4).    04250000
042600                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    04260000
042700                                                     COMP-3.      04270000
042800                 20  ASC-SEL-SEQ                     PIC 9.       04280000
042900             15  ASC-START-ITEM-REQUEST.                          04290000
043000                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    04300000
043100             15  ASC-PACK-SLIP-ITEM-SW               PIC X.       04310000
043200                 88  ASC-MORE-PACK-SLIP-ITEMS        VALUE 'Y'.   04320000
043300                 88  ASC-NO-MORE-PACK-SLIP-ITEMS     VALUE 'N'.   04330000
043400             15  ASC-READ-ONLY-SW                    PIC X.       04340000
043500                 88  ASC-READ-ONLY                   VALUE 'R'.   04350000
043600                 88  ASC-UPDATES-ALLOWED             VALUE 'U'.   04360000
043700             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(1).    04370000
043800                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   04380000
043900             15  ASC-HOLD-INTER-APPL                 PIC X(200).  04390000
044000                                                                  04400000
044100******************************************************************04410000
044200*    ABEND PROCESSING                                             04420000
044300******************************************************************04430000
044400     COPY DPWS013.                                                04440000
044500                                                                  04450000
044600******************************************************************04460000
044700*    DB2 SQL COMMUNICATION AREA                                   04470000
044800******************************************************************04480000
044900     EXEC SQL                                                     04490000
045000          INCLUDE SQLCA                                           04500000
045100     END-EXEC.                                                    04510000
045200                                                                  04520000
045300******************************************************************04530000
045400*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        04540000
045500******************************************************************04550000
045600     EXEC SQL                                                     04560000
045700          INCLUDE TPKSLIP                                         04570000
045800     END-EXEC.                                                    04580000
045900                                                                  04590000
046000******************************************************************04600000
046100*    DB2 DCLGEN FOR THE RECEIVER TABLE                            04610000
046200******************************************************************04620000
046300     EXEC SQL                                                     04630000
046400          INCLUDE TRECEIV                                         04640000
046500     END-EXEC.                                                    04650000
046600                                                                  04660000
046700******************************************************************04670000
046800*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       04680000
046900******************************************************************04690000
047000     EXEC SQL                                                     04700000
047100          INCLUDE TRECITM                                         04710000
047200     END-EXEC.                                                    04720000
047300                                                                  04730000
047400******************************************************************04740000
047500*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          04750000
047600******************************************************************04760000
047700     EXEC SQL                                                     04770000
047800          INCLUDE TPKITEM                                         04780000
047900     END-EXEC.                                                    04790000
048000                                                                  04800000
048100******************************************************************04810000
048200*    DB2 DCLGEN FOR UNMATCHED PACK SLIP ITEM TABLE                04820000
048300******************************************************************04830000
048400     EXEC SQL                                                     04840000
048500          INCLUDE TUNPKSL                                         04850000
048600     END-EXEC.                                                    04860000
048700                                                                  04870000
048800******************************************************************04880000
048900*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          04890000
049000******************************************************************04900000
049100     EXEC SQL                                                     04910000
049200          INCLUDE TPURCHS                                         04920000
049300     END-EXEC.                                                    04930000
049400                                                                  04940000
049500******************************************************************04950000
049600*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     04960000
049700******************************************************************04970000
049800     EXEC SQL                                                     04980000
049900          INCLUDE TPURITM                                         04990000
050000     END-EXEC.                                                    05000000
050100                                                                  05010000
050200******************************************************************05020000
050300*    DB2 DCLGEN FOR VENDOR ENTERPRISE NAME TABLE                  05030000
050400******************************************************************05040000
050500     EXEC SQL                                                     05050000
050600          INCLUDE TENTNME                                         05060000
050700     END-EXEC.                                                    05070000
050800                                                                  05080000
050900                                                                  05090000
051000******************************************************************05100000
051100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            05110000
051200*  NOTIFICATION TABLE                                             05120000
051300******************************************************************05130000
051400     EXEC SQL                                                     05140000
051500          INCLUDE TTRBNTF                                         05150000
051600     END-EXEC.                                                    05160000
051700                                                                  05170000
051800******************************************************************05180000
051900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            05190000
052000*  REASON CODE TABLE                                              05200000
052100******************************************************************05210000
052200     EXEC SQL                                                     05220000
052300          INCLUDE TTRBRSN                                         05230000
052400     END-EXEC.                                                    05240000
052500                                                                  05250000
052600******************************************************************05260000
052700*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PACK SLIP ITEMS       05270000
052800******************************************************************05280000
052900     EXEC SQL                                                     05290000
053000          DECLARE ITEM-CURSOR CURSOR FOR                          05300000
053100           SELECT A.PKSL_LNE_NBR,                                 05310000
053200                  A.PKSL_ITM_QTY,                                 05320000
053300                  B.VEND_STYL_NAME,                               05330000
053400                  B.UNT_COST_AMT,                                 05340000
053500                  B.COLOR_DESC,                                   05350000
053600                  B.SKU_DESC,                                     05360000
053700                  B.SIZE_DESC,                                    05370000
053800                  C.PKSL_STAT_CDE,                                05380000
053900                  C.SEQ_NBR,                                      05390008
054000                  B.PO_PREPK_ID                                   05400011
054100             FROM TPKITEM A,                                      05410000
054200                  TPURITM B,                                      05420000
054300                  TPKSLIP C                                       05430000
054400            WHERE A.PO_NBR         = :DK-PO-NBR                   05440000
054500              AND B.PO_NBR         = :DK-PO-NBR                   05450000
054600              AND C.PO_NBR         = :DK-PO-NBR                   05460000
054700              AND C.SEQ_NBR  BETWEEN :DK-SEQ-NBR-B                05470000
054800                                 AND :DK-SEQ-NBR-E                05480000
054900              AND A.SEQ_NBR        = C.SEQ_NBR                    05490000
055000              AND A.PKSL_LNE_NBR   = B.APP_PO_LNE_NBR             05500000
055100              AND A.VER_STAT_CDE   = :PC-ACTIVE                   05510000
055200              AND C.VER_STAT_CDE   = :PC-ACTIVE                   05520000
055300              AND A.PURITM_VER_NBR = B.VER_NBR                    05530000
055400              AND C.REC_SEQ_NBR    > 0                            05540000
055500              AND C.OPER_UNT_ID    = :DK-OPER-UNT-ID              05550000
055600              AND C.FCLTY_ID       = :DK-FCLTY-ID                 05560000
055700       UNION                                                      05570000
055800           SELECT A.PKSL_LNE_NBR,                                 05580000
055900                  A.PKSL_ITM_QTY,                                 05590000
056000                  B.VEND_STYL_NAME,                               05600000
056100                  B.UNT_COST_AMT,                                 05610000
056200                  B.COLOR_DESC,                                   05620000
056300                  B.SKU_DESC,                                     05630000
056400                  B.SIZE_DESC,                                    05640000
056500                  C.PKSL_STAT_CDE,                                05650000
056600                  C.SEQ_NBR,                                      05660009
056700                  B.PO_PREPK_ID                                   05670011
056800             FROM TPKITEM A,                                      05680000
056900                  TPURITM B,                                      05690000
057000                  TPKSLIP C                                       05700000
057100            WHERE A.PO_NBR         = :DK-PO-NBR                   05710000
057200              AND B.PO_NBR         = :DK-PO-NBR                   05720000
057300              AND C.PO_NBR         = :DK-PO-NBR                   05730000
057400              AND C.SEQ_NBR  BETWEEN :DK-SEQ-NBR-B                05740000
057500                                 AND :DK-SEQ-NBR-E                05750000
057600              AND A.SEQ_NBR        = C.SEQ_NBR                    05760000
057700              AND A.PKSL_LNE_NBR   = B.APP_PO_LNE_NBR             05770000
057800              AND A.VER_STAT_CDE   = :PC-ACTIVE                   05780000
057900              AND B.VER_STATUS_CDE = :PC-ACTIVE                   05790000
058000              AND C.VER_STAT_CDE   = :PC-ACTIVE                   05800000
058100              AND C.REC_SEQ_NBR    = 0                            05810000
058200              AND C.OPER_UNT_ID    = :DK-OPER-UNT-ID              05820000
058300              AND C.FCLTY_ID       = :DK-FCLTY-ID                 05830000
058400       UNION                                                      05840000
058500           SELECT A.PKSL_LNE_NBR,                                 05850000
058600                  A.PKSL_ITM_QTY,                                 05860000
058700                  A.VEND_STYL_NAME,                               05870000
058800                  A.UNT_COST_AMT,                                 05880000
058900                  A.COLOR_DESC,                                   05890000
059000                  A.VEND_DESC,                                    05900000
059100                  A.SIZE_DESC,                                    05910000
059200                  C.PKSL_STAT_CDE,                                05920000
059300                  C.SEQ_NBR,                                      05930009
059400                  0                                               05940011
059500             FROM TUNPKSL A,                                      05950000
059600                  TPKSLIP C                                       05960000
059700            WHERE A.PO_NBR        = :DK-PO-NBR                    05970000
059800              AND C.PO_NBR        = :DK-PO-NBR                    05980000
059900              AND C.SEQ_NBR  BETWEEN :DK-SEQ-NBR-B                05990000
060000                                 AND :DK-SEQ-NBR-E                06000000
060100              AND A.SEQ_NBR       = C.SEQ_NBR                     06010000
060200              AND A.VER_STAT_CDE  = :PC-ACTIVE                    06020000
060300              AND C.VER_STAT_CDE  = :PC-ACTIVE                    06030000
060400              AND C.OPER_UNT_ID   = :DK-OPER-UNT-ID               06040000
060500              AND C.FCLTY_ID      = :DK-FCLTY-ID                  06050000
060600         ORDER BY 1                                               06060000
060700     END-EXEC.                                                    06070000
060800                                                                  06080000
060900******************************************************************06090000
061000*  SQL DB2 TROUBLE RECORD CURSOR DECLARATION                      06100000
061100******************************************************************06110000
061200     EXEC SQL                                                     06120000
061300          DECLARE TRBL_CSR CURSOR FOR                             06130000
061400              SELECT  B.TRBL_SHT_DESC                             06140000
061500                FROM  TTRBNTF A                                   06150000
061600                    , TTRBRSN B                                   06160000
061700               WHERE  (A.PO_NBR          =   :DK-PO-NBR           06170002
061800                 AND ((A.PO_LNE_NBR      =   :DK-ORD-LNE-NBR      06180002
061900                 AND   B.TRBL_LVL_IND     <> :PC-M)               06190002
062000                 OR   (A.PREPK_ID        =   :DK-PREPK-ID         06200007
062100                 AND   B.TRBL_LVL_IND     =  :PC-M))              06210002
062200                 AND   A.REC_SEQ_NBR     =   :DK-REC-SEQ-NBR      06220002
062300                 AND   A.OPER_UNT_ID     =   :DK-OPER-UNT-ID      06230002
062400                 AND   A.RESOLVED_IND    IN ('N', 'I')            06240002
062500                 AND   A.TRBL_RSN_CDE    =    B.TRBL_RSN_CDE)     06250002
062600     END-EXEC.                                                    06260000
062700                                                                  06270000
062800 LINKAGE SECTION.                                                 06280000
062900                                                                  06290000
063000 01  DFHCOMMAREA.                                                 06300000
063100     05  FILLER                       OCCURS 1 TO 4072 TIMES      06310000
063200                                      DEPENDING ON EIBCALEN.      06320000
063300         10  FILLER                   PIC X.                      06330000
063400                                                                  06340000
063500                                                                  06350000
063600 PROCEDURE DIVISION.                                              06360000
063700                                                                  06370000
063800 0000-MAIN-MODULE.                                                06380000
063900                                                                  06390000
064000     INITIALIZE DP030-CICS-API-FIELDS.                            06400000
064100                                                                  06410000
064200     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         06420000
064300     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            06430000
064400     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           06440000
064500                                                                  06450000
064600     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         06460000
064700                                                                  06470000
064800     MOVE LENGTH OF RC294AI      TO DP030-MAP-LENGTH (1).         06480001
064900     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       06490000
065000                                                                  06500000
065100*&   SET DP030-OVERRIDE-APPL-ERROR                                06510000
065200*&                               TO TRUE.                         06520000
065300                                                                  06530000
065400     PERFORM 0001-CALL-CICS-ARCH-API.                             06540000
065500     PERFORM 1000-CONTROL-PROCESSING.                             06550000
065600                                                                  06560000
065700     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       06570000
065800                                                                  06580000
065900     PERFORM 0001-CALL-CICS-ARCH-API.                             06590000
066000                                                                  06600000
066100 0001-CALL-CICS-ARCH-API.                                         06610000
066200                                                                  06620000
066310     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06631015
066400                                    DFHCOMMAREA                   06640015
066500                                    DP030-CICS-API-FIELDS         06650015
066600                                    DP020-STANDARD-COMMAREA       06660015
066700                                    RC294AI.                      06670015
066800                                                                  06680000
066900     IF DP030-RC-CALL-SUCCESSFUL                                  06690000
067000*&      DP030-RC-APPL-ERROR                                       06700000
067100         CONTINUE                                                 06710000
067200     ELSE                                                         06720000
067300         SET DP013-CICS-ABEND                                     06730000
067400             DP013-NO-ROLLBACK                                    06740000
067500             DP013-XCTL-DISPLAY-RESTART                           06750000
067600                                 TO TRUE                          06760000
067700         MOVE '0001-CALL-CICS-ARCH-API'                           06770000
067800                                 TO DP013-PARAGRAPH               06780000
067820         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O06782015
067830-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06783015
068100         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        06810000
068200                                                                  06820000
068300         PERFORM DP013-0000-PROCESS-ABEND.                        06830000
068400                                                                  06840000
068500 1000-CONTROL-PROCESSING.                                         06850000
068600                                                                  06860000
068700     EVALUATE TRUE                                                06870000
068800                                                                  06880000
068900         WHEN DP030-RC-APPL-ERROR                                 06890000
069000              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       06900000
069100                                 TO PV-TOP-ITEM                   06910000
069200              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      06920000
069300                                                                  06930000
069400              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                06940000
069500                                                                  06950000
069600              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  06960000
069700                                                                  06970000
069800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06980000
069900                                                                  06990000
070000                                                                  07000000
070100         WHEN DP020-NEXT-ACT-INITIAL                              07010000
070200              INITIALIZE ASC-SPECIFIC-COMMAREA                    07020000
070300              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              07030000
070400                                    ASC-SEL-TERM-ID               07040000
070500              MOVE DP020-SRC-TASK-NUMBER                          07050000
070600                                 TO ASC-LIST-TASK-NUMBER          07060000
070700                                    ASC-SEL-TASK-NUMBER           07070000
070800              MOVE PC-LIST-QUEUE-SEQ                              07080000
070900                                 TO ASC-LIST-SEQ                  07090000
071000              MOVE PC-SEL-QUEUE-SEQ                               07100000
071100                                 TO ASC-SEL-SEQ                   07110000
071200                                                                  07120000
071300              SET PS-NO-ERROR    TO TRUE                          07130000
071400                                                                  07140000
071500              PERFORM 1100-PROCESS-INTER-APPL-COMM                07150000
071600                                                                  07160000
071700              IF PS-NO-ERROR                                      07170000
071800                  MOVE INTER-APPL-COMM-AREA                       07180000
071900                                    TO ASC-HOLD-INTER-APPL        07190000
072000                  PERFORM 4000-BUILD-INITIAL-PANEL                07200000
072100              END-IF                                              07210000
072200                                                                  07220000
072300         WHEN DP020-NEXT-ACT-READ-MAP                             07230000
072400              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       07240000
072500                                 TO PV-TOP-ITEM                   07250000
072600                                                                  07260000
072700              PERFORM 2000-PROCESS-PANEL                          07270000
072800                                                                  07280000
072900         WHEN DP020-NEXT-ACT-RETURN                               07290000
073000              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       07300000
073100                                 TO PV-TOP-ITEM                   07310000
073200              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      07320000
073300              MOVE ASC-HOLD-INTER-APPL                            07330000
073400                                 TO INTER-APPL-COMM-AREA          07340000
073500*             THIS PROGRAM REQUIRES THAT ANY ADDED OR CHANGED     07350000
073600*             INFORMATION BE DISPLAYED UPON RETURN TO THIS        07360000
073700*             PROGRAM.  THEREFORE THE LIST QUEUE IS REBUILT.      07370000
073800                                                                  07380000
073900              PERFORM 2050-DELETE-LIST-QUEUE                      07390000
074000              PERFORM 4000-BUILD-INITIAL-PANEL                    07400000
074100                                                                  07410000
074200*             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                07420000
074300*             PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07430000
074400*             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07440000
074500                                                                  07450000
074600                                                                  07460000
074700         WHEN OTHER                                               07470000
074800              SET DP013-LOGIC-ABEND                               07480000
074900                  DP013-NO-ROLLBACK                               07490000
075000                                 TO TRUE                          07500000
075100              MOVE '1000-CONTROL-PROCESSING'                      07510000
075200                                 TO DP013-PARAGRAPH               07520000
075300              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   07530000
075400                                 TO DP013-MESSAGE-TEXT(1)         07540000
075500                                                                  07550000
075600              PERFORM DP013-0000-PROCESS-ABEND                    07560000
075700                                                                  07570000
075800     END-EVALUATE.                                                07580000
075900                                                                  07590000
076000 1100-PROCESS-INTER-APPL-COMM.                                    07600000
076100                                                                  07610000
076200     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       07620000
076300                                                                  07630000
076400     EVALUATE DP020-INT-APPL-FORMAT-IND                           07640000
076500         WHEN PC-INTER-APPL-MAINT                                 07650000
076600             MOVE RC012-OPER-UNT-ID                               07660000
076700                                 TO ASC-KEY-OPER-UNT-ID           07670000
076800                                    DK-OPER-UNT-ID                07680000
076900             MOVE RC012-FCLTY-ID TO ASC-KEY-FCLTY-ID              07690000
077000                                    DK-FCLTY-ID                   07700000
077100             MOVE RC012-PO-NBR   TO ASC-KEY-PO-NBR                07710000
077200                                    DK-PO-NBR                     07720000
077300             MOVE RC012-SEQ-NBR  TO ASC-KEY-SEQ-NBR               07730000
077400             MOVE RC012-REC-SEQ-NBR                               07740000
077500                                 TO ASC-KEY-REC-SEQ-NBR           07750000
077600                                    DK-REC-SEQ-NBR                07760000
077700             MOVE RC012-PKSL-NBR TO ASC-KEY-PKSL-NBR              07770000
077800             MOVE RC012-STR-NBR  TO ASC-KEY-STR-DEST-NBR          07780000
077900                                                                  07790000
078000         WHEN PC-INTER-APPL-LIST                                  07800000
078100             EVALUATE TRUE                                        07810000
078200                 WHEN RC015-NUMBER-OF-SELECTED-ITEMS = ZERO       07820000
078300                     SET ASC-NO-TSQ-UPDATE                        07830000
078400                                 TO TRUE                          07840000
078500                     SET DP020-MSG-FATAL                          07850000
078600                         DP020-NEXT-ACT-APPL-ERROR                07860000
078700                         PS-ERROR                                 07870000
078800                                 TO TRUE                          07880000
078900                     MOVE PC-TSYMSG-00057                         07890000
079000                                 TO DP020-MSG-NUMBER              07900000
079100                                                                  07910000
079200                 WHEN RC015-NUMBER-OF-SELECTED-ITEMS > 1          07920000
079300                     SET ASC-NO-TSQ-UPDATE                        07930000
079400                                 TO TRUE                          07940000
079500                     SET DP020-MSG-FATAL                          07950000
079600                         DP020-NEXT-ACT-APPL-ERROR                07960000
079700                         PS-ERROR                                 07970000
079800                                 TO TRUE                          07980000
079900                     MOVE PC-TSYMSG-00047                         07990000
080000                                 TO DP020-MSG-NUMBER              08000000
080100                                                                  08010000
080200                 WHEN OTHER                                       08020000
080300                     SET ASC-USE-SELECTION-QUEUE                  08030000
080400                                 TO TRUE                          08040000
080500                     MOVE RC015-NUMBER-OF-SELECTED-ITEMS          08050000
080600                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  08060000
080700                     MOVE RC015-NUMBER-OF-TS-ITEMS                08070000
080800                                 TO ASC-NUMBER-OF-TS-ITEMS        08080000
080900                     MOVE RC015-SEL-QUEUE-NAME                    08090000
081000                                 TO ASC-SEL-QUEUE-NAME-IN         08100000
081100                     PERFORM 1120-PREPARE-LIST-ENTRY              08110000
081200         END-EVALUATE                                             08120000
081300     END-EVALUATE.                                                08130000
081400                                                                  08140000
081500*---------------------------------------------------------------* 08150000
081600*    ENTRY IS FROM A LIST.  GET THE KEYS FROM THE TEMP STORAGE  * 08160000
081700*    QUEUE PASSED FROM THE LIST.                                * 08170000
081800*---------------------------------------------------------------* 08180000
081900 1120-PREPARE-LIST-ENTRY.                                         08190000
082000     MOVE RC013-MAX-ITEMS           TO ASC-SEL-SUB.               08200000
082100     MOVE ZERO                      TO ASC-SEL-ITEM.              08210000
082200     MOVE RC015-PO-NBR              TO ASC-KEY-PO-NBR             08220000
082300                                       DK-PO-NBR.                 08230000
082400     MOVE RC015-OPER-UNT-ID         TO ASC-KEY-OPER-UNT-ID        08240000
082500                                       DK-OPER-UNT-ID.            08250000
082600     MOVE RC015-FCLTY-ID            TO ASC-KEY-FCLTY-ID           08260000
082700                                       DK-FCLTY-ID.               08270000
082800     PERFORM 2300-GET-NEXT-RECORD.                                08280000
082900                                                                  08290000
083000 2000-PROCESS-PANEL.                                              08300000
083100                                                                  08310000
083200     EVALUATE TRUE                                                08320000
083300                                                                  08330000
083400         WHEN DP020-SRC-AID = DP016-CLEAR                         08340000
083500              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      08350000
083600                                                                  08360000
083700              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  08370000
083800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08380000
083900                                                                  08390000
084000                                                                  08400000
084100         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08410000
084200                                                                  08420000
084300              PERFORM 2050-DELETE-LIST-QUEUE                      08430000
084400              PERFORM 4000-BUILD-INITIAL-PANEL                    08440000
084500                                                                  08450000
084600                                                                  08460000
084700         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   08470000
084800                                                                  08480000
084900              PERFORM 2140-DESELECT-ALL-ITEMS                     08490000
085000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08500000
085100                                                                  08510000
085200                                                                  08520000
085300         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 08530000
085400                                                                  08540000
085500              PERFORM 2150-SELECT-ALL-ITEMS                       08550000
085600              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08560000
085700                                                                  08570000
085800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08580000
085900             IF ASC-USE-SELECTION-QUEUE                           08590000
086000                 PERFORM 6200-DEL-LIST-QUEUE                      08600000
086100                 PERFORM 2300-GET-NEXT-RECORD                     08610000
086200                 PERFORM 4000-BUILD-INITIAL-PANEL                 08620000
086300                 PERFORM 3200-RESET-ATTRIBUTES                    08630000
086400             ELSE                                                 08640000
086500*                --- BOTTOM OF LIST ---                           08650000
086600                 MOVE PC-TSYMSG-00070                             08660000
086700                                   TO DP020-MSG-NUMBER            08670000
086800                 SET DP020-MSG-INFORMATIONAL                      08680000
086900                                   TO TRUE                        08690000
087000             END-IF                                               08700000
087100                                                                  08710000
087200         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08720000
087300             IF ASC-USE-SELECTION-QUEUE                           08730000
087400                 PERFORM 6200-DEL-LIST-QUEUE                      08740000
087500                 PERFORM 2310-GET-PREV-RECORD                     08750000
087600                 PERFORM 4000-BUILD-INITIAL-PANEL                 08760000
087700                 PERFORM 3200-RESET-ATTRIBUTES                    08770000
087800             ELSE                                                 08780000
087900*                --- TOP OF LIST ---                              08790000
088000                 MOVE PC-TSYMSG-00069                             08800000
088100                                   TO DP020-MSG-NUMBER            08810000
088200                 SET DP020-MSG-INFORMATIONAL                      08820000
088300                                   TO TRUE                        08830000
088400             END-IF                                               08840000
088500                                                                  08850000
088600         WHEN OTHER                                               08860000
088700                                                                  08870000
088800              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                08880000
088900              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  08890000
089000                                                                  08900000
089100              IF PS-NO-ERROR                                      08910000
089200                  SET DP030-CONTINUE-GO                           08920000
089300                                 TO TRUE                          08930000
089400                                                                  08940000
089500                  PERFORM 2100-CHECK-FUNCTION-KEY                 08950000
089600              ELSE                                                08960000
089700                  SET DP030-OVERRIDE-GO                           08970000
089800                                 TO TRUE                          08980000
089900              END-IF                                              08990000
090000                                                                  09000000
090100     END-EVALUATE.                                                09010000
090200                                                                  09020000
090300 2050-DELETE-LIST-QUEUE.                                          09030000
090400                                                                  09040000
090500     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             09050000
090600                          RESP  (PV-CICS-RESP)                    09060000
090700                          END-EXEC.                               09070000
090800                                                                  09080000
090900     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      09090000
091000        (PV-CICS-RESP = DFHRESP (QIDERR))                         09100000
091100         CONTINUE                                                 09110000
091200     ELSE                                                         09120000
091300         SET DP013-CICS-ABEND                                     09130000
091400             DP013-NO-ROLLBACK   TO TRUE                          09140000
091500         MOVE '2050-DELETE-LIST-QUEUE'                            09150000
091600                                 TO DP013-PARAGRAPH               09160000
091700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 09170000
091800                                 TO DP013-MESSAGE-TEXT (1)        09180000
091900                                                                  09190000
092000         PERFORM DP013-0000-PROCESS-ABEND.                        09200000
092100                                                                  09210000
092200     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    09220000
092300                                                                  09230000
092400 2100-CHECK-FUNCTION-KEY.                                         09240000
092500                                                                  09250000
092600*DC-154 FROM HERE                                                 09260000
092700     IF  ASC-KEY-PKSL-STAT-CDE = PC-AC AND                        09270000
092800            (DP020-SRC-AID EQUAL DP016-PF13                       09280000
092900         OR  DP020-SRC-AID EQUAL DP016-PF15                       09290000
093000         OR  DP020-SRC-AID EQUAL DP016-PF17                       09300000
093100         OR  DP020-SRC-AID EQUAL DP016-PF21                       09310000
093200         OR  DP020-SRC-AID EQUAL DP016-PF23)                      09320000
093300             MOVE PC-TSYMSG-00966                                 09330000
093400                                 TO DP020-MSG-NUMBER              09340000
093500             SET PS-ERROR                                         09350000
093600                 DP030-OVERRIDE-GO                                09360000
093700                 DP020-MSG-FATAL TO  TRUE                         09370000
093800     ELSE                                                         09380000
093900         IF  ASC-READ-ONLY                                        09390000
094000             IF (DP020-SRC-AID EQUAL DP016-PF13                   09400000
094100             OR  DP020-SRC-AID EQUAL DP016-PF15                   09410000
094200             OR  DP020-SRC-AID EQUAL DP016-PF16                   09420000
094300             OR  DP020-SRC-AID EQUAL DP016-PF23)                  09430000
094400                 MOVE PC-TSYMSG-00966                             09440000
094500                                 TO DP020-MSG-NUMBER              09450000
094600                 SET PS-ERROR                                     09460000
094700                     DP030-OVERRIDE-GO                            09470000
094800                     DP020-MSG-FATAL TO  TRUE                     09480000
094900             ELSE                                                 09490000
095000                 IF ASC-KEY-OPER-UNT-ID = PC-0                    09500000
095100                 AND (DP020-SRC-AID EQUAL DP016-PF17              09510000
095200                 OR   DP020-SRC-AID EQUAL DP016-PF21              09520000
095300                 OR   DP020-SRC-AID EQUAL DP016-PF22              09530000
095400                 OR   DP020-SRC-AID EQUAL DP016-PF23)             09540000
095500                     MOVE PC-TSYMSG-00815                         09550000
095600                                     TO DP020-MSG-NUMBER          09560000
095700                     SET PS-ERROR                                 09570000
095800                         DP030-OVERRIDE-GO                        09580000
095900                         DP020-MSG-FATAL TO  TRUE                 09590000
096000                 ELSE                                             09600000
096100                     PERFORM 2101-REAL-PFKEY-CHECK                09610000
096200                 END-IF                                           09620000
096300             END-IF                                               09630000
096400         ELSE                                                     09640000
096500             IF ASC-KEY-OPER-UNT-ID = PC-0                        09650000
096600             AND (DP020-SRC-AID EQUAL DP016-PF17                  09660000
096700             OR   DP020-SRC-AID EQUAL DP016-PF21                  09670000
096800             OR   DP020-SRC-AID EQUAL DP016-PF22                  09680000
096900             OR   DP020-SRC-AID EQUAL DP016-PF23)                 09690000
097000                 MOVE PC-TSYMSG-00815                             09700000
097100                                 TO DP020-MSG-NUMBER              09710000
097200                 SET PS-ERROR                                     09720000
097300                     DP030-OVERRIDE-GO                            09730000
097400                     DP020-MSG-FATAL TO  TRUE                     09740000
097500             ELSE                                                 09750000
097600                 PERFORM 2101-REAL-PFKEY-CHECK                    09760000
097700             END-IF                                               09770000
097800         END-IF                                                   09780000
097900     END-IF.                                                      09790000
098000*DC-154 TO HERE                                                   09800000
098100                                                                  09810000
098200 2101-REAL-PFKEY-CHECK.                                           09820000
098300                                                                  09830000
098400     EVALUATE TRUE                                                09840000
098500*F24 CARTON LIST (SUKCS555)                                       09850011
098600         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               09860011
098700             IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO               09870011
098800                 INITIALIZE RC015-INTER-APPL-COMMAREA             09880011
098900                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                09890011
099000                                TO RC015-NUMBER-OF-SELECTED-ITEMS 09900011
099100                 MOVE ASC-KEY-PO-NBR                              09910011
099200                                TO RC015-PO-NBR                   09920011
099300                 MOVE ASC-KEY-PKSL-NBR                            09930011
099400                                TO RC015-PKSL-NBR                 09940011
099500                 MOVE ASC-KEY-REC-SEQ-NBR                         09950011
099600                                TO RC015-REC-SEQ-NBR              09960011
099700                 MOVE ASC-KEY-SEQ-NBR                             09970011
099800                                TO RC015-SEQ-NBR                  09980011
099900                 MOVE ASC-KEY-OPER-UNT-ID                         09990011
100000                                TO RC015-OPER-UNT-ID              10000011
100100                 MOVE ASC-KEY-FCLTY-ID                            10010011
100200                                TO RC015-FCLTY-ID                 10020011
100300                 MOVE ASC-KEY-STR-DEST-NBR                        10030011
100400                                TO RC015-STR-NBR                  10040011
100500                 MOVE 'N'       TO RC015-DISPLAY-Z-OTR            10050011
100600                 PERFORM 5000-PREPARE-SEL-QUEUE                   10060011
100700             END-IF                                               10070011
100800         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 10080000
100900*&            IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              10090000
101000                  INITIALIZE RC015-INTER-APPL-COMMAREA            10100000
101100                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               10110000
101200                                 TO RC015-NUMBER-OF-SELECTED-ITEMS10120000
101300                  MOVE ASC-KEY-PO-NBR                             10130000
101400                                 TO RC015-PO-NBR                  10140000
101500                  MOVE ASC-KEY-PKSL-NBR                           10150000
101600                                 TO RC015-PKSL-NBR                10160000
101700                  MOVE ASC-KEY-REC-SEQ-NBR                        10170000
101800                                 TO RC015-REC-SEQ-NBR             10180000
101900                  MOVE ASC-KEY-SEQ-NBR                            10190000
102000                                 TO RC015-SEQ-NBR                 10200000
102100                  MOVE ASC-KEY-OPER-UNT-ID                        10210000
102200                                 TO RC015-OPER-UNT-ID             10220000
102300                  MOVE ASC-KEY-FCLTY-ID                           10230000
102400                                 TO RC015-FCLTY-ID                10240000
102500                  MOVE ASC-KEY-STR-DEST-NBR                       10250000
102600                                 TO RC015-STR-NBR                 10260000
102700                  PERFORM 5000-PREPARE-SEL-QUEUE                  10270000
102800*&            ELSE                                                10280000
102900*&                IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO          10290000
103000*&                    SET DP030-OVERRIDE-GO                       10300000
103100*&                        DP020-MSG-WARNING                       10310000
103200*&                               TO TRUE                          10320000
103300*&                    MOVE PC-TSYMSG-00057                        10330000
103400*&                               TO DP020-MSG-NUMBER              10340000
103500*&                END-IF                                          10350000
103600*&            END-IF                                              10360000
103700                                                                  10370000
103800         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 10380000
103900             MOVE +1             TO PV-TOP-ITEM                   10390000
104000                                                                  10400000
104100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10410000
104200             PERFORM 3200-RESET-ATTRIBUTES                        10420000
104300                                                                  10430000
104400                                                                  10440000
104500         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  10450000
104600                                                                  10460000
104700             PERFORM 2110-BROWSE-BACKWARD                         10470000
104800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10480000
104900             PERFORM 3200-RESET-ATTRIBUTES                        10490000
105000                                                                  10500000
105100                                                                  10510000
105200         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  10520000
105300                                                                  10530000
105400             PERFORM 2120-BROWSE-FORWARD                          10540000
105500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10550000
105600             PERFORM 3200-RESET-ATTRIBUTES                        10560000
105700                                                                  10570000
105800                                                                  10580000
105900         WHEN DP020-SRC-AID = DP016-ENTER                         10590000
106000                                                                  10600000
106100             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   10610000
106200                                                                  10620000
106300             IF PS-NO-ERROR                                       10630000
106400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10640000
106500             END-IF                                               10650000
106600                                                                  10660000
106700                                                                  10670000
106800         WHEN OTHER                                               10680000
106900             SET DP013-CICS-ABEND                                 10690000
107000                 DP013-NO-ROLLBACK                                10700000
107100                 DP013-XCTL-DISPLAY-RESTART                       10710000
107200                                 TO TRUE                          10720000
107300             MOVE '2100-CHECK-FUNCTION-KEY'                       10730000
107400                                 TO DP013-PARAGRAPH               10740000
107500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10750000
107600                                 TO DP013-MESSAGE-TEXT (1)        10760000
107700                                                                  10770000
107800             PERFORM DP013-0000-PROCESS-ABEND                     10780000
107900     END-EVALUATE.                                                10790000
108000                                                                  10800000
108100 2110-BROWSE-BACKWARD.                                            10810000
108200                                                                  10820000
108300     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    10830000
108400         GIVING PV-TOP-ITEM.                                      10840000
108500                                                                  10850000
108600     IF PV-TOP-ITEM NOT > +1                                      10860000
108700         MOVE +1                 TO PV-TOP-ITEM                   10870000
108800         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              10880000
108900         SET DP020-MSG-INFORMATIONAL                              10890000
109000                                 TO TRUE.                         10900000
109100                                                                  10910000
109200 2120-BROWSE-FORWARD.                                             10920000
109300                                                                  10930000
109400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              10940000
109500         GIVING PV-TOP-ITEM.                                      10950000
109600                                                                  10960000
109700     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    10970000
109800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            10980000
109900                                 TO PV-TOP-ITEM                   10990000
110000         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              11000000
110100         SET DP020-MSG-INFORMATIONAL                              11010000
110200                                 TO TRUE                          11020000
110300     ELSE                                                         11030000
110400         COMPUTE PV-BOTTOM-ITEM =                                 11040000
110500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11050000
110600         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             11060000
110700             MOVE PC-TSYMSG-00070                                 11070000
110800                                 TO DP020-MSG-NUMBER              11080000
110900             SET DP020-MSG-INFORMATIONAL                          11090000
111000                                 TO TRUE.                         11100000
111100                                                                  11110000
111200 2130-CHECK-FOR-JUMP-BROWSE.                                      11120000
111300                                                                  11130000
111400     SET PS-NO-ERROR             TO TRUE.                         11140000
111500                                                                  11150000
111600     IF ASC-KEY-SEARCH-STYLE > SPACES                             11160000
111700         PERFORM 2400-CHECK-FOR-SEARCH-STYLE                      11170000
111800     END-IF.                                                      11180000
111900                                                                  11190000
112000     IF ASC-START-ITEM-REQUEST = SPACE                            11200000
112100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11210000
112200                                 TO PV-TOP-ITEM                   11220000
112300     ELSE                                                         11230000
112400         MOVE ASC-START-ITEM-REQUEST                              11240000
112500                                 TO DP010I-UNEDITED-FIELD         11250000
112600         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         11260000
112700         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       11270000
112800         SET DP010I-NEGATIVE-NOT-ALLOWED                          11280000
112900                                 TO TRUE                          11290000
113000                                                                  11300000
113110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11311013
113120              USING DP010I-NUMERIC-EDIT-AREA                      11312013
113200                                                                  11320000
113300         IF NOT DP010I-ERROR-DETECTED                             11330000
113400             MOVE DP010I-NUMERIC-FIELD                            11340000
113500                                 TO ASC-START-ITEM-REQUEST-N      11350000
113600             IF ASC-START-ITEM-REQUEST-N > ZERO                   11360000
113700                IF ASC-START-ITEM-REQUEST-N >                     11370000
113800                                          ASC-NUMBER-OF-ITEMS-READ11380000
113900                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        11390000
114000                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ11400000
114100                                          - PC-ITEMS-PER-PANEL + 111410000
114200                    IF PV-TOP-ITEM < +1                           11420000
114300                        MOVE +1  TO PV-TOP-ITEM                   11430000
114400                        MOVE PC-TSYMSG-00070                      11440000
114500                                 TO DP020-MSG-NUMBER              11450000
114600                        SET DP020-MSG-INFORMATIONAL               11460000
114700                                 TO TRUE                          11470000
114800                    END-IF                                        11480000
114900                ELSE                                              11490000
115000                    MOVE ASC-START-ITEM-REQUEST-N                 11500000
115100                                 TO PV-TOP-ITEM                   11510000
115200                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        11520000
115300                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        11530000
115400                                            PC-ITEMS-PER-PANEL - 111540000
115500                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  11550000
115600                         MOVE PC-TSYMSG-00070                     11560000
115700                                 TO DP020-MSG-NUMBER              11570000
115800                         SET DP020-MSG-INFORMATIONAL              11580000
115900                                 TO TRUE                          11590000
116000                    END-IF                                        11600000
116100                END-IF                                            11610000
116200             ELSE                                                 11620000
116300                 MOVE PC-TSYMSG-00101                             11630000
116400                                 TO DP020-MSG-NUMBER              11640000
116500                 SET DP030-SET-CURSOR-APPL-1                      11650000
116600                                 TO TRUE                          11660000
116700                 MOVE -1         TO ASTRTITL                      11670000
116800                 MOVE DP015-UNP-NUM-BRT-MDT                       11680000
116900                                 TO ASTRTITA                      11690000
117000                 MOVE DP015-RED  TO ASTRTITC                      11700000
117100                 MOVE DP015-REVERSE                               11710000
117200                                 TO ASTRTITH                      11720000
117300                 SET PS-ERROR                                     11730000
117400                     DP020-MSG-FATAL                              11740000
117500                                 TO TRUE                          11750000
117600             END-IF                                               11760000
117700         ELSE                                                     11770000
117800             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             11780000
117900             SET DP030-SET-CURSOR-APPL-1                          11790000
118000                                 TO TRUE                          11800000
118100             MOVE -1             TO ASTRTITL                      11810000
118200             MOVE DP015-UNP-NUM-BRT-MDT                           11820000
118300                                 TO ASTRTITA                      11830000
118400             MOVE DP015-RED      TO ASTRTITC                      11840000
118500             MOVE DP015-REVERSE  TO ASTRTITH                      11850000
118600             SET PS-ERROR                                         11860000
118700                 DP020-MSG-FATAL TO TRUE                          11870000
118800         END-IF                                                   11880000
118900     END-IF.                                                      11890000
119000                                                                  11900000
119100 2140-DESELECT-ALL-ITEMS.                                         11910000
119200                                                                  11920000
119300     MOVE +1                     TO ASC-BLK-SUB.                  11930000
119400                                                                  11940000
119500     PERFORM 2141-CLEAR-SELECTED-INDS                             11950000
119600             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    11960000
119700             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           11970000
119800                                                                  11980000
119900     ADD +1                      TO ASC-BLK-SUB.                  11990000
120000                                                                  12000000
120100     PERFORM 2141-CLEAR-SELECTED-INDS                             12010000
120200             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    12020000
120300             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           12030000
120400                                                                  12040000
120500     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              12050000
120600                                 TO PV-LIST-ITEM-NUMBER.          12060000
120700                                                                  12070000
120800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12080000
120900             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).12090000
121000                                                                  12100000
121100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12110000
121200              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)12120000
121300         MOVE +1                 TO ASC-BLK-SUB                   12130000
121400                                                                  12140000
121500         PERFORM 5100-WRITE-TEMP-STORAGE                          12150000
121600                                                                  12160000
121700         MOVE +1                 TO PV-BLOCK-NUMBER               12170000
121800                                                                  12180000
121900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12190000
122000                                       PV-FIRST-BLOCK-IN-ARRAY - 112200000
122100                                                                  12210000
122200         PERFORM                                                  12220000
122300           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         12230000
122400                                                                  12240000
122500                 PERFORM 4410-READ-TEMP-STORAGE                   12250000
122600                                                                  12260000
122700                 PERFORM 2141-CLEAR-SELECTED-INDS                 12270000
122800                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        12280000
122900                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL12290000
123000                                                                  12300000
123100                 PERFORM 5100-WRITE-TEMP-STORAGE                  12310000
123200                                                                  12320000
123300                 ADD +1          TO PV-BLOCK-NUMBER               12330000
123400                                                                  12340000
123500         END-PERFORM                                              12350000
123600                                                                  12360000
123700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12370000
123800                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY12380000
123900                                                                  12390000
124000         PERFORM                                                  12400000
124100           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         12410000
124200                                         ASC-HIGHEST-BLOCK-WRITTEN12420000
124300                                                                  12430000
124400                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      12440000
124500                                 TO PV-BLOCK-NUMBER               12450000
124600                                                                  12460000
124700                 PERFORM 4410-READ-TEMP-STORAGE                   12470000
124800                                                                  12480000
124900                 PERFORM 2141-CLEAR-SELECTED-INDS                 12490000
125000                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        12500000
125100                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL12510000
125200                                                                  12520000
125300                 PERFORM 5100-WRITE-TEMP-STORAGE                  12530000
125400                                                                  12540000
125500                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        12550000
125600                                                                  12560000
125700         END-PERFORM                                              12570000
125800                                                                  12580000
125900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             12590000
126000                                 TO PV-BLOCK-NUMBER               12600000
126100                                                                  12610000
126200         PERFORM 4410-READ-TEMP-STORAGE                           12620000
126300                                                                  12630000
126400     END-IF.                                                      12640000
126500                                                                  12650000
126600     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  12660000
126700                                    ASC-START-OF-SELECTED-RANGE   12670000
126800                                    ASC-END-OF-SELECTED-RANGE.    12680000
126900                                                                  12690000
127000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12700000
127100                                                                  12710000
127200 2141-CLEAR-SELECTED-INDS.                                        12720000
127300                                                                  12730000
127400     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO12740000
127500        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           12750000
127600            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          12760000
127700                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     12770000
127800                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  12780000
127900                                 TO TRUE.                         12790000
128000                                                                  12800000
128100 2150-SELECT-ALL-ITEMS.                                           12810000
128200                                                                  12820000
128300     MOVE +1                     TO ASC-BLK-SUB.                  12830000
128400                                                                  12840000
128500     PERFORM 2151-SET-SELECTED-INDS                               12850000
128600             VARYING ASC-ITEM-SUB FROM 1 BY 1                     12860000
128700             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           12870000
128800                                                                  12880000
128900     ADD +1                      TO ASC-BLK-SUB.                  12890000
129000                                                                  12900000
129100     PERFORM 2151-SET-SELECTED-INDS                               12910000
129200             VARYING ASC-ITEM-SUB FROM 1 BY 1                     12920000
129300             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           12930000
129400                                                                  12940000
129500     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              12950000
129600                                 TO PV-LIST-ITEM-NUMBER.          12960000
129700                                                                  12970000
129800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12980000
129900             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).12990000
130000                                                                  13000000
130100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13010000
130200              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)13020000
130300         MOVE +1                 TO ASC-BLK-SUB                   13030000
130400                                                                  13040000
130500         PERFORM 5100-WRITE-TEMP-STORAGE                          13050000
130600                                                                  13060000
130700         MOVE +1                 TO PV-BLOCK-NUMBER               13070000
130800                                                                  13080000
130900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13090000
131000                                       PV-FIRST-BLOCK-IN-ARRAY - 113100000
131100                                                                  13110000
131200         PERFORM                                                  13120000
131300           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         13130000
131400                                                                  13140000
131500                 PERFORM 4410-READ-TEMP-STORAGE                   13150000
131600                                                                  13160000
131700                 PERFORM 2151-SET-SELECTED-INDS                   13170000
131800                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        13180000
131900                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL13190000
132000                                                                  13200000
132100                 PERFORM 5100-WRITE-TEMP-STORAGE                  13210000
132200                                                                  13220000
132300                 ADD +1          TO PV-BLOCK-NUMBER               13230000
132400                                                                  13240000
132500         END-PERFORM                                              13250000
132600                                                                  13260000
132700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13270000
132800                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY13280000
132900                                                                  13290000
133000         PERFORM                                                  13300000
133100           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         13310000
133200                                         ASC-HIGHEST-BLOCK-WRITTEN13320000
133300                                                                  13330000
133400                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      13340000
133500                                 TO PV-BLOCK-NUMBER               13350000
133600                                                                  13360000
133700                 PERFORM 4410-READ-TEMP-STORAGE                   13370000
133800                                                                  13380000
133900                 PERFORM 2151-SET-SELECTED-INDS                   13390000
134000                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        13400000
134100                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL13410000
134200                                                                  13420000
134300                 PERFORM 5100-WRITE-TEMP-STORAGE                  13430000
134400                                                                  13440000
134500                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        13450000
134600                                                                  13460000
134700         END-PERFORM                                              13470000
134800                                                                  13480000
134900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13490000
135000                                 TO PV-BLOCK-NUMBER               13500000
135100                                                                  13510000
135200         PERFORM 4410-READ-TEMP-STORAGE                           13520000
135300     END-IF.                                                      13530000
135400                                                                  13540000
135500     MOVE ASC-NUMBER-OF-ITEMS-READ                                13550000
135600                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 13560000
135700                                                                  13570000
135800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13580000
135900                                                                  13590000
136000 2151-SET-SELECTED-INDS.                                          13600000
136100                                                                  13610000
136200     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO13620000
136300        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              13630000
136400            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             13640000
136500                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        13650000
136600                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  13660000
136700                                 TO TRUE                          13670000
136800        END-IF                                                    13680000
136900     END-IF.                                                      13690000
137000                                                                  13700000
137100 2200-MOVE-SCREEN-TO-COMMAREA.                                    13710000
137200                                                                  13720000
137300     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               13730000
137400     MOVE +1                     TO PV-SUB.                       13740000
137500                                                                  13750000
137600     PERFORM 3100-SET-SUBSCRIPTS.                                 13760000
137700                                                                  13770000
137800     IF ASTYLEL > ZERO                                            13780000
137900         MOVE ASTYLEI            TO ASC-KEY-SEARCH-STYLE          13790000
138000     ELSE                                                         13800000
138100         IF ASTYLEF = DP015-ERASE-EOF                             13810000
138200             MOVE SPACES         TO ASC-KEY-SEARCH-STYLE          13820000
138300         END-IF                                                   13830000
138400     END-IF.                                                      13840000
138500                                                                  13850000
138600     IF ASTRTITL > ZERO                                           13860000
138700         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        13870000
138800     ELSE                                                         13880000
138900         IF ASTRTITF = DP015-ERASE-EOF                            13890000
139000             INITIALIZE ASC-START-ITEM-REQUEST                    13900000
139100         END-IF                                                   13910000
139200     END-IF.                                                      13920000
139300                                                                  13930000
139400     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          13940000
139500             VARYING PV-SUB  FROM 1 BY 1                          13950000
139600             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                13960000
139700                                                                  13970000
139800 2210-MOVE-LINES-TO-COMMAREA.                                     13980000
139900                                                                  13990000
140000     IF MR-SELECTL (PV-SUB) > ZERO                                14000000
140100         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  14010000
140200                                 TO TRUE                          14020000
140300         MOVE MR-SELECTI (PV-SUB)                                 14030000
140400                                 TO ASC-TEMP-SELECTED-SW          14040000
140500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14050000
140600     ELSE                                                         14060000
140700         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 14070000
140800             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 14080000
140900                                 TO TRUE                          14090000
141000             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          14100000
141100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14110000
141200         END-IF                                                   14120000
141300     END-IF.                                                      14130000
141400                                                                  14140000
141500     ADD +1                      TO ASC-ITEM-SUB.                 14150000
141600                                                                  14160000
141700     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         14170000
141800         ADD  +1                 TO ASC-BLK-SUB                   14180000
141900         MOVE +1                 TO ASC-ITEM-SUB                  14190000
142000     END-IF.                                                      14200000
142100                                                                  14210000
142200******************************************************************14220000
142300* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *14230000
142400* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *14240000
142500******************************************************************14250000
142600 2300-GET-NEXT-RECORD.                                            14260000
142700                                                                  14270000
142800     ADD +1                        TO ASC-SEL-SUB.                14280000
142900                                                                  14290000
143000     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             14300000
143100         ADD +1                    TO ASC-SEL-ITEM                14310000
143200         MOVE +1                   TO ASC-SEL-SUB                 14320000
143300     END-IF.                                                      14330000
143400                                                                  14340000
143500     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 14350000
143600         PERFORM 9100-READ-SEL-QUEUE                              14360000
143700         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       14370000
143800             MOVE RC013-PKSL-NBR     (ASC-SEL-SUB)                14380000
143900                                   TO ASC-KEY-PKSL-NBR            14390000
144000             MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB)                14400000
144100                                   TO ASC-KEY-REC-SEQ-NBR         14410000
144200                                      DK-REC-SEQ-NBR              14420000
144300             MOVE RC013-STR-NBR      (ASC-SEL-SUB)                14430000
144400                                   TO ASC-KEY-STR-DEST-NBR        14440000
144500             MOVE RC013-SEQ-NBR      (ASC-SEL-SUB)                14450000
144600                                   TO ASC-KEY-SEQ-NBR             14460000
144700                                      DK-SEQ-NBR-B                14470000
144800                                      DK-SEQ-NBR-E                14480000
144900             IF RC013-OPER-UNT-ID (ASC-SEL-SUB) = PC-0 AND        14490000
145000                DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-LIST    14500000
145100                 MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)             14510000
145200                                    TO ASC-KEY-OPER-UNT-ID        14520000
145300                                       DK-OPER-UNT-ID             14530000
145400             END-IF                                               14540000
145500             SET RC013-INQ (ASC-SEL-SUB)                          14550000
145600                                   TO TRUE                        14560000
145700             PERFORM 9200-REWRITE-LIST-QUEUE                      14570000
145800         ELSE                                                     14580000
145900             SUBTRACT +1 FROM ASC-SEL-SUB                         14590000
146000*            --- BOTTOM OF LIST ---                               14600000
146100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14610000
146200             SET DP020-MSG-INFORMATIONAL                          14620000
146300                                   TO TRUE                        14630000
146400         END-IF                                                   14640000
146500     ELSE                                                         14650000
146600         SUBTRACT +1 FROM ASC-SEL-ITEM                            14660000
146700         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 14670000
146800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14680000
146900         SET DP020-MSG-INFORMATIONAL                              14690000
147000                                   TO TRUE                        14700000
147100     END-IF.                                                      14710000
147200                                                                  14720000
147300/                                                                 14730000
147400******************************************************************14740000
147500* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *14750000
147600* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *14760000
147700******************************************************************14770000
147800 2310-GET-PREV-RECORD.                                            14780000
147900                                                                  14790000
148000     SUBTRACT +1 FROM ASC-SEL-SUB.                                14800000
148100                                                                  14810000
148200     IF ASC-SEL-SUB < +1                                          14820000
148300         SUBTRACT +1 FROM ASC-SEL-ITEM                            14830000
148400         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 14840000
148500     END-IF.                                                      14850000
148600                                                                  14860000
148700     IF ASC-SEL-ITEM > ZERO                                       14870000
148800         PERFORM 9100-READ-SEL-QUEUE                              14880000
148900         MOVE RC013-PKSL-NBR     (ASC-SEL-SUB)                    14890000
149000                                   TO ASC-KEY-PKSL-NBR            14900000
149100         MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB)                    14910000
149200                                   TO ASC-KEY-REC-SEQ-NBR         14920000
149300         MOVE RC013-STR-NBR      (ASC-SEL-SUB)                    14930000
149400                                   TO ASC-KEY-STR-DEST-NBR        14940000
149500         MOVE RC013-SEQ-NBR      (ASC-SEL-SUB)                    14950000
149600                                   TO ASC-KEY-SEQ-NBR             14960000
149700                                      DK-SEQ-NBR-B                14970000
149800                                      DK-SEQ-NBR-E                14980000
149900     ELSE                                                         14990000
150000         MOVE +1                   TO ASC-SEL-ITEM                15000000
150100                                      ASC-SEL-SUB                 15010000
150200*        --- TOP OF LIST ---                                      15020000
150300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15030000
150400         SET DP020-MSG-INFORMATIONAL                              15040000
150500                                   TO TRUE                        15050000
150600     END-IF.                                                      15060000
150700                                                                  15070000
150800/                                                                 15080000
150900******************************************************************15090000
151000* THE USER CAN CHANGE THE SEARCH FOR VENDOR STYLE FIELD TO       *15100000
151100* REPOSITION THE LIST TO THE NEXT VENDOR STYLE THAT IS EQUAL OR  *15110000
151200* GREATER THAN THE SEARCH FOR VENDOR STYLE ENTERED.              *15120000
151300******************************************************************15130000
151400 2400-CHECK-FOR-SEARCH-STYLE.                                     15140000
151500                                                                  15150000
151600     MOVE 99999                    TO ASC-START-ITEM-REQUEST-N.   15160000
151700                                                                  15170000
151800     PERFORM 2500-SEARCH-LISTQ-CNTL                               15180000
151900         VARYING PV-ITEM                                          15190000
152000         FROM 1 BY 1                                              15200000
152100         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                15210000
152200         OR ASC-KEY-SEARCH-STYLE < LQW-VEND-STYL-NAME (LQW-IDX)   15220000
152300         OR ASC-KEY-SEARCH-STYLE = LQW-VEND-STYL-NAME (LQW-IDX).  15230000
152400                                                                  15240000
152500     IF PS-INVALID-SEARCH-STYLE                                   15250000
152600         MOVE PC-TSYMSG-00148      TO DP020-MSG-NUMBER            15260000
152700         MOVE -1                   TO ASTYLEL                     15270000
152800         SET DP030-SET-CURSOR-APPL-1                              15280000
152900                                   TO TRUE                        15290000
153000         MOVE DP015-REVERSE        TO ASTYLEH                     15300000
153100         MOVE DP015-YELLOW         TO ASTYLEC                     15310000
153200         MOVE DP015-UNP-ALP-BRT-MDT                               15320000
153300                                   TO ASTYLEA                     15330000
153400         SET DP020-MSG-WARNING     TO TRUE                        15340000
153500         SET PS-ERROR              TO TRUE                        15350000
153600     END-IF.                                                      15360000
153700                                                                  15370000
153800******************************************************************15380000
153900*   READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED       *15390000
154000*   OBJECTS TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.     *15400000
154100******************************************************************15410000
154200 2500-SEARCH-LISTQ-CNTL.                                          15420000
154300                                                                  15430000
154400     PERFORM 6112-READ-LIST-QUEUE.                                15440000
154500                                                                  15450000
154600     IF PV-CICS-RESP = DFHRESP (NORMAL)                           15460000
154700         PERFORM                                                  15470000
154800             VARYING LQW-IDX                                      15480000
154900             FROM 1 BY 1                                          15490000
155000             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   15500000
155100             OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO             15510000
155200                 IF ASC-KEY-SEARCH-STYLE =                        15520000
155300                    LQW-VEND-STYL-NAME (LQW-IDX)  OR              15530000
155400                    ASC-KEY-SEARCH-STYLE <                        15540000
155500                    LQW-VEND-STYL-NAME (LQW-IDX)                  15550000
155600                     SET PS-VALID-SEARCH-STYLE                    15560000
155700                                 TO TRUE                          15570000
155800                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          15580000
155900                                 TO ASC-START-ITEM-REQUEST-N      15590000
156000                     SET LQW-IDX TO PC-ITEMS-PER-PANEL            15600000
156100                     ADD ASC-HIGHEST-BLOCK-WRITTEN                15610000
156200                                 TO PV-ITEM                       15620000
156300                 END-IF                                           15630000
156400         END-PERFORM                                              15640000
156500     END-IF.                                                      15650000
156600                                                                  15660000
156700/                                                                 15670000
156800 3000-EDIT-DATA-IN-COMMAREA.                                      15680000
156900                                                                  15690000
157000     SET PS-NO-ERROR             TO TRUE.                         15700000
157100                                                                  15710000
157200     PERFORM 3200-RESET-ATTRIBUTES.                               15720000
157300                                                                  15730000
157400     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       15740000
157500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       15750000
157600                                          ASC-ITEMS-DISPLAYED - 1.15760000
157700     PERFORM 3100-SET-SUBSCRIPTS.                                 15770000
157800                                                                  15780000
157900     PERFORM 3300-EDIT-SELECTIONS                                 15790000
158000             VARYING PV-SUB  FROM PV-SUB BY -1                    15800000
158100             UNTIL   PV-SUB < +1.                                 15810000
158200                                                                  15820000
158300     IF PS-NO-ERROR                                               15830000
158400         PERFORM 3400-CHECK-RANGE-SEQUENCE                        15840000
158500     END-IF.                                                      15850000
158600                                                                  15860000
158700     IF PS-NO-ERROR AND                                           15870000
158800        ASC-START-OF-SELECTED-RANGE > ZERO AND                    15880000
158900        ASC-END-OF-SELECTED-RANGE > ZERO                          15890000
159000                                                                  15900000
159100         PERFORM 3500-MARK-RANGE-AS-SELECTED                      15910000
159200     END-IF.                                                      15920000
159300                                                                  15930000
159400                                                                  15940000
159500 3100-SET-SUBSCRIPTS.                                             15950000
159600                                                                  15960000
159700     COMPUTE ASC-ITEM-SUB =                                       15970000
159800                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.15980000
159900                                                                  15990000
160000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         16000000
160100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            16010000
160200         MOVE PC-MAX-BLOCKS-IN-ARRAY                              16020000
160300                                 TO ASC-BLK-SUB                   16030000
160400     ELSE                                                         16040000
160500         MOVE +1                 TO ASC-BLK-SUB                   16050000
160600     END-IF.                                                      16060000
160700                                                                  16070000
160800 3200-RESET-ATTRIBUTES.                                           16080000
160900                                                                  16090000
161000     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA.                     16100000
161100     MOVE DP015-GREEN            TO ASTRTITC.                     16110000
161200     MOVE DP015-UNDERLINE        TO ASTRTITH.                     16120000
161300                                                                  16130000
161400     IF  ASC-READ-ONLY                                            16140000
161500         MOVE DP015-ASK-NOR-OFF  TO ASTYLEA                       16150000
161600         MOVE DP015-BLUE         TO ASTYLEC                       16160000
161700         MOVE DP015-HL-OFF       TO ASTYLEH                       16170000
161800     ELSE                                                         16180000
161900         MOVE DP015-UNP-ALP-NOR-OFF                               16190000
162000                                 TO ASTYLEA                       16200000
162100         MOVE DP015-GREEN        TO ASTYLEC                       16210000
162200         MOVE DP015-UNDERLINE    TO ASTYLEH                       16220000
162300     END-IF.                                                      16230000
162400                                                                  16240000
162500     IF DP020-NEXT-ACT-RETURN OR                                  16250000
162600        DP020-NEXT-ACT-READ-MAP                                   16260000
162700         PERFORM VARYING PV-SUB  FROM 1 BY 1                      16270000
162800                 UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             16280000
162900                 MOVE DP015-UNP-ALP-NOR-OFF                       16290000
163000                                 TO MR-SELECTA (PV-SUB)           16300000
163100                 MOVE DP015-GREEN                                 16310000
163200                                 TO MR-SELECTC (PV-SUB)           16320000
163300                 MOVE DP015-UNDERLINE                             16330000
163400                                 TO MR-SELECTH (PV-SUB)           16340000
163500         END-PERFORM                                              16350000
163600     ELSE                                                         16360000
163700         PERFORM VARYING PV-SUB  FROM 1 BY 1                      16370000
163800                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              16380000
163900                 MOVE DP015-UNP-ALP-NOR-OFF                       16390000
164000                                 TO MR-SELECTA (PV-SUB)           16400000
164100                 MOVE DP015-GREEN                                 16410000
164200                                 TO MR-SELECTC (PV-SUB)           16420000
164300                 MOVE DP015-UNDERLINE                             16430000
164400                                 TO MR-SELECTH (PV-SUB)           16440000
164500         END-PERFORM                                              16450000
164600     END-IF.                                                      16460000
164700                                                                  16470000
164800 3300-EDIT-SELECTIONS.                                            16480000
164900                                                                  16490000
165000     EVALUATE TRUE                                                16500000
165100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   16510000
165200                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16520000
165300              CONTINUE                                            16530000
165400                                                                  16540000
165500         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        16550000
165600              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        16560000
165700                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  16570000
165800                  MOVE ASC-TEMP-SELECTED-SW                       16580000
165900                                        (ASC-BLK-SUB ASC-ITEM-SUB)16590000
166000                                 TO ASC-SELECTED-SW               16600000
166100                                        (ASC-BLK-SUB ASC-ITEM-SUB)16610000
166200              END-IF                                              16620000
166300                                                                  16630000
166400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   16640000
166500                                                             SPACE16650000
166600              EVALUATE TRUE                                       16660000
166700                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     16670000
166800                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS16680000
166900                     MOVE SPACE  TO ASC-SELECTED-SW               16690000
167000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16700000
167100                                                                  16710000
167200                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     16720000
167300                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   16730000
167400                       MOVE SPACE                                 16740000
167500                                 TO ASC-SELECTED-SW               16750000
167600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16760000
167700                                                                  16770000
167800                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     16780000
167900                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     16790000
168000                       MOVE SPACE                                 16800000
168100                                 TO ASC-SELECTED-SW               16810000
168200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16820000
168300             END-EVALUATE                                         16830000
168400                                                                  16840000
168500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           16850000
168600              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           16860000
168700                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   16870000
168800              END-IF                                              16880000
168900                                                                  16890000
169000              PERFORM 3310-EDIT-RANGE                             16900000
169100                                                                  16910000
169200         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            16920000
169300              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16930000
169400                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   16940000
169500              END-IF                                              16950000
169600                                                                  16960000
169700              PERFORM 3310-EDIT-RANGE                             16970000
169800                                                                  16980000
169900         WHEN OTHER                                               16990000
170000              MOVE PC-TSYMSG-00005                                17000000
170100                                 TO DP020-MSG-NUMBER              17010000
170200              SET PS-ERROR                                        17020000
170300                  DP020-MSG-FATAL                                 17030000
170400                  DP030-SET-CURSOR-APPL-1                         17040000
170500                                 TO TRUE                          17050000
170600              MOVE -1            TO MR-SELECTL (PV-SUB)           17060000
170700              MOVE DP015-RED     TO MR-SELECTC (PV-SUB)           17070000
170800              MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)           17080000
170900              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17090000
171000                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    17100000
171100                  MOVE SPACE     TO ASC-SELECTED-SW               17110000
171200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17120000
171300              END-IF                                              17130000
171400     END-EVALUATE.                                                17140000
171500                                                                  17150000
171600     SUBTRACT +1 FROM PV-ITEM-IN-USE                              17160000
171700                      ASC-ITEM-SUB.                               17170000
171800     IF ASC-ITEM-SUB < 1                                          17180000
171900         SUBTRACT +1 FROM ASC-BLK-SUB                             17190000
172000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB.                 17200000
172100                                                                  17210000
172200 3310-EDIT-RANGE.                                                 17220000
172300                                                                  17230000
172400     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 17240000
172500        IF ASC-START-OF-SELECTED-RANGE = ZERO                     17250000
172600            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  17260000
172700                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  17270000
172800            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   17280000
172900        ELSE                                                      17290000
173000            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       17300000
173100                CONTINUE                                          17310000
173200            ELSE                                                  17320000
173300                MOVE PC-TSYMSG-00054                              17330000
173400                                 TO DP020-MSG-NUMBER              17340000
173500                SET DP020-MSG-FATAL                               17350000
173600                    PS-ERROR                                      17360000
173700                    DP030-SET-CURSOR-APPL-1                       17370000
173800                                 TO TRUE                          17380000
173900                MOVE -1          TO MR-SELECTL (PV-SUB)           17390000
174000                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           17400000
174100                MOVE DP015-UNDERLINE                              17410000
174200                                 TO MR-SELECTH (PV-SUB)           17420000
174300            END-IF                                                17430000
174400        END-IF                                                    17440000
174500     ELSE                                                         17450000
174600         IF ASC-END-OF-SELECTED-RANGE = ZERO                      17460000
174700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 17470000
174800                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 17480000
174900             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     17490000
175000         ELSE                                                     17500000
175100             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        17510000
175200                 CONTINUE                                         17520000
175300             ELSE                                                 17530000
175400                MOVE PC-TSYMSG-00055                              17540000
175500                                 TO DP020-MSG-NUMBER              17550000
175600                SET DP020-MSG-FATAL                               17560000
175700                    PS-ERROR                                      17570000
175800                    DP030-SET-CURSOR-APPL-1                       17580000
175900                                 TO TRUE                          17590000
176000                MOVE -1          TO MR-SELECTL (PV-SUB)           17600000
176100             END-IF                                               17610000
176200         END-IF                                                   17620000
176300     END-IF.                                                      17630000
176400                                                                  17640000
176500 3400-CHECK-RANGE-SEQUENCE.                                       17650000
176600                                                                  17660000
176700     IF ASC-START-OF-SELECTED-RANGE > ZERO AND                    17670000
176800        ASC-END-OF-SELECTED-RANGE   > ZERO AND                    17680000
176900        ASC-START-OF-SELECTED-RANGE > ASC-END-OF-SELECTED-RANGE   17690000
177000         MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER              17700000
177100         SET PS-ERROR                                             17710000
177200             DP020-MSG-FATAL     TO TRUE                          17720000
177300                                                                  17730000
177400         PERFORM 3410-POSITION-AT-ERROR.                          17740000
177500                                                                  17750000
177600 3410-POSITION-AT-ERROR.                                          17760000
177700                                                                  17770000
177800     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         17780000
177900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               17790000
178000                                                  PV-TOP-ITEM + 1.17800000
178100     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       17810000
178200         CONTINUE                                                 17820000
178300     ELSE                                                         17830000
178400         MOVE -1                 TO MR-SELECTL (PV-SUB)           17840000
178500         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           17850000
178600         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           17860000
178700     END-IF.                                                      17870000
178800                                                                  17880000
178900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.17890000
179000     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       17900000
179100         CONTINUE                                                 17910000
179200     ELSE                                                         17920000
179300         MOVE -1                 TO MR-SELECTL (PV-SUB)           17930000
179400         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           17940000
179500         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           17950000
179600     END-IF.                                                      17960000
179700                                                                  17970000
179800 3500-MARK-RANGE-AS-SELECTED.                                     17980000
179900                                                                  17990000
180000     MOVE +1                     TO ASC-BLK-SUB.                  18000000
180100                                                                  18010000
180200     PERFORM 3510-MARK-SELECTED-INDS                              18020000
180300             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    18030000
180400             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           18040000
180500                                                                  18050000
180600     ADD +1                      TO ASC-BLK-SUB.                  18060000
180700                                                                  18070000
180800     PERFORM 3510-MARK-SELECTED-INDS                              18080000
180900             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    18090000
181000             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           18100000
181100                                                                  18110000
181200     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              18120000
181300                                 TO PV-LIST-ITEM-NUMBER.          18130000
181400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1 +                        18140000
181500                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).18150000
181600     MOVE ASC-START-OF-SELECTED-RANGE                             18160000
181700                                 TO PV-START-OF-SELECTED-RANGE.   18170000
181800     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        18180000
181900             ((PV-START-OF-SELECTED-RANGE - 1) /                  18190000
182000                                              PC-ITEMS-PER-PANEL).18200000
182100     MOVE ASC-END-OF-SELECTED-RANGE                               18210000
182200                                 TO PV-END-OF-SELECTED-RANGE.     18220000
182300     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         18230000
182400             ((PV-END-OF-SELECTED-RANGE - 1) /                    18240000
182500                                              PC-ITEMS-PER-PANEL).18250000
182600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY = PV-FIRST-BLOCK-IN-ARRAY + 1.18260000
182700                                                                  18270000
182800     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    18280000
182900        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        18290000
183000         MOVE +1                 TO ASC-BLK-SUB                   18300000
183100                                                                  18310000
183200         PERFORM 5100-WRITE-TEMP-STORAGE                          18320000
183300                                                                  18330000
183400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18340000
183500                                       PV-FIRST-BLOCK-IN-ARRAY - 118350000
183600                                                                  18360000
183700         PERFORM                                                  18370000
183800           UNTIL PV-FIRST-BLOCK-IN-RANGE > PV-PREV-BLOCK-IN-ARRAY 18380000
183900                 MOVE PV-FIRST-BLOCK-IN-RANGE TO PV-BLOCK-NUMBER  18390000
184000                                                                  18400000
184100                 PERFORM 4410-READ-TEMP-STORAGE                   18410000
184200                                                                  18420000
184300                 PERFORM 3510-MARK-SELECTED-INDS                  18430000
184400                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        18440000
184500                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL18450000
184600                                                                  18460000
184700                 PERFORM 5100-WRITE-TEMP-STORAGE                  18470000
184800                                                                  18480000
184900                 ADD +1          TO PV-FIRST-BLOCK-IN-RANGE       18490000
185000         END-PERFORM                                              18500000
185100                                                                  18510000
185200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18520000
185300                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY18530000
185400         PERFORM                                                  18540000
185500           UNTIL PV-NEXT-BLOCK-IN-ARRAY > PV-LAST-BLOCK-IN-RANGE  18550000
185600                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      18560000
185700                                 TO PV-BLOCK-NUMBER               18570000
185800                                                                  18580000
185900                 PERFORM 4410-READ-TEMP-STORAGE                   18590000
186000                                                                  18600000
186100                 PERFORM 3510-MARK-SELECTED-INDS                  18610000
186200                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        18620000
186300                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL18630000
186400                                                                  18640000
186500                 PERFORM 5100-WRITE-TEMP-STORAGE                  18650000
186600                                                                  18660000
186700                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        18670000
186800         END-PERFORM                                              18680000
186900                                                                  18690000
187000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18700000
187100                                 TO PV-BLOCK-NUMBER               18710000
187200                                                                  18720000
187300         PERFORM 4410-READ-TEMP-STORAGE                           18730000
187400                                                                  18740000
187500     END-IF.                                                      18750000
187600                                                                  18760000
187700     MOVE ZERO                   TO ASC-START-OF-SELECTED-RANGE   18770000
187800                                    ASC-END-OF-SELECTED-RANGE.    18780000
187900                                                                  18790000
188000 3510-MARK-SELECTED-INDS.                                         18800000
188100                                                                  18810000
188200     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT <     18820000
188300                                       ASC-START-OF-SELECTED-RANGE18830000
188400        IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT >  18840000
188500                                         ASC-END-OF-SELECTED-RANGE18850000
188600           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           18860000
188700               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          18870000
188800                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               18880000
188900                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     18890000
189000                                 TO TRUE                          18900000
189100               ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS  18910000
189200           END-IF                                                 18920000
189300        END-IF                                                    18930000
189400     END-IF.                                                      18940000
189500                                                                  18950000
189600 4000-BUILD-INITIAL-PANEL.                                        18960000
189700                                                                  18970000
189800     INITIALIZE ASC-BLOCK-ENTRIES (1)                             18980000
189900                ASC-BLOCK-ENTRIES (2).                            18990000
190000     MOVE +1                     TO ASC-BLK-SUB.                  19000000
190100     SET ASC-MORE-PACK-SLIP-ITEMS                                 19010000
190200                                 TO TRUE.                         19020000
190300                                                                  19030000
190400     MOVE ZERO                   TO ASC-ITEM-SUB                  19040000
190500                                    ASC-NUMBER-OF-ITEMS-READ      19050000
190600                                    ASC-NUMBER-OF-SELECTED-ITEMS  19060000
190700                                    ASC-HIGHEST-BLOCK-WRITTEN     19070000
190800                                    ASC-START-OF-SELECTED-RANGE   19080000
190900                                    ASC-END-OF-SELECTED-RANGE     19090000
191000                                    ASC-ITEM-AT-TOP-OF-PANEL.     19100000
191100                                                                  19110000
191200     PERFORM 4010-FORMAT-KEYS.                                    19120000
191300     PERFORM 4100-GET-TRECEIV.                                    19130000
191400     PERFORM 4020-GET-VENDOR-NAME.                                19140000
191500                                                                  19150000
191600     PERFORM 4030-OPEN-CURSOR.                                    19160000
191700                                                                  19170000
191800     PERFORM 4040-GET-PACK-SLIP-ITEMS.                            19180000
191900                                                                  19190000
192000     PERFORM 4050-CLOSE-CURSOR.                                   19200000
192100                                                                  19210000
192200     MOVE +1                     TO PV-TOP-ITEM.                  19220000
192300                                                                  19230000
192400*&   IF ASC-NUMBER-OF-ITEMS-READ = ZERO                           19240000
192500*&       SET DP020-MSG-FATAL                                      19250000
192600*&           DP020-NEXT-ACT-APPL-ERROR                            19260000
192700*&                               TO TRUE                          19270000
192800*&       MOVE PC-TSYMSG-00050    TO DP020-MSG-NUMBER              19280000
192900*&   ELSE                                                         19290000
193000         MOVE -1                 TO ASTYLEL                       19300000
193100         SET DP030-SET-CURSOR-APPL-1                              19310000
193200                                 TO TRUE                          19320000
193300                                                                  19330000
193400         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                    19340000
193500*&   END-IF.                                                      19350000
193600                                                                  19360000
193700 4010-FORMAT-KEYS.                                                19370000
193800                                                                  19380000
193900     MOVE ASC-KEY-PO-NBR         TO DK-PO-NBR.                    19390000
194000     MOVE ASC-KEY-REC-SEQ-NBR    TO DK-REC-SEQ-NBR.               19400000
194100     MOVE ASC-KEY-PKSL-NBR       TO DK-PKSL-NBR.                  19410000
194200     MOVE ASC-KEY-SEQ-NBR        TO DK-SEQ-NBR-B                  19420000
194300                                    DK-SEQ-NBR-E.                 19430000
194400     MOVE ASC-KEY-OPER-UNT-ID    TO DK-OPER-UNT-ID.               19440000
194500     MOVE ASC-KEY-FCLTY-ID       TO DK-FCLTY-ID.                  19450000
194600                                                                  19460000
194700 4020-GET-VENDOR-NAME.                                            19470000
194800                                                                  19480000
194900     PERFORM WITH TEST AFTER                                      19490000
195000         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    19500000
195100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             19510000
195200                 SQLCODE = ZERO OR                                19520000
195300                 SQLCODE = +100                                   19530000
195400                                                                  19540000
195500         EXEC SQL                                                 19550000
195600              SELECT B.ENT_NAME_DESC                              19560000
195700                INTO :ENTNME-ENT-NAME-DESC                        19570000
195800                FROM TPURCHS A,                                   19580000
195900                     TENTNME B                                    19590000
196000               WHERE A.VER_STATUS_CDE = :PC-ACTIVE                19600000
196100                 AND A.PO_NBR         = :DK-PO-NBR                19610000
196200                 AND A.ENT_ID         = B.ENT_ID                  19620000
196300                 AND B.TYPE_CDE       = :PC-01                    19630000
196400         END-EXEC                                                 19640000
196500                                                                  19650000
196600         EVALUATE TRUE                                            19660000
196700             WHEN SQLCODE = ZERO                                  19670000
196800             WHEN SQLCODE = +100                                  19680000
196900             WHEN SQLCODE = -904                                  19690000
197000             WHEN SQLCODE = -913                                  19700000
197100                  CONTINUE                                        19710000
197200                                                                  19720000
197300             WHEN SQLWARN0 NOT = SPACES                           19730000
197400             WHEN SQLCODE  NOT = ZERO                             19740000
197500                  MOVE '4020-GET-VENDOR-NAME'                     19750000
197600                                 TO DP013-PARAGRAPH               19760000
197700                  MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'       19770000
197800                                 TO DP013-MESSAGE-TEXT (1)        19780000
197900                  MOVE SQLCA     TO DP013-SQLCA                   19790000
198000                  MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)      19800000
198100                  SET DP013-DB2-ABEND                             19810000
198200                      DP013-XCTL-DISPLAY-RESTART                  19820000
198300                                 TO TRUE                          19830000
198400                                                                  19840000
198500                  PERFORM DP013-0000-PROCESS-ABEND                19850000
198600         END-EVALUATE                                             19860000
198700     END-PERFORM.                                                 19870000
198800                                                                  19880000
198900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         19890000
199000         MOVE '4020-GET-VENDOR-NAME'                              19900000
199100                                 TO DP013-PARAGRAPH               19910000
199200         MOVE 'MAX RETRIES EXCEEDED ON SELECT VENDOR NAME'        19920000
199300                                 TO DP013-MESSAGE-TEXT (1)        19930000
199400         MOVE SQLCA              TO DP013-SQLCA                   19940000
199500         MOVE 'TENTNME '         TO DP013-DB2-TABLE-NAME (1)      19950000
199600         SET DP013-XCTL-DISPLAY-RESTART                           19960000
199700             DP013-DB2-ABEND     TO TRUE                          19970000
199800                                                                  19980000
199900         PERFORM DP013-0000-PROCESS-ABEND                         19990000
200000     END-IF.                                                      20000000
200100                                                                  20010000
200200     IF SQLCODE = ZERO                                            20020000
200300         MOVE ENTNME-ENT-NAME-DESC                                20030000
200400                                 TO ASC-KEY-VENDOR-NAME           20040000
200500     ELSE                                                         20050000
200600         IF SQLCODE = +100                                        20060000
200700             MOVE 'VENDOR NOT FOUND'                              20070000
200800                                 TO ASC-KEY-VENDOR-NAME           20080000
200900         END-IF                                                   20090000
201000     END-IF.                                                      20100000
201100                                                                  20110000
201200 4030-OPEN-CURSOR.                                                20120000
201300                                                                  20130000
201400     PERFORM WITH TEST AFTER                                      20140000
201500         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    20150000
201600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             20160000
201700                 SQLCODE = ZERO                                   20170000
201800                                                                  20180000
201900         EXEC SQL                                                 20190000
202000              OPEN ITEM-CURSOR                                    20200000
202100         END-EXEC                                                 20210000
202200                                                                  20220000
202300         EVALUATE TRUE                                            20230000
202400             WHEN SQLCODE = ZERO                                  20240000
202500             WHEN SQLCODE = -904                                  20250000
202600             WHEN SQLCODE = -913                                  20260000
202700                  CONTINUE                                        20270000
202800                                                                  20280000
202900             WHEN SQLWARN0 NOT = SPACES                           20290000
203000             WHEN SQLCODE  NOT = ZERO                             20300000
203100                  MOVE '4030-OPEN-CURSOR'                         20310000
203200                                 TO DP013-PARAGRAPH               20320000
203300                  MOVE 'UNSUCCESSFUL PACK SLIP ITEM CURSOR OPEN'  20330000
203400                                 TO DP013-MESSAGE-TEXT (1)        20340000
203500                  MOVE SQLCA TO DP013-SQLCA                       20350000
203600                  MOVE 'TPKITEM' TO DP013-DB2-TABLE-NAME (1)      20360000
203700                  MOVE 'TUNPKSL' TO DP013-DB2-TABLE-NAME (2)      20370000
203800                  SET DP013-XCTL-DISPLAY-RESTART                  20380000
203900                      DP013-DB2-ABEND                             20390000
204000                                 TO TRUE                          20400000
204100                                                                  20410000
204200                  PERFORM DP013-0000-PROCESS-ABEND                20420000
204300         END-EVALUATE                                             20430000
204400     END-PERFORM.                                                 20440000
204500                                                                  20450000
204600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         20460000
204700         MOVE '4030-OPEN-CURSOR' TO DP013-PARAGRAPH               20470000
204800         MOVE 'MAX RETRIES EXCEEDED ON PKSLIP ITEM CURSOR OPEN'   20480000
204900                                 TO DP013-MESSAGE-TEXT (1)        20490000
205000         MOVE SQLCA              TO DP013-SQLCA                   20500000
205100         MOVE 'TPKITEM '         TO DP013-DB2-TABLE-NAME (1)      20510000
205200         MOVE 'TUNPKSL '         TO DP013-DB2-TABLE-NAME (2)      20520000
205300         SET DP013-XCTL-DISPLAY-RESTART                           20530000
205400             DP013-DB2-ABEND     TO TRUE                          20540000
205500                                                                  20550000
205600         PERFORM DP013-0000-PROCESS-ABEND                         20560000
205700     END-IF.                                                      20570000
205800                                                                  20580000
205900 4040-GET-PACK-SLIP-ITEMS.                                        20590000
206000                                                                  20600000
206100     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   20610000
206200         UNTIL PV-READ-COUNT > PC-MAX-ITEMS OR                    20620000
206300               ASC-NO-MORE-PACK-SLIP-ITEMS                        20630000
206400                                                                  20640000
206500         PERFORM 4042-FETCH-PACK-SLIP-ITEM                        20650000
206600                                                                  20660000
206700         IF ASC-MORE-PACK-SLIP-ITEMS                              20670000
206800             IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 20680000
206900                 ADD +1          TO ASC-ITEM-SUB                  20690000
207000             ELSE                                                 20700000
207100                 ADD +1          TO ASC-BLK-SUB                   20710000
207200                 MOVE +1         TO ASC-ITEM-SUB                  20720000
207300                                                                  20730000
207400                 IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY          20740000
207500                     MOVE +1     TO ASC-BLK-SUB                   20750000
207600                     SET ASC-BLOCK-MODIFIED (1)                   20760000
207700                                 TO TRUE                          20770000
207800                                                                  20780000
207900                     PERFORM 5100-WRITE-TEMP-STORAGE              20790000
208000                                                                  20800000
208100                     MOVE ASC-BLOCK-ENTRIES                       20810000
208200                                          (PC-MAX-BLOCKS-IN-ARRAY)20820000
208300                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)20830000
208400                     ADD +1      TO ASC-BLK-SUB                   20840000
208500                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   20850000
208600                     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)     20860000
208700                                 TO TRUE                          20870000
208800                 END-IF                                           20880000
208900             END-IF                                               20890000
209000             MOVE PV-PKSL-LNE-NBR                                 20900000
209100                                 TO DK-ORD-LNE-NBR                20910000
209200             MOVE PURITM-PO-PREPK-ID                              20920011
209300                                 TO DK-PREPK-ID                   20930007
209400             PERFORM 4200-FETCH-TROUBLE                           20940000
209500             ADD +1              TO ASC-NUMBER-OF-ITEMS-READ      20950000
209600             MOVE ASC-NUMBER-OF-ITEMS-READ                        20960000
209700                                 TO ASC-LIST-ITEM-NUMBER          20970000
209800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20980000
209900             MOVE PV-PKSL-STAT-CDE                                20990000
210000                                 TO ASC-KEY-PKSL-STAT-CDE         21000000
210100             MOVE PV-PKSL-LNE-NBR                                 21010000
210200                                 TO ASC-PKSL-LNE-NBR-N            21020000
210300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21030000
210400             MOVE PV-PKSL-ITM-QTY                                 21040000
210500                                 TO ASC-PKSL-ITM-QTY-N            21050000
210600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21060000
210700             MOVE PV-VEND-STYL-NAME                               21070000
210800                                 TO ASC-VEND-STYL-NAME            21080000
210900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21090000
211000             MOVE PV-UNT-COST-AMT                                 21100000
211100                                 TO ASC-UNT-COST-AMT-N            21110000
211200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21120000
211300             MOVE PV-COLOR-DESC  TO ASC-COLOR-DESC                21130000
211400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21140000
211500             MOVE PV-VEND-DESC   TO ASC-VEND-DESC                 21150000
211600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21160000
211700             MOVE PV-TROUBLE-DESC TO ASC-TROUBLE                  21170000
211800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21180000
211900             MOVE PV-SIZE-DESC   TO ASC-SIZE-DESC                 21190000
212000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21200000
212100*MIKE, ADD RECITM SELECT AND CHECK|                               21210000
212200         END-IF                                                   21220000
212300     END-PERFORM.                                                 21230000
212400                                                                  21240000
212500     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           21250000
212600         MOVE +1                 TO ASC-BLK-SUB                   21260000
212700                                                                  21270000
212800         PERFORM 5100-WRITE-TEMP-STORAGE                          21280000
212900                                                                  21290000
213000         ADD +1                  TO ASC-BLK-SUB                   21300000
213100                                                                  21310000
213200         PERFORM 5100-WRITE-TEMP-STORAGE                          21320000
213300                                                                  21330000
213400         MOVE +1                 TO ASC-BLK-SUB                   21340000
213500                                    PV-BLOCK-NUMBER               21350000
213600                                                                  21360000
213700         PERFORM 4410-READ-TEMP-STORAGE                           21370000
213800                                                                  21380000
213900         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         21390000
214000             MOVE +2             TO ASC-BLK-SUB                   21400000
214100                                    PV-BLOCK-NUMBER               21410000
214200                                                                  21420000
214300             PERFORM 4410-READ-TEMP-STORAGE                       21430000
214400         END-IF                                                   21440000
214500     END-IF.                                                      21450000
214600                                                                  21460000
214700 4042-FETCH-PACK-SLIP-ITEM.                                       21470000
214800                                                                  21480000
214900     EXEC SQL                                                     21490000
215000          FETCH  ITEM-CURSOR                                      21500000
215100           INTO :PV-PKSL-LNE-NBR,                                 21510000
215200                :PV-PKSL-ITM-QTY,                                 21520000
215300                :PV-VEND-STYL-NAME,                               21530000
215400                :PV-UNT-COST-AMT,                                 21540000
215500                :PV-COLOR-DESC,                                   21550000
215600                :PV-VEND-DESC,                                    21560000
215700                :PV-SIZE-DESC,                                    21570000
215800                :PV-PKSL-STAT-CDE,                                21580000
215900                :PV-SEQ-NBR,                                      21590010
216000                :PURITM-PO-PREPK-ID                               21600007
216100     END-EXEC.                                                    21610000
216200                                                                  21620000
216300     EVALUATE TRUE                                                21630000
216400         WHEN SQLCODE = ZERO                                      21640000
216500              MOVE PV-SEQ-NBR    TO ASC-KEY-SEQ-NBR               21650000
216600         WHEN SQLCODE = +100                                      21660000
216700              SET ASC-NO-MORE-PACK-SLIP-ITEMS                     21670000
216800                                 TO TRUE                          21680000
216900                                                                  21690000
217000         WHEN SQLWARN0 NOT = SPACES                               21700000
217100         WHEN SQLCODE  NOT = ZERO                                 21710000
217200              MOVE '4042-FETCH-PACK-SLIP-ITEM'                    21720000
217300                                 TO DP013-PARAGRAPH               21730000
217400              MOVE 'UNSUCCESSFUL FETCH PACK SLIP ITEM CURSOR'     21740000
217500                                 TO DP013-MESSAGE-TEXT (1)        21750000
217600              MOVE SQLCA         TO DP013-SQLCA                   21760000
217700              MOVE 'TPKITEM'     TO DP013-DB2-TABLE-NAME (1)      21770000
217800              MOVE 'TUNPKSL'     TO DP013-DB2-TABLE-NAME (2)      21780000
217900              SET DP013-DB2-ABEND                                 21790000
218000                  DP013-XCTL-DISPLAY-RESTART                      21800000
218100                                 TO TRUE                          21810000
218200                                                                  21820000
218300              PERFORM DP013-0000-PROCESS-ABEND                    21830000
218400     END-EVALUATE.                                                21840000
218500                                                                  21850000
218600                                                                  21860000
218700 4050-CLOSE-CURSOR.                                               21870000
218800                                                                  21880000
218900     EXEC SQL                                                     21890000
219000          CLOSE ITEM-CURSOR                                       21900000
219100     END-EXEC.                                                    21910000
219200                                                                  21920000
219300     EVALUATE TRUE                                                21930000
219400         WHEN SQLCODE = ZERO                                      21940000
219500              CONTINUE                                            21950000
219600                                                                  21960000
219700         WHEN SQLWARN0 NOT = SPACES                               21970000
219800         WHEN SQLCODE  NOT = ZERO                                 21980000
219900              MOVE '4050-CLOSE-CURSOR'                            21990000
220000                                 TO DP013-PARAGRAPH               22000000
220100              MOVE 'UNSUCCESSFUL PACK SLIP ITEM CURSOR CLOSE'     22010000
220200                                 TO DP013-MESSAGE-TEXT (1)        22020000
220300              MOVE SQLCA TO DP013-SQLCA                           22030000
220400              MOVE 'TPKITEM '    TO DP013-DB2-TABLE-NAME (1)      22040000
220500              MOVE 'TUNPKSL '    TO DP013-DB2-TABLE-NAME (2)      22050000
220600              SET DP013-DB2-ABEND                                 22060000
220700                  DP013-XCTL-DISPLAY-RESTART                      22070000
220800                                 TO TRUE                          22080000
220900                                                                  22090000
221000              PERFORM DP013-0000-PROCESS-ABEND                    22100000
221100     END-EVALUATE.                                                22110000
221200/                                                                 22120000
221300 4100-GET-TRECEIV.                                                22130000
221400                                                                  22140000
221500     PERFORM WITH TEST AFTER                                      22150000
221600         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    22160000
221700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             22170000
221800                 SQLCODE = ZERO OR                                22180000
221900                 SQLCODE = +100                                   22190000
222000                                                                  22200000
222100         EXEC SQL                                                 22210000
222200              SELECT                                              22220000
222300                     STATUS_CDE                                   22230000
222400                INTO                                              22240000
222500                     :RECEIV-STATUS-CDE                           22250000
222600                FROM                                              22260000
222700                     TRECEIV                                      22270000
222800               WHERE                                              22280000
222900                     ORD_NBR          =  :DK-PO-NBR               22290000
223000                AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR          22300000
223100                AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID          22310000
223200                AND  FCLTY_ID         =  :DK-FCLTY-ID             22320000
223300                AND  VER_STATUS_CDE   =  :PC-ACTIVE               22330000
223400         END-EXEC                                                 22340000
223500                                                                  22350000
223600         EVALUATE TRUE                                            22360000
223700             WHEN SQLCODE = ZERO                                  22370000
223800             WHEN SQLCODE = +100                                  22380000
223900             WHEN SQLCODE = -904                                  22390000
224000             WHEN SQLCODE = -913                                  22400000
224100                  CONTINUE                                        22410000
224200                                                                  22420000
224300             WHEN SQLWARN0 NOT = SPACES                           22430000
224400             WHEN SQLCODE  NOT = ZERO                             22440000
224500                  MOVE '4100-GET-TRECEIV'                         22450000
224600                                 TO DP013-PARAGRAPH               22460000
224700                  MOVE 'UNSUCCESSFUL SELECT OF RECEIVER STATUS'   22470000
224800                                 TO DP013-MESSAGE-TEXT (1)        22480000
224900                  MOVE SQLCA     TO DP013-SQLCA                   22490000
225000                  MOVE 'TRECEIV' TO DP013-DB2-TABLE-NAME (1)      22500000
225100                  SET DP013-DB2-ABEND                             22510000
225200                      DP013-XCTL-DISPLAY-RESTART                  22520000
225300                                 TO TRUE                          22530000
225400                                                                  22540000
225500                  PERFORM DP013-0000-PROCESS-ABEND                22550000
225600         END-EVALUATE                                             22560000
225700     END-PERFORM.                                                 22570000
225800                                                                  22580000
225900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         22590000
226000         MOVE '4100-GET-TRECEIV'                                  22600000
226100                                 TO DP013-PARAGRAPH               22610000
226200         MOVE 'MAX RETRIES EXCEEDED ON SELECT RECEIVER STATUS'    22620000
226300                                 TO DP013-MESSAGE-TEXT (1)        22630000
226400         MOVE SQLCA              TO DP013-SQLCA                   22640000
226500         MOVE 'TRECEIV '         TO DP013-DB2-TABLE-NAME (1)      22650000
226600         SET DP013-XCTL-DISPLAY-RESTART                           22660000
226700             DP013-DB2-ABEND     TO TRUE                          22670000
226800                                                                  22680000
226900         PERFORM DP013-0000-PROCESS-ABEND                         22690000
227000     END-IF.                                                      22700000
227100                                                                  22710000
227200     IF  RECEIV-STATUS-CDE EQUAL PC-CM OR PC-VE                   22720000
227300         SET ASC-READ-ONLY       TO  TRUE                         22730000
227400     ELSE                                                         22740000
227500         PERFORM 4110-CHECK-RECITM                                22750000
227600     END-IF.                                                      22760000
227700                                                                  22770000
227800                                                                  22780002
227900                                                                  22790002
228000 4110-CHECK-RECITM.                                               22800000
228100                                                                  22810000
228200     MOVE ZERO           TO  PV-DB2-COUNT.                        22820000
228300     PERFORM WITH TEST AFTER                                      22830000
228400         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    22840000
228500         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             22850000
228600                 SQLCODE = ZERO OR                                22860000
228700                 SQLCODE = +100                                   22870000
228800                                                                  22880000
228900         EXEC SQL                                                 22890000
229000              SELECT                                              22900000
229100                     COUNT(*)                                     22910000
229200                INTO                                              22920000
229300                     :PV-DB2-COUNT :PV-NULL-IND                   22930000
229400                FROM                                              22940000
229500                     TRECITM                                      22950000
229600               WHERE                                              22960000
229700                     ORD_NBR          =  :DK-PO-NBR               22970000
229800                AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR          22980000
229900                AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID          22990000
230000                AND  FCLTY_ID         =  :DK-FCLTY-ID             23000000
230100                AND  VER_STATUS_CDE   =  :PC-ACTIVE               23010000
230200                AND  STATUS_CDE       =  :PC-VE                   23020000
230300         END-EXEC                                                 23030000
230400                                                                  23040000
230500         EVALUATE TRUE                                            23050000
230600             WHEN SQLCODE = ZERO                                  23060000
230700             WHEN SQLCODE = +100                                  23070000
230800             WHEN SQLCODE = -904                                  23080000
230900             WHEN SQLCODE = -913                                  23090000
231000                  CONTINUE                                        23100000
231100                                                                  23110000
231200             WHEN SQLWARN0 NOT = SPACES                           23120000
231300             WHEN SQLCODE  NOT = ZERO                             23130000
231400                  MOVE '4110-CHECK-TRECITM'                       23140000
231500                                 TO DP013-PARAGRAPH               23150000
231600                  MOVE 'UNSUCCESSFUL COUNT OF STATUS "VE"'        23160000
231700                                 TO DP013-MESSAGE-TEXT (1)        23170000
231800                  MOVE SQLCA     TO DP013-SQLCA                   23180000
231900                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      23190000
232000                  SET DP013-DB2-ABEND                             23200000
232100                      DP013-XCTL-DISPLAY-RESTART                  23210000
232200                                 TO TRUE                          23220000
232300                                                                  23230000
232400                  PERFORM DP013-0000-PROCESS-ABEND                23240000
232500         END-EVALUATE                                             23250000
232600     END-PERFORM.                                                 23260000
232700                                                                  23270000
232800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         23280000
232900         MOVE '4110-CHECK-TRECITM'                                23290000
233000                                 TO DP013-PARAGRAPH               23300000
233100         MOVE 'MAX RETRIES EXCEEDED ON COUNT "VE" RECITM'         23310000
233200                                 TO DP013-MESSAGE-TEXT (1)        23320000
233300         MOVE SQLCA              TO DP013-SQLCA                   23330000
233400         MOVE 'TRECITM '         TO DP013-DB2-TABLE-NAME (1)      23340000
233500         SET DP013-XCTL-DISPLAY-RESTART                           23350000
233600             DP013-DB2-ABEND     TO TRUE                          23360000
233700                                                                  23370000
233800         PERFORM DP013-0000-PROCESS-ABEND                         23380000
233900     END-IF.                                                      23390000
234000                                                                  23400000
234100     IF  PV-DB2-COUNT GREATER THAN ZERO                           23410000
234200         SET ASC-READ-ONLY       TO  TRUE                         23420000
234300     ELSE                                                         23430000
234400         SET ASC-UPDATES-ALLOWED TO  TRUE                         23440000
234500     END-IF.                                                      23450000
234600/                                                                 23460000
234700 4200-FETCH-TROUBLE.                                              23470000
234800     PERFORM 4210-OPEN-TRBL-CSR.                                  23480000
234900     PERFORM 4220-FETCH-TRBL-CSR.                                 23490000
235000     IF SQLCODE = +100                                            23500000
235100         MOVE SPACES TO PV-TROUBLE-DESC                           23510000
235200     ELSE                                                         23520000
235300         MOVE TRBRSN-TRBL-SHT-DESC TO PV-TROUBLE                  23530000
235400         PERFORM 4220-FETCH-TRBL-CSR                              23540000
235500         IF SQLCODE = +100                                        23550000
235600             MOVE SPACES TO PV-TROUBLE-PLUS                       23560000
235700         ELSE                                                     23570000
235800             MOVE '+' TO PV-TROUBLE-PLUS                          23580000
235900         END-IF                                                   23590000
236000     END-IF.                                                      23600000
236100     PERFORM 4230-CLOSE-TRBL-CSR.                                 23610000
236200                                                                  23620000
236300                                                                  23630000
236400 4210-OPEN-TRBL-CSR.                                              23640000
236500                                                                  23650000
236600     PERFORM WITH TEST AFTER                                      23660000
236700         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    23670000
236800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             23680000
236900                 SQLCODE = ZERO                                   23690000
237000                                                                  23700000
237100         EXEC SQL                                                 23710000
237200              OPEN TRBL_CSR                                       23720000
237300         END-EXEC                                                 23730000
237400                                                                  23740000
237500         EVALUATE TRUE                                            23750000
237600             WHEN SQLCODE = ZERO                                  23760000
237700             WHEN SQLCODE = -904                                  23770000
237800             WHEN SQLCODE = -913                                  23780000
237900                  CONTINUE                                        23790000
238000                                                                  23800000
238100             WHEN SQLWARN0 NOT = SPACES                           23810000
238200             WHEN SQLCODE  NOT = ZERO                             23820000
238300                  MOVE '4210-OPEN-TRBL-CSR'                       23830000
238400                                 TO DP013-PARAGRAPH               23840000
238500                  MOVE 'UNSUCCESSFUL TROUBLE CURSOR OPEN'         23850000
238600                                 TO DP013-MESSAGE-TEXT (1)        23860000
238700                  MOVE SQLCA TO DP013-SQLCA                       23870000
238800                  MOVE 'TTRBNTF' TO DP013-DB2-TABLE-NAME (1)      23880000
238900                  MOVE 'TTRBRSN' TO DP013-DB2-TABLE-NAME (2)      23890000
239000                  SET DP013-XCTL-DISPLAY-RESTART                  23900000
239100                      DP013-DB2-ABEND                             23910000
239200                                 TO TRUE                          23920000
239300                                                                  23930000
239400                  PERFORM DP013-0000-PROCESS-ABEND                23940000
239500         END-EVALUATE                                             23950000
239600     END-PERFORM.                                                 23960000
239700                                                                  23970000
239800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         23980000
239900         MOVE '4210-OPEN-TRBL-CSR' TO DP013-PARAGRAPH             23990000
240000         MOVE 'UNSUCCESSFUL TROUBLE CURSOR OPEN'                  24000000
240100                                 TO DP013-MESSAGE-TEXT (1)        24010000
240200         MOVE SQLCA              TO DP013-SQLCA                   24020000
240300         MOVE 'TTRBNTF'          TO DP013-DB2-TABLE-NAME (1)      24030000
240400         MOVE 'TTRBRSN'          TO DP013-DB2-TABLE-NAME (2)      24040000
240500         SET DP013-XCTL-DISPLAY-RESTART                           24050000
240600             DP013-DB2-ABEND     TO TRUE                          24060000
240700                                                                  24070000
240800         PERFORM DP013-0000-PROCESS-ABEND                         24080000
240900     END-IF.                                                      24090000
241000                                                                  24100000
241100 4220-FETCH-TRBL-CSR.                                             24110000
241200     INITIALIZE DCLTTRBRSN.                                       24120000
241300                                                                  24130000
241400     EXEC SQL                                                     24140000
241500         FETCH  TRBL_CSR                                          24150000
241600          INTO  :TRBRSN-TRBL-SHT-DESC                             24160000
241700     END-EXEC.                                                    24170000
241800                                                                  24180000
241900     EVALUATE TRUE                                                24190000
242000         WHEN SQLCODE = ZERO                                      24200000
242100         WHEN SQLCODE = +100                                      24210000
242200             CONTINUE                                             24220000
242300         WHEN SQLWARN0 NOT = SPACES                               24230000
242400         WHEN SQLCODE  NOT = ZERO                                 24240000
242500              MOVE '4220-FETCH-TRBL-CSR'                          24250000
242600                                 TO DP013-PARAGRAPH               24260000
242700              MOVE 'UNSUCCESSFUL FETCH OF TROUBLE CURSOR'         24270000
242800                                 TO DP013-MESSAGE-TEXT (1)        24280000
242900              MOVE SQLCA         TO DP013-SQLCA                   24290000
243000              MOVE 'TTRBNTF'     TO DP013-DB2-TABLE-NAME (1)      24300000
243100              MOVE 'TTRBRSN'     TO DP013-DB2-TABLE-NAME (2)      24310000
243200              SET DP013-DB2-ABEND                                 24320000
243300                  DP013-XCTL-DISPLAY-RESTART                      24330000
243400                                 TO TRUE                          24340000
243500                                                                  24350000
243600              PERFORM DP013-0000-PROCESS-ABEND                    24360000
243700     END-EVALUATE.                                                24370000
243800                                                                  24380000
243900                                                                  24390000
244000 4230-CLOSE-TRBL-CSR.                                             24400000
244100     EXEC SQL                                                     24410000
244200         CLOSE TRBL_CSR                                           24420000
244300     END-EXEC.                                                    24430000
244400                                                                  24440000
244500     EVALUATE TRUE                                                24450000
244600         WHEN SQLWARN0 NOT = SPACE                                24460000
244700         WHEN SQLCODE < ZERO                                      24470000
244800         WHEN SQLCODE > ZERO                                      24480000
244900             MOVE '4230-CLOSE-TRBL-CSR'                           24490000
245000                 TO DP013-PARAGRAPH                               24500000
245100             MOVE 'CLOSE THE TRBL_CSR'                            24510000
245200                 TO DP013-MESSAGE-TEXT (1)                        24520000
245300             MOVE SQLCA            TO DP013-SQLCA                 24530000
245400             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    24540000
245500             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    24550000
245600             SET DP013-DB2-ABEND   TO TRUE                        24560000
245700             SET DP013-NO-ROLLBACK TO TRUE                        24570000
245800             PERFORM DP013-0000-PROCESS-ABEND                     24580000
245900         WHEN SQLCODE = ZERO                                      24590000
246000             CONTINUE                                             24600000
246100     END-EVALUATE.                                                24610000
246200                                                                  24620000
246300/                                                                 24630000
246400 4400-MOVE-COMMAREA-TO-SCREEN.                                    24640000
246500                                                                  24650000
246600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         24660000
246700           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         24670000
246800           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            24680000
246900             MOVE +1             TO ASC-BLK-SUB                   24690000
247000                                                                  24700000
247100             PERFORM 5100-WRITE-TEMP-STORAGE                      24710000
247200                                                                  24720000
247300             ADD +1              TO ASC-BLK-SUB                   24730000
247400                                                                  24740000
247500             PERFORM 5100-WRITE-TEMP-STORAGE                      24750000
247600                                                                  24760000
247700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             24770000
247800                 GIVING PV-BLOCK-NUMBER                           24780000
247900                 REMAINDER PV-REMAINDER                           24790000
248000             IF PV-REMAINDER > ZERO                               24800000
248100                 ADD +1          TO PV-BLOCK-NUMBER               24810000
248200             END-IF                                               24820000
248300             MOVE +1             TO ASC-BLK-SUB                   24830000
248400                                                                  24840000
248500             PERFORM 4410-READ-TEMP-STORAGE                       24850000
248600                                                                  24860000
248700             ADD +1              TO ASC-BLK-SUB                   24870000
248800                                    PV-BLOCK-NUMBER               24880000
248900                                                                  24890000
249000             PERFORM 4410-READ-TEMP-STORAGE                       24900000
249100                                                                  24910000
249200     END-IF.                                                      24920000
249300                                                                  24930000
249400     MOVE +1                     TO ASC-BLK-SUB.                  24940000
249500     COMPUTE ASC-ITEM-SUB =                                       24950000
249600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              24960000
249700                       + PC-ITEMS-PER-PANEL).                     24970000
249800                                                                  24980000
249900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         24990000
250000         ADD +1                  TO ASC-BLK-SUB                   25000000
250100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            25010000
250200     END-IF.                                                      25020000
250300                                                                  25030000
250400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           25040000
250500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                25050000
250600                                                                  25060000
250700     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        25070000
250800                                                                  25080000
250900     PERFORM 4420-FORMAT-LIST-LINES                               25090000
251000         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            25100000
251100         UNTIL   PV-SUB < +1.                                     25110000
251200                                                                  25120000
251300     COMPUTE ASC-ITEMS-DISPLAYED =                                25130000
251400                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).25140000
251500     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      25150000
251600                                    ASTRTITO.                     25160000
251700     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                25170000
251800                                 TO AENDITO.                      25180000
251900     MOVE ASC-NUMBER-OF-ITEMS-READ                                25190000
252000                                 TO ATOTITO.                      25200000
252100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            25210000
252200                                 TO ASELITO.                      25220000
252300                                                                  25230000
252400     MOVE ASC-KEY-PO-NBR         TO APOO.                         25240000
252500     MOVE ASC-KEY-PKSL-NBR       TO APKSLIPO.                     25250000
252600     MOVE ASC-KEY-VENDOR-NAME    TO AVENDO.                       25260000
252700     MOVE ASC-KEY-REC-SEQ-NBR    TO ARECSEQO.                     25270000
252800     MOVE ASC-KEY-STR-DEST-NBR   TO ASTRO.                        25280000
252900                                                                  25290000
253000     IF DP020-MSG-NUMBER-X = SPACE                                25300000
253100        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    25310000
253200            MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER              25320000
253300            SET DP020-MSG-INFORMATIONAL                           25330000
253400                                 TO TRUE                          25340000
253500        END-IF                                                    25350000
253600     END-IF.                                                      25360000
253700                                                                  25370000
253800 4410-READ-TEMP-STORAGE.                                          25380000
253900                                                                  25390000
254000     EXEC CICS READQ TS                                           25400000
254100               QUEUE (ASC-LIST-QUEUE-NAME)                        25410000
254200               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            25420000
254300               ITEM  (PV-BLOCK-NUMBER)                            25430000
254400               RESP  (PV-CICS-RESP)                               25440000
254500     END-EXEC.                                                    25450000
254600                                                                  25460000
254700     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     25470000
254800         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      25480000
254900         CONTINUE                                                 25490000
255000     ELSE                                                         25500000
255100         SET DP013-CICS-ABEND                                     25510000
255200             DP013-NO-ROLLBACK   TO TRUE                          25520000
255300         MOVE '4410-READ-TEMP-STORAGE'                            25530000
255400                                 TO DP013-PARAGRAPH               25540000
255500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   25550000
255600                                 TO DP013-MESSAGE-TEXT (1)        25560000
255700                                                                  25570000
255800         PERFORM DP013-0000-PROCESS-ABEND                         25580000
255900     END-IF.                                                      25590000
256000                                                                  25600000
256100     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     25610000
256200                                 TO TRUE.                         25620000
256300                                                                  25630000
256400     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          25640000
256500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               25650000
256600     END-IF.                                                      25660000
256700                                                                  25670000
256800 4420-FORMAT-LIST-LINES.                                          25680000
256900                                                                  25690000
257000     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       25700000
257100         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                25710000
257200         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     25720000
257300         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     25730000
257400                                    MR-ACTION        (PV-SUB)     25740000
257500                                    MR-PKSL-LNE-NBR  (PV-SUB)     25750000
257600                                    MR-VEND-STYL-NAME(PV-SUB)     25760000
257700                                    MR-PKSL-ITM-QTY  (PV-SUB)     25770000
257800                                    MR-UNT-COST-AMT  (PV-SUB)     25780000
257900                                    MR-COLOR-DESC    (PV-SUB)     25790000
258000                                    MR-VEND-DESC     (PV-SUB)     25800000
258100                                    MR-TROUBLE       (PV-SUB)     25810000
258200                                    MR-SIZE-DESC     (PV-SUB)     25820000
258300     ELSE                                                         25830000
258400         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     25840000
258500                                                             SPACE25850000
258600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 25860000
258700                                 TO MR-SELECTI (PV-SUB)           25870000
258800         ELSE                                                     25880000
258900             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      25890000
259000                                 TO MR-SELECTI (PV-SUB)           25900000
259100         END-IF                                                   25910000
259200                                                                  25920000
259300         IF DP030-SET-CURSOR-TRAILER                              25930000
259400            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  25940000
259500                                                             SPACE25950000
259600               OR PV-SUB = 1                                      25960000
259700                SET DP030-SET-CURSOR-APPL-1                       25970000
259800                                 TO TRUE                          25980000
259900                MOVE -1          TO MR-SELECTL (PV-SUB)           25990000
260000            END-IF                                                26000000
260100         END-IF                                                   26010000
260200                                                                  26020000
260300         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            26030000
260400             MOVE ASC-ACTION         (ASC-BLK-SUB ASC-ITEM-SUB)   26040000
260500                                 TO MR-ACTION          (PV-SUB)   26050000
260600             MOVE ASC-PKSL-LNE-NBR   (ASC-BLK-SUB ASC-ITEM-SUB)   26060000
260700                                 TO MR-PKSL-LNE-NBR    (PV-SUB)   26070000
260800             MOVE ASC-VEND-STYL-NAME (ASC-BLK-SUB ASC-ITEM-SUB)   26080000
260900                                 TO MR-VEND-STYL-NAME  (PV-SUB)   26090000
261000             MOVE ASC-PKSL-ITM-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)   26100000
261100                                 TO MR-PKSL-ITM-QTY-EDITTED       26110000
261200                                                       (PV-SUB)   26120000
261300             MOVE ASC-UNT-COST-AMT-N (ASC-BLK-SUB ASC-ITEM-SUB)   26130000
261400                                 TO MR-UNT-COST-AMT-EDITTED       26140000
261500                                                       (PV-SUB)   26150000
261600             MOVE ASC-COLOR-DESC     (ASC-BLK-SUB ASC-ITEM-SUB)   26160000
261700                                 TO MR-COLOR-DESC      (PV-SUB)   26170000
261800             MOVE ASC-VEND-DESC      (ASC-BLK-SUB ASC-ITEM-SUB)   26180000
261900                                 TO MR-VEND-DESC       (PV-SUB)   26190000
262000             MOVE ASC-SIZE-DESC      (ASC-BLK-SUB ASC-ITEM-SUB)   26200000
262100                                 TO MR-SIZE-DESC       (PV-SUB)   26210000
262200             MOVE ASC-TROUBLE        (ASC-BLK-SUB ASC-ITEM-SUB)   26220000
262300                                 TO MR-TROUBLE         (PV-SUB)   26230000
262400             IF ASC-TROUBLE (ASC-BLK-SUB ASC-ITEM-SUB)            26240000
262500                     NOT = SPACES                                 26250000
262600                 MOVE DP015-YELLOW     TO MR-TROUBLE-C (PV-SUB)   26260000
262700             END-IF                                               26270000
262800         END-IF                                                   26280000
262900     END-IF.                                                      26290000
263000                                                                  26300000
263100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               26310000
263200                                                                  26320000
263300     IF ASC-ITEM-SUB < +1                                         26330000
263400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  26340000
263500         MOVE +1                 TO ASC-BLK-SUB.                  26350000
263600                                                                  26360000
263700 4430-CHECK-FOR-BEGIN-AND-END.                                    26370000
263800                                                                  26380000
263900     IF ASC-START-OF-SELECTED-RANGE > ZERO                        26390000
264000        IF ASC-END-OF-SELECTED-RANGE = ZERO                       26400000
264100            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              26410000
264200            SET DP020-MSG-WARNING                                 26420000
264300                                 TO TRUE                          26430000
264400                                                                  26440000
264500            PERFORM 4431-POSITION-AT-WARNING                      26450000
264600                                                                  26460000
264700         END-IF                                                   26470000
264800     ELSE                                                         26480000
264900         IF ASC-END-OF-SELECTED-RANGE > ZERO                      26490000
265000             MOVE PC-TSYMSG-00053                                 26500000
265100                                 TO DP020-MSG-NUMBER              26510000
265200             SET DP020-MSG-WARNING                                26520000
265300                                 TO TRUE                          26530000
265400                                                                  26540000
265500             PERFORM 4431-POSITION-AT-WARNING                     26550000
265600                                                                  26560000
265700         END-IF                                                   26570000
265800     END-IF.                                                      26580000
265900                                                                  26590000
266000 4431-POSITION-AT-WARNING.                                        26600000
266100                                                                  26610000
266200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               26620000
266300                                                  PV-TOP-ITEM + 1.26630000
266400     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       26640000
266500         CONTINUE                                                 26650000
266600     ELSE                                                         26660000
266700         SET DP030-SET-CURSOR-APPL-1                              26670000
266800                                 TO TRUE                          26680000
266900         MOVE -1                 TO MR-SELECTL (PV-SUB)           26690000
267000         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           26700000
267100         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           26710000
267200     END-IF.                                                      26720000
267300                                                                  26730000
267400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.26740000
267500                                                                  26750000
267600     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       26760000
267700         CONTINUE                                                 26770000
267800     ELSE                                                         26780000
267900         SET DP030-SET-CURSOR-APPL-1                              26790000
268000                                 TO TRUE                          26800000
268100         MOVE -1                 TO MR-SELECTL (PV-SUB)           26810000
268200         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           26820000
268300         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           26830000
268400     END-IF.                                                      26840000
268500                                                                  26850000
268600 5000-PREPARE-SEL-QUEUE.                                          26860000
268700                                                                  26870000
268800     MOVE +1                     TO ASC-BLK-SUB.                  26880000
268900                                                                  26890000
269000     PERFORM 5100-WRITE-TEMP-STORAGE.                             26900000
269100                                                                  26910000
269200     ADD +1                      TO ASC-BLK-SUB.                  26920000
269300                                                                  26930000
269400     PERFORM 5100-WRITE-TEMP-STORAGE.                             26940000
269500                                                                  26950000
269600     MOVE ASC-SEL-QUEUE-NAME-OUT TO RC015-SEL-QUEUE-NAME.         26960000
269700                                                                  26970000
269800     PERFORM 6010-DELETE-SEL-QUEUE.                               26980000
269900                                                                  26990000
270000     IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                       27000000
270100         SET ASC-UPDATE-TSQ      TO TRUE                          27010000
270200     END-IF.                                                      27020000
270300                                                                  27030000
270400     SET RC013-IDX               TO 1.                            27040000
270500     MOVE ZERO                   TO RC015-NUMBER-OF-TS-ITEMS.     27050000
270600     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        27060000
270700                                                                  27070000
270800     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           27080000
270900         VARYING PV-ITEM  FROM 1 BY 1                             27090000
271000         UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN.             27100000
271100                                                                  27110000
271200     IF RC013-IDX > 1                                             27120000
271300         PERFORM 5205-WRITE-SEL-QUEUE                             27130000
271400         ADD +1                  TO RC015-NUMBER-OF-TS-ITEMS      27140000
271500     END-IF.                                                      27150000
271600                                                                  27160000
271700 5100-WRITE-TEMP-STORAGE.                                         27170000
271800                                                                  27180000
271900     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    27190000
272000                                 TO PV-LIST-ITEM-NUMBER.          27200000
272100     COMPUTE PV-BLOCK-NUMBER = 1 +                                27210000
272200                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).27220000
272300                                                                  27230000
272400     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           27240000
272500        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       27250000
272600                                                                  27260000
272700            PERFORM 5105-REWRITE-ASC-LISTQ                        27270000
272800                                                                  27280000
272900        END-IF                                                    27290000
273000     ELSE                                                         27300000
273100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       27310000
273200                                     ASC-HIGHEST-BLOCK-WRITTEN + 127320000
273300         PERFORM 5110-WRITE-ASC-LISTQ                             27330000
273400                                                                  27340000
273500         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     27350000
273600     END-IF.                                                      27360000
273700                                                                  27370000
273800     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     27380000
273900                                 TO TRUE.                         27390000
274000                                                                  27400000
274100 5105-REWRITE-ASC-LISTQ.                                          27410000
274200                                                                  27420000
274300     EXEC CICS WRITEQ TS                                          27430000
274400               QUEUE   (ASC-LIST-QUEUE-NAME)                      27440000
274500               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           27450000
274600               ITEM    (PV-BLOCK-NUMBER)                          27460000
274700               REWRITE                                            27470000
274800               RESP    (PV-CICS-RESP)                             27480000
274900     END-EXEC.                                                    27490000
275000                                                                  27500000
275100     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       27510000
275200         SET DP013-CICS-ABEND                                     27520000
275300             DP013-NO-ROLLBACK   TO TRUE                          27530000
275400         MOVE '5105-REWRITE-ASC-LISTQ'                            27540000
275500                                 TO DP013-PARAGRAPH               27550000
275600         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'27560000
275700                                 TO DP013-MESSAGE-TEXT (1)        27570000
275800         PERFORM DP013-0000-PROCESS-ABEND                         27580000
275900     END-IF.                                                      27590000
276000                                                                  27600000
276100 5110-WRITE-ASC-LISTQ.                                            27610000
276200                                                                  27620000
276300     EXEC CICS WRITEQ TS                                          27630000
276400               QUEUE (ASC-LIST-QUEUE-NAME)                        27640000
276500               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            27650000
276600               ITEM  (PV-BLOCK-NUMBER)                            27660000
276700               RESP  (PV-CICS-RESP)                               27670000
276800     END-EXEC.                                                    27680000
276900                                                                  27690000
277000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      27700000
277100         SET DP013-CICS-ABEND                                     27710000
277200             DP013-NO-ROLLBACK   TO TRUE                          27720000
277300         MOVE '5110-WRITE-ASC-LISTQ'                              27730000
277400                                 TO DP013-PARAGRAPH               27740000
277500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  27750000
277600                                 TO DP013-MESSAGE-TEXT (1)        27760000
277700         PERFORM DP013-0000-PROCESS-ABEND                         27770000
277800     END-IF.                                                      27780000
277900                                                                  27790000
278000 5200-FILL-SEL-QUEUE-RECORD.                                      27800000
278100                                                                  27810000
278200     PERFORM 6112-READ-LIST-QUEUE.                                27820000
278300                                                                  27830000
278400     IF PV-CICS-RESP = DFHRESP (NORMAL)                           27840000
278500         PERFORM                                                  27850000
278600         VARYING LQW-IDX  FROM 1 BY 1                             27860000
278700         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  27870000
278800                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            27880000
278900                                                                  27890000
279000             IF LQW-SELECT (LQW-IDX)                              27900000
279100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              27910000
279200                                 TO RC013-ITEM         (RC013-IDX)27920000
279300                 MOVE LQW-PKSL-LNE-NBR     (LQW-IDX)              27930000
279400                                 TO RC013-PKSL-LNE-NBR-N          27940000
279500                                                       (RC013-IDX)27950000
279600                 MOVE SPACE      TO RC013-ACTION-SW    (RC013-IDX)27960000
279700                 SET RC013-IDX UP BY 1                            27970000
279800                 IF RC013-IDX > RC013-MAX-ITEMS                   27980000
279900                                                                  27990000
280000                     PERFORM 5205-WRITE-SEL-QUEUE                 28000000
280100                                                                  28010000
280200                     ADD +1      TO RC015-NUMBER-OF-TS-ITEMS      28020000
280300                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         28030000
280400                     SET RC013-IDX                                28040000
280500                                 TO 1                             28050000
280600                 END-IF                                           28060000
280700             END-IF                                               28070000
280800         END-PERFORM                                              28080000
280900     END-IF.                                                      28090000
281000                                                                  28100000
281100 5205-WRITE-SEL-QUEUE.                                            28110000
281200                                                                  28120000
281300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            28130000
281400                                 TO RC013-SELECTED-ITEMS.         28140000
281500                                                                  28150000
281600     EXEC CICS WRITEQ TS                                          28160000
281700               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     28170000
281800               FROM  (RC013-DC-SELECT-RECORD)                     28180000
281900               ITEM  (PV-SEL-QUEUE-ITEM)                          28190000
282000               RESP  (PV-CICS-RESP)                               28200000
282100     END-EXEC.                                                    28210000
282200                                                                  28220000
282300     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       28230000
282400         SET DP013-CICS-ABEND                                     28240000
282500             DP013-NO-ROLLBACK   TO TRUE                          28250000
282600         MOVE '5205-WRITE-SEL-QUEUE'                              28260000
282700                                 TO DP013-PARAGRAPH               28270000
282800         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   28280000
282900                                 TO DP013-MESSAGE-TEXT (1)        28290000
283000         PERFORM DP013-0000-PROCESS-ABEND                         28300000
283100     END-IF.                                                      28310000
283200                                                                  28320000
283300 6000-REFRESH-PANEL-FROM-TEMP.                                    28330000
283400                                                                  28340000
283500     IF ASC-UPDATE-TSQ                                            28350000
283600         SET ASC-NO-TSQ-UPDATE   TO TRUE                          28360000
283700         MOVE ZERO               TO PV-SAVE-ITEM                  28370000
283800                                    PV-SEL-QUEUE-ITEM             28380000
283900         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        28390000
284000                                 TO PV-HOLD-SELECTED-ITEMS        28400000
284100         PERFORM 6100-UPDATE-TSQ                                  28410000
284200           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS28420000
284300                                                                  28430000
284400         PERFORM 6010-DELETE-SEL-QUEUE                            28440000
284500                                                                  28450000
284600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         28460000
284700                    ASC-BLOCK-ENTRIES (2)                         28470000
284800                                                                  28480000
284900         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 28490000
285000                GIVING    PV-BLOCK-NUMBER                         28500000
285100                REMAINDER PV-REMAINDER                            28510000
285200                                                                  28520000
285300         IF PV-REMAINDER > ZERO                                   28530000
285400             ADD +1              TO PV-BLOCK-NUMBER               28540000
285500         END-IF                                                   28550000
285600                                                                  28560000
285700         MOVE +1                 TO ASC-BLK-SUB                   28570000
285800                                                                  28580000
285900         PERFORM 4410-READ-TEMP-STORAGE                           28590000
286000                                                                  28600000
286100         ADD +1                  TO ASC-BLK-SUB                   28610000
286200                            PV-BLOCK-NUMBER                       28620000
286300         PERFORM 4410-READ-TEMP-STORAGE                           28630000
286400                                                                  28640000
286500     END-IF.                                                      28650000
286600                                                                  28660000
286700 6010-DELETE-SEL-QUEUE.                                           28670000
286800                                                                  28680000
286900     EXEC CICS DELETEQ TS                                         28690000
287000               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     28700000
287100               RESP  (PV-CICS-RESP)                               28710000
287200     END-EXEC.                                                    28720000
287300                                                                  28730000
287400     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     28740000
287500         (PV-CICS-RESP = DFHRESP (QIDERR)))                       28750000
287600         CONTINUE                                                 28760000
287700     ELSE                                                         28770000
287800         SET DP013-CICS-ABEND                                     28780000
287900             DP013-NO-ROLLBACK   TO TRUE                          28790000
288000         MOVE '6010-DELETE-SEL-QUEUE'                             28800000
288100                                 TO DP013-PARAGRAPH               28810000
288200         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  28820000
288300                                 TO DP013-MESSAGE-TEXT (1)        28830000
288400         PERFORM DP013-0000-PROCESS-ABEND                         28840000
288500     END-IF.                                                      28850000
288600                                                                  28860000
288700 6100-UPDATE-TSQ.                                                 28870000
288800                                                                  28880000
288900     ADD 1                       TO PV-SEL-QUEUE-ITEM.            28890000
289000                                                                  28900000
289100     PERFORM 6105-READ-SEL-QUEUE.                                 28910000
289200                                                                  28920000
289300     PERFORM                                                      28930000
289400     VARYING RC013-IDX  FROM 1 BY 1                               28940000
289500     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       28950000
289600             RC013-IDX > RC013-MAX-ITEMS                          28960000
289700                                                                  28970000
289800         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   28980000
289900            PERFORM 6110-PROCESS-ITEMS                            28990000
290000            SET PS-WRITE-LIST-QUEUE                               29000000
290100                                 TO TRUE                          29010000
290200         END-IF                                                   29020000
290300                                                                  29030000
290400         ADD +1                  TO PV-ITEMS-PROCESSED            29040000
290500     END-PERFORM.                                                 29050000
290600                                                                  29060000
290700     IF PS-WRITE-LIST-QUEUE                                       29070000
290800         PERFORM 6111-WRITE-LIST-QUEUE                            29080000
290900     END-IF.                                                      29090000
291000                                                                  29100000
291100                                                                  29110000
291200 6105-READ-SEL-QUEUE.                                             29120000
291300                                                                  29130000
291400     EXEC CICS READQ TS                                           29140000
291500               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     29150000
291600               INTO  (RC013-DC-SELECT-RECORD)                     29160000
291700               ITEM  (PV-SEL-QUEUE-ITEM)                          29170000
291800               RESP  (PV-CICS-RESP)                               29180000
291900     END-EXEC.                                                    29190000
292000                                                                  29200000
292100     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       29210000
292200         SET DP013-CICS-ABEND                                     29220000
292300             DP013-NO-ROLLBACK   TO TRUE                          29230000
292400         MOVE '6105-READ-SEL-QUEUE'                               29240000
292500                                 TO DP013-PARAGRAPH               29250000
292600         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    29260000
292700                                 TO DP013-MESSAGE-TEXT (1)        29270000
292800         PERFORM DP013-0000-PROCESS-ABEND                         29280000
292900     END-IF.                                                      29290000
293000                                                                  29300000
293100 6110-PROCESS-ITEMS.                                              29310000
293200                                                                  29320000
293300     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          29330000
293400                                            / PC-ITEMS-PER-PANEL).29340000
293500                                                                  29350000
293600     IF PV-ITEM NOT = PV-SAVE-ITEM                                29360000
293700        IF PV-SAVE-ITEM NOT = ZERO                                29370000
293800                                                                  29380000
293900            PERFORM 6111-WRITE-LIST-QUEUE                         29390000
294000                                                                  29400000
294100        END-IF                                                    29410000
294200        MOVE PV-ITEM             TO PV-SAVE-ITEM                  29420000
294300                                                                  29430000
294400        PERFORM 6112-READ-LIST-QUEUE                              29440000
294500        IF PV-CICS-RESP NOT = DFHRESP(NORMAL)                     29450000
294600            CONTINUE                                              29460000
294700        END-IF                                                    29470000
294800     END-IF.                                                      29480000
294900                                                                  29490000
295000     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX) -                   29500000
295100                                    LQW-LIST-ITEM-NUMBER (1)) + 1.29510000
295200     SET LQW-DESELECT (PV-SUB)   TO TRUE                          29520000
295300     MOVE LQW-SELECTED-SW (PV-SUB)                                29530000
295400                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).29540000
295500     EVALUATE TRUE                                                29550000
295600         WHEN RC013-INQ (RC013-IDX)                               29560000
295700              MOVE PC-INQ        TO LQW-ACTION (PV-SUB)           29570000
295800                                                                  29580000
295900         WHEN RC013-UPD (RC013-IDX)                               29590000
296000              MOVE PC-UPD        TO LQW-ACTION (PV-SUB)           29600000
296100                                                                  29610000
296200         WHEN RC013-DEL (RC013-IDX)                               29620000
296300              MOVE PC-DEL        TO LQW-ACTION (PV-SUB)           29630000
296400                                                                  29640000
296500         WHEN RC013-ERR (RC013-IDX)                               29650000
296600              MOVE PC-ERR        TO LQW-ACTION (PV-SUB)           29660000
296700     END-EVALUATE.                                                29670000
296800                                                                  29680000
296900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                29690000
297000                                                                  29700000
297100 6111-WRITE-LIST-QUEUE.                                           29710000
297200                                                                  29720000
297300     EXEC CICS WRITEQ TS                                          29730000
297400               QUEUE (ASC-LIST-QUEUE-NAME)                        29740000
297500               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   29750000
297600               ITEM  (PV-SAVE-ITEM)                               29760000
297700               REWRITE                                            29770000
297800               RESP  (PV-CICS-RESP)                               29780000
297900     END-EXEC.                                                    29790000
298000                                                                  29800000
298100     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       29810000
298200         SET DP013-CICS-ABEND                                     29820000
298300             DP013-NO-ROLLBACK   TO TRUE                          29830000
298400         MOVE '6111-WRITE-LIST-QUEUE'                             29840000
298500                                 TO DP013-PARAGRAPH               29850000
298600         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'29860000
298700                                 TO DP013-MESSAGE-TEXT(1)         29870000
298800         PERFORM DP013-0000-PROCESS-ABEND                         29880000
298900     END-IF.                                                      29890000
299000                                                                  29900000
299100 6112-READ-LIST-QUEUE.                                            29910000
299200                                                                  29920000
299300     EXEC CICS READQ TS                                           29930000
299400               QUEUE (ASC-LIST-QUEUE-NAME)                        29940000
299500               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   29950000
299600               ITEM  (PV-ITEM)                                    29960000
299700               RESP  (PV-CICS-RESP)                               29970000
299800     END-EXEC.                                                    29980000
299900                                                                  29990000
300000     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       30000000
300100         SET DP013-CICS-ABEND                                     30010000
300200             DP013-NO-ROLLBACK   TO TRUE                          30020000
300300         MOVE '6112-READ-LIST-QUEUE'                              30030000
300400                                 TO DP013-PARAGRAPH               30040000
300500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   30050000
300600                                 TO DP013-MESSAGE-TEXT(1)         30060000
300700         PERFORM DP013-0000-PROCESS-ABEND                         30070000
300800     END-IF.                                                      30080000
300900                                                                  30090000
301000/                                                                 30100000
301100******************************************************************30110000
301200* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *30120000
301300******************************************************************30130000
301400 6200-DEL-LIST-QUEUE.                                             30140000
301500                                                                  30150000
301600     EXEC CICS                                                    30160000
301700         DELETEQ TS                                               30170000
301800             QUEUE (ASC-LIST-QUEUE-NAME)                          30180000
301900             RESP  (PV-CICS-RESP)                                 30190000
302000     END-EXEC.                                                    30200000
302100                                                                  30210000
302200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      30220000
302300        (PV-CICS-RESP = DFHRESP(QIDERR)))                         30230000
302400         CONTINUE                                                 30240000
302500     ELSE                                                         30250000
302600        SET DP013-CICS-ABEND       TO TRUE                        30260000
302700        SET DP013-NO-ROLLBACK      TO TRUE                        30270000
302800        MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH             30280000
302900        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               30290000
303000                                   TO DP013-MESSAGE-TEXT (1)      30300000
303100        PERFORM DP013-0000-PROCESS-ABEND                          30310000
303200     END-IF.                                                      30320000
303300                                                                  30330000
303400/                                                                 30340000
303500******************************************************************30350000
303600* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *30360000
303700******************************************************************30370000
303800 9100-READ-SEL-QUEUE.                                             30380000
303900     EXEC CICS                                                    30390000
304000         READQ TS                                                 30400000
304100             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        30410000
304200             INTO  (RC013-DC-SELECT-RECORD)                       30420000
304300             ITEM  (ASC-SEL-ITEM)                                 30430000
304400             RESP  (PV-CICS-RESP)                                 30440000
304500     END-EXEC.                                                    30450000
304600                                                                  30460000
304700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        30470000
304800         CONTINUE                                                 30480000
304900     ELSE                                                         30490000
305000         SET DP013-LOGIC-ABEND                                    30500000
305100             DP013-NO-ROLLBACK     TO TRUE                        30510000
305200         MOVE '9100-READ-SEL-QUEUE'                               30520000
305300                                   TO DP013-PARAGRAPH             30530000
305400         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    30540000
305500                                   TO DP013-MESSAGE-TEXT (1)      30550000
305600         PERFORM DP013-0000-PROCESS-ABEND                         30560000
305700     END-IF.                                                      30570000
305800                                                                  30580000
305900/                                                                 30590000
306000******************************************************************30600000
306100* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *30610000
306200******************************************************************30620000
306300 9200-REWRITE-LIST-QUEUE.                                         30630000
306400     EXEC CICS                                                    30640000
306500          WRITEQ TS                                               30650000
306600              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     30660000
306700              FROM    (RC013-DC-SELECT-RECORD)                    30670000
306800              ITEM    (ASC-SEL-ITEM)                              30680000
306900              RESP    (PV-CICS-RESP)                              30690000
307000              REWRITE                                             30700000
307100     END-EXEC.                                                    30710000
307200                                                                  30720000
307300     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    30730000
307400         SET DP013-CICS-ABEND                                     30740000
307500             DP013-NO-ROLLBACK     TO TRUE                        30750000
307600         MOVE '9200-REWRITE-LIST-QUEUE'                           30760000
307700                                   TO DP013-PARAGRAPH             30770000
307800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   30780000
307900                                   TO DP013-MESSAGE-TEXT (1)      30790000
308000         PERFORM DP013-0000-PROCESS-ABEND                         30800000
308100     END-IF.                                                      30810000
308200                                                                  30820000
308300                                                                  30830000
308400******************************************************************30840000
308500*    ABEND PROCESSING                                             30850000
308600******************************************************************30860000
308700     COPY DPPD013.                                                30870000
