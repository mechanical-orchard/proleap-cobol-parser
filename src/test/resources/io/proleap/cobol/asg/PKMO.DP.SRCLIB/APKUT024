000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKUT024.                                        00020000
000300 AUTHOR.         ELENA MOZNAIM                                    00030000
000400 DATE-WRITTEN.   FEBRUARY 2019.                                   00040000
000500 DATE-COMPILED.                                                   00050000
000600******************************************************************00060000
000700*    COBOL 2                                                     *00070000
000800*     REFORMATS GLRD002 FILE TO TEXT FORMAT                      *00080000
000900*                                                                *00090000
001000* INPUT:                                                         *00100000
001100*  1. AP ADJ SORTED FILE           COPYBOOK APRD047              *00110000
001200*                                                                *00120000
001300* OUTPUT:                                                        *00130000
001400*  1. AMOUNT TEXT FILE                                           *00140000
001500*                                                                *00150000
001600******************************************************************00160000
001610* CHANGE LOG:                                                    *00161000
001611*    DATE  08/5/2019                                             *00161100
001612*        CHANGE MADE: INITIAL IMPLEMENTATION.                    *00161200
001613*        MADE BY: ELENA MOZNAIM           WR/IR #: CHG0228548    *00161301
001615*                                                                *00161500
001620******************************************************************00162000
001700   EJECT                                                          00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900 CONFIGURATION SECTION.                                           00190000
002000 SOURCE-COMPUTER.    IBM-3090.                                    00200000
002100 OBJECT-COMPUTER.    IBM-3090.                                    00210000
002200                                                                  00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400 FILE-CONTROL.                                                    00240000
002500     SELECT IN-FILE       ASSIGN TO UT-S-INP01.                   00250000
002600     SELECT OUT-FILE      ASSIGN TO UT-S-OUT01.                   00260000
002700                                                                  00270000
002800 DATA DIVISION.                                                   00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  IN-FILE                                                      00310000
003200     RECORDING MODE IS F                                          00320000
003300     LABEL RECORDS ARE STANDARD                                   00330000
003400     BLOCK CONTAINS 0 RECORDS                                     00340000
003500     DATA RECORD IS APTRAN-IN-REC.                                00350000
003600 01  IN-REC.                                                      00360000
003700     05  FILLER                       PIC  X(170).                00370000
003800                                                                  00380000
003900 FD  OUT-FILE                                                     00390000
004000     RECORDING MODE IS F                                          00400000
004100     LABEL RECORDS ARE STANDARD                                   00410000
004200     BLOCK CONTAINS 0 RECORDS                                     00420000
004300     DATA RECORD IS APTRAN-OUT-REC.                               00430000
004400 01  OUT-REC.                                                     00440000
004500     05  FILLER                       PIC  X(79).                 00450000
004600                                                                  00460000
004700 EJECT                                                            00470000
004800 WORKING-STORAGE SECTION.                                         00480000
004900                                                                  00490000
005000 01  EOF-SW                           PIC X     VALUE 'N'.        00500000
005100     88  IN-EOF                                 VALUE 'Y'.        00510000
005110                                                                  00511000
005120 01  TEXT-RECORD.                                                 00512000
005130     05  AP-TXT-GL-ACCT-NBR           PIC X(6).                   00513000
005140     05  FILLER                       PIC X(1)  VALUE ','.        00514000
005150     05  AP-TXT-STR-NBR               PIC 9(4).                   00515000
005160     05  FILLER                       PIC X(1)  VALUE ','.        00516000
005170     05  AP-TXT-TRN-TYP-CDE           PIC X(3).                   00517000
005180     05  FILLER                       PIC X(1)  VALUE ','.        00518000
005190     05  AP-TXT-PSTG-DTE              PIC X(10).                  00519000
005200     05  FILLER                       PIC X(1)  VALUE ','.        00520000
005300     05  AP-TXT-ENT-NME-DESC          PIC X(30).                  00530000
005310     05  FILLER                       PIC X(1)  VALUE ','.        00531000
005311     05  AP-TXT-NET-COST-AMT          PIC ----------.99.          00531100
005312     05  FILLER                       PIC X(1)  VALUE ','.        00531200
005313     05  AP-TXT-OFFSET-ACCT-NBR       PIC X(6).                   00531300
005314                                                                  00531400
005315                                                                  00531500
005316     COPY APRD047.                                                00531600
005317                                                                  00531700
005318 EJECT                                                            00531800
005319 PROCEDURE DIVISION.                                              00531900
005320 A100-MAIN.                                                       00532000
005330                                                                  00533000
005340     PERFORM B100-INITIALIZE.                                     00534000
005341                                                                  00534100
005342     PERFORM B200-PROCESS                                         00534200
005343         UNTIL IN-EOF.                                            00534300
005344                                                                  00534400
005345     GOBACK.                                                      00534500
005346 EJECT                                                            00534600
005347*----------------------------------------------------------------*00534700
005348*    INITIALIZATION PROCESSING                                   *00534800
005349*    CALLED FROM A100-MAIN                                       *00534900
005350*----------------------------------------------------------------*00535000
005360 B100-INITIALIZE.                                                 00536000
005370                                                                  00537000
005380     OPEN INPUT  IN-FILE                                          00538000
005390          OUTPUT OUT-FILE.                                        00539000
005400                                                                  00540000
005500     PERFORM R100-READ-INPUT.                                     00550000
005600                                                                  00560000
005700 B200-PROCESS.                                                    00570000
005800                                                                  00580000
005900     MOVE AP047-GL-ACCT-NBR   TO AP-TXT-GL-ACCT-NBR.              00590000
006000     MOVE AP047-STR-NBR       TO AP-TXT-STR-NBR.                  00600000
006100     MOVE AP047-TRN-TYP-CDE   TO AP-TXT-TRN-TYP-CDE.              00610000
006200     MOVE AP047-PSTG-DTE      TO AP-TXT-PSTG-DTE.                 00620000
006300     MOVE AP047-ENT-NME-DESC  TO AP-TXT-ENT-NME-DESC.             00630000
006400                                                                  00640000
006410     INSPECT AP-TXT-ENT-NME-DESC                                  00641000
006420     REPLACING ALL ',' BY ' '.                                    00642000
006421                                                                  00642100
006422*    INSPECT AP-TXT-ENT-NME-DESC                                  00642200
006423*    REPLACING ALL X'0D25' BY '  '.                               00642300
006424*                                                                 00642400
006425*    INSPECT AP-TXT-ENT-NME-DESC                                  00642500
006426*    REPLACING ALL X'0D15' BY '  '.                               00642600
006427*                                                                 00642700
006428*    INSPECT AP-TXT-ENT-NME-DESC                                  00642800
006429*    REPLACING ALL '`' BY ' '.                                    00642900
006430*                                                                 00643000
006440*    INSPECT AP-TXT-ENT-NME-DESC                                  00644000
006450*    REPLACING ALL 'ç' BY ' '.                                    00645000
006460*                                                                 00646000
006470*    INSPECT AP-TXT-ENT-NME-DESC                                  00647000
006480*    REPLACING ALL 'Ÿ' BY ' '.                                    00648000
006490*                                                                 00649000
006491*    INSPECT AP-TXT-ENT-NME-DESC                                  00649100
006492*    REPLACING ALL 'µ' BY ' '.                                    00649200
006493*                                                                 00649300
006494*    INSPECT AP-TXT-ENT-NME-DESC                                  00649400
006495*    REPLACING ALL X'B7' BY ' '.                                  00649500
006496*                                                                 00649600
006497*    INSPECT AP-TXT-ENT-NME-DESC                                  00649700
006498*    REPLACING ALL X'B8' BY ' '.                                  00649800
006499*                                                                 00649900
006500*    INSPECT AP-TXT-ENT-NME-DESC                                  00650000
006501*    REPLACING ALL '~' BY ' '.                                    00650100
006502*                                                                 00650200
006503*    INSPECT AP-TXT-ENT-NME-DESC                                  00650300
006504*    REPLACING ALL '<' BY ' '.                                    00650400
006505*                                                                 00650500
006506*    INSPECT AP-TXT-ENT-NME-DESC                                  00650600
006507*    REPLACING ALL '>' BY ' '.                                    00650700
006508*                                                                 00650800
006509*    INSPECT AP-TXT-ENT-NME-DESC                                  00650900
006510*    REPLACING ALL '|' BY ' '.                                    00651000
006511*                                                                 00651100
006512*    INSPECT AP-TXT-ENT-NME-DESC                                  00651200
006513*    REPLACING ALL '!' BY ' '.                                    00651300
006514*                                                                 00651400
006515*    INSPECT AP-TXT-ENT-NME-DESC                                  00651500
006516*    REPLACING ALL X'00' BY ' '.                                  00651600
006517*                                                                 00651700
006518*    INSPECT AP-TXT-ENT-NME-DESC                                  00651800
006519*    REPLACING ALL X'05' BY ' '.                                  00651900
006520*                                                                 00652000
006521*    INSPECT AP-TXT-ENT-NME-DESC                                  00652100
006522*    REPLACING ALL X'1E' BY ' '.                                  00652200
006523*                                                                 00652300
006524*    INSPECT AP-TXT-ENT-NME-DESC                                  00652400
006525*    REPLACING ALL X'32' BY ' '.                                  00652500
006526*                                                                 00652600
006527*    INSPECT AP-TXT-ENT-NME-DESC                                  00652700
006528*    REPLACING ALL X'AB' BY ' '.                                  00652800
006529*                                                                 00652900
006530*    INSPECT AP-TXT-ENT-NME-DESC                                  00653000
006531*    REPLACING ALL X'9B' BY ' '.                                  00653100
006532*                                                                 00653200
006533*    INSPECT AP-TXT-ENT-NME-DESC                                  00653300
006534*    REPLACING ALL X'15' BY ' '.                                  00653400
006535*                                                                 00653500
006536*    INSPECT AP-TXT-ENT-NME-DESC                                  00653600
006537*    REPLACING ALL X'41' BY ' '.                                  00653700
006538*                                                                 00653800
006539*    INSPECT AP-TXT-ENT-NME-DESC                                  00653900
006540*    REPLACING ALL X'FD' BY ' '.                                  00654000
006541*                                                                 00654100
006542*    INSPECT AP-TXT-ENT-NME-DESC                                  00654200
006543*    REPLACING ALL X'B3' BY ' '.                                  00654300
006544*                                                                 00654400
006545*    INSPECT AP-TXT-ENT-NME-DESC                                  00654500
006546*    REPLACING ALL X'0D' BY ' '.                                  00654600
006547                                                                  00654700
006548     MOVE AP047-NET-COST-AMT    TO AP-TXT-NET-COST-AMT.           00654800
006549     MOVE AP047-OFFSET-ACCT-NBR TO AP-TXT-OFFSET-ACCT-NBR.        00654900
006550                                                                  00655000
006560     IF AP047-NET-COST-AMT = ZERO                                 00656000
006570***  IF AP-TXT-NET-COST-AMT = 0                                   00657000
006580        NEXT SENTENCE                                             00658000
006590     ELSE                                                         00659000
006600        PERFORM W100-WRITE-OUTPUT                                 00660000
006700     END-IF.                                                      00670000
006710                                                                  00671000
006720     PERFORM R100-READ-INPUT.                                     00672000
006730                                                                  00673000
006740 R100-READ-INPUT.                                                 00674000
006750                                                                  00675000
006760                                                                  00676000
006770     READ IN-FILE INTO AP047-GL-EXTRACT-FILE                      00677000
006780         AT END SET IN-EOF TO TRUE.                               00678000
006790                                                                  00679000
006800                                                                  00680000
006900 W100-WRITE-OUTPUT.                                               00690000
007000                                                                  00700000
007100     WRITE OUT-REC FROM TEXT-RECORD.                              00710000
007200                                                                  00720000
