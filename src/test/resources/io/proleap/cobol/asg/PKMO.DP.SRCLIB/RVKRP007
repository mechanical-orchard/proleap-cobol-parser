00001 ******************************************************************01/03/96
00002  IDENTIFICATION DIVISION.                                         RVKRP007
00003 ******************************************************************   LV002
00004                                                                      CL**2
00005  PROGRAM-ID.             RVKRP007.                                   CL**2
00006  AUTHOR.                 MICHAEL WALTERS.                            CL**2
00007  INSTALLATION.           KOHLS.                                      CL**2
00008  DATE-WRITTEN            AUGUST, 1995.                               CL**2
00009  DATE-COMPILED.                                                      CL**2
00010                                                                      CL**2
00011 ******************************************************************   CL**2
00012 *  THIS PROGRAM WILL SUMMARIZE ALL THE "SHIPPED" DEFECTIVE ITEMS     CL**2
00013 *  AND CREATE THE VENDOR SUMMARY REPORT.                             CL**2
00014 ******************************************************************   CL**2
00015                                                                      CL**2
00016 ******************************************************************   CL**2
00017  ENVIRONMENT DIVISION.                                               CL**2
00018 ******************************************************************   CL**2
00019                                                                      CL**2
00020  CONFIGURATION SECTION.                                              CL**2
00021                                                                      CL**2
00022  SOURCE-COMPUTER.        IBM-3090.                                   CL**2
00023  OBJECT-COMPUTER.        IBM-3090.                                   CL**2
00024                                                                      CL**2
00025  INPUT-OUTPUT SECTION.                                               CL**2
00026                                                                      CL**2
00027  FILE-CONTROL.                                                       CL**2
00028                                                                      CL**2
00029      SELECT RTV-REPORT-EXTRACT                                       CL**2
00030          ASSIGN TO IN01.                                             CL**2
00031                                                                      CL**2
00032      SELECT DI-DEFECT-ITEM-REPORT-COST                               CL**2
00033          ASSIGN TO RPT01.                                            CL**2
00034                                                                      CL**2
00032      SELECT DI-DEFECT-ITEM-REPORT-RETAIL                             CL**2
00033          ASSIGN TO RPT02.                                            CL**2
00034                                                                      CL**2
00035 ******************************************************************   CL**2
00036  DATA DIVISION.                                                      CL**2
00037 ******************************************************************   CL**2
00038                                                                      CL**2
00039  FILE SECTION.                                                       CL**2
00040                                                                      CL**2
00041  FD  RTV-REPORT-EXTRACT                                              CL**2
00042      RECORDING MODE IS F                                             CL**2
00043      LABEL RECORDS ARE STANDARD                                      CL**2
00044      BLOCK CONTAINS 0 RECORDS.                                       CL**2
00045                                                                      CL**2
00046  01  RTV-REPORT-EXTRACT-RECORD       PIC  X(200).                    CL**2
00047                                                                      CL**2
00048  FD  DI-DEFECT-ITEM-REPORT-COST                                      CL**2
00049      RECORDING MODE IS F                                             CL**2
00050      LABEL RECORDS ARE STANDARD                                      CL**2
00051      BLOCK CONTAINS 0 RECORDS.                                       CL**2
00052                                                                      CL**2
00053  01  DI-DEFECT-ITEM-LINE-COST        PIC  X(132).                    CL**2
00054                                                                      CL**2
00048  FD  DI-DEFECT-ITEM-REPORT-RETAIL                                    CL**2
00049      RECORDING MODE IS F                                             CL**2
00050      LABEL RECORDS ARE STANDARD                                      CL**2
00051      BLOCK CONTAINS 0 RECORDS.                                       CL**2
00052                                                                      CL**2
00053  01  DI-DEFECT-ITEM-LINE-RETAIL      PIC  X(132).                    CL**2
00054                                                                      CL**2
00055 ******************************************************************   CL**2
00056  WORKING-STORAGE SECTION.                                            CL**2
00057 ******************************************************************   CL**2
00058                                                                      CL**2
00059 *                                                                    CL**2
00060 *  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                   CL**2
00061 *                                                                    CL**2
00062      COPY DPWS132O.                                                  CL**2
00063 *                                                                    CL**2
00064 *  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                         CL**2
00065 *                                                                    CL**2
00066      COPY DPWS004.                                                   CL**2
00067                                                                      CL**2
00068 *                                                                    CL**2
00069 *  RECORD LAYOUT OF THE RTV EXTRACT FILE.                            CL**2
00070 *                                                                    CL**2
00071      COPY RVWS010.                                                   CL**2
00072                                                                      CL**2
00073                                                                      CL**2
00074  01  ABEND-CODE                          PIC S9(04) VALUE +0         CL**2
00075                                                      COMP SYNC.      CL**2
00076  01  PH2-PAGE-HEADING-MNTH-COST.                                     CL**2
00077      05  FILLER                          PIC  X(40)  VALUE SPACE.    CL**2
00078      05  FILLER                          PIC  X(52)  VALUE           CL**2
00079      'RETURN-TO-VENDOR VENDOR MONTLY SUMMARY REPORT (COST)'.         CL**2
00080                                                                      CL**2
00076  01  PH2-PAGE-HEADING-MNTH-RETAIL.                                   CL**2
00077      05  FILLER                          PIC  X(39)  VALUE SPACE.    CL**2
00078      05  FILLER                          PIC  X(54)  VALUE           CL**2
00079      'RETURN-TO-VENDOR VENDOR MONTLY SUMMARY REPORT (RETAIL)'.       CL**2
                                                                           CL**2
00081  01  PH2-PAGE-HEADING-YTD-COST.                                      CL**2
00082      05  FILLER                          PIC  X(37)  VALUE SPACE.    CL**2
00083      05  FILLER                          PIC  X(51)  VALUE           CL**2
00084          'RETURN-TO-VENDOR VENDOR YEAR TO DATE SUMMARY REPORT'.      CL**2
00083      05  FILLER                          PIC  X(07)  VALUE           CL**2
00084          ' (COST)'.                                                  CL**2
00081  01  PH2-PAGE-HEADING-YTD-RETAIL.                                    CL**2
00082      05  FILLER                          PIC  X(36)  VALUE SPACE.    CL**2
00083      05  FILLER                          PIC  X(51)  VALUE           CL**2
00084          'RETURN-TO-VENDOR VENDOR YEAR TO DATE SUMMARY REPORT'.      CL**2
00083      05  FILLER                          PIC  X(09)  VALUE           CL**2
00084          ' (RETAIL)'.                                                CL**2
00085                                                                      CL**2
00076  01  PH2-PAGE-HEADING-WEEK-COST.                                     CL**2
00077      05  FILLER                          PIC  X(40)  VALUE SPACE.    CL**2
00078      05  FILLER                          PIC  X(52)  VALUE           CL**2
00079      'RETURN-TO-VENDOR VENDOR WEEKLY SUMMARY REPORT (COST)'.         CL**2
00080                                                                      CL**2
00076  01  PH2-PAGE-HEADING-WEEK-RETAIL.                                   CL**2
00077      05  FILLER                          PIC  X(39)  VALUE SPACE.    CL**2
00078      05  FILLER                          PIC  X(54)  VALUE           CL**2
00079      'RETURN-TO-VENDOR VENDOR WEEKLY SUMMARY REPORT (RETAIL)'.       CL**2
                                                                           CL**2
00086  01  PH3-PAGE-HEADING-3.                                             CL**2
00087      05  FILLER                          PIC  X(44)  VALUE SPACE.    CL**2
00088      05  FILLER                          PIC  X(12)  VALUE           CL**2
00089          'BEGIN DATE: '.                                             CL**2
00090      05  PH3-START-DATE                  PIC  X(10)  VALUE SPACE.    CL**2
00091      05  FILLER                          PIC  X(13)  VALUE           CL**2
00092          ' - END DATE: '.                                            CL**2
00093      05  PH3-END-DATE                    PIC  X(10)  VALUE SPACE.    CL**2
00094      05  FILLER                          PIC  X(42)  VALUE SPACE.    CL**2
00095                                                                      CL**2
00096  01  DH1-DETAIL-HEADING-1.                                           CL**2
00097      05  FILLER                          PIC  X(15)  VALUE SPACES.   CL**2
00098      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00099      05  FILLER                          PIC  X(09)  VALUE           CL**2
00100          'DUNS     '.                                                CL**2
00101      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00102      05  FILLER                          PIC  X(03)  VALUE           CL**2
00103          'DPT'.                                                      CL**2
00104      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00105      05  FILLER                          PIC  X(15)  VALUE SPACES.   CL**2
00106      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00107      05  FILLER                          PIC  X(15)  VALUE SPACES.   CL**2
00108      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00109      05  FILLER                          PIC  X(20)  VALUE           CL**2
00110          ' DEBITED & RETURNED '.                                     CL**2
00111      05  FILLER                          PIC  X(03)  VALUE SPACES.   CL**2
00112      05  FILLER                          PIC  X(20)  VALUE           CL**2
00113          ' DEBITED & DESTROYED'.                                     CL**2
00114      05  FILLER                          PIC  X(03)  VALUE SPACES.   CL**2
00115      05  FILLER                          PIC  X(20)  VALUE           CL**2
00116          ' MARKED OUT OF STOCK'.                                     CL**2
00117                                                                      CL**2
00118  01  DH2-DETAIL-HEADING-2-COST.                                      CL**2
00119      05  FILLER                          PIC  X(15)  VALUE           CL**2
00120          'VENDOR NAME    '.                                          CL**2
00121      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00122      05  FILLER                          PIC  X(09)  VALUE           CL**2
00123          'NUMBER   '.                                                CL**2
00124      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00125      05  FILLER                          PIC  X(03)  VALUE           CL**2
00126          'NBR'.                                                      CL**2
00127      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00128      05  FILLER                          PIC  X(15)  VALUE           CL**2
00129          'DPT DESCRIPTION'.                                          CL**2
00130      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00131      05  FILLER                          PIC  X(15)  VALUE           CL**2
00132          'FACILITY       '.                                          CL**2
00133      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00134      05  FILLER                          PIC  X(07)  VALUE           CL**2
00135          '    QTY'.                                                  CL**2
00136      05  FILLER                          PIC  X(01)  VALUE           CL**2
00137          ' '.                                                        CL**2
00138      05  FILLER                          PIC  X(12)  VALUE           CL**2
00139          '       COST '.                                             CL**2
00140      05  FILLER                          PIC  X(03)  VALUE SPACES.   CL**2
00141      05  FILLER                          PIC  X(07)  VALUE           CL**2
00142          '    QTY'.                                                  CL**2
00143      05  FILLER                          PIC  X(01)  VALUE           CL**2
00144          ' '.                                                        CL**2
00145      05  FILLER                         PIC  X(12)  VALUE            CL**2
00146          '       COST '.                                             CL**2
00147      05  FILLER                          PIC  X(03)  VALUE SPACES.   CL**2
00148      05  FILLER                          PIC  X(07)  VALUE           CL**2
00149          '    QTY'.                                                  CL**2
00150      05  FILLER                          PIC  X(01)  VALUE           CL**2
00151          ' '.                                                        CL**2
00152      05  FILLER                          PIC  X(12)  VALUE           CL**2
00153          '       COST '.                                             CL**2
                                                                                
00118  01  DH2-DETAIL-HEADING-2-RETAIL.                                    CL**2
00119      05  FILLER                          PIC  X(15)  VALUE           CL**2
00120          'VENDOR NAME    '.                                          CL**2
00121      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00122      05  FILLER                          PIC  X(09)  VALUE           CL**2
00123          'NUMBER   '.                                                CL**2
00124      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00125      05  FILLER                          PIC  X(03)  VALUE           CL**2
00126          'NBR'.                                                      CL**2
00127      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00128      05  FILLER                          PIC  X(15)  VALUE           CL**2
00129          'DPT DESCRIPTION'.                                          CL**2
00130      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00131      05  FILLER                          PIC  X(15)  VALUE           CL**2
00132          'FACILITY       '.                                          CL**2
00133      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00134      05  FILLER                          PIC  X(07)  VALUE           CL**2
00135          '    QTY'.                                                  CL**2
00136      05  FILLER                          PIC  X(01)  VALUE           CL**2
00137          ' '.                                                        CL**2
00138      05  FILLER                          PIC  X(12)  VALUE           CL**2
00139          '     RETAIL '.                                             CL**2
00140      05  FILLER                          PIC  X(03)  VALUE SPACES.   CL**2
00141      05  FILLER                          PIC  X(07)  VALUE           CL**2
00142          '    QTY'.                                                  CL**2
00143      05  FILLER                          PIC  X(01)  VALUE           CL**2
00144          ' '.                                                        CL**2
00145      05  FILLER                         PIC  X(12)  VALUE            CL**2
00146          '     RETAIL '.                                             CL**2
00147      05  FILLER                          PIC  X(03)  VALUE SPACES.   CL**2
00148      05  FILLER                          PIC  X(07)  VALUE           CL**2
00149          '    QTY'.                                                  CL**2
00150      05  FILLER                          PIC  X(01)  VALUE           CL**2
00151          ' '.                                                        CL**2
00152      05  FILLER                          PIC  X(12)  VALUE           CL**2
00153          '     RETAIL '.                                             CL**2
00154                                                                      CL**2
00155  01  DHD-DETAIL-HEADING-DASHES.                                      CL**2
00156      05  FILLER                          PIC  X(15)  VALUE           CL**2
00157          '_______________'.                                          CL**2
00158      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00159      05  FILLER                          PIC  X(09)  VALUE           CL**2
00160          '_________'.                                                CL**2
00161      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00162      05  FILLER                          PIC  X(03)  VALUE           CL**2
00163          '___'.                                                      CL**2
00164      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00165      05  FILLER                          PIC  X(15)  VALUE           CL**2
00166          '_______________'.                                          CL**2
00167      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00168      05  FILLER                          PIC  X(15)  VALUE           CL**2
00169          '_______________'.                                          CL**2
00170      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00171      05  FILLER                          PIC  X(07)  VALUE           CL**2
00172          '_______'.                                                  CL**2
00173      05  FILLER                          PIC  X(01)  VALUE           CL**2
00174          ' '.                                                        CL**2
00175      05  FILLER                          PIC  X(13)  VALUE           CL**2
00176          '_____________'.                                            CL**2
00177      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00178      05  FILLER                          PIC  X(07)  VALUE           CL**2
00179          '_______'.                                                  CL**2
00180      05  FILLER                          PIC  X(01)  VALUE           CL**2
00181          ' '.                                                        CL**2
00182      05  FILLER                          PIC  X(13)  VALUE           CL**2
00183          '_____________'.                                            CL**2
00184      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00185      05  FILLER                          PIC  X(07)  VALUE           CL**2
00186          '_______'.                                                  CL**2
00187      05  FILLER                          PIC  X(01)  VALUE           CL**2
00188          ' '.                                                        CL**2
00189      05  FILLER                          PIC  X(13)  VALUE           CL**2
00190          '_____________'.                                            CL**2
00191                                                                      CL**2
00192                                                                      CL**2
00193  01  DL-DETAIL-LINE.                                                 CL**2
00194      05  DL-VND-NAME                     PIC  X(15).                 CL**2
00195      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00196      05  DL-DUNS-NBR                     PIC  X(09).                 CL**2
00197      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00198      05  DL-DPT-NBR                      PIC  X(03).                 CL**2
00199      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00200      05  DL-DPT-DESC                     PIC  X(15).                 CL**2
00201      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00202      05  DL-FCLTY-NAME                   PIC  X(15).                 CL**2
00203      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00204      05  DL-DR-QTY                       PIC  ZZZ,ZZ9.               CL**2
00205      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00206      05  DL-DR-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.         CL**2
00207      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00208      05  DL-DD-QTY                       PIC  ZZZ,ZZ9.               CL**2
00209      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00210      05  DL-DD-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.         CL**2
00211      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00212      05  DL-MO-QTY                       PIC  ZZZ,ZZ9.               CL**2
00213      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00214      05  DL-MO-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.         CL**2
00215                                                                      CL**2
00216  01  TL-TOTAL-LINE-DASHES.                                           CL**2
00217      05  FILLER                          PIC  X(15)  VALUE SPACES.   CL**2
00218      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00219      05  FILLER                          PIC  X(09)  VALUE SPACES.   CL**2
00220      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00221      05  FILLER                          PIC  X(03)  VALUE SPACES.   CL**2
00222      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00223      05  FILLER                          PIC  X(15)  VALUE SPACES.   CL**2
00224      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00225      05  FILLER                          PIC  X(15)  VALUE SPACES.   CL**2
00226      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00227      05  FILLER                          PIC  X(07)  VALUE           CL**2
00228          '_______'.                                                  CL**2
00229      05  FILLER                          PIC  X(01)  VALUE           CL**2
00230          ' '.                                                        CL**2
00231      05  FILLER                          PIC  X(13)  VALUE           CL**2
00232          '_____________'.                                            CL**2
00233      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00234      05  FILLER                          PIC  X(07)  VALUE           CL**2
00235          '_______'.                                                  CL**2
00236      05  FILLER                          PIC  X(01)  VALUE           CL**2
00237          ' '.                                                        CL**2
00238      05  FILLER                          PIC  X(13)  VALUE           CL**2
00239          '_____________'.                                            CL**2
00240      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00241      05  FILLER                          PIC  X(07)  VALUE           CL**2
00242          '_______'.                                                  CL**2
00243      05  FILLER                          PIC  X(01)  VALUE           CL**2
00244          ' '.                                                        CL**2
00245      05  FILLER                          PIC  X(13)  VALUE           CL**2
00246          '_____________'.                                            CL**2
00247                                                                      CL**2
00248                                                                      CL**2
00249                                                                      CL**2
00250  01  TL-TOTAL-LINE.                                                  CL**2
00251      05  FILLER                          PIC  X(15)  VALUE SPACES.   CL**2
00252      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00253      05  FILLER                          PIC  X(07)  VALUE SPACES.   CL**2
00254      05  TL-TOTAL-DESCRIPTION            PIC  X(30)  VALUE SPACES.   CL**2
00255      05  FILLER                          PIC  X(08)  VALUE           CL**2
00256          ' TOTAL: '.                                                 CL**2
00257      05  FILLER                          PIC  X(04)  VALUE SPACES.   CL**2
00258      05  TL-DR-QTY                       PIC  ZZZ,ZZ9.               CL**2
00259      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00260      05  TL-DR-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.         CL**2
00261      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00262      05  TL-DD-QTY                       PIC  ZZZ,ZZ9.               CL**2
00263      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00264      05  TL-DD-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.         CL**2
00265      05  FILLER                          PIC  X(02)  VALUE SPACES.   CL**2
00266      05  TL-MO-QTY                       PIC  ZZZ,ZZ9.               CL**2
00267      05  FILLER                          PIC  X(01)  VALUE SPACES.   CL**2
00268      05  TL-MO-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.         CL**2
00269                                                                      CL**2
00270  01  BLANK-LINE.                                                     CL**2
00271      05  FILLER                          PIC  X(132) VALUE SPACE.    CL**2
00272                                                                      CL**2
00273  01  END-OF-REPORT-LINE.                                             CL**2
00274      05  FILLER                          PIC  X(88)  VALUE SPACE.    CL**2
00275      05  FILLER                          PIC  X(25)  VALUE           CL**2
00276          '***** END OF REPORT *****'.                                CL**2
00277      05  FILLER                          PIC  X(87)  VALUE SPACE.    CL**2
00278                                                                      CL**2
00279  01  ER-EMPTY-REPORT-LINE.                                           CL**2
00280      05  FILLER                          PIC  X(42)  VALUE SPACE.    CL**2
00281      05  FILLER                          PIC  X(48)  VALUE           CL**2
00282          '*** NO DATA SATISFIES THE SELECTION CRITERIA ***'.         CL**2
00283      05  FILLER                          PIC  X(42)  VALUE SPACE.    CL**2
00284                                                                      CL**2
00285  01  PA-PROGRAM-ACCUMULATORS.                                        CL**2
00286      05  PA-VND-TOTALS.                                              CL**2
00287          10 PA-VND-DC-COUNT              PIC S9(06)  VALUE +0        CL**2
00288                                                      COMP-3.         CL**2
00289                                                                      CL**2
00290          10 PA-DR-VND-QTY                PIC S9(06)  VALUE +0        CL**2
00291                                                      COMP-3.         CL**2
00292          10 PA-DR-VND-COST               PIC S9(08)V99               CL**2
00293                                                      VALUE +0        CL**2
00294                                                      COMP-3.         CL**2
00295                                                                      CL**2
00292          10 PA-DR-VND-RETAIL             PIC S9(08)V99               CL**2
00293                                                      VALUE +0        CL**2
00294                                                      COMP-3.         CL**2
00295                                                                      CL**2
00296          10 PA-DD-VND-QTY                PIC S9(06)  VALUE +0        CL**2
00297                                                      COMP-3.         CL**2
00298          10 PA-DD-VND-COST               PIC S9(08)V99               CL**2
00299                                                      VALUE +0        CL**2
00300                                                      COMP-3.         CL**2
00298          10 PA-DD-VND-RETAIL             PIC S9(08)V99               CL**2
00299                                                      VALUE +0        CL**2
00300                                                      COMP-3.         CL**2
00301                                                                      CL**2
00302          10 PA-MO-VND-QTY                PIC S9(06)  VALUE +0        CL**2
00303                                                      COMP-3.         CL**2
00304          10 PA-MO-VND-COST               PIC S9(08)V99               CL**2
00305                                                      VALUE +0        CL**2
00306                                                      COMP-3.         CL**2
00304          10 PA-MO-VND-RETAIL             PIC S9(08)V99               CL**2
00305                                                      VALUE +0        CL**2
00306                                                      COMP-3.         CL**2
00307      05  PA-DPT-TOTALS.                                              CL**2
00308          10 PA-DPT-DC-COUNT              PIC S9(06)  VALUE +0        CL**2
00309                                                      COMP-3.         CL**2
00310                                                                      CL**2
00311          10 PA-DR-DPT-QTY                PIC S9(06)  VALUE +0        CL**2
00312                                                      COMP-3.         CL**2
00313          10 PA-DR-DPT-COST               PIC S9(08)V99               CL**2
00314                                                      VALUE +0        CL**2
00315                                                      COMP-3.         CL**2
00313          10 PA-DR-DPT-RETAIL             PIC S9(08)V99               CL**2
00314                                                      VALUE +0        CL**2
00315                                                      COMP-3.         CL**2
00316                                                                      CL**2
00317          10 PA-DD-DPT-QTY                PIC S9(06)  VALUE +0        CL**2
00318                                                      COMP-3.         CL**2
00319          10 PA-DD-DPT-COST               PIC S9(08)V99               CL**2
00320                                                      VALUE +0        CL**2
00321                                                      COMP-3.         CL**2
00319          10 PA-DD-DPT-RETAIL             PIC S9(08)V99               CL**2
00320                                                      VALUE +0        CL**2
00321                                                      COMP-3.         CL**2
00322                                                                      CL**2
00323          10 PA-MO-DPT-QTY                PIC S9(06)  VALUE +0        CL**2
00324                                                      COMP-3.         CL**2
00325          10 PA-MO-DPT-COST               PIC S9(08)V99               CL**2
00326                                                      VALUE +0        CL**2
00327                                                      COMP-3.         CL**2
00325          10 PA-MO-DPT-RETAIL             PIC S9(08)V99               CL**2
00326                                                      VALUE +0        CL**2
00327                                                      COMP-3.         CL**2
00328      05  PA-FCLTY-TOTALS.                                            CL**2
00329          10 PA-DR-FCLTY-QTY              PIC S9(06)  VALUE +0        CL**2
00330                                                      COMP-3.         CL**2
00331          10 PA-DR-FCLTY-COST             PIC S9(08)V99               CL**2
00332                                                      VALUE +0        CL**2
00333                                                      COMP-3.         CL**2
00331          10 PA-DR-FCLTY-RETAIL           PIC S9(08)V99               CL**2
00332                                                      VALUE +0        CL**2
00333                                                      COMP-3.         CL**2
00334          10 PA-DD-FCLTY-QTY              PIC S9(06)  VALUE +0        CL**2
00335                                                      COMP-3.         CL**2
00336          10 PA-DD-FCLTY-COST             PIC S9(08)V99               CL**2
00337                                                      VALUE +0        CL**2
00338                                                      COMP-3.         CL**2
00336          10 PA-DD-FCLTY-RETAIL           PIC S9(08)V99               CL**2
00337                                                      VALUE +0        CL**2
00338                                                      COMP-3.         CL**2
00339          10 PA-MO-FCLTY-QTY              PIC S9(06)  VALUE +0        CL**2
00340                                                      COMP-3.         CL**2
00341          10 PA-MO-FCLTY-COST             PIC S9(08)V99               CL**2
00342                                                      VALUE +0        CL**2
00343                                                      COMP-3.         CL**2
00341          10 PA-MO-FCLTY-RETAIL           PIC S9(08)V99               CL**2
00342                                                      VALUE +0        CL**2
00343                                                      COMP-3.         CL**2
00344      05  PA-GRAND-TOTALS.                                            CL**2
00345          10 PA-DR-GRAND-QTY              PIC S9(06)  VALUE +0        CL**2
00346                                                      COMP-3.         CL**2
00347          10 PA-DR-GRAND-COST             PIC S9(08)V99               CL**2
00348                                                      VALUE +0        CL**2
00349                                                      COMP-3.         CL**2
00347          10 PA-DR-GRAND-RETAIL           PIC S9(08)V99               CL**2
00348                                                      VALUE +0        CL**2
00349                                                      COMP-3.         CL**2
00350          10 PA-DD-GRAND-QTY              PIC S9(06)  VALUE +0        CL**2
00351                                                      COMP-3.         CL**2
00352          10 PA-DD-GRAND-COST             PIC S9(08)V99               CL**2
00353                                                      VALUE +0        CL**2
00354                                                      COMP-3.         CL**2
00352          10 PA-DD-GRAND-RETAIL           PIC S9(08)V99               CL**2
00353                                                      VALUE +0        CL**2
00354                                                      COMP-3.         CL**2
00355          10 PA-MO-GRAND-QTY              PIC S9(06)  VALUE +0        CL**2
00356                                                      COMP-3.         CL**2
00357          10 PA-MO-GRAND-COST             PIC S9(08)V99               CL**2
00358                                                      VALUE +0        CL**2
00359                                                      COMP-3.         CL**2
00357          10 PA-MO-GRAND-RETAIL           PIC S9(08)V99               CL**2
00358                                                      VALUE +0        CL**2
00359                                                      COMP-3.         CL**2
00360                                                                      CL**2
00361  01  PC-CONSTANTS.                                                   CL**2
00362      05  PC-COMMIT-INTERVAL              PIC  9(02)  VALUE 10.       CL**2
00363      05  PC-MAX-REFERRAL-CODES           PIC S9(04)  VALUE +7        CL**2
00364                                                      COMP SYNC.      CL**2
00365 * 6 LPI -- 14 X 8.5 PAPER (6 * 8.5 = 51)                             CL**2
00366      05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +55       CL**2
00367                                                      COMP SYNC.      CL**2
00368      05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100      CL**2
00369                                                      COMP SYNC.      CL**2
00370      05  PC-ZERO                         PIC  9(01)  VALUE 0.        CL**2
00371      05  PC-ONE                          PIC  9(01)  VALUE 1.        CL**2
00372      05  PC-TWO                          PIC  9(01)  VALUE 2.        CL**2
00373      05  PC-THREE                        PIC  9(01)  VALUE 3.        CL**2
00374      05  PC-FOUR                         PIC  9(01)  VALUE 4.        CL**2
00375      05  PC-EIGHT                        PIC  9(01)  VALUE 8.        CL**2
00376      05  PC-NINE                         PIC  9(01)  VALUE 9.        CL**2
00377      05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.     CL**2
00378      05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE           CL**2
00379          'RVKRP007'.                                                 CL**2
00380      05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE           CL**2
00381          'RVK050  '.                                                 CL**2
00382      05  PC-SKU-DESC-ZERO                PIC  X(15)  VALUE           CL**2
00383          'V E N D O R    '.                                          CL**2
00384      05  PC-DPKUT500                     PIC  X(10)  VALUE           CL**2
00385          'DPKUT500  '.                                               CL**2
00386      05  PC-MBS-SYSTEM-CODE-RV           PIC  X(02)  VALUE 'RV'.     CL**2
00387      05  PC-MBS-OP-CO-03                 PIC  X(02)  VALUE '03'.     CL**2
00388      05  PC-PGM-DPKUT039                 PIC  X(08)                  CL**2
00389                                          VALUE 'DPKUT039'.           CL**2
00390                                                                      CL**2
00391  01  PS-PROGRAM-SWITCHES.                                            CL**2
00392                                                                      CL**2
00393      05  PS-END-OF-EXTRACT-FILE-IND      PIC  X(01)  VALUE 'N'.      CL**2
00394          88  PS-END-OF-EXTRACT-FILE                  VALUE 'Y'.      CL**2
00395          88  PS-NOT-END-OF-EXTRACT-FILE              VALUE 'N'.      CL**2
00396                                                                      CL**2
00397      05  PS-NO-DATA-IND                  PIC  X(01)  VALUE 'N'.      CL**2
00398          88  PS-NO-DATA                              VALUE 'N'.      CL**2
00399          88  PS-DATA                                 VALUE 'Y'.      CL**2
00400                                                                      CL**2
00401      05  PS-TOTAL-TYPE-PRINT-IND         PIC  X(01)  VALUE ' '.      CL**2
00402          88  PS-PRINT-DPT-TOTAL                      VALUE '1'.      CL**2
00403          88  PS-PRINT-VND-TOTAL                      VALUE '2'.      CL**2
00404          88  PS-PRINT-FCLTY-TOTAL                    VALUE '3'.      CL**2
00405          88  PS-PRINT-GRAND-TOTAL                    VALUE '4'.      CL**2
00406                                                                      CL**2
00407  01  PV-PROGRAM-VARIABLES.                                           CL**2
00408      05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0        CL**2
00409                                                      COMP SYNC.      CL**2
00410      05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0        CL**2
00411                                                      COMP SYNC.      CL**2
00412                                                                      CL**2
00413      05  PV-CHAR-COUNT                   PIC S9(02)  VALUE +0        CL**2
00414                                                      COMP SYNC.      CL**2
00415      05  PV-HOLD-DUNS-NBR                PIC  X(09).                 CL**2
00416      05  PV-HOLD-VND-NAME                PIC  X(30) USAGE DISPLAY.   CL**2
00417      05  PV-HOLD-DPT-NBR                 PIC  X(03).                 CL**2
00418      05  PV-HOLD-DPT-DESC                PIC  X(25).                 CL**2
00419      05  PV-HOLD-OPER-UNT-ID             PIC S9(04) COMP.            CL**2
00420      05  PV-HOLD-FCLTY-NAME              PIC  X(25).                 CL**2
00421      05  PV-RPT-TYPE                     PIC  X(1).                  CL**2
00422          88  PV-MONTHLY-REPORT           VALUE 'M'.                  CL**2
00423          88  PV-YEAR-TO-DATE-REPORT      VALUE 'Y'.                  CL**2
00422          88  PV-WEEKLY-REPORT            VALUE 'W'.                  CL**2
00424 *                                                                    CL**2
00425      05  PV-START-DATE.                                              CL**2
00426          10  PV-START-MONTH              PIC  9(02).                 CL**2
00427          10  FILLER                      PIC  X(01) VALUE '/'.       CL**2
00428          10  PV-START-DAY                PIC  9(02).                 CL**2
00429          10  FILLER                      PIC  X(01) VALUE '/'.       CL**2
00430          10  PV-START-CENTURY            PIC  9(02).                 CL**2
00431          10  PV-START-YEAR               PIC  9(02).                 CL**2
00432      05  PV-END-DATE.                                                CL**2
00433          10  PV-END-MONTH                PIC  9(02).                 CL**2
00434          10  FILLER                      PIC  X(01) VALUE '/'.       CL**2
00435          10  PV-END-DAY                  PIC  9(02).                 CL**2
00436          10  FILLER                      PIC  X(01) VALUE '/'.       CL**2
00437          10  PV-END-CENTURY              PIC  9(02).                 CL**2
00438          10  PV-END-YEAR                 PIC  9(02).                 CL**2
00439      05  PV-REPORT-LINE                 PIC X(132).                  CL**2
00440      05  PV-TOTAL-DESCRIPTION           PIC X(30) VALUE SPACES       CL**2
00441                                                   JUST RIGHT.        CL**2
00442      05  PV-VENDOR-TOTAL-DESC.                                       CL**2
00443          10 FILLER                       PIC  X(01)                  CL**2
00444             OCCURS 30 TIMES DEPENDING ON PV-CHAR-COUNT.              CL**2
00445                                                                      CL**2
00446                                                                      CL**2
00447  01  ST-SYSTEM-TIME.                                                 CL**2
00448      05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS.    CL**2
00449      05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS.    CL**2
00450                                                                      CL**2
00451 *                                                                    CL**2
00452 ******************************************************************   CL**2
00453 *  WORK FIELDS FOR THE MBS SUBROUTINE                                CL**2
00454 ******************************************************************   CL**2
00455      COPY DPWS003.                                                   CL**2
00456                                                                      CL**2
00457 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *    CL**2
00458  PROCEDURE DIVISION.                                                 CL**2
00459 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *    CL**2
00460                                                                      CL**2
00461 ******************************************************************   CL**2
00462 *  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM       CL**2
00463 ******************************************************************   CL**2
00464  0000-PROGRAM-MAINLINE.                                              CL**2
00465                                                                      CL**2
00466      PERFORM 1000-INITIALIZE.                                        CL**2
00467                                                                      CL**2
00468      PERFORM 2000-CREATE-REPORT.                                     CL**2
00469                                                                      CL**2
00470      PERFORM 9000-EOJ-ROUTINE.                                       CL**2
00471      STOP RUN.                                                       CL**2
00472 *0000-EXIT.                                                          CL**2
00473                                                                      CL**2
00474 ******************************************************************   CL**2
00475 *  1000-INITIALIZE -  OPENS ALL THE REPORT FILE, ACCEPTS, EDITS,     CL**2
00476 *  AND DISPLAYS CONTROL CARD INFORMATION, OPENS AND FETCHES FIRST    CL**2
00477 *  OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO REPORT    CL**2
00478 *  FILE.                                                             CL**2
00479 ******************************************************************   CL**2
00480  1000-INITIALIZE.                                                    CL**2
00481                                                                      CL**2
00482      OPEN OUTPUT DI-DEFECT-ITEM-REPORT-COST                          CL**2
                OUTPUT DI-DEFECT-ITEM-REPORT-RETAIL                        CL**2
00483           INPUT  RTV-REPORT-EXTRACT.                                 CL**2
00484                                                                      CL**2
00485      SET PS-NOT-END-OF-EXTRACT-FILE TO TRUE.                         CL**2
00486                                                                      CL**2
00487      PERFORM 7000-READ-EXTRACT-FILE.                                 CL**2
00488                                                                      CL**2
00489      IF PS-END-OF-EXTRACT-FILE                                       CL**2
00490          SET PS-NO-DATA          TO TRUE                             CL**2
00491      ELSE                                                            CL**2
00492          IF RV010-DETAIL-REC                                         CL**2
00493              DISPLAY '** ABEND **'                                   CL**2
00494              DISPLAY '** PROGRAM = RVKRP007 **'                      CL**2
00495              DISPLAY '** PARAGRAPH = 1000-INITIALIZE.     **'        CL**2
00496              DISPLAY '** FIRST RECORD NOT THE DATE RECORD **'        CL**2
00497              MOVE +4003 TO ABEND-CODE                                CL**2
00498              CALL 'ILBOABN0' USING ABEND-CODE                        CL**2
00499          ELSE                                                        CL**2
00500              SET PS-DATA           TO TRUE                           CL**2
00501                                                                      CL**2
00502              MOVE RV010-RPT-TYPE   TO PV-RPT-TYPE                    CL**2
00503                                                                      CL**2
00504              MOVE RV010-END-MM     TO PV-END-MONTH                   CL**2
00505              MOVE RV010-END-DD     TO PV-END-DAY                     CL**2
00506              MOVE RV010-END-CC     TO PV-END-CENTURY                 CL**2
00507              MOVE RV010-END-YY     TO PV-END-YEAR                    CL**2
00508                                                                      CL**2
00509              MOVE RV010-BEGIN-MM   TO PV-START-MONTH                 CL**2
00510              MOVE RV010-BEGIN-DD   TO PV-START-DAY                   CL**2
00511              MOVE RV010-BEGIN-CC   TO PV-START-CENTURY               CL**2
00512              MOVE RV010-BEGIN-YY   TO PV-START-YEAR                  CL**2
00513                                                                      CL**2
00514              MOVE PV-START-DATE    TO PH3-START-DATE                 CL**2
00515              MOVE PV-END-DATE      TO PH3-END-DATE                   CL**2
00516                                                                      CL**2
00517              MOVE RV010-CURR-YY    TO DP132O-RUN-YEAR                CL**2
00518              MOVE RV010-CURR-MM    TO DP132O-RUN-MONTH               CL**2
00519              MOVE RV010-CURR-DD    TO DP132O-RUN-DAY                 CL**2
00520                                                                      CL**2
00521              ACCEPT ST-SYSTEM-TIME FROM TIME                         CL**2
00522              MOVE ST-SYSTEM-HOUR   TO DP132O-RUN-HOUR                CL**2
00523              MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE              CL**2
00524                                                                      CL**2
00525              MOVE 'RVKRP007'       TO DP132O-PROGRAM-NAME            CL**2
00532                                                                      CL**2
00533              MOVE PC-MAX-REPORT-LINES                                CL**2
00534                                    TO PV-LINE-COUNT                  CL**2
00535              MOVE +0               TO PV-PAGE-COUNT                  CL**2
00536                                                                      CL**2
00537              INITIALIZE DL-DETAIL-LINE                               CL**2
00538                         PA-PROGRAM-ACCUMULATORS                      CL**2
00539              PERFORM 7000-READ-EXTRACT-FILE                          CL**2
00540          END-IF                                                      CL**2
00541      END-IF.                                                         CL**2
00542                                                                      CL**2
00543                                                                      CL**2
00544 *1000-EXIT.                                                          CL**2
00545                                                                      CL**2
00546 ******************************************************************   CL**2
00547 * 2000-CREATE-REPORT                                                 CL**2
00548 * PROCESS:  THIS PARAGRAPH WILL SET UP THE WORKING STORAGE INTERNA   CL**2
00549 * SORT FILE.                                                         CL**2
00550 ******************************************************************   CL**2
00551  2000-CREATE-REPORT.                                                 CL**2
00552                                                                      CL**2
00553      IF PS-END-OF-EXTRACT-FILE                                       CL**2
00554          MOVE ER-EMPTY-REPORT-LINE  TO PV-REPORT-LINE                CL**2
00555          PERFORM 8000-PRINT-REPORT-LINE                              CL**2
00556      ELSE                                                            CL**2
00557          MOVE RV010-DUNS-NBR      TO PV-HOLD-DUNS-NBR                CL**2
00558          MOVE RV010-VND-NAME      TO PV-HOLD-VND-NAME                CL**2
00559          MOVE RV010-DPT-NBR       TO PV-HOLD-DPT-NBR                 CL**2
00560          MOVE RV010-DPT-DESC      TO PV-HOLD-DPT-DESC                CL**2
00561          MOVE RV010-OPER-UNT-ID   TO PV-HOLD-OPER-UNT-ID             CL**2
00562          MOVE RV010-FCLTY-NAME    TO PV-HOLD-FCLTY-NAME              CL**2
00563 *                                                                    CL**2
00564          PERFORM UNTIL PS-END-OF-EXTRACT-FILE                        CL**2
00565              IF RV010-DUNS-NBR = PV-HOLD-DUNS-NBR                    CL**2
00566                  IF RV010-DPT-NBR = PV-HOLD-DPT-NBR                  CL**2
00567                      IF RV010-OPER-UNT-ID = PV-HOLD-OPER-UNT-ID      CL**2
00568                          PERFORM 2100-ACCUMULATE-TOTALS              CL**2
00569                      ELSE                                            CL**2
00570                          PERFORM 2200-FCLTY-BREAK                    CL**2
00571                      END-IF                                          CL**2
00572                  ELSE                                                CL**2
00573                      PERFORM 2300-DPT-BREAK                          CL**2
00574                  END-IF                                              CL**2
00575              ELSE                                                    CL**2
00576                  PERFORM 2400-VND-BREAK                              CL**2
00577              END-IF                                                  CL**2
00578                                                                      CL**2
00579              PERFORM 7000-READ-EXTRACT-FILE                          CL**2
00580                                                                      CL**2
00581          END-PERFORM                                                 CL**2
00582      END-IF.                                                         CL**2
00583                                                                      CL**2
00584 ******************************************************************   CL**2
00585 * 2100-ACCUMULATE-TOTALS                                             CL**2
00586 * PROCESS:  THIS PARAGRAPH WILL ACCUMULATE TOTALS AT THE             CL**2
00587 *  DEPT/FACILITY LEVEL.                                              CL**2
00588 ******************************************************************   CL**2
00589  2100-ACCUMULATE-TOTALS.                                             CL**2
00590                                                                      CL**2
00591      EVALUATE TRUE                                                   CL**2
00592          WHEN RV010-RTV-TYPE                                         CL**2
00593              ADD RV010-UNIT-COST-AMT TO PA-DR-FCLTY-COST             CL**2
00593              ADD RV010-RTL-COST-AMT  TO PA-DR-FCLTY-RETAIL           CL**2
00594              ADD +1                  TO PA-DR-FCLTY-QTY              CL**2
00595                                                                      CL**2
00596          WHEN RV010-DD-TYPE                                          CL**2
00597              ADD RV010-UNIT-COST-AMT TO PA-DD-FCLTY-COST             CL**2
00597              ADD RV010-RTL-COST-AMT  TO PA-DD-FCLTY-RETAIL           CL**2
00598              ADD +1                  TO PA-DD-FCLTY-QTY              CL**2
00599                                                                      CL**2
               WHEN RV010-MO-TYPE                                               
00601              ADD RV010-UNIT-COST-AMT TO PA-MO-FCLTY-COST             CL**2
00601              ADD RV010-RTL-COST-AMT  TO PA-MO-FCLTY-RETAIL           CL**2
00602              ADD +1                  TO PA-MO-FCLTY-QTY              CL**2
00603      END-EVALUATE.                                                   CL**2
00604                                                                      CL**2
00605                                                                      CL**2
00606 ******************************************************************   CL**2
00607 * 2200-FCLTY-BREAK.                                                  CL**2
00608 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN    CL**2
00609 *  THE FACILITY:                                                     CL**2
00610 *     1) PRINT LINE OF OLD FACILITY TO REPORT                        CL**2
00611 *     2) RESET THE "HOLD" VARIABLES                                  CL**2
00612 *     3) ADD "OLD" FACILITY TOTALS TO DEPARTMENT TOTALS              CL**2
00613 *     4) INITIALIZE FACILITY TOTALS FOR NEW FACILITY                 CL**2
00614 *     5) ADD CURRENT VALUES TO NEW FACILITY TOTALS                   CL**2
00615 ******************************************************************   CL**2
00616  2200-FCLTY-BREAK.                                                   CL**2
00617                                                                      CL**2
00618      PERFORM 8000-PRINT-REPORT-LINE.                                 CL**2
00619                                                                      CL**2
00620      MOVE RV010-OPER-UNT-ID   TO PV-HOLD-OPER-UNT-ID                 CL**2
00621      MOVE RV010-FCLTY-NAME    TO PV-HOLD-FCLTY-NAME.                 CL**2
00622 *                                                                    CL**2
00623      ADD +1                   TO PA-DPT-DC-COUNT.                    CL**2
00624 *                                                                    CL**2
00625      ADD PA-DR-FCLTY-QTY      TO PA-DR-DPT-QTY.                      CL**2
00626      ADD PA-DR-FCLTY-COST     TO PA-DR-DPT-COST.                     CL**2
00626      ADD PA-DR-FCLTY-RETAIL   TO PA-DR-DPT-RETAIL.                   CL**2
00627 *                                                                    CL**2
00628      ADD PA-DD-FCLTY-QTY      TO PA-DD-DPT-QTY.                      CL**2
00629      ADD PA-DD-FCLTY-COST     TO PA-DD-DPT-COST.                     CL**2
00629      ADD PA-DD-FCLTY-RETAIL   TO PA-DD-DPT-RETAIL.                   CL**2
00630 *                                                                    CL**2
00631      ADD PA-MO-FCLTY-QTY      TO PA-MO-DPT-QTY.                      CL**2
00632      ADD PA-MO-FCLTY-COST     TO PA-MO-DPT-COST.                     CL**2
00632      ADD PA-MO-FCLTY-RETAIL   TO PA-MO-DPT-RETAIL.                   CL**2
00633 *                                                                    CL**2
00634      INITIALIZE PA-FCLTY-TOTALS.                                     CL**2
00635 *                                                                    CL**2
00636      PERFORM 2100-ACCUMULATE-TOTALS.                                 CL**2
00637                                                                      CL**2
00638 ******************************************************************   CL**2
00639 * 2300-DPT-BREAK                                                     CL**2
00640 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN    CL**2
00641 *  THE DPT:                                                          CL**2
00642 *     1) PERFORM FACILITY BREAK LOGIC                                CL**2
00643 *     2) PRINT DEPARTMENT TOTAL LINE                                 CL**2
00644 *     3) RESET THE "HOLD" DPT VALUE                                  CL**2
00645 *     4) ADD "OLD" DPT TOTALS TO VND TOTALS                          CL**2
00646 *     5) INITIALIZE DPT TOTALS FOR NEW DPT                           CL**2
00647 ******************************************************************   CL**2
00648  2300-DPT-BREAK.                                                     CL**2
00649                                                                      CL**2
00650      PERFORM 2200-FCLTY-BREAK.                                       CL**2
00651 *                                                                    CL**2
00652      SET PS-PRINT-DPT-TOTAL   TO TRUE                                CL**2
00653      PERFORM 8100-PRINT-TOTAL-LINE                                   CL**2
00654 *                                                                    CL**2
00655      MOVE RV010-DPT-NBR       TO DL-DPT-NBR                          CL**2
00656                                  PV-HOLD-DPT-NBR.                    CL**2
00657      MOVE RV010-DPT-DESC      TO DL-DPT-DESC                         CL**2
00658                                  PV-HOLD-DPT-DESC.                   CL**2
00659 *                                                                    CL**2
00660      ADD PA-DR-DPT-QTY        TO PA-DR-VND-QTY.                      CL**2
00661      ADD PA-DR-DPT-COST       TO PA-DR-VND-COST.                     CL**2
00661      ADD PA-DR-DPT-RETAIL     TO PA-DR-VND-RETAIL.                   CL**2
00662                                                                      CL**2
00663      ADD PA-DD-DPT-QTY        TO PA-DD-VND-QTY.                      CL**2
00664      ADD PA-DD-DPT-COST       TO PA-DD-VND-COST.                     CL**2
00664      ADD PA-DD-DPT-RETAIL     TO PA-DD-VND-RETAIL.                   CL**2
00665                                                                      CL**2
00666      ADD PA-MO-DPT-QTY        TO PA-MO-VND-QTY.                      CL**2
00667      ADD PA-MO-DPT-COST       TO PA-MO-VND-COST.                     CL**2
00667      ADD PA-MO-DPT-RETAIL     TO PA-MO-VND-RETAIL.                   CL**2
00668 *                                                                    CL**2
00669      INITIALIZE PA-DPT-TOTALS.                                       CL**2
00670                                                                      CL**2
00671 *                                                                    CL**2
00672 ******************************************************************   CL**2
00673 * 2400-VND-BREAK                                                     CL**2
00674 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN    CL**2
00675 *  THE VENDOR:                                                       CL**2
00676 *     1) PERFORM DEPARTMENT BREAK LOGIC                              CL**2
00677 *     2) PRINT VENDOR TOTAL LINE                                     CL**2
00678 *     3) RESET THE "HOLD" VENDOR VALUES                              CL**2
00679 *     4) ADD "OLD" VENDOR TOTALS TO GRAND TOTALS                     CL**2
00680 *     5) INITIALIZE VENDOR TOTALS FOR NEW VENDOR                     CL**2
00681 ******************************************************************   CL**2
00682  2400-VND-BREAK.                                                     CL**2
00683                                                                      CL**2
00684      PERFORM 2300-DPT-BREAK.                                         CL**2
00685 *                                                                    CL**2
00686      SET PS-PRINT-VND-TOTAL   TO TRUE.                               CL**2
00687      PERFORM 8100-PRINT-TOTAL-LINE.                                  CL**2
00688 *                                                                    CL**2
00689      MOVE RV010-DUNS-NBR      TO DL-DUNS-NBR                         CL**2
00690                                  PV-HOLD-DUNS-NBR.                   CL**2
00691      MOVE RV010-VND-NAME      TO DL-VND-NAME                         CL**2
00692                                  PV-HOLD-VND-NAME.                   CL**2
00693 *                                                                    CL**2
00694      ADD PA-DR-VND-QTY        TO PA-DR-GRAND-QTY.                    CL**2
00695      ADD PA-DR-VND-COST       TO PA-DR-GRAND-COST.                   CL**2
00695      ADD PA-DR-VND-RETAIL     TO PA-DR-GRAND-RETAIL.                 CL**2
00696                                                                      CL**2
00697      ADD PA-DD-VND-QTY        TO PA-DD-GRAND-QTY.                    CL**2
00698      ADD PA-DD-VND-COST       TO PA-DD-GRAND-COST.                   CL**2
00698      ADD PA-DD-VND-RETAIL     TO PA-DD-GRAND-RETAIL.                 CL**2
00699                                                                      CL**2
00700      ADD PA-MO-VND-QTY        TO PA-MO-GRAND-QTY.                    CL**2
00701      ADD PA-MO-VND-COST       TO PA-MO-GRAND-COST.                   CL**2
00701      ADD PA-MO-VND-RETAIL     TO PA-MO-GRAND-RETAIL.                 CL**2
00702 *                                                                    CL**2
00703      INITIALIZE PA-VND-TOTALS.                                       CL**2
00704                                                                      CL**2
00705 *                                                                    CL**2
00706 *                                                                    CL**2
00707 ******************************************************************   CL**2
00708 * 2500-GRAND-TOTAL                                                   CL**2
00709 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR THE GRAND      CL**2
00710 *  TOTAL:                                                            CL**2
00711 *     1) PERFORM DPT BREAK LOGIC                                     CL**2
00712 *     2) PRINT GRAND TOTAL LINE                                      CL**2
00713 ******************************************************************   CL**2
00714  2500-GRAND-TOTAL.                                                   CL**2
00715                                                                      CL**2
00716      PERFORM 2400-VND-BREAK.                                         CL**2
00717 *                                                                    CL**2
00718      SET PS-PRINT-GRAND-TOTAL TO TRUE.                               CL**2
00719      PERFORM 8100-PRINT-TOTAL-LINE.                                  CL**2
00720 *                                                                    CL**2
00721 *                                                                    CL**2
00722 ******************************************************************   CL**2
00723 * 7000-READ-EXTRACT-FILE.                                        *   CL**2
00724 *  THIS PROCEDURE WILL READ ONE EXTRACT RECORD FROM THE EXTRACT  *   CL**2
00725 *  FLAT FILE.                                                    *   CL**2
00726 ******************************************************************   CL**2
00727  7000-READ-EXTRACT-FILE.                                             CL**2
00728 *                                                                    CL**2
00729      READ RTV-REPORT-EXTRACT                                         CL**2
00730          INTO RV010-EXTRACT-RECORD                                   CL**2
00731          AT END SET PS-END-OF-EXTRACT-FILE TO TRUE.                  CL**2
00732                                                                      CL**2
00733 ******************************************************************   CL**2
00734 * 8000-PRINT-REPORT-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-      CL**2
00735 * CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNT   CL**2
00736 * INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                     CL**2
00737 ******************************************************************   CL**2
00738  8000-PRINT-REPORT-LINE.                                             CL**2
00739                                                                      CL**2
00740      ADD +1 TO PV-LINE-COUNT.                                        CL**2
00741                                                                      CL**2
00742      IF PV-LINE-COUNT >= PC-MAX-REPORT-LINES                         CL**2
00743          PERFORM 8300-WRITE-PAGE-HEADING                             CL**2
00744          PERFORM 8400-WRITE-COLUMN-HEADING                           CL**2
00745      END-IF.                                                         CL**2
00746                                                                      CL**2
00747      MOVE PV-HOLD-FCLTY-NAME       TO DL-FCLTY-NAME.                 CL**2
00748      MOVE PA-DR-FCLTY-QTY          TO DL-DR-QTY.                     CL**2
00749      MOVE PA-DR-FCLTY-COST         TO DL-DR-COST-RETAIL.             CL**2
00750      MOVE PA-DD-FCLTY-QTY          TO DL-DD-QTY.                     CL**2
00751      MOVE PA-DD-FCLTY-COST         TO DL-DD-COST-RETAIL.             CL**2
00752      MOVE PA-MO-FCLTY-QTY          TO DL-MO-QTY.                     CL**2
00753      MOVE PA-MO-FCLTY-COST         TO DL-MO-COST-RETAIL.             CL**2
00755      WRITE DI-DEFECT-ITEM-LINE-COST                                  CL**2
00756          FROM DL-DETAIL-LINE                                         CL**2
00757          AFTER ADVANCING 1 LINES.                                    CL**2
00754                                                                      CL**2
00749      MOVE PA-DR-FCLTY-RETAIL       TO DL-DR-COST-RETAIL.             CL**2
00751      MOVE PA-DD-FCLTY-RETAIL       TO DL-DD-COST-RETAIL.             CL**2
00753      MOVE PA-MO-FCLTY-RETAIL       TO DL-MO-COST-RETAIL.             CL**2
00755      WRITE DI-DEFECT-ITEM-LINE-RETAIL                                CL**2
00756          FROM DL-DETAIL-LINE                                         CL**2
00757          AFTER ADVANCING 1 LINES.                                    CL**2
00758                                                                      CL**2
00759      MOVE SPACES                   TO DL-DPT-NBR                     CL**2
00760                                       DL-DPT-DESC                    CL**2
00761                                       DL-DUNS-NBR                    CL**2
00762                                       DL-VND-NAME.                   CL**2
00763                                                                      CL**2
00764 *8000-EXIT.                                                          CL**2
00765                                                                      CL**2
00766 ******************************************************************   CL**2
00767 * 8100-PRINT-TOTAL-LINE - WRITE THE CONTROL BREAK TOTAL LINES        CL**2
00768 ******************************************************************   CL**2
00769  8100-PRINT-TOTAL-LINE.                                              CL**2
00770                                                                      CL**2
00771      EVALUATE TRUE                                                   CL**2
00772          WHEN PS-PRINT-DPT-TOTAL                                     CL**2
00773              IF PA-DPT-DC-COUNT > 1                                  CL**2
00774                  STRING '                DEPARTMENT '                CL**2
00775                                          DELIMITED BY SIZE           CL**2
00776                         PV-HOLD-DPT-NBR  DELIMITED BY SIZE           CL**2
00777                  INTO TL-TOTAL-DESCRIPTION                           CL**2
00778                                                                      CL**2
00779 *                MOVE SPACES          TO TL-TOTAL-DESCRIPTION        CL**2
00780                  MOVE PA-DR-DPT-QTY   TO TL-DR-QTY                   CL**2
00781                  MOVE PA-DR-DPT-COST  TO TL-DR-COST-RETAIL           CL**2
00782                  MOVE PA-DD-DPT-QTY   TO TL-DD-QTY                   CL**2
00783                  MOVE PA-DD-DPT-COST  TO TL-DD-COST-RETAIL           CL**2
00784                  MOVE PA-MO-DPT-QTY   TO TL-MO-QTY                   CL**2
00785                  MOVE PA-MO-DPT-COST  TO TL-MO-COST-RETAIL           CL**2
00787                  WRITE DI-DEFECT-ITEM-LINE-COST                      CL**2
00788                      FROM TL-TOTAL-LINE                              CL**2
00789                      AFTER ADVANCING 1 LINES                         CL**2
                                                                                
00781                  MOVE PA-DR-DPT-RETAIL TO TL-DR-COST-RETAIL          CL**2
00783                  MOVE PA-DD-DPT-RETAIL TO TL-DD-COST-RETAIL          CL**2
00785                  MOVE PA-MO-DPT-RETAIL TO TL-MO-COST-RETAIL          CL**2
00787                  WRITE DI-DEFECT-ITEM-LINE-RETAIL                    CL**2
00788                      FROM TL-TOTAL-LINE                              CL**2
00789                      AFTER ADVANCING 1 LINES                         CL**2
00790                                                                      CL**2
00791                  ADD +1           TO PV-LINE-COUNT                   CL**2
00792              END-IF                                                  CL**2
00793                                                                      CL**2
00794          WHEN PS-PRINT-VND-TOTAL                                     CL**2
00795                                                                      CL**2
00796              MOVE +0 TO PV-CHAR-COUNT                                CL**2
00797                                                                      CL**2
00798              INSPECT PV-HOLD-VND-NAME TALLYING PV-CHAR-COUNT         CL**2
00799                  FOR CHARACTERS BEFORE '  '                          CL**2
00800                                                                      CL**2
00801              MOVE PV-HOLD-VND-NAME    TO PV-VENDOR-TOTAL-DESC        CL**2
00802                                                                      CL**2
00803              MOVE PV-VENDOR-TOTAL-DESC                               CL**2
00804                                       TO PV-TOTAL-DESCRIPTION        CL**2
00805              MOVE PV-TOTAL-DESCRIPTION                               CL**2
00806                                       TO TL-TOTAL-DESCRIPTION        CL**2
00807                                                                      CL**2
00808              MOVE PA-DR-VND-QTY       TO TL-DR-QTY                   CL**2
00809              MOVE PA-DR-VND-COST      TO TL-DR-COST-RETAIL           CL**2
00810              MOVE PA-DD-VND-QTY       TO TL-DD-QTY                   CL**2
00811              MOVE PA-DD-VND-COST      TO TL-DD-COST-RETAIL           CL**2
00812              MOVE PA-MO-VND-QTY       TO TL-MO-QTY                   CL**2
00813              MOVE PA-MO-VND-COST      TO TL-MO-COST-RETAIL           CL**2
00815              WRITE DI-DEFECT-ITEM-LINE-COST                          CL**2
00816                  FROM TL-TOTAL-LINE-DASHES                           CL**2
00817                  AFTER ADVANCING 0 LINES                             CL**2
00819              WRITE DI-DEFECT-ITEM-LINE-COST                          CL**2
00820                  FROM TL-TOTAL-LINE                                  CL**2
00821                  AFTER ADVANCING 1 LINES                             CL**2
00822                                                                      CL**2
00809              MOVE PA-DR-VND-RETAIL    TO TL-DR-COST-RETAIL           CL**2
00811              MOVE PA-DD-VND-RETAIL    TO TL-DD-COST-RETAIL           CL**2
00813              MOVE PA-MO-VND-RETAIL    TO TL-MO-COST-RETAIL           CL**2
00815              WRITE DI-DEFECT-ITEM-LINE-RETAIL                        CL**2
00816                  FROM TL-TOTAL-LINE-DASHES                           CL**2
00817                  AFTER ADVANCING 0 LINES                             CL**2
00819              WRITE DI-DEFECT-ITEM-LINE-RETAIL                        CL**2
00820                  FROM TL-TOTAL-LINE                                  CL**2
00821                  AFTER ADVANCING 1 LINES                             CL**2
00822                                                                      CL**2
00823              ADD +1           TO PV-LINE-COUNT                       CL**2
00824                                                                      CL**2
00825              PERFORM  8200-WRITE-BLANK-LINE                          CL**2
00826                                                                      CL**2
00827          WHEN PS-PRINT-GRAND-TOTAL                                   CL**2
00828              MOVE '                        GRAND '                   CL**2
00829                                       TO TL-TOTAL-DESCRIPTION        CL**2
00830              MOVE PA-DR-GRAND-QTY     TO TL-DR-QTY                   CL**2
00831              MOVE PA-DR-GRAND-COST    TO TL-DR-COST-RETAIL           CL**2
00832              MOVE PA-DD-GRAND-QTY     TO TL-DD-QTY                   CL**2
00833              MOVE PA-DD-GRAND-COST    TO TL-DD-COST-RETAIL           CL**2
00834              MOVE PA-MO-GRAND-QTY     TO TL-MO-QTY                   CL**2
00835              MOVE PA-MO-GRAND-COST    TO TL-MO-COST-RETAIL           CL**2
00837              WRITE DI-DEFECT-ITEM-LINE-COST                          CL**2
00838                  FROM TL-TOTAL-LINE-DASHES                           CL**2
00839                  AFTER ADVANCING 0 LINES                             CL**2
00841              WRITE DI-DEFECT-ITEM-LINE-COST                          CL**2
00842                  FROM TL-TOTAL-LINE                                  CL**2
00843                  AFTER ADVANCING 1 LINES                             CL**2
00844                                                                      CL**2
00831              MOVE PA-DR-GRAND-RETAIL  TO TL-DR-COST-RETAIL           CL**2
00833              MOVE PA-DD-GRAND-RETAIL  TO TL-DD-COST-RETAIL           CL**2
00835              MOVE PA-MO-GRAND-RETAIL  TO TL-MO-COST-RETAIL           CL**2
00837              WRITE DI-DEFECT-ITEM-LINE-RETAIL                        CL**2
00838                  FROM TL-TOTAL-LINE-DASHES                           CL**2
00839                  AFTER ADVANCING 0 LINES                             CL**2
00841              WRITE DI-DEFECT-ITEM-LINE-RETAIL                        CL**2
00842                  FROM TL-TOTAL-LINE                                  CL**2
00843                  AFTER ADVANCING 1 LINES                             CL**2
00844                                                                      CL**2
00845              PERFORM  8200-WRITE-BLANK-LINE                          CL**2
00846                                                                      CL**2
00847      END-EVALUATE.                                                   CL**2
00848                                                                      CL**2
00849 *8100-EXIT.                                                          CL**2
00850                                                                      CL**2
00851 ******************************************************************   CL**2
00852 * 8200-WRITE-BLANK-LINE - WRITES A BLANK LINE TO THE REPORT.         CL**2
00853 ******************************************************************   CL**2
00854  8200-WRITE-BLANK-LINE.                                              CL**2
00855                                                                      CL**2
00856      WRITE DI-DEFECT-ITEM-LINE-COST                                  CL**2
00857          FROM BLANK-LINE                                             CL**2
00858          AFTER ADVANCING 1 LINES.                                    CL**2
00856      WRITE DI-DEFECT-ITEM-LINE-RETAIL                                CL**2
00857          FROM BLANK-LINE                                             CL**2
00858          AFTER ADVANCING 1 LINES.                                    CL**2
00859                                                                      CL**2
00860      ADD +1                        TO PV-LINE-COUNT.                 CL**2
00861                                                                      CL**2
00862                                                                      CL**2
00863 *8200-EXIT.                                                          CL**2
00864 ******************************************************************   CL**2
00865 * 8300-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FOR   CL**2
00866 * THE DEFECTIVE ITEM REPORT.                                         CL**2
00867 ******************************************************************   CL**2
00868  8300-WRITE-PAGE-HEADING.                                            CL**2
00869                                                                      CL**2
00870      ADD +1 TO PV-PAGE-COUNT.                                        CL**2
00871      MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                       CL**2
00872                                                                      CL**2
           EVALUATE TRUE                                                        
00527        WHEN PV-MONTHLY-REPORT                                        CL**2
00528          MOVE 1            TO DP132O-REPORT-NUMBER                   CL**2
00529        WHEN PV-YEAR-TO-DATE-REPORT                                   CL**2
00530          MOVE 2            TO DP132O-REPORT-NUMBER                   CL**2
00527        WHEN PV-WEEKLY-REPORT                                         CL**2
00528          MOVE 5            TO DP132O-REPORT-NUMBER                   CL**2
00531      END-EVALUATE                                                    CL**2
                                                                                
00873      WRITE DI-DEFECT-ITEM-LINE-COST                                  CL**2
00874          FROM DP132O-STANDRD-HEADER-132-COLS                         CL**2
00875          AFTER ADVANCING PAGE.                                       CL**2
                                                                                
           EVALUATE TRUE                                                        
00527        WHEN PV-MONTHLY-REPORT                                        CL**2
00528          MOVE 3            TO DP132O-REPORT-NUMBER                   CL**2
00529        WHEN PV-YEAR-TO-DATE-REPORT                                   CL**2
00530          MOVE 4            TO DP132O-REPORT-NUMBER                   CL**2
00527        WHEN PV-WEEKLY-REPORT                                         CL**2
00528          MOVE 6            TO DP132O-REPORT-NUMBER                   CL**2
00531      END-EVALUATE                                                    CL**2
                                                                                
00873      WRITE DI-DEFECT-ITEM-LINE-RETAIL                                CL**2
00874          FROM DP132O-STANDRD-HEADER-132-COLS                         CL**2
00875          AFTER ADVANCING PAGE.                                       CL**2
00876                                                                      CL**2
00877                                                                      CL**2
           EVALUATE TRUE                                                        
00878        WHEN PV-MONTHLY-REPORT                                        CL**2
00879          WRITE DI-DEFECT-ITEM-LINE-COST                              CL**2
00880              FROM PH2-PAGE-HEADING-MNTH-COST                         CL**2
00881              AFTER ADVANCING 1 LINES                                 CL**2
00879          WRITE DI-DEFECT-ITEM-LINE-RETAIL                            CL**2
00880              FROM PH2-PAGE-HEADING-MNTH-RETAIL                       CL**2
00881              AFTER ADVANCING 1 LINES                                 CL**2
00878        WHEN PV-YEAR-TO-DATE-REPORT                                   CL**2
00883          WRITE DI-DEFECT-ITEM-LINE-COST                              CL**2
00884              FROM PH2-PAGE-HEADING-YTD-COST                          CL**2
00885              AFTER ADVANCING 1 LINES                                 CL**2
00883          WRITE DI-DEFECT-ITEM-LINE-RETAIL                            CL**2
00884              FROM PH2-PAGE-HEADING-YTD-RETAIL                        CL**2
00885              AFTER ADVANCING 1 LINES                                 CL**2
00878        WHEN PV-WEEKLY-REPORT                                         CL**2
00879          WRITE DI-DEFECT-ITEM-LINE-COST                              CL**2
UPD                FROM PH2-PAGE-HEADING-WEEK-COST                         CL**2
UPD                AFTER ADVANCING 1 LINES                                 CL**2
UPD            WRITE DI-DEFECT-ITEM-LINE-RETAIL                            CL**2
UPD                FROM PH2-PAGE-HEADING-WEEK-RETAIL                       CL**2
00881              AFTER ADVANCING 1 LINES                                 CL**2
00886      END-EVALUATE.                                                   CL**2
00887                                                                      CL**2
00888      WRITE DI-DEFECT-ITEM-LINE-COST                                  CL**2
00889          FROM PH3-PAGE-HEADING-3                                     CL**2
00890          AFTER ADVANCING 1 LINES.                                    CL**2
00888      WRITE DI-DEFECT-ITEM-LINE-RETAIL                                CL**2
00889          FROM PH3-PAGE-HEADING-3                                     CL**2
00890          AFTER ADVANCING 1 LINES.                                    CL**2
00891                                                                      CL**2
00892      MOVE +3     TO PV-LINE-COUNT.                                   CL**2
00893                                                                      CL**2
00894      MOVE PV-HOLD-DUNS-NBR    TO DL-DUNS-NBR.                        CL**2
00895      MOVE PV-HOLD-VND-NAME    TO DL-VND-NAME.                        CL**2
00896      MOVE PV-HOLD-DPT-NBR     TO DL-DPT-NBR.                         CL**2
00897      MOVE PV-HOLD-DPT-DESC    TO DL-DPT-DESC.                        CL**2
00898                                                                      CL**2
00899 *8300-EXIT.                                                          CL**2
00900                                                                      CL**2
00901 ******************************************************************   CL**2
00902 * 8400-WRITE-COLUMN-HEADING - WRITE THE COLUMN HEADINGS FOR          CL**2
00903 * THE DEFECTIVE ITEM REPORT.                                         CL**2
00904 ******************************************************************   CL**2
00905  8400-WRITE-COLUMN-HEADING.                                          CL**2
00906                                                                      CL**2
00907      WRITE DI-DEFECT-ITEM-LINE-COST                                  CL**2
00908          FROM DH1-DETAIL-HEADING-1                                   CL**2
00909          AFTER ADVANCING 2 LINES.                                    CL**2
00907      WRITE DI-DEFECT-ITEM-LINE-RETAIL                                CL**2
00908          FROM DH1-DETAIL-HEADING-1                                   CL**2
00909          AFTER ADVANCING 2 LINES.                                    CL**2
00910                                                                      CL**2
00911      WRITE DI-DEFECT-ITEM-LINE-COST                                  CL**2
00912          FROM DH2-DETAIL-HEADING-2-COST                              CL**2
00913          AFTER ADVANCING 1 LINES.                                    CL**2
00911      WRITE DI-DEFECT-ITEM-LINE-RETAIL                                CL**2
00912          FROM DH2-DETAIL-HEADING-2-RETAIL                            CL**2
00913          AFTER ADVANCING 1 LINES.                                    CL**2
00914                                                                      CL**2
00915      WRITE DI-DEFECT-ITEM-LINE-COST                                  CL**2
00916          FROM DHD-DETAIL-HEADING-DASHES                              CL**2
00917          AFTER ADVANCING 0 LINES.                                    CL**2
00915      WRITE DI-DEFECT-ITEM-LINE-RETAIL                                CL**2
00916          FROM DHD-DETAIL-HEADING-DASHES                              CL**2
00917          AFTER ADVANCING 0 LINES.                                    CL**2
00918                                                                      CL**2
00919      ADD +4       TO PV-LINE-COUNT.                                  CL**2
00920 *8400-EXIT.                                                          CL**2
00921                                                                      CL**2
00922 ******************************************************************   CL**2
00923 * 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER     CL**2
00924 * CURSOR AND THE REPORT FILE.                                        CL**2
00925 ******************************************************************   CL**2
00926  9000-EOJ-ROUTINE.                                                   CL**2
00927                                                                      CL**2
00928      IF PS-NO-DATA                                                   CL**2
00929          CONTINUE                                                    CL**2
00930      ELSE                                                            CL**2
00931          PERFORM 2500-GRAND-TOTAL                                    CL**2
00932      END-IF.                                                         CL**2
00933                                                                      CL**2
00934      WRITE DI-DEFECT-ITEM-LINE-COST                                  CL**2
00935          FROM END-OF-REPORT-LINE                                     CL**2
00936          AFTER ADVANCING 1 LINES.                                    CL**2
00934      WRITE DI-DEFECT-ITEM-LINE-RETAIL                                CL**2
00935          FROM END-OF-REPORT-LINE                                     CL**2
00936          AFTER ADVANCING 1 LINES.                                    CL**2
00937                                                                      CL**2
00938      CLOSE DI-DEFECT-ITEM-REPORT-COST                                CL**2
00938            DI-DEFECT-ITEM-REPORT-RETAIL                              CL**2
00939            RTV-REPORT-EXTRACT.                                       CL**2
00940                                                                      CL**2
00941 ******************************************************************   CL**2
00942 *********************** END OF RVKRP007 **************************   CL**2
00943 ******************************************************************   CL**2
