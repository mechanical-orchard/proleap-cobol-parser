000100 IDENTIFICATION DIVISION.                                         00020001
000200 PROGRAM-ID.      XSKRP039.                                       00030001
000300 AUTHOR.          NANCY MARTIN                                    00040001
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050001
000500 DATE-WRITTEN.    10/18/2004.                                     00060001
000600 DATE-COMPILED.                                                   00070001
000700******************************************************************00080001
000800**XS DOMAIN TABLE INTEGRITY CHECK - FOR TABLE XST_STR_GP_PRCHG    00090001
000900******************************************************************00100001
001000**THIS PROGRAM VALIDATES THE DATA IN THE XS DOMAIN IS THE SAME    00110001
001100**AS THE DATA IN THE SOR                                          00120001
001150**   THIS PROGRAM WAS CLONED FROM XSKRP038                        00130001
001160**   CREATED FOR NEW PERM SYSTEM WORK WR27634                     00140001
001200******************************************************************00150001
      * DATE:        02/04/2005                                         00151016
      * WR/IR#:      WR27634                                            00152016
      * PROGRAMMER:  NANCY MARTIN                                       00153016
      * DESCRIPTION: CHANGE TO NOT HAVE EMPTY SOR FILE TRIGGER MSG.     00154016
      *                                                                 00155016
      *--------------------------------------------------------------*  00156016
      * DATE:        07/26/2010                                         00157020
      * WR/IR#:      WR36734                                            00158022
      * PROGRAMMER:  DAVE METZGER                                       00159020
      * DESCRIPTION: REMOVED TMST VALIDATION CHECK AS PART OF THE       00159120
      *              MDO SPRING 2010 PROJECT DUE TO MESSAGING           00159220
      *              CHANGES FROM PERM TO XS.                           00159321
      *                                                                 00159420
      *--------------------------------------------------------------*  00159920
001300 ENVIRONMENT DIVISION.                                            00160001
001400 CONFIGURATION SECTION.                                           00170001
001500 SOURCE-COMPUTER.        IBM-3090.                                00180001
001600 OBJECT-COMPUTER.        IBM-3090.                                00190001
001700 INPUT-OUTPUT SECTION.                                            00200001
001800 FILE-CONTROL.                                                    00210001
001900                                                                  00220001
002400     SELECT SOR-PRCHG-EXTRACT-FILE                                00230001
002500            ASSIGN TO INP01.                                      00240001
002600     SELECT XS-PRCHG-EXTRACT-FILE                                 00250001
002700            ASSIGN TO INP02.                                      00260001
002800     SELECT XS-PRCHG-INTEG-RPT-FILE                               00270001
002900            ASSIGN TO RPT01.                                      00280001
003000                                                                  00290001
003100 DATA DIVISION.                                                   00300001
003200 FILE SECTION.                                                    00310001
003300                                                                  00320001
004800 FD  SOR-PRCHG-EXTRACT-FILE                                       00321001
004900     RECORDING MODE F                                             00322001
005000     BLOCK CONTAINS 0 RECORDS                                     00323001
005100     LABEL RECORDS ARE OMITTED                                    00324001
005200     DATA RECORD IS SOR-PRCHG-EXTRACT-RECORD.                     00325001
005300 01  SOR-PRCHG-EXTRACT-RECORD        PIC X(200).                  00326001
005400                                                                  00327001
005500 FD  XS-PRCHG-EXTRACT-FILE                                        00400001
005600     RECORDING MODE F                                             00410001
005700     BLOCK CONTAINS 0 RECORDS                                     00420001
005800     LABEL RECORDS ARE OMITTED                                    00430001
005900     DATA RECORD IS XS-PRCHG-EXTRACT-RECORD.                      00440001
006000 01  XS-PRCHG-EXTRACT-RECORD         PIC X(072).                  00450004
006100                                                                  00460001
006200 FD  XS-PRCHG-INTEG-RPT-FILE                                      00470001
006300     RECORDING MODE IS F                                          00480001
006400     BLOCK CONTAINS 0  RECORDS.                                   00490001
006500 01  XS-PRCHG-INTEG-RPT-RECORD       PIC  X(200).                 00500001
006600                                                                  00510001
006700 WORKING-STORAGE SECTION.                                         00520001
006800                                                                  00530001
006900 01  FILLER                              PIC X(41)                00540001
007000     VALUE 'WORKING STORAGE STARTS HERE FOR XSKRP039'.            00550001
007100                                                                  00560001
007200 01  PS-PROGRAM-SWITCHES.                                         00570001
NEMNTE***** THE VARIABLE NAMES WERE LEFT "PRCHG" EVEN THOUGH            00571003
NEMNTE***** THIS PROGRAM DEALS WITH "STR GP PRCHG"                      00572003
007900     05  PS-END-OF-SOR-PRCHG-SW          PIC X(01) VALUE 'N'.     00580001
008000         88  PS-END-OF-SOR-PRCHG                   VALUE 'Y'.     00590001
008100         88  PS-NOT-END-OF-SOR-PRCHG               VALUE 'N'.     00600001
008200     05  PS-END-OF-XS-PRCHG-SW           PIC X(01) VALUE 'N'.     00610001
008300         88  PS-END-OF-XS-PRCHG                    VALUE 'Y'.     00620001
008400         88  PS-NOT-END-OF-XS-PRCHG                VALUE 'N'.     00630001
009100     05  PS-ERROR-FOUND-SW               PIC X(01) VALUE 'N'.     00670001
009200         88  PS-ERROR-FOUND                        VALUE 'Y'.     00680001
009300         88  PS-NO-ERROR-FOUND                     VALUE 'N'.     00690001
009400                                                                  00700001
010500 01  PC-PROGRAM-CONSTANTS.                                        00710001
010600     05  PC-CURRENT-PROGRAM-NAME         PIC X(08)  VALUE         00720001
010700                                                    'XSKRP039'.   00730001
010800     05  PC-REPORT-NBR-1                 PIC  9(01) VALUE 1.      00740001
010900     05  PC-ONE                          PIC  9(01) VALUE 1.      00750001
NEMTST     05  PC-NULL                         PIC S9(04) VALUE -1.     00760001
011200     05  PC-MAX-REPORT-LINES             PIC S9(05) VALUE +74     00770001
011300                                                    COMP-3.       00780001
011400                                                                  00790001
011500     05  PC-NO-ERROR-MESSAGE             PIC  X(200) VALUE        00800001
011600         'NO ERRORS'.                                             00810001
011900                                                                  00820001
012600     05  PC-MISSING-FROM-SOR-PRCHG       PIC  X(50) VALUE         00920009
012700         'MATCHING KEY NOT FOUND ON SOR STR GP PRCHG EXTRACT'.    00930011
*************   123456789-123456789-123456789-123456789-123456789-      00931011
012800                                                                  00940001
012900     05  PC-MISSING-FROM-XS-PRCHG        PIC  X(50) VALUE         00950009
013000         'MATCHING KEY NOT FOUND ON XS STR GP PRCHG EXTRACT'.     00960008
013100                                                                  00970001
012600     05  PC-EXTRA-FOUND-SOR-PRCHG        PIC  X(50) VALUE         00980009
012700         'ADDITIONAL DATA FOUND FOR SOR STR GP PRCHG EXTRACT'.    00990003
012800                                                                  01000001
012900     05  PC-EXTRA-FOUND-XS-PRCHG        PIC  X(50) VALUE          01010009
013000         'ADDITTIONAL DATA FOUND ON XS STR GP PRCHG EXTRACT'.     01020003
013100                                                                  01030001
           05  PC-EMPTY-SOR-PRCHG              PIC  X(40) VALUE         01031013
               'NO DATA RECEIVED FROM SOR PRCHG EXTRACT '.              01032017
*************   123456789-123456789-123456789-123456789-123456789-      01032113
                                                                        01033012
013200 01  PV-MISCELANEOUS.                                             01040001
NEMCHG     05  PV-TEMP-PRCHG-ID                PIC S9(11) COMP          01050001
NEMCHG                                                    VALUE ZEROS.  01060001
013400     05  PV-PRINT-RECORD                 PIC X(200) VALUE SPACE.  01070001
013500     05  PV-LINE-SPACING                 PIC S9(04) VALUE ZEROES  01080001
013600                                                    COMP SYNC.    01090001
014200     05  PV-WORK-DATE-CCYYMMDD.                                   01091003
014300         10  PV-WORK-DATE-CC             PIC  9(02) VALUE ZEROES. 01092003
014300         10  PV-WORK-DATE-YY             PIC  9(02) VALUE ZEROES. 01092103
014300         10  FILLER                      PIC  X(01) VALUE '-'.    01092203
014400         10  PV-WORK-DATE-MM             PIC  9(02) VALUE ZEROES. 01093003
014300         10  FILLER                      PIC  X(01) VALUE '-'.    01093103
014500         10  PV-WORK-DATE-DD             PIC  9(02) VALUE ZEROES. 01094003
014600                                                                  01095003
013700     05  PV-CURR-TIME.                                            01100001
013800        10  PV-CURR-TIME-HH              PIC  9(02) VALUE ZEROES. 01110001
013900        10  PV-CURR-TIME-MM              PIC  9(02) VALUE ZEROES. 01120001
014000        10  PV-CURR-TIME-SSHH            PIC  9(04) VALUE ZEROES. 01130001
014100                                                                  01140001
014200     05  PV-CURR-DATE-CCYYMMDD.                                   01150001
014300         10  PV-CURR-DATE-CCYY           PIC  9(04) VALUE ZEROES. 01160001
014400         10  PV-CURR-DATE-MM             PIC  9(02) VALUE ZEROES. 01170001
014500         10  PV-CURR-DATE-DD             PIC  9(02) VALUE ZEROES. 01180001
014600                                                                  01190001
014700 01  PV-PROGRAM-COUNTER.                                          01200001
014800     05  PV-PAGE-CNT                     PIC  9(05) VALUE ZEROS.  01210001
014900     05  PV-LINE-CNT                     PIC S9(07) VALUE ZEROS.  01220001
015000     05  PV-SOR-PRCHG-RECS-READ-CNT      PIC  9(09) VALUE ZEROS.  01230001
015200     05  PV-XS-EXTRACT-REC-READ-CNT      PIC  9(09) VALUE ZEROS.  01240001
015000     05  PV-SOR-PRCHG-RECS-UNIQUE        PIC  9(09) VALUE ZEROS.  01250001
015200     05  PV-XS-EXTRACT-REC-UNIQUE        PIC  9(09) VALUE ZEROS.  01260001
015000     05  PV-SOR-XS-COMMON-CNT            PIC  9(09) VALUE ZEROS.  01270001
015000     05  PV-SOR-XS-TOTAL-CNT             PIC  9(09) VALUE ZEROS.  01280001
015300     05  PV-ERROR-RECORD-WRITTEN-CNT     PIC  9(09) VALUE ZEROS.  01290001
015400     05  PV-VALID-MATCH-CNT              PIC  9(09) VALUE ZEROS.  01300001
015500                                                                  01310001
015600 01  PV-MISC-ABEND-FIELDS.                                        01320001
015700     05  PV-PARAGRAPH-NAME               PIC  X(30) VALUE SPACE.  01330001
015800     05  PV-OPERATION-MSG-1              PIC  X(40) VALUE SPACE.  01340001
015900     05  PV-OPERATION-MSG-2              PIC  X(40) VALUE SPACE.  01350001
016100                                                                  01360001
016200 01  PV-ABEND-CODE   COMP  SYNC          PIC S9(04) VALUE +0000.  01370001
016300     88  PV-ABEND-4008-DATA-ERROR                   VALUE +4008.  01380001
016400     88  PV-ABEND-4009-CARD-ERROR                   VALUE +4009.  01390001
016700                                                                  01400001
016800******************************************************************01410001
016900*  TOP OF PAGE HEADING LINE FOR PRINTING A 200 CHARACTER REPORT.  01420001
017000******************************************************************01430001
017100     COPY DPWS200.                                                01440001
017200                                                                  01450001
017300 01  HL2-HEADING-LINE-2.                                          01460001
017400     05  FILLER                  PIC X(82)   VALUE SPACES.        01470003
017500     05  FILLER                  PIC X(37)   VALUE                01480003
017600         'XS STR GP PRCHG DATA INTEGRITY ERRORS'.                 01490003
017700     05  FILLER                  PIC X(81)   VALUE SPACES.        01500003
017800                                                                  01510001
017900 01  HL3-HEADING-LINE-3.                                          01520001
018400     05  FILLER                  PIC X(13)   VALUE                01540006
018500         '  PRCHG ID   '.                                         01550006
018400     05  FILLER                  PIC X(13)   VALUE                01551006
018500         '--STR GRP--  '.                                         01552006
018700     05  FILLER                  PIC X(06)   VALUE                01570001
018800         'SOURCE'.                                                01580001
019000     05  FILLER                  PIC X(22)   VALUE                01620003
019100         '  EFF DATE  OH AUTO  '.                                 01630003
*************   123456789-123456789-123456789                           01640001
019200     05  FILLER                  PIC X(26)   VALUE SPACES.        01650003
019000     05  FILLER                  PIC X(45)   VALUE                01660011
019100         '  ----------------------- DIFFERENCE(S) FOUND'.         01670011
019200     05  FILLER                  PIC X(25)   VALUE                01671009
019300         ' ------------------------'.                             01672009
019200     05  FILLER                  PIC X(25)   VALUE                01673009
019300         '-------------------------'.                             01674009
019200     05  FILLER                  PIC X(25)   VALUE                01680001
019300         '-------------------------'.                             01690009
017900 01  HL4-HEADING-LINE-4.                                          01700001
018000     05  FILLER                  PIC X(13)   VALUE SPACES.        01710006
018400     05  FILLER                  PIC X(13)   VALUE                01711006
018500         'TYPE     ID  '.                                         01712006
018700     05  FILLER                  PIC X(06)   VALUE SPACES.        01713003
019000     05  FILLER                  PIC X(22)   VALUE                01730003
019100         '            CNT IND  '.                                 01740003
019000     05  FILLER                  PIC X(26)   VALUE                01750003
019100         '---SOR UPDATE TIMESTAMP---'.                            01760003
*************   123456789-123456789-123456789-12345678                  01770001
*************   123456789-123456789                                     01800001
019200     05  FILLER                  PIC X(97)   VALUE SPACES.        01810003
019500                                                                  01820001
019600******************************************************************01830001
019700*  DETAIL LINE LAYOUT FOR THE ERROR REPORT.                       01840001
019800******************************************************************01850001
019900 01  DLS-DETAIL-LINE-1.                                           01950009
020100     05  DLS-SOR-PRCHG-ID        PIC Z(10)-    VALUE ZEROES.      01970001
021000     05  FILLER                  PIC X(01)     VALUE SPACES.      01980005
020100     05  DLS-GP-TYP              PIC Z(05)-    VALUE ZEROES.      01981003
021000     05  FILLER                  PIC X(01)     VALUE SPACES.      01982006
020100     05  DLS-GP-ID               PIC Z(05)-    VALUE ZEROES.      01983003
020600     05  FILLER                  PIC X(03)     VALUE SPACES.      01984006
020300     05  DLS-SOURCE              PIC X(03)     VALUE 'SOR'.       01990001
020600     05  FILLER                  PIC X(03)     VALUE SPACES.      02000006
020300     05  DLS-SOR-EFF-DTE         PIC X(08)     VALUE SPACES.      02010003
021200     05  FILLER                  PIC X(05)     VALUE SPACES.      02020006
020300     05  DLS-SOR-OH-CNT-IND      PIC X(01)     VALUE SPACES.      02030003
021200     05  FILLER                  PIC X(06)     VALUE SPACES.      02140006
020300     05  DLS-SOR-SOR-UPD         PIC X(26)     VALUE ZEROES.      02150001
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02160011
021100     05  DLS-ERR-EFF-DT          PIC X(18)     VALUE SPACES.      02180003
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02181011
021100     05  DLS-ERR-OH              PIC X(18)     VALUE SPACES.      02190003
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02191011
021100     05  DLS-ERR-SOR-UPD-TMST    PIC X(18)     VALUE SPACES.      02200003
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      02210011
021100     05  DLS-ERROR-MESSAGE       PIC X(50)     VALUE SPACES.      02221009
021300                                                                  02230001
019900 01  DLX-DETAIL-LINE-1.                                           02240009
020500     05  DLX-XS-PRCHG-ID         PIC Z(10)-    VALUE ZEROES.      02260001
021000     05  FILLER                  PIC X(01)     VALUE SPACES.      02270005
020100     05  DLX-GP-TYP              PIC Z(05)-    VALUE ZEROES.      02271003
021000     05  FILLER                  PIC X(01)     VALUE SPACES.      02272006
020100     05  DLX-GP-ID               PIC Z(05)-    VALUE ZEROES.      02273003
021000     05  FILLER                  PIC X(03)     VALUE SPACES.      02274006
020300     05  DLX-SOURCE              PIC X(03)     VALUE 'XS '.       02280001
021200     05  FILLER                  PIC X(03)     VALUE SPACES.      02290006
020300     05  DLX-XS-EFF-DTE          PIC X(10)     VALUE SPACES.      02300003
021200     05  FILLER                  PIC X(03)     VALUE SPACES.      02310006
020300     05  DLX-XS-OH-CNT-IND       PIC X(01)     VALUE SPACES.      02320003
021200     05  FILLER                  PIC X(06)     VALUE SPACES.      02430006
020300     05  DLX-XS-SOR-UPD          PIC X(26)     VALUE ZEROES.      02440001
021200     05  FILLER                  PIC X(61)     VALUE SPACES.      02500011
021100     05  DLX-ERROR-MESSAGE       PIC X(50)     VALUE SPACES.      02501009
021300                                                                  02510001
021400******************************************************************02520001
021500*  TRAILER LAYOUT FOR THE ERROR REPORT.                           02530001
021600******************************************************************02540001
021700 01  TR1-TRAILER-LINE-1.                                          02550001
021800     05  FILLER                  PIC X(25)   VALUE                02560001
021900         ' TOTAL NUMBER OF ERRORS: '.                             02570001
022000     05  TR1-TOTAL-ERROR-CNT     PIC Z(09)   VALUE ZEROS.         02580001
022100     05  FILLER                  PIC X(166)  VALUE SPACES.        02590001
022200                                                                  02600001
022300******************************************************************02610001
022400**COPYBOOKS                                                       02620001
022500******************************************************************02630001
022600                                                                  02640001
022700***SOR EXTRACT FILE LAYOUT                                        02650001
022800     COPY PERD104.                                                02660003
022900                                                                  02670001
023000***XS EXTRACT FILE LAYOUT                                         02680001
023100     COPY XSRD070.                                                02690003
023200                                                                  02700001
023300***************************************************************** 02710001
023400 PROCEDURE DIVISION.                                              02720001
023500***************************************************************** 02730001
023600 0000-MAINLINE.                                                   02740001
023700                                                                  02750001
023800     PERFORM 1000-INITIALIZATION.                                 02760001
023900                                                                  02770001
           IF PS-NOT-END-OF-SOR-PRCHG                                   02771012
024000        PERFORM 2000-PROCESS-RECORDS                              02780012
024100          UNTIL PS-END-OF-SOR-PRCHG                               02790012
024200             OR PS-END-OF-XS-PRCHG                                02800012
           END-IF.                                                      02801012
024300                                                                  02810001
024400     PERFORM 2200-PROCESS-EXTRA-RECORDS                           02820001
024500       UNTIL PS-END-OF-SOR-PRCHG                                  02830001
024600         AND PS-END-OF-XS-PRCHG.                                  02840001
024700                                                                  02850001
024710     IF PV-ERROR-RECORD-WRITTEN-CNT = 0                           02860001
024720         MOVE PC-NO-ERROR-MESSAGE TO PV-PRINT-RECORD              02870009
024740         PERFORM 8900-WRITE-REPORT-LINE                           02890001
024750     ELSE                                                         02900001
024760         MOVE PV-ERROR-RECORD-WRITTEN-CNT TO                      02910001
024770                TR1-TOTAL-ERROR-CNT                               02920001
024780         MOVE TR1-TRAILER-LINE-1  TO PV-PRINT-RECORD              02930001
024790         PERFORM 8900-WRITE-REPORT-LINE                           02940001
024791     END-IF.                                                      02950001
024792                                                                  02960001
024800     PERFORM 9000-END-OF-PGM.                                     02970001
024900                                                                  02980001
025000     GOBACK.                                                      02990001
025100                                                                  03000001
025200******************************************************************03010001
025300*1000-INITIALIZATION.                                             03020001
025400* INITIALIZATION AREA                                             03030001
025500******************************************************************03040001
025600 1000-INITIALIZATION.                                             03050001
025700                                                                  03060001
025800     INITIALIZE PV-PROGRAM-COUNTER.                               03070001
025900                                                                  03080001
026000     OPEN INPUT  SOR-PRCHG-EXTRACT-FILE                           03090001
026300                 XS-PRCHG-EXTRACT-FILE.                           03100001
026400                                                                  03110001
026500     OPEN OUTPUT XS-PRCHG-INTEG-RPT-FILE.                         03120001
026600                                                                  03130001
031100     ACCEPT PV-CURR-TIME FROM TIME.                               03131015
031200     MOVE PV-CURR-TIME-HH          TO DP200-RUN-HOUR.             03132015
031300     MOVE PV-CURR-TIME-MM          TO DP200-RUN-MINUTE.           03133015
031400                                                                  03134015
031500     MOVE FUNCTION CURRENT-DATE (1:8)                             03135015
031600                                   TO PV-CURR-DATE-CCYYMMDD.      03136015
031700                                                                  03137015
031800     MOVE PV-CURR-DATE-MM          TO DP200-RUN-MONTH.            03138015
031900     MOVE PV-CURR-DATE-DD          TO DP200-RUN-DAY.              03139015
032000     MOVE PV-CURR-DATE-CCYY        TO DP200-RUN-YEAR.             03139115
032100                                                                  03139215
032200     MOVE PC-CURRENT-PROGRAM-NAME  TO DP200-PROGRAM-NAME.         03139315
032300                                                                  03139415
032400     PERFORM 8700-REPORT-HEADER-ROUTINE.                          03139515
032500                                                                  03139615
029300     PERFORM 7000-READ-SOR-PRCHG-EXTRACT                          03140001
029600                                                                  03150001
029700     IF PS-END-OF-SOR-PRCHG                                       03160001
              INITIALIZE DLS-DETAIL-LINE-1                              03161013
              MOVE ZEROES             TO PE104-PRCHG-ID                 03170013
                                         PE104-STR-GP-TYP-CDE           03181013
                                         PE104-STR-GP-ID                03182013
              MOVE 'SOR'              TO DLS-SOURCE                     03190013
              MOVE PC-EMPTY-SOR-PRCHG TO DLS-ERROR-MESSAGE              03200013
              MOVE DLS-DETAIL-LINE-1  TO PV-PRINT-RECORD                03210013
NEMDEL**** NOTE: THIS SITUATION WILL NOT TRIGGER RC 4 FOR MSG           03210116
NEMDEL******* ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                     03210216
              PERFORM 8900-WRITE-REPORT-LINE                            03212012
030200     END-IF.                                                      03220001
030300                                                                  03230001
030500     PERFORM 7100-READ-XS-PRCHG-EXTRACT.                          03240001
031000                                                                  03250001
032600******************************************************************03410001
032700*2000-PROCESS-RECORDS.                                            03420001
032800* THIS SECTION COMPARES RECORDS ON THE SOR STR GP PRCHG FILE &    03430003
032900* XS DOMAIN EXTRACT FILE. IF KEYS MATCH, PROGRAM LOOKS AT DETAIL  03440003
032900* FIELDS AND CHECKS THAT THEY MATCH, DIFFERENCES ARE REPORTED.    03450003
033000* IF KEY (PRCHG ID+ STR GP ID & TYP) DOES NOT APPEAR ON ONE FILE, 03460003
033010* BUT IS ON THE OTHER FILE THEN AN APPROPRIATE MESSAGE WILL BE    03470001
033100* WRITTEN TO THE ERROR FILE, ALONG WITH THE DATA THAT WAS ON      03480001
033200* THE CORRESPONDING FILES.                                        03490001
033300******************************************************************03500001
033400 2000-PROCESS-RECORDS.                                            03510001
033500                                                                  03520001
033600     INITIALIZE DLS-DETAIL-LINE-1                                 03540009
                      DLX-DETAIL-LINE-1                                 03550009
033800                                                                  03560001
NEMTST*    DISPLAY '>>> 2000-PROCESS KEYS ARE PRCHG SOR*'               03570011
NEMTST*            PE104-PRCHG-ID,                                      03580011
NEMTST*               '== AND XS*'                                      03590011
NEMTST*            XS070-PRCHG-ID, '**'                                 03600011
NEMTST*    DISPLAY '>>>               STORE GRP TYP SOR*'               03601011
NEMTST*            PE104-STR-GP-TYP-CDE,                                03602011
NEMTST*               '== AND XS*'                                      03603011
NEMTST*            XS070-STR-GP-TYP-CDE, '**'                           03604011
NEMTST*    DISPLAY '>>>               STORE GRP ID  SOR*'               03605011
NEMTST*            PE104-STR-GP-ID,                                     03606011
NEMTST*               '== AND XS*'                                      03607011
NEMTST*            XS070-STR-GP-ID, '**'                                03608011
033900     EVALUATE TRUE                                                03610001
034000        WHEN PE104-PRCHG-ID = XS070-PRCHG-ID                      03620003
               AND PE104-STR-GP-TYP-CDE  = XS070-STR-GP-TYP-CDE         03620105
                 AND PE104-STR-GP-ID = XS070-STR-GP-ID                  03620203
                   ADD +1 TO PV-SOR-XS-COMMON-CNT                       03630001
034100             PERFORM 2100-COMPARE-FIELDS                          03640001
034200             PERFORM 7000-READ-SOR-PRCHG-EXTRACT                  03650001
034700             PERFORM 7100-READ-XS-PRCHG-EXTRACT                   03660001
NEMTST*    DISPLAY '>>>------- MATCHED KEY ---------<<<<'               03660111
034000        WHEN PE104-PRCHG-ID = XS070-PRCHG-ID                      03660205
               AND (PE104-STR-GP-TYP-CDE  = XS070-STR-GP-TYP-CDE        03660305
                 AND PE104-STR-GP-ID NOT = XS070-STR-GP-ID)             03660405
                IF PE104-STR-GP-ID < XS070-STR-GP-ID                    03660505
035400             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  03660705
035500             PERFORM 2600-MOVE-ALL-VALUES                         03660809
035600             MOVE PC-MISSING-FROM-XS-PRCHG                        03661008
035700               TO DLS-ERROR-MESSAGE                               03661109
035800             MOVE DLS-DETAIL-LINE-1 TO PV-PRINT-RECORD            03661209
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                03661305
                   ADD +1 TO PV-SOR-PRCHG-RECS-UNIQUE                   03661405
036000             PERFORM 8900-WRITE-REPORT-LINE                       03662003
036100             PERFORM 7000-READ-SOR-PRCHG-EXTRACT                  03663003
NEMTST*    DISPLAY '>>>------- STORE GP LOW --------<<<<'               03664011
035200          ELSE                                                    03670003
036300             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  03670103
035500             PERFORM 2600-MOVE-ALL-VALUES                         03670209
036500             MOVE PC-MISSING-FROM-SOR-PRCHG                       03670408
036600               TO DLX-ERROR-MESSAGE                               03670510
036700             MOVE DLX-DETAIL-LINE-1 TO PV-PRINT-RECORD            03670610
036800             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                03670703
                   ADD +1 TO PV-XS-EXTRACT-REC-UNIQUE                   03670803
036900             PERFORM 8900-WRITE-REPORT-LINE                       03670903
037000             PERFORM 7100-READ-XS-PRCHG-EXTRACT                   03671003
NEMTST*    DISPLAY '>>>------- STORE GP HIGH -------<<<<'               03672011
035200          END-IF                                                  03673003
034000        WHEN PE104-PRCHG-ID = XS070-PRCHG-ID                      03674005
               AND (PE104-STR-GP-TYP-CDE NOT = XS070-STR-GP-TYP-CDE)    03677005
                IF PE104-STR-GP-TYP-CDE < XS070-STR-GP-TYP-CDE          03677105
035400             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  03678005
035500             PERFORM 2600-MOVE-ALL-VALUES                         03679009
035600             MOVE PC-MISSING-FROM-XS-PRCHG                        03679108
035700               TO DLS-ERROR-MESSAGE                               03679209
035800             MOVE DLS-DETAIL-LINE-1 TO PV-PRINT-RECORD            03679309
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                03679405
                   ADD +1 TO PV-SOR-PRCHG-RECS-UNIQUE                   03679505
036000             PERFORM 8900-WRITE-REPORT-LINE                       03679605
036100             PERFORM 7000-READ-SOR-PRCHG-EXTRACT                  03679705
NEMTST*    DISPLAY '>>>------- STORE TYPE LOW ------<<<<'               03679811
035200          ELSE                                                    03679905
036300             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  03680005
036400             PERFORM 2600-MOVE-ALL-VALUES                         03680109
036500             MOVE PC-MISSING-FROM-SOR-PRCHG                       03680208
036600               TO DLX-ERROR-MESSAGE                               03680309
036700             MOVE DLX-DETAIL-LINE-1 TO PV-PRINT-RECORD            03680409
036800             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                03680505
                   ADD +1 TO PV-XS-EXTRACT-REC-UNIQUE                   03680605
036900             PERFORM 8900-WRITE-REPORT-LINE                       03680705
037000             PERFORM 7100-READ-XS-PRCHG-EXTRACT                   03680805
NEMTST*    DISPLAY '>>>------- STORE TYPE HIGH -----<<<<'               03680911
                END-IF                                                  03681005
035300        WHEN PE104-PRCHG-ID < XS070-PRCHG-ID                      03682003
NEMTST***     DISPLAY '=== SOR LOWER *'                                 03690001
NEMTST***          PE104-PRCHG-ID, '-', PE104-PRCHG-ID                  03700003
NEMTST***             '== AND XS*'                                      03710001
NEMTST***          XS070-PRCHG-ID, '-', XS070-PRCHG, '**'               03720003
035400             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  03730001
035500             PERFORM 2600-MOVE-ALL-VALUES                         03740009
035600             MOVE PC-MISSING-FROM-XS-PRCHG                        03750001
035700               TO DLS-ERROR-MESSAGE                               03760009
035800             MOVE DLS-DETAIL-LINE-1 TO PV-PRINT-RECORD            03770009
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                03780001
                   ADD +1 TO PV-SOR-PRCHG-RECS-UNIQUE                   03790001
036000             PERFORM 8900-WRITE-REPORT-LINE                       03800001
036100             PERFORM 7000-READ-SOR-PRCHG-EXTRACT                  03810001
NEMTST*    DISPLAY '>>>------- PRCHG ID LO ---------<<<<'               03811011
036200        WHEN PE104-PRCHG-ID > XS070-PRCHG-ID                      03820003
036300             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  03830001
036400             PERFORM 2600-MOVE-ALL-VALUES                         03840009
036500             MOVE PC-MISSING-FROM-SOR-PRCHG                       03850001
036600               TO DLX-ERROR-MESSAGE                               03860009
036700             MOVE DLX-DETAIL-LINE-1 TO PV-PRINT-RECORD            03870009
036800             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                03880001
                   ADD +1 TO PV-XS-EXTRACT-REC-UNIQUE                   03890001
036900             PERFORM 8900-WRITE-REPORT-LINE                       03900001
037000             PERFORM 7100-READ-XS-PRCHG-EXTRACT                   03910001
NEMTST*    DISPLAY '>>>------- PRCHG ID HIGH -------<<<<'               03911011
037100     END-EVALUATE.                                                03920001
037200                                                                  03930001
037300******************************************************************03940001
037400*2100-COMPARE-FIELDS.                                             03950001
037500* COMPARES FIELDS BETWEEN FILES TO SEE IF ANY DIFFERENCES EXIST   03960001
037600******************************************************************03970001
037700 2100-COMPARE-FIELDS.                                             03980001
037800                                                                  03990001
037900     SET PS-NO-ERROR-FOUND               TO TRUE.                 04000003
038200                                                                  04030001
014300     MOVE PE104-PRCHG-EFF-CC TO PV-WORK-DATE-CC.                  04050003
014300     MOVE PE104-PRCHG-EFF-YY TO PV-WORK-DATE-YY.                  04060003
014400     MOVE PE104-PRCHG-EFF-MM TO PV-WORK-DATE-MM.                  04070003
014500     MOVE PE104-PRCHG-EFF-DD TO PV-WORK-DATE-DD.                  04081003
038800     IF  PV-WORK-DATE-CCYYMMDD  NOT EQUAL XS070-PRCHG-EFF-DTE     04090003
038900         SET PS-ERROR-FOUND  TO TRUE                              04140003
021100         MOVE 'EFFECTIVE DATE' TO  DLS-ERR-EFF-DT                 04150003
039100     END-IF.                                                      04170001
039200                                                                  04180001
038800     IF  PE104-OH-AUTO-CNT-IND NOT EQUAL XS070-OH-AUTO-CNT-IND    04190003
038900         SET PS-ERROR-FOUND  TO TRUE                              04200001
021100         MOVE 'OH AUTO CNT IND' TO  DLS-ERR-OH                    04210003
039100     END-IF.                                                      04220001
039200                                                                  04230001
039200* 07/26/2010 - COMMENTED OUT AS PART OF MDO SPRING 2010 PROJECT   04240023
038800*    IF  PE104-SOR-LAST-UPD-TMST                                  04550019
      *                       NOT EQUAL XS070-SOR-LAST-UPD-TMST         04560019
038900*         SET PS-ERROR-FOUND  TO TRUE                             04570019
021100*         MOVE 'SOR UPD TIMESTAMP' TO  DLS-ERR-SOR-UPD-TMST       04580019
039100*    END-IF.                                                      04590019
039200                                                                  04600001
039300     IF  PS-ERROR-FOUND                                           04610001
039400         PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                      04620001
039500         PERFORM 2600-MOVE-ALL-VALUES                             04630001
039800         MOVE DLS-DETAIL-LINE-1     TO PV-PRINT-RECORD            04650009
040000         PERFORM 8900-WRITE-REPORT-LINE                           04660001
039800         MOVE DLX-DETAIL-LINE-1    TO PV-PRINT-RECORD             04670009
039900         ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                    04680001
040000         PERFORM 8900-WRITE-REPORT-LINE                           04690001
NEMTST*    DISPLAY '>>>*** DIFFERENCES FOUND---'                        04691011
040100     ELSE                                                         04700001
NEMTST***  DISPLAY '>>>*** RECORDS MATCHED SOR*'                        04701007
NEMTST***          PE104-RECORD                                         04702007
NEMTST***  DISPLAY '>>>***                  XS*'                        04703007
NEMTST***          XS070-STR-GP-PRCHG-UNLOAD                            04704007
040200         ADD +1 TO PV-VALID-MATCH-CNT                             04710001
040300     END-IF.                                                      04720001
040400                                                                  04730001
040700******************************************************************04740001
040800**  PROCESSES THRU END OF FILE FOR REMAINING RECORDS              04750001
040900******************************************************************04760001
041000 2200-PROCESS-EXTRA-RECORDS.                                      04770001
041100                                                                  04780001
033600     INITIALIZE DLS-DETAIL-LINE-1                                 04791009
                      DLX-DETAIL-LINE-1                                 04792009
041400                                                                  04800001
041500     IF  PS-NOT-END-OF-SOR-PRCHG                                  04810001
NEMTST*    DISPLAY '>>>*** EXTRA RECORDS SOR*'                          04811011
NEMTST*            PE104-RECORD                                         04812011
041700         PERFORM 2600-MOVE-ALL-VALUES                             04830009
041800         MOVE PC-EXTRA-FOUND-SOR-PRCHG                            04840009
041900           TO DLS-ERROR-MESSAGE                                   04850009
042000         MOVE DLS-DETAIL-LINE-1   TO PV-PRINT-RECORD              04860009
042010         ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                    04870009
               ADD +1 TO PV-SOR-PRCHG-RECS-UNIQUE                       04871018
042100         PERFORM 8900-WRITE-REPORT-LINE                           04880009
042300         PERFORM 7000-READ-SOR-PRCHG-EXTRACT                      04900001
042400     END-IF.                                                      04910001
042500                                                                  04920001
042600     IF  PS-NOT-END-OF-XS-PRCHG                                   04930001
NEMTST*    DISPLAY '>>>*** EXTRA RECORDS  XS*'                          04931011
NEMTST*                XS070-STR-GP-PRCHG-UNLOAD                        04932011
042800         PERFORM 2600-MOVE-ALL-VALUES                             04950009
042900         MOVE PC-EXTRA-FOUND-XS-PRCHG                             04960009
043000           TO DLX-ERROR-MESSAGE                                   04970009
043100         MOVE DLX-DETAIL-LINE-1   TO PV-PRINT-RECORD              04980009
043110         ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                    04990009
               ADD +1 TO PV-XS-EXTRACT-REC-UNIQUE                       04991018
043200         PERFORM 8900-WRITE-REPORT-LINE                           05000009
043400         PERFORM 7100-READ-XS-PRCHG-EXTRACT                       05020001
043500     END-IF.                                                      05030001
043600                                                                  05040001
043700******************************************************************05050001
043800* 2300-CHECK-IF-NEW-PG-NEEDED.                                    05060001
043900*     CHECKS TO SEE IF A NEW PAGE IS NEEDED.                      05070001
044000***************************************************************** 05080001
044100 2300-CHECK-IF-NEW-PG-NEEDED.                                     05090001
044200                                                                  05100001
044300     IF PV-LINE-CNT > PC-MAX-REPORT-LINES                         05110001
044400        PERFORM 8700-REPORT-HEADER-ROUTINE                        05120001
044500     END-IF.                                                      05130001
044600                                                                  05140001
045800******************************************************************05390001
045900* 2600-MOVE-ALL-VALUES.                                           05400001
046000*     MOVES THE XS AND SOR VALUES TO THE TWO DETAIL LINES.        05410001
046100***************************************************************** 05420001
046200 2600-MOVE-ALL-VALUES.                                            05430001
046300                                                                  05440001
045300     MOVE PE104-PRCHG-ID        TO PV-TEMP-PRCHG-ID               05450003
045400     MOVE PV-TEMP-PRCHG-ID      TO DLS-SOR-PRCHG-ID.              05460001
045700                                                                  05470001
046400     MOVE XS070-PRCHG-ID        TO PV-TEMP-PRCHG-ID.              05480003
046500     MOVE PV-TEMP-PRCHG-ID      TO DLX-XS-PRCHG-ID.               05490001
           MOVE XS070-STR-GP-TYP-CDE  TO DLX-GP-TYP                     05491003
           MOVE PE104-STR-GP-TYP-CDE  TO DLS-GP-TYP                     05492003
           MOVE XS070-STR-GP-ID       TO DLX-GP-ID                      05494003
           MOVE PE104-STR-GP-ID       TO DLS-GP-ID                      05495003
046800                                                                  05500001
045400     MOVE 'SOR'                 TO DLS-SOURCE.                    05510001
045400     MOVE 'XS '                 TO DLX-SOURCE.                    05520001
                                                                        05530001
045500     MOVE XS070-PRCHG-EFF-DTE   TO DLX-XS-EFF-DTE.                05540003
045500     MOVE PE104-PRCHG-EFF-DTE   TO DLS-SOR-EFF-DTE.               05550003
045700                                                                  05560001
045500     MOVE XS070-OH-AUTO-CNT-IND TO DLX-XS-OH-CNT-IND.             05570003
045500     MOVE PE104-OH-AUTO-CNT-IND TO DLS-SOR-OH-CNT-IND.            05580003
045700                                                                  05590001
045500     MOVE XS070-SOR-LAST-UPD-TMST TO DLX-XS-SOR-UPD.              05750003
045500     MOVE PE104-SOR-LAST-UPD-TMST TO DLS-SOR-SOR-UPD.             05760003
045700                                                                  05770001
048500***************************************************************** 05880001
048600*7000-READ-SOR-PRCHG-EXTRACT.                                     05890001
048700*  READ SOR PRCHG    EXTRACT FILE                                 05900001
049100***************************************************************** 05910001
049200 7000-READ-SOR-PRCHG-EXTRACT.                                     05920001
049300                                                                  05930001
049400     IF  PS-NOT-END-OF-SOR-PRCHG                                  05940001
049500         READ SOR-PRCHG-EXTRACT-FILE                              05950001
049550            INTO PE104-RECORD                                     05960003
049600              AT END                                              05970001
NEMTST*       DISPLAY '=== END OF SOR READ *'                           05971011
049700                 SET PS-END-OF-SOR-PRCHG TO TRUE                  05980001
049800         END-READ                                                 05990001
049900     END-IF.                                                      06000001
050000                                                                  06010001
050100     IF  PS-NOT-END-OF-SOR-PRCHG                                  06020001
NEMTST*       DISPLAY '=== SYSTEM OF RECORD READ *'                     06030011
NEMTST*            PE104-PRCHG-ID, '**'                                 06040011
052200         ADD +1 TO PV-SOR-PRCHG-RECS-READ-CNT                     06050001
052500     END-IF.                                                      06060001
052600                                                                  06070001
052700***************************************************************** 06080001
052800*7100-READ-XS-PRCHG-EXTRACT.                                      06090001
052900* READ XS EXTRACT FILE                                            06100001
053000***************************************************************** 06110001
053100 7100-READ-XS-PRCHG-EXTRACT.                                      06120001
053200                                                                  06130001
053300     IF  PS-NOT-END-OF-XS-PRCHG                                   06140001
053400         READ XS-PRCHG-EXTRACT-FILE                               06150001
053450           INTO XS070-STR-GP-PRCHG-UNLOAD                         06160003
053500             AT END                                               06170001
NEMTST*       DISPLAY '=== END OF XS READ *'                            06171011
053600                SET PS-END-OF-XS-PRCHG TO TRUE                    06180001
053700         END-READ                                                 06190001
053800     END-IF.                                                      06200001
053900                                                                  06210001
054000     IF  PS-NOT-END-OF-XS-PRCHG                                   06220001
NEMTST*       DISPLAY '=== XS READ *'                                   06230011
NEMTST*            XS070-PRCHG-ID, '**'                                 06240011
054100         ADD +1                   TO PV-XS-EXTRACT-REC-READ-CNT   06250001
054200     END-IF.                                                      06260001
054300                                                                  06270001
054400******************************************************************06280001
054500* 8700-REPORT-HEADER-ROUTINE.                                     06290001
054600*     PRINT THE HEADINGS FOR THE REPORT.                          06300001
054700******************************************************************06310001
054800 8700-REPORT-HEADER-ROUTINE.                                      06320001
054900                                                                  06330001
055000     MOVE ZEROS                  TO PV-LINE-CNT.                  06340001
055100     ADD +1                      TO PV-PAGE-CNT.                  06350001
055200     MOVE PV-PAGE-CNT            TO DP200-PAGE-NUMBER.            06360001
055300                                                                  06370001
055400     MOVE PC-REPORT-NBR-1        TO DP200-REPORT-NUMBER.          06380001
055500     MOVE DP200-STANDRD-HEADER-200-COLS                           06390001
055600                                 TO PV-PRINT-RECORD.              06400001
055700                                                                  06410001
055800     PERFORM 8800-WRITE-RPT-TOP-OF-PAGE.                          06420001
055900                                                                  06430001
056000     MOVE HL2-HEADING-LINE-2     TO PV-PRINT-RECORD.              06440001
056100     MOVE +2                     TO PV-LINE-SPACING.              06450001
056200     PERFORM 8900-WRITE-REPORT-LINE.                              06460001
056300                                                                  06470001
056400     MOVE HL3-HEADING-LINE-3     TO PV-PRINT-RECORD.              06480001
056500     MOVE +3                     TO PV-LINE-SPACING.              06490001
056600     PERFORM 8900-WRITE-REPORT-LINE.                              06500001
056700                                                                  06510001
056400     MOVE HL4-HEADING-LINE-4     TO PV-PRINT-RECORD.              06520001
056500     MOVE +1                     TO PV-LINE-SPACING.              06530001
056600     PERFORM 8900-WRITE-REPORT-LINE.                              06540001
056700                                                                  06550001
056800******************************************************************06560001
056900* 8800-WRITE-RPT-TOP-OF-PAGE                                      06570001
057000*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   06580001
057100******************************************************************06590001
057200 8800-WRITE-RPT-TOP-OF-PAGE.                                      06600001
057300                                                                  06610001
057400     WRITE XS-PRCHG-INTEG-RPT-RECORD                              06620001
057500       FROM PV-PRINT-RECORD                                       06630001
057600         AFTER ADVANCING PAGE.                                    06640001
057700                                                                  06650001
057800     MOVE +1 TO PV-LINE-CNT.                                      06660001
057900                                                                  06670001
058000******************************************************************06680001
058100* 8900-WRITE-REPORT-LINE                                          06690001
058200*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             06700001
058300******************************************************************06710001
058400 8900-WRITE-REPORT-LINE.                                          06720001
058500                                                                  06730001
058600     WRITE XS-PRCHG-INTEG-RPT-RECORD                              06740001
058700       FROM PV-PRINT-RECORD                                       06750001
058800         AFTER ADVANCING PV-LINE-SPACING.                         06760001
058900                                                                  06770001
059000     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          06780001
059100                                                                  06790001
059200****************************************************************  06800001
059300*END OF PROGRAM ROUTINE                                           06810001
059400****************************************************************  06820001
059500 9000-END-OF-PGM.                                                 06830001
059600                                                                  06840001
060800     DISPLAY '******** XSKRP039 COUNTS *********'.                06850001
060850     DISPLAY ' INTEGRITY CHECK - FOR XST_STR_GP_PRCHG '.          06860003
060900     DISPLAY '   SOR REC READ CNT= '                              06870001
060950                     PV-SOR-PRCHG-RECS-READ-CNT.                  06880001
061000     DISPLAY 'XS PRCHG READ COUNT= ' PV-XS-EXTRACT-REC-READ-CNT.  06890001
061300     DISPLAY '  =============================== '                 06900001
           DISPLAY 'UNIQUE TO SOR ONLY  - ', PV-SOR-PRCHG-RECS-UNIQUE   06910001
           DISPLAY 'UNIQUE TO XS  ONLY  - ', PV-XS-EXTRACT-REC-UNIQUE   06920001
           DISPLAY 'COMMON TO BOTH FILES- ',  PV-SOR-XS-COMMON-CNT      06930001
           COMPUTE PV-SOR-XS-TOTAL-CNT =  PV-SOR-XS-COMMON-CNT          06940001
            + PV-SOR-PRCHG-RECS-UNIQUE  + PV-XS-EXTRACT-REC-UNIQUE      06950001
           DISPLAY 'TOTAL COMMON + UNIQUE=', PV-SOR-XS-TOTAL-CNT        06960001
061300     DISPLAY '  =============================== '                 06970001
061100     DISPLAY ' ERROR MSGS WRITTEN= ' PV-ERROR-RECORD-WRITTEN-CNT. 06980001
061200     DISPLAY '  VALID MATCH COUNT= ' PV-VALID-MATCH-CNT.          06990001
061300     DISPLAY '                              '.                    07000001
061700     DISPLAY '**********************************'.                07010001
061800                                                                  07020001
061900     IF  PV-ERROR-RECORD-WRITTEN-CNT > 0                          07030001
062000         MOVE 04               TO RETURN-CODE                     07040001
062100     END-IF.                                                      07050001
062200                                                                  07060001
062300     CLOSE SOR-PRCHG-EXTRACT-FILE                                 07070001
062400           XS-PRCHG-EXTRACT-FILE                                  07080001
062500           XS-PRCHG-INTEG-RPT-FILE.                               07090001
062600                                                                  07100001
062700******************************************************************07110001
062800*     9999-ABEND                                                 *07120001
062900* ==> PROCESSES:                                                 *07130001
063000*     -PERFORMS ABEND PROCESSING FOR NON-SQL-ERRORS.             *07140001
063100******************************************************************07150001
063200 9999-ABEND.                                                      07160001
063300                                                                  07170001
063400     DISPLAY '9999-ABEND'.                                        07180001
063500     DISPLAY '**  ABEND     **', PC-CURRENT-PROGRAM-NAME.         07190001
063600     DISPLAY '**  PARAGRAPH ** ' PV-PARAGRAPH-NAME.               07200001
063700     DISPLAY '**  OPERATION ** ' PV-OPERATION-MSG-1.              07210001
063800     DISPLAY '**            ** ' PV-OPERATION-MSG-2.              07220001
063900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07230001
