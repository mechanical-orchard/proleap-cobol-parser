000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.         SVKRP020.                                    00020000
000300 AUTHOR.             SUSAN COONEY.                                00030000
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
000500 DATE-WRITTEN.       MARCH 1998.                                  00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800******************************************************************00080000
000900*  MODULE TYPE: COBOL2 DB2 BATCH                                 *00090000
001000*                                                                *00100000
001100* THIS PROGRAM PRINTS THE GIFT CARD/KMRC SUMMARY REPORT.  A      *00110000
001200* SEPERATE REPORT FOR EACH CARD STOCK IS GENERATED.  ALL STORES  *00120000
001300* ARE PRINTED ON EACH REPORT EVEN IF THEY DIDN'T HAVE ACTIVITY.  *00130000
001400******************************************************************00140000
001400******************************************************************00150006
003620* 10/08/12  INCIDENT 2376618                                     *00160006
003630*           CRQ: 34587                                            00170006
003640*           Coded for the Incomm Store (676) to not count         00180006
      *           deactivations (Rev Code: 0 Auth Amt: negative).  This 00190006
      *           was counting them as add ons.                         00200006
      *           Incomm currently is the only one that does deacts.    00210006
      *  transaction   rev cde    void ind    auth amt                  00220006
      *  ACTIVATION      0           N          POSITIVE                00230006
      *  DEACTIVATION    0           Y          NEGATIVE                00240006
      *  REVERSAL        1           Y          NEGATIVE                00250006
      *  DEACT/REVER     1           Y          POSITIVE                00260006
001400******************************************************************00270006
001500 ENVIRONMENT DIVISION.                                            00280000
001600 CONFIGURATION SECTION.                                           00290000
001700                                                                  00300000
001800 SOURCE-COMPUTER.    IBM-3090.                                    00310000
001900 OBJECT-COMPUTER.    IBM-3090.                                    00320000
002000                                                                  00330000
002100 INPUT-OUTPUT SECTION.                                            00340000
002200                                                                  00350000
002300 FILE-CONTROL.                                                    00360000
002400                                                                  00370000
002500     SELECT CONTROL-CARD-FILE         ASSIGN TO INP01.            00380000
002600     SELECT KMRC-FILE                 ASSIGN TO INP02.            00390000
002700     SELECT GIFT-FILE                 ASSIGN TO INP03.            00400000
002800     SELECT PURCH-FILE                ASSIGN TO OUT01.            00410000
002900     SELECT KMRC-REPORT               ASSIGN TO RPT01.            00420000
003000     SELECT GIFT-REPORT               ASSIGN TO RPT02.            00430000
003100     SELECT NET-GIFT-REPORT           ASSIGN TO RPT03.            00440000
003200                                                                  00450000
003300 DATA DIVISION.                                                   00460000
003400                                                                  00470000
003500 FILE SECTION.                                                    00480000
003600                                                                  00490000
003700 FD  CONTROL-CARD-FILE                                            00500000
003800     RECORDING MODE IS F                                          00510000
003900     BLOCK CONTAINS 0 RECORDS                                     00520000
004000     LABEL RECORDS ARE OMITTED.                                   00530000
004100 01  CARD-FILE-RECORD                 PIC X(80).                  00540000
004200                                                                  00550000
004300 FD  KMRC-FILE                                                    00560000
004400     RECORDING MODE IS F                                          00570000
004500     BLOCK CONTAINS 0 RECORDS                                     00580000
004600     LABEL RECORDS ARE OMITTED.                                   00590000
004700 01  KMRC-FILE-RECORD                 PIC X(53).                  00600000
004800                                                                  00610000
004900 FD  GIFT-FILE                                                    00620000
005000     RECORDING MODE IS F                                          00630000
005100     BLOCK CONTAINS 0 RECORDS                                     00640000
005200     LABEL RECORDS ARE OMITTED.                                   00650000
005300 01  GIFT-FILE-RECORD                 PIC X(53).                  00660000
005400                                                                  00670000
005500 FD  PURCH-FILE                                                   00680000
005600     RECORDING MODE IS F                                          00690000
005700     BLOCK CONTAINS 0 RECORDS                                     00700000
005800     LABEL RECORDS ARE OMITTED.                                   00710000
005900 01  PURCH-FILE-RECORD                PIC X(23).                  00720000
006000                                                                  00730000
006100 FD  KMRC-REPORT                                                  00740000
006200     RECORDING MODE IS F                                          00750000
006300     BLOCK CONTAINS 0 RECORDS                                     00760000
006400     LABEL RECORDS ARE OMITTED.                                   00770000
006500 01  KMRC-REPORT-RECORD               PIC X(250).                 00780000
006600                                                                  00790000
006700 FD  GIFT-REPORT                                                  00800000
006800     RECORDING MODE IS F                                          00810000
006900     BLOCK CONTAINS 0 RECORDS                                     00820000
007000     LABEL RECORDS ARE OMITTED.                                   00830000
007100 01  GIFT-REPORT-RECORD               PIC X(250).                 00840000
007200                                                                  00850000
007300 FD  NET-GIFT-REPORT                                              00860000
007400     RECORDING MODE IS F                                          00870000
007500     BLOCK CONTAINS 0 RECORDS                                     00880000
007600     LABEL RECORDS ARE OMITTED.                                   00890000
007700 01  NET-GIFT-REPORT-RECORD           PIC X(132).                 00900000
007800                                                                  00910000
007900 WORKING-STORAGE SECTION.                                         00920000
008000                                                                  00930000
008100 01  ABEND-CODE                       PIC S9(04)    VALUE +0 COMP.00940000
008200                                                                  00950000
008300******************************************************************00960000
008400*    PC-PROGRAM CONSTANTS                                        *00970000
008500******************************************************************00980000
008600 01  PC-PROGRAM-CONSTANTS.                                        00990000
008700     05  PC-PROGRAM-NAME              PIC  X(08)     VALUE        01000000
008800                                                    'SVKRP020'.   01010000
008900     05  PC-KMRC-REPORT               PIC  X         VALUE 'R'.   01020000
009000     05  PC-GIFT-REPORT               PIC  X         VALUE 'G'.   01030000
009100     05  PC-BOTH-REPORT               PIC  X         VALUE 'B'.   01040000
009200     05  PC-MAX-LINE-PER-PAGE         PIC  S9(2)     VALUE +74    01050000
009300                                                     COMP.        01060000
009400     05  PC-MAX-LINE-BEFORE-TOT       PIC  S9(2)     VALUE +67    01070000
009500                                                     COMP.        01080000
009600     05  PC-HEADER-LINE-COUNT         PIC  S9(2)     VALUE +8     01090000
009700                                                     COMP.        01100000
009800     05  PC-DETAIL-LINE-COUNT         PIC  S9(2)     VALUE +1     01110000
009900                                                     COMP.        01120000
010000     05  PC-ONE                       PIC  S9(2)     VALUE +1     01130000
010100                                                     COMP.        01140000
010200     05  PC-TWO                       PIC  S9(2)     VALUE +2     01150000
010300                                                     COMP.        01160000
010400     05  PC-THREE                     PIC  S9(2)     VALUE +3     01170000
010500                                                     COMP.        01180000
010600     05  PC-ALL-CARD                  PIC  X(08)     VALUE        01190000
010700         'ALL CARD'.                                              01200000
010800     05  PC-MAX-NUM-OF-STORES         PIC  9(04)     VALUE 9999.  01210000
010900     05  PC-NEW-FRONT-REQUEST.                                    01220000
011000         10  FILLER                   PIC S9(4)      VALUE -1     01230000
011100                                                     COMP SYNC.   01240000
011200     05  PC-DEFAULT-SPACES            PIC  X(10)     VALUE SPACES.01250000
011300                                                                  01260000
011400******************************************************************01270000
011500*    PROGRAM VARIABLES                                           *01280000
011600******************************************************************01290000
011700 01  PV-PROGRAM-VARIABLES.                                        01300000
011800     05  PV-PARAGRAPH-NAME            PIC  X(30)  VALUE SPACES.   01310000
011900     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30)  VALUE SPACES.   01320000
012000     05  PV-NUM-OF-STORES             PIC  9(04)  VALUE ZEROES.   01330000
012100     05  PV-STORE-SUB                 PIC  9(04)  VALUE 0 COMP.   01340000
012200     05  PV-PREV-CRD-STK-TYP-ID       PIC  X(08)  VALUE SPACES.   01350000
012300     05  PV-CURR-CRD-STK-TYP-ID       PIC  X(08)  VALUE SPACES.   01360000
012400                                                                  01370000
012500     05  PV-PREV-CRD-STK-TYP-DESC     PIC X(25)   VALUE SPACES.   01380000
012600     05  PV-CURR-CRD-STK-TYP-DESC     PIC X(25)   VALUE SPACES.   01390000
012700                                                                  01400000
012800     05  PV-CURR-STR-NBR      PIC S9(4)     COMP  VALUE ZEROES.   01410000
012900                                                                  01420000
013000     05  PV-CT-ISS-TOT-NUM    PIC S9(09)     COMP-3 VALUE ZEROES. 01430000
013100     05  PV-CT-ISS-TOT-AMT    PIC S9(10)V99  COMP-3 VALUE ZEROES. 01440000
013200     05  PV-CT-ISS-ADD-NUM    PIC S9(09)     COMP-3 VALUE ZEROES. 01450000
013300     05  PV-CT-ISS-ADD-AMT    PIC S9(10)V99  COMP-3 VALUE ZEROES. 01460000
013400     05  PV-CT-ISS-VOID-NUM   PIC S9(09)     COMP-3 VALUE ZEROES. 01470000
013500     05  PV-CT-ISS-VOID-AMT   PIC S9(10)V99  COMP-3 VALUE ZEROES. 01480000
013600     05  PV-CT-ISS-NET-NUM    PIC S9(09)     COMP-3 VALUE ZEROES. 01490000
013700     05  PV-CT-ISS-NET-AMT    PIC S9(10)V99  COMP-3 VALUE ZEROES. 01500000
013800     05  PV-CT-TEND-TOT-NUM   PIC S9(09)     COMP-3 VALUE ZEROES. 01510000
013900     05  PV-CT-TEND-TOT-AMT   PIC S9(10)V99  COMP-3 VALUE ZEROES. 01520000
014000     05  PV-CT-TEND-VOID-NUM  PIC S9(09)     COMP-3 VALUE ZEROES. 01530000
014100     05  PV-CT-TEND-VOID-AMT  PIC S9(10)V99  COMP-3 VALUE ZEROES. 01540000
014200     05  PV-CT-TEND-NET-NUM   PIC S9(09)     COMP-3 VALUE ZEROES. 01550000
014300     05  PV-CT-TEND-NET-AMT   PIC S9(10)V99  COMP-3 VALUE ZEROES. 01560000
014400     05  PV-NET-VARIANCE-AMT  PIC S9(10)V99  COMP-3 VALUE ZEROES. 01570000
014500                                                                  01580000
014600     05  PV-CA-ISS-TOT-NUM    PIC S9(09)     COMP-3 VALUE ZEROES. 01590000
014700     05  PV-CA-ISS-TOT-AMT    PIC S9(10)V99  COMP-3 VALUE ZEROES. 01600000
014800     05  PV-CA-ISS-ADD-NUM    PIC S9(09)     COMP-3 VALUE ZEROES. 01610000
014900     05  PV-CA-ISS-ADD-AMT    PIC S9(10)V99  COMP-3 VALUE ZEROES. 01620000
015000     05  PV-CA-ISS-VOID-NUM   PIC S9(09)     COMP-3 VALUE ZEROES. 01630000
015100     05  PV-CA-ISS-VOID-AMT   PIC S9(10)V99  COMP-3 VALUE ZEROES. 01640000
015200     05  PV-CA-ISS-NET-NUM    PIC S9(09)     COMP-3 VALUE ZEROES. 01650000
015300     05  PV-CA-ISS-NET-AMT    PIC S9(10)V99  COMP-3 VALUE ZEROES. 01660000
015400     05  PV-CA-TEND-TOT-NUM   PIC S9(09)     COMP-3 VALUE ZEROES. 01670000
015500     05  PV-CA-TEND-TOT-AMT   PIC S9(10)V99  COMP-3 VALUE ZEROES. 01680000
015600     05  PV-CA-TEND-VOID-NUM  PIC S9(09)     COMP-3 VALUE ZEROES. 01690000
015700     05  PV-CA-TEND-VOID-AMT  PIC S9(10)V99  COMP-3 VALUE ZEROES. 01700000
015800     05  PV-CA-TEND-NET-NUM   PIC S9(09)     COMP-3 VALUE ZEROES. 01710000
015900     05  PV-CA-TEND-NET-AMT   PIC S9(10)V99  COMP-3 VALUE ZEROES. 01720000
016000     05  PV-CA-VARIANCE-AMT   PIC S9(10)V99  COMP-3 VALUE ZEROES. 01730000
016100                                                                  01740000
016200     05  PV-GCTA-ISS-TOT-NUM    PIC S9(09)    COMP-3 VALUE ZEROES.01750000
016300     05  PV-GCTA-ISS-TOT-AMT    PIC S9(10)V99 COMP-3 VALUE ZEROES.01760000
016400     05  PV-GCTA-ISS-ADD-NUM    PIC S9(09)    COMP-3 VALUE ZEROES.01770000
016500     05  PV-GCTA-ISS-ADD-AMT    PIC S9(10)V99 COMP-3 VALUE ZEROES.01780000
016600     05  PV-GCTA-ISS-VOID-NUM   PIC S9(09)    COMP-3 VALUE ZEROES.01790000
016700     05  PV-GCTA-ISS-VOID-AMT   PIC S9(10)V99 COMP-3 VALUE ZEROES.01800000
016800     05  PV-GCTA-ISS-NET-NUM    PIC S9(09)    COMP-3 VALUE ZEROES.01810000
016900     05  PV-GCTA-ISS-NET-AMT    PIC S9(10)V99 COMP-3 VALUE ZEROES.01820000
017000     05  PV-GCTA-TEND-TOT-NUM   PIC S9(09)    COMP-3 VALUE ZEROES.01830000
017100     05  PV-GCTA-TEND-TOT-AMT   PIC S9(10)V99 COMP-3 VALUE ZEROES.01840000
017200     05  PV-GCTA-TEND-VOID-NUM  PIC S9(09)    COMP-3 VALUE ZEROES.01850000
017300     05  PV-GCTA-TEND-VOID-AMT  PIC S9(10)V99 COMP-3 VALUE ZEROES.01860000
017400     05  PV-GCTA-TEND-NET-NUM   PIC S9(09)    COMP-3 VALUE ZEROES.01870000
017500     05  PV-GCTA-TEND-NET-AMT   PIC S9(10)V99 COMP-3 VALUE ZEROES.01880000
017600     05  PV-GCTA-VARIANCE-AMT   PIC S9(10)V99 COMP-3 VALUE ZEROES.01890000
017700                                                                  01900000
017800     05  PV-TRANS-TIMESTAMP.                                      01910000
017900         10  PV-TRANS-TMST-CC           PIC  X(02)  VALUE SPACES. 01920000
018000         10  PV-TRANS-TMST-YY           PIC  X(02)  VALUE SPACES. 01930000
018100         10  FILLER                     PIC  X(01)  VALUE '-'.    01940000
018200         10  PV-TRANS-TMST-MM           PIC  X(02)  VALUE SPACES. 01950000
018300         10  FILLER                     PIC  X(01)  VALUE '-'.    01960000
018400         10  PV-TRANS-TMST-DD           PIC  X(02)  VALUE SPACES. 01970000
018500         10  FILLER                     PIC  X(01)  VALUE '-'.    01980000
018600         10  PV-TRANS-TMST-HH           PIC  X(02)  VALUE SPACES. 01990000
018700         10  FILLER                     PIC  X(01)  VALUE '.'.    02000000
018800         10  PV-TRANS-TMST-MIN          PIC  X(02)  VALUE SPACES. 02010000
018900         10  FILLER                     PIC  X(01)  VALUE '.'.    02020000
019000         10  PV-TRANS-TMST-SS           PIC  X(02)  VALUE SPACES. 02030000
019100         10  FILLER                     PIC  X(06).               02040000
019200     05  PV-CURRENT-TIMESTAMP           PIC  X(26).               02050000
019300                                                                  02060000
019400******************************************************************02070000
019500*    PS-PROGRAM SWITCHES                                         *02080000
019600******************************************************************02090000
019700 01  PS-PROGRAM-SWITCHES.                                         02100000
019800     05  PS-END-OF-GIFT-FILE-SW       PIC  X(01)     VALUE 'N'.   02110000
019900         88  PS-END-OF-GIFT-FILE                     VALUE 'Y'.   02120000
020000     05  PS-END-OF-KMRC-FILE-SW       PIC  X(01)     VALUE 'N'.   02130000
020100         88  PS-END-OF-KMRC-FILE                     VALUE 'Y'.   02140000
020200     05  PS-END-OF-STORE-CSR-SW       PIC  X(01)     VALUE 'N'.   02150000
020300         88  PS-END-OF-STORE-CSR                     VALUE 'Y'.   02160000
020400     05  PS-FIRST-TIME-THRU-SW        PIC  X(01)     VALUE 'N'.   02170000
020500         88  PS-FIRST-TIME-THRU                      VALUE 'Y'.   02180000
020600         88  PS-NOT-FIRST-TIME-THRU                  VALUE 'N'.   02190000
020700                                                                  02200000
020800******************************************************************02210000
020900*    PA-PROGRAM ACCUMULATORS                                     *02220000
021000******************************************************************02230000
021100 01  PA-PROGRAM-ACCUMULATORS.                                     02240000
021200     05  PA-PAGE-COUNTER-KMRC         PIC S9(11)     COMP-3       02250000
021300                                                     VALUE ZEROES.02260000
021400     05  PA-PAGE-COUNTER-GIFT         PIC S9(11)     COMP-3       02270000
021500                                                     VALUE ZEROES.02280000
021600     05  PA-PAGE-COUNTER-NET-GIFT     PIC S9(11)     COMP-3       02290000
021700                                                     VALUE ZEROES.02300000
021800     05  PA-LINE-COUNTER-KMRC         PIC S9(11)     COMP-3       02310000
021900                                                     VALUE ZEROES.02320000
022000     05  PA-LINE-COUNTER-GIFT         PIC S9(11)     COMP-3       02330000
022100                                                     VALUE ZEROES.02340000
022200     05  PA-LINE-COUNTER-NET-GIFT     PIC S9(11)     COMP-3       02350000
022300                                                     VALUE ZEROES.02360000
022400     05  PA-PURCH-COUNTER             PIC S9(11)     COMP-3       02370000
022500                                                     VALUE ZEROES.02380000
022600                                                                  02390000
022700     05  PA-STORE-TABLE.                                          02400000
022800         10  PA-STORE-ENTRY              OCCURS 9999 TIMES.       02410000
022900             15  PA-STORE-NUM     PIC S9(04)     COMP.            02420000
023000             15  PA-STORE-NAME    PIC  X(10).                     02430000
023100             15  PA-E-BUS-IND     PIC  X(01).                     02440000
023200             15  PA-ISS-TOT-NUM   PIC S9(09)     COMP-3           02450000
023300                                                    VALUE ZEROES. 02460000
023400             15  PA-ISS-TOT-AMT   PIC S9(10)V99  COMP-3           02470000
023500                                                    VALUE ZEROES. 02480000
023600             15  PA-ISS-ADD-NUM   PIC S9(09)     COMP-3           02490000
023700                                                    VALUE ZEROES. 02500000
023800             15  PA-ISS-ADD-AMT   PIC S9(10)V99  COMP-3           02510000
023900                                                    VALUE ZEROES. 02520000
024000             15  PA-ISS-VOID-NUM  PIC S9(09)     COMP-3           02530000
024100                                                    VALUE ZEROES. 02540000
024200             15  PA-ISS-VOID-AMT  PIC S9(10)V99  COMP-3           02550000
024300                                                    VALUE ZEROES. 02560000
024400             15  PA-ISS-NET-NUM   PIC S9(09)     COMP-3           02570000
024500                                                    VALUE ZEROES. 02580000
024600             15  PA-ISS-NET-AMT   PIC S9(10)V99  COMP-3           02590000
024700                                                    VALUE ZEROES. 02600000
024800             15  PA-TEND-TOT-NUM  PIC S9(09)     COMP-3           02610000
024900                                                    VALUE ZEROES. 02620000
025000             15  PA-TEND-TOT-AMT  PIC S9(10)V99  COMP-3           02630000
025100                                                    VALUE ZEROES. 02640000
025200             15  PA-TEND-VOID-NUM PIC S9(09)     COMP-3           02650000
025300                                                    VALUE ZEROES. 02660000
025400             15  PA-TEND-VOID-AMT PIC S9(10)V99  COMP-3           02670000
025500                                                    VALUE ZEROES. 02680000
025600             15  PA-TEND-NET-NUM  PIC S9(09)     COMP-3           02690000
025700                                                    VALUE ZEROES. 02700000
025800             15  PA-TEND-NET-AMT  PIC S9(10)V99  COMP-3           02710000
025900                                                    VALUE ZEROES. 02720000
026000             15  PA-ISS-TOT-NUS   PIC S9(09)     COMP-3           02730000
026100                                                    VALUE ZEROES. 02740000
026200             15  PA-ISS-TOT-AMS   PIC S9(10)V99  COMP-3           02750000
026300                                                    VALUE ZEROES. 02760000
026400             15  PA-ISS-ADD-NUS   PIC S9(09)     COMP-3           02770000
026500                                                    VALUE ZEROES. 02780000
026600             15  PA-ISS-ADD-AMS   PIC S9(10)V99  COMP-3           02790000
026700                                                    VALUE ZEROES. 02800000
026800             15  PA-ISS-VOID-NUS  PIC S9(09)     COMP-3           02810000
026900                                                    VALUE ZEROES. 02820000
027000             15  PA-ISS-VOID-AMS  PIC S9(10)V99  COMP-3           02830000
027100                                                    VALUE ZEROES. 02840000
027200             15  PA-ISS-NET-NUS   PIC S9(09)     COMP-3           02850000
027300                                                    VALUE ZEROES. 02860000
027400             15  PA-ISS-NET-AMS   PIC S9(10)V99  COMP-3           02870000
027500                                                    VALUE ZEROES. 02880000
027600             15  PA-TEND-TOT-NUS  PIC S9(09)     COMP-3           02890000
027700                                                    VALUE ZEROES. 02900000
027800             15  PA-TEND-TOT-AMS  PIC S9(10)V99  COMP-3           02910000
027900                                                    VALUE ZEROES. 02920000
028000             15  PA-TEND-VOID-NUS PIC S9(09)     COMP-3           02930000
028100                                                    VALUE ZEROES. 02940000
028200             15  PA-TEND-VOID-AMS PIC S9(10)V99  COMP-3           02950000
028300                                                    VALUE ZEROES. 02960000
028400             15  PA-TEND-NET-NUS  PIC S9(09)     COMP-3           02970000
028500                                                    VALUE ZEROES. 02980000
028600             15  PA-TEND-NET-AMS  PIC S9(10)V99  COMP-3           02990000
028700                                                    VALUE ZEROES. 03000000
028800                                                                  03010000
028900******************************************************************03020000
029000*    INPUT RECORD                                                *03030000
029100******************************************************************03040000
029200 01  IR-CONTROL-CARD-RECORD.                                      03050000
029300     05  IR-CNTL-CRD-TYP              PIC X.                      03060000
029400     05  IR-CNTL-START-DATE           PIC X(10).                  03070000
029500     05  IR-CNTL-START-DATE-UNFMT REDEFINES IR-CNTL-START-DATE.   03080000
029600         10  IR-CNTL-CRD-BEG-CC           PIC XX.                 03090000
029700         10  IR-CNTL-CRD-BEG-YY           PIC XX.                 03100000
029800         10  FILLER                       PIC X.                  03110000
029900         10  IR-CNTL-CRD-BEG-MM           PIC XX.                 03120000
030000         10  FILLER                       PIC X.                  03130000
030100         10  IR-CNTL-CRD-BEG-DD           PIC XX.                 03140000
030200     05  IR-CNTL-END-DATE                 PIC X(10).              03150000
030300     05  IR-CNTL-END-DATE-UNFMT REDEFINES IR-CNTL-END-DATE.       03160000
030400         10  IR-CNTL-CRD-END-CC           PIC XX.                 03170000
030500         10  IR-CNTL-CRD-END-YY           PIC XX.                 03180000
030600         10  FILLER                       PIC X.                  03190000
030700         10  IR-CNTL-CRD-END-MM           PIC XX.                 03200000
030800         10  FILLER                       PIC X.                  03210000
030900         10  IR-CNTL-CRD-END-DD           PIC XX.                 03220000
031000     05  FILLER                       PIC X(59).                  03230000
031100******************************************************************03240000
031200*    INPUT ACTIVITY RECORD                                       *03250000
031300******************************************************************03260000
031400     COPY SVRD010.                                                03270000
031500                                                                  03280000
031600     COPY SVRD023.                                                03290000
031700                                                                  03300000
031800******************************************************************03310000
031900*    HEADERS                                                     *03320000
032000******************************************************************03330000
032100 01  REPORT-TITLE-LINE-KMRC.                                      03340000
032200     05  FILLER                         PIC  X(04)   VALUE SPACES.03350000
032300     05  FILLER                         PIC  X(16)   VALUE        03360000
032400         'CARD STOCK ID  :'.                                      03370000
032500     05  RTL-KMRC-CRD-STK-ID            PIC  X(08)   VALUE SPACES.03380000
032600     05  FILLER                         PIC  X(89)   VALUE SPACES.03390000
032700     05  FILLER                         PIC  X(19)   VALUE        03400000
032800         'KMRC SUMMARY REPORT'.                                   03410000
032900     05  FILLER                         PIC  X(114)  VALUE SPACES.03420000
033000                                                                  03430000
033100 01  REPORT-TITLE-LINE-GC.                                        03440000
033200     05  FILLER                         PIC  X(04)   VALUE SPACES.03450000
033300     05  FILLER                         PIC  X(16)   VALUE        03460000
033400         'CARD STOCK ID  :'.                                      03470000
033500     05  RTL-GC-CRD-STK-ID              PIC  X(08)   VALUE SPACES.03480000
033600     05  FILLER                         PIC  X(87)   VALUE SPACES.03490000
033700     05  FILLER                         PIC  X(24)   VALUE        03500000
033800         'GIFT CARD SUMMARY REPORT'.                              03510000
033900     05  FILLER                         PIC  X(111)  VALUE SPACES.03520000
034000                                                                  03530000
034100 01  REPORT-SUBTITLE-LINE.                                        03540000
034200     05  FILLER                         PIC  X(04)   VALUE SPACES.03550000
034300     05  FILLER                         PIC  X(16)   VALUE        03560000
034400         'CARD STOCK DESC:'.                                      03570000
034500     05  RSL-CRD-STK-ID-DESC            PIC  X(25)   VALUE SPACES.03580000
034600     05  FILLER                         PIC  X(68)   VALUE SPACES.03590000
034700     05  RSL-REPORT-DATE-RANGE.                                   03600000
034800         10  RSL-RANGE-BEG-DATE-MM      PIC  X(02)   VALUE SPACES.03610000
034900         10  FILLER                     PIC  X(01)   VALUE '/'.   03620000
035000         10  RSL-RANGE-BEG-DATE-DD      PIC  X(02)   VALUE SPACES.03630000
035100         10  FILLER                     PIC  X(01)   VALUE '/'.   03640000
035200         10  RSL-RANGE-BEG-DATE-CC      PIC  X(02)   VALUE SPACES.03650000
035300         10  RSL-RANGE-BEG-DATE-YY      PIC  X(02)   VALUE SPACES.03660000
035400         10  FILLER                     PIC  X(08)   VALUE        03670000
035500             '  THRU  '.                                          03680000
035600         10  RSL-RANGE-END-DATE-MM      PIC  X(02)   VALUE SPACES.03690000
035700         10  FILLER                     PIC  X(01)   VALUE '/'.   03700000
035800         10  RSL-RANGE-END-DATE-DD      PIC  X(02)   VALUE SPACES.03710000
035900         10  FILLER                     PIC  X(01)   VALUE '/'.   03720000
036000         10  RSL-RANGE-END-DATE-CC      PIC  X(02)   VALUE SPACES.03730000
036100         10  RSL-RANGE-END-DATE-YY      PIC  X(02)   VALUE SPACES.03740000
036200     05  FILLER                         PIC  X(109)  VALUE SPACES.03750000
036300                                                                  03760000
036400 01  NET-REPORT-SUBTITLE-LINE.                                    03770000
036500     05  FILLER                         PIC  X(52)   VALUE SPACES.03780000
036600     05  NET-REPORT-DATE-RANGE          PIC  X(28)   VALUE SPACES.03790000
036700     05  FILLER                         PIC  X(52)   VALUE SPACES.03800000
036800                                                                  03810000
036900 01  REPORT-DETAIL-HEADER-1.                                      03820000
037000     05  FILLER                         PIC  X(56)   VALUE SPACES.03830000
037100     05  FILLER                         PIC  X(23)   VALUE        03840000
037200         'I S S U E D   C A R D S'.                               03850000
037300     05  FILLER                         PIC  X(70)   VALUE SPACES.03860000
037400     05  FILLER                         PIC  X(27)   VALUE        03870000
037500         'T E N D E R E D   C A R D S'.                           03880000
037600     05  FILLER                         PIC  X(74)   VALUE SPACES.03890000
037700                                                                  03900000
037800 01  NET-REPORT-DETAIL-HEADER-1.                                  03910000
037900     05  FILLER                         PIC  X(56)   VALUE SPACES.03920000
038000     05  FILLER                         PIC  X(20)   VALUE        03930000
038100         'GIFT CARD NET REPORT'.                                  03940000
038200     05  FILLER                         PIC  X(56)   VALUE SPACES.03950000
038300                                                                  03960000
038400 01  NET-REPORT-DETAIL-HEADER-2.                                  03970000
038500     05  FILLER                         PIC  X(35)   VALUE SPACES.03980000
038600     05  FILLER                         PIC  X(23)   VALUE        03990000
038700         'I S S U E D   C A R D S'.                               04000000
038800     05  FILLER                         PIC  X(35)   VALUE SPACES.04010000
038900     05  FILLER                         PIC  X(27)   VALUE        04020000
039000         'T E N D E R E D   C A R D S'.                           04030000
039100     05  FILLER                         PIC  X(12)   VALUE SPACES.04040000
039200                                                                  04050000
039300 01  NET-REPORT-DETAIL-HEADER-3.                                  04060000
039400     05  FILLER                         PIC  X(42)   VALUE SPACES.04070000
039500     05  FILLER                         PIC  X(05)   VALUE        04080000
039600         'N E T'.                                                 04090000
039700     05  FILLER                         PIC  X(56)   VALUE SPACES.04100000
039800     05  FILLER                         PIC  X(05)   VALUE        04110000
039900         'N E T'.                                                 04120000
040000     05  FILLER                         PIC  X(24)   VALUE SPACES.04130000
040100                                                                  04140000
040200 01  NET-REPORT-DETAIL-HEADER-4.                                  04150000
040300     05  FILLER                         PIC  X(01)   VALUE SPACES.04160000
040400     05  FILLER                         PIC  X(09)   VALUE        04170000
040500         'CARD TYPE'.                                             04180000
040600     05  FILLER                         PIC  X(23)   VALUE SPACES.04190000
040700     05  FILLER                         PIC  X(06)   VALUE        04200000
040800         'NUMBER'.                                                04210000
040900     05  FILLER                         PIC  X(10)   VALUE SPACES.04220000
041000     05  FILLER                         PIC  X(06)   VALUE        04230000
041100         'AMOUNT'.                                                04240000
041200     05  FILLER                         PIC  X(39)   VALUE SPACES.04250000
041300     05  FILLER                         PIC  X(06)   VALUE        04260000
041400         'NUMBER'.                                                04270000
041500     05  FILLER                         PIC  X(10)   VALUE SPACES.04280000
041600     05  FILLER                         PIC  X(06)   VALUE        04290000
041700         'AMOUNT'.                                                04300000
041800     05  FILLER                         PIC  X(16)   VALUE SPACES.04310000
041900                                                                  04320000
042000 01  REPORT-DETAIL-HEADER-2.                                      04330000
042100     05  FILLER                         PIC  X(27)   VALUE SPACES.04340000
042200     05  FILLER                         PIC  X(09)   VALUE        04350000
042300         'T O T A L'.                                             04360000
042400     05  FILLER                         PIC  X(16)   VALUE SPACES.04370000
042500     05  FILLER                         PIC  X(12)   VALUE        04380000
042600         'A D D  O N S'.                                          04390000
042700     05  FILLER                         PIC  X(10)   VALUE SPACES.04400000
042800     05  FILLER                         PIC  X(11)   VALUE        04410000
042900         'V O I D E D'.                                           04420000
043000     05  FILLER                         PIC  X(19)   VALUE SPACES.04430000
043100     05  FILLER                         PIC  X(05)   VALUE        04440000
043200         'N E T'.                                                 04450000
043300     05  FILLER                         PIC  X(24)   VALUE SPACES.04460000
043400     05  FILLER                         PIC  X(09)   VALUE        04470000
043500         'T O T A L'.                                             04480000
043600     05  FILLER                         PIC  X(14)   VALUE SPACES.04490000
043700     05  FILLER                         PIC  X(11)   VALUE        04500000
043800         'V O I D E D'.                                           04510000
043900     05  FILLER                         PIC  X(21)   VALUE SPACES.04520000
044000     05  FILLER                         PIC  X(05)   VALUE        04530000
044100         'N E T'.                                                 04540000
044200     05  FILLER                         PIC  X(12)   VALUE SPACES.04550000
044300     05  FILLER                         PIC  X(15)   VALUE        04560000
044400         'V A R I A N C E'.                                       04570000
044500                                                                  04580000
044600 01  REPORT-DETAIL-HEADER-3.                                      04590000
044700     05  FILLER                         PIC  X(04)   VALUE SPACES.04600000
044800     05  FILLER                         PIC  X(05)   VALUE        04610000
044900         'STORE'.                                                 04620000
045000     05  FILLER                         PIC  X(12)   VALUE SPACES.04630000
045100     05  FILLER                         PIC  X(06)   VALUE        04640000
045200         'NUMBER'.                                                04650000
045300     05  FILLER                         PIC  X(09)   VALUE SPACES.04660000
045400     05  FILLER                         PIC  X(06)   VALUE        04670000
045500         'AMOUNT'.                                                04680000
045600     05  FILLER                         PIC  X(06)   VALUE SPACES.04690000
045700     05  FILLER                         PIC  X(06)   VALUE        04700000
045800         'NUMBER'.                                                04710000
045900     05  FILLER                         PIC  X(05)   VALUE SPACES.04720000
046000     05  FILLER                         PIC  X(06)   VALUE        04730000
046100         'AMOUNT'.                                                04740000
046200     05  FILLER                         PIC  X(05)   VALUE SPACES.04750000
046300     05  FILLER                         PIC  X(06)   VALUE        04760000
046400         'NUMBER'.                                                04770000
046500     05  FILLER                         PIC  X(05)   VALUE SPACES.04780000
046600     05  FILLER                         PIC  X(06)   VALUE        04790000
046700         'AMOUNT'.                                                04800000
046800     05  FILLER                         PIC  X(09)   VALUE SPACES.04810000
046900     05  FILLER                         PIC  X(06)   VALUE        04820000
047000         'NUMBER'.                                                04830000
047100     05  FILLER                         PIC  X(09)   VALUE SPACES.04840000
047200     05  FILLER                         PIC  X(06)   VALUE        04850000
047300         'AMOUNT'.                                                04860000
047400     05  FILLER                         PIC  X(10)   VALUE SPACES.04870000
047500     05  FILLER                         PIC  X(06)   VALUE        04880000
047600         'NUMBER'.                                                04890000
047700     05  FILLER                         PIC  X(09)   VALUE SPACES.04900000
047800     05  FILLER                         PIC  X(06)   VALUE        04910000
047900         'AMOUNT'.                                                04920000
048000     05  FILLER                         PIC  X(06)   VALUE SPACES.04930000
048100     05  FILLER                         PIC  X(06)   VALUE        04940000
048200         'NUMBER'.                                                04950000
048300     05  FILLER                         PIC  X(05)   VALUE SPACES.04960000
048400     05  FILLER                         PIC  X(06)   VALUE        04970000
048500         'AMOUNT'.                                                04980000
048600     05  FILLER                         PIC  X(08)   VALUE SPACES.04990000
048700     05  FILLER                         PIC  X(06)   VALUE        05000000
048800         'NUMBER'.                                                05010000
048900     05  FILLER                         PIC  X(09)   VALUE SPACES.05020000
049000     05  FILLER                         PIC  X(06)   VALUE        05030000
049100         'AMOUNT'.                                                05040000
049200     05  FILLER                         PIC  X(11)   VALUE SPACES.05050000
049300     05  FILLER                         PIC  X(06)   VALUE        05060000
049400         'AMOUNT'.                                                05070000
049500     05  FILLER                         PIC  X(03)   VALUE SPACES.05080000
049600                                                                  05090000
049700 01  REPORT-DETAIL-DASH-LINE.                                     05100000
049800     05  FILLER                         PIC  X(18)   VALUE SPACES.05110000
049900     05  FILLER                         PIC  X(102)  VALUE ALL    05120000
050000         '_'.                                                     05130000
050100     05  FILLER                         PIC  X(02)   VALUE SPACES.05140000
050200     05  FILLER                         PIC  X(82)   VALUE ALL    05150000
050300         '_'.                                                     05160000
050400     05  FILLER                         PIC  X(01)   VALUE SPACES.05170000
050500     05  FILLER                         PIC  X(15)   VALUE ALL    05180000
050600         '_'.                                                     05190000
050700                                                                  05200000
050800 01  NET-REPORT-DASH-HEADER.                                      05210000
050900     05  FILLER                         PIC  X(01)   VALUE SPACES.05220000
051000     05  FILLER                         PIC  X(09)   VALUE        05230000
051100         '---------'.                                             05240000
051200     05  FILLER                         PIC  X(23)   VALUE SPACES.05250000
051300     05  FILLER                         PIC  X(06)   VALUE        05260000
051400         '------'.                                                05270000
051500     05  FILLER                         PIC  X(10)   VALUE SPACES.05280000
051600     05  FILLER                         PIC  X(06)   VALUE        05290000
051700         '------'.                                                05300000
051800     05  FILLER                         PIC  X(39)   VALUE SPACES.05310000
051900     05  FILLER                         PIC  X(06)   VALUE        05320000
052000         '------'.                                                05330000
052100     05  FILLER                         PIC  X(10)   VALUE SPACES.05340000
052200     05  FILLER                         PIC  X(06)   VALUE        05350000
052300         '------'.                                                05360000
052400     05  FILLER                         PIC  X(16)   VALUE SPACES.05370000
052500                                                                  05380000
052600 01  NET-REPORT-DETAIL-DASH-LINE.                                 05390000
052700     05  FILLER                         PIC  X(18)   VALUE SPACES.05400000
052800     05  FILLER                         PIC  X(55)   VALUE ALL    05410000
052900         '_'.                                                     05420000
053000     05  FILLER                         PIC  X(02)   VALUE SPACES.05430000
053100     05  FILLER                         PIC  X(55)   VALUE ALL    05440000
053200         '_'.                                                     05450000
053300     05  FILLER                         PIC  X(02)   VALUE SPACES.05460000
053400                                                                  05470000
053500 01  REPORT-DETAIL-LINE.                                          05480000
053600     05  FILLER                         PIC  X(01)  VALUE SPACES. 05490000
053700     05  RDL-STORE-NBR                  PIC  9999   VALUE ZEROES. 05500000
053800     05  RDL-STORE-HYPHEN               PIC  X(01)  VALUE         05510000
053900         '-'.                                                     05520000
054000     05  RDL-STORE-NME                  PIC  X(10)  VALUE SPACES. 05530000
054100     05  FILLER                         PIC  X(01)  VALUE SPACES. 05540000
054200     05  RDL-ISSUE-TOT-NUMBER           PIC  ZZZ,ZZZ,ZZ9          05550000
054300                                                    VALUE ZEROES. 05560000
054400     05  FILLER                         PIC  X(01)  VALUE SPACES. 05570000
054500     05  RDL-ISSUE-TOT-AMOUNT           PIC  Z,ZZZ,ZZZ,ZZZ.99-    05580000
054600                                                    VALUE ZEROES. 05590000
054700     05  FILLER                         PIC  X(01)  VALUE SPACES. 05600000
054800     05  RDL-ISSUE-ADD-NUMBER           PIC  ZZZ,ZZ9              05610000
054900                                                    VALUE ZEROES. 05620000
055000     05  FILLER                         PIC  X(01)  VALUE SPACES. 05630000
055100     05  RDL-ISSUE-ADD-AMOUNT           PIC  Z,ZZZ,ZZZ.99-        05640000
055200                                                    VALUE ZEROES. 05650000
055300     05  FILLER                         PIC  X(01)  VALUE SPACES. 05660000
055400     05  RDL-ISSUE-VOID-NUMBER          PIC  ZZZ,ZZ9              05670000
055500                                                    VALUE ZEROES. 05680000
055600     05  FILLER                         PIC  X(01)  VALUE SPACES. 05690000
055700     05  RDL-ISSUE-VOID-AMOUNT          PIC ZZ,ZZZ,ZZZ.99-        05700000
055800                                                    VALUE ZEROES. 05710000
055900     05  FILLER                         PIC  X(01)  VALUE SPACES. 05720000
056000     05  RDL-ISSUE-NET-NUMBER           PIC  ZZZ,ZZZ,ZZ9          05730000
056100                                                    VALUE ZEROES. 05740000
056200     05  FILLER                         PIC  X(01)  VALUE SPACES. 05750000
056300     05  RDL-ISSUE-NET-AMOUNT           PIC  Z,ZZZ,ZZZ,ZZZ.99-    05760000
056400                                                    VALUE ZEROES. 05770000
056500     05  FILLER                         PIC  X(01)  VALUE SPACES. 05780000
056600     05  RDL-TEND-TOT-NUMBER            PIC  ZZZ,ZZZ,ZZ9          05790000
056700                                                    VALUE ZEROES. 05800000
056800     05  FILLER                         PIC  X(01)  VALUE SPACES. 05810000
056900     05  RDL-TEND-TOT-AMOUNT            PIC  Z,ZZZ,ZZZ,ZZZ.99-    05820000
057000                                                    VALUE ZEROES. 05830000
057100     05  FILLER                         PIC  X(01)  VALUE SPACES. 05840000
057200     05  RDL-TEND-VOID-NUMBER           PIC  ZZZ,ZZ9              05850000
057300                                                    VALUE ZEROES. 05860000
057400     05  FILLER                         PIC  X(01)  VALUE SPACES. 05870000
057500     05  RDL-TEND-VOID-AMOUNT           PIC ZZ,ZZZ,ZZZ.99-        05880000
057600                                                    VALUE ZEROES. 05890000
057700     05  FILLER                         PIC  X(01)  VALUE SPACES. 05900000
057800     05  RDL-TEND-NET-NUMBER            PIC  ZZZ,ZZZ,ZZ9-         05910000
057900                                                    VALUE ZEROES. 05920000
058000     05  FILLER                         PIC  X(01)  VALUE SPACES. 05930000
058100     05  RDL-TEND-NET-AMOUNT            PIC  Z,ZZZ,ZZZ,ZZZ.99-    05940000
058200                                                    VALUE ZEROES. 05950000
058300     05  FILLER                         PIC  X(01)  VALUE SPACES. 05960000
058400     05  RDL-NET-VARIANCE-AMOUNT        PIC  ZZZ,ZZZ,ZZZ.99-      05970000
058500                                                    VALUE ZEROES. 05980000
058600                                                                  05990000
058700 01  NET-REPORT-DETAIL-LINE.                                      06000000
058800     05  FILLER                         PIC  X(01)  VALUE SPACES. 06010000
058900     05  RDL-DESCRIPTION.                                         06020000
059000         10  RDL-STOCK-ID               PIC  X(08)  VALUE SPACES. 06030000
059100         10  FILLER                     PIC  X(06)  VALUE SPACES. 06040000
059200     05  FILLER                         PIC  X(13)  VALUE SPACES. 06050000
059300     05  RDL-NET-ISSUE-NUMBER           PIC  ZZZ,ZZZ,ZZ9          06060000
059400                                                    VALUE ZEROES. 06070000
059500     05  FILLER                         PIC  X(01)  VALUE SPACES. 06080000
059600     05  RDL-NET-ISSUE-AMOUNT           PIC  Z,ZZZ,ZZZ,ZZZ.99-    06090000
059700                                                    VALUE ZEROES. 06100000
059800     05  FILLER                         PIC  X(32)  VALUE SPACES. 06110000
059900     05  RDL-NET-TEND-NUMBER            PIC  ZZZ,ZZZ,ZZ9-         06120000
060000                                                    VALUE ZEROES. 06130000
060100     05  FILLER                         PIC  X(01)  VALUE SPACES. 06140000
060200     05  RDL-NET-TEND-AMOUNT            PIC  Z,ZZZ,ZZZ,ZZZ.99-    06150000
060300                                                    VALUE ZEROES. 06160000
060400     05  FILLER                         PIC  X(09)  VALUE SPACES. 06170000
060500                                                                  06180000
060600 01  REPORT-TOTAL-LINE.                                           06190000
060700     05  FILLER                         PIC  X(01)  VALUE SPACES. 06200000
060800     05  TL-LINE-NAME                   PIC  X(14)  VALUE SPACES. 06210000
060900     05  FILLER                         PIC  X(02)  VALUE SPACES. 06220000
061000     05  TL-ISSUE-TOT-NUMBER            PIC  ZZZ,ZZZ,ZZ9          06230000
061100                                                    VALUE ZEROES. 06240000
061200     05  FILLER                         PIC  X(01)  VALUE SPACES. 06250000
061300     05  TL-ISSUE-TOT-AMOUNT            PIC  Z,ZZZ,ZZZ,ZZZ.99-    06260000
061400                                                    VALUE ZEROES. 06270000
061500     05  FILLER                         PIC  X(01)  VALUE SPACES. 06280000
061600     05  TL-ISSUE-ADD-NUMBER            PIC  ZZZ,ZZ9              06290000
061700                                                    VALUE ZEROES. 06300000
061800     05  FILLER                         PIC  X(01)  VALUE SPACES. 06310000
061900     05  TL-ISSUE-ADD-AMOUNT            PIC  Z,ZZZ,ZZZ.99-        06320000
062000                                                    VALUE ZEROES. 06330000
062100     05  FILLER                         PIC  X(01)  VALUE SPACES. 06340000
062200     05  TL-ISSUE-VOID-NUMBER           PIC  ZZZ,ZZ9              06350000
062300                                                    VALUE ZEROES. 06360000
062400     05  FILLER                         PIC  X(01)  VALUE SPACES. 06370000
062500     05  TL-ISSUE-VOID-AMOUNT           PIC  ZZ,ZZZ,ZZZ.99-       06380000
062600                                                    VALUE ZEROES. 06390000
062700     05  FILLER                         PIC  X(01)  VALUE SPACES. 06400000
062800     05  TL-ISSUE-NET-NUMBER            PIC  ZZZ,ZZZ,ZZ9          06410000
062900                                                    VALUE ZEROES. 06420000
063000     05  FILLER                         PIC  X(01)  VALUE SPACES. 06430000
063100     05  TL-ISSUE-NET-AMOUNT            PIC  Z,ZZZ,ZZZ,ZZZ.99-    06440000
063200                                                    VALUE ZEROES. 06450000
063300     05  FILLER                         PIC  X(01)  VALUE SPACES. 06460000
063400     05  TL-TEND-TOT-NUMBER             PIC  ZZZ,ZZZ,ZZ9          06470000
063500                                                    VALUE ZEROES. 06480000
063600     05  FILLER                         PIC  X(01)  VALUE SPACES. 06490000
063700     05  TL-TEND-TOT-AMOUNT             PIC  Z,ZZZ,ZZZ,ZZZ.99-    06500000
063800                                                    VALUE ZEROES. 06510000
063900     05  FILLER                         PIC  X(01)  VALUE SPACES. 06520000
064000     05  TL-TEND-VOID-NUMBER            PIC  ZZZ,ZZ9              06530000
064100                                                    VALUE ZEROES. 06540000
064200     05  FILLER                         PIC  X(01)  VALUE SPACES. 06550000
064300     05  TL-TEND-VOID-AMOUNT            PIC ZZ,ZZZ,ZZZ.99-        06560000
064400                                                    VALUE ZEROES. 06570000
064500     05  FILLER                         PIC  X(01)  VALUE SPACES. 06580000
064600     05  TL-TEND-NET-NUMBER             PIC  ZZZ,ZZZ,ZZ9-         06590000
064700                                                    VALUE ZEROES. 06600000
064800     05  FILLER                         PIC  X(01)  VALUE SPACES. 06610000
064900     05  TL-TEND-NET-AMOUNT             PIC  Z,ZZZ,ZZZ,ZZZ.99-    06620000
065000                                                    VALUE ZEROES. 06630000
065100     05  FILLER                         PIC  X(01)  VALUE SPACES. 06640000
065200     05  TL-NET-VARIANCE-AMOUNT         PIC  ZZZ,ZZZ,ZZZ.99-      06650000
065300                                                    VALUE ZEROES. 06660000
065400                                                                  06670000
065500 01  REPORT-END-OF-REPORT-LINE.                                   06680000
065600     05  FILLER                         PIC  X(84)   VALUE SPACES.06690000
065700     05  FILLER                         PIC  X(31)                06700000
065800         VALUE '*** E N D  O F  R E P O R T ***'.                 06710000
065900     05  FILLER                         PIC  X(85)   VALUE SPACES.06720000
066000                                                                  06730000
066100                                                                  06740000
066200******************************************************************06750000
066300*    KOHLS MERCHANDISE CARD CONSTANTS                            *06760000
066400******************************************************************06770000
066500     COPY SVWS004.                                                06780000
066600                                                                  06790000
066700******************************************************************06800000
066800*    VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004     *06810000
066900******************************************************************06820000
067000     COPY DPWS004.                                                06830000
067100                                                                  06840000
067200******************************************************************06850000
067300*    DATE ROUTINE COPY MEMBERS                                   *06860000
067400******************************************************************06870000
067500     COPY DPWS500.                                                06880000
067600                                                                  06890000
067700******************************************************************06900000
067800*    STANDARD HEADER FOR 250 COLUMN REPORT                       *06910000
067900******************************************************************06920000
068000     COPY DPWS250O.                                               06930000
068100                                                                  06940000
068200******************************************************************06950000
068300*  KOHL'S STANDARD REPORT HEADING                                *06960000
068400******************************************************************06970000
068500     COPY DPWS132.                                                06980000
068600                                                                  06990000
068700******************************************************************07000000
068800*      KOHL'S DOMAIN LOCATION TABLE                             * 07010000
068900******************************************************************07020000
069000     EXEC SQL                                                     07030000
069100         INCLUDE XST00001                                         07040000
069200     END-EXEC.                                                    07050000
069300                                                                  07060000
069400******************************************************************07070000
069500*    CURSOR TO ACCESS STORES                                     *07080000
069600******************************************************************07090000
069700     EXEC SQL                                                     07100000
069800       DECLARE XST00001-CSR CURSOR FOR                            07110000
069900           SELECT LOC_NBR,                                        07120000
070000                  COALESCE(LOC_10_ABBR_NM, :PC-DEFAULT-SPACES),   07130000
070100                  LOC_5_ABBR_NM,                                  07140000
070200                  COALESCE(E_BUS_IND, 'N')                        07150000
070300             FROM XST_LOC                                         07160000
070400            WHERE LOC_TYP_CDE IN ('DS','SV','HQ')                 07170000
070500              AND CLO_DTE >= :IR-CNTL-START-DATE                  07180000
070600              AND OPN_DTE <= :IR-CNTL-END-DATE                    07190000
070700           ORDER BY LOC_NBR                                       07200000
070800           WITH UR                                                07210000
070900     END-EXEC.                                                    07220000
071000******************************************************************07230000
071100*    STANDARD LAYOUT FOR THE SQL COMMUNCATIONS AREA              *07240000
071200******************************************************************07250000
071300     EXEC SQL                                                     07260000
071400         INCLUDE SQLCA                                            07270000
071500     END-EXEC.                                                    07280000
071600                                                                  07290000
071700     COPY SQLCA2.                                                 07300000
071800                                                                  07310000
071900                                                                  07320000
072000                                                                  07330000
072100 PROCEDURE DIVISION.                                              07340000
072200******************************************************************07350000
072300* MAINLINE                                                        07360000
072400******************************************************************07370000
072500 A100-MAINLINE.                                                   07380000
072600                                                                  07390000
072700     PERFORM B100-INITIALIZE.                                     07400000
072800     PERFORM B200-PROCESS-REPORTS.                                07410000
072900     PERFORM B900-EOJ-ROUTINE.                                    07420000
073000                                                                  07430000
073100     GOBACK.                                                      07440000
073200                                                                  07450000
073300*A100-EXIT.                                                       07460000
073400                                                                  07470000
073500******************************************************************07480000
073600*     B100-INITIALIZE                                            *07490000
073700* ==> PROCESSES: OPENS CONTROL CARD FILE AND CHECKS CONTROL CARD *07500000
073800*                TYPE FOR G,R,OR B.                              *07510000
073900* ==> PERFORMED FROM:  A100-MAINLINE                             *07520000
074000******************************************************************07530000
074100 B100-INITIALIZE.                                                 07540000
074200                                                                  07550000
074300     OPEN OUTPUT PURCH-FILE.                                      07560000
074400                                                                  07570000
074500     OPEN INPUT  CONTROL-CARD-FILE.                               07580000
074600     READ CONTROL-CARD-FILE INTO IR-CONTROL-CARD-RECORD.          07590000
074700     IF IR-CNTL-CRD-TYP  = PC-KMRC-REPORT OR                      07600000
074800                           PC-GIFT-REPORT OR                      07610000
074900                           PC-BOTH-REPORT                         07620000
075000        CONTINUE                                                  07630000
075100     ELSE                                                         07640000
075200        DISPLAY ' '                                               07650000
075300        DISPLAY '** ABEND     **'                                 07660000
075400        DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME             07670000
075500        DISPLAY '** PARAGRAPH **  = B100-INITIALIZE      '        07680000
075600        DISPLAY '** CONTROL REPORT TYPE HAS TO BE B,G, OR R **'   07690000
075700        MOVE +4002 TO ABEND-CODE                                  07700000
075800        CALL 'ILBOABN0' USING ABEND-CODE                          07710000
075900     END-IF.                                                      07720000
076000                                                                  07730000
076100     PERFORM B125-DATE-CONVERSION.                                07740000
076200     MOVE IR-CNTL-CRD-BEG-CC TO RSL-RANGE-BEG-DATE-CC.            07750000
076300     MOVE IR-CNTL-CRD-BEG-YY TO RSL-RANGE-BEG-DATE-YY.            07760000
076400     MOVE IR-CNTL-CRD-BEG-MM TO RSL-RANGE-BEG-DATE-MM.            07770000
076500     MOVE IR-CNTL-CRD-BEG-DD TO RSL-RANGE-BEG-DATE-DD.            07780000
076600     MOVE IR-CNTL-CRD-END-CC TO RSL-RANGE-END-DATE-CC.            07790000
076700     MOVE IR-CNTL-CRD-END-YY TO RSL-RANGE-END-DATE-YY.            07800000
076800     MOVE IR-CNTL-CRD-END-MM TO RSL-RANGE-END-DATE-MM.            07810000
076900     MOVE IR-CNTL-CRD-END-DD TO RSL-RANGE-END-DATE-DD.            07820000
077000                                                                  07830000
077100     EXEC SQL                                                     07840000
077200         SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP            07850000
077300     END-EXEC.                                                    07860000
077400                                                                  07870000
077500     EVALUATE TRUE                                                07880000
077600       WHEN SQLCODE NOT = 0                                       07890000
077700         DISPLAY ' '                                              07900000
077800         DISPLAY '** ABEND     **'                                07910000
077900         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            07920000
078000         DISPLAY '** PARAGRAPH ** = B100-INITIALIZE'              07930000
078100         DISPLAY '** GETTING TIMESTAMP'                           07940000
078200         PERFORM Z900-SQL-ABEND                                   07950000
078300     END-EVALUATE.                                                07960000
078400                                                                  07970000
078500     MOVE PV-CURRENT-TIMESTAMP TO PV-TRANS-TIMESTAMP.             07980000
078600     MOVE PV-TRANS-TMST-YY     TO DP250O-RUN-YEAR.                07990000
078700     MOVE PV-TRANS-TMST-MM     TO DP250O-RUN-MONTH.               08000000
078800     MOVE PV-TRANS-TMST-DD     TO DP250O-RUN-DAY.                 08010000
078900     MOVE PC-PROGRAM-NAME      TO DP250O-PROGRAM-NAME.            08020000
079000                                                                  08030000
079100     MOVE PV-TRANS-TMST-HH  TO DP250O-RUN-HOUR.                   08040000
079200     MOVE PV-TRANS-TMST-MIN TO DP250O-RUN-MINUTE.                 08050000
079300     MOVE PV-TRANS-TMST-YY     TO DP132-RUN-YEAR.                 08060000
079400     MOVE PV-TRANS-TMST-MM     TO DP132-RUN-MONTH.                08070000
079500     MOVE PV-TRANS-TMST-DD     TO DP132-RUN-DAY.                  08080000
079600     MOVE PC-PROGRAM-NAME      TO DP132-PROGRAM-NAME.             08090000
079700                                                                  08100000
079800     MOVE PV-TRANS-TMST-HH  TO DP132-RUN-HOUR.                    08110000
079900     MOVE PV-TRANS-TMST-MIN TO DP132-RUN-MINUTE.                  08120000
080000*LOAD STORE TABLE                                                 08130000
080100     EXEC SQL                                                     08140000
080200       OPEN XST00001-CSR                                          08150000
080300     END-EXEC.                                                    08160000
080400     EVALUATE TRUE                                                08170000
080500       WHEN SQLCODE NOT = 0                                       08180000
080600         DISPLAY ' '                                              08190000
080700         DISPLAY '** ABEND     **'                                08200000
080800         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            08210000
080900         DISPLAY '** PARAGRAPH **  = B100-INITIALIZE'             08220000
081000         DISPLAY '** OPEN CURSOR TO XST00001 TABLE'               08230000
081100         PERFORM Z900-SQL-ABEND                                   08240000
081200     END-EVALUATE.                                                08250000
081300                                                                  08260000
081400     INITIALIZE PA-STORE-TABLE.                                   08270000
081500                                                                  08280000
081600     PERFORM B155-FETCH-XST00001-CSR.                             08290000
081700                                                                  08300000
081800     PERFORM B150-LOAD-STORE-TABLE                                08310000
081900       UNTIL PS-END-OF-STORE-CSR.                                 08320000
082000                                                                  08330000
082100     EXEC SQL                                                     08340000
082200       CLOSE XST00001-CSR                                         08350000
082300     END-EXEC.                                                    08360000
082400     EVALUATE TRUE                                                08370000
082500        WHEN SQLCODE NOT = 0                                      08380000
082600         DISPLAY ' '                                              08390000
082700         DISPLAY '** ABEND     **'                                08400000
082800         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            08410000
082900         DISPLAY '** PARAGRAPH **  = B100-LOAD-STORE-TABLE'       08420000
083000         DISPLAY '** CLOSE CURSOR TO XST00001 TABLE'              08430000
083100         PERFORM Z900-SQL-ABEND                                   08440000
083200     END-EVALUATE.                                                08450000
083300                                                                  08460000
083400*B100-EXIT.                                                       08470000
083500                                                                  08480000
083600******************************************************************08490000
083700*     DECREMENT ENDING CONTROL CARD DATE BY ONE DAY TO MATCH     *08500000
083800*     AUDIT REPORT DATES.                                        *08510000
083900******************************************************************08520000
084000 B125-DATE-CONVERSION.                                            08530000
084100     INITIALIZE DPG51 DPG52 DPG53                                 08540000
084200                DPG54 DPG55 DPG56.                                08550000
084300     SET DPG51-ACTUAL-CALENDAR-ONLY                               08560000
084400                                 TO TRUE.                         08570000
084500     SET DPG51-DECREMENT-DATE    TO TRUE.                         08580000
084600     MOVE 1      TO DPG51-INCR-DECR-DAYS-9.                       08590000
084700     MOVE IR-CNTL-END-DATE-UNFMT TO DPG52-LK-DATE-INPUT.          08600000
084800     SET DPG52-LK-DTE-ISO-FMT    TO TRUE                          08610000
084900     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    08620000
085000                                             DPG54 DPG55 DPG56.   08630000
085100     EVALUATE TRUE                                                08640000
085200       WHEN DPG54-SEVERE-ERROR                                    08650000
085300       WHEN DPG54-DATE-INVALID                                    08660000
085400         DISPLAY ' '                                              08670000
085500         DISPLAY '** ABEND     **'                                08680000
085600         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            08690000
085700         DISPLAY '** PARAGRAPH **  = B125-DATE-CONVERSION'        08700000
085800         DISPLAY '** BAD CALL TO CALENDAR MODULE '                08710000
085900         DISPLAY '** DETERMINE VALID ENDING DATE **'              08720000
086000         DISPLAY DPG54-ERROR-MESSAGE                              08730000
086100         MOVE +4019             TO ABEND-CODE                     08740000
086200         CALL 'ILBOABN0' USING ABEND-CODE                         08750000
086300     END-EVALUATE.                                                08760000
086400                                                                  08770000
086500     MOVE DPG55-DB2-ISO-DATE-FMT TO IR-CNTL-END-DATE-UNFMT.       08780000
086600                                                                  08790000
086700******************************************************************08800000
086800*     B150-LOAD-STORE-TABLE                                      *08810000
086900* ==> PROCESSES:  LOADS THE STORE NUMBERS AND DESCRIPTION.       *08820000
087000* ==> PERFORMED FROM:  B100-INITIALIZE                           *08830000
087100******************************************************************08840000
087200 B150-LOAD-STORE-TABLE.                                           08850000
087300                                                                  08860000
087400     MOVE XST00001-LOC-NBR TO PV-STORE-SUB.                       08870000
087500     MOVE XST00001-LOC-NBR TO PA-STORE-NUM(PV-STORE-SUB).         08880000
087600                                                                  08890000
087700     IF XST00001-LOC-10-ABBR-NM NOT = ' '                         08900000
087800         MOVE XST00001-LOC-10-ABBR-NM                             08910000
087900                           TO PA-STORE-NAME(PV-STORE-SUB)         08920000
088000     ELSE                                                         08930000
088100         MOVE XST00001-LOC-5-ABBR-NM                              08940000
088200                           TO PA-STORE-NAME(PV-STORE-SUB)         08950000
088300     END-IF.                                                      08960000
088400                                                                  08970000
088500     MOVE XST00001-E-BUS-IND TO PA-E-BUS-IND(PV-STORE-SUB).       08980000
088600                                                                  08990000
088700     ADD PC-ONE TO PV-NUM-OF-STORES.                              09000000
088800                                                                  09010000
088900     PERFORM B155-FETCH-XST00001-CSR.                             09020000
089000                                                                  09030000
089100*B150-EXIT.                                                       09040000
089200                                                                  09050000
089300******************************************************************09060000
089400*     B155-FETCH-XST00001-CSR                                    *09070000
089500* ==> PROCESSES:  FETCH THE STORE NUMBERS AND DESCRIPTION.       *09080000
089600******************************************************************09090000
089700 B155-FETCH-XST00001-CSR.                                         09100000
089800                                                                  09110000
089900     EXEC SQL                                                     09120000
090000       FETCH XST00001-CSR                                         09130000
090100         INTO  :XST00001-LOC-NBR,                                 09140000
090200               :XST00001-LOC-10-ABBR-NM,                          09150000
090300               :XST00001-LOC-5-ABBR-NM,                           09160000
090400               :XST00001-E-BUS-IND                                09170000
090500     END-EXEC.                                                    09180000
090600     EVALUATE TRUE                                                09190000
090700        WHEN SQLCODE = +0                                         09200000
090800            CONTINUE                                              09210000
090900        WHEN SQLCODE = +100                                       09220000
091000           SET PS-END-OF-STORE-CSR TO TRUE                        09230000
091100        WHEN OTHER                                                09240000
091200         DISPLAY ' '                                              09250000
091300         DISPLAY '** ABEND     **'                                09260000
091400         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            09270000
091500         DISPLAY '** PARAGRAPH **  = B155-FETCH-XST000010-CSR'    09280000
091600         DISPLAY '** FETCHING STORE INFORMATION'                  09290000
091700         PERFORM Z900-SQL-ABEND                                   09300000
091800     END-EVALUATE.                                                09310000
091900                                                                  09320000
092000*B150-EXIT.                                                       09330000
092100                                                                  09340000
092200******************************************************************09350000
092300*     B200-PROCESS-REPORTS                                       *09360000
092400* ==> PROCESSES:  CHECKS TO SEE WHICH REPORTS NEED TO BE WRITTEN *09370000
092500* ==> PERFORMED FROM:  A100-MAINLINE                             *09380000
092600******************************************************************09390000
092700 B200-PROCESS-REPORTS.                                            09400000
092800                                                                  09410000
092900     IF IR-CNTL-CRD-TYP = PC-KMRC-REPORT OR                       09420000
093000                          PC-BOTH-REPORT                          09430000
093100          PERFORM C100-PROCESS-KMRC-REPORT                        09440000
093200     END-IF.                                                      09450000
093300     IF IR-CNTL-CRD-TYP = PC-GIFT-REPORT OR                       09460000
093400                          PC-BOTH-REPORT                          09470000
093500          PERFORM C200-PROCESS-GIFT-REPORT                        09480000
093600     END-IF.                                                      09490000
093700                                                                  09500000
093800*B200-EXIT.                                                       09510000
093900                                                                  09520000
094000******************************************************************09530000
094100*     B900-EOJ-ROUTINE                                           *09540000
094200* ==> PROCESSES: CLOSE THE FILES                                 *09550000
094300* ==> PERFORMED FROM:  A100-MAINLINE                             *09560000
094400******************************************************************09570000
094500 B900-EOJ-ROUTINE.                                                09580000
094600                                                                  09590000
094700     CLOSE PURCH-FILE                                             09600000
094800           CONTROL-CARD-FILE.                                     09610000
094900                                                                  09620000
095000     EVALUATE TRUE                                                09630000
095100       WHEN IR-CNTL-CRD-TYP = PC-KMRC-REPORT                      09640000
095200           CLOSE KMRC-REPORT                                      09650000
095300                 KMRC-FILE                                        09660000
095400       WHEN IR-CNTL-CRD-TYP = PC-GIFT-REPORT                      09670000
095500           CLOSE GIFT-REPORT                                      09680000
095600                 GIFT-FILE                                        09690000
095700                 NET-GIFT-REPORT                                  09700000
095800       WHEN IR-CNTL-CRD-TYP = PC-BOTH-REPORT                      09710000
095900           CLOSE GIFT-FILE                                        09720000
096000                 GIFT-REPORT                                      09730000
096100                 KMRC-FILE                                        09740000
096200                 KMRC-REPORT                                      09750000
096300                 NET-GIFT-REPORT                                  09760000
096400     END-EVALUATE.                                                09770000
096500                                                                  09780000
096600*B900-EXIT.                                                       09790000
096700                                                                  09800000
096800******************************************************************09810000
096900*     C100-PROCESS-KMRC-REPORT                                   *09820000
097000* ==> PROCESSES:  CONTROLS THE KMRC REPORT PRINTING              *09830000
097100* ==> PERFORMED FROM:  B200-PROCESS-REPORTS                      *09840000
097200******************************************************************09850000
097300 C100-PROCESS-KMRC-REPORT.                                        09860000
097400                                                                  09870000
097500     OPEN INPUT KMRC-FILE.                                        09880000
097600     OPEN OUTPUT KMRC-REPORT.                                     09890000
097700                                                                  09900000
097800     PERFORM D100-INITIALIZE-STORE-TOTALS                         09910000
097900         VARYING PV-STORE-SUB FROM 1 BY 1                         09920000
098000           UNTIL PV-STORE-SUB > PC-MAX-NUM-OF-STORES.             09930000
098100                                                                  09940000
098200     PERFORM D200-INITIALIZE-COMPANY-TOTALS.                      09950000
098300                                                                  09960000
098400     PERFORM D600-READ-KMRC-FILE.                                 09970000
098500                                                                  09980000
098600     IF PS-END-OF-KMRC-FILE                                       09990000
098700         CONTINUE                                                 10000000
098800     ELSE                                                         10010000
098900         SET PS-FIRST-TIME-THRU      TO TRUE                      10020000
099000         MOVE SV010-CRD-STK-TYP-ID   TO PV-CURR-CRD-STK-TYP-ID    10030000
099100         MOVE SV010-CRD-STK-TYP-DESC TO PV-CURR-CRD-STK-TYP-DESC  10040000
099200         MOVE SV010-STR-NBR          TO PV-CURR-STR-NBR           10050000
099300                                                                  10060000
099400         PERFORM D400-PROCESS-KMRC-DETAIL                         10070000
099500             UNTIL PS-END-OF-KMRC-FILE                            10080000
099600                                                                  10090000
099700         PERFORM E200-WRITE-DETAIL-LINE-KMRC                      10100000
099800             VARYING PV-STORE-SUB FROM 1 BY 1                     10110000
099900               UNTIL PV-STORE-SUB > PC-MAX-NUM-OF-STORES          10120000
100000                                                                  10130000
100100         PERFORM E300-WRITE-COMPANY-TOTALS-KMRC                   10140000
100200     END-IF.                                                      10150000
100300                                                                  10160000
100400*C100-EXIT.                                                       10170000
100500                                                                  10180000
100600******************************************************************10190000
100700*     C200-PROCESS-GIFT-REPORT                                   *10200000
100800* ==> PROCESSES:  CONTROLS THE GIFT REPORT PRINTING              *10210000
100900* ==> PERFORMED FROM:  B200-PROCESS-REPORTS                      *10220000
101000******************************************************************10230000
101100 C200-PROCESS-GIFT-REPORT.                                        10240000
101200                                                                  10250000
101300     OPEN INPUT GIFT-FILE.                                        10260000
101400     OPEN OUTPUT GIFT-REPORT                                      10270000
101500                 NET-GIFT-REPORT.                                 10280000
101600     PERFORM D100-INITIALIZE-STORE-TOTALS                         10290000
101700         VARYING PV-STORE-SUB FROM 1 BY 1                         10300000
101800           UNTIL PV-STORE-SUB > PC-MAX-NUM-OF-STORES.             10310000
101900                                                                  10320000
102000     PERFORM D200-INITIALIZE-COMPANY-TOTALS.                      10330000
102100     PERFORM D300-INITIALIZE-GC-COMP-TOTALS.                      10340000
102200                                                                  10350000
102300     PERFORM D700-READ-GIFT-FILE.                                 10360000
102400                                                                  10370000
102500     IF PS-END-OF-GIFT-FILE                                       10380000
102600         CONTINUE                                                 10390000
102700     ELSE                                                         10400000
102800         SET PS-FIRST-TIME-THRU      TO TRUE                      10410000
102900         MOVE SV010-CRD-STK-TYP-ID   TO PV-CURR-CRD-STK-TYP-ID    10420000
103000         MOVE SV010-CRD-STK-TYP-DESC TO PV-CURR-CRD-STK-TYP-DESC  10430000
103100         MOVE SV010-STR-NBR          TO PV-CURR-STR-NBR           10440000
103200                                                                  10450000
103300         PERFORM E401-PRINT-NET-GIFT-HEADINGS                     10460000
103400                                                                  10470000
103500         PERFORM D500-PROCESS-GIFT-DETAIL                         10480000
103600                 UNTIL PS-END-OF-GIFT-FILE                        10490000
103700                                                                  10500000
103800         PERFORM E500-WRITE-DETAIL-LINE-GIFT                      10510000
103900             VARYING PV-STORE-SUB FROM 1 BY 1                     10520000
104000               UNTIL PV-STORE-SUB > PC-MAX-NUM-OF-STORES          10530000
104100                                                                  10540000
104200         PERFORM E600-WRITE-COMPANY-TOTALS-GIFT                   10550000
104300                                                                  10560000
104400         PERFORM E900-WRITE-ALL-STORE-LINES                       10570000
104500                                                                  10580000
104600         PERFORM E950-WRITE-ALLCARDS-GC-TOTALS                    10590000
104700     END-IF.                                                      10600000
104800*C200-EXIT.                                                       10610000
104900                                                                  10620000
105000******************************************************************10630000
105100*     D100-INITIALIZE-STORE-TOTALS                               *10640000
105200* ==> PROCESSES:  INITIALIZES THE TOTALS                         *10650000
105300* ==> PERFORMED FROM:  C100-PROCESS-KMRC-REPORT                  *10660000
105400*                      C200-PROCESS-GIFT-REPORT                  *10670000
105500*                      D400-PROCESS-KMRC-DETAIL                  *10680000
105600*                      D500-PROCESS-GIFT-DETAIL                  *10690000
105700******************************************************************10700000
105800 D100-INITIALIZE-STORE-TOTALS.                                    10710000
105900                                                                  10720000
106000     MOVE ZEROS  TO PA-ISS-TOT-NUS(PV-STORE-SUB)                  10730000
106100                    PA-ISS-TOT-AMS(PV-STORE-SUB)                  10740000
106200                    PA-ISS-ADD-NUS(PV-STORE-SUB)                  10750000
106300                    PA-ISS-ADD-AMS(PV-STORE-SUB)                  10760000
106400                    PA-ISS-VOID-NUS(PV-STORE-SUB)                 10770000
106500                    PA-ISS-VOID-AMS(PV-STORE-SUB)                 10780000
106600                    PA-ISS-NET-NUS(PV-STORE-SUB)                  10790000
106700                    PA-ISS-NET-AMS(PV-STORE-SUB)                  10800000
106800                    PA-TEND-TOT-NUS(PV-STORE-SUB)                 10810000
106900                    PA-TEND-TOT-AMS(PV-STORE-SUB)                 10820000
107000                    PA-TEND-VOID-NUS(PV-STORE-SUB)                10830000
107100                    PA-TEND-VOID-AMS(PV-STORE-SUB)                10840000
107200                    PA-TEND-NET-NUS(PV-STORE-SUB)                 10850000
107300                    PA-TEND-NET-AMS(PV-STORE-SUB).                10860000
107400                                                                  10870000
107500*D100-EXIT.                                                       10880000
107600                                                                  10890000
107700******************************************************************10900000
107800*     D200-INITIALIZE-COMPANY-TOTALS                             *10910000
107900* ==> PROCESSES:  INITIALIZES THE COMPANY TOTALS                 *10920000
108000* ==> PERFORMED FROM:  C100-PROCESS-KMRC-REPORT                  *10930000
108100*                      C200-PROCESS-GIFT-REPORT                  *10940000
108200*                      D400-PROCESS-KMRC-DETAIL                  *10950000
108300*                      D500-PROCESS-GIFT-DETAIL                  *10960000
108400******************************************************************10970000
108500 D200-INITIALIZE-COMPANY-TOTALS.                                  10980000
108600                                                                  10990000
108700     MOVE ZEROS       TO PV-CT-ISS-TOT-NUM                        11000000
108800                         PV-CT-ISS-TOT-AMT                        11010000
108900                         PV-CT-ISS-ADD-NUM                        11020000
109000                         PV-CT-ISS-ADD-AMT                        11030000
109100                         PV-CT-ISS-VOID-NUM                       11040000
109200                         PV-CT-ISS-VOID-AMT                       11050000
109300                         PV-CT-ISS-NET-NUM                        11060000
109400                         PV-CT-ISS-NET-AMT                        11070000
109500                         PV-CT-TEND-TOT-NUM                       11080000
109600                         PV-CT-TEND-TOT-AMT                       11090000
109700                         PV-CT-TEND-VOID-NUM                      11100000
109800                         PV-CT-TEND-VOID-AMT                      11110000
109900                         PV-CT-TEND-NET-NUM                       11120000
110000                         PV-CT-TEND-NET-AMT                       11130000
110100                         PV-CA-ISS-TOT-NUM                        11140000
110200                         PV-CA-ISS-TOT-AMT                        11150000
110300                         PV-CA-ISS-ADD-NUM                        11160000
110400                         PV-CA-ISS-ADD-AMT                        11170000
110500                         PV-CA-ISS-VOID-NUM                       11180000
110600                         PV-CA-ISS-VOID-AMT                       11190000
110700                         PV-CA-ISS-NET-NUM                        11200000
110800                         PV-CA-ISS-NET-AMT                        11210000
110900                         PV-CA-TEND-TOT-NUM                       11220000
111000                         PV-CA-TEND-TOT-AMT                       11230000
111100                         PV-CA-TEND-VOID-NUM                      11240000
111200                         PV-CA-TEND-VOID-AMT                      11250000
111300                         PV-CA-TEND-NET-NUM                       11260000
111400                         PV-CA-TEND-NET-AMT.                      11270000
111500                                                                  11280000
111600*D200-EXIT.                                                       11290000
111700                                                                  11300000
111800******************************************************************11310000
111900*     D300-INITIALIZE-GC-COMP-TOTALS                             *11320000
112000* ==> PROCESSES:  INITIALIZES THE COMPANY TOTALS                 *11330000
112100* ==> PERFORMED FROM:  C200-PROCESS-GIFT-REPORT                  *11340000
112200******************************************************************11350000
112300 D300-INITIALIZE-GC-COMP-TOTALS.                                  11360000
112400                                                                  11370000
112500     INITIALIZE PV-GCTA-ISS-TOT-NUM                               11380000
112600                PV-GCTA-ISS-TOT-AMT                               11390000
112700                PV-GCTA-ISS-ADD-NUM                               11400000
112800                PV-GCTA-ISS-ADD-AMT                               11410000
112900                PV-GCTA-ISS-VOID-NUM                              11420000
113000                PV-GCTA-ISS-VOID-AMT                              11430000
113100                PV-GCTA-ISS-NET-NUM                               11440000
113200                PV-GCTA-ISS-NET-AMT                               11450000
113300                PV-GCTA-TEND-TOT-NUM                              11460000
113400                PV-GCTA-TEND-TOT-AMT                              11470000
113500                PV-GCTA-TEND-VOID-NUM                             11480000
113600                PV-GCTA-TEND-VOID-AMT                             11490000
113700                PV-GCTA-TEND-NET-NUM                              11500000
113800                PV-GCTA-TEND-NET-AMT.                             11510000
113900                                                                  11520000
114000*D300-EXIT.                                                       11530000
114100******************************************************************11540000
114200*     D400-PROCESS-KMRC-DETAIL                                   *11550000
114300* ==> PROCESSES:  PRINTS THE DETAIL FOR THE KMRC REPORT          *11560000
114400* ==> PERFORMED FROM:  C100-PROCESS-KMRC-REPORT                  *11570000
114500******************************************************************11580000
114600 D400-PROCESS-KMRC-DETAIL.                                        11590000
114700                                                                  11600000
114800     IF PV-CURR-CRD-STK-TYP-ID NOT = PV-PREV-CRD-STK-TYP-ID       11610000
114900        IF PS-NOT-FIRST-TIME-THRU                                 11620000
115000            PERFORM E200-WRITE-DETAIL-LINE-KMRC                   11630000
115100                VARYING PV-STORE-SUB FROM 1 BY 1                  11640000
115200                  UNTIL PV-STORE-SUB > PC-MAX-NUM-OF-STORES       11650000
115300            PERFORM D100-INITIALIZE-STORE-TOTALS                  11660000
115400                VARYING PV-STORE-SUB FROM 1 BY 1                  11670000
115500                  UNTIL PV-STORE-SUB > PC-MAX-NUM-OF-STORES       11680000
115600            PERFORM E300-WRITE-COMPANY-TOTALS-KMRC                11690000
115700            PERFORM D200-INITIALIZE-COMPANY-TOTALS                11700000
115800        END-IF                                                    11710000
115900        SET PS-NOT-FIRST-TIME-THRU  TO TRUE                       11720000
116000        MOVE SV010-CRD-STK-TYP-ID   TO PV-CURR-CRD-STK-TYP-ID     11730000
116100                                       PV-PREV-CRD-STK-TYP-ID     11740000
116200        MOVE SV010-CRD-STK-TYP-DESC TO PV-PREV-CRD-STK-TYP-DESC   11750000
116300                                       PV-CURR-CRD-STK-TYP-DESC   11760000
116400        MOVE SV010-STR-NBR          TO PV-CURR-STR-NBR            11770000
116500        MOVE ZEROS TO PA-PAGE-COUNTER-KMRC                        11780000
116600        MOVE PC-NEW-FRONT-REQUEST TO                              11790000
116700             DP250O-LASER-NEW-PAGE-INDICATR                       11800000
116800        PERFORM E100-PRINT-KMRC-HEADINGS                          11810000
116900     END-IF.                                                      11820000
117000                                                                  11830000
117100     MOVE PV-CURR-STR-NBR TO PV-STORE-SUB.                        11840000
117200                                                                  11850000
117300     IF PA-STORE-NUM(PV-STORE-SUB) > 0                            11860000
117400       IF SV010-ACTVY-TYP-CDE = SV004-ISSUE-KMRC-ACT-TYP-N        11870000
117500          IF SV010-TRN-RVRSL-CDE = SV004-REV-CDE-NORMAL           11880000
117600           IF ((PA-E-BUS-IND(PV-STORE-SUB) NOT = 'Y') OR          11890000
117700               (PA-E-BUS-IND(PV-STORE-SUB) = 'Y' AND              11900000
117800                SV010-ACTVY-STAT-CDE = SV004-STAT-NO-AUTH-CD OR   11910000
117900                SV010-ACTVY-STAT-CDE = SV004-STAT-VERIFIED-CD))   11920000
118000                 ADD PC-ONE        TO PA-ISS-TOT-NUS(PV-STORE-SUB)11930000
118100                 ADD SV010-APP-AUTH-AMT                           11940000
118200                                   TO PA-ISS-TOT-AMS(PV-STORE-SUB)11950000
118300                 ADD PC-ONE             TO PV-CT-ISS-TOT-NUM      11960000
118400                 ADD SV010-APP-AUTH-AMT TO PV-CT-ISS-TOT-AMT      11970000
118500                 IF SV010-ADDON-COUNTER > 1                       11980000
118600                     ADD PC-ONE TO PA-ISS-ADD-NUS(PV-STORE-SUB)   11990000
118700                                   PV-CT-ISS-ADD-NUM              12000000
118800                     ADD SV010-APP-AUTH-AMT                       12010000
118900                                TO PA-ISS-ADD-AMS(PV-STORE-SUB)   12020000
119000                                   PV-CT-ISS-ADD-AMT              12030000
119100                 END-IF                                           12040000
119200           ELSE                                                   12050000
119300                 ADD PC-ONE             TO PV-CA-ISS-TOT-NUM      12060000
119400                                           PV-GCTA-ISS-TOT-NUM    12070000
119500                 ADD SV010-APP-AUTH-AMT TO PV-CA-ISS-TOT-AMT      12080000
119600                                           PV-GCTA-ISS-TOT-AMT    12090000
119700                 IF SV010-ADDON-COUNTER > 1                       12100000
119800                    ADD PC-ONE TO PV-CA-ISS-ADD-NUM               12110000
119900                                  PV-GCTA-ISS-ADD-NUM             12120000
120000                    ADD SV010-APP-AUTH-AMT TO PV-CA-ISS-ADD-AMT   12130000
120100                                              PV-GCTA-ISS-ADD-AMT 12140000
120200                 END-IF                                           12150000
120300           END-IF                                                 12160000
120400        ELSE                                                      12170000
120500           IF ((PA-E-BUS-IND(PV-STORE-SUB) NOT = 'Y') OR          12180000
120600               (PA-E-BUS-IND(PV-STORE-SUB) = 'Y' AND              12190000
120700                SV010-ACTVY-STAT-CDE = SV004-STAT-NO-AUTH-CD OR   12200000
120800                SV010-ACTVY-STAT-CDE = SV004-STAT-VERIFIED-CD))   12210000
120900                 ADD PC-ONE       TO PA-ISS-VOID-NUS(PV-STORE-SUB)12220000
121000                 ADD SV010-APP-AUTH-AMT                           12230000
121100                                  TO PA-ISS-VOID-AMS(PV-STORE-SUB)12240000
121200                 ADD PC-ONE             TO PV-CT-ISS-VOID-NUM     12250000
121300                 ADD SV010-APP-AUTH-AMT TO PV-CT-ISS-VOID-AMT     12260000
121400           ELSE                                                   12270000
121500                 ADD PC-ONE             TO PV-CA-ISS-VOID-NUM     12280000
121600                                           PV-GCTA-ISS-VOID-NUM   12290000
121700                 ADD SV010-APP-AUTH-AMT TO PV-CA-ISS-VOID-AMT     12300000
121800                                           PV-GCTA-ISS-VOID-AMT   12310000
121900           END-IF                                                 12320000
122000        END-IF                                                    12330000
122100     ELSE                                                         12340000
122200        IF SV010-TRN-RVRSL-CDE = SV004-REV-CDE-NORMAL             12350000
122300           IF ((PA-E-BUS-IND(PV-STORE-SUB) NOT = 'Y') OR          12360000
122400               (PA-E-BUS-IND(PV-STORE-SUB) = 'Y' AND              12370000
122500                SV010-ACTVY-STAT-CDE = SV004-STAT-NO-AUTH-CD OR   12380000
122600                SV010-ACTVY-STAT-CDE = SV004-STAT-VERIFIED-CD))   12390000
122700                 ADD PC-ONE      TO PA-TEND-TOT-NUS(PV-STORE-SUB) 12400000
122800                 ADD SV010-APP-AUTH-AMT                           12410000
122900                                 TO PA-TEND-TOT-AMS(PV-STORE-SUB) 12420000
123000                 ADD PC-ONE             TO PV-CT-TEND-TOT-NUM     12430000
123100                 ADD SV010-APP-AUTH-AMT TO PV-CT-TEND-TOT-AMT     12440000
123200           ELSE                                                   12450000
123300                 ADD PC-ONE             TO PV-CA-TEND-TOT-NUM     12460000
123400                                           PV-GCTA-TEND-TOT-NUM   12470000
123500                 ADD SV010-APP-AUTH-AMT TO PV-CA-TEND-TOT-AMT     12480000
123600                                           PV-GCTA-TEND-TOT-AMT   12490000
123700           END-IF                                                 12500000
123800        ELSE                                                      12510000
123900           IF ((PA-E-BUS-IND(PV-STORE-SUB) NOT = 'Y') OR          12520000
124000               (PA-E-BUS-IND(PV-STORE-SUB) = 'Y' AND              12530000
124100                SV010-ACTVY-STAT-CDE = SV004-STAT-NO-AUTH-CD OR   12540000
124200                SV010-ACTVY-STAT-CDE = SV004-STAT-VERIFIED-CD))   12550000
124300                 ADD PC-ONE      TO PA-TEND-VOID-NUS(PV-STORE-SUB)12560000
124400                 ADD SV010-APP-AUTH-AMT                           12570000
124500                                 TO PA-TEND-VOID-AMS(PV-STORE-SUB)12580000
124600                 ADD PC-ONE             TO PV-CT-TEND-VOID-NUM    12590000
124700                 ADD SV010-APP-AUTH-AMT TO PV-CT-TEND-VOID-AMT    12600000
124800           ELSE                                                   12610000
124900                 ADD PC-ONE             TO PV-CA-TEND-VOID-NUM    12620000
125000                                           PV-GCTA-TEND-VOID-NUM  12630000
125100                 ADD SV010-APP-AUTH-AMT TO PV-CA-TEND-VOID-AMT    12640000
125200                                           PV-GCTA-TEND-VOID-AMT  12650000
125300           END-IF                                                 12660000
125400        END-IF                                                    12670000
125500      END-IF                                                      12680000
125600     END-IF.                                                      12690000
125700                                                                  12700000
125800     MOVE PV-CURR-CRD-STK-TYP-ID TO PV-PREV-CRD-STK-TYP-ID.       12710000
125900     MOVE PV-CURR-CRD-STK-TYP-DESC TO PV-PREV-CRD-STK-TYP-DESC.   12720000
126000     PERFORM D600-READ-KMRC-FILE.                                 12730000
126100     IF NOT PS-END-OF-KMRC-FILE                                   12740000
126200         MOVE SV010-CRD-STK-TYP-ID   TO PV-CURR-CRD-STK-TYP-ID    12750000
126300         MOVE SV010-CRD-STK-TYP-DESC TO PV-CURR-CRD-STK-TYP-DESC  12760000
126400         MOVE SV010-STR-NBR          TO PV-CURR-STR-NBR           12770000
126500     END-IF.                                                      12780000
126600                                                                  12790000
126700*D400-EXIT.                                                       12800000
126800                                                                  12810000
126900******************************************************************12820000
127000*     D500-PROCESS-GIFT-DETAIL                                   *12830000
127100* ==> PROCESSES:  PRINTS THE DETAIL FOR THE GIFT REPORT          *12840000
127200* ==> PERFORMED FROM:  C200-PROCESS-GIFT-REPORT                  *12850000
127300******************************************************************12860000
127400 D500-PROCESS-GIFT-DETAIL.                                        12870000
127500                                                                  12880000
127600     IF PV-CURR-CRD-STK-TYP-ID NOT = PV-PREV-CRD-STK-TYP-ID       12890000
127700        IF PS-NOT-FIRST-TIME-THRU                                 12900000
127800            PERFORM E500-WRITE-DETAIL-LINE-GIFT                   12910000
127900                VARYING PV-STORE-SUB FROM 1 BY 1                  12920000
128000                  UNTIL PV-STORE-SUB > PC-MAX-NUM-OF-STORES       12930000
128100            PERFORM D100-INITIALIZE-STORE-TOTALS                  12940000
128200                VARYING PV-STORE-SUB FROM 1 BY 1                  12950000
128300                  UNTIL PV-STORE-SUB > PC-MAX-NUM-OF-STORES       12960000
128400            PERFORM E600-WRITE-COMPANY-TOTALS-GIFT                12970000
128500            PERFORM D200-INITIALIZE-COMPANY-TOTALS                12980000
128600        END-IF                                                    12990000
128700        SET PS-NOT-FIRST-TIME-THRU  TO TRUE                       13000000
128800        MOVE SV010-CRD-STK-TYP-ID   TO PV-CURR-CRD-STK-TYP-ID     13010000
128900                                       PV-PREV-CRD-STK-TYP-ID     13020000
129000        MOVE SV010-CRD-STK-TYP-DESC TO PV-CURR-CRD-STK-TYP-DESC   13030000
129100                                       PV-PREV-CRD-STK-TYP-DESC   13040000
129200        MOVE SV010-STR-NBR          TO PV-CURR-STR-NBR            13050000
129300        MOVE ZEROS TO PA-PAGE-COUNTER-GIFT                        13060000
129400        MOVE PC-NEW-FRONT-REQUEST TO                              13070000
129500             DP250O-LASER-NEW-PAGE-INDICATR                       13080000
129600        PERFORM E400-PRINT-GIFT-HEADINGS                          13090000
129700     END-IF.                                                      13100000
129800                                                                  13110000
129900     MOVE PV-CURR-STR-NBR TO PV-STORE-SUB.                        13120000
130000                                                                  13130000
130100     IF PA-STORE-NUM(PV-STORE-SUB) > 0                            13140000
130200      IF SV010-ACTVY-TYP-CDE = SV004-ISSUE-GIFT-CRD-ACT-TYP-N     13150000
              IF (((SV010-TRN-RVRSL-CDE = SV004-REV-CDE-NORMAL) AND     13160002
               ((PA-STORE-NUM(PV-STORE-SUB)                             13170002
                          NOT = SV004-INCOMM-LOCATION))) OR             13180003
               ((PA-STORE-NUM(PV-STORE-SUB) = SV004-INCOMM-LOCATION) AND13190002
               (SV010-TRN-RVRSL-CDE = SV004-REV-CDE-NORMAL) AND         13200005
                (SV010-APP-AUTH-AMT > 0)))                              13210000
130400           IF ((PA-E-BUS-IND(PV-STORE-SUB) NOT = 'Y') OR          13220000
130500               (PA-E-BUS-IND(PV-STORE-SUB) = 'Y' AND              13230000
130600                SV010-ACTVY-STAT-CDE = SV004-STAT-NO-AUTH-CD OR   13240000
130700                SV010-ACTVY-STAT-CDE = SV004-STAT-VERIFIED-CD))   13250000
130800                 ADD PC-ONE        TO PA-ISS-TOT-NUS(PV-STORE-SUB)13260000
130900                 ADD SV010-APP-AUTH-AMT                           13270000
131000                                   TO PA-ISS-TOT-AMS(PV-STORE-SUB)13280000
131100                 ADD PC-ONE             TO PV-CT-ISS-TOT-NUM      13290000
131200                 ADD SV010-APP-AUTH-AMT TO PV-CT-ISS-TOT-AMT      13300000
131300                 IF SV010-ADDON-COUNTER > 0                       13310000
131400                    ADD PC-ONE TO PA-ISS-ADD-NUS(PV-STORE-SUB)    13320000
131500                                  PV-CT-ISS-ADD-NUM               13330000
131600                    ADD SV010-APP-AUTH-AMT                        13340000
131700                               TO PA-ISS-ADD-AMS(PV-STORE-SUB)    13350000
131800                                  PV-CT-ISS-ADD-AMT               13360000
131900                 END-IF                                           13370000
132000           ELSE                                                   13380000
132100                 ADD PC-ONE             TO PV-CA-ISS-TOT-NUM      13390000
132200                                           PV-GCTA-ISS-TOT-NUM    13400000
132300                 ADD SV010-APP-AUTH-AMT TO PV-CA-ISS-TOT-AMT      13410000
132400                                           PV-GCTA-ISS-TOT-AMT    13420000
132500                 IF SV010-ADDON-COUNTER > 0                       13430000
132600                    ADD PC-ONE TO PV-CA-ISS-ADD-NUM               13440000
132700                                  PV-GCTA-ISS-ADD-NUM             13450000
132800                    ADD SV010-APP-AUTH-AMT TO PV-CA-ISS-ADD-AMT   13460000
132900                                              PV-GCTA-ISS-ADD-AMT 13470000
133000                 END-IF                                           13480000
133100           END-IF                                                 13490000
133200        ELSE                                                      13500000
133300           IF ((PA-E-BUS-IND(PV-STORE-SUB) NOT = 'Y') OR          13510000
133400               (PA-E-BUS-IND(PV-STORE-SUB) = 'Y' AND              13520000
133500                SV010-ACTVY-STAT-CDE = SV004-STAT-NO-AUTH-CD OR   13530000
133600                SV010-ACTVY-STAT-CDE = SV004-STAT-VERIFIED-CD))   13540000
133700                 ADD PC-ONE       TO PA-ISS-VOID-NUS(PV-STORE-SUB)13550000
133800                 ADD SV010-APP-AUTH-AMT                           13560000
133900                                  TO PA-ISS-VOID-AMS(PV-STORE-SUB)13570000
134000                 ADD PC-ONE             TO PV-CT-ISS-VOID-NUM     13580000
134100                 ADD SV010-APP-AUTH-AMT TO PV-CT-ISS-VOID-AMT     13590000
134200           ELSE                                                   13600000
134300                 ADD PC-ONE             TO PV-CA-ISS-VOID-NUM     13610000
134400                                           PV-GCTA-ISS-VOID-NUM   13620000
134500                 ADD SV010-APP-AUTH-AMT TO PV-CA-ISS-VOID-AMT     13630000
134600                                           PV-GCTA-ISS-VOID-AMT   13640000
134700           END-IF                                                 13650000
134800        END-IF                                                    13660000
134900     ELSE                                                         13670000
135000        IF SV010-TRN-RVRSL-CDE = SV004-REV-CDE-NORMAL             13680000
135100           IF ((PA-E-BUS-IND(PV-STORE-SUB) NOT = 'Y') OR          13690000
135200               (PA-E-BUS-IND(PV-STORE-SUB) = 'Y' AND              13700000
135300                SV010-ACTVY-STAT-CDE = SV004-STAT-NO-AUTH-CD OR   13710000
135400                SV010-ACTVY-STAT-CDE = SV004-STAT-VERIFIED-CD))   13720000
135500                 ADD PC-ONE       TO PA-TEND-TOT-NUS(PV-STORE-SUB)13730000
135600                 ADD SV010-APP-AUTH-AMT                           13740000
135700                                  TO PA-TEND-TOT-AMS(PV-STORE-SUB)13750000
135800                 ADD PC-ONE             TO PV-CT-TEND-TOT-NUM     13760000
135900                 ADD SV010-APP-AUTH-AMT TO PV-CT-TEND-TOT-AMT     13770000
136000           ELSE                                                   13780000
136100                 ADD PC-ONE             TO PV-CA-TEND-TOT-NUM     13790000
136200                                           PV-GCTA-TEND-TOT-NUM   13800000
136300                 ADD SV010-APP-AUTH-AMT TO PV-CA-TEND-TOT-AMT     13810000
136400                                           PV-GCTA-TEND-TOT-AMT   13820000
136500           END-IF                                                 13830000
136600        ELSE                                                      13840000
136700           IF ((PA-E-BUS-IND(PV-STORE-SUB) NOT = 'Y') OR          13850000
136800               (PA-E-BUS-IND(PV-STORE-SUB) = 'Y' AND              13860000
136900                SV010-ACTVY-STAT-CDE = SV004-STAT-NO-AUTH-CD OR   13870000
137000                SV010-ACTVY-STAT-CDE = SV004-STAT-VERIFIED-CD))   13880000
137100                 ADD PC-ONE      TO PA-TEND-VOID-NUS(PV-STORE-SUB)13890000
137200                 ADD SV010-APP-AUTH-AMT                           13900000
137300                                 TO PA-TEND-VOID-AMS(PV-STORE-SUB)13910000
137400                 ADD PC-ONE             TO PV-CT-TEND-VOID-NUM    13920000
137500                 ADD SV010-APP-AUTH-AMT TO PV-CT-TEND-VOID-AMT    13930000
137600           ELSE                                                   13940000
137700                 ADD PC-ONE             TO PV-CA-TEND-VOID-NUM    13950000
137800                                        PV-GCTA-TEND-VOID-NUM     13960000
137900              ADD SV010-APP-AUTH-AMT TO PV-CA-TEND-VOID-AMT       13970000
138000                                        PV-GCTA-TEND-VOID-AMT     13980000
138100           END-IF                                                 13990000
138200        END-IF                                                    14000000
138300      END-IF                                                      14010000
138400     END-IF.                                                      14020000
138500                                                                  14030000
138600     MOVE PV-CURR-CRD-STK-TYP-ID TO PV-PREV-CRD-STK-TYP-ID.       14040000
138700     MOVE PV-CURR-CRD-STK-TYP-DESC TO PV-PREV-CRD-STK-TYP-DESC.   14050000
138800                                                                  14060000
138900     PERFORM D700-READ-GIFT-FILE.                                 14070000
139000                                                                  14080000
139100     IF NOT PS-END-OF-GIFT-FILE                                   14090000
139200         MOVE SV010-CRD-STK-TYP-ID   TO PV-CURR-CRD-STK-TYP-ID    14100000
139300         MOVE SV010-CRD-STK-TYP-DESC TO PV-CURR-CRD-STK-TYP-DESC  14110000
139400         MOVE SV010-STR-NBR          TO PV-CURR-STR-NBR           14120000
139500     END-IF.                                                      14130000
139600                                                                  14140000
139700*D500-EXIT.                                                       14150000
139800                                                                  14160000
139900******************************************************************14170000
140000*     D600-READ-KMRC-FILE                                        *14180000
140100* ==> PROCESSES: READ KMRC FILE                                  *14190000
140200* ==> PERFORMED FROM: D400-PROCESS-KMRC-DETAIL                   *14200000
140300******************************************************************14210000
140400 D600-READ-KMRC-FILE.                                             14220000
140500     READ KMRC-FILE INTO SV010-RECORD                             14230000
140600          AT END SET PS-END-OF-KMRC-FILE TO TRUE.                 14240000
140700                                                                  14250000
140800*D600-EXIT.                                                       14260000
140900******************************************************************14270000
141000*     D700-READ-GIFT-FILE                                        *14280000
141100* ==> PROCESSES: READ GIFT FILE                                  *14290000
141200* ==> PERFORMED FROM: D500-PROCESS-GIFT-DETAIL                   *14300000
141300******************************************************************14310000
141400 D700-READ-GIFT-FILE.                                             14320000
141500     READ GIFT-FILE INTO SV010-RECORD                             14330000
141600          AT END SET PS-END-OF-GIFT-FILE TO TRUE.                 14340000
141700                                                                  14350000
141800*D700-EXIT.                                                       14360000
141900******************************************************************14370000
142000*     E100-PRINT-KMRC-HEADINGS                                   *14380000
142100* ==> PROCESSES:  PRINTS THE HEADINGS FOR THE KMRC REPORT        *14390000
142200* ==> PERFORMED FROM:  C100-PROCESS-KMRC-REPORT                  *14400000
142300*                      C200-PROCESS-GIFT-REPORT                  *14410000
142400*                      D400-PROCESS-KMRC-DETAIL                  *14420000
142500*                      D500-PROCESS-GIFT-DETAIL                  *14430000
142600******************************************************************14440000
142700 E100-PRINT-KMRC-HEADINGS.                                        14450000
142800                                                                  14460000
142900     ADD PC-ONE                       TO PA-PAGE-COUNTER-KMRC.    14470000
143000     MOVE PA-PAGE-COUNTER-KMRC        TO DP250O-PAGE-NUMBER.      14480000
143100     MOVE PC-TWO                      TO DP250O-REPORT-NUMBER.    14490000
143200     MOVE PC-PROGRAM-NAME             TO DP250O-PROGRAM-NAME.     14500000
143300     MOVE PV-PREV-CRD-STK-TYP-ID      TO RTL-KMRC-CRD-STK-ID.     14510000
143400     MOVE PV-PREV-CRD-STK-TYP-DESC    TO RSL-CRD-STK-ID-DESC.     14520000
143500                                                                  14530000
143600     WRITE KMRC-REPORT-RECORD                                     14540000
143700         FROM DP250O-STANDRD-HEADER-250-COLS                      14550000
143800         AFTER ADVANCING PAGE.                                    14560000
143900     INITIALIZE DP250O-LASER-NEW-PAGE-INDICATR.                   14570000
144000     WRITE KMRC-REPORT-RECORD FROM REPORT-TITLE-LINE-KMRC         14580000
144100         AFTER ADVANCING 1 LINE.                                  14590000
144200     WRITE KMRC-REPORT-RECORD FROM REPORT-SUBTITLE-LINE           14600000
144300         AFTER ADVANCING 1 LINE.                                  14610000
144400     WRITE KMRC-REPORT-RECORD FROM REPORT-DETAIL-HEADER-1         14620000
144500         AFTER ADVANCING 1 LINE.                                  14630000
144600     WRITE KMRC-REPORT-RECORD FROM REPORT-DETAIL-DASH-LINE        14640000
144700         AFTER ADVANCING 1 LINE.                                  14650000
144800     WRITE KMRC-REPORT-RECORD FROM REPORT-DETAIL-HEADER-2         14660000
144900         AFTER ADVANCING 1 LINE.                                  14670000
145000     WRITE KMRC-REPORT-RECORD FROM REPORT-DETAIL-HEADER-3         14680000
145100         AFTER ADVANCING 1 LINE.                                  14690000
145200     MOVE PC-HEADER-LINE-COUNT        TO PA-LINE-COUNTER-KMRC.    14700000
145300                                                                  14710000
145400*E100-EXIT.                                                       14720000
145500                                                                  14730000
145600******************************************************************14740000
145700*     E200-WRITE-DETAIL-LINE-KMRC                                *14750000
145800* ==> PROCESSES:  WRITES THE DETAIL LINE                         *14760000
145900* ==> PERFORMED FROM:  E100-PRINT-KMRC-HEADINGS                  *14770000
146000*                      C100-PROCESS-KMRC-REPORT                  *14780000
146100*                      D400-PROCESS-KMRC-DETAIL                  *14790000
146200******************************************************************14800000
146300 E200-WRITE-DETAIL-LINE-KMRC.                                     14810000
146400                                                                  14820000
146500     IF PA-STORE-NUM(PV-STORE-SUB) > 0                            14830000
146600         MOVE PA-STORE-NAME(PV-STORE-SUB) TO RDL-STORE-NME        14840000
146700         MOVE PA-STORE-NUM(PV-STORE-SUB) TO RDL-STORE-NBR         14850000
146800                                                                  14860000
146900         MOVE PA-ISS-TOT-NUS(PV-STORE-SUB) TO RDL-ISSUE-TOT-NUMBER14870000
147000         MOVE PA-ISS-TOT-AMS(PV-STORE-SUB) TO RDL-ISSUE-TOT-AMOUNT14880000
147100         MOVE PA-ISS-ADD-NUS(PV-STORE-SUB) TO RDL-ISSUE-ADD-NUMBER14890000
147200         MOVE PA-ISS-ADD-AMS(PV-STORE-SUB) TO RDL-ISSUE-ADD-AMOUNT14900000
147300         MOVE PA-ISS-VOID-NUS(PV-STORE-SUB)                       14910000
147400                                          TO RDL-ISSUE-VOID-NUMBER14920000
147500         MOVE PA-ISS-VOID-AMS(PV-STORE-SUB)                       14930000
147600                                          TO RDL-ISSUE-VOID-AMOUNT14940000
147700         COMPUTE PA-ISS-NET-NUS(PV-STORE-SUB)                     14950000
147800                                =   PA-ISS-TOT-NUS(PV-STORE-SUB) -14960000
147900                                    PA-ISS-VOID-NUS(PV-STORE-SUB) 14970000
148000         COMPUTE PA-ISS-NET-AMS(PV-STORE-SUB)                     14980000
148100                                =   PA-ISS-TOT-AMS(PV-STORE-SUB) +14990000
148200                                    PA-ISS-VOID-AMS(PV-STORE-SUB) 15000000
148300         MOVE PA-ISS-NET-NUS(PV-STORE-SUB) TO RDL-ISSUE-NET-NUMBER15010000
148400         MOVE PA-ISS-NET-AMS(PV-STORE-SUB) TO RDL-ISSUE-NET-AMOUNT15020000
148500         MOVE PA-TEND-TOT-NUS(PV-STORE-SUB) TO RDL-TEND-TOT-NUMBER15030000
148600         MOVE PA-TEND-TOT-AMS(PV-STORE-SUB) TO RDL-TEND-TOT-AMOUNT15040000
148700         MOVE PA-TEND-VOID-NUS(PV-STORE-SUB)                      15050000
148800                                           TO RDL-TEND-VOID-NUMBER15060000
148900         MOVE PA-TEND-VOID-AMS(PV-STORE-SUB)                      15070000
149000                                           TO RDL-TEND-VOID-AMOUNT15080000
149100         COMPUTE PA-TEND-NET-NUS(PV-STORE-SUB)                    15090000
149200                                 = PA-TEND-TOT-NUS(PV-STORE-SUB) -15100000
149300                                   PA-TEND-VOID-NUS(PV-STORE-SUB) 15110000
149400         COMPUTE PA-TEND-NET-AMS(PV-STORE-SUB)                    15120000
149500                                 = PA-TEND-TOT-AMS(PV-STORE-SUB) +15130000
149600                                   PA-TEND-VOID-AMS(PV-STORE-SUB) 15140000
149700         MOVE PA-TEND-NET-NUS(PV-STORE-SUB) TO RDL-TEND-NET-NUMBER15150000
149800         MOVE PA-TEND-NET-AMS(PV-STORE-SUB) TO RDL-TEND-NET-AMOUNT15160000
149900         COMPUTE PV-NET-VARIANCE-AMT                              15170000
150000                              = PA-ISS-NET-AMS(PV-STORE-SUB) +    15180000
150100                                PA-TEND-NET-AMS(PV-STORE-SUB)     15190000
150200         MOVE PV-NET-VARIANCE-AMT TO RDL-NET-VARIANCE-AMOUNT      15200000
150300                                                                  15210000
150400         IF PA-LINE-COUNTER-KMRC > PC-MAX-LINE-PER-PAGE           15220000
150500             MOVE SPACES TO DP250O-LASER-NEW-PAGE-INDICATR        15230000
150600             PERFORM E100-PRINT-KMRC-HEADINGS                     15240000
150700         END-IF                                                   15250000
150800                                                                  15260000
150900         WRITE KMRC-REPORT-RECORD FROM REPORT-DETAIL-LINE         15270000
151000             AFTER ADVANCING 1 LINE                               15280000
151100                                                                  15290000
151200         ADD PC-ONE TO PA-LINE-COUNTER-KMRC                       15300000
151300                                                                  15310000
151400         PERFORM E210-WRITE-DETAIL-LINE-PURCH                     15320000
151500     END-IF.                                                      15330000
151600                                                                  15340000
151700*E200-EXIT.                                                       15350000
151800                                                                  15360000
151900******************************************************************15370000
152000* WRITE THE PURCHASING DETAIL LINES                              *15380000
152100*  - SUBTRACT THE NUMBER OF ADD-ON CARDS FROM THE NBR OF ISSUES  *15390000
152200******************************************************************15400000
152300 E210-WRITE-DETAIL-LINE-PURCH.                                    15410000
152400                                                                  15420000
152500     MOVE PV-CURR-CRD-STK-TYP-ID     TO SV023-CRD-STK-TYP.        15430000
152600     MOVE PA-STORE-NUM(PV-STORE-SUB) TO SV023-STR-NBR.            15440000
152700                                                                  15450000
152800     SUBTRACT PA-ISS-ADD-NUS(PV-STORE-SUB)                        15460000
152900       FROM PA-ISS-TOT-NUS(PV-STORE-SUB) GIVING SV023-ISSUE-COUNT.15470000
153000                                                                  15480000
153100     IF  SV023-ISSUE-COUNT = ZERO                                 15490000
153200         CONTINUE                                                 15500000
153300     ELSE                                                         15510000
153400         WRITE PURCH-FILE-RECORD                                  15520000
153500                        FROM SV023-KMCACT-EXTRACT-RECORD          15530000
153600                                                                  15540000
153700         ADD PC-ONE TO PA-PURCH-COUNTER                           15550000
153800                                                                  15560000
153900     END-IF.                                                      15570000
154000                                                                  15580000
154100*E210-EXIT.                                                       15590000
154200                                                                  15600000
154300******************************************************************15610000
154400*     E300-WRITE-COMPANY-TOTALS-KMRC                             *15620000
154500* ==> PROCESSES:  WRITES THE COMPANY TOTAL LINE FOR EACH CARD STK*15630000
154600* ==> PERFORMED FROM:  E100-PRINT-KMRC-HEADINGS                  *15640000
154700*                      C100-PROCESS-KMRC-REPORT                  *15650000
154800*                      D400-PROCESS-KMRC-DETAIL                  *15660000
154900******************************************************************15670000
155000 E300-WRITE-COMPANY-TOTALS-KMRC.                                  15680000
155100                                                                  15690000
155200     INITIALIZE REPORT-TOTAL-LINE.                                15700000
155300     MOVE 'ECOMM AUTH:'            TO TL-LINE-NAME.               15710000
155400     MOVE PV-CA-ISS-TOT-NUM        TO TL-ISSUE-TOT-NUMBER.        15720000
155500     MOVE PV-CA-ISS-TOT-AMT        TO TL-ISSUE-TOT-AMOUNT.        15730000
155600     MOVE PV-CA-ISS-ADD-NUM        TO TL-ISSUE-ADD-NUMBER.        15740000
155700     MOVE PV-CA-ISS-ADD-AMT        TO TL-ISSUE-ADD-AMOUNT.        15750000
155800     MOVE PV-CA-ISS-VOID-NUM       TO TL-ISSUE-VOID-NUMBER.       15760000
155900     MOVE PV-CA-ISS-VOID-AMT       TO TL-ISSUE-VOID-AMOUNT.       15770000
156000     COMPUTE PV-CA-ISS-NET-NUM =   PV-CA-ISS-TOT-NUM -            15780000
156100                                   PV-CA-ISS-VOID-NUM.            15790000
156200     COMPUTE PV-CA-ISS-NET-AMT =   PV-CA-ISS-TOT-AMT +            15800000
156300                                   PV-CA-ISS-VOID-AMT.            15810000
156400     MOVE PV-CA-ISS-NET-NUM        TO TL-ISSUE-NET-NUMBER.        15820000
156500     MOVE PV-CA-ISS-NET-AMT        TO TL-ISSUE-NET-AMOUNT.        15830000
156600     MOVE PV-CA-TEND-TOT-NUM       TO TL-TEND-TOT-NUMBER.         15840000
156700     MOVE PV-CA-TEND-TOT-AMT       TO TL-TEND-TOT-AMOUNT.         15850000
156800     MOVE PV-CA-TEND-VOID-NUM      TO TL-TEND-VOID-NUMBER.        15860000
156900     MOVE PV-CA-TEND-VOID-AMT      TO TL-TEND-VOID-AMOUNT.        15870000
157000     COMPUTE PV-CA-TEND-NET-NUM =  PV-CA-TEND-TOT-NUM -           15880000
157100                                   PV-CA-TEND-VOID-NUM.           15890000
157200     COMPUTE PV-CA-TEND-NET-AMT =  PV-CA-TEND-TOT-AMT +           15900000
157300                                   PV-CA-TEND-VOID-AMT.           15910000
157400     MOVE PV-CA-TEND-NET-NUM       TO TL-TEND-NET-NUMBER.         15920000
157500     MOVE PV-CA-TEND-NET-AMT       TO TL-TEND-NET-AMOUNT.         15930000
157600     COMPUTE PV-CA-VARIANCE-AMT = PV-CA-ISS-NET-AMT +             15940000
157700                                  PV-CA-TEND-NET-AMT.             15950000
157800     MOVE PV-CA-VARIANCE-AMT      TO TL-NET-VARIANCE-AMOUNT.      15960000
157900                                                                  15970000
158000     IF PA-LINE-COUNTER-KMRC > PC-MAX-LINE-BEFORE-TOT             15980000
158100        MOVE SPACES TO DP250O-LASER-NEW-PAGE-INDICATR             15990000
158200        PERFORM E100-PRINT-KMRC-HEADINGS                          16000000
158300     END-IF.                                                      16010000
158400     WRITE KMRC-REPORT-RECORD FROM REPORT-TOTAL-LINE              16020000
158500        AFTER ADVANCING 2 LINES.                                  16030000
158600                                                                  16040000
158700     INITIALIZE REPORT-TOTAL-LINE.                                16050000
158800                                                                  16060000
158900     MOVE 'COMPANY TOTAL:'    TO TL-LINE-NAME.                    16070000
159000     COMPUTE PV-CT-ISS-TOT-NUM =   PV-CT-ISS-TOT-NUM +            16080000
159100                                   PV-CA-ISS-TOT-NUM.             16090000
159200     COMPUTE PV-CT-ISS-TOT-AMT =   PV-CT-ISS-TOT-AMT +            16100000
159300                                   PV-CA-ISS-TOT-AMT.             16110000
159400     COMPUTE PV-CT-ISS-ADD-NUM =   PV-CT-ISS-ADD-NUM +            16120000
159500                                   PV-CA-ISS-ADD-NUM.             16130000
159600     COMPUTE PV-CT-ISS-ADD-AMT =   PV-CT-ISS-ADD-AMT +            16140000
159700                                   PV-CA-ISS-ADD-AMT.             16150000
159800     COMPUTE PV-CT-ISS-VOID-NUM =  PV-CT-ISS-VOID-NUM +           16160000
159900                                   PV-CA-ISS-VOID-NUM.            16170000
160000     COMPUTE PV-CT-ISS-VOID-AMT =  PV-CT-ISS-VOID-AMT +           16180000
160100                                   PV-CA-ISS-VOID-AMT.            16190000
160200     COMPUTE PV-CT-ISS-NET-NUM =   PV-CT-ISS-TOT-NUM -            16200000
160300                                   PV-CT-ISS-VOID-NUM.            16210000
160400     COMPUTE PV-CT-ISS-NET-AMT =   PV-CT-ISS-TOT-AMT +            16220000
160500                                   PV-CT-ISS-VOID-AMT.            16230000
160600     MOVE PV-CT-ISS-TOT-NUM        TO TL-ISSUE-TOT-NUMBER.        16240000
160700     MOVE PV-CT-ISS-TOT-AMT        TO TL-ISSUE-TOT-AMOUNT.        16250000
160800     MOVE PV-CT-ISS-ADD-NUM        TO TL-ISSUE-ADD-NUMBER.        16260000
160900     MOVE PV-CT-ISS-ADD-AMT        TO TL-ISSUE-ADD-AMOUNT.        16270000
161000     MOVE PV-CT-ISS-VOID-NUM       TO TL-ISSUE-VOID-NUMBER.       16280000
161100     MOVE PV-CT-ISS-VOID-AMT       TO TL-ISSUE-VOID-AMOUNT.       16290000
161200     MOVE PV-CT-ISS-NET-NUM        TO TL-ISSUE-NET-NUMBER.        16300000
161300     MOVE PV-CT-ISS-NET-AMT        TO TL-ISSUE-NET-AMOUNT.        16310000
161400     COMPUTE PV-CT-TEND-TOT-NUM  = PV-CT-TEND-TOT-NUM +           16320000
161500                                   PV-CA-TEND-TOT-NUM.            16330000
161600     COMPUTE PV-CT-TEND-TOT-AMT  = PV-CT-TEND-TOT-AMT +           16340000
161700                                   PV-CA-TEND-TOT-AMT.            16350000
161800     COMPUTE PV-CT-TEND-VOID-NUM = PV-CT-TEND-VOID-NUM +          16360000
161900                                   PV-CA-TEND-VOID-NUM.           16370000
162000     COMPUTE PV-CT-TEND-VOID-AMT = PV-CT-TEND-VOID-AMT +          16380000
162100                                   PV-CA-TEND-VOID-AMT.           16390000
162200     COMPUTE PV-CT-TEND-NET-NUM =  PV-CT-TEND-TOT-NUM -           16400000
162300                                   PV-CT-TEND-VOID-NUM.           16410000
162400     COMPUTE PV-CT-TEND-NET-AMT =  PV-CT-TEND-TOT-AMT +           16420000
162500                                   PV-CT-TEND-VOID-AMT.           16430000
162600     MOVE PV-CT-TEND-TOT-NUM       TO TL-TEND-TOT-NUMBER.         16440000
162700     MOVE PV-CT-TEND-TOT-AMT       TO TL-TEND-TOT-AMOUNT.         16450000
162800     MOVE PV-CT-TEND-VOID-NUM      TO TL-TEND-VOID-NUMBER.        16460000
162900     MOVE PV-CT-TEND-VOID-AMT      TO TL-TEND-VOID-AMOUNT.        16470000
163000     MOVE PV-CT-TEND-NET-NUM       TO TL-TEND-NET-NUMBER.         16480000
163100     MOVE PV-CT-TEND-NET-AMT       TO TL-TEND-NET-AMOUNT.         16490000
163200     COMPUTE PV-NET-VARIANCE-AMT = PV-CT-ISS-NET-AMT +            16500000
163300                                   PV-CT-TEND-NET-AMT.            16510000
163400     MOVE PV-NET-VARIANCE-AMT      TO TL-NET-VARIANCE-AMOUNT.     16520000
163500                                                                  16530000
163600     WRITE KMRC-REPORT-RECORD FROM REPORT-TOTAL-LINE              16540000
163700        AFTER ADVANCING 1 LINES.                                  16550000
163800     WRITE KMRC-REPORT-RECORD FROM REPORT-END-OF-REPORT-LINE      16560000
163900        AFTER ADVANCING 3 LINES.                                  16570000
164000     MOVE ZEROS TO PA-LINE-COUNTER-KMRC.                          16580000
164100                                                                  16590000
164200*E300-EXIT.                                                       16600000
164300                                                                  16610000
164400******************************************************************16620000
164500*     E400-PRINT-GIFT-HEADINGS                                   *16630000
164600* ==> PROCESSES:  PRINTS THE HEADINGS FOR THE GIFT REPORT        *16640000
164700* ==> PERFORMED FROM:  C200-PROCESS-GIFT-REPORT                  *16650000
164800*                      D500-PROCESS-GIFT-DETAIL                  *16660000
164900*                      E400-PRINT-GIFT-HEADINGS                  *16670000
165000******************************************************************16680000
165100 E400-PRINT-GIFT-HEADINGS.                                        16690000
165200                                                                  16700000
165300     ADD PC-ONE                       TO PA-PAGE-COUNTER-GIFT.    16710000
165400     MOVE PA-PAGE-COUNTER-GIFT        TO DP250O-PAGE-NUMBER.      16720000
165500     MOVE PC-ONE                      TO DP250O-REPORT-NUMBER.    16730000
165600     MOVE PC-PROGRAM-NAME             TO DP250O-PROGRAM-NAME.     16740000
165700     MOVE PV-PREV-CRD-STK-TYP-ID      TO RTL-GC-CRD-STK-ID.       16750000
165800     MOVE PV-PREV-CRD-STK-TYP-DESC    TO RSL-CRD-STK-ID-DESC.     16760000
165900                                                                  16770000
166000     WRITE GIFT-REPORT-RECORD                                     16780000
166100         FROM DP250O-STANDRD-HEADER-250-COLS                      16790000
166200         AFTER ADVANCING PAGE.                                    16800000
166300     INITIALIZE DP250O-LASER-NEW-PAGE-INDICATR.                   16810000
166400     WRITE GIFT-REPORT-RECORD FROM REPORT-TITLE-LINE-GC           16820000
166500         AFTER ADVANCING 1 LINE.                                  16830000
166600     WRITE GIFT-REPORT-RECORD FROM REPORT-SUBTITLE-LINE           16840000
166700         AFTER ADVANCING 1 LINE.                                  16850000
166800     WRITE GIFT-REPORT-RECORD FROM REPORT-DETAIL-HEADER-1         16860000
166900         AFTER ADVANCING 1 LINE.                                  16870000
167000     WRITE GIFT-REPORT-RECORD FROM REPORT-DETAIL-DASH-LINE        16880000
167100         AFTER ADVANCING 1 LINE.                                  16890000
167200     WRITE GIFT-REPORT-RECORD FROM REPORT-DETAIL-HEADER-2         16900000
167300         AFTER ADVANCING 1 LINE.                                  16910000
167400     WRITE GIFT-REPORT-RECORD FROM REPORT-DETAIL-HEADER-3         16920000
167500         AFTER ADVANCING 1 LINE.                                  16930000
167600     MOVE PC-HEADER-LINE-COUNT        TO PA-LINE-COUNTER-GIFT.    16940000
167700                                                                  16950000
167800*E400-EXIT.                                                       16960000
167900                                                                  16970000
168000******************************************************************16980000
168100*     E401-PRINT-NET-GIFT-HEADINGS                               *16990000
168200* ==> PROCESSES:  PRINTS THE HEADINGS FOR THE NET GIFT REPORT    *17000000
168300* ==> PERFORMED FROM:  C200-PROCESS-GIFT-REPORT                  *17010000
168400*                      E600-WRITE-COMPANY-TOTALS-GIFT            *17020000
168500******************************************************************17030000
168600 E401-PRINT-NET-GIFT-HEADINGS.                                    17040000
168700                                                                  17050000
168800     ADD PC-ONE                       TO PA-PAGE-COUNTER-NET-GIFT.17060000
168900     MOVE PA-PAGE-COUNTER-NET-GIFT    TO DP132-PAGE-NUMBER.       17070000
169000     MOVE PC-THREE                    TO DP132-REPORT-NUMBER.     17080000
169100     MOVE PC-PROGRAM-NAME             TO DP132-PROGRAM-NAME.      17090000
169200     MOVE RSL-REPORT-DATE-RANGE       TO NET-REPORT-DATE-RANGE.   17100000
169300                                                                  17110000
169400     WRITE NET-GIFT-REPORT-RECORD                                 17120000
169500         FROM DP132-STANDRD-HEADER-132-COLS                       17130000
169600         AFTER ADVANCING PAGE.                                    17140000
169700     INITIALIZE DP132-LASER-NEW-PAGE-INDICATR.                    17150000
169800     WRITE NET-GIFT-REPORT-RECORD FROM NET-REPORT-DETAIL-HEADER-1 17160000
169900         AFTER ADVANCING 1 LINE.                                  17170000
170000     WRITE NET-GIFT-REPORT-RECORD FROM NET-REPORT-SUBTITLE-LINE   17180000
170100         AFTER ADVANCING 1 LINE.                                  17190000
170200     WRITE NET-GIFT-REPORT-RECORD FROM NET-REPORT-DETAIL-HEADER-2 17200000
170300         AFTER ADVANCING 1 LINE.                                  17210000
170400     WRITE NET-GIFT-REPORT-RECORD FROM NET-REPORT-DETAIL-DASH-LINE17220000
170500         AFTER ADVANCING 1 LINE.                                  17230000
170600     WRITE NET-GIFT-REPORT-RECORD FROM NET-REPORT-DETAIL-HEADER-3 17240000
170700         AFTER ADVANCING 1 LINE.                                  17250000
170800     WRITE NET-GIFT-REPORT-RECORD FROM NET-REPORT-DETAIL-HEADER-4 17260000
170900         AFTER ADVANCING 1 LINE.                                  17270000
171000     WRITE NET-GIFT-REPORT-RECORD FROM NET-REPORT-DASH-HEADER     17280000
171100         AFTER ADVANCING 1 LINE.                                  17290000
171200                                                                  17300000
171300******************************************************************17310000
171400*     E500-WRITE-DETAIL-LINE-GIFT                                *17320000
171500* ==> PROCESSES:  WRITES THE DETAIL LINE FOR GIFT CARD REPORT    *17330000
171600* ==> PERFORMED FROM:  C200-PROCESS-GIFT-REPORT                  *17340000
171700*                      D500-PROCESS-GIFT-DETAIL                  *17350000
171800*                      E400-PRINT-GIFT-HEADINGS                  *17360000
171900******************************************************************17370000
172000 E500-WRITE-DETAIL-LINE-GIFT.                                     17380000
172100                                                                  17390000
172200     IF PA-STORE-NUM(PV-STORE-SUB) > 0                            17400000
172300         MOVE PA-STORE-NAME(PV-STORE-SUB) TO RDL-STORE-NME        17410000
172400         MOVE PA-STORE-NUM(PV-STORE-SUB) TO RDL-STORE-NBR         17420000
172500                                                                  17430000
172600         MOVE PA-ISS-TOT-NUS(PV-STORE-SUB) TO RDL-ISSUE-TOT-NUMBER17440000
172700         MOVE PA-ISS-TOT-AMS(PV-STORE-SUB) TO RDL-ISSUE-TOT-AMOUNT17450000
172800         MOVE PA-ISS-ADD-NUS(PV-STORE-SUB) TO RDL-ISSUE-ADD-NUMBER17460000
172900         MOVE PA-ISS-ADD-AMS(PV-STORE-SUB) TO RDL-ISSUE-ADD-AMOUNT17470000
173000         MOVE PA-ISS-VOID-NUS(PV-STORE-SUB)                       17480000
173100                                          TO RDL-ISSUE-VOID-NUMBER17490000
173200         MOVE PA-ISS-VOID-AMS(PV-STORE-SUB)                       17500000
173300                                          TO RDL-ISSUE-VOID-AMOUNT17510000
173400         COMPUTE PA-ISS-NET-NUS(PV-STORE-SUB) =                   17520000
173500                                   PA-ISS-TOT-NUS(PV-STORE-SUB) - 17530000
173600                                   PA-ISS-VOID-NUS(PV-STORE-SUB)  17540000
173700         COMPUTE PA-ISS-NET-AMS(PV-STORE-SUB) =                   17550000
173800                                   PA-ISS-TOT-AMS(PV-STORE-SUB) + 17560000
173900                                   PA-ISS-VOID-AMS(PV-STORE-SUB)  17570000
174000         MOVE PA-ISS-NET-NUS(PV-STORE-SUB) TO RDL-ISSUE-NET-NUMBER17580000
174100         MOVE PA-ISS-NET-AMS(PV-STORE-SUB) TO RDL-ISSUE-NET-AMOUNT17590000
174200         MOVE PA-TEND-TOT-NUS(PV-STORE-SUB) TO RDL-TEND-TOT-NUMBER17600000
174300         MOVE PA-TEND-TOT-AMS(PV-STORE-SUB) TO RDL-TEND-TOT-AMOUNT17610000
174400         MOVE PA-TEND-VOID-NUS(PV-STORE-SUB)                      17620000
174500                                           TO RDL-TEND-VOID-NUMBER17630000
174600         MOVE PA-TEND-VOID-AMS(PV-STORE-SUB)                      17640000
174700                                           TO RDL-TEND-VOID-AMOUNT17650000
174800         COMPUTE PA-TEND-NET-NUS(PV-STORE-SUB) =                  17660000
174900                                PA-TEND-TOT-NUS(PV-STORE-SUB) -   17670000
175000                                PA-TEND-VOID-NUS(PV-STORE-SUB)    17680000
175100         COMPUTE PA-TEND-NET-AMS(PV-STORE-SUB) =                  17690000
175200                                PA-TEND-TOT-AMS(PV-STORE-SUB) +   17700000
175300                                PA-TEND-VOID-AMS(PV-STORE-SUB)    17710000
175400         MOVE PA-TEND-NET-NUS(PV-STORE-SUB) TO RDL-TEND-NET-NUMBER17720000
175500         MOVE PA-TEND-NET-AMS(PV-STORE-SUB) TO RDL-TEND-NET-AMOUNT17730000
175600         COMPUTE PV-NET-VARIANCE-AMT =                            17740000
175700                                   PA-ISS-NET-AMS(PV-STORE-SUB) + 17750000
175800                                   PA-TEND-NET-AMS(PV-STORE-SUB)  17760000
175900         MOVE PV-NET-VARIANCE-AMT TO RDL-NET-VARIANCE-AMOUNT      17770000
176000                                                                  17780000
176100         IF PA-LINE-COUNTER-GIFT > PC-MAX-LINE-PER-PAGE           17790000
176200             MOVE SPACES TO DP250O-LASER-NEW-PAGE-INDICATR        17800000
176300             PERFORM E400-PRINT-GIFT-HEADINGS                     17810000
176400         END-IF                                                   17820000
176500                                                                  17830000
176600         WRITE GIFT-REPORT-RECORD FROM REPORT-DETAIL-LINE         17840000
176700             AFTER ADVANCING 1 LINE                               17850000
176800                                                                  17860000
176900         ADD  PA-ISS-TOT-NUS(PV-STORE-SUB)                        17870000
177000                             TO PA-ISS-TOT-NUM(PV-STORE-SUB)      17880000
177100         ADD  PA-ISS-TOT-AMS(PV-STORE-SUB)                        17890000
177200                             TO PA-ISS-TOT-AMT(PV-STORE-SUB)      17900000
177300         ADD  PA-ISS-ADD-NUS(PV-STORE-SUB)                        17910000
177400                             TO PA-ISS-ADD-NUM(PV-STORE-SUB)      17920000
177500         ADD  PA-ISS-ADD-AMS(PV-STORE-SUB)                        17930000
177600                             TO PA-ISS-ADD-AMT(PV-STORE-SUB)      17940000
177700         ADD  PA-ISS-VOID-NUS(PV-STORE-SUB)                       17950000
177800                             TO PA-ISS-VOID-NUM(PV-STORE-SUB)     17960000
177900         ADD  PA-ISS-VOID-AMS(PV-STORE-SUB)                       17970000
178000                             TO PA-ISS-VOID-AMT(PV-STORE-SUB)     17980000
178100         ADD  PA-ISS-NET-NUS(PV-STORE-SUB)                        17990000
178200                     TO PA-ISS-NET-NUM(PV-STORE-SUB)              18000000
178300         ADD  PA-ISS-NET-AMS(PV-STORE-SUB)                        18010000
178400                     TO PA-ISS-NET-AMT(PV-STORE-SUB)              18020000
178500         ADD  PA-TEND-TOT-NUS(PV-STORE-SUB)                       18030000
178600                     TO PA-TEND-TOT-NUM(PV-STORE-SUB)             18040000
178700         ADD  PA-TEND-TOT-AMS(PV-STORE-SUB)                       18050000
178800                     TO PA-TEND-TOT-AMT(PV-STORE-SUB)             18060000
178900         ADD  PA-TEND-VOID-NUS(PV-STORE-SUB)                      18070000
179000                     TO PA-TEND-VOID-NUM(PV-STORE-SUB)            18080000
179100         ADD  PA-TEND-VOID-AMS(PV-STORE-SUB)                      18090000
179200                     TO PA-TEND-VOID-AMT(PV-STORE-SUB)            18100000
179300         ADD  PA-TEND-NET-NUS(PV-STORE-SUB)                       18110000
179400                     TO PA-TEND-NET-NUM(PV-STORE-SUB)             18120000
179500         ADD  PA-TEND-NET-AMS(PV-STORE-SUB)                       18130000
179600                     TO PA-TEND-NET-AMT(PV-STORE-SUB)             18140000
179700                                                                  18150000
179800         ADD PC-ONE TO PA-LINE-COUNTER-GIFT                       18160000
179900                                                                  18170000
180000         PERFORM E510-WRITE-DETAIL-LINE-PURCH                     18180000
180100     END-IF.                                                      18190000
180200                                                                  18200000
180300*E500-EXIT.                                                       18210000
180400                                                                  18220000
180500******************************************************************18230000
180600* WRITE THE PURCHASING DETAIL LINES                              *18240000
180700*  - SUBTRACT THE NUMBER OF ADD-ON CARDS FROM THE NBR OF ISSUES  *18250000
180800******************************************************************18260000
180900 E510-WRITE-DETAIL-LINE-PURCH.                                    18270000
181000                                                                  18280000
181100     MOVE PV-PREV-CRD-STK-TYP-ID     TO SV023-CRD-STK-TYP.        18290000
181200     MOVE PA-STORE-NUM(PV-STORE-SUB) TO SV023-STR-NBR.            18300000
181300                                                                  18310000
181400     SUBTRACT PA-ISS-ADD-NUS(PV-STORE-SUB)                        18320000
181500         FROM PA-ISS-TOT-NUS(PV-STORE-SUB) GIVING                 18330000
181600         SV023-ISSUE-COUNT.                                       18340000
181700                                                                  18350000
181800     IF  SV023-ISSUE-COUNT = ZERO                                 18360000
181900         CONTINUE                                                 18370000
182000     ELSE                                                         18380000
182100         WRITE PURCH-FILE-RECORD                                  18390000
182200                        FROM SV023-KMCACT-EXTRACT-RECORD          18400000
182300                                                                  18410000
182400         ADD PC-ONE TO PA-PURCH-COUNTER                           18420000
182500                                                                  18430000
182600     END-IF.                                                      18440000
182700                                                                  18450000
182800*E510-EXIT.                                                       18460000
182900                                                                  18470000
183000******************************************************************18480000
183100*     E600-WRITE-COMPANY-TOTALS-GIFT                             *18490000
183200* ==> PROCESSES:  WRITES THE COMPANY TOTAL LINE FOR EACH CARD STK*18500000
183300* ==> PERFORMED FROM:  C200-PROCESS-GIFT-REPORT                  *18510000
183400*                      D500-PROCESS-GIFT-DETAIL                  *18520000
183500*                      E400-PRINT-GIFT-HEADINGS                  *18530000
183600******************************************************************18540000
183700 E600-WRITE-COMPANY-TOTALS-GIFT.                                  18550000
183800                                                                  18560000
183900     INITIALIZE REPORT-TOTAL-LINE.                                18570000
184000     MOVE 'ECOMM AUTH:'            TO TL-LINE-NAME.               18580000
184100     MOVE PV-CA-ISS-TOT-NUM        TO TL-ISSUE-TOT-NUMBER.        18590000
184200     MOVE PV-CA-ISS-TOT-AMT        TO TL-ISSUE-TOT-AMOUNT.        18600000
184300     MOVE PV-CA-ISS-ADD-NUM        TO TL-ISSUE-ADD-NUMBER.        18610000
184400     MOVE PV-CA-ISS-ADD-AMT        TO TL-ISSUE-ADD-AMOUNT.        18620000
184500     MOVE PV-CA-ISS-VOID-NUM       TO TL-ISSUE-VOID-NUMBER.       18630000
184600     MOVE PV-CA-ISS-VOID-AMT       TO TL-ISSUE-VOID-AMOUNT.       18640000
184700     COMPUTE PV-CA-ISS-NET-NUM =   PV-CA-ISS-TOT-NUM -            18650000
184800                                   PV-CA-ISS-VOID-NUM.            18660000
184900     COMPUTE PV-CA-ISS-NET-AMT =   PV-CA-ISS-TOT-AMT +            18670000
185000                                   PV-CA-ISS-VOID-AMT.            18680000
185100     MOVE PV-CA-ISS-NET-NUM        TO TL-ISSUE-NET-NUMBER.        18690000
185200     MOVE PV-CA-ISS-NET-AMT        TO TL-ISSUE-NET-AMOUNT.        18700000
185300     MOVE PV-CA-TEND-TOT-NUM       TO TL-TEND-TOT-NUMBER.         18710000
185400     MOVE PV-CA-TEND-TOT-AMT       TO TL-TEND-TOT-AMOUNT.         18720000
185500     MOVE PV-CA-TEND-VOID-NUM      TO TL-TEND-VOID-NUMBER.        18730000
185600     MOVE PV-CA-TEND-VOID-AMT      TO TL-TEND-VOID-AMOUNT.        18740000
185700     COMPUTE PV-CA-TEND-NET-NUM =  PV-CA-TEND-TOT-NUM -           18750000
185800                                   PV-CA-TEND-VOID-NUM.           18760000
185900     COMPUTE PV-CA-TEND-NET-AMT =  PV-CA-TEND-TOT-AMT +           18770000
186000                                   PV-CA-TEND-VOID-AMT.           18780000
186100     MOVE PV-CA-TEND-NET-NUM       TO TL-TEND-NET-NUMBER.         18790000
186200     MOVE PV-CA-TEND-NET-AMT       TO TL-TEND-NET-AMOUNT.         18800000
186300     COMPUTE PV-CA-VARIANCE-AMT = PV-CA-ISS-NET-AMT +             18810000
186400                                  PV-CA-TEND-NET-AMT.             18820000
186500     MOVE PV-CA-VARIANCE-AMT      TO TL-NET-VARIANCE-AMOUNT.      18830000
186600                                                                  18840000
186700     IF PA-LINE-COUNTER-GIFT > PC-MAX-LINE-BEFORE-TOT             18850000
186800        MOVE SPACES TO DP250O-LASER-NEW-PAGE-INDICATR             18860000
186900        PERFORM E400-PRINT-GIFT-HEADINGS                          18870000
187000     END-IF.                                                      18880000
187100     WRITE GIFT-REPORT-RECORD FROM REPORT-TOTAL-LINE              18890000
187200        AFTER ADVANCING 2 LINES.                                  18900000
187300                                                                  18910000
187400     INITIALIZE REPORT-TOTAL-LINE.                                18920000
187500                                                                  18930000
187600     MOVE 'COMPANY TOTAL:'    TO TL-LINE-NAME.                    18940000
187700     COMPUTE PV-CT-ISS-TOT-NUM =   PV-CT-ISS-TOT-NUM +            18950000
187800                                   PV-CA-ISS-TOT-NUM.             18960000
187900     COMPUTE PV-CT-ISS-TOT-AMT =   PV-CT-ISS-TOT-AMT +            18970000
188000                                   PV-CA-ISS-TOT-AMT.             18980000
188100     COMPUTE PV-CT-ISS-ADD-NUM =   PV-CT-ISS-ADD-NUM +            18990000
188200                                   PV-CA-ISS-ADD-NUM.             19000000
188300     COMPUTE PV-CT-ISS-ADD-AMT =   PV-CT-ISS-ADD-AMT +            19010000
188400                                   PV-CA-ISS-ADD-AMT.             19020000
188500                                                                  19030000
188600     COMPUTE PV-CT-ISS-VOID-NUM =  PV-CT-ISS-VOID-NUM +           19040000
188700                                   PV-CA-ISS-VOID-NUM.            19050000
188800     COMPUTE PV-CT-ISS-VOID-AMT =  PV-CT-ISS-VOID-AMT +           19060000
188900                                   PV-CA-ISS-VOID-AMT.            19070000
189000     COMPUTE PV-CT-ISS-NET-NUM =   PV-CT-ISS-TOT-NUM -            19080000
189100                                   PV-CT-ISS-VOID-NUM.            19090000
189200     COMPUTE PV-CT-ISS-NET-AMT =   PV-CT-ISS-TOT-AMT +            19100000
189300                                   PV-CT-ISS-VOID-AMT.            19110000
189400     MOVE PV-CT-ISS-TOT-NUM        TO TL-ISSUE-TOT-NUMBER.        19120000
189500     MOVE PV-CT-ISS-TOT-AMT        TO TL-ISSUE-TOT-AMOUNT.        19130000
189600     MOVE PV-CT-ISS-ADD-NUM        TO TL-ISSUE-ADD-NUMBER.        19140000
189700     MOVE PV-CT-ISS-ADD-AMT        TO TL-ISSUE-ADD-AMOUNT.        19150000
189800     MOVE PV-CT-ISS-VOID-NUM       TO TL-ISSUE-VOID-NUMBER.       19160000
189900     MOVE PV-CT-ISS-VOID-AMT       TO TL-ISSUE-VOID-AMOUNT.       19170000
190000     MOVE PV-CT-ISS-NET-NUM        TO TL-ISSUE-NET-NUMBER.        19180000
190100     MOVE PV-CT-ISS-NET-AMT        TO TL-ISSUE-NET-AMOUNT.        19190000
190200     COMPUTE PV-CT-TEND-TOT-NUM  = PV-CT-TEND-TOT-NUM +           19200000
190300                                   PV-CA-TEND-TOT-NUM.            19210000
190400     COMPUTE PV-CT-TEND-TOT-AMT  = PV-CT-TEND-TOT-AMT +           19220000
190500                                   PV-CA-TEND-TOT-AMT.            19230000
190600     COMPUTE PV-CT-TEND-VOID-NUM = PV-CT-TEND-VOID-NUM +          19240000
190700                                   PV-CA-TEND-VOID-NUM.           19250000
190800     COMPUTE PV-CT-TEND-VOID-AMT = PV-CT-TEND-VOID-AMT +          19260000
190900                                   PV-CA-TEND-VOID-AMT.           19270000
191000     COMPUTE PV-CT-TEND-NET-NUM =  PV-CT-TEND-TOT-NUM -           19280000
191100                                   PV-CT-TEND-VOID-NUM.           19290000
191200     COMPUTE PV-CT-TEND-NET-AMT =  PV-CT-TEND-TOT-AMT +           19300000
191300                                   PV-CT-TEND-VOID-AMT.           19310000
191400     MOVE PV-CT-TEND-TOT-NUM       TO TL-TEND-TOT-NUMBER.         19320000
191500     MOVE PV-CT-TEND-TOT-AMT       TO TL-TEND-TOT-AMOUNT.         19330000
191600     MOVE PV-CT-TEND-VOID-NUM      TO TL-TEND-VOID-NUMBER.        19340000
191700     MOVE PV-CT-TEND-VOID-AMT      TO TL-TEND-VOID-AMOUNT.        19350000
191800     MOVE PV-CT-TEND-NET-NUM       TO TL-TEND-NET-NUMBER.         19360000
191900     MOVE PV-CT-TEND-NET-AMT       TO TL-TEND-NET-AMOUNT.         19370000
192000     COMPUTE PV-NET-VARIANCE-AMT = PV-CT-ISS-NET-AMT +            19380000
192100                                   PV-CT-TEND-NET-AMT.            19390000
192200     MOVE PV-NET-VARIANCE-AMT      TO TL-NET-VARIANCE-AMOUNT.     19400000
192300                                                                  19410000
192400     WRITE GIFT-REPORT-RECORD FROM REPORT-TOTAL-LINE              19420000
192500          AFTER ADVANCING 1 LINE.                                 19430000
192600     WRITE GIFT-REPORT-RECORD FROM REPORT-END-OF-REPORT-LINE      19440000
192700        AFTER ADVANCING 3 LINES.                                  19450000
192800     MOVE ZEROS TO PA-LINE-COUNTER-GIFT.                          19460000
192900                                                                  19470000
193000     IF PA-LINE-COUNTER-NET-GIFT > PC-MAX-LINE-PER-PAGE           19480000
193100         ADD PC-ONE                    TO PA-PAGE-COUNTER-NET-GIFT19490000
193200         MOVE PA-PAGE-COUNTER-NET-GIFT TO DP132-PAGE-NUMBER       19500000
193300         PERFORM E401-PRINT-NET-GIFT-HEADINGS                     19510000
193400         MOVE ZERO                     TO PA-LINE-COUNTER-NET-GIFT19520000
193500     END-IF.                                                      19530000
193600                                                                  19540000
193700     MOVE PV-PREV-CRD-STK-TYP-ID      TO RDL-STOCK-ID.            19550000
193800     MOVE PV-CT-ISS-NET-NUM           TO RDL-NET-ISSUE-NUMBER.    19560000
193900     MOVE PV-CT-ISS-NET-AMT           TO RDL-NET-ISSUE-AMOUNT.    19570000
194000     MOVE PV-CT-TEND-NET-NUM          TO RDL-NET-TEND-NUMBER.     19580000
194100     MOVE PV-CT-TEND-NET-AMT          TO RDL-NET-TEND-AMOUNT.     19590000
194200                                                                  19600000
194300     WRITE NET-GIFT-REPORT-RECORD FROM NET-REPORT-DETAIL-LINE     19610000
194400        AFTER ADVANCING 1 LINE.                                   19620000
194500     ADD PC-ONE TO PA-LINE-COUNTER-NET-GIFT.                      19630000
194600                                                                  19640000
194700*E600-EXIT.                                                       19650000
194800                                                                  19660000
194900******************************************************************19670000
195000*     E900-WRITE-ALL-STORE-LINES                                 *19680000
195100* ==> PROCESSES:  WRITES DETAIL LINES FOR ALL CARDS              *19690000
195200* ==> PERFORMED FROM:  C200-PROCESS-GIFT-REPORT                  *19700000
195300******************************************************************19710000
195400 E900-WRITE-ALL-STORE-LINES.                                      19720000
195500                                                                  19730000
195600     PERFORM D200-INITIALIZE-COMPANY-TOTALS.                      19740000
195700     INITIALIZE REPORT-DETAIL-LINE.                               19750000
195800                                                                  19760000
195900* FORCE PAGE BREAK FOR ALL CARD HEADING                           19770000
196000     MOVE 99                     TO PA-LINE-COUNTER-GIFT.         19780000
196100     MOVE PC-ALL-CARD            TO PV-PREV-CRD-STK-TYP-ID        19790000
196200     MOVE PC-ALL-CARD            TO PV-PREV-CRD-STK-TYP-DESC.     19800000
196300                                                                  19810000
196400     PERFORM VARYING PV-STORE-SUB FROM 1 BY 1                     19820000
196500       UNTIL PV-STORE-SUB > PC-MAX-NUM-OF-STORES                  19830000
196600         IF PA-STORE-NUM(PV-STORE-SUB) > 0                        19840000
196700             MOVE PA-STORE-NAME(PV-STORE-SUB)                     19850000
196800                                 TO RDL-STORE-NME                 19860000
196900             MOVE PA-STORE-NUM(PV-STORE-SUB)                      19870000
197000                                 TO RDL-STORE-NBR                 19880000
197100                                                                  19890000
197200             MOVE PA-ISS-TOT-NUM(PV-STORE-SUB)                    19900000
197300                                 TO RDL-ISSUE-TOT-NUMBER          19910000
197400             MOVE PA-ISS-TOT-AMT(PV-STORE-SUB)                    19920000
197500                                 TO RDL-ISSUE-TOT-AMOUNT          19930000
197600             MOVE PA-ISS-ADD-NUM(PV-STORE-SUB)                    19940000
197700                                 TO RDL-ISSUE-ADD-NUMBER          19950000
197800             MOVE PA-ISS-ADD-AMT(PV-STORE-SUB)                    19960000
197900                                 TO RDL-ISSUE-ADD-AMOUNT          19970000
198000             MOVE PA-ISS-VOID-NUM(PV-STORE-SUB)                   19980000
198100                                 TO RDL-ISSUE-VOID-NUMBER         19990000
198200             MOVE PA-ISS-VOID-AMT(PV-STORE-SUB)                   20000000
198300                                 TO RDL-ISSUE-VOID-AMOUNT         20010000
198400             MOVE PA-ISS-NET-NUM(PV-STORE-SUB)                    20020000
198500                                 TO RDL-ISSUE-NET-NUMBER          20030000
198600             MOVE PA-ISS-NET-AMT(PV-STORE-SUB)                    20040000
198700                                 TO RDL-ISSUE-NET-AMOUNT          20050000
198800             MOVE PA-TEND-TOT-NUM(PV-STORE-SUB)                   20060000
198900                                 TO RDL-TEND-TOT-NUMBER           20070000
199000             MOVE PA-TEND-TOT-AMT(PV-STORE-SUB)                   20080000
199100                                 TO RDL-TEND-TOT-AMOUNT           20090000
199200             MOVE PA-TEND-VOID-NUM(PV-STORE-SUB)                  20100000
199300                                 TO RDL-TEND-VOID-NUMBER          20110000
199400             MOVE PA-TEND-VOID-AMT(PV-STORE-SUB)                  20120000
199500                                 TO RDL-TEND-VOID-AMOUNT          20130000
199600             MOVE PA-TEND-NET-NUM(PV-STORE-SUB)                   20140000
199700                                 TO RDL-TEND-NET-NUMBER           20150000
199800             MOVE PA-TEND-NET-AMT(PV-STORE-SUB)                   20160000
199900                                 TO RDL-TEND-NET-AMOUNT           20170000
200000             COMPUTE PV-NET-VARIANCE-AMT =                        20180000
200100                 PA-ISS-NET-AMT(PV-STORE-SUB)  +                  20190000
200200                                   PA-TEND-NET-AMT(PV-STORE-SUB)  20200000
200300             MOVE PV-NET-VARIANCE-AMT                             20210000
200400                                 TO RDL-NET-VARIANCE-AMOUNT       20220000
200500                                                                  20230000
200600             ADD  PA-ISS-TOT-NUM(PV-STORE-SUB)                    20240000
200700                                 TO PV-CT-ISS-TOT-NUM             20250000
200800             ADD  PA-ISS-TOT-AMT(PV-STORE-SUB)                    20260000
200900                                 TO PV-CT-ISS-TOT-AMT             20270000
201000             ADD  PA-ISS-ADD-NUM(PV-STORE-SUB)                    20280000
201100                                 TO PV-CT-ISS-ADD-NUM             20290000
201200             ADD  PA-ISS-ADD-AMT(PV-STORE-SUB)                    20300000
201300                                 TO PV-CT-ISS-ADD-AMT             20310000
201400             ADD  PA-ISS-VOID-NUM(PV-STORE-SUB)                   20320000
201500                                 TO PV-CT-ISS-VOID-NUM            20330000
201600             ADD  PA-ISS-VOID-AMT(PV-STORE-SUB)                   20340000
201700                                 TO PV-CT-ISS-VOID-AMT            20350000
201800             ADD  PA-ISS-NET-NUM(PV-STORE-SUB)                    20360000
201900                                 TO PV-CT-ISS-NET-NUM             20370000
202000             ADD  PA-ISS-NET-AMT(PV-STORE-SUB)                    20380000
202100                                 TO PV-CT-ISS-NET-AMT             20390000
202200             ADD  PA-TEND-TOT-NUM(PV-STORE-SUB)                   20400000
202300                                 TO PV-CT-TEND-TOT-NUM            20410000
202400             ADD  PA-TEND-TOT-AMT(PV-STORE-SUB)                   20420000
202500                                 TO PV-CT-TEND-TOT-AMT            20430000
202600             ADD  PA-TEND-VOID-NUM(PV-STORE-SUB)                  20440000
202700                                 TO PV-CT-TEND-VOID-NUM           20450000
202800             ADD  PA-TEND-VOID-AMT(PV-STORE-SUB)                  20460000
202900                                 TO PV-CT-TEND-VOID-AMT           20470000
203000             ADD  PA-TEND-NET-NUM(PV-STORE-SUB)                   20480000
203100                                 TO PV-CT-TEND-NET-NUM            20490000
203200             ADD  PA-TEND-NET-AMT(PV-STORE-SUB)                   20500000
203300                                 TO PV-CT-TEND-NET-AMT            20510000
203400                                                                  20520000
203500             IF PA-LINE-COUNTER-GIFT > PC-MAX-LINE-PER-PAGE       20530000
203600                 MOVE SPACES TO DP250O-LASER-NEW-PAGE-INDICATR    20540000
203700                 PERFORM E400-PRINT-GIFT-HEADINGS                 20550000
203800             END-IF                                               20560000
203900                                                                  20570000
204000             WRITE GIFT-REPORT-RECORD FROM REPORT-DETAIL-LINE     20580000
204100                 AFTER ADVANCING 1 LINE                           20590000
204200                                                                  20600000
204300             ADD PC-ONE TO PA-LINE-COUNTER-GIFT                   20610000
204400         END-IF                                                   20620000
204500     END-PERFORM.                                                 20630000
204600                                                                  20640000
204700*E900-EXIT.                                                       20650000
204800                                                                  20660000
204900******************************************************************20670000
205000*     E950-WRITE-ALLCARDS-GC-TOTALS                              *20680000
205100* ==> PROCESSES:  WRITES THE COMPANY TOTAL LINE FOR EACH CARD STK*20690000
205200* ==> PERFORMED FROM:  C200-PROCESS-GIFT-REPORT                  *20700000
205300******************************************************************20710000
205400 E950-WRITE-ALLCARDS-GC-TOTALS.                                   20720000
205500                                                                  20730000
205600     MOVE 'ECOMM AUTH:'            TO TL-LINE-NAME.               20740000
205700     MOVE PV-GCTA-ISS-TOT-NUM        TO TL-ISSUE-TOT-NUMBER.      20750000
205800     MOVE PV-GCTA-ISS-TOT-AMT        TO TL-ISSUE-TOT-AMOUNT.      20760000
205900     MOVE PV-GCTA-ISS-ADD-NUM        TO TL-ISSUE-ADD-NUMBER.      20770000
206000     MOVE PV-GCTA-ISS-ADD-AMT        TO TL-ISSUE-ADD-AMOUNT.      20780000
206100     MOVE PV-GCTA-ISS-VOID-NUM       TO TL-ISSUE-VOID-NUMBER.     20790000
206200     MOVE PV-GCTA-ISS-VOID-AMT       TO TL-ISSUE-VOID-AMOUNT.     20800000
206300     COMPUTE PV-GCTA-ISS-NET-NUM =   PV-GCTA-ISS-TOT-NUM -        20810000
206400                                     PV-GCTA-ISS-VOID-NUM.        20820000
206500     COMPUTE PV-GCTA-ISS-NET-AMT =   PV-GCTA-ISS-TOT-AMT +        20830000
206600                                     PV-GCTA-ISS-VOID-AMT.        20840000
206700     MOVE PV-GCTA-ISS-NET-NUM        TO TL-ISSUE-NET-NUMBER.      20850000
206800     MOVE PV-GCTA-ISS-NET-AMT        TO TL-ISSUE-NET-AMOUNT.      20860000
206900     MOVE PV-GCTA-TEND-TOT-NUM       TO TL-TEND-TOT-NUMBER.       20870000
207000     MOVE PV-GCTA-TEND-TOT-AMT       TO TL-TEND-TOT-AMOUNT.       20880000
207100     MOVE PV-GCTA-TEND-VOID-NUM      TO TL-TEND-VOID-NUMBER.      20890000
207200     MOVE PV-GCTA-TEND-VOID-AMT      TO TL-TEND-VOID-AMOUNT.      20900000
207300     COMPUTE PV-GCTA-TEND-NET-NUM =  PV-GCTA-TEND-TOT-NUM -       20910000
207400                                     PV-GCTA-TEND-VOID-NUM.       20920000
207500     COMPUTE PV-GCTA-TEND-NET-AMT =  PV-GCTA-TEND-TOT-AMT +       20930000
207600                                     PV-GCTA-TEND-VOID-AMT.       20940000
207700     MOVE PV-GCTA-TEND-NET-NUM       TO TL-TEND-NET-NUMBER.       20950000
207800     MOVE PV-GCTA-TEND-NET-AMT       TO TL-TEND-NET-AMOUNT.       20960000
207900     COMPUTE PV-GCTA-VARIANCE-AMT = PV-GCTA-ISS-NET-AMT +         20970000
208000                                    PV-GCTA-TEND-NET-AMT.         20980000
208100     MOVE PV-GCTA-VARIANCE-AMT      TO TL-NET-VARIANCE-AMOUNT.    20990000
208200                                                                  21000000
208300     IF PA-LINE-COUNTER-GIFT > PC-MAX-LINE-BEFORE-TOT             21010000
208400        MOVE SPACES TO DP250O-LASER-NEW-PAGE-INDICATR             21020000
208500        PERFORM E400-PRINT-GIFT-HEADINGS                          21030000
208600     END-IF.                                                      21040000
208700     WRITE GIFT-REPORT-RECORD FROM REPORT-TOTAL-LINE              21050000
208800         AFTER ADVANCING 2 LINES.                                 21060000
208900                                                                  21070000
209000     INITIALIZE REPORT-TOTAL-LINE.                                21080000
209100                                                                  21090000
209200     MOVE 'COMPANY TOTAL:'    TO TL-LINE-NAME.                    21100000
209300     COMPUTE PV-CT-ISS-TOT-NUM =   PV-CT-ISS-TOT-NUM +            21110000
209400                                   PV-GCTA-ISS-TOT-NUM.           21120000
209500     COMPUTE PV-CT-ISS-TOT-AMT =   PV-CT-ISS-TOT-AMT +            21130000
209600                                   PV-GCTA-ISS-TOT-AMT.           21140000
209700     COMPUTE PV-CT-ISS-ADD-NUM =   PV-CT-ISS-ADD-NUM +            21150000
209800                                   PV-GCTA-ISS-ADD-NUM.           21160000
209900     COMPUTE PV-CT-ISS-ADD-AMT =   PV-CT-ISS-ADD-AMT +            21170000
210000                                   PV-GCTA-ISS-ADD-AMT.           21180000
210100     COMPUTE PV-CT-ISS-VOID-NUM = PV-CT-ISS-VOID-NUM +            21190000
210200                                  PV-GCTA-ISS-VOID-NUM.           21200000
210300     COMPUTE PV-CT-ISS-VOID-AMT = PV-CT-ISS-VOID-AMT +            21210000
210400                                  PV-GCTA-ISS-VOID-AMT.           21220000
210500     COMPUTE PV-CT-ISS-NET-NUM =   PV-CT-ISS-NET-NUM +            21230000
210600                                   PV-GCTA-ISS-NET-NUM.           21240000
210700     COMPUTE PV-CT-ISS-NET-AMT =   PV-CT-ISS-NET-AMT +            21250000
210800                                   PV-GCTA-ISS-NET-AMT.           21260000
210900     MOVE PV-CT-ISS-TOT-NUM        TO TL-ISSUE-TOT-NUMBER.        21270000
211000     MOVE PV-CT-ISS-TOT-AMT        TO TL-ISSUE-TOT-AMOUNT.        21280000
211100     MOVE PV-CT-ISS-ADD-NUM        TO TL-ISSUE-ADD-NUMBER.        21290000
211200     MOVE PV-CT-ISS-ADD-AMT        TO TL-ISSUE-ADD-AMOUNT.        21300000
211300     MOVE PV-CT-ISS-VOID-NUM       TO TL-ISSUE-VOID-NUMBER.       21310000
211400     MOVE PV-CT-ISS-VOID-AMT       TO TL-ISSUE-VOID-AMOUNT.       21320000
211500     MOVE PV-CT-ISS-NET-NUM        TO TL-ISSUE-NET-NUMBER.        21330000
211600     MOVE PV-CT-ISS-NET-AMT        TO TL-ISSUE-NET-AMOUNT.        21340000
211700     COMPUTE PV-CT-TEND-TOT-NUM  = PV-CT-TEND-TOT-NUM +           21350000
211800                                   PV-GCTA-TEND-TOT-NUM.          21360000
211900     COMPUTE PV-CT-TEND-TOT-AMT  = PV-CT-TEND-TOT-AMT +           21370000
212000                                   PV-GCTA-TEND-TOT-AMT.          21380000
212100     COMPUTE PV-CT-TEND-VOID-NUM = PV-CT-TEND-VOID-NUM +          21390000
212200                                   PV-GCTA-TEND-VOID-NUM.         21400000
212300     COMPUTE PV-CT-TEND-VOID-AMT = PV-CT-TEND-VOID-AMT +          21410000
212400                                   PV-GCTA-TEND-VOID-AMT.         21420000
212500     COMPUTE PV-CT-TEND-NET-NUM =  PV-CT-TEND-NET-NUM +           21430000
212600                                   PV-GCTA-TEND-NET-NUM.          21440000
212700     COMPUTE PV-CT-TEND-NET-AMT =  PV-CT-TEND-NET-AMT +           21450000
212800                                   PV-GCTA-TEND-NET-AMT.          21460000
212900     MOVE PV-CT-TEND-TOT-NUM       TO TL-TEND-TOT-NUMBER.         21470000
213000     MOVE PV-CT-TEND-TOT-AMT       TO TL-TEND-TOT-AMOUNT.         21480000
213100     MOVE PV-CT-TEND-VOID-NUM      TO TL-TEND-VOID-NUMBER.        21490000
213200     MOVE PV-CT-TEND-VOID-AMT      TO TL-TEND-VOID-AMOUNT.        21500000
213300     MOVE PV-CT-TEND-NET-NUM       TO TL-TEND-NET-NUMBER.         21510000
213400     MOVE PV-CT-TEND-NET-AMT       TO TL-TEND-NET-AMOUNT.         21520000
213500     COMPUTE PV-NET-VARIANCE-AMT = PV-CT-ISS-NET-AMT +            21530000
213600                                   PV-CT-TEND-NET-AMT.            21540000
213700     MOVE PV-NET-VARIANCE-AMT      TO TL-NET-VARIANCE-AMOUNT.     21550000
213800                                                                  21560000
213900     WRITE GIFT-REPORT-RECORD FROM REPORT-TOTAL-LINE.             21570000
214000     WRITE GIFT-REPORT-RECORD FROM REPORT-END-OF-REPORT-LINE      21580000
214100        AFTER ADVANCING 3 LINES.                                  21590000
214200     MOVE ZEROS TO PA-LINE-COUNTER-GIFT.                          21600000
214300                                                                  21610000
214400     IF PA-LINE-COUNTER-NET-GIFT > PC-MAX-LINE-PER-PAGE           21620000
214500         ADD PC-ONE                    TO PA-PAGE-COUNTER-NET-GIFT21630000
214600         MOVE PA-PAGE-COUNTER-NET-GIFT TO DP132-PAGE-NUMBER       21640000
214700         PERFORM E401-PRINT-NET-GIFT-HEADINGS                     21650000
214800         MOVE ZERO                     TO PA-LINE-COUNTER-NET-GIFT21660000
214900     END-IF.                                                      21670000
215000                                                                  21680000
215100     MOVE 'COMPANY TOTAL:'         TO RDL-DESCRIPTION.            21690000
215200     MOVE PV-CT-ISS-NET-NUM  TO RDL-NET-ISSUE-NUMBER.             21700000
215300     MOVE PV-CT-ISS-NET-AMT  TO RDL-NET-ISSUE-AMOUNT.             21710000
215400     MOVE PV-CT-TEND-NET-NUM TO RDL-NET-TEND-NUMBER.              21720000
215500     MOVE PV-CT-TEND-NET-AMT TO RDL-NET-TEND-AMOUNT.              21730000
215600     WRITE NET-GIFT-REPORT-RECORD FROM NET-REPORT-DASH-HEADER     21740000
215700        AFTER ADVANCING 1 LINE.                                   21750000
215800     WRITE NET-GIFT-REPORT-RECORD FROM NET-REPORT-DETAIL-LINE     21760000
215900        AFTER ADVANCING 1 LINE.                                   21770000
216000                                                                  21780000
216100                                                                  21790000
216200*E950-EXIT.                                                       21800000
216300******************************************************************21810000
216400*     Z900-SQL-ABEND                                             *21820000
216500* ==> PROCESSES:                                                 *21830000
216600*     -PERFORMS ABEND PROCESSING FOR SQL ERRORS.                 *21840000
216700* ==> PERFORMED FROM:                                            *21850000
216800*                      E200-WRITE-DETAIL-LINE-KMRC               *21860000
216900*                      E500-WRITE-DETAIL-LINE-GIFT               *21870000
217000******************************************************************21880000
217100 Z900-SQL-ABEND.                                                  21890000
217200                                                                  21900000
217300     DISPLAY ' '.                                                 21910000
217400     DISPLAY 'Z900-SQL-ABEND'.                                    21920000
217500     DISPLAY '**  ABEND     **'.                                  21930000
217600     DISPLAY '**  PROGRAM   ** = ' PC-PROGRAM-NAME.               21940000
217700     DISPLAY '**  PARAGRAPH ** = ' PV-PARAGRAPH-NAME.             21950000
217800     DISPLAY '**  OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.    21960000
217900                                                                  21970000
218000******************************************************************21980000
218100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *21990000
218200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *22000000
218300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *22010000
218400* FORMAT.                                                        *22020000
218500******************************************************************22030000
218600     COPY DPPD004.                                                22040000
218700                                                                  22050000
218800     MOVE +4013 TO ABEND-CODE.                                    22060000
218900     CALL 'ILBOABN0' USING ABEND-CODE.                            22070000
219000*Z900-EXIT.                                                       22080000
