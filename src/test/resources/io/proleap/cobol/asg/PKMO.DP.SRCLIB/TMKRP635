000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.   TMKRP635.                                          00050000
000600 AUTHOR.       THERESE RAMSEYER.                                  00060000
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070000
000800 DATE-WRITTEN. MAY, 1999.                                         00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM WILL PRODUCE BOTH THE DETAIL AND ERROR REPORTS FOR 00120000
001300* EXCEPTION PROCESSING.                                           00130000
      *                                                                 00131006
      * CHANGE LOG:                                                     00131106
      *  09/26/2022  JEAN KURK  RECOMPILE FOR COBOL UPGRADE             00132006
      *                                CHG0274597                       00133006
001400* ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::00140000
001500* NOTE !  THE INPUT FILE TO THIS PROGRAM MUST BE SORTED ON THE    00150000
001600* ::::::  FOLLOWING KEYS IN ORDER:   ODR-RECORD-TYP               00160000
001700*                                    PO-NBR                       00170000
001800*                                    CNTRL-NBR                    00180000
001900*                                    TRBL-RSN-CDE                 00190000
002000*                                    GROUP-TYP-CDE                00200000
002100*SORT FIELDS=(01,1,CH,A,02,9,BI,A,11,9,BI,A,20,4,BI,A,24,2,BI,A)  00210000
002200*FROM UNLOADING DB2 TROUBLE MANAGEMENT WORK TABLE TOUTTM2         00220000
002300*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::00230000
002400* BECAUSE THIS PROGRAM WRITES BOTH REPORTS, AND BECAUSE 4         00240000
002500* DIFFERENT COPYBOOK LAYOUTS ARE USED FOR THE DETAIL REPORT,      00250000
002600* THE INPUT IS READ INTO A MASTER RECORD COMPOSED OF THE          00260000
002700* ABOVE KEY FIELDS FROM THE SORT AND FILLER. THE GROUP-TYP-CDE    00270000
002800* WILL DETERMINE WHICH COPYBOOK WILL BE USED. BELOW IS A GUIDE    00280000
002900* TO THE GROUP-TYP-CDE, COPYBOOKS AND THE DETAIL LINES (DL-) WITH 00290000
003000* THE ASSOCIATED VARIABLE NAMES TO MATCH REPORTS.                 00300000
003100*                                                                 00310000
003200*  ------------------------------(COPYBOOK TMRD602)-----GROUP 1---00320000
003300*  DL1-   PO NUMBER                                               00330000
003400*         TROUBLE REASON  EVENT                                   00340000
003500*         EVENT                                                   00350000
003600*  DL2-   TROUBLE REASON DESC                                     00360000
003700*  DL3-   PO VER                                                  00370000
003800*  DL4-   PLN SHP VER                                             00380000
003900*  DL5-   PO LINE VER                                             00390000
004000*  DL5A-  DEPT                                                    00400000
004100*  DL6-   FOB CODE                                                00410000
004200*         POE CODE                                                00420000
004300*  DL7-   CONSOLIDATOR                                            00430000
004400*         DECONSOLIDATOR                                          00440000
004500*         CUSTOMS BROKER                                          00450000
004600*  DL8-   START FACTORY DATE                                      00460000
004700*         PO BKG DELIVERY DATE                                    00470000
004800*         PO RECEIPT DATE                                         00480000
004900*  DL9-   LAST FACTORY DATE                                       00490000
005000*         CONTNR PICK UP DATE                                     00500000
005100*         FOB EST DELIVERY DATE                                   00510000
005200*  DL10-  ACTL POE SAIL DATE                                      00520000
005300*  DL11-  PO UNIT QUANTITY                                        00530000
005400*         PO BKG UNIT QUANTITY                                    00540000
005500*         PO RECEIPT UNIT QUANTITY                                00550000
005600*  DL12-  CONTNR UNIT QUANTITY                                    00560000
005700*  DL13-  BEGIN DAY/PCT QUANTITY                                  00570000
005800*         END DAY/PCT QUANTITY                                    00580000
005900*         CONTROL TYPE CODE                                       00590000
006000*  ------------------------------(COPYBOOK TMRD603)-----GROUP 2---00600000
006100*  DL16-  RULE NAME                                               00610000
006200*         RULE TYPE                                               00620000
006300*         RULE CONDITION                                          00630000
006400*         RULE CONDITION PROCESS CODE                             00640000
006500*         RULE RESULT (DAYS/PCT)                                  00650000
006600*         RULE RESULT INDICATOR                                   00660000
006700*         SOURCE PROCESS APPL CODE                                00670000
006800*  ------------------------------(COPYBOOK TMRD604)-----GROUP 3---00680000
006900*  DL17-  ACTION                                                  00690000
007000*         NOTIFY DATE/TIME                                        00700000
007100*         UPDATED DATE/TIME OR RESOLVED DATE/TIME                 00710000
007200*  DL18-  INITIATOR                                               00720000
007300*         RESPONSIBLE PARTY                                       00730000
007400*         REPORTED AGAINST                                        00740000
007500*  DL19-  RESOLUTION ACTION                                       00750000
007600*         EARLY/LATE DAY QTY                                      00760000
007700*         OVER/SHORT PCT QTY                                      00770000
007800*  ------------------------------(COPYBOOK TMRD605)-----GROUP 4---00780000
007900*  DL22-  BKG DELY DATE                                           00790000
008000*         RECEIPT DATE                                            00800000
008100*         IMPORT ID                                               00810000
008200*         FOB ACTL SAIL DATE                                      00820000
008300*         IMPORT SEQ NBR                                          00830000
008400*         IMPORT KEY TYPE                                         00840000
008500*  ------------------------------(COPYBOOK TMRD600)-----GROUP 5---00850000
008600*  DL24-  PO NBR                                                  00860000
008700*         TROUBLE REASON CODE                                     00870000
008800*         FOB CODE                                                00880000
008900*         RULE NAME                                               00890000
009000*         ERROR                                                   00900000
009100*  ---------------------------------------------------------------00910000
009200*                                                                 00920000
009300* BREAKS OCCUR FOR EACH NEW PO, TROUBLE REASON AND CONTROL NUMBER 00930000
009400*                                                                 00940000
009500* EACH DETAIL WILL CONSIST OF :                                   00950000
009600*       _________________________________________________________ 00960000
009700*      | REPORT TYPE | GROUP VALUE | REQUIRED ? | NUMBER OF EACH |00970000
009800*      |_____________|_____________|____________|________________|00980000
009900*      |  DETAIL     |    01       |    YES     |     1 ONLY     |00990000
010000*      |_____________|_____________|____________|________________|01000000
010100*      |             |    02       |    YES     |     1 OR MORE  |01010000
010200*      |_____________|_____________|____________|________________|01020000
010300*      |             |    03       |    NO      |     1 ONLY     |01030000
010400*      |_____________|_____________|____________|________________|01040000
010500*      |             |    04       |    NO      |     1 OR MORE  |01050000
010600*      |_____________|_____________|____________|________________|01060000
010700*      |  ERROR      |    05       |    YES     |     1 OR MORE  |01070000
010800*      |_____________|_____________|____________|________________|01080000
010900*                                                                 01090000
011000*                                                                 01100000
011100*  THERE IS A POSSIBILITY OF HAVING MORE THAN 1 "RULE DETAIL" OR  01110000
011200*  "IMPORT DETAIL", SO PAGE SPILL-OVER LOGIG IS NEEDED FOR        01120000
011300*  PROCESSING OF GROUPS 2 AND 4 --ALSO FOR 3 BECAUSE IT FALLS     01130000
011400*  IN BETWEEN TWO POSSIBLY VARAIBLE VERTICAL LENGTH DETAIL GROUPS.01140000
011500*                                                                 01150000
011600******************************************************************01160000
011700******************************************************************01170000
011800 ENVIRONMENT DIVISION.                                            01180000
011900******************************************************************01190000
012000                                                                  01200000
012100 CONFIGURATION SECTION.                                           01210000
012200                                                                  01220000
012300 SOURCE-COMPUTER.        IBM-3090.                                01230000
012400 OBJECT-COMPUTER.        IBM-3090.                                01240000
012500                                                                  01250000
012600 INPUT-OUTPUT SECTION.                                            01260000
012700                                                                  01270000
012800 FILE-CONTROL.                                                    01280000
012900                                                                  01290000
013000     SELECT EXCEPTION-FILE                                        01300000
013100         ASSIGN TO INP01.                                         01310000
013200                                                                  01320000
013300     SELECT EXCEPTION-DETAIL-FILE                                 01330000
013400         ASSIGN TO RPT01.                                         01340000
013500                                                                  01350000
013600     SELECT EXCEPTION-ERROR-FILE                                  01360000
013700         ASSIGN TO RPT02.                                         01370000
013800                                                                  01380000
013900******************************************************************01390000
014000 DATA DIVISION.                                                   01400000
014100******************************************************************01410000
014200                                                                  01420000
014300 FILE SECTION.                                                    01430000
014400                                                                  01440000
014500 FD  EXCEPTION-FILE                                               01450000
014600     RECORDING MODE IS F                                          01460000
014700     LABEL RECORDS ARE STANDARD                                   01470000
014800     BLOCK CONTAINS 0 RECORDS.                                    01480000
014900                                                                  01490000
015000 01  EXCEPTION-RECORD                PIC X(508).                  01500000
015100                                                                  01510000
015200 FD  EXCEPTION-DETAIL-FILE                                        01520000
015300     RECORDING MODE IS F                                          01530000
015400     LABEL RECORDS ARE STANDARD                                   01540000
015500     BLOCK CONTAINS 0 RECORDS.                                    01550000
015600                                                                  01560000
015700 01  EXCEPTION-DETAIL-RECORD         PIC X(132).                  01570000
015800                                                                  01580000
015900 FD  EXCEPTION-ERROR-FILE                                         01590000
016000     RECORDING MODE IS F                                          01600000
016100     LABEL RECORDS ARE STANDARD                                   01610000
016200     BLOCK CONTAINS 0 RECORDS.                                    01620000
016300                                                                  01630000
016400 01  EXCEPTION-ERROR-RECORD          PIC X(132).                  01640000
016500                                                                  01650000
016600******************************************************************01660000
016700 WORKING-STORAGE SECTION.                                         01670000
016800******************************************************************01680000
016900                                                                  01690000
017000******************************************************************01700000
017100*  DB2 FORMATTED MESSAGE AREA                                     01710000
017200******************************************************************01720000
017300     COPY DPWS004.                                                01730000
017400                                                                  01740000
017500******************************************************************01750000
017600*  KOHL'S COPYBOOK FOR STANDARD 132 COLUMN REPORT HEADER.         01760000
017700******************************************************************01770000
017800     COPY DPWS132O.                                               01780000
017900                                                                  01790000
018000******************************************************************01800000
018100*  COMMUNICATIONS AREA FOR DB2                                    01810000
018200******************************************************************01820000
018300     EXEC SQL                                                     01830000
018400          INCLUDE SQLCA                                           01840000
018500     END-EXEC.                                                    01850000
018600                                                                  01860000
018700******************************************************************01870000
018800*  DB2 TABLE DECLARATION -  IMPORT MASTER CODE TABLE.             01880000
018900*      (TICDMST)                                                  01890000
019000******************************************************************01900000
019100     EXEC SQL                                                     01910000
019200          INCLUDE TICDMST                                         01920000
019300     END-EXEC.                                                    01930000
019400                                                                  01940000
019500******************************************************************01950000
019600*  DB2 TABLE DECLARATION -  IMPORT CODE VALUE TABLE.              01960000
019700*      (TICDVAL)                                                  01970000
019800******************************************************************01980000
019900     EXEC SQL                                                     01990000
020000          INCLUDE TICDVAL                                         02000000
020100     END-EXEC.                                                    02010000
020200                                                                  02020000
020300******************************************************************02030000
020400*  DB2 TABLE DECLARATION -  ENTITY NAME TABLE.                    02040000
020500*      (TENTNME)                                                  02050000
020600******************************************************************02060000
020700     EXEC SQL                                                     02070000
020800          INCLUDE TENTNME                                         02080000
020900     END-EXEC.                                                    02090000
021000                                                                  02100000
021100******************************************************************02110000
021200*  DB2 TABLE DECLARATION -  TROUBLE NOTIFY TABLE.                 02120000
021300*      (TTRBNTF)                                                  02130000
021400******************************************************************02140000
021500     EXEC SQL                                                     02150000
021600          INCLUDE TTRBNTF                                         02160000
021700     END-EXEC.                                                    02170000
021800                                                                  02180000
021900******************************************************************02190000
022000*  DB2 TABLE DECLARATION -  TROUBLE REASON TABLE.                 02200000
022100*      (TTRBRSN)                                                  02210000
022200******************************************************************02220000
022300     EXEC SQL                                                     02230000
022400          INCLUDE TTRBRSN                                         02240000
022500     END-EXEC.                                                    02250000
022600                                                                  02260000
022700******************************************************************02270000
022800*  DB2 TABLE DECLARATION -  PURCHASE ORDER PURCHASE TABLE.        02280000
022900*      (TPURCHS)                                                  02290000
023000******************************************************************02300000
023100     EXEC SQL                                                     02310000
023200          INCLUDE TPURCHS                                         02320000
023300     END-EXEC.                                                    02330000
023400                                                                  02340000
023500******************************************************************02350000
023600*  DB2 TABLE DECLARATION - PURCHASE ORDER PLANNED SHIPMENT.       02360000
023700*      (TPLNSHP)                                                  02370000
023800******************************************************************02380000
023900     EXEC SQL                                                     02390000
024000          INCLUDE TPLNSHP                                         02400000
024100     END-EXEC.                                                    02410000
024200                                                                  02420000
024300******************************************************************02430000
024400*  DB2 TABLE DECLARATION - IMPORT BOOKING PO TABLE.               02440000
024500*      (TIMBKPO)                                                  02450000
024600******************************************************************02460000
024700     EXEC SQL                                                     02470000
024800          INCLUDE TIMBKPO                                         02480000
024900     END-EXEC.                                                    02490000
025000                                                                  02500000
025100******************************************************************02510000
025200*  DB2 TABLE DECLARATION - IMPORT RECIEVING PO TABLE.             02520000
025300*      (TIMRCPO)                                                  02530000
025400******************************************************************02540000
025500     EXEC SQL                                                     02550000
025600          INCLUDE TIMRCPO                                         02560000
025700     END-EXEC.                                                    02570000
025800                                                                  02580000
025900******************************************************************02590000
026000*  DB2 TABLE DECLARATION - IMPORT CONTAINER PO TABLE.             02600000
026100*      (TIMCNPO)                                                  02610000
026200******************************************************************02620000
026300     EXEC SQL                                                     02630000
026400          INCLUDE TIMCNPO                                         02640000
026500     END-EXEC.                                                    02650000
026600                                                                  02660000
026700******************************************************************02670000
026800*  DB2 TABLE DECLARATION - IMPORT CONTAINER TRACKING TABLE.       02680000
026900*      (TIMCNTK)                                                  02690000
027000******************************************************************02700000
027100     EXEC SQL                                                     02710000
027200          INCLUDE TIMCNTK                                         02720000
027300     END-EXEC.                                                    02730000
027400                                                                  02740000
027500******************************************************************02750000
027600* COPYBOOKS TO PROCESS REPORT FROM WORK TABLE (TOUTTM1)           02760000
027700******************************************************************02770000
027800     COPY TMRD602.                                                02780000
027900     COPY TMRD603.                                                02790000
028000     COPY TMRD604.                                                02800000
028100     COPY TMRD605.                                                02810000
028200     COPY TMRD600.                                                02820000
028300 EJECT                                                            02830000
028400                                                                  02840000
028500 01  ABEND-CODE                      PIC S9(04)    VALUE +0       02850000
028600                                                   COMP SYNC.     02860000
028700 01  PA-PROGRAM-ACCUMULATORS.                                     02870000
028800     05  PA-TOTALS.                                               02880000
028900         10 PA-TOTAL-RECORDS-READ     PIC  S9(09)  VALUE +0       02890000
029000                                                     COMP-3.      02900000
029100         10 PA-DETAILS-WRITTEN        PIC  S9(09)  VALUE +0       02910000
029200                                                     COMP-3.      02920000
029300         10 PA-ERRORS-WRITTEN         PIC  S9(09)  VALUE +0       02930000
029400                                                     COMP-3.      02940000
029500         10 PA-PO-GROUPS-PROCESSED    PIC  S9(09)  VALUE +0       02950000
029600                                                     COMP-3.      02960000
029700 01  PS-PROGRAM-SWITCHES.                                         02970000
029800     05  PS-END-OF-EXCEPTIONS-SW       PIC  X(01)    VALUE 'N'.   02980000
029900         88  PS-END-OF-EXCEPTIONS                    VALUE 'Y'.   02990000
030000         88  PS-END-OF-EXCEPTIONS-NO                 VALUE 'N'.   03000000
030100     05  PS-GOOD-RECORD-SW             PIC  X(01)    VALUE 'N'.   03010000
030200         88  PS-GOOD-RECORD                          VALUE 'Y'.   03020000
030300         88  PS-GOOD-RECORD-NO                       VALUE 'N'.   03030000
030400     05  PS-FILE-IS-EMPTY-SW           PIC  X(01)    VALUE 'N'.   03040000
030500         88  PS-FILE-IS-EMPTY                        VALUE 'Y'.   03050000
030600         88  PS-FILE-IS-EMPTY-NO                     VALUE 'N'.   03060000
030700     05  PS-ERRORS-IN-FILE-SW          PIC  X(01)    VALUE 'N'.   03070000
030800         88  PS-ERRORS-IN-FILE                       VALUE 'Y'.   03080000
030900         88  PS-ERRORS-IN-FILE-NO                    VALUE 'N'.   03090000
031000     05  PS-NEW-PO-GROUP-SW            PIC  X(01)    VALUE 'N'.   03100000
031100         88  PS-NEW-PO-GROUP                         VALUE 'Y'.   03110000
031200         88  PS-NEW-PO-GROUP-NO                      VALUE 'N'.   03120000
031210     05  PS-PROCESS-SW                 PIC  X(01)    VALUE 'N'.   03121000
031220         88  PS-PROCESS                              VALUE 'Y'.   03122000
031230         88  PS-PROCESS-NO                           VALUE 'N'.   03123000
031300     05  PS-NEW-PAGE-WRITTEN-SW        PIC  X(01)    VALUE 'N'.   03130000
031400         88  PS-NEW-PAGE-WRITTEN                     VALUE 'Y'.   03140000
031500         88  PS-NEW-PAGE-WRITTEN-NO                  VALUE 'N'.   03150000
031600     05  PS-REPORT-TYPE-IS-ERROR-SW    PIC  X(01)    VALUE 'N'.   03160000
031700         88  PS-REPORT-TYPE-IS-ERROR                 VALUE 'Y'.   03170000
031800         88  PS-REPORT-TYPE-IS-ERROR-NO              VALUE 'N'.   03180000
031900     05  PS-REPORT-TYPE-IS-DETAIL-SW   PIC  X(01)    VALUE 'N'.   03190000
032000         88  PS-REPORT-TYPE-IS-DETAIL                VALUE 'Y'.   03200000
032100         88  PS-REPORT-TYPE-IS-DETAIL-NO             VALUE 'N'.   03210000
032200     05  PS-DETAIL-HEADINGS-WRITTEN-SW PIC  X(01)    VALUE 'N'.   03220000
032300         88  PS-DETAIL-HEADINGS-WRITTEN              VALUE 'Y'.   03230000
032400         88  PS-DETAIL-HEADINGS-WRITTEN-NO           VALUE 'N'.   03240000
032500     05  PS-ERROR-HEADINGS-WRITTEN-SW  PIC  X(01)    VALUE 'N'.   03250000
032600         88  PS-ERROR-HEADINGS-WRITTEN               VALUE 'Y'.   03260000
032700         88  PS-ERROR-HEADINGS-WRITTEN-NO            VALUE 'N'.   03270000
032800     05  PS-RULE-HEADINGS-WRITTEN-SW   PIC  X(01)    VALUE 'N'.   03280000
032900         88  PS-RULE-HEADINGS-WRITTEN                VALUE 'Y'.   03290000
033000         88  PS-RULE-HEADINGS-WRITTEN-NO             VALUE 'N'.   03300000
033100     05  PS-IMPRT-HEADINGS-WRITTEN-SW  PIC  X(01)    VALUE 'N'.   03310000
033200         88  PS-IMPRT-HEADINGS-WRITTEN               VALUE 'Y'.   03320000
033300         88  PS-IMPRT-HEADINGS-WRITTEN-NO            VALUE 'N'.   03330000
033400     05  PS-GRP-3-UPDATES-WRITTEN-SW   PIC  X(01)    VALUE 'N'.   03340000
033500         88  PS-GRP-3-UPDATES-WRITTEN                VALUE 'Y'.   03350000
033600         88  PS-GRP-3-UPDATES-WRITTEN-NO             VALUE 'N'.   03360000
033700     05  PS-GRP-4-LOAD-DATA-WRITTEN-SW PIC  X(01)    VALUE 'N'.   03370000
033800         88  PS-GRP-4-LOAD-DATA-WRITTEN              VALUE 'Y'.   03380000
033900         88  PS-GRP-4-LOAD-DATA-WRITTEN-NO           VALUE 'N'.   03390000
034000     05  PS-TRBL-ACTION-CDE-IS-R-SW    PIC  X(01)    VALUE 'N'.   03400000
034100         88  PS-TRBL-ACTION-CDE-IS-R                 VALUE 'Y'.   03410000
034200         88  PS-TRBL-ACTION-CDE-IS-R-NO              VALUE 'N'.   03420000
034300                                                                  03430000
034400 01  PC-PROGRAM-CONSTANTS.                                        03440000
034500                                                                  03450000
034600     05  PC-MAX-RETRIES              PIC S9(03) VALUE +5 COMP-3.  03460000
034700                                                                  03470000
034800     05  PC-PAGE-SIZE-054            PIC S9(04)   VALUE +054      03480000
034900                                                     COMP SYNC.   03490000
035000                                                                  03500000
035100     05  PC-056                      PIC S9(04)   VALUE +056      03510000
035200                                                     COMP SYNC.   03520000
035300                                                                  03530000
035400     05  PC-PAGE-SIZE-060            PIC S9(04)   VALUE +060      03540000
035500                                                     COMP SYNC.   03550000
035600                                                                  03560000
035700     05  PC-060                      PIC S9(04)   VALUE +060      03570000
035800                                                     COMP SYNC.   03580000
035900                                                                  03590000
036000     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)  VALUE 'TMKRP635'. 03600000
036100                                                                  03610000
036200     05  PC-DEFAULT-DTE              PIC X(10) VALUE '0001-01-01'.03620000
036300                                                                  03630000
036400     05  PC-PERCENT                  PIC  X(01)   VALUE  '%'.     03640000
036500                                                                  03650000
036600     05  PC-PCT                      PIC  X(03)   VALUE  'PCT'.   03660000
036700                                                                  03670000
036800     05  PC-PCT-SIGN                 PIC  X(05)   VALUE  ' %   '. 03680000
036900                                                                  03690000
037000     05  PC-DAY                      PIC  X(03)   VALUE  'DAY'.   03700000
037100                                                                  03710000
037200     05  PC-DAYS                     PIC  X(07) VALUE  ' DAY(S)'. 03720000
037300                                                                  03730000
037400     05  PC-IND                      PIC  X(03)   VALUE  'IND'.   03740000
037500                                                                  03750000
037600     05  PC-UPDATED                  PIC  X(09) VALUE 'UPDATED  '.03760000
037700                                                                  03770000
037800     05  PC-RESOLVED                 PIC  X(09) VALUE 'RESOLVED '.03780000
037900                                                                  03790000
038000     05  PC-1STAR                    PIC  X(01)   VALUE  '*'.     03800000
038100                                                                  03810000
038200     05  PC-1                        PIC  X(01)    VALUE '1'.     03820000
038300                                                                  03830000
038400     05  PC-2                        PIC  X(01)    VALUE '2'.     03840000
038500                                                                  03850000
038600     05  PC-01                       PIC  X(02)    VALUE '01'.    03860000
038700                                                                  03870000
038800     05  PC-02                       PIC  X(02)    VALUE '02'.    03880000
038900                                                                  03890000
039000     05  PC-03                       PIC  X(02)    VALUE '03'.    03900000
039100                                                                  03910000
039200     05  PC-04                       PIC  X(02)    VALUE '04'.    03920000
039300                                                                  03930000
039400     05  PC-05                       PIC  X(02)    VALUE '05'.    03940000
039500                                                                  03950000
039600     05  PC-20                       PIC  9(02)    VALUE 20.      03960000
039700                                                                  03970000
039800     05  PC-21                       PIC  9(02)    VALUE 21.      03980000
039900                                                                  03990000
040000     05  PC-22                       PIC  9(02)    VALUE 22.      04000000
040100                                                                  04010000
040200     05  PC-23                       PIC  9(02)    VALUE 23.      04020000
040300                                                                  04030000
040400     05  PC-24                       PIC  9(02)    VALUE 24.      04040000
040500                                                                  04050000
040600     05  PC-25                       PIC  9(02)    VALUE 25.      04060000
040700                                                                  04070000
040800     05  PC-26                       PIC  9(02)    VALUE 26.      04080000
040900                                                                  04090000
041000     05  PC-27                       PIC  9(02)    VALUE 27.      04100000
041100                                                                  04110000
041200     05  PC-D                        PIC  X(01)    VALUE 'D'.     04120000
041300                                                                  04130000
041400     05  PC-E                        PIC  X(01)    VALUE 'E'.     04140000
041500                                                                  04150000
041600     05  PC-T                        PIC  X(01)    VALUE 'T'.     04160000
041700                                                                  04170000
041800     05  PC-R                        PIC  X(01)    VALUE 'R'.     04180000
041900                                                                  04190000
042000     05  PC-U                        PIC  X(01)    VALUE 'U'.     04200000
042100                                                                  04210000
042200     05  PC-NA                       PIC  X(03)   VALUE 'N/A'.    04220000
042300                                                                  04230000
042310     05  PC-BK                       PIC  X(02)   VALUE 'BK'.     04231000
042320                                                                  04232000
042330     05  PC-RC                       PIC  X(02)   VALUE 'RC'.     04233000
042340                                                                  04234000
042350     05  PC-CN                       PIC  X(02)   VALUE 'CN'.     04235000
042360                                                                  04236000
042400     05  PC-DATA-ID-500              PIC S9(03) VALUE +500 COMP-3.04240000
042500                                                                  04250000
042600     05  PC-DATA-ID-600              PIC S9(03) VALUE +600 COMP-3.04260000
042700                                                                  04270000
042800     05  PC-SIGNED-ZERO              PIC S9(04) VALUE +0.         04280000
042900                                                                  04290000
043000 01  PV-PROGRAM-VARIABLES.                                        04300000
043100       05  PV-CURRENT-PO-NBR            PIC ZZZZZZZZ9.            04310000
043200       05  PV-CURRENT-PO-NBR-X  REDEFINES                         04320000
043300           PV-CURRENT-PO-NBR            PIC  X(09).               04330000
043400                                                                  04340000
043500       05  PV-CURRENT-CNTRL-NBR         PIC ZZZZZZZZ9.            04350000
043600       05  PV-CURRENT-CNTRL-NBR-X REDEFINES                       04360000
043700           PV-CURRENT-CNTRL-NBR         PIC  X(09).               04370000
043800                                                                  04380000
043900       05  PV-CURRENT-TRBL-RSN-CDE      PIC ZZZ9.                 04390000
044000       05  PV-CURRENT-TRBL-RSN-CDE-X REDEFINES                    04400000
044100           PV-CURRENT-TRBL-RSN-CDE      PIC  X(04).               04410000
044200                                                                  04420000
044300       05  PV-4BYTE-HOLD-FOR-EVAL        PIC  9(04) VALUE ZEROES. 04430000
044400                                                                  04440000
044500       05  PV-SIGNED-COMP-PO             PIC S9(09) COMP.         04450000
044600                                                                  04460000
044700       05  PV-SIGNED-COMP-VER            PIC S9(09) COMP.         04470000
044800                                                                  04480000
044810       05  PV-SIGNED-COMP-SEQ-NBR        PIC S9(09) COMP.         04481000
044820                                                                  04482000
044900       05  PV-HOLD-RESP-PARTY-TEXT       PIC  X(15) VALUE SPACES. 04490000
045000                                                                  04500000
045010       05  PV-BKG-DELY-DTE               PIC  X(10) VALUE SPACES. 04501000
045020                                                                  04502000
045030       05  PV-RCVD-DELY-DTE              PIC  X(10) VALUE SPACES. 04503000
045040                                                                  04504000
045050       05  PV-SAIL-DTE                   PIC  X(10) VALUE SPACES. 04505000
045060                                                                  04506000
045100       05  PV-PAGE-COUNT                 PIC S9(04)   VALUE +0.   04510000
045200                                                                  04520000
045300       05  PV-LINE-COUNT                 PIC S9(04)   VALUE +0.   04530000
045400                                                                  04540000
045500       05  PV-LAST-DETAIL-LINE-COUNT     PIC S9(04)   VALUE +0.   04550000
045600                                                                  04560000
045700       05  PV-LAST-DETAIL-PAGE-COUNT     PIC S9(04)   VALUE +0.   04570000
045800                                                                  04580000
045900       05  PV-RETRY-COUNTER              PIC S9(04)   VALUE +0.   04590000
046000                                                                  04600000
046100       05  PV-CURRENT-TMST               PIC  X(26) VALUE SPACES. 04610000
046200                                                                  04620000
046300       05  PV-APPL-CDE                   PIC  X(02) VALUE SPACES. 04630000
046400                                                                  04640000
046500       05  PV-RPT-FORMATTED-DATE.                                 04650000
046600           10 PV-RPT-MM                  PIC  X(02)  VALUE SPACES.04660000
046700           10 FILLER                     PIC  X(01)  VALUE '/'.   04670000
046800           10 PV-RPT-DD                  PIC  X(02)  VALUE SPACES.04680000
046900           10 FILLER                     PIC  X(01)  VALUE '/'.   04690000
047000           10 PV-RPT-CCYY                PIC  X(04)  VALUE SPACES.04700000
047100                                                                  04710000
047200       05  PV-RPT-FORMATTED-TIME.                                 04720000
047300           10 PV-RPT-HH                  PIC  X(02)  VALUE SPACES.04730000
047400           10 FILLER                     PIC  X(01)  VALUE ':'.   04740000
047500           10 PV-RPT-MIN                 PIC  X(02)  VALUE SPACES.04750000
047600           10 FILLER                     PIC  X(01)  VALUE ':'.   04760000
047700           10 PV-RPT-SS                  PIC  X(02)  VALUE SPACES.04770000
047800                                                                  04780000
047900*      05  PV-PCT-FORMAT-1.                                       04790000
048000*          10 PV-VALUE                   PIC  +ZZZ9.              04800000
048100*          10 FILLER                     PIC  X(01) VALUE '%'.    04810000
048200*                                                                 04820000
048300*      05  PV-PCT-FORMAT-2               PIC  X(06) VALUE SPACES. 04830000
048400                                                                  04840000
048500       05  PV-RES-FORMAT-1.                                       04850000
048600           10 PV-VALUE-1            PIC  ++++9.                   04860000
048700           10 FILLER                     PIC  X(01) VALUE '%'.    04870000
048800                                                                  04880000
048900       05  PV-RES-FORMAT-2.                                       04890000
049000           10 PV-VALUE-2            PIC  ++++9.                   04900000
049100           10 FILLER                     PIC  X(01) VALUE ' '.    04910000
049200                                                                  04920000
049300       05  PV-RES-FORMAT-3               PIC  X(06) VALUE SPACES. 04930000
049400                                                                  04940000
049500       05  PV-MASTER-RECORD.                                      04950000
049600           10 PV-RECORD-KEY.                                      04960000
049700              15  PV-KEY-RECORD-TYP      PIC  X(01)  VALUE SPACES.04970000
049800              15  PV-KEY-PO-NBR          PIC  9(09)  VALUE ZEROES.04980000
049900              15  PV-KEY-PO-NBR-X REDEFINES                       04990000
050000                  PV-KEY-PO-NBR          PIC  X(09).              05000000
050100              15  PV-KEY-CNTRL-NBR       PIC  9(09)  VALUE ZEROES.05010000
050200              15  PV-KEY-CNTRL-NBR-X REDEFINES                    05020000
050300                  PV-KEY-CNTRL-NBR       PIC  X(09).              05030000
050400              15  PV-KEY-TRBL-RSN-CDE    PIC  9(04)  VALUE ZEROES.05040000
050500              15  PV-KEY-TRBL-RSN-CDE-X REDEFINES                 05050000
050600                  PV-KEY-TRBL-RSN-CDE    PIC  X(04).              05060000
050700              15  PV-KEY-GROUP-TYP-CDE   PIC  X(02)  VALUE SPACES.05070000
050800              15  PV-KEY-GROUP-SEQ-NBR   PIC  9(04)  VALUE ZEROES.05080000
050900              15  PV-KEY-GROUP-SEQ-NBR-X REDEFINES                05090000
051000                  PV-KEY-GROUP-SEQ-NBR   PIC  X(04).              05100000
051100              15  FILLER                 PIC  X(479) VALUE SPACES.05110000
051200                                                                  05120000
051300 01  SD-SYSTEM-DATE.                                              05130000
051400     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      05140000
051500     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      05150000
051600     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      05160000
051700                                                                  05170000
051800 01  ST-SYSTEM-TIME.                                              05180000
051900     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      05190000
052000     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      05200000
052100     05  FILLER                     PIC  9(04)   VALUE ZERO.      05210000
052200                                                                  05220000
052300 01  ER-END-OF-REPORT-LINE.                                       05230000
052400     05  FILLER                     PIC  X(02)   VALUE SPACES.    05240000
052500     05  FILLER                     PIC  X(52)   VALUE SPACES.    05250000
052600     05  FILLER                     PIC  X(25)   VALUE            05260000
052700         '***** END OF REPORT *****'.                             05270000
052800     05  FILLER                     PIC  X(53)   VALUE SPACES.    05280000
052900                                                                  05290000
053000 01  EP-EMPTY-REPORT-LINE.                                        05300000
053100     05  FILLER                     PIC  X(02)   VALUE SPACES.    05310000
053200     05  FILLER                     PIC  X(52)   VALUE SPACES.    05320000
053300     05  FILLER                     PIC  X(25)   VALUE            05330000
053400         '******* NO DATA *********'.                             05340000
053500     05  FILLER                     PIC  X(53)   VALUE SPACES.    05350000
053600                                                                  05360000
053700 01  HL2-HEADING-LINE-2.                                          05370000
053800     05  FILLER                      PIC  X(02)  VALUE SPACES.    05380000
053900     05  FILLER                      PIC  X(51)  VALUE SPACES.    05390000
054000     05  FILLER                      PIC  X(27)  VALUE            05400000
054100         'EXCEPTION PROCESSING REPORT'.                           05410000
054200     05  FILLER                      PIC  X(52)  VALUE SPACES.    05420000
054300                                                                  05430000
054400 01  HL3-HEADING-LINE-3.                                          05440000
054500     05  FILLER                      PIC  X(02)  VALUE SPACES.    05450000
054600     05  FILLER                      PIC  X(57)  VALUE SPACES.    05460000
054700     05  FILLER                      PIC  X(15)  VALUE            05470000
054800         'TROUBLE DETAILS'.                                       05480000
054900     05  FILLER                      PIC  X(58)  VALUE SPACES.    05490000
055000                                                                  05500000
055100 01  HL4-HEADING-LINE-4.                                          05510000
055200     05  FILLER                      PIC  X(02)  VALUE SPACES.    05520000
055300     05  FILLER                      PIC  X(57)  VALUE SPACES.    05530000
055400     05  FILLER                      PIC  X(14)  VALUE            05540000
055500         'TROUBLE ERRORS'.                                        05550000
055600     05  FILLER                      PIC  X(59)  VALUE SPACES.    05560000
055700                                                                  05570000
055800 01  HL5-CONTINUE-LINE.                                           05580000
055900     05  FILLER                      PIC  X(02)  VALUE SPACES.    05590000
056000     05  FILLER                      PIC  X(45)  VALUE            05600000
056100         'CONTINUED FROM PREVIOUS PAGE FOR PO NUMBER : '.         05610000
056200     05  HL5-PO-NBR                  PIC ZZZZZZZZ9.               05620000
056300     05  HL5-PO-NBR-X         REDEFINES                           05630000
056400         HL5-PO-NBR                  PIC  X(09).                  05640000
056500     05  FILLER                      PIC  X(04)  VALUE SPACES.    05650000
056600     05  FILLER                      PIC  X(17)  VALUE            05660000
056700         'TROUBLE REASON : '.                                     05670000
056800     05  HL5-TRBL-RSN-CDE            PIC ZZZ9.                    05680000
056900     05  HL5-TRBL-RSN-CDE-X   REDEFINES                           05690000
057000         HL5-TRBL-RSN-CDE            PIC  X(04).                  05700000
057100     05  FILLER                      PIC  X(51)  VALUE SPACES.    05710000
057200                                                                  05720000
057300 01  DL-NO-UPDATES-DETAIL-LINE.                                   05730000
057400     05  FILLER                     PIC  X(02)   VALUE SPACES.    05740000
057500     05  FILLER                     PIC  X(26)   VALUE            05750000
057600         '... NO TROUBLE CREATED ...'.                            05760000
057700     05  FILLER                     PIC  X(104)  VALUE SPACES.    05770000
057800                                                                  05780000
057900 01  DL-NO-LOAD-DATA-DETAIL-LINE.                                 05790000
058000     05  FILLER                     PIC  X(02)   VALUE SPACES.    05800000
058100     05  FILLER                     PIC  X(45)   VALUE            05810000
058200         '... NO PO TRACKING KEY LOAD DATA TO REPORT...'.         05820000
058300     05  FILLER                     PIC  X(85)  VALUE SPACES.     05830000
058400                                                                  05840000
058500 01  DL1-DETAIL-LINE-1.                                           05850000
058600     05  FILLER                      PIC  X(02)  VALUE SPACES.    05860000
058700     05  FILLER                      PIC  X(24)  VALUE            05870000
058800         'PO NUMBER..............:'.                              05880000
058900     05  FILLER                      PIC  X(01)  VALUE SPACES.    05890000
059000     05  DL1-PO-NBR                  PIC  ZZZZZZZZ9.              05900000
059100     05  DL1-PO-NBR-X REDEFINES DL1-PO-NBR PIC  X(09).            05910000
059200     05  FILLER                      PIC  X(15)  VALUE SPACES.    05920000
059300     05  FILLER                      PIC  X(19)  VALUE            05930000
059400         'TROUBLE REASON....:'.                                   05940000
059500     05  FILLER                      PIC  X(01)  VALUE SPACES.    05950000
059600     05  DL1-TRBL-RSN-CDE            PIC  ZZZ9.                   05960000
059700     05  DL1-TRBL-RSN-CDE-X REDEFINES DL1-TRBL-RSN-CDE            05970000
059800                                     PIC  X(04).                  05980000
059900     05  FILLER                      PIC  X(19)  VALUE SPACES.    05990000
060000     05  FILLER                      PIC  X(17)  VALUE            06000000
060100         'EVENT.........:'.                                       06010000
060200     05  FILLER                      PIC  X(01)  VALUE SPACES.    06020000
060300     05  DL1-EVENT                   PIC  X(10)  VALUE SPACES.    06030000
060400     05  FILLER                      PIC  X(11)  VALUE SPACES.    06040000
060500                                                                  06050000
060600 01  DL2-DETAIL-LINE-2.                                           06060000
060700     05  FILLER                      PIC  X(02)  VALUE SPACES.    06070000
060800     05  FILLER                      PIC  X(24)  VALUE            06080000
060900         'TROUBLE REASON DESC....:'.                              06090000
061000     05  FILLER                      PIC  X(01)  VALUE SPACES.    06100000
061100     05  DL2-TRBL-RSN-DESC           PIC  X(20)  VALUE SPACES.    06110000
061200     05  FILLER                      PIC  X(85)  VALUE SPACES.    06120000
061300                                                                  06130000
061400 01  DL3-DETAIL-LINE-3.                                           06140000
061500     05  FILLER                      PIC  X(02)  VALUE SPACES.    06150000
061600     05  FILLER                      PIC  X(92)  VALUE SPACES.    06160000
061700     05  FILLER                      PIC  X(15)  VALUE            06170000
061800         'PO VER........:'.                                       06180000
061900     05  FILLER                      PIC  X(01)  VALUE SPACES.    06190000
062000     05  DL3-PURCHS-VER-NBR          PIC  ZZZZZZZZ9.              06200000
062100     05  DL3-PURCHS-VER-NBR-X REDEFINES DL3-PURCHS-VER-NBR        06210000
062200                                     PIC  X(09).                  06220000
062300     05  FILLER                      PIC  X(13)  VALUE SPACES.    06230000
062400                                                                  06240000
062500 01  DL4-DETAIL-LINE-4.                                           06250000
062600     05  FILLER                      PIC  X(02)  VALUE SPACES.    06260000
062700     05  FILLER                      PIC  X(92)  VALUE SPACES.    06270000
062800     05  FILLER                      PIC  X(15)  VALUE            06280000
062900         'PLN SHP VER...:'.                                       06290000
063000     05  FILLER                      PIC  X(01)  VALUE SPACES.    06300000
063100     05  DL4-PLNSHP-VER-NBR          PIC  ZZZZZZZZ9.              06310000
063200     05  DL4-PLNSHP-VER-NBR-X REDEFINES DL4-PLNSHP-VER-NBR        06320000
063300                                     PIC  X(09).                  06330000
063400     05  FILLER                      PIC  X(13)  VALUE SPACES.    06340000
063500                                                                  06350000
063600 01  DL5-DETAIL-LINE-5.                                           06360000
063700     05  FILLER                      PIC  X(02)  VALUE SPACES.    06370000
063800     05  FILLER                      PIC  X(92)  VALUE SPACES.    06380000
063900     05  FILLER                      PIC  X(15)  VALUE            06390000
064000         'PO LINE VER...:'.                                       06400000
064100     05  FILLER                      PIC  X(01)  VALUE SPACES.    06410000
064200     05  DL5-PURITM-LINE-VER-NBR     PIC  ZZZZZZZZ9.              06420000
064300     05  DL5-PURITM-LINE-VER-NBR-X REDEFINES                      06430000
064400         DL5-PURITM-LINE-VER-NBR     PIC  X(09).                  06440000
064500     05  FILLER                      PIC  X(13)  VALUE SPACES.    06450000
064600                                                                  06460000
064700 01  DL5A-DETAIL-LINE-5A.                                         06470000
064800     05  FILLER                      PIC  X(02)  VALUE SPACES.    06480000
064900     05  FILLER                      PIC  X(92)  VALUE SPACES.    06490000
065000     05  FILLER                      PIC  X(15)  VALUE            06500000
065100         'DEPARTMENT....:'.                                       06510000
065200     05  FILLER                      PIC  X(01)  VALUE SPACES.    06520000
065300     05  DL5A-DEPT                   PIC  X(03)  VALUE SPACES.    06530000
065400     05  FILLER                      PIC  X(18)  VALUE SPACES.    06540000
065500                                                                  06550000
065600 01  DL6-DETAIL-LINE-6.                                           06560000
065700     05  FILLER                      PIC  X(02)  VALUE SPACES.    06570000
065800     05  FILLER                      PIC  X(24)  VALUE            06580000
065900         'FOB CODE...............:'.                              06590000
066000     05  FILLER                      PIC  X(01)  VALUE SPACES.    06600000
066100     05  DL6-FOB-CDE                 PIC  X(05)  VALUE SPACES.    06610000
066200     05  FILLER                      PIC  X(18)  VALUE SPACES.    06620000
066300     05  FILLER                      PIC  X(22)  VALUE            06630000
066400         'POE CODE.............:'.                                06640000
066500     05  FILLER                      PIC  X(01)  VALUE SPACES.    06650000
066600     05  DL6-POE-CDE                 PIC  X(03).                  06660000
066700     05  FILLER                      PIC  X(57)  VALUE SPACES.    06670000
066800                                                                  06680000
066900 01  DL7-DETAIL-LINE-7.                                           06690000
067000     05  FILLER                      PIC  X(02)  VALUE SPACES.    06700000
067100     05  FILLER                      PIC  X(24)  VALUE            06710000
067200         'CONSOLIDATOR...........:'.                              06720000
067300     05  FILLER                      PIC  X(01)  VALUE SPACES.    06730000
067400     05  DL7-CONSLR                  PIC  X(20)  VALUE SPACES.    06740000
067500     05  FILLER                      PIC  X(03)  VALUE SPACES.    06750000
067600     05  FILLER                      PIC  X(22)  VALUE            06760000
067700         'DECONSOLIDATOR.......:'.                                06770000
067800     05  FILLER                      PIC  X(01)  VALUE SPACES.    06780000
067900     05  DL7-DCONSLR                 PIC  X(20)  VALUE SPACES.    06790000
068000     05  FILLER                      PIC  X(01)  VALUE SPACES.    06800000
068100     05  FILLER                      PIC  X(15)  VALUE            06810000
068200         'CUSTOMS BROKER:'.                                       06820000
068300     05  FILLER                      PIC  X(01)  VALUE SPACES.    06830000
068400     05  DL7-CSTM-BKR                PIC  X(20)  VALUE SPACES.    06840000
068500     05  FILLER                      PIC  X(02)  VALUE SPACES.    06850000
068600                                                                  06860000
068700                                                                  06870000
068800 01  DL8-DETAIL-LINE-8.                                           06880000
068900     05  FILLER                      PIC  X(02)  VALUE SPACES.    06890000
069000     05  FILLER                      PIC  X(24)  VALUE            06900000
069100         'START FACTORY DATE.....:'.                              06910000
069200     05  FILLER                      PIC  X(01)  VALUE SPACES.    06920000
069300     05  DL8-STRT-FCTRY-DTE          PIC  X(10)  VALUE SPACES.    06930000
069400     05  FILLER                      PIC  X(13)  VALUE SPACES.    06940000
069500     05  FILLER                      PIC  X(22)  VALUE            06950000
069600         'PO BKG DELIVERY DATE.:'.                                06960000
069700     05  FILLER                      PIC  X(01)  VALUE SPACES.    06970000
069800     05  DL8-PO-BKG-DELY-DTE         PIC  X(10)  VALUE SPACES.    06980000
069900     05  FILLER                      PIC  X(11)  VALUE SPACES.    06990000
070000     05  FILLER                      PIC  X(25)  VALUE            07000000
070100         'PO RECEIPT DATE.........:'.                             07010000
070200     05  FILLER                      PIC  X(01)  VALUE SPACES.    07020000
070300     05  DL8-PO-RCVD-DELY-DTE        PIC  X(10)  VALUE SPACES.    07030000
070400     05  FILLER                      PIC  X(02)  VALUE SPACES.    07040000
070500                                                                  07050000
070600                                                                  07060000
070700 01  DL9-DETAIL-LINE-9.                                           07070000
070800     05  FILLER                      PIC  X(02)  VALUE SPACES.    07080000
070900     05  FILLER                      PIC  X(24)  VALUE            07090000
071000         'LAST FACTORY DATE......:'.                              07100000
071100     05  FILLER                      PIC  X(01)  VALUE SPACES.    07110000
071200     05  DL9-LAST-FCTRY-DTE          PIC  X(10)  VALUE SPACES.    07120000
071300     05  FILLER                      PIC  X(13)  VALUE SPACES.    07130000
071400     05  FILLER                      PIC  X(22)  VALUE            07140000
071500         'CONTNR PICK UP DATE..:'.                                07150000
071600     05  FILLER                      PIC  X(01)  VALUE SPACES.    07160000
071700     05  DL9-CONTNR-PU-DTE           PIC  X(10)  VALUE SPACES.    07170000
071800     05  FILLER                      PIC  X(11)  VALUE SPACES.    07180000
071900     05  FILLER                      PIC  X(25)  VALUE            07190000
072000         'FOB EST SAIL DATE.......:'.                             07200000
072100     05  FILLER                      PIC  X(01)  VALUE SPACES.    07210000
072200     05  DL9-EST-DPRTR-DTE           PIC  X(10)  VALUE SPACES.    07220000
072300     05  FILLER                      PIC  X(02)  VALUE SPACES.    07230000
072400                                                                  07240000
072500 01  DL10-DETAIL-LINE-10.                                         07250000
072600     05  FILLER                      PIC  X(02)  VALUE SPACES.    07260000
072700     05  FILLER                      PIC  X(24)  VALUE            07270000
072800         'ACTL POE ARRIVAL DATE..:'.                              07280000
072900     05  FILLER                      PIC  X(01)  VALUE SPACES.    07290000
073000     05  DL10-MOM-POE-DELY-DTE       PIC  X(10)  VALUE SPACES.    07300000
073100     05  FILLER                      PIC  X(95)  VALUE SPACES.    07310000
073200                                                                  07320000
073300 01  DL11-DETAIL-LINE-11.                                         07330000
073400     05  FILLER                      PIC  X(02)  VALUE SPACES.    07340000
073500     05  FILLER                      PIC  X(24)  VALUE            07350000
073600         'PO UNIT QUANTITY.......:'.                              07360000
073700     05  FILLER                      PIC  X(01)  VALUE SPACES.    07370000
073800     05  DL11-PURCHS-UNT-QTY         PIC ZZZZZZZZ9.               07380000
073900     05  DL11-PURCHS-UNT-QTY-X REDEFINES DL11-PURCHS-UNT-QTY      07390000
074000                                     PIC  X(09).                  07400000
074100     05  FILLER                      PIC  X(14)  VALUE SPACES.    07410000
074200     05  FILLER                      PIC  X(22)  VALUE            07420000
074300         'PO BKG UNIT QUANTITY.:'.                                07430000
074400     05  FILLER                      PIC  X(01)  VALUE SPACES.    07440000
074500     05  DL11-IMBKPO-PO-UNT-QTY      PIC ZZZZZZZZ9.               07450000
074600     05  DL11-IMBKPO-PO-UNT-QTY-X REDEFINES                       07460000
074700         DL11-IMBKPO-PO-UNT-QTY      PIC  X(09).                  07470000
074800     05  FILLER                      PIC  X(12)  VALUE SPACES.    07480000
074900     05  FILLER                      PIC  X(25)  VALUE            07490000
075000         'PO RECEIPT UNIT QUANTITY:'.                             07500000
075100     05  FILLER                      PIC  X(01)  VALUE SPACES.    07510000
075200     05  DL11-IMRCPO-PO-UNT-QTY      PIC ZZZZZZZZ9.               07520000
075300     05  DL11-IMRCPO-PO-UNT-QTY-X REDEFINES                       07530000
075400         DL11-IMRCPO-PO-UNT-QTY      PIC  X(09).                  07540000
075500     05  FILLER                      PIC  X(02)  VALUE SPACES.    07550000
075600                                                                  07560000
075700 01  DL12-DETAIL-LINE-12.                                         07570000
075800     05  FILLER                      PIC  X(02)  VALUE SPACES.    07580000
075900     05  FILLER                      PIC  X(24)  VALUE            07590000
076000         'CONTNR UNIT QUANTITY...:'.                              07600000
076100     05  FILLER                      PIC  X(01)  VALUE SPACES.    07610000
076200     05  DL12-IMCNPO-PO-UNT-QTY      PIC ZZZZZZZZ9.               07620000
076300     05  DL12-IMCNPO-PO-UNT-QTY-X REDEFINES                       07630000
076400         DL12-IMCNPO-PO-UNT-QTY      PIC  X(09).                  07640000
076500     05  FILLER                      PIC  X(96)  VALUE SPACES.    07650000
076600                                                                  07660000
076700 01  DL13-DETAIL-LINE-13.                                         07670000
076800     05  FILLER                      PIC  X(02)  VALUE SPACES.    07680000
076900     05  FILLER                      PIC  X(24)  VALUE            07690000
077000         'BEGIN DAY/PCT QUANTITY.:'.                              07700000
077100     05  FILLER                      PIC  X(01)  VALUE SPACES.    07710000
077200     05  DL13-BEG-LMT-QTY            PIC ++++9.                   07720000
077300     05  DL13-BEG-LMT-QTY-X    REDEFINES DL13-BEG-LMT-QTY         07730000
077400                                     PIC  X(05).                  07740000
077500     05  DL13-BEG-LMT-FILLER         PIC  X(07)  VALUE SPACES.    07750000
077600     05  FILLER                      PIC  X(11)  VALUE SPACES.    07760000
077700     05  FILLER                      PIC  X(22)  VALUE            07770000
077800         'END DAY/PCT QUANTITY.:'.                                07780000
077900     05  FILLER                      PIC  X(01)  VALUE SPACES.    07790000
078000     05  DL13-END-LMT-QTY            PIC ++++9.                   07800000
078100     05  DL13-END-LMT-QTY-X    REDEFINES DL13-END-LMT-QTY         07810000
078200                                     PIC  X(05).                  07820000
078300     05  DL13-END-LMT-FILLER         PIC  X(07)  VALUE SPACES.    07830000
078400     05  FILLER                      PIC  X(09)  VALUE SPACES.    07840000
078500     05  FILLER                      PIC  X(25)  VALUE            07850000
078600         'CONTROL TYPE CODE.......:'.                             07860000
078700     05  FILLER                      PIC  X(01)  VALUE SPACES.    07870000
078800     05  DL13-CNTRL-TYP-CDE          PIC  X(02)  VALUE ZEROES.    07880000
078900     05  FILLER                      PIC  X(10)  VALUE SPACES.    07890000
079000                                                                  07900000
079100 01  DL14-DETAIL-LINE-14.                                         07910000
079200     05  FILLER                      PIC  X(02)  VALUE SPACES.    07920000
079300     05  FILLER                      PIC  X(12)  VALUE SPACES.    07930000
079400     05  FILLER                      PIC  X(04)  VALUE            07940000
079500         'RULE'.                                                  07950000
079600     05  FILLER                      PIC  X(20)  VALUE SPACES.    07960000
079700     05  FILLER                      PIC  X(04)  VALUE            07970000
079800         'RULE'.                                                  07980000
079900     05  FILLER                      PIC  X(08)  VALUE SPACES.    07990000
080000     05  FILLER                      PIC  X(04)  VALUE            08000000
080100         'RULE'.                                                  08010000
080200     05  FILLER                      PIC  X(06)  VALUE SPACES.    08020000
080300     05  FILLER                      PIC  X(14)  VALUE            08030000
080400         'RULE CONDITION'.                                        08040000
080500     05  FILLER                      PIC  X(08)  VALUE SPACES.    08050000
080600     05  FILLER                      PIC  X(04)  VALUE            08060000
080700         'RULE'.                                                  08070000
080800     05  FILLER                      PIC  X(08)  VALUE SPACES.    08080000
080900     05  FILLER                      PIC  X(11)  VALUE            08090000
081000         'RULE RESULT'.                                           08100000
081100     05  FILLER                      PIC  X(07)  VALUE SPACES.    08110000
081200     05  FILLER                      PIC  X(14)  VALUE            08120000
081300         'SOURCE PROCESS'.                                        08130000
081400     05  FILLER                      PIC  X(16)  VALUE SPACES.    08140000
081500                                                                  08150000
081600 01  DL15-DETAIL-LINE-15.                                         08160000
081700     05  FILLER                      PIC  X(02)  VALUE SPACES.    08170000
081800     05  FILLER                      PIC  X(12)  VALUE SPACES.    08180000
081900     05  FILLER                      PIC  X(04)  VALUE            08190000
082000         'NAME'.                                                  08200000
082100     05  FILLER                      PIC  X(20)  VALUE SPACES.    08210000
082200     05  FILLER                      PIC  X(04)  VALUE            08220000
082300         'TYPE'.                                                  08230000
082400     05  FILLER                      PIC  X(05)  VALUE SPACES.    08240000
082500     05  FILLER                      PIC  X(12)  VALUE            08250000
082600         'CONDITION'.                                             08260000
082700     05  FILLER                      PIC  X(02)  VALUE SPACES.    08270000
082800     05  FILLER                      PIC  X(12)  VALUE            08280000
082900         'PROCESS CODE'.                                          08290000
083000     05  FILLER                      PIC  X(06)  VALUE SPACES.    08300000
083100     05  FILLER                      PIC  X(10)  VALUE            08310000
083200         '(DAYS/PCT)'.                                            08320000
083300     05  FILLER                      PIC  X(06)  VALUE SPACES.    08330000
083400     05  FILLER                      PIC  X(15)  VALUE            08340000
083500         'INDICATOR'.                                             08350000
083600     05  FILLER                      PIC  X(05)  VALUE SPACES.    08360000
083700     05  FILLER                      PIC  X(09)  VALUE            08370000
083800         'APPL CODE'.                                             08380000
083900     05  FILLER                      PIC  X(18)  VALUE SPACES.    08390000
084000                                                                  08400000
084100 01  DL16-DETAIL-LINE-16.                                         08410000
084200     05  FILLER                      PIC  X(02)  VALUE SPACES.    08420000
084300     05  DL16-CURR-RUL-NAME          PIC  X(30)  VALUE SPACES.    08430000
084400     05  FILLER                      PIC  X(06)  VALUE SPACES.    08440000
084500     05  DL16-CURR-RUL-RET-TYP       PIC  X(03)  VALUE SPACES.    08450000
084600     05  FILLER                      PIC  X(10)  VALUE SPACES.    08460000
084700     05  DL16-CURR-RUL-COND-IND      PIC  X(01)  VALUE SPACES.    08470000
084800     05  FILLER                      PIC  X(15)  VALUE SPACES.    08480000
084900     05  DL16-CURR-RUL-COND-PROC-CDE PIC  X(01)  VALUE SPACES.    08490000
085000     05  FILLER                      PIC  X(13)  VALUE SPACES.    08500000
085100     05  DL16-CURR-RUL-RES           PIC  X(06)  VALUE SPACES.    08510000
085200     05  DL16-CURR-RUL-RES-FILLER    PIC  X(07)  VALUE SPACES.    08520000
085300     05  FILLER                      PIC  X(06)  VALUE SPACES.    08530000
085400     05  DL16-CURR-RUL-RES-IND       PIC  X(01)  VALUE SPACES.    08540000
085500     05  FILLER                      PIC  X(14)  VALUE SPACES.    08550000
085600     05  DL16-APPL-CDE               PIC  X(10)  VALUE SPACES.    08560000
085700     05  FILLER                      PIC  X(12)  VALUE SPACES.    08570000
085800                                                                  08580000
085900 01  DL17-DETAIL-LINE-17.                                         08590000
086000     05  FILLER                      PIC  X(02)  VALUE SPACES.    08600000
086100     05  FILLER                      PIC  X(18)  VALUE            08610000
086200         'ACTION...........:'.                                    08620000
086300     05  FILLER                      PIC  X(02)  VALUE SPACES.    08630000
086400     05  DL17-ACTION                 PIC  X(15)  VALUE SPACES.    08640000
086500     05  FILLER                      PIC  X(01)  VALUE SPACES.    08650000
086600     05  FILLER                      PIC  X(25)  VALUE            08660000
086700         'NOTIFY DATE/TIME........:'.                             08670000
086800     05  FILLER                      PIC  X(01)  VALUE SPACES.    08680000
086900     05  DL17-NOTIFY                 PIC  X(19)  VALUE SPACES.    08690000
087000     05  FILLER                      PIC  X(08)  VALUE SPACES.    08700000
087100     05  DL17-UPD-RES-FILLER         PIC  X(09)  VALUE SPACES.    08710000
087200     05  FILLER                      PIC  X(11)  VALUE            08720000
087300         'DATE/TIME.:'.                                           08730000
087400     05  FILLER                      PIC  X(01)  VALUE SPACES.    08740000
087500     05  DL17-UPD-RES                PIC  X(19)  VALUE SPACES.    08750000
087600     05  FILLER                      PIC  X(01)  VALUE SPACES.    08760000
087700                                                                  08770000
087800 01  DL18-DETAIL-LINE-18.                                         08780000
087900     05  FILLER                      PIC  X(02)  VALUE SPACES.    08790000
088000     05  FILLER                      PIC  X(18)  VALUE            08800000
088100         'INITIATOR........:'.                                    08810000
088200     05  FILLER                      PIC  X(01)  VALUE SPACES.    08820000
088300     05  DL18-INITIATOR              PIC  X(15)  VALUE SPACES.    08830000
088400     05  FILLER                      PIC  X(02)  VALUE SPACES.    08840000
088500     05  FILLER                      PIC  X(25)  VALUE            08850000
088600         'RESPONSIBLE PARTY.......:'.                             08860000
088700     05  FILLER                      PIC  X(01)  VALUE SPACES.    08870000
088800     05  DL18-RESP-PARTY             PIC  X(10)  VALUE SPACES.    08880000
088900     05  FILLER                      PIC  X(17)  VALUE SPACES.    08890000
089000     05  FILLER                      PIC  X(20)  VALUE            08900000
089100         'REPORTED AGAINST...:'.                                  08910000
089200     05  FILLER                      PIC  X(01)  VALUE SPACES.    08920000
089300     05  DL18-RPTD-AGAINST           PIC  X(10)  VALUE SPACES.    08930000
089400     05  FILLER                      PIC  X(10)  VALUE SPACES.    08940000
089500                                                                  08950000
089600                                                                  08960000
089700 01  DL19-DETAIL-LINE-19.                                         08970000
089800     05  FILLER                      PIC  X(02)  VALUE SPACES.    08980000
089900     05  FILLER                      PIC  X(18)  VALUE            08990000
090000         'RESOLUTION ACTION:'.                                    09000000
090100     05  FILLER                      PIC  X(01)  VALUE SPACES.    09010000
090200     05  DL19-RESOLU-ACTION          PIC  X(15)  VALUE SPACES.    09020000
090300     05  FILLER                      PIC  X(02)  VALUE SPACES.    09030000
090400     05  FILLER                      PIC  X(25)  VALUE            09040000
090500         'EARLY/LATE DAY QTY......:'.                             09050000
090600     05  FILLER                      PIC  X(01)  VALUE SPACES.    09060000
090700     05  DL19-EARLY-LATE-DAY-QTY     PIC ++++9.                   09070000
090800     05  DL19-EARLY-LATE-DAY-QTY-X REDEFINES                      09080000
090900         DL19-EARLY-LATE-DAY-QTY     PIC  X(05).                  09090000
091000     05  FILLER                      PIC  X(22)  VALUE SPACES.    09100000
091100     05  FILLER                      PIC  X(20)  VALUE            09110000
091200         'OVER/SHORT PCT QTY.:'.                                  09120000
091300     05  FILLER                      PIC  X(01)  VALUE SPACES.    09130000
091400     05  DL19-OVER-SHORT-PCT         PIC ++++9.                   09140000
091500     05  DL19-OVER-SHORT-PCT-X  REDEFINES                         09150000
091600         DL19-OVER-SHORT-PCT         PIC  X(05).                  09160000
091700     05  DL19-PCT-FILLER             PIC  X(01)  VALUE '%'.       09170000
091800     05  FILLER                      PIC  X(20)  VALUE SPACES.    09180000
091900                                                                  09190000
092000 01  DL20-DETAIL-LINE-20.                                         09200000
092100     05  FILLER                      PIC  X(02)  VALUE SPACES.    09210000
092200     05  FILLER                      PIC  X(12)  VALUE            09220000
092300         'BKG DELIVERY'.                                          09230000
092400     05  FILLER                      PIC  X(06)  VALUE SPACES.    09240000
092500     05  FILLER                      PIC  X(07)  VALUE            09250000
092600         'RECEIPT'.                                               09260000
092700     05  FILLER                      PIC  X(11)  VALUE SPACES.    09270000
092800     05  FILLER                      PIC  X(06)  VALUE            09280000
092900         'IMPORT'.                                                09290000
093000     05  FILLER                      PIC  X(18)  VALUE SPACES.    09300000
093100     05  FILLER                      PIC  X(08)  VALUE            09310000
093200         'FOB ACTL'.                                              09320000
093300     05  FILLER                      PIC  X(24)  VALUE SPACES.    09330000
093400     05  FILLER                      PIC  X(06)  VALUE            09340000
093500         'IMPORT'.                                                09350000
093600     05  FILLER                      PIC  X(13)  VALUE SPACES.    09360000
093700     05  FILLER                      PIC  X(06)  VALUE            09370000
093800         'IMPORT'.                                                09380000
093900     05  FILLER                      PIC  X(12)  VALUE SPACES.    09390000
094000                                                                  09400000
094100 01  DL21-DETAIL-LINE-21.                                         09410000
094200     05  FILLER                      PIC  X(02)  VALUE SPACES.    09420000
094300     05  FILLER                      PIC  X(04)  VALUE SPACES.    09430000
094400     05  FILLER                      PIC  X(04)  VALUE            09440000
094500         'DATE'.                                                  09450000
094600     05  FILLER                      PIC  X(11)  VALUE SPACES.    09460000
094700     05  FILLER                      PIC  X(04)  VALUE            09470000
094800         'DATE'.                                                  09480000
094900     05  FILLER                      PIC  X(15)  VALUE SPACES.    09490000
095000     05  FILLER                      PIC  X(02)  VALUE            09500000
095100         'ID'.                                                    09510000
095200     05  FILLER                      PIC  X(20)  VALUE SPACES.    09520000
095300     05  FILLER                      PIC  X(09)  VALUE            09530000
095400         'SAIL DATE'.                                             09540000
095500     05  FILLER                      PIC  X(23)  VALUE SPACES.    09550000
095600     05  FILLER                      PIC  X(07)  VALUE            09560000
095700         'SEQ NBR'.                                               09570000
095800     05  FILLER                      PIC  X(11)  VALUE SPACES.    09580000
095900     05  FILLER                      PIC  X(08)  VALUE            09590000
096000         'KEY TYPE'.                                              09600000
096100     05  FILLER                      PIC  X(05)  VALUE SPACES.    09610000
096200                                                                  09620000
096300 01  DL22-DETAIL-LINE-22.                                         09630000
096400     05  FILLER                      PIC  X(02)  VALUE SPACES.    09640000
096500     05  DL22-BKG-DELY-DTE           PIC  X(10)  VALUE SPACES.    09650000
096600     05  FILLER                      PIC  X(08)  VALUE SPACES.    09660000
096700     05  DL22-RCVG-DELY-DTE          PIC  X(10)  VALUE SPACES.    09670000
096800     05  FILLER                      PIC  X(05)  VALUE SPACES.    09680000
096900     05  DL22-IMPRT-ID               PIC  X(12)  VALUE SPACES.    09690000
097000     05  FILLER                      PIC  X(18)  VALUE SPACES.    09700000
097100     05  DL22-FOB-ACTL-DPRTR-DTE     PIC  X(10)  VALUE SPACES.    09710000
097200     05  FILLER                      PIC  X(20)  VALUE SPACES.    09720000
097300     05  DL22-IMPRT-SEQ-NBR          PIC ZZZ9.                    09730000
097400     05  DL22-IMPRT-SEQ-NBR-X REDEFINES                           09740000
097500         DL22-IMPRT-SEQ-NBR          PIC  X(04).                  09750000
097600     05  FILLER                      PIC  X(16)  VALUE SPACES.    09760000
097700     05  DL22-IMPRT-KEY-TYP          PIC  X(02)  VALUE SPACES.    09770000
097800     05  FILLER                      PIC  X(06)  VALUE SPACES.    09780000
097900                                                                  09790000
098000 01  DL23-DETAIL-LINE-23.                                         09800000
098100     05  FILLER                      PIC  X(02)  VALUE SPACES.    09810000
098200     05  FILLER                      PIC  X(09)  VALUE            09820000
098300         'PO NUMBER'.                                             09830000
098400     05  FILLER                      PIC  X(03)  VALUE SPACES.    09840000
098500     05  FILLER                      PIC  X(19)  VALUE            09850000
098600         'TROUBLE REASON CODE'.                                   09860000
098700     05  FILLER                      PIC  X(02)  VALUE SPACES.    09870000
098800     05  FILLER                      PIC  X(05)  VALUE            09880000
098900         'FOB'.                                                   09890000
099000     05  FILLER                      PIC  X(02)  VALUE SPACES.    09900000
099100     05  FILLER                      PIC  X(09)  VALUE            09910000
099200         'RULE NAME'.                                             09920000
099300     05  FILLER                      PIC  X(28)  VALUE SPACES.    09930000
099400     05  FILLER                      PIC  X(07)  VALUE            09940000
099500         'ERROR'.                                                 09950000
099600     05  FILLER                      PIC  X(46)  VALUE SPACES.    09960000
099700                                                                  09970000
099800 01  DL24-DETAIL-LINE-24.                                         09980000
099900     05  FILLER                      PIC  X(02)  VALUE SPACES.    09990000
100000     05  DL24-PO-NBR                 PIC ZZZZZZZZ9.               10000000
100100     05  DL24-PO-NBR-X        REDEFINES                           10010000
100200         DL24-PO-NBR                 PIC  X(09).                  10020000
100300     05  FILLER                      PIC  X(10)  VALUE SPACES.    10030000
100400     05  DL24-TRBL-RSN-CDE           PIC ZZZ9.                    10040000
100500     05  DL24-TRBL-RSN-CDE-X  REDEFINES                           10050000
100600         DL24-TRBL-RSN-CDE           PIC  X(04).                  10060000
100700     05  FILLER                      PIC  X(10)  VALUE SPACES.    10070000
100800     05  DL24-FOB-CDE                PIC  X(05)  VALUE SPACES.    10080000
100900     05  FILLER                      PIC  X(02)  VALUE SPACES.    10090000
101000     05  DL24-CURR-RUL-NAME          PIC  X(30)  VALUE SPACES.    10100000
101100     05  FILLER                      PIC  X(07)  VALUE SPACES.    10110000
101200     05  DL24-TRBL-ERROR-TEXT        PIC  X(50)  VALUE SPACES.    10120000
101300     05  FILLER                      PIC  X(03)  VALUE SPACES.    10130000
101400                                                                  10140000
101500 EJECT                                                            10150000
101600                                                                  10160000
101700******************************************************************10170000
101800 LINKAGE SECTION.                                                 10180000
101900******************************************************************10190000
102000                                                                  10200000
102100******************************************************************10210000
102200 PROCEDURE DIVISION.                                              10220000
102300******************************************************************10230000
102400******************************************************************10240000
102500*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *10250000
102600******************************************************************10260000
102700 0000-PROGRAM-MAINLINE.                                           10270000
102800                                                                  10280000
102900     PERFORM 1000-INITIALIZE.                                     10290000
103000                                                                  10300000
103100     PERFORM 2000-PROCESS-EXCEPTIONS                              10310000
103200       UNTIL PS-END-OF-EXCEPTIONS.                                10320000
103300                                                                  10330000
103400     PERFORM 8000-EOJ-ROUTINE.                                    10340000
103500     STOP RUN.                                                    10350000
103600                                                                  10360000
103700******************************************************************10370000
103800* OPENS FILES, INITIALIZES ACCUMULATORS, DETERMINES RUN DATE AND  10380000
103900* TIME, DOES A PRIMING READ AND LOADS CONTROL BREAK COMPARE FIELDS10390000
104000******************************************************************10400000
104100 1000-INITIALIZE.                                                 10410000
104200                                                                  10420000
104300     OPEN INPUT  EXCEPTION-FILE                                   10430000
104400          OUTPUT EXCEPTION-DETAIL-FILE                            10440000
104500                 EXCEPTION-ERROR-FILE.                            10450000
104600                                                                  10460000
104700     INITIALIZE   PV-MASTER-RECORD                                10470000
104800                  PV-RPT-FORMATTED-DATE                           10480000
104900                  TM600-RECORD                                    10490000
105000                  TM602-RECORD                                    10500000
105100                  TM603-RECORD                                    10510000
105200                  TM604-RECORD                                    10520000
105300                  TM605-RECORD                                    10530000
105400                  PA-TOTAL-RECORDS-READ                           10540000
105500                  PA-DETAILS-WRITTEN                              10550000
105600                  PA-ERRORS-WRITTEN.                              10560000
105700                                                                  10570000
105800     ACCEPT SD-SYSTEM-DATE FROM DATE.                             10580000
105900     ACCEPT ST-SYSTEM-TIME FROM TIME.                             10590000
106000                                                                  10600000
106100     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              10610000
106200     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             10620000
106300     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               10630000
106400     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              10640000
106500     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            10650000
106600                                                                  10660000
106700     MOVE PC-CURRENT-PROGRAM-NAME                                 10670000
106800                                 TO DP132O-PROGRAM-NAME.          10680000
106900                                                                  10690000
107000     SET  PS-GOOD-RECORD-NO      TO TRUE.                         10700000
107100                                                                  10710000
107200     PERFORM 6000-READ-EXCEPTION-RECORD                           10720000
107300     UNTIL  PS-GOOD-RECORD OR PS-END-OF-EXCEPTIONS.               10730000
107400     SET  PS-GOOD-RECORD-NO      TO TRUE.                         10740000
107500                                                                  10750000
107600     MOVE PV-KEY-PO-NBR-X    TO PV-CURRENT-PO-NBR-X.              10760000
107700     MOVE PV-KEY-CNTRL-NBR-X TO PV-CURRENT-CNTRL-NBR-X.           10770000
107800                                                                  10780000
107900      IF PV-KEY-GROUP-TYP-CDE EQUAL PC-01                         10790000
108000         MOVE PV-KEY-TRBL-RSN-CDE   TO PV-CURRENT-TRBL-RSN-CDE-X  10800000
108100      END-IF.                                                     10810000
108200                                                                  10820000
108300 EJECT                                                            10830000
108400                                                                  10840000
108500******************************************************************10850000
108600* DETERMINES IF RECORD IS DETAIL OR ERROR. THE DETAILS SHOULD BE  10860000
108700* FIRST IF THE INPUT WAS SORTED PROPERLY. THE REPORT TITLES       10870000
108800* WILL BE WRITTEN FOR THE FIRST TIME HERE, THEN AFTER, THEY WILL  10880000
108900* BE WRITTEN FROM PARA 6200-CHECK-LINE-COUNT. THE GROUP-TYP       10890000
109000* WILL BE DETERMINED IN PARA 2100-, WHICH CONTROLS PROCESSING.    10900000
109100******************************************************************10910000
109200 2000-PROCESS-EXCEPTIONS.                                         10920000
109300                                                                  10930000
109400      SET PS-REPORT-TYPE-IS-ERROR-NO         TO TRUE.             10940000
109500      SET PS-REPORT-TYPE-IS-DETAIL-NO        TO TRUE.             10950000
109600                                                                  10960000
109700      EVALUATE PV-KEY-RECORD-TYP                                  10970000
109800          WHEN PC-E                                               10980000
109900               MOVE PC-2             TO DP132O-REPORT-NUMBER      10990000
110000               SET PS-REPORT-TYPE-IS-ERROR   TO TRUE              11000000
110100          WHEN PC-D                                               11010000
110200               MOVE PC-1             TO DP132O-REPORT-NUMBER      11020000
110300               SET PS-REPORT-TYPE-IS-DETAIL  TO TRUE              11030000
110400      END-EVALUATE.                                               11040000
110600                                                                  11060000
110700      IF PS-REPORT-TYPE-IS-ERROR                                  11070000
110800        IF PS-ERROR-HEADINGS-WRITTEN-NO                           11080000
110900          PERFORM 7001-WRITE-ERROR-HEADINGS                       11090000
111000        END-IF                                                    11100000
111100        PERFORM 3000-PROCESS-ERROR-LINE                           11110000
111200      END-IF.                                                     11120000
111300                                                                  11130000
111400      IF PS-REPORT-TYPE-IS-DETAIL                                 11140000
111500        IF PS-DETAIL-HEADINGS-WRITTEN-NO                          11150000
111600          PERFORM 7000-WRITE-DETAIL-HEADINGS                      11160000
111700        END-IF                                                    11170000
111800        PERFORM 2100-DETERMINE-GROUP-TYPE                         11180000
111900      END-IF.                                                     11190000
112000                                                                  11200000
112800      PERFORM 6000-READ-EXCEPTION-RECORD                          11280000
112900                UNTIL PS-GOOD-RECORD OR PS-END-OF-EXCEPTIONS.     11290000
113000                                                                  11300000
113100      SET   PS-GOOD-RECORD-NO            TO TRUE.                 11310000
113200                                                                  11320000
113300 EJECT                                                            11330000
113400                                                                  11340000
113500******************************************************************11350000
113600* THIS IS THE PROCESSING FOR ALL DETAILS.                        *11360000
113700* GENERALLY THE PROCESSING IS AS FOLLOWS:                        *11370000
113800* 1) MOVE THE CURRENT RECORD INTO ITS APPROPRIATE COPYBOOK.      *11380000
113900* 2) BUILD ONE DETAIL LINE AT A TIME BY LOADING THE CORRESPONDING*11390000
114000*    WORKING STORAGE FIELD.                                      *11400000
114100* 3) CHECK THE LINE COUNT AND WRITE EACH DETAIL LINE AS IT IS    *11410000
114200*    BUILT, ENSURING THAT THERE IS ENOUGH ROOM ON THE PAGE.      *11420000
114300*    THE EXCEPTION IS FOR GROUP 3, WHICH IS BETWEEN TWO POSSIBLY *11430000
114400*    VARIABLE LENGTH DETAIL GROUPS, SO BUILD ALL 3 DETAIL LINES  *11440000
114500*    OF GROUP 3 FIRST, THEN DETERMINE TO WRITE ON THIS PAGE OR   *11450000
114600*    NEXT.                                                       *11460000
114700* 4) KEEP COUNTS OF TOTAL RECORDS READ, PO GROUPS (WHICH CONSIST *11470000
114800*    OF A PO NBR, TRBL REASON AND CONTROL NBR), DETAILS WRITTEN  *11480000
114900******************************************************************11490000
114910                                                                  11491000
115000 2100-DETERMINE-GROUP-TYPE.                                       11500000
115100                                                                  11510000
115104     IF PV-KEY-GROUP-TYP-CDE = PC-01                              11510400
115105       INITIALIZE TM602-RECORD                                    11510500
115106       MOVE PV-MASTER-RECORD       TO TM602-RECORD                11510600
115107       IF  TM602-CURR-TRBL-PROCESS-SW = PC-T                      11510700
115108        OR TM602-CURR-RSLV-PROCESS-SW = PC-R                      11510800
115110         SET PS-PROCESS         TO TRUE                           11511000
115111       ELSE                                                       11511100
115112         SET PS-PROCESS-NO      TO TRUE                           11511200
115113       END-IF                                                     11511300
115114     END-IF.                                                      11511400
115120                                                                  11512000
115130     IF PS-PROCESS                                                11513000
115200       EVALUATE PV-KEY-GROUP-TYP-CDE                              11520000
115300          WHEN PC-01                                              11530000
115400           PERFORM 4100-PROCESS-GROUP-1-LINES                     11540000
115500         WHEN PC-02                                               11550000
115600           PERFORM 4200-PROCESS-GROUP-2-LINES                     11560000
115700         WHEN PC-03                                               11570000
115800           PERFORM 4300-PROCESS-GROUP-3-LINES                     11580000
115900         WHEN PC-04                                               11590000
116000           PERFORM 4400-PROCESS-GROUP-4-LINES                     11600000
116100       END-EVALUATE                                               11610000
116110     END-IF.                                                      11611000
116200                                                                  11620000
116300 EJECT                                                            11630000
116400                                                                  11640000
116500******************************************************************11650000
116600* BUILD ERROR LINES AND WRITE THEM ONE AT A TIME, ONLY AFTER     *11660000
116700* FINISHING UP THE DETAIL REPORT WITH AN "END-OF-REPORT" MSG.    *11670000
116800******************************************************************11680000
116900 3000-PROCESS-ERROR-LINE.                                         11690000
117000                                                                  11700000
117100     INITIALIZE TM600-RECORD.                                     11710000
117200     MOVE PV-MASTER-RECORD       TO TM600-RECORD.                 11720000
117300                                                                  11730000
117400     INITIALIZE                     DL24-PO-NBR                   11740000
117500                                    DL24-TRBL-RSN-CDE             11750000
117600                                    DL24-FOB-CDE                  11760000
117700                                    DL24-CURR-RUL-NAME            11770000
117800                                    DL24-TRBL-ERROR-TEXT.         11780000
117900                                                                  11790000
118000     MOVE TM600-PO-NBR           TO DL24-PO-NBR.                  11800000
118100     IF TM600-TRBL-RSN-CDE EQUAL ZEROES                           11810000
118200        MOVE PC-NA               TO DL24-TRBL-RSN-CDE-X           11820000
118300     ELSE                                                         11830000
118400        MOVE TM600-TRBL-RSN-CDE  TO DL24-TRBL-RSN-CDE             11840000
118500     END-IF.                                                      11850000
118600                                                                  11860000
118700     MOVE TM600-FOB-CDE          TO DL24-FOB-CDE.                 11870000
118800     MOVE TM600-CURR-RUL-NAME    TO DL24-CURR-RUL-NAME.           11880000
118900     MOVE TM600-TRBL-ERROR-TEXT  TO DL24-TRBL-ERROR-TEXT.         11890000
119000                                                                  11900000
119100     IF PS-PROCESS                                                11910002
119200       PERFORM 3100-WRAP-UP-DETAIL-LINE                           11920002
120200     END-IF.                                                      12020002
123800                                                                  12380000
123900     IF PS-END-OF-EXCEPTIONS-NO                                   12390000
124000        SET PS-NEW-PAGE-WRITTEN-NO     TO TRUE                    12400000
124100        PERFORM 6200-CHECK-LINE-COUNT                             12410000
124200     END-IF.                                                      12420000
124300                                                                  12430000
124400     IF PS-NEW-PAGE-WRITTEN-NO                                    12440000
124500        IF PS-ERROR-HEADINGS-WRITTEN-NO                           12450000
124600           WRITE EXCEPTION-ERROR-RECORD                           12460000
124700           FROM  DL23-DETAIL-LINE-23                              12470000
124800                 AFTER ADVANCING 2 LINES                          12480000
124900                                                                  12490000
125000           SET PS-ERROR-HEADINGS-WRITTEN    TO TRUE               12500000
125100                                                                  12510000
125200           WRITE EXCEPTION-ERROR-RECORD                           12520000
125300           FROM  DL24-DETAIL-LINE-24                              12530000
125400                 AFTER ADVANCING 2 LINES                          12540000
125500                                                                  12550000
125600           ADD  +1       TO PA-ERRORS-WRITTEN                     12560000
125700           ADD  +4       TO PV-LINE-COUNT                         12570000
125800        ELSE                                                      12580000
125900           WRITE EXCEPTION-ERROR-RECORD                           12590000
126000           FROM  DL24-DETAIL-LINE-24                              12600000
126100                 AFTER ADVANCING 2 LINES                          12610000
126200                                                                  12620000
126300           ADD  +1       TO PA-ERRORS-WRITTEN                     12630000
126400           ADD  +2       TO PV-LINE-COUNT                         12640000
126500        END-IF                                                    12650000
126600     ELSE                                                         12660000
126700        CONTINUE                                                  12670000
126800     END-IF.                                                      12680000
126900                                                                  12690000
127000                                                                  12700000
127100     IF PV-KEY-RECORD-TYP  EQUAL PC-E  AND                        12710000
127200        PS-END-OF-EXCEPTIONS           AND                        12720000
127300        PA-ERRORS-WRITTEN   >    ZERO  AND                        12730000
127400        PV-LINE-COUNT       <  PC-PAGE-SIZE-060                   12740000
127500           WRITE EXCEPTION-ERROR-RECORD                           12750000
127600              FROM ER-END-OF-REPORT-LINE                          12760000
127700              AFTER ADVANCING 4 LINES                             12770000
127800     ELSE                                                         12780000
127900        IF PV-KEY-RECORD-TYP  EQUAL PC-E  AND                     12790000
128000           PS-END-OF-EXCEPTIONS           AND                     12800000
128100           PA-ERRORS-WRITTEN   >    ZERO  AND                     12810000
128200           PV-LINE-COUNT       >  PC-PAGE-SIZE-060                12820000
128300              ADD  +1             TO PV-PAGE-COUNT                12830000
128400              MOVE PV-PAGE-COUNT  TO DP132O-PAGE-NUMBER           12840000
128500              WRITE EXCEPTION-ERROR-RECORD                        12850000
128600              FROM  DP132O-STANDRD-HEADER-132-COLS                12860000
128700              AFTER ADVANCING PAGE                                12870000
128800              WRITE EXCEPTION-ERROR-RECORD                        12880000
128900                 FROM ER-END-OF-REPORT-LINE                       12890000
129000                 AFTER ADVANCING 4 LINES                          12900000
129100        END-IF                                                    12910000
129200     END-IF.                                                      12920000
129300                                                                  12930000
129301******************************************************************12930102
129310** THIS WILL 'WRAP UP' THE DETAIL RPT WITH AN END-OF-REPORT LINE  12931002
129320** BEFORE THE ERROR REPORT BUILDING BEGINS                        12932002
129321******************************************************************12932102
129322 3100-WRAP-UP-DETAIL-LINE.                                        12932202
129330                                                                  12933002
129340     IF PV-KEY-RECORD-TYP  EQUAL PC-E  AND                        12934002
129350        PS-END-OF-EXCEPTIONS-NO        AND                        12935002
129360        PA-DETAILS-WRITTEN  >    ZERO  AND                        12936002
129370        PV-LINE-COUNT       <  PC-056  AND                        12937002
129380        PV-LAST-DETAIL-LINE-COUNT > ZERO AND                      12938002
129390        PV-LAST-DETAIL-PAGE-COUNT > ZERO                          12939002
129391           PERFORM 7825-GRPS-NOT-WRITTEN-MSG-CHK                  12939102
129392           WRITE EXCEPTION-DETAIL-RECORD                          12939202
129393           FROM ER-END-OF-REPORT-LINE                             12939302
129394           AFTER ADVANCING 4 LINES                                12939402
129395           MOVE  +0          TO PV-LAST-DETAIL-LINE-COUNT         12939502
129396           MOVE  +0          TO PV-LAST-DETAIL-PAGE-COUNT         12939602
129397     ELSE                                                         12939702
129398        IF PV-KEY-RECORD-TYP  EQUAL PC-E  AND                     12939802
129399           PS-END-OF-EXCEPTIONS-NO        AND                     12939902
129400           PA-DETAILS-WRITTEN  >    ZERO  AND                     12940002
129401           PV-LINE-COUNT       >  PC-056 AND                      12940102
129402           PV-LAST-DETAIL-LINE-COUNT > ZERO AND                   12940202
129403           PV-LAST-DETAIL-PAGE-COUNT > ZERO                       12940302
129404              PERFORM 7825-GRPS-NOT-WRITTEN-MSG-CHK               12940402
129405              ADD  +1      TO PV-LAST-DETAIL-PAGE-COUNT           12940502
129406              MOVE PV-LAST-DETAIL-PAGE-COUNT    TO                12940602
129407                   DP132O-PAGE-NUMBER                             12940702
129408                                                                  12940802
129409              WRITE EXCEPTION-DETAIL-RECORD                       12940902
129410              FROM  DP132O-STANDRD-HEADER-132-COLS                12941002
129411              AFTER ADVANCING PAGE                                12941102
129412                                                                  12941202
129413              WRITE EXCEPTION-DETAIL-RECORD                       12941302
129414              FROM  HL2-HEADING-LINE-2                            12941402
129415              AFTER ADVANCING 1 LINE                              12941502
129416                                                                  12941602
129417              WRITE EXCEPTION-DETAIL-RECORD                       12941702
129418              FROM  HL3-HEADING-LINE-3                            12941802
129419              AFTER ADVANCING 1 LINE                              12941902
129420                                                                  12942002
129421              WRITE EXCEPTION-DETAIL-RECORD                       12942102
129422              FROM ER-END-OF-REPORT-LINE                          12942202
129423              AFTER ADVANCING 4 LINES                             12942302
129424                                                                  12942402
129425              MOVE  +0          TO PV-LAST-DETAIL-LINE-COUNT      12942502
129426              MOVE  +0          TO PV-LAST-DETAIL-PAGE-COUNT      12942602
129427        END-IF                                                    12942702
129428     END-IF.                                                      12942802
129430 EJECT                                                            12943000
129500                                                                  12950000
129600******************************************************************12960000
129700* BUILD, THEN WRITE DETAIL LINES 1 THRU 13. GROUP 1 WILL NEVER   *12970000
129800* SPILL ON TO ANOTHER PAGE.                                      *12980000
129900******************************************************************12990000
130000 4100-PROCESS-GROUP-1-LINES.                                      13000000
130100                                                                  13010000
130700     INITIALIZE                     DL1-PO-NBR                    13070000
130800                                    DL1-TRBL-RSN-CDE.             13080000
130900     MOVE TM602-PO-NBR           TO DL1-PO-NBR.                   13090000
131000     MOVE TM602-TRBL-RSN-CDE     TO DL1-TRBL-RSN-CDE.             13100000
131100     PERFORM 7100-DETERMINE-DATA-SOURCE.                          13110000
131200                                                                  13120000
131300     IF PS-NEW-PO-GROUP                                           13130000
131400        PERFORM 6200-CHECK-LINE-COUNT                             13140000
131500     END-IF.                                                      13150000
131600                                                                  13160000
131700     WRITE EXCEPTION-DETAIL-RECORD                                13170000
131800     FROM  DL1-DETAIL-LINE-1                                      13180000
131900           AFTER ADVANCING 3 LINES.                               13190000
132000                                                                  13200000
132100     ADD  +1       TO PA-DETAILS-WRITTEN.                         13210000
132200     ADD  +4       TO PV-LINE-COUNT.                              13220000
132300                                                                  13230000
132400*------------------------------------------------------DL2--------13240000
132500                                                                  13250000
132600     INITIALIZE   DL2-TRBL-RSN-DESC.                              13260000
132700                                                                  13270000
132800     PERFORM 7150-DETERMINE-RSN-DESC.                             13280000
132900                                                                  13290000
133000     WRITE EXCEPTION-DETAIL-RECORD                                13300000
133100     FROM  DL2-DETAIL-LINE-2                                      13310000
133200           AFTER ADVANCING 1 LINE.                                13320000
133300                                                                  13330000
133400     ADD  +1       TO PV-LINE-COUNT.                              13340000
133500                                                                  13350000
133600*------------------------------------------------------DL3--------13360000
133700                                                                  13370000
133800     INITIALIZE                        DL3-PURCHS-VER-NBR.        13380000
133900                                                                  13390000
134000     IF TM602-PURCHS-VER-NBR   EQUAL ZERO                         13400000
134100        MOVE PC-NA                  TO DL3-PURCHS-VER-NBR-X       13410000
134200     ELSE                                                         13420000
134300        MOVE TM602-PURCHS-VER-NBR   TO DL3-PURCHS-VER-NBR         13430000
134400     END-IF.                                                      13440000
134500                                                                  13450000
134600     WRITE EXCEPTION-DETAIL-RECORD                                13460000
134700     FROM  DL3-DETAIL-LINE-3                                      13470000
134800           AFTER ADVANCING 1 LINE.                                13480000
134900                                                                  13490000
135000     ADD  +1       TO PV-LINE-COUNT.                              13500000
135100                                                                  13510000
135200*------------------------------------------------------DL4--------13520000
135300                                                                  13530000
135400     INITIALIZE                        DL4-PLNSHP-VER-NBR.        13540000
135500                                                                  13550000
135600     IF TM602-PLNSHP-VER-NBR   EQUAL ZERO                         13560000
135700        MOVE PC-NA                  TO DL4-PLNSHP-VER-NBR-X       13570000
135800     ELSE                                                         13580000
135900        MOVE TM602-PLNSHP-VER-NBR   TO DL4-PLNSHP-VER-NBR         13590000
136000     END-IF.                                                      13600000
136100                                                                  13610000
136200     WRITE EXCEPTION-DETAIL-RECORD                                13620000
136300     FROM  DL4-DETAIL-LINE-4                                      13630000
136400           AFTER ADVANCING 1 LINE.                                13640000
136500                                                                  13650000
136600     ADD  +1       TO PV-LINE-COUNT.                              13660000
136700                                                                  13670000
136800*------------------------------------------------------DL5--------13680000
136900                                                                  13690000
137000*NOTE: DON'T CONFUSE THIS WITH PO-LNE-NBR ON TMRD602 LAYOUT,      13700000
137100*      WHICH WILL BE UTILIZED IN THE FUTURE OR ANOTHER PGM.       13710000
137200                                                                  13720000
137300     INITIALIZE                        DL5-PURITM-LINE-VER-NBR.   13730000
137400                                                                  13740000
137500     IF TM602-PURITM-VER-NBR   EQUAL ZERO                         13750000
137600        MOVE PC-NA                  TO DL5-PURITM-LINE-VER-NBR-X  13760000
137700     ELSE                                                         13770000
137800        MOVE TM602-PURITM-VER-NBR   TO DL5-PURITM-LINE-VER-NBR    13780000
137900     END-IF.                                                      13790000
138000                                                                  13800000
138100     WRITE EXCEPTION-DETAIL-RECORD                                13810000
138200     FROM  DL5-DETAIL-LINE-5                                      13820000
138300           AFTER ADVANCING 1 LINE.                                13830000
138400                                                                  13840000
138500     ADD  +1       TO PV-LINE-COUNT.                              13850000
138600                                                                  13860000
138700*------------------------------------------------------DL5A-------13870000
138800                                                                  13880000
138900     INITIALIZE DL5A-DEPT.                                        13890000
139000                                                                  13900000
139100     IF DL3-PURCHS-VER-NBR NUMERIC                                13910000
139200        PERFORM 7325-DETERMINE-DEPT-BY-VER-NBR                    13920000
139300     ELSE                                                         13930000
139400        PERFORM 7330-DETERMINE-DEPT-BY-STAT-CD                    13940000
139500     END-IF.                                                      13950000
139600                                                                  13960000
139700     WRITE EXCEPTION-DETAIL-RECORD                                13970000
139800     FROM  DL5A-DETAIL-LINE-5A                                    13980000
139900           AFTER ADVANCING 1 LINE.                                13990000
140000                                                                  14000000
140100     ADD  +1       TO PV-LINE-COUNT.                              14010000
140200*------------------------------------------------------DL6--------14020000
140300                                                                  14030000
140400     INITIALIZE                     DL6-FOB-CDE                   14040000
140500                                    DL6-POE-CDE.                  14050000
140600                                                                  14060000
140700     IF TM602-FOB-CDE EQUAL SPACES                                14070000
140800        MOVE PC-NA               TO DL6-FOB-CDE                   14080000
140900     ELSE                                                         14090000
141000        MOVE TM602-FOB-CDE       TO DL6-FOB-CDE                   14100000
141100     END-IF.                                                      14110000
141200                                                                  14120000
141300     IF TM602-POE-CDE EQUAL SPACES OR ZEROES                      14130000
141400        MOVE PC-NA               TO DL6-POE-CDE                   14140000
141500     ELSE                                                         14150000
141600        MOVE TM602-POE-CDE       TO DL6-POE-CDE                   14160000
141700     END-IF.                                                      14170000
141800                                                                  14180000
141900     WRITE EXCEPTION-DETAIL-RECORD                                14190000
142000     FROM  DL6-DETAIL-LINE-6                                      14200000
142100           AFTER ADVANCING 1 LINE.                                14210000
142200                                                                  14220000
142300     ADD  +1       TO PV-LINE-COUNT.                              14230000
142400                                                                  14240000
142500*------------------------------------------------------DL7--------14250000
142600                                                                  14260000
142700* NOTE:THE CONSOLIDATOR, DECONSOLIDATOR, CUSTOMS BROKER NAMES ARE 14270000
142800*      RETRIEVED FROM THE SAME DB2 TABLE                          14280000
142900                                                                  14290000
143000     INITIALIZE ENTNME-ENT-ID                                     14300000
143100                DL7-CONSLR                                        14310000
143200                DL7-DCONSLR                                       14320000
143300                DL7-CSTM-BKR.                                     14330000
143400                                                                  14340000
143500     MOVE TM602-CONSLR-ENT-ID      TO ENTNME-ENT-ID.              14350000
143600     PERFORM 7175-DETERMINE-ENTITY-NAMES.                         14360000
143700                                                                  14370000
143800     IF SQLCODE EQUAL +0                                          14380000
143900        MOVE ENTNME-ENT-NAME-DESC (1:20) TO DL7-CONSLR            14390000
144000     ELSE                                                         14400000
144100        MOVE PC-NA                 TO DL7-CONSLR                  14410000
144200     END-IF.                                                      14420000
144300                                                                  14430000
144400     INITIALIZE ENTNME-ENT-ID.                                    14440000
144500     MOVE TM602-DCONSLR-ENT-ID     TO ENTNME-ENT-ID.              14450000
144600     PERFORM 7175-DETERMINE-ENTITY-NAMES.                         14460000
144700                                                                  14470000
144800     IF SQLCODE EQUAL +0                                          14480000
144900        MOVE ENTNME-ENT-NAME-DESC (1:20) TO DL7-DCONSLR           14490000
145000     ELSE                                                         14500000
145100        MOVE PC-NA                 TO DL7-DCONSLR                 14510000
145200     END-IF.                                                      14520000
145300                                                                  14530000
145400     INITIALIZE ENTNME-ENT-ID.                                    14540000
145500     MOVE TM602-CSTM-BKR-ENT-ID    TO ENTNME-ENT-ID.              14550000
145600     PERFORM 7175-DETERMINE-ENTITY-NAMES.                         14560000
145700                                                                  14570000
145800     IF SQLCODE EQUAL +0                                          14580000
145900        MOVE ENTNME-ENT-NAME-DESC (1:20) TO DL7-CSTM-BKR          14590000
146000     ELSE                                                         14600000
146100        MOVE PC-NA                 TO DL7-CSTM-BKR                14610000
146200     END-IF.                                                      14620000
146300                                                                  14630000
146400     WRITE EXCEPTION-DETAIL-RECORD                                14640000
146500     FROM  DL7-DETAIL-LINE-7                                      14650000
146600           AFTER ADVANCING 1 LINE.                                14660000
146700                                                                  14670000
146800     ADD  +1       TO PV-LINE-COUNT.                              14680000
146900                                                                  14690000
147000*------------------------------------------------------DL8--------14700000
147100                                                                  14710000
147200     INITIALIZE                        DL8-STRT-FCTRY-DTE         14720000
147300                                       DL8-PO-BKG-DELY-DTE        14730000
147400                                       DL8-PO-RCVD-DELY-DTE.      14740000
147500                                                                  14750000
147600     IF TM602-STRT-FCTRY-DTE   EQUAL PC-DEFAULT-DTE OR SPACES     14760000
147700        MOVE PC-NA                  TO DL8-STRT-FCTRY-DTE         14770000
147800     ELSE                                                         14780000
147900        MOVE TM602-STRT-FCTRY-DTE     (1:4)  TO                   14790000
148000               PV-RPT-CCYY                                        14800000
148100        MOVE TM602-STRT-FCTRY-DTE     (6:2)  TO                   14810000
148200               PV-RPT-MM                                          14820000
148300        MOVE TM602-STRT-FCTRY-DTE     (9:2)  TO                   14830000
148400               PV-RPT-DD                                          14840000
148500        MOVE PV-RPT-FORMATTED-DATE  TO DL8-STRT-FCTRY-DTE         14850000
148600     END-IF.                                                      14860000
148700                                                                  14870000
148800     IF TM602-PO-BKG-DELY-DTE  EQUAL PC-DEFAULT-DTE OR SPACES     14880000
148900        MOVE PC-NA                  TO DL8-PO-BKG-DELY-DTE        14890000
149000     ELSE                                                         14900000
149100        MOVE TM602-PO-BKG-DELY-DTE    (1:4)  TO                   14910000
149200               PV-RPT-CCYY                                        14920000
149300        MOVE TM602-PO-BKG-DELY-DTE    (6:2)  TO                   14930000
149400               PV-RPT-MM                                          14940000
149500        MOVE TM602-PO-BKG-DELY-DTE    (9:2)  TO                   14950000
149600               PV-RPT-DD                                          14960000
149700        MOVE PV-RPT-FORMATTED-DATE  TO DL8-PO-BKG-DELY-DTE        14970000
149800     END-IF.                                                      14980000
149900                                                                  14990000
150000     IF TM602-PO-RCVD-DELY-DTE EQUAL PC-DEFAULT-DTE OR SPACES     15000000
150100        MOVE PC-NA                  TO DL8-PO-RCVD-DELY-DTE       15010000
150200     ELSE                                                         15020000
150300        MOVE TM602-PO-RCVD-DELY-DTE   (1:4)  TO                   15030000
150400               PV-RPT-CCYY                                        15040000
150500        MOVE TM602-PO-RCVD-DELY-DTE   (6:2)  TO                   15050000
150600               PV-RPT-MM                                          15060000
150700        MOVE TM602-PO-RCVD-DELY-DTE   (9:2)  TO                   15070000
150800               PV-RPT-DD                                          15080000
150900        MOVE PV-RPT-FORMATTED-DATE  TO DL8-PO-RCVD-DELY-DTE       15090000
151000     END-IF.                                                      15100000
151100                                                                  15110000
151200     WRITE EXCEPTION-DETAIL-RECORD                                15120000
151300     FROM  DL8-DETAIL-LINE-8                                      15130000
151400           AFTER ADVANCING 2 LINES.                               15140000
151500                                                                  15150000
151600     ADD  +2       TO PV-LINE-COUNT.                              15160000
151700                                                                  15170000
151800*------------------------------------------------------DL9--------15180000
151900                                                                  15190000
152000     INITIALIZE                        DL9-LAST-FCTRY-DTE         15200000
152100                                       DL9-CONTNR-PU-DTE          15210000
152200                                       DL9-EST-DPRTR-DTE.         15220000
152300                                                                  15230000
152400     IF TM602-LAST-FCTRY-DTE   EQUAL PC-DEFAULT-DTE OR SPACES     15240000
152500        MOVE PC-NA                  TO DL9-LAST-FCTRY-DTE         15250000
152600     ELSE                                                         15260000
152700        MOVE TM602-LAST-FCTRY-DTE     (1:4) TO                    15270000
152800               PV-RPT-CCYY                                        15280000
152900        MOVE TM602-LAST-FCTRY-DTE     (6:2) TO                    15290000
153000               PV-RPT-MM                                          15300000
153100        MOVE TM602-LAST-FCTRY-DTE     (9:2) TO                    15310000
153200               PV-RPT-DD                                          15320000
153300        MOVE PV-RPT-FORMATTED-DATE  TO DL9-LAST-FCTRY-DTE         15330000
153400     END-IF.                                                      15340000
153500                                                                  15350000
153600     IF TM602-CONTNR-PKUP-DTE    EQUAL PC-DEFAULT-DTE OR SPACES   15360000
153700        MOVE PC-NA                  TO DL9-CONTNR-PU-DTE          15370000
153800     ELSE                                                         15380000
153900        MOVE TM602-CONTNR-PKUP-DTE      (1:4) TO                  15390000
154000               PV-RPT-CCYY                                        15400000
154100        MOVE TM602-CONTNR-PKUP-DTE      (6:2) TO                  15410000
154200               PV-RPT-MM                                          15420000
154300        MOVE TM602-CONTNR-PKUP-DTE      (9:2) TO                  15430000
154400               PV-RPT-DD                                          15440000
154500        MOVE PV-RPT-FORMATTED-DATE  TO DL9-CONTNR-PU-DTE          15450000
154600     END-IF.                                                      15460000
154700                                                                  15470000
154800     IF TM602-EST-DPRTR-DTE EQUAL PC-DEFAULT-DTE OR SPACES        15480000
154900        MOVE PC-NA                  TO DL9-EST-DPRTR-DTE          15490000
155000     ELSE                                                         15500000
155100        MOVE TM602-EST-DPRTR-DTE      (1:4) TO                    15510000
155200               PV-RPT-CCYY                                        15520000
155300        MOVE TM602-EST-DPRTR-DTE      (6:2) TO                    15530000
155400               PV-RPT-MM                                          15540000
155500        MOVE TM602-EST-DPRTR-DTE      (9:2) TO                    15550000
155600               PV-RPT-DD                                          15560000
155700        MOVE PV-RPT-FORMATTED-DATE  TO DL9-EST-DPRTR-DTE          15570000
155800     END-IF.                                                      15580000
155900                                                                  15590000
156000     WRITE EXCEPTION-DETAIL-RECORD                                15600000
156100     FROM  DL9-DETAIL-LINE-9                                      15610000
156200           AFTER ADVANCING 1 LINE.                                15620000
156300                                                                  15630000
156400     ADD  +1       TO PV-LINE-COUNT.                              15640000
156500                                                                  15650000
156600*------------------------------------------------------DL10-------15660000
156700                                                                  15670000
156800     INITIALIZE                        DL10-MOM-POE-DELY-DTE.     15680000
156900                                                                  15690000
157000     IF TM602-MOM-POE-DELY-DTE EQUAL PC-DEFAULT-DTE OR SPACES     15700000
157100        MOVE PC-NA                  TO DL10-MOM-POE-DELY-DTE      15710000
157200     ELSE                                                         15720000
157300        MOVE TM602-MOM-POE-DELY-DTE   (1:4) TO                    15730000
157400               PV-RPT-CCYY                                        15740000
157500        MOVE TM602-MOM-POE-DELY-DTE   (6:2) TO                    15750000
157600               PV-RPT-MM                                          15760000
157700        MOVE TM602-MOM-POE-DELY-DTE   (9:2) TO                    15770000
157800               PV-RPT-DD                                          15780000
157900        MOVE PV-RPT-FORMATTED-DATE     TO DL10-MOM-POE-DELY-DTE   15790000
158000     END-IF.                                                      15800000
158100                                                                  15810000
158200     WRITE EXCEPTION-DETAIL-RECORD                                15820000
158300     FROM  DL10-DETAIL-LINE-10                                    15830000
158400           AFTER ADVANCING 1 LINE.                                15840000
158500                                                                  15850000
158600     ADD  +1       TO PV-LINE-COUNT.                              15860000
158700                                                                  15870000
158800*------------------------------------------------------DL11-------15880000
158900                                                                  15890000
159000     INITIALIZE                        DL11-PURCHS-UNT-QTY        15900000
159100                                       DL11-IMBKPO-PO-UNT-QTY     15910000
159200                                       DL11-IMRCPO-PO-UNT-QTY.    15920000
159300                                                                  15930000
159400     IF TM602-PURCHS-TOT-UNT-QTY EQUAL ZERO                       15940000
159500        MOVE PC-NA                  TO DL11-PURCHS-UNT-QTY-X      15950000
159600     ELSE                                                         15960000
159700        MOVE TM602-PURCHS-TOT-UNT-QTY   TO DL11-PURCHS-UNT-QTY    15970000
159800     END-IF.                                                      15980000
159900                                                                  15990000
160000     IF TM602-IMBKPO-PO-UNT-QTY EQUAL ZERO                        16000000
160100        MOVE PC-NA                  TO DL11-IMBKPO-PO-UNT-QTY-X   16010000
160200     ELSE                                                         16020000
160300        MOVE TM602-IMBKPO-PO-UNT-QTY   TO DL11-IMBKPO-PO-UNT-QTY  16030000
160400     END-IF.                                                      16040000
160500                                                                  16050000
160600     IF TM602-IMRCPO-PO-UNT-QTY EQUAL ZERO                        16060000
160700        MOVE PC-NA                  TO DL11-IMRCPO-PO-UNT-QTY-X   16070000
160800     ELSE                                                         16080000
160900        MOVE TM602-IMRCPO-PO-UNT-QTY   TO DL11-IMRCPO-PO-UNT-QTY  16090000
161000     END-IF.                                                      16100000
161100                                                                  16110000
161200     WRITE EXCEPTION-DETAIL-RECORD                                16120000
161300     FROM  DL11-DETAIL-LINE-11                                    16130000
161400           AFTER ADVANCING 2 LINES.                               16140000
161500                                                                  16150000
161600     ADD  +2       TO PV-LINE-COUNT.                              16160000
161700                                                                  16170000
161800*------------------------------------------------------DL12-------16180000
161900                                                                  16190000
162000     INITIALIZE                        DL12-IMCNPO-PO-UNT-QTY.    16200000
162100                                                                  16210000
162200     IF TM602-IMCNPO-PO-UNT-QTY EQUAL ZERO                        16220000
162300        MOVE PC-NA                  TO DL12-IMCNPO-PO-UNT-QTY-X   16230000
162400     ELSE                                                         16240000
162500        MOVE TM602-IMCNPO-PO-UNT-QTY   TO DL12-IMCNPO-PO-UNT-QTY  16250000
162600     END-IF.                                                      16260000
162700                                                                  16270000
162800     WRITE EXCEPTION-DETAIL-RECORD                                16280000
162900     FROM  DL12-DETAIL-LINE-12                                    16290000
163000           AFTER ADVANCING 1 LINE.                                16300000
163100                                                                  16310000
163200     ADD  +1       TO PV-LINE-COUNT.                              16320000
163300                                                                  16330000
163400*------------------------------------------------------DL13-------16340000
163500                                                                  16350000
163600     INITIALIZE                          DL13-BEG-LMT-QTY         16360000
163700                                         DL13-END-LMT-QTY         16370000
163800                                         DL13-BEG-LMT-FILLER      16380000
163900                                         DL13-END-LMT-FILLER      16390000
164000                                         DL13-CNTRL-TYP-CDE.      16400000
164100                                                                  16410000
164200     IF (TM602-BEG-LMT-PCT     EQUAL PC-SIGNED-ZERO   AND         16420000
164300         TM602-END-LMT-PCT     EQUAL PC-SIGNED-ZERO)              16430000
164400        MOVE TM602-BEG-LMT-DAY-QTY    TO DL13-BEG-LMT-QTY         16440000
164500        MOVE TM602-END-LMT-DAY-QTY    TO DL13-END-LMT-QTY         16450000
164600        MOVE PC-DAYS                  TO DL13-BEG-LMT-FILLER      16460000
164700                                         DL13-END-LMT-FILLER      16470000
164800     ELSE                                                         16480000
164900        MOVE TM602-BEG-LMT-PCT        TO DL13-BEG-LMT-QTY         16490000
165000        MOVE PC-PCT-SIGN              TO DL13-BEG-LMT-FILLER      16500000
165100        MOVE TM602-END-LMT-PCT        TO DL13-END-LMT-QTY         16510000
165200        MOVE PC-PCT-SIGN              TO DL13-END-LMT-FILLER      16520000
165300     END-IF.                                                      16530000
165400                                                                  16540000
165500     IF TM602-TRBL-CNTL-TYP-CDE EQUAL SPACES                      16550000
165600        MOVE PC-D                   TO DL13-CNTRL-TYP-CDE         16560000
165700     ELSE                                                         16570000
165800        MOVE TM602-TRBL-CNTL-TYP-CDE TO DL13-CNTRL-TYP-CDE        16580000
165900     END-IF.                                                      16590000
166000                                                                  16600000
166100     WRITE EXCEPTION-DETAIL-RECORD                                16610000
166200     FROM  DL13-DETAIL-LINE-13                                    16620000
166300           AFTER ADVANCING 2 LINES.                               16630000
166400                                                                  16640000
166500     ADD  +2       TO PV-LINE-COUNT.                              16650000
166600                                                                  16660000
166700     SET PS-NEW-PO-GROUP            TO TRUE.                      16670000
166800                                                                  16680000
166900 EJECT                                                            16690000
167000                                                                  16700000
167100******************************************************************16710000
167200* DETAIL LINES DL14- AND DL15- ARE "RULE HEADINGS" FOR GROUP 2   *16720000
167300* DETAIL LINES WHICH MAY OR MAY NOT BE PRESENT. THERE ALSO MAY BE 16730000
167400* MORE THAN ENOUGH TO CONTINUE TO NEXT PAGE. THE DETAIL LINES WILL16740000
167500* BE DL16- .                                                      16750000
167600******************************************************************16760000
167700 4200-PROCESS-GROUP-2-LINES.                                      16770000
167800                                                                  16780000
167900     INITIALIZE TM603-RECORD.                                     16790000
168000     MOVE PV-MASTER-RECORD       TO TM603-RECORD.                 16800000
168100                                                                  16810000
168200*------------------------------------------------------DL16-------16820000
168300                                                                  16830000
168400     INITIALIZE                        DL16-CURR-RUL-NAME         16840000
168500                                       DL16-CURR-RUL-RET-TYP      16850000
168600                                       DL16-CURR-RUL-COND-IND     16860000
168700                                       DL16-CURR-RUL-RES-FILLER   16870000
168800                                       DL16-CURR-RUL-RES          16880000
168900                                       DL16-CURR-RUL-RES-IND      16890000
169000                                       DL16-APPL-CDE              16900000
169100                                       PV-RES-FORMAT-1            16910000
169200                                       PV-RES-FORMAT-2            16920000
169300                                       PV-RES-FORMAT-3.           16930000
169400                                                                  16940000
169500     MOVE TM603-CURR-RUL-NAME       TO DL16-CURR-RUL-NAME.        16950000
169600     MOVE TM603-CURR-RUL-RET-TYP    TO DL16-CURR-RUL-RET-TYP.     16960000
169700     MOVE TM603-CURR-RUL-COND-IND   TO DL16-CURR-RUL-COND-IND.    16970000
169800     MOVE TM603-CURR-RUL-COND-PROC-CDE TO                         16980000
169900            DL16-CURR-RUL-COND-PROC-CDE.                          16990000
170000                                                                  17000000
170100     IF TM603-CURR-RUL-RET-TYP      EQUAL PC-DAY                  17010000
170200        MOVE TM603-CURR-RUL-RES-DAYS   TO PV-VALUE-2              17020000
170300        MOVE PV-RES-FORMAT-2           TO DL16-CURR-RUL-RES       17030000
170400        MOVE PC-DAYS                  TO DL16-CURR-RUL-RES-FILLER 17040000
170500     END-IF.                                                      17050000
170600                                                                  17060000
170700     IF TM603-CURR-RUL-RET-TYP      EQUAL PC-PCT                  17070000
170800        MOVE TM603-CURR-RUL-RES-PCT    TO PV-VALUE-1              17080000
170900        MOVE PV-RES-FORMAT-1           TO DL16-CURR-RUL-RES       17090000
171000        MOVE SPACES                   TO DL16-CURR-RUL-RES-FILLER 17100000
171100     END-IF.                                                      17110000
171200                                                                  17120000
171300     IF TM603-CURR-RUL-RET-TYP      EQUAL SPACES                  17130000
171400        MOVE PC-NA                      TO DL16-CURR-RUL-RES      17140000
171500     END-IF.                                                      17150000
171600                                                                  17160000
171700     IF TM603-CURR-RUL-RET-TYP      EQUAL PC-IND                  17170000
171800        MOVE SPACES                      TO PV-RES-FORMAT-3       17180000
171900        MOVE PV-RES-FORMAT-3             TO DL16-CURR-RUL-RES     17190000
172000     END-IF.                                                      17200000
172100                                                                  17210000
172200     MOVE TM603-CURR-RUL-RES-IND         TO DL16-CURR-RUL-RES-IND.17220000
172300                                                                  17230000
172400     PERFORM 7200-DETERMINE-SOURCE-APPL.                          17240000
172500                                                                  17250000
172600     SET PS-NEW-PAGE-WRITTEN-NO        TO TRUE.                   17260000
172700     PERFORM 6200-CHECK-LINE-COUNT.                               17270000
172800                                                                  17280000
172900     IF PS-RULE-HEADINGS-WRITTEN-NO                               17290000
173000        WRITE EXCEPTION-DETAIL-RECORD                             17300000
173100        FROM  DL14-DETAIL-LINE-14                                 17310000
173200              AFTER ADVANCING 4 LINES                             17320000
173300        WRITE EXCEPTION-DETAIL-RECORD                             17330000
173400        FROM  DL15-DETAIL-LINE-15                                 17340000
173500              AFTER ADVANCING 1 LINE                              17350000
173600        WRITE EXCEPTION-DETAIL-RECORD                             17360000
173700        FROM  DL16-DETAIL-LINE-16                                 17370000
173800              AFTER ADVANCING 2 LINES                             17380000
173900                                                                  17390000
174000        SET PS-RULE-HEADINGS-WRITTEN    TO TRUE                   17400000
174100        ADD  +7       TO PV-LINE-COUNT                            17410000
174200        MOVE PV-LINE-COUNT           TO PV-LAST-DETAIL-LINE-COUNT 17420000
174300        MOVE PV-PAGE-COUNT           TO PV-LAST-DETAIL-PAGE-COUNT 17430000
174400     ELSE                                                         17440000
174500        WRITE EXCEPTION-DETAIL-RECORD                             17450000
174600        FROM  DL16-DETAIL-LINE-16                                 17460000
174700              AFTER ADVANCING 1 LINE                              17470000
174800                                                                  17480000
174900        ADD  +1       TO PV-LINE-COUNT                            17490000
175000        MOVE PV-LINE-COUNT           TO PV-LAST-DETAIL-LINE-COUNT 17500000
175100        MOVE PV-PAGE-COUNT           TO PV-LAST-DETAIL-PAGE-COUNT 17510000
175200     END-IF.                                                      17520000
175300                                                                  17530000
175400 EJECT                                                            17540000
175500                                                                  17550000
175600******************************************************************17560000
175700* BUILD DETAIL LINES DL17- THRU DL19 FIRST. IF THERE WERE NO     *17570000
175800* GROUP 2 RULES WRITTEN TO REPORT, WRITE OUT A MSG LINE ON EITHER 17580000
175900* THIS PAGE OR THE NEXT PAGE, THE WRITE OUT THE THREE DETAIL LINES17590000
176000* ON EITHER THIS PAGE OR THE NEXT PAGE.                           17600000
176100******************************************************************17610000
176200 4300-PROCESS-GROUP-3-LINES.                                      17620000
176300                                                                  17630000
176400     INITIALIZE TM604-RECORD.                                     17640000
176500     MOVE PV-MASTER-RECORD       TO TM604-RECORD.                 17650000
176600                                                                  17660000
176700*------------------------------------------------------DL17-------17670000
176800                                                                  17680000
176900     INITIALIZE                          DL17-ACTION              17690000
177000                                         DL17-NOTIFY              17700000
177100                                         DL17-UPD-RES.            17710000
177200                                                                  17720000
177300     SET PS-TRBL-ACTION-CDE-IS-R-NO   TO TRUE.                    17730000
177400                                                                  17740000
177500     EVALUATE TM604-TRBL-ACTION-CDE                               17750000
177600         WHEN PC-T                                                17760000
177700              MOVE 'TROUBLE'          TO DL17-ACTION              17770000
177800              MOVE PC-UPDATED         TO DL17-UPD-RES-FILLER      17780000
177900              PERFORM 7805-REFORMAT-UPD-TMST                      17790000
178000         WHEN PC-R                                                17800000
178100              MOVE 'RESOLVED'         TO DL17-ACTION              17810000
178200              MOVE PC-RESOLVED        TO DL17-UPD-RES-FILLER      17820000
178300              SET PS-TRBL-ACTION-CDE-IS-R      TO TRUE            17830000
178400         WHEN PC-U                                                17840000
178500              MOVE 'UPDATED'          TO DL17-ACTION              17850000
178600              MOVE PC-UPDATED         TO DL17-UPD-RES-FILLER      17860000
178700              PERFORM 7805-REFORMAT-UPD-TMST                      17870000
178800         WHEN OTHER                                               17880000
178900              MOVE PC-NA              TO DL17-ACTION              17890000
179000              MOVE PC-UPDATED         TO DL17-UPD-RES-FILLER      17900000
179100              PERFORM 7805-REFORMAT-UPD-TMST                      17910000
179200     END-EVALUATE.                                                17920000
179300                                                                  17930000
179400     PERFORM 7250-DETERMINE-NOTF-RES-TMST.                        17940000
179500                                                                  17950000
179600*------------------------------------------------------DL18-------17960000
179700                                                                  17970000
179800     INITIALIZE                         DL18-INITIATOR            17980000
179900                                        DL18-RESP-PARTY           17990000
180000                                        DL18-RPTD-AGAINST.        18000000
180100                                                                  18010000
180200     MOVE TM604-CURR-INITR-ID        TO PV-4BYTE-HOLD-FOR-EVAL.   18020000
180300     PERFORM 7850-DETERMINE-RESP-PARTY.                           18030000
180400     MOVE PV-HOLD-RESP-PARTY-TEXT    TO DL18-INITIATOR.           18040000
180500                                                                  18050000
180600     MOVE TM604-CURR-RSPNB-RSLU-ID   TO PV-4BYTE-HOLD-FOR-EVAL.   18060000
180700     PERFORM 7850-DETERMINE-RESP-PARTY.                           18070000
180800     MOVE PV-HOLD-RESP-PARTY-TEXT    TO DL18-RESP-PARTY.          18080000
180900                                                                  18090000
181000     MOVE TM604-CURR-PFMC-TRKG-ID    TO PV-4BYTE-HOLD-FOR-EVAL.   18100000
181100     PERFORM 7850-DETERMINE-RESP-PARTY.                           18110000
181200     MOVE PV-HOLD-RESP-PARTY-TEXT    TO DL18-RPTD-AGAINST.        18120000
181300                                                                  18130000
181400*------------------------------------------------------DL19-------18140000
181500                                                                  18150000
181600     INITIALIZE                         DL19-RESOLU-ACTION        18160000
181700                                        DL19-EARLY-LATE-DAY-QTY   18170000
181800                                        DL19-OVER-SHORT-PCT.      18180000
181900                                                                  18190000
182000     PERFORM 7125-DETERMINE-RES-ACTION.                           18200000
182100                                                                  18210000
182200     MOVE TM604-ERLY-LTE-DAY-QTY     TO DL19-EARLY-LATE-DAY-QTY.  18220000
182300                                                                  18230000
182400     IF TM604-OVER-SHRT-PCT      NOT EQUAL ZERO                   18240000
182500        MOVE TM604-OVER-SHRT-PCT     TO   DL19-OVER-SHORT-PCT     18250000
182600     ELSE                                                         18260000
182700        MOVE PC-NA                   TO DL19-OVER-SHORT-PCT-X     18270000
182800        MOVE SPACES                  TO DL19-PCT-FILLER           18280000
182900     END-IF.                                                      18290000
183000                                                                  18300000
183100     IF PV-LINE-COUNT < PC-056                                    18310000
183200        WRITE EXCEPTION-DETAIL-RECORD                             18320000
183300        FROM  DL17-DETAIL-LINE-17                                 18330000
183400              AFTER ADVANCING 3 LINES                             18340000
183500                                                                  18350000
183600        WRITE EXCEPTION-DETAIL-RECORD                             18360000
183700        FROM  DL18-DETAIL-LINE-18                                 18370000
183800              AFTER ADVANCING 1 LINE                              18380000
183900                                                                  18390000
184000        WRITE EXCEPTION-DETAIL-RECORD                             18400000
184100        FROM  DL19-DETAIL-LINE-19                                 18410000
184200              AFTER ADVANCING 1 LINE                              18420000
184300                                                                  18430000
184400        ADD  +5       TO PV-LINE-COUNT                            18440000
184500        MOVE PV-LINE-COUNT           TO PV-LAST-DETAIL-LINE-COUNT 18450000
184600        MOVE PV-PAGE-COUNT           TO PV-LAST-DETAIL-PAGE-COUNT 18460000
184700                                                                  18470000
184800     ELSE                                                         18480000
184900        SET PS-NEW-PAGE-WRITTEN-NO      TO TRUE                   18490000
185000        MOVE PC-060                     TO PV-LINE-COUNT          18500000
185100        PERFORM 6200-CHECK-LINE-COUNT                             18510000
185200     END-IF.                                                      18520000
185300                                                                  18530000
185400     SET PS-GRP-3-UPDATES-WRITTEN       TO TRUE.                  18540000
185500                                                                  18550000
185600 EJECT                                                            18560000
185700                                                                  18570000
185800******************************************************************18580000
185900* DEPENDING ON WHETHER THE BKG, RCVG OR CONTNR DATES ARE SENT,   *18590000
186000* BUILD THE APPROPRIATE DETAIL LINE. DL21- AND DL22- ARE THE      18600000
186100* "IMPRT HEADINGS" FOR DETAIL LINE(S) DL23- BUILT AND DISPLAYED   18610000
186200*  AS FOLLOWS:                                                    18620000
186300*   __________________________________________________________    18630000
186400*  |BKG DELY | RECEIPT |IMPORT |FOB ACTL | IMPORT  |IMPORT   |    18640000
186500*  |    DATE |  DATE   |  ID   |DEP DATE | SEQ NBR |KEY TYPE |    18650000
186600*  |_________|_________|_______|_________|_________|_________|    18660000
186700*  | SENT    |  N/A    |  SENT |   N/A   | BKG_SEQ |   BK    |    18670000
186800*  |         |         |       |         | TIMBKPO |         |    18680000
186900*  |_________|_________|_______|_________|_________|_________|    18690000
187000*  |  N/A    |  SENT   |  SENT |   N/A   | RCVG_SEQ|   RC    |    18700000
187100*  |         |         |       |         | TIMRCPO |         |    18710000
187200*  |_________|_________|_______|_________|_________|_________|    18720000
187300*  |  N/A    |  N/A    |  SENT |   SENT  |CNTR_SEQ |   CN    |    18730000
187400*  |         |         |       |         |TIMCNTK  |         |    18740000
187500*  |_________|_________|_______|_________|_________|_________|    18750000
187600*                                                                 18760000
187700******************************************************************18770000
187800 4400-PROCESS-GROUP-4-LINES.                                      18780000
187900                                                                  18790000
188000     INITIALIZE TM605-RECORD.                                     18800000
188100     MOVE PV-MASTER-RECORD       TO TM605-RECORD.                 18810000
188200                                                                  18820000
188300*------------------------------------------------------DL22-------18830000
188400                                                                  18840000
188500     INITIALIZE                        DL22-BKG-DELY-DTE          18850000
188600                                       DL22-RCVG-DELY-DTE         18860000
188700                                       DL22-IMPRT-ID              18870000
188800                                       DL22-FOB-ACTL-DPRTR-DTE    18880000
188900                                       DL22-IMPRT-SEQ-NBR         18890000
189000                                       DL22-IMPRT-KEY-TYP.        18900000
189100                                                                  18910000
189200     MOVE TM605-PRCS-TYP-CDE        TO DL22-IMPRT-KEY-TYP.        18920000
189300                                                                  18930000
189400     EVALUATE DL22-IMPRT-KEY-TYP                                  18940000
189500        WHEN PC-BK                                                18950000
189600             MOVE TM605-BKG-SEQ-NBR    TO DL22-IMPRT-SEQ-NBR      18960000
189700             PERFORM 7340-DETERMINE-BKG-DELY-DTE                  18970000
189800             MOVE PC-NA                TO DL22-RCVG-DELY-DTE      18980000
189900             MOVE PC-NA                TO DL22-FOB-ACTL-DPRTR-DTE 18990000
190000             MOVE PC-NA                TO DL22-IMPRT-ID           19000000
190100        WHEN PC-RC                                                19010000
190200             MOVE TM605-RCVD-SEQ-NBR   TO DL22-IMPRT-SEQ-NBR      19020000
190300             PERFORM 7345-DETERMINE-RCVD-DELY-DTE                 19030000
190400             MOVE PC-NA                TO DL22-BKG-DELY-DTE       19040000
190500             MOVE PC-NA                TO DL22-FOB-ACTL-DPRTR-DTE 19050000
190600             MOVE PC-NA                TO DL22-IMPRT-ID           19060000
190700        WHEN PC-CN                                                19070000
190800             MOVE TM605-CONTNR-SEQ-NBR TO DL22-IMPRT-SEQ-NBR      19080000
190900             MOVE TM605-CONTNR-ID      TO DL22-IMPRT-ID           19090000
191000             PERFORM 7350-DETERMINE-SAIL-DTE                      19100000
191100             MOVE PC-NA                TO DL22-BKG-DELY-DTE       19110000
191200             MOVE PC-NA                TO DL22-RCVG-DELY-DTE      19120000
191300     END-EVALUATE.                                                19130000
191400                                                                  19140000
191500***WRITES A 'NO-GRP-3' MESSAGE IF THE GRP-4 IS PRESENT            19150000
191600***PARA 7825- IS NOT EXECUTED HERE BECAUSE BOTH MESSAGES          19160000
191700***WOULD BE PRINTED. A GRP-3 SWITCH IS SET TO TRUE TO PREVENT THIS19170000
191800***SAME MESSAGE FROM BEING PRINTED AGAIN, AND TO PREVENT THE      19180000
191900***PAGE NUMBERING FROM BEING ALTERED WHEN PARA 7825- IS EXECUTED  19190000
192000***AT THE CONTROL BREAK.                                          19200000
192100     IF PS-GRP-3-UPDATES-WRITTEN-NO     AND                       19210000
192200        PV-PAGE-COUNT > +0              AND                       19220000
192300        PV-LINE-COUNT < PC-056                                    19230000
192400                                                                  19240000
192500        WRITE EXCEPTION-DETAIL-RECORD                             19250000
192600        FROM  DL-NO-UPDATES-DETAIL-LINE                           19260000
192700              AFTER ADVANCING 3 LINES                             19270000
192800                                                                  19280000
192900        ADD  +3       TO PV-LINE-COUNT                            19290000
193000        SET   PS-GRP-3-UPDATES-WRITTEN   TO TRUE                  19300000
193100     ELSE                                                         19310000
193200       IF PS-GRP-3-UPDATES-WRITTEN-NO   AND                       19320000
193300          PV-PAGE-COUNT > +0                                      19330000
193400          MOVE  +0     TO PV-LINE-COUNT                           19340000
193500          ADD  +1      TO PV-PAGE-COUNT                           19350000
193600          MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER             19360000
193700                                                                  19370000
193800          WRITE EXCEPTION-DETAIL-RECORD                           19380000
193900          FROM  DP132O-STANDRD-HEADER-132-COLS                    19390000
194000          AFTER ADVANCING PAGE                                    19400000
194100                                                                  19410000
194200          WRITE EXCEPTION-DETAIL-RECORD                           19420000
194300          FROM  HL2-HEADING-LINE-2                                19430000
194400          AFTER ADVANCING 1 LINE                                  19440000
194500                                                                  19450000
194600          WRITE EXCEPTION-DETAIL-RECORD                           19460000
194700          FROM  HL3-HEADING-LINE-3                                19470000
194800          AFTER ADVANCING 1 LINE                                  19480000
194900                                                                  19490000
195000          PERFORM 7300-BUILD-CONTINUE-LINE                        19500000
195100                                                                  19510000
195200          WRITE EXCEPTION-DETAIL-RECORD                           19520000
195300          FROM  HL5-CONTINUE-LINE                                 19530000
195400          AFTER ADVANCING 3 LINES                                 19540000
195500                                                                  19550000
195600          WRITE EXCEPTION-DETAIL-RECORD                           19560000
195700          FROM  DL-NO-UPDATES-DETAIL-LINE                         19570000
195800                AFTER ADVANCING 3 LINES                           19580000
195900                                                                  19590000
196000          ADD  +8       TO PV-LINE-COUNT                          19600000
196100          SET   PS-GRP-3-UPDATES-WRITTEN   TO TRUE                19610000
196200       END-IF                                                     19620000
196300     END-IF.                                                      19630000
196400                                                                  19640000
196500     SET PS-NEW-PAGE-WRITTEN-NO      TO TRUE.                     19650000
196600     PERFORM 6200-CHECK-LINE-COUNT.                               19660000
196700                                                                  19670000
196800     IF PS-IMPRT-HEADINGS-WRITTEN-NO    AND                       19680000
196900        PS-NEW-PAGE-WRITTEN-NO                                    19690000
197000        WRITE EXCEPTION-DETAIL-RECORD                             19700000
197100        FROM  DL20-DETAIL-LINE-20                                 19710000
197200              AFTER ADVANCING 4 LINES                             19720000
197300        WRITE EXCEPTION-DETAIL-RECORD                             19730000
197400        FROM  DL21-DETAIL-LINE-21                                 19740000
197500              AFTER ADVANCING 1 LINE                              19750000
197600        WRITE EXCEPTION-DETAIL-RECORD                             19760000
197700        FROM  DL22-DETAIL-LINE-22                                 19770000
197800              AFTER ADVANCING 2 LINES                             19780000
197900                                                                  19790000
198000        SET PS-IMPRT-HEADINGS-WRITTEN    TO TRUE                  19800000
198100        ADD  +7       TO PV-LINE-COUNT                            19810000
198200        MOVE PV-LINE-COUNT           TO PV-LAST-DETAIL-LINE-COUNT 19820000
198300        MOVE PV-PAGE-COUNT           TO PV-LAST-DETAIL-PAGE-COUNT 19830000
198400     ELSE                                                         19840000
198500        IF PS-NEW-PAGE-WRITTEN-NO                                 19850000
198600           WRITE EXCEPTION-DETAIL-RECORD                          19860000
198700           FROM  DL22-DETAIL-LINE-22                              19870000
198800                 AFTER ADVANCING 1 LINE                           19880000
198900                                                                  19890000
199000           ADD  +1       TO PV-LINE-COUNT                         19900000
199100           MOVE PV-LINE-COUNT        TO PV-LAST-DETAIL-LINE-COUNT 19910000
199200           MOVE PV-PAGE-COUNT        TO PV-LAST-DETAIL-PAGE-COUNT 19920000
199300        END-IF                                                    19930000
199400     END-IF.                                                      19940000
199500                                                                  19950000
199600     SET PS-GRP-4-LOAD-DATA-WRITTEN       TO TRUE.                19960000
199700                                                                  19970000
199800 EJECT                                                            19980000
199900                                                                  19990000
200000******************************************************************20000000
200100* 1) READ A RECORD FROM THE INPUT EXCEPTION FILE.                *20010000
200200* 2) CHECK FOR NECESSARY EMPTY FILE HANDLING.                    *20020000
200300* 3) COMPARE THE INCOMING KEY FIELDS TO THE CURRENT FIELDS TO    *20030000
200400*    DENOTE A CONTROL BREAK, RESET SWITCHES AND ADD TO COUNTERS. *20040000
200500* 4) WRITE END OR REPORT MESSAGES FOR EITHER REPORT WHEN THERE   *20050000
200600*    ARE ONLY DETAILS OR ONLY ERRORS.                            *20060000
200700******************************************************************20070000
200800 6000-READ-EXCEPTION-RECORD.                                      20080000
200900                                                                  20090000
201000      SET PS-FILE-IS-EMPTY-NO                 TO TRUE.            20100000
201100      SET PS-ERRORS-IN-FILE                   TO TRUE.            20110000
201200                                                                  20120000
201300      READ EXCEPTION-FILE                                         20130000
201400          INTO PV-RECORD-KEY                                      20140000
201500          AT END                                                  20150000
201600          SET PS-END-OF-EXCEPTIONS            TO TRUE.            20160000
201700                                                                  20170000
201800** WRITE EMPTY FILE MSG FOR DETAIL RPT WHEN INPUT FILE IS EMPTY   20180000
201900      IF  PS-END-OF-EXCEPTIONS              AND                   20190000
202000          PA-TOTAL-RECORDS-READ EQUAL ZERO  AND                   20200000
202100          PA-DETAILS-WRITTEN EQUAL ZERO                           20210000
202200          SET PS-FILE-IS-EMPTY   TO TRUE                          20220000
202300          PERFORM 6100-EMPTY-DETAIL-FILE                          20230000
202400      ELSE                                                        20240000
202500         SET PS-GOOD-RECORD                   TO TRUE             20250000
202600      END-IF.                                                     20260000
202700                                                                  20270000
202800** WRITE EMPTY FILE MSG FOR DETAIL RPT WHEN THERE IS AN ERROR RPT 20280000
202900      IF  PS-END-OF-EXCEPTIONS              AND                   20290000
203000          PA-TOTAL-RECORDS-READ   >   ZERO  AND                   20300000
203100          PA-DETAILS-WRITTEN EQUAL ZERO                           20310000
203200          PERFORM 6100-EMPTY-DETAIL-FILE                          20320000
203300      ELSE                                                        20330000
203400         SET PS-GOOD-RECORD                   TO TRUE             20340000
203500      END-IF.                                                     20350000
203600                                                                  20360000
203700** WRITE EMPTY FILE MSG FOR ERROR RPT WHEN INPUT FILE IS EMPTY    20370000
203800      IF  PS-END-OF-EXCEPTIONS              AND                   20380000
203900          PA-TOTAL-RECORDS-READ EQUAL ZERO  AND                   20390000
204000          PA-ERRORS-WRITTEN EQUAL ZERO                            20400000
204100          SET PS-FILE-IS-EMPTY   TO TRUE                          20410000
204200          SET PS-ERRORS-IN-FILE-NO            TO TRUE             20420000
204300          PERFORM 6105-EMPTY-ERROR-FILE                           20430000
204400      ELSE                                                        20440000
204500         SET PS-GOOD-RECORD                   TO TRUE             20450000
204600      END-IF.                                                     20460000
204700                                                                  20470000
204800** WRITE EMPTY FILE MSG FOR ERROR RPT WHEN THERE IS A DETAIL RPT  20480000
204900      IF  PS-END-OF-EXCEPTIONS              AND                   20490000
205000          PA-TOTAL-RECORDS-READ   >   ZERO  AND                   20500000
205100          PA-ERRORS-WRITTEN EQUAL ZERO                            20510000
205200          SET PS-ERRORS-IN-FILE-NO            TO TRUE             20520000
205300          PERFORM 6105-EMPTY-ERROR-FILE                           20530000
205400      ELSE                                                        20540000
205500         SET PS-GOOD-RECORD                   TO TRUE             20550000
205600      END-IF.                                                     20560000
205700                                                                  20570000
205800      IF PS-END-OF-EXCEPTIONS-NO                                  20580000
205900         ADD  +1              TO PA-TOTAL-RECORDS-READ            20590000
206000      END-IF.                                                     20600000
206100                                                                  20610000
206200      SET PS-NEW-PO-GROUP-NO                     TO TRUE.         20620000
206300      IF (PV-KEY-PO-NBR-X    NOT EQUAL PV-CURRENT-PO-NBR-X OR     20630000
206400          PV-KEY-CNTRL-NBR-X NOT EQUAL PV-CURRENT-CNTRL-NBR-X OR  20640000
206500          PV-KEY-TRBL-RSN-CDE-X NOT EQUAL                         20650000
206600                             PV-CURRENT-TRBL-RSN-CDE-X)           20660000
206700         AND                                                      20670000
206800         PV-KEY-GROUP-TYP-CDE   EQUAL PC-01                       20680000
206900         AND                                                      20690000
207000         PS-END-OF-EXCEPTIONS-NO                                  20700004
207100             PERFORM 7825-GRPS-NOT-WRITTEN-MSG-CHK                20710000
207200             SET PS-RULE-HEADINGS-WRITTEN-NO     TO TRUE          20720000
207300             SET PS-IMPRT-HEADINGS-WRITTEN-NO    TO TRUE          20730000
207400             SET PS-NEW-PO-GROUP                 TO TRUE          20740000
207500             SET PS-GRP-3-UPDATES-WRITTEN-NO     TO TRUE          20750000
207600             SET PS-GRP-4-LOAD-DATA-WRITTEN-NO   TO TRUE          20760000
207700             ADD  +1                  TO PA-PO-GROUPS-PROCESSED   20770000
207800      END-IF.                                                     20780000
207900                                                                  20790000
208000      IF (PV-KEY-PO-NBR-X    NOT EQUAL PV-CURRENT-PO-NBR-X OR     20800000
208100          PV-KEY-CNTRL-NBR-X NOT EQUAL PV-CURRENT-CNTRL-NBR-X OR  20810000
208200          TM602-TRBL-RSN-CDE NOT EQUAL PV-CURRENT-TRBL-RSN-CDE-X) 20820000
208300         AND                                                      20830000
208400         PV-KEY-GROUP-TYP-CDE   EQUAL PC-05                       20840000
208500         AND                                                      20850000
208600         PS-END-OF-EXCEPTIONS-NO                                  20860000
208700             SET PS-NEW-PO-GROUP                 TO TRUE          20870000
208800             ADD  +1                  TO PA-PO-GROUPS-PROCESSED   20880000
208900      END-IF.                                                     20890000
209000                                                                  20900000
209100* WRITE AND END-OF-REPORT MESSAGE FOR DETAIL REPORT IF THERE IS   20910000
209200* NO ERROR REPORT                                                 20920000
209300      IF PV-KEY-RECORD-TYP  EQUAL PC-D  AND                       20930000
209400         PS-END-OF-EXCEPTIONS           AND                       20940000
209500         PA-DETAILS-WRITTEN  >    ZERO  AND                       20950000
209600         PV-LINE-COUNT       <  PC-PAGE-SIZE-060                  20960004
209700            PERFORM 7825-GRPS-NOT-WRITTEN-MSG-CHK                 20970000
209800                                                                  20980000
209900            WRITE EXCEPTION-DETAIL-RECORD                         20990000
210000               FROM ER-END-OF-REPORT-LINE                         21000000
210100               AFTER ADVANCING 4 LINES                            21010000
210200      ELSE                                                        21020000
210300         IF PV-KEY-RECORD-TYP  EQUAL PC-D  AND                    21030000
210400            PS-END-OF-EXCEPTIONS           AND                    21040000
210500            PA-DETAILS-WRITTEN  >    ZERO  AND                    21050000
210600            PV-LINE-COUNT       >  PC-PAGE-SIZE-060               21060000
210700               ADD  +1             TO PV-PAGE-COUNT               21070000
210800               MOVE PV-PAGE-COUNT  TO DP132O-PAGE-NUMBER          21080000
210900                                                                  21090000
211000               WRITE EXCEPTION-DETAIL-RECORD                      21100000
211100               FROM  DP132O-STANDRD-HEADER-132-COLS               21110000
211200               AFTER ADVANCING PAGE                               21120000
211300                                                                  21130000
211400               PERFORM 7825-GRPS-NOT-WRITTEN-MSG-CHK              21140000
211500                                                                  21150000
211600               WRITE EXCEPTION-DETAIL-RECORD                      21160000
211700                  FROM ER-END-OF-REPORT-LINE                      21170000
211800                  AFTER ADVANCING 4 LINES                         21180000
211900      END-IF.                                                     21190000
212000                                                                  21200000
212100* WRITE AND END-OF-REPORT MESSAGE FOR ERROR REPORT IF THERE IS    21210000
212200* NO DETAIL REPORT                                                21220000
212300      IF PV-KEY-RECORD-TYP  EQUAL PC-E  AND                       21230000
212400         PS-END-OF-EXCEPTIONS           AND                       21240000
212500         PA-ERRORS-WRITTEN   >    ZERO  AND                       21250000
212600         PV-LINE-COUNT       <  PC-PAGE-SIZE-060                  21260000
212700            WRITE EXCEPTION-ERROR-RECORD                          21270000
212800               FROM ER-END-OF-REPORT-LINE                         21280000
212900               AFTER ADVANCING 4 LINES                            21290000
213000      ELSE                                                        21300000
213100         IF PV-KEY-RECORD-TYP  EQUAL PC-E  AND                    21310000
213200            PS-END-OF-EXCEPTIONS           AND                    21320000
213300            PA-ERRORS-WRITTEN   >    ZERO  AND                    21330000
213400            PV-LINE-COUNT       >  PC-PAGE-SIZE-060               21340000
213500               ADD  +1             TO PV-PAGE-COUNT               21350000
213600               MOVE PV-PAGE-COUNT  TO DP132O-PAGE-NUMBER          21360000
213700               WRITE EXCEPTION-ERROR-RECORD                       21370000
213800               FROM  DP132O-STANDRD-HEADER-132-COLS               21380000
213900               AFTER ADVANCING PAGE                               21390000
214000               WRITE EXCEPTION-ERROR-RECORD                       21400000
214100                  FROM ER-END-OF-REPORT-LINE                      21410000
214200                  AFTER ADVANCING 4 LINES                         21420000
214300      END-IF.                                                     21430000
214400                                                                  21440000
214500 EJECT                                                            21450000
214600                                                                  21460000
214700******************************************************************21470000
214800* WRITES '***** NO DATA *****' TO THE DETAIL REPORT.             *21480000
214900******************************************************************21490000
215000 6100-EMPTY-DETAIL-FILE.                                          21500000
215100                                                                  21510000
215200        PERFORM  7000-WRITE-DETAIL-HEADINGS.                      21520000
215300        WRITE EXCEPTION-DETAIL-RECORD                             21530000
215400           FROM EP-EMPTY-REPORT-LINE                              21540000
215500           AFTER ADVANCING 4 LINES.                               21550000
215600        WRITE EXCEPTION-DETAIL-RECORD                             21560000
215700           FROM ER-END-OF-REPORT-LINE                             21570000
215800        AFTER ADVANCING 4 LINES.                                  21580000
215900                                                                  21590000
216000 EJECT                                                            21600000
216100                                                                  21610000
216200******************************************************************21620000
216300* WRITES '***** NO DATA *****' TO THE ERROR REPORT.              *21630000
216400******************************************************************21640000
216500 6105-EMPTY-ERROR-FILE.                                           21650000
216600                                                                  21660000
216700        PERFORM  7001-WRITE-ERROR-HEADINGS.                       21670000
216800        WRITE EXCEPTION-ERROR-RECORD                              21680000
216900        FROM EP-EMPTY-REPORT-LINE                                 21690000
217000           AFTER ADVANCING 4 LINES.                               21700000
217100        WRITE EXCEPTION-ERROR-RECORD                              21710000
217200        FROM ER-END-OF-REPORT-LINE                                21720000
217300           AFTER ADVANCING 4 LINES.                               21730000
217400                                                                  21740000
217500 EJECT                                                            21750000
217600                                                                  21760000
217700******************************************************************21770000
217800* CHECKS LINE COUNT TO SEE IF THERE NEEDS TO BE A CONTINUATION    21780000
217900* TO A NEW PAGE. GROUP 2, GROUP 3 AND GROUP 4 RECORD TYPES WILL   21790000
218000* NEED TO DO THIS. THERE MAY BE MULTIPLE ROWS FOR GROUP 2 AND     21800000
218100* GROUP 4 RECORD TYPES. (AND GROUP 5 WHICH ARE ERRORS)            21810000
218200* THE PAGE SIZE USED HERE IS 60 LINES. IF THE COUNTER IS GREATER  21820000
218300* THAN OR EQUAL TO 54, A NEW PAGE IS NEEDED BECAUSE THE HEADER    21830000
218400* WILL USE 6 LINES.                                               21840000
218500******************************************************************21850000
218600 6200-CHECK-LINE-COUNT.                                           21860000
218700                                                                  21870000
218800      IF PS-NEW-PO-GROUP               AND                        21880000
218900         PV-KEY-GROUP-TYP-CDE = PC-01  AND                        21890000
219000         PA-DETAILS-WRITTEN   > ZERO                              21900000
219100            MOVE  +0     TO PV-LINE-COUNT                         21910000
219200            ADD  +1      TO PV-PAGE-COUNT                         21920000
219300            MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER           21930000
219400                                                                  21940000
219500            WRITE EXCEPTION-DETAIL-RECORD                         21950000
219600            FROM  DP132O-STANDRD-HEADER-132-COLS                  21960000
219700            AFTER ADVANCING PAGE                                  21970000
219800                                                                  21980000
219900            WRITE EXCEPTION-DETAIL-RECORD                         21990000
220000            FROM  HL2-HEADING-LINE-2                              22000000
220100            AFTER ADVANCING 1 LINE                                22010000
220200                                                                  22020000
220300            WRITE EXCEPTION-DETAIL-RECORD                         22030000
220400            FROM  HL3-HEADING-LINE-3                              22040000
220500            AFTER ADVANCING 1 LINE                                22050000
220600                                                                  22060000
220700            ADD  +3      TO PV-LINE-COUNT                         22070000
220800                                                                  22080000
220900            SET PS-NEW-PO-GROUP-NO TO TRUE                        22090000
221000      END-IF.                                                     22100000
221100                                                                  22110000
221200      IF PV-LINE-COUNT  >=  PC-PAGE-SIZE-060                      22120000
221300         SET PS-ERROR-HEADINGS-WRITTEN-NO     TO TRUE             22130000
221400         SET PS-RULE-HEADINGS-WRITTEN-NO      TO TRUE             22140000
221500         SET PS-IMPRT-HEADINGS-WRITTEN-NO     TO TRUE             22150000
221600                                                                  22160000
221700         EVALUATE PV-KEY-GROUP-TYP-CDE                            22170000
221800             WHEN PC-02                                           22180000
221900                  MOVE  +0     TO PV-LINE-COUNT                   22190000
222000                  ADD  +1      TO PV-PAGE-COUNT                   22200000
222100                  MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER     22210000
222200                                                                  22220000
222300                  WRITE EXCEPTION-DETAIL-RECORD                   22230000
222400                  FROM  DP132O-STANDRD-HEADER-132-COLS            22240000
222500                  AFTER ADVANCING PAGE                            22250000
222600                                                                  22260000
222700                  WRITE EXCEPTION-DETAIL-RECORD                   22270000
222800                  FROM  HL2-HEADING-LINE-2                        22280000
222900                  AFTER ADVANCING 1 LINE                          22290000
223000                                                                  22300000
223100                  WRITE EXCEPTION-DETAIL-RECORD                   22310000
223200                  FROM  HL3-HEADING-LINE-3                        22320000
223300                  AFTER ADVANCING 1 LINE                          22330000
223400                                                                  22340000
223500                  PERFORM 7300-BUILD-CONTINUE-LINE                22350000
223600                                                                  22360000
223700                  WRITE EXCEPTION-DETAIL-RECORD                   22370000
223800                  FROM  HL5-CONTINUE-LINE                         22380000
223900                  AFTER ADVANCING 3 LINES                         22390000
224000                                                                  22400000
224100                  SET PS-RULE-HEADINGS-WRITTEN    TO TRUE         22410000
224200                  SET PS-NEW-PAGE-WRITTEN         TO TRUE         22420000
224300                                                                  22430000
224400                  WRITE EXCEPTION-DETAIL-RECORD                   22440000
224500                  FROM  DL14-DETAIL-LINE-14                       22450000
224600                  AFTER ADVANCING 4 LINES                         22460000
224700                                                                  22470000
224800                  WRITE EXCEPTION-DETAIL-RECORD                   22480000
224900                  FROM  DL15-DETAIL-LINE-15                       22490000
225000                  AFTER ADVANCING 1 LINE                          22500000
225100                                                                  22510000
225200                  WRITE EXCEPTION-DETAIL-RECORD                   22520000
225300                  FROM  DL16-DETAIL-LINE-16                       22530000
225400                  AFTER ADVANCING 2 LINES                         22540000
225500                                                                  22550000
225600                  ADD  +14     TO PV-LINE-COUNT                   22560000
225700                                                                  22570000
225800             WHEN PC-03                                           22580000
225900                  MOVE  +0     TO PV-LINE-COUNT                   22590000
226000                  ADD  +1      TO PV-PAGE-COUNT                   22600000
226100                  MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER     22610000
226200                                                                  22620000
226300                  WRITE EXCEPTION-DETAIL-RECORD                   22630000
226400                  FROM  DP132O-STANDRD-HEADER-132-COLS            22640000
226500                  AFTER ADVANCING PAGE                            22650000
226600                                                                  22660000
226700                  WRITE EXCEPTION-DETAIL-RECORD                   22670000
226800                  FROM  HL2-HEADING-LINE-2                        22680000
226900                  AFTER ADVANCING 1 LINE                          22690000
227000                                                                  22700000
227100                  WRITE EXCEPTION-DETAIL-RECORD                   22710000
227200                  FROM  HL3-HEADING-LINE-3                        22720000
227300                  AFTER ADVANCING 1 LINE                          22730000
227400                                                                  22740000
227500                  PERFORM 7300-BUILD-CONTINUE-LINE                22750000
227600                                                                  22760000
227700                  WRITE EXCEPTION-DETAIL-RECORD                   22770000
227800                  FROM  HL5-CONTINUE-LINE                         22780000
227900                  AFTER ADVANCING 3 LINES                         22790000
228000                                                                  22800000
228100                  WRITE EXCEPTION-DETAIL-RECORD                   22810000
228200                  FROM  DL17-DETAIL-LINE-17                       22820000
228300                  AFTER ADVANCING 4 LINES                         22830000
228400                                                                  22840000
228500                  WRITE EXCEPTION-DETAIL-RECORD                   22850000
228600                  FROM  DL18-DETAIL-LINE-18                       22860000
228700                  AFTER ADVANCING 1 LINE                          22870000
228800                                                                  22880000
228900                  WRITE EXCEPTION-DETAIL-RECORD                   22890000
229000                  FROM  DL19-DETAIL-LINE-19                       22900000
229100                  AFTER ADVANCING 1 LINE                          22910000
229200                                                                  22920000
229300                  ADD  +13     TO PV-LINE-COUNT                   22930000
229400                  SET PS-NEW-PAGE-WRITTEN         TO TRUE         22940000
229500                                                                  22950000
229600             WHEN PC-04                                           22960000
229700                  MOVE  +0     TO PV-LINE-COUNT                   22970000
229800                  ADD  +1      TO PV-PAGE-COUNT                   22980000
229900                  MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER     22990000
230000                                                                  23000000
230100                  WRITE EXCEPTION-DETAIL-RECORD                   23010000
230200                  FROM  DP132O-STANDRD-HEADER-132-COLS            23020000
230300                  AFTER ADVANCING PAGE                            23030000
230400                                                                  23040000
230500                  WRITE EXCEPTION-DETAIL-RECORD                   23050000
230600                  FROM  HL2-HEADING-LINE-2                        23060000
230700                  AFTER ADVANCING 1 LINE                          23070000
230800                                                                  23080000
230900                  WRITE EXCEPTION-DETAIL-RECORD                   23090000
231000                  FROM  HL3-HEADING-LINE-3                        23100000
231100                  AFTER ADVANCING 1 LINE                          23110000
231200                                                                  23120000
231300                  PERFORM 7300-BUILD-CONTINUE-LINE                23130000
231400                                                                  23140000
231500                  WRITE EXCEPTION-DETAIL-RECORD                   23150000
231600                  FROM  HL5-CONTINUE-LINE                         23160000
231700                  AFTER ADVANCING 3 LINES                         23170000
231800                                                                  23180000
231900                  WRITE EXCEPTION-DETAIL-RECORD                   23190000
232000                  FROM  DL20-DETAIL-LINE-20                       23200000
232100                  AFTER ADVANCING 4 LINES                         23210000
232200                                                                  23220000
232300                  WRITE EXCEPTION-DETAIL-RECORD                   23230000
232400                  FROM  DL21-DETAIL-LINE-21                       23240000
232500                  AFTER ADVANCING 1 LINES                         23250000
232600                                                                  23260000
232700                  SET PS-IMPRT-HEADINGS-WRITTEN   TO TRUE         23270000
232800                  SET PS-NEW-PAGE-WRITTEN         TO TRUE         23280000
232900                                                                  23290000
233000                  WRITE EXCEPTION-DETAIL-RECORD                   23300000
233100                  FROM  DL22-DETAIL-LINE-22                       23310000
233200                  AFTER ADVANCING 2 LINES                         23320000
233300                                                                  23330000
233400                  ADD  +14     TO PV-LINE-COUNT                   23340000
233500                                                                  23350000
233600             WHEN PC-05                                           23360000
233700                  MOVE  +0     TO PV-LINE-COUNT                   23370000
233800                  ADD  +1               TO PV-PAGE-COUNT          23380000
233900                  MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER     23390000
234000                                                                  23400000
234100                  WRITE EXCEPTION-ERROR-RECORD                    23410000
234200                  FROM  DP132O-STANDRD-HEADER-132-COLS            23420000
234300                  AFTER ADVANCING PAGE                            23430000
234400                                                                  23440000
234500                  WRITE EXCEPTION-ERROR-RECORD                    23450000
234600                  FROM  HL2-HEADING-LINE-2                        23460000
234700                  AFTER ADVANCING 1 LINE                          23470000
234800                                                                  23480000
234900                  WRITE EXCEPTION-ERROR-RECORD                    23490000
235000                  FROM  HL4-HEADING-LINE-4                        23500000
235100                  AFTER ADVANCING 1 LINE                          23510000
235200                                                                  23520000
235300                  WRITE EXCEPTION-ERROR-RECORD                    23530000
235400                  FROM  DL23-DETAIL-LINE-23                       23540000
235500                  AFTER ADVANCING 2 LINES                         23550000
235600                                                                  23560000
235700                  SET PS-ERROR-HEADINGS-WRITTEN   TO TRUE         23570000
235800                  SET PS-NEW-PAGE-WRITTEN         TO TRUE         23580000
235900                                                                  23590000
236000                  WRITE EXCEPTION-ERROR-RECORD                    23600000
236100                  FROM  DL24-DETAIL-LINE-24                       23610000
236200                  AFTER ADVANCING 2 LINES                         23620000
236300                                                                  23630000
236400                  ADD  +1      TO PA-ERRORS-WRITTEN               23640000
236500                  ADD  +8      TO PV-LINE-COUNT                   23650000
236600                                                                  23660000
236700         END-EVALUATE                                             23670000
236800      ELSE                                                        23680000
236900         CONTINUE                                                 23690000
237000      END-IF.                                                     23700000
237100                                                                  23710000
237200 EJECT                                                            23720000
237300                                                                  23730000
237400******************************************************************23740000
237500* WRITES THE STANDARD 132 COLUMN REPORT HEADER FOR KOHL'S AND    *23750000
237600* THE TWO TITLE/SUBTITLE LINES FOR THE DETAIL  REPORT.           *23760000
237700******************************************************************23770000
237800 7000-WRITE-DETAIL-HEADINGS.                                      23780000
237900                                                                  23790000
238000      IF PS-FILE-IS-EMPTY  OR PA-DETAILS-WRITTEN EQUAL ZERO       23800000
238100         MOVE PC-1             TO DP132O-REPORT-NUMBER            23810000
238200         MOVE  +1              TO PV-PAGE-COUNT                   23820000
238300         MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER              23830000
238400         MOVE +0               TO PV-LINE-COUNT                   23840000
238500      ELSE                                                        23850000
238600         MOVE PC-1             TO DP132O-REPORT-NUMBER            23860000
238700         ADD  +1               TO PV-PAGE-COUNT                   23870000
238800         MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER              23880000
238900         MOVE +0               TO PV-LINE-COUNT                   23890000
239000      END-IF.                                                     23900000
239100                                                                  23910000
239200      WRITE EXCEPTION-DETAIL-RECORD                               23920000
239300      FROM  DP132O-STANDRD-HEADER-132-COLS                        23930000
239400      AFTER ADVANCING PAGE.                                       23940000
239500                                                                  23950000
239600      WRITE EXCEPTION-DETAIL-RECORD                               23960000
239700      FROM  HL2-HEADING-LINE-2                                    23970000
239800      AFTER ADVANCING 1 LINE.                                     23980000
239900                                                                  23990000
240000      WRITE EXCEPTION-DETAIL-RECORD                               24000000
240100      FROM  HL3-HEADING-LINE-3                                    24010000
240200      AFTER ADVANCING 1 LINE.                                     24020000
240300                                                                  24030000
240400      ADD  +6      TO PV-LINE-COUNT.                              24040000
240500      SET PS-DETAIL-HEADINGS-WRITTEN    TO TRUE.                  24050000
240600                                                                  24060000
240700 EJECT                                                            24070000
240800                                                                  24080000
240900******************************************************************24090000
241000* WRITES THE STANDARD 132 COLUMN REPORT HEADER FOR KOHL'S AND    *24100000
241100* THE TWO TITLE/SUBTITLE LINES FOR THE DETAIL  REPORT.           *24110000
241200******************************************************************24120000
241300 7001-WRITE-ERROR-HEADINGS.                                       24130000
241400                                                                  24140000
241500      IF PS-FILE-IS-EMPTY  OR PA-ERRORS-WRITTEN EQUAL ZERO        24150000
241600         MOVE PC-2             TO DP132O-REPORT-NUMBER            24160000
241700         MOVE  +1              TO PV-PAGE-COUNT                   24170000
241800         MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER              24180000
241900         MOVE +0               TO PV-LINE-COUNT                   24190000
242000      ELSE                                                        24200000
242100         MOVE PC-2             TO DP132O-REPORT-NUMBER            24210000
242200         ADD  +1               TO PV-PAGE-COUNT                   24220000
242300         MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER              24230000
242400         MOVE +0               TO PV-LINE-COUNT                   24240000
242500      END-IF.                                                     24250000
242600                                                                  24260000
242700      WRITE EXCEPTION-ERROR-RECORD                                24270000
242800      FROM  DP132O-STANDRD-HEADER-132-COLS                        24280000
242900      AFTER ADVANCING PAGE.                                       24290000
243000                                                                  24300000
243100      WRITE EXCEPTION-ERROR-RECORD                                24310000
243200      FROM  HL2-HEADING-LINE-2                                    24320000
243300      AFTER ADVANCING 1 LINE.                                     24330000
243400                                                                  24340000
243500      WRITE EXCEPTION-ERROR-RECORD                                24350000
243600      FROM  HL4-HEADING-LINE-4                                    24360000
243700      AFTER ADVANCING 1 LINE.                                     24370000
243800                                                                  24380000
243900      IF PS-ERRORS-IN-FILE                                        24390000
244000            WRITE EXCEPTION-ERROR-RECORD                          24400000
244100            FROM  DL23-DETAIL-LINE-23                             24410000
244200            AFTER ADVANCING 2 LINES                               24420000
244300            ADD  +2      TO PV-LINE-COUNT                         24430000
244400      END-IF.                                                     24440000
244500                                                                  24450000
244600      ADD  +6      TO PV-LINE-COUNT.                              24460000
244700      SET PS-ERROR-HEADINGS-WRITTEN     TO TRUE.                  24470000
244800                                                                  24480000
244900 EJECT                                                            24490000
245000                                                                  24500000
245100******************************************************************24510000
245200* THIS FIELD IS DISPLAYED AS 'EVENT' ON THE DETAIL REPORT        *24520000
245300* CODE ID = 500                                                  *24530000
245400******************************************************************24540000
245500 7100-DETERMINE-DATA-SOURCE.                                      24550000
245600                                                                  24560000
245700     PERFORM                                                      24570000
245800         WITH TEST AFTER                                          24580000
245900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     24590000
246000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            24600000
246100                 SQLCODE = ZERO                     OR            24610000
246200                 SQLCODE = +100                                   24620000
246300                                                                  24630000
246400         EXEC SQL                                                 24640000
246500              SELECT CDVL_SHRT_DESC                               24650000
246600              INTO   :ICDVAL-CDVL-SHRT-DESC                       24660000
246700              FROM   TICDMST  A                                   24670000
246800                   , TICDVAL  B                                   24680000
246900              WHERE B.CDE_ID             = :PC-DATA-ID-500        24690000
247000              AND   B.CDVL_CDE           = :TM602-DATA-SOURCE     24700000
247100              AND   A.CDE_ID             =  B.CDE_ID              24710000
247200              AND   A.CDE_EFF_STRT_DTE   <  CURRENT DATE          24720000
247300              AND   (A.CDE_EFF_END_DTE   >  CURRENT DATE OR       24730000
247400                     A.CDE_EFF_END_DTE   =  :PC-DEFAULT-DTE)      24740000
247500              AND   B.CDVL_EFF_STRT_DTE  <  CURRENT DATE          24750000
247600              AND   (B.CDVL_EFF_END_DTE  >  CURRENT DATE OR       24760000
247700                     B.CDVL_EFF_END_DTE  =  :PC-DEFAULT-DTE)      24770000
247800         END-EXEC                                                 24780000
247900                                                                  24790000
248000         EVALUATE TRUE                                            24800000
248100             WHEN SQLCODE = ZERO                                  24810000
248200                 MOVE ICDVAL-CDVL-SHRT-DESC TO DL1-EVENT          24820000
248300             WHEN SQLCODE = +100                                  24830000
248400                 MOVE PC-NA                TO DL1-EVENT           24840000
248500                                                                  24850000
248600             WHEN SQLWARN0 NOT EQUAL SPACE                        24860000
248700              DISPLAY '**************************************'    24870000
248800              DISPLAY '**ABEND                             **'    24880000
248900              DISPLAY '**PROGRAM = TMKRP635                **'    24890000
249000              DISPLAY '**PARAGRAPH = 7100-DETERMINE-DATA-SOURCE'  24900000
249100              DISPLAY '**CURRENT PO NBR  :' PV-CURRENT-PO-NBR-X   24910000
249200              DISPLAY '**CURRENT CNTL NBR:' PV-CURRENT-CNTRL-NBR-X24920000
249300              DISPLAY '**************************************'    24930000
249400              PERFORM 9100-SQL-ABEND                              24940000
249500         END-EVALUATE                                             24950000
249600     END-PERFORM.                                                 24960000
249700                                                                  24970000
249800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    24980000
249900         (SQLCODE NOT = ZERO    AND                               24990000
250000             SQLCODE NOT = +100 AND                               25000000
250100             SQLCODE NOT = -811)                                  25010000
250200         DISPLAY '****************************************'       25020000
250300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       25030000
250400         DISPLAY '** SELECT FROM TICDMST AND TICDVAL    **'       25040000
250500         DISPLAY '** PARAGRAPH = 7100-DETERMINE-DATA-SOURCE'      25050000
250600         DISPLAY '****************************************'       25060000
250700         PERFORM 9100-SQL-ABEND                                   25070000
250800     END-IF.                                                      25080000
250900                                                                  25090000
251000 EJECT                                                            25100000
251100                                                                  25110000
251200******************************************************************25120000
251300* THIS FIELD IS DISPLAYED AS 'RESOLUTION ACTION' ON DETAIL REPORT*25130000
251400* CODE ID = 600                                                  *25140000
251500******************************************************************25150000
251600 7125-DETERMINE-RES-ACTION.                                       25160000
251700                                                                  25170000
251800     PERFORM                                                      25180000
251900         WITH TEST AFTER                                          25190000
252000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     25200000
252100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            25210000
252200                 SQLCODE = ZERO                     OR            25220000
252300                 SQLCODE = +100                                   25230000
252400                                                                  25240000
252500         EXEC SQL                                                 25250000
252600              SELECT CDVL_SHRT_DESC                               25260000
252700              INTO   :ICDVAL-CDVL-SHRT-DESC                       25270000
252800              FROM   TICDMST  A                                   25280000
252900                   , TICDVAL  B                                   25290000
253000              WHERE B.CDE_ID             = :PC-DATA-ID-600        25300000
253100              AND   B.CDVL_CDE       = :TM604-CURR-ACTVY-RSLU-CDE 25310000
253200              AND   A.CDE_ID             =  B.CDE_ID              25320000
253300              AND   A.CDE_EFF_STRT_DTE   <  CURRENT DATE          25330000
253400              AND   (A.CDE_EFF_END_DTE   >  CURRENT DATE OR       25340000
253500                     A.CDE_EFF_END_DTE   =  :PC-DEFAULT-DTE)      25350000
253600              AND   B.CDVL_EFF_STRT_DTE  <  CURRENT DATE          25360000
253700              AND   (B.CDVL_EFF_END_DTE  >  CURRENT DATE OR       25370000
253800                     B.CDVL_EFF_END_DTE  =  :PC-DEFAULT-DTE)      25380000
253900         END-EXEC                                                 25390000
254000                                                                  25400000
254100         EVALUATE TRUE                                            25410000
254200             WHEN SQLCODE = ZERO                                  25420000
254300                 MOVE ICDVAL-CDVL-SHRT-DESC TO DL19-RESOLU-ACTION 25430000
254400             WHEN SQLCODE = +100                                  25440000
254500                 MOVE PC-NA                 TO DL19-RESOLU-ACTION 25450000
254600                                                                  25460000
254700             WHEN SQLWARN0 NOT EQUAL SPACE                        25470000
254800              DISPLAY '**************************************'    25480000
254900              DISPLAY '**ABEND                             **'    25490000
255000              DISPLAY '**PROGRAM = TMKRP635                **'    25500000
255100              DISPLAY '**PARAGRAPH = 7125-DETERMINE-RES-ACTION'   25510000
255200              DISPLAY '**CURRENT PO NBR  :' PV-CURRENT-PO-NBR-X   25520000
255300              DISPLAY '**CURRENT CNTL NBR:' PV-CURRENT-CNTRL-NBR-X25530000
255400              DISPLAY '**************************************'    25540000
255500              PERFORM 9100-SQL-ABEND                              25550000
255600         END-EVALUATE                                             25560000
255700     END-PERFORM.                                                 25570000
255800                                                                  25580000
255900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    25590000
256000         (SQLCODE NOT = ZERO    AND                               25600000
256100             SQLCODE NOT = +100 AND                               25610000
256200             SQLCODE NOT = -811)                                  25620000
256300         DISPLAY '****************************************'       25630000
256400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       25640000
256500         DISPLAY '** SELECT FROM TICDMST AND TICDVAL    **'       25650000
256600         DISPLAY '** PARAGRAPH = 7125-DETERMINE-RES-ACTION'       25660000
256700         DISPLAY '****************************************'       25670000
256800         PERFORM 9100-SQL-ABEND                                   25680000
256900     END-IF.                                                      25690000
257000                                                                  25700000
257100 EJECT                                                            25710000
257200******************************************************************25720000
257300* THIS WILL RETRIEVE A DESCRIPTION FROM THE TROUBLE REASON CODE  *25730000
257400******************************************************************25740000
257500 7150-DETERMINE-RSN-DESC.                                         25750000
257600                                                                  25760000
257700     PERFORM                                                      25770000
257800         WITH TEST AFTER                                          25780000
257900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     25790000
258000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            25800000
258100                 SQLCODE = ZERO                     OR            25810000
258200                 SQLCODE = +100                                   25820000
258300                                                                  25830000
258400         MOVE TM602-TRBL-RSN-CDE       TO TRBRSN-TRBL-RSN-CDE     25840000
258500                                                                  25850000
258600         EXEC SQL                                                 25860000
258700              SELECT TRBL_LONG_DESC                               25870000
258800              INTO   :TRBRSN-TRBL-LONG-DESC                       25880000
258900              FROM    TTRBRSN                                     25890000
259000              WHERE  TRBL_RSN_CDE = :TRBRSN-TRBL-RSN-CDE          25900000
259100         END-EXEC                                                 25910000
259200                                                                  25920000
259300         EVALUATE TRUE                                            25930000
259400             WHEN SQLCODE = ZERO                                  25940000
259500                 MOVE TRBRSN-TRBL-LONG-DESC TO DL2-TRBL-RSN-DESC  25950000
259600             WHEN SQLCODE = +100                                  25960000
259700                 MOVE PC-NA                 TO DL2-TRBL-RSN-DESC  25970000
259800                                                                  25980000
259900             WHEN SQLWARN0 NOT EQUAL SPACE                        25990000
260000              DISPLAY '**************************************'    26000000
260100              DISPLAY '**ABEND                             **'    26010000
260200              DISPLAY '**PROGRAM = TMKRP635                **'    26020000
260300              DISPLAY '**PARAGRAPH = 7150-DETERMINE-RSN-DESC'     26030000
260400              DISPLAY '**CURRENT PO NBR  :' PV-CURRENT-PO-NBR-X   26040000
260500              DISPLAY '**CURRENT CNTL NBR:' PV-CURRENT-CNTRL-NBR-X26050000
260600              DISPLAY '**************************************'    26060000
260700              PERFORM 9100-SQL-ABEND                              26070000
260800         END-EVALUATE                                             26080000
260900     END-PERFORM.                                                 26090000
261000                                                                  26100000
261100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    26110000
261200         (SQLCODE NOT = ZERO    AND                               26120000
261300             SQLCODE NOT = +100 AND                               26130000
261400             SQLCODE NOT = -811)                                  26140000
261500         DISPLAY '****************************************'       26150000
261600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       26160000
261700         DISPLAY '** SELECT FROM TTRBRSN                **'       26170000
261800         DISPLAY '** PARAGRAPH = 7150-DETERMINE-RSN-DESC'         26180000
261900         DISPLAY '****************************************'       26190000
262000         PERFORM 9100-SQL-ABEND                                   26200000
262100     END-IF.                                                      26210000
262200                                                                  26220000
262300 EJECT                                                            26230000
262400                                                                  26240000
262500******************************************************************26250000
262600* THIS IS USED TO DETERMINE THE CONSOLIDATOR, DECONSOLIDATOR AND *26260000
262700*  THE CUSTOMS BROKER FOR DL7-.                                  *26270000
262800******************************************************************26280000
262900 7175-DETERMINE-ENTITY-NAMES.                                     26290000
263000                                                                  26300000
263100     PERFORM                                                      26310000
263200         WITH TEST AFTER                                          26320000
263300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     26330000
263400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            26340000
263500                 SQLCODE = ZERO                     OR            26350000
263600                 SQLCODE = +100                                   26360000
263700                                                                  26370000
263800         EXEC SQL                                                 26380000
263900              SELECT ENT_NAME_DESC                                26390000
264000              INTO :ENTNME-ENT-NAME-DESC                          26400000
264100              FROM TENTNME                                        26410000
264200              WHERE  ENT_ID  = :ENTNME-ENT-ID                     26420000
264300              AND     TYPE_CDE  = '01'                            26430000
264400         END-EXEC                                                 26440000
264500                                                                  26450000
264600         EVALUATE TRUE                                            26460000
264610             WHEN SQLCODE = ZERO                                  26461005
264620                  CONTINUE                                        26462005
264630                                                                  26463005
264700             WHEN SQLWARN0 NOT EQUAL SPACE                        26470000
264800              DISPLAY '**************************************'    26480000
264900              DISPLAY '**ABEND                             **'    26490000
265000              DISPLAY '**PROGRAM = TMKRP635                **'    26500000
265100              DISPLAY '**PARAGRAPH= 7175-DETERMINE-ENTITY-NAMES'  26510000
265200              DISPLAY '**CURRENT PO NBR  :' PV-CURRENT-PO-NBR-X   26520000
265300              DISPLAY '**CURRENT CNTL NBR:' PV-CURRENT-CNTRL-NBR-X26530000
265400              DISPLAY '**ENTNME-ENT-ID   :' ENTNME-ENT-ID         26540000
265500              DISPLAY '**************************************'    26550000
265600              PERFORM 9100-SQL-ABEND                              26560000
265700         END-EVALUATE                                             26570000
265800     END-PERFORM.                                                 26580000
265900                                                                  26590000
266000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    26600000
266100         (SQLCODE NOT = ZERO    AND                               26610000
266200             SQLCODE NOT = +100 AND                               26620000
266300             SQLCODE NOT = -811)                                  26630000
266400         DISPLAY '****************************************'       26640000
266500         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       26650000
266600         DISPLAY '** SELECT FROM TENTNME                **'       26660000
266700         DISPLAY '** PARAGRAPH = 7175-DETERMINE-ENTITY-NAMES'     26670000
266800         DISPLAY '****************************************'       26680000
266900         PERFORM 9100-SQL-ABEND                                   26690000
267000     END-IF.                                                      26700000
267100                                                                  26710000
267200                                                                  26720000
267300 EJECT                                                            26730000
267400                                                                  26740000
267500******************************************************************26750000
267600* THIS APPEARS ON THE REPORT AS 'SOURCE PROCESS APPL CODE' AND   *26760000
267700* IS A PART OF DL16-.                                            *26770000
267800******************************************************************26780000
267900 7200-DETERMINE-SOURCE-APPL.                                      26790000
268000                                                                  26800000
268100     MOVE TM603-CURR-SRC-PRCG-APPL-CDE  TO PV-APPL-CDE            26810000
268200                                                                  26820000
268300     PERFORM                                                      26830000
268400         WITH TEST AFTER                                          26840000
268500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     26850000
268600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            26860000
268700                 SQLCODE = ZERO                     OR            26870000
268800                 SQLCODE = +100                                   26880000
268900                                                                  26890000
269000         EXEC SQL                                                 26900000
269100             SELECT CDVL_SHRT_DESC                                26910000
269200             INTO   :ICDVAL-CDVL-SHRT-DESC                        26920000
269300             FROM    TICDMST  A                                   26930000
269400                   , TICDVAL  B                                   26940000
269500             WHERE  B.CDE_ID            =   :PC-DATA-ID-600       26950000
269600             AND    B.CDVL_CDE          = :PV-APPL-CDE            26960000
269700             AND    A.CDE_ID            =    B.CDE_ID             26970000
269800             AND    A.CDE_EFF_STRT_DTE  <  CURRENT DATE           26980000
269900             AND   (A.CDE_EFF_END_DTE   >  CURRENT DATE OR        26990000
270000                    A.CDE_EFF_END_DTE   =  :PC-DEFAULT-DTE)       27000000
270100             AND    B.CDVL_EFF_STRT_DTE <  CURRENT DATE           27010000
270200             AND   (B.CDVL_EFF_END_DTE  >  CURRENT DATE OR        27020000
270300                    B.CDVL_EFF_END_DTE =  :PC-DEFAULT-DTE)        27030000
270400         END-EXEC                                                 27040000
270500                                                                  27050000
270600         EVALUATE TRUE                                            27060000
270700             WHEN SQLCODE = ZERO                                  27070000
270800                 MOVE ICDVAL-CDVL-SHRT-DESC TO DL16-APPL-CDE      27080000
270900             WHEN SQLCODE = +100                                  27090000
271000                 MOVE PC-NA                 TO DL16-APPL-CDE      27100000
271100                                                                  27110000
271200             WHEN SQLWARN0 NOT EQUAL SPACE                        27120000
271300              DISPLAY '**************************************'    27130000
271400              DISPLAY '**ABEND                             **'    27140000
271500              DISPLAY '**PROGRAM = TMKRP635                **'    27150000
271600              DISPLAY '**PARAGRAPH = 7200-DETERMINE-SOURCE-APPL'  27160000
271700              DISPLAY '**CURRENT PO NBR  :' PV-CURRENT-PO-NBR-X   27170000
271800              DISPLAY '**CURRENT CNTL NBR:' PV-CURRENT-CNTRL-NBR-X27180000
271900              DISPLAY '**************************************'    27190000
272000              PERFORM 9100-SQL-ABEND                              27200000
272100         END-EVALUATE                                             27210000
272200     END-PERFORM.                                                 27220000
272300                                                                  27230000
272400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27240000
272500         (SQLCODE NOT = ZERO    AND                               27250000
272600             SQLCODE NOT = +100 AND                               27260000
272700             SQLCODE NOT = -811)                                  27270000
272800         DISPLAY '****************************************'       27280000
272900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       27290000
273000         DISPLAY '** SELECT FROM TICDMST AND TICDVAL    **'       27300000
273100         DISPLAY '** PARAGRAPH = 7200-DETERMINE-SOURCE-APPL'      27310000
273200         DISPLAY '****************************************'       27320000
273300         PERFORM 9100-SQL-ABEND                                   27330000
273400     END-IF.                                                      27340000
273500                                                                  27350000
273600 EJECT                                                            27360000
273700                                                                  27370000
273800******************************************************************27380000
273900* BOTH TIMESTAMPS WILL BE USED FROM TTRBNTF FOR DL17- .          *27390000
274000******************************************************************27400000
274100 7250-DETERMINE-NOTF-RES-TMST.                                    27410000
274200                                                                  27420000
274300     MOVE TM604-NOTIF-NBR     TO TRBNTF-NOTIF-NBR.                27430000
274400                                                                  27440000
274500     PERFORM                                                      27450000
274600         WITH TEST AFTER                                          27460000
274700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     27470000
274800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            27480000
274900                 SQLCODE = ZERO                     OR            27490000
275000                 SQLCODE = +100                                   27500000
275100                                                                  27510000
275200         EXEC SQL                                                 27520000
275300             SELECT NOTIF_TMST                                    27530000
275400                  , RESOLVED_TMST                                 27540000
275500             INTO  :TRBNTF-NOTIF-TMST                             27550000
275600                  ,:TRBNTF-RESOLVED-TMST                          27560000
275700             FROM    TTRBNTF                                      27570000
275800             WHERE  NOTIF_NBR = :TRBNTF-NOTIF-NBR                 27580000
275900         END-EXEC                                                 27590000
276000                                                                  27600000
276100         EVALUATE TRUE                                            27610000
276200             WHEN SQLCODE = ZERO                                  27620000
276300                 PERFORM 7800-REFORMAT-TMST                       27630000
276400             WHEN SQLCODE = +100                                  27640000
276500                 MOVE PC-NA                TO DL17-NOTIFY         27650000
276600                 MOVE PC-NA                TO DL17-UPD-RES        27660000
276700                                                                  27670000
276800             WHEN SQLWARN0 NOT EQUAL SPACE                        27680000
276900              DISPLAY '**************************************'    27690000
277000              DISPLAY '**ABEND                             **'    27700000
277100              DISPLAY '**PROGRAM = TMKRP635                **'    27710000
277200              DISPLAY '**PARAGRAPH= 7250-DETERMINE-NOTF-RES-TMST' 27720000
277300              DISPLAY '**CURRENT PO NBR  :' PV-CURRENT-PO-NBR-X   27730000
277400              DISPLAY '**CURRENT CNTL NBR:' PV-CURRENT-CNTRL-NBR-X27740000
277500              DISPLAY '**************************************'    27750000
277600              PERFORM 9100-SQL-ABEND                              27760000
277700         END-EVALUATE                                             27770000
277800     END-PERFORM.                                                 27780000
277900                                                                  27790000
278000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27800000
278100         (SQLCODE NOT = ZERO    AND                               27810000
278200             SQLCODE NOT = +100 AND                               27820000
278300             SQLCODE NOT = -811)                                  27830000
278400         DISPLAY '****************************************'       27840000
278500         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       27850000
278600         DISPLAY '** SELECT FROM TTRBNTF                **'       27860000
278700         DISPLAY '** PARAGRAPH = 7250-DETERMINE-NOTF-RES-TMST'    27870000
278800         DISPLAY '****************************************'       27880000
278900         PERFORM 9100-SQL-ABEND                                   27890000
279000     END-IF.                                                      27900000
279100                                                                  27910000
279200 EJECT                                                            27920000
279300                                                                  27930000
279400******************************************************************27940000
279500* JUST MOVE THE CURRENT PO AND TROUBLE REASON TO THE CONTINUE    *27950000
279600* LINE.                                                          *27960000
279700******************************************************************27970000
279800 7300-BUILD-CONTINUE-LINE.                                        27980000
279900                                                                  27990000
280000       MOVE PV-CURRENT-PO-NBR         TO HL5-PO-NBR.              28000000
280100       MOVE PV-CURRENT-TRBL-RSN-CDE   TO HL5-TRBL-RSN-CDE.        28010000
280200                                                                  28020000
280300 EJECT                                                            28030000
280400                                                                  28040000
280500******************************************************************28050000
280600* DETERMINE THE DEPARMENT NUMBER FROM TPURCHS BY VERSION NBR     *28060000
280700******************************************************************28070000
280800 7325-DETERMINE-DEPT-BY-VER-NBR.                                  28080000
280900                                                                  28090000
281000     MOVE PV-KEY-PO-NBR       TO PV-SIGNED-COMP-PO.               28100000
281100     MOVE DL3-PURCHS-VER-NBR  TO PV-SIGNED-COMP-VER.              28110000
281200                                                                  28120000
281300     PERFORM                                                      28130000
281400         WITH TEST AFTER                                          28140000
281500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     28150000
281600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            28160000
281700                 SQLCODE = ZERO                     OR            28170000
281800                 SQLCODE = +100                                   28180000
281900                                                                  28190000
282000         EXEC SQL                                                 28200000
282100               SELECT  A.DEPT_NBR                                 28210000
282200                 INTO  :PURCHS-DEPT-NBR                           28220000
282300                 FROM  TPURCHS   A                                28230000
282400                 WHERE A.PO_NBR          = :PV-SIGNED-COMP-PO     28240000
282500                 AND   A.VER_NBR         = :PV-SIGNED-COMP-VER    28250000
282600         END-EXEC                                                 28260000
282700                                                                  28270000
282800       EVALUATE TRUE                                              28280000
282900           WHEN SQLCODE = ZERO                                    28290000
283000               MOVE PURCHS-DEPT-NBR    TO DL5A-DEPT               28300000
283100           WHEN SQLCODE = +100                                    28310000
283200               MOVE PC-NA              TO DL5A-DEPT               28320000
283300       END-EVALUATE                                               28330000
283400     END-PERFORM.                                                 28340000
283500                                                                  28350000
283600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28360000
283700         (SQLCODE NOT = ZERO    AND                               28370000
283800             SQLCODE NOT = +100 AND                               28380000
283900             SQLCODE NOT = -811)                                  28390000
284000         DISPLAY '****************************************'       28400000
284100         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       28410000
284200         DISPLAY '** SELECT FROM TPURCHS                **'       28420000
284300         DISPLAY '** PARAGRAPH = 7325-DETERMINE-DEPT-BY-VER-NBR'  28430000
284400         DISPLAY '****************************************'       28440000
284500         PERFORM 9100-SQL-ABEND                                   28450000
284600     END-IF.                                                      28460000
284700                                                                  28470000
284800 EJECT                                                            28480000
284900                                                                  28490000
285000******************************************************************28500000
285100* DETERMINE THE DEPARMENT NUMBER FROM TPURCHS USING STATUS CODE  *28510000
285200******************************************************************28520000
285300 7330-DETERMINE-DEPT-BY-STAT-CD.                                  28530000
285400                                                                  28540000
285500     MOVE PV-KEY-PO-NBR       TO PV-SIGNED-COMP-PO.               28550000
285600                                                                  28560000
285700     PERFORM                                                      28570000
285800         WITH TEST AFTER                                          28580000
285900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     28590000
286000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            28600000
286100                 SQLCODE = ZERO                     OR            28610000
286200                 SQLCODE = +100                                   28620000
286300                                                                  28630000
286400         EXEC SQL                                                 28640000
286500               SELECT  A.DEPT_NBR                                 28650000
286600                 INTO  :PURCHS-DEPT-NBR                           28660000
286700                 FROM  TPURCHS   A                                28670000
286800                 WHERE A.PO_NBR          = :PV-SIGNED-COMP-PO     28680000
286900                 AND   A.VER_STATUS_CDE  = 'A'                    28690000
287000         END-EXEC                                                 28700000
287100                                                                  28710000
287200       EVALUATE TRUE                                              28720000
287300           WHEN SQLCODE = ZERO                                    28730000
287400               MOVE PURCHS-DEPT-NBR    TO DL5A-DEPT               28740000
287500           WHEN SQLCODE = +100                                    28750000
287600               MOVE PC-NA              TO DL5A-DEPT               28760000
287700       END-EVALUATE                                               28770000
287800     END-PERFORM.                                                 28780000
287900                                                                  28790000
288000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28800000
288100         (SQLCODE NOT = ZERO    AND                               28810000
288200             SQLCODE NOT = +100 AND                               28820000
288300             SQLCODE NOT = -811)                                  28830000
288400         DISPLAY '****************************************'       28840000
288500         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       28850000
288600         DISPLAY '** SELECT FROM TPURCHS                **'       28860000
288700         DISPLAY '** PARAGRAPH = 7330-DETERMINE-DEPT-BY-STAT-CD'  28870000
288800         DISPLAY '****************************************'       28880000
288900         PERFORM 9100-SQL-ABEND                                   28890000
289000     END-IF.                                                      28900000
289100                                                                  28910000
289200 EJECT                                                            28920000
289300                                                                  28930000
289400******************************************************************28940000
289500* DETERMINE THE BKG DELY DTE IF IMPRT KEY = BK                   *28950000
289600******************************************************************28960000
289700 7340-DETERMINE-BKG-DELY-DTE.                                     28970000
289800                                                                  28980000
289900     MOVE PV-KEY-PO-NBR       TO PV-SIGNED-COMP-PO.               28990000
290000     MOVE DL22-IMPRT-SEQ-NBR  TO PV-SIGNED-COMP-SEQ-NBR.          29000000
290100                                                                  29010000
290200     PERFORM                                                      29020000
290300         WITH TEST AFTER                                          29030000
290400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     29040000
290500         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            29050000
290600                 SQLCODE = ZERO                     OR            29060000
290700                 SQLCODE = +100                                   29070000
290800                                                                  29080000
290900         EXEC SQL                                                 29090000
291000               SELECT DATE(A.PO_BKG_DELY_TMST)                    29100000
291100                 INTO  :PV-BKG-DELY-DTE                           29110000
291200                 FROM  TIMBKPO   A                                29120000
291300                 WHERE A.PO_NBR         = :PV-SIGNED-COMP-PO      29130000
291400                 AND   A.PO_BKG_SEQ_NBR = :PV-SIGNED-COMP-SEQ-NBR 29140000
291500         END-EXEC                                                 29150000
291600                                                                  29160000
291700       EVALUATE TRUE                                              29170000
291800           WHEN SQLCODE = ZERO                                    29180000
291900                INITIALIZE PV-RPT-FORMATTED-DATE                  29190000
292000                MOVE PV-BKG-DELY-DTE          (1:4)  TO           29200000
292100                       PV-RPT-CCYY                                29210000
292200                MOVE PV-BKG-DELY-DTE          (6:2)  TO           29220000
292300                       PV-RPT-MM                                  29230000
292400                MOVE PV-BKG-DELY-DTE          (9:2)  TO           29240000
292500                       PV-RPT-DD                                  29250000
292600                MOVE PV-RPT-FORMATTED-DATE  TO DL22-BKG-DELY-DTE  29260000
292700                                                                  29270000
292800           WHEN SQLCODE = +100                                    29280000
292900               MOVE PC-NA              TO DL22-BKG-DELY-DTE       29290000
293000       END-EVALUATE                                               29300000
293100     END-PERFORM.                                                 29310000
293200                                                                  29320000
293300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    29330000
293400         (SQLCODE NOT = ZERO    AND                               29340000
293500             SQLCODE NOT = +100 AND                               29350000
293600             SQLCODE NOT = -811)                                  29360000
293700         DISPLAY '****************************************'       29370000
293800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       29380000
293900         DISPLAY '** SELECT FROM TPURCHS                **'       29390000
294000         DISPLAY '** PARAGRAPH = 7340-DETERMINE-BKG-DELY-DTE'     29400000
294100         DISPLAY '****************************************'       29410000
294200         PERFORM 9100-SQL-ABEND                                   29420000
294300     END-IF.                                                      29430000
294400                                                                  29440000
294500 EJECT                                                            29450000
294600                                                                  29460000
294700******************************************************************29470000
294800* DETERMINE THE RCVD-DELY-DTE IF IMPRT KEY = RC.                 *29480000
294900******************************************************************29490000
295000 7345-DETERMINE-RCVD-DELY-DTE.                                    29500000
295100                                                                  29510000
295200     MOVE PV-KEY-PO-NBR       TO PV-SIGNED-COMP-PO.               29520000
295300     MOVE DL22-IMPRT-SEQ-NBR  TO PV-SIGNED-COMP-SEQ-NBR.          29530000
295400                                                                  29540000
295500     PERFORM                                                      29550000
295600         WITH TEST AFTER                                          29560000
295700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     29570000
295800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            29580000
295900                 SQLCODE = ZERO                     OR            29590000
296000                 SQLCODE = +100                                   29600000
296100                                                                  29610000
296200         EXEC SQL                                                 29620000
296300               SELECT DATE(A.PO_RCVD_DELY_TMST)                   29630000
296400                INTO  :PV-RCVD-DELY-DTE                           29640000
296500                FROM  TIMRCPO   A                                 29650000
296600                WHERE A.PO_NBR          = :PV-SIGNED-COMP-PO      29660000
296700                AND   A.PO_RCVD_SEQ_NBR = :PV-SIGNED-COMP-SEQ-NBR 29670000
296800         END-EXEC                                                 29680000
296900                                                                  29690000
297000       EVALUATE TRUE                                              29700000
297100           WHEN SQLCODE = ZERO                                    29710000
297200                INITIALIZE PV-RPT-FORMATTED-DATE                  29720000
297300                MOVE PV-RCVD-DELY-DTE         (1:4)  TO           29730000
297400                       PV-RPT-CCYY                                29740000
297500                MOVE PV-RCVD-DELY-DTE         (6:2)  TO           29750000
297600                       PV-RPT-MM                                  29760000
297700                MOVE PV-RCVD-DELY-DTE         (9:2)  TO           29770000
297800                       PV-RPT-DD                                  29780000
297900                MOVE PV-RPT-FORMATTED-DATE  TO DL22-RCVG-DELY-DTE 29790000
298000                                                                  29800000
298100           WHEN SQLCODE = +100                                    29810000
298200               MOVE PC-NA              TO DL22-RCVG-DELY-DTE      29820000
298300       END-EVALUATE                                               29830000
298400     END-PERFORM.                                                 29840000
298500                                                                  29850000
298600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    29860000
298700         (SQLCODE NOT = ZERO    AND                               29870000
298800             SQLCODE NOT = +100 AND                               29880000
298900             SQLCODE NOT = -811)                                  29890000
299000         DISPLAY '****************************************'       29900000
299100         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       29910000
299200         DISPLAY '** SELECT FROM TPURCHS                **'       29920000
299300         DISPLAY '** PARAGRAPH = 7345-DETERMINE-RCVD-DELY-DTE'    29930000
299400         DISPLAY '****************************************'       29940000
299500         PERFORM 9100-SQL-ABEND                                   29950000
299600     END-IF.                                                      29960000
299700                                                                  29970000
299800 EJECT                                                            29980000
299900                                                                  29990000
300000******************************************************************30000000
300100* DETERMINE THE FOB-ACTL-DPRTR-DTE IF IMPRT KEY = CN.            *30010000
300200******************************************************************30020000
300300 7350-DETERMINE-SAIL-DTE.                                         30030000
300400                                                                  30040000
300500     MOVE PV-KEY-PO-NBR       TO PV-SIGNED-COMP-PO.               30050000
300600     MOVE DL22-IMPRT-SEQ-NBR  TO PV-SIGNED-COMP-SEQ-NBR.          30060000
300700                                                                  30070000
300800     PERFORM                                                      30080000
300900         WITH TEST AFTER                                          30090000
301000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     30100000
301100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            30110000
301200                 SQLCODE = ZERO                     OR            30120000
301300                 SQLCODE = +100                                   30130000
301400                                                                  30140000
301500         EXEC SQL                                                 30150000
301600               SELECT DATE(A.MOM_DPRTR_TMST)                      30160000
301610                    , B.PO_NBR                                    30161000
301700                INTO  :PV-SAIL-DTE                                30170000
301710                    , :IMCNPO-PO-NBR                              30171000
301800                FROM  TIMCNTK   A                                 30180000
301810                     ,TIMCNPO   B                                 30181000
301900                WHERE B.PO_NBR          = :PV-SIGNED-COMP-PO      30190000
302000                AND   A.CONTNR_ID       =  B.CONTNR_ID            30200000
302010                AND   B.CONTNR_SEQ_NBR  = :PV-SIGNED-COMP-SEQ-NBR 30201000
302020                AND   A.CONTNR_ID       = :DL22-IMPRT-ID          30202000
302100         END-EXEC                                                 30210000
302200                                                                  30220000
302300       EVALUATE TRUE                                              30230000
302400           WHEN SQLCODE = ZERO                                    30240000
302500                INITIALIZE PV-RPT-FORMATTED-DATE                  30250000
302600                MOVE PV-SAIL-DTE              (1:4)  TO           30260000
302700                       PV-RPT-CCYY                                30270000
302800                MOVE PV-SAIL-DTE              (6:2)  TO           30280000
302900                       PV-RPT-MM                                  30290000
303000                MOVE PV-SAIL-DTE              (9:2)  TO           30300000
303100                       PV-RPT-DD                                  30310000
303200                MOVE PV-RPT-FORMATTED-DATE  TO                    30320000
303210                     DL22-FOB-ACTL-DPRTR-DTE                      30321000
303300                                                                  30330000
303400           WHEN SQLCODE = +100                                    30340000
303500               MOVE PC-NA              TO DL22-FOB-ACTL-DPRTR-DTE 30350000
303600       END-EVALUATE                                               30360000
303700     END-PERFORM.                                                 30370000
303800                                                                  30380000
303900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    30390000
304000         (SQLCODE NOT = ZERO    AND                               30400000
304100             SQLCODE NOT = +100 AND                               30410000
304200             SQLCODE NOT = -811)                                  30420000
304300         DISPLAY '****************************************'       30430000
304400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       30440000
304500         DISPLAY '** SELECT FROM TPURCHS                **'       30450000
304600         DISPLAY '** PARAGRAPH = 7345-DETERMINE-RCVD-DELY-DTE'    30460000
304700         DISPLAY '****************************************'       30470000
304800         PERFORM 9100-SQL-ABEND                                   30480000
304900     END-IF.                                                      30490000
305000                                                                  30500000
305100 EJECT                                                            30510000
305200                                                                  30520000
305300******************************************************************30530000
305400* REFORMAT FIELDS FROM DB2 TIMESTAMP TO REPORT FORMAT            *30540000
305500******************************************************************30550000
305600 7800-REFORMAT-TMST.                                              30560000
305700                                                                  30570000
305800      MOVE TRBNTF-NOTIF-TMST (6:2)   TO PV-RPT-MM.                30580000
305900      MOVE TRBNTF-NOTIF-TMST (9:2)   TO PV-RPT-DD.                30590000
306000      MOVE TRBNTF-NOTIF-TMST (1:4)   TO PV-RPT-CCYY.              30600000
306100      MOVE PV-RPT-FORMATTED-DATE TO DL17-NOTIFY (1:10).           30610000
306200                                                                  30620000
306300      MOVE TRBNTF-NOTIF-TMST (12:2)  TO PV-RPT-HH.                30630000
306400      MOVE TRBNTF-NOTIF-TMST (15:2)  TO PV-RPT-MIN.               30640000
306500      MOVE TRBNTF-NOTIF-TMST (18:2)  TO PV-RPT-SS.                30650000
306600      MOVE PV-RPT-FORMATTED-TIME TO DL17-NOTIFY (12:8).           30660000
306700                                                                  30670000
306800      IF PS-TRBL-ACTION-CDE-IS-R                                  30680000
306900         MOVE TRBNTF-RESOLVED-TMST (6:2) TO PV-RPT-MM             30690000
307000         MOVE TRBNTF-RESOLVED-TMST (9:2) TO PV-RPT-DD             30700000
307100         MOVE TRBNTF-RESOLVED-TMST (1:4) TO PV-RPT-CCYY           30710000
307200         MOVE PV-RPT-FORMATTED-DATE TO DL17-UPD-RES (1:10)        30720000
307300                                                                  30730000
307400         MOVE TRBNTF-RESOLVED-TMST (12:2) TO PV-RPT-HH            30740000
307500         MOVE TRBNTF-RESOLVED-TMST (15:2) TO PV-RPT-MIN           30750000
307600         MOVE TRBNTF-RESOLVED-TMST (18:2) TO PV-RPT-SS            30760000
307700         MOVE PV-RPT-FORMATTED-TIME TO DL17-UPD-RES (12:8)        30770000
307800      END-IF.                                                     30780000
307900                                                                  30790000
308000 EJECT                                                            30800000
308100                                                                  30810000
308200******************************************************************30820000
308300* REFORMAT FIELDS FROM COPYBOOK TIMESTAMP TO REPORT FORMAT       *30830000
308400******************************************************************30840000
308500 7805-REFORMAT-UPD-TMST.                                          30850000
308600                                                                  30860000
308700      MOVE TM604-UPDATE-TMST    (6:2) TO PV-RPT-MM.               30870000
308800      MOVE TM604-UPDATE-TMST    (9:2) TO PV-RPT-DD.               30880000
308900      MOVE TM604-UPDATE-TMST    (1:4) TO PV-RPT-CCYY.             30890000
309000      MOVE PV-RPT-FORMATTED-DATE TO DL17-UPD-RES (1:10).          30900000
309100                                                                  30910000
309200      MOVE TM604-UPDATE-TMST    (12:2) TO PV-RPT-HH.              30920000
309300      MOVE TM604-UPDATE-TMST    (15:2) TO PV-RPT-MIN.             30930000
309400      MOVE TM604-UPDATE-TMST    (18:2) TO PV-RPT-SS.              30940000
309500      MOVE PV-RPT-FORMATTED-TIME TO DL17-UPD-RES (12:8).          30950000
309600                                                                  30960000
309700 EJECT                                                            30970000
309800                                                                  30980000
309900******************************************************************30990000
310000* BEFORE EACH CONTROL BREAK, CHECK TO SEE IF THE GROUP 3 AND     *31000000
310100* GROUP 4 LINES HAVE BEEN WRITTEN, IF NOT, WRITE OUT THE         *31010000
310200* APPROPRIATE MESSAGE FOR EACH GROUP MISSING.                    *31020000
310300******************************************************************31030000
310400 7825-GRPS-NOT-WRITTEN-MSG-CHK.                                   31040000
310500                                                                  31050000
310510     IF PS-PROCESS                                                31051004
310600       IF PS-GRP-3-UPDATES-WRITTEN-NO     AND                     31060004
310700          PV-PAGE-COUNT > +0              AND                     31070004
310800          PV-LINE-COUNT < PC-056                                  31080004
310900                                                                  31090004
311000          WRITE EXCEPTION-DETAIL-RECORD                           31100004
311100          FROM  DL-NO-UPDATES-DETAIL-LINE                         31110004
311200                AFTER ADVANCING 3 LINES                           31120004
311300                                                                  31130004
311400          ADD  +3       TO PV-LINE-COUNT                          31140004
311500       ELSE                                                       31150004
311600         IF PS-GRP-3-UPDATES-WRITTEN-NO   AND                     31160004
311700            PV-PAGE-COUNT > +0                                    31170004
311800            MOVE  +0     TO PV-LINE-COUNT                         31180004
311900            ADD  +1      TO PV-PAGE-COUNT                         31190004
312000            MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER           31200004
312100                                                                  31210004
312200            WRITE EXCEPTION-DETAIL-RECORD                         31220004
312300            FROM  DP132O-STANDRD-HEADER-132-COLS                  31230004
312400            AFTER ADVANCING PAGE                                  31240004
312500                                                                  31250004
312600            WRITE EXCEPTION-DETAIL-RECORD                         31260004
312700            FROM  HL2-HEADING-LINE-2                              31270004
312800            AFTER ADVANCING 1 LINE                                31280004
312900                                                                  31290004
313000            WRITE EXCEPTION-DETAIL-RECORD                         31300004
313100            FROM  HL3-HEADING-LINE-3                              31310004
313200            AFTER ADVANCING 1 LINE                                31320004
313300                                                                  31330004
313400            PERFORM 7300-BUILD-CONTINUE-LINE                      31340004
313500                                                                  31350004
313600            WRITE EXCEPTION-DETAIL-RECORD                         31360004
313700            FROM  HL5-CONTINUE-LINE                               31370004
313800            AFTER ADVANCING 3 LINES                               31380004
313900                                                                  31390004
314000            WRITE EXCEPTION-DETAIL-RECORD                         31400004
314100            FROM  DL-NO-UPDATES-DETAIL-LINE                       31410004
314200                  AFTER ADVANCING 3 LINES                         31420004
314300                                                                  31430004
314400            ADD  +8       TO PV-LINE-COUNT                        31440004
314500         END-IF                                                   31450004
314600       END-IF                                                     31460004
314700                                                                  31470004
314800       IF PS-GRP-4-LOAD-DATA-WRITTEN-NO   AND                     31480004
314900          PV-PAGE-COUNT > +0              AND                     31490004
315000          PV-LINE-COUNT < PC-056                                  31500004
315100                                                                  31510004
315200          WRITE EXCEPTION-DETAIL-RECORD                           31520004
315300          FROM  DL-NO-LOAD-DATA-DETAIL-LINE                       31530004
315400                AFTER ADVANCING 3 LINES                           31540004
315500                                                                  31550004
315600          ADD  +3       TO PV-LINE-COUNT                          31560004
315700       ELSE                                                       31570004
315800         IF PS-GRP-4-LOAD-DATA-WRITTEN-NO AND                     31580004
315900            PV-PAGE-COUNT > +0                                    31590004
316000            MOVE  +0     TO PV-LINE-COUNT                         31600004
316100            ADD  +1      TO PV-PAGE-COUNT                         31610004
316200            MOVE PV-PAGE-COUNT    TO DP132O-PAGE-NUMBER           31620004
316300                                                                  31630004
316400            WRITE EXCEPTION-DETAIL-RECORD                         31640004
316500            FROM  DP132O-STANDRD-HEADER-132-COLS                  31650004
316600            AFTER ADVANCING PAGE                                  31660004
316700                                                                  31670004
316800            WRITE EXCEPTION-DETAIL-RECORD                         31680004
316900            FROM  HL2-HEADING-LINE-2                              31690004
317000            AFTER ADVANCING 1 LINE                                31700004
317100                                                                  31710004
317200            WRITE EXCEPTION-DETAIL-RECORD                         31720004
317300            FROM  HL3-HEADING-LINE-3                              31730004
317400            AFTER ADVANCING 1 LINE                                31740004
317500                                                                  31750004
317600            PERFORM 7300-BUILD-CONTINUE-LINE                      31760004
317700                                                                  31770004
317800            WRITE EXCEPTION-DETAIL-RECORD                         31780004
317900            FROM  HL5-CONTINUE-LINE                               31790004
318000            AFTER ADVANCING 3 LINES                               31800004
318100                                                                  31810004
318200            WRITE EXCEPTION-DETAIL-RECORD                         31820004
318300            FROM  DL-NO-LOAD-DATA-DETAIL-LINE                     31830004
318400                  AFTER ADVANCING 3 LINES                         31840004
318500                                                                  31850004
318600            ADD  +8       TO PV-LINE-COUNT                        31860004
318700         END-IF                                                   31870004
318800       END-IF                                                     31880004
318900     END-IF.                                                      31890004
319000 EJECT                                                            31900000
319100                                                                  31910000
319200******************************************************************31920000
319300* THIS IS USED TO DETERMINE THE INITIATOR, RESPONSIBLE PARTY AND *31930000
319400* REPORTED AGAINST FOR DL18-.                                    *31940000
319500******************************************************************31950000
319600 7850-DETERMINE-RESP-PARTY.                                       31960000
319700                                                                  31970000
319800     EVALUATE PV-4BYTE-HOLD-FOR-EVAL                              31980000
319900         WHEN PC-20                                               31990000
320000              MOVE 'CARRIER'          TO PV-HOLD-RESP-PARTY-TEXT  32000000
320100         WHEN PC-21                                               32010000
320200              MOVE 'CONSOLIDATOR'     TO PV-HOLD-RESP-PARTY-TEXT  32020000
320300         WHEN PC-22                                               32030000
320400              MOVE 'DECONSOLIDATOR'   TO PV-HOLD-RESP-PARTY-TEXT  32040000
320500         WHEN PC-23                                               32050000
320600              MOVE 'CUSTOMS BROKER'   TO PV-HOLD-RESP-PARTY-TEXT  32060000
320700         WHEN PC-24                                               32070000
320800              MOVE 'VENDOR'           TO PV-HOLD-RESP-PARTY-TEXT  32080000
320900         WHEN PC-25                                               32090000
321000              MOVE 'MAKER'            TO PV-HOLD-RESP-PARTY-TEXT  32100000
321100         WHEN PC-26                                               32110000
321200              MOVE 'TRANSPORTATION'   TO PV-HOLD-RESP-PARTY-TEXT  32120000
321300         WHEN PC-27                                               32130000
321400              MOVE 'BUYER'            TO PV-HOLD-RESP-PARTY-TEXT  32140000
321500         WHEN OTHER                                               32150000
321600              MOVE PC-NA              TO PV-HOLD-RESP-PARTY-TEXT  32160000
321700     END-EVALUATE.                                                32170000
321800                                                                  32180000
321900 EJECT                                                            32190000
322000                                                                  32200000
322100******************************************************************32210000
322200* DISPLAYS THE SUMMARY STATISTICS FOR THE PROGRAM.               *32220000
322300* CLOSES THE FLAT FILE.                                          *32230000
322400******************************************************************32240000
322500 8000-EOJ-ROUTINE.                                                32250000
322600                                                                  32260000
322700      DISPLAY ' ********************************************'.    32270000
322800      DISPLAY '     * TMKRP635 SUMMARY STATISTICS *         '.    32280000
322900      DISPLAY '       ---------------------------           '.    32290000
323000      DISPLAY ' TOTAL RECORDS READ     :' PA-TOTAL-RECORDS-READ.  32300000
323100      DISPLAY '                                             '.    32310000
323200      DISPLAY '                                             '.    32320000
323300      DISPLAY ' TOTAL PO GROUPS        :' PA-PO-GROUPS-PROCESSED. 32330000
323400      DISPLAY '                                             '.    32340000
323500      DISPLAY ' TOTAL EXCEPTION DETAILS:' PA-DETAILS-WRITTEN.     32350000
323600      DISPLAY '                                             '.    32360000
323700      DISPLAY ' TOTAL EXCEPTION ERRORS :' PA-ERRORS-WRITTEN.      32370000
323800      DISPLAY '                                             '.    32380000
323900      DISPLAY '*********************************************'.    32390000
324000                                                                  32400000
324100 EJECT                                                            32410000
324200                                                                  32420000
324300******************************************************************32430000
324400* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *32440000
324500* ERROR OR WARNING CODE OCCURS.                                  *32450000
324600******************************************************************32460000
324700 9100-SQL-ABEND.                                                  32470000
324800******************************************************************32480000
324900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *32490000
325000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *32500000
325100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *32510000
325200* FORMAT.                                                        *32520000
325300******************************************************************32530000
325400                                                                  32540000
325500     COPY DPPD004.                                                32550000
325600                                                                  32560000
325700     DISPLAY '***********************************'.               32570000
325800     DISPLAY 'EXCEPTION REPORT ABEND             '.               32580000
325900     DISPLAY '***********************************'.               32590000
326000     DISPLAY 'CURRENT PO AT ABEND : ' PV-CURRENT-PO-NBR-X.        32600000
326100     DISPLAY 'CURRENT CNTRL NBR   : ' PV-CURRENT-CNTRL-NBR-X.     32610000
326200     DISPLAY 'CURRENT TRBL RSN CDE: ' PV-CURRENT-TRBL-RSN-CDE-X.  32620000
326300     DISPLAY '***********************************'.               32630000
326400     MOVE +4013 TO ABEND-CODE.                                    32640000
326500     CALL 'ILBOABN0' USING ABEND-CODE.                            32650000
326600                                                                  32660000
326700 EJECT                                                            32670000
326800                                                                  32680000
