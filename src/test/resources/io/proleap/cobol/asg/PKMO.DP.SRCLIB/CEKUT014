000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    CEKUT014.                                         00040000
000500 AUTHOR.        JOE LAROSA.                                       00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   JUNE 2000.                                        00070000
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000*  THIS PROGRAM READS IN THE UPLOADED BILL OF LADING (BOL) DATA * 00100000
001100*  (INPUT1 - CONTAINER INFO, INPUT2 - CONTAINER/ITEM INFO) AND  * 00110000
001200*  COMBINES DATA INTO ONE OUTPUT FILE TO BE PROCESSED BY KOHL'S * 00120000
001300*  LEGACY DATABASE STRUCTURE FOR CENTRAL STOCK PULL INFORMATION.* 00130000
001300*                                                                 00131000
001300*  01/09/2020  JEAN KURK                                        * 00132000
001300*              RENAME FROM WMKUT014 TO CEKUT014                 * 00133000
001400***************************************************************** 00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600 INPUT-OUTPUT SECTION.                                            00160000
001700 FILE-CONTROL.                                                    00170000
001800                                                                  00180000
001900     SELECT CONTAINER-FILE ASSIGN TO UT-S-INP01.                  00190000
002000     SELECT ITEM-FILE      ASSIGN TO UT-S-INP02.                  00200000
002100     SELECT COMBINED-FILE  ASSIGN TO UT-S-OUT01.                  00210000
002110     SELECT CE-MANIFEST-BOL-FILE ASSIGN TO UT-S-OUT02.            00211000
002200                                                                  00220000
002300***************************************************************** 00230000
002400 DATA DIVISION.                                                   00240000
002500***************************************************************** 00250000
002600 FILE SECTION.                                                    00260000
002700                                                                  00270000
002800 FD  CONTAINER-FILE                                               00280000
002900     RECORDING MODE IS F                                          00290000
003000     LABEL RECORDS ARE STANDARD                                   00300000
003100     RECORD CONTAINS 91                                           00310000
003200     BLOCK CONTAINS 0 RECORDS                                     00320000
003300     DATA RECORD IS CONTAINER-RECORD.                             00330000
003400 01  CONTAINER-RECORD            PIC X(091).                      00340000
003500                                                                  00350000
003600 FD  ITEM-FILE                                                    00360000
003700     RECORDING MODE IS F                                          00370000
003800     LABEL RECORDS ARE STANDARD                                   00380000
003900     RECORD CONTAINS 107                                          00390000
004000     BLOCK CONTAINS 0 RECORDS                                     00400000
004100     DATA RECORD IS ITEM-RECORD.                                  00410000
004200 01  ITEM-RECORD                 PIC X(107).                      00420000
004300                                                                  00430000
004400 FD  COMBINED-FILE                                                00440000
004500     RECORDING MODE IS F                                          00450000
004600     LABEL RECORDS ARE STANDARD                                   00460000
004700     RECORD CONTAINS 150                                          00470000
004800     BLOCK CONTAINS 0 RECORDS                                     00480000
004900     DATA RECORD IS COMBINED-RECORD.                              00490000
005000 01  COMBINED-RECORD             PIC X(150).                      00500000
005100                                                                  00510000
005110 FD  CE-MANIFEST-BOL-FILE                                         00511000
005120     RECORDING MODE IS F                                          00512000
005130     LABEL RECORDS ARE STANDARD                                   00513000
005140     RECORD CONTAINS 100 CHARACTERS                               00514000
005150     BLOCK CONTAINS 0  RECORDS.                                   00515000
005160 01  CE-MANIFEST-BOL-REC              PIC X(100).                 00516000
005170                                                                  00517000
005200***************************************************************** 00520000
005300 WORKING-STORAGE SECTION.                                         00530000
005400                                                                  00540000
005500 01  PS-PROGRAM-SWITCHES.                                         00550000
005600     05  PS-END-OF-INPUT-SW           PIC X(01)  VALUE 'N'.       00560000
005700         88  PS-END-OF-INPUT                     VALUE 'Y'.       00570000
005800         88  PS-NOT-END-OF-INPUT                 VALUE 'N'.       00580000
005900     05  PS-END-OF-INPUT2-SW          PIC X(01)  VALUE 'N'.       00590000
006000         88  PS-END-OF-INPUT2                    VALUE 'Y'.       00600000
006100         88  PS-NOT-END-OF-INPUT2                VALUE 'N'.       00610000
006200                                                                  00620000
006300 01  PV-PROGRAM-VARIABLES.                                        00630000
006400     05  PV-INPUT1-READ               PIC S9(8) VALUE ZERO.       00640000
006500     05  PV-INPUT2-READ               PIC S9(8) VALUE ZERO.       00650000
006600     05  PV-RECORDS-WRITTEN           PIC S9(8) VALUE ZERO.       00660000
006610     05  PV-COUNT-MNFST               PIC S9(8) VALUE ZERO.       00661000
006700     05  PV-DISPLAY-RECORD            PIC ZZ,ZZZ,ZZ9-.            00670000
006800     05  PV-DIST-NBR.                                             00680000
006900         10  PV-DIST-F5               PIC 9(05).                  00690000
007000         10  PV-DIST-L4               PIC 9(04).                  00700000
007010     05  PV-CONTAINER-ID.                                         00701000
007020         10  FILLER                   PIC 9(02) VALUE 0.          00702000
007030         10  PV-SHIPT-UNT-ID          PIC 9(18).                  00703000
007100     05  PV-TODAYS-DATE.                                          00710000
007200         10  PV-TODAYS-DATE-YY        PIC 9(02) VALUE ZERO.       00720000
007300         10  PV-TODAYS-DATE-MM        PIC 9(02) VALUE ZERO.       00730000
007400         10  PV-TODAYS-DATE-DD        PIC 9(02) VALUE ZERO.       00740000
007500     05  PV-EXTRACT-DATE.                                         00750000
007600         10  PV-DATE-MM               PIC 9(02).                  00760000
007700         10  PV-DATE-DD               PIC 9(02).                  00770000
007800         10  PV-DATE-CC               PIC 9(02) VALUE 20.         00780000
007900         10  PV-DATE-YY               PIC 9(02).                  00790000
007901     05  PV-SKU-ITEM.                                             00790100
007902         10  PV-SKU                   PIC 9(08).                  00790200
007903         10  FILLER                   PIC 9(08).                  00790300
007910     05  PV-SML-NBR                   PIC 9(20).                  00791000
007918*                                                                 00791800
008000                                                                  00800000
008100 01 PC-PROGRAM-CONSTANTS.                                         00810000
008200     05 PC-PROGRAM-NAME               PIC X(08) VALUE 'CEKUT014'. 00820000
008300                                                                  00830000
008810 01  PV-ABEND-FIELDS.                                             00881000
008840     05 PV-ABEND-PROGRAM             PIC  X(08) VALUE 'CEKUT014'. 00884000
008850     05 PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.     00885000
008860     05 PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.     00886000
008870     05 PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.     00887000
008892                                                                  00889200
008900                                                                  00890000
009000***********************************************************       00900000
009100*  COPYBOOK USED BY INPUT FILE #1                         *       00910000
009200***********************************************************       00920000
009300     COPY CERD024.                                                00930000
009400                                                                  00940000
009500***********************************************************       00950000
009600*  COPYBOOK USED BY INPUT FILE #2                         *       00960000
009700***********************************************************       00970000
009800     COPY CERD025.                                                00980000
009900                                                                  00990000
010000***********************************************************       01000000
010100*  COPYBOOK USED IN CREATING EXTRACT FILE.                *       01010000
010200***********************************************************       01020000
010300     COPY CERD026.                                                01030000
010400                                                                  01040000
010500***********************************************************       01050000
010510***********************************************************       01051000
010520*  COPYBOOK USED IN CREATING EXTRACT CONTAINER FILE     *         01052000
010530***********************************************************       01053000
010540     COPY CERD048.                                                01054000
010550                                                                  01055000
010595***********************************************************       01059500
010600 PROCEDURE DIVISION.                                              01060000
010700***********************************************************       01070000
010800     DISPLAY '*** START OF CEKUT014 ***'.                         01080000
010900     DISPLAY ' '.                                                 01090000
011000                                                                  01100000
011100     OPEN INPUT  CONTAINER-FILE                                   01110000
011200          INPUT  ITEM-FILE                                        01120000
011300          OUTPUT COMBINED-FILE                                    01130000
011310          OUTPUT CE-MANIFEST-BOL-FILE.                            01131000
011400                                                                  01140000
011500*GET CURRENT DATE.                                                01150000
011600     ACCEPT PV-TODAYS-DATE FROM DATE.                             01160000
011700     MOVE PV-TODAYS-DATE-MM  TO PV-DATE-MM.                       01170000
011800     MOVE PV-TODAYS-DATE-DD  TO PV-DATE-DD.                       01180000
011900     MOVE PV-TODAYS-DATE-YY  TO PV-DATE-YY.                       01190000
012000                                                                  01200000
012100*READ FIRST INPUT RECORD.                                         01210000
012200     SET PS-NOT-END-OF-INPUT TO TRUE.                             01220000
012300     READ CONTAINER-FILE                                          01230000
012400       INTO CE024-CONTAINER-UPLOAD-RECORD                         01240000
012500         AT END                                                   01250000
012600           SET PS-END-OF-INPUT TO TRUE.                           01260000
012700                                                                  01270000
012800     SET PS-NOT-END-OF-INPUT2 TO TRUE.                            01280000
012900     READ ITEM-FILE                                               01290000
013000       INTO CE025-BOL-CONTAINER-ITEM-REC                          01300000
013100         AT END                                                   01310000
013200           SET PS-END-OF-INPUT2 TO TRUE.                          01320000
013300                                                                  01330000
013400*PROCESS INPUT FILE.                                              01340000
013500     IF PS-END-OF-INPUT                                           01350000
013600         DISPLAY ' '                                              01360000
013700         DISPLAY '**********************************************' 01370000
013800         DISPLAY '* NO INPUT CONTAINER FILE FOUND FOR CEKUT014 *' 01380000
013900         DISPLAY '**********************************************' 01390000
014000         DISPLAY ' '                                              01400000
014100     ELSE                                                         01410000
014200     IF PS-END-OF-INPUT2                                          01420000
014300         MOVE +1 TO PV-INPUT1-READ                                01430000
014400         DISPLAY ' '                                              01440000
014500         DISPLAY '**********************************************' 01450000
014600         DISPLAY '* NO INPUT ITEM FILE FOUND FOR CEKUT014      *' 01460000
014700         DISPLAY '**********************************************' 01470000
014800         DISPLAY ' '                                              01480000
014900     ELSE                                                         01490000
015000         MOVE +1 TO PV-INPUT2-READ                                01500000
015100         PERFORM 1000-PROCESS-INPUT                               01510000
015200           UNTIL PS-END-OF-INPUT                                  01520000
015300     END-IF                                                       01530000
015400     END-IF.                                                      01540000
015500                                                                  01550000
015600     MOVE PV-INPUT1-READ        TO PV-DISPLAY-RECORD.             01560000
015700     DISPLAY '* CERD024 RECS READ ==> ' PV-DISPLAY-RECORD.        01570000
015800     MOVE PV-INPUT2-READ        TO PV-DISPLAY-RECORD.             01580000
015900     DISPLAY '* CERD025 RECS READ ==> ' PV-DISPLAY-RECORD.        01590000
016000     MOVE PV-RECORDS-WRITTEN     TO PV-DISPLAY-RECORD.            01600000
016002     DISPLAY '* CERD026 WRITTEN   ==> ' PV-DISPLAY-RECORD.        01600200
016010     MOVE PV-COUNT-MNFST         TO PV-DISPLAY-RECORD.            01601000
016020     DISPLAY '* SURD011 WRITTEN   ==> ' PV-DISPLAY-RECORD.        01602000
016200                                                                  01620000
016300*CLOSE FILES.                                                     01630000
016400     CLOSE CONTAINER-FILE                                         01640000
016500           ITEM-FILE                                              01650000
016600           COMBINED-FILE                                          01660000
016610           CE-MANIFEST-BOL-FILE.                                  01661000
016700                                                                  01670000
016800     DISPLAY ' '.                                                 01680000
016900     DISPLAY '***  END OF CEKUT014  ***'.                         01690000
017000     GOBACK.                                                      01700000
017100                                                                  01710000
017200***************************************************************** 01720000
017300 1000-PROCESS-INPUT.                                              01730000
017400***************************************************************** 01740000
017500     MOVE '1000-PROCESS-INPUT' TO PV-ABEND-PARAGRAPH.             01750000
017600                                                                  01760000
017700     ADD +1 TO PV-INPUT1-READ.                                    01770000
017800                                                                  01780000
017900     IF (CE024-LOCATION > CE025-LOCATION)                         01790000
018000       OR (CE024-LOCATION = CE025-LOCATION                        01800000
018100        AND CE024-CONTAINER-ID > CE025-CONTAINER-ID)              01810000
018200         PERFORM 2100-READ-INPUT-FILE2                            01820000
018300           UNTIL ((CE024-LOCATION NOT > CE025-LOCATION)           01830000
018400             AND (CE024-CONTAINER-ID NOT > CE025-CONTAINER-ID))   01840000
018500              OR PS-END-OF-INPUT2                                 01850000
018600     END-IF.                                                      01860000
018700                                                                  01870000
018800     IF CE024-LOCATION = CE025-LOCATION                           01880000
018900       AND CE024-CONTAINER-ID = CE025-CONTAINER-ID                01890000
019000         PERFORM 1100-WRITE-OUTPUT                                01900000
019100           UNTIL (CE024-LOCATION NOT = CE025-LOCATION)            01910000
019200              OR (CE024-CONTAINER-ID NOT = CE025-CONTAINER-ID)    01920000
019300              OR PS-END-OF-INPUT2                                 01930000
019400     END-IF.                                                      01940000
019500                                                                  01950000
019600*READ NEXT INPUT RECORD.                                          01960000
019700     PERFORM 2000-READ-INPUT-FILE1.                               01970000
019800                                                                  01980000
019900***************************************************************** 01990000
020000 1100-WRITE-OUTPUT.                                               02000000
020100***************************************************************** 02010000
020200                                                                  02020000
020300*LOAD EXTRACT RECORD.                                             02030000
020400     INITIALIZE CE026-CS-STR-MANIFEST-RECORD.                     02040000
020410     INITIALIZE CE048-PULL-BRCD-EXTRACT-REC.                      02041000
020500                                                                  02050000
020600     MOVE CE025-DISTRIBUTION-NBR TO PV-DIST-NBR.                  02060000
020700     MOVE PV-DIST-F5             TO CE026-PULL-NBR                02070000
020710                                    CE048-CNSTK-REQ-PL-NBR.       02071000
020800     MOVE PV-DIST-L4             TO CE026-PULL-LNE-NBR            02080000
020900                                    CE048-PL-LNE-NBR.             02090000
021000     MOVE CE024-LOCATION         TO CE026-DC-STORE-NBR            02100000
021100                                    CE048-DC-NUMBER.              02110000
021200     MOVE CE024-DEST-ID          TO CE026-RECV-STORE-NBR          02120000
021300                                    CE048-STORE-NUMBER.           02130000
021400     MOVE PV-EXTRACT-DATE        TO CE026-MANIFEST-DATE.          02140000
021500                                                                  02150000
021600     MOVE CE025-UNIT-QTY         TO CE026-MANIFEST-QTY            02160000
021700                                    CE048-REQ-ORD-QTY.            02170000
021800     MOVE CE024-BOL-NBR          TO CE026-BOL-NBR                 02180000
021900                                    CE048-STOCK-ORDER-NBR.        02190000
022000     MOVE CE024-BATCH-NBR        TO CE026-RDM-BATCH-NBR           02200000
022001                                    CE048-BATCH-NBR.              02200100
022010     MOVE CE024-CONTAINER-ID     TO PV-CONTAINER-ID.              02201000
022020     MOVE PV-CONTAINER-ID        TO CE048-SHIPT-UNT-ID.           02202000
022100                                                                  02210000
022200     MOVE CE025-ITEM-NBR         TO CE026-RDM-ITEM-ID             02220000
022210                                    PV-SKU-ITEM.                  02221000
022300     MOVE PV-SKU                 TO CE048-SKU-NUMBER.             02230000
022400     MOVE 'Y'                    TO CE026-VALID-RCD-IND.          02240000
022500     MOVE 'V'                    TO CE026-VALID-PULL-CDE.         02250000
022600     MOVE 'V'                    TO CE026-VALID-LINE-CDE.         02260000
022700     MOVE 'V'                    TO CE026-VALID-DC-CDE.           02270000
022800     MOVE 'V'                    TO CE026-VALID-STR-CDE.          02280000
022900                                                                  02290000
023000*WRITE EXTRACT RECORD.                                            02300000
023010     IF  CE026-PULL-NBR >  00000000                               02301000
023020     AND CE026-PULL-NBR <= 99999999                               02302000
023030         IF  CE026-PULL-LNE-NBR >  0000                           02303000
023040         AND CE026-PULL-LNE-NBR <= 9999                           02304000
023100             WRITE COMBINED-RECORD                                02310000
023110              FROM CE026-CS-STR-MANIFEST-RECORD                   02311000
023120             WRITE CE-MANIFEST-BOL-REC                            02312000
023130              FROM CE048-PULL-BRCD-EXTRACT-REC                    02313000
023200             ADD +1 TO PV-RECORDS-WRITTEN                         02320000
023210         END-IF                                                   02321000
023220     END-IF.                                                      02322000
023300                                                                  02330000
023301*READ NEXT INPUT FILE2 RECORD.                                    02330100
023302     IF PS-NOT-END-OF-INPUT2                                      02330200
023303         PERFORM 2100-READ-INPUT-FILE2                            02330300
023304     END-IF.                                                      02330400
023305                                                                  02330500
023310***************************************************************** 02331000
024000 2000-READ-INPUT-FILE1.                                           02400000
024100***************************************************************** 02410000
024200     MOVE '2000-READ-INPUT-FILE1' TO PV-ABEND-PARAGRAPH.          02420000
024300                                                                  02430000
024400     READ CONTAINER-FILE                                          02440000
024500       INTO CE024-CONTAINER-UPLOAD-RECORD                         02450000
024600         AT END                                                   02460000
024700           SET PS-END-OF-INPUT TO TRUE.                           02470000
024800                                                                  02480000
024900***************************************************************** 02490000
025000 2100-READ-INPUT-FILE2.                                           02500000
025100***************************************************************** 02510000
025200     MOVE '2100-READ-INPUT-FILE2' TO PV-ABEND-PARAGRAPH.          02520000
025300                                                                  02530000
025400     READ ITEM-FILE                                               02540000
025500       INTO CE025-BOL-CONTAINER-ITEM-REC                          02550000
025600         AT END                                                   02560000
025700           SET PS-END-OF-INPUT2 TO TRUE.                          02570000
025800                                                                  02580000
025900     IF PS-NOT-END-OF-INPUT2                                      02590000
026000         ADD +1 TO PV-INPUT2-READ                                 02600000
026100     END-IF.                                                      02610000
026200                                                                  02620000
026600******************************************************************02660000
