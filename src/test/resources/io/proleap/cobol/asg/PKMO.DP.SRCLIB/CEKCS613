000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020089
000300*-----------------------*                                         00030089
000400 PROGRAM-ID.    CEKCS613.                                         00040089
000500 AUTHOR.        LYNN MCADAMS.                                     00050089
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060089
000700 DATE-WRITTEN.  JUNE, 2000.                                       00070089
000800 DATE-COMPILED.                                                   00080089
000900                                                                  00090089
001000                                                                  00100099
001100*---------------------------------------------------------------* 00110089
001200*    S613 - CENTRAL STOCK STORE MANIFEST                        * 00120089
001300*                                                               * 00130089
001400*---------------------------------------------------------------* 00140089
263455* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00141099
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00142099
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00143099
263455*----------------------------------------------------------------*00144099
CICS  * CHANGED 10/20/2022    BY JIM HUNTER      WR: CHG0276924         00145099
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00146099
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00147099
CICS  *-----------------------------------------------------------------00148099
001500 EJECT                                                            00150089
001600 ENVIRONMENT DIVISION.                                            00160089
001700                                                                  00170089
001800 DATA DIVISION.                                                   00180089
001900                                                                  00190089
002000 WORKING-STORAGE SECTION.                                         00200089
002100                                                                  00210089
002200 01  DK-DB2-KEYS.                                                 00220089
002300     15  DK-PULL-NUMBER                 PIC S9(09)  VALUE ZERO    00230089
002400                                                    COMP.         00240089
002500     15  DK-REF-NUMBER                  PIC  X(15)  VALUE SPACES. 00250089
002600     15  DK-LINE-NUMBER                 PIC S9(04)  VALUE ZERO    00260089
002700                                                    COMP.         00270089
002800     15  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00280089
002900                                                    COMP.         00290089
003000                                                                  00300089
003100                                                                  00310089
003200 01  PC-PROGRAM-CONSTANTS.                                        00320089
003300     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE613A  '.  00330089
003400     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM613 '.  00340089
003500     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS613'.  00350089
003600     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00360089
003700     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00370089
003800     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00380089
003900     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00390089
004000     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +10          00400089
004100                                               COMP SYNC.         00410089
004200     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00420089
004300                                               COMP SYNC.         00430089
004400     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00440089
004500                                               COMP-3.            00450089
004600     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00460089
004700                                               COMP SYNC.         00470089
004800     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00480089
004900                                               COMP-3.            00490089
005000     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00500089
005100     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00510089
005200     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00520089
005300     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00530089
005400     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00540089
005500     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00550089
005600     05  PC-COLON                  PIC  X(01)  VALUE ':'.         00560099
005700     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00570089
005800                                               COMP.              00580089
005900     05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00590089
006000     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00600089
006100     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00610089
006200     05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00620089
006300     05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00630089
006400     05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00640089
006500     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00650089
006600     05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00660089
006700     05  PC-01                     PIC  X(02)  VALUE '01'.        00670089
006800     05  PC-ONE                    PIC  9(04)  VALUE 0001.        00680089
006900     05  PC-ALL                    PIC  X(04)  VALUE ' ALL'.      00690099
007000*                                                                 00700089
007100*                                                                 00710089
007200*----------------------------------------------------------------*00720089
007300*  SYSTEM MESSAGES                                               *00730089
007400*----------------------------------------------------------------*00740089
007500*   00005 = INVALID VALUE                                        *00750089
007600*   00008 = MUST BE NUMERIC                                      *00760089
007700*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00770089
007800*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00780089
007900*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00790089
008000*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00800089
008100*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00810089
008200*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00820089
008300*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00830089
008400*   00069 - TOP OF LIST                                          *00840089
008500*   00070 - BOTTOM OF LIST                                       *00850089
008600*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00860089
008700*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*00870089
008800*   00279 - MORE ITEMS TO DISPLAY                                *00880089
008900*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00890089
009000*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *00900089
009100*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*00910089
009200*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *00920089
009300*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *00930089
009400*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*00940089
009500*   02229 = YOU DO NOT HAVE AUTHORITY TO ADD STORE DISTRIBUTION   00950089
009600*   02333 = CANNOT ADD STORE DISTRIBUTION - STATUS IS POSTED/DISTR00960089
009700*   02355 = CANNOT ADJUST STORE DISTRIBUTION - LINE STATUS IS NEW 00970089
009800*   99901 = INVALID COMMAND WAS ENTERED                          *00980089
009900*----------------------------------------------------------------*00990089
010000     05  PC-TSYMSG-NUMBERS.                                       01000089
010100         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01010089
010200         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01020089
010300         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01030089
010400         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01040089
010500         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01050089
010600         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01060089
010700         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01070089
010800         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01080089
010900         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01090089
011000         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01100089
011100         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01110089
011200         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01120089
011300         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01130089
011400         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01140089
011500         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01150089
011600         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01160089
011700         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01170089
011800         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01180089
011900         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01190089
012000         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01200089
012100         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  01210089
012200         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  01220089
012300         10  PC-TSYMSG-02329            PIC  9(05)  VALUE 02329.  01230089
012400         10  PC-TSYMSG-02333            PIC  9(05)  VALUE 02333.  01240089
012500         10  PC-TSYMSG-02355            PIC  9(05)  VALUE 02355.  01250089
012600         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01260089
012700*                                                                 01270089
012800 01  PS-PROGRAM-SWITCHES.                                         01280089
012900     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01290089
013000         88  PS-NO-ERROR                            VALUE 'Y'.    01300089
013100         88  PS-ERROR                               VALUE 'N'.    01310089
013200     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01320089
013300         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01330089
013400         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01340089
013500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01350089
013600         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01360089
013700         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01370089
013800     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01380089
013900         88  PS-DONE                                VALUE 'Y'.    01390089
014000         88  PS-NOT-DONE                            VALUE 'N'.    01400089
014100     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01410089
014200         88  PS-LIST-END                            VALUE  'Y'.   01420089
014300         88  PS-NO-LIST-END                         VALUE  'N'.   01430089
014400     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01440089
014500         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01450089
014600         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01460089
014700*                                                                 01470089
014800 01  PV-PROGRAM-VARIABLES.                                        01480089
014900     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01490089
015000                                        COMP SYNC.                01500089
015100     05  PV-DISPLAY-PULL-NBR            PIC  9(09)  VALUE ZEROES. 01510089
015200     05  PV-SUB                         PIC S9(04)  VALUE +0      01520089
015300                                                    COMP SYNC.    01530089
015400     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01540089
015500                                                    COMP SYNC.    01550089
015600     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01560089
015700                                                    COMP-3.       01570089
015800     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01580089
015900                                                    COMP-3.       01590089
016000     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01600089
016100                                                    COMP-3.       01610089
016200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01620089
016300                                                    COMP-3.       01630089
016400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01640089
016500                                                    COMP-3.       01650089
016600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01660089
016700                                                    COMP-3.       01670089
016800     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01680089
016900                                                    COMP-3.       01690089
017000     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01700089
017100                                                    COMP SYNC.    01710089
017200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01720089
017300                                                    COMP SYNC.    01730089
017400     05  PV-ITEM                        PIC S9(04)  VALUE +0      01740089
017500                                                    COMP SYNC.    01750089
017600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01760089
017700                                                    COMP SYNC.    01770089
017800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01780089
017900                                                    COMP SYNC.    01790089
018000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01800089
018100                                                    COMP SYNC.    01810089
018200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01820089
018300                                                    COMP SYNC.    01830089
018400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01840089
018500                                                    COMP SYNC.    01850089
018600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01860089
018700                                                    COMP SYNC.    01870089
018800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01880089
018900                                                    COMP SYNC.    01890089
019000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01900089
019100                                                    COMP SYNC.    01910089
019200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01920089
019300                                                    COMP SYNC.    01930089
019400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01940089
019500                                                    COMP SYNC.    01950089
019600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01960089
019700                                                    COMP SYNC.    01970089
019800     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01980089
019900                                                    COMP SYNC.    01990089
020000     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02000089
020100                                                    COMP SYNC.    02010089
020200     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02020089
020300                                                    COMP.         02030089
020400     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02040089
020500                                                    COMP.         02050089
020600     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02060089
020700                                                    COMP.         02070099
020800*                                                                 02080099
020900     05  PV-SOFT-ABORT-MSG.                                       02090089
021000         10  FILLER            PIC X(12) VALUE ' CEKCS613 - '.    02100089
021100         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02110089
021200         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02120089
021300         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02130089
021400         10  PV-SOFT-PARAGRAPH PIC X(30).                         02140089
021500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02150089
021600                                                     COMP SYNC.   02160089
021700     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02170089
021800     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02180089
021900     05  PV-CICS-MSG-HOLD.                                        02190089
022000         10  FILLER                      PIC  X(01)  VALUE SPACE. 02200089
022100         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02210089
022200     05  PV-CICS-MSG-HOLD2.                                       02220089
022300         10  FILLER                      PIC  X(01)  VALUE SPACE. 02230089
022400         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02240089
022500                                                                  02250089
022600     05  PV-TMST                        PIC X(26)   VALUE SPACES. 02260099
022700     05  PV-TMST-R REDEFINES  PV-TMST.                            02270099
022800         10   PV-TMST-CC                PIC X(02).                02280099
022900         10   PV-TMST-YY                PIC X(02).                02290099
023000         10   FILLER                    PIC X(01).                02300099
023100         10   PV-TMST-MM                PIC X(02).                02310099
023200         10   FILLER                    PIC X(01).                02320099
023300         10   PV-TMST-DD                PIC X(02).                02330099
023400         10   FILLER                    PIC X(01).                02340099
023500         10   PV-TMST-HRS               PIC X(02).                02350099
023600         10   FILLER                    PIC X(01).                02360099
023700         10   PV-TMST-MIN               PIC X(02).                02370099
023800         10   FILLER                    PIC X(01).                02380099
023900         10   PV-TMST-SEC               PIC X(02).                02390099
024000         10   FILLER                    PIC X(07).                02400099
024100     05  PV-DATE-TIME                   PIC X(26)   VALUE SPACES. 02410099
024200     05  PV-DATE-TIME-DISPLAY REDEFINES PV-DATE-TIME.             02420099
024300         10   PV-DISPLAY-MM             PIC X(02).                02430099
024400         10   PV-SLASH-1                PIC X(01).                02440099
024500         10   PV-DISPLAY-DD             PIC X(02).                02450099
024600         10   PV-SLASH-2                PIC X(01).                02460099
024700         10   PV-DISPLAY-CC             PIC X(02).                02470099
024800         10   PV-DISPLAY-YY             PIC X(02).                02480099
024900         10   PV-SPACE                  PIC X(01).                02490099
025000         10   PV-DISPLAY-HRS            PIC X(02).                02500099
025100         10   PV-COLON                  PIC X(01).                02510099
025200         10   PV-DISPLAY-MIN            PIC X(02).                02520099
025300         10   FILLER                    PIC X(10).                02530099
025400                                                                  02540089
025500                                                                  02550099
025600     05  PV-CEPLIT-ITEM-QTY              PIC S9(09) VALUE ZEROES  02560089
025700                                                    COMP.         02570089
025800     05  PV-CEPLIT-REQ-QTY               PIC S9(09) VALUE ZEROES  02580089
025900                                                    COMP.         02590089
026000     05  PV-CEPLIT-ACTL-QTY              PIC S9(09) VALUE ZEROES  02600089
026100                                                    COMP.         02610089
026200     05  PV-CEPLDS-DISTRB-QTY            PIC S9(09) VALUE ZEROES  02620089
026300                                                    COMP.         02630089
026400     05  PV-CEPLDS-STORE-COUNT           PIC S9(09) VALUE ZEROES  02640089
026500                                                    COMP.         02650089
026600     05  PV-DISTRB-RETAIL                PIC S9(06)V99            02660089
026700                                                    VALUE ZEROES. 02670089
026800     05  PV-TYPE-1                       PIC X(02)  VALUE SPACES. 02680089
026900         88   PV-TYPE-1-ADAM                        VALUE 'AD'.   02690089
027000         88   PV-TYPE-1-INFOREM                     VALUE 'IN'.   02700089
027100         88   PV-TYPE-1-MANUAL                      VALUE 'MA'.   02710089
027200     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 02720089
027300         88   PV-TYPE-2-ADAM                        VALUE 'AD'.   02730089
027400         88   PV-TYPE-2-INFOREM                     VALUE 'IN'.   02740089
027500         88   PV-TYPE-2-MANUAL                      VALUE 'MA'.   02750089
027600     05  PV-TYPE-3                       PIC X(02)  VALUE SPACES. 02760089
027700         88   PV-TYPE-3-ADAM                        VALUE 'AD'.   02770089
027800         88   PV-TYPE-3-INFOREM                     VALUE 'IN'.   02780089
027900         88   PV-TYPE-3-MANUAL                      VALUE 'MA'.   02790089
028000                                                                  02800089
028100     05  PV-STATUS-1                     PIC X(02)  VALUE SPACES. 02810089
028200         88   PV-STATUS-1-NEW                       VALUE 'NW'.   02820089
028300         88   PV-STATUS-1-CANCELLED                 VALUE 'CA'.   02830089
028400         88   PV-STATUS-1-INPROCESS                 VALUE 'IP'.   02840089
028500         88   PV-STATUS-1-DISTRIBTD                 VALUE 'DS'.   02850089
028600         88   PV-STATUS-1-POSTED                    VALUE 'PD'.   02860089
028700     05  PV-STATUS-2                     PIC X(02)  VALUE SPACES. 02870089
028800         88   PV-STATUS-2-NEW                       VALUE 'NW'.   02880089
028900         88   PV-STATUS-2-CANCELLED                 VALUE 'CA'.   02890089
029000         88   PV-STATUS-2-INPROCESS                 VALUE 'IP'.   02900089
029100         88   PV-STATUS-2-DISTRIBTD                 VALUE 'DS'.   02910089
029200         88   PV-STATUS-2-POSTED                    VALUE 'PD'.   02920089
029300     05  PV-STATUS-3                     PIC X(02)  VALUE SPACES. 02930089
029400         88   PV-STATUS-3-NEW                       VALUE 'NW'.   02940089
029500         88   PV-STATUS-3-CANCELLED                 VALUE 'CA'.   02950089
029600         88   PV-STATUS-3-INPROCESS                 VALUE 'IP'.   02960089
029700         88   PV-STATUS-3-DISTRIBTD                 VALUE 'DS'.   02970089
029800         88   PV-STATUS-3-POSTED                    VALUE 'PD'.   02980089
029900     05  PV-STATUS-4                     PIC X(02)  VALUE SPACES. 02990089
030000         88   PV-STATUS-4-NEW                       VALUE 'NW'.   03000089
030100         88   PV-STATUS-4-CANCELLED                 VALUE 'CA'.   03010089
030200         88   PV-STATUS-4-INPROCESS                 VALUE 'IP'.   03020089
030300         88   PV-STATUS-4-DISTRIBTD                 VALUE 'DS'.   03030089
030400         88   PV-STATUS-4-POSTED                    VALUE 'PD'.   03040089
030500     05  PV-STATUS-5                     PIC X(02)  VALUE SPACES. 03050089
030600         88   PV-STATUS-5-NEW                       VALUE 'NW'.   03060089
030700         88   PV-STATUS-5-CANCELLED                 VALUE 'CA'.   03070089
030800         88   PV-STATUS-5-INPROCESS                 VALUE 'IP'.   03080089
030900         88   PV-STATUS-5-DISTRIBTD                 VALUE 'DS'.   03090089
031000         88   PV-STATUS-5-POSTED                    VALUE 'PD'.   03100089
031100                                                                  03110089
031200     05  PV-PULL-NUMBER                  PIC  9(08) VALUE ZEROES. 03120089
031300     05  PV-REF-NUMBER                   PIC  X(15) VALUE SPACES. 03130089
031400     05  PV-CS-LOCATION                  PIC  9(04) VALUE ZEROES. 03140089
031500     05  PV-LINE-NUMBER                  PIC  9(04) VALUE ZEROES. 03150089
031600     05  PV-STORE-NUMBER                 PIC  9(04) VALUE ZEROES. 03160089
031700     05  PV-CEPLIT-ITM-NBR               PIC  9(15) VALUE ZEROES. 03170089
285700*----------------------------------------------------------------*03171099
285800*                                               **   WR # 230ZZ  *03172099
285900* COMMENTED: PROGRAM VARIABLE  PV-LINE-SKU                       *03173099
286000*----------------------------------------------------------------*03175099
031800*    05  PV-LINE-SKU                     PIC  X(10) VALUE SPACES. 03180099
285400*----------------------------------------------------------------*03181099
285500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *03182099
285600*----------------------------------------------------------------*03183099
031900     05  PV-LINE-SKU-RETAIL              PIC  9(05)V99            03190089
032000                                                    VALUE ZEROES. 03200089
032100     05  PV-LINE-ITEM                    PIC  9(15) VALUE ZEROES. 03210089
032200     05  PV-LINE-STATUS-CDE              PIC  X(02) VALUE SPACES. 03220089
032300     05  PV-NBR-STORES                   PIC  9(05) VALUE ZEROES. 03230089
032400     05  PV-REQ-PULL-UNITS               PIC  9(06) VALUE ZEROES. 03240089
032500     05  PV-ACT-PULL-UNITS               PIC  9(06) VALUE ZEROES. 03250089
032600     05  PV-DISTRBUTED-UNITS             PIC  9(06) VALUE ZEROES. 03260089
032700     05  PV-UPDATE-UNITS                 PIC  9(05) VALUE ZEROES. 03270089
032800*                                                                 03280089
032900     05  PV-MANIFEST-UNITS               PIC S9(09) COMP.         03290089
033000     05  PV-BEFORE-ADJUST                PIC S9(09) COMP.         03300089
033100     05  PV-AFTER-ADJUST                 PIC S9(09) COMP.         03310089
033200     05  PV-ADJUST-UNITS                 PIC S9(09) COMP.         03320089
033300                                                                  03330089
033400     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 03340089
033500     05  PV-PULL-STATUS-CDE              PIC  X(02) VALUE SPACES. 03350089
033600         88   PV-PULL-STATUS-NEW                    VALUE 'NW'.   03360089
033700         88   PV-PULL-STATUS-CANCELLED              VALUE 'CA'.   03370089
033800         88   PV-PULL-STATUS-INPROCESS              VALUE 'IP'.   03380089
033900         88   PV-PULL-STATUS-DISTRIBTD              VALUE 'DS'.   03390089
034000         88   PV-PULL-STATUS-POSTED                 VALUE 'PD'.   03400089
034100     05  PV-PULL-SOURCE-CDE              PIC  X(02) VALUE SPACES. 03410089
034200     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 03420089
034300     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 03430089
034400     05  PV-DIST-PULL-UNITS              PIC  9(06) VALUE ZEROES. 03440089
285700*----------------------------------------------------------------*03450099
285800*                                               **   WR # 230ZZ  *03450199
285900* COMMENTED: PROGRAM STRUCTURE PV-SKU-NUMBER.                    *03450299
285900* ADDED    : PROGRAM VARIABLE  PV-SKU-NUMBER.                    *03450399
286000*----------------------------------------------------------------*03450499
034500*    05  PV-SKU-NUMBER.                                           03451099
034600*        10  PV-SKU-DEPT                 PIC  X(03) VALUE SPACES. 03460099
034700*        10  PV-SKU-CLASS                PIC  X(02) VALUE SPACES. 03470099
034800*        10  PV-SKU-SEQ                  PIC  X(03) VALUE SPACES. 03480099
034500     05  PV-SKU-NUMBER                   PIC  9(08) VALUE ZEROES. 03481099
285400*----------------------------------------------------------------*03482099
285500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *03483099
285600*----------------------------------------------------------------*03484099
034900                                                                  03490089
035000     05  PV-SEL-TERM-ID                  PIC  X(04).              03500089
035100     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03510089
035200     05  PV-SEL-SEQ                      PIC  9(01).              03520089
035300                                                                  03530089
035400     05  PV-DISPLAY-NO-ZERO              PIC  Z(05).              03540089
035500     05  PV-DISPLAY-ZERO                 PIC  Z(04)9.             03550089
035600     05  PV-4-DIGIT-STORE                PIC  Z(04)  VALUE ZEROES.03560089
035700     05  PV-NUMERIC-ACTL-DISTRB-QTY      PIC  Z(04)9 VALUE ZEROES.03570089
035800     05  PV-DISPLAY-ACTL-DISTRB-QTY      PIC  X(05)  VALUE SPACES.03580089
035900******************************************************************03590089
036000**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03600089
036100**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03610089
036200**  APPLICATION-SPECIFIC COMMAREA.                              **03620089
036300******************************************************************03630089
036400 01  LQW-LIST-QUEUE-WORK-AREA.                                    03640089
036500     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03650089
036600*                                                                 03660089
036700     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           03670089
036800                                        INDEXED BY LQW-IDX.       03680089
036900         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03690089
037000         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03700089
037100         10  LQW-SELECTED-SW            PIC  X(01).               03710089
037200             88  LQW-SELECT                         VALUE 'S'.    03720089
037300             88  LQW-DESELECT                       VALUE ' '.    03730089
037400         10  LQW-ACTION                 PIC  X(03).               03740089
037500             88  LQW-DEL                            VALUE 'DEL'.  03750089
037600             88  LQW-INQ                            VALUE 'INQ'.  03760089
037700             88  LQW-UPD                            VALUE 'UPD'.  03770089
037800             88  LQW-ERR                            VALUE 'ERR'.  03780089
037900         10  LQW-STORE-NUMBER           PIC  9(04).               03790089
038000         10  LQW-DATE-TIME              PIC  X(16).               03800099
038100         10  LQW-MANIFEST-UNITS         PIC  X(05).               03810090
038200         10  LQW-BOL-NUMBER             PIC  X(30).               03820090
038300         10  LQW-BATCH-NUMBER           PIC  X(03).               03830090
038400                                                                  03840089
038500                                                                  03850089
038600*---------------------------------------------------------------* 03860089
038700* SELECTON QUEUE LAYOUT                                         * 03870089
038800*---------------------------------------------------------------* 03880089
038900     COPY CEWS003.                                                03890089
039000                                                                  03900089
039100                                                                  03910089
039200*---------------------------------------------------------------* 03920089
039300*    MAP LAYOUT                                                 * 03930089
039400*---------------------------------------------------------------* 03940089
039500                                                                  03950089
039600     COPY CEKM613.                                                03960089
039700*                                                                 03970089
039800 01  MR-OCCURS-LAYOUT                   REDEFINES  CE613AO.       03980089
039900     05  FILLER                         PIC X(161).               03990099
040000*                                                                 04000089
040100     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          04010089
040200         10  MR-STORE-NUMBERL           PIC S9(04) COMP.          04020096
040300         10  MR-STORE-NUMBERA           PIC  X(01).               04030096
040400         10  MR-STORE-NUMBERC           PIC  X(01).               04040096
040500         10  MR-STORE-NUMBERH           PIC  X(01).               04050096
040600         10  MR-STORE-NUMBER-X.                                   04060099
040700             15  MR-STORE-NUMBER        PIC  Z(04).               04070099
040800                                                                  04080099
040900         10  MR-DATE-TIMEL              PIC S9(04) COMP.          04090091
041000         10  MR-DATE-TIMEA              PIC  X(01).               04100091
041100         10  MR-DATE-TIMEC              PIC  X(01).               04110091
041200         10  MR-DATE-TIMEH              PIC  X(01).               04120091
041300         10  MR-DATE-TIME               PIC  X(16).               04130095
041400                                                                  04140089
041500         10  MR-MANIFEST-UNITSL         PIC S9(04) COMP.          04150091
041600         10  MR-MANIFEST-UNITSA         PIC  X(01).               04160091
041700         10  MR-MANIFEST-UNITSC         PIC  X(01).               04170091
041800         10  MR-MANIFEST-UNITSH         PIC  X(01).               04180091
041900         10  MR-MANIFEST-UNITS-X.                                 04190091
042000             15  MR-MANIFEST-UNITS      PIC  Z(05).               04200091
042100                                                                  04210091
042200         10  MR-BOL-NUMBERL             PIC S9(04) COMP.          04220091
042300         10  MR-BOL-NUMBERA             PIC  X(01).               04230091
042400         10  MR-BOL-NUMBERC             PIC  X(01).               04240091
042500         10  MR-BOL-NUMBERH             PIC  X(01).               04250091
042600         10  MR-BOL-NUMBER              PIC  X(30).               04260091
042700                                                                  04270091
042800         10  MR-BATCH-NUMBERL           PIC S9(04) COMP.          04280091
042900         10  MR-BATCH-NUMBERA           PIC  X(01).               04290091
043000         10  MR-BATCH-NUMBERC           PIC  X(01).               04300091
043100         10  MR-BATCH-NUMBERH           PIC  X(01).               04310091
043200         10  MR-BATCH-NUMBER            PIC  X(03).               04320091
043300                                                                  04330089
043400*    05  FILLER                         PIC  X(12).               04340099
043500                                                                  04350089
043600                                                                  04360089
043700*----------------------------------------------------------------*04370089
043800**  SECURITY SUBROUTINE PARAMETERS                                04380089
043900*----------------------------------------------------------------*04390089
044000     COPY DPWS008.                                                04400089
044100                                                                  04410089
044200                                                                  04420089
044300*---------------------------------------------------------------* 04430089
044400*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04440089
044500*---------------------------------------------------------------* 04450089
044600                                                                  04460089
044700     COPY DPWS015.                                                04470089
044800                                                                  04480089
044900*---------------------------------------------------------------* 04490089
045000*    FUNCTION KEYS COPYBOOK.                                    * 04500089
045100*---------------------------------------------------------------* 04510089
045200                                                                  04520089
045300     COPY DPWS016.                                                04530089
045400                                                                  04540089
045500*---------------------------------------------------------------* 04550089
045600*    NUMERIC EDIT LAYOUT.                                       * 04560089
045700*---------------------------------------------------------------* 04570089
045800                                                                  04580089
045900     COPY DPWS010I.                                               04590089
046000 EJECT                                                            04600089
046100*---------------------------------------------------------------* 04610089
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 04621099
046300*---------------------------------------------------------------* 04630089
046400                                                                  04640089
046500     COPY DPWS030.                                                04650089
CICS       COPY DPWS930.                                                04651099
046600 EJECT                                                            04660089
046700*---------------------------------------------------------------* 04670089
046800*    STANDARD COMMAREA.                                         * 04680089
046900*---------------------------------------------------------------* 04690089
047000                                                                  04700089
047100     COPY DPWS020.                                                04710089
047200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04720089
047300                                                                  04730089
047400*---------------------------------------------------------------* 04740089
047500* INTER-APPLICATION COMMAREA.                                   * 04750089
047600*   CEWS002 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04760089
047700*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04770089
047800*---------------------------------------------------------------* 04780089
047900                                                                  04790089
048000         10  INTER-APPL-COMM-AREA       PIC X(200).               04800089
048100     COPY CEWS002.                                                04810089
048200*---------------------------------------------------------------* 04820089
048300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04830089
048400*---------------------------------------------------------------* 04840089
048500         10  ASC-SPECIFIC-COMMAREA.                               04850089
048600             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          04860089
048700             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 04870089
048800                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          04880089
048900             15  ASC-CURR-FCLTY-ID           PIC  X(04).          04890089
049000             15  ASC-CURR-FCLTY-ID-N REDEFINES                    04900089
049100                     ASC-CURR-FCLTY-ID       PIC  9(04).          04910089
049200             15  ASC-CS-LOC                  PIC  X(04).          04920089
049300             15  ASC-CS-LOC-R REDEFINES ASC-CS-LOC.               04930089
049400                 20  ASC-CS-LOC-N            PIC  9(04).          04940089
049500             15  ASC-CS-LOCATION-DESC        PIC  X(25).          04950089
049600*                                                                 04960089
049700             15  ASC-TOT-MANIFEST-UNTS       PIC  9(05).          04970099
049800             15  ASC-TOT-ADJUST-UNTS         PIC S9(05).          04980099
049900             15  ASC-TOT-DISTRB-UNTS         PIC  9(05).          04990099
050000             15  ASC-MANIFEST-UNTS           PIC  9(05).          05000097
050100             15  ASC-ADJUST-UNTS             PIC S9(05).          05010099
050200             15  ASC-DISTRB-UNTS             PIC  9(05).          05020097
050300             15  ASC-STORE-NBR               PIC  9(04).          05030089
050400             15  ASC-PULL-NBR                PIC  X(09).          05040089
050500             15  ASC-PULL-NBR-R REDEFINES ASC-PULL-NBR.           05050089
050600                 20  ASC-PULL-NBR-N          PIC  9(09).          05060089
050700             15  ASC-REF-NBR                 PIC  X(15).          05070089
285700*----------------------------------------------------------------*05081099
285800*                                               **   WR # 230ZZ  *05082099
285900* CHANGED ASC-SKU-NUMBER PIC X(10) TO PIC X(08).                 *05083099
285900* COMMENTED: GROUP ITEM ASC-SKU-NUMBER-HOLD.                     *05084099
286000*----------------------------------------------------------------*05085099
050800*            15  ASC-SKU-NUMBER              PIC  X(10).          05086099
050800             15  ASC-SKU-NUMBER              PIC  X(08).          05087099
050900*            15  ASC-SKU-NUMBER-HOLD.                             05090099
051000*                20  ASC-SKU-DEPT            PIC  X(03).          05100099
051100*                20  FILLER                  PIC  X(01).          05110099
051200*                20  ASC-SKU-CLASS           PIC  X(02).          05120099
051300*                20  FILLER                  PIC  X(01).          05130099
051400*                20  ASC-SKU-SEQ             PIC  X(03).          05140099
285400*----------------------------------------------------------------*05141099
285500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *05142099
285600*----------------------------------------------------------------*05143099
051500             15  ASC-LINE-NBR                PIC  9(04).          05150099
051600             15  ASC-LINE-SKU-RETAIL         PIC  9(05)V99.       05160089
051700             15  ASC-LINE-STATUS-CDE         PIC  X(02).          05170089
051800                 88   ASC-LINE-STATUS-NEW             VALUE 'NW'. 05180089
051900                 88   ASC-LINE-STATUS-CANCELLED       VALUE 'CA'. 05190089
052000                 88   ASC-LINE-STATUS-INPROCESS       VALUE 'IP'. 05200089
052100                 88   ASC-LINE-STATUS-DISTRIBTD       VALUE 'DS'. 05210089
052200                 88   ASC-LINE-STATUS-POSTED          VALUE 'PD'. 05220089
052300             15  ASC-LINE-STATUS-DESC        PIC  X(08).          05230089
052400             15  ASC-PULL-SELECT-STATUS      PIC  X(01).          05240089
052500                 88  ASC-SELECT-VALID        VALUE 'A' 'C' 'D'    05250089
052600                                                   'I' 'N' 'P'    05260089
052700                                                   ' '.           05270089
052800                 88  ASC-PULL-STATUS-ENTERED VALUE 'A' 'C' 'D'    05280089
052900                                                   'I' 'N' 'P'.   05290089
053000                 88  ASC-SELECT-ALL               VALUE 'A'.      05300089
053100                 88  ASC-SELECT-CNCLD             VALUE 'C'.      05310089
053200                 88  ASC-SELECT-DSTRB             VALUE 'D'.      05320089
053300                 88  ASC-SELECT-INPROC            VALUE 'I'.      05330089
053400                 88  ASC-SELECT-NEW               VALUE 'N'.      05340089
053500                 88  ASC-SELECT-POSTD             VALUE 'P'.      05350089
053600             15  ASC-PULL-SELECT-TYPE        PIC  X(01).          05360089
053700                 88  ASC-SELECT-SRC-VALID    VALUE 'A' 'D' 'I'    05370089
053800                                                   'M' ' '.       05380089
053900                 88  ASC-PULL-SOURCE-ENTERED VALUE 'A' 'D' 'I'    05390089
054000                                                   'M'.           05400089
054100                 88  ASC-SELECT-SRC-ALL           VALUE 'A'.      05410089
054200                 88  ASC-SELECT-SRC-ADAM          VALUE 'D'.      05420089
054300                 88  ASC-SELECT-SRC-INFOREM       VALUE 'I'.      05430089
054400                 88  ASC-SELECT-SRC-MANUAL        VALUE 'M'.      05440089
054500             15  ASC-PULL-SELECT-DATE-FROM.                       05450089
054600                 20  ASC-FROM-MM             PIC  9(02).          05460089
054700                 20  ASC-FROM-DD             PIC  9(02).          05470089
054800                 20  ASC-FROM-YY             PIC  9(04).          05480089
054900             15  ASC-PULL-SELECT-DATE-TO.                         05490089
055000                 20  ASC-TO-MM               PIC  9(02).          05500089
055100                 20  ASC-TO-DD               PIC  9(02).          05510089
055200                 20  ASC-TO-YY               PIC  9(04).          05520089
055300             15  ASC-SELECT-LIST-SEQUENCE    PIC  X(01).          05530089
055400                 88  ASC-LIST-SEQ-VALID      VALUE 'P' 'D' ' '.   05540089
055500                 88  ASC-LIST-SEQ-ENTERED    VALUE 'P' 'D'.       05550089
055600                 88  ASC-LIST-SEQ-PL-NBR          VALUE 'P'.      05560089
055700                 88  ASC-LIST-SEQ-CR-DTE          VALUE 'D'.      05570089
055800             15  ASC-PULL-STATUS             PIC  X(02).          05580089
055900                 88  ASC-PULL-CANCELLED           VALUE 'CA'.     05590089
056000                 88  ASC-PULL-DISTRIBUTED         VALUE 'DS'.     05600089
056100                 88  ASC-PULL-IN-PROCESS          VALUE 'IP'.     05610089
056200                 88  ASC-PULL-NEW                 VALUE 'NW'.     05620089
056300                 88  ASC-PULL-POSTED              VALUE 'PD'.     05630089
056400             15  ASC-PULL-TYPE               PIC  X(02).          05640089
056500                 88  ASC-PULL-SRC-ADAM            VALUE 'AD'.     05650089
056600                 88  ASC-PULL-SRC-INFOREM         VALUE 'IN'.     05660089
056700                 88  ASC-PULL-SRC-MANUAL          VALUE 'MA'.     05670089
056800             15  ASC-DISPLAY-SW              PIC  X(01).          05680099
056900                 88  ASC-DISPLAY-ONE-STORE        VALUE '1'.      05690099
057000                 88  ASC-DISPLAY-ALL-STORE        VALUE 'A'.      05700099
057100                                                                  05710089
057200             15  FILLER                      PIC  X(124).         05720099
057300*-----------------------------------------------------------------05730089
057400             15  ASC-BLK-SUB                  PIC S9(04) COMP     05740089
057500                                                         SYNC.    05750089
057600             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05760089
057700                                                         SYNC.    05770089
057800             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05780089
057900             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05790089
058000             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05800089
058100             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05810089
058200             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05820089
058300             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05830089
058400                                                         SYNC.    05840089
058500             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05850089
058600             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05860089
058700             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05870089
058800                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05880089
058900                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05890089
059000             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05900089
059100                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05910089
059200                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05920089
059300             15  ASC-LIST-QUEUE-NAME.                             05930089
059400                 20  ASC-LIST-TERM-ID         PIC  X(04).         05940089
059500                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05950089
059600                 20  ASC-LIST-SEQ             PIC  9(01).         05960089
059700                                                                  05970089
059800             15  ASC-START-ITEM-REQUEST.                          05980089
059900                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05990089
060000             15  ASC-CURSOR-SW                PIC  X(02).         06000099
060100                 88  ASC-NO-CURSOR                   VALUE 'Z '.  06010099
060200                 88  ASC-ONE-STORE-CURSOR            VALUE 'A '.  06020099
060300                 88  ASC-ALL-STORES-CURSOR           VALUE 'B '.  06030099
060400             15  ASC-SEL-SUB                  PIC S9(4) COMP.     06040089
060500             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     06050089
060600             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          06060089
060700                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06070089
060800             15  ASC-SEL-QUEUE-NAME.                              06080089
060900                 20  ASC-SEL-TERM-ID          PIC  X(04).         06090089
061000                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  06100089
061100                 20  ASC-SEL-SEQ              PIC  9(01).         06110089
061200             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  06120089
061300                                                                  06130089
061400*-----------------------------------------------------------------06140089
061500                                                                  06150089
061600             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06160089
061700                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06170089
061800                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06180089
061900                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06190089
062000                                                                  06200089
062100                 20  ASC-ITEM-ARRAY.                              06210089
062200                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        06220089
062300                         30  ASC-LIST-ITEM-NUMBER                 06230089
062400                                                     PIC S9(09)   06240089
062500                                                     COMP-3.      06250089
062600                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06260089
062700                             88  ASC-VALID-SELECT    VALUE ' '    06270089
062800                                                           'S'    06280089
062900                                                           'B'    06290089
063000                                                           'E'.   06300089
063100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06310089
063200                             88  ASC-TEMP-SELECT     VALUE 'S'.   06320089
063300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06330089
063400                             88  ASC-TEMP-END        VALUE 'E'.   06340089
063500                         30  ASC-SELECTED-SW         PIC  X(01).  06350089
063600                             88  ASC-NO-SELECT       VALUE ' '.   06360089
063700                             88  ASC-SELECT          VALUE 'S'.   06370089
063800                             88  ASC-BEGIN           VALUE 'B'.   06380089
063900                             88  ASC-END             VALUE 'E'.   06390089
064000                         30  ASC-ACTION              PIC  X(03).  06400089
064100                         30  ASC-STORE-NUMBER        PIC  9(04).  06410089
064200                         30  ASC-DATE-TIME           PIC  X(16).  06420099
064300                         30  ASC-MANIFEST-UNITS      PIC  9(05).  06430090
064400                         30  ASC-BOL-NUMBER          PIC  X(30).  06440090
064500                         30  ASC-BATCH-NUMBER        PIC  X(03).  06450090
064600                                                                  06460089
064700                                                                  06470089
064800     EJECT                                                        06480089
064900*---------------------------------------------------------------* 06490089
065000*    ABEND PROCESSING COPYBOOK.                                 * 06500089
065100*---------------------------------------------------------------* 06510089
065200                                                                  06520089
065300     COPY DPWS013.                                                06530089
065400                                                                  06540089
065500 EJECT                                                            06550089
065600*---------------------------------------------------------------* 06560089
065700*    TCEPLRQ - CENTRAL STOCK PULL REQUESTS                      * 06570089
065800*---------------------------------------------------------------* 06580089
065900     EXEC SQL                                                     06590089
066000          INCLUDE TCEPLRQ                                         06600089
066100     END-EXEC.                                                    06610089
066200*---------------------------------------------------------------* 06620089
066300*    TCEPLDS - CENTRAL STOCK PULL DISTRIBUTION                  * 06630089
066400*---------------------------------------------------------------* 06640089
066500     EXEC SQL                                                     06650089
066600          INCLUDE TCEPLDS                                         06660089
066700     END-EXEC.                                                    06670089
066800*---------------------------------------------------------------* 06680089
066900*    TCEPLIT - CENTRAL STOCK PULL ITEMS                         * 06690089
067000*---------------------------------------------------------------* 06700089
067100     EXEC SQL                                                     06710089
067200          INCLUDE TCEPLIT                                         06720089
067300     END-EXEC.                                                    06730089
067400*---------------------------------------------------------------* 06740089
067500*    TCEPLST - CENTRAL STOCK PULL STATUS                        * 06750089
067600*---------------------------------------------------------------* 06760089
067700     EXEC SQL                                                     06770089
067800          INCLUDE TCEPLST                                         06780089
067900     END-EXEC.                                                    06790089
068000*                                                                 06800089
068100*---------------------------------------------------------------* 06810089
068200*    TCEPLMF - CENTRAL STOCK MANIFEST                           * 06820089
068300*---------------------------------------------------------------* 06830089
068400     EXEC SQL                                                     06840089
068500          INCLUDE TCEPLMF                                         06850089
068600     END-EXEC.                                                    06860089
068700*---------------------------------------------------------------* 06870089
068800*    TCEPLAU - CENTRAL STOCK ADJUST AUDIT                       * 06880089
068900*---------------------------------------------------------------* 06890089
069000     EXEC SQL                                                     06900089
069100          INCLUDE TCEPLAU                                         06910089
069200     END-EXEC.                                                    06920089
285700*----------------------------------------------------------------*06921099
285800*                                               **   WR # 230ZZ  *06922099
285900* REMOVED THE SKU TABLE - TSK.                                   *06923099
286000*----------------------------------------------------------------*06924099
069300*---------------------------------------------------------------* 06930089
069400*    TSK - SKU TABLE                                            * 06940089
069500*---------------------------------------------------------------* 06950089
069600*    EXEC SQL                                                     06960099
069700*         INCLUDE TSK                                             06970099
069800*    END-EXEC.                                                    06980099
285400*----------------------------------------------------------------*06981099
285500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *06982099
285600*----------------------------------------------------------------*06983099
069900*---------------------------------------------------------------* 06990089
070000*    DB2 AREA FOR COMMUNICATIONS                                * 07000089
070100*---------------------------------------------------------------* 07010089
070200     EXEC SQL                                                     07020089
070300          INCLUDE SQLCA                                           07030089
070400     END-EXEC.                                                    07040089
070500                                                                  07050089
070600*---------------------------------------------------------------* 07060099
070700*    ONE-STORE-CURSOR                                           * 07070099
070800*---------------------------------------------------------------* 07080099
070900                                                                  07090099
071000     EXEC SQL                                                     07100099
071100          DECLARE ONE-STORE-CSR CURSOR FOR                        07110099
071200            SELECT A.STR_NBR                                      07120099
071300                 , A.MFST_TMST                                    07130099
071400                 , A.MFST_UNT_QTY                                 07140099
071500                 , A.BOL_NBR                                      07150099
071600                 , A.EXPRT_PRC_BTCH_ID                            07160099
071700              FROM  TCEPLMF A                                     07170099
071800             WHERE A.CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER           07180099
071900               AND A.PL_LNE_NBR       = :DK-LINE-NUMBER           07190099
072000               AND A.STR_NBR          = :DK-STORE-NUMBER          07200099
072100     END-EXEC.                                                    07210099
072200                                                                  07220089
072300*---------------------------------------------------------------* 07230099
072400*    ALL-STORES-CURSOR                                          * 07240099
072500*---------------------------------------------------------------* 07250099
072600                                                                  07260099
072700     EXEC SQL                                                     07270099
072800          DECLARE ALL-STORES-CSR CURSOR FOR                       07280099
072900            SELECT A.STR_NBR                                      07290099
073000                 , A.MFST_TMST                                    07300099
073100                 , A.MFST_UNT_QTY                                 07310099
073200                 , A.BOL_NBR                                      07320099
073300                 , A.EXPRT_PRC_BTCH_ID                            07330099
073400              FROM  TCEPLMF A                                     07340099
073500             WHERE A.CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER           07350099
073600               AND A.PL_LNE_NBR       = :DK-LINE-NUMBER           07360099
073700     END-EXEC.                                                    07370099
073800*                                                                 07380099
073900 LINKAGE SECTION.                                                 07390089
074000                                                                  07400089
074100 01  DFHCOMMAREA.                                                 07410089
074200     05  FILLER                         OCCURS  1 TO 4072 TIMES   07420089
074300                                        DEPENDING ON EIBCALEN.    07430089
074400         10  FILLER                     PIC X.                    07440089
074500                                                                  07450089
074600 EJECT                                                            07460089
074700 PROCEDURE DIVISION.                                              07470089
074800******************************************************************07480089
074900**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07490089
075000**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07500089
075100**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07510089
075200******************************************************************07520089
075300 0000-MAIN-MODULE.                                                07530089
075400     INITIALIZE DP030-CICS-API-FIELDS.                            07540089
075500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07550089
075600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07560089
075700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07570089
075800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07580089
075900     MOVE LENGTH OF CE613AI        TO DP030-MAP-LENGTH (1).       07590089
076000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07600089
076100     PERFORM 0001-CALL-CICS-ARCH-API.                             07610089
076200*                                                                 07620089
076300     PERFORM 1000-CONTROL-PROCESSING                              07630089
076400*                                                                 07640089
076500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07650089
076600     PERFORM 0001-CALL-CICS-ARCH-API.                             07660089
076700                                                                  07670089
076800******************************************************************07680089
076900**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07690089
077000**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07700089
077100******************************************************************07710089
077200 0001-CALL-CICS-ARCH-API.                                         07720089
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07731099
077400                                    DFHCOMMAREA                   07740099
077500                                    DP030-CICS-API-FIELDS         07750099
077600                                    DP020-STANDARD-COMMAREA       07760099
077700                                    CE613AI.                      07770099
077800*                                                                 07780089
077900     IF  DP030-RC-CALL-SUCCESSFUL                                 07790089
078000         CONTINUE                                                 07800089
078100     ELSE                                                         07810089
078200         SET DP013-NO-ROLLBACK                                    07820089
078300             DP013-XCTL-DISPLAY-RESTART                           07830089
078400             DP013-CICS-ABEND      TO TRUE                        07840089
078500         MOVE '0001-CALL-CICS-ARCH-API'                           07850089
078600                                   TO DP013-PARAGRAPH             07860089
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07881099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07882099
078900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07890089
079000         PERFORM DP013-0000-PROCESS-ABEND                         07900089
079100     END-IF.                                                      07910089
079200*----------------------------------------------------------------*07920089
079300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07930089
079400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07940089
079500*                                                                *07950089
079600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07960089
079700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07970089
079800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07980089
079900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07990089
080000*----------------------------------------------------------------*08000089
080100                                                                  08010089
080200 1000-CONTROL-PROCESSING.                                         08020089
080300                                                                  08030089
080400     EVALUATE TRUE                                                08040089
080500         WHEN DP020-NEXT-ACT-INITIAL                              08050089
080600             INITIALIZE ASC-SPECIFIC-COMMAREA                     08060089
080700             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08070089
080800                                      ASC-SEL-TERM-ID             08080089
080900             MOVE DP020-SRC-TASK-NUMBER                           08090089
081000                                   TO ASC-LIST-TASK-NUMBER        08100089
081100                                      ASC-SEL-TASK-NUMBER         08110089
081200             MOVE PC-LIST-QUEUE-SEQ                               08120089
081300                                   TO ASC-LIST-SEQ                08130089
081400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 08140089
081500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08150089
081600***-----$TEMPLATE NOTE$-------------------------------------------08160089
081700*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,08170089
081800*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  08180089
081900*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.08190089
082000***---------------------------------------------------------------08200089
082100             IF  PS-COMMAREA-NOT-VALID                            08210089
082200                 SET DP020-NEXT-ACT-APPL-ERROR                    08220089
082300                                   TO TRUE                        08230089
082400             ELSE                                                 08240089
082500                 SET  ASC-DISPLAY-ONE-STORE  TO  TRUE             08250099
082600                 PERFORM 4000-BUILD-INITIAL-PANEL                 08260089
082700             END-IF                                               08270089
082800                                                                  08280089
082900         WHEN DP020-NEXT-ACT-READ-MAP                             08290089
083000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08300089
083100                                   TO PV-TOP-ITEM                 08310089
083200             PERFORM 2000-PROCESS-PANEL                           08320089
083300                                                                  08330089
083400         WHEN DP020-NEXT-ACT-RETURN                               08340089
083500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08350089
083600                                   TO PV-TOP-ITEM                 08360089
083700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08370089
083800             PERFORM 2050-DELETE-LIST-QUEUE                       08380089
083900             PERFORM 4000-BUILD-INITIAL-PANEL                     08390089
084000                                                                  08400089
084100         WHEN OTHER                                               08410089
084200             SET DP013-LOGIC-ABEND TO TRUE                        08420089
084300             SET DP013-NO-ROLLBACK TO TRUE                        08430089
084400             MOVE '1000-CONTROL-PROCESSING'                       08440089
084500                                   TO DP013-PARAGRAPH             08450089
084600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08460089
084700                                   TO DP013-MESSAGE-TEXT(1)       08470089
084800             PERFORM DP013-0000-PROCESS-ABEND                     08480089
084900     END-EVALUATE.                                                08490089
085000                                                                  08500089
085100 EJECT                                                            08510089
085200*----------------------------------------------------------------*08520089
085300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08530089
085400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08540089
085500*----------------------------------------------------------------*08550089
085600                                                                  08560089
085700 1100-PROCESS-INTER-APPL-COMM.                                    08570089
085800                                                                  08580089
085900     SET PS-COMMAREA-VALID         TO TRUE.                       08590089
086000     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     08600089
086100                                                                  08610089
086200     IF CE002-NUMBER-OF-SELECTED-ITEMS > 0                        08620099
086300         MOVE CE002-CURR-FCLTY-ID-N   TO ASC-CURR-FCLTY-ID-N      08630099
086400         MOVE CE002-CS-LOCATION       TO ASC-CS-LOC-N             08640089
086500         MOVE CE002-PULL-NBR          TO ASC-PULL-NBR-N           08650089
086600         MOVE CE002-LNE-NBR           TO ASC-LINE-NBR             08660099
086700         MOVE CE002-REF-NBR           TO ASC-REF-NBR              08670099
086800         MOVE CE002-SKU-NBR           TO ASC-SKU-NUMBER           08680099
086900         MOVE CE002-SKU-RETAIL        TO ASC-LINE-SKU-RETAIL      08690099
087000         MOVE CE002-MANIFEST-UNITS    TO ASC-TOT-MANIFEST-UNTS    08700099
087100         MOVE CE002-ADJUSTED-UNITS    TO ASC-TOT-ADJUST-UNTS      08710099
087200*DRS     MOVE CE002-DISTRB-UNITS      TO ASC-TOT-DISTRB-UNTS      08720099
087300         IF  CE002-DISPLAY-ALL                                    08721099
087400             SET  ASC-DISPLAY-ALL-STORE                           08722099
087500                  ASC-ALL-STORES-CURSOR  TO  TRUE                 08722199
087600         ELSE                                                     08723099
087700             SET  ASC-DISPLAY-ONE-STORE                           08724099
087800                  ASC-ONE-STORE-CURSOR   TO  TRUE                 08724199
087900         END-IF                                                   08725099
088000                                                                  08730099
088100         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    08740089
088200         MOVE CE002-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  08750089
088300         MOVE CE002-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      08760089
088400         PERFORM 1120-PREPARE-LIST-ENTRY.                         08770099
088500                                                                  08780089
088600                                                                  08790099
088700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08800089
088800 1120-PREPARE-LIST-ENTRY.                                         08810089
088900                                                                  08820089
089000     MOVE CE003-MAX-ITEMS          TO ASC-SEL-SUB.                08830089
089100     MOVE ZERO                     TO ASC-SEL-ITEM.               08840089
089200     PERFORM 1130-GET-NEXT-RECORD.                                08850089
089300                                                                  08860089
089400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08870089
089500*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*08880089
089600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08890089
089700 1130-GET-NEXT-RECORD.                                            08900089
089800                                                                  08910089
089900     ADD +1                       TO ASC-SEL-SUB.                 08920089
090000                                                                  08930089
090100     IF  ASC-SEL-SUB > CE003-MAX-ITEMS                            08940089
090200         ADD +1                   TO ASC-SEL-ITEM                 08950089
090300         MOVE +1                  TO ASC-SEL-SUB                  08960089
090400     END-IF.                                                      08970089
090500                                                                  08980089
090600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08990089
090700         PERFORM 9100-READ-SEL-QUEUE                              09000089
090800         IF  CE003-ITEM (ASC-SEL-SUB) > ZERO                      09010089
090900             MOVE CE003-STR-NBR (ASC-SEL-SUB)                     09020099
091000                                  TO ASC-STORE-NBR                09030099
091100             MOVE CE003-MFST-UNT-QTY (ASC-SEL-SUB)                09040099
091200                                  TO ASC-MANIFEST-UNTS            09050099
091300             MOVE CE003-ADJ-UNT-QTY (ASC-SEL-SUB)                 09060099
091400                                  TO ASC-ADJUST-UNTS              09070099
091500             MOVE CE003-DISTRB-UNITS (ASC-SEL-SUB)                09080099
091600                                  TO ASC-DISTRB-UNTS              09090099
091700             IF  CE002-DISPLAY-ALL                                09091099
091800                 MOVE  CE003-LINE-NUMBER (ASC-SEL-SUB)            09092099
091900                   TO  ASC-LINE-NBR                               09093099
092000                 MOVE  CE003-LINE-SKU    (ASC-SEL-SUB)            09093199
092100                   TO  ASC-SKU-NUMBER                             09093299
092200                 MOVE  CE003-LINE-SKU-RETAIL (ASC-SEL-SUB)        09093399
092300                   TO  ASC-LINE-SKU-RETAIL                        09093499
092400                 MOVE  CE003-TOT-MNFST-UNTS (ASC-SEL-SUB)         09093899
092500                   TO  ASC-TOT-MANIFEST-UNTS                      09093999
092600                 MOVE  CE003-TOT-ADJ-UNTS (ASC-SEL-SUB)           09094099
092700                   TO  ASC-TOT-ADJUST-UNTS                        09094199
092800*DRS             MOVE  CE003-TOT-DSTRB-UNTS (ASC-SEL-SUB)         09094299
092900*DRS               TO  ASC-TOT-DISTRB-UNTS                        09094399
093000*DRS                   ASC-DISTRB-UNTS                            09094499
093100             END-IF                                               09095099
093200                                                                  09100091
093300             SET CE003-INQ (ASC-SEL-SUB)                          09110089
093400                                  TO TRUE                         09120089
093500             PERFORM 9200-REWRITE-SEL-QUEUE                       09130089
093600         ELSE                                                     09140089
093700             SUBTRACT +1 FROM ASC-SEL-SUB                         09150089
093800             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             09160089
093900             SET DP020-MSG-INFORMATIONAL                          09170089
094000                 PS-LIST-END             TO TRUE                  09180089
094100         END-IF                                                   09190089
094200     ELSE                                                         09200089
094300         SUBTRACT +1 FROM ASC-SEL-ITEM                            09210089
094400         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  09220089
094500         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             09230089
094600         SET DP020-MSG-INFORMATIONAL                              09240089
094700             PS-LIST-END             TO TRUE                      09250089
094800     END-IF.                                                      09260089
094900                                                                  09270089
095000/                                                                 09280089
095100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09290089
095200*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *09300089
095300*    PROCESSED.                                                  *09310089
095400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09320089
095500                                                                  09330089
095600 1140-GET-PREV-RECORD.                                            09340089
095700                                                                  09350089
095800     SUBTRACT +1 FROM ASC-SEL-SUB.                                09360089
095900                                                                  09370089
096000     IF  ASC-SEL-SUB < +1                                         09380089
096100         SUBTRACT +1 FROM ASC-SEL-ITEM                            09390089
096200         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  09400089
096300     END-IF.                                                      09410089
096400                                                                  09420089
096500     IF  ASC-SEL-ITEM > ZERO                                      09430089
096600         PERFORM 9100-READ-SEL-QUEUE                              09440089
096700             MOVE CE003-STR-NBR (ASC-SEL-SUB)                     09450099
096800                                  TO ASC-STORE-NBR                09460099
096900             MOVE CE003-MFST-UNT-QTY (ASC-SEL-SUB)                09470099
097000                                  TO ASC-MANIFEST-UNTS            09480099
097100             MOVE CE003-ADJ-UNT-QTY (ASC-SEL-SUB)                 09490099
097200                                  TO ASC-ADJUST-UNTS              09500099
097300             MOVE CE003-DISTRB-UNITS (ASC-SEL-SUB)                09510099
097400                                  TO ASC-DISTRB-UNTS              09520099
097500             IF  CE002-DISPLAY-ALL                                09521099
097600                 MOVE  CE003-LINE-NUMBER (ASC-SEL-SUB)            09522099
097700                   TO  ASC-LINE-NBR                               09523099
097800                 MOVE  CE003-LINE-SKU    (ASC-SEL-SUB)            09523199
097900                   TO  ASC-SKU-NUMBER                             09523299
098000                 MOVE  CE003-LINE-SKU-RETAIL (ASC-SEL-SUB)        09523399
098100                   TO  ASC-LINE-SKU-RETAIL                        09523499
098200                 MOVE  CE003-TOT-MNFST-UNTS (ASC-SEL-SUB)         09523599
098300                   TO  ASC-TOT-MANIFEST-UNTS                      09523699
098400                 MOVE  CE003-TOT-ADJ-UNTS (ASC-SEL-SUB)           09523799
098500                   TO  ASC-TOT-ADJUST-UNTS                        09523899
098600                 MOVE  CE003-TOT-DSTRB-UNTS (ASC-SEL-SUB)         09523999
098700                   TO  ASC-TOT-ADJUST-UNTS                        09524099
098800                       ASC-DISTRB-UNTS                            09524199
098900             END-IF                                               09525099
099000                                                                  09530099
099100         SET CE003-INQ (ASC-SEL-SUB)                              09540089
099200                                  TO TRUE                         09550089
099300         PERFORM 9200-REWRITE-SEL-QUEUE                           09560089
099400     ELSE                                                         09570089
099500         MOVE +1                  TO ASC-SEL-ITEM                 09580089
099600                                     ASC-SEL-SUB                  09590089
099700         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09600089
099800         SET DP020-MSG-INFORMATIONAL                              09610089
099900             PS-LIST-END             TO TRUE                      09620089
100000     END-IF.                                                      09630089
100100                                                                  09640089
100200*----------------------------------------------------------------*09650089
100300* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09660089
100400* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09670089
100500* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09680089
100600* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09690089
100700* FUNCTION KEYS CAN GET THIS FAR.                                *09700089
100800*----------------------------------------------------------------*09710089
100900                                                                  09720089
101000 2000-PROCESS-PANEL.                                              09730089
101100     EVALUATE TRUE                                                09740089
101200         WHEN DP020-SRC-AID = DP016-CLEAR                         09750089
101300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09760089
101400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09770089
101500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09780089
101600                                                                  09790089
101700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09800089
101800             PERFORM 2050-DELETE-LIST-QUEUE                       09810089
101900             PERFORM 4000-BUILD-INITIAL-PANEL                     09820089
102000                                                                  09830089
102100         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    09840089
102200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09850089
102300                                                                  09860089
102400         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  09870089
102500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09880089
102600                                                                  09890089
102700         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09900089
102800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09910089
102900                                                                  09920089
103000         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09930089
103100             IF  ASC-USE-SELECTION-QUEUE                          09940089
103200                 PERFORM 1130-GET-NEXT-RECORD                     09950089
103300                 IF PS-LIST-END                                   09960089
103400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09970089
103500                     SET PS-NO-LIST-END TO TRUE                   09980089
103600                 ELSE                                             09990089
103700                     PERFORM 2050-DELETE-LIST-QUEUE               10000089
103800                     PERFORM 3200-RESET-ATTRIBUTES                10010089
103900                     PERFORM 4000-BUILD-INITIAL-PANEL             10020089
104000                 END-IF                                           10030089
104100              ELSE                                                10040089
104200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10050089
104300*                --- BOTTOM OF LIST ---                           10060089
104400                 MOVE PC-TSYMSG-00070                             10070089
104500                                   TO DP020-MSG-NUMBER            10080089
104600                 SET DP020-MSG-INFORMATIONAL                      10090089
104700                                   TO TRUE                        10100089
104800             END-IF                                               10110089
104900                                                                  10120089
105000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10130089
105100             IF  ASC-USE-SELECTION-QUEUE                          10140089
105200                 PERFORM 1140-GET-PREV-RECORD                     10150089
105300                 IF PS-LIST-END                                   10160089
105400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10170089
105500                     SET PS-NO-LIST-END                           10180089
105600                                   TO TRUE                        10190089
105700                 ELSE                                             10200089
105800                     PERFORM 2050-DELETE-LIST-QUEUE               10210089
105900                     PERFORM 3200-RESET-ATTRIBUTES                10220089
106000                     PERFORM 4000-BUILD-INITIAL-PANEL             10230089
106100                 END-IF                                           10240089
106200             ELSE                                                 10250089
106300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10260089
106400                 MOVE PC-TSYMSG-00069                             10270089
106500                                   TO DP020-MSG-NUMBER            10280089
106600                 SET DP020-MSG-INFORMATIONAL                      10290089
106700                                   TO TRUE                        10300089
106800             END-IF                                               10310089
106900                                                                  10320089
107000         WHEN OTHER                                               10330089
107100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10340089
107200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10350089
107300                                                                  10360089
107400             IF  PS-NO-ERROR                                      10370089
107500                 SET DP030-CONTINUE-GO                            10380089
107600                                 TO TRUE                          10390089
107700                 PERFORM 2100-CHECK-FUNCTION-KEY                  10400089
107800             ELSE                                                 10410089
107900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10420089
108000                 SET DP030-OVERRIDE-GO                            10430089
108100                                 TO TRUE                          10440089
108200             END-IF                                               10450089
108300     END-EVALUATE.                                                10460089
108400 EJECT                                                            10470089
108500*----------------------------------------------------------------*10480089
108600*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10490089
108700*----------------------------------------------------------------*10500089
108800 2050-DELETE-LIST-QUEUE.                                          10510089
108900                                                                  10520089
109000     EXEC CICS                                                    10530089
109100         DELETEQ TS                                               10540089
109200             QUEUE (ASC-LIST-QUEUE-NAME)                          10550089
109300             RESP  (PV-CICS-RESP)                                 10560089
109400     END-EXEC.                                                    10570089
109500                                                                  10580089
109600     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10590089
109700        (PV-CICS-RESP = DFHRESP(QIDERR))                          10600089
109800         CONTINUE                                                 10610089
109900     ELSE                                                         10620089
110000         SET DP013-CICS-ABEND      TO TRUE                        10630089
110100         SET DP013-NO-ROLLBACK     TO TRUE                        10640089
110200                                                                  10650089
110300         MOVE '2050-DELETE-LIST-QUEUE'                            10660089
110400                                   TO DP013-PARAGRAPH             10670089
110500         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10680089
110600                                   TO DP013-MESSAGE-TEXT (1)      10690089
110700         PERFORM DP013-0000-PROCESS-ABEND                         10700089
110800     END-IF.                                                      10710089
110900                                                                  10720089
111000     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10730089
111100 EJECT                                                            10740089
111200*----------------------------------------------------------------*10750089
111300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10760089
111400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10770089
111500* CICS ARCHITECTURE API.                                         *10780089
111600*----------------------------------------------------------------*10790089
111700 2100-CHECK-FUNCTION-KEY.                                         10800089
111800                                                                  10810089
111900     EVALUATE TRUE                                                10820089
112000*                                                                 10830089
112100*F13=ALL STOR (DISPLAY ALL STORES) (LOCAL-FUNC-01)                10840099
112200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10850099
112300              INITIALIZE CE002-INTER-APPL-COMMAREA                10860099
112400              PERFORM 2050-DELETE-LIST-QUEUE                      10870099
112500              PERFORM 3200-RESET-ATTRIBUTES                       10880099
112600              MOVE PC-ONE       TO CE002-NUMBER-OF-SELECTED-ITEMS 10890099
112700              SET  ASC-DISPLAY-ALL-STORE  TO  TRUE                10900099
112800              PERFORM 4000-BUILD-INITIAL-PANEL                    10910099
112900              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10920099
113000                                                                  10930099
113100*F22=ADJ LIST (CEKCS614 - 'CELSTADJ') (LOCAL-FUNC-02)             10940099
113200*SCREEN IS DISPLAY ONLY - DATA FROM COMMAREA CEWS002              10950099
113300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              10960099
113400             MOVE +1               TO PV-TOP-ITEM                 10970099
113500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10980099
113600*                                                                 10990089
113700* F6 - FIRST PAGE                                                 11000089
113800*                                                                 11010089
113900         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11020089
114000             MOVE +1               TO PV-TOP-ITEM                 11030089
114100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11040089
114200*                                                                 11050089
114300* F7 - PREVIOUS PAGE                                              11060089
114400*                                                                 11070089
114500         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11080089
114600             PERFORM 3200-RESET-ATTRIBUTES                        11090089
114700             PERFORM 2110-BROWSE-BACKWARD                         11100089
114800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11110089
114900*                                                                 11120089
115000* F8 - NEXT PAGE                                                  11130089
115100*                                                                 11140089
115200         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11150089
115300             PERFORM 3200-RESET-ATTRIBUTES                        11160089
115400             PERFORM 2120-BROWSE-FORWARD                          11170089
115500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11180089
115600*                                                                 11190089
115700* ENTER KEY                                                       11200089
115800*                                                                 11210089
115900         WHEN DP020-SRC-AID = DP016-ENTER                         11220089
116000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   11230089
116100             IF  PS-ERROR                                         11240089
116200                 CONTINUE                                         11250089
116300             ELSE                                                 11260089
116400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11270089
116500             END-IF                                               11280089
116600                                                                  11290089
116700         WHEN OTHER                                               11300089
116800             SET DP013-NO-ROLLBACK                                11310089
116900                 DP013-XCTL-DISPLAY-RESTART                       11320089
117000                 DP013-CICS-ABEND  TO TRUE                        11330089
117100             MOVE '2100-CHECK-FUNCTION-KEY'                       11340089
117200                                   TO DP013-PARAGRAPH             11350089
117300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11360089
117400                                   TO DP013-MESSAGE-TEXT (1)      11370089
117500             PERFORM DP013-0000-PROCESS-ABEND                     11380089
117600     END-EVALUATE.                                                11390089
117700                                                                  11400089
117800                                                                  11410089
117900*                                                                 11420089
118000*----------------------------------------------------------------*11430089
118100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *11440089
118200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *11450089
118300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *11460089
118400*    MESSAGE.                                                    *11470089
118500*----------------------------------------------------------------*11480089
118600                                                                  11490089
118700 2110-BROWSE-BACKWARD.                                            11500089
118800     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    11510089
118900         GIVING PV-TOP-ITEM.                                      11520089
119000*                                                                 11530089
119100     IF  ((PV-TOP-ITEM < +1)                                      11540089
119200       OR (PV-TOP-ITEM = +1))                                     11550089
119300         MOVE +1                   TO PV-TOP-ITEM                 11560089
119400*        -- TOP OF LIST --                                        11570089
119500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11580089
119600         SET DP020-MSG-INFORMATIONAL TO TRUE                      11590089
119700     END-IF.                                                      11600089
119800                                                                  11610089
119900 EJECT                                                            11620089
120000*----------------------------------------------------------------*11630089
120100*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *11640089
120200*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11650089
120300*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11660089
120400*----------------------------------------------------------------*11670089
120500                                                                  11680089
120600 2120-BROWSE-FORWARD.                                             11690089
120700                                                                  11700089
120800     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11710089
120900         GIVING PV-TOP-ITEM.                                      11720089
121000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11730089
121100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11740089
121200                                   TO PV-TOP-ITEM                 11750089
121300*        -- BOTTOM OF LIST --                                     11760089
121400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11770089
121500         SET DP020-MSG-INFORMATIONAL                              11780089
121600                                   TO TRUE                        11790089
121700     ELSE                                                         11800089
121800         COMPUTE PV-BOTTOM-ITEM =                                 11810089
121900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11820089
122000         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11830089
122100*            -- BOTTOM OF LIST --                                 11840089
122200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11850089
122300             SET DP020-MSG-INFORMATIONAL                          11860089
122400                                   TO TRUE                        11870089
122500         END-IF                                                   11880089
122600     END-IF.                                                      11890089
122700 EJECT                                                            11900089
122800*----------------------------------------------------------------*11910089
122900*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11920089
123000*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11930089
123100*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11940089
123200*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11950089
123300*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11960089
123400*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11970089
123500*----------------------------------------------------------------*11980089
123600                                                                  11990089
123700 2130-CHECK-FOR-JUMP-BROWSE.                                      12000089
123800     SET PS-NO-ERROR               TO TRUE.                       12010089
123900     IF (ASC-START-ITEM-REQUEST = SPACE)                          12020089
124000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12030089
124100                                   TO PV-TOP-ITEM                 12040089
124200     ELSE                                                         12050089
124300         MOVE ASC-START-ITEM-REQUEST                              12060089
124400                                   TO DP010I-UNEDITED-FIELD       12070089
124500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       12080089
124600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     12090089
124700         SET DP010I-NEGATIVE-NOT-ALLOWED                          12100089
124800                                   TO TRUE                        12110089
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12121099
263455              USING DP010I-NUMERIC-EDIT-AREA                      12122099
125000                                                                  12130089
125100         IF  NOT DP010I-ERROR-DETECTED                            12140089
125200             MOVE DP010I-NUMERIC-FIELD                            12150089
125300                                   TO  ASC-START-ITEM-REQUEST-N   12160089
125400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  12170089
125500                 IF  ASC-START-ITEM-REQUEST-N >                   12180089
125600                                          ASC-NUMBER-OF-ITEMS-READ12190089
125700                     MOVE SPACE TO ASC-START-ITEM-REQUEST         12200089
125800                     COMPUTE PV-TOP-ITEM =                        12210089
125900                             ASC-NUMBER-OF-ITEMS-READ             12220089
126000                             - PC-ITEMS-PER-PANEL + 1             12230089
126100                     IF  PV-TOP-ITEM < +1                         12240089
126200                         MOVE +1   TO PV-TOP-ITEM                 12250089
126300                         MOVE PC-TSYMSG-00070                     12260089
126400                                   TO DP020-MSG-NUMBER            12270089
126500                         SET DP020-MSG-INFORMATIONAL              12280089
126600                                   TO TRUE                        12290089
126700                     END-IF                                       12300089
126800                 ELSE                                             12310089
126900                     MOVE ASC-START-ITEM-REQUEST-N                12320089
127000                                   TO PV-TOP-ITEM                 12330089
127100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      12340089
127200                     COMPUTE PV-BOTTOM-ITEM =                     12350089
127300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     12360089
127400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ12370089
127500*                        -- BOTTOM OF LIST --                     12380089
127600                         MOVE PC-TSYMSG-00070                     12390089
127700                                   TO DP020-MSG-NUMBER            12400089
127800                         SET DP020-MSG-INFORMATIONAL              12410089
127900                                   TO TRUE                        12420089
128000                     END-IF                                       12430089
128100                 END-IF                                           12440089
128200             ELSE                                                 12450089
128300*                --- VALUE OUT OF RANGE ----                      12460089
128400                 MOVE PC-TSYMSG-00101                             12470089
128500                                   TO DP020-MSG-NUMBER            12480089
128600                 MOVE -1           TO ASTRTITL                    12490089
128700                 SET DP030-SET-CURSOR-APPL-1                      12500089
128800                                   TO TRUE                        12510089
128900                 MOVE DP015-REVERSE                               12520089
129000                                   TO ASTRTITH                    12530089
129100                 MOVE DP015-RED    TO ASTRTITC                    12540089
129200                 MOVE DP015-UNP-NUM-BRT-MDT                       12550089
129300                                   TO ASTRTITA                    12560089
129400                 SET DP020-MSG-FATAL                              12570089
129500                                   TO TRUE                        12580089
129600                 SET PS-ERROR      TO TRUE                        12590089
129700             END-IF                                               12600089
129800                                                                  12610089
129900         ELSE                                                     12620089
130000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12630089
130100             MOVE -1               TO ASTRTITL                    12640089
130200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12650089
130300             MOVE DP015-REVERSE    TO ASTRTITH                    12660089
130400             MOVE DP015-RED        TO ASTRTITC                    12670089
130500             MOVE DP015-UNP-NUM-BRT-MDT                           12680089
130600                                   TO ASTRTITA                    12690089
130700             SET DP020-MSG-FATAL   TO TRUE                        12700089
130800             SET PS-ERROR          TO TRUE                        12710089
130900         END-IF                                                   12720089
131000     END-IF.                                                      12730089
131100 EJECT                                                            12740089
131200*----------------------------------------------------------------*12750089
131300*    MARK EACH ITEM AS BEING NOT SELECTED.                       *12760089
131400*----------------------------------------------------------------*12770089
131500                                                                  12780089
131600 2141-CLEAR-SELECTED-INDS.                                        12790089
131700                                                                  12800089
131800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           12810089
131900             NOT EQUAL ZERO                                       12820089
132000         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12830089
132100             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12840089
132200                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    12850089
132300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  12860089
132400                                   TO TRUE                        12870089
132500         END-IF                                                   12880089
132600     END-IF.                                                      12890089
132700                                                                  12900089
132800 EJECT                                                            12910089
132900*----------------------------------------------------------------*12920089
133000*    MARK EACH ITEM AS BEING SELECTED.                           *12930089
133100*----------------------------------------------------------------*12940089
133200                                                                  12950089
133300 2151-SET-SELECTED-INDS.                                          12960089
133400                                                                  12970089
133500     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO12980089
133600         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             12990089
133700             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             13000089
133800                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        13010089
133900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13020089
134000                               TO  TRUE                           13030089
134100         END-IF                                                   13040089
134200     END-IF.                                                      13050089
134300******************************************************************13060089
134400** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **13070089
134500** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **13080089
134600******************************************************************13090089
134700 2200-MOVE-SCREEN-TO-COMMAREA.                                    13100089
134800                                                                  13110089
134900     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             13120089
135000     MOVE +1                       TO PV-SUB.                     13130089
135100*                                                                 13140089
135200     PERFORM 3100-SET-SUBSCRIPTS.                                 13150089
135300     IF  ASTRTITL > ZERO                                          13160089
135400         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          13170089
135500     ELSE                                                         13180089
135600         IF  ASTRTITF = DP015-ERASE-EOF                           13190089
135700             INITIALIZE ASC-START-ITEM-REQUEST                    13200089
135800         END-IF                                                   13210089
135900     END-IF.                                                      13220089
136000     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          13230099
136100         VARYING PV-SUB                                           13240099
136200         FROM 1 BY 1                                              13250099
136300         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      13260099
136400******************************************************************13270099
136500** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**13280099
136600** - THIS PROGRAM HAS NO ENTERABLE FIELDS - DISPLAY ONLY.       **13290099
136700******************************************************************13300099
136800 2210-MOVE-LINES-TO-COMMAREA.                                     13310099
136900                                                                  13320099
137000      SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE                13330099
137100      MOVE SPACE        TO ASC-TEMP-SELECTED-SW                   13340099
137200                      (ASC-BLK-SUB, ASC-ITEM-SUB).                13350099
137300                                                                  13360089
137400******************************************************************13370089
137500** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **13380089
137600** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **13390089
137700******************************************************************13400089
137800 3000-EDIT-DATA-IN-COMMAREA.                                      13410089
137900     SET PS-NO-ERROR               TO TRUE.                       13420089
138000     PERFORM 3200-RESET-ATTRIBUTES.                               13430089
138100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     13440089
138200                                                                  13450089
138300**                                                                13460089
138400* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              13470089
138500* EDITTING IS DONE FROM THE BOTTOM UP.                            13480089
138600**                                                                13490089
138700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       13500089
138800         ASC-ITEMS-DISPLAYED - 1.                                 13510089
138900     PERFORM 3100-SET-SUBSCRIPTS.                                 13520089
139000     PERFORM 3300-EDIT-SELECTIONS                                 13530089
139100         VARYING PV-SUB                                           13540089
139200         FROM PV-SUB BY -1                                        13550089
139300         UNTIL PV-SUB < +1                                        13560089
139400*                                                                 13570089
139500     IF  PS-NO-ERROR                                              13580089
139600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        13590089
139700     END-IF.                                                      13600089
139800*                                                                 13610089
139900     IF  ((PS-NO-ERROR)                                           13620089
140000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   13630089
140100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    13640089
140200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  13650089
140300     END-IF.                                                      13660089
140400                                                                  13670089
140500                                                                  13680089
140600*----------------------------------------------------------------*13690089
140700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *13700089
140800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*13710089
140900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *13720089
141000*                                                                *13730089
141100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *13740089
141200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *13750089
141300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *13760089
141400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *13770089
141500*----------------------------------------------------------------*13780089
141600                                                                  13790089
141700 3100-SET-SUBSCRIPTS.                                             13800089
141800                                                                  13810089
141900     COMPUTE ASC-ITEM-SUB =                                       13820089
142000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        13830089
142100                                                                  13840089
142200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         13850089
142300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            13860089
142400                                                                  13870089
142500         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               13880089
142600     ELSE                                                         13890089
142700         MOVE +1                     TO ASC-BLK-SUB               13900089
142800     END-IF.                                                      13910089
142900******************************************************************13920089
143000** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **13930089
143100******************************************************************13940089
143200                                                                  13950089
143300 3200-RESET-ATTRIBUTES.                                           13960089
143400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   13970089
143500     MOVE DP015-GREEN              TO ASTRTITC.                   13980089
143600     MOVE DP015-UNDERLINE          TO ASTRTITH.                   13990089
143700*                                                                 14000089
143800     PERFORM                                                      14010089
143900         VARYING PV-SUB                                           14020089
144000         FROM 1 BY 1                                              14030089
144100         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        14040089
144200         MOVE DP015-ASK-NOR-OFF     TO MR-STORE-NUMBERA (PV-SUB)  14050099
144300     END-PERFORM.                                                 14060089
144400******************************************************************14070089
144500** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **14080089
144600** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **14090089
144700** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **14100089
144800** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **14110089
144900******************************************************************14120089
145000 3300-EDIT-SELECTIONS.                                            14130089
145100     EVALUATE TRUE                                                14140089
145200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14150089
145300             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         14160089
145400                 CONTINUE                                         14170089
145500         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         14180089
145600             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        14190089
145700                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   14200089
145800                 MOVE ASC-TEMP-SELECTED-SW                        14210089
145900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14220089
146000                                TO ASC-SELECTED-SW                14230089
146100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14240089
146200             END-IF                                               14250089
146300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14260089
146400                 = SPACE                                          14270089
146500             EVALUATE TRUE                                        14280089
146600                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       14290089
146700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS14300089
146800                     MOVE SPACE TO ASC-SELECTED-SW                14310089
146900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14320089
147000                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        14330089
147100                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    14340089
147200                     MOVE SPACE TO ASC-SELECTED-SW                14350089
147300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14360089
147400                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          14370089
147500                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      14380089
147600                     MOVE SPACE TO ASC-SELECTED-SW                14390089
147700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14400089
147800             END-EVALUATE                                         14410089
147900         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           14420089
148000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14430089
148100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14440089
148200             END-IF                                               14450089
148300             PERFORM 3310-EDIT-RANGE                              14460089
148400         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             14470089
148500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14480089
148600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14490089
148700             END-IF                                               14500089
148800             PERFORM 3310-EDIT-RANGE                              14510089
148900         WHEN OTHER                                               14520089
149000             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           14530089
149100             SET DP020-MSG-FATAL    TO TRUE                       14540099
149200             MOVE -1           TO ASTRTITL                        14550099
149300             SET DP030-SET-CURSOR-APPL-1                          14560089
149400                                    TO TRUE                       14570089
149500             SET PS-ERROR TO TRUE                                 14580089
149600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14590089
149700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     14600089
149800                 MOVE SPACE         TO ASC-SELECTED-SW            14610089
149900                                        (ASC-BLK-SUB ASC-ITEM-SUB)14620089
150000             END-IF                                               14630089
150100     END-EVALUATE.                                                14640089
150200                                                                  14650089
150300     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 14660089
150400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               14670089
150500     IF  ASC-ITEM-SUB < 1                                         14680089
150600         SUBTRACT +1 FROM ASC-BLK-SUB                             14690089
150700         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                14700089
150800     END-IF.                                                      14710089
150900                                                                  14720093
151000******************************************************************14730089
151100** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **14740089
151200** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **14750089
151300** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**14760089
151400** THE ENDING.                                                  **14770089
151500******************************************************************14780089
151600 3310-EDIT-RANGE.                                                 14790089
151700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                14800089
151800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   14810089
151900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)14820089
152000                                   TO ASC-SELECTED-SW             14830089
152100                                        (ASC-BLK-SUB ASC-ITEM-SUB)14840089
152200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 14850089
152300         ELSE                                                     14860089
152400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     14870089
152500                 CONTINUE                                         14880089
152600             ELSE                                                 14890089
152700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        14900089
152800                 MOVE PC-TSYMSG-00054                             14910089
152900                                   TO DP020-MSG-NUMBER            14920089
153000                 SET DP020-MSG-FATAL                              14930089
153100                                   TO TRUE                        14940089
153200                 MOVE -1           TO ASTRTITL                    14950099
153300                 SET DP030-SET-CURSOR-APPL-1                      14960089
153400                                   TO TRUE                        14970089
153500*                MOVE DP015-UNDERLINE                             14980096
153600                 SET PS-ERROR      TO TRUE                        14990089
153700             END-IF                                               15000089
153800         END-IF                                                   15010089
153900     ELSE                                                         15020089
154000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     15030089
154100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 15040089
154200                                   TO ASC-SELECTED-SW             15050089
154300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15060089
154400             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   15070089
154500         ELSE                                                     15080089
154600             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       15090089
154700                 CONTINUE                                         15100089
154800             ELSE                                                 15110089
154900*                -- ONLY ONE END-OF-RANGE ALLOWED --              15120089
155000                 MOVE PC-TSYMSG-00055                             15130089
155100                                   TO DP020-MSG-NUMBER            15140089
155200                 SET DP020-MSG-FATAL                              15150089
155300                                   TO TRUE                        15160089
155400                 MOVE -1           TO ASTRTITL                    15170099
155500                 SET DP030-SET-CURSOR-APPL-1                      15180089
155600                                   TO TRUE                        15190089
155700                 SET PS-ERROR      TO TRUE                        15200089
155800             END-IF                                               15210089
155900         END-IF                                                   15220089
156000     END-IF.                                                      15230089
156100*                                                                 15240089
156200******************************************************************15250089
156300** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **15260089
156400** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **15270089
156500******************************************************************15280089
156600 3400-CHECK-RANGE-SEQUENCE.                                       15290089
156700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       15300089
156800       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      15310089
156900       AND  ASC-START-OF-SELECTED-RANGE >                         15320089
157000                                         ASC-END-OF-SELECTED-RANGE15330089
157100*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                15340089
157200         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 15350089
157300         SET DP020-MSG-FATAL TO TRUE                              15360089
157400         SET PS-ERROR TO TRUE                                     15370089
157500         PERFORM 3410-POSITION-AT-ERROR                           15380089
157600     END-IF.                                                      15390089
157700******************************************************************15400089
157800** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **15410089
157900** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **15420089
158000** SHOULD BE POSITIONED ON A RANGE ERROR.                       **15430089
158100******************************************************************15440089
158200 3410-POSITION-AT-ERROR.                                          15450089
158300     SET DP030-SET-CURSOR-APPL-1                                  15460089
158400                                   TO TRUE.                       15470089
158500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 15480089
158600                    - PV-TOP-ITEM + 1.                            15490089
158700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15500089
158800         CONTINUE                                                 15510089
158900     ELSE                                                         15520089
159000         MOVE -1                   TO ASTRTITL                    15530099
159100     END-IF.                                                      15540089
159200*                                                                 15550089
159300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   15560089
159400                    - PV-TOP-ITEM + 1.                            15570089
159500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15580089
159600         CONTINUE                                                 15590089
159700     ELSE                                                         15600089
159800         MOVE -1                   TO ASTRTITL                    15610099
159900     END-IF.                                                      15620089
160000 EJECT                                                            15630089
160100*----------------------------------------------------------------*15640089
160200*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *15650089
160300*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *15660089
160400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *15670089
160500*----------------------------------------------------------------*15680089
160600                                                                  15690089
160700 3500-MARK-RANGE-AS-SELECTED.                                     15700089
160800     MOVE +1                       TO  ASC-BLK-SUB.               15710089
160900     PERFORM 3510-MARK-SELECTED-INDS                              15720089
161000         VARYING ASC-ITEM-SUB                                     15730089
161100         FROM 1 BY 1                                              15740089
161200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15750089
161300                                                                  15760089
161400     ADD +1                        TO ASC-BLK-SUB.                15770089
161500     PERFORM 3510-MARK-SELECTED-INDS                              15780089
161600         VARYING ASC-ITEM-SUB                                     15790089
161700         FROM 1 BY 1                                              15800089
161800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15810089
161900                                                                  15820089
162000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15830089
162100                                   TO  PV-LIST-ITEM-NUMBER.       15840089
162200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15850089
162300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         15860089
162400               PC-ITEMS-PER-PANEL).                               15870089
162500                                                                  15880089
162600     MOVE ASC-START-OF-SELECTED-RANGE                             15890089
162700                                   TO PV-START-OF-SELECTED-RANGE. 15900089
162800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            15910089
162900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  15920089
163000               PC-ITEMS-PER-PANEL).                               15930089
163100                                                                  15940089
163200     MOVE ASC-END-OF-SELECTED-RANGE                               15950089
163300                                   TO  PV-END-OF-SELECTED-RANGE.  15960089
163400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             15970089
163500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    15980089
163600               PC-ITEMS-PER-PANEL).                               15990089
163700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             16000089
163800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             16010089
163900                                                                  16020089
164000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    16030089
164100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        16040089
164200         MOVE +1                   TO ASC-BLK-SUB                 16050089
164300         PERFORM 5100-WRITE-TEMP-STORAGE                          16060089
164400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16070089
164500             PV-FIRST-BLOCK-IN-ARRAY - 1                          16080089
164600                                                                  16090089
164700         PERFORM                                                  16100089
164800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      16110089
164900                   PV-PREV-BLOCK-IN-ARRAY                         16120089
165000             MOVE PV-FIRST-BLOCK-IN-RANGE                         16130089
165100                                   TO PV-BLOCK-NUMBER             16140089
165200             PERFORM 4410-READ-TEMP-STORAGE                       16150089
165300             PERFORM 3510-MARK-SELECTED-INDS                      16160089
165400                 VARYING ASC-ITEM-SUB                             16170089
165500                 FROM 1 BY 1                                      16180089
165600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16190089
165700             PERFORM 5100-WRITE-TEMP-STORAGE                      16200089
165800             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     16210089
165900         END-PERFORM                                              16220089
166000                                                                  16230089
166100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16240089
166200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16250089
166300         PERFORM                                                  16260089
166400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16270089
166500                   PV-LAST-BLOCK-IN-RANGE                         16280089
166600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16290089
166700                                   TO PV-BLOCK-NUMBER             16300089
166800             PERFORM 4410-READ-TEMP-STORAGE                       16310089
166900             PERFORM 3510-MARK-SELECTED-INDS                      16320089
167000                 VARYING ASC-ITEM-SUB                             16330089
167100                 FROM 1 BY 1                                      16340089
167200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16350089
167300             PERFORM 5100-WRITE-TEMP-STORAGE                      16360089
167400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16370089
167500         END-PERFORM                                              16380089
167600                                                                  16390089
167700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16400089
167800                                   TO PV-BLOCK-NUMBER             16410089
167900         PERFORM 4410-READ-TEMP-STORAGE                           16420089
168000     END-IF.                                                      16430089
168100                                                                  16440089
168200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 16450089
168300                                      ASC-END-OF-SELECTED-RANGE.  16460089
168400                                                                  16470089
168500 EJECT                                                            16480089
168600*----------------------------------------------------------------*16490089
168700* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *16500089
168800*----------------------------------------------------------------*16510089
168900                                                                  16520089
169000 3510-MARK-SELECTED-INDS.                                         16530089
169100                                                                  16540089
169200     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16550089
169300                                ASC-ITEM-SUB) >                   16560089
169400         ASC-START-OF-SELECTED-RANGE)                             16570089
169500     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16580089
169600                                ASC-ITEM-SUB) =                   16590089
169700         ASC-START-OF-SELECTED-RANGE)                             16600089
169800                                                                  16610089
169900         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16620089
170000                                    ASC-ITEM-SUB) <               16630089
170100             ASC-END-OF-SELECTED-RANGE)                           16640089
170200         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16650089
170300                                    ASC-ITEM-SUB) =               16660089
170400             ASC-END-OF-SELECTED-RANGE)                           16670089
170500                                                                  16680089
170600             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16690089
170700                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   16700089
170800                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   16710089
170900                               TO TRUE                            16720089
171000                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              16730089
171100                               TO TRUE                            16740089
171200                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    16750089
171300             END-IF                                               16760089
171400         END-IF                                                   16770089
171500     END-IF.                                                      16780089
171600                                                                  16790089
171700 EJECT                                                            16800089
171800*----------------------------------------------------------------*16810089
171900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *16820089
172000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *16830089
172100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *16840089
172200*    DISPLAY THE PANEL TO USER.                                  *16850089
172300*----------------------------------------------------------------*16860089
172400                                                                  16870089
172500 4000-BUILD-INITIAL-PANEL.                                        16880089
172600                                                                  16890089
172700     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            16900089
172800                                 ASC-BLOCK-ENTRIES (2).           16910089
172900     MOVE +1                  TO ASC-BLK-SUB.                     16920091
173000     SET ASC-ITEMS-LEFT-ON-DB                                     16930089
173100                             TO TRUE.                             16940089
173200                                                                  16950089
173300     MOVE +0                 TO ASC-ITEM-SUB                      16960089
173400                                ASC-NUMBER-OF-ITEMS-READ          16970099
173500                                ASC-NUMBER-OF-SELECTED-ITEMS      16980089
173600                                ASC-HIGHEST-BLOCK-WRITTEN         16990089
173700                                ASC-START-OF-SELECTED-RANGE       17000089
173800                                ASC-END-OF-SELECTED-RANGE         17010089
173900                                ASC-ITEM-AT-TOP-OF-PANEL          17020099
174000                                ASC-TOT-DISTRB-UNTS               17021099
174100                                                                  17030089
174200     PERFORM 4100-PREPARE-CURSOR                                  17040099
174300                                                                  17050099
174400     PERFORM 4010-OPEN-CURSOR.                                    17060099
174500                                                                  17070099
174600     PERFORM 4300-READ-ITEMS-FROM-DB.                             17080099
174700                                                                  17090099
174800     PERFORM 4020-CLOSE-CURSOR.                                   17100099
174900                                                                  17110089
175000     MOVE +1                   TO  PV-TOP-ITEM.                   17120089
175100     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          17130089
175200         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    17140089
175300         SET DP020-MSG-FATAL   TO  TRUE                           17150089
175400         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               17160089
175500     ELSE                                                         17170089
175600         MOVE -1               TO ASTRTITL                        17180099
175700         SET DP030-SET-CURSOR-APPL-1                              17190089
175800                               TO TRUE                            17200089
175900         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     17210089
176000     END-IF.                                                      17220089
176100                                                                  17230089
176200                                                                  17240089
176300*----------------------------------------------------------------*17250099
176400* OPEN THE TMESSAGE CURSOR.                                      *17260099
176500*   IN THIS PARTICULAR APPLICATION ONE OF 2 DIFFERENT CURSORS    *17270099
176600*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *17280099
176700*   USER. THERE IS A ONE-STORE-CURSOR AND AN ALL-STORES-CURSOR.  *17290099
176800*----------------------------------------------------------------*17300099
176900                                                                  17310099
177000 4010-OPEN-CURSOR.                                                17320099
177100     PERFORM                                                      17330099
177200         WITH TEST AFTER                                          17340099
177300         VARYING PV-RETRY-COUNTER                                 17350099
177400         FROM 1 BY 1                                              17360099
177500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17370099
177600                   OR (SQLCODE = ZERO))                           17380099
177700                                                                  17390099
177800         EVALUATE TRUE                                            17400099
177900             WHEN ASC-ONE-STORE-CURSOR                            17410099
178000                  MOVE 'CURSOR:  ONE-STORE-CSR'                   17420099
178100                                 TO DP013-MESSAGE-TEXT (2)        17430099
178200                  EXEC SQL                                        17440099
178300                       OPEN ONE-STORE-CSR                         17450099
178400                  END-EXEC                                        17460099
178500                                                                  17470099
178600             WHEN ASC-ALL-STORES-CURSOR                           17480099
178700                  MOVE 'CURSOR:  ALL-STORES-CSR'                  17490099
178800                                 TO DP013-MESSAGE-TEXT (2)        17500099
178900                  EXEC SQL                                        17510099
179000                       OPEN ALL-STORES-CSR                        17520099
179100                  END-EXEC                                        17530099
179200         END-EVALUATE                                             17540099
179300                                                                  17550099
179400         EVALUATE TRUE                                            17560099
179500             WHEN SQLCODE = ZERO                                  17570099
179600             WHEN SQLCODE = -904                                  17580099
179700             WHEN SQLCODE = -913                                  17590099
179800                 CONTINUE                                         17600099
179900             WHEN SQLWARN0 NOT = SPACES                           17610099
180000             WHEN SQLCODE < ZERO                                  17620099
180100             WHEN SQLCODE > ZERO                                  17630099
180200                 MOVE '4010-OPEN-CURSOR'                          17640099
180300                                   TO DP013-PARAGRAPH             17650099
180400                 MOVE 'OPEN ONE STORE CURSOR - '                  17660099
180500                                   TO DP013-MESSAGE-TEXT (1)      17670099
180600                 MOVE SQLCA        TO DP013-SQLCA                 17680099
180700                 MOVE 'TCEPLMF '   TO DP013-DB2-TABLE-NAME (1)    17690099
180800                 SET DP013-DB2-ABEND                              17700099
180900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           17710099
181000                 PERFORM DP013-0000-PROCESS-ABEND                 17720099
181100         END-EVALUATE                                             17730099
181200     END-PERFORM                                                  17740099
181300*                                                                 17750099
181400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17760099
181500         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             17770099
181600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   17780099
181700                                   TO DP013-MESSAGE-TEXT (1)      17790099
181800         MOVE SQLCA                TO DP013-SQLCA                 17800099
181900         MOVE 'TCEPLMF '           TO DP013-DB2-TABLE-NAME (1)    17810099
182000         SET DP013-DB2-ABEND                                      17820099
182100             DP013-XCTL-DISPLAY-RESTART                           17830099
182200                                   TO TRUE                        17840099
182300         PERFORM DP013-0000-PROCESS-ABEND                         17850099
182400     END-IF.                                                      17860099
182500                                                                  17870099
182600 EJECT                                                            17880099
182700*----------------------------------------------------------------*17890099
182800* CLOSE THE TMESSAGE CURSOR.                                     *17900099
182900*   IN THIS PARTICULAR APPLICATION ONE OF 2 DIFFERENT CURSORS    *17910099
183000*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *17920099
183100*   USER.                                                        *17930099
183200*----------------------------------------------------------------*17940099
183300                                                                  17950099
183400 4020-CLOSE-CURSOR.                                               17960099
183500     EVALUATE TRUE                                                17970099
183600         WHEN ASC-ONE-STORE-CURSOR                                17980099
183700              EXEC SQL                                            17990099
183800                   CLOSE ONE-STORE-CSR                            18000099
183900              END-EXEC                                            18010099
184000                                                                  18020099
184100         WHEN ASC-ALL-STORES-CURSOR                               18030099
184200              EXEC SQL                                            18040099
184300                   CLOSE ALL-STORES-CSR                           18050099
184400              END-EXEC                                            18060099
184500     END-EVALUATE.                                                18070099
184600*                                                                 18080099
184700     EVALUATE TRUE                                                18090099
184800         WHEN SQLCODE = ZERO                                      18100099
184900             CONTINUE                                             18110099
185000         WHEN SQLWARN0 NOT = SPACES                               18120099
185100         WHEN SQLCODE < ZERO                                      18130099
185200         WHEN SQLCODE > ZERO                                      18140099
185300             MOVE '4020-CLOSE-CURSOR'                             18150099
185400                               TO DP013-PARAGRAPH                 18160099
185500             MOVE 'CLOSE ONE STORE CURSOR'                        18170099
185600                               TO DP013-MESSAGE-TEXT (1)          18180099
185700             MOVE SQLCA        TO DP013-SQLCA                     18190099
185800             MOVE 'TCEPLMF '   TO DP013-DB2-TABLE-NAME (1)        18200099
185900             SET DP013-DB2-ABEND                                  18210099
186000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18220099
186100             PERFORM DP013-0000-PROCESS-ABEND                     18230099
186200     END-EVALUATE.                                                18240099
186300                                                                  18250099
186400 EJECT                                                            18260099
186500*----------------------------------------------------------------*18270099
186600*    SET UP THE HOST VARIABLES.                                  *18280099
186700*----------------------------------------------------------------*18290099
186800                                                                  18300099
186900 4100-PREPARE-CURSOR.                                             18310099
187000                                                                  18320099
187100     MOVE ASC-PULL-NBR-N       TO DK-PULL-NUMBER.                 18330099
187200     MOVE ASC-STORE-NBR        TO DK-STORE-NUMBER.                18340099
187300     MOVE ASC-LINE-NBR         TO DK-LINE-NUMBER.                 18350099
187400     MOVE ASC-REF-NBR          TO DK-REF-NUMBER.                  18360099
187500                                                                  18370099
187600         IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                18380099
187700              SET ASC-ALL-STORES-CURSOR TO TRUE                   18390099
187800         ELSE                                                     18400099
187900         IF  CE002-DISPLAY-ALL                                    18401099
188000             SET  ASC-ALL-STORES-CURSOR  TO  TRUE                 18403099
188100         ELSE                                                     18404099
188200              SET ASC-ONE-STORE-CURSOR   TO TRUE                  18410099
188300         END-IF                                                   18420099
188400         END-IF.                                                  18421099
188500                                                                  18430099
188600*----------------------------------------------------------------*18440089
188700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *18450089
188800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *18460089
188900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *18470089
189000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *18480089
189100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *18490089
189200*                                                                *18500089
189300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *18510089
189400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *18520089
189500*    UPON INITIALIZATION.                                        *18530089
189600*----------------------------------------------------------------*18540089
189700 4300-READ-ITEMS-FROM-DB.                                         18550089
189800                                                                  18560089
189900     PERFORM                                                      18570089
190000         VARYING PV-READ-COUNT                                    18580089
190100         FROM 1 BY 1                                              18590089
190200         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    18600089
190300            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         18610089
190400                                                                  18620089
190500         PERFORM 4310-FETCH                                       18630099
190600                                                                  18640099
190700         IF  ASC-ITEMS-LEFT-ON-DB                                 18650089
190800             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                18660089
190900                 ADD +1            TO ASC-ITEM-SUB                18670089
191000             ELSE                                                 18680089
191100                 ADD +1            TO ASC-BLK-SUB                 18690089
191200                 MOVE +1           TO ASC-ITEM-SUB                18700089
191300                                                                  18710089
191400                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         18720089
191500                     MOVE +1       TO ASC-BLK-SUB                 18730089
191600                     SET ASC-BLOCK-MODIFIED (1)                   18740089
191700                                   TO TRUE                        18750089
191800                     PERFORM 5100-WRITE-TEMP-STORAGE              18760089
191900                     MOVE ASC-BLOCK-ENTRIES                       18770089
192000                               (PC-MAX-BLOCKS-IN-ARRAY)           18780089
192100                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 18790089
192200                     ADD +1        TO ASC-BLK-SUB                 18800089
192300                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   18810089
192400                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      18820089
192500                                   TO TRUE                        18830089
192600                 END-IF                                           18840089
192700             END-IF                                               18850089
192800             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    18860089
192900             MOVE ASC-NUMBER-OF-ITEMS-READ                        18870089
193000                                   TO ASC-LIST-ITEM-NUMBER        18880089
193100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18890089
193200******************************************************************18900099
193300*                                                                 18910099
193400             MOVE CEPLMF-STR-NBR                                  18920099
193500                              TO  ASC-STORE-NUMBER                18930099
193600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18940099
193700             MOVE PV-DATE-TIME-DISPLAY                            18950099
193800                              TO  ASC-DATE-TIME                   18960099
193900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18970099
194000             MOVE CEPLMF-MFST-UNT-QTY                             18980099
194100                              TO  ASC-MANIFEST-UNITS              18990099
194200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19000099
194300             ADD CEPLMF-MFST-UNT-QTY                              19000199
194400                              TO ASC-TOT-DISTRB-UNTS              19001099
194500             MOVE CEPLMF-BOL-NBR                                  19010099
194600                              TO  ASC-BOL-NUMBER                  19020099
194700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19030099
194800             MOVE CEPLMF-EXPRT-PRC-BTCH-ID                        19040099
194900                              TO  ASC-BATCH-NUMBER                19050099
195000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19060099
195100         END-IF                                                   19070099
195200     END-PERFORM                                                  19080099
195300******************************************************************19090099
195400                                                                  19100099
195500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          19110099
195600         MOVE +1               TO ASC-BLK-SUB                     19120099
195700         PERFORM 5100-WRITE-TEMP-STORAGE                          19130099
195800         ADD +1                TO ASC-BLK-SUB                     19140099
195900         PERFORM 5100-WRITE-TEMP-STORAGE                          19150099
196000                                                                  19160099
196100         MOVE 1                TO ASC-BLK-SUB                     19170099
196200                                  PV-BLOCK-NUMBER                 19180099
196300         PERFORM 4410-READ-TEMP-STORAGE                           19190099
196400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             19200099
196500             MOVE 2            TO ASC-BLK-SUB                     19210099
196600                                  PV-BLOCK-NUMBER                 19220099
196700             PERFORM 4410-READ-TEMP-STORAGE                       19230099
196800         END-IF                                                   19240099
196900     END-IF.                                                      19250099
197000 EJECT                                                            19260099
197100                                                                  19270099
197200*----------------------------------------------------------------*19280099
197300*    FETCH THE MESSAGE CURSOR.                                   *19290099
197400*----------------------------------------------------------------*19300099
197500                                                                  19310099
197600 4310-FETCH.                                                      19320099
197700                                                                  19330099
197800     EVALUATE TRUE                                                19340099
197900         WHEN ASC-ONE-STORE-CURSOR                                19350099
198000              EXEC SQL                                            19360099
198100                   FETCH ONE-STORE-CSR                            19370099
198200                     INTO  :CEPLMF-STR-NBR                        19380099
198300                          ,:CEPLMF-MFST-TMST                      19390099
198400                          ,:CEPLMF-MFST-UNT-QTY                   19400099
198500                          ,:CEPLMF-BOL-NBR                        19410099
198600                          ,:CEPLMF-EXPRT-PRC-BTCH-ID              19420099
198700              END-EXEC                                            19430099
198800                                                                  19440099
198900         WHEN ASC-ALL-STORES-CURSOR                               19450099
199000              EXEC SQL                                            19460099
199100                   FETCH ALL-STORES-CSR                           19470099
199200                     INTO  :CEPLMF-STR-NBR                        19480099
199300                          ,:CEPLMF-MFST-TMST                      19490099
199400                          ,:CEPLMF-MFST-UNT-QTY                   19500099
199500                          ,:CEPLMF-BOL-NBR                        19510099
199600                          ,:CEPLMF-EXPRT-PRC-BTCH-ID              19520099
199700              END-EXEC                                            19530099
199800     END-EVALUATE.                                                19540099
199900                                                                  19550099
200000     EVALUATE TRUE                                                19560099
200100         WHEN SQLCODE = ZERO                                      19570099
200200              MOVE CEPLMF-MFST-TMST TO PV-TMST-R                  19580099
200300              MOVE PV-TMST-CC       TO PV-DISPLAY-CC              19590099
200400              MOVE PV-TMST-YY       TO PV-DISPLAY-YY              19600099
200500              MOVE PC-SLASH         TO PV-SLASH-1                 19610099
200600              MOVE PV-TMST-MM       TO PV-DISPLAY-MM              19620099
200700              MOVE PC-SLASH         TO PV-SLASH-2                 19630099
200800              MOVE PV-TMST-DD       TO PV-DISPLAY-DD              19640099
200900              MOVE PV-TMST-HRS      TO PV-DISPLAY-HRS             19650099
201000              MOVE PC-COLON         TO PV-COLON                   19660099
201100              MOVE PV-TMST-MIN      TO PV-DISPLAY-MIN             19670099
201200         WHEN SQLCODE = +100                                      19680099
201300              MOVE SPACES           TO PV-TMST-R                  19690099
201400              MOVE SPACES           TO PV-DISPLAY-CC              19700099
201500              MOVE SPACES           TO PV-DISPLAY-YY              19710099
201600              MOVE SPACES           TO PV-SLASH-1                 19720099
201700              MOVE SPACES           TO PV-DISPLAY-MM              19730099
201800              MOVE SPACES           TO PV-SLASH-2                 19740099
201900              MOVE SPACES           TO PV-DISPLAY-DD              19750099
202000              MOVE SPACES           TO PV-DISPLAY-HRS             19760099
202100              MOVE SPACES           TO PV-COLON                   19770099
202200              MOVE SPACES           TO PV-DISPLAY-MIN             19780099
202300         WHEN SQLWARN0 NOT = SPACE                                19790099
202400         WHEN SQLCODE NOT = ZERO                                  19800099
202500              MOVE '4310-FETCH-CURSOR'                            19810099
202600                               TO DP013-PARAGRAPH                 19820099
202700              MOVE 'FETCH ONE STORE CURSOR'                       19830099
202800                               TO DP013-MESSAGE-TEXT (1)          19840099
202900              MOVE SQLCA       TO DP013-SQLCA                     19850099
203000              SET DP013-DB2-ABEND                                 19860099
203100                               TO TRUE                            19870099
203200              PERFORM DP013-0000-PROCESS-ABEND                    19880099
203300     END-EVALUATE.                                                19890099
203400                                                                  19900099
203500     IF  SQLCODE EQUAL +100                                       19910099
203600         SET ASC-NO-ITEMS-LEFT-ON-DB                              19920099
203700                                   TO TRUE                        19930099
203800     END-IF.                                                      19940099
203900                                                                  19950099
204000                                                                  19960099
204100                                                                  19970099
204200*----------------------------------------------------------------*19980099
204300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *19990099
204400*----------------------------------------------------------------*20000099
204500                                                                  20010099
204600 4400-MOVE-COMMAREA-TO-SCREEN.                                    20020099
204700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             20030099
204800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          20040099
204900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          20050099
205000             MOVE +1    TO ASC-BLK-SUB                            20060099
205100             PERFORM 5100-WRITE-TEMP-STORAGE                      20070099
205200             ADD +1     TO ASC-BLK-SUB                            20080099
205300             PERFORM 5100-WRITE-TEMP-STORAGE                      20090099
205400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             20100099
205500                 GIVING PV-BLOCK-NUMBER                           20110099
205600                 REMAINDER PV-REMAINDER                           20120099
205700             IF  PV-REMAINDER > ZERO                              20130099
205800                 ADD +1 TO PV-BLOCK-NUMBER                        20140099
205900             END-IF                                               20150099
206000             MOVE +1    TO ASC-BLK-SUB                            20160099
206100             PERFORM 4410-READ-TEMP-STORAGE                       20170099
206200             ADD +1     TO ASC-BLK-SUB                            20180099
206300                           PV-BLOCK-NUMBER                        20190099
206400             PERFORM 4410-READ-TEMP-STORAGE                       20200099
206500     END-IF.                                                      20210099
206600     MOVE +1            TO ASC-BLK-SUB.                           20220099
206700     COMPUTE ASC-ITEM-SUB =                                       20230099
206800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              20240099
206900         + PC-ITEMS-PER-PANEL).                                   20250099
207000*                                                                 20260099
207100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        20270099
207200         ADD +1         TO ASC-BLK-SUB                            20280099
207300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            20290099
207400     END-IF.                                                      20300099
207500*                                                                 20310099
207600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           20320099
207700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                20330099
207800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        20340099
207900     PERFORM 4420-FORMAT-LIST-LINES                               20350099
208000         VARYING PV-SUB                                           20360099
208100         FROM PC-ITEMS-PER-PANEL BY -1                            20370099
208200         UNTIL PV-SUB < +1.                                       20380099
208300*                                                                 20390099
208400     COMPUTE ASC-ITEMS-DISPLAYED =                                20400099
208500         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          20410099
208600     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    20420099
208700                                      ASTRTITO.                   20430099
208800     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    20440099
208900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    20450099
209000                                                                  20460099
209100     MOVE ASC-CS-LOC-N               TO PV-4-DIGIT-STORE.         20470099
209200     MOVE PV-4-DIGIT-STORE           TO ALOCIDO.                  20480099
209300     MOVE ASC-PULL-NBR-N             TO APULNOO                   20490099
209400                                        DK-PULL-NUMBER.           20500099
285700*----------------------------------------------------------------*20510099
285800*                                               **   WR # 230ZZ  *20510199
285900* THE FOLLOWING MOVE STATEMENTS ARE REPLACED WITH                *20510299
285900* ASC-SKU-NUMBER TO PV-SKU-NUMBER.                               *20510399
286000*----------------------------------------------------------------*20510499
209500*    MOVE ASC-SKU-NUMBER             TO ASC-SKU-NUMBER-HOLD.      20511099
209600*    MOVE ASC-SKU-DEPT               TO PV-SKU-DEPT.              20520099
209700*    MOVE ASC-SKU-CLASS              TO PV-SKU-CLASS.             20530099
209800*    MOVE ASC-SKU-SEQ                TO PV-SKU-SEQ.               20540099
209500     MOVE ASC-SKU-NUMBER             TO PV-SKU-NUMBER.            20541099
285400*----------------------------------------------------------------*20542099
285500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *20543099
285600*----------------------------------------------------------------*20544099
209900                                                                  20550099
210000     MOVE PV-SKU-NUMBER              TO ASKUO.                    20560099
210100     MOVE ASC-LINE-NBR               TO ALNENOO                   20570099
210200                                        DK-LINE-NUMBER.           20580099
210300     MOVE ASC-LINE-SKU-RETAIL        TO ASKRETO.                  20590099
210400                                                                  20600099
210500*F13=ALL STOR                                                     20610099
210600        IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR             20620099
210700           ASC-DISPLAY-ALL-STORE                                  20630099
210800           EVALUATE TRUE                                          20640099
210900             WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)          20650099
211000                MOVE PC-ALL                     TO ASTRNOO        20660099
211100                MOVE ASC-TOT-MANIFEST-UNTS      TO AMFUNTO        20670099
211200                MOVE ASC-TOT-ADJUST-UNTS        TO AADJUNTO       20680099
211300                MOVE ASC-TOT-DISTRB-UNTS        TO ADSUNTO        20690099
211400                MULTIPLY  ASC-LINE-SKU-RETAIL                     20700099
211500                    BY  ASC-TOT-DISTRB-UNTS                       20710099
211600                 GIVING PV-DISTRB-RETAIL                          20720099
211700                MOVE PV-DISTRB-RETAIL           TO ADSRTLO        20730099
211800             WHEN DP020-SRC-AID = DP016-ENTER                     20740099
211900                MOVE PC-ALL                     TO ASTRNOO        20750099
212000                MOVE ASC-TOT-MANIFEST-UNTS      TO AMFUNTO        20760099
212100                MOVE ASC-TOT-ADJUST-UNTS        TO AADJUNTO       20770099
212200                MOVE ASC-TOT-DISTRB-UNTS        TO ADSUNTO        20780099
212300                MULTIPLY  ASC-LINE-SKU-RETAIL                     20790099
212400                    BY  ASC-TOT-DISTRB-UNTS                       20800099
212500                 GIVING PV-DISTRB-RETAIL                          20810099
212600                MOVE PV-DISTRB-RETAIL           TO ADSRTLO        20820099
212700           END-EVALUATE                                           20830099
212800        ELSE                                                      20840099
212900           IF  ASC-ALL-STORES-CURSOR                              20841099
213000               MOVE PC-ALL                 TO ASTRNOO             20842099
213100               MOVE ASC-TOT-MANIFEST-UNTS  TO AMFUNTO             20842199
213200               MOVE ASC-TOT-ADJUST-UNTS    TO AADJUNTO            20842299
213300               MOVE ASC-TOT-DISTRB-UNTS    TO ADSUNTO             20842399
213400           ELSE                                                   20843099
213500               MOVE ASC-STORE-NBR          TO ASTRNOO             20850099
213600               MOVE ASC-MANIFEST-UNTS      TO AMFUNTO             20850199
213700               MOVE ASC-ADJUST-UNTS        TO AADJUNTO            20850299
213800               MOVE ASC-TOT-DISTRB-UNTS    TO ADSUNTO             20850499
213900           END-IF                                                 20851099
214000           MULTIPLY  ASC-LINE-SKU-RETAIL                          20890099
214100               BY  ASC-TOT-DISTRB-UNTS                            20900099
214200            GIVING PV-DISTRB-RETAIL                               20910099
214300           MOVE PV-DISTRB-RETAIL           TO ADSRTLO             20920099
214400        END-IF                                                    20930099
214500*                                                                 20940099
214600*                                                                 20950099
214700     IF  DP020-MSG-NUMBER-X = SPACE                               20960099
214800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  20970099
214900*            --- MORE ITEMS TO DISPLAY ----                       20980099
215000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            20990099
215100             SET DP020-MSG-INFORMATIONAL TO TRUE                  21000099
215200         END-IF                                                   21010099
215300     END-IF.                                                      21020099
215400*----------------------------------------------------------------*21030099
215500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *21040099
215600*----------------------------------------------------------------*21050099
215700                                                                  21060099
215800 4410-READ-TEMP-STORAGE.                                          21070099
215900                                                                  21080099
216000     EXEC CICS                                                    21090099
216100         READQ TS                                                 21100099
216200             QUEUE (ASC-LIST-QUEUE-NAME)                          21110099
216300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               21120099
216400             ITEM  (PV-BLOCK-NUMBER)                              21130099
216500             RESP  (PV-CICS-RESP)                                 21140099
216600     END-EXEC.                                                    21150099
216700                                                                  21160099
216800     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       21170099
216900       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     21180099
217000         CONTINUE                                                 21190099
217100     ELSE                                                         21200099
217200         SET DP013-CICS-ABEND     TO TRUE                         21210099
217300         SET DP013-NO-ROLLBACK    TO TRUE                         21220099
217400         MOVE '4410-READ-TEMP-STORAGE'                            21230099
217500                                  TO DP013-PARAGRAPH              21240099
217600         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      21250099
217700                                  TO DP013-MESSAGE-TEXT(1)        21260099
217800         PERFORM DP013-0000-PROCESS-ABEND                         21270099
217900     END-IF.                                                      21280099
218000                                                                  21290099
218100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             21300099
218200*                                                                 21310099
218300     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         21320099
218400         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               21330099
218500     END-IF.                                                      21340099
218600 EJECT                                                            21350099
218700*----------------------------------------------------------------*21360099
218800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *21370099
218900*----------------------------------------------------------------*21380099
219000                                                                  21390099
219100 4420-FORMAT-LIST-LINES.                                          21400099
219200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      21410099
219300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                21420099
219400                                                                  21430099
219500         MOVE SPACES             TO MR-DATE-TIME(PV-SUB)          21440099
219600                                    MR-BOL-NUMBER (PV-SUB)        21450099
219700                                    MR-BATCH-NUMBER (PV-SUB)      21460099
219800         MOVE ZEROES             TO MR-STORE-NUMBER (PV-SUB)      21470099
219900                                    MR-MANIFEST-UNITS (PV-SUB)    21480099
220000     ELSE                                                         21490099
220100         IF  DP030-SET-CURSOR-TRAILER                             21500099
220200             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)21510099
220300                 > SPACE)                                         21520099
220400               OR (PV-SUB = 1))                                   21530099
220500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               21540099
220600                MOVE -1          TO ASTRTITL                      21550099
220700             END-IF                                               21560099
220800         END-IF                                                   21570099
220900*                                                                 21580099
221000         MOVE ASC-STORE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)         21590099
221100                                 TO MR-STORE-NUMBER (PV-SUB)      21600099
221200         MOVE ASC-DATE-TIME    (ASC-BLK-SUB ASC-ITEM-SUB)         21610099
221300                                 TO MR-DATE-TIME(PV-SUB)          21620099
221400         MOVE ASC-MANIFEST-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)       21630099
221500                                 TO MR-MANIFEST-UNITS (PV-SUB)    21640099
221600         MOVE ASC-BOL-NUMBER   (ASC-BLK-SUB ASC-ITEM-SUB)         21650099
221700                                 TO MR-BOL-NUMBER (PV-SUB)        21660099
221800         MOVE ASC-BATCH-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)         21670099
221900                                 TO MR-BATCH-NUMBER (PV-SUB)      21680099
222000     END-IF.                                                      21690099
222100     SUBTRACT +1 FROM ASC-ITEM-SUB                                21700099
222200     IF  ASC-ITEM-SUB < + 1                                       21710099
222300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  21720099
222400         MOVE +1                 TO ASC-BLK-SUB                   21730099
222500     END-IF.                                                      21740099
222600******************************************************************21750099
222700** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **21760099
222800** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **21770099
222900** ISSUE A WARNING.                                             **21780099
223000******************************************************************21790099
223100 4430-CHECK-FOR-BEGIN-AND-END.                                    21800099
223200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       21810099
223300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     21820099
223400*            -- NO END-OF-RANGE SPECFIED ---                      21830099
223500             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            21840099
223600             SET DP020-MSG-WARNING TO TRUE                        21850099
223700             PERFORM 4431-POSITION-AT-WARNING                     21860099
223800         END-IF                                                   21870099
223900     ELSE                                                         21880099
224000         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     21890099
224100*            -- NO BEGINNING-OF-RANGE SPECFIED ---                21900099
224200             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            21910099
224300             SET DP020-MSG-WARNING TO TRUE                        21920099
224400             PERFORM 4431-POSITION-AT-WARNING                     21930099
224500         END-IF                                                   21940099
224600     END-IF.                                                      21950099
224700******************************************************************21960099
224800** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **21970099
224900** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **21980099
225000** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **21990099
225100** POSITION THE CURSOR THERE.                                   **22000099
225200******************************************************************22010099
225300 4431-POSITION-AT-WARNING.                                        22020099
225400     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 22030099
225500                    - PV-TOP-ITEM + 1.                            22040099
225600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22050099
225700         CONTINUE                                                 22060099
225800     ELSE                                                         22070099
225900         SET DP030-SET-CURSOR-APPL-1                              22080099
226000                                   TO TRUE                        22090099
226100         MOVE -1                   TO ASTRTITL                    22100099
226200     END-IF.                                                      22110099
226300*                                                                 22120099
226400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   22130099
226500                    - PV-TOP-ITEM + 1.                            22140099
226600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22150099
226700         CONTINUE                                                 22160099
226800     ELSE                                                         22170099
226900         SET DP030-SET-CURSOR-APPL-1                              22180099
227000                                   TO TRUE                        22190099
227100         MOVE -1                   TO ASTRTITL                    22200099
227200     END-IF.                                                      22210099
227300                                                                  22220099
227400*----------------------------------------------------------------*22230099
227500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *22240099
227600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *22250099
227700* FOR THE SELECTED ITEMS QUEUE.                                  *22260099
227800*                                                                *22270099
227900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *22280099
228000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *22290099
228100* THE ARRAY IS FULL.                                             *22300099
228200*----------------------------------------------------------------*22310099
228300                                                                  22320099
228400 5000-PREPARE-SEL-QUEUE.                                          22330099
228500                                                                  22340099
228600     MOVE +1                   TO  ASC-BLK-SUB.                   22350099
228700     PERFORM 5100-WRITE-TEMP-STORAGE.                             22360099
228800     ADD +1                    TO  ASC-BLK-SUB.                   22370099
228900     PERFORM 5100-WRITE-TEMP-STORAGE.                             22380099
229000                                                                  22390099
229100     MOVE ASC-SEL-QUEUE-NAME   TO  CE002-SEL-QUEUE-NAME.          22400099
229200     PERFORM 6010-DELETE-SEL-QUEUE.                               22410099
229300                                                                  22420099
229400     SET ASC-UPDATE-TSQ        TO  TRUE.                          22430099
229500                                                                  22440099
229600     SET CE003-IDX             TO  1.                             22450099
229700     MOVE ZERO                 TO CE002-NUMBER-OF-TS-ITEMS.       22460099
229800     INITIALIZE CE003-SELECTED-ITEM-ARRAY.                        22470099
229900                                                                  22480099
230000     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           22490099
230100             VARYING PV-ITEM                                      22500099
230200             FROM 1 BY 1                                          22510099
230300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     22520099
230400                                                                  22530099
230500     IF  CE003-IDX > 1                                            22540099
230600         PERFORM 5205-WRITE-SEL-QUEUE                             22550099
230700         ADD +1                TO CE002-NUMBER-OF-TS-ITEMS        22560099
230800     END-IF.                                                      22570099
230900                                                                  22580099
231000*----------------------------------------------------------------*22590099
231100*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *22600099
231200*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *22610099
231300*----------------------------------------------------------------*22620099
231400                                                                  22630099
231500 5100-WRITE-TEMP-STORAGE.                                         22640099
231600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     22650099
231700                                   TO PV-LIST-ITEM-NUMBER.        22660099
231800     COMPUTE PV-BLOCK-NUMBER =                                    22670099
231900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    22680099
232000                                                                  22690099
232100     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             22700099
232200     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             22710099
232300         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      22720099
232400             PERFORM 5105-REWRITE-ASC-LISTQ                       22730099
232500         END-IF                                                   22740099
232600     ELSE                                                         22750099
232700         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       22760099
232800         ASC-HIGHEST-BLOCK-WRITTEN + 1                            22770099
232900         PERFORM 5110-WRITE-ASC-LISTQ                             22780099
233000         ADD +1                TO ASC-HIGHEST-BLOCK-WRITTEN       22790099
233100     END-IF.                                                      22800099
233200                                                                  22810099
233300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             22820099
233400******************************************************************22830099
233500** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **22840099
233600** SPECIFIC COMMAREA.                                           **22850099
233700******************************************************************22860099
233800 5105-REWRITE-ASC-LISTQ.                                          22870099
233900     EXEC CICS                                                    22880099
234000         WRITEQ TS                                                22890099
234100             QUEUE (ASC-LIST-QUEUE-NAME)                          22900099
234200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               22910099
234300             ITEM  (PV-BLOCK-NUMBER)                              22920099
234400             REWRITE                                              22930099
234500             RESP  (PV-CICS-RESP)                                 22940099
234600     END-EXEC.                                                    22950099
234700                                                                  22960099
234800     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           22970099
234900         CONTINUE                                                 22980099
235000     ELSE                                                         22990099
235100         SET DP013-CICS-ABEND            TO TRUE                  23000099
235200         SET DP013-NO-ROLLBACK           TO TRUE                  23010099
235300         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       23020099
235400         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     23030099
235500                                         TO DP013-MESSAGE-TEXT(1) 23040099
235600         PERFORM DP013-0000-PROCESS-ABEND                         23050099
235700     END-IF.                                                      23060099
235800                                                                  23070099
235900******************************************************************23080099
236000** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **23090099
236100** SPECIFIC COMMAREA.                                           **23100099
236200******************************************************************23110099
236300 5110-WRITE-ASC-LISTQ.                                            23120099
236400     EXEC CICS                                                    23130099
236500         WRITEQ TS                                                23140099
236600             QUEUE (ASC-LIST-QUEUE-NAME)                          23150099
236700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23160099
236800             ITEM  (PV-BLOCK-NUMBER)                              23170099
236900             RESP  (PV-CICS-RESP)                                 23180099
237000     END-EXEC.                                                    23190099
237100     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      23200099
237200         SET DP013-CICS-ABEND      TO TRUE                        23210099
237300         SET DP013-NO-ROLLBACK     TO TRUE                        23220099
237400         MOVE '5110-WRITE-ASC-LISTQ'                              23230099
237500                                   TO DP013-PARAGRAPH             23240099
237600         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           23250099
237700                                   TO DP013-MESSAGE-TEXT(1)       23260099
237800         PERFORM DP013-0000-PROCESS-ABEND                         23270099
237900     END-IF.                                                      23280099
238000                                                                  23290099
238100                                                                  23300099
238200*----------------------------------------------------------------*23310099
238300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *23320099
238400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *23330099
238500*----------------------------------------------------------------*23340099
238600                                                                  23350099
238700 5200-FILL-SEL-QUEUE-RECORD.                                      23360099
238800                                                                  23370099
238900     PERFORM 6112-READ-LIST-QUEUE.                                23380099
239000                                                                  23390099
239100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       23400099
239200         PERFORM                                                  23410099
239300         VARYING LQW-IDX                                          23420099
239400         FROM 1 BY 1                                              23430099
239500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            23440099
239600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          23450099
239700                                                                  23460099
239800             IF  LQW-SELECT (LQW-IDX)                             23470099
239900                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              23480099
240000                                   TO CE003-ITEM (CE003-IDX)      23490099
240100                 MOVE SPACE        TO CE003-ACTION-SW (CE003-IDX) 23500099
240200                                                                  23510099
240300                 MOVE LQW-STORE-NUMBER (LQW-IDX)                  23520099
240400                                   TO  CE003-STR-NBR              23530099
240500                                       (CE003-IDX)                23540099
240600                                                                  23550099
240700                 SET CE003-IDX UP BY 1                            23560099
240800                 IF  CE003-IDX > CE003-MAX-ITEMS                  23570099
240900                     PERFORM 5205-WRITE-SEL-QUEUE                 23580099
241000                     ADD +1        TO CE002-NUMBER-OF-TS-ITEMS    23590099
241100                     INITIALIZE CE003-SELECTED-ITEM-ARRAY         23600099
241200                     SET CE003-IDX TO  1                          23610099
241300                 END-IF                                           23620099
241400             END-IF                                               23630099
241500         END-PERFORM                                              23640099
241600     END-IF.                                                      23650099
241700                                                                  23660099
241800*----------------------------------------------------------------*23670099
241900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *23680099
242000*----------------------------------------------------------------*23690099
242100                                                                  23700099
242200 5205-WRITE-SEL-QUEUE.                                            23710099
242300                                                                  23720099
242400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            23730099
242500                                   TO CE003-SELECTED-ITEMS.       23740099
242600                                                                  23750099
242700     EXEC CICS                                                    23760099
242800          WRITEQ TS                                               23770099
242900              QUEUE (ASC-SEL-QUEUE-NAME)                          23780099
243000              FROM  (CE003-SELECT-RECORD)                         23790099
243100              ITEM  (PV-SEL-QUEUE-ITEM)                           23800099
243200              RESP  (PV-CICS-RESP)                                23810099
243300     END-EXEC.                                                    23820099
243400                                                                  23830099
243500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          23840099
243600         CONTINUE                                                 23850099
243700     ELSE                                                         23860099
243800         SET DP013-CICS-ABEND      TO TRUE                        23870099
243900         SET DP013-NO-ROLLBACK     TO TRUE                        23880099
244000         MOVE '5205-WRITE-SEL-QUEUE'                              23890099
244100                                   TO DP013-PARAGRAPH             23900099
244200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          23910099
244300                                   TO DP013-MESSAGE-TEXT(1)       23920099
244400         PERFORM DP013-0000-PROCESS-ABEND                         23930099
244500     END-IF.                                                      23940099
244600 EJECT                                                            23950099
244700******************************************************************23960099
244800** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **23970099
244900** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **23980099
245000** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **23990099
245100** THE USER.                                                    **24000099
245200******************************************************************24010099
245300 6000-REFRESH-PANEL-FROM-TEMP.                                    24020099
245400     IF  ASC-UPDATE-TSQ                                           24030099
245500         SET ASC-NO-TSQ-UPDATE TO TRUE                            24040099
245600         MOVE ZERO                 TO PV-SAVE-ITEM                24050099
245700                                      PV-SEL-QUEUE-ITEM           24060099
245800         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        24070099
245900                                   TO PV-HOLD-SELECTED-ITEMS      24080099
246000         MOVE +1                   TO PV-ITEMS-PROCESSED          24090099
246100         PERFORM 6100-UPDATE-TSQ                                  24100099
246200             UNTIL PV-ITEMS-PROCESSED >                           24110099
246300                                     PV-HOLD-SELECTED-ITEMS       24120099
246400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         24130099
246500                    ASC-BLOCK-ENTRIES (2)                         24140099
246600     END-IF.                                                      24150099
246700                                                                  24160099
246800*----------------------------------------------------------------*24170099
246900*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *24180099
247000*----------------------------------------------------------------*24190099
247100 6010-DELETE-SEL-QUEUE.                                           24200099
247200                                                                  24210099
247300     EXEC CICS                                                    24220099
247400         DELETEQ TS                                               24230099
247500             QUEUE (ASC-SEL-QUEUE-NAME)                           24240099
247600             RESP  (PV-CICS-RESP)                                 24250099
247700     END-EXEC.                                                    24260099
247800*                                                                 24270099
247900     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      24280099
248000        (PV-CICS-RESP = DFHRESP(QIDERR)))                         24290099
248100         CONTINUE                                                 24300099
248200     ELSE                                                         24310099
248300         SET DP013-CICS-ABEND TO TRUE                             24320099
248400         SET DP013-NO-ROLLBACK TO TRUE                            24330099
248500         MOVE '6010-DELETE-SEL-QUEUE'                             24340099
248600                        TO DP013-PARAGRAPH                        24350099
248700         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         24360099
248800                        TO DP013-MESSAGE-TEXT (1)                 24370099
248900         PERFORM DP013-0000-PROCESS-ABEND                         24380099
249000     END-IF.                                                      24390099
249100                                                                  24400099
249200*----------------------------------------------------------------*24410099
249300*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *24420099
249400*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *24430099
249500*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *24440099
249600*    THE TEMP QUEUE.                                             *24450099
249700*----------------------------------------------------------------*24460099
249800                                                                  24470099
249900 6100-UPDATE-TSQ.                                                 24480099
250000                                                                  24490099
250100     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             24500099
250200     PERFORM 6105-READ-SEL-QUEUE.                                 24510099
250300     PERFORM                                                      24520099
250400         VARYING CE003-IDX                                        24530099
250500         FROM 1 BY 1                                              24540099
250600         UNTIL ((PV-ITEMS-PROCESSED >                             24550099
250700                              PV-HOLD-SELECTED-ITEMS)             24560099
250800         OR (CE003-IDX GREATER THAN CE003-MAX-ITEMS))             24570099
250900         IF  CE003-ACTION-SW (CE003-IDX) > SPACE                  24580099
251000             PERFORM 6110-PROCESS-ITEMS                           24590099
251100         END-IF                                                   24600099
251200         ADD +1                TO PV-ITEMS-PROCESSED              24610099
251300     END-PERFORM.                                                 24620099
251400     PERFORM 6111-WRITE-LIST-QUEUE.                               24630099
251500*----------------------------------------------------------------*24640099
251600*    READ THE LIST QUEUE RECORD.                                 *24650099
251700*----------------------------------------------------------------*24660099
251800                                                                  24670099
251900 6105-READ-SEL-QUEUE.                                             24680099
252000                                                                  24690099
252100     EXEC CICS                                                    24700099
252200          READQ TS                                                24710099
252300              QUEUE (ASC-SEL-QUEUE-NAME)                          24720099
252400              INTO  (CE003-SELECT-RECORD)                         24730099
252500              ITEM  (PV-SEL-QUEUE-ITEM)                           24740099
252600              RESP  (PV-CICS-RESP)                                24750099
252700     END-EXEC.                                                    24760099
252800*                                                                 24770099
252900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          24780099
253000         CONTINUE                                                 24790099
253100     ELSE                                                         24800099
253200         SET DP013-CICS-ABEND      TO  TRUE                       24810099
253300         SET DP013-NO-ROLLBACK     TO  TRUE                       24820099
253400         MOVE '6105-READ-SEL-QUEUE'                               24830099
253500                                   TO  DP013-PARAGRAPH            24840099
253600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           24850099
253700                                   TO  DP013-MESSAGE-TEXT(1)      24860099
253800         PERFORM DP013-0000-PROCESS-ABEND                         24870099
253900     END-IF.                                                      24880099
254000 EJECT                                                            24890099
254100*----------------------------------------------------------------*24900099
254200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*24910099
254300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*24920099
254400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *24930099
254500*----------------------------------------------------------------*24940099
254600                                                                  24950099
254700 6110-PROCESS-ITEMS.                                              24960099
254800                                                                  24970099
254900     COMPUTE PV-ITEM = 1 + ((CE003-ITEM (CE003-IDX) - 1)          24980099
255000                     / PC-ITEMS-PER-PANEL).                       24990099
255100                                                                  25000099
255200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           25010099
255300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          25020099
255400             PERFORM 6111-WRITE-LIST-QUEUE                        25030099
255500         END-IF                                                   25040099
255600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    25050099
255700                                                                  25060099
255800         PERFORM 6112-READ-LIST-QUEUE                             25070099
255900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               25080099
256000             CONTINUE                                             25090099
256100         END-IF                                                   25100099
256200     END-IF.                                                      25110099
256300                                                                  25120099
256400     COMPUTE PV-SUB = (CE003-ITEM (CE003-IDX)                     25130099
256500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              25140099
256600     SET LQW-DESELECT (PV-SUB)             TO  TRUE.              25150099
256700     MOVE LQW-SELECTED-SW (PV-SUB)                                25160099
256800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  25170099
256900     EVALUATE TRUE                                                25180099
257000         WHEN CE003-INQ (CE003-IDX)                               25190099
257100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             25200099
257200                                                                  25210099
257300         WHEN CE003-UPD (CE003-IDX)                               25220099
257400              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             25230099
257500                                                                  25240099
257600         WHEN CE003-DEL (CE003-IDX)                               25250099
257700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             25260099
257800                                                                  25270099
257900         WHEN CE003-ERR (CE003-IDX)                               25280099
258000              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             25290099
258100     END-EVALUATE.                                                25300099
258200                                                                  25310099
258300     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                25320099
258400                                                                  25330099
258500*----------------------------------------------------------------*25340099
258600*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *25350099
258700*----------------------------------------------------------------*25360099
258800                                                                  25370099
258900 6111-WRITE-LIST-QUEUE.                                           25380099
259000                                                                  25390099
259100     EXEC CICS                                                    25400099
259200         WRITEQ TS                                                25410099
259300             QUEUE (ASC-LIST-QUEUE-NAME)                          25420099
259400             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     25430099
259500             ITEM  (PV-SAVE-ITEM)                                 25440099
259600             REWRITE                                              25450099
259700             RESP  (PV-CICS-RESP)                                 25460099
259800     END-EXEC.                                                    25470099
259900*                                                                 25480099
260000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          25490099
260100         CONTINUE                                                 25500099
260200     ELSE                                                         25510099
260300         SET DP013-CICS-ABEND  TO  TRUE                           25520099
260400         SET DP013-NO-ROLLBACK TO  TRUE                           25530099
260500         MOVE '6111-WRITE-LIST-QUEUE'                             25540099
260600                               TO  DP013-PARAGRAPH                25550099
260700         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  25560099
260800                               TO  DP013-MESSAGE-TEXT(1)          25570099
260900         PERFORM DP013-0000-PROCESS-ABEND                         25580099
261000     END-IF.                                                      25590099
261100                                                                  25600099
261200 EJECT                                                            25610099
261300*----------------------------------------------------------------*25620099
261400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*25630099
261500*----------------------------------------------------------------*25640099
261600                                                                  25650099
261700 6112-READ-LIST-QUEUE.                                            25660099
261800                                                                  25670099
261900     EXEC CICS                                                    25680099
262000         READQ TS                                                 25690099
262100             QUEUE (ASC-LIST-QUEUE-NAME)                          25700099
262200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     25710099
262300             ITEM  (PV-ITEM)                                      25720099
262400             RESP  (PV-CICS-RESP)                                 25730099
262500     END-EXEC.                                                    25740099
262600*                                                                 25750099
262700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          25760099
262800         CONTINUE                                                 25770099
262900     ELSE                                                         25780099
263000         SET DP013-CICS-ABEND        TO TRUE                      25790099
263100         SET DP013-NO-ROLLBACK       TO TRUE                      25800099
263200         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           25810099
263300         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    25820099
263400                                     TO DP013-MESSAGE-TEXT(1)     25830099
263500         PERFORM DP013-0000-PROCESS-ABEND                         25840099
263600     END-IF.                                                      25850099
263700                                                                  25860099
263800                                                                  25870099
263900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 25880099
264000* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *25890099
264100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 25900099
264200 9100-READ-SEL-QUEUE.                                             25910099
264300                                                                  25920099
264400     EXEC CICS                                                    25930099
264500         READQ TS                                                 25940099
264600             QUEUE (ASC-SEL-QUEUE-NAME)                           25950099
264700             INTO  (CE003-SELECT-RECORD)                          25960099
264800             ITEM  (ASC-SEL-ITEM)                                 25970099
264900             RESP  (PV-CICS-RESP)                                 25980099
265000     END-EXEC.                                                    25990099
265100     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        26000099
265200         CONTINUE                                                 26010099
265300     ELSE                                                         26020099
265400         SET DP013-LOGIC-ABEND                                    26030099
265500             DP013-NO-ROLLBACK   TO   TRUE                        26040099
265600         MOVE '9100-READ-SEL-QUEUE'                               26050099
265700                                 TO   DP013-PARAGRAPH             26060099
265800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   26070099
265900                                 TO   DP013-MESSAGE-TEXT (1)      26080099
266000         PERFORM DP013-0000-PROCESS-ABEND                         26090099
266100     END-IF.                                                      26100099
266200                                                                  26110099
266300                                                                  26120099
266400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*26130099
266500* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *26140099
266600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 26150099
266700 9200-REWRITE-SEL-QUEUE.                                          26160099
266800                                                                  26170099
266900     EXEC CICS                                                    26180099
267000          WRITEQ TS                                               26190099
267100              QUEUE  (ASC-SEL-QUEUE-NAME)                         26200099
267200              FROM   (CE003-SELECT-RECORD)                        26210099
267300              ITEM   (ASC-SEL-ITEM)                               26220099
267400              RESP   (PV-CICS-RESP)                               26230099
267500              REWRITE                                             26240099
267600     END-EXEC.                                                    26250099
267700                                                                  26260099
267800     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   26270099
267900         SET DP013-CICS-ABEND                                     26280099
268000             DP013-NO-ROLLBACK     TO TRUE                        26290099
268100         MOVE '9200-REWRITE-SEL-QUEUE'                            26300099
268200                                   TO DP013-PARAGRAPH             26310099
268300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   26320099
268400                                   TO DP013-MESSAGE-TEXT (1)      26330099
268500         PERFORM DP013-0000-PROCESS-ABEND                         26340099
268600     END-IF.                                                      26350099
268700                                                                  26360099
268800                                                                  26370099
268900*----------------------------------------------------------------*26380099
269000*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *26390099
269100*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *26400099
269200*----------------------------------------------------------------*26410099
269300 9900-SOFT-ABORT.                                                 26420099
269400                                                                  26430099
269500     EXEC CICS SYNCPOINT                                          26440099
269600          ROLLBACK                                                26450099
269700     END-EXEC.                                                    26460099
269800                                                                  26470099
269900     SET  PS-ERROR                                                26480099
270000          PS-SOFT-ABORT-ERROR                                     26490099
270100          DP020-MSG-FATAL       TO  TRUE.                         26500099
270200                                                                  26510099
270300                                                                  26520099
270400*----------------------------------------------------------------*26530099
270500*    ABEND PROCESSOR MODULE                                      *26540099
270600*----------------------------------------------------------------*26550099
270700                                                                  26560099
270800     COPY DPPD013.                                                26570099
