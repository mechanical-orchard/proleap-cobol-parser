000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400*  I M P O R T A N T --- WHEN COMPILING THIS PROGRAM THE SOCKET  *00040000
000500* SWITCH ON THE 2ND COMPILE SCREEN NEEDS TO BE SET TO 'Y'.  THIS *00050000
000600* PROGRAM IS USING "EZASOKET".                                   *00060000
000700******************************************************************00070000
000800                                                                  00080000
000900 PROGRAM-ID.             SUKRF527.                                00090000
001000 AUTHOR.                 DENISE HAHN.                             00100000
001100 INSTALLATION.           KOHLS.                                   00110000
001200 DATE-WRITTEN            JULY, 1999.                              00120000
001300 DATE-COMPILED.                                                   00130000
001400                                                                  00140000
001500******************************************************************00150000
001600* THIS PROGRAM DISPLAYS THE LABEL PRINT SCREEN ON THE             00160000
001700* LRT (LASER RADIO TERMINAL) AND ACCEPTS AN F-KEY.                00170000
001800* THE ASSOCIATE CAN PRINT SML, P2L OR CENTRAL STOCK LABELS.       00180000
001900******************************************************************00190000
002000* 04/23/2013  CHERI PARMLEY         CRQ# 0055296                 *00200000
002100*             MODIFIED FOR THE RFID PROJECT #5148B.              *00210000
002200*             LBPTDA-PRC-MSG-CDE IS NOW BEING EXTRACTED TO       *00220000
002300*             DETERMINE IF CARTON IS RFID.                       *00230000
002400*             CHANGES TAGGED AS CLP 06/20/2013 PR5148B           *00240000
002500* 07/19/13 RLK BEG                                                00250000
002600* 07/19/2013  RICH KELLEN           CRQ# CHG0058309              *00260000
002700*             ADDED TO 2 LABEL TYPES, CARTON AND MESSAGE.        *00270000
002800*             THESE WILL ONLY BE PRINTED AT NON-AUTO CONVEYOR    *00280000
002900*             DC'S AND WILL USE NEW LABEL TYPE CODES OF 'D' AND  *00290000
003000*             'M', RESPCTIVELY.                                  *00300000
003100* 11/07/2013  CHERI PARMLEY         CRQ# CHG0068598              *00310013
003200*             ADDED VALUES FOR THE "COMBO" OR "RF ONLY"          *00320014
003300*             TO THE PCWS255 COPYBOOK. CODE IN 4559-  CHECKS IF  *00330000
003400*             THESE SITUATIONS OCCUR. IF NOT DEAULTS TO          *00340000
003500*             'QCAUDIT' ON LABEL.                                *00350000
003600* 07/01/2015  Denise Hahn                                        *00360000
003700*             Changes to use the lbl-msg-txt instead of the      *00370000
003800*             mdse-pgm-desc on the TLBPTDA table.                *00380000
003900* 06/27/2017  BARB SCHULTZ          CRQ# CHG0176459              *00390013
004000*             CHANGES TO HANDLE EAS AND RFID TAGGING             *00400013
004100*             SIMULTANEOUSLY.                                    *00410013
263968*---------------------------------------------------------------* 00411016
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00412016
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00413016
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00414016
263968*---------------------------------------------------------------* 00415016
004200                                                                  00420000
004300******************************************************************00430000
004400 ENVIRONMENT DIVISION.                                            00440000
004500******************************************************************00450000
004600                                                                  00460000
004700******************************************************************00470000
004800 DATA DIVISION.                                                   00480000
004900******************************************************************00490000
005000                                                                  00500000
005100******************************************************************00510000
005200 WORKING-STORAGE SECTION.                                         00520000
005300******************************************************************00530000
005400 01  CA-COMMAREA.                                                 00540000
005500     COPY SUWS001.                                                00550000
005600                                                                  00560000
005700*----------------------------------------------------------------*00570000
005800*  DB2 KEYS                                                      *00580000
005900*----------------------------------------------------------------*00590000
006000 01  DK-DB2-KEYS.                                                 00600000
006100     05  DK-TRIP-ID                      PIC  S9(09)  COMP.       00610000
006200     05  DK-USER-ID                      PIC   X(08).             00620000
006300     05  DK-BATCH-NUMBER                 PIC  S9(04)  COMP.       00630000
006400     05  DK-MANIFEST                     PIC  S9(09)  COMP.       00640000
006500     05  DK-LPMS-TRANS-ID                PIC  S9(09)  COMP.       00650000
006600     05  DK-CURR-OPER-UNT-ID             PIC  S9(04)  COMP        00660000
006700                                              VALUE +0.           00670000
006800     05  DK-BARCODE-NBR                  PIC  X(22).              00680000
006900*----------------------------------------------------------------*00690000
007000*SOCKET COMMANDS CODES NEED FOR THE TCP/IP SOCKET CALLS-EZASOKET *00700000
007100*----------------------------------------------------------------*00710000
007200     COPY DPWS081.                                                00720000
007300                                                                  00730000
007400*---------------------------------------------------------------* 00740000
007500* COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE              * 00750000
007600*---------------------------------------------------------------* 00760000
007700     COPY XLWS001.                                                00770000
007800                                                                  00780000
007900*---------------------------------------------------------------* 00790000
008000* COPYBOOK FOR MODULE TO SECURE SEQ #'S FOR ASSIGNMENTS         * 00800000
008100*         DLKUP001                                              * 00810000
008200*---------------------------------------------------------------* 00820000
008300     COPY DLWS001.                                                00830000
008400                                                                  00840000
008500*---------------------------------------------------------------* 00850000
008600* COPYBOOK FOR WRITE DATA TO EAI EXPORT TABLE MODULE (XLKUP033) * 00860000
008700*---------------------------------------------------------------* 00870000
008800     COPY XLWS072.                                                00880000
008900*---------------------------------------------------------------* 00890000
009000* COPYBOOK TO DETERMINE CURRENT STORE ON HAND (XLKUT088)        * 00900000
009100*---------------------------------------------------------------* 00910000
009200     COPY XLWS088.                                                00920000
009300                                                                  00930000
009400*---------------------------------------------------------------* 00940000
009500     COPY SUWS050.                                                00950000
009600                                                                  00960000
009700*----------------------------------------------------------------*00970000
009800*                                                                *00980000
009900*----------------------------------------------------------------*00990000
010000 01  CONNECT-ERR.                                                 01000000
010100     05  FILLER                       PIC X(12)                   01010000
010200         VALUE ' SUKRF527 - '.                                    01020000
010300     05  FILLER                       PIC X(24)                   01030000
010400         VALUE 'CONNECT-SOCKET FAILED   '.                        01040000
010500     05  FILLER                       PIC X(9)                    01050000
010600         VALUE ' ERRNO = '.                                       01060000
010700     05  CONNECT-ERRNO                PIC 9(8).                   01070000
010800                                                                  01080000
010900                                                                  01090000
011000*----------------------------------------------------------------*01100000
011100*                                                                *01110000
011200*----------------------------------------------------------------*01120000
011300 01  RECEIVE-ERR.                                                 01130000
011400     05  FILLER                       PIC X(10)                   01140000
011500         VALUE ' SUKRF527-'.                                      01150000
011600     05  FILLER                       PIC X(17)                   01160000
011700         VALUE 'RCV CNFRM FAILED '.                               01170000
011800     05  FILLER                       PIC X(7)                    01180000
011900         VALUE ' ERRNO='.                                         01190000
012000     05  RECEIVE-RETCODE              PIC 9(10)-.                 01200000
012100     05  FILLER                       PIC X(2) VALUE SPACES.      01210000
012200     05  RECEIVE-ERRNO                PIC 9(8).                   01220000
012300     05  FILLER                       PIC X(2) VALUE SPACES.      01230000
012400     05  RECEIVE-RECEIVER             PIC 9(8).                   01240000
012500     05  FILLER                       PIC X(1) VALUE '-'.         01250000
012600     05  RECEIVE-SEQ                  PIC 9(3).                   01260000
012700     05  FILLER                       PIC X(1) VALUE '-'.         01270000
012800     05  RECEIVE-LINE                 PIC 9(4).                   01280000
012900                                                                  01290000
013000*----------------------------------------------------------------*01300000
013100*                                                                *01310000
013200*----------------------------------------------------------------*01320000
013300 01  SOCKET-SELECT-ERR.                                           01330000
013400     05  FILLER                       PIC X(10)                   01340000
013500         VALUE ' SUKRF527-'.                                      01350000
013600     05  FILLER                       PIC X(14)                   01360000
013700         VALUE 'SOCKET SELECT-'.                                  01370000
013800     05  FILLER                       PIC X(7)                    01380000
013900         VALUE '-RETCD='.                                         01390000
014000     05  SOCKET-RETCODE               PIC 9(10)-.                 01400000
014100     05  FILLER                       PIC X(2) VALUE SPACES.      01410000
014200     05  SOCKET-ERRNO                 PIC 9(8).                   01420000
014300     05  FILLER                       PIC X(2) VALUE SPACES.      01430000
014400     05  SOCKET-RECEIVER              PIC 9(8).                   01440000
014500     05  FILLER                       PIC X(1) VALUE '-'.         01450000
014600     05  SOCKET-SEQ                   PIC 9(3).                   01460000
014700     05  FILLER                       PIC X(1) VALUE '-'.         01470000
014800     05  SOCKET-LINE                  PIC 9(4).                   01480000
014900     05  FILLER                       PIC X(1) VALUE '-'.         01490000
015000     05  SOCKET-DESCR                 PIC X(20).                  01500000
015100                                                                  01510000
015200*----------------------------------------------------------------*01520000
015300*                                                                *01530000
015400*----------------------------------------------------------------*01540000
015500 01  ERROR-DETAILS.                                               01550000
015600     05  FILLER                   PIC X(12)  VALUE ' SUKRF527-'.  01560000
015610     05  ERR-MSG-OPER             PIC 9(04).                      01561014
015620     05  FILLER                   PIC X(01)  VALUE ' '.           01562014
015700     05  FILLER                   PIC X(05)  VALUE 'PRTR-'.       01570000
015800     05  ERR-MSG-PRINTER          PIC X(03).                      01580000
015900     05  FILLER                   PIC X(01)  VALUE ' '.           01590000
016200     05  ERR-MSG-PO               PIC 9(09).                      01620000
016300     05  FILLER                   PIC X(01)  VALUE '-'.           01630000
016400     05  ERR-MSG-RCVR             PIC 9(04).                      01640000
016500     05  FILLER                   PIC X(07)  VALUE '  TRIP-'.     01650000
016600     05  ERR-MSG-TRIP             PIC 9(09).                      01660000
016700     05  FILLER                   PIC X(06)  VALUE ' USER-'.      01670000
016800     05  ERR-MSG-USERID           PIC X(07).                      01680000
016900     05  FILLER                   PIC X(07)  VALUE ' BATCH-'.     01690000
017000     05  ERR-MSG-BATCH            PIC 9(04).                      01700000
017100                                                                  01710000
017200                                                                  01720000
017300                                                                  01730000
017400 01  TCP-BUF2.                                                    01740000
017500     05 TCP-BUF                          PIC  X(05)  VALUE SPACE. 01750000
017600     05 TCP-BUF-DATA                     PIC X(299)  VALUE SPACE. 01760000
017700                                                                  01770000
017800                                                                  01780000
017900*----------------------------------------------------------------*01790000
018000*  PROGRAM CONSTANTS                                             *01800000
018100*----------------------------------------------------------------*01810000
018200 01  PC-PROGRAM-CONSTANTS.                                        01820000
018300*    05  PC-COMMAREA-LENGTH          PIC S9(04)  VALUE +300 COMP. 01830005
018400     05  PV-COMMAREA-LENGTH          PIC S9(04)  VALUE +0         01840005
018500                                                       COMP SYNC. 01850005
018600     05  PV-RETRY-COUNTER            PIC S9(04)  VALUE ZERO       01860000
018700                                                    COMP SYNC.    01870000
018800     05  PC-MAX-RETRIES              PIC S9(03)  VALUE 3          01880000
018900                                               COMP-3.            01890000
019000     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE 'SUKRF527'.01900000
019100     05  PC-SU-PRT-DISPLAY           PIC  X(04)  VALUE 'S527'.    01910000
019200     05  PC-SU-CHECK-IN-PGM          PIC  X(08)  VALUE 'SUKRF502'.01920000
019300     05  PC-SU-LABEL-PRT-PGM         PIC  X(08)  VALUE 'SUKRF528'.01930000
019400     05  PC-PRTR-VALIDATION-PGM      PIC  X(08)  VALUE 'DPKCS060'.01940000
019500     05  PC-REPORT-PGM-1             PIC  X(08)  VALUE 'PCKCS126'.01950000
019600     05  PC-REPORT-PGM-2             PIC  X(08)  VALUE 'SUKRF527'.01960000
019700     05  PC-RANDOM-PGM               PIC  X(08)  VALUE 'DPKUT902'.01970000
019800                                                                  01980000
019900     05  PC-HEADER-LBL-APPL          PIC  X(03)  VALUE 'HDR'.     01990000
020000     05  PC-CARTON-LBL-APPL          PIC  X(03)  VALUE 'CRT'.     02000000
020100     05  PC-CHECK-IN-LBL-APPL        PIC  X(03)  VALUE 'CKN'.     02010000
020200     05  PC-PGYBK-LBL-APPL           PIC  X(03)  VALUE 'PBK'.     02020000
020300     05  PC-P2L-LBL-APPL             PIC  X(03)  VALUE 'P2L'.     02030000
020400     05  PC-SML-DC-LBL-APPL          PIC  X(03)  VALUE 'SMD'.     02040000
020500     05  PC-SML-STORE-LBL-APPL       PIC  X(03)  VALUE 'SMS'.     02050000
020600     05  PC-SHIP-DC-LBL-APPL         PIC  X(03)  VALUE 'SHD'.     02060000
020700     05  PC-SHIP-STORE-LBL-APPL      PIC  X(03)  VALUE 'SHS'.     02070000
020800     05  PC-USER-ID-LBL-APPL         PIC  X(03)  VALUE 'UID'.     02080000
020900     05  PC-SOCKET-INTERFACE         PIC  X(01)  VALUE 'S'.       02090000
021000     05  PC-FTP-INTERFACE            PIC  X(01)  VALUE 'F'.       02100000
021100     05  PC-CARTON                   PIC  X(20)  VALUE 'CARTON'.  02110000
021200     05  PC-CHECKIN-PRINT            PIC  X(20)  VALUE            02120000
021300         'CHECKIN PRINT       '.                                  02130000
021400                                                                  02140000
021500     05  PC-A                        PIC  X(01)  VALUE 'A'.       02150000
021600     05  PC-C                        PIC  X(01)  VALUE 'C'.       02160000
021700     05  PC-D                        PIC  X(01)  VALUE 'D'.       02170000
021800     05  PC-SPACE                    PIC  X(01)  VALUE ' '.       02180000
021900     05  PC-Q                        PIC  X(01)  VALUE 'Q'.       02190000
022000     05  PC-MGMX                     PIC  X(04)  VALUE 'MGMX'.    02200000
022100     05  PC-M                        PIC  X(01)  VALUE 'M'.       02210000
022200     05  PC-N                        PIC  X(01)  VALUE 'N'.       02220000
022300     05  PC-R                        PIC  X(01)  VALUE 'R'.       02230000
022400     05  PC-T                        PIC  X(01)  VALUE 'T'.       02240000
022500     05  PC-Y                        PIC  X(01)  VALUE 'Y'.       02250000
022600     05  PC-K                        PIC  X(01)  VALUE 'K'.       02260000
022700     05  PC-G                        PIC  X(01)  VALUE 'G'.       02270000
022800     05  PC-L                        PIC  X(01)  VALUE 'L'.       02280000
022900     05  PC-I                        PIC  X(01)  VALUE 'I'.       02290000
023000     05  PC-01                       PIC  X(02)  VALUE '01'.      02300000
023100     05  PC-OF                       PIC  X(04)  VALUE ' OF '.    02310000
023200     05  PC-90                       PIC  9(02)  VALUE  90.       02320000
023300     05  PC-FLAT                     PIC  X(09)  VALUE            02330000
023400                                                 'FLAT'.          02340000
023500*CLP 11/07/13 - START                                             02350000
023600     05  PC-RA                       PIC  X(02)  VALUE 'RA'.      02360000
023700     05  PC-QR                       PIC  X(02)  VALUE 'QR'.      02370000
023800*CLP 11/07/13 - END                                               02380000
023900     05  PC-0                        PIC  9(01)  VALUE  0.        02390000
024000     05  PC-1                        PIC  9(01)  VALUE  1.        02400000
024100     05  PC-2                        PIC  9(01)  VALUE  2.        02410000
024200     05  PC-3                        PIC  9(01)  VALUE  3.        02420000
024300*                                                                 02430000
024400                                                                  02440000
024500*LMM                                                              02450000
024600 01  PC-LABEL-TYPE.                                               02460000
024700     05  PC-CENTRAL-STOCK            PIC  X(01)  VALUE 'C'.       02470000
024800     05  PC-P2L                      PIC  X(01)  VALUE 'P'.       02480000
024900     05  PC-SML                      PIC  X(01)  VALUE 'S'.       02490000
025000                                                                  02500000
025100 01  PV-SAVE-FIELDS.                                              02510000
025200     05  PV-PREV-LABEL-TYPE          PIC  X(01)  VALUE SPACES.    02520000
025300     05  PV-PREV-INPK-CNVYB-IND      PIC  X(01)  VALUE SPACES.    02530000
025400     05  PV-PREV-AUDIT-CART-IND      PIC  X(01)  VALUE SPACES.    02540000
025500     05  PV-PREV-CART-ACTN-CDE       PIC  X(01)  VALUE SPACES.    02550000
025600     05  PV-PREV-DEST-OPER-UNT-ID    PIC  S9(4) COMP.             02560000
025700     05  PV-PREV-SKU-NBR             PIC  S9(8)V COMP-3.          02570000
025800*                                                                 02580000
025900     05  PV-PREV-PO-NBR              PIC  S9(9) COMP.             02590000
026000     05  PV-PREV-PO-LNE-NBR          PIC  S9(9) COMP.             02600000
026100     05  PV-PREV-PREPK-ID            PIC  S9(4) COMP.             02610000
026200     05  PV-PREV-OPER-UNT-ID         PIC  S9(4) COMP.             02620000
026300     05  PV-PREV-TRIP-ID             PIC  S9(9) COMP.             02630000
026400     05  PV-PREV-RCVR-SEQ-NBR        PIC  S9(9) COMP.             02640000
026500*                                                                 02650000
026600     05  PV-PREV-SULBXF-LBL-TYP-CDE  PIC  X(01)  VALUE SPACES.    02660000
026700*                                                                 02670000
026800     05  PV-TCP-EXP-LENGTH               PIC 9(08)   VALUE 05.    02680000
026900     05  PV-TCP-RET-LENGTH               PIC 9(08)   VALUE ZEROS. 02690000
027000     05  PV-TCP-REM-LENGTH               PIC 9(08)   VALUE ZEROS. 02700000
027100     05  PV-TCP-PRCSD-LENGTH             PIC 9(08)   VALUE ZEROS. 02710000
027200     05  PV-TCP-TOT-LENGTH               PIC 9(08)   VALUE ZEROS. 02720000
027300     05  PV-TCP-BUF                      PIC  X(05)  VALUE SPACES.02730000
027400     05  PV-DATE-CCYY-MM-DD              PIC  X(10)  VALUE SPACES.02740000
027500     05  PV-DATE-CCYY-MM-DD-R REDEFINES PV-DATE-CCYY-MM-DD.       02750000
027600         10  PV-DATE-CCYY-R.                                      02760000
027700             15  PV-DATE-CC-R            PIC  X(02).              02770000
027800             15  PV-DATE-YY-R            PIC  X(02).              02780000
027900         10  FILLER                      PIC  X(01).              02790000
028000         10  PV-DATE-MM-R                PIC  X(02).              02800000
028100         10  FILLER                      PIC  X(01).              02810000
028200         10  PV-DATE-DD-R                PIC  X(02).              02820000
028300     05  PV-ARVD-DATE                    PIC  X(08)  VALUE SPACES.02830000
028400     05  PV-ARVD-DATE-R REDEFINES PV-ARVD-DATE.                   02840000
028500         10  PV-ARVD-DATE-MM             PIC  X(02).              02850000
028600         10  PV-ARVD-DASH1               PIC  X(01).              02860000
028700         10  PV-ARVD-DATE-DD             PIC  X(02).              02870000
028800         10  PV-ARVD-DASH2               PIC  X(01).              02880000
028900         10  PV-ARVD-DATE-YY             PIC  X(02).              02890000
029000 01  PC-PROGRAM-MESSAGES.                                         02900000
029100     05  PC-END-OF-SESSION-MSG           PIC  X(19)  VALUE        02910000
029200         'END OF SESSION     '.                                   02920000
029300     05  PC-INVALID-SELECTION-MSG        PIC  X(19)  VALUE        02930000
029400         'INVALID SELECTION  '.                                   02940000
029500     05  PC-INVALID-VALUE-MSG            PIC  X(19)  VALUE        02950000
029600         'INVALID VALUE      '.                                   02960000
029700     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        02970000
029800         'UNRECOGNIZED PF KEY'.                                   02980000
029900     05  PC-ACCESS-NOT-ALLOWED-MSG       PIC  X(19)  VALUE        02990000
030000         'USER NOT AUTHORIZED'.                                   03000000
030100     05  PC-NON-NUMERIC-SELECTION-MSG    PIC  X(19)  VALUE        03010000
030200         'NUMERIC VALUE REQ. '.                                   03020000
030300     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        03030000
030400         'TRANS NOT AVAILABLE'.                                   03040000
030500     05  PC-CICS-ABEND-MSG               PIC  X(19)  VALUE        03050000
030600         'CICS ABEND -CALL DP'.                                   03060000
030700     05  PC-CICSAUTH-MSG                 PIC  X(19)  VALUE        03070000
030800         'CICSAUTH BAD RETURN'.                                   03080000
030900     05  PC-UNAVAIL-SELECTION-MSG        PIC X(19)   VALUE        03090000
031000         'SELECTION NOT AVAIL'.                                   03100000
031100     05  PC-INVALID-PRTR-ID              PIC X(19)   VALUE        03110000
031200         'INVALID PRINTER ID '.                                   03120000
031300     05  PC-MUST-BE-NUM-MSG              PIC X(19)   VALUE        03130000
031400         'MUST BE NUMERIC    '.                                   03140000
031500     05  PC-MUST-BE-GT-0-MSG             PIC X(19)   VALUE        03150000
031600         'MUST BE > ZERO     '.                                   03160000
031700     05  PC-INVALID-BATCH-NO             PIC X(19)   VALUE        03170000
031800         'INVALID BATCH NBR  '.                                   03180000
031900     05  PC-BATCH-NOT-FOUND              PIC X(19)   VALUE        03190000
032000         'BATCH NBR NOT FOUND'.                                   03200000
032100     05  PC-COMMUNICATION-ERROR          PIC X(19)   VALUE        03210000
032200         'COMMUNICATION ERROR'.                                   03220000
032300     05  PC-SOCKET-CALL-ERROR            PIC X(19)   VALUE        03230000
032400         'SOCKET CALL ERROR  '.                                   03240000
032500     05  PC-SOCKET-CONNECT-ERROR         PIC X(19)   VALUE        03250000
032600         'SOCKET CONNECT ERR '.                                   03260000
032700     05  PC-SOCKET-CLOSE-ERROR           PIC X(19)   VALUE        03270000
032800         'SOCKET CLOSE ERROR '.                                   03280000
032900     05  PC-SOCKET-SEND-ERROR            PIC X(19)   VALUE        03290000
033000         'SOCKET SEND ERROR  '.                                   03300000
033100     05  PC-SOCKET-RECEIVE-ERROR         PIC X(19)   VALUE        03310000
033200         'SOCKET RECEIVE ERR '.                                   03320000
033300     05  PC-BAD-TRANS-NMBR               PIC X(19)   VALUE        03330000
033400         'LPMS-TRANS NBR ERR '.                                   03340000
033500     05  PC-INVALID-PRTR-W-BTCH          PIC X(19)   VALUE        03350000
033600         'INVALID PRTR W/BTCH'.                                   03360000
033700     05  PC-LABELS-SUBMITTED             PIC X(19)   VALUE        03370000
033800         'LABELS SUBMITTED   '.                                   03380000
033900                                                                  03390000
034000                                                                  03400000
034100*----------------------------------------------------------------*03410000
034200 01  PC-LABEL-MESSAGES.                                           03420000
034300*----------------------------------------------------------------*03430000
034400     05  PC-DEFAULT-LABEL-MSG       PIC X(35) VALUE               03440000
034500                           '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'. 03450000
034600     05  PC-NOT-ATTACHED-RCVR-MSG   PIC X(35) VALUE               03460000
034700                           'CARTON NOT ATTACHED TO A RECEIVER  '. 03470000
034800     05  PC-NOT-FOUND-MSG           PIC X(35) VALUE               03480000
034900                           '*** NO ITEM INFO - DETAIL CHECK ***'. 03490000
035000     05  PC-FREE-ASTRY-NO-RCVR-MSG  PIC X(35) VALUE               03500000
035100                           '***FREE ASTY - CRTN NO RECEIVER ***'. 03510000
035200     05  PC-FREE-ASTRY-NO-TRIP-MSG  PIC X(35) VALUE               03520000
035300                           '***FREE ASTY - RCVR NO SCAC/TRLR***'. 03530000
035400     05  PC-DUPLICATE-SCAN-MSG      PIC X(35) VALUE               03540000
035500                           '** DUPLICATE SCAN - DETAIL CHECK **'. 03550000
035600     05  PC-DETAIL-CK-NEED-MSG      PIC X(35) VALUE               03560000
035700                           '* * * * DETAIL CHECK NEEDED * * * *'. 03570000
035800     05  PC-MISDIRECT-MSG          PIC X(35) VALUE                03580000
035900                           '* * *  M I S  -  D I R E C T * * * '. 03590000
036000     05  PC-INACT-PKSK-CRE-NEW-RCVR PIC X(35) VALUE               03600000
036100                           '** INACT PKSLP/CREATE NEW RCVR  ***'. 03610000
036200     05  PC-PKSLIP-CARTON-UNEQUAL   PIC X(35) VALUE               03620000
036300                           '** PACKSLIP/CARTON DATA UNEQUAL ***'. 03630000
036400     05  PC-CASEPK-NOT-DNLD-RECVR   PIC X(35) VALUE               03640000
036500                           '** CASEPACK NOT DNLD FOR RECVR *** '. 03650000
036600     05  PC-CASEPK-DNLD-PHYSCL      PIC X(35) VALUE               03660000
036700                           '** CASEPACK DNLD PHYSICAL LABELS***'. 03670000
036800     05  PC-FREE-ASTY-NEED-TRANS    PIC X(35) VALUE               03680000
036900                           '** FREE ASTY NEEDS TRANSCRIPTION***'. 03690000
037000     05  PC-HOLD-CRTN-TRIP-END      PIC X(35) VALUE               03700000
037100                           '** HOLD CARTON UNTIL TRLR EMPTY ***'. 03710000
037200     05  PC-UNUSABLE-128-NO-PKSLIP  PIC X(35) VALUE               03720000
037300                           '**** UNUSABLE UCC128 DATA     *****'. 03730000
037400     05  PC-TRANSC-CHECK-IN-RCVR    PIC X(35) VALUE               03740000
037500                           '** TRANSCRIBE CHECK IN RECEIVER ***'. 03750000
037600                                                                  03760000
037700                                                                  03770000
037800                                                                  03780000
037900 01  PS-PROGRAM-SWITCHES.                                         03790000
038000     05  PS-SOCKET-ERROR-SW              PIC  X(01)  VALUE 'N'.   03800000
038100         88  PS-SOCKET-ERROR                         VALUE 'Y'.   03810000
038200         88  PS-NO-SOCKET-ERROR                      VALUE 'N'.   03820000
038300     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   03830000
038400         88  PS-VALID-INPUT                          VALUE 'Y'.   03840000
038500         88  PS-INVALID-INPUT                        VALUE 'N'.   03850000
038600     05  PS-VALID-TRANS-ID-SW            PIC  X(01)  VALUE 'Y'.   03860000
038700         88  PS-VALID-TRANS-ID                       VALUE 'Y'.   03870000
038800         88  PS-INVALID-TRANS-ID                     VALUE 'N'.   03880000
038900     05  PS-VALID-PRINTER-SW             PIC  X(01)  VALUE 'Y'.   03890000
039000         88  PS-VALID-PRINTER-ID                     VALUE 'Y'.   03900000
039100         88  PS-INVALID-PRINTER-ID                   VALUE 'N'.   03910000
039200     05  PS-VALID-BATCH-NUMBER-SW        PIC  X(01)  VALUE 'Y'.   03920000
039300         88  PS-VALID-BATCH-NUMBER                   VALUE 'Y'.   03930000
039400         88  PS-INVALID-BATCH-NUMBER                 VALUE 'N'.   03940000
039500     05  PS-EOF-LBL-CURSOR-SW            PIC  X(01)  VALUE 'N'.   03950000
039600         88  PS-EOF-LBL-CURSOR                       VALUE 'Y'.   03960000
039700         88  PS-NOT-EOF-LBL-CURSOR                   VALUE 'N'.   03970000
039800     05  PS-REPRINT-BATCH-SW             PIC  X(01)  VALUE 'N'.   03980000
039900         88  PS-REPRINT-BATCH                        VALUE 'Y'.   03990000
040000         88  PS-NOT-REPRINT-BATCH                    VALUE 'N'.   04000000
040100     05  PS-REPRINT-FORM-SW              PIC  X(01)  VALUE 'N'.   04010000
040200         88  PS-REPRINT-FORM                         VALUE 'Y'.   04020000
040300         88  PS-NOT-REPRINT-FORM                     VALUE 'N'.   04030000
040400*LMM                                                              04040000
040500     05  PS-PREPK-FORM-SW                PIC  X(01)  VALUE 'N'.   04050000
040600         88  PS-PREPK-FORM                           VALUE 'Y'.   04060000
040700         88  PS-NOT-PREPK-FORM                       VALUE 'N'.   04070000
040800     05  PS-MSG-1-SW                     PIC  X(01)  VALUE 'N'.   04080000
040900         88  PS-NO-MSG-1                             VALUE 'N'.   04090000
041000         88  PS-YES-MSG-1                            VALUE 'Y'.   04100000
041100     05  PS-MSG-2-SW                     PIC  X(01)  VALUE 'N'.   04110000
041200         88  PS-NO-MSG-2                             VALUE 'N'.   04120000
041300         88  PS-YES-MSG-2                            VALUE 'Y'.   04130000
041400     05  PS-TRANS-ID-DUP-SW              PIC  X(01)  VALUE 'Y'.   04140000
041500         88  PS-TRANS-ID-NOT-DUP                     VALUE 'N'.   04150000
041600         88  PS-TRANS-ID-DUP                         VALUE 'Y'.   04160000
041700     05  PS-SULBXF-FOUND-SW              PIC  X(01)  VALUE 'N'.   04170000
041800         88  PS-SULBXF-NOT-FOUND                     VALUE 'N'.   04180000
041900         88  PS-SULBXF-FOUND                         VALUE 'Y'.   04190000
042000*                                                                 04200000
042100     05  PS-PART-RECEIVE-SW              PIC  X(01)  VALUE 'S'.   04210000
042200         88  PS-PART-RECEIVE                         VALUE 'P'.   04220000
042300         88  PS-COMP-RECEIVE                         VALUE 'C'.   04230000
042400         88  PS-ERROR-RECEIVE                        VALUE 'E'.   04240000
042500         88  PS-START-RECEIVE                        VALUE 'S'.   04250000
042600     05  PS-AUDIT-CRTN-FOUND-SW          PIC  X(01)  VALUE 'N'.   04260000
042700         88  PS-AUDIT-CRTN-FOUND-YES                 VALUE 'Y'.   04270000
042800         88  PS-AUDIT-CRTN-FOUND-NO                  VALUE 'N'.   04280000
042900*** 12/02/10 added dmh                                            04290000
043000     05  PS-HEADER-DIVIDER-PRINT-SW      PIC  X(01)  VALUE 'Y'.   04300000
043100         88  PS-HEADER-DIVIDER-PRINT-YES             VALUE 'Y'.   04310000
043200         88  PS-HEADER-DIVIDER-PRINT-NO              VALUE 'N'.   04320000
043300     05  PS-TRAILER-DIVIDER-PRINT-SW     PIC  X(01)  VALUE 'Y'.   04330000
043400         88  PS-TRAILER-DIVIDER-PRINT-YES            VALUE 'Y'.   04340000
043500         88  PS-TRAILER-DIVIDER-PRINT-NO             VALUE 'N'.   04350000
043600* WR41309-RF ID 8/30/2012  AME  BEGIN                             04360000
043700     05  PS-RF-ID-FOUND-SW               PIC  X(01)  VALUE 'Y'.   04370000
043800         88  PS-RF-ID-FOUND-YES                      VALUE 'Y'.   04380000
043900         88  PS-RF-ID-FOUND-NO                       VALUE 'N'.   04390000
044000* WR41309-RF ID 8/30/2012  AME  END                               04400000
044100                                                                  04410000
044200 01  PV-PROGRAM-VARIABLES.                                        04420000
044300     05  PV-NULL-IND                     PIC S9(4)   VALUE ZERO   04430000
044400                                                     COMP SYNC.   04440000
044500     05  PV-CICS-MSG-AREA-A.                                      04450000
044600         10  FILLER                      PIC  X(01)  VALUE SPACE. 04460000
044700         10  PV-CICS-MSG-AREA-B          PIC  X(80)  VALUE SPACE. 04470000
044800     05  PV-CICS-MSG-AREA-C.                                      04480000
044900         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 04490000
045000         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 04500000
045100         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 04510000
045200         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 04520000
045300     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACES.04530000
045400     05  PV-RETCODE                      PIC  9(08)- VALUE ZERO.  04540000
045500     05  PV-ERRNO                        PIC  9(08)- VALUE ZERO.  04550000
045600     05  PV-SOCK-ID                      PIC  9(04)  VALUE ZERO.  04560000
045700     05  PV-TCPLENG                      PIC  9(08)  VALUE ZERO.  04570000
045800     05  PV-FLAG                         PIC  9(08)  VALUE ZERO.  04580000
045900     05  PV-BLANKS                PIC  X(40)  VALUE SPACES.       04590000
046000*                                                                 04600000
046100     05  PV-OTBND-CRTN                   PIC  X(22)  VALUE SPACES.04610000
046200     05  PV-OTBND-CRTN-R   REDEFINES PV-OTBND-CRTN.               04620000
046300         10  PV-OTBND-SML                PIC  9(20).              04630000
046400         10  FILLER                      PIC  9(02).              04640000
046500     05  PV-OTBND-CRTN-SULBXF            PIC  X(22)  VALUE SPACES.04650000
046600     05  PV-OTBND-CRTN-SULBXF-R   REDEFINES PV-OTBND-CRTN-SULBXF. 04660000
046700         10  PV-OTBND-SML-SULBXF         PIC  9(20).              04670000
046800         10  FILLER                      PIC  9(02).              04680000
046900*LMM                                                              04690000
047000     05  PV-SHIPT-UNT-ID                 PIC  X(18)  VALUE SPACES.04700000
047100     05  PV-SHIPT-UNT-ID-R REDEFINES PV-SHIPT-UNT-ID.             04710000
047200         10  FILLER                      PIC  9(13).              04720000
047300         10  PV-LAST-FIVE-DIGITS         PIC  9(05).              04730000
047400     05  PV-SHIPT-UNT-ID-18              PIC  9(18)  VALUE ZEROES.04740000
047500*DMH                                                              04750000
047600     05  PV-SHIPT-UNT-ID-NUM             PIC  9(18)  VALUE ZEROES.04760000
047700     05  PV-SHIPT-UNT-ID-NUM-R REDEFINES PV-SHIPT-UNT-ID-NUM.     04770000
047800         10  FILLER                      PIC  9(13).              04780000
047900         10  PV-SHIPT-UNT-14-18          PIC  9(05).              04790000
048000*                                                                 04800000
048100     05  PV-PO-NBR                       PIC  X(09)  VALUE SPACES.04810000
048200     05  PV-PO-NBR-R REDEFINES PV-PO-NBR.                         04820000
048300         10  FILLER                      PIC  9(01).              04830000
048400         10  PV-PO-NBR-7POS              PIC  9(08).              04840000
048500*                                                                 04850000
048600     05  PV-RCVR-NBR                     PIC  X(09)  VALUE SPACES.04860000
048700     05  PV-RCVR-NBR-R REDEFINES PV-RCVR-NBR.                     04870000
048800         10  FILLER                      PIC  9(06).              04880000
048900         10  PV-RCVR-NBR-3POS            PIC  9(03).              04890000
049000*                                                                 04900000
049100     05  PV-LINE-NBR                     PIC  X(09)  VALUE SPACES.04910000
049200     05  PV-LINE-NBR-R REDEFINES PV-LINE-NBR.                     04920000
049300         10  FILLER                      PIC  9(06).              04930000
049400         10  PV-PO-LINE-NBR              PIC  9(03).              04940000
049500*                                                                 04950000
049600     05  PV-LINE-RATO                    PIC  9(04).              04960000
049700     05  PV-LINE-RATO-R REDEFINES PV-LINE-RATO.                   04970000
049800         10  FILLER                      PIC  X(01).              04980000
049900         10  PV-LINE-RATO-NBR            PIC  X(03).              04990000
050000*                                                                 05000000
050100     05  PV-INPK-QTY                     PIC  X(09)  VALUE SPACES.05010000
050200     05  PV-INPK-QTY-R REDEFINES PV-INPK-QTY.                     05020000
050300         10  FILLER                      PIC  9(05).              05030000
050400         10  PV-INPK-UNIT-QTY            PIC  9(04).              05040000
050500*                                                                 05050000
050600     05  PV-OTPK-QTY                     PIC  X(09)  VALUE SPACES.05060000
050700     05  PV-OTPK-QTY-R REDEFINES PV-OTPK-QTY.                     05070000
050800         10  FILLER                      PIC  9(05).              05080000
050900         10  PV-OTPK-UNIT-QTY            PIC  9(04).              05090000
051000*                                                                 05100000
051100     05  PV-PREPK-QTY                    PIC  X(04)  VALUE SPACES.05110000
051200     05  PV-PREPK-QTY-R REDEFINES PV-PREPK-QTY.                   05120000
051300         10  PV-PREPK-UNIT-QTY           PIC  9(04).              05130000
051400*                                                                 05140000
051500     05  PV-PO-ITM-UNITS-BC           PIC X(21) VALUE SPACES.     05150000
051600     05  PV-PO-ITM-UNITS-BC-R REDEFINES PV-PO-ITM-UNITS-BC.       05160000
051700         10  PV-BC-PO-NBR-BC          PIC 9(09).                  05170000
051800         10  PV-BC-ITEM-NBR-BC        PIC 9(08).                  05180000
051900         10  PV-BC-UNITS-BC           PIC 9(04).                  05190000
052000     05  PV-PO-ITM-UNITS-NBR          PIC X(23) VALUE SPACES.     05200000
052100     05  PV-PO-ITM-UNITS-NBR-R REDEFINES PV-PO-ITM-UNITS-NBR.     05210000
052200         10  PV-BC-PO-NBR             PIC 9(09).                  05220000
052300         10  FILLER                   PIC X(01).                  05230000
052400         10  PV-BC-ITEM-NBR           PIC 9(08).                  05240000
052500         10  FILLER                   PIC X(01).                  05250000
052600         10  PV-BC-UNITS              PIC 9(04).                  05260000
052700                                                                  05270000
052800     05  PV-STORE-NBR                    PIC  9(04)  VALUE ZEROES.05280000
052900                                                                  05290000
053000     05  PV-RANDOM-NUMBER                PIC  9(09)  VALUE ZEROES.05300000
053100     05  PV-RANDOM-NUMBER-R REDEFINES  PV-RANDOM-NUMBER.          05310000
053200         10  PV-RANDOM-1-8               PIC  9(08).              05320000
053300         10  FILLER                      PIC  9(01).              05330000
053400     05  PV-LPMS-TRANS-ID                PIC  9(08)  VALUE ZEROES.05340000
053500     05  PV-LPMS-XMIT-RETURN             PIC  X(01)  VALUE SPACES.05350000
053600                                                                  05360000
053700     05  PV-TRAILER-COUNT                PIC  9(07)  VALUE ZERO.  05370000
053800*                                                                 05380000
053900     05  PV-PACKS-IN-CARTON              PIC  9(04)  VALUE ZERO.  05390000
054000     05  PV-PACKS-IN-CARTON-X REDEFINES PV-PACKS-IN-CARTON        05400000
054100                                         PIC  X(04).              05410000
054200*                                                                 05420000
054300     05  PV-LABELS-PRINTED               PIC  9(04)  VALUE ZERO.  05430000
054400     05  PV-LABELS-PRINTED-X REDEFINES PV-LABELS-PRINTED          05440000
054500                                         PIC  X(04).              05450000
054600*                                                                 05460000
054700*EXAMPLE:  (055-31)12345678   (USED ON SML LABELS).               05470000
054800     05  PV-SML-SKU-NUMBER.                                       05480000
054900         10  FILLER                      PIC  X(01)  VALUE '('.   05490000
055000         10  PV-SML-DEPT1                PIC  X(03).              05500000
055100         10  FILLER                      PIC  X(01)  VALUE '-'.   05510000
055200         10  PV-SML-CLASS-NBR1           PIC  X(02).              05520000
055300         10  FILLER                      PIC  X(01)  VALUE ')'.   05530000
055400         10  PV-SML-SKU                  PIC  9(08).              05540000
055500                                                                  05550000
055600*EXAMPLE:  12345678           (USED ON P2L LABELS).               05560000
055700     05  PV-P2L-SKU-NUMBER.                                       05570000
055800         10  FILLER                      PIC  X(02)  VALUE SPACES.05580000
055900         10  PV-P2L-SKU                  PIC  9(08).              05590000
056000                                                                  05600000
056100*EXAMPLE:  313-59             (USED ON P2L LABELS).               05610000
056200     05  PV-P2L-DEPT-CLASS.                                       05620000
056300         10  PV-P2L-DEPT1                PIC  X(03).              05630000
056400         10  FILLER                      PIC  X(01)  VALUE '-'.   05640000
056500         10  PV-P2L-CLASS-NBR1           PIC  X(02).              05650000
056600                                                                  05660000
056700*EXAMPLE:  (055-31)183        (USED ON CS LABELS).                05670000
056800     05  PV-CS-SKU-NUMBER.                                        05680000
056900         10  FILLER                      PIC  X(01)  VALUE '('.   05690000
057000         10  PV-CS-DEPT                  PIC  X(03).              05700000
057100         10  FILLER                      PIC  X(01)  VALUE '-'.   05710000
057200         10  PV-CS-CLASS-NBR             PIC  X(02).              05720000
057300         10  FILLER                      PIC  X(01)  VALUE ')'.   05730000
057400         10  PV-CS-SKU                   PIC  9(08).              05740000
057500                                                                  05750000
057600*EXAMPLE:  05531183           (USED ON CS LABELS).                05760000
057700     05  PV-CS-SKU-NBR.                                           05770000
057800         10  PV-CS-SKU-ONLY              PIC  9(08).              05780000
057900*                                                                 05790000
058000     05  PV-PO-RCVR.                                              05800000
058100         10  PV-PO-NUMBER                PIC  9(08)  VALUE ZEROES.05810000
058200         10  FILLER                      PIC  X(01)  VALUE '-'.   05820000
058300         10  PV-PO-RECEIVER              PIC  9(03)  VALUE ZEROES.05830000
058400                                                                  05840000
058500     05  PV-BARCODE.                                              05850000
058600         10  PV-PO                       PIC S9(09)  COMP.        05860000
058700         10  PV-ITEM                     PIC S9(15)V COMP-3.      05870000
058800         10  PV-OUTERPACK                PIC S9(09)  COMP.        05880000
058900*                                                                 05890000
059000     05  PV-PACK.                                                 05900000
059100         10  PV-PACK-TEXT                PIC  X(05)               05910000
059200                                         VALUE 'PACK-'.           05920000
059300         10  PV-PREPK-ID                 PIC  9(4).               05930000
059400*        10  PV-PREPK-ID                 PIC  S9(4)  COMP.        05940000
059500*                                                                 05950000
059600     05  PV-PRINTER-HOLD.                                         05960000
059700         10  PV-PRINTER-1-3              PIC  9(03).              05970000
059800         10  FILLER                      PIC  X(05).              05980000
059900*                                                                 05990000
060000     05  PV-DSPLY-PRTR                   PIC  X(06)  VALUE SPACES.06000000
060100     05  PV-DSPLY-PRTR-R REDEFINES PV-DSPLY-PRTR.                 06010000
060200         10  PV-DSPLY-DC                 PIC  X(02).              06020000
060300         10  PV-DSPLY-DASH               PIC  X(01).              06030000
060400         10  PV-DSPLY-PRTR-ID            PIC  X(03).              06040000
060500*                                                                 06050000
060600     05  PV-DISPLAY-PRTR                 PIC  X(07)  VALUE SPACES.06060000
060700     05  PV-DISPLAY-PRTR-R REDEFINES PV-DISPLAY-PRTR.             06070000
060800         10  PV-DISPLAY-NUM              PIC  X(01).              06080000
060900         10  PV-DISPLAY-DC               PIC  X(02).              06090000
061000         10  PV-DISPLAY-DASH             PIC  X(01).              06100000
061100         10  PV-DISPLAY-PRTR-ID          PIC  X(03).              06110000
061200*                                                                 06120000
061300     05  PV-DISPLAY-SKU                  PIC  9(08) VALUE ZEROES. 06130000
061400     05  PV-PRINTER-ID                   PIC  X(03)  VALUE SPACES.06140000
061500*                                                                 06150000
061600*                                                                 06160000
061700     05  PV-BATCH-NUMBER-HOLD            PIC  X(04)  VALUE SPACES.06170000
061800*    05  PV-BATCH-NUMBER-HOLD-R REDEFINES PV-BATCH-NUMBER-HOLD.   06180000
061900*        10  FILLER                      PIC  X(01).              06190000
062000*        10  PV-BATCH-NUMBER-3-POS       PIC  X(03).              06200000
062100     05  PV-BATCH-NUMBER                 PIC  X(04)  VALUE SPACES.06210000
062200     05  PV-BATCH-NUMBER-R REDEFINES PV-BATCH-NUMBER.             06220000
062300         10  PV-BATCH-NUMBER-N           PIC  9(04).              06230000
062400*                                                                 06240000
062500*                                                                 06250000
062600     05  PV-DB2-COUNT                    PIC S9(09)  VALUE +0     06260000
062700                                                     COMP-3.      06270000
062800     05  PV-DB2-COUNT-AUDIT              PIC S9(09)  VALUE +0     06280000
062900                                                     COMP-3.      06290000
063000     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  06300000
063100                                                     COMP SYNC.   06310000
063200     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 06320000
063300     05  PV-DISPLAY-LPMS-TRAN            PIC  X(08)  VALUE SPACE. 06330000
063400     05  PV-DISPLAY-MANIFEST             PIC  X(09)  VALUE SPACE. 06340000
063500     05  PV-DISPLAY-BATCH-NO             PIC  9(04)  VALUE ZEROS. 06350000
063600     05  PV-DISPLAY-SOCK-ID              PIC  9(04)  VALUE ZEROS. 06360000
063700     05  PV-DISPLAY-FLAG                 PIC  9(08)  VALUE ZEROS. 06370000
063800     05  PV-DISPLAY-NBR-BYTES            PIC  9(08)  VALUE ZEROS. 06380000
063900     05  PV-DISPLAY-FAMILY               PIC  9(04)  VALUE ZEROS. 06390000
064000     05  PV-DISPLAY-PORT                 PIC  9(04)  VALUE ZEROS. 06400000
064100     05  PV-DISPLAY-IP-ADDR              PIC  9(08)  VALUE ZEROS. 06410000
064200     05  PV-DISPLAY-RETURN-CODE          PIC  9(08)  VALUE ZEROS. 06420000
064300     05  PV-DISPLAY-CURR-OPER            PIC  9(04)  VALUE ZEROS. 06430000
064400     05  PV-DISPLAY-EIBCALEN             PIC S9(04)  VALUE ZEROES.06440000
064500                                                                  06450000
064600     05  PV-DISPLAY-OPER                 PIC  9(04)  VALUE ZEROES.06460000
064700     05  PV-DISPLAY-TRIP                 PIC  9(09)  VALUE ZEROES.06470000
064800     05  PV-DISPLAY-BATCH                PIC  9(04)  VALUE ZEROES.06480000
064900     05  PV-DISPLAY-PO                   PIC  9(09)  VALUE ZEROES.06490000
065000     05  PV-DISPLAY-RCVR                 PIC  9(09)  VALUE ZEROES.06500000
065100     05  PV-DISPLAY-LINE                 PIC  9(09)  VALUE ZEROES.06510000
065200     05  PV-DISPLAY-DEST                 PIC  9(04)  VALUE ZEROES.06520000
065300     05  PV-DISPLAY-CRTN                 PIC  9(20)  VALUE ZEROES.06530000
065400     05  PV-DISPLAY-sscc                 PIC  9(20)  VALUE ZEROES.06540000
065500                                                                  06550000
065600     05  PV-IP-ADDRESS.                                           06560000
065700         10  PV-IP-ADDR-NUM1             PIC 9(03).               06570000
065800             88  PV-IP-ADDR-NUM1-VALID              VALUE 1 THRU  06580000
065900                                                          255.    06590000
066000         10  PV-IP-ADDR-DOT1             PIC X(01).               06600000
066100             88  PV-IP-ADDR-DOT1-VALID              VALUE '.'.    06610000
066200         10  PV-IP-ADDR-NUM2             PIC 9(03).               06620000
066300             88  PV-IP-ADDR-NUM2-VALID              VALUE 1 THRU  06630000
066400                                                          255.    06640000
066500         10  PV-IP-ADDR-DOT2             PIC X(01).               06650000
066600             88  PV-IP-ADDR-DOT2-VALID              VALUE '.'.    06660000
066700         10  PV-IP-ADDR-NUM3             PIC 9(03).               06670000
066800             88  PV-IP-ADDR-NUM3-VALID              VALUE 1 THRU  06680000
066900                                                          255.    06690000
067000         10  PV-IP-ADDR-DOT3             PIC X(01).               06700000
067100             88  PV-IP-ADDR-DOT3-VALID              VALUE '.'.    06710000
067200         10  PV-IP-ADDR-NUM4             PIC 9(03).               06720000
067300             88  PV-IP-ADDR-NUM4-VALID              VALUE 1 THRU  06730000
067400                                                          255.    06740000
067500                                                                  06750000
067600     05  PV-HEX-FIELD.                                            06760000
067700         10  PV-HEX-FIELD-1              PIC X(01).               06770000
067800         10  PV-HEX-FIELD-2              PIC X(01).               06780000
067900         10  PV-HEX-FIELD-3              PIC X(01).               06790000
068000         10  PV-HEX-FIELD-4              PIC X(01).               06800000
068100     05  PV-HEX-FIELD-NUMBER REDEFINES PV-HEX-FIELD               06810000
068200                                         PIC 9(08)  COMP.         06820000
068300     05  PV-HEX-NUMERIC                  PIC 9(04) BINARY.        06830000
068400     05  PV-HEX-CHAR REDEFINES PV-HEX-NUMERIC.                    06840000
068500         10  PV-HEX-CHAR-1               PIC X(01).               06850000
068600         10  PV-HEX-CHAR-2               PIC X(01).               06860000
068700                                                                  06870000
068800     05 PV-CURRENT-DB2-DATE              PIC X(10)   VALUE SPACES.06880000
068900     05 PV-CURRENT-DB2-DATE-R REDEFINES PV-CURRENT-DB2-DATE.      06890000
069000         10 PV-CURRENT-CCYY              PIC  9(04).              06900000
069100         10 FILLER                       PIC  X(01).              06910000
069200         10 PV-CURRENT-MM-DD             PIC  9(05).              06920000
069300                                                                  06930000
069400     05 PV-LBL-DATE                      PIC  X(08)  VALUE SPACES.06940000
069500     05 PV-LBL-DATE-R REDEFINES PV-LBL-DATE.                      06950000
069600        10  PV-LBL-DATE-MM               PIC  X(02).              06960000
069700        10  PV-LBL-DASH1                 PIC  X(01).              06970000
069800        10  PV-LBL-DATE-DD               PIC  X(02).              06980000
069900        10  PV-LBL-DASH2                 PIC  X(01).              06990000
070000        10  PV-LBL-DATE-YY               PIC  X(02).              07000000
070100                                                                  07010000
070200     05 PV-WORK-DB2-DATE                 PIC X(10)   VALUE SPACES.07020000
070300     05 PV-WORK-DB2-DATE-R    REDEFINES PV-WORK-DB2-DATE.         07030000
070400         10 PV-WORK-CC                   PIC  9(02).              07040000
070500         10 PV-WORK-YY                   PIC  9(02).              07050000
070600         10 FILLER                       PIC  X(01).              07060000
070700         10 PV-WORK-MM                   PIC  9(02).              07070000
070800         10 FILLER                       PIC  X(01).              07080000
070900         10 PV-WORK-DD                   PIC  9(02).              07090000
071000                                                                  07100000
071100     05 PV-CURRENT-DB2-TIME              PIC  X(08)  VALUE SPACES.07110000
071200     05 PV-CURRENT-DB2-TIME-R REDEFINES PV-CURRENT-DB2-TIME.      07120000
071300         10 PV-CURRENT-HR                PIC  9(02).              07130000
071400         10 FILLER                       PIC  X(01).              07140000
071500         10 PV-CURRENT-MN                PIC  9(02).              07150000
071600         10 FILLER                       PIC  X(01).              07160000
071700         10 PV-CURRENT-SC                PIC  9(02).              07170000
071800                                                                  07180000
071900     05 PV-CURRENT-TIME.                                          07190000
072000         10 PV-CURRENT-HOUR              PIC  9(02)  VALUE ZEROES.07200000
072100         10 FILLER                       PIC  X(01)  VALUE ':'.   07210000
072200         10 PV-CURRENT-MIN               PIC  9(02)  VALUE ZEROES.07220000
072300                                                                  07230000
072400     05  PV-MAX-USER-BATCH               PIC S9(04)  VALUE ZEROES 07240000
072500                                                     COMP.        07250000
072600     05  PV-LAST-BATCH-NUMBER            PIC S9(04)  VALUE ZEROES 07260000
072700                                                     COMP.        07270000
072800     05  PV-LAST-BATCH-NO                PIC  9(03)  VALUE ZEROES.07280000
072900                                                                  07290000
073000     05  PV-DISPLAY-DOWNLOAD.                                     07300000
073100         10  PV-DISPLAY-DOWNLOAD-1       PIC  X(80)  VALUE SPACE. 07310000
073200         10  PV-DISPLAY-DOWNLOAD-2       PIC  X(80)  VALUE SPACE. 07320000
073300         10  PV-DISPLAY-DOWNLOAD-3       PIC  X(80)  VALUE SPACE. 07330000
073400     05  PV-CICS-MESSAGE-AREA            PIC  X(80)  VALUE SPACES.07340000
073500     05  PV-DB2-LABEL-COUNT              PIC S9(09)  VALUE ZEROS  07350000
073600                                                     COMP-3.      07360000
073700     05  PV-DB2-REPRINT-LBL-CNT          PIC S9(09)  VALUE ZEROS  07370000
073800                                                     COMP-3.      07380000
073900     05  PV-DB2-EXCEPT-LBL-CNT           PIC S9(09)  VALUE ZEROS  07390000
074000                                                     COMP-3.      07400000
074100     05  PV-OWNER-SCAC-ID                PIC  X(04)  VALUE SPACES.07410000
074200     05  PV-VEH-NBR                      PIC  X(10)  VALUE SPACES.07420000
074300*CLP 06/20/2013 PR5148B START                                     07430000
074400     05  PV-PRC-MSG-CDE                  PIC  X(02)  VALUE SPACES.07440000
074500*CLP 06/20/2013 PR5148B END                                       07450000
074600     05  PV-DC-5-CHAR-ABBR               PIC  X(05)  VALUE SPACES.07460000
074700     05  PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.         07470000
074800         10  FILLER                      PIC  X(03).              07480000
074900         10  PV-2-DIGIT-DC-ABBR          PIC  X(02).              07490000
075000                                                                  07500000
075100     05  PV-PRINTER-FORMAT.                                       07510000
075200         10  FILLER                      PIC  X(01)  VALUE '#'.   07520000
075300         10  PV-DC-PRTD-AT               PIC  X(02)  VALUE SPACES.07530000
075400         10  FILLER                      PIC  X(01)  VALUE '-'.   07540000
075500         10  PV-PRTR-ID                  PIC  X(03)  VALUE SPACES.07550000
075600                                                                  07560000
075700     05  PV-DEPT-MAJ-CLASS-CONCAT        PIC  X(35)  VALUE SPACES.07570000
075800     05  PV-PROG-SHORT-NAME              PIC  X(35)  VALUE SPACES.07580000
075900                                                                  07590000
076000     05  PV-FIRST-STORE-RCPT.                                     07600000
076100         10 PV-FIRST-STORE-RCPT-TXT-1 PIC X(12) VALUE             07610000
076200                                       '@@@@NEW@@@@@'.            07620000
076300         10 PV-FIRST-STORE-RCPT-TXT-2 PIC X(12) VALUE             07630000
076400                                       '@@@@@TO@@@@@'.            07640000
076500         10 PV-FIRST-STORE-RCPT-TXT-3 PIC X(12) VALUE             07650000
076600                                       '@@@STORE@@@@'.            07660000
076700* 07/19/13 RLK BEG                                                07670000
076800     05  PV-22-DIGIT-BARCODE.                                     07680000
076900         10  PV-22-CRTN-TYPE-IND              PIC 9(01).          07690000
077000         10  PV-22-CRTN-DIVERT-CDE            PIC X(04).          07700000
077100         10  PV-22-CRTN-PO-NBR                PIC 9(08).          07710000
077200         10  PV-22-CTRN-RCVR-SEQ-NBR          PIC 9(02).          07720000
077300         10  PV-22-CRTN-PO-LNE-NBR            PIC 9(03).          07730000
077400         10  PV-22-CRTN-CART-NBR              PIC 9(04).          07740000
077500* 07/19/13 RLK END                                                07750000
077600* DISPLAY TCP BUFFER DATA                                         07760000
077700     05  PV-TCP-BUF-DATA-FORMAT.                                  07770000
077800         10  PV-TCP-BUF-DATA-FORMAT1     PIC  X(51)  VALUE SPACE. 07780000
077900         10  PV-TCP-BUF-DATA-FORMAT2     PIC  X(51)  VALUE SPACE. 07790000
078000     05  PV-2O-DIGIT-BARCODE.                                     07800000
078100         10  PV-20-SML-CONTAINER-CDE         PIC 9(02).           07810000
078200         10  PV-20-SML-PACKAGING-TYP         PIC 9(01).           07820000
078300         10  PV-20-SML-SOFTWARE-SRC          PIC 9(01).           07830000
078400         10  PV-20-SML-BC-DIVERT             PIC 9(05).           07840000
078500         10  PV-20-SML-BC-DC-ORIGIN          PIC 9(03).           07850000
078600         10  PV-20-SML-BC-MNFST-NBR          PIC 9(08).           07860000
078700                                                                  07870000
078800* WR41309-RF ID 8/30/2012  AME  BEGIN                             07880000
078900     05  PV-RFID-STORE-TXT-4     PIC X(12) VALUE '***@RFID@***'.  07890000
079000* WR41309-RF ID 8/30/2012  AME  END                               07900000
079100     05  PV-EAS-STORE-TXT-4      PIC X(12) VALUE '***@EAS@****'.  07910013
079200     05  PV-EAS-RF-STORE-TXT-4   PIC X(12) VALUE '*@EAS/RFID@*'.  07920013
079300                                                                  07930000
079400* DMH - 10/06/04 - BEGIN                                          07940000
079500* add select parameter before recv socket command to determine if 07950000
079600* is still active                                                 07960000
079700*                                                                 07970000
079800 01  SELECT-PARMS.                                                07980000
079900     02  SELECT-NUMFDS          PIC 9(8) COMP VALUE 2.            07990000
080000     02  SELECT-TIMEOUT.                                          08000000
080100         03  SELECT-SECS        PIC 9(8) COMP VALUE 05.           08010000
080200         03  SELECT-MILLSECS    PIC 9(8) COMP VALUE 0.            08020000
080300     02  SELECT-RD-MASK         PIC X(16).                        08030000
080400     02  SELECT-WR-MASK         PIC X(16).                        08040000
080500     02  SELECT-EX-MASK         PIC X(16).                        08050000
080600     02  SELECT-RR-MASK         PIC X(16).                        08060000
080700     02  SELECT-RW-MASK         PIC X(16).                        08070000
080800     02  SELECT-RE-MASK         PIC X(16).                        08080000
080900                                                                  08090000
081000 01  CHAR-MASK.                                                   08100000
081100     02 CHAR-STRING             PIC  X(100).                      08110000
081200                                                                  08120000
081300 01  CHAR-ARRAY REDEFINES CHAR-MASK.                              08130000
081400     02  CHAR-ENTRY-TABLE OCCURS 100 TIMES.                       08140000
081500       03  CHAR-ENTRY         PIC  X.                             08150000
081600                                                                  08160000
081700 01  BIT-MASK.                                                    08170000
081800     02  BIT-ARRAY            PIC  X(16).                         08180000
081900                                                                  08190000
082000 01  BIT-FUNCTION-CODES.                                          08200000
082100     02  CTOB                 PIC  X(4) VALUE 'CTOB'.             08210000
082200     02  BTOC                 PIC  X(4) VALUE 'BTOC'.             08220000
082300                                                                  08230000
082400 01  BIT-MASK-LENGTH          PIC  9(8) COMP VALUE 100.           08240000
082500                                                                  08250000
082600 01  BITMASK-TOKEN            PIC X(16) VALUE 'TCPIPBITMASKCOBL'. 08260000
082700 01  SOCKETS                  PIC  9(8) COMP VALUE 100.           08270000
082800 01  SOCKNO                   PIC S9(8) BINARY.                   08280000
082900 01  EZRETC                   PIC S9(8) COMP.                     08290000
083000*                                                                 08300000
083100* DMH - 10/06/04 - END                                            08310000
083200*                                                                 08320000
083300                                                                  08330000
083400                                                                  08340000
083500 01  PT-TCP-RECEIVE-TABLE.                                        08350000
083600     05  PT-TCP-RECEIVE OCCURS 5 TIMES                            08360000
083700                        INDEXED BY PT-RECEIVE-IDX.                08370000
083800         10  PT-TCP-RECEIVE-CHAR         PIC X(01).               08380000
083900                                                                  08390000
084000 01  PT-TCP-ASSEMBLE-TABLE.                                       08400000
084100     05  PT-TCP-DATA-ASSEMBLE OCCURS 5  TIMES                     08410000
084200                              INDEXED BY PT-ASSEMBLE-IDX.         08420000
084300         10  PT-TCP-DATA-CHAR            PIC X(01).               08430000
084400/                                                                 08440000
084500*----------------------------------------------------------------*08450000
084600*  RANDOM NUMBER AREA                                            *08460000
084700*----------------------------------------------------------------*08470000
084800     COPY DPWS902.                                                08480000
084900                                                                  08490000
085000*----------------------------------------------------------------*08500000
085100*  RECORD LAYOUTS FOR LABEL PRINT MGMT SYSTEM (LPMS)             *08510000
085200*----------------------------------------------------------------*08520000
085300     COPY PCWS133.                                                08530000
085400                                                                  08540000
085500*----------------------------------------------------------------*08550000
085600*  BATCH LABEL - LABEL HEADER                                    *08560000
085700*----------------------------------------------------------------*08570000
085800     COPY PCWS134.                                                08580000
085900                                                                  08590000
086000*----------------------------------------------------------------*08600000
086100*  BATCH LABEL - SML LABEL FORM                                  *08610000
086200*----------------------------------------------------------------*08620000
086300     COPY PCWS255.                                                08630000
086400                                                                  08640000
086500*----------------------------------------------------------------*08650000
086600*  BATCH LABEL - SML LABEL DATA                                  *08660000
086700*----------------------------------------------------------------*08670000
086800     COPY PCWS256.                                                08680000
086900                                                                  08690000
087000* 07/19/13 RLK BEG                                                08700000
087100*----------------------------------------------------------------*08710000
087200*  BATCH LABEL - RFID CARTON LABEL (FORM AND DATA)               *08720000
087300*----------------------------------------------------------------*08730000
087400     COPY PCWS266.                                                08740000
087500* 07/19/13 RLK END                                                08750000
087600                                                                  08760000
087700*----------------------------------------------------------------*08770000
087800*  BATCH LABEL - LABEL TRAILER                                   *08780000
087900*----------------------------------------------------------------*08790000
088000     COPY PCWS137.                                                08800000
088100                                                                  08810000
088200*LMM                                                              08820000
088300*----------------------------------------------------------------*08830000
088400*  DEST LABEL - P2L LABEL                                        *08840000
088500*----------------------------------------------------------------*08850000
088600     COPY PCWS169.                                                08860000
088700                                                                  08870000
088800*----------------------------------------------------------------*08880000
088900*  BATCH LABEL - CS LABEL FORM                                   *08890000
089000*----------------------------------------------------------------*08900000
089100     COPY PCWS205.                                                08910000
089200                                                                  08920000
089300*----------------------------------------------------------------*08930000
089400*  BATCH LABEL - CS LABEL DATA                                   *08940000
089500*----------------------------------------------------------------*08950000
089600     COPY PCWS189.                                                08960000
089700                                                                  08970000
089800*----------------------------------------------------------------*08980000
089900*  BATCH LABEL - MESSAGE   LABEL FORM                            *08990000
090000*----------------------------------------------------------------*09000000
090100     COPY PCWS178.                                                09010000
090200                                                                  09020000
090300*----------------------------------------------------------------*09030000
090400*  BATCH LABEL - MESSAGE LABEL DATA                              *09040000
090500*----------------------------------------------------------------*09050000
090600     COPY PCWS179.                                                09060000
090700                                                                  09070000
090800*----------------------------------------------------------------*09080000
090900*  BARCODE COPYBOOK                                              *09090000
091000*----------------------------------------------------------------*09100000
091100     COPY PCWS160.                                                09110000
091200                                                                  09120000
091300*----------------------------------------------------------------*09130000
091400*  LABEL PRINT MANAGEMENT SYSTEM - 'EZASOKET' ERROR MESSAGES     *09140000
091500*----------------------------------------------------------------*09150000
091600     COPY PCWS138.                                                09160000
091700                                                                  09170000
091800*----------------------------------------------------------------*09180000
091900*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               09190000
092000*----------------------------------------------------------------*09200000
092100     COPY DPWS013.                                                09210000
092200                                                                  09220000
092300*----------------------------------------------------------------*09230000
092400*  SENDING/RECEIVING AREA FOR THE                                *09240000
092500*  PRINTER VALIDATION ROUTING (DPKCS060)                         *09250000
092600*----------------------------------------------------------------*09260000
092700     COPY DPWS072.                                                09270000
092800                                                                  09280000
092900******************************************************************09290000
093000*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        09300000
093100******************************************************************09310000
093200*    COPY DPWS008.                                                09320000
093300*                                                                 09330000
093400******************************************************************09340000
093500*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 09350000
093600******************************************************************09360000
093700     COPY DPWS010I.                                               09370000
093800                                                                  09380000
093900******************************************************************09390000
094000*  GENERATED DSECT FOR THE SUKM527 MAPSET                         09400000
094100******************************************************************09410000
094200     COPY SUKM527.                                                09420000
094300                                                                  09430000
094400******************************************************************09440000
094500*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   09450000
094600******************************************************************09460000
094700     COPY DPWS015.                                                09470000
094800                                                                  09480000
094900*----------------------------------------------------------------*09490000
095000* HELP SCREEN COMMAREA                                            09500000
095100     COPY PCWS192.                                                09510000
095200*----------------------------------------------------------------*09520000
095300* HELP SCREEN WORK AREA                                           09530000
095400     COPY PCWS188.                                                09540000
095500                                                                  09550000
095600******************************************************************09560000
095700*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      09570000
095800******************************************************************09580000
095900     COPY DFHAID.                                                 09590000
096000                                                                  09600000
096100*----------------------------------------------------------------*09610000
096200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL PRINT DATA  *09620000
096300*  TABLE                                                         *09630000
096400*----------------------------------------------------------------*09640000
096500     EXEC SQL                                                     09650000
096600         INCLUDE TLBPTDA                                          09660000
096700     END-EXEC.                                                    09670000
096800                                                                  09680000
096900*----------------------------------------------------------------*09690000
097000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL TRANSACTION *09700000
097100*  HISTORY TABLE                                                 *09710000
097200*----------------------------------------------------------------*09720000
097300     EXEC SQL                                                     09730000
097400         INCLUDE TLBTKHS                                          09740000
097500     END-EXEC.                                                    09750000
097600                                                                  09760000
097700*----------------------------------------------------------------*09770000
097800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL TRANSACTION *09780000
097900*  ID TABLE                                                      *09790000
098000*----------------------------------------------------------------*09800000
098100     EXEC SQL                                                     09810000
098200         INCLUDE TLBTKID                                          09820000
098300     END-EXEC.                                                    09830000
098400                                                                  09840000
098500*----------------------------------------------------------------*09850000
098600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CONTROL TABLE     *09860000
098700*----------------------------------------------------------------*09870000
098800     EXEC SQL                                                     09880000
098900         INCLUDE TCOCNTL                                          09890000
099000     END-EXEC.                                                    09900000
099100                                                                  09910000
099200*----------------------------------------------------------------*09920000
099300*  DCLGEN LAYOUT AND COBOL DECLARATION                           *09930000
099400*----------------------------------------------------------------*09940000
099500     EXEC SQL                                                     09950000
099600         INCLUDE TVHTRIP                                          09960000
099700     END-EXEC.                                                    09970000
099800                                                                  09980000
099900*----------------------------------------------------------------*09990000
100000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR LOGISTICS DOMAIN       10000000
100100*  LOCATION MASTER TABLE                                          10010000
100200*----------------------------------------------------------------*10020000
100300     EXEC SQL                                                     10030000
100400         INCLUDE XLT00010                                         10040000
100500     END-EXEC.                                                    10050000
100600                                                                  10060000
100700*----------------------------------------------------------------*10070000
100800*  DCLGEN LAYOUT AND COBOL DECLARATION                           *10080000
100900*----------------------------------------------------------------*10090000
101000     EXEC SQL                                                     10100000
101100         INCLUDE TSULBXF                                          10110000
101200     END-EXEC.                                                    10120000
101300                                                                  10130000
101400*----------------------------------------------------------------*10140000
101500*  DCLGEN LAYOUT AND COBOL DECLARATION                           *10150000
101600*----------------------------------------------------------------*10160000
101700     EXEC SQL                                                     10170000
101800         INCLUDE TKRPRPM                                          10180000
101900     END-EXEC.                                                    10190000
102000                                                                  10200000
102100*----------------------------------------------------------------*10210000
102200*  DCLGEN LAYOUT AND COBOL DECLARATION  SUT_PO_AUD_REQ           *10220000
102300*----------------------------------------------------------------*10230000
102400     EXEC SQL                                                     10240000
102500         INCLUDE SUT00015                                         10250000
102600     END-EXEC.                                                    10260000
102700                                                                  10270000
102800*----------------------------------------------------------------*10280000
102900*  DCLGEN LAYOUT AND COBOL DECLARATION  AUDIT PO TABLE           *10290000
103000*----------------------------------------------------------------*10300000
103100     EXEC SQL                                                     10310000
103200         INCLUDE TSUATRN                                          10320000
103300     END-EXEC.                                                    10330000
103400                                                                  10340000
103500* WR41309-RF ID 8/30/2012  AME  BEGIN                             10350000
103600*----------------------------------------------------------------*10360000
103700*  DCLGEN LAYOUT AND COBOL DECLARATION  PROCESS MESSAGE CONTROL  *10370000
103800*  TABLE, SUT_PRC_MSG_CNTL                                       *10380000
103900*----------------------------------------------------------------*10390000
104000     EXEC SQL                                                     10400000
104100         INCLUDE SUT00094                                         10410000
104200     END-EXEC.                                                    10420000
104300                                                                  10430000
104400*----------------------------------------------------------------*10440000
104500*  DCLGEN LAYOUT AND COBOL DECLARATION  RECEIVER TABLE           *10450000
104600*----------------------------------------------------------------*10460000
104700     EXEC SQL                                                     10470000
104800         INCLUDE TRECEIV                                          10480000
104900     END-EXEC.                                                    10490000
105000                                                                  10500000
105100*----------------------------------------------------------------*10510000
105200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PO TABLE           10520000
105300*----------------------------------------------------------------*10530000
105400     EXEC SQL                                                     10540000
105500         INCLUDE TPURCHS                                          10550000
105600     END-EXEC.                                                    10560000
105700                                                                  10570000
105800*----------------------------------------------------------------*10580000
105900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE MDSEAR TABLE       10590000
106000*----------------------------------------------------------------*10600000
106100     EXEC SQL                                                     10610000
106200         INCLUDE TMDSEAR                                          10620000
106300     END-EXEC.                                                    10630000
106400                                                                  10640000
106500*----------------------------------------------------------------*10650000
106600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE MDSEDP TABLE       10660000
106700*----------------------------------------------------------------*10670000
106800     EXEC SQL                                                     10680000
106900         INCLUDE TMDSEDP                                          10690000
107000     END-EXEC.                                                    10700000
107100                                                                  10710000
107200* WR41309-RF ID 8/30/2012  AME  end                               10720000
107300*-----------------------------------------------------------------10730000
107400* LABEL BATCH CURSOR - THIS CURSOR WILL RETRIEVE ALL THE LABEL    10740000
107500* INFORMATION FOR A GIVEN TRIP/USERID/BATCH #                     10750000
107600*-----------------------------------------------------------------10760000
107700     EXEC SQL                                                     10770000
107800          DECLARE  LABEL_CURSOR CURSOR WITH HOLD FOR              10780000
107900           SELECT  TRIP_ID                                        10790000
108000                  ,CRE_USR_ID                                     10800000
108100                  ,LBL_PRT_BTCH_ID                                10810000
108200                  ,SHIPT_UNT_ID                                   10820000
108300                  ,OPER_UNT_ID                                    10830000
108400                  ,FCLTY_ID                                       10840000
108500                  ,CRE_TMST                                       10850000
108600                  ,OWNR_SCAC_ID                                   10860000
108700                  ,VEH_NBR                                        10870000
108800                  ,RPRT_IND                                       10880000
108900                  ,SU_DUP_LBL_IND                                 10890000
109000                  ,SU_FRE_ASTRA_IND                               10900000
109100                  ,SU_MSSG_DAT_IND                                10910000
109200                  ,SU_MISDIR_IND                                  10920000
109300                  ,MISDIR_OPER_UNT_ID                             10930000
109400                  ,PO_NBR                                         10940000
109500                  ,RCVR_SEQ_NBR                                   10950000
109600                  ,PO_LNE_NBR                                     10960000
109700                  ,DEST_OPER_UNT_ID                               10970000
109800                  ,STR_NM                                         10980000
109900                  ,STR_ZN_ID                                      10990000
110000                  ,SKU_DEPT_NBR                                   11000000
110100                  ,SKU_CL_NBR                                     11010000
110200                  ,VS_NBR                                         11020000
110300                  ,OTPK_UNT_QTY                                   11030000
110400                  ,INPK_UNT_QTY                                   11040000
110500                  ,PRTR_ID                                        11050000
110600                  ,BRCDE_NBR                                      11060000
110700                  ,DC_PRTD_AT_CDE                                 11070000
110800                  ,INVLD_DAT_ERR_CDE                              11080000
110900                  ,PREPK_ID                                       11090000
111000                  ,PREPK_RATO_QTY                                 11100000
111100                  ,PREPK_UNT_QTY                                  11110000
111200                  ,CSE_PK_QTY                                     11120000
111300                  ,ODD_CART_IND                                   11130000
111400                  ,INPK_CNVYB_IND                                 11140000
111500                  ,LBL_TYP_LBL_SEQ_ID                             11150000
111600                  ,LBL_TYP_TOT_QTY                                11160000
111700                  ,MODU_DESC                                      11170000
111800                  ,ITM_NBR                                        11180000
111900                  ,DEPT_DESC                                      11190000
112000                  ,MAJ_CL_DESC                                    11200000
112100                  ,SEASET_NM                                      11210000
112200                  ,FIXT_ID                                        11220000
112300                  ,CART_LBL_TYP_CDE                               11230000
112400                  ,STRG_AREA_CDE                                  11240000
112500                  ,CART_ACTN_CDE                                  11250000
112600                  ,HNG_FOLD_SEQ_NBR                               11260000
112700                  ,BUS_AREA_ID                                    11270000
112800                  ,SKU_NBR                                        11280000
112900                  ,RTRIM(DEPT_DESC)||'/'||RTRIM(MAJ_CL_DESC)      11290000
113000                  ,EAS_TAG_IND                                    11300000
113100                  ,DOOR_ID                                        11310000
113200*DMH 07/01/2015 START                                             11320000
113300                  ,LBL_MSG_TXT                                    11330000
113400*DMH 07/01/2015 END                                               11340000
113500*CLP 06/20/2013 PR5148B START                                     11350000
113600                  ,PRC_MSG_CDE                                    11360000
113700*CLP 06/20/2013 PR5148B END                                       11370000
113800             FROM  TLBPTDA                                        11380000
113900            WHERE  TRIP_ID         = :SU001-MANIFEST              11390000
114000              AND  CRE_USR_ID      = :SU001-USER-ID-USE           11400000
114100              AND  LBL_PRT_BTCH_ID = :SU001-BATCH-NO-USE          11410000
114200            ORDER  BY CRE_TMST                                    11420000
114300     END-EXEC.                                                    11430000
114400                                                                  11440000
114500                                                                  11450000
114600*----------------------------------------------------------------*11460000
114700*  COMMUNICATIONS AREA FOR DB2                                   *11470000
114800*----------------------------------------------------------------*11480000
114900     EXEC SQL                                                     11490000
115000         INCLUDE SQLCA                                            11500000
115100     END-EXEC.                                                    11510000
115200                                                                  11520000
115300                                                                  11530000
115400******************************************************************11540000
115500 LINKAGE SECTION.                                                 11550000
115600******************************************************************11560000
115700*01  DFHCOMMAREA                         PIC  X(500).             11570000
115800 01  DFHCOMMAREA.                                                 11580000
115900     05  FILLER                       OCCURS 1 TO 4072 TIMES      11590000
116000                                      DEPENDING ON EIBCALEN.      11600000
116100         10  FILLER                   PIC X.                      11610000
116200                                                                  11620000
116300******************************************************************11630000
116400 PROCEDURE DIVISION.                                              11640000
116500******************************************************************11650000
116600 0000-PROGRAM-MAINLINE.                                           11660000
116700                                                                  11670000
116800     PERFORM 1000-CHECK-COMMAREA.                                 11680000
116900                                                                  11690000
117000     PERFORM 1100-GET-SOCKET-TIMEOUT.                             11700000
117100     PERFORM 1150-LBL-DIVIDER-PRINT.                              11710000
117200                                                                  11720000
117300     MOVE LOW-VALUES                 TO SU527AI.                  11730000
117400                                                                  11740000
117500     EVALUATE TRUE                                                11750000
117600         WHEN EIBCALEN = ZERO                                     11760000
117700              IF  SU001-LBL-PRT-AT-SCAN                           11770000
117800                  MOVE SU001-USER-ID         TO  SU001-USER-ID-USE11780000
117900                  MOVE SU001-PRINTER-ID-USE  TO  PV-PRINTER-HOLD  11790000
118000                  MOVE PV-PRINTER-1-3        TO  PV-PRINTER-ID    11800000
118100                  PERFORM 2245-VALIDATE-PRINTER-ID                11810000
118200                  IF  PS-VALID-INPUT                              11820000
118300                      PERFORM 3000-GET-LABEL-INFORMATION          11830000
118400                      SET  PS-INVALID-TRANS-ID  TO  TRUE          11840000
118500                      PERFORM 4370-CREATE-TRANS-ID                11850000
118600                              UNTIL PS-VALID-TRANS-ID             11860000
118700                      PERFORM 4000-LABEL-ROUTINE                  11870000
118800                  END-IF                                          11880000
118900              ELSE                                                11890000
119000                  PERFORM 3030-GET-LAST-BATCH                     11900000
119100*DMH              MOVE PV-LAST-BATCH-NO     TO  ALSTNOO           11910000
119200                  MOVE PV-LAST-BATCH-NUMBER TO  ALSTNOO           11920000
119300                  MOVE SU001-PRINTER-ID     TO  PV-PRINTER-HOLD   11930000
119400                  MOVE PV-PRINTER-1-3       TO  APRTIDO           11940000
119500                  MOVE SU001-BATCH-NUMBER   TO  ABATCHO           11950000
119600                  MOVE SU001-USER-ID        TO  AUSERO            11960000
119700                  SET SU001-PROCESS-SCREEN  TO  TRUE              11970000
119800                  PERFORM 8000-SEND-MAP                           11980000
119900                  PERFORM 8200-RETURN-TRANID                      11990000
120000              END-IF                                              12000000
120100                                                                  12010000
120200****************************************************************  12020000
120300* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        12030000
120400****************************************************************  12040000
120500         WHEN EIBTRNID = 'Z278'                                   12050000
120600             MOVE DFHCOMMAREA          TO PC192-COMMAREA          12060000
120700             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             12070000
120800              PERFORM 3030-GET-LAST-BATCH                         12080000
120900*DMH          MOVE PV-LAST-BATCH-NO        TO  ALSTNOO            12090000
121000              MOVE PV-LAST-BATCH-NUMBER    TO  ALSTNOO            12100000
121100              MOVE -1                      TO  APRTIDL            12110000
121200              MOVE DP015-UNP-ALP-NOR-MDT   TO  APRTIDA            12120000
121300                                               ABATCHA            12130000
121400                                               AUSERA             12140000
121500              MOVE SU001-PRINTER-ID        TO  PV-PRINTER-HOLD    12150000
121600              MOVE PV-PRINTER-1-3          TO  APRTIDO            12160000
121700              MOVE SU001-BATCH-NUMBER      TO  ABATCHO            12170000
121800              MOVE SU001-USER-ID           TO  AUSERO             12180000
121900              MOVE SU001-USER-ID           TO  SU001-USER-ID-USE  12190000
122000              SET  SU001-PROCESS-SCREEN    TO  TRUE               12200000
122100             PERFORM 8000-SEND-MAP                                12210000
122200             PERFORM 8200-RETURN-TRANID                           12220000
122300                                                                  12230000
122400         WHEN EIBAID = DFHCLEAR                                   12240000
122500         WHEN SU001-INITIALIZE-SCREEN                             12250000
122600              PERFORM 3030-GET-LAST-BATCH                         12260000
122700              MOVE PV-LAST-BATCH-NUMBER    TO  ALSTNOO            12270000
122800              MOVE -1                      TO  APRTIDL            12280000
122900              MOVE DP015-UNP-ALP-NOR-MDT   TO  APRTIDA            12290000
123000                                               ABATCHA            12300000
123100                                               AUSERA             12310000
123200              MOVE SU001-PRINTER-ID        TO  PV-PRINTER-HOLD    12320000
123300              MOVE PV-PRINTER-1-3          TO  APRTIDO            12330000
123400              MOVE SU001-BATCH-NUMBER      TO  ABATCHO            12340000
123500              MOVE SU001-USER-ID           TO  AUSERO             12350000
123600              MOVE SU001-USER-ID           TO  SU001-USER-ID-USE  12360000
123700              SET  SU001-PROCESS-SCREEN    TO  TRUE               12370000
123800              PERFORM 8000-SEND-MAP                               12380000
123900              PERFORM 8200-RETURN-TRANID                          12390000
124000                                                                  12400000
124100         WHEN EIBAID = DFHPF3                                     12410000
124200             MOVE PC-SU-CHECK-IN-PGM TO PV-TRANSFER-PROGRAM       12420000
124300             PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                12430000
124400                                                                  12440000
124500         WHEN EIBAID = DFHPF4                                     12450000
124600             SET PS-VALID-INPUT  TO  TRUE                         12460000
124700             PERFORM 2000-PROCESS-SCREEN-FIELDS                   12470000
124800                                                                  12480000
124900             IF  PS-VALID-INPUT                                   12490000
125000                 IF  PS-VALID-INPUT                               12500000
125100                     PERFORM 3000-GET-LABEL-INFORMATION           12510000
125200                     SET  PS-INVALID-TRANS-ID  TO  TRUE           12520000
125300                     PERFORM 4370-CREATE-TRANS-ID                 12530000
125400                             UNTIL PS-VALID-TRANS-ID              12540000
125500                     PERFORM 4000-LABEL-ROUTINE                   12550000
125600                     IF  PS-SOCKET-ERROR                          12560000
125700                         PERFORM 8100-SEND-DATA-ONLY              12570000
125800                         PERFORM 8200-RETURN-TRANID               12580000
125900                     ELSE                                         12590000
126000                         MOVE PC-LABELS-SUBMITTED TO AMSGLNO      12600000
126100                         IF  SU001-BATCH-NO-USE =                 12610000
126200                             SU001-BATCH-NUMBER     AND           12620000
126300                             SU001-USER-ID-USE  =                 12630000
126400                             SU001-USER-ID                        12640000
126500                             ADD  1      TO SU001-BATCH-NUMBER    12650000
126600                             MOVE ZEROES TO SU001-ROWS-INSERTED   12660000
126700                         END-IF                                   12670000
126800*                                                                 12680000
126900                         MOVE SU001-PRINTER-ID-USE  TO APRTIDO    12690000
127000                         MOVE SU001-BATCH-NO-USE                  12700000
127100                           TO PV-BATCH-NUMBER-HOLD                12710000
127200*                        MOVE PV-BATCH-NUMBER-3-POS TO ABATCHO    12720000
127300                         MOVE PV-BATCH-NUMBER-HOLD  TO ABATCHO    12730000
127400                         MOVE SU001-USER-ID-USE     TO AUSERO     12740000
127500                         PERFORM 8000-SEND-MAP                    12750000
127600                         PERFORM 8200-RETURN-TRANID               12760000
127700                     END-IF                                       12770000
127800                 ELSE                                             12780000
127900                     PERFORM 8100-SEND-DATA-ONLY                  12790000
128000                     PERFORM 8200-RETURN-TRANID                   12800000
128100                 END-IF                                           12810000
128200             ELSE                                                 12820000
128300                 PERFORM 8100-SEND-DATA-ONLY                      12830000
128400                 PERFORM 8200-RETURN-TRANID                       12840000
128500             END-IF                                               12850000
128600                                                                  12860000
128700         WHEN EIBAID = DFHENTER                                   12870000
128800              PERFORM 8100-SEND-DATA-ONLY                         12880000
128900              PERFORM 8200-RETURN-TRANID                          12890000
129000                                                                  12900000
129100         WHEN EIBAID = DFHPF1                                     12910000
129200              PERFORM 1400-HELP-SCREEN                            12920000
129300                                                                  12930000
129400         WHEN OTHER                                               12940000
129500              MOVE PC-UNRECOGNIZED-PF-KEY-MSG                     12950000
129600                                     TO AMSGLNO                   12960000
129700              PERFORM 8100-SEND-DATA-ONLY                         12970000
129800              PERFORM 8200-RETURN-TRANID                          12980000
129900     END-EVALUATE.                                                12990000
130000                                                                  13000000
130100     GOBACK.                                                      13010000
130200                                                                  13020000
130300                                                                  13030000
130400******************************************************************13040000
130500** CHECK FOR A COMMAREA UPON ENTRANCE INTO A CICS PROGRAM         13050000
130600** PASSING CONTROL BETWEEN PROGRAMS IS DONE USING A               13060000
130700** 'START', HENCE THE NEED FOR THE 'RETRIEVE' COMMAND.            13070000
130800******************************************************************13080000
130900 1000-CHECK-COMMAREA.                                             13090000
131000                                                                  13100000
131100     IF  EIBCALEN = ZERO                                          13110000
131200         MOVE LENGTH OF CA-COMMAREA TO PV-COMMAREA-LENGTH         13120000
131300         EXEC CICS                                                13130000
131400             RETRIEVE                                             13140000
131500                 INTO   (CA-COMMAREA)                             13150000
131600                 LENGTH (PV-COMMAREA-LENGTH)                      13160000
131700                 RESP   (PV-CICS-RESPONSE)                        13170000
131800         END-EXEC                                                 13180000
131900     ELSE                                                         13190000
132000         MOVE DFHCOMMAREA            TO CA-COMMAREA               13200000
132100     END-IF.                                                      13210000
132200                                                                  13220000
132300                                                                  13230000
132400*----------------------------------------------------------------*13240000
132500* SELECT SOCKET TIMEOUT FROM PARAMETER DATABASE                  *13250000
132600* DMH - 10/06/04 - BEGIN                                          13260000
132700*----------------------------------------------------------------*13270000
132800 1100-GET-SOCKET-TIMEOUT.                                         13280000
132900                                                                  13290000
133000     EXEC SQL                                                     13300000
133100          SELECT  FUNC_QTY                                        13310000
133200            INTO :KRPRPM-FUNC-QTY                                 13320000
133300            FROM  tKRPRPM                                         13330000
133400           WHERE  LOC_ID            =  90                         13340000
133500             AND  SYS_PRC_FUNC_CDE  = 'SCKTM2'                    13350000
133600             AND  FUNC_PRC_STAT_CDE = 'AC'                        13360000
133700             AND  INTFC_SYS_CDE     = 'KHL'                       13370000
133710            with ur                                               13371014
133800     END-EXEC.                                                    13380000
133900                                                                  13390000
134000     EVALUATE TRUE                                                13400000
134100                                                                  13410000
134200         WHEN SQLCODE = +0                                        13420000
134300              MOVE KRPRPM-FUNC-QTY  TO  SELECT-SECS               13430000
134400                                                                  13440000
134500         WHEN SQLCODE = +100                                      13450000
134600              CONTINUE                                            13460000
134700                                                                  13470000
134800         WHEN SQLCODE = -811                                      13480000
134900         WHEN SQLCODE = -904                                      13490000
135000         WHEN SQLCODE = -913                                      13500000
135100             MOVE '1100-GET-SOCKET-TIMEOUT   '                    13510000
135200                             TO DP013-PARAGRAPH                   13520000
135300             MOVE 'SUKRF527 - GET SOCKET TIMEOUT VALUE'           13530000
135400                                   TO DP013-MESSAGE-TEXT(1)       13540000
135500             MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST         13550000
135600             STRING ' TRIP-'                                      13560000
135700                    PV-DISPLAY-MANIFEST                           13570000
135800                    ' USER ID-'                                   13580000
135900                    SU001-USER-ID                                 13590000
136000                    ' USER ID REQ-'                               13600000
136100                    SU001-USER-ID-USE                             13610000
136200                    ' BATCH NUMBER-'                              13620000
136300                    PV-BATCH-NUMBER-N     DELIMITED BY SIZE       13630000
136400                                 INTO DP013-MESSAGE-TEXT (2)      13640000
136500             MOVE SQLCA            TO DP013-SQLCA                 13650000
136600             MOVE 'TKRPRPM'        TO DP013-DB2-TABLE-NAME(1)     13660000
136700             SET DP013-DB2-ABEND             TO TRUE              13670000
136800             SET DP013-NO-ROLLBACK           TO TRUE              13680000
136900             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              13690000
137000             PERFORM DP014-0000-PROCESS-ABEND                     13700000
137100         WHEN SQLWARN0 NOT = SPACES                               13710000
137200         WHEN SQLCODE < +0                                        13720000
137300         WHEN SQLCODE > +0                                        13730000
137400             MOVE '1100-GET-SOCKET-TIMEOUT   '                    13740000
137500                             TO DP013-PARAGRAPH                   13750000
137600             MOVE 'SUKRF527 - GET SOCKET TIMEOUT VALUE'           13760000
137700                                   TO DP013-MESSAGE-TEXT(1)       13770000
137800             MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST         13780000
137900             STRING ' TRIP-'                                      13790000
138000                    PV-DISPLAY-MANIFEST                           13800000
138100                    ' USER ID-'                                   13810000
138200                    SU001-USER-ID                                 13820000
138300                    ' USER ID REQ-'                               13830000
138400                    SU001-USER-ID-USE                             13840000
138500                    ' BATCH NUMBER-'                              13850000
138600                    PV-BATCH-NUMBER-N     DELIMITED BY SIZE       13860000
138700                                 INTO DP013-MESSAGE-TEXT (2)      13870000
138800             MOVE SQLCA            TO DP013-SQLCA                 13880000
138900             MOVE 'TKRPRPM'        TO DP013-DB2-TABLE-NAME(1)     13890000
139000             SET DP013-DB2-ABEND             TO TRUE              13900000
139100             SET DP013-NO-ROLLBACK           TO TRUE              13910000
139200             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              13920000
139300             PERFORM DP014-0000-PROCESS-ABEND                     13930000
139400     END-EVALUATE.                                                13940000
139500* DMH - 10/06/04 - BEGIN                                          13950000
139600                                                                  13960000
139700                                                                  13970000
139800*----------------------------------------------------------------*13980000
139900* check to see if header/trailer labels should print             *13990000
140000* DMH - 12/02/10 - BEGIN                                          14000000
140100*----------------------------------------------------------------*14010000
140200 1150-LBL-DIVIDER-PRINT.                                          14020000
140300                                                                  14030000
140400     MOVE  SU001-OPER-UNT-ID   TO  KRPRPM-LOC-ID.                 14040000
140500                                                                  14050000
140600     EXEC SQL                                                     14060000
140700          SELECT  A.FUNC_TXT                                      14070000
140800               ,  B.FUNC_TXT                                      14080000
140900            INTO :PS-HEADER-DIVIDER-PRINT-SW                      14090000
141000               , :PS-TRAILER-DIVIDER-PRINT-SW                     14100000
141100            FROM  TKRPRPM A                                       14110000
141200               ,  TKRPRPM B                                       14120000
141300           WHERE  A.LOC_ID            = :KRPRPM-LOC-ID            14130000
141400             AND  A.SYS_PRC_FUNC_CDE  = 'CNKHDR'                  14140000
141500             AND  A.FUNC_PRC_STAT_CDE = 'AC'                      14150000
141600             AND  A.INTFC_SYS_CDE     = 'KHL'                     14160000
141700             AND  B.LOC_ID            = :KRPRPM-LOC-ID            14170000
141800             AND  B.SYS_PRC_FUNC_CDE  = 'CNKTRL'                  14180000
141900             AND  B.FUNC_PRC_STAT_CDE = 'AC'                      14190000
142000             AND  B.INTFC_SYS_CDE     = 'KHL'                     14200000
142010            with ur                                               14201014
142100     END-EXEC.                                                    14210000
142200                                                                  14220000
142300     EVALUATE TRUE                                                14230000
142400                                                                  14240000
142500         WHEN SQLCODE = +0                                        14250000
142600              CONTINUE                                            14260000
142700                                                                  14270000
142800         WHEN SQLCODE = +100                                      14280000
142900              SET  PS-HEADER-DIVIDER-PRINT-YES                    14290000
143000                   PS-TRAILER-DIVIDER-PRINT-YES TO TRUE           14300000
143100                                                                  14310000
143200         WHEN SQLCODE = -811                                      14320000
143300         WHEN SQLCODE = -904                                      14330000
143400         WHEN SQLCODE = -913                                      14340000
143500             MOVE '1150-LBL-DIVIDER-PRINT    '                    14350000
143600                             TO DP013-PARAGRAPH                   14360000
143700             MOVE 'SUKRF527 - CHECK IF HEADER/DIVERER PRINT'      14370000
143800                                   TO DP013-MESSAGE-TEXT(1)       14380000
143900             MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST         14390000
144000             STRING ' TRIP-'                                      14400000
144100                    PV-DISPLAY-MANIFEST                           14410000
144200                    ' USER ID-'                                   14420000
144300                    SU001-USER-ID                                 14430000
144400                    ' USER ID REQ-'                               14440000
144500                    SU001-USER-ID-USE                             14450000
144600                    ' BATCH NUMBER-'                              14460000
144700                    PV-BATCH-NUMBER-N     DELIMITED BY SIZE       14470000
144800                                 INTO DP013-MESSAGE-TEXT (2)      14480000
144900             MOVE SQLCA            TO DP013-SQLCA                 14490000
145000             MOVE 'TKRPRPM'        TO DP013-DB2-TABLE-NAME(1)     14500000
145100             SET DP013-DB2-ABEND             TO TRUE              14510000
145200             SET DP013-NO-ROLLBACK           TO TRUE              14520000
145300             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              14530000
145400             PERFORM DP014-0000-PROCESS-ABEND                     14540000
145500         WHEN SQLWARN0 NOT = SPACES                               14550000
145600         WHEN SQLCODE < +0                                        14560000
145700         WHEN SQLCODE > +0                                        14570000
145800             MOVE '1150-LBL-DIVIDER-PRINT    '                    14580000
145900                             TO DP013-PARAGRAPH                   14590000
146000             MOVE 'SUKRF527-CHECK PRINT HEADER/TRLR LABEL'        14600000
146100                                   TO DP013-MESSAGE-TEXT(1)       14610000
146200             MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST         14620000
146300             STRING ' TRIP-'                                      14630000
146400                    PV-DISPLAY-MANIFEST                           14640000
146500                    ' USER ID-'                                   14650000
146600                    SU001-USER-ID                                 14660000
146700                    ' USER ID REQ-'                               14670000
146800                    SU001-USER-ID-USE                             14680000
146900                    ' BATCH NUMBER-'                              14690000
147000                    PV-BATCH-NUMBER-N     DELIMITED BY SIZE       14700000
147100                                 INTO DP013-MESSAGE-TEXT (2)      14710000
147200             MOVE SQLCA            TO DP013-SQLCA                 14720000
147300             MOVE 'TKRPRPM'        TO DP013-DB2-TABLE-NAME(1)     14730000
147400             SET DP013-DB2-ABEND             TO TRUE              14740000
147500             SET DP013-NO-ROLLBACK           TO TRUE              14750000
147600             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              14760000
147700             PERFORM DP014-0000-PROCESS-ABEND                     14770000
147800     END-EVALUATE.                                                14780000
147900* DMH - 10/06/04 - BEGIN                                          14790000
148000                                                                  14800000
148100                                                                  14810000
148200*----------------------------------------------------------------*14820000
148300*                                                                *14830000
148400*----------------------------------------------------------------*14840000
148500 1400-HELP-SCREEN.                                                14850000
148600     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      14860000
148700     MOVE 'SUKRF527'                  TO PC192-PROGRAM-NAME       14870000
148800     COPY PCPD188.                                                14880000
148900     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      14890000
149000     PERFORM 3200-XCTL-TO-HELP.                                   14900000
149100                                                                  14910000
149200                                                                  14920000
149300 2000-PROCESS-SCREEN-FIELDS.                                      14930000
149400                                                                  14940000
149500     PERFORM 2100-RECEIVE-MAP.                                    14950000
149600     PERFORM 2200-EDIT-INPUT.                                     14960000
149700                                                                  14970000
149800                                                                  14980000
149900 2100-RECEIVE-MAP.                                                14990000
150000                                                                  15000000
150100     EXEC CICS                                                    15010000
150200         RECEIVE MAP    ('SU527A')                                15020000
150300                 MAPSET ('SUKM527')                               15030000
150400                 RESP   (PV-CICS-RESPONSE)                        15040000
150500     END-EXEC.                                                    15050000
150600                                                                  15060000
150700     EVALUATE TRUE                                                15070000
150800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15080000
150900             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   15090000
151000         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                15100000
151100             CONTINUE                                             15110000
151200         WHEN OTHER                                               15120000
151300            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       15130000
151400            MOVE 'SUKRF502 - UNABLE TO RECEIVE MAP'               15140000
151500                                         TO DP013-MESSAGE-TEXT (1)15150000
151600            SET DP013-LOGIC-ABEND        TO TRUE                  15160000
151700            SET DP013-NO-ROLLBACK        TO TRUE                  15170000
151800            PERFORM 9999-WRITE-CICS-LOG-MSG                       15180000
151900     END-EVALUATE.                                                15190000
152000                                                                  15200000
152100                                                                  15210000
152200 2110-RECEIVE-SCREEN-FIELDS.                                      15220000
152300                                                                  15230000
152400     IF  APRTIDL > ZERO                                           15240000
152500         MOVE APRTIDI TO PV-PRINTER-ID                            15250000
152600     ELSE                                                         15260000
152700         IF APRTIDA = DP015-ERASE-EOF                             15270000
152800             MOVE SPACES TO PV-PRINTER-ID                         15280000
152900         END-IF                                                   15290000
153000     END-IF.                                                      15300000
153100                                                                  15310000
153200     IF  ABATCHL > ZERO                                           15320000
153300         MOVE ABATCHI TO PV-BATCH-NUMBER                          15330000
153400     ELSE                                                         15340000
153500         IF ABATCHA = DP015-ERASE-EOF                             15350000
153600             MOVE SPACES TO PV-BATCH-NUMBER                       15360000
153700         END-IF                                                   15370000
153800     END-IF.                                                      15380000
153900                                                                  15390000
154000     IF  AUSERL > ZERO                                            15400000
154100         MOVE AUSERI TO SU001-USER-ID-USE                         15410000
154200     ELSE                                                         15420000
154300         IF AUSERA = DP015-ERASE-EOF                              15430000
154400             MOVE SU001-USER-ID  TO  SU001-USER-ID-USE            15440000
154500         END-IF                                                   15450000
154600     END-IF.                                                      15460000
154700                                                                  15470000
154800                                                                  15480000
154900 2150-GET-ZONE-DESC-FOR-CL.                                       15490000
155000                                                                  15500000
155100                                                                  15510000
155200         EXEC SQL                                                 15520000
155300              SELECT C.STR_ZN_ID                                  15530000
155400              INTO   :MDSEDP-STR-ZN-ID                            15540000
155500              FROM   TPURCHS A,                                   15550000
155600                     TMDSEAR B,                                   15560000
155700                     TMDSEDP C                                    15570000
155800              WHERE  A.PO_NBR   = :PURCHS-PO-NBR                  15580000
155900                AND  A.VER_STATUS_CDE = 'A'                       15590000
156000                AND  A.DEPT_NBR = B.DEPT_NBR                      15600000
156100                AND  B.MDSELV_CDE = 'DPT'                         15610000
156200                AND  B.OPERCO_NBR = '03'                          15620000
156300                AND (B.STRT_DTE <= CURRENT DATE AND               15630000
156400                     B.END_DTE > CURRENT DATE)                    15640000
156500                AND  B.MDSEAR_DKEY = C.MDSEAR_DKEY                15650000
156510               with ur                                            15651014
156600         END-EXEC                                                 15660000
156700                                                                  15670000
156800     EVALUATE TRUE                                                15680000
156900         WHEN SQLCODE = ZERO                                      15690000
157000             CONTINUE                                             15700000
157100         WHEN SQLCODE = +100                                      15710000
157200             MOVE SPACES TO MDSEDP-STR-ZN-ID                      15720000
157300         WHEN SQLWARN0 NOT = SPACES                               15730000
157400         WHEN SQLCODE NOT EQUAL ZERO                              15740000
157500             MOVE '2150-GET-ZONE-DESC-FOR-CL'                     15750000
157600                             TO DP013-PARAGRAPH                   15760000
157700             MOVE 'SUKRF527 - look up store zone'                 15770000
157800                             TO DP013-MESSAGE-TEXT(1)             15780000
157900             SET DP013-DB2-ABEND                                  15790000
158000                             TO TRUE                              15800000
158100             SET DP013-NO-ROLLBACK                                15810000
158200                             TO TRUE                              15820000
158300             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              15830000
158400             PERFORM DP014-0000-PROCESS-ABEND                     15840000
158500     END-EVALUATE.                                                15850000
158600                                                                  15860000
158700 2200-EDIT-INPUT.                                                 15870000
158800                                                                  15880000
158900     PERFORM 2210-INIT-ATTR.                                      15890000
159000     PERFORM 2230-EDIT-INPUT.                                     15900000
159100                                                                  15910000
159200                                                                  15920000
159300*----------------------------------------------------------------*15930000
159400* RESET INITIAL ATTRTIBUTES                                      *15940000
159500*----------------------------------------------------------------*15950000
159600 2210-INIT-ATTR.                                                  15960000
159700                                                                  15970000
159800     MOVE -1                         TO APRTIDL.                  15980000
159900     MOVE DP015-UNP-ALP-NOR-MDT      TO APRTIDA                   15990000
160000                                        ABATCHA                   16000000
160100                                        AUSERA.                   16010000
160200                                                                  16020000
160300     MOVE SU001-PRINTER-ID-USE       TO PV-PRINTER-HOLD.          16030000
160400     MOVE PV-PRINTER-1-3             TO APRTIDO.                  16040000
160500     MOVE SU001-BATCH-NO-USE         TO ABATCHO.                  16050000
160600     MOVE SU001-USER-ID-USE          TO AUSERO.                   16060000
160700     MOVE SPACES                     TO AMSGLNO.                  16070000
160800                                                                  16080000
160900                                                                  16090000
161000*----------------------------------------------------------------*16100000
161100* EDIT/VALIDATE DATA                                             *16110000
161200*----------------------------------------------------------------*16120000
161300 2230-EDIT-INPUT.                                                 16130000
161400                                                                  16140000
161500     PERFORM 2240-EDIT-PRINTER-ID.                                16150000
161600     PERFORM 2260-EDIT-BATCH-NBR.                                 16160000
161700                                                                  16170000
161800                                                                  16180000
161900*----------------------------------------------------------------*16190000
162000* VALIDATE PRINTER ID                                            *16200000
162100*----------------------------------------------------------------*16210000
162200 2240-EDIT-PRINTER-ID.                                            16220000
162300                                                                  16230000
162400     EVALUATE TRUE                                                16240000
162500         WHEN PV-PRINTER-ID = SPACES                              16250000
162600             SET PS-INVALID-INPUT        TO TRUE                  16260000
162700             MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA               16270000
162800             MOVE -1                     TO APRTIDL               16280000
162900             MOVE PC-INVALID-PRTR-ID     TO AMSGLNO               16290000
163000         WHEN OTHER                                               16300000
163100             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              16310000
163200             MOVE PV-PRINTER-ID  TO  DP010I-UNEDITED-FIELD        16320000
163300             MOVE 03             TO  DP010I-MAXIMUM-DIGITS        16330000
163400             MOVE 0              TO  DP010I-MAXIMUM-DECIMALS      16340000
163500                                                                  16350000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     16361016
263968                  USING DP010I-NUMERIC-EDIT-AREA                  16362016
163700                                                                  16370000
163800             IF  DP010I-ERROR-DETECTED                            16380000
163900                 SET PS-INVALID-INPUT        TO TRUE              16390000
164000                 MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA           16400000
164100                 MOVE -1                     TO APRTIDL           16410000
164200                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           16420000
164300             ELSE                                                 16430000
164400             IF  DP010I-NUMERIC-FIELD = ZEROES                    16440000
164500                 SET PS-INVALID-INPUT        TO TRUE              16450000
164600                 MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA           16460000
164700                 MOVE -1                     TO APRTIDL           16470000
164800                 MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO           16480000
164900             ELSE                                                 16490000
165000                 PERFORM 2245-VALIDATE-PRINTER-ID                 16500000
165100                 IF  PS-INVALID-PRINTER-ID                        16510000
165200                     SET PS-INVALID-INPUT TO TRUE                 16520000
165300                     MOVE DP015-UNP-NUM-BRT-MDT                   16530000
165400                                             TO APRTIDA           16540000
165500                     MOVE -1                 TO APRTIDL           16550000
165600                     MOVE PC-INVALID-PRTR-ID TO AMSGLNO           16560000
165700                 ELSE                                             16570000
165800                 IF  DP072-PRTR-INTFC-FTP                         16580000
165900                     SET PS-INVALID-INPUT        TO TRUE          16590000
166000                     MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA       16600000
166100                     MOVE -1                     TO APRTIDL       16610000
166200                     MOVE PC-INVALID-PRTR-W-BTCH TO AMSGLNO       16620000
166300                 ELSE                                             16630000
166400                     MOVE  PV-PRINTER-ID                          16640000
166500                           TO  SU001-PRINTER-ID-USE               16650000
166600                 END-IF                                           16660000
166700                 END-IF                                           16670000
166800             END-IF                                               16680000
166900             END-IF                                               16690000
167000     END-EVALUATE.                                                16700000
167100                                                                  16710000
167200                                                                  16720000
167300******************************************************************16730000
167400* VALIDATE PRINTER ID                                            *16740000
167500******************************************************************16750000
167600 2245-VALIDATE-PRINTER-ID.                                        16760000
167700                                                                  16770000
167800*** BEGIN - FOR TESTING ONLY                                      16780000
167900*    MOVE  SU001-CURR-OPER-UNT-ID  TO  PV-DISPLAY-CURR-OPER.      16790000
168000*    STRING ' SUKRF527 - '              DELIMITED BY SIZE         16800000
168100*           'SU001-CURR-OPER-UNT-ID-'   DELIMITED BY SIZE         16810000
168200*           PV-DISPLAY-CURR-OPER        DELIMITED BY SIZE         16820000
168300*           '  PRINTER-ID-'             DELIMITED BY SIZE         16830000
168400*           PV-PRINTER-ID               DELIMITED BY SIZE         16840000
168500*           '  SU001-PRINTER-ID-USE-'   DELIMITED BY SIZE         16850000
168600*           SU001-PRINTER-ID-USE        DELIMITED BY SIZE         16860000
168700*                                       INTO PV-CICS-MSG-AREA.    16870000
168800*    MOVE LENGTH OF PV-CICS-MSG-AREA                              16880000
168900*           TO PV-COMMAREA-LENGTH.                                16890000
169000*    PERFORM 9990-WRITE-CICS.                                     16900000
169100*** END - FOR TESTING ONLY                                        16910000
169200                                                                  16920000
169300     IF SU001-PRINT-AND-PEEL                                      16930000
169400        MOVE PC-REPORT-PGM-2        TO  DP072-RPT-PGM-NME         16940000
169500     ELSE                                                         16950000
169600        MOVE PC-REPORT-PGM-1        TO  DP072-RPT-PGM-NME         16960000
169700     END-IF                                                       16970000
169800                                                                  16980000
169900     MOVE PV-PRINTER-ID          TO  DP072-PRINTER-ID.            16990000
170000     MOVE PC-01                  TO  DP072-RPT-PGM-TYP-ID.        17000000
170100     MOVE SU001-CURR-OPER-UNT-ID TO  DP072-ORIGIN-OPER-UNT-ID.    17010000
170200     MOVE SU001-CURR-OPER-UNT-ID TO  DP072-OPER-UNT-ID.           17020000
170300     MOVE 1                      TO  DP072-ORIGIN-FCLTY-ID        17030000
170400                                     DP072-FCLTY-ID.              17040000
170500     SET DP072-VALIDATE          TO  TRUE.                        17050000
170600                                                                  17060000
170700     EXEC CICS                                                    17070000
170800          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  17080000
170900               COMMAREA (DP072-COMM-AREA)                         17090000
171000               RESP     (PV-CICS-RESPONSE)                        17100000
171100     END-EXEC                                                     17110000
171200                                                                  17120000
171300     EVALUATE TRUE                                                17130000
171400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17140000
171500              PERFORM 2250-VALIDATE-PRINTER-SML                   17150000
171600                                                                  17160000
171700         WHEN OTHER                                               17170000
171800             SET PS-INVALID-PRINTER-ID  TO  TRUE                  17180000
171900     END-EVALUATE.                                                17190000
172000                                                                  17200000
172100                                                                  17210000
172200******************************************************************17220000
172300*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *17230000
172400*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *17240000
172500*  CAN BE PRINTED ON THIS PRINTER.                               *17250000
172600******************************************************************17260000
172700 2250-VALIDATE-PRINTER-SML.                                       17270000
172800                                                                  17280000
172900     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX               17290000
173000         SET  PS-INVALID-PRINTER-ID   TO TRUE                     17300000
173100     END-IF.                                                      17310000
173200                                                                  17320000
173300     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  17330000
173400         CONTINUE                                                 17340000
173500     ELSE                                                         17350000
173600         SET  PS-INVALID-PRINTER-ID   TO TRUE                     17360000
173700     END-IF.                                                      17370000
173800                                                                  17380000
173900     MOVE  DP072-PRTR-IP-ADDRESS  TO  PV-IP-ADDRESS.              17390000
174000                                                                  17400000
174100                                                                  17410000
174200*----------------------------------------------------------------*17420000
174300* VALIDATE PRINTER ID                                            *17430000
174400*----------------------------------------------------------------*17440000
174500 2260-EDIT-BATCH-NBR.                                             17450000
174600                                                                  17460000
174700     EVALUATE TRUE                                                17470000
174800         WHEN PV-BATCH-NUMBER = SPACES                            17480000
174900             SET PS-INVALID-INPUT        TO TRUE                  17490000
175000             MOVE DP015-UNP-NUM-BRT-MDT  TO ABATCHA               17500000
175100             MOVE -1                     TO ABATCHL               17510000
175200             MOVE PC-INVALID-BATCH-NO    TO AMSGLNO               17520000
175300         WHEN OTHER                                               17530000
175400             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              17540000
175500             MOVE PV-BATCH-NUMBER  TO  DP010I-UNEDITED-FIELD      17550000
175600*DMH                                                              17560000
175700*            MOVE 03               TO  DP010I-MAXIMUM-DIGITS      17570000
175800             MOVE 04               TO  DP010I-MAXIMUM-DIGITS      17580000
175900             MOVE 0                TO  DP010I-MAXIMUM-DECIMALS    17590000
176000                                                                  17600000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     17611016
263968                  USING DP010I-NUMERIC-EDIT-AREA                  17612016
176200                                                                  17620000
176300             IF  DP010I-ERROR-DETECTED                            17630000
176400                 SET PS-INVALID-INPUT        TO TRUE              17640000
176500                 MOVE DP015-UNP-NUM-BRT-MDT  TO ABATCHA           17650000
176600                 MOVE -1                     TO ABATCHL           17660000
176700                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           17670000
176800             ELSE                                                 17680000
176900             IF  DP010I-NUMERIC-FIELD = ZEROES                    17690000
177000                 SET PS-INVALID-INPUT        TO TRUE              17700000
177100                 MOVE DP015-UNP-NUM-BRT-MDT  TO ABATCHA           17710000
177200                 MOVE -1                     TO ABATCHL           17720000
177300                 MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO           17730000
177400             ELSE                                                 17740000
177500                 MOVE  DP010I-NUMERIC-FIELD TO PV-BATCH-NUMBER-N  17750000
177600                 PERFORM 2265-VALIDATE-BATCH-NUMBER               17760000
177700                 IF  PS-INVALID-BATCH-NUMBER                      17770000
177800                     SET PS-INVALID-INPUT     TO TRUE             17780000
177900                     MOVE DP015-UNP-NUM-BRT-MDT                   17790000
178000                                              TO ABATCHA          17800000
178100                     MOVE -1                  TO ABATCHL          17810000
178200                     MOVE PC-BATCH-NOT-FOUND  TO AMSGLNO          17820000
178300                 ELSE                                             17830000
178400                     MOVE  PV-BATCH-NUMBER-N                      17840000
178500                           TO  SU001-BATCH-NO-USE                 17850000
178600                 END-IF                                           17860000
178700             END-IF                                               17870000
178800             END-IF                                               17880000
178900     END-EVALUATE.                                                17890000
179000                                                                  17900000
179100                                                                  17910000
179200*----------------------------------------------------------------*17920000
179300* VALIDATE PRINTER ID                                            *17930000
179400*----------------------------------------------------------------*17940000
179500 2265-VALIDATE-BATCH-NUMBER.                                      17950000
179600                                                                  17960000
179700     MOVE  SU001-MANIFEST     TO  DK-TRIP-ID.                     17970000
179800     MOVE  SU001-USER-ID-USE  TO  DK-USER-ID.                     17980000
179900     MOVE  PV-BATCH-NUMBER-N  TO  DK-BATCH-NUMBER.                17990000
180000                                                                  18000000
180100     EXEC SQL                                                     18010000
180200         SELECT COUNT(*)                                          18020000
180300         INTO   :PV-DB2-COUNT                                     18030000
180400         FROM   TLBPTDA                                           18040000
180500         WHERE  TRIP_ID          = :DK-TRIP-ID                    18050000
180600           AND  CRE_USR_ID       = :DK-USER-ID                    18060000
180700           AND  LBL_PRT_BTCH_ID  = :DK-BATCH-NUMBER               18070000
180710          with ur                                                 18071014
180800     END-EXEC.                                                    18080000
180900                                                                  18090000
181000     EVALUATE TRUE                                                18100000
181100         WHEN SQLCODE = ZERO                                      18110000
181200             IF  PV-DB2-COUNT  >  0                               18120000
181300                 SET PS-VALID-BATCH-NUMBER  TO  TRUE              18130000
181400             ELSE                                                 18140000
181500                 SET PS-INVALID-BATCH-NUMBER  TO  TRUE            18150000
181600             END-IF                                               18160000
181700                                                                  18170000
181800         WHEN SQLCODE = +100                                      18180000
181900             SET PS-INVALID-BATCH-NUMBER  TO  TRUE                18190000
182000                                                                  18200000
182100         WHEN SQLWARN0 NOT = SPACES                               18210000
182200         WHEN SQLCODE NOT EQUAL ZERO                              18220000
182300             MOVE '2265-VALIDATE-BATCH-NUMBER'                    18230000
182400                             TO DP013-PARAGRAPH                   18240000
182500             MOVE 'SUKRF527 - VALIDATE BATCH NUMBER'              18250000
182600                             TO DP013-MESSAGE-TEXT(1)             18260000
182700             MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST         18270000
182800             STRING ' TRIP-'              DELIMITED BY SIZE       18280000
182900                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       18290000
183000                    ' USER ID-'           DELIMITED BY SIZE       18300000
183100                    SU001-USER-ID         DELIMITED BY SIZE       18310000
183200                    ' USER ID REQ-'       DELIMITED BY SIZE       18320000
183300                    SU001-USER-ID-USE     DELIMITED BY SIZE       18330000
183400                    ' BATCH NUMBER-'      DELIMITED BY SIZE       18340000
183500                    PV-BATCH-NUMBER-N     DELIMITED BY SIZE       18350000
183600                             INTO DP013-MESSAGE-TEXT (2)          18360000
183700             MOVE SQLCA      TO DP013-SQLCA                       18370000
183800             MOVE 'TLBPTDA'  TO DP013-DB2-TABLE-NAME(1)           18380000
183900             SET DP013-DB2-ABEND                                  18390000
184000                             TO TRUE                              18400000
184100             SET DP013-NO-ROLLBACK                                18410000
184200                             TO TRUE                              18420000
184300             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              18430000
184400             PERFORM DP014-0000-PROCESS-ABEND                     18440000
184500     END-EVALUATE.                                                18450000
184600                                                                  18460000
184700                                                                  18470000
184800 2100-XCTL-TO-SELECTED-PROGRAM.                                   18480000
184900     SET SU001-INITIALIZE-SCREEN     TO TRUE.                     18490000
185000     MOVE PC-CURRENT-PROGRAM-NAME    TO SU001-LAST-PROGRAM.       18500000
185100                                                                  18510000
185200*LMM                                                              18520000
185300     MOVE LENGTH OF CA-COMMAREA     TO PV-COMMAREA-LENGTH         18530000
185400     EXEC CICS                                                    18540000
185500         XCTL                                                     18550000
185600             PROGRAM   (PV-TRANSFER-PROGRAM)                      18560000
185700             COMMAREA  (CA-COMMAREA)                              18570000
185800             LENGTH    (PV-COMMAREA-LENGTH)                       18580000
185900             RESP      (PV-CICS-RESPONSE)                         18590000
186000     END-EXEC.                                                    18600000
186100                                                                  18610000
186200     EVALUATE TRUE                                                18620000
186300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 18630000
186400              CONTINUE                                            18640000
186500         WHEN OTHER                                               18650000
186600              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                18660000
186700                                     TO DP013-PARAGRAPH           18670000
186800              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       18680000
186900                                     TO DP013-MESSAGE-TEXT (1)    18690000
187000              MOVE PV-TRANSFER-PROGRAM                            18700000
187100                                     TO DP013-MESSAGE-TEXT (2)    18710000
187200              SET DP013-CICS-ABEND   TO TRUE                      18720000
187300              SET DP013-NO-ROLLBACK  TO TRUE                      18730000
187400              PERFORM 9999-WRITE-CICS-LOG-MSG                     18740000
187500              MOVE PC-TRANS-UNAVAILABLE-MSG                       18750000
187600                                     TO AMSGLNO                   18760000
187700              SET SU001-PROCESS-SCREEN TO TRUE                    18770000
187800              PERFORM 8100-SEND-DATA-ONLY                         18780000
187900              PERFORM 8200-RETURN-TRANID                          18790000
188000     END-EVALUATE.                                                18800000
188100                                                                  18810000
188200                                                                  18820000
188300*----------------------------------------------------------------*18830000
188400* GET LABEL INFORMATION                                          *18840000
188500*----------------------------------------------------------------*18850000
188600 3000-GET-LABEL-INFORMATION.                                      18860000
188700     PERFORM 3005-DATE-TIME.                                      18870000
188800     PERFORM 3010-LABEL-COUNT.                                    18880000
188900     PERFORM 3015-REPRINT-COUNT.                                  18890000
189000     PERFORM 3020-SCAC-TRAILER.                                   18900000
189100     PERFORM 3025-EXCEPT-COUNT.                                   18910000
189200                                                                  18920000
189300                                                                  18930000
189400*----------------------------------------------------------------*18940000
189500* GET CURRENT DATE/TIME FROM CONTROL TABLE                       *18950000
189600*----------------------------------------------------------------*18960000
189700 3005-DATE-TIME.                                                  18970000
189800     EXEC SQL                                                     18980000
189900         SELECT  CURRENT DATE                                     18990000
190000               , CURRENT TIME                                     19000000
190100           INTO  :PV-CURRENT-DB2-DATE                             19010000
190200               , :PV-CURRENT-DB2-TIME                             19020000
190300           FROM  TCOCNTL                                          19030000
190400          WHERE  OPER_UNT_ID = 90                                 19040000
190410           with ur                                                19041014
190500     END-EXEC.                                                    19050000
190600                                                                  19060000
190700     EVALUATE TRUE                                                19070000
190800         WHEN SQLCODE = ZERO                                      19080000
190900              MOVE  PV-CURRENT-HR  TO  PV-CURRENT-HOUR            19090000
191000              MOVE  PV-CURRENT-MN  TO  PV-CURRENT-MIN             19100000
191100                                                                  19110000
191200         WHEN OTHER                                               19120000
191300              MOVE '3005-DATE-TIME '                              19130000
191400                                  TO DP013-PARAGRAPH              19140000
191500              MOVE 'GET CURRENT DATE/TIME '                       19150000
191600                                  TO DP013-MESSAGE-TEXT (1)       19160000
191700              MOVE SQLCA          TO DP013-SQLCA                  19170000
191800              MOVE 'TCOCNTL'      TO DP013-DB2-TABLE-NAME (1)     19180000
191900              SET DP013-DB2-ABEND TO TRUE                         19190000
192000*             PERFORM 9999-WRITE-CICS-LOG-MSG                     19200000
192100             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              19210000
192200              PERFORM DP014-0000-PROCESS-ABEND                    19220000
192300      END-EVALUATE.                                               19230000
192400                                                                  19240000
192500                                                                  19250000
192600*----------------------------------------------------------------*19260000
192700* GET LABEL COUNT                                                *19270000
192800*----------------------------------------------------------------*19280000
192900 3010-LABEL-COUNT.                                                19290000
193000                                                                  19300000
193100     INITIALIZE PV-DB2-LABEL-COUNT.                               19310000
193200                                                                  19320000
193300     EXEC SQL                                                     19330000
193400          SELECT COUNT(*)                                         19340000
193500            INTO :PV-DB2-LABEL-COUNT                              19350000
193600            FROM TLBPTDA                                          19360000
193700            WHERE  TRIP_ID         = :SU001-MANIFEST              19370000
193800              AND  CRE_USR_ID      = :SU001-USER-ID-USE           19380000
193900              AND  LBL_PRT_BTCH_ID = :SU001-BATCH-NO-USE          19390000
193910             with ur                                              19391014
194000     END-EXEC.                                                    19400000
194100                                                                  19410000
194200     EVALUATE TRUE                                                19420000
194300         WHEN SQLCODE = +0                                        19430000
194400              CONTINUE                                            19440000
194500                                                                  19450000
194600         WHEN OTHER                                               19460000
194700             MOVE   SU001-MANIFEST     TO PV-DISPLAY-MANIFEST     19470000
194800             MOVE   SU001-BATCH-NO-USE TO PV-DISPLAY-BATCH-NO     19480000
194900              STRING ' SUKRF527 - '            DELIMITED BY SIZE  19490000
195000                     'SU001-MANIFEST: '        DELIMITED BY SIZE  19500000
195100                     PV-DISPLAY-MANIFEST       DELIMITED BY SIZE  19510000
195200                     '  SU001-USER-ID-USE: '   DELIMITED BY SIZE  19520000
195300                     SU001-USER-ID-USE         DELIMITED BY SIZE  19530000
195400                     '  SU001-BATCH-NO-USE: '  DELIMITED BY SIZE  19540000
195500                      PV-DISPLAY-BATCH-NO       DELIMITED BY SIZE 19550000
195600                                           INTO PV-CICS-MSG-AREA  19560000
195700              MOVE LENGTH OF PV-CICS-MSG-AREA                     19570000
195800                     TO PV-COMMAREA-LENGTH                        19580000
195900              PERFORM 9990-WRITE-CICS                             19590000
196000                                                                  19600000
196100              MOVE '3010-LABEL-COUNT'                             19610000
196200                                  TO DP013-PARAGRAPH              19620000
196300              MOVE 'GET  LABEL COUNT'                             19630000
196400                                  TO DP013-MESSAGE-TEXT (1)       19640000
196500              MOVE SQLCA          TO DP013-SQLCA                  19650000
196600              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     19660000
196700              SET DP013-DB2-ABEND TO TRUE                         19670000
196800*             PERFORM 9999-WRITE-CICS-LOG-MSG                     19680000
196900             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              19690000
197000              PERFORM DP014-0000-PROCESS-ABEND                    19700000
197100     END-EVALUATE.                                                19710000
197200                                                                  19720000
197300                                                                  19730000
197400*----------------------------------------------------------------*19740000
197500* GET REPRINT LABEL COUNT                                        *19750000
197600*----------------------------------------------------------------*19760000
197700 3015-REPRINT-COUNT.                                              19770000
197800                                                                  19780000
197900     INITIALIZE PV-DB2-REPRINT-LBL-CNT.                           19790000
198000                                                                  19800000
198100     EXEC SQL                                                     19810000
198200          SELECT COUNT(*)                                         19820000
198300            INTO :PV-DB2-REPRINT-LBL-CNT                          19830000
198400            FROM TLBPTDA                                          19840000
198500            WHERE  TRIP_ID         = :SU001-MANIFEST              19850000
198600              AND  CRE_USR_ID      = :SU001-USER-ID-USE           19860000
198700              AND  LBL_PRT_BTCH_ID = :SU001-BATCH-NO-USE          19870000
198800*LMM          AND  RPRT_IND        = :PC-R                        19880000
198900              AND  RPRT_IND        = 'Y'                          19890000
198910             with ur                                              19891014
199000     END-EXEC.                                                    19900000
199100                                                                  19910000
199200     EVALUATE TRUE                                                19920000
199300         WHEN SQLCODE = +0                                        19930000
199400              CONTINUE                                            19940000
199500                                                                  19950000
199600         WHEN OTHER                                               19960000
199700             MOVE   SU001-MANIFEST     TO PV-DISPLAY-MANIFEST     19970000
199800             MOVE   SU001-BATCH-NO-USE TO PV-DISPLAY-BATCH-NO     19980000
199900              STRING ' SUKRF527 - '            DELIMITED BY SIZE  19990000
200000                     'SU001-MANIFEST: '        DELIMITED BY SIZE  20000000
200100                     PV-DISPLAY-MANIFEST       DELIMITED BY SIZE  20010000
200200                     '  SU001-USER-ID-USE: '   DELIMITED BY SIZE  20020000
200300                     SU001-USER-ID-USE         DELIMITED BY SIZE  20030000
200400                     '  SU001-BATCH-NO-USE: '  DELIMITED BY SIZE  20040000
200500                      PV-DISPLAY-BATCH-NO       DELIMITED BY SIZE 20050000
200600                                           INTO PV-CICS-MSG-AREA  20060000
200700              MOVE LENGTH OF PV-CICS-MSG-AREA                     20070000
200800                     TO PV-COMMAREA-LENGTH                        20080000
200900              PERFORM 9990-WRITE-CICS                             20090000
201000                                                                  20100000
201100              MOVE '3015-REPRINT-COUNT'                           20110000
201200                                  TO DP013-PARAGRAPH              20120000
201300              MOVE 'GET REPRINT LABEL COUNT'                      20130000
201400                                  TO DP013-MESSAGE-TEXT (1)       20140000
201500              MOVE SQLCA          TO DP013-SQLCA                  20150000
201600              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     20160000
201700              SET DP013-DB2-ABEND TO TRUE                         20170000
201800*             PERFORM 9999-WRITE-CICS-LOG-MSG                     20180000
201900             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              20190000
202000              PERFORM DP014-0000-PROCESS-ABEND                    20200000
202100     END-EVALUATE.                                                20210000
202200                                                                  20220000
202300                                                                  20230000
202400*----------------------------------------------------------------*20240000
202500* GET SCAC & TRAILER NUMBER                                      *20250000
202600*----------------------------------------------------------------*20260000
202700 3020-SCAC-TRAILER.                                               20270000
202800                                                                  20280000
202900     INITIALIZE PV-OWNER-SCAC-ID                                  20290000
203000                PV-VEH-NBR.                                       20300000
203100                                                                  20310000
203200     EXEC SQL                                                     20320000
203300         SELECT OWNER_SCAC_ID                                     20330000
203400              , VEH_NBR                                           20340000
203500          INTO :PV-OWNER-SCAC-ID                                  20350000
203600              ,:PV-VEH-NBR           :PV-NULL-IND                 20360000
203700          FROM  TVHTRIP                                           20370000
203800            WHERE  TRIP_ID         = :SU001-MANIFEST              20380000
203810             with ur                                              20381014
203900     END-EXEC.                                                    20390000
204000                                                                  20400000
204100     EVALUATE TRUE                                                20410000
204200         WHEN SQLCODE = +0                                        20420000
204300              CONTINUE                                            20430000
204400                                                                  20440000
204500         WHEN OTHER                                               20450000
204600             MOVE   SU001-MANIFEST     TO PV-DISPLAY-MANIFEST     20460000
204700             MOVE   SU001-BATCH-NO-USE TO PV-DISPLAY-BATCH-NO     20470000
204800              STRING ' SUKRF527 - '            DELIMITED BY SIZE  20480000
204900                     'SU001-MANIFEST: '        DELIMITED BY SIZE  20490000
205000                     PV-DISPLAY-MANIFEST       DELIMITED BY SIZE  20500000
205100                     '  SU001-USER-ID: '       DELIMITED BY SIZE  20510000
205200                     SU001-USER-ID             DELIMITED BY SIZE  20520000
205300                     '  SU001-BATCH-NO-USE: '  DELIMITED BY SIZE  20530000
205400                      PV-DISPLAY-BATCH-NO       DELIMITED BY SIZE 20540000
205500                                           INTO PV-CICS-MSG-AREA  20550000
205600              MOVE LENGTH OF PV-CICS-MSG-AREA                     20560000
205700                     TO PV-COMMAREA-LENGTH                        20570000
205800              PERFORM 9990-WRITE-CICS                             20580000
205900                                                                  20590000
206000              MOVE '3020-SCAC-TRAILER'                            20600000
206100                                  TO DP013-PARAGRAPH              20610000
206200              MOVE 'GET SCAC AND TRAILER NUMBER'                  20620000
206300                                  TO DP013-MESSAGE-TEXT (1)       20630000
206400              MOVE SQLCA          TO DP013-SQLCA                  20640000
206500              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     20650000
206600              SET DP013-DB2-ABEND TO TRUE                         20660000
206700*             PERFORM 9999-WRITE-CICS-LOG-MSG                     20670000
206800             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              20680000
206900              PERFORM DP014-0000-PROCESS-ABEND                    20690000
207000     END-EVALUATE.                                                20700000
207100                                                                  20710000
207200                                                                  20720000
207300*----------------------------------------------------------------*20730000
207400* GET EXCEPTIONS COUNT                                           *20740000
207500*----------------------------------------------------------------*20750000
207600 3025-EXCEPT-COUNT.                                               20760000
207700                                                                  20770000
207800     INITIALIZE PV-DB2-EXCEPT-LBL-CNT.                            20780000
207900                                                                  20790000
208000     EXEC SQL                                                     20800000
208100          SELECT COUNT(*)                                         20810000
208200            INTO :PV-DB2-EXCEPT-LBL-CNT                           20820000
208300            FROM TLBPTDA                                          20830000
208400            WHERE  TRIP_ID            = :SU001-MANIFEST           20840000
208500              AND  CRE_USR_ID         = :SU001-USER-ID-USE        20850000
208600              AND  LBL_PRT_BTCH_ID    = :SU001-BATCH-NO-USE       20860000
208700              AND (SU_FRE_ASTRA_IND  IN ('Y', 'R', 'T')  OR       20870000
208800                   SU_MSSG_DAT_IND    = 'Y'              OR       20880000
208900                   SU_MISDIR_IND      = 'Y'              OR       20890000
209000                   SU_DUP_LBL_IND     = 'Y')                      20900000
209010            with ur                                               20901014
209100     END-EXEC.                                                    20910000
209200                                                                  20920000
209300     EVALUATE TRUE                                                20930000
209400         WHEN SQLCODE = +0                                        20940000
209500              CONTINUE                                            20950000
209600                                                                  20960000
209700         WHEN OTHER                                               20970000
209800             MOVE   SU001-MANIFEST     TO PV-DISPLAY-MANIFEST     20980000
209900             MOVE   SU001-BATCH-NO-USE TO PV-DISPLAY-BATCH-NO     20990000
210000              STRING ' SUKRF527 - '            DELIMITED BY SIZE  21000000
210100                     'SU001-MANIFEST: '        DELIMITED BY SIZE  21010000
210200                     PV-DISPLAY-MANIFEST       DELIMITED BY SIZE  21020000
210300                     '  SU001-USER-ID-USE: '   DELIMITED BY SIZE  21030000
210400                     SU001-USER-ID-USE         DELIMITED BY SIZE  21040000
210500                     '  SU001-BATCH-NO-USE: '  DELIMITED BY SIZE  21050000
210600                      PV-DISPLAY-BATCH-NO       DELIMITED BY SIZE 21060000
210700                                           INTO PV-CICS-MSG-AREA  21070000
210800              MOVE LENGTH OF PV-CICS-MSG-AREA                     21080000
210900                     TO PV-COMMAREA-LENGTH                        21090000
211000              PERFORM 9990-WRITE-CICS                             21100000
211100                                                                  21110000
211200              MOVE '3025-EXCEPT-COUNT'                            21120000
211300                                  TO DP013-PARAGRAPH              21130000
211400              MOVE 'GET BATCH EXCEPTION COUNT'                    21140000
211500                                  TO DP013-MESSAGE-TEXT (1)       21150000
211600              MOVE SQLCA          TO DP013-SQLCA                  21160000
211700              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     21170000
211800              SET DP013-DB2-ABEND TO TRUE                         21180000
211900*             PERFORM 9999-WRITE-CICS-LOG-MSG                     21190000
212000             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              21200000
212100              PERFORM DP014-0000-PROCESS-ABEND                    21210000
212200     END-EVALUATE.                                                21220000
212300                                                                  21230000
212400                                                                  21240000
212500*----------------------------------------------------------------*21250000
212600* GET LAST BATCH NUMBER PROCESSED                                *21260000
212700*----------------------------------------------------------------*21270000
212800 3030-GET-LAST-BATCH.                                             21280000
212900                                                                  21290000
213000     MOVE  SU001-MANIFEST    TO  DK-MANIFEST.                     21300000
213100     IF  SU001-BATCH-NO-USE  >  ZERO                              21310000
213200         MOVE  SU001-BATCH-NO-USE  TO  PV-MAX-USER-BATCH          21320000
213300     ELSE                                                         21330000
213400     IF  SU001-BATCH-NUMBER  >  ZERO                              21340000
213500         MOVE  SU001-BATCH-NUMBER  TO  PV-MAX-USER-BATCH          21350000
213600     ELSE                                                         21360000
213700         MOVE  9999                TO  PV-MAX-USER-BATCH          21370000
213800     END-IF                                                       21380000
213900     END-IF.                                                      21390000
214000                                                                  21400000
214100     EXEC SQL                                                     21410000
214200         SELECT MAX(LBL_PRT_BTCH_ID)                              21420000
214300         INTO   :PV-LAST-BATCH-NUMBER                             21430000
214400          FROM  TLBPTDA                                           21440000
214500          WHERE TRIP_ID           = :DK-MANIFEST                  21450000
214600            AND CRE_USR_ID        = :SU001-USER-ID-USE            21460000
214700            AND LBL_PRT_BTCH_ID  ^= :PV-MAX-USER-BATCH            21470000
214710           with ur                                                21471014
214800     END-EXEC.                                                    21480000
214900                                                                  21490000
215000     EVALUATE TRUE                                                21500000
215100         WHEN SQLCODE = ZERO                                      21510000
215200             MOVE  PV-LAST-BATCH-NUMBER  TO  PV-LAST-BATCH-NO     21520000
215300         WHEN SQLCODE = -305                                      21530000
215400             MOVE  ZEROES  TO  PV-MAX-USER-BATCH                  21540000
215500         WHEN SQLWARN0 NOT = SPACES                               21550000
215600         WHEN SQLCODE NOT EQUAL ZERO                              21560000
215700             MOVE '3030-GET-LAST-BATCH'                           21570000
215800                             TO DP013-PARAGRAPH                   21580000
215900             MOVE                                                 21590000
216000                'SUKRF502-GET HIGHEST BATCH NUMBER FOR TRIP/USER' 21600000
216100                             TO DP013-MESSAGE-TEXT(1)             21610000
216200             MOVE SU001-MANIFEST                                  21620000
216300                             TO DP013-MESSAGE-TEXT(2)             21630000
216400             MOVE SU001-USER-ID                                   21640000
216500                             TO DP013-MESSAGE-TEXT(3)             21650000
216600             MOVE SQLCA      TO DP013-SQLCA                       21660000
216700             MOVE 'TLBPTDA'  TO DP013-DB2-TABLE-NAME(1)           21670000
216800             SET DP013-DB2-ABEND                                  21680000
216900                             TO TRUE                              21690000
217000             SET DP013-NO-ROLLBACK                                21700000
217100                             TO TRUE                              21710000
217200             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              21720000
217300             PERFORM DP014-0000-PROCESS-ABEND                     21730000
217400     END-EVALUATE.                                                21740000
217500*                                                                 21750000
217600*                                                                 21760000
217700*LMM                                                              21770000
217800*----------------------------------------------------------------*21780000
217900*  GET THE DC WHERE LABEL PRINTED AT                             *21790000
218000*----------------------------------------------------------------*21800000
218100 3040-GET-DC-PRTD-AT.                                             21810000
218200                                                                  21820000
218300     MOVE  DP072-OPER-UNT-ID         TO  DK-CURR-OPER-UNT-ID.     21830000
218400                                                                  21840000
218500     EXEC SQL                                                     21850000
218600          SELECT LOC_5_ABBR_NM                                    21860000
218700          INTO  :PV-DC-5-CHAR-ABBR                                21870000
218800          FROM   XLT_LOC                                          21880000
218900          WHERE  LOC_TYP_CDE  = 'DC'                              21890000
219000          AND    LOC_NBR   = :DK-CURR-OPER-UNT-ID                 21900000
219010          with ur                                                 21901014
219100     END-EXEC.                                                    21910000
219200                                                                  21920000
219300     EVALUATE TRUE                                                21930000
219400         WHEN SQLCODE = ZERO                                      21940000
219500              MOVE  PV-2-DIGIT-DC-ABBR  TO  PV-DC-PRTD-AT         21950000
219600                                                                  21960000
219700         WHEN SQLCODE = +100                                      21970000
219800              MOVE  PC-90   TO  PV-DC-PRTD-AT                     21980000
219900                                                                  21990000
220000         WHEN SQLCODE = -811                                      22000000
220100         WHEN SQLCODE = -904                                      22010000
220200         WHEN SQLCODE = -913                                      22020000
220300             CONTINUE                                             22030000
220400         WHEN SQLWARN0 NOT = SPACES                               22040000
220500         WHEN SQLCODE < +0                                        22050000
220600         WHEN SQLCODE > +0                                        22060000
220700            MOVE '3040-GET-DC-PRTD-AT' TO DP013-PARAGRAPH         22070000
220800            MOVE 'GET DC PRINTED AT'   TO DP013-MESSAGE-TEXT(1)   22080000
220900            MOVE SQLCA                 TO DP013-SQLCA             22090000
221000            MOVE 'XLT00010'            TO DP013-DB2-TABLE-NAME(1) 22100000
221100            SET  DP013-DB2-ABEND       to true                    22110000
221200             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              22120000
221300            PERFORM DP014-0000-PROCESS-ABEND                      22130000
221400     END-EVALUATE.                                                22140000
221500*                                                                 22150000
221600*                                                                 22160000
221700 3200-XCTL-TO-HELP.                                               22170000
221800                                                                  22180000
221900     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      22190000
222000     SET  SU001-INITIALIZE-SCREEN     TO TRUE.                    22200000
222100     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    22210000
222200                                                                  22220000
222300     EXEC CICS                                                    22230000
222400         XCTL                                                     22240000
222500             PROGRAM   (PV-TRANSFER-PROGRAM)                      22250000
222600             COMMAREA  (PC192-COMMAREA)                           22260000
222700             LENGTH    (PV-COMMAREA-LENGTH)                       22270000
222800             RESP      (PV-CICS-RESPONSE)                         22280000
222900     END-EXEC.                                                    22290000
223000                                                                  22300000
223100     EVALUATE TRUE                                                22310000
223200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22320000
223300              CONTINUE                                            22330000
223400         WHEN OTHER                                               22340000
223500             MOVE '3200-XCTL-TO-HELP '                            22350000
223600                 TO DP013-PARAGRAPH                               22360000
223700             MOVE 'SUKRF527 - UNABLE TO XCTL TO PROGRAM: '        22370000
223800                 TO DP013-MESSAGE-TEXT (1)                        22380000
223900             MOVE PV-TRANSFER-PROGRAM                             22390000
224000                 TO DP013-MESSAGE-TEXT (2)                        22400000
224100             SET DP013-CICS-ABEND  TO TRUE                        22410000
224200             SET DP013-ROLLBACK TO TRUE                           22420000
224300             PERFORM 9999-WRITE-CICS-LOG-MSG                      22430000
224400             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             22440000
224500             SET SU001-PROCESS-SCREEN TO TRUE                     22450000
224600             PERFORM 8000-SEND-MAP                                22460000
224700             PERFORM 8200-RETURN-TRANID                           22470000
224800     END-EVALUATE.                                                22480000
224900*                                                                 22490000
225000* WR41309-RF ID 8/30/2012  AME  BEGIN                             22500000
225100*----------------------------------------------------------------*22510000
225200*----------------------------------------------------------------*22520000
225300 3250-SELECT-BRCDE.                                               22530000
225400                                                                  22540000
225500      EXEC SQL                                                    22550000
225600           SELECT BRCDE_NBR                                       22560000
225700                 ,CART_LBL_TYP_CDE                                22570000
225800           INTO :SULBXF-BRCDE-NBR                                 22580000
225900               ,:SULBXF-CART-LBL-TYP-CDE                          22590000
226000           FROM TSULBXF                                           22600000
226100           WHERE SHIPT_UNT_ID = :LBPTDA-SHIPT-UNT-ID              22610000
226200             AND STAT_CDE   = 'A'                                 22620000
226300          WITH UR                                                 22630000
226400      END-EXEC                                                    22640000
226500                                                                  22650000
226600                                                                  22660000
226700     EVALUATE TRUE                                                22670000
226800         WHEN SQLCODE = ZERO                                      22680000
226900         when SQLCODE = -811                                      22690000
227000              SET PS-SULBXF-FOUND  TO TRUE                        22700000
227100         WHEN SQLCODE = +100                                      22710000
227200              SET PS-SULBXF-NOT-FOUND  TO TRUE                    22720000
227300         WHEN OTHER                                               22730000
227400             STRING ' SUKRF527 - '             DELIMITED BY SIZE  22740000
227500                     'PV-OTBND-SML'            DELIMITED BY SIZE  22750000
227600                      PV-OTBND-SML             DELIMITED BY SIZE  22760000
227700                                          INTO PV-CICS-MSG-AREA   22770000
227800             MOVE LENGTH OF PV-CICS-MSG-AREA                      22780000
227900                     TO PV-COMMAREA-LENGTH                        22790000
228000             PERFORM 9990-WRITE-CICS                              22800000
228100                                                                  22810000
228200             MOVE '3250-SELECT-BRCDE '                            22820000
228300                                            TO DP013-PARAGRAPH    22830000
228400             MOVE 'SUKRF527 - COUNT RD PROCESS MSGS'              22840000
228500                             TO DP013-MESSAGE-TEXT(1)             22850000
228600             MOVE   LBPTDA-OPER-UNT-ID      TO  PV-DISPLAY-OPER   22860000
228700             MOVE   LBPTDA-TRIP-ID          TO  PV-DISPLAY-TRIP   22870000
228800             MOVE   LBPTDA-LBL-PRT-BTCH-ID  TO  PV-DISPLAY-BATCH  22880000
228900             MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO     22890000
229000             MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR   22900000
229100             MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE   22910000
229200             STRING 'OPER UNIT: '                                 22920000
229300                    PV-DISPLAY-OPER                               22930000
229400                    '   DK-BARCODE-NBR: '                         22940000
229500                     DK-BARCODE-NBR                               22950000
229600                    '   BATCH NO: '                               22960000
229700                    PV-DISPLAY-BATCH        DELIMITED BY SIZE     22970000
229800                                       INTO DP013-MESSAGE-TEXT(2) 22980000
229900             STRING 'TRIP ID: '                                   22990000
230000                    PV-DISPLAY-TRIP                               23000000
230100                    '   SCAC: '                                   23010000
230200                    LBPTDA-OWNR-SCAC-ID                           23020000
230300                    '   TRLR: '                                   23030000
230400                    LBPTDA-VEH-NBR          DELIMITED BY SIZE     23040000
230500                                        INTO DP013-MESSAGE-TEXT(3)23050000
230600             STRING '   OPER: '                                   23060000
230700                    PV-DISPLAY-OPER                               23070000
230800                    'PO: '                                        23080000
230900                    PV-DISPLAY-PO                                 23090000
231000                    '   RCVR: '                                   23100000
231100                    PV-DISPLAY-RCVR                               23110000
231200                    '   LINE: '                                   23120000
231300                    PV-DISPLAY-LINE         DELIMITED BY SIZE     23130000
231400                                       INTO DP013-MESSAGE-TEXT(4) 23140000
231500             MOVE SQLCA      TO DP013-SQLCA                       23150000
231600             MOVE 'TSULBXF'  TO DP013-DB2-TABLE-NAME(1)           23160000
231700             SET DP013-DB2-ABEND            TO TRUE               23170000
231800             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              23180000
231900             PERFORM DP014-0000-PROCESS-ABEND                     23190000
232000         END-EVALUATE.                                            23200000
232100                                                                  23210000
232200* WR41309-RF ID 8/30/2012  AME  END                               23220000
232300*----------------------------------------------------------------*23230000
232400* COUNT PROCESS MESSAGES THAT ARE OF A CODE TYPE 'RD' TO         *23240000
232500* DETERMINE IF '*** RF ID ****' SHOULD BE PRINTED ON THE LABEL   *23250000
232600*----------------------------------------------------------------*23260000
232700 3300-COUNT-MSG-RD.                                               23270000
232800                                                                  23280000
232900*CLP 06/20/2013 PR5148B START                                     23290000
233000         EXEC SQL                                                 23300000
233100              SELECT PRC_MSG_CDE                                  23310000
233200         INTO   :PV-PRC-MSG-CDE                                   23320000
233300                FROM SUT_PRC_MSG_CNTL                             23330000
233400               WHERE SHIPT_UNT_ID = :SUT00094-SHIPT-UNT-ID        23340000
233500                 AND PRC_MSG_CDE  IN ('RD', 'EA', 'RE')           23350013
233600               FETCH FIRST 1 ROW ONLY                             23360000
233610               with ur                                            23361014
233700         END-EXEC                                                 23370000
233800                                                                  23380000
233900     EVALUATE TRUE                                                23390000
234000         WHEN SQLCODE = ZERO                                      23400000
234100         when SQLCODE = -811                                      23410000
234200              SET PS-RF-ID-FOUND-YES TO TRUE                      23420000
234300*CLP 06/20/2013 PR5148B END                                       23430000
234400         WHEN SQLCODE = +100                                      23440000
234500              SET PS-RF-ID-FOUND-NO  TO TRUE                      23450000
234600         WHEN OTHER                                               23460000
234700             MOVE   SUT00094-SHIPT-UNT-ID   TO  PV-DISPLAY-sscc   23470000
234800             STRING ' SUKRF527 - '                                23480000
234900                     'SSCC:'                                      23490000
235000                      PV-DISPLAY-sscc          DELIMITED BY SIZE  23500000
235100                                          INTO PV-CICS-MSG-AREA   23510000
235200             MOVE LENGTH OF PV-CICS-MSG-AREA                      23520000
235300                     TO PV-COMMAREA-LENGTH                        23530000
235400             PERFORM 9990-WRITE-CICS                              23540000
235500                                                                  23550000
235600             MOVE '3300-COUNT-MSG-RD'                             23560000
235700                                            TO DP013-PARAGRAPH    23570000
235800             MOVE 'SUKRF527 - COUNT RD PROCESS MSGS'              23580000
235900                             TO DP013-MESSAGE-TEXT(1)             23590000
236000             MOVE   LBPTDA-OPER-UNT-ID      TO  PV-DISPLAY-OPER   23600000
236100             MOVE   LBPTDA-TRIP-ID          TO  PV-DISPLAY-TRIP   23610000
236200             MOVE   LBPTDA-LBL-PRT-BTCH-ID  TO  PV-DISPLAY-BATCH  23620000
236300             MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO     23630000
236400             MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR   23640000
236500             MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE   23650000
236600             STRING 'OPER:'         pV-DISPLAY-OPER               23660000
236700                    '   sscc:'      PV-DISPLAY-sscc               23670000
236800                    '   BATCH:'     PV-DISPLAY-BATCH              23680000
236900                                          DELIMITED BY SIZE       23690000
237000                                     INTO DP013-MESSAGE-TEXT(2)   23700000
237100             STRING 'TRIP:'         PV-DISPLAY-TRIP               23710000
237200                    '   SCAC:'      LBPTDA-OWNR-SCAC-ID           23720000
237300                    '   TRLR:'      LBPTDA-VEH-NBR                23730000
237400                                          DELIMITED BY SIZE       23740000
237500                                     INTO DP013-MESSAGE-TEXT(3)   23750000
237600             STRING '   PO:'        PV-DISPLAY-OPER               23760000
237700                    '-'             PV-DISPLAY-PO                 23770000
237800                    '-'             PV-DISPLAY-RCVR               23780000
237900                    '-'             PV-DISPLAY-LINE               23790000
238000                                          DELIMITED BY SIZE       23800000
238100                                     INTO DP013-MESSAGE-TEXT(4)   23810000
238200             MOVE SQLCA      TO DP013-SQLCA                       23820000
238300             MOVE 'SUT_PRC_MSG_CNTL' to dp013-DB2-TABLE-NAME(1)   23830014
238400             SET DP013-DB2-ABEND            TO TRUE               23840000
238500             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              23850000
238600             PERFORM DP014-0000-PROCESS-ABEND                     23860000
238700         END-EVALUATE.                                            23870000
238800                                                                  23880000
238900* WR41309-RF ID 8/30/2012  AME  END                               23890000
239000*----------------------------------------------------------------*23900000
239100* PRINT LABEL ROUTINE                                            *23910000
239200*----------------------------------------------------------------*23920000
239300 4000-LABEL-ROUTINE.                                              23930000
239400                                                                  23940000
239500*   7/17/2006  DRS                                                23950000
239600*    IF SU001-DC-NOT-INTERFACED                                   23960000
239700*       CONTINUE                                                  23970000
239800*    ELSE                                                         23980000
239900*       PERFORM 4100-DETERMINE-EAI-CALL                           23990000
240000*    END-IF.                                                      24000000
240100*   7/17/2006  DRS                                                24010000
240200                                                                  24020000
240300     IF PS-NO-SOCKET-ERROR                                        24030000
240400        PERFORM 4300-FORMAT-IP-ADDR                               24040000
240500        PERFORM 4310-CALL-SOCKET                                  24050000
240600     END-IF.                                                      24060000
240700     IF  PS-NO-SOCKET-ERROR                                       24070000
240800         PERFORM 4320-CONNECT-SOCKET                              24080000
240900     END-IF.                                                      24090000
241000     IF  PS-NO-SOCKET-ERROR                                       24100000
241100         PERFORM 4400-BLD-HDR-REC                                 24110000
241200     END-IF.                                                      24120000
241300     IF  PS-NO-SOCKET-ERROR                                       24130000
241400         PERFORM 4500-BLD-DTL-REC                                 24140000
241500     END-IF.                                                      24150000
241600     IF  PS-NO-SOCKET-ERROR                                       24160000
241700         PERFORM 4600-BLD-TLR-REC                                 24170000
241800     END-IF.                                                      24180000
241900     IF  PS-NO-SOCKET-ERROR                                       24190000
242000         PERFORM 4340-CLOSE-SOCKET                                24200000
242100     END-IF.                                                      24210000
242200                                                                  24220000
242300     IF  PS-SOCKET-ERROR                                          24230000
242400         PERFORM 9200-SYNCPOINT-ROLLBACK                          24240000
242500         PERFORM 4730-UPDATE-TLBTKHS                              24250000
242600     END-IF.                                                      24260000
242700                                                                  24270000
242800*    SKIP EVENT PROCESSING IF A SOCKET ERROR HAS OCCURRED         24280000
242900*    OR THE EVENT HAS ALREADY BEEN RECORDED                       24290000
243000                                                                  24300000
243100     IF  PS-SOCKET-ERROR                                          24310000
243200         CONTINUE                                                 24320000
243300     ELSE                                                         24330000
243400         IF SU001-DC-NOT-INTERFACED                               24340000
243500             CONTINUE                                             24350000
243600         ELSE                                                     24360000
243700            PERFORM 4100-DETERMINE-EAI-CALL                       24370000
243800         END-IF                                                   24380000
243900     END-IF.                                                      24390000
244000                                                                  24400000
244100*----------------------------------------------------------------*24410000
244200*    FIRST THING TO OCCUR IN THE PARAGRAPH IS THE FORMATTING     *24420000
244300*    OF THE DLWS001 COMMAREA TO PASS TO DLKUP001.  DLKUP001 IS   *24430000
244400*    USED TO NUMBER EVENTS WITHIN A LABOR ASSIGNMENT.            *24440000
244500*        IF THE CALL TO DLKUP001 IS SUCCESSFUL, DO A SYNCPOINT   *24450000
244600*    AND THEN FORMAT THE XLWS072 COMMAREA TO PASS TO XLKUP033    *24460000
244700*    WHICH WILL WRITE DATA TO THE EAI EXPORT TABLES.             *24470000
244800*                                                                *24480000
244900*----------------------------------------------------------------*24490000
245000                                                                  24500000
245100 4100-DETERMINE-EAI-CALL.                                         24510000
245200                                                                  24520000
245300     INITIALIZE DL001-ASGMT-COMMAREA.                             24530000
245400                                                                  24540000
245500     SET DL001-BY-ASGMT-KEY         TO TRUE.                      24550000
245600     SET DL001-DO-NOT-COMMIT-UPDATE TO TRUE.                      24560000
245700     SET DL001-FIND-NEXT-ASGMT      TO TRUE.                      24570000
245800                                                                  24580000
245900     MOVE SU001-ASGMT-STRT-DTE TO DL001-KEY-START-DTE.            24590000
246000     MOVE SU001-ASGMT-NBR-TXT  TO DL001-KEY-NBR-TXT.              24600000
246100     MOVE SU001-ASGMT-NBR-SEQ-NBR TO DL001-KEY-NBR-SEQ-NBR.       24610000
246200                                                                  24620000
246300     MOVE 1 TO DL001-NBR-OF-NBRS-NEED-QTY.                        24630000
246400     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   24640000
246500                                                                  24650000
246600     CALL DL001-USER-PGM USING DFHEIBLK                           24660000
246700                               DL001-COMMAREA                     24670000
246800                               DL001-ASGMT-COMMAREA.              24680000
246900                                                                  24690000
247000     IF DL001-SUCCESSFUL                                          24700000
247100        PERFORM 9100-SYNCPOINT                                    24710000
247200        IF DL001-ASGMT-NEXT-USED                                  24720000
247300           MOVE DL001-NXT-START-DTE TO  SU001-ASGMT-STRT-DTE      24730000
247400           MOVE DL001-NXT-NBR-TXT   TO  SU001-ASGMT-NBR-TXT       24740000
247500           MOVE DL001-NXT-NBR-SEQ-NBR TO                          24750000
247600                              SU001-ASGMT-NBR-SEQ-NBR             24760000
247700**??    ELSE                                                      24770000
247800**??       MOVE DL001-SEQ-START-NBR TO                            24780000
247900**??                          SU001-ASGMT-NBR-SEQ-NBR             24790000
248000        END-IF                                                    24800000
248100                                                                  24810000
248200        PERFORM 4200-CALL-XLKUP033                                24820000
248300     ELSE                                                         24830000
248400        IF DL001-ASGMT-CLOSED-RETURN                              24840000
248500           CONTINUE                                               24850000
248600        ELSE                                                      24860000
248700           SET  PS-SOCKET-ERROR         TO TRUE                   24870000
248800           STRING PC-CURRENT-PROGRAM-NAME                         24880000
248900                  ' - ERROR FROM DLKUP001 - '                     24890000
249000                  DL001-RETURN-CODE                               24900000
249100                  ' - START DATE -  '                             24910000
249200                  DL001-KEY-START-DTE                             24920000
249300                  PV-BLANKS                                       24930000
249400                  DELIMITED BY SIZE                               24940000
249500                  INTO PV-CICS-MSG-AREA                           24950000
249600           PERFORM 9990-WRITE-CICS                                24960000
249700                                                                  24970000
249800           STRING 'DL001-KEY-NBR-TXT -------> '                   24980000
249900                  DL001-KEY-NBR-TXT                               24990000
250000                  PV-BLANKS                                       25000000
250100                  DELIMITED BY SIZE                               25010000
250200                  INTO PV-CICS-MSG-AREA                           25020000
250300           PERFORM 9990-WRITE-CICS                                25030000
250400                                                                  25040000
250500           SET  DP013-OTHER-ABEND TO TRUE                         25050000
250600           SET  DP013-NO-ROLLBACK TO TRUE                         25060000
250700           MOVE '4100-DETERMINE-EAI-CALL' TO DP013-PARAGRAPH      25070000
250800           STRING PC-CURRENT-PROGRAM-NAME                         25080000
250900                  ' - ERROR FROM DLKUP001 - '                     25090000
251000                  DL001-RETURN-CODE                               25100000
251100                  ' - START DATE -  '                             25110000
251200                  DL001-KEY-START-DTE                             25120000
251300                  PV-BLANKS                                       25130000
251400                  DELIMITED BY SIZE                               25140000
251500                                       INTO DP013-MESSAGE-TEXT (1)25150000
251600           STRING 'DL001-KEY-NBR-TXT -------> '                   25160000
251700                  DL001-KEY-NBR-TXT                               25170000
251800                  PV-BLANKS                                       25180000
251900                  DELIMITED BY SIZE                               25190000
252000                                       INTO DP013-MESSAGE-TEXT (2)25200000
252100           PERFORM 9999-WRITE-CICS-LOG-MSG                        25210000
252200        END-IF                                                    25220000
252300     END-IF.                                                      25230000
252400                                                                  25240000
252500*----------------------------------------------------------------*25250000
252600*    FORMAT THE XLWS072 COMMAREA TO PASS TO XLKUP033 WHICH WILL  *25260000
252700*    WRITE DATA TO THE EAI EXPORT TABLES.                        *25270000
252800*        THE BUSINESS EVENT THAT THIS WRITES IS THE "CARTON"     *25280000
252900*    "CHECKIN PRINT" AND IT WILL WRITE ROWS TO BOTH THE SUT00037 *25290000
253000*    (SUT_BUS_EVNT_EXPRT) AND SUT00038 (SUT_BUS_EVNT_DTL) TABLES.*25300000
253100*                                                                *25310000
253200*----------------------------------------------------------------*25320000
253300                                                                  25330000
253400 4200-CALL-XLKUP033.                                              25340000
253500                                                                  25350000
253600     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        25360000
253700                                                                  25370000
253800     SET XL072-SU-APP-ID          TO TRUE.                        25380000
253900                                                                  25390000
254000     MOVE PC-CARTON               TO XL072-EVNT-OBJ-TXT.          25400000
254100     MOVE PC-CHECKIN-PRINT        TO XL072-EVNT-OBJ-ACTN-TXT.     25410000
254200     MOVE SU001-USER-ID           TO XL072-CRE-BY-USR-ID.         25420000
254300     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            25430000
254400**?? MOVE DK-TRIP-ID              TO XL072-EVNT-KY-1-NBR.         25440000
254500**?? MOVE DK-BATCH-NUMBER         TO XL072-EVNT-KY-2-NBR.         25450000
254600**?? MOVE DK-USER-ID              TO XL072-EVNT-KY-1-TXT.         25460000
254700     MOVE SU001-MANIFEST          TO XL072-EVNT-KY-1-NBR.         25470000
254800**?? MOVE PV-BATCH-NUMBER-N       TO XL072-EVNT-KY-2-NBR.         25480000
254900                                                                  25490000
255000     EVALUATE TRUE                                                25500000
255100         WHEN SU001-BATCH-NO-USE  >  ZERO                         25510000
255200              MOVE SU001-BATCH-NO-USE TO XL072-EVNT-KY-2-NBR      25520000
255300                                                                  25530000
255400         WHEN SU001-BATCH-NUMBER >  ZERO                          25540000
255500              MOVE SU001-BATCH-NUMBER TO XL072-EVNT-KY-2-NBR      25550000
255600                                                                  25560000
255700         WHEN OTHER                                               25570000
255800              MOVE 9999 TO XL072-EVNT-KY-2-NBR                    25580000
255900                                                                  25590000
256000     END-EVALUATE.                                                25600000
256100                                                                  25610000
256200     MOVE SU001-USER-ID-USE       TO XL072-EVNT-KY-1-TXT.         25620000
256300     SET XL072-DO-NOT-COMMIT-UPDATE TO TRUE.                      25630000
256400     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-ORIG-CALLING-PGM-NM.   25640000
256500                                                                  25650000
256600     SET XL072-SUWS050-COPYBOOK TO TRUE.                          25660000
256700                                                                  25670000
256800     INITIALIZE SU050-DTL-TXT-AREA.                               25680000
256900     SET SU050-CHECK-IN-LBL-PRT TO TRUE.                          25690000
257000     MOVE SU001-ASGMT-STRT-DTE  TO SU050-AB-ASGMT-STRT-DTE.       25700000
257100     MOVE SU001-ASGMT-NBR-TXT   TO SU050-AB-ASGMT-NBR-TXT.        25710000
257200     MOVE SU001-ASGMT-NBR-SEQ-NBR TO SU050-AB-ASGMT-NBR-SEQ-NBR.  25720000
257300     MOVE DL001-SEQ-START-NBR     TO SU050-AB-ASGMT-SEQ-DTL-NBR.  25730000
257400     MOVE SU001-DOOR-ID           TO SU050-AB-DOOR-NBR.           25740000
257500     MOVE SU050-DTL-TXT-AREA      TO XL072-DTL-TXT.               25750000
257600                                                                  25760000
257700     CALL XL072-USER-PGM USING DFHEIBLK                           25770000
257800                               XL072-COMMAREA                     25780000
257900                               XL072-EAI-EXPORT-COMMAREA.         25790000
258000                                                                  25800000
258100     IF XL072-SUCCESSFUL                                          25810000
258200        CONTINUE                                                  25820000
258300     ELSE                                                         25830000
258400        SET  PS-SOCKET-ERROR         TO TRUE                      25840000
258500        STRING PC-CURRENT-PROGRAM-NAME                            25850000
258600               ' - ERROR FROM XLKUP033 - '                        25860000
258700               XL072-RETURN-CODE                                  25870000
258800               ' - OBJECT TXT - '                                 25880000
258900               XL072-EVNT-OBJ-TXT                                 25890000
259000               ' - CRE USR - '                                    25900000
259100               XL072-CRE-BY-USR-ID                                25910000
259200               PV-BLANKS                                          25920000
259300               DELIMITED BY SIZE                                  25930000
259400               INTO PV-CICS-MSG-AREA                              25940000
259500        PERFORM 9990-WRITE-CICS                                   25950000
259600                                                                  25960000
259700        STRING 'OBJECT ACTN TXT ---> '                            25970000
259800               XL072-EVNT-OBJ-ACTN-TXT                            25980000
259900               ' CRE PGM - '                                      25990000
260000               XL072-CRE-PGM-NM                                   26000000
260100               PV-BLANKS                                          26010000
260200               DELIMITED BY SIZE                                  26020000
260300               INTO PV-CICS-MSG-AREA                              26030000
260400        PERFORM 9990-WRITE-CICS                                   26040000
260500                                                                  26050000
260600        SET  DP013-OTHER-ABEND TO TRUE                            26060000
260700        SET  DP013-NO-ROLLBACK TO TRUE                            26070000
260800        MOVE '4200-CALL-XLKUP033' TO DP013-PARAGRAPH              26080000
260900        PERFORM 9999-WRITE-CICS-LOG-MSG                           26090000
261000     END-IF.                                                      26100000
261100                                                                  26110000
261200                                                                  26120000
261300*----------------------------------------------------------------*26130000
261400*  THIS PARAGRAPH WILL TAKE EACH NUMERIC PORTION OF THE IP       *26140000
261500*  ADDRESS AND CONVERT EACH PORTION INTO ITS HEX VALUE.  THE     *26150000
261600*  HEX VALUE WILL THEN BE MOVED TO A FIELD WHICH WILL STACK THE  *26160000
261700*  FOUR HEX VALUES SIDE BY SIDE INTO A FIELD DEFINED AS X(04).   *26170000
261800*  THIS VALUE IS THEN WHAT IS USED BY THE SOCKETS LOGIC FOR THE  *26180000
261900*  IP ADDRESS.                                                   *26190000
262000*----------------------------------------------------------------*26200000
262100 4300-FORMAT-IP-ADDR.                                             26210000
262200                                                                  26220000
262300     MOVE PV-IP-ADDR-NUM1 TO PV-HEX-NUMERIC.                      26230000
262400     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-1.                        26240000
262500                                                                  26250000
262600     MOVE PV-IP-ADDR-NUM2 TO PV-HEX-NUMERIC.                      26260000
262700     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-2.                        26270000
262800                                                                  26280000
262900     MOVE PV-IP-ADDR-NUM3 TO PV-HEX-NUMERIC.                      26290000
263000     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-3.                        26300000
263100                                                                  26310000
263200     MOVE PV-IP-ADDR-NUM4 TO PV-HEX-NUMERIC.                      26320000
263300     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-4.                        26330000
263400                                                                  26340000
263500     MOVE PV-HEX-FIELD-NUMBER TO DP081-NAME-IP-ADDR.              26350000
263600                                                                  26360000
263700                                                                  26370000
263800*----------------------------------------------------------------*26380000
263900*  CALL SOCKET                                                   *26390000
264000*----------------------------------------------------------------*26400000
264100 4310-CALL-SOCKET.                                                26410000
264200                                                                  26420000
264300     CALL 'EZASOKET'                                              26430000
264400         USING DP081-SOCKET-CMD                                   26440000
264500               DP081-AF-INET                                      26450000
264600               DP081-SOCK-TYPE                                    26460000
264700               DP081-PROTOCOL                                     26470000
264800               DP081-ERRNO                                        26480000
264900               DP081-RETCODE.                                     26490000
265000                                                                  26500000
265100     MOVE DP081-RETCODE TO DP081-SOCK-ID.                         26510000
265200                                                                  26520000
265300     IF DP081-RETCODE < ZERO                                      26530000
265400        SET  PS-SOCKET-ERROR         TO TRUE                      26540000
265500        MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                   26550000
265600        MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                   26560000
265700        MOVE -1                      TO APRTIDL                   26570000
265800        MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME     26580000
265900        SET  DP081-TCP-IP-SOCKET-ERR TO TRUE                      26590000
266000        MOVE DP081-ERRNO             TO DP081-TCP-IP-ERR-NBR      26600000
266100        SET  DP013-OTHER-ABEND       TO TRUE                      26610000
266200        SET  DP013-NO-ROLLBACK       TO TRUE                      26620000
266300        MOVE '4310-CALL-SOCKET'      TO DP013-PARAGRAPH           26630000
266400        MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)   26640000
266500        MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY        26650000
266600        MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT          26660000
266700        MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR       26670000
266800        STRING ' SUKRF527 - '            DELIMITED BY SIZE        26680000
266900               'DP081-FAMILY='           DELIMITED BY SIZE        26690000
267000               PV-DISPLAY-FAMILY         DELIMITED BY SIZE        26700000
267100               ' DP081-PORT='            DELIMITED BY SIZE        26710000
267200               PV-DISPLAY-PORT           DELIMITED BY SIZE        26720000
267300               ' DP081-IP-ADDR='         DELIMITED BY SIZE        26730000
267400               PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE        26740000
267500                                    INTO DP013-MESSAGE-TEXT (2)   26750000
267600        MOVE DP081-RETCODE            TO  PV-RETCODE              26760000
267700        MOVE DP081-ERRNO              TO  PV-ERRNO                26770000
267800        STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE       26780000
267900               ' DP081-RETCODE - '        DELIMITED BY SIZE       26790000
268000               PV-RETCODE                 DELIMITED BY SIZE       26800000
268100               ' DP081-ERRNO - '          DELIMITED BY SIZE       26810000
268200               PV-ERRNO                   DELIMITED BY SIZE       26820000
268300                                     INTO DP013-MESSAGE-TEXT (3)  26830000
268400        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          26840000
268500        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        26850000
268600        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        26860000
268700        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        26870000
268800        STRING ' PRTR ID: '                DELIMITED BY SIZE      26880000
268900               SU001-PRINTER-ID-USE        DELIMITED BY SIZE      26890000
269000               '   OPER: '                 DELIMITED BY SIZE      26900000
269100               PV-DISPLAY-OPER             DELIMITED BY SIZE      26910000
269200               '   PO: '                   DELIMITED BY SIZE      26920000
269300               PV-DISPLAY-PO               DELIMITED BY SIZE      26930000
269400               '   RCVR: '                 DELIMITED BY SIZE      26940000
269500               PV-DISPLAY-RCVR             DELIMITED BY SIZE      26950000
269600                                      INTO DP013-MESSAGE-TEXT (4) 26960000
269700        PERFORM 9999-WRITE-CICS-LOG-MSG                           26970000
269800                                                                  26980000
269900*** BEGIN - FOR TESTING ONLY                                      26990000
270000*    ELSE                                                         27000000
270100*       MOVE ' SUKRF527 - CALL SOCKET SUCCESSFUL'                 27010000
270200*                                           TO PV-CICS-MSG-AREA   27020000
270300*       PERFORM 9990-WRITE-CICS                                   27030000
270400*** END - FOR TESTING ONLY                                        27040000
270500                                                                  27050000
270600     END-IF.                                                      27060000
270700                                                                  27070000
270800                                                                  27080000
270900*----------------------------------------------------------------*27090000
271000*  CONNECT THE PATH (SOCKET).                                    *27100000
271100*----------------------------------------------------------------*27110000
271200 4320-CONNECT-SOCKET.                                             27120000
271300                                                                  27130000
271400                                                                  27140000
271500     MOVE DP081-AF-INET         TO DP081-NAME-FAMILY.             27150000
271600     MOVE DP081-COM-PORT        TO DP081-NAME-PORT.               27160000
271700                                                                  27170000
271800     CALL 'EZASOKET'                                              27180000
271900         USING DP081-CONNECT-CMD                                  27190000
272000               DP081-SOCK-ID                                      27200000
272100               DP081-SOCK-NAME                                    27210000
272200               DP081-ERRNO                                        27220000
272300               DP081-RETCODE.                                     27230000
272400                                                                  27240000
272500     IF DP081-RETCODE < ZERO                                      27250000
272600        SET  PS-SOCKET-ERROR         TO TRUE                      27260000
272700        MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                   27270000
272800        MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                   27280000
272900        MOVE -1                      TO APRTIDL                   27290000
273000        MOVE PC-CURRENT-PROGRAM-NAME  TO DP081-TCP-IP-PGM-NAME    27300000
273100        SET  DP081-TCP-IP-CONNECT-ERR TO TRUE                     27310000
273200        MOVE DP081-ERRNO              TO DP081-TCP-IP-ERR-NBR     27320000
273300                                         CONNECT-ERRNO            27330000
273400        MOVE CONNECT-ERR              TO PV-CICS-MSG-AREA         27340000
273500                                                                  27350000
273600        PERFORM 9990-WRITE-CICS                                   27360000
273700*                                                                 27370000
273800** DMH - 3/24/05 - BEGIN                                          27380000
273900        MOVE  SPACES                  TO PV-CICS-MSG-AREA         27390000
274000        MOVE  SU001-PRINTER-ID        TO ERR-MSG-PRINTER          27400000
274100        MOVE  SU001-OPER-UNT-ID       TO ERR-MSG-OPER             27410000
274200        MOVE  SU001-PO                TO ERR-MSG-PO               27420000
274300        MOVE  SU001-RCVR-SEQ-NBR      TO ERR-MSG-RCVR             27430000
274400        MOVE  SU001-MANIFEST          TO ERR-MSG-TRIP             27440000
274500        MOVE  SU001-USER-ID           TO ERR-MSG-USERID           27450000
274600        MOVE  SU001-BATCH-NUMBER      TO ERR-MSG-BATCH            27460000
274700        MOVE  ERROR-DETAILS           TO PV-CICS-MSG-AREA         27470000
274800                                                                  27480000
274900        PERFORM 9990-WRITE-CICS                                   27490000
275000*                                                                 27500000
275100*dmh                                                              27510000
275200*dmh    SET  DP013-OTHER-ABEND        TO TRUE                     27520000
275300*dmh    SET  DP013-NO-ROLLBACK        TO TRUE                     27530000
275400*dmh    MOVE '4320-CONNECT-SOCKET'    TO DP013-PARAGRAPH          27540000
275500*dmh    MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)   27550000
275600*dmh    MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY        27560000
275700*dmh    MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT          27570000
275800*dmh    MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR       27580000
275900*dmh    STRING ' SUKRF527 - '            DELIMITED BY SIZE        27590000
276000*dmh           'DP081-FAMILY='           DELIMITED BY SIZE        27600000
276100*dmh           PV-DISPLAY-FAMILY         DELIMITED BY SIZE        27610000
276200*dmh           ' DP081-PORT='            DELIMITED BY SIZE        27620000
276300*dmh           PV-DISPLAY-PORT           DELIMITED BY SIZE        27630000
276400*dmh           ' DP081-IP-ADDR='         DELIMITED BY SIZE        27640000
276500*dmh           PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE        27650000
276600*dmh                                INTO DP013-MESSAGE-TEXT (2)   27660000
276700*dmh    MOVE DP081-RETCODE            TO  PV-RETCODE              27670000
276800*dmh    MOVE DP081-ERRNO              TO  PV-ERRNO                27680000
276900*dmh    STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE       27690000
277000*dmh           ' DP081-RETCODE - '        DELIMITED BY SIZE       27700000
277100*dmh           PV-RETCODE                 DELIMITED BY SIZE       27710000
277200*dmh           ' DP081-ERRNO - '          DELIMITED BY SIZE       27720000
277300*dmh           PV-ERRNO                   DELIMITED BY SIZE       27730000
277400*dmh                                 INTO DP013-MESSAGE-TEXT (3)  27740000
277500*dmh    MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          27750000
277600*dmh    MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        27760000
277700*dmh    MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        27770000
277800*dmh    MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        27780000
277900*dmh    STRING ' PRTR ID: '                DELIMITED BY SIZE      27790000
278000*dmh           SU001-PRINTER-ID-USE        DELIMITED BY SIZE      27800000
278100*dmh           '   OPER: '                 DELIMITED BY SIZE      27810000
278200*dmh           PV-DISPLAY-OPER             DELIMITED BY SIZE      27820000
278300*dmh           '   PO: '                   DELIMITED BY SIZE      27830000
278400*dmh           PV-DISPLAY-PO               DELIMITED BY SIZE      27840000
278500*dmh           '   RCVR: '                 DELIMITED BY SIZE      27850000
278600*dmh           PV-DISPLAY-RCVR             DELIMITED BY SIZE      27860000
278700*dmh           '   LINE: '                 DELIMITED BY SIZE      27870000
278800*dmh           PV-DISPLAY-LINE             DELIMITED BY SIZE      27880000
278900*dmh                                  INTO DP013-MESSAGE-TEXT (4) 27890000
279000*dmh    PERFORM 9999-WRITE-CICS-LOG-MSG                           27900000
279100** DMH - 3/24/05 - END                                            27910000
279200                                                                  27920000
279300*** BEGIN - FOR TESTING ONLY                                      27930000
279400*    ELSE                                                         27940000
279500*       MOVE ' SUKRF527 - CONNECT SOCKET SUCCESSFUL'              27950000
279600*                                           TO PV-CICS-MSG-AREA   27960000
279700*       PERFORM 9990-WRITE-CICS                                   27970000
279800*** END - FOR TESTING ONLY                                        27980000
279900     END-IF.                                                      27990000
280000                                                                  28000000
280100                                                                  28010000
280200*----------------------------------------------------------------*28020000
280300*  CLOSE THE SOCKET                                              *28030000
280400*----------------------------------------------------------------*28040000
280500 4340-CLOSE-SOCKET.                                               28050000
280600                                                                  28060000
280700     CALL 'EZASOKET'                                              28070000
280800         USING DP081-CLOSE-CMD                                    28080000
280900               DP081-SOCK-ID                                      28090000
281000               DP081-ERRNO                                        28100000
281100               DP081-RETCODE.                                     28110000
281200                                                                  28120000
281300     IF DP081-RETCODE < ZERO                                      28130000
281400        SET  PS-SOCKET-ERROR         TO TRUE                      28140000
281500        MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                   28150000
281600        MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                   28160000
281700        MOVE -1                      TO APRTIDL                   28170000
281800        MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME     28180000
281900        SET  DP081-TCP-IP-CLOSE-ERR  TO TRUE                      28190000
282000        MOVE DP081-ERRNO             TO DP081-TCP-IP-ERR-NBR      28200000
282100        SET  DP013-OTHER-ABEND       TO TRUE                      28210000
282200        SET  DP013-NO-ROLLBACK       TO TRUE                      28220000
282300        MOVE '4340-CLOSE-SOCKET'     TO DP013-PARAGRAPH           28230000
282400        MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)   28240000
282500        MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY        28250000
282600        MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT          28260000
282700        MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR       28270000
282800        STRING ' SUKRF527 - '            DELIMITED BY SIZE        28280000
282900               'DP081-FAMILY='           DELIMITED BY SIZE        28290000
283000               PV-DISPLAY-FAMILY         DELIMITED BY SIZE        28300000
283100               ' DP081-PORT='            DELIMITED BY SIZE        28310000
283200               PV-DISPLAY-PORT           DELIMITED BY SIZE        28320000
283300               ' DP081-IP-ADDR='         DELIMITED BY SIZE        28330000
283400               PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE        28340000
283500                                    INTO DP013-MESSAGE-TEXT (2)   28350000
283600        MOVE DP081-RETCODE            TO  PV-RETCODE              28360000
283700        MOVE DP081-ERRNO              TO  PV-ERRNO                28370000
283800        STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE       28380000
283900               ' DP081-RETCODE - '        DELIMITED BY SIZE       28390000
284000               PV-RETCODE                 DELIMITED BY SIZE       28400000
284100               ' DP081-ERRNO - '          DELIMITED BY SIZE       28410000
284200               PV-ERRNO                   DELIMITED BY SIZE       28420000
284300                                     INTO DP013-MESSAGE-TEXT (3)  28430000
284400        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          28440000
284500        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        28450000
284600        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        28460000
284700        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        28470000
284800        STRING ' PRTR ID: '                DELIMITED BY SIZE      28480000
284900               SU001-PRINTER-ID-USE        DELIMITED BY SIZE      28490000
285000               '   OPER: '                 DELIMITED BY SIZE      28500000
285100               PV-DISPLAY-OPER             DELIMITED BY SIZE      28510000
285200               '   PO: '                   DELIMITED BY SIZE      28520000
285300               PV-DISPLAY-PO               DELIMITED BY SIZE      28530000
285400               '   RCVR: '                 DELIMITED BY SIZE      28540000
285500               PV-DISPLAY-RCVR             DELIMITED BY SIZE      28550000
285600               '   LINE: '                 DELIMITED BY SIZE      28560000
285700               PV-DISPLAY-LINE             DELIMITED BY SIZE      28570000
285800                                      INTO DP013-MESSAGE-TEXT (4) 28580000
285900        PERFORM 9999-WRITE-CICS-LOG-MSG                           28590000
286000                                                                  28600000
286100*** BEGIN - FOR TESTING ONLY                                      28610000
286200*    ELSE                                                         28620000
286300*       MOVE ' SUKRF527 - CLOSE SOCKET SUCCESSFUL'                28630000
286400*                                           TO PV-CICS-MSG-AREA   28640000
286500*       PERFORM 9990-WRITE-CICS                                   28650000
286600*** END - FOR TESTING ONLY                                        28660000
286700                                                                  28670000
286800     END-IF.                                                      28680000
286900                                                                  28690000
287000                                                                  28700000
287100*----------------------------------------------------------------*28710000
287200*                                                                *28720000
287300*----------------------------------------------------------------*28730000
287400 4370-CREATE-TRANS-ID.                                            28740000
287500                                                                  28750000
287600     CALL PC-RANDOM-PGM USING DFHEIBLK                            28760000
287700                              DFHCOMMAREA                         28770000
287800                              DP902-RANDNBR-ROUTINE-FIELDS.       28780000
287900                                                                  28790000
288000     IF  DP902-SUCCESSFUL                                         28800000
288100         MOVE DP902-RANDOM-NUMBER    TO PV-RANDOM-NUMBER          28810000
288200         MOVE PV-RANDOM-1-8          TO PV-LPMS-TRANS-ID          28820000
288300         SET  PS-TRANS-ID-DUP        TO TRUE                      28830000
288400         PERFORM 4750-CK-TRANS-ID                                 28840000
288500                 UNTIL PS-TRANS-ID-NOT-DUP                        28850000
288600         PERFORM 4700-LABEL-HISTORY                               28860000
288700                                                                  28870000
288800     ELSE                                                         28880000
288900                                                                  28890000
289000         SET  PS-INVALID-TRANS-ID    TO TRUE                      28900000
289100         SET  PS-INVALID-INPUT       TO TRUE                      28910000
289200         MOVE DP015-UNP-NUM-BRT-MDT  TO ABATCHA                   28920000
289300         MOVE -1                     TO ABATCHL                   28930000
289400         MOVE PC-BAD-TRANS-NMBR      TO AMSGLNO                   28940000
289500         STRING ' SUKRF527 -'              DELIMITED BY SIZE      28950000
289600                ' 4370-CREATE-TRANS-ID -'  DELIMITED BY SIZE      28960000
289700                ' ERROR GENERATING RANDOM' DELIMITED BY SIZE      28970000
289800                ' NBR FOR LPMS TRANS ID'   DELIMITED BY SIZE      28980000
289900                                           INTO PV-CICS-MSG-AREA  28990000
290000         PERFORM 9990-WRITE-CICS                                  29000000
290100         MOVE   SU001-MANIFEST      TO PV-DISPLAY-MANIFEST        29010000
290200         STRING ' SUKRF527 -'              DELIMITED BY SIZE      29020000
290300                ' TRIP - '                 DELIMITED BY SIZE      29030000
290400                PV-DISPLAY-MANIFEST        DELIMITED BY SIZE      29040000
290500                '  USER ID - '             DELIMITED BY SIZE      29050000
290600                SU001-USER-ID              DELIMITED BY SIZE      29060000
290700                '  BATCH NUMBER - '        DELIMITED BY SIZE      29070000
290800                PV-BATCH-NUMBER-N          DELIMITED BY SIZE      29080000
290900                                           INTO PV-CICS-MSG-AREA  29090000
291000          MOVE LENGTH OF PV-CICS-MSG-AREA                         29100000
291100            TO PV-COMMAREA-LENGTH                                 29110000
291200         PERFORM 9990-WRITE-CICS                                  29120000
291300     END-IF.                                                      29130000
291400                                                                  29140000
291500                                                                  29150000
291600*----------------------------------------------------------------*29160000
291700*                                                                *29170000
291800*----------------------------------------------------------------*29180000
291900 4400-BLD-HDR-REC.                                                29190000
292000     INITIALIZE PC133-LABEL-HDR-REC.                              29200000
292100     SET  PC133-LABEL-HDR           TO  TRUE.                     29210000
292200                                                                  29220000
292300     MOVE PV-LPMS-TRANS-ID          TO  PC133-HDR-TRANS-ID.       29230000
292400     MOVE SU001-PRINTER-ID-USE      TO  PV-PRINTER-HOLD.          29240000
292500     MOVE PV-PRINTER-1-3            TO  PC133-HDR-PRTR-ID.        29250000
292600     MOVE SPACES                    TO  PC133-HDR-LBL-TYPE.       29260000
292700     MOVE SU001-PO                  TO  PC133-HDR-PO-NBR.         29270000
292800     MOVE SU001-RCVR-SEQ-NBR        TO  PC133-HDR-RCVR-SEQ.       29280000
292900     MOVE ZEROES                    TO  PC133-HDR-STORE-NBR.      29290000
293000     MOVE SPACES                    TO  PC133-HDR-PROC-AREA.      29300000
293100                                                                  29310000
293200     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    29320000
293300         '' BY SPACES.                                           29330000
293400     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    29340000
293500         ';' BY SPACES.                                           29350000
293600     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    29360000
293700         LOW-VALUES BY SPACES.                                    29370000
293800                                                                  29380000
293900     MOVE PC133-HDR-REC-LENGTH    TO DP081-TCPLENG                29390000
294000                                     DP081-NBR-BYTES.             29400000
294100     PERFORM 5100-SEND-DATA-TO-LPMS.                              29410000
294200                                                                  29420000
294300                                                                  29430000
294400*----------------------------------------------------------------*29440000
294500* BUILD DETAIL RECORD                                            *29450000
294600*----------------------------------------------------------------*29460000
294700 4500-BLD-DTL-REC.                                                29470000
294800**GB 4/21/02 CHECK TO NOT PRINT HEADER AND FOOTER FOR PRINT & PEEL29480000
294900     IF SU001-PRINT-AND-PEEL                                      29490000
295000        CONTINUE                                                  29500000
295100     ELSE                                                         29510000
295200        MOVE  ZEROES TO PV-TRAILER-COUNT                          29520000
295300        PERFORM 4800-CREATE-HEADER-LABEL                          29530000
295400     END-IF.                                                      29540000
295500                                                                  29550000
295600     SET PS-NOT-EOF-LBL-CURSOR TO TRUE.                           29560000
295700     MOVE SPACES TO PV-PREV-LABEL-TYPE.                           29570000
295800     PERFORM 4550-OPEN-LBL-CURSOR.                                29580000
295900*INITIAL FETCH                                                    29590000
296000     PERFORM 4555-FETCH-LBL-CURSOR.                               29600000
296100*                                                                 29610000
296200     PERFORM UNTIL PS-EOF-LBL-CURSOR                              29620000
296300        IF PS-SULBXF-NOT-FOUND                                    29630000
296400           CONTINUE                                               29640000
296500        ELSE                                                      29650000
296600           IF LBPTDA-CART-ACTN-CDE = 'U'                          29660000
296700              IF (LBPTDA-PO-NBR = PV-PREV-PO-NBR)           AND   29670000
296800                 (LBPTDA-PO-LNE-NBR = PV-PREV-PO-LNE-NBR)   AND   29680000
296900                 (LBPTDA-PREPK-ID = PV-PREV-PREPK-ID)       AND   29690000
297000                 (LBPTDA-OPER-UNT-ID = PV-PREV-OPER-UNT-ID) AND   29700000
297100                 (LBPTDA-TRIP-ID = PV-PREV-TRIP-ID)         AND   29710000
297200                 (LBPTDA-RCVR-SEQ-NBR = PV-PREV-RCVR-SEQ-NBR)     29720000
297300                    MOVE PV-PREV-CART-ACTN-CDE TO                 29730000
297400                                 LBPTDA-CART-ACTN-CDE             29740000
297500              ELSE                                                29750000
297600                  PERFORM 5000-AUDIT-STATUS-CHECK                 29760000
297700              END-IF                                              29770000
297800           END-IF                                                 29780000
297900           EVALUATE TRUE                                          29790000
298000                WHEN LBPTDA-CART-LBL-TYP-CDE = 'C'                29800000
298100                WHEN LBPTDA-CART-LBL-TYP-CDE = 'E'                29810000
298200                   PERFORM 4920-CREATE-CNSTK-LABEL                29820000
298300                WHEN LBPTDA-CART-LBL-TYP-CDE = 'P'                29830000
298400                   PERFORM 4910-CREATE-P2L-LABEL                  29840000
298500                WHEN LBPTDA-CART-LBL-TYP-CDE = 'S'                29850000
298600                   PERFORM 4900-CREATE-SML-LABEL                  29860000
298700* 07/19/13 RLK BEG                                                29870000
298800                WHEN LBPTDA-CART-LBL-TYP-CDE = 'D'                29880000
298900                   PERFORM 4940-CREATE-CRTN-LABEL                 29890000
299000                WHEN LBPTDA-CART-LBL-TYP-CDE = 'R'                29900000
299100* 07/19/13 RLK END                                                29910000
299200                   PERFORM 4915-CREATE-EC-REPURP-LBL              29920000
299300                WHEN LBPTDA-CART-LBL-TYP-CDE = 'Q'                29930000
299400                WHEN LBPTDA-CART-LBL-TYP-CDE = 'W'                29940000
299500                WHEN LBPTDA-CART-LBL-TYP-CDE = 'F'                29950000
299600                WHEN LBPTDA-CART-LBL-TYP-CDE = 'O'                29960000
299700                WHEN LBPTDA-CART-LBL-TYP-CDE = 'K'                29970000
299800                WHEN LBPTDA-CART-LBL-TYP-CDE = 'I'                29980000
299900                   PERFORM 4930-CREATE-MESSAGE-LABEL              29990000
300000           END-EVALUATE                                           30000000
300100           MOVE LBPTDA-CART-LBL-TYP-CDE TO PV-PREV-LABEL-TYPE     30010000
300200           MOVE SULBXF-CART-LBL-TYP-CDE                           30020000
300300                                  TO PV-PREV-SULBXF-LBL-TYP-CDE   30030000
300400           MOVE LBPTDA-DEST-OPER-UNT-ID                           30040000
300500                                  TO PV-PREV-DEST-OPER-UNT-ID     30050000
300600           MOVE LBPTDA-SKU-NBR                                    30060000
300700                                  TO PV-PREV-SKU-NBR              30070000
300800        END-IF                                                    30080000
300900        PERFORM 4555-FETCH-LBL-CURSOR                             30090000
301000     END-PERFORM                                                  30100000
301100                                                                  30110000
301200     PERFORM 4570-CLOSE-LBL-CURSOR.                               30120000
301300*GB 4/21/02                                                       30130000
301400     IF SU001-PRINT-AND-PEEL                                      30140000
301500        CONTINUE                                                  30150000
301600     ELSE                                                         30160000
301700        PERFORM 4810-CREATE-TRAILER-LABEL                         30170000
301800     END-IF.                                                      30180000
301900*                                                                 30190000
302000*                                                                 30200000
302100*----------------------------------------------------------------*30210000
302200* SEND HEADER LABEL                                              *30220000
302300*----------------------------------------------------------------*30230000
302400 4510-HDR-LABEL.                                                  30240000
302500     INITIALIZE PC133-LABEL-DTL-REC.                              30250000
302600     SET  PC133-LABEL-DTL           TO  TRUE.                     30260000
302700                                                                  30270000
302800     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       30280000
302900     SET  PC134-IDX-2               TO  PC134-IDX.                30290000
303000     MOVE PC134-HDR-LINE-LENGTH (PC134-IDX-2)                     30300000
303100                                    TO  PC133-DTL-LENGTH.         30310000
303200     MOVE PC134-SML-HEADER-LINE (PC134-IDX)                       30320000
303300                                    TO  PC133-DTL-DATA.           30330000
303400                                                                  30340000
303500     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    30350000
303600         '' BY SPACES.                                           30360000
303700     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    30370000
303800         ';' BY SPACES.                                           30380000
303900     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    30390000
304000         LOW-VALUES BY SPACES.                                    30400000
304100                                                                  30410000
304200******************************************************************30420000
304300* LENGTH CALCULATION:                                            *30430000
304400*       LINE LENGTH HEADER LABEL (PC134-HDR-LINE-LENGTH)         *30440000
304500*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *30450000
304600*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *30460000
304700*              PC133-DTL-LENGTH        (3 POSITIONS)             *30470000
304800*              HEX 03-END EACH DTL REC (1 POSITIONS)             *30480000
304900*              FILLER                  (6 POSITIONS)             *30490000
305000******************************************************************30500000
305100     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        30510000
305200     MOVE PC134-HDR-LINE-LENGTH (PC134-IDX-2)                     30520000
305300                                  TO PC133-DTL-REC-LENGTH.        30530000
305400     ADD  20                      TO PC133-DTL-REC-LENGTH.        30540000
305500     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                30550000
305600                                     DP081-NBR-BYTES.             30560000
305700                                                                  30570000
305800     PERFORM 5100-SEND-DATA-TO-LPMS.                              30580000
305900                                                                  30590000
306000     ADD  1  TO  PV-TRAILER-COUNT.                                30600000
306100                                                                  30610000
306200                                                                  30620000
306300*----------------------------------------------------------------*30630000
306400* OPEN LABEL CURSOR                                              *30640000
306500*----------------------------------------------------------------*30650000
306600 4550-OPEN-LBL-CURSOR.                                            30660000
306700                                                                  30670000
306800     EXEC SQL                                                     30680000
306900         OPEN LABEL_CURSOR                                        30690000
307000     END-EXEC.                                                    30700000
307100                                                                  30710000
307200     EVALUATE TRUE                                                30720000
307300         WHEN SQLCODE = +0                                        30730000
307400              SET PS-NOT-EOF-LBL-CURSOR  TO  TRUE                 30740000
307500         WHEN SQLCODE  NOT =  +0                                  30750000
307600              MOVE '4550-OPEN-LBL-CURSOR'                         30760000
307700                                  TO DP013-PARAGRAPH              30770000
307800              MOVE 'OPEN LABEL BATCH CURSOR'                      30780000
307900                                  TO DP013-MESSAGE-TEXT (1)       30790000
308000              MOVE SQLCA          TO DP013-SQLCA                  30800000
308100              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     30810000
308200              SET DP013-DB2-ABEND TO TRUE                         30820000
308300*             PERFORM 9999-WRITE-CICS-LOG-MSG                     30830000
308400             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              30840000
308500              PERFORM DP014-0000-PROCESS-ABEND                    30850000
308600     END-EVALUATE.                                                30860000
308700                                                                  30870000
308800                                                                  30880000
308900*----------------------------------------------------------------*30890000
309000* FETCH LABEL CURSOR                                             *30900000
309100*----------------------------------------------------------------*30910000
309200 4555-FETCH-LBL-CURSOR.                                           30920000
309300                                                                  30930000
309400     EXEC SQL                                                     30940000
309500          FETCH LABEL_CURSOR                                      30950000
309600          INTO :LBPTDA-TRIP-ID                                    30960000
309700              ,:LBPTDA-CRE-USR-ID                                 30970000
309800              ,:LBPTDA-LBL-PRT-BTCH-ID                            30980000
309900              ,:LBPTDA-SHIPT-UNT-ID                               30990000
310000              ,:LBPTDA-OPER-UNT-ID                                31000000
310100              ,:LBPTDA-FCLTY-ID                                   31010000
310200              ,:LBPTDA-CRE-TMST                                   31020000
310300              ,:LBPTDA-OWNR-SCAC-ID                               31030000
310400              ,:LBPTDA-VEH-NBR                                    31040000
310500              ,:LBPTDA-RPRT-IND                                   31050000
310600              ,:LBPTDA-SU-DUP-LBL-IND                             31060000
310700              ,:LBPTDA-SU-FRE-ASTRA-IND                           31070000
310800              ,:LBPTDA-SU-MSSG-DAT-IND                            31080000
310900              ,:LBPTDA-SU-MISDIR-IND                              31090000
311000              ,:LBPTDA-MISDIR-OPER-UNT-ID                         31100000
311100              ,:LBPTDA-PO-NBR                                     31110000
311200              ,:LBPTDA-RCVR-SEQ-NBR                               31120000
311300              ,:LBPTDA-PO-LNE-NBR                                 31130000
311400              ,:LBPTDA-DEST-OPER-UNT-ID                           31140000
311500              ,:LBPTDA-STR-NM                                     31150000
311600              ,:LBPTDA-STR-ZN-ID                                  31160000
311700              ,:LBPTDA-SKU-DEPT-NBR                               31170000
311800              ,:LBPTDA-SKU-CL-NBR                                 31180000
311900              ,:LBPTDA-VS-NBR                                     31190000
312000              ,:LBPTDA-OTPK-UNT-QTY                               31200000
312100              ,:LBPTDA-INPK-UNT-QTY                               31210000
312200              ,:LBPTDA-PRTR-ID                                    31220000
312300              ,:LBPTDA-BRCDE-NBR                                  31230000
312400              ,:LBPTDA-DC-PRTD-AT-CDE                             31240000
312500              ,:LBPTDA-INVLD-DAT-ERR-CDE                          31250000
312600              ,:LBPTDA-PREPK-ID                                   31260000
312700              ,:LBPTDA-PREPK-RATO-QTY                             31270000
312800              ,:LBPTDA-PREPK-UNT-QTY                              31280000
312900              ,:LBPTDA-CSE-PK-QTY                                 31290000
313000              ,:LBPTDA-ODD-CART-IND                               31300000
313100              ,:LBPTDA-INPK-CNVYB-IND                             31310000
313200              ,:LBPTDA-LBL-TYP-LBL-SEQ-ID                         31320000
313300              ,:LBPTDA-LBL-TYP-TOT-QTY                            31330000
313400              ,:LBPTDA-MODU-DESC                                  31340000
313500              ,:LBPTDA-ITM-NBR                                    31350000
313600              ,:LBPTDA-DEPT-DESC                                  31360000
313700              ,:LBPTDA-MAJ-CL-DESC                                31370000
313800              ,:LBPTDA-SEASET-NM                                  31380000
313900              ,:LBPTDA-FIXT-ID                                    31390000
314000              ,:LBPTDA-CART-LBL-TYP-CDE                           31400000
314100              ,:LBPTDA-STRG-AREA-CDE                              31410000
314200              ,:LBPTDA-CART-ACTN-CDE                              31420000
314300              ,:LBPTDA-HNG-FOLD-SEQ-NBR                           31430000
314400              ,:LBPTDA-BUS-AREA-ID                                31440000
314500              ,:LBPTDA-SKU-NBR                                    31450000
314600              ,:PV-DEPT-MAJ-CLASS-CONCAT                          31460000
314700              ,:LBPTDA-EAS-TAG-IND                                31470000
314800              ,:LBPTDA-DOOR-ID                                    31480000
314900*dmh 07/01/2015 start                                             31490000
315000              ,:LBPTDA-LBL-MSG-TXT                                31500000
315100*dmh 07/01/2015 end                                               31510000
315200*CLP 06/20/2013 PR5148B START                                     31520000
315300              ,:LBPTDA-PRC-MSG-CDE   :PV-NULL-IND                 31530000
315400*CLP 06/20/2013 PR5148B END                                       31540000
315500     END-EXEC.                                                    31550000
315600                                                                  31560000
315700     EVALUATE TRUE                                                31570000
315800         WHEN SQLCODE = ZERO                                      31580000
315900             EVALUATE TRUE                                        31590000
316000               WHEN LBPTDA-CART-LBL-TYP-CDE = 'F'                 31600000
316100               WHEN LBPTDA-CART-LBL-TYP-CDE = 'I'                 31610000
316200               WHEN LBPTDA-CART-LBL-TYP-CDE = 'K'                 31620000
316300               WHEN LBPTDA-CART-LBL-TYP-CDE = 'O'                 31630000
316400               WHEN LBPTDA-CART-LBL-TYP-CDE = 'Q'                 31640000
316500               WHEN LBPTDA-CART-LBL-TYP-CDE = 'R'                 31650000
316600               WHEN LBPTDA-CART-LBL-TYP-CDE = 'W'                 31660000
316700               WHEN LBPTDA-CART-LBL-TYP-CDE = 'D'                 31670000
316800               WHEN LBPTDA-CART-ACTN-CDE    = 'Q'                 31680000
316900                   SET  PS-SULBXF-FOUND  TO TRUE                  31690000
317000               WHEN OTHER                                         31700000
317100                   PERFORM 4556-GET-LABEL-STATUS                  31710000
317200             END-EVALUATE                                         31720000
317300*            PERFORM 4558-CALL-XLKUT-DOMAIN                       31730000
317400         WHEN SQLCODE = +100                                      31740000
317500              SET PS-EOF-LBL-CURSOR TO TRUE                       31750000
317600         WHEN SQLWARN0 NOT = +0                                   31760000
317700         WHEN SQLCODE < ZERO                                      31770000
317800         WHEN SQLCODE > ZERO                                      31780000
317900              MOVE '4555-FETCH-LBL-CURSOR'                        31790000
318000                                  TO DP013-PARAGRAPH              31800000
318100              MOVE 'FETCH LABEL BATCH CURSOR'                     31810000
318200                                  TO DP013-MESSAGE-TEXT (1)       31820000
318300              MOVE SQLCA          TO DP013-SQLCA                  31830000
318400              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     31840000
318500              SET DP013-DB2-ABEND TO TRUE                         31850000
318600              SET DP013-NO-ROLLBACK                               31860000
318700                              TO TRUE                             31870000
318800*             PERFORM 9999-WRITE-CICS-LOG-MSG                     31880000
318900             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              31890000
319000              PERFORM DP014-0000-PROCESS-ABEND                    31900000
319100     END-EVALUATE.                                                31910000
319200                                                                  31920000
319300*----------------------------------------------------------------*31930000
319400* CHECK LABEL STATUS                                             *31940000
319500*----------------------------------------------------------------*31950000
319600 4556-GET-LABEL-STATUS.                                           31960000
319700     MOVE LBPTDA-BRCDE-NBR     TO DK-BARCODE-NBR                  31970000
319800     SET  PS-SULBXF-NOT-FOUND  TO TRUE                            31980000
319900                                                                  31990000
320000*    PERFORM                                                      32000000
320100*        WITH TEST AFTER                                          32010000
320200*        VARYING PV-RETRY-COUNTER                                 32020000
320300*        FROM 1 BY 1                                              32030000
320400*        UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32040000
320500*                  OR (SQLCODE = ZERO)                            32050000
320600*                  OR (SQLCODE = +100))                           32060000
320700                                                                  32070000
320800         EXEC SQL                                                 32080000
320900              SELECT CART_LBL_TYP_CDE                             32090000
321000              INTO :SULBXF-CART-LBL-TYP-CDE                       32100000
321100              FROM TSULBXF                                        32110000
321200              WHERE BRCDE_NBR  = :DK-BARCODE-NBR                  32120000
321300                AND STAT_CDE   = 'A'                              32130000
321400                AND SHIPT_UNT_ID = :LBPTDA-SHIPT-UNT-ID           32140000
321500             WITH UR                                              32150000
321600         END-EXEC                                                 32160000
321700                                                                  32170000
321800     EVALUATE TRUE                                                32180000
321900         WHEN SQLCODE = ZERO                                      32190000
322000              SET  PS-SULBXF-FOUND  TO TRUE                       32200000
322100         WHEN SQLCODE = +100                                      32210000
322200              SET  PS-SULBXF-NOT-FOUND     TO TRUE                32220000
322300         WHEN SQLCODE = -911                                      32230000
322400         WHEN SQLCODE = -913                                      32240000
322500         WHEN SQLCODE = -904                                      32250000
322600             CONTINUE                                             32260000
322700         WHEN OTHER                                               32270000
322800             STRING ' SUKRF527 - '            DELIMITED BY SIZE   32280000
322900                     'DK-BARCODE-NBR: '        DELIMITED BY SIZE  32290000
323000                      DK-BARCODE-NBR           DELIMITED BY SIZE  32300000
323100                                          INTO PV-CICS-MSG-AREA   32310000
323200             MOVE LENGTH OF PV-CICS-MSG-AREA                      32320000
323300                     TO PV-COMMAREA-LENGTH                        32330000
323400             PERFORM 9990-WRITE-CICS                              32340000
323500                                                                  32350000
323600             MOVE '4556-GET-LABEL-STATUS'                         32360000
323700                                            TO DP013-PARAGRAPH    32370000
323800             MOVE 'SUKRF527 - GET LABEL STATUS CODE'              32380000
323900                             TO DP013-MESSAGE-TEXT(1)             32390000
324000             MOVE   LBPTDA-OPER-UNT-ID      TO  PV-DISPLAY-OPER   32400000
324100             MOVE   LBPTDA-TRIP-ID          TO  PV-DISPLAY-TRIP   32410000
324200             MOVE   LBPTDA-LBL-PRT-BTCH-ID  TO  PV-DISPLAY-BATCH  32420000
324300             MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO     32430000
324400             MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR   32440000
324500             MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE   32450000
324600             STRING 'OPER UNIT: '                                 32460000
324700                    PV-DISPLAY-OPER                               32470000
324800                    '   DK-BARCODE-NBR: '                         32480000
324900                     DK-BARCODE-NBR                               32490000
325000                    '   BATCH NO: '                               32500000
325100                    PV-DISPLAY-BATCH        DELIMITED BY SIZE     32510000
325200                                       INTO DP013-MESSAGE-TEXT(2) 32520000
325300             STRING 'TRIP ID: '                                   32530000
325400                    PV-DISPLAY-TRIP                               32540000
325500                    '   SCAC: '                                   32550000
325600                    LBPTDA-OWNR-SCAC-ID                           32560000
325700                    '   TRLR: '                                   32570000
325800                    LBPTDA-VEH-NBR          DELIMITED BY SIZE     32580000
325900                                        INTO DP013-MESSAGE-TEXT(3)32590000
326000             STRING '   OPER: '                                   32600000
326100                    PV-DISPLAY-OPER                               32610000
326200                    'PO: '                                        32620000
326300                    PV-DISPLAY-PO                                 32630000
326400                    '   RCVR: '                                   32640000
326500                    PV-DISPLAY-RCVR                               32650000
326600                    '   LINE: '                                   32660000
326700                    PV-DISPLAY-LINE         DELIMITED BY SIZE     32670000
326800                                       INTO DP013-MESSAGE-TEXT(4) 32680000
326900             MOVE SQLCA      TO DP013-SQLCA                       32690000
327000             MOVE 'TSULBXF'  TO DP013-DB2-TABLE-NAME(1)           32700000
327100             SET DP013-DB2-ABEND            TO TRUE               32710000
327200             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              32720000
327300             PERFORM DP014-0000-PROCESS-ABEND                     32730000
327400         END-EVALUATE.                                            32740000
327500*    END-PERFORM.                                                 32750000
327600                                                                  32760000
327700*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32770000
327800*              AND SQLCODE NOT = ZERO                             32780000
327900*                                                                 32790000
328000*        STRING ' SUKRF527 - '                                    32800000
328100*               'DK-BARCODE-NBR: '                                32810000
328200*                DK-BARCODE-NBR           DELIMITED BY SIZE       32820000
328300*                                          INTO PV-CICS-MSG-AREA  32830000
328400*        MOVE LENGTH OF PV-CICS-MSG-AREA                          32840000
328500*                    TO PV-COMMAREA-LENGTH                        32850000
328600*        PERFORM 9990-WRITE-CICS                                  32860000
328700*                                                                 32870000
328800*        MOVE '4556-GET-LABEL-STATUS'                             32880000
328900*                            TO DP013-PARAGRAPH                   32890000
329000*        MOVE 'SUKRF527 - GET LABEL STATUS CODE'                  32900000
329100*                            TO DP013-MESSAGE-TEXT(1)             32910000
329200*        MOVE   LBPTDA-OPER-UNT-ID          TO PV-DISPLAY-OPER    32920000
329300*        MOVE   LBPTDA-TRIP-ID              TO PV-DISPLAY-TRIP    32930000
329400*        MOVE   LBPTDA-LBL-PRT-BTCH-ID      TO PV-DISPLAY-BATCH   32940000
329500*        MOVE   LBPTDA-PO-NBR               TO PV-DISPLAY-PO      32950000
329600*        MOVE   LBPTDA-RCVR-SEQ-NBR         TO PV-DISPLAY-RCVR    32960000
329700*        MOVE   LBPTDA-PO-LNE-NBR           TO PV-DISPLAY-LINE    32970000
329800*        STRING 'OPER UNIT: '                                     32980000
329900*               PV-DISPLAY-OPER                                   32990000
330000*               '   DK-BARCODE-NBR: '                             33000000
330100*                DK-BARCODE-NBR                                   33010000
330200*               '   BATCH NO: '                                   33020000
330300*               PV-DISPLAY-BATCH        DELIMITED BY SIZE         33030000
330400*                                      INTO DP013-MESSAGE-TEXT(2) 33040000
330500*        STRING 'TRIP ID: '                                       33050000
330600*               PV-DISPLAY-TRIP                                   33060000
330700*               '   SCAC: '                                       33070000
330800*               LBPTDA-OWNR-SCAC-ID                               33080000
330900*               '   TRLR: '                                       33090000
331000*               LBPTDA-VEH-NBR          DELIMITED BY SIZE         33100000
331100*                                      INTO DP013-MESSAGE-TEXT(3) 33110000
331200*        STRING '   OPER: '                                       33120000
331300*               PV-DISPLAY-OPER                                   33130000
331400*               'PO: '                                            33140000
331500*               PV-DISPLAY-PO                                     33150000
331600*               '   RCVR: '                                       33160000
331700*               PV-DISPLAY-RCVR                                   33170000
331800*               '   LINE: '                                       33180000
331900*               PV-DISPLAY-LINE         DELIMITED BY SIZE         33190000
332000*                                      INTO DP013-MESSAGE-TEXT(4) 33200000
332100*        MOVE SQLCA      TO DP013-SQLCA                           33210000
332200*        MOVE 'TSULBXF'  TO DP013-DB2-TABLE-NAME(1)               33220000
332300*        SET DP013-DB2-ABEND                TO TRUE               33230000
332400*            SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              33240000
332500*        PERFORM DP014-0000-PROCESS-ABEND                         33250000
332600*    END-IF.                                                      33260000
332700                                                                  33270000
332800*                                                                 33280000
332900 4558-CALL-XLKUT-DOMAIN.                                          33290000
333000     INITIALIZE XL001-ITEM-COMMAREA.                              33300000
333100                                                                  33310000
333200     MOVE LBPTDA-SKU-NBR        TO XL001-KEY-SKU.                 33320000
333300                                                                  33330000
333400     SET  XL001-BY-NUMERIC-SKU                                    33340000
333500          XL001-SELECT-VND-STYL TO TRUE.                          33350000
333600                                                                  33360000
333700     CALL XL001-VSM-PGM USING  DFHEIBLK                           33370000
333800                               XL001-COMMAREA                     33380000
333900                               XL001-ITEM-COMMAREA.               33390000
334000     EVALUATE TRUE                                                33400000
334100                                                                  33410000
334200         WHEN XL001-VND-STYL-SQLCODE = +0                         33420000
334300             CONTINUE                                             33430000
334400                                                                  33440000
334500         WHEN XL001-INVALID-ACCESS                                33450000
334600             MOVE '4558-CALL-XLKUT-DOMAIN'                        33460000
334700                             TO DP013-PARAGRAPH                   33470000
334800             MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'            33480000
334900                             TO DP013-MESSAGE-TEXT (1)            33490000
335000             MOVE LBPTDA-SKU-NBR                                  33500000
335100                             TO PV-DISPLAY-SKU                    33510000
335200             MOVE PV-DISPLAY-SKU                                  33520000
335300                             TO DP013-MESSAGE-TEXT (2)            33530000
335400             MOVE SQLCA      TO DP013-SQLCA                       33540000
335500             MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)          33550000
335600             SET DP013-DB2-ABEND to true                          33560000
335700             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              33570000
335800             PERFORM DP014-0000-PROCESS-ABEND                     33580000
335900                                                                  33590000
336000         WHEN OTHER                                               33600000
336100             MOVE '4558-CALL-XLKUT-DOMAIN'                        33610000
336200                             TO DP013-PARAGRAPH                   33620000
336300             MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'                33630000
336400                             TO DP013-MESSAGE-TEXT (1)            33640000
336500             MOVE LBPTDA-SKU-NBR                                  33650000
336600                             TO PV-DISPLAY-SKU                    33660000
336700             MOVE PV-DISPLAY-SKU                                  33670000
336800                             TO DP013-MESSAGE-TEXT (2)            33680000
336900             MOVE XL001-SKU-SQLCODE                               33690000
337000                             TO SQLCODE                           33700000
337100             MOVE SQLCA      TO DP013-SQLCA                       33710000
337200             MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)          33720000
337300             SET DP013-DB2-ABEND                                  33730000
337400                             TO TRUE                              33740000
337500             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              33750000
337600             PERFORM DP014-0000-PROCESS-ABEND                     33760000
337700     END-EVALUATE.                                                33770000
337800*                                                                 33780000
337900*----------------------------------------------------------------*33790000
338000* BUILD SML LABEL FORM                                           *33800000
338100*----------------------------------------------------------------*33810000
338200 4559-BUILD-SML-FORM.                                             33820000
338300     INITIALIZE PC133-LABEL-DTL-REC.                              33830000
338400     SET  PC133-LABEL-DTL           TO  TRUE.                     33840000
338500                                                                  33850000
338600     IF  LBPTDA-CART-ACTN-CDE = PC-Q                              33860000
338700         MOVE SPACES                 TO  PC255-SML-BARCODE        33870000
338800         MOVE LBPTDA-BRCDE-NBR       TO  PC255-AUDIT-BARCODE      33880000
338900         IF LBPTDA-SU-FRE-ASTRA-IND =  PC-T                       33890000
339000            SET PC255-FSTY-AUDIT-YES TO TRUE                      33900000
339100         ELSE                                                     33910000
339200*CLP 11/07/13 - START                                             33920000
339300            IF LBPTDA-PRC-MSG-CDE = PC-RA                         33930000
339400               SET PC255-AUDIT-RFID-YES  TO TRUE                  33940000
339500            ELSE                                                  33950000
339600               IF LBPTDA-PRC-MSG-CDE = PC-QR                      33960000
339700                  SET PC255-AUDIT-QCRD-YES  TO TRUE               33970000
339800               ELSE                                               33980000
339900                  SET PC255-AUDIT-HDG-YES  TO TRUE                33990000
340000               END-IF                                             34000000
340100            END-IF                                                34010000
340200         END-IF                                                   34020000
340300*CLP 11/07/13 - END                                               34030000
340400                                                                  34040000
340500         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO  PC255-SET           34050000
340600         MOVE '@@'                        TO PC255-MDSE-GROUP     34060000
340700         SET PC255-AUDIT-NBR-SIDE                                 34070000
340800             PC255-MFST-BOX-NO                                    34080000
340900             PC255-TRIP-HDG                                       34090000
341000             PC255-DEFLT-PRESENTATION                             34100000
341100             PC255-STR-REV-NO                                     34110000
341200             PC255-TEST-LNE-NO                                    34120000
341300             PC255-NO-ZONE-HDG                                    34130000
341400             PC255-AUDIT-YES                                      34140000
341500             PC255-FORM-NO-STORE-ON-HAND                          34150000
341600             PC255-EAS-TAG-NOT-NEEDED                             34160000
341700             PC255-OH-ZERO-NO                                     34170000
341800             PC255-FORM-NO-FIX-HDG                                34180000
341900*DMH6/30/11  PC255-FIXTURE-NO                                     34190000
342000             PC256-FIXTURE-HDG-NO                                 34200000
342100             PC255-FORM-NO-FIXTURE                                34210000
342200             PC255-FORM-NO-TEXT-1                                 34220000
342300             PC255-FORM-NO-TEXT-2                                 34230000
342400             PC255-FORM-NO-TEXT-3                                 34240000
342500             PC255-FORM-NO-TEXT-4     TO TRUE                     34250000
342600         MOVE  SPACES                 TO  PC256-FIXTURE           34260000
342700     ELSE                                                         34270000
342800                                                                  34280000
342900         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO  PC255-SET           34290000
343000                                                                  34300000
343100         MOVE '@@@@@@@@@@@@@@@@@@@@' TO  PC255-SML-BARCODE        34310000
343200         SET PC255-SML-BRCD                                       34320000
343300             PC255-AUDIT-HDG-NO                                   34330000
343400             PC255-MFST-BOX-YES                                   34340000
343500             PC255-BRCD-NBR-ABOVE                                 34350000
343600             PC255-STR-REV-YES                                    34360000
343700             PC255-TEST-LNE-YES                                   34370000
343800             PC255-ZONE-HDG                                       34380000
343900             PC255-SET-HDG           TO TRUE                      34390000
344000     END-IF.                                                      34400000
344100                                                                  34410000
344200     SET PC255-CRTN-HDG                                           34420000
344300         PC255-FORM-NO-FIX-HDG          TO TRUE.                  34430000
344400*DMH6/30 PC255-FIXTURE-NO               TO TRUE.                  34440000
344500                                                                  34450000
344600*FIXTURE REVERSE IMAGE  ----  added 12/14/10 dmh                  34460000
344700*DMH6/30  LBPTDA-FIXT-ID  >  SPACES                               34470000
344800*DMH6/30  SET  PC255-FIXTURE-YES  TO  TRUE                        34480000
344900*DMH  ELSE                                                        34490000
345000*DMH6/30  SET  PC255-FIXTURE-NO   TO  TRUE                        34500000
345100*DMH  END-IF.                                                     34510000
345200                                                                  34520000
345300*PREPACK ORDERS                                                   34530000
345400     IF  LBPTDA-PREPK-ID > 0                                      34540000
345500         SET PS-PREPK-FORM              TO TRUE                   34550000
345600         SET PC255-PACK-HDG             TO TRUE                   34560000
345700         MOVE LBPTDA-PREPK-ID           TO PC255-PO-LNE-NBR       34570000
345800     ELSE                                                         34580000
345900         SET PS-NOT-PREPK-FORM          TO TRUE                   34590000
346000         SET PC255-LINE-HDG             TO TRUE                   34600000
346100         MOVE LBPTDA-PO-LNE-NBR         TO PC255-PO-LNE-NBR       34610000
346200     END-IF                                                       34620000
346300                                                                  34630000
346400*INNER PACK CONVEYABLE                                            34640000
346500     IF  LBPTDA-INPK-CNVYB-IND = 'Y'                              34650000
346600         SET PC255-FORM-INPK-BOX        TO TRUE                   34660000
346700         SET PC255-FORM-INPK-HDG        TO TRUE                   34670000
346800     ELSE                                                         34680000
346900         SET PC255-FORM-NO-INPK-BOX     TO TRUE                   34690000
347000         SET PC255-FORM-NO-UNT-HDG      TO TRUE                   34700000
347100     END-IF                                                       34710000
347200                                                                  34720000
347300*REPRINT                                                          34730000
347400     IF  PS-REPRINT-BATCH  OR                                     34740000
347500         LBPTDA-RPRT-IND  =  PC-Y                                 34750000
347600         SET PC255-FORM-REPRT-BOX       TO  TRUE                  34760000
347700         SET PC255-FORM-REPRT-FLD       TO  TRUE                  34770000
347800         SET  PS-REPRINT-FORM           TO  TRUE                  34780000
347900     ELSE                                                         34790000
348000         SET  PC255-FORM-NO-RPRT-BOX    TO  TRUE                  34800000
348100         SET  PC255-FORM-NO-RPRT-FLD    TO  TRUE                  34810000
348200         SET  PS-NOT-REPRINT-FORM       TO  TRUE                  34820000
348300     END-IF.                                                      34830000
348400***                                                               34840000
348500     MOVE LBPTDA-DC-PRTD-AT-CDE     TO  PV-DSPLY-DC.              34850000
348600     MOVE '-'                       TO  PV-DSPLY-DASH.            34860000
348700     MOVE SU001-PRINTER-ID-USE      TO  PV-DSPLY-PRTR-ID.         34870000
348800     MOVE PV-DSPLY-PRTR             TO  PC255-SML-PRTR-NBR.       34880000
348900*                                                                 34890000
349000     MOVE PV-CURRENT-DB2-DATE       TO  PV-WORK-DB2-DATE.         34900000
349100     MOVE PV-WORK-YY                TO  PV-LBL-DATE-YY.           34910000
349200     MOVE PV-WORK-MM                TO  PV-LBL-DATE-MM.           34920000
349300     MOVE PV-WORK-DD                TO  PV-LBL-DATE-DD.           34930000
349400     MOVE '-'                       TO  PV-LBL-DASH1              34940000
349500                                        PV-LBL-DASH2.             34950000
349600     MOVE PV-LBL-DATE               TO  PC255-LBL-PRT-DATE.       34960000
349700*                                                                 34970000
349800     MOVE PV-CURRENT-TIME           TO  PC255-LBL-PRT-TIME.       34980000
349900*                                                                 34990000
350000     MOVE 'CI'                      TO  PC255-FROM-APPLICATION.   35000000
350100     IF  SU001-BATCH-PRINTER                                      35010000
350200         MOVE 'BATCH'               TO  PC255-PRTR-ATTACHED       35020000
350300     ELSE                                                         35030000
350400     IF  SU001-TETHERED-PRINTER                                   35040000
350500         MOVE 'CABLE'               TO  PC255-PRTR-ATTACHED       35050000
350600     ELSE                                                         35060000
350700         MOVE 'OTHER'               TO  PC255-PRTR-ATTACHED       35070000
350800     END-IF                                                       35080000
350900     END-IF.                                                      35090000
351000     MOVE '-SML-'                   TO  PC255-LBL-DESC.           35100000
351100     MOVE PC255-LABEL-INFO-WORK     TO  PC255-LABEL-INFO.         35110000
351200*                                                                 35120000
351300                                                                  35130000
351400     SET  PC255-FORM-NO-FIXTURE     TO TRUE.                      35140000
351500                                                                  35150000
351600*REGULAR SML OR QC AUDIT BARCODE                                  35160000
351700     IF  LBPTDA-CART-ACTN-CDE = PC-Q                              35170000
351800         MOVE SPACES                 TO  PC255-SML-BARCODE        35180000
351900         MOVE LBPTDA-BRCDE-NBR       TO  PC255-AUDIT-BARCODE      35190000
352000         IF LBPTDA-SU-FRE-ASTRA-IND =  PC-T                       35200000
352100            SET PC255-FSTY-AUDIT-YES TO TRUE                      35210000
352200         ELSE                                                     35220000
352300*CLP 11/07/13 - START                                             35230000
352400            IF LBPTDA-PRC-MSG-CDE = PC-RA                         35240000
352500               SET PC255-AUDIT-RFID-YES  TO TRUE                  35250000
352600            ELSE                                                  35260000
352700               IF LBPTDA-PRC-MSG-CDE = PC-QR                      35270000
352800                  SET PC255-AUDIT-QCRD-YES  TO TRUE               35280000
352900               ELSE                                               35290000
353000                  SET PC255-AUDIT-HDG-YES  TO TRUE                35300000
353100               END-IF                                             35310000
353200            END-IF                                                35320000
353300         END-IF                                                   35330000
353400*CLP 11/07/13 - END                                               35340000
353500                                                                  35350000
353600         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO  PC255-SET           35360000
353700                                                                  35370000
353800         SET PC255-AUDIT-BRCD                                     35380000
353900             PC255-OH-ZERO-NO                                     35390000
354000*DMH6/30/11  PC255-FIXTURE-NO                                     35400000
354100             PC255-MFST-BOX-NO                                    35410000
354200             PC255-AUDIT-NBR-SIDE                                 35420000
354300             PC255-TRIP-HDG                                       35430000
354400             PC255-DEFLT-PRESENTATION TO TRUE                     35440000
354500     ELSE                                                         35450000
354600                                                                  35460000
354700         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO  PC255-SET           35470000
354800                                                                  35480000
354900         MOVE '@@@@@@@@@@@@@@@@@@@@' TO  PC255-SML-BARCODE        35490000
355000         SET PC255-SML-BRCD                                       35500000
355100             PC255-AUDIT-HDG-NO                                   35510000
355200             PC255-MFST-BOX-YES                                   35520000
355300             PC255-BRCD-NBR-ABOVE                                 35530000
355400             PC255-SET-HDG                   TO TRUE              35540000
355500         IF XL088-PROCESS-MSG-YES                                 35550000
355600            SET PC255-OH-ZERO-YES TO TRUE                         35560000
355700         ELSE                                                     35570000
355800            SET PC255-OH-ZERO-NO  TO TRUE                         35580000
355900         END-IF                                                   35590000
356000     END-IF.                                                      35600000
356100                                                                  35610000
356200                                                                  35620000
356300*REGULAR SML OR QC AUDIT BARCODE                                  35630000
356400     MOVE LBPTDA-CART-ACTN-CDE TO PV-PREV-AUDIT-CART-IND          35640000
356500                                                                  35650000
356600     IF LBPTDA-CART-ACTN-CDE > SPACES                             35660000
356700        MOVE LBPTDA-CART-ACTN-CDE TO PC255-AUDIT-CASI             35670000
356800     ELSE                                                         35680000
356900        MOVE '@'                  TO PC255-AUDIT-CASI             35690000
357000     END-IF                                                       35700000
357100                                                                  35710000
357200     EVALUATE LBPTDA-HNG-FOLD-SEQ-NBR                             35720000
357300        WHEN  PC-0                                                35730000
357400            SET PC255-DEFLT-PRESENTATION TO TRUE                  35740000
357500        WHEN  PC-1                                                35750000
357600            SET PC255-HANG  TO TRUE                               35760000
357700        WHEN  PC-2                                                35770000
357800            SET PC255-FOLD  TO TRUE                               35780000
357900        WHEN  OTHER                                               35790000
358000            SET PC255-DEFLT-PRESENTATION TO TRUE                  35800000
358100     END-EVALUATE                                                 35810000
358200                                                                  35820000
358300     MOVE LBPTDA-CRE-USR-ID         TO  PC255-USER-ID.            35830000
358400                                                                  35840000
358500*                                                                 35850000
358600*                                                                 35860000
358700*----------------------------------------------------------------*35870000
358800* SEND SML LABEL FORM                                            *35880000
358900*----------------------------------------------------------------*35890000
359000 4560-SEND-SML-FORM.                                              35900000
359100     INITIALIZE PC133-LABEL-DTL-REC.                              35910000
359200     SET  PC133-LABEL-DTL           TO  TRUE.                     35920000
359300                                                                  35930000
359400     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       35940000
359500     SET  PC255-IDX-2               TO  PC255-IDX.                35950000
359600     MOVE PC255-DTL-FORM-LNE-LNGTH (PC255-IDX-2)                  35960000
359700                                    TO  PC133-DTL-LENGTH.         35970000
359800     MOVE PC255-SHIP-MFST-LBL-LINE (PC255-IDX)                    35980000
359900                                    TO  PC133-DTL-DATA.           35990000
360000                                                                  36000000
360100     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    36010000
360200         '' BY SPACES.                                           36020000
360300     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    36030000
360400         ';' BY SPACES.                                           36040000
360500     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    36050000
360600         LOW-VALUES BY SPACES.                                    36060000
360700                                                                  36070000
360800******************************************************************36080000
360900* LENGTH CALCULATION:                                            *36090000
361000*       LINE LENGTH SML FORM     (PC255-DTL-FORM-LNE-LNGTH)      *36100000
361100*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *36110000
361200*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *36120000
361300*              PC133-DTL-LENGTH        (3 POSITIONS)             *36130000
361400*              HEX 03-END EACH DTL REC (1 POSITIONS)             *36140000
361500*              FILLER                  (6 POSITIONS)             *36150000
361600******************************************************************36160000
361700     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        36170000
361800     MOVE PC255-DTL-FORM-LNE-LNGTH (PC255-IDX-2)                  36180000
361900                                  TO PC133-DTL-REC-LENGTH.        36190000
362000     ADD  20                      TO PC133-DTL-REC-LENGTH.        36200000
362100     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                36210000
362200                                     DP081-NBR-BYTES.             36220000
362300                                                                  36230000
362400     PERFORM 5100-SEND-DATA-TO-LPMS.                              36240000
362500                                                                  36250000
362600     ADD  1  TO  PV-TRAILER-COUNT.                                36260000
362700*                                                                 36270000
362800*                                                                 36280000
362900*----------------------------------------------------------------*36290000
363000*  BUILD SML LABEL DATA                                          *36300000
363100*----------------------------------------------------------------*36310000
363200 4561-BUILD-SML-DATA.                                             36320000
363300*----------------------------------------------------------------*36330000
363400     INITIALIZE PC133-LABEL-DTL-REC.                              36340000
363500     SET PC133-LABEL-DTL           TO  TRUE.                      36350000
363600                                                                  36360000
363700*CRTN                                                             36370000
363800         MOVE LBPTDA-SHIPT-UNT-ID      TO  PV-SHIPT-UNT-ID-NUM    36380000
363900         MOVE PV-SHIPT-UNT-14-18       TO  PC256-CARTON-ID        36390000
364000*PO/RCVR                                                          36400000
364100         MOVE LBPTDA-PO-NBR            TO  PV-PO-NUMBER           36410000
364200         MOVE LBPTDA-RCVR-SEQ-NBR      TO  PV-PO-RECEIVER         36420000
364300         MOVE PV-PO-RCVR               TO  PC256-PO-RCVR          36430000
364400         MOVE LBPTDA-PO-LNE-NBR        TO  PC256-LINE-NBR         36440000
364500*DOOR ID                                                          36450000
364600         SET PC256-DOOR-HDG-YES        TO  TRUE                   36460000
364700         IF LBPTDA-DOOR-ID > SPACES                               36470000
364800            MOVE LBPTDA-DOOR-ID        TO PC256-DOOR-NUMBER       36480000
364900         ELSE                                                     36490000
365000            SET PC256-DOOR-NBR-NO      TO  TRUE                   36500000
365100         END-IF                                                   36510000
365200*SKU                                                              36520000
365300         IF LBPTDA-SKU-NBR > ZERO                                 36530000
365400                                                                  36540000
365500             MOVE LBPTDA-SKU-DEPT-NBR  TO PV-SML-DEPT1            36550000
365600             MOVE LBPTDA-SKU-CL-NBR TO PV-SML-CLASS-NBR1          36560000
365700             MOVE LBPTDA-SKU-NBR       TO PV-SML-SKU              36570000
365800             MOVE PV-SML-SKU-NUMBER    TO PC256-SKU               36580000
365900         ELSE                                                     36590000
366000             MOVE SPACES               TO PC256-SKU               36600000
366100         END-IF                                                   36610000
366200*STYLE                                                            36620000
366300         MOVE LBPTDA-VS-NBR            TO PC256-STYLE             36630000
366400* EAS TAG INDICATOR                                               36640000
366500         IF LBPTDA-EAS-TAG-IND  = 'Y'                             36650000
366600            SET PC256-EAS-TAG-YES TO TRUE                         36660000
366700         ELSE                                                     36670000
366800            SET PC256-EAS-TAG-NO  TO TRUE                         36680000
366900         END-IF                                                   36690000
367000*                                                                 36700000
367100*OUTER PK UNTS                                                    36710000
367200*        MOVE LBPTDA-OTPK-UNT-QTY                                 36720000
367300*                                      TO PV-OTPK-QTY             36730000
367400*        MOVE PV-OTPK-UNIT-QTY                                    36740000
367500*                                      TO PC256-OTPK-UNIT         36750000
367600                                                                  36760000
367700         SET  PS-NO-MSG-1                                         36770000
367800              PS-NO-MSG-2              TO TRUE                    36780000
367900         SET  PC256-TEXT-1-NO          TO TRUE                    36790000
368000                                                                  36800000
368100         IF  LBPTDA-SU-MSSG-DAT-IND  =  PC-Y                      36810000
368200             MOVE PC-NOT-FOUND-MSG                                36820000
368300                                       TO PC256-TEXT-1            36830000
368400             SET PS-YES-MSG-1                                     36840000
368500                 PS-YES-MSG-2  TO TRUE                            36850000
368600         ELSE                                                     36860000
368700         IF  LBPTDA-SU-DUP-LBL-IND  =  PC-Y                       36870000
368800             MOVE PC-DUPLICATE-SCAN-MSG                           36880000
368900                                       TO PC256-TEXT-1            36890000
369000             SET PS-YES-MSG-1                                     36900000
369100                 PS-YES-MSG-2  TO TRUE                            36910000
369200         ELSE                                                     36920000
369300         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-R                     36930000
369400             MOVE PC-FREE-ASTRY-NO-RCVR-MSG                       36940000
369500                                       TO PC256-TEXT-1            36950000
369600             SET PS-YES-MSG-1                                     36960000
369700                 PS-YES-MSG-2      TO TRUE                        36970000
369800         ELSE                                                     36980000
369900         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-T                     36990000
370000             MOVE PC-FREE-ASTRY-NO-TRIP-MSG                       37000000
370100                                       TO PC256-TEXT-1            37010000
370200             SET PS-YES-MSG-1                                     37020000
370300                 PS-YES-MSG-2      TO TRUE                        37030000
370400         END-IF                                                   37040000
370500         END-IF                                                   37050000
370600         END-IF                                                   37060000
370700         END-IF                                                   37070000
370800                                                                  37080000
370900         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-Y                     37090000
371000             IF PS-NO-MSG-1                                       37100000
371100                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   37110000
371200                                       TO PC256-TEXT-1            37120000
371300                 SET PS-YES-MSG-1  TO TRUE                        37130000
371400             ELSE                                                 37140000
371500             IF PS-NO-MSG-2                                       37150000
371600                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   37160000
371700                                       TO PC256-TEXT-1            37170000
371800                 SET PS-YES-MSG-2  TO TRUE                        37180000
371900             END-IF                                               37190000
372000             END-IF                                               37200000
372100         END-IF                                                   37210000
372200                                                                  37220000
372300         IF  LBPTDA-SU-MISDIR-IND  =  PC-Y                        37230000
372400             IF PS-NO-MSG-1                                       37240000
372500                 MOVE PC-MISDIRECT-MSG                            37250000
372600                                       TO PC256-TEXT-1            37260000
372700                 SET PS-YES-MSG-1  TO TRUE                        37270000
372800             ELSE                                                 37280000
372900             IF PS-NO-MSG-2                                       37290000
373000                 MOVE PC-MISDIRECT-MSG                            37300000
373100                                       TO PC256-TEXT-1            37310000
373200                 SET PS-YES-MSG-2  TO TRUE                        37320000
373300             END-IF                                               37330000
373400             END-IF                                               37340000
373500         END-IF                                                   37350000
373600**                                                                37360000
373700        MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'                37370000
373800                                        TO PC256-POG-PROGRAM-NAME 37380000
373900*DMH 07/01/2015 START                                             37390000
374000        IF LBPTDA-LBL-MSG-TXT-TEXT   > SPACES                     37400000
374100           MOVE LBPTDA-LBL-MSG-TXT-TEXT                           37410000
374200                                        TO PC256-POG-PROGRAM-NAME 37420000
374300*DMH 07/01/2015 END                                               37430000
374400        ELSE                                                      37440000
374500           MOVE PV-DEPT-MAJ-CLASS-CONCAT                          37450000
374600                                    TO PC256-POG-PROGRAM-NAME     37460000
374700        END-IF                                                    37470000
374800        MOVE SPACES TO LBPTDA-LBL-MSG-TXT-TEXT                    37480006
374900**                                                                37490000
375000         MOVE LBPTDA-CART-ACTN-CDE TO PC256-AUDIT-IND             37500000
375100         EVALUATE LBPTDA-HNG-FOLD-SEQ-NBR                         37510000
375200            WHEN  PC-1                                            37520000
375300                SET PC256-HANG  TO TRUE                           37530000
375400            WHEN  PC-2                                            37540000
375500                SET PC256-FOLD  TO TRUE                           37550000
375600            WHEN  OTHER                                           37560000
375700                SET PC256-DEFLT-PRESENTATION TO TRUE              37570000
375800         END-EVALUATE                                             37580000
375900                                                                  37590000
376000*                                                                 37600000
376100*BARCODE                                                          37610000
376200                                                                  37620000
376300                                                                  37630000
376400      IF LBPTDA-CART-ACTN-CDE = PC-Q                              37640000
376500         SET PC256-OH-ZERO-MSG-NO                                 37650000
376600             PC256-EAS-TAG-NO                                     37660000
376700             PC256-TEXT-1-NO                                      37670000
376800             PC256-TEXT-2-NO                                      37680000
376900             PC256-TEXT-3-NO                                      37690000
377000             PC256-TEXT-4-NO      TO TRUE                         37700000
377100            MOVE LBPTDA-BRCDE-NBR    TO  PC256-AUDIT-BARCODE      37710000
377200                                         PC256-BARCODE-TEXT       37720000
377300            MOVE SPACES                                           37730000
377400                                     TO  PC256-AUDIT-FILLER       37740000
377500                                         PC256-SML-STR-NBR        37750000
377600            MOVE '@@'                TO PC256-MDSE-GROUP          37760000
377700            SET PC256-DEFLT-PRESENTATION TO TRUE                  37770000
377800                                                                  37780000
377900            IF  LBPTDA-TRIP-ID    >  ZERO                         37790000
378000                SET  PC256-TRIP-HDG   TO TRUE                     37800000
378100                MOVE LBPTDA-TRIP-ID   TO  PC256-SEASET            37810000
378200            ELSE                                                  37820000
378300                SET  PC256-SEASET-HDG-NO         TO TRUE          37830000
378400                SET  PC256-SEASET-NO             TO TRUE          37840000
378500            END-IF                                                37850000
378600                                                                  37860000
378700*PREPACK ORDERS                                                   37870000
378800           IF LBPTDA-PREPK-ID > 0                                 37880000
378900              MOVE LBPTDA-PREPK-ID       TO PC256-LINE-NBR        37890000
379000           ELSE                                                   37900000
379100              MOVE LBPTDA-PO-LNE-NBR     TO PC256-LINE-NBR        37910000
379200           END-IF                                                 37920000
379300           MOVE '@@@@'                TO PC256-OTPK-UNIT          37930000
379400                                                                  37940000
379500*INNER PACK CONVEYABLE                                            37950000
379600           IF LBPTDA-INPK-CNVYB-IND = 'Y'                         37960000
379700              MOVE LBPTDA-INPK-UNT-QTY   TO PV-INPK-QTY           37970000
379800              MOVE PV-INPK-UNIT-QTY      TO PC256-OTPK-UNIT       37980000
379900           END-IF                                                 37990000
380000      ELSE                                                        38000000
380100             MOVE  LBPTDA-BRCDE-NBR       TO  PV-2O-DIGIT-BARCODE 38010000
380200             MOVE  PV-20-SML-CONTAINER-CDE                        38020000
380300               TO  PC160-20-SML-NBR-CONTAINER-CDE                 38030000
380400             MOVE  PV-20-SML-PACKAGING-TYP                        38040000
380500               TO  PC160-20-SML-NBR-PACKAGING-TYP                 38050000
380600             MOVE  PV-20-SML-SOFTWARE-SRC                         38060000
380700               TO  PC160-20-SML-NBR-SOFTWARE-SRC                  38070000
380800             MOVE  PV-20-SML-BC-DIVERT                            38080000
380900               TO  PC160-20-SML-NBR-BC-DIVERT                     38090000
381000             MOVE  PV-20-SML-BC-DC-ORIGIN                         38100000
381100               TO  PC160-20-SML-NBR-BC-DC-ORIGIN                  38110000
381200             MOVE  PV-20-SML-BC-MNFST-NBR                         38120000
381300               TO  PC160-20-SML-NBR-BC-MNFST-NBR                  38130000
381400                                                                  38140000
381500             MOVE PC160-20-DIGIT-BARCODE-NBR TO PC256-BARCODE-TEXT38150000
381600             MOVE LBPTDA-BRCDE-NBR           TO PC256-SML-BARCODE 38160000
381700* SEASONAL SET                                                    38170000
381800         IF  LBPTDA-SEASET-NM  >  SPACES                          38180000
381900             SET  PC256-SEASET-HDG-YES TO TRUE                    38190000
382000             MOVE LBPTDA-SEASET-NM     TO  PC256-SEASET           38200000
382100         ELSE                                                     38210000
382200             SET  PC256-SEASET-HDG-NO  TO TRUE                    38220000
382300             SET  PC256-SEASET-NO      TO TRUE                    38230000
382400         END-IF                                                   38240000
382500*STORE NUMBER                                                     38250000
382600             IF LBPTDA-STR-NM   =  PC-FLAT                        38260000
382700                MOVE   ZEROES              TO  PV-STORE-NBR       38270000
382800                MOVE   PV-STORE-NBR        TO  PC256-SML-STR-NBR  38280000
382900             ELSE                                                 38290000
383000                MOVE LBPTDA-DEST-OPER-UNT-ID TO  PV-STORE-NBR     38300000
383100                MOVE PV-STORE-NBR            TO  PC256-SML-STR-NBR38310000
383200             END-IF                                               38320000
383300                                                                  38330000
383400* MERCHANDISE GROUP                                               38340000
383500             IF  LBPTDA-BUS-AREA-ID > ZEROES                      38350000
383600                 MOVE LBPTDA-BUS-AREA-ID   TO PC256-MDSE-GROUP    38360000
383700             ELSE                                                 38370000
383800                 MOVE '@@'                 TO PC256-MDSE-GROUP    38380000
383900             END-IF                                               38390000
384000                                                                  38400000
384100                                                                  38410000
384200*PREPACK ORDERS                                                   38420000
384300           IF LBPTDA-PREPK-ID > 0                                 38430000
384400              MOVE LBPTDA-PREPK-ID       TO PC256-LINE-NBR        38440000
384500           ELSE                                                   38450000
384600              MOVE LBPTDA-PO-LNE-NBR     TO PC256-LINE-NBR        38460000
384700           END-IF                                                 38470000
384800           MOVE '@@@@'                TO PC256-OTPK-UNIT          38480000
384900                                                                  38490000
385000*INNER PACK CONVEYABLE                                            38500000
385100           IF LBPTDA-INPK-CNVYB-IND = 'Y'                         38510000
385200              MOVE LBPTDA-INPK-UNT-QTY   TO PV-INPK-QTY           38520000
385300              MOVE PV-INPK-UNIT-QTY      TO PC256-OTPK-UNIT       38530000
385400           END-IF                                                 38540000
385500*                                                                 38550000
385600                                                                  38560000
385700           IF XL088-PROCESS-MSG-YES                               38570000
385800              MOVE XL088-PROCESS-MESSAGE-TXT                      38580000
385900                              TO PC256-ON-HAND-ERR-MSG            38590000
386000           ELSE                                                   38600000
386100              SET PC256-OH-ZERO-MSG-NO TO TRUE                    38610000
386200           END-IF                                                 38620000
386300                                                                  38630000
386400*   FIXTURE ID                                                    38640000
386500           IF  LBPTDA-FIXT-ID  >  SPACES                          38650000
386600               SET PC256-FIXTURE-HDG-YES TO TRUE                  38660000
386700               MOVE LBPTDA-FIXT-ID       TO  PC256-FIXTURE        38670000
386800           ELSE                                                   38680000
386900               SET  PC256-FIXTURE-HDG-NO TO TRUE                  38690000
387000               MOVE '@@@@@@@@@@'         TO  PC256-FIXTURE        38700000
387100           END-IF                                                 38710000
387200*                                                                 38720000
387300*                                                                 38730000
387400           IF XL088-PROCESS-MSG-YES AND XL088-FIRST-STORE-RCPT    38740000
387500              MOVE PV-FIRST-STORE-RCPT-TXT-1 TO PC256-TEXT-1      38750000
387600              MOVE PV-FIRST-STORE-RCPT-TXT-2 TO PC256-TEXT-2      38760000
387700              MOVE PV-FIRST-STORE-RCPT-TXT-3 TO PC256-TEXT-3      38770000
387800              SET PC256-TEXT-4-NO            TO TRUE              38780000
387900           ELSE                                                   38790000
388000              SET PC256-TEXT-1-NO                                 38800000
388100                  PC256-TEXT-2-NO                                 38810000
388200                  PC256-TEXT-3-NO                                 38820000
388300                  PC256-TEXT-4-NO            TO TRUE              38830000
388400           END-IF                                                 38840000
388500      END-IF.                                                     38850000
388600                                                                  38860012
388700* WR41309-RF ID 8/30/2012  AME  BEGIN                             38870000
388800                                                                  38880013
388900      IF PS-RF-ID-FOUND-YES                                       38890013
389000         EVALUATE PV-PRC-MSG-CDE                                  38900013
389100         WHEN 'RD'                                                38910013
389200            MOVE PV-RFID-STORE-TXT-4    TO PC256-TEXT-4           38920013
389300         WHEN 'EA'                                                38930013
389400            MOVE PV-EAS-STORE-TXT-4  TO PC256-TEXT-4              38940013
389500         WHEN 'RE'                                                38950013
389600            MOVE PV-EAS-RF-STORE-TXT-4  TO PC256-TEXT-4           38960013
389700         WHEN OTHER                                               38970013
389800            SET PC256-TEXT-4-NO TO TRUE                           38980013
389900         END-EVALUATE                                             38990013
390000      ELSE                                                        39000013
390100         EVALUATE LBPTDA-PRC-MSG-CDE                              39010013
390200         WHEN 'RD'                                                39020013
390300            MOVE PV-RFID-STORE-TXT-4    TO PC256-TEXT-4           39030013
390400         WHEN 'EA'                                                39040013
390500            MOVE PV-EAS-STORE-TXT-4     TO PC256-TEXT-4           39050013
390600         WHEN 'RE'                                                39060013
390700            MOVE PV-EAS-RF-STORE-TXT-4  TO PC256-TEXT-4           39070013
390800         WHEN OTHER                                               39080013
390900            SET PC256-TEXT-4-NO TO TRUE                           39090013
391000         END-EVALUATE                                             39100013
391100      END-IF                                                      39110013
391200* WR41309-RF ID 8/30/2012  AME  END                               39120000
391300                                                                  39130000
391400      MOVE PC-01                    TO PC256-SML-LBL-QTY          39140000
391500                                                                  39150000
391600      MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                              39160000
391700                                    TO PC256-LABEL-NBR.           39170000
391800      MOVE PC-OF                    TO PC256-LABEL-OF.            39180000
391900      MOVE LBPTDA-LBL-TYP-TOT-QTY   TO PC256-TOT-LABEL.           39190000
392000                                                                  39200000
392100*                                                                 39210000
392200* SEND SML LABEL DATA                                            *39220000
392300*----------------------------------------------------------------*39230000
392400 4562-SEND-SML-DATA.                                              39240000
392500     SET  PC133-LABEL-DTL           TO  TRUE.                     39250000
392600     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       39260000
392700     SET  PC256-IDX-2               TO  PC256-IDX.                39270000
392800     MOVE PC256-DTL-DATA-LNE-LNGTH (PC256-IDX-2)                  39280000
392900                                    TO  PC133-DTL-LENGTH.         39290000
393000     MOVE PC256-SML-LABEL-LINE (PC256-IDX)                        39300000
393100                                    TO  PC133-DTL-DATA.           39310000
393200                                                                  39320000
393300     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    39330000
393400         '' BY SPACES.                                           39340000
393500     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    39350000
393600         ';' BY SPACES.                                           39360000
393700     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    39370000
393800         LOW-VALUES BY SPACES.                                    39380000
393900                                                                  39390000
394000******************************************************************39400000
394100* LENGTH CALCULATION:                                            *39410000
394200*       LINE LENGTH SML DATA     (PC256-DTL-DATA-LNE-LNGTH)      *39420000
394300*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *39430000
394400*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *39440000
394500*              PC133-DTL-LENGTH        (3 POSITIONS)             *39450000
394600*              HEX 03-END EACH DTL REC (1 POSITIONS)             *39460000
394700*              FILLER                  (6 POSITIONS)             *39470000
394800******************************************************************39480000
394900     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        39490000
395000     MOVE PC256-DTL-DATA-LNE-LNGTH (PC256-IDX-2)                  39500000
395100                                  TO PC133-DTL-REC-LENGTH.        39510000
395200     ADD  20                      TO PC133-DTL-REC-LENGTH.        39520000
395300     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                39530000
395400                                     DP081-NBR-BYTES.             39540000
395500                                                                  39550000
395600     PERFORM 5100-SEND-DATA-TO-LPMS.                              39560000
395700                                                                  39570000
395800     ADD  1  TO  PV-TRAILER-COUNT.                                39580000
395900*                                                                 39590000
396000*                                                                 39600000
396100*----------------------------------------------------------------*39610000
396200* BUILD CS LABEL FORM                                            *39620000
396300*----------------------------------------------------------------*39630000
396400 4563-BUILD-CS-FORM.                                              39640000
396500     INITIALIZE PC133-LABEL-DTL-REC.                              39650000
396600     SET  PC133-LABEL-DTL           TO  TRUE.                     39660000
396700                                                                  39670000
396800*    SET PC205-SML-BC-FORM-20                                     39680000
396900*        PC205-SML-BC-FORM-20-END   TO TRUE.                      39690000
397000                                                                  39700000
397100*ODD CRTN                                                         39710000
397200     MOVE PC205-FORM-NO-ODD-BOX                                   39720000
397300                                    TO PC205-ODD-CARTON-BOX       39730000
397400     MOVE PC205-FORM-NO-ODD-FLD                                   39740000
397500                                    TO PC205-ODD-CARTON-FIELD     39750000
397600                                                                  39760000
397700*AUDIT INDICATOR                                                  39770000
397800******** MOVE LBPTDA-CART-ACTN-CDE TO PC205-AUDIT-IND             39780000
397900** GB 8/10/05                                                     39790000
398000     IF LBPTDA-CART-ACTN-CDE > SPACES                             39800000
398100        MOVE LBPTDA-CART-ACTN-CDE TO PC205-AUDIT-IND              39810000
398200     ELSE                                                         39820000
398300        MOVE '@'                  TO PC205-AUDIT-IND              39830000
398400     END-IF                                                       39840000
398500                                                                  39850000
398600*INNER PACK CONVEYABLE                                            39860000
398700     IF  LBPTDA-INPK-CNVYB-IND = 'Y'                              39870000
398800         MOVE PC205-FORM-INPK-BOX       TO PC205-INPK-CONVY-BOX   39880000
398900     ELSE                                                         39890000
399000         MOVE PC205-FORM-NO-INPK-BOX    TO PC205-INPK-CONVY-BOX   39900000
399100     END-IF                                                       39910000
399200                                                                  39920000
399300*REPRINT                                                          39930000
399400     IF  PS-REPRINT-BATCH  OR                                     39940000
399500*LMM     LBPTDA-RPRT-IND  =  PC-R                                 39950000
399600         LBPTDA-RPRT-IND  =  PC-Y                                 39960000
399700         MOVE PC205-FORM-REPRT-BOX      TO  PC205-REPRINT-BOX     39970000
399800         MOVE PC205-FORM-REPRT-FLD      TO  PC205-REPRINT-TEXT    39980000
399900         SET  PS-REPRINT-FORM           TO  TRUE                  39990000
400000     ELSE                                                         40000000
400100         MOVE PC205-FORM-NO-RPRT-BOX    TO  PC205-REPRINT-BOX     40010000
400200         MOVE PC205-FORM-NO-RPRT-FLD    TO  PC205-REPRINT-TEXT    40020000
400300         SET  PS-NOT-REPRINT-FORM       TO  TRUE                  40030000
400400     END-IF.                                                      40040000
400500*CRTN                                                             40050000
400600     MOVE 'CRTN:'                   TO  PC205-CRTN-HDG.           40060000
400700*PRTR                                                             40070000
400800     MOVE '#'                       TO  PV-DISPLAY-NUM.           40080000
400900     MOVE LBPTDA-DC-PRTD-AT-CDE     TO  PV-DISPLAY-DC.            40090000
401000     MOVE '-'                       TO  PV-DISPLAY-DASH.          40100000
401100     MOVE SU001-PRINTER-ID-USE      TO  PV-DISPLAY-PRTR-ID.       40110000
401200     MOVE PV-DISPLAY-PRTR           TO  PC205-SML-PRTR-NBR.       40120000
401300*                                                                 40130000
401400*LABEL COUNT                                                      40140000
401500     MOVE PC205-FORM-OF             TO  PC205-LABEL-CNT.          40150000
401600     MOVE LBPTDA-LBL-TYP-TOT-QTY    TO  PC205-TOT-LBL-CNT.        40160000
401700*                                                                 40170000
401800*DATE                                                             40180000
401900     MOVE PV-CURRENT-DB2-DATE       TO  PV-WORK-DB2-DATE.         40190000
402000     MOVE PV-WORK-YY                TO  PV-LBL-DATE-YY.           40200000
402100     MOVE PV-WORK-MM                TO  PV-LBL-DATE-MM.           40210000
402200     MOVE PV-WORK-DD                TO  PV-LBL-DATE-DD.           40220000
402300     MOVE '-'                       TO  PV-LBL-DASH1              40230000
402400                                        PV-LBL-DASH2.             40240000
402500     MOVE PV-LBL-DATE               TO  PC205-LBL-PRT-DATE.       40250000
402600*TIME                                                             40260000
402700     MOVE PV-CURRENT-TIME           TO  PC205-LBL-PRT-TIME.       40270000
402800*                                                                 40280000
402900*LABEL DESC                                                       40290000
403000*    MOVE PC205-CI-CTL-STK-LBL      TO  PC205-SML-LBL-DESC.       40300000
403100*                                                                 40310000
403200*ZONE                                                             40320000
403300     IF LBPTDA-CART-LBL-TYP-CDE = 'C'                             40330000
403400        MOVE LBPTDA-STR-ZN-ID          TO  PC205-STR-ZN-ID        40340000
403500     ELSE                                                         40350000
403600        MOVE '@@@@@'                   TO  PC205-STR-ZN-ID        40360000
403700     END-IF                                                       40370000
403800*                                                                 40380000
403900*RCVR                                                             40390000
404000     MOVE LBPTDA-PO-NBR             TO  PV-PO-NUMBER.             40400000
404100     MOVE LBPTDA-RCVR-SEQ-NBR       TO  PV-PO-RECEIVER.           40410000
404200     MOVE PV-PO-RCVR                TO  PC205-PO-RCVR-NBR.        40420000
404300*                                                                 40430000
404400*LINE NUMBER                                                      40440000
404500     MOVE LBPTDA-PO-LNE-NBR         TO  PV-LINE-NBR.              40450000
404600     MOVE PV-PO-LINE-NBR            TO  PC205-PO-LNE-NBR.         40460000
404700*                                                                 40470000
404800*SKU                                                              40480000
404900     MOVE LBPTDA-SKU-DEPT-NBR       TO  PV-CS-DEPT.               40490000
405000     MOVE LBPTDA-SKU-CL-NBR         TO  PV-CS-CLASS-NBR.          40500000
405100     MOVE LBPTDA-SKU-NBR            TO  PV-CS-SKU.                40510000
405200     MOVE PV-CS-SKU-NUMBER          TO  PC205-SKU-NBR.            40520000
405300                                                                  40530000
405400*SKU FOR RDM ITEM NUMBER BARCODE                                  40540000
405500     MOVE LBPTDA-SKU-NBR            TO  PV-CS-SKU-ONLY.           40550000
405600     MOVE PV-CS-SKU-NBR             TO  PC205-ITEM-NBR-BC.        40560000
405700     MOVE PV-CS-SKU-NBR             TO  PC205-ITEM-NBR-BC-NBR.    40570000
405800*STYLE                                                            40580000
405900     MOVE LBPTDA-VS-NBR             TO  PC205-STYLE.              40590000
406000*                                                                 40600000
406100*INNER PACK UNITS                                                 40610000
406200     MOVE LBPTDA-INPK-CNVYB-IND                                   40620000
406300                                 TO  PV-PREV-INPK-CNVYB-IND       40630000
406400     IF  LBPTDA-INPK-CNVYB-IND = 'Y'                              40640000
406500         MOVE PC205-FORM-INPK-HDG                                 40650000
406600                                    TO  PC205-INPK-CONVY-TEXT     40660000
406700         MOVE LBPTDA-INPK-UNT-QTY                                 40670000
406800                                    TO  PV-INPK-QTY               40680000
406900         MOVE PV-INPK-UNIT-QTY                                    40690000
407000                                    TO  PC205-PACK-UNT            40700000
407100     ELSE                                                         40710000
407200*OUTER PK UNTS                                                    40720000
407300         MOVE PC205-FORM-OTPK-HDG                                 40730000
407400                                    TO  PC205-INPK-CONVY-TEXT     40740000
407500         MOVE LBPTDA-OTPK-UNT-QTY                                 40750000
407600                                    TO PV-OTPK-QTY                40760000
407700         MOVE PV-OTPK-UNIT-QTY                                    40770000
407800                                    TO PC205-PACK-UNT             40780000
407900     END-IF.                                                      40790000
408000*USER ID                                                          40800000
408100                                                                  40810000
408200     MOVE LBPTDA-CRE-USR-ID         TO  PC205-USER-ID.            40820000
408300                                                                  40830000
408400*reverse image store number                                       40840000
408500                                                                  40850000
408600     MOVE PC205-FORM-NO-REVRSE-STR  TO  PC205-REVERSE-STORE-BOX.  40860000
408700                                                                  40870000
408800*                                                                 40880000
408900*                                                                 40890000
409000*                                                                 40900000
409100*----------------------------------------------------------------*40910000
409200* SEND CS LABEL FORM                                             *40920000
409300*----------------------------------------------------------------*40930000
409400 4564-SEND-CS-FORM.                                               40940000
409500     INITIALIZE PC133-LABEL-DTL-REC.                              40950000
409600     SET  PC133-LABEL-DTL           TO  TRUE.                     40960000
409700                                                                  40970000
409800     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       40980000
409900     SET  PC205-IDX-2               TO  PC205-IDX.                40990000
410000     MOVE PC205-SML-FORM-LINE-LENGTH (PC205-IDX-2)                41000000
410100                                    TO  PC133-DTL-LENGTH.         41010000
410200     MOVE PC205-SHIP-MFST-LBL-LINE (PC205-IDX)                    41020000
410300                                    TO  PC133-DTL-DATA.           41030000
410400                                                                  41040000
410500     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    41050000
410600         '' BY SPACES.                                           41060000
410700     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    41070000
410800         ';' BY SPACES.                                           41080000
410900     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    41090000
411000         LOW-VALUES BY SPACES.                                    41100000
411100                                                                  41110000
411200******************************************************************41120000
411300* LENGTH CALCULATION:                                            *41130000
411400*       LINE LENGTH SML FORM     (PC205-SML-FORM-LINE-LENGTH)    *41140000
411500*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *41150000
411600*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *41160000
411700*              PC133-DTL-LENGTH        (3 POSITIONS)             *41170000
411800*              HEX 03-END EACH DTL REC (1 POSITIONS)             *41180000
411900*              FILLER                  (6 POSITIONS)             *41190000
412000******************************************************************41200000
412100     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        41210000
412200     MOVE PC205-SML-FORM-LINE-LENGTH (PC205-IDX-2)                41220000
412300                                  TO PC133-DTL-REC-LENGTH.        41230000
412400     ADD  20                      TO PC133-DTL-REC-LENGTH.        41240000
412500     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                41250000
412600                                     DP081-NBR-BYTES.             41260000
412700                                                                  41270000
412800     PERFORM 5100-SEND-DATA-TO-LPMS.                              41280000
412900                                                                  41290000
413000     ADD  1  TO  PV-TRAILER-COUNT.                                41300000
413100*                                                                 41310000
413200*                                                                 41320000
413300*----------------------------------------------------------------*41330000
413400*  BUILD CS LABEL DATA                                           *41340000
413500*----------------------------------------------------------------*41350000
413600 4565-BUILD-CS-DATA.                                              41360000
413700         INITIALIZE PC133-LABEL-DTL-REC.                          41370000
413800         SET PC133-LABEL-DTL           TO  TRUE.                  41380000
413900*CRTN                                                             41390000
414000         MOVE LBPTDA-SHIPT-UNT-ID                                 41400000
414100                                       TO  PV-SHIPT-UNT-ID        41410000
414200         MOVE PV-LAST-FIVE-DIGITS                                 41420000
414300                                       TO  PC189-CARTON-NBR       41430000
414400* GB 12/20/01 BEG                                                 41440000
414500*AUDIT INDICATOR                                                  41450000
414600         MOVE LBPTDA-CART-ACTN-CDE TO PC189-AUDIT-IND             41460000
414700* GB 12/20/01 END                                                 41470000
414800                                                                  41480000
414900*STORE NAME & NUMBER                                              41490000
415000         MOVE LBPTDA-STR-NM            TO  PC189-SML-STR-NME      41500000
415100         MOVE LBPTDA-DEST-OPER-UNT-ID  TO  PV-STORE-NBR           41510000
415200         MOVE PV-STORE-NBR             TO  PC189-SML-STR-NBR      41520000
415300* LINE NUMBER                                                     41530000
415400         MOVE LBPTDA-PO-LNE-NBR        TO  PV-LINE-NBR            41540000
415500         MOVE PV-PO-LINE-NBR           TO  PC189-LINE-NUMBER      41550000
415600*NUMBER OF LABELS                                                 41560000
415700         MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                           41570000
415800                                       TO  PC189-LABEL-NUMBER-N   41580000
415900         MOVE 1                        TO  PC189-SML-TOT-LBLS     41590000
416000*TOTAL NUMBER OF LABELS                                           41600000
416100      MOVE LBPTDA-LBL-TYP-TOT-QTY    TO  PC189-TOT-LBL-CNT.       41610000
416200*RCVR                                                             41620000
416300     MOVE LBPTDA-PO-NBR             TO  PV-PO-NUMBER.             41630000
416400     MOVE LBPTDA-RCVR-SEQ-NBR       TO  PV-PO-RECEIVER.           41640000
416500     MOVE PV-PO-RCVR                TO  PC189-PO-RCVR.            41650000
416600*SKU                                                              41660000
416700     MOVE LBPTDA-SKU-DEPT-NBR       TO  PV-CS-DEPT.               41670000
416800     MOVE LBPTDA-SKU-CL-NBR         TO  PV-CS-CLASS-NBR.          41680000
416900     MOVE LBPTDA-SKU-NBR            TO  PV-CS-SKU.                41690000
417000     MOVE PV-CS-SKU-NUMBER          TO  PC189-DEPT-CL-SKU.        41700000
417100                                                                  41710000
417200*SKU FOR RDM ITEM NUMBER BARCODE                                  41720000
417300     MOVE LBPTDA-SKU-NBR            TO  PV-CS-SKU-ONLY.           41730000
417400     MOVE PV-CS-SKU-NBR             TO  PC189-ITEM-NBR.           41740000
417500     MOVE PV-CS-SKU-NBR             TO  PC189-ITEM-NBR-BC.        41750000
417600*STYLE                                                            41760000
417700     MOVE LBPTDA-VS-NBR             TO  PC189-STYLE.              41770000
417800                                                                  41780000
417900*LABEL TYPE                                                       41790000
418000     IF LBPTDA-CART-LBL-TYP-CDE = 'C'                             41800000
418100        MOVE  PC189-CI-CTL-STK-LBL     TO  PC189-SML-LBL-DESC     41810000
418200        MOVE  PC189-ZONE-HDG-VALUE     TO  PC189-ZONE-STRG-HDG    41820000
418300        MOVE  LBPTDA-STR-ZN-ID         TO  PC189-ZONE-STRG-DESC   41830000
418400     ELSE                                                         41840000
418500     IF LBPTDA-CART-LBL-TYP-CDE = 'E'                             41850000
418600        MOVE  PC189-CI-E-COMM-LBL      TO  PC189-SML-LBL-DESC     41860000
418700        MOVE  PC189-STORAGE-HDG-VALUE  TO  PC189-ZONE-STRG-HDG    41870000
418800        IF    LBPTDA-STRG-AREA-CDE  > SPACES                      41880000
418900              MOVE LBPTDA-STRG-AREA-CDE TO PC189-ZONE-STRG-DESC   41890000
419000        ELSE                                                      41900000
419100              MOVE '@@@@@'  TO PC189-ZONE-STRG-DESC               41910000
419200        END-IF                                                    41920000
419300     END-IF                                                       41930000
419400     END-IF                                                       41940000
419500*BARCODE                                                          41950000
419600         MOVE LBPTDA-BRCDE-NBR         TO  PV-2O-DIGIT-BARCODE    41960000
419700         MOVE SPACES                   TO  PC189-SML-BC           41970000
419800                                                                  41980000
419900         MOVE  PV-20-SML-CONTAINER-CDE                            41990000
420000           TO  PC160-20-SML-CONTAINER-CDE                         42000000
420100               PC160-20-SML-NBR-CONTAINER-CDE                     42010000
420200         MOVE  PV-20-SML-PACKAGING-TYP                            42020000
420300           TO  PC160-20-SML-PACKAGING-TYP                         42030000
420400               PC160-20-SML-NBR-PACKAGING-TYP                     42040000
420500         MOVE  PV-20-SML-SOFTWARE-SRC                             42050000
420600           TO  PC160-20-SML-SOFTWARE-SRC                          42060000
420700               PC160-20-SML-NBR-SOFTWARE-SRC                      42070000
420800         MOVE  PV-20-SML-BC-DIVERT                                42080000
420900           TO  PC160-20-SML-BC-DIVERT                             42090000
421000               PC160-20-SML-NBR-BC-DIVERT                         42100000
421100         MOVE  PV-20-SML-BC-DC-ORIGIN                             42110000
421200           TO  PC160-20-SML-BC-DC-ORIGIN                          42120000
421300               PC160-20-SML-NBR-BC-DC-ORIGIN                      42130000
421400         MOVE  PV-20-SML-BC-MNFST-NBR                             42140000
421500           TO  PC160-20-SML-BC-MNFST-NBR                          42150000
421600               PC160-20-SML-NBR-BC-MNFST-NBR                      42160000
421700         MOVE PC160-20-DIGIT-BARCODE     TO PC189-SML-BC          42170000
421800         MOVE PC160-20-DIGIT-BARCODE-NBR TO PC189-SML-BC-NBR      42180000
421900                                                                  42190000
422000* 29 DIGIT BARCODE & NBR - DATA                                   42200000
422100         MOVE  LBPTDA-PO-NBR           TO PV-BC-PO-NBR-BC         42210000
422200                                          PV-BC-PO-NBR            42220000
422300         MOVE  LBPTDA-ITM-NBR          TO PV-BC-ITEM-NBR-BC       42230000
422400                                          PV-BC-ITEM-NBR          42240000
422500**GB 6/15/01 ADDED MOVE TO OTPK FROM LBPTDA RATHER                42250000
422600** THAN PC205-PACK-UNT(FORM FIELD)                                42260000
422700         MOVE LBPTDA-OTPK-UNT-QTY                                 42270000
422800                                       TO PV-OTPK-QTY             42280000
422900         MOVE PV-OTPK-UNIT-QTY         TO PV-BC-UNITS-BC          42290000
423000                                          PV-BC-UNITS             42300000
423100                                          PC189-PACK-UNT          42310000
423200*GB 6/15/01******                                                 42320000
423300*        MOVE  PC205-PACK-UNT          TO PV-BC-UNITS-BC          42330000
423400*                                         PV-BC-UNITS             42340000
423500*****************                                                 42350000
423600         MOVE  PV-PO-ITM-UNITS-NBR     TO PC189-PO-ITM-UNITS      42360000
423700         MOVE  PV-PO-ITM-UNITS-BC      TO PC189-PO-ITM-UNITS-BC   42370000
423800*                                                                 42380000
423900         SET  PS-NO-MSG-1                                         42390000
424000              PS-NO-MSG-2              TO TRUE                    42400000
424100         MOVE PC-DEFAULT-LABEL-MSG     TO PC189-ERROR-MSG-1       42410000
424200                                                                  42420000
424300         IF  LBPTDA-SU-MSSG-DAT-IND  =  PC-Y                      42430000
424400             MOVE PC-NOT-FOUND-MSG                                42440000
424500                                       TO PC189-ERROR-MSG-1       42450000
424600             SET PS-YES-MSG-1                                     42460000
424700                 PS-YES-MSG-2  TO TRUE                            42470000
424800         ELSE                                                     42480000
424900         IF  LBPTDA-SU-DUP-LBL-IND  =  PC-Y                       42490000
425000             MOVE PC-DUPLICATE-SCAN-MSG                           42500000
425100                                       TO PC189-ERROR-MSG-1       42510000
425200             SET PS-YES-MSG-1                                     42520000
425300                 PS-YES-MSG-2  TO TRUE                            42530000
425400         ELSE                                                     42540000
425500         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-R                     42550000
425600             MOVE PC-FREE-ASTRY-NO-RCVR-MSG                       42560000
425700                                       TO PC189-ERROR-MSG-1       42570000
425800             SET PS-YES-MSG-1                                     42580000
425900                 PS-YES-MSG-2      TO TRUE                        42590000
426000         ELSE                                                     42600000
426100         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-T                     42610000
426200             MOVE PC-FREE-ASTRY-NO-TRIP-MSG                       42620000
426300                                       TO PC189-ERROR-MSG-1       42630000
426400             SET PS-YES-MSG-1                                     42640000
426500                 PS-YES-MSG-2      TO TRUE                        42650000
426600         END-IF                                                   42660000
426700         END-IF                                                   42670000
426800         END-IF                                                   42680000
426900         END-IF                                                   42690000
427000                                                                  42700000
427100         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-Y                     42710000
427200             IF PS-NO-MSG-1                                       42720000
427300                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   42730000
427400                                       TO PC189-ERROR-MSG-1       42740000
427500                 SET PS-YES-MSG-1  TO TRUE                        42750000
427600             ELSE                                                 42760000
427700             IF PS-NO-MSG-2                                       42770000
427800                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   42780000
427900                                       TO PC189-ERROR-MSG-1       42790000
428000                 SET PS-YES-MSG-2  TO TRUE                        42800000
428100             END-IF                                               42810000
428200             END-IF                                               42820000
428300         END-IF                                                   42830000
428400                                                                  42840000
428500         IF  LBPTDA-SU-MISDIR-IND  =  PC-Y                        42850000
428600             IF PS-NO-MSG-1                                       42860000
428700                 MOVE PC-MISDIRECT-MSG                            42870000
428800                                       TO PC189-ERROR-MSG-1       42880000
428900                 SET PS-YES-MSG-1  TO TRUE                        42890000
429000             ELSE                                                 42900000
429100             IF PS-NO-MSG-2                                       42910000
429200                 MOVE PC-MISDIRECT-MSG                            42920000
429300                                       TO PC189-ERROR-MSG-1       42930000
429400                 SET PS-YES-MSG-2  TO TRUE                        42940000
429500             END-IF                                               42950000
429600             END-IF                                               42960000
429700         END-IF.                                                  42970000
429800*                                                                 42980000
429900*                                                                 42990000
430000*----------------------------------------------------------------*43000000
430100* SEND CS LABEL DATA                                             *43010000
430200*----------------------------------------------------------------*43020000
430300 4566-SEND-CS-DATA.                                               43030000
430400     INITIALIZE PC133-LABEL-DTL-REC.                              43040000
430500     SET  PC133-LABEL-DTL           TO  TRUE.                     43050000
430600                                                                  43060000
430700     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       43070000
430800     SET  PC189-IDX-2               TO  PC189-IDX.                43080000
430900     MOVE PC189-SML-DATA-LINE-LENGTH (PC189-IDX-2)                43090000
431000                                    TO  PC133-DTL-LENGTH.         43100000
431100     MOVE PC189-SML-LABEL-LINE (PC189-IDX)                        43110000
431200                                    TO  PC133-DTL-DATA.           43120000
431300                                                                  43130000
431400     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    43140000
431500         '' BY SPACES.                                           43150000
431600     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    43160000
431700         ';' BY SPACES.                                           43170000
431800     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    43180000
431900         LOW-VALUES BY SPACES.                                    43190000
432000                                                                  43200000
432100******************************************************************43210000
432200* LENGTH CALCULATION:                                            *43220000
432300*       LINE LENGTH SML DATA     (PC189-SML-DATA-LINE-LENGTH)    *43230000
432400*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *43240000
432500*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *43250000
432600*              PC133-DTL-LENGTH        (3 POSITIONS)             *43260000
432700*              HEX 03-END EACH DTL REC (1 POSITIONS)             *43270000
432800*              FILLER                  (6 POSITIONS)             *43280000
432900******************************************************************43290000
433000     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        43300000
433100     MOVE PC189-SML-DATA-LINE-LENGTH (PC189-IDX-2)                43310000
433200                                  TO PC133-DTL-REC-LENGTH.        43320000
433300     ADD  20                      TO PC133-DTL-REC-LENGTH.        43330000
433400     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                43340000
433500                                     DP081-NBR-BYTES.             43350000
433600                                                                  43360000
433700     PERFORM 5100-SEND-DATA-TO-LPMS.                              43370000
433800                                                                  43380000
433900     ADD  1  TO  PV-TRAILER-COUNT.                                43390000
434000*                                                                 43400000
434100*                                                                 43410000
434200*----------------------------------------------------------------*43420000
434300* SEND P2L LABEL DATA - FOR P2L FORM & DATA ARE COMBINED         *43430000
434400*----------------------------------------------------------------*43440000
434500 4567-SEND-P2L-DATA.                                              43450000
434600                                                                  43460000
434700     INITIALIZE PC133-LABEL-DTL-REC.                              43470000
434800     SET  PC133-LABEL-DTL           TO  TRUE.                     43480000
434900                                                                  43490000
435000     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       43500000
435100     SET  PC169-IDX-2               TO  PC169-IDX.                43510000
435200     MOVE PC169-DEST-LBL-LINE-LENGTH (PC169-IDX-2)                43520000
435300                                    TO  PC133-DTL-LENGTH.         43530000
435400     MOVE PC169-P2L-DEST-LBL-LINE (PC169-IDX)                     43540000
435500                                    TO  PC133-DTL-DATA.           43550000
435600                                                                  43560000
435700     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    43570000
435800         '' BY SPACES.                                           43580000
435900     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    43590000
436000         ';' BY SPACES.                                           43600000
436100     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    43610000
436200         LOW-VALUES BY SPACES.                                    43620000
436300                                                                  43630000
436400******************************************************************43640000
436500* LENGTH CALCULATION:                                            *43650000
436600*       LINE LENGTH HEADER LABEL (PC169-DEST-LBL-LINE-LENGTH)    *43660000
436700*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *43670000
436800*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *43680000
436900*              PC133-DTL-LENGTH        (3 POSITIONS)             *43690000
437000*              HEX 03-END EACH DTL REC (1 POSITIONS)             *43700000
437100*              FILLER                  (6 POSITIONS)             *43710000
437200******************************************************************43720000
437300     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        43730000
437400     MOVE PC169-DEST-LBL-LINE-LENGTH (PC169-IDX-2)                43740000
437500                                  TO PC133-DTL-REC-LENGTH.        43750000
437600     ADD  20                      TO PC133-DTL-REC-LENGTH.        43760000
437700     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                43770000
437800                                     DP081-NBR-BYTES.             43780000
437900                                                                  43790000
438000     PERFORM 5100-SEND-DATA-TO-LPMS.                              43800000
438100                                                                  43810000
438200     ADD  1  TO  PV-TRAILER-COUNT.                                43820000
438300                                                                  43830000
438400* 07/19/13 RLK BEG                                                43840000
438500*----------------------------------------------------------------*43850000
438600* BUILD SML LABEL FORM                                           *43860000
438700*----------------------------------------------------------------*43870000
438800 4568-BUILD-CRTN-LBL-FORM.                                        43880000
438900     INITIALIZE PC266-CARTON-LABEL                                43890000
439000                DCLTRECEIV                                        43900000
439100                PV-ARVD-DATE                                      43910000
439200                PV-DATE-CCYY-MM-DD.                               43920000
439300                                                                  43930000
439400*BARCODE IS NEEDED                                                43940000
439500     MOVE PV-CURRENT-DB2-DATE       TO  PV-WORK-DB2-DATE.         43950000
439600     MOVE PV-WORK-YY                TO  PV-LBL-DATE-YY.           43960000
439700     MOVE PV-WORK-MM                TO  PV-LBL-DATE-MM.           43970000
439800     MOVE PV-WORK-DD                TO  PV-LBL-DATE-DD.           43980000
439900     MOVE '-'                       TO  PV-LBL-DASH1              43990000
440000                                        PV-LBL-DASH2              44000000
440100                                        PV-ARVD-DASH1             44010000
440200                                        PV-ARVD-DASH2.            44020000
440300     MOVE PV-LBL-DATE               TO  PC266-LBL-PRT-DATE.       44030000
440400*                                       PC266-RCVD-DTE.           44040000
440500     MOVE PV-CURRENT-TIME           TO  PC266-LBL-PRT-TIME.       44050000
440600                                                                  44060000
440700                                                                  44070000
440800                                                                  44080000
440900**RLK                                                             44090000
441000**   SET PC266-BRCD-NBR TO TRUE.                                  44100000
441100**   MOVE  PC266-WORK-END-CHARACTER                               44110000
441200**     TO  PC266-BRCDE-NBR-END.                                   44120000
441300**RLK                                                             44130000
441400* dmh - 7/31/13 - BEGIN                                           44140000
441500***  MOVE  PC266-WORK-END-CHARACTER                               44150000
441600***    TO  PC266-BRCDE-INC-END.                                   44160000
441700* dmh - 7/31/13 - END                                             44170000
441800**RLK                                                             44180000
441900**   MOVE  PC266-WORK-END-CHARACTER                               44190000
442000**     TO  PC266-UNDR-BC-END.                                     44200000
442100**RLK                                                             44210000
442200* dmh - 7/31/13 - BEGIN                                           44220000
442300***  MOVE  PC266-WORK-END-CHARACTER                               44230000
442400***    TO  PC266-UNDR-BC-INC-END.                                 44240000
442500* dmh - 7/31/13 - BEGIN                                           44250000
442600     MOVE 0 TO PC266-BC-ZERO.                                     44260000
442700     MOVE LBPTDA-PRTR-ID           TO  PC266-PRINTER-NBR.         44270000
442800     MOVE LBPTDA-SHIPT-UNT-ID      TO  PV-SHIPT-UNT-ID-NUM.       44280000
442900     MOVE PV-SHIPT-UNT-14-18       TO  PC266-SSCC-NBR.            44290000
443000     MOVE LBPTDA-BRCDE-NBR         TO  PV-22-DIGIT-BARCODE.       44300000
443100     MOVE PV-22-CRTN-DIVERT-CDE TO PC266-BC-DIVERT-CODE           44310000
443200                                   PC266-DIVERT-CODE.             44320000
443300     IF LBPTDA-SKU-NBR > ZERO                                     44330000
443400                                                                  44340000
443500         MOVE LBPTDA-SKU-DEPT-NBR  TO PV-SML-DEPT1                44350000
443600         MOVE LBPTDA-SKU-CL-NBR TO PV-SML-CLASS-NBR1              44360000
443700         MOVE LBPTDA-SKU-NBR       TO PV-SML-SKU                  44370000
443800         MOVE PV-SML-SKU-NUMBER    TO PC266-SKU                   44380000
443900     ELSE                                                         44390000
444000         MOVE SPACES               TO PC266-SKU                   44400000
444100     END-IF.                                                      44410000
444200     MOVE LBPTDA-CART-ACTN-CDE TO PC266-CASI.                     44420000
444300     MOVE LBPTDA-CRE-USR-ID        TO PC266-USERID.               44430000
444400     MOVE 0 TO PC266-UNDR-BC-ZERO.                                44440000
444500     MOVE LBPTDA-PO-NBR TO PV-PO-NBR.                             44450000
444600     MOVE PV-PO-NBR-7POS TO                                       44460000
444700               PC266-BC-PO-NBR                                    44470000
444800               PC266-PO-NBR                                       44480000
444900               PC266-PO-NBR-X                                     44490000
445000               RECEIV-ORD-NBR.                                    44500000
445100     MOVE LBPTDA-RCVR-SEQ-NBR TO PV-RCVR-NBR.                     44510000
445200     MOVE PV-RCVR-NBR-3POS TO                                     44520000
445300               PC266-RECV-SEQ-NBR                                 44530000
445400               RECEIV-REC-SEQ-NBR.                                44540000
445500     MOVE PV-RCVR-NBR-3POS (2:2) TO                               44550000
445600               PC266-BC-RECV-SEQ-NBR                              44560000
445700               PC266-RECV-SEQ-NBR-X.                              44570000
445800     MOVE LBPTDA-PO-LNE-NBR TO PV-LINE-NBR.                       44580000
445900     MOVE PV-PO-LINE-NBR TO                                       44590000
446000               PC266-BC-PO-LNE-NBR                                44600000
446100               PC266-PO-LNE-NBR                                   44610000
446200               PC266-PO-LNE-NBR-X.                                44620000
446300                                                                  44630000
446400     PERFORM 4571-GET-ARVD-DATE.                                  44640000
446500     MOVE PV-ARVD-DATE TO PC266-ARVD-DTE.                         44650000
446600                                                                  44660000
446610     MOVE PV-22-CRTN-CART-NBR  TO                                 44661015
446700          PC266-START-CARTON-CNT                                  44670015
446800          PC266-BC-START-CARTON-CNT.                              44680015
446900     MOVE LBPTDA-MODU-DESC      TO PC266-PROCESS-AREA.            44690000
447000     IF LBPTDA-CART-ACTN-CDE > SPACES                             44700000
447100        MOVE LBPTDA-CART-ACTN-CDE TO PC266-CASI                   44710000
447200     ELSE                                                         44720000
447300        MOVE ' '                  TO PC266-CASI                   44730000
447400     END-IF.                                                      44740000
447500* 08/01/13 RLK BEG                                                44750000
447600* SML                                                             44760000
447700     PERFORM 3250-SELECT-BRCDE                                    44770000
447800     IF SULBXF-CART-LBL-TYP-CDE = 'P'                             44780000
447900       MOVE 'P2L'                   TO PC266-MSG-1                44790000
448000     ELSE                                                         44800000
448100       MOVE 'Crossdock'             TO PC266-MSG-1                44810000
448200     END-IF.                                                      44820000
448300** MERCHANDISE GROUP                                              44830000
448400     MOVE LBPTDA-PO-NBR TO PURCHS-PO-NBR.                         44840000
448500     PERFORM 2150-GET-ZONE-DESC-FOR-CL.                           44850000
448600     MOVE MDSEDP-STR-ZN-ID     TO PC266-MSG-2.                    44860000
448700* No values for PC266-MSG-3 has been established yet              44870000
448800     MOVE '@@@@@@@@@@@@@@@@@'     TO PC266-MSG-3.                 44880000
448900     IF LBPTDA-RPRT-IND  =  PC-R                                  44890000
449000      OR  LBPTDA-RPRT-IND  =  PC-Y                                44900000
449100       SET PC266-REPRINT-BOX TO TRUE                              44910000
449200       SET PC266-REPRINT-TEXT TO TRUE                             44920000
449300     ELSE                                                         44930000
449400       SET PC266-NO-RPRT-BOX TO TRUE                              44940000
449500       SET PC266-NO-RPRT-TEXT TO TRUE                             44950000
449600     END-IF.                                                      44960000
449700* 08/01/13 RLK END                                                44970000
449800                                                                  44980000
449900***************************************************************** 44990000
450000* this is the basic code that needs to be put in                * 45000000
450100* dmh 7/31/13 - begin                                           * 45010000
450200***************************************************************** 45020000
450300     IF PV-22-CRTN-DIVERT-CDE = 'XXXX'                            45030000
450400         SET  PC266-NO-BRCDE-NBR                                  45040000
450500              PC266-NO-BRCDE-VALUE  TO  true                      45050000
450600         MOVE SPACES                TO  PC266-UNDR-BC-ZERO        45060000
450700                                        PC266-DIVERT-CODE         45070000
450800                                        PC266-PO-NBR-X            45080000
450900                                        PC266-RECV-SEQ-NBR-X      45090000
451000                                        PC266-PO-LNE-NBR-X        45100000
451100                                        PC266-START-CARTON-CNT    45110000
451200                                                                  45120000
451300        MOVE  PC266-WORK-END-CHARACTER                            45130000
451400          TO  PC266-UNDR-BC-END                                   45140000
451500     ELSE                                                         45150000
451600        SET PC266-BRCD-NBR TO TRUE                                45160000
451700        MOVE  PC266-WORK-END-CHARACTER                            45170000
451800          TO  PC266-BRCDE-NBR-END                                 45180000
451900        MOVE  PC266-WORK-END-CHARACTER                            45190000
452000          TO  PC266-UNDR-BC-END                                   45200000
452100        MOVE 0 TO PC266-BC-ZERO                                   45210000
452200        MOVE PV-22-CRTN-DIVERT-CDE TO PC266-BC-DIVERT-CODE        45220000
452300                                      PC266-DIVERT-CODE           45230000
452400        MOVE PV-PO-NBR-7POS TO                                    45240000
452500                  PC266-BC-PO-NBR                                 45250000
452600        MOVE PV-RCVR-NBR-3POS (2:2) TO                            45260000
452700                  PC266-BC-RECV-SEQ-NBR                           45270000
452800        MOVE PV-PO-LINE-NBR TO                                    45280000
452900                  PC266-BC-PO-LNE-NBR                             45290000
452910        MOVE PV-22-CRTN-CART-NBR TO                               45291015
453000             PC266-START-CARTON-CNT                               45300015
453100             PC266-BC-START-CARTON-CNT                            45310015
453200     END-IF.                                                      45320000
453300***************************************************************** 45330000
453400* dmh 7/31/13 - end                                             * 45340000
453500***************************************************************** 45350000
453600*                                                                 45360000
453700*** DMH - 7/31/13 - begin                                         45370000
453800*    MOVE 'AAAAAAAAAAAAAAAAA'     TO PC266-MSG-1.                 45380000
453900*    MOVE 'BBBBBBBBBBBBBBBBB'     TO PC266-MSG-2.                 45390000
454000*    MOVE 'CCCCCCCCCCCCCCCCC'     TO PC266-MSG-3.                 45400000
454100*** DMH - 7/31/13 - end                                           45410000
454200*                                                                 45420000
454300                                                                  45430000
454400*** BEGIN - FOR TESTING ONLY                                      45440000
454500*    STRING ' '                  DELIMITED BY SIZE                45450000
454600*           'SUKRF527-'          DELIMITED BY SIZE                45460000
454700*    '4568-BUILD-CRTN-LBL-FORM-' DELIMITED BY SIZE                45470000
454800*            'CART-LBL-TYP-CDE-' DELIMITED BY SIZE                45480000
454900*      LBPTDA-CART-LBL-TYP-CDE   DELIMITED BY SIZE                45490000
455000*           'CRTN-DIVERT-CDE-'   DELIMITED BY SIZE                45500000
455100*      PV-22-CRTN-DIVERT-CDE     DELIMITED BY SIZE                45510000
455200*           'CRTN-DIVERT-CDE-'   DELIMITED BY SIZE                45520000
455300*      PV-22-CRTN-DIVERT-CDE     DELIMITED BY SIZE                45530000
455400*                   'REPRINT-'   DELIMITED BY SIZE                45540000
455500*      LBPTDA-RPRT-IND           DELIMITED BY SIZE                45550000
455600*                                INTO PV-CICS-MSG-AREA.           45560000
455700*      MOVE LENGTH OF PV-CICS-MSG-AREA                            45570000
455800*          TO PV-COMMAREA-LENGTH.                                 45580000
455900*     PERFORM 9990-WRITE-CICS.                                    45590000
456000*** END - FOR TESTING ONLY                                        45600000
456100                                                                  45610000
456200*                                                                 45620000
456300*                                                                 45630000
456400*----------------------------------------------------------------*45640000
456500* SEND CRTN LABEL FORM                                           *45650000
456600*----------------------------------------------------------------*45660000
456700 4569-SEND-CRTN-FORM.                                             45670000
456800*    INITIALIZE PC266-CARTON-LABEL.                               45680000
456900                                                                  45690000
457000     SET  PC133-LABEL-DTL           TO  TRUE.                     45700000
457100                                                                  45710000
457200     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       45720000
457300     SET  PC266-IDX-2               TO  PC266-IDX.                45730000
457400     MOVE PC266-CART-LINE-LENGTH (PC266-IDX-2)                    45740000
457500                                    TO  PC133-DTL-LENGTH.         45750000
457600     MOVE PC266-CARTON-LBL-LINE (PC266-IDX)                       45760000
457700                                    TO  PC133-DTL-DATA.           45770000
457800                                                                  45780000
457900     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    45790000
458000         '' BY SPACES.                                           45800000
458100     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    45810000
458200         ';' BY SPACES.                                           45820000
458300     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    45830000
458400         LOW-VALUES BY SPACES.                                    45840000
458500                                                                  45850000
458600******************************************************************45860000
458700* LENGTH CALCULATION:                                            *45870000
458800*       LINE LENGTH SML FORM     (PC266-CART-LINE-LENGTH)        *45880000
458900*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *45890000
459000*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *45900000
459100*              PC133-DTL-LENGTH        (3 POSITIONS)             *45910000
459200*              HEX 03-END EACH DTL REC (1 POSITIONS)             *45920000
459300*              FILLER                  (6 POSITIONS)             *45930000
459400******************************************************************45940000
459500     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        45950000
459600     MOVE PC266-CART-LINE-LENGTH (PC266-IDX-2)                    45960000
459700                                  TO PC133-DTL-REC-LENGTH.        45970000
459800     ADD  20                      TO PC133-DTL-REC-LENGTH.        45980000
459900     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                45990000
460000                                     DP081-NBR-BYTES.             46000000
460100                                                                  46010000
460200     PERFORM 5100-SEND-DATA-TO-LPMS.                              46020000
460300     ADD  1  TO  PV-TRAILER-COUNT.                                46030000
460400                                                                  46040000
460500* 07/19/13 RLK END                                                46050000
460600*                                                                 46060000
460700*                                                                 46070000
460800*                                                                 46080000
460900*----------------------------------------------------------------*46090000
461000* CLOSE LABEL CURSOR                                             *46100000
461100*----------------------------------------------------------------*46110000
461200 4570-CLOSE-LBL-CURSOR.                                           46120000
461300                                                                  46130000
461400     EXEC SQL                                                     46140000
461500         CLOSE LABEL_CURSOR                                       46150000
461600     END-EXEC.                                                    46160000
461700                                                                  46170000
461800     EVALUATE TRUE                                                46180000
461900         WHEN SQLCODE = +0                                        46190000
462000              CONTINUE                                            46200000
462100         WHEN SQLCODE  NOT =  +0                                  46210000
462200              MOVE '4570-CLOSE-LBL-CURSOR'                        46220000
462300                                  TO DP013-PARAGRAPH              46230000
462400              MOVE 'CLOSE LABEL BATCH CURSOR'                     46240000
462500                                  TO DP013-MESSAGE-TEXT (1)       46250000
462600              MOVE SQLCA          TO DP013-SQLCA                  46260000
462700              MOVE 'TLBPTDA'      TO DP013-DB2-TABLE-NAME (1)     46270000
462800              SET DP013-DB2-ABEND TO TRUE                         46280000
462900*             PERFORM 9999-WRITE-CICS-LOG-MSG                     46290000
463000             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              46300000
463100              PERFORM DP014-0000-PROCESS-ABEND                    46310000
463200     END-EVALUATE.                                                46320000
463300                                                                  46330000
463400*----------------------------------------------------------------*46340000
463500* GET TRAILER ARRIVAL DATE                                       *46350000
463600*----------------------------------------------------------------*46360000
463700 4571-GET-ARVD-DATE.                                              46370000
463800                                                                  46380000
463900     EXEC SQL                                                     46390000
464000          SELECT DATE(REC_TMST)                                   46400000
464100          INTO  :PV-DATE-CCYY-MM-DD                               46410000
464200          FROM   TRECEIV                                          46420000
464300          WHERE  ORD_NBR        = :RECEIV-ORD-NBR                 46430000
464400          AND    REC_SEQ_NBR    = :RECEIV-REC-SEQ-NBR             46440000
464500          AND    VER_STATUS_CDE = 'A'                             46450000
464510          with ur                                                 46451014
464600     END-EXEC.                                                    46460000
464700                                                                  46470000
464800     EVALUATE TRUE                                                46480000
464900         WHEN SQLCODE = ZERO                                      46490000
465000              MOVE PV-DATE-MM-R TO PV-ARVD-DATE-MM                46500000
465100              MOVE PV-DATE-DD-R TO PV-ARVD-DATE-DD                46510000
465200              MOVE PV-DATE-YY-R TO PV-ARVD-DATE-YY                46520000
465300         WHEN SQLCODE = +100                                      46530000
465400              MOVE PV-LBL-DATE  TO PV-ARVD-DATE                   46540000
465500         WHEN SQLWARN0 NOT = SPACES                               46550000
465600         WHEN SQLCODE < ZERO                                      46560000
465700         WHEN SQLCODE > ZERO                                      46570000
465800              MOVE '4568-BUILD-CRTN-LBL-FORM'                     46580000
465900                                  TO DP013-PARAGRAPH              46590000
466000              MOVE 'GET ARRIVAL DATE '                            46600000
466100                                  TO DP013-MESSAGE-TEXT (1)       46610000
466200              MOVE SQLCA          TO DP013-SQLCA                  46620000
466300              MOVE 'TRECEIV'      TO DP013-DB2-TABLE-NAME (1)     46630000
466400              SET DP013-DB2-ABEND TO TRUE                         46640000
466500              SET DP013-XCTL-DISPLAY-RESTART  TO TRUE             46650000
466600              PERFORM DP014-0000-PROCESS-ABEND                    46660000
466700     END-EVALUATE.                                                46670000
466800*4571-EXIT.                                                       46680000
466900                                                                  46690000
467000*----------------------------------------------------------------*46700000
467100* BUILD SML LABEL FORM                                           *46710000
467200*----------------------------------------------------------------*46720000
467300 4575-BUILD-MESSAGE-FORM.                                         46730000
467400     INITIALIZE PC133-LABEL-DTL-REC.                              46740000
467500     SET  PC133-LABEL-DTL           TO  TRUE.                     46750000
467600                                                                  46760000
467700*PREPACK ORDERS                                                   46770000
467800     IF  LBPTDA-PREPK-ID > 0                                      46780000
467900         SET PS-PREPK-FORM              TO TRUE                   46790000
468000         MOVE 'PACK ID:'                TO PC178-LNE-PCK-HDG      46800000
468100         MOVE 'UNITS IN PACK:'          TO PC178-PCK-UNTS-HDG     46810000
468200         MOVE 'PCKS IN OUTR PK:'        TO PC178-PKINOT-UNTS-HDG  46820000
468300         MOVE '0000'                    TO PC178-PCK-UNTS         46830000
468400     ELSE                                                         46840000
468500         SET PS-NOT-PREPK-FORM          TO TRUE                   46850000
468600         MOVE 'LINE NO:'                TO PC178-LNE-PCK-HDG      46860000
468700         MOVE '@@@@@@@@@@@@@@'          TO PC178-PCK-UNTS-HDG     46870000
468800         MOVE '@@@@@@@@@@@@@@@@'        TO PC178-PKINOT-UNTS-HDG  46880000
468900         MOVE '@@@@'                    TO PC178-PCK-UNTS         46890000
469000     END-IF                                                       46900000
469100                                                                  46910000
469200*INNER PACK CONVEYABLE                                            46920000
469300     IF  LBPTDA-INPK-CNVYB-IND = 'Y'                              46930000
469400         MOVE PC178-FORM-INPK-HDG       TO PC178-OUTPK-UNTS-HDG   46940000
469500         MOVE PC178-FORM-INPK-BOX       TO PC178-INPK-CONVY-BOX   46950000
469600     ELSE                                                         46960000
469700         MOVE PC178-FORM-OTPK-HDG       TO PC178-OUTPK-UNTS-HDG   46970000
469800         MOVE PC178-FORM-NO-INPK-BOX    TO PC178-INPK-CONVY-BOX   46980000
469900     END-IF                                                       46990000
470000                                                                  47000000
470100*REPRINT                                                          47010000
470200     IF  PS-REPRINT-BATCH  OR                                     47020000
470300         LBPTDA-RPRT-IND  =  PC-Y                                 47030000
470400         MOVE PC178-FORM-REPRT-BOX      TO  PC178-REPRINT-BOX     47040000
470500         MOVE PC178-FORM-REPRT-FLD      TO  PC178-REPRINT-TEXT    47050000
470600         SET  PS-REPRINT-FORM           TO  TRUE                  47060000
470700     ELSE                                                         47070000
470800         MOVE PC178-FORM-NO-RPRT-BOX    TO  PC178-REPRINT-BOX     47080000
470900         MOVE PC178-FORM-NO-RPRT-FLD    TO  PC178-REPRINT-TEXT    47090000
471000         SET  PS-NOT-REPRINT-FORM       TO  TRUE                  47100000
471100     END-IF.                                                      47110000
471200***                                                               47120000
471300     MOVE LBPTDA-DC-PRTD-AT-CDE     TO  PV-DSPLY-DC.              47130000
471400     MOVE '-'                       TO  PV-DSPLY-DASH.            47140000
471500     MOVE SU001-PRINTER-ID-USE      TO  PV-DSPLY-PRTR-ID.         47150000
471600     MOVE PV-DSPLY-PRTR             TO  PC178-SML-PRTR-NBR.       47160000
471700*                                                                 47170000
471800     MOVE PV-CURRENT-DB2-DATE       TO  PV-WORK-DB2-DATE.         47180000
471900     MOVE PV-WORK-YY                TO  PV-LBL-DATE-YY.           47190000
472000     MOVE PV-WORK-MM                TO  PV-LBL-DATE-MM.           47200000
472100     MOVE PV-WORK-DD                TO  PV-LBL-DATE-DD.           47210000
472200     MOVE '-'                       TO  PV-LBL-DASH1              47220000
472300                                        PV-LBL-DASH2.             47230000
472400     MOVE PV-LBL-DATE               TO  PC178-LBL-PRT-DATE.       47240000
472500*                                                                 47250000
472600     MOVE PV-CURRENT-TIME           TO  PC178-LBL-PRT-TIME.       47260000
472700*                                                                 47270000
472800     MOVE 'CI'                      TO  PC178-FROM-APPLICATION.   47280000
472900     IF  SU001-BATCH-PRINTER                                      47290000
473000         MOVE 'BATCH'               TO  PC178-PRTR-ATTACHED       47300000
473100     ELSE                                                         47310000
473200     IF  SU001-TETHERED-PRINTER                                   47320000
473300         MOVE 'CABLE'               TO  PC178-PRTR-ATTACHED       47330000
473400     ELSE                                                         47340000
473500         MOVE 'OTHER'               TO  PC178-PRTR-ATTACHED       47350000
473600     END-IF                                                       47360000
473700     END-IF.                                                      47370000
473800     MOVe '-SML-'                   TO  PC178-LBL-DESC.           47380000
473900     MOVE PC178-LABEL-INFO-WORK     TO  PC178-LABEL-INFO.         47390000
474000                                                                  47400000
474100     MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'                   47410000
474200                                    TO  PC178-DEPT-NAME           47420000
474300                                        PC178-STR-ON-HAND.        47430000
474400*    IF  LBPTDA-DEPT-DESC > SPACES                                47440000
474500*        MOVE LBPTDA-DEPT-DESC      TO  PC178-DEPT-NAME           47450000
474600*    ELSE                                                         47460000
474700*        MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                         47470000
474800*                                   TO  PC178-DEPT-NAME           47480000
474900*    END-IF.                                                      47490000
475000*                                                                 47500000
475100*    IF  LBPTDA-MAJ-CL-DESC > SPACES                              47510000
475200*        MOVE LBPTDA-MAJ-CL-DESC    TO  PC178-MAJOR-CLASS         47520000
475300*    ELSE                                                         47530000
475400*        MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                         47540000
475500*                                   TO  PC178-MAJOR-CLASS         47550000
475600*    END-IF.                                                      47560000
475700                                                                  47570000
475800     IF  LBPTDA-FIXT-ID  >  SPACES                                47580000
475900         MOVE LBPTDA-FIXT-ID        TO  PC178-FIXTURE             47590000
476000     ELSE                                                         47600000
476100         MOVE '@@@@@@@@@@'          TO  PC178-FIXTURE             47610000
476200     END-IF.                                                      47620000
476300     IF  LBPTDA-SEASET-NM  >  SPACES                              47630000
476400         MOVE LBPTDA-SEASET-NM            TO  PC178-SET           47640000
476500     ELSE                                                         47650000
476600         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO  PC178-SET           47660000
476700     END-IF.                                                      47670000
476800     IF  LBPTDA-TRIP-ID    >  ZERO                                47680000
476900         MOVE LBPTDA-TRIP-ID   TO  PC178-TRIP-ID                  47690000
477000     ELSE                                                         47700000
477100         MOVE '@@@@@@@@@'      TO  PC178-TRIP-ID                  47710000
477200     END-IF.                                                      47720000
477300     MOVE LBPTDA-CRE-USR-ID         TO  PC178-USER-ID.            47730000
477400                                                                  47740000
477500     IF  LBPTDA-SU-MSSG-DAT-IND  =  PC-K                          47750000
477600         SET  PC178-STR-LNE-1-YES                                 47760000
477700              PC178-STR-LNE-2-YES                                 47770000
477800              PC178-STR-LNE-3-YES                                 47780000
477900              PC178-STR-LNE-4-YES       TO  TRUE                  47790000
478000         MOVE PC178-FORM-PRT-STORE      TO  PC178-STORE-NBR       47800000
478100     ELSE                                                         47810000
478200         SET  PC178-STR-LNE-1-NO                                  47820000
478300              PC178-STR-LNE-2-NO                                  47830000
478400              PC178-STR-LNE-3-NO                                  47840000
478500              PC178-STR-LNE-4-NO        TO  TRUE                  47850000
478600         MOVE PC178-FORM-NO-STORE       TO  PC178-STORE-NBR       47860000
478700     END-IF.                                                      47870000
478800*                                                                 47880000
478900*                                                                 47890000
479000*----------------------------------------------------------------*47900000
479100* SEND SML LABEL FORM                                            *47910000
479200*----------------------------------------------------------------*47920000
479300 4576-SEND-MESSAGE-FORM.                                          47930000
479400     INITIALIZE PC133-LABEL-DTL-REC.                              47940000
479500     SET  PC133-LABEL-DTL           TO  TRUE.                     47950000
479600                                                                  47960000
479700     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       47970000
479800     SET  PC178-IDX-2               TO  PC178-IDX.                47980000
479900     MOVE PC178-DTL-FORM-LNE-LNGTH (PC178-IDX-2)                  47990000
480000                                    TO  PC133-DTL-LENGTH.         48000000
480100     MOVE PC178-SHIP-MFST-LBL-LINE (PC178-IDX)                    48010000
480200                                    TO  PC133-DTL-DATA.           48020000
480300                                                                  48030000
480400     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    48040000
480500         '' BY SPACES.                                           48050000
480600     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    48060000
480700         ';' BY SPACES.                                           48070000
480800     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    48080000
480900         LOW-VALUES BY SPACES.                                    48090000
481000                                                                  48100000
481100******************************************************************48110000
481200* LENGTH CALCULATION:                                            *48120000
481300*       LINE LENGTH SML FORM     (PC178-DTL-FORM-LNE-LNGTH)      *48130000
481400*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *48140000
481500*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *48150000
481600*              PC133-DTL-LENGTH        (3 POSITIONS)             *48160000
481700*              HEX 03-END EACH DTL REC (1 POSITIONS)             *48170000
481800*              FILLER                  (6 POSITIONS)             *48180000
481900******************************************************************48190000
482000     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        48200000
482100     MOVE PC178-DTL-FORM-LNE-LNGTH (PC178-IDX-2)                  48210000
482200                                  TO PC133-DTL-REC-LENGTH.        48220000
482300     ADD  20                      TO PC133-DTL-REC-LENGTH.        48230000
482400     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                48240000
482500                                     DP081-NBR-BYTES.             48250000
482600                                                                  48260000
482700     PERFORM 5100-SEND-DATA-TO-LPMS.                              48270000
482800                                                                  48280000
482900     ADD  1  TO  PV-TRAILER-COUNT.                                48290000
483000*                                                                 48300000
483100*                                                                 48310000
483200*----------------------------------------------------------------*48320000
483300*  BUILD SML LABEL DATA                                          *48330000
483400*----------------------------------------------------------------*48340000
483500 4577-BUILD-MESSAGE-DATA.                                         48350000
483600         INITIALIZE PC133-LABEL-DTL-REC.                          48360000
483700         SET PC133-LABEL-DTL           TO  TRUE.                  48370000
483800*CRTN                                                             48380000
483900         MOVE LBPTDA-SHIPT-UNT-ID      TO  PC179-CARTON-ID        48390000
484000*PO/RCVR                                                          48400000
484100         MOVE LBPTDA-PO-NBR            TO  PV-PO-NUMBER           48410000
484200         MOVE LBPTDA-RCVR-SEQ-NBR      TO  PV-PO-RECEIVER         48420000
484300         MOVE PV-PO-RCVR               TO  PC179-PO-RCVR          48430000
484400         MOVE LBPTDA-PO-LNE-NBR        TO  PC179-LINE-NBR         48440000
484500*SKU                                                              48450000
484600         IF LBPTDA-SKU-NBR > ZERO                                 48460000
484700                                                                  48470000
484800             MOVE LBPTDA-SKU-DEPT-NBR  TO PV-SML-DEPT1            48480000
484900             MOVE LBPTDA-SKU-CL-NBR TO PV-SML-CLASS-NBR1          48490000
485000             MOVE LBPTDA-SKU-NBR       TO PV-SML-SKU              48500000
485100         ELSE                                                     48510000
485200             MOVE SPACES               TO PC179-SKU               48520000
485300         END-IF                                                   48530000
485400*STYLE                                                            48540000
485500         MOVE LBPTDA-VS-NBR            TO PC179-STYLE             48550000
485600*OUTER PK UNTS                                                    48560000
485700         MOVE LBPTDA-OTPK-UNT-QTY                                 48570000
485800                                       TO PV-OTPK-QTY             48580000
485900         MOVE PV-OTPK-UNIT-QTY                                    48590000
486000                                       TO PC179-OTPK-UNIT         48600000
486100                                                                  48610000
486200         SET  PS-NO-MSG-1                                         48620000
486300              PS-NO-MSG-2                                         48630000
486400              PC179-NO-PRT-SML-STR-NME                            48640000
486500              PC179-NO-PRT-SML-STR-NBR TO TRUE                    48650000
486600         MOVE PC-DEFAULT-LABEL-MSG     TO PC179-ERROR-MSG-1       48660000
486700                                          PC179-ERROR-MSG-2       48670000
486800         EVALUATE TRUE                                            48680000
486900           WHEN LBPTDA-SU-MSSG-DAT-IND  =  PC-Y                   48690000
487000             MOVE PC-NOT-FOUND-MSG                                48700000
487100                                       TO PC179-ERROR-MSG-1       48710000
487200             MOVE PC-DETAIL-CK-NEED-MSG                           48720000
487300                                       TO PC179-ERROR-MSG-2       48730000
487400             SET PS-YES-MSG-1                                     48740000
487500                 PS-YES-MSG-2  TO TRUE                            48750000
487600           WHEN LBPTDA-SU-MSSG-DAT-IND  =  PC-K                   48760000
487700             IF LBPTDA-SU-FRE-ASTRA-IND  = PC-R OR PC-T           48770000
487800                MOVE PC-INACT-PKSK-CRE-NEW-RCVR                   48780000
487900                                       TO PC179-ERROR-MSG-1       48790000
488000             ELSE                                                 48800000
488100                MOVE PC-PKSLIP-CARTON-UNEQUAL                     48810000
488200                                       TO PC179-ERROR-MSG-1       48820000
488300             END-IF                                               48830000
488400             MOVE PC-DETAIL-CK-NEED-MSG                           48840000
488500                                       TO PC179-ERROR-MSG-2       48850000
488600             SET PS-YES-MSG-1                                     48860000
488700                 PS-YES-MSG-2  TO TRUE                            48870000
488800             MOVE LBPTDA-STR-NM            TO  PC179-SML-STR-NME  48880000
488900             MOVE LBPTDA-DEST-OPER-UNT-ID  TO  PV-STORE-NBR       48890000
489000             MOVE PV-STORE-NBR             TO  PC179-SML-STR-NBR  48900000
489100           WHEN LBPTDA-SU-DUP-LBL-IND  =  PC-Y                    48910000
489200             MOVE PC-DUPLICATE-SCAN-MSG                           48920000
489300                                       TO PC179-ERROR-MSG-1       48930000
489400             MOVE PC-DETAIL-CK-NEED-MSG                           48940000
489500                                       TO PC179-ERROR-MSG-2       48950000
489600             SET PS-YES-MSG-1                                     48960000
489700                 PS-YES-MSG-2  TO TRUE                            48970000
489800           WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-R                  48980000
489900             MOVE PC-FREE-ASTRY-NO-RCVR-MSG                       48990000
490000                                       TO PC179-ERROR-MSG-1       49000000
490100             MOVE PC-DEFAULT-LABEL-MSG                            49010000
490200                                       TO PC179-ERROR-MSG-2       49020000
490300             SET PS-YES-MSG-1                                     49030000
490400                 PS-YES-MSG-2      TO TRUE                        49040000
490500           WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-T                  49050000
490600             MOVE PC-FREE-ASTRY-NO-TRIP-MSG                       49060000
490700                                       TO PC179-ERROR-MSG-1       49070000
490800             MOVE PC-DEFAULT-LABEL-MSG                            49080000
490900                                       TO PC179-ERROR-MSG-2       49090000
491000             SET PS-YES-MSG-1                                     49100000
491100                 PS-YES-MSG-2      TO TRUE                        49110000
491200           WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-A                  49120000
491300             MOVE PC-HOLD-CRTN-TRIP-END                           49130000
491400                                       TO PC179-ERROR-MSG-1       49140000
491500             MOVE PC-FREE-ASTY-NEED-TRANS                         49150000
491600                                       TO PC179-ERROR-MSG-2       49160000
491700             SET PS-YES-MSG-1                                     49170000
491800                 PS-YES-MSG-2      TO TRUE                        49180000
491900           WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-C                  49190000
492000             MOVE PC-TRANSC-CHECK-IN-RCVR                         49200000
492100                                       TO PC179-ERROR-MSG-1       49210000
492200             MOVE PC-FREE-ASTY-NEED-TRANS                         49220000
492300                                       TO PC179-ERROR-MSG-2       49230000
492400             SET PS-YES-MSG-1                                     49240000
492500                 PS-YES-MSG-2      TO TRUE                        49250000
492600           WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-D                  49260000
492700             MOVE PC-UNUSABLE-128-NO-PKSLIP                       49270000
492800                                       TO PC179-ERROR-MSG-1       49280000
492900             MOVE PC-DEFAULT-LABEL-MSG                            49290000
493000                                       TO PC179-ERROR-MSG-2       49300000
493100             SET PS-YES-MSG-1                                     49310000
493200                 PS-YES-MSG-2      TO TRUE                        49320000
493300         END-EVALUATE                                             49330000
493400                                                                  49340000
493500         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-Y                     49350000
493600             IF PS-NO-MSG-1                                       49360000
493700                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   49370000
493800                                       TO PC179-ERROR-MSG-1       49380000
493900                 SET PS-YES-MSG-1  TO TRUE                        49390000
494000             ELSE                                                 49400000
494100             IF PS-NO-MSG-2                                       49410000
494200                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   49420000
494300                                       TO PC179-ERROR-MSG-1       49430000
494400                 SET PS-YES-MSG-2  TO TRUE                        49440000
494500             END-IF                                               49450000
494600             END-IF                                               49460000
494700         END-IF                                                   49470000
494800                                                                  49480000
494900         IF  LBPTDA-SU-MISDIR-IND  =  PC-Y                        49490000
495000             IF PS-NO-MSG-1                                       49500000
495100                 MOVE PC-MISDIRECT-MSG                            49510000
495200                                       TO PC179-ERROR-MSG-1       49520000
495300                 SET PS-YES-MSG-1  TO TRUE                        49530000
495400             ELSE                                                 49540000
495500             IF PS-NO-MSG-2                                       49550000
495600                 MOVE PC-MISDIRECT-MSG                            49560000
495700                                       TO PC179-ERROR-MSG-1       49570000
495800                 SET PS-YES-MSG-2  TO TRUE                        49580000
495900             END-IF                                               49590000
496000             END-IF                                               49600000
496100         END-IF                                                   49610000
496200         EVALUATE TRUE                                            49620000
496300           WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-G                  49630000
496400           WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-L                  49640000
496500             MOVE PC-CASEPK-NOT-DNLD-RECVR                        49650000
496600                                       TO PC179-ERROR-MSG-2       49660000
496700             SET PS-YES-MSG-2  TO TRUE                            49670000
496800           WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-I                  49680000
496900           WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-N                  49690000
497000               MOVE PC-CASEPK-DNLD-PHYSCL                         49700000
497100                                         TO PC179-ERROR-MSG-2     49710000
497200               SET PS-YES-MSG-2  TO TRUE                          49720000
497300         END-EVALUATE                                             49730000
497400                                                                  49740000
497500         MOVE LBPTDA-BRCDE-NBR      TO PC179-IINFO-MSG            49750000
497600                                                                  49760000
497700         MOVE PC-01                    TO PC179-SML-LBL-QTY       49770000
497800                                                                  49780000
497900*PREPACK ORDERS                                                   49790000
498000         IF LBPTDA-ODD-CART-IND  = 'Y'                            49800000
498100            MOVE 0                     TO PC179-LINE-NBR          49810000
498200                                          PV-PREPK-QTY            49820000
498300                                          PC179-PACK-UNITS        49830000
498400                                          PC179-OTPK-PACKS        49840000
498500         ELSE                                                     49850000
498600         IF LBPTDA-PREPK-ID > 0                                   49860000
498700            MOVE LBPTDA-PREPK-ID       TO PC179-LINE-NBR          49870000
498800            MOVE LBPTDA-PREPK-UNT-QTY  TO PV-PREPK-QTY            49880000
498900            MOVE PV-PREPK-UNIT-QTY     TO PC179-PACK-UNITS        49890000
499000            MOVE LBPTDA-PREPK-RATO-QTY TO PC179-OTPK-PACKS        49900000
499100*GB 3/21/01*******************************************************49910000
499200*gb 12/8    DIVIDE LBPTDA-OTPK-UNT-QTY BY                         49920000
499300*gb 12/8                  LBPTDA-PREPK-UNT-QTY                    49930000
499400*gb 12/8                  GIVING   PV-PACKS-IN-CARTON             49940000
499500*gb 12/8    MOVE PV-PACKS-IN-CARTON-X                             49950000
499600*gb 12/8                            TO PC179-OTPK-PACKS           49960000
499700*GB END **********************************************************49970000
499800         ELSE                                                     49980000
499900            MOVE LBPTDA-PO-LNE-NBR     TO PC179-LINE-NBR          49990000
500000         END-IF                                                   50000000
500100         END-IF.                                                  50010000
500200*INNER PACK CONVEYABLE                                            50020000
500300         IF LBPTDA-INPK-CNVYB-IND = 'Y'                           50030000
500400            MOVE LBPTDA-INPK-UNT-QTY   TO PV-INPK-QTY             50040000
500500            MOVE PV-INPK-UNIT-QTY      TO PC179-OTPK-UNIT         50050000
500600         ELSE                                                     50060000
500700            MOVE LBPTDA-OTPK-UNT-QTY   TO PV-OTPK-QTY             50070000
500800            MOVE PV-OTPK-UNIT-QTY      TO PC179-OTPK-UNIT         50080000
500900         END-IF.                                                  50090000
501000*                                                                 50100000
501100         MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                           50110000
501200                                       TO PC179-LABEL-NBR.        50120000
501300         MOVE PC-OF                    TO PC179-LABEL-OF.         50130000
501400         MOVE LBPTDA-LBL-TYP-TOT-QTY   TO PC179-TOT-LABEL.        50140000
501500                                                                  50150000
501600* DEPARTMENT NAME (INSIDE OF BOX)                                 50160000
501700         MOVE PV-DEPT-MAJ-CLASS-CONCAT TO PC179-DEPT-CLASS-DESC.  50170000
501800         SET  PC179-OH-ZERO-MSG-NO     TO TRUE                    50180000
501900*        IF  LBPTDA-DEPT-DESC  >  SPACES                          50190000
502000*            MOVE LBPTDA-DEPT-DESC     TO  PC179-DEPT-DESC        50200000
502100*        ELSE                                                     50210000
502200*            MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                     50220000
502300*                                      TO  PC179-DEPT-DESC        50230000
502400*        END-IF.                                                  50240000
502500* MAJOR CLASS (INSIDE OF BOX)                                     50250000
502600*        IF  LBPTDA-MAJ-CL-DESC  >  SPACES                        50260000
502700*            MOVE LBPTDA-MAJ-CL-DESC   TO  PC179-MAJOR-CLASS      50270000
502800*        ELSE                                                     50280000
502900*            MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                     50290000
503000*                                      TO  PC179-MAJOR-CLASS      50300000
503100*        END-IF.                                                  50310000
503200* FIXTURE ID                                                      50320000
503300         IF  LBPTDA-FIXT-ID  >  SPACES                            50330000
503400             MOVE LBPTDA-FIXT-ID       TO  PC179-FIXTURE          50340000
503500         ELSE                                                     50350000
503600             MOVE '@@@@@@@@@@'         TO  PC179-FIXTURE          50360000
503700         END-IF.                                                  50370000
503800* SEASONAL SET                                                    50380000
503900         IF  LBPTDA-SEASET-NM  >  SPACES                          50390000
504000             MOVE LBPTDA-SEASET-NM     TO  PC179-SEASET           50400000
504100         ELSE                                                     50410000
504200             MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                     50420000
504300                                       TO  PC179-SEASET           50430000
504400         END-IF.                                                  50440000
504500*  TRIP ID                                                        50450000
504600     IF  LBPTDA-TRIP-ID    >  ZERO                                50460000
504700         MOVE LBPTDA-TRIP-ID   TO  PC179-TRIP-ID                  50470000
504800     ELSE                                                         50480000
504900         MOVE '@@@@@@@@@'      TO  PC179-TRIP-ID                  50490000
505000     END-IF.                                                      50500000
505100                                                                  50510000
505200*                                                                 50520000
505300*----------------------------------------------------------------*50530000
505400* SEND SML LABEL DATA                                            *50540000
505500*----------------------------------------------------------------*50550000
505600 4578-SEND-MESSAGE-DATA.                                          50560000
505700     SET  PC133-LABEL-DTL           TO  TRUE.                     50570000
505800     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       50580000
505900     SET  PC179-IDX-2               TO  PC179-IDX.                50590000
506000     MOVE PC179-DTL-DATA-LNE-LNGTH (PC179-IDX-2)                  50600000
506100                                    TO  PC133-DTL-LENGTH.         50610000
506200     MOVE PC179-SML-LABEL-LINE (PC179-IDX)                        50620000
506300                                    TO  PC133-DTL-DATA.           50630000
506400                                                                  50640000
506500     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    50650000
506600         '' BY SPACES.                                           50660000
506700     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    50670000
506800         ';' BY SPACES.                                           50680000
506900     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    50690000
507000         LOW-VALUES BY SPACES.                                    50700000
507100                                                                  50710000
507200******************************************************************50720000
507300* LENGTH CALCULATION:                                            *50730000
507400*       LINE LENGTH SML DATA     (PC179-DTL-DATA-LNE-LNGTH)      *50740000
507500*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *50750000
507600*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *50760000
507700*              PC133-DTL-LENGTH        (3 POSITIONS)             *50770000
507800*              HEX 03-END EACH DTL REC (1 POSITIONS)             *50780000
507900*              FILLER                  (6 POSITIONS)             *50790000
508000******************************************************************50800000
508100     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        50810000
508200     MOVE PC179-DTL-DATA-LNE-LNGTH (PC179-IDX-2)                  50820000
508300                                  TO PC133-DTL-REC-LENGTH.        50830000
508400     ADD  20                      TO PC133-DTL-REC-LENGTH.        50840000
508500     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                50850000
508600                                     DP081-NBR-BYTES.             50860000
508700                                                                  50870000
508800     PERFORM 5100-SEND-DATA-TO-LPMS.                              50880000
508900                                                                  50890000
509000     ADD  1  TO  PV-TRAILER-COUNT.                                50900000
509100*                                                                 50910000
509200*                                                                 50920000
509300*----------------------------------------------------------------*50930000
509400* SEND TRAILER LABEL                                             *50940000
509500*----------------------------------------------------------------*50950000
509600 4590-TLR-LABEL.                                                  50960000
509700                                                                  50970000
509800     INITIALIZE PC133-LABEL-DTL-REC.                              50980000
509900     SET  PC133-LABEL-DTL           TO  TRUE.                     50990000
510000                                                                  51000000
510100     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       51010000
510200     SET  PC137-IDX-2               TO  PC137-IDX.                51020000
510300     MOVE PC137-TLR-LINE-LENGTH (PC137-IDX-2)                     51030000
510400                                    TO  PC133-DTL-LENGTH.         51040000
510500     MOVE PC137-SML-TRAILER-LABEL-LINE (PC137-IDX)                51050000
510600                                    TO  PC133-DTL-DATA.           51060000
510700                                                                  51070000
510800     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    51080000
510900         '' BY SPACES.                                           51090000
511000     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    51100000
511100         ';' BY SPACES.                                           51110000
511200     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    51120000
511300         LOW-VALUES BY SPACES.                                    51130000
511400                                                                  51140000
511500******************************************************************51150000
511600* LENGTH CALCULATION:                                            *51160000
511700*       LINE LENGTH TRAILER LBL  (PC137-TLR-LINE-LENGTH)         *51170000
511800*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *51180000
511900*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *51190000
512000*              PC133-DTL-LENGTH        (3 POSITIONS)             *51200000
512100*              HEX 03-END EACH DTL REC (1 POSITIONS)             *51210000
512200*              FILLER                  (6 POSITIONS)             *51220000
512300******************************************************************51230000
512400     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        51240000
512500     MOVE PC137-TLR-LINE-LENGTH (PC137-IDX-2)                     51250000
512600                                  TO PC133-DTL-REC-LENGTH.        51260000
512700     ADD  20                      TO PC133-DTL-REC-LENGTH.        51270000
512800     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                51280000
512900                                     DP081-NBR-BYTES.             51290000
513000                                                                  51300000
513100     PERFORM 5100-SEND-DATA-TO-LPMS.                              51310000
513200                                                                  51320000
513300     ADD  1  TO  PV-TRAILER-COUNT.                                51330000
513400                                                                  51340000
513500                                                                  51350000
513600*----------------------------------------------------------------*51360000
513700*                                                                *51370000
513800*----------------------------------------------------------------*51380000
513900 4600-BLD-TLR-REC.                                                51390000
514000                                                                  51400000
514100     INITIALIZE PC133-LABEL-TLR-REC.                              51410000
514200     SET  PC133-LABEL-TLR           TO  TRUE.                     51420000
514300                                                                  51430000
514400     MOVE PV-LPMS-TRANS-ID          TO  PC133-TLR-TRANS-ID.       51440000
514500     MOVE PV-TRAILER-COUNT          TO  PC133-TLR-RECORD-COUNT.   51450000
514600                                                                  51460000
514700     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    51470000
514800         '' BY SPACES.                                           51480000
514900     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    51490000
515000         ';' BY SPACES.                                           51500000
515100     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    51510000
515200         LOW-VALUES BY SPACES.                                    51520000
515300                                                                  51530000
515400     MOVE PC133-TLR-REC-LENGTH    TO DP081-TCPLENG                51540000
515500                                     DP081-NBR-BYTES.             51550000
515600                                                                  51560000
515700     PERFORM 5100-SEND-DATA-TO-LPMS.                              51570000
515800                                                                  51580000
515900                                                                  51590000
516000*----------------------------------------------------------------*51600000
516100* GENERATE LABEL HISTORY INFORMATION                             *51610000
516200*----------------------------------------------------------------*51620000
516300 4700-LABEL-HISTORY.                                              51630000
516400                                                                  51640000
516500     INITIALIZE  DCLTLBTKHS                                       51650000
516600                 DCLTLBTKID.                                      51660000
516700                                                                  51670000
516800     MOVE  PV-LPMS-TRANS-ID         TO LBTKHS-LBL-REQ-TRN-ID.     51680000
516900     MOVE  PC-CHECK-IN-LBL-APPL     TO LBTKHS-LBL-TYP-CDE.        51690000
517000     MOVE  SU001-USER-ID            TO LBTKHS-CRED-BY-USR-ID.     51700000
517100     MOVE  PC-CURRENT-PROGRAM-NAME  TO LBTKHS-REQ-PGM-NM.         51710000
517200     MOVE  ZEROES                   TO LBTKHS-LOC-ID.             51720000
517300     MOVE  PV-DB2-LABEL-COUNT       TO LBTKHS-LBL-PRT-QTY.        51730000
517400     ADD   2                        TO LBTKHS-LBL-PRT-QTY.        51740000
517500     MOVE  SU001-PRINTER-ID-USE     TO LBTKHS-PRTR-ID.            51750000
517600     MOVE  SU001-CURR-OPER-UNT-ID   TO LBTKHS-PRTR-OPER-UNT-ID.   51760000
517700     MOVE  SU001-FCLTY-ID           TO LBTKHS-PRTR-FCLTY-ID.      51770000
517800     MOVE  PC-SOCKET-INTERFACE      TO LBTKHS-XMIT-INTFC-CDE.     51780000
517900     MOVE  PC-A                     TO LBTKHS-XMIT-STAT-CDE.      51790000
518000     MOVE  ZERO                     TO LBTKHS-USR-LBL-ID-LEN.     51800000
518100                                                                  51810000
518200     PERFORM 4710-INSERT-TLBTKHS.                                 51820000
518300                                                                  51830000
518400     MOVE  PV-LPMS-TRANS-ID         TO LBTKID-LBL-REQ-TRN-ID.     51840000
518500     MOVE  PC-CHECK-IN-LBL-APPL     TO LBTKID-LBL-TYP-CDE.        51850000
518600     MOVE  ZEROES                   TO LBTKID-PO-NBR.             51860000
518700     MOVE  ZEROES                   TO LBTKID-RCVR-SEQ-NBR.       51870000
518800     MOVE  ZEROES                   TO LBTKID-PO-LNE-NBR.         51880000
518900     MOVE  SU001-MANIFEST           TO LBTKID-TRIP-ID.            51890000
519000     MOVE  SU001-BATCH-NO-USE       TO LBTKID-LBL-PRT-BTCH-ID.    51900000
519100     MOVE  PV-DB2-LABEL-COUNT       TO LBTKID-LBL-PRT-QTY.        51910000
519200     MOVE  2                        TO LBTKID-SEPOR-LBL-PRT-QTY.  51920000
519300                                                                  51930000
519400     PERFORM 4720-INSERT-LBTKID.                                  51940000
519500                                                                  51950000
519600     PERFORM 9100-SYNCPOINT.                                      51960000
519700                                                                  51970000
519800*----------------------------------------------------------------*51980000
519900* INSERT INTO TLBTKHS - LABEL HISTORY                            *51990000
520000*----------------------------------------------------------------*52000000
520100 4710-INSERT-TLBTKHS.                                             52010000
520200                                                                  52020000
520300     EXEC SQL                                                     52030000
520400         INSERT INTO TLBTKHS                                      52040000
520500               (LBL_REQ_TRN_ID,                                   52050000
520600                LBL_TYP_CDE,                                      52060000
520700                CRE_TMST,                                         52070000
520800                CRED_BY_USR_ID,                                   52080000
520900                REQ_PGM_NM,                                       52090000
521000                LOC_ID,                                           52100000
521100                LBL_PRT_QTY,                                      52110000
521200                PRTR_ID,                                          52120000
521300                PRTR_OPER_UNT_ID,                                 52130000
521400                PRTR_FCLTY_ID,                                    52140000
521500                XMIT_INTFC_CDE,                                   52150000
521600                XMIT_STAT_CDE,                                    52160000
521700                USR_LBL_ID)                                       52170000
521800         VALUES                                                   52180000
521900               (:LBTKHS-LBL-REQ-TRN-ID,                           52190000
522000                :LBTKHS-LBL-TYP-CDE,                              52200000
522100                CURRENT TIMESTAMP,                                52210000
522200                :LBTKHS-CRED-BY-USR-ID,                           52220000
522300                :LBTKHS-REQ-PGM-NM,                               52230000
522400                :LBTKHS-LOC-ID,                                   52240000
522500                :LBTKHS-LBL-PRT-QTY,                              52250000
522600                :LBTKHS-PRTR-ID,                                  52260000
522700                :LBTKHS-PRTR-OPER-UNT-ID,                         52270000
522800                :LBTKHS-PRTR-FCLTY-ID,                            52280000
522900                :LBTKHS-XMIT-INTFC-CDE,                           52290000
523000                :LBTKHS-XMIT-STAT-CDE,                            52300000
523100                :LBTKHS-USR-LBL-ID)                               52310000
523200     END-EXEC.                                                    52320000
523300                                                                  52330000
523400     EVALUATE TRUE                                                52340000
523500         WHEN SQLCODE = ZERO                                      52350000
523600             CONTINUE                                             52360000
523700         WHEN SQLWARN0 NOT = SPACES                               52370000
523800         WHEN SQLCODE NOT EQUAL ZERO                              52380000
523900             MOVE '4710-INSERT-TLBTKHS'                           52390000
524000                             TO DP013-PARAGRAPH                   52400000
524100             MOVE 'SUKRF527 - INSERT LABEL HISTORY'               52410000
524200                             TO DP013-MESSAGE-TEXT(1)             52420000
524300             MOVE SU001-MANIFEST                                  52430000
524400                             TO DP013-MESSAGE-TEXT(2)             52440000
524500             MOVE SQLCA      TO DP013-SQLCA                       52450000
524600             MOVE 'TLBTKHS'  TO DP013-DB2-TABLE-NAME(1)           52460000
524700             SET DP013-DB2-ABEND              TO TRUE             52470000
524800*            PERFORM 9999-WRITE-CICS-LOG-MSG                      52480000
524900             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              52490000
525000             PERFORM DP014-0000-PROCESS-ABEND                     52500000
525100     END-EVALUATE.                                                52510000
525200                                                                  52520000
525300                                                                  52530000
525400*----------------------------------------------------------------*52540000
525500* INSERT INTO TLBTKID - LABEL IDENTIFICATION                     *52550000
525600*----------------------------------------------------------------*52560000
525700 4720-INSERT-LBTKID.                                              52570000
525800                                                                  52580000
525900     EXEC SQL                                                     52590000
526000         INSERT INTO TLBTKID                                      52600000
526100               (LBL_REQ_TRN_ID,                                   52610000
526200                LBL_TYP_CDE,                                      52620000
526300                PO_NBR,                                           52630000
526400                RCVR_SEQ_NBR,                                     52640000
526500                PO_LNE_NBR,                                       52650000
526600                TRIP_ID,                                          52660000
526700                LBL_PRT_BTCH_ID,                                  52670000
526800                LBL_PRT_QTY,                                      52680000
526900                SEPOR_LBL_PRT_QTY)                                52690000
527000         VALUES                                                   52700000
527100               (:LBTKID-LBL-REQ-TRN-ID,                           52710000
527200                :LBTKID-LBL-TYP-CDE,                              52720000
527300                :LBTKID-PO-NBR,                                   52730000
527400                :LBTKID-RCVR-SEQ-NBR,                             52740000
527500                :LBTKID-PO-LNE-NBR,                               52750000
527600                :LBTKID-TRIP-ID,                                  52760000
527700                :LBTKID-LBL-PRT-BTCH-ID,                          52770000
527800                :LBTKID-LBL-PRT-QTY,                              52780000
527900                :LBTKID-SEPOR-LBL-PRT-QTY)                        52790000
528000     END-EXEC.                                                    52800000
528100                                                                  52810000
528200     EVALUATE TRUE                                                52820000
528300         WHEN SQLCODE = ZERO                                      52830000
528400             CONTINUE                                             52840000
528500         WHEN SQLWARN0 NOT = SPACES                               52850000
528600         WHEN SQLCODE NOT EQUAL ZERO                              52860000
528700             MOVE '4720-INSERT-LBTKIDS'                           52870000
528800                             TO DP013-PARAGRAPH                   52880000
528900             MOVE 'SUKRF527 - INSERT LABEL IDENTIFICATION'        52890000
529000                             TO DP013-MESSAGE-TEXT(1)             52900000
529100             MOVE SU001-MANIFEST                                  52910000
529200                             TO DP013-MESSAGE-TEXT(2)             52920000
529300             MOVE SQLCA      TO DP013-SQLCA                       52930000
529400             MOVE 'TLBTKHS'  TO DP013-DB2-TABLE-NAME(1)           52940000
529500             SET DP013-DB2-ABEND              TO TRUE             52950000
529600*            PERFORM 9999-WRITE-CICS-LOG-MSG                      52960000
529700             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              52970000
529800             PERFORM DP014-0000-PROCESS-ABEND                     52980000
529900     END-EVALUATE.                                                52990000
530000                                                                  53000000
530100                                                                  53010000
530200*----------------------------------------------------------------*53020000
530300* UPDATE TLBTKHS - LABEL HISTORY WITH RETURN ERROR               *53030000
530400*----------------------------------------------------------------*53040000
530500 4730-UPDATE-TLBTKHS.                                             53050000
530600                                                                  53060000
530700     MOVE PV-LPMS-TRANS-ID  TO  DK-LPMS-TRANS-ID.                 53070000
530800                                                                  53080000
530900     EXEC SQL                                                     53090000
531000         UPDATE TLBTKHS                                           53100000
531100         SET                                                      53110000
531200             XMIT_STAT_CDE  =  :PV-LPMS-XMIT-RETURN               53120000
531300          WHERE                                                   53130000
531400             LBL_REQ_TRN_ID  = :DK-LPMS-TRANS-ID                  53140000
531500     END-EXEC.                                                    53150000
531600                                                                  53160000
531700     EVALUATE TRUE                                                53170000
531800         WHEN SQLCODE = ZERO                                      53180000
531900              CONTINUE                                            53190000
532000                                                                  53200000
532100         WHEN OTHER                                               53210000
532200             MOVE   DK-LPMS-TRANS-ID   TO PV-DISPLAY-LPMS-TRAN    53220000
532300              STRING ' SUKRF527 - '            DELIMITED BY SIZE  53230000
532400                     'DK-LPMS-TRANS-ID: '      DELIMITED BY SIZE  53240000
532500                     PV-DISPLAY-LPMS-TRAN      DELIMITED BY SIZE  53250000
532600                     '  PV-LPMS-XMIT-RETURN: ' DELIMITED BY SIZE  53260000
532700                     PV-LPMS-XMIT-RETURN       DELIMITED BY SIZE  53270000
532800                                           INTO PV-CICS-MSG-AREA  53280000
532900              MOVE LENGTH OF PV-CICS-MSG-AREA                     53290000
533000                     TO PV-COMMAREA-LENGTH                        53300000
533100              PERFORM 9990-WRITE-CICS                             53310000
533200                                                                  53320000
533300             MOVE '4730-UPDATE-TLBTKHS'                           53330000
533400                             TO DP013-PARAGRAPH                   53340000
533500             MOVE 'SUKRF527 - UPDATE LPMS HISTORY RETURN'         53350000
533600                             TO DP013-MESSAGE-TEXT(1)             53360000
533700             MOVE PV-LPMS-TRANS-ID                                53370000
533800                             TO DP013-MESSAGE-TEXT(2)             53380000
533900             MOVE SQLCA      TO DP013-SQLCA                       53390000
534000             MOVE 'TLBTKHS'  TO DP013-DB2-TABLE-NAME(1)           53400000
534100             SET DP013-DB2-ABEND              TO TRUE             53410000
534200*            PERFORM 9999-WRITE-CICS-LOG-MSG                      53420000
534300             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              53430000
534400             PERFORM DP014-0000-PROCESS-ABEND                     53440000
534500     END-EVALUATE.                                                53450000
534600                                                                  53460000
534700                                                                  53470000
534800*----------------------------------------------------------------*53480000
534900*  GET LPMS RETURN CODE                                          *53490000
535000*----------------------------------------------------------------*53500000
535100 4740-GET-LPMS-RETURN.                                            53510000
535200                                                                  53520000
535300     SEARCH ALL PC138-SOCKET-ERRORS                               53530000
535400            AT END                                                53540000
535500                MOVE 'Z' TO  PV-LPMS-XMIT-RETURN                  53550000
535600            WHEN                                                  53560000
535700                PC138-CONFIRM-CODE(PC138-IDX)  =                  53570000
535800                PC133-CONFIRM-CODE                                53580000
535900                    MOVE PC138-XREF-CODE(PC138-IDX)               53590000
536000                      TO PV-LPMS-XMIT-RETURN.                     53600000
536100                                                                  53610000
536200                                                                  53620000
536300                                                                  53630000
536400*----------------------------------------------------------------*53640000
536500*  CHECK TO SEE IF LABEL TRANSACTION ID ALREADY EXISTS           *53650000
536600*----------------------------------------------------------------*53660000
536700 4750-CK-TRANS-ID.                                                53670000
536800                                                                  53680000
536900     MOVE PV-LPMS-TRANS-ID  TO  DK-LPMS-TRANS-ID.                 53690000
537000                                                                  53700000
537100     EXEC SQL                                                     53710000
537200          SELECT LBL_REQ_TRN_ID                                   53720000
537300          INTO  :LBTKHS-LBL-REQ-TRN-ID                            53730000
537400          FROM   TLBTKHS                                          53740000
537500          WHERE  LBL_REQ_TRN_ID  = :DK-LPMS-TRANS-ID              53750000
537510          with ur                                                 53751014
537600     END-EXEC.                                                    53760000
537700                                                                  53770000
537800     EVALUATE TRUE                                                53780000
537900         WHEN SQLCODE = ZERO                                      53790000
538000              ADD  1  TO  PV-LPMS-TRANS-ID                        53800000
538100              SET  PS-TRANS-ID-DUP    TO  TRUE                    53810000
538200                                                                  53820000
538300         WHEN SQLCODE = +100                                      53830000
538400             SET PS-TRANS-ID-NOT-DUP  TO  TRUE                    53840000
538500             SET PS-VALID-TRANS-ID    TO  TRUE                    53850000
538600                                                                  53860000
538700         WHEN OTHER                                               53870000
538800             MOVE   DK-LPMS-TRANS-ID   TO PV-DISPLAY-LPMS-TRAN    53880000
538900              STRING ' SUKRF527 - '            DELIMITED BY SIZE  53890000
539000                     'DK-LPMS-TRANS-ID: '      DELIMITED BY SIZE  53900000
539100                     PV-DISPLAY-LPMS-TRAN      DELIMITED BY SIZE  53910000
539200                                           INTO PV-CICS-MSG-AREA  53920000
539300              MOVE LENGTH OF PV-CICS-MSG-AREA                     53930000
539400                     TO PV-COMMAREA-LENGTH                        53940000
539500              PERFORM 9990-WRITE-CICS                             53950000
539600                                                                  53960000
539700             MOVE '4750-CK-TRANS-ID'                              53970000
539800                             TO DP013-PARAGRAPH                   53980000
539900             MOVE 'SUKRF527 - CK FOR DUP LPMS TRANS ID'           53990000
540000                             TO DP013-MESSAGE-TEXT(1)             54000000
540100             MOVE PV-LPMS-TRANS-ID                                54010000
540200                             TO DP013-MESSAGE-TEXT(2)             54020000
540300             MOVE SQLCA      TO DP013-SQLCA                       54030000
540400             MOVE 'TLBTKID'  TO DP013-DB2-TABLE-NAME(1)           54040000
540500             SET DP013-DB2-ABEND              TO TRUE             54050000
540600*            PERFORM 9999-WRITE-CICS-LOG-MSG                      54060000
540700             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              54070000
540800             PERFORM DP014-0000-PROCESS-ABEND                     54080000
540900     END-EVALUATE.                                                54090000
541000                                                                  54100000
541100*----------------------------------------------------------------*54110000
541200*  SEND HEADER LABEL                                             *54120000
541300*----------------------------------------------------------------*54130000
541400 4800-CREATE-HEADER-LABEL.                                        54140000
541500* SEND HEADER LABEL                                               54150000
541600                                                                  54160000
541700     SET  PC133-LABEL-DTL             TO TRUE.                    54170000
541800     MOVE SU001-USER-ID               TO PC134-REQUESTED-BY.      54180000
541900     IF  SU001-BATCH-NUMBER  =  SU001-BATCH-NO-USE                54190000
542000         MOVE '1X1100000100045L000000'   TO PC134-REPRINT-BOX     54200000
542100         MOVE '341100500320150@@@@@@@@@' TO PC134-REPRINT-FIELD   54210000
542200         SET  PS-NOT-REPRINT-BATCH       TO TRUE                  54220000
542300     ELSE                                                         54230000
542400         MOVE '1X1100000100045L115025'   TO PC134-REPRINT-BOX     54240000
542500         MOVE '341100500320150*REPRINT*' TO PC134-REPRINT-FIELD   54250000
542600         SET  PS-REPRINT-BATCH           TO TRUE                  54260000
542700     END-IF.                                                      54270000
542800     MOVE PV-OWNER-SCAC-ID            TO PC134-SCAC.              54280000
542900     MOVE PV-VEH-NBR                  TO PC134-TRAILER.           54290000
543000     MOVE SU001-MANIFEST              TO PC134-TRIP.              54300000
543100     MOVE SU001-BATCH-NO-USE          TO PC134-BATCH-NBR.         54310000
543200     IF  SU001-BATCH-NUMBER  =  SU001-BATCH-NO-USE                54320000
543300         MOVE PV-DB2-REPRINT-LBL-CNT  TO PC134-REPRINT-LBL-CNT    54330000
543400     ELSE                                                         54340000
543500         MOVE PV-DB2-LABEL-COUNT      TO PC134-REPRINT-LBL-CNT    54350000
543600     END-IF                                                       54360000
543700     MOVE PV-DB2-LABEL-COUNT          TO PC134-SML-LBL-CNT.       54370000
543800     MOVE SU001-PRINTER-ID-USE        TO PC134-PRINTER-ID.        54380000
543900     MOVE PV-CURRENT-MM-DD            TO PC134-SUBMIT-MMDD.       54390000
544000     MOVE PV-CURRENT-TIME             TO PC134-SUBMIT-HHMM.       54400000
544100                                                                  54410000
544200     IF  PV-DB2-EXCEPT-LBL-CNT  >  ZERO                           54420000
544300         MOVE '1X1100003300045L465050' TO PC134-EXCEPT-BOX        54430000
544400         MOVE '342200503720390EXCEPTIONS EXIST'                   54440000
544500                                       TO PC134-EXCEPT-FIELD      54450000
544600     ELSE                                                         54460000
544700         MOVE '1X1100003300045L000000' TO PC134-EXCEPT-BOX        54470000
544800         MOVE '342200503720390@@@@@@@@@@@@@@@@'                   54480000
544900                                       TO PC134-EXCEPT-FIELD      54490000
545000     END-IF.                                                      54500000
545100                                                                  54510000
545200     IF  PS-HEADER-DIVIDER-PRINT-YES                              54520000
545300         PERFORM 4510-HDR-LABEL                                   54530000
545400                 VARYING PC134-IDX FROM 1 BY 1                    54540000
545500                   UNTIL PC134-IDX > PC134-HEADER-LABEL-MAX-LN    54550000
545600                      OR PS-SOCKET-ERROR                          54560000
545700     END-IF.                                                      54570000
545800                                                                  54580000
545900*----------------------------------------------------------------*54590000
546000*  SEND TRAILER LABEL                                            *54600000
546100*----------------------------------------------------------------*54610000
546200 4810-CREATE-TRAILER-LABEL.                                       54620000
546300                                                                  54630000
546400     MOVE SU001-USER-ID              TO PC137-REQUESTED-BY.       54640000
546500     MOVE PV-OWNER-SCAC-ID           TO PC137-SCAC.               54650000
546600     MOVE PV-VEH-NBR                 TO PC137-TRAILER.            54660000
546700     MOVE SU001-MANIFEST             TO PC137-TRIP.               54670000
546800     MOVE SU001-BATCH-NO-USE         TO PC137-BATCH-NBR.          54680000
546900                                                                  54690000
547000     IF  SU001-BATCH-NUMBER  =  SU001-BATCH-NO-USE                54700000
547100         MOVE '1X1100000100045L000000'   TO PC137-REPRINT-BOX     54710000
547200         MOVE '341100500320150@@@@@@@@@' TO PC137-REPRINT-FIELD   54720000
547300         SET  PS-NOT-REPRINT-BATCH       TO TRUE                  54730000
547400     ELSE                                                         54740000
547500         MOVE '1X1100000100045L115025'   TO PC137-REPRINT-BOX     54750000
547600         MOVE '341100500320150*REPRINT*' TO PC137-REPRINT-FIELD   54760000
547700         SET  PS-REPRINT-BATCH           TO TRUE                  54770000
547800     END-IF.                                                      54780000
547900                                                                  54790000
548000     IF  PV-DB2-EXCEPT-LBL-CNT  >  ZERO                           54800000
548100         MOVE '1X1100003300045L465050' TO PC137-EXCEPT-BOX        54810000
548200         MOVE '342200503720388EXCEPTIONS EXIST'                   54820000
548300                                       TO PC137-EXCEPT-FIELD      54830000
548400     ELSE                                                         54840000
548500         MOVE '1X1100003300045L000000' TO PC137-EXCEPT-BOX        54850000
548600         MOVE '342200503720390@@@@@@@@@@@@@@@@'                   54860000
548700                                       TO PC137-EXCEPT-FIELD      54870000
548800     END-IF.                                                      54880000
548900                                                                  54890000
549000     IF  PS-TRAILER-DIVIDER-PRINT-YES                             54900000
549100         PERFORM 4590-TLR-LABEL                                   54910000
549200             VARYING PC137-IDX FROM 1 BY 1                        54920000
549300               UNTIL PC137-IDX > PC137-SML-TRAILER-LABEL-MAX-LN   54930000
549400                  OR PS-SOCKET-ERROR                              54940000
549500     END-IF.                                                      54950000
549600*                                                                 54960000
549700*                                                                 54970000
549800*----------------------------------------------------------------*54980000
549900*  CREATE SHIPPING MANIFEST LABEL                                *54990000
550000*----------------------------------------------------------------*55000000
550100 4900-CREATE-SML-LABEL.                                           55010000
550200*                                                                 55020000
550300*  SEND SML LABEL FORM                                            55030000
550400*                                                                 55040000
550500     IF LBPTDA-CART-ACTN-CDE = PC-Q                               55050000
550600        SET XL088-ONHND-QTY-NOT-ZERO TO TRUE                      55060000
550700     ELSE                                                         55070000
550800        PERFORM 7000-CALL-STORE-ON-HAND-MOD                       55080000
550900        PERFORM 7100-CHECK-AUDIT-CRTN                             55090000
551000     END-IF                                                       55100000
551100                                                                  55110000
551200     IF XL088-PROCESS-MSG-NO AND  PC255-OH-ZERO-NO                55120000
551300        CONTINUE                                                  55130000
551400     ELSE                                                         55140000
551500        IF XL088-PROCESS-MSG-YES AND PC255-OH-ZERO-YES            55150000
551600           CONTINUE                                               55160000
551700        ELSE                                                      55170000
551800           MOVE SPACES TO PV-PREV-LABEL-TYPE                      55180000
551900        END-IF                                                    55190000
552000     END-IF                                                       55200000
552100                                                                  55210000
552200* WR41309-RF ID 8/30/2012  AME  BEGIN                             55220000
552300     IF LBPTDA-CART-ACTN-CDE = PC-Q                               55230000
552400        PERFORM 3250-SELECT-BRCDE                                 55240000
552500        IF PS-SULBXF-FOUND                                        55250000
552600           MOVE SULBXF-BRCDE-NBR   TO PV-OTBND-CRTN-SULBXF        55260000
552700           MOVE PV-OTBND-SML-SULBXF TO SUT00094-SHIPT-UNT-ID      55270000
552800        END-IF                                                    55280000
552900     ELSE                                                         55290000
553000        MOVE LBPTDA-BRCDE-NBR  TO PV-OTBND-CRTN                   55300000
553100        MOVE PV-OTBND-SML      TO SUT00094-SHIPT-UNT-ID           55310000
553200     END-IF                                                       55320000
553300*                                                                 55330000
553400     PERFORM 3300-COUNT-MSG-RD                                    55340000
553500                                                                  55350000
553600*                                                                 55360000
553700* WR41309-RF ID 8/30/2012  AME  END                               55370000
553800*                                                                 55380000
553900     IF PS-AUDIT-CRTN-FOUND-NO AND PC255-AUDIT-NO                 55390000
554000        CONTINUE                                                  55400000
554100     ELSE                                                         55410000
554200        IF PS-AUDIT-CRTN-FOUND-YES AND PC255-AUDIT-YES            55420000
554300           CONTINUE                                               55430000
554400        ELSE                                                      55440000
554500           MOVE SPACES TO PV-PREV-LABEL-TYPE                      55450000
554600        END-IF                                                    55460000
554700     END-IF                                                       55470000
554800                                                                  55480000
554900     IF PS-AUDIT-CRTN-FOUND-YES                                   55490000
555000        SET PC255-AUDIT-YES TO TRUE                               55500000
555100     ELSE                                                         55510000
555200        SET PC255-AUDIT-NO TO TRUE                                55520000
555300     END-IF                                                       55530000
555400                                                                  55540000
555500                                                                  55550000
555600*** DMH 12/15/10 BEGIN                                            55560000
555700*DMH IF  LBPTDA-FIXT-ID  >  SPACES                                55570000
555800*DMH6/30 IF  PC255-FIXTURE-YES                                    55580000
555900*DMH6/30     CONTINUE                                             55590000
556000*DMH6/30 ELSE                                                     55600000
556100*DMH6/30     SET  PC255-FIXTURE-YES  TO  TRUE                     55610000
556200*DMH6/30     MOVE SPACES TO PV-PREV-LABEL-TYPE                    55620000
556300*DMH6/30 END-IF                                                   55630000
556400*DMH ELSE                                                         55640000
556500*DMH6/30 IF  PC255-FIXTURE-YES                                    55650000
556600*DMH6/30     SET  PC255-FIXTURE-NO  TO  TRUE                      55660000
556700*DMH6/30     MOVE SPACES TO PV-PREV-LABEL-TYPE                    55670000
556800*DMH6/30 END-IF                                                   55680000
556900*DMH END-IF.                                                      55690000
557000*** DMH 12/15/10 END                                              55700000
557100                                                                  55710000
557200                                                                  55720000
557300* GB 01/4/02 WHEN PREVIOUS TYPE IS AUDIT, FORCE FORM TO BE RESENT 55730000
557400     IF LBPTDA-CART-ACTN-CDE = PV-PREV-AUDIT-CART-IND             55740000
557500        CONTINUE                                                  55750000
557600     ELSE                                                         55760000
557700        MOVE SPACES TO PV-PREV-LABEL-TYPE                         55770000
557800     END-IF                                                       55780000
557900* GB 1/04/02 END                                                  55790000
558000                                                                  55800000
558100     IF (LBPTDA-CART-LBL-TYP-CDE = PV-PREV-LABEL-TYPE) AND        55810000
558200        (SULBXF-CART-LBL-TYP-CDE = PV-PREV-SULBXF-LBL-TYP-CDE)    55820000
558300       IF PS-REPRINT-BATCH AND PS-REPRINT-FORM                    55830000
558400          IF LBPTDA-PREPK-ID > 0 AND PS-PREPK-FORM                55840000
558500             CONTINUE                                             55850000
558600          ELSE                                                    55860000
558700             PERFORM 4559-BUILD-SML-FORM                          55870000
558800             PERFORM 4560-SEND-SML-FORM                           55880000
558900                 VARYING PC255-IDX FROM 1 BY 1                    55890000
559000                 UNTIL PC255-IDX >                                55900000
559100                       PC255-SML-BATCH-LBL-MAX-LN                 55910000
559200                 OR PS-SOCKET-ERROR                               55920000
559300          END-IF                                                  55930000
559400       ELSE                                                       55940000
559500         IF LBPTDA-RPRT-IND = PC-Y AND PS-REPRINT-FORM            55950000
559600            IF LBPTDA-PREPK-ID > 0 AND PS-PREPK-FORM              55960000
559700               CONTINUE                                           55970000
559800            ELSE                                                  55980000
559900               PERFORM 4559-BUILD-SML-FORM                        55990000
560000               PERFORM 4560-SEND-SML-FORM                         56000000
560100                   VARYING PC255-IDX FROM 1 BY 1                  56010000
560200                   UNTIL PC255-IDX >                              56020000
560300                         PC255-SML-BATCH-LBL-MAX-LN               56030000
560400                   OR PS-SOCKET-ERROR                             56040000
560500            END-IF                                                56050000
560600         ELSE                                                     56060000
560700           IF LBPTDA-RPRT-IND = PC-Y                              56070000
560800               PERFORM 4559-BUILD-SML-FORM                        56080000
560900               PERFORM 4560-SEND-SML-FORM                         56090000
561000                   VARYING PC255-IDX FROM 1 BY 1                  56100000
561100                UNTIL PC255-IDX > PC255-SML-BATCH-LBL-MAX-LN      56110000
561200                        OR PS-SOCKET-ERROR                        56120000
561300           ELSE                                                   56130000
561400             IF LBPTDA-RPRT-IND NOT = PC-Y AND                    56140000
561500                 PS-REPRINT-FORM                                  56150000
561600                 PERFORM 4559-BUILD-SML-FORM                      56160000
561700                 PERFORM 4560-SEND-SML-FORM                       56170000
561800                     VARYING PC255-IDX FROM 1 BY 1                56180000
561900                       UNTIL PC255-IDX >                          56190000
562000                             PC255-SML-BATCH-LBL-MAX-LN           56200000
562100                          OR PS-SOCKET-ERROR                      56210000
562200             END-IF                                               56220000
562300           END-IF                                                 56230000
562400         END-IF                                                   56240000
562500       END-IF                                                     56250000
562600     ELSE                                                         56260000
562700        PERFORM 4559-BUILD-SML-FORM                               56270000
562800        PERFORM 4560-SEND-SML-FORM                                56280000
562900           VARYING PC255-IDX FROM 1 BY 1                          56290000
563000             UNTIL PC255-IDX > PC255-SML-BATCH-LBL-MAX-LN         56300000
563100                OR PS-SOCKET-ERROR                                56310000
563200     END-IF.                                                      56320000
563300*                                                                 56330000
563400     PERFORM 4561-BUILD-SML-DATA                                  56340000
563500     PERFORM 4562-SEND-SML-DATA                                   56350000
563600         VARYING PC256-IDX FROM 1 BY 1                            56360000
563700           UNTIL PC256-IDX > PC256-MAX-LABEL-LINES                56370000
563800              OR PS-SOCKET-ERROR.                                 56380000
563900*                                                                 56390000
564000*                                                                 56400000
564100*----------------------------------------------------------------*56410000
564200*  CREATE PACK TO LIGHT LABEL                                    *56420000
564300*----------------------------------------------------------------*56430000
564400 4910-CREATE-P2L-LABEL.                                           56440000
564500                                                                  56450000
564600     IF LBPTDA-PREPK-ID > 0                                       56460000
564700***PACK DIVIDE***                                                 56470000
564800              MOVE PC169-PK-DIVIDE-FLD                            56480000
564900                                      TO PC169-PACK-DIVIDE-FLD    56490000
565000*PACK-XXXX                                                        56500000
565100              MOVE LBPTDA-PREPK-ID                                56510000
565200                                      TO PV-PREPK-ID              56520000
565300              MOVE PV-PACK                                        56530000
565400                                      TO PC169-SKU                56540000
565500*DRIVR LINE RATIO:                                                56550000
565600              MOVE PC169-DRVR-LNE-RATIO-DESC                      56560000
565700                                      TO PC169-LNE-NO-DESC        56570000
565800              MOVE LBPTDA-PREPK-RATO-QTY                          56580000
565900                                      TO PV-LINE-RATO             56590000
566000              MOVE PV-LINE-RATO-NBR   TO PC169-LINE-NO            56600000
566100*TOT UNTS IN PACK:                                                56610000
566200              MOVE PC169-TOT-UNITS-DESC                           56620000
566300                                      TO PC169-DES-INPK-DESC      56630000
566400              MOVE LBPTDA-PREPK-UNT-QTY                           56640000
566500                                      TO PC169-DES-INPK-QTY       56650000
566600*PACKS IN CARTON:                                                 56660000
566700              MOVE PC169-PCKS-INCTN-DESC                          56670000
566800                                      TO PC169-DES-UNT-PK-DESC    56680000
566900*GB 3/21/01*******************************************************56690000
567000            DIVIDE LBPTDA-OTPK-UNT-QTY BY                         56700000
567100                          LBPTDA-PREPK-UNT-QTY                    56710000
567200                          GIVING   PV-PACKS-IN-CARTON             56720000
567300            MOVE PV-PACKS-IN-CARTON-X                             56730000
567400                                    TO PC169-DES-UNT-PK-QTY       56740000
567500*DRIVR LNE SKU:                                                   56750000
567600          MOVE PC169-DRVR-LINE-DESC                               56760000
567700                                  TO PC169-DES-DWN-SK-DESC        56770000
567800                                                                  56780000
567900          MOVE   LBPTDA-SKU-NBR                                   56790000
568000                                  TO PC169-DES-DWN-SK-QTY         56800000
568100                                                                  56810000
568200                                                                  56820000
568300          MOVE PC169-PK-DIVIDE-BOX                                56830000
568400                                  TO PC169-PACK-DIVIDE-BOX        56840000
568500                                                                  56850000
568600           MOVE LBPTDA-BRCDE-NBR      TO PC169-BC-BARCODE         56860000
568700                                         PC169-TXT-BARCODE        56870000
568800           MOVE LBPTDA-CRE-USR-ID                                 56880000
568900                                      TO PC169-USER-ID            56890000
569000*                                                                 56900000
569100           PERFORM 3040-GET-DC-PRTD-AT                            56910000
569200           MOVE LBPTDA-PRTR-ID                                    56920000
569300                                      TO PV-PRTR-ID               56930000
569400           MOVE PV-PRINTER-FORMAT     TO PC169-DES-PRINTER-ID     56940000
569500*                                                                 56950000
569600           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         56960000
569700                                      TO PC169-LABEL-NBR          56970000
569800           MOVE LBPTDA-LBL-TYP-TOT-QTY                            56980000
569900                                      TO PC169-TOT-LABEL          56990000
570000           MOVE PV-CURRENT-DB2-DATE   TO PV-WORK-DB2-DATE         57000000
570100           MOVE PV-WORK-YY            TO PV-LBL-DATE-YY           57010000
570200           MOVE PV-WORK-MM            TO PV-LBL-DATE-MM           57020000
570300           MOVE PV-WORK-DD            TO PV-LBL-DATE-DD           57030000
570400           MOVE '-'                   TO PV-LBL-DASH1             57040000
570500                                         PV-LBL-DASH2             57050000
570600           MOVE PV-LBL-DATE           TO PC169-LBL-PRT-DATE       57060000
570700           MOVE PV-CURRENT-TIME                                   57070000
570800                                      TO PC169-LBL-PRT-TIME       57080000
570900           MOVE PC169-LABEL-DESCRIPTION                           57090000
571000                                      TO PC169-DEST-LBL-DESC      57100000
571100*CRTN                                                             57110000
571200           MOVE LBPTDA-SHIPT-UNT-ID                               57120000
571300                                      TO PV-SHIPT-UNT-ID          57130000
571400           MOVE PV-LAST-FIVE-DIGITS                               57140000
571500                                      TO PC169-CRTN-NBR           57150000
571600*LBL SEQ                                                          57160000
571700           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         57170000
571800                                      TO PC169-START-CARTON-CNT-1 57180000
571900*SKU                                                              57190000
572000           MOVE LBPTDA-SKU-NBR        TO PC169-DES-DWN-SK-QTY     57200000
572100*PO RCVR                                                          57210000
572200           MOVE LBPTDA-PO-NBR                                     57220000
572300                                      TO PV-PO-NBR                57230000
572400           MOVE PV-PO-NBR-7POS                                    57240000
572500                                      TO PC169-DES-PO             57250000
572600           MOVE '-'                                               57260000
572700                                      TO PC169-DES-PO-DASH        57270000
572800           MOVE LBPTDA-RCVR-SEQ-NBR                               57280000
572900                                      TO PV-RCVR-NBR              57290000
573000           MOVE PV-RCVR-NBR-3POS                                  57300000
573100                                      TO PC169-SEQ-NO             57310000
573200*DEPT-CLASS                                                       57320000
573300           MOVE LBPTDA-SKU-DEPT-NBR                               57330000
573400                                      TO PV-P2L-DEPT1             57340000
573500           MOVE LBPTDA-SKU-CL-NBR                                 57350000
573600                                      TO PV-P2L-CLASS-NBR1        57360000
573700           MOVE PV-P2L-DEPT-CLASS                                 57370000
573800                                      TO PC169-DEPT-CLASS         57380000
573900                                                                  57390000
574000*ZONE                                                             57400000
574100           MOVE LBPTDA-STR-ZN-ID                                  57410000
574200                                      TO PC169-DES-ZONE           57420000
574300*MODULE NAME                                                      57430000
574400           MOVE LBPTDA-MODU-DESC                                  57440000
574500                                      TO PC169-MODULE-NAME        57450000
574600*****************IF NON-PREPACK ORDER*****************************57460000
574700     ELSE                                                         57470000
574800           MOVE LBPTDA-BRCDE-NBR      TO PC169-BC-BARCODE         57480000
574900                                         PC169-TXT-BARCODE        57490000
575000           MOVE LBPTDA-CRE-USR-ID                                 57500000
575100                                      TO PC169-USER-ID            57510000
575200*                                                                 57520000
575300           PERFORM 3040-GET-DC-PRTD-AT                            57530000
575400           MOVE LBPTDA-PRTR-ID                                    57540000
575500                                      TO PV-PRTR-ID               57550000
575600           MOVE PV-PRINTER-FORMAT     TO PC169-DES-PRINTER-ID     57560000
575700*                                                                 57570000
575800           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         57580000
575900                                      TO PC169-LABEL-NBR          57590000
576000           MOVE LBPTDA-LBL-TYP-TOT-QTY                            57600000
576100                                      TO PC169-TOT-LABEL          57610000
576200           MOVE PV-CURRENT-DB2-DATE   TO PV-WORK-DB2-DATE         57620000
576300           MOVE PV-WORK-YY            TO PV-LBL-DATE-YY           57630000
576400           MOVE PV-WORK-MM            TO PV-LBL-DATE-MM           57640000
576500           MOVE PV-WORK-DD            TO PV-LBL-DATE-DD           57650000
576600           MOVE '-'                   TO PV-LBL-DASH1             57660000
576700                                         PV-LBL-DASH2             57670000
576800           MOVE PV-LBL-DATE           TO PC169-LBL-PRT-DATE       57680000
576900           MOVE PV-CURRENT-TIME                                   57690000
577000                                      TO PC169-LBL-PRT-TIME       57700000
577100           MOVE PC169-LABEL-DESCRIPTION                           57710000
577200                                      TO PC169-DEST-LBL-DESC      57720000
577300*CRTN                                                             57730000
577400           MOVE LBPTDA-SHIPT-UNT-ID                               57740000
577500                                      TO PV-SHIPT-UNT-ID          57750000
577600           MOVE PV-LAST-FIVE-DIGITS                               57760000
577700                                      TO PC169-CRTN-NBR           57770000
577800*LBL SEQ                                                          57780000
577900           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         57790000
578000                                      TO PC169-START-CARTON-CNT-1 57800000
578100*SKU                                                              57810000
578200           MOVE LBPTDA-SKU-NBR                                    57820000
578300                                      TO PC169-SKU                57830000
578400*PO RCVR                                                          57840000
578500           MOVE LBPTDA-PO-NBR                                     57850000
578600                                      TO PV-PO-NBR                57860000
578700           MOVE PV-PO-NBR-7POS                                    57870000
578800                                      TO PC169-DES-PO             57880000
578900           MOVE '-'                                               57890000
579000                                      TO PC169-DES-PO-DASH        57900000
579100           MOVE LBPTDA-RCVR-SEQ-NBR                               57910000
579200                                      TO PV-RCVR-NBR              57920000
579300           MOVE PV-RCVR-NBR-3POS                                  57930000
579400                                      TO PC169-SEQ-NO             57940000
579500*DEPT-CLASS                                                       57950000
579600           MOVE LBPTDA-SKU-DEPT-NBR                               57960000
579700                                      TO PV-P2L-DEPT1             57970000
579800           MOVE LBPTDA-SKU-CL-NBR                                 57980000
579900                                      TO PV-P2L-CLASS-NBR1        57990000
580000           MOVE PV-P2L-DEPT-CLASS                                 58000000
580100                                      TO PC169-DEPT-CLASS         58010000
580200*LINE NUMBER                                                      58020000
580300           MOVE PC169-LINE-NO-DESC                                58030000
580400                                      TO PC169-LNE-NO-DESC        58040000
580500           MOVE LBPTDA-PO-LNE-NBR                                 58050000
580600                                      TO PV-LINE-NBR              58060000
580700           MOVE PV-PO-LINE-NBR                                    58070000
580800                                      TO PC169-LINE-NO            58080000
580900*INNER PACK UNITS                                                 58090000
581000       IF  LBPTDA-INPK-CNVYB-IND = 'Y'                            58100000
581100             MOVE PC169-INPK-CNVY-DESC                            58110000
581200                                        TO PC169-DES-INPK-DESC    58120000
581300             MOVE PC169-INPK-CNVY-BOX                             58130000
581400                                        TO PC169-INPK-BOX         58140000
581500             MOVE LBPTDA-INPK-UNT-QTY                             58150000
581600                                        TO PV-INPK-QTY            58160000
581700             MOVE PV-INPK-UNIT-QTY                                58170000
581800                                        TO PC169-DES-INPK-QTY     58180000
581900       ELSE                                                       58190000
582000             MOVE PC169-INNER-PACK-DESC                           58200000
582100                                        TO PC169-DES-INPK-DESC    58210000
582200             MOVE PC169-NO-INPK-CNVY-BOX                          58220000
582300                                        TO PC169-INPK-BOX         58230000
582400             MOVE LBPTDA-INPK-UNT-QTY                             58240000
582500                                        TO PV-INPK-QTY            58250000
582600             MOVE PV-INPK-UNIT-QTY                                58260000
582700                                        TO PC169-DES-INPK-QTY     58270000
582800       END-IF                                                     58280000
582900                                                                  58290000
583000*ZONE                                                             58300000
583100           MOVE LBPTDA-STR-ZN-ID                                  58310000
583200                                      TO PC169-DES-ZONE           58320000
583300*MODULE NAME                                                      58330000
583400           MOVE LBPTDA-MODU-DESC                                  58340000
583500                                      TO PC169-MODULE-NAME        58350000
583600                                                                  58360000
583700           MOVE SPACES                TO PC169-DES-UNT-PK-DESC    58370000
583800                                         PC169-DES-UNT-PK-QTY     58380000
583900                                         PC169-DES-DWN-SK-DESC    58390000
584000                                         PC169-DES-DWN-SK-QTY     58400000
584100           MOVE PC169-NO-PK-DIVIDE-BOX                            58410000
584200                                      TO PC169-PACK-DIVIDE-BOX    58420000
584300           MOVE PC169-NO-PK-DIVIDE-FLD                            58430000
584400                                      TO PC169-PACK-DIVIDE-FLD    58440000
584500     END-IF.                                                      58450000
584600*                                                                 58460000
584700* GB 12/20/01 BEG                                                 58470000
584800*AUDIT INDICATOR                                                  58480000
584900     MOVE LBPTDA-CART-ACTN-CDE TO PC169-AUDIT-IND                 58490000
585000* GB 12/20/01 END                                                 58500000
585100                                                                  58510000
585200*CLP 06/20/2013 PR5148B START                                     58520000
585300     IF LBPTDA-PRC-MSG-CDE = 'RD'                                 58530000
585400       MOVE PC169-RFID-BOX    TO PC169-LBL-RFID-BOX               58540007
585500       MOVE PC169-RFID-FLD    TO PC169-LBL-RFID-FLD               58550007
585600     ELSE                                                         58560000
585700       IF LBPTDA-PRC-MSG-CDE = 'EA'                               58570013
585800         MOVE PC169-RFID-BOX    TO PC169-LBL-RFID-BOX             58580013
585900         MOVE PC169-EAS-FLD     TO PC169-LBL-RFID-FLD             58590013
586000       ELSE                                                       58600013
586100         IF LBPTDA-PRC-MSG-CDE = 'RE'                             58610013
586200           MOVE PC169-RFID-BOX    TO PC169-LBL-RFID-BOX           58620013
586300           MOVE PC169-RF-EAS-FLD  TO PC169-LBL-RFID-FLD           58630013
586400         ELSE                                                     58640013
586500           MOVE PC169-NO-RFID-BOX TO PC169-LBL-RFID-BOX           58650007
586600           MOVE PC169-NO-RFID-FLD TO PC169-LBL-RFID-FLD           58660007
586700         END-IF                                                   58670013
586800       END-IF                                                     58680013
586900     END-IF.                                                      58690007
587000                                                                  58700000
587100*CLP 06/20/2013 PR5148B END                                       58710000
587200     MOVE 0001  TO PC169-LBL-QTY-TO-PRT.                          58720000
587300                                                                  58730000
587400     PERFORM 4567-SEND-P2L-DATA                                   58740000
587500           VARYING PC169-IDX FROM 1 BY 1                          58750000
587600             UNTIL PC169-IDX > PC169-P2L-DEST-LBL-MAX-LN          58760000
587700                OR PS-SOCKET-ERROR.                               58770000
587800*                                                                 58780000
587900*                                                                 58790000
588000*----------------------------------------------------------------*58800000
588100*  CREATE ECOMMERCE REPURPOSE LABEL                              *58810000
588200*----------------------------------------------------------------*58820000
588300 4915-CREATE-EC-REPURP-LBL.                                       58830000
588400                                                                  58840000
588500     IF LBPTDA-PREPK-ID > 0                                       58850000
588600*PACK-XXXX                                                        58860000
588700           MOVE LBPTDA-PREPK-ID                                   58870000
588800                                      TO PV-PREPK-ID              58880000
588900           MOVE PV-PACK                                           58890000
589000                                      TO PC169-SKU                58900000
589100*LINE NUMBER                                                      58910000
589200           MOVE PC169-LINE-NO-DESC                                58920000
589300                                      TO PC169-LNE-NO-DESC        58930000
589400           MOVE ZEROES                                            58940000
589500*INNER PACK UNITS                                                 58950000
589600                                      TO PC169-LINE-NO            58960000
589700           MOVE PC169-INNER-PACK-DESC                             58970000
589800                                      TO PC169-DES-INPK-DESC      58980000
589900           MOVE PC169-NO-INPK-CNVY-BOX                            58990000
590000                                      TO PC169-INPK-BOX           59000000
590100           MOVE ZEROES                                            59010000
590200                                        TO PC169-DES-INPK-QTY     59020000
590300     ELSE                                                         59030000
590400*SKU                                                              59040000
590500           MOVE LBPTDA-SKU-NBR                                    59050000
590600                                      TO PC169-SKU                59060000
590700*LINE NUMBER                                                      59070000
590800           MOVE PC169-LINE-NO-DESC                                59080000
590900                                      TO PC169-LNE-NO-DESC        59090000
591000           MOVE LBPTDA-PO-LNE-NBR                                 59100000
591100                                      TO PV-LINE-NBR              59110000
591200           MOVE PV-PO-LINE-NBR                                    59120000
591300                                      TO PC169-LINE-NO            59130000
591400*INNER PACK UNITS                                                 59140000
591500           MOVE PC169-INNER-PACK-DESC                             59150000
591600                                      TO PC169-DES-INPK-DESC      59160000
591700           MOVE PC169-NO-INPK-CNVY-BOX                            59170000
591800                                      TO PC169-INPK-BOX           59180000
591900           MOVE LBPTDA-INPK-UNT-QTY                               59190000
592000                                      TO PV-INPK-QTY              59200000
592100           MOVE PV-INPK-UNIT-QTY                                  59210000
592200                                      TO PC169-DES-INPK-QTY       59220000
592300     END-IF                                                       59230000
592400           MOVE LBPTDA-BRCDE-NBR      TO PC169-BC-BARCODE         59240000
592500                                         PC169-TXT-BARCODE        59250000
592600           MOVE LBPTDA-CRE-USR-ID                                 59260000
592700                                      TO PC169-USER-ID            59270000
592800*                                                                 59280000
592900           PERFORM 3040-GET-DC-PRTD-AT                            59290000
593000           MOVE LBPTDA-PRTR-ID                                    59300000
593100                                      TO PV-PRTR-ID               59310000
593200           MOVE PV-PRINTER-FORMAT     TO PC169-DES-PRINTER-ID     59320000
593300*                                                                 59330000
593400           MOVE +1                                                59340000
593500                                      TO PC169-LABEL-NBR          59350000
593600           MOVE LBPTDA-LBL-TYP-TOT-QTY                            59360000
593700                                      TO PC169-TOT-LABEL          59370000
593800           MOVE PV-CURRENT-DB2-DATE   TO PV-WORK-DB2-DATE         59380000
593900           MOVE PV-WORK-YY            TO PV-LBL-DATE-YY           59390000
594000           MOVE PV-WORK-MM            TO PV-LBL-DATE-MM           59400000
594100           MOVE PV-WORK-DD            TO PV-LBL-DATE-DD           59410000
594200           MOVE '-'                   TO PV-LBL-DASH1             59420000
594300                                         PV-LBL-DASH2             59430000
594400           MOVE PV-LBL-DATE           TO PC169-LBL-PRT-DATE       59440000
594500           MOVE PV-CURRENT-TIME                                   59450000
594600                                      TO PC169-LBL-PRT-TIME       59460000
594700           MOVE PC169-LABEL-DESCRIPTION                           59470000
594800                                      TO PC169-DEST-LBL-DESC      59480000
594900*CRTN                                                             59490000
595000           MOVE LBPTDA-SHIPT-UNT-ID                               59500000
595100                                      TO PV-SHIPT-UNT-ID          59510000
595200           MOVE PV-LAST-FIVE-DIGITS                               59520000
595300                                      TO PC169-CRTN-NBR           59530000
595400*LBL SEQ                                                          59540000
595500           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         59550000
595600                                      TO PC169-START-CARTON-CNT-1 59560000
595700*PO RCVR                                                          59570000
595800           MOVE LBPTDA-PO-NBR                                     59580000
595900                                      TO PV-PO-NBR                59590000
596000           MOVE PV-PO-NBR-7POS                                    59600000
596100                                      TO PC169-DES-PO             59610000
596200           MOVE '-'                                               59620000
596300                                      TO PC169-DES-PO-DASH        59630000
596400           MOVE LBPTDA-RCVR-SEQ-NBR                               59640000
596500                                      TO PV-RCVR-NBR              59650000
596600           MOVE PV-RCVR-NBR-3POS                                  59660000
596700                                      TO PC169-SEQ-NO             59670000
596800*DEPT-CLASS                                                       59680000
596900           MOVE LBPTDA-SKU-DEPT-NBR                               59690000
597000                                      TO PV-P2L-DEPT1             59700000
597100           MOVE LBPTDA-SKU-CL-NBR                                 59710000
597200                                      TO PV-P2L-CLASS-NBR1        59720000
597300           MOVE PV-P2L-DEPT-CLASS                                 59730000
597400                                      TO PC169-DEPT-CLASS         59740000
597500                                                                  59750000
597600*ZONE                                                             59760000
597700           MOVE LBPTDA-STR-ZN-ID                                  59770000
597800                                      TO PC169-DES-ZONE           59780000
597900*MODULE NAME                                                      59790000
598000           MOVE LBPTDA-MODU-DESC                                  59800000
598100                                      TO PC169-MODULE-NAME        59810000
598200                                                                  59820000
598300           MOVE SPACES                TO PC169-DES-UNT-PK-DESC    59830000
598400                                         PC169-DES-UNT-PK-QTY     59840000
598500                                         PC169-DES-DWN-SK-DESC    59850000
598600                                         PC169-DES-DWN-SK-QTY     59860000
598700                                                                  59870000
598800     IF LBPTDA-SU-MSSG-DAT-IND = 'M'                              59880000
598900        MOVE PC169-PK-DIVIDE-BOX                                  59890000
599000                                  TO PC169-PACK-DIVIDE-BOX        59900000
599100        MOVE PC169-REPURP-WGHTS-MSURES                            59910000
599200                                      TO PC169-PACK-DIVIDE-FLD    59920000
599300     ELSE                                                         59930000
599400        MOVE PC169-NO-PK-DIVIDE-BOX                               59940000
599500                                      TO PC169-PACK-DIVIDE-BOX    59950000
599600        MOVE PC169-NO-PK-DIVIDE-FLD                               59960000
599700                                      TO PC169-PACK-DIVIDE-FLD    59970000
599800     END-IF                                                       59980000
599900*                                                                 59990000
600000* GB 12/20/01 BEG                                                 60000000
600100*AUDIT INDICATOR                                                  60010000
600200     MOVE LBPTDA-CART-ACTN-CDE TO PC169-AUDIT-IND                 60020000
600300* GB 12/20/01 END                                                 60030000
600400                                                                  60040000
600500                                                                  60050000
600600     MOVE 0001  TO PC169-LBL-QTY-TO-PRT.                          60060000
600700                                                                  60070000
600800     PERFORM 4567-SEND-P2L-DATA                                   60080000
600900           VARYING PC169-IDX FROM 1 BY 1                          60090000
601000             UNTIL PC169-IDX > PC169-P2L-DEST-LBL-MAX-LN          60100000
601100                OR PS-SOCKET-ERROR.                               60110000
601200*                                                                 60120000
601300*                                                                 60130000
601400*----------------------------------------------------------------*60140000
601500*  CREATE CENTRAL STOCK LABEL                                    *60150000
601600*----------------------------------------------------------------*60160000
601700 4920-CREATE-CNSTK-LABEL.                                         60170000
601800*  SEND CENTRAL STOCK LABEL FORM                                  60180000
601900*                                                                 60190000
602000     IF LBPTDA-INPK-CNVYB-IND  = PV-PREV-INPK-CNVYB-IND           60200000
602100        CONTINUE                                                  60210000
602200     ELSE                                                         60220000
602300        MOVE SPACES TO PV-PREV-LABEL-TYPE                         60230000
602400     END-IF                                                       60240000
602500                                                                  60250000
602600     IF LBPTDA-CART-LBL-TYP-CDE = PV-PREV-LABEL-TYPE              60260000
602700        IF  LBPTDA-PREPK-ID > 0                                   60270000
602800           PERFORM UNTIL PS-EOF-LBL-CURSOR                        60280000
602900                   OR PS-SOCKET-ERROR                             60290000
603000           IF PS-REPRINT-BATCH AND                                60300000
603100               PS-REPRINT-FORM                                    60310000
603200               CONTINUE                                           60320000
603300           ELSE                                                   60330000
603400*LMM       IF LBPTDA-RPRT-IND = PC-R AND                          60340000
603500           IF LBPTDA-RPRT-IND = PC-Y AND                          60350000
603600               PS-REPRINT-FORM                                    60360000
603700               CONTINUE                                           60370000
603800           ELSE                                                   60380000
603900*LMM       IF LBPTDA-RPRT-IND = PC-R                              60390000
604000           IF LBPTDA-RPRT-IND = PC-Y                              60400000
604100               PERFORM 4563-BUILD-CS-FORM                         60410000
604200               PERFORM 4564-SEND-CS-FORM                          60420000
604300                   VARYING PC205-IDX FROM 1 BY 1                  60430000
604400                     UNTIL PC205-IDX > PC205-SHIP-MFST-LBL-MAX-LN 60440000
604500                        OR PS-SOCKET-ERROR                        60450000
604600*                                                                 60460000
604700               PERFORM 4565-BUILD-CS-DATA                         60470000
604800               PERFORM 4566-SEND-CS-DATA                          60480000
604900                   VARYING PC189-IDX FROM 1 BY 1                  60490000
605000                     UNTIL PC189-IDX > PC189-MAX-LABEL-LINES      60500000
605100                        OR PS-SOCKET-ERROR                        60510000
605200           ELSE                                                   60520000
605300*LMM       IF LBPTDA-RPRT-IND NOT = PC-R AND                      60530000
605400           IF LBPTDA-RPRT-IND NOT = PC-Y AND                      60540000
605500               PS-REPRINT-FORM                                    60550000
605600               PERFORM 4563-BUILD-CS-FORM                         60560000
605700               PERFORM 4564-SEND-CS-FORM                          60570000
605800                   VARYING PC205-IDX FROM 1 BY 1                  60580000
605900                     UNTIL PC205-IDX > PC205-SHIP-MFST-LBL-MAX-LN 60590000
606000                        OR PS-SOCKET-ERROR                        60600000
606100*                                                                 60610000
606200               PERFORM 4565-BUILD-CS-DATA                         60620000
606300               PERFORM 4566-SEND-CS-DATA                          60630000
606400                   VARYING PC189-IDX FROM 1 BY 1                  60640000
606500                     UNTIL PC189-IDX > PC189-MAX-LABEL-LINES      60650000
606600                        OR PS-SOCKET-ERROR                        60660000
606700           END-IF                                                 60670000
606800           END-IF                                                 60680000
606900           END-IF                                                 60690000
607000           END-IF                                                 60700000
607100           END-PERFORM                                            60710000
607200        ELSE                                                      60720000
607300           PERFORM 4565-BUILD-CS-DATA                             60730000
607400           PERFORM 4566-SEND-CS-DATA                              60740000
607500               VARYING PC189-IDX FROM 1 BY 1                      60750000
607600                 UNTIL PC189-IDX > PC189-MAX-LABEL-LINES          60760000
607700                    OR PS-SOCKET-ERROR                            60770000
607800     ELSE                                                         60780000
607900        PERFORM 4563-BUILD-CS-FORM                                60790000
608000        PERFORM 4564-SEND-CS-FORM                                 60800000
608100           VARYING PC205-IDX FROM 1 BY 1                          60810000
608200             UNTIL PC205-IDX > PC205-SHIP-MFST-LBL-MAX-LN         60820000
608300                OR PS-SOCKET-ERROR                                60830000
608400*                                                                 60840000
608500        PERFORM 4565-BUILD-CS-DATA                                60850000
608600        PERFORM 4566-SEND-CS-DATA                                 60860000
608700            VARYING PC189-IDX FROM 1 BY 1                         60870000
608800              UNTIL PC189-IDX > PC189-MAX-LABEL-LINES             60880000
608900                 OR PS-SOCKET-ERROR                               60890000
609000        END-IF.                                                   60900000
609100*                                                                 60910000
609200*                                                                 60920000
609300*----------------------------------------------------------------*60930000
609400*  CREATE MESSAGE LABEL                                        *  60940000
609500*----------------------------------------------------------------*60950000
609600 4930-CREATE-MESSAGE-LABEL.                                       60960000
609700*  SEND MESSAGE LABEL FORM                                        60970000
609800*----------------------------------------------------------------*60980000
609900*                                                                 60990000
610000     IF LBPTDA-CART-LBL-TYP-CDE = PV-PREV-LABEL-TYPE              61000000
610100       IF PS-REPRINT-BATCH AND PS-REPRINT-FORM                    61010000
610200          IF LBPTDA-PREPK-ID > 0 AND PS-PREPK-FORM                61020000
610300             CONTINUE                                             61030000
610400          ELSE                                                    61040000
610500             PERFORM 4575-BUILD-MESSAGE-FORM                      61050000
610600             PERFORM 4576-SEND-MESSAGE-FORM                       61060000
610700                 VARYING PC178-IDX FROM 1 BY 1                    61070000
610800                 UNTIL PC178-IDX >                                61080000
610900                       PC178-SML-BATCH-LBL-MAX-LN                 61090000
611000                 OR PS-SOCKET-ERROR                               61100000
611100          END-IF                                                  61110000
611200       ELSE                                                       61120000
611300         IF LBPTDA-RPRT-IND = PC-Y AND PS-REPRINT-FORM            61130000
611400            IF LBPTDA-PREPK-ID > 0 AND PS-PREPK-FORM              61140000
611500               CONTINUE                                           61150000
611600            ELSE                                                  61160000
611700               PERFORM 4575-BUILD-MESSAGE-FORM                    61170000
611800               PERFORM 4576-SEND-MESSAGE-FORM                     61180000
611900                   VARYING PC178-IDX FROM 1 BY 1                  61190000
612000                   UNTIL PC178-IDX >                              61200000
612100                         PC178-SML-BATCH-LBL-MAX-LN               61210000
612200                   OR PS-SOCKET-ERROR                             61220000
612300            END-IF                                                61230000
612400         ELSE                                                     61240000
612500           IF LBPTDA-RPRT-IND = PC-Y                              61250000
612600               PERFORM 4575-BUILD-MESSAGE-FORM                    61260000
612700               PERFORM 4576-SEND-MESSAGE-FORM                     61270000
612800                   VARYING PC178-IDX FROM 1 BY 1                  61280000
612900                UNTIL PC178-IDX > PC178-SML-BATCH-LBL-MAX-LN      61290000
613000                        OR PS-SOCKET-ERROR                        61300000
613100           ELSE                                                   61310000
613200             IF LBPTDA-RPRT-IND NOT = PC-Y AND                    61320000
613300                 PS-REPRINT-FORM                                  61330000
613400                 PERFORM 4575-BUILD-MESSAGE-FORM                  61340000
613500                 PERFORM 4576-SEND-MESSAGE-FORM                   61350000
613600                     VARYING PC178-IDX FROM 1 BY 1                61360000
613700                       UNTIL PC178-IDX >                          61370000
613800                             PC178-SML-BATCH-LBL-MAX-LN           61380000
613900                          OR PS-SOCKET-ERROR                      61390000
614000             END-IF                                               61400000
614100           END-IF                                                 61410000
614200         END-IF                                                   61420000
614300       END-IF                                                     61430000
614400     ELSE                                                         61440000
614500        PERFORM 4575-BUILD-MESSAGE-FORM                           61450000
614600        PERFORM 4576-SEND-MESSAGE-FORM                            61460000
614700           VARYING PC178-IDX FROM 1 BY 1                          61470000
614800             UNTIL PC178-IDX > PC178-SML-BATCH-LBL-MAX-LN         61480000
614900                OR PS-SOCKET-ERROR                                61490000
615000     END-IF.                                                      61500000
615100*                                                                 61510000
615200     PERFORM 4577-BUILD-MESSAGE-DATA                              61520000
615300     PERFORM 4578-SEND-MESSAGE-DATA                               61530000
615400         VARYING PC179-IDX FROM 1 BY 1                            61540000
615500           UNTIL PC179-IDX > PC179-MAX-LABEL-LINES                61550000
615600              OR PS-SOCKET-ERROR.                                 61560000
615700                                                                  61570000
615800* 07/19/13 RLK BEG                                                61580000
615900*----------------------------------------------------------------*61590000
616000*  CREATE DESTINATION LABEL                                      *61600000
616100*----------------------------------------------------------------*61610000
616200 4940-CREATE-CRTN-LABEL.                                          61620000
616300*                                                                 61630000
616400*  SEND CARTON LABEL FORM                                         61640000
616500*                                                                 61650000
616600                                                                  61660000
616700     PERFORM 4568-BUILD-CRTN-LBL-FORM.                            61670000
616800     PERFORM 4569-SEND-CRTN-FORM                                  61680000
616900        VARYING PC266-IDX FROM 1 BY 1                             61690000
617000          UNTIL PC266-IDX > PC266-CARTON-LABEL-DATA-MAX-LN        61700000
617100             OR PS-SOCKET-ERROR.                                  61710000
617200                                                                  61720000
617300*                                                                 61730000
617400* 07/19/13 RLK END                                                61740000
617500*                                                                 61750000
617600*                                                                 61760000
617700*----------------------------------------------------------------*61770000
617800* CHECK AUDIT STATUS                                             *61780000
617900*----------------------------------------------------------------*61790000
618000 5000-AUDIT-STATUS-CHECK.                                         61800000
618100                                                                  61810000
618200     MOVE LBPTDA-PO-NBR        TO PV-PREV-PO-NBR.                 61820000
618300     MOVE LBPTDA-PREPK-ID      TO PV-PREV-PREPK-ID.               61830000
618400     MOVE LBPTDA-PO-LNE-NBR    TO PV-PREV-PO-LNE-NBR.             61840000
618500     MOVE LBPTDA-OPER-UNT-ID   TO PV-PREV-OPER-UNT-ID.            61850000
618600     MOVE LBPTDA-TRIP-ID       TO PV-PREV-TRIP-ID.                61860000
618700     MOVE LBPTDA-RCVR-SEQ-NBR  TO PV-PREV-RCVR-SEQ-NBR.           61870000
618800                                                                  61880000
618900     EXEC SQL                                                     61890000
619000          SELECT AUD_STAT_CDE                                     61900000
619100          INTO  :SUT00015-AUD-STAT-CDE                            61910000
619200          FROM   SUT_PO_AUD_REQ                                   61920000
619300          WHERE  PO_NBR        = :LBPTDA-PO-NBR                   61930000
619400            AND  PO_LNE_NBR    = :LBPTDA-PO-LNE-NBR               61940000
619500            AND  PO_PREPK_ID   = :LBPTDA-PREPK-ID                 61950000
619600            AND  OPER_UNT_ID   = :LBPTDA-OPER-UNT-ID              61960000
619700            AND  INBND_TRIP_ID = :LBPTDA-TRIP-ID                  61970000
619800            AND  RCVR_SEQ_NBR  = :LBPTDA-RCVR-SEQ-NBR             61980000
619810           with ur                                                61981014
619900     END-EXEC.                                                    61990000
620000                                                                  62000000
620100     EVALUATE TRUE                                                62010000
620200         WHEN SQLCODE = ZERO                                      62020000
620300              IF SUT00015-AUD-STAT-CDE = 'P' OR 'N'               62030000
620400                 MOVE SPACE TO LBPTDA-CART-ACTN-CDE               62040000
620500                               PV-PREV-CART-ACTN-CDE              62050000
620600              ELSE                                                62060000
620700                IF SUT00015-AUD-STAT-CDE = 'F'                    62070000
620800                   MOVE 'R' TO LBPTDA-CART-ACTN-CDE               62080000
620900                               PV-PREV-CART-ACTN-CDE              62090000
621000                ELSE                                              62100000
621100                   MOVE LBPTDA-CART-ACTN-CDE TO                   62110000
621200                               PV-PREV-CART-ACTN-CDE              62120000
621300                END-IF                                            62130000
621400              END-IF                                              62140000
621500         WHEN SQLCODE = +100                                      62150000
621600               MOVE LBPTDA-CART-ACTN-CDE TO                       62160000
621700                               PV-PREV-CART-ACTN-CDE              62170000
621800         WHEN OTHER                                               62180000
621900              STRING ' SUKRF527 - '            DELIMITED BY SIZE  62190000
622000                     'DK-BARCODE-NBR: '        DELIMITED BY SIZE  62200000
622100                      DK-BARCODE-NBR           DELIMITED BY SIZE  62210000
622200                                           INTO PV-CICS-MSG-AREA  62220000
622300              MOVE LENGTH OF PV-CICS-MSG-AREA                     62230000
622400                     TO PV-COMMAREA-LENGTH                        62240000
622500              PERFORM 9990-WRITE-CICS                             62250000
622600                                                                  62260000
622700             MOVE '5000-AUDIT-STATUS-CHECK'                       62270000
622800                             TO DP013-PARAGRAPH                   62280000
622900             MOVE 'SUKRF527 - GET LABEL STATUS CODE'              62290000
623000                             TO DP013-MESSAGE-TEXT(1)             62300000
623100             MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER   62310000
623200             MOVE   LBPTDA-TRIP-ID          TO  PV-DISPLAY-TRIP   62320000
623300             MOVE   LBPTDA-LBL-PRT-BTCH-ID  TO  PV-DISPLAY-BATCH  62330000
623400             MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO     62340000
623500             MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR   62350000
623600             MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE   62360000
623700             STRING 'OPER UNIT: '           DELIMITED BY SIZE     62370000
623800                    PV-DISPLAY-OPER         DELIMITED BY SIZE     62380000
623900                    '   DK-BARCODE-NBR: '   DELIMITED BY SIZE     62390000
624000                     DK-BARCODE-NBR         DELIMITED BY SIZE     62400000
624100                    '   BATCH NO: '         DELIMITED BY SIZE     62410000
624200                    PV-DISPLAY-BATCH        DELIMITED BY SIZE     62420000
624300                                       INTO DP013-MESSAGE-TEXT(2) 62430000
624400             STRING 'TRIP ID: '             DELIMITED BY SIZE     62440000
624500                    PV-DISPLAY-TRIP         DELIMITED BY SIZE     62450000
624600                    '   SCAC: '             DELIMITED BY SIZE     62460000
624700                    LBPTDA-OWNR-SCAC-ID     DELIMITED BY SIZE     62470000
624800                    '   TRLR: '             DELIMITED BY SIZE     62480000
624900                    LBPTDA-VEH-NBR          DELIMITED BY SIZE     62490000
625000                                       INTO DP013-MESSAGE-TEXT(3) 62500000
625100             STRING 'PO: '                  DELIMITED BY SIZE     62510000
625200                    PV-DISPLAY-PO           DELIMITED BY SIZE     62520000
625300                    '   RCVR: '             DELIMITED BY SIZE     62530000
625400                    PV-DISPLAY-RCVR         DELIMITED BY SIZE     62540000
625500                    '   LINE: '             DELIMITED BY SIZE     62550000
625600                    PV-DISPLAY-LINE         DELIMITED BY SIZE     62560000
625700                    '   OPER: '             DELIMITED BY SIZE     62570000
625800                    PV-DISPLAY-OPER         DELIMITED BY SIZE     62580000
625900                                       INTO DP013-MESSAGE-TEXT(4) 62590000
626000             MOVE SQLCA      TO DP013-SQLCA                       62600000
626100             MOVE 'SUT_PO_AUD_REQ'     TO DP013-DB2-TABLE-NAME(1) 62610000
626200             SET DP013-DB2-ABEND              TO TRUE             62620000
626300             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              62630000
626400             PERFORM DP014-0000-PROCESS-ABEND                     62640000
626500     END-EVALUATE.                                                62650000
626600*                                                                 62660000
626700*                                                                 62670000
626800*----------------------------------------------------------------*62680000
626900*  CONNECT THE PATH (SOCKET).                                    *62690000
627000*----------------------------------------------------------------*62700000
627100 5100-SEND-DATA-TO-LPMS.                                          62710000
627200                                                                  62720000
627300     MOVE LOW-VALUES              TO TCP-BUF2.                    62730000
627400     MOVE PC133-LABEL-RECORD      TO TCP-BUF2.                    62740000
627500     MOVE PC133-LABEL-RECORD      TO PV-DISPLAY-DOWNLOAD.         62750000
627600                                                                  62760000
627700*** BEGIN - FOR TESTING ONLY                                      62770000
627800*    STRING '  '                 DELIMITED BY SIZE                62780000
627900*           'SUKRF527 '          DELIMITED BY SIZE                62790000
628000*                                INTO PV-CICS-MSG-AREA.           62800000
628100*    PERFORM 9990-WRITE-CICS.                                     62810000
628200*    STRING ' '                   DELIMITED BY SIZE               62820000
628300*           PV-DISPLAY-DOWNLOAD-1 DELIMITED BY SIZE               62830000
628400*                                INTO PV-CICS-MSG-AREA.           62840000
628500*    PERFORM 9990-WRITE-CICS.                                     62850000
628600*    STRING ' '                   DELIMITED BY SIZE               62860000
628700*           PV-DISPLAY-DOWNLOAD-2 DELIMITED BY SIZE               62870000
628800*                                INTO PV-CICS-MSG-AREA.           62880000
628900*    PERFORM 9990-WRITE-CICS.                                     62890000
629000*    STRING ' '                   DELIMITED BY SIZE               62900000
629100*           PV-DISPLAY-DOWNLOAD-3 DELIMITED BY SIZE               62910000
629200*                                INTO PV-CICS-MSG-AREA.           62920000
629300*    PERFORM 9990-WRITE-CICS.                                     62930000
629400*** END - FOR TESTING ONLY                                        62940000
629500                                                                  62950000
629600*-----------------------------------------------------*           62960000
629700*                                                     *           62970000
629800*-----------------------------------------------------*           62980000
629900     CALL 'EZACIC04'                                              62990000
630000         USING DP081-TOASCII-TOKEN                                63000000
630100               TCP-BUF2                                           63010000
630200               DP081-TCPLENG.                                     63020000
630300                                                                  63030000
630400*-----------------------------------------------------*           63040000
630500*                                                     *           63050000
630600*-----------------------------------------------------*           63060000
630700*                                                                 63070000
630800*** BEGIN - FOR TESTING ONLY                                      63080000
630900*    MOVE  DP081-SOCK-ID    TO  PV-DISPLAY-SOCK-ID.               63090000
631000*    MOVE  DP081-FLAG       TO  PV-DISPLAY-FLAG.                  63100000
631100*    MOVE  DP081-NBR-BYTES  TO  PV-DISPLAY-NBR-BYTES.             63110000
631200*    STRING ' '                  DELIMITED BY SIZE                63120000
631300*           'SUKRF527-'          DELIMITED BY SIZE                63130000
631400*           'DP081-SEND-CMD-'    DELIMITED BY SIZE                63140000
631500*           DP081-SEND-CMD       DELIMITED BY SIZE                63150000
631600*           ' DP081-SOCK-ID-'    DELIMITED BY SIZE                63160000
631700*           PV-DISPLAY-SOCK-ID   DELIMITED BY SIZE                63170000
631800*           ' DP081-FLAG-'       DELIMITED BY SIZE                63180000
631900*           PV-DISPLAY-FLAG      DELIMITED BY SIZE                63190000
632000*                                INTO PV-CICS-MSG-AREA.           63200000
632100*    PERFORM 9990-WRITE-CICS.                                     63210000
632200*    STRING ' '                  DELIMITED BY SIZE                63220000
632300*           'SUKRF527-'          DELIMITED BY SIZE                63230000
632400*           ' DP081-NBR-BYTES'   DELIMITED BY SIZE                63240000
632500*           PV-DISPLAY-NBR-BYTES DELIMITED BY SIZE                63250000
632600*                                INTO PV-CICS-MSG-AREA.           63260000
632700*    PERFORM 9990-WRITE-CICS.                                     63270000
632800*** END - FOR TESTING ONLY                                        63280000
632900                                                                  63290000
633000     SET  DP081-OUT-OF-BAND-FLAG TO TRUE.                         63300000
633100                                                                  63310000
633200     CALL 'EZASOKET'                                              63320000
633300         USING DP081-SEND-CMD                                     63330000
633400               DP081-SOCK-ID                                      63340000
633500               DP081-FLAG                                         63350000
633600               DP081-NBR-BYTES                                    63360000
633700               TCP-BUF2                                           63370000
633800               DP081-ERRNO                                        63380000
633900               DP081-RETCODE.                                     63390000
634000                                                                  63400000
634100*-----------------------------------------------------*           63410000
634200*                                                     *           63420000
634300*-----------------------------------------------------*           63430000
634400                                                                  63440000
634500     IF  DP081-RETCODE < ZERO                                     63450000
634600         SET  PS-SOCKET-ERROR        TO TRUE                      63460000
634700         MOVE PC-COMMUNICATION-ERROR TO AMSGLNO                   63470000
634800         MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA                   63480000
634900         MOVE -1                     TO APRTIDL                   63490000
635000         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    63500000
635100         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    63510000
635200         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      63520000
635300                                        RECEIVE-ERRNO             63530000
635400         MOVE DP081-RETCODE          TO RECEIVE-RETCODE           63540000
635500         MOVE SU001-PO               TO RECEIVE-RECEIVER          63550000
635600         MOVE SU001-RCVR-SEQ-NBR     TO RECEIVE-SEQ               63560000
635700         MOVE SU001-PO-LINE-NBR      TO RECEIVE-LINE              63570000
635800                                                                  63580000
635900         MOVE RECEIVE-ERR            TO PV-CICS-MSG-AREA          63590000
636000         PERFORM 9990-WRITE-CICS                                  63600000
636001                                                                  63600114
636010** DMH - 9/19/17 - BEGIN                                          63601014
636020         MOVE  SPACES                  TO PV-CICS-MSG-AREA        63602014
636030         MOVE  SU001-PRINTER-ID        TO ERR-MSG-PRINTER         63603014
636040         MOVE  SU001-OPER-UNT-ID       TO ERR-MSG-OPER            63604014
636050         MOVE  SU001-PO                TO ERR-MSG-PO              63605014
636060         MOVE  SU001-RCVR-SEQ-NBR      TO ERR-MSG-RCVR            63606014
636070         MOVE  SU001-MANIFEST          TO ERR-MSG-TRIP            63607014
636080         MOVE  SU001-USER-ID           TO ERR-MSG-USERID          63608014
636090         MOVE  SU001-BATCH-NUMBER      TO ERR-MSG-BATCH           63609014
636091         MOVE  ERROR-DETAILS           TO PV-CICS-MSG-AREA        63609114
636092         PERFORM 9990-WRITE-CICS                                  63609214
636093** DMH - 9/19/17 - end                                            63609314
636100                                                                  63610000
636200         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      63620000
636300         SET  DP013-OTHER-ABEND      TO TRUE                      63630000
636400         SET  DP013-ROLLBACK         TO TRUE                      63640000
636500                                                                  63650000
636600         MOVE '5100-SEND-DATA-TO-LPMS' TO DP013-PARAGRAPH         63660000
636700         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  63670000
636800         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       63680000
636900         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         63690000
637000         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      63700000
637100         STRING ' SUKRF527 - '            DELIMITED BY SIZE       63710000
637200                'DP081-FAMILY='           DELIMITED BY SIZE       63720000
637300                PV-DISPLAY-FAMILY         DELIMITED BY SIZE       63730000
637400                ' DP081-PORT='            DELIMITED BY SIZE       63740000
637500                PV-DISPLAY-PORT           DELIMITED BY SIZE       63750000
637600                ' DP081-IP-ADDR='         DELIMITED BY SIZE       63760000
637700                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       63770000
637800                                     INTO DP013-MESSAGE-TEXT (2)  63780000
637900         MOVE DP081-RETCODE            TO  PV-RETCODE             63790000
638000         MOVE DP081-ERRNO              TO  PV-ERRNO               63800000
638100         STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE      63810000
638200                ' DP081-RETCODE - '        DELIMITED BY SIZE      63820000
638300                PV-RETCODE                 DELIMITED BY SIZE      63830000
638400                ' DP081-ERRNO - '          DELIMITED BY SIZE      63840000
638500                PV-ERRNO                   DELIMITED BY SIZE      63850000
638600                                      INTO DP013-MESSAGE-TEXT (3) 63860000
638700        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          63870000
638800        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        63880000
638900        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        63890000
639000        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        63900000
639100        STRING ' PRTR ID: '                DELIMITED BY SIZE      63910000
639200               SU001-PRINTER-ID-USE        DELIMITED BY SIZE      63920000
639300               '   OPER: '                 DELIMITED BY SIZE      63930000
639400               PV-DISPLAY-OPER             DELIMITED BY SIZE      63940000
639500               '   PO: '                   DELIMITED BY SIZE      63950000
639600               PV-DISPLAY-PO               DELIMITED BY SIZE      63960000
639700               '   RCVR: '                 DELIMITED BY SIZE      63970000
639800               PV-DISPLAY-RCVR             DELIMITED BY SIZE      63980000
639900               '   LINE: '                 DELIMITED BY SIZE      63990000
640000               PV-DISPLAY-LINE             DELIMITED BY SIZE      64000000
640100                                      INTO DP013-MESSAGE-TEXT (4) 64010000
640200         PERFORM 9999-WRITE-CICS-LOG-MSG                          64020000
640300*                                                                 64030000
640400*** BEGIN - FOR TESTING ONLY                                      64040000
640500*    ELSE                                                         64050000
640600*        MOVE ' SUKRF527 - SEND SUCCESSFUL'                       64060000
640700*                                     TO PV-CICS-MSG-AREA         64070000
640800*        PERFORM 9990-WRITE-CICS                                  64080000
640900*        IF  PC133-LABEL-HDR                                      64090000
641000*            STRING ' SUKRF527 - '           DELIMITED BY SIZE    64100000
641100*                   PC133-HDR-PO-NBR         DELIMITED BY SIZE    64110000
641200*                   '-'                      DELIMITED BY SIZE    64120000
641300*                   PC133-HDR-RCVR-SEQ       DELIMITED BY SIZE    64130000
641400*                   '-'                      DELIMITED BY SIZE    64140000
641500*                   PC133-HDR-LINE-NBR       DELIMITED BY SIZE    64150000
641600*                   '  -  PRINTER ID-'       DELIMITED BY SIZE    64160000
641700*                   PC133-HDR-PRTR-ID        DELIMITED BY SIZE    64170000
641800*                   '  -  TLR-COUNT -'       DELIMITED BY SIZE    64180000
641900*                   PC133-TLR-RECORD-COUNT   DELIMITED BY SIZE    64190000
642000*                   '  -  DTL-DATA  -'       DELIMITED BY SIZE    64200000
642100*                   PC133-DTL-DATA           DELIMITED BY SIZE    64210000
642200*                                       INTO PV-CICS-MSG-AREA     64220000
642300*            PERFORM 9990-WRITE-CICS                              64230000
642400*        END-IF                                                   64240000
642500                                                                  64250000
642600     END-IF.                                                      64260000
642700*** BEG - FOR TESTING ONLY                                        64270000
642800*        IF  PC133-LABEL-DTL                                      64280000
642900*            STRING ' SUKRF527 - '           DELIMITED BY SIZE    64290000
643000*                   PC133-DTL-TRANS-ID       DELIMITED BY SIZE    64300000
643100*                   '-'                      DELIMITED BY SIZE    64310000
643200*                   PC133-DTL-LENGTH         DELIMITED BY SIZE    64320000
643300*                   '-'                      DELIMITED BY SIZE    64330000
643400*                   '  -  TLR-CNT    '       DELIMITED BY SIZE    64340000
643500*                    PC133-TLR-RECORD-COUNT  DELIMITED BY SIZE    64350000
643600*                   '  -  DTL-DATA  -'       DELIMITED BY SIZE    64360000
643700*                   PC133-DTL-DATA           DELIMITED BY SIZE    64370000
643800*                                       INTO PV-CICS-MSG-AREA     64380000
643900*            PERFORM 9990-WRITE-CICS                              64390000
644000*        END-IF                                                   64400000
644100*** END - FOR TESTING ONLY                                        64410000
644200                                                                  64420000
644300     IF SU001-PRINT-AND-PEEL                                      64430000
644400                                                                  64440000
644500        SET PS-START-RECEIVE TO TRUE                              64450000
644600        MOVE ZEROS   TO  PV-TCP-RET-LENGTH                        64460000
644700                         PV-TCP-REM-LENGTH                        64470000
644800                         PV-TCP-PRCSD-LENGTH                      64480000
644900        MOVE SPACES  TO  PT-TCP-RECEIVE-TABLE                     64490000
645000                         PT-TCP-ASSEMBLE-TABLE                    64500000
645100                                                                  64510000
645200        MOVE LOW-VALUES  TO  TCP-BUF2                             64520000
645300        MOVE 5           TO  DP081-TCPLENG                        64530000
645400                             DP081-NBR-BYTES                      64540000
645500                                                                  64550000
645600        SET  DP081-NO-FLAG  TO  TRUE                              64560000
645700        PERFORM 5200-CHECK-SOCKET-CONNECTION                      64570000
645800        IF  PS-NO-SOCKET-ERROR                                    64580000
645900            PERFORM 5401-RECEIVE-CONFIRM-FROM-LPMS                64590000
646000                UNTIL PS-COMP-RECEIVE OR                          64600000
646100                      PS-SOCKET-ERROR                             64610000
646200        END-IF                                                    64620000
646300     ELSE                                                         64630000
646400        PERFORM 5200-CHECK-SOCKET-CONNECTION                      64640000
646500        IF  PS-NO-SOCKET-ERROR                                    64650000
646600            PERFORM 5400-RECEIVE-CONFIRM-FROM-LPMS                64660000
646700        END-IF                                                    64670000
646800     END-IF.                                                      64680000
646900                                                                  64690000
647000* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 64700000
647100*  added Select socket command to check if socket connection    * 64710000
647200*  is still active.  if return code > 0 then socket is active   * 64720000
647300*  if return code = 0 socket is no longer active.               * 64730000
647400* DMH - 10/06/04 - BEGIN                                          64740000
647500* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 64750000
647600 5200-CHECK-SOCKET-CONNECTION.                                    64760000
647700                                                                  64770000
647800                                                                  64780000
647900* ZERO OUT ALL OUTPUT BIT MASKS FOR SELECT                        64790000
648000     PERFORM VARYING SOCKNO FROM 1 BY 1 UNTIL SOCKNO > SOCKETS    64800000
648100        MOVE '0' TO CHAR-ENTRY(SOCKNO)                            64810000
648200     END-PERFORM.                                                 64820000
648300     PERFORM 5210-CHAR-TO-BIT.                                    64830000
648400     MOVE BIT-MASK TO SELECT-RR-MASK.                             64840000
648500     MOVE BIT-MASK TO SELECT-RW-MASK.                             64850000
648600     MOVE BIT-MASK TO SELECT-RE-MASK.                             64860000
648700     MOVE BIT-MASK TO SELECT-EX-MASK.                             64870000
648800     MOVE BIT-MASK TO SELECT-WR-MASK.                             64880000
648900                                                                  64890000
649000* set all input bit masks for select to 1                         64900000
649100     PERFORM VARYING SOCKNO FROM 1 BY 1 UNTIL SOCKNO > SOCKETS    64910000
649200        MOVE '1' TO CHAR-ENTRY(SOCKNO)                            64920000
649300     END-PERFORM.                                                 64930000
649400     PERFORM 5210-CHAR-TO-BIT.                                    64940000
649500     MOVE BIT-MASK TO SELECT-RD-MASK.                             64950000
649600*                                                                 64960000
649700* ISSUE THE SELECT COMMAND ----------------------------           64970000
649800* SELECT WILL FLIP A BIT IN THE READ MASK TO '1' FOR ANY          64980000
649900* SOCKET THAT HAS DATA TO BE PROCESSED.                           64990000
650000*                                                                 65000000
650100                                                                  65010000
650200     MOVE 0 TO DP081-ERRNO.                                       65020000
650300     MOVE 0 TO DP081-RETCODE.                                     65030000
650400     CALL 'EZASOKET' USING DP081-SELECT-CMD                       65040000
650500         SELECT-NUMFDS SELECT-TIMEOUT                             65050000
650600         SELECT-RD-MASK SELECT-WR-MASK SELECT-EX-MASK             65060000
650700         SELECT-RR-MASK SELECT-RW-MASK SELECT-RE-MASK             65070000
650800         DP081-ERRNO DP081-RETCODE.                               65080000
650900                                                                  65090000
651000     IF DP081-RETCODE < 0                                         65100000
651100         SET  PS-SOCKET-ERROR        TO TRUE                      65110000
651200         MOVE PC-COMMUNICATION-ERROR TO AMSGLNO                   65120000
651300         MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA                   65130000
651400         MOVE -1                     TO APRTIDL                   65140000
651500         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    65150000
651600         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    65160000
651700         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      65170000
651800                                        SOCKET-ERRNO              65180000
651900         MOVE DP081-RETCODE          TO SOCKET-RETCODE            65190000
652000         MOVE SU001-PO               TO SOCKET-RECEIVER           65200000
652100         MOVE SU001-RCVR-SEQ-NBR     TO SOCKET-SEQ                65210000
652200         MOVE SU001-PO-LINE-NBR      TO SOCKET-LINE               65220000
652300         MOVE 'SEE ERROR NO '        TO SOCKET-DESCR              65230000
652400                                                                  65240000
652500         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          65250000
652600         PERFORM 9990-WRITE-CICS                                  65260000
652700                                                                  65270000
652800         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      65280000
652900         SET  DP013-OTHER-ABEND      TO TRUE                      65290000
653000         SET  DP013-ROLLBACK         TO TRUE                      65300000
653100                                                                  65310000
653200         MOVE '5200-CHECK-SOCKET-CONN' TO DP013-PARAGRAPH         65320000
653300         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  65330000
653400         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       65340000
653500         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         65350000
653600         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      65360000
653700         STRING ' SUKRF527 - '                                    65370000
653800                'DP081-FAMILY='                                   65380000
653900                PV-DISPLAY-FAMILY                                 65390000
654000                ' DP081-PORT='                                    65400000
654100                PV-DISPLAY-PORT                                   65410000
654200                ' DP081-IP-ADDR='                                 65420000
654300                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       65430000
654400                                     INTO DP013-MESSAGE-TEXT (2)  65440000
654500         MOVE DP081-RETCODE            TO  PV-RETCODE             65450000
654600         MOVE DP081-ERRNO              TO  PV-ERRNO               65460000
654700         STRING ' EZASOKET CONNECT -'                             65470000
654800                ' DP081-RETCODE - '                               65480000
654900                PV-RETCODE                                        65490000
655000                ' DP081-ERRNO - '                                 65500000
655100                PV-ERRNO ' - '                                    65510000
655200                SOCKET-DESCR               DELIMITED BY SIZE      65520000
655300                                      INTO DP013-MESSAGE-TEXT (3) 65530000
655400        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          65540000
655500        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        65550000
655600        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        65560000
655700        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        65570000
655800        STRING ' PRTR ID: '                                       65580000
655900               SU001-PRINTER-ID-USE                               65590000
656000               '   OPER: '                                        65600000
656100               PV-DISPLAY-OPER                                    65610000
656200               '   PO: '                                          65620000
656300               PV-DISPLAY-PO                                      65630000
656400               '   RCVR: '                                        65640000
656500               PV-DISPLAY-RCVR                                    65650000
656600               '   LINE: '                                        65660000
656700               PV-DISPLAY-LINE             delimited by size      65670000
656800                                      INTO DP013-MESSAGE-TEXT (4) 65680000
656900         PERFORM 9999-WRITE-CICS-LOG-MSG                          65690000
657000     END-IF.                                                      65700000
657100                                                                  65710000
657200     IF DP081-RETCODE = 0                                         65720000
657300         SET  PS-SOCKET-ERROR        TO TRUE                      65730000
657400         MOVE PC-COMMUNICATION-ERROR TO AMSGLNO                   65740000
657500         MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA                   65750000
657600         MOVE -1                     TO APRTIDL                   65760000
657700         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    65770000
657800         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    65780000
657900         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      65790000
658000                                        SOCKET-ERRNO              65800000
658100         MOVE DP081-RETCODE          TO SOCKET-RETCODE            65810000
658200         MOVE SU001-PO               TO SOCKET-RECEIVER           65820000
658300         MOVE SU001-RCVR-SEQ-NBR     TO SOCKET-SEQ                65830000
658400         MOVE SU001-PO-LINE-NBR      TO SOCKET-LINE               65840000
658500         MOVE 'SOCKET TIMEOUT'       TO SOCKET-DESCR              65850000
658600                                                                  65860000
658700         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          65870000
658800         PERFORM 9990-WRITE-CICS                                  65880000
658900                                                                  65890000
659000         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      65900000
659100         SET  DP013-OTHER-ABEND      TO TRUE                      65910000
659200         SET  DP013-ROLLBACK         TO TRUE                      65920000
659300                                                                  65930000
659400         MOVE '5200-CHECK-SOCKET-CONN' TO DP013-PARAGRAPH         65940000
659500         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  65950000
659600         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       65960000
659700         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         65970000
659800         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      65980000
659900         STRING ' SUKRF527 - '                                    65990000
660000                'DP081-FAMILY='                                   66000000
660100                PV-DISPLAY-FAMILY                                 66010000
660200                ' DP081-PORT='                                    66020000
660300                PV-DISPLAY-PORT                                   66030000
660400                ' DP081-IP-ADDR='                                 66040000
660500                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       66050000
660600                                     INTO DP013-MESSAGE-TEXT (2)  66060000
660700         MOVE DP081-RETCODE            TO  PV-RETCODE             66070000
660800         MOVE DP081-ERRNO              TO  PV-ERRNO               66080000
660900         STRING ' EZASOKET CONNECT -'                             66090000
661000                ' DP081-RETCODE - '                               66100000
661100                PV-RETCODE                                        66110000
661200                ' DP081-ERRNO - '                                 66120000
661300                PV-ERRNO ' - '                                    66130000
661400                SOCKET-DESCR               DELIMITED BY SIZE      66140000
661500                                      INTO DP013-MESSAGE-TEXT (3) 66150000
661600        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          66160000
661700        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        66170000
661800        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        66180000
661900        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        66190000
662000        STRING ' PRTR ID: '                                       66200000
662100               SU001-PRINTER-ID-USE                               66210000
662200               '   OPER: '                                        66220000
662300               PV-DISPLAY-OPER                                    66230000
662400               '   PO: '                                          66240000
662500               PV-DISPLAY-PO                                      66250000
662600               '   RCVR: '                                        66260000
662700               PV-DISPLAY-RCVR                                    66270000
662800               '   LINE: '                                        66280000
662900               PV-DISPLAY-LINE             delimited by size      66290000
663000                                      INTO DP013-MESSAGE-TEXT (4) 66300000
663100         PERFORM 9999-WRITE-CICS-LOG-MSG                          66310000
663200     END-IF.                                                      66320000
663300                                                                  66330000
663400***************************************************************   66340000
663500* CHAR-TO-BIT                                                 *   66350000
663600* CONVERT THE CHARACTER ARRAY TO A SELECT BIT MASK SO THAT THE*   66360000
663700* COBOL PROGRAM CAN WRITE IT.                                 *   66370000
663800***************************************************************   66380000
663900 5210-CHAR-TO-BIT.                                                66390000
664000*                                                                 66400000
664100* CHAR-TO-BIT                                                     66410000
664200* CONVERT THE CHARACTER ARRAY TO A SELECT BIT MASK SO THAT THE    66420000
664300* COBOL PROGRAM CAN WRITE IT.                                     66430000
664400*                                                                 66440000
664500     CALL 'EZACIC06' USING BITMASK-TOKEN CTOB                     66450000
664600          BIT-MASK CHAR-MASK BIT-MASK-LENGTH EZRETC               66460000
664700     IF  EZRETC < 0 THEN                                          66470000
664800         MOVE '!EZCIC06 - CTOB-EXCP ' TO PV-CICS-MSG-AREA         66480000
664900         MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH    66490000
665000                                                                  66500000
665100         EXEC CICS                                                66510000
665200             WRITEQ TD                                            66520000
665300                 QUEUE   ('CSSL')                                 66530000
665400                 FROM    (PV-CICS-MSG-AREA)                       66540000
665500                 LENGTH  (PV-COMMAREA-LENGTH)                     66550000
665600                 RESP    (PV-CICS-RESPONSE)                       66560000
665700         END-EXEC                                                 66570000
665800                                                                  66580000
665900         SET  PS-SOCKET-ERROR        TO TRUE                      66590000
666000         MOVE PC-COMMUNICATION-ERROR TO AMSGLNO                   66600000
666100         MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA                   66610000
666200         MOVE -1                     TO APRTIDL                   66620000
666300         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    66630000
666400         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    66640000
666500         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      66650000
666600                                        SOCKET-ERRNO              66660000
666700         MOVE EZRETC                 TO SOCKET-RETCODE            66670000
666800         MOVE SU001-PO               TO SOCKET-RECEIVER           66680000
666900         MOVE SU001-RCVR-SEQ-NBR     TO SOCKET-SEQ                66690000
667000         MOVE SU001-PO-LINE-NBR      TO SOCKET-LINE               66700000
667100         MOVE 'SEE RETURN CODE'      TO SOCKET-DESCR              66710000
667200                                                                  66720000
667300         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          66730000
667400         PERFORM 9990-WRITE-CICS                                  66740000
667500                                                                  66750000
667600         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      66760000
667700         SET  DP013-OTHER-ABEND      TO TRUE                      66770000
667800         SET  DP013-ROLLBACK         TO TRUE                      66780000
667900                                                                  66790000
668000         MOVE '5210-CHAR-TO-BIT'       TO DP013-PARAGRAPH         66800000
668100         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  66810000
668200         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       66820000
668300         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         66830000
668400         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      66840000
668500         STRING ' SUKRF527 - '                                    66850000
668600                'DP081-FAMILY='                                   66860000
668700                PV-DISPLAY-FAMILY                                 66870000
668800                ' DP081-PORT='                                    66880000
668900                PV-DISPLAY-PORT                                   66890000
669000                ' DP081-IP-ADDR='                                 66900000
669100                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       66910000
669200                                     INTO DP013-MESSAGE-TEXT (2)  66920000
669300         MOVE EZRETC                   TO  PV-RETCODE             66930000
669400         MOVE DP081-ERRNO              TO  PV-ERRNO               66940000
669500         STRING ' EZASOKET CONNECT -'                             66950000
669600                ' DP081-RETCODE - '                               66960000
669700                PV-RETCODE                                        66970000
669800                ' DP081-ERRNO - '                                 66980000
669900                PV-ERRNO ' - '                                    66990000
670000                SOCKET-DESCR               DELIMITED BY SIZE      67000000
670100                                      INTO DP013-MESSAGE-TEXT (3) 67010000
670200        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          67020000
670300        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        67030000
670400        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        67040000
670500        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        67050000
670600        STRING ' PRTR ID: '                                       67060000
670700               SU001-PRINTER-ID-USE                               67070000
670800               '   OPER: '                                        67080000
670900               PV-DISPLAY-OPER                                    67090000
671000               '   PO: '                                          67100000
671100               PV-DISPLAY-PO                                      67110000
671200               '   RCVR: '                                        67120000
671300               PV-DISPLAY-RCVR                                    67130000
671400               '   LINE: '                                        67140000
671500               PV-DISPLAY-LINE             delimited by size      67150000
671600                                      INTO DP013-MESSAGE-TEXT (4) 67160000
671700         PERFORM 9999-WRITE-CICS-LOG-MSG                          67170000
671800     END-IF.                                                      67180000
671900                                                                  67190000
672000* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 67200000
672100* DMH - 10/06/04 - END                                            67210000
672200                                                                  67220000
672300                                                                  67230000
672400*----------------------------------------------------------------*67240000
672500*  RECEIVE CONFIRMATION BACK FROM AL SYSTEMS THAT THEY RECEIVED  *67250000
672600*  ALL RECORDS CORRECTLY.                                        *67260000
672700*----------------------------------------------------------------*67270000
672800 5400-RECEIVE-CONFIRM-FROM-LPMS.                                  67280000
672900                                                                  67290000
673000*** BEGIN - FOR TESTING ONLY                                      67300000
673100*    MOVE ' SUKRF527 - START OF RECEIVE CONFIRM FROM LPMS'        67310000
673200*                                        TO PV-CICS-MSG-AREA.     67320000
673300*    PERFORM 9990-WRITE-CICS.                                     67330000
673400*** END - FOR TESTING ONLY                                        67340000
673500                                                                  67350000
673600                                                                  67360000
673700     MOVE LOW-VALUES  TO  TCP-BUF2.                               67370000
673800     MOVE 5           TO  DP081-TCPLENG                           67380000
673900                          DP081-NBR-BYTES.                        67390000
674000                                                                  67400000
674100     SET  DP081-NO-FLAG  TO  TRUE.                                67410000
674200                                                                  67420000
674300     CALL 'EZASOKET'                                              67430000
674400         USING DP081-RECV-CMD                                     67440000
674500               DP081-SOCK-ID                                      67450000
674600               DP081-FLAG                                         67460000
674700               DP081-NBR-BYTES                                    67470000
674800               TCP-BUF                                            67480000
674900               DP081-ERRNO                                        67490000
675000               DP081-RETCODE.                                     67500000
675100                                                                  67510000
675200*-----------------------------------------------------*           67520000
675300*                                                     *           67530000
675400*-----------------------------------------------------*           67540000
675500     CALL 'EZACIC05'                                              67550000
675600         USING DP081-TOEBCDIC-TOKEN                               67560000
675700               TCP-BUF                                            67570000
675800               DP081-TCPLENG.                                     67580000
675900                                                                  67590000
676000     IF  DP081-RETCODE < ZERO                                     67600000
676100         SET  PS-SOCKET-ERROR         TO TRUE                     67610000
676200         MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                  67620000
676300         MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                  67630000
676400         MOVE -1                      TO APRTIDL                  67640000
676500         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    67650000
676600         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      67660000
676700         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      67670000
676800         SET  DP013-OTHER-ABEND      TO TRUE                      67680000
676900         SET  DP013-ROLLBACK         TO TRUE                      67690000
676910                                                                  67691014
676920** DMH - 9/19/17 - BEGIN                                          67692014
676930         MOVE  SPACES                  TO PV-CICS-MSG-AREA        67693014
676940         MOVE  SU001-PRINTER-ID        TO ERR-MSG-PRINTER         67694014
676950         MOVE  SU001-OPER-UNT-ID       TO ERR-MSG-OPER            67695014
676960         MOVE  SU001-PO                TO ERR-MSG-PO              67696014
676970         MOVE  SU001-RCVR-SEQ-NBR      TO ERR-MSG-RCVR            67697014
676980         MOVE  SU001-MANIFEST          TO ERR-MSG-TRIP            67698014
676990         MOVE  SU001-USER-ID           TO ERR-MSG-USERID          67699014
676991         MOVE  SU001-BATCH-NUMBER      TO ERR-MSG-BATCH           67699114
676992         MOVE  ERROR-DETAILS           TO PV-CICS-MSG-AREA        67699214
676993         PERFORM 9990-WRITE-CICS                                  67699314
676994** DMH - 9/19/17 - end                                            67699414
677000                                                                  67700000
677100         MOVE '5400-RECEIVE-CONFIRM-FROM-LPMS'                    67710000
677200                                     TO DP013-PARAGRAPH           67720000
677300         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  67730000
677400         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       67740000
677500         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         67750000
677600         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      67760000
677700         STRING ' SUKRF527 - '            DELIMITED BY SIZE       67770000
677800                'DP081-FAMILY='           DELIMITED BY SIZE       67780000
677900                PV-DISPLAY-FAMILY         DELIMITED BY SIZE       67790000
678000                ' DP081-PORT='            DELIMITED BY SIZE       67800000
678100                PV-DISPLAY-PORT           DELIMITED BY SIZE       67810000
678200                ' DP081-IP-ADDR='         DELIMITED BY SIZE       67820000
678300                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       67830000
678400                                     INTO DP013-MESSAGE-TEXT (2)  67840000
678500         MOVE DP081-RETCODE            TO  PV-RETCODE             67850000
678600         MOVE DP081-ERRNO              TO  PV-ERRNO               67860000
678700         STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE      67870000
678800                ' DP081-RETCODE - '        DELIMITED BY SIZE      67880000
678900                PV-RETCODE                 DELIMITED BY SIZE      67890000
679000                ' DP081-ERRNO - '          DELIMITED BY SIZE      67900000
679100                PV-ERRNO                   DELIMITED BY SIZE      67910000
679200                                      INTO DP013-MESSAGE-TEXT (3) 67920000
679300        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          67930000
679400        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        67940000
679500        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        67950000
679600        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        67960000
679700        STRING ' PRTR ID: '                DELIMITED BY SIZE      67970000
679800               SU001-PRINTER-ID-USE        DELIMITED BY SIZE      67980000
679900               '   OPER: '                 DELIMITED BY SIZE      67990000
680000               PV-DISPLAY-OPER             DELIMITED BY SIZE      68000000
680100               '   PO: '                   DELIMITED BY SIZE      68010000
680200               PV-DISPLAY-PO               DELIMITED BY SIZE      68020000
680300               '   RCVR: '                 DELIMITED BY SIZE      68030000
680400               PV-DISPLAY-RCVR             DELIMITED BY SIZE      68040000
680500               '   LINE: '                 DELIMITED BY SIZE      68050000
680600               PV-DISPLAY-LINE             DELIMITED BY SIZE      68060000
680700                                      INTO DP013-MESSAGE-TEXT (4) 68070000
680800         PERFORM 9999-WRITE-CICS-LOG-MSG                          68080000
680900                                                                  68090000
681000*** BEGIN - FOR TESTING ONLY                                      68100000
681100*    ELSE                                                         68110000
681200*        MOVE ' SUKRF527 - CONFIRM SUCCESSFUL'                    68120000
681300*                                            TO PV-CICS-MSG-AREA  68130000
681400*        PERFORM 9990-WRITE-CICS                                  68140000
681500*** END - FOR TESTING ONLY                                        68150000
681600                                                                  68160000
681700     END-IF.                                                      68170000
681800                                                                  68180000
681900*-----------------------------------------------------*           68190000
682000*                                                     *           68200000
682100*-----------------------------------------------------*           68210000
682200     MOVE TCP-BUF TO PC133-LABEL-RECORD.                          68220000
682300                                                                  68230000
682400     IF  NOT PC133-SEND-SUCCESSFUL                                68240000
682500         PERFORM 4340-CLOSE-SOCKET                                68250000
682600         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    68260000
682700         SET  PS-SOCKET-ERROR         TO TRUE                     68270000
682800         MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                  68280000
682900         MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                  68290000
683000         MOVE -1                      TO APRTIDL                  68300000
683100         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      68310000
683200         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      68320000
683300                                        RECEIVE-ERRNO             68330000
683400         MOVE SU001-PO               TO RECEIVE-RECEIVER          68340000
683500         MOVE SU001-RCVR-SEQ-NBR     TO RECEIVE-SEQ               68350000
683600         MOVE SU001-PO-LINE-NBR      TO RECEIVE-LINE              68360000
683700                                                                  68370000
683800         MOVE RECEIVE-ERR            TO PV-CICS-MSG-AREA          68380000
683900         PERFORM 9990-WRITE-CICS                                  68390000
684000         STRING '  '                 DELIMITED BY SIZE            68400000
684100                PC133-LABEL-RECORD   DELIMITED BY SIZE            68410000
684200                                     INTO PV-CICS-MSG-AREA        68420000
684300         PERFORM 9990-WRITE-CICS                                  68430000
684400                                                                  68440000
684500         PERFORM 4740-GET-LPMS-RETURN                             68450000
684600                                                                  68460000
684700         EVALUATE TRUE                                            68470000
684800             WHEN  PC133-INVALID-PRINTER                          68480000
684900               STRING ' SUKRF527 -'           DELIMITED BY SIZE   68490000
685000                 PC138-MSG-INVALID-PRTR       DELIMITED BY SIZE   68500000
685100                                          INTO PV-CICS-MSG-AREA   68510000
685200             WHEN  PC133-DTL-WITHOUT-HDR                          68520000
685300               STRING ' SUKRF527 -'           DELIMITED BY SIZE   68530000
685400                 PC138-MSG-DTL-WO-HDR         DELIMITED BY SIZE   68540000
685500                                          INTO PV-CICS-MSG-AREA   68550000
685600             WHEN  PC133-TLR-WITHOUT-HDR-DTL                      68560000
685700               STRING ' SUKRF527 -'           DELIMITED BY SIZE   68570000
685800                 PC138-MSG-TLR-WO-HDR-DTL     DELIMITED BY SIZE   68580000
685900                                          INTO PV-CICS-MSG-AREA   68590000
686000             WHEN  PC133-TLR-CNT-NOT-MTCH-DTL                     68600000
686100               STRING ' SUKRF527 -'           DELIMITED BY SIZE   68610000
686200                 PC138-MSG-TLR-CNT-NOT-DTL    DELIMITED BY SIZE   68620000
686300                                          INTO PV-CICS-MSG-AREA   68630000
686400             WHEN  PC133-TRAN-IDS-NOT-MTCH                        68640000
686500               STRING ' SUKRF527 -'           DELIMITED BY SIZE   68650000
686600                 PC138-MSG-TRAN-IDS-NOT-MTCH  DELIMITED BY SIZE   68660000
686700                                          INTO PV-CICS-MSG-AREA   68670000
686800             WHEN  PC133-DTL-LNGTH-NOT-MTCH                       68680000
686900               STRING ' SUKRF527 -'           DELIMITED BY SIZE   68690000
687000                 PC138-MSG-DTL-LNGTH-NOT-MTCH DELIMITED BY SIZE   68700000
687100                                          INTO PV-CICS-MSG-AREA   68710000
687200             WHEN  PC133-DISK-ERROR                               68720000
687300               STRING ' SUKRF527 -'           DELIMITED BY SIZE   68730000
687400                 PC138-MSG-DISK-ERROR         DELIMITED BY SIZE   68740000
687500                                          INTO PV-CICS-MSG-AREA   68750000
687600             WHEN  PC133-TIMEOUT                                  68760000
687700               STRING ' SUKRF527 -'           DELIMITED BY SIZE   68770000
687800                 PC138-MSG-TIMEOUT            DELIMITED BY SIZE   68780000
687900                                          INTO PV-CICS-MSG-AREA   68790000
688000             WHEN  PC133-ADDR-NOT-FND                             68800000
688100               STRING ' SUKRF527 -'           DELIMITED BY SIZE   68810000
688200                 PC138-MSG-ADDR-NOT-FND       DELIMITED BY SIZE   68820000
688300                                          INTO PV-CICS-MSG-AREA   68830000
688400             WHEN  PC133-INVALID-PACKET                           68840000
688500               STRING ' SUKRF527 -'           DELIMITED BY SIZE   68850000
688600                 PC138-MSG-INVALID-PACKET     DELIMITED BY SIZE   68860000
688700                                          INTO PV-CICS-MSG-AREA   68870000
688800         END-EVALUATE                                             68880000
688900         PERFORM 9990-WRITE-CICS                                  68890000
688910** DMH - 9/19/17 - BEGIN                                          68891014
688920         MOVE  SPACES                  TO PV-CICS-MSG-AREA        68892014
688930         MOVE  SU001-PRINTER-ID        TO ERR-MSG-PRINTER         68893014
688940         MOVE  SU001-OPER-UNT-ID       TO ERR-MSG-OPER            68894014
688950         MOVE  SU001-PO                TO ERR-MSG-PO              68895014
688960         MOVE  SU001-RCVR-SEQ-NBR      TO ERR-MSG-RCVR            68896014
688970         MOVE  SU001-MANIFEST          TO ERR-MSG-TRIP            68897014
688980         MOVE  SU001-USER-ID           TO ERR-MSG-USERID          68898014
688990         MOVE  SU001-BATCH-NUMBER      TO ERR-MSG-BATCH           68899014
688991         MOVE  ERROR-DETAILS           TO PV-CICS-MSG-AREA        68899114
688992         PERFORM 9990-WRITE-CICS                                  68899214
688993** DMH - 9/19/17 - end                                            68899314
689000                                                                  68900000
689100         SET  DP013-OTHER-ABEND      TO TRUE                      68910000
689200         SET  DP013-ROLLBACK         TO TRUE                      68920000
689300                                                                  68930000
689400         MOVE '5400-RECEIVE-CONFIRM-FROM-LPMS'                    68940000
689500                                     TO DP013-PARAGRAPH           68950000
689600         STRING ' SUKRF527 - '           DELIMITED BY SIZE        68960000
689700                DP081-TCP-IP-LOGGING-MSG DELIMITED BY SIZE        68970000
689800                                     INTO DP013-MESSAGE-TEXT (1)  68980000
689900         PERFORM 9999-WRITE-CICS-LOG-MSG                          68990000
690000*** BEGIN - FOR TESTING ONLY                                      69000000
690100*    ELSE                                                         69010000
690200*        MOVE ' SUKRF527 - CONFIRM SUCCESSFUL'                    69020000
690300*                                    TO PV-CICS-MSG-AREA          69030000
690400*        PERFORM 9990-WRITE-CICS                                  69040000
690500*** END - FOR TESTING ONLY                                        69050000
690600     END-IF.                                                      69060000
690700                                                                  69070000
690800*----------------------------------------------------------------*69080000
690900*  RECEIVE CONFIRMATION BACK AND PROCESS ANY PARTIAL DATA SENT   *69090000
691000*----------------------------------------------------------------*69100000
691100 5401-RECEIVE-CONFIRM-FROM-LPMS.                                  69110000
691200                                                                  69120000
691300*** BEGIN - FOR TESTING ONLY                                      69130000
691400*    MOVE ' SUKRF527 - START OF RECEIVE CONFIRM FROM LPMS'        69140000
691500*                                        TO PV-CICS-MSG-AREA.     69150000
691600*    PERFORM 9990-WRITE-CICS.                                     69160000
691700*** END - FOR TESTING ONLY                                        69170000
691800                                                                  69180000
691900                                                                  69190000
692000     CALL 'EZASOKET'                                              69200000
692100         USING DP081-RECV-CMD                                     69210000
692200               DP081-SOCK-ID                                      69220000
692300               DP081-FLAG                                         69230000
692400               DP081-NBR-BYTES                                    69240000
692500               TCP-BUF                                            69250000
692600               DP081-ERRNO                                        69260000
692700               DP081-RETCODE.                                     69270000
692800*-----------------------------------------------------*           69280000
692900*                                                     *           69290000
693000*-----------------------------------------------------*           69300000
693100     CALL 'EZACIC05'                                              69310000
693200         USING DP081-TOEBCDIC-TOKEN                               69320000
693300               TCP-BUF                                            69330000
693400               DP081-TCPLENG.                                     69340000
693500                                                                  69350000
693600     IF  DP081-RETCODE < ZERO                                     69360000
693700         SET  PS-SOCKET-ERROR         TO TRUE                     69370000
693800         MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                  69380000
693900         MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                  69390000
694000         MOVE -1                      TO APRTIDL                  69400000
694100         PERFORM 6000-FORMAT-ABEND                                69410000
694200*** BEGIN - FOR TESTING ONLY                                      69420000
694300*    ELSE                                                         69430000
694400*        MOVE ' SUKRF527 - CONFIRM SUCCESSFUL'                    69440000
694500*                                            TO PV-CICS-MSG-AREA  69450000
694600*        PERFORM 9990-WRITE-CICS                                  69460000
694700*** END - FOR TESTING ONLY                                        69470000
694800                                                                  69480000
694900     ELSE                                                         69490000
695000             MOVE DP081-RETCODE TO PV-TCP-RET-LENGTH              69500000
695100             IF  PV-TCP-RET-LENGTH = PV-TCP-EXP-LENGTH            69510000
695200                 SET PS-COMP-RECEIVE TO TRUE                      69520000
695300             ELSE                                                 69530000
695400                 IF  PV-TCP-RET-LENGTH > DP081-NBR-BYTES          69540000
695500                     PERFORM 4340-CLOSE-SOCKET                    69550000
695600                     INITIALIZE PV-CICS-MSG-AREA                  69560000
695700                     MOVE DP081-RETCODE TO PV-RETCODE             69570000
695800                     MOVE DP081-NBR-BYTES TO PV-TCPLENG           69580000
695900                     MOVE DP081-ERRNO   TO PV-ERRNO               69590000
696000                     STRING ' SUKRF527:'                          69600000
696100                          'SOCKET LENGTH ERROR #1'                69610000
696200                          ' RETCODE='                             69620000
696300                          PV-RETCODE                              69630000
696400                          ' DP081-NBR-BYTES='                     69640000
696500                          PV-TCPLENG                              69650000
696600                          ' ERRNO='                               69660000
696700                          PV-ERRNO                                69670000
696800                         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA  69680000
696900                     PERFORM 9990-WRITE-CICS                      69690000
697000*                    BEGIN OF TRANSLATE ASCII TO EBCDIC           69700000
697100                     CALL 'EZACIC05'                              69710000
697200                         USING  DP081-TOEBCDIC-TOKEN              69720000
697300                                TCP-BUF2                          69730000
697400                                DP081-NBR-BYTES                   69740000
697500*                    END OF TRANSLATE ASCII TO EBCDIC             69750000
697600                                                                  69760000
697700                                                                  69770000
697800                     MOVE PC-CURRENT-PROGRAM-NAME TO              69780000
697900                                            DP081-TCP-IP-PGM-NAME 69790000
698000                     SET  DP081-TCP-IP-READ-ERR TO TRUE           69800000
698100                     MOVE DP081-ERRNO         TO                  69810000
698200                                             DP081-TCP-IP-ERR-NBR 69820000
698300                     SET  DP013-OTHER-ABEND   TO TRUE             69830000
698400                     SET  DP013-NO-ROLLBACK   TO TRUE             69840000
698500                     MOVE '5401-RECEIVE-CONFIRM'                  69850000
698600                         TO DP013-PARAGRAPH                       69860000
698700                     MOVE DP081-TCP-IP-LOGGING-MSG TO             69870000
698800                          DP013-MESSAGE-TEXT (1)                  69880000
698900                     PERFORM 9999-WRITE-CICS-LOG-MSG              69890000
699000                 ELSE                                             69900000
699100                     PERFORM 6100-PROCESS-PARTIAL-TCP             69910000
699200                 END-IF                                           69920000
699300             END-IF                                               69930000
699400     END-IF.                                                      69940000
699500                                                                  69950000
699600*-----------------------------------------------------*           69960000
699700*                                                     *           69970000
699800*-----------------------------------------------------*           69980000
699900     IF PS-COMP-RECEIVE                                           69990000
700000         MOVE TCP-BUF TO PC133-LABEL-RECORD                       70000000
700100                                                                  70010000
700200     IF  NOT PC133-SEND-SUCCESSFUL                                70020000
700300         PERFORM 4340-CLOSE-SOCKET                                70030000
700400         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    70040000
700500         SET  PS-SOCKET-ERROR         TO TRUE                     70050000
700600         MOVE PC-COMMUNICATION-ERROR  TO AMSGLNO                  70060000
700700         MOVE DP015-UNP-NUM-BRT-MDT   TO APRTIDA                  70070000
700800         MOVE -1                      TO APRTIDL                  70080000
700900         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      70090000
701000         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      70100000
701100                                        RECEIVE-ERRNO             70110000
701200         MOVE SU001-PO               TO RECEIVE-RECEIVER          70120000
701300         MOVE SU001-RCVR-SEQ-NBR     TO RECEIVE-SEQ               70130000
701400         MOVE SU001-PO-LINE-NBR      TO RECEIVE-LINE              70140000
701500                                                                  70150000
701600         MOVE RECEIVE-ERR            TO PV-CICS-MSG-AREA          70160000
701700         PERFORM 9990-WRITE-CICS                                  70170000
701800         STRING '  '                 DELIMITED BY SIZE            70180000
701900                PC133-LABEL-RECORD   DELIMITED BY SIZE            70190000
702000                                     INTO PV-CICS-MSG-AREA        70200000
702100         PERFORM 9990-WRITE-CICS                                  70210000
702200                                                                  70220000
702300         PERFORM 4740-GET-LPMS-RETURN                             70230000
702400                                                                  70240000
702500         EVALUATE TRUE                                            70250000
702600             WHEN  PC133-INVALID-PRINTER                          70260000
702700               STRING ' SUKRF527 -'           DELIMITED BY SIZE   70270000
702800                 PC138-MSG-INVALID-PRTR       DELIMITED BY SIZE   70280000
702900                                          INTO PV-CICS-MSG-AREA   70290000
703000             WHEN  PC133-DTL-WITHOUT-HDR                          70300000
703100               STRING ' SUKRF527 -'           DELIMITED BY SIZE   70310000
703200                 PC138-MSG-DTL-WO-HDR         DELIMITED BY SIZE   70320000
703300                                          INTO PV-CICS-MSG-AREA   70330000
703400             WHEN  PC133-TLR-WITHOUT-HDR-DTL                      70340000
703500               STRING ' SUKRF527 -'           DELIMITED BY SIZE   70350000
703600                 PC138-MSG-TLR-WO-HDR-DTL     DELIMITED BY SIZE   70360000
703700                                          INTO PV-CICS-MSG-AREA   70370000
703800             WHEN  PC133-TLR-CNT-NOT-MTCH-DTL                     70380000
703900               STRING ' SUKRF527 -'           DELIMITED BY SIZE   70390000
704000                 PC138-MSG-TLR-CNT-NOT-DTL    DELIMITED BY SIZE   70400000
704100                                          INTO PV-CICS-MSG-AREA   70410000
704200             WHEN  PC133-TRAN-IDS-NOT-MTCH                        70420000
704300               STRING ' SUKRF527 -'           DELIMITED BY SIZE   70430000
704400                 PC138-MSG-TRAN-IDS-NOT-MTCH  DELIMITED BY SIZE   70440000
704500                                          INTO PV-CICS-MSG-AREA   70450000
704600             WHEN  PC133-DTL-LNGTH-NOT-MTCH                       70460000
704700               STRING ' SUKRF527 -'           DELIMITED BY SIZE   70470000
704800                 PC138-MSG-DTL-LNGTH-NOT-MTCH DELIMITED BY SIZE   70480000
704900                                          INTO PV-CICS-MSG-AREA   70490000
705000             WHEN  PC133-DISK-ERROR                               70500000
705100               STRING ' SUKRF527 -'           DELIMITED BY SIZE   70510000
705200                 PC138-MSG-DISK-ERROR         DELIMITED BY SIZE   70520000
705300                                          INTO PV-CICS-MSG-AREA   70530000
705400             WHEN  PC133-TIMEOUT                                  70540000
705500               STRING ' SUKRF527 -'           DELIMITED BY SIZE   70550000
705600                 PC138-MSG-TIMEOUT            DELIMITED BY SIZE   70560000
705700                                          INTO PV-CICS-MSG-AREA   70570000
705800             WHEN  PC133-ADDR-NOT-FND                             70580000
705900               STRING ' SUKRF527 -'           DELIMITED BY SIZE   70590000
706000                 PC138-MSG-ADDR-NOT-FND       DELIMITED BY SIZE   70600000
706100                                          INTO PV-CICS-MSG-AREA   70610000
706200             WHEN  PC133-INVALID-PACKET                           70620000
706300               STRING ' SUKRF527 -'           DELIMITED BY SIZE   70630000
706400                 PC138-MSG-INVALID-PACKET     DELIMITED BY SIZE   70640000
706500                                          INTO PV-CICS-MSG-AREA   70650000
706600         END-EVALUATE                                             70660000
706700         PERFORM 9990-WRITE-CICS                                  70670000
706710                                                                  70671014
706720** DMH - 9/19/17 - BEGIN                                          70672014
706730         MOVE  SPACES                  TO PV-CICS-MSG-AREA        70673014
706740         MOVE  SU001-PRINTER-ID        TO ERR-MSG-PRINTER         70674014
706750         MOVE  SU001-OPER-UNT-ID       TO ERR-MSG-OPER            70675014
706760         MOVE  SU001-PO                TO ERR-MSG-PO              70676014
706770         MOVE  SU001-RCVR-SEQ-NBR      TO ERR-MSG-RCVR            70677014
706780         MOVE  SU001-MANIFEST          TO ERR-MSG-TRIP            70678014
706790         MOVE  SU001-USER-ID           TO ERR-MSG-USERID          70679014
706791         MOVE  SU001-BATCH-NUMBER      TO ERR-MSG-BATCH           70679114
706792         MOVE  ERROR-DETAILS           TO PV-CICS-MSG-AREA        70679214
706793         PERFORM 9990-WRITE-CICS                                  70679314
706794** DMH - 9/19/17 - end                                            70679414
706800                                                                  70680000
706900         SET  DP013-OTHER-ABEND      TO TRUE                      70690000
707000         SET  DP013-ROLLBACK         TO TRUE                      70700000
707100                                                                  70710000
707200         MOVE '5401-RECEIVE-CONFIRM-FROM-LPMS'                    70720000
707300                                     TO DP013-PARAGRAPH           70730000
707400         STRING ' SUKRF527 - '           DELIMITED BY SIZE        70740000
707500                DP081-TCP-IP-LOGGING-MSG DELIMITED BY SIZE        70750000
707600                                     INTO DP013-MESSAGE-TEXT (1)  70760000
707700         PERFORM 9999-WRITE-CICS-LOG-MSG                          70770000
707800*** BEGIN - FOR TESTING ONLY                                      70780000
707900*    ELSE                                                         70790000
708000*        MOVE ' SUKRF527 - CONFIRM SUCCESSFUL'                    70800000
708100*                                    TO PV-CICS-MSG-AREA          70810000
708200*        PERFORM 9990-WRITE-CICS                                  70820000
708300*** END - FOR TESTING ONLY                                        70830000
708400     END-IF                                                       70840000
708500     END-IF.                                                      70850000
708600************************************                              70860000
708700 6000-FORMAT-ABEND.                                               70870000
708800         SET  PS-SOCKET-ERROR         TO TRUE                     70880000
708900         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    70890000
709000         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      70900000
709100         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      70910000
709200         SET  DP013-OTHER-ABEND      TO TRUE                      70920000
709300         SET  DP013-ROLLBACK         TO TRUE                      70930000
709400                                                                  70940000
709500         MOVE '5401-RECEIVE-CONFIRM-FROM-LPMS'                    70950000
709600                                     TO DP013-PARAGRAPH           70960000
709700         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  70970000
709800         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       70980000
709900         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         70990000
710000         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      71000000
710100         STRING ' SUKRF527 - '            DELIMITED BY SIZE       71010000
710200                'DP081-FAMILY='           DELIMITED BY SIZE       71020000
710300                PV-DISPLAY-FAMILY         DELIMITED BY SIZE       71030000
710400                ' DP081-PORT='            DELIMITED BY SIZE       71040000
710500                PV-DISPLAY-PORT           DELIMITED BY SIZE       71050000
710600                ' DP081-IP-ADDR='         DELIMITED BY SIZE       71060000
710700                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       71070000
710800                                     INTO DP013-MESSAGE-TEXT (2)  71080000
710900         MOVE DP081-RETCODE            TO  PV-RETCODE             71090000
711000         MOVE DP081-ERRNO              TO  PV-ERRNO               71100000
711100         STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE      71110000
711200                ' DP081-RETCODE - '        DELIMITED BY SIZE      71120000
711300                PV-RETCODE                 DELIMITED BY SIZE      71130000
711400                ' DP081-ERRNO - '          DELIMITED BY SIZE      71140000
711500                PV-ERRNO                   DELIMITED BY SIZE      71150000
711600                                      INTO DP013-MESSAGE-TEXT (3) 71160000
711700        MOVE   LBPTDA-PO-NBR           TO  PV-DISPLAY-PO          71170000
711800        MOVE   LBPTDA-RCVR-SEQ-NBR     TO  PV-DISPLAY-RCVR        71180000
711900        MOVE   LBPTDA-PO-LNE-NBR       TO  PV-DISPLAY-LINE        71190000
712000        MOVE   SU001-OPER-UNT-ID       TO  PV-DISPLAY-OPER        71200000
712100        STRING ' PRTR ID: '                DELIMITED BY SIZE      71210000
712200               SU001-PRINTER-ID-USE        DELIMITED BY SIZE      71220000
712300               '   OPER: '                 DELIMITED BY SIZE      71230000
712400               PV-DISPLAY-OPER             DELIMITED BY SIZE      71240000
712500               '   PO: '                   DELIMITED BY SIZE      71250000
712600               PV-DISPLAY-PO               DELIMITED BY SIZE      71260000
712700               '   RCVR: '                 DELIMITED BY SIZE      71270000
712800               PV-DISPLAY-RCVR             DELIMITED BY SIZE      71280000
712900               '   LINE: '                 DELIMITED BY SIZE      71290000
713000               PV-DISPLAY-LINE             DELIMITED BY SIZE      71300000
713100                                      INTO DP013-MESSAGE-TEXT (4) 71310000
713200         PERFORM 9999-WRITE-CICS-LOG-MSG.                         71320000
713300                                                                  71330000
713400*----------------------------------------------------------------*71340000
713500*    THIS PARAGRAPH WILL BE USED WHEN WHAT IS RECEIVED VIA A     *71350000
713600*    SOCKET IS LESS THAN WHAT WAS EXPECTED TO BE RETURNED.       *71360000
713700*    THIS PARAGRAPH WILL DETERMINE IF THE PARTIAL IS A FIRST     *71370000
713800*    RECEIPT OF A NEW PACKET OR AN ADDITIONAL RECEIPT OF A       *71380000
713900*    PACKAGE AND THEN TAKE THE RECEIVED DATA AND CHARACTER BY    *71390000
714000*    CHARACTER MOVE FROM THE RECEIVED FIELD TO THE ASSEMBLE      *71400000
714100*    FIELD IN ORDER TO BUILD THE SOCKET PACKET OVER MULTIPLE     *71410000
714200*    RECEIVE COMMANDS.                                           *71420000
714300*----------------------------------------------------------------*71430000
714400                                                                  71440000
714500 6100-PROCESS-PARTIAL-TCP.                                        71450000
714600                                                                  71460000
714700     IF  PS-START-RECEIVE                                         71470000
714800         SET PS-PART-RECEIVE TO TRUE                              71480000
714900         SET PT-ASSEMBLE-IDX TO 1                                 71490000
715000         MOVE ZEROS TO PV-TCP-PRCSD-LENGTH                        71500000
715100     END-IF.                                                      71510000
715200                                                                  71520000
715300     ADD PV-TCP-RET-LENGTH TO PV-TCP-PRCSD-LENGTH.                71530000
715400                                                                  71540000
715500     IF  PV-TCP-PRCSD-LENGTH > PV-TCP-EXP-LENGTH                  71550000
715600         PERFORM 4340-CLOSE-SOCKET                                71560000
715700         INITIALIZE PV-CICS-MSG-AREA                              71570000
715800         MOVE DP081-RETCODE TO PV-RETCODE                         71580000
715900         MOVE DP081-NBR-BYTES TO PV-TCPLENG                       71590000
716000         MOVE DP081-ERRNO   TO PV-ERRNO                           71600000
716100         STRING ' SUKRF527:'                                      71610000
716200              'SOCKET TOTAL LENGTH ERROR'                         71620000
716300              ' RETCODE='                                         71630000
716400              PV-RETCODE                                          71640000
716500              ' TOTLENG='                                         71650000
716600              PV-TCP-PRCSD-LENGTH                                 71660000
716700              ' ERRNO='                                           71670000
716800              PV-ERRNO                                            71680000
716900             DELIMITED BY SIZE INTO PV-CICS-MSG-AREA              71690000
717000         PERFORM 9990-WRITE-CICS                                  71700000
717100*        BEGIN OF TRANSLATE ASCII TO EBCDIC                       71710000
717200         CALL 'EZACIC05'                                          71720000
717300             USING  DP081-TOEBCDIC-TOKEN                          71730000
717400                    TCP-BUF2                                      71740000
717500                    DP081-NBR-BYTES                               71750000
717600*        END OF TRANSLATE ASCII TO EBCDIC                         71760000
717700                                                                  71770000
717800* JUST FOR TESTING - BEGIN                                        71780000
717900*        INITIALIZE PV-CICS-MSG-AREA                              71790000
718000*        STRING ' SUKRF527:'                                      71800000
718100*             TCP-BUF2                                            71810000
718200*            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA              71820000
718300*        PERFORM 9990-WRITE-CICS                                  71830000
718400* JUST FOR TESTING - END                                          71840000
718500                                                                  71850000
718600         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    71860000
718700         SET  DP081-TCP-IP-READ-ERR TO TRUE                       71870000
718800         MOVE DP081-ERRNO         TO DP081-TCP-IP-ERR-NBR         71880000
718900         SET  DP013-OTHER-ABEND   TO TRUE                         71890000
719000         SET  DP013-NO-ROLLBACK   TO TRUE                         71900000
719100         MOVE '6100-PROCESS-PARTIAL-TCP'                          71910000
719200             TO DP013-PARAGRAPH                                   71920000
719300         MOVE DP081-TCP-IP-LOGGING-MSG TO                         71930000
719400              DP013-MESSAGE-TEXT (1)                              71940000
719500         PERFORM 9999-WRITE-CICS-LOG-MSG                          71950000
719600     END-IF.                                                      71960000
719700                                                                  71970000
719800*  DISPLAYS ADDED TO DISPLAY A PARTIAL SOCKET RECEIVE             71980000
719900*  \/                                                             71990000
720000                                                                  72000000
720100     INITIALIZE PV-CICS-MSG-AREA.                                 72010000
720200     MOVE DP081-RETCODE TO PV-RETCODE.                            72020000
720300     MOVE DP081-NBR-BYTES TO PV-TCPLENG.                          72030000
720400     MOVE DP081-ERRNO   TO PV-ERRNO.                              72040000
720500                                                                  72050000
720600* JUST FOR TESTING - BEGIN                                        72060000
720700*    STRING ' SUKRF527:'                                          72070000
720800*         'SOCKET PARTIAL RECEIVE'                                72080000
720900*         ' RETCODE='                                             72090000
721000*         PV-RETCODE                                              72100000
721100*         ' TCPLENG='                                             72110000
721200*         PV-TCPLENG                                              72120000
721300*         ' ERRNO='                                               72130000
721400*         PV-ERRNO                                                72140000
721500*        DELIMITED BY SIZE INTO PV-CICS-MSG-AREA.                 72150000
721600*    PERFORM 9990-WRITE-CICS.                                     72160000
721700* JUST FOR TESTING - END                                          72170000
721800                                                                  72180000
721900*        BEGIN OF TRANSLATE ASCII TO EBCDIC                       72190000
722000     MOVE TCP-BUF TO PV-TCP-BUF.                                  72200000
722100     CALL 'EZACIC05'                                              72210000
722200         USING  DP081-TOEBCDIC-TOKEN                              72220000
722300                PV-TCP-BUF                                        72230000
722400                DP081-NBR-BYTES.                                  72240000
722500*        END OF TRANSLATE ASCII TO EBCDIC                         72250000
722600                                                                  72260000
722700* JUST FOR TESTING - BEGIN                                        72270000
722800*    INITIALIZE PV-CICS-MSG-AREA.                                 72280000
722900*    STRING ' SUKRF527:'                                          72290000
723000*         PV-TCP-BUF                                              72300000
723100*        DELIMITED BY SIZE INTO PV-CICS-MSG-AREA.                 72310000
723200*    PERFORM 9990-WRITE-CICS.                                     72320000
723300* JUST FOR TESTING - END                                          72330000
723400                                                                  72340000
723500*  /\                                                             72350000
723600*  DISPLAYS ADDED TO DISPLAY A PARTIAL SOCKET RECEIVE             72360000
723700                                                                  72370000
723800     MOVE TCP-BUF TO PT-TCP-RECEIVE-TABLE.                        72380000
723900                                                                  72390000
724000     PERFORM 6200-ASSEMBLE-DATA                                   72400000
724100         VARYING PT-RECEIVE-IDX FROM 1 BY 1                       72410000
724200             UNTIL PT-RECEIVE-IDX > PV-TCP-RET-LENGTH.            72420000
724300                                                                  72430000
724400     IF  PV-TCP-PRCSD-LENGTH = PV-TCP-EXP-LENGTH                  72440000
724500         SET PS-COMP-RECEIVE TO TRUE                              72450000
724600         MOVE SPACES TO TCP-BUF2                                  72460000
724700         MOVE PT-TCP-ASSEMBLE-TABLE TO TCP-BUF                    72470000
724800         MOVE PV-TCP-EXP-LENGTH TO DP081-NBR-BYTES                72480000
724900                                                                  72490000
725000* JUST FOR TESTING - BEGIN                                        72500000
725100*        INITIALIZE PV-CICS-MSG-AREA                              72510000
725200*        STRING ' SUKRF527:STRUNG DATA  '                         72520000
725300*             TCP-BUF2                                            72530000
725400*            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA              72540000
725500*        PERFORM 9990-WRITE-CICS                                  72550000
725600* JUST FOR TESTING - END                                          72560000
725700                                                                  72570000
725800     ELSE                                                         72580000
725900         SUBTRACT PV-TCP-PRCSD-LENGTH FROM                        72590000
726000                  PV-TCP-EXP-LENGTH   GIVING                      72600000
726100                  PV-TCP-REM-LENGTH                               72610000
726200         MOVE PV-TCP-REM-LENGTH TO DP081-NBR-BYTES                72620000
726300                                                                  72630000
726400* JUST FOR TESTING - BEGIN                                        72640000
726500*        INITIALIZE PV-CICS-MSG-AREA                              72650000
726600*        STRING ' SUKRF527:'                                      72660000
726700*             'SOCKET GET MORE LENGTH'                            72670000
726800*             ' PRCSD='                                           72680000
726900*             PV-TCP-PRCSD-LENGTH                                 72690000
727000*             ' EXPECT='                                          72700000
727100*             PV-TCP-EXP-LENGTH                                   72710000
727200*             ' REMAIN='                                          72720000
727300*             PV-TCP-REM-LENGTH                                   72730000
727400*            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA              72740000
727500*        PERFORM 9990-WRITE-CICS                                  72750000
727600* JUST FOR TESTING - END                                          72760000
727700                                                                  72770000
727800     END-IF.                                                      72780000
727900                                                                  72790000
728000                                                                  72800000
728100                                                                  72810000
728200*----------------------------------------------------------------*72820000
728300*    THIS PARAGRAPH WILL ASSEMBLE THE DATA THAT WAS RECEIVED     *72830000
728400*    WITH THE DATA RECEIVED FROM PREVIOUS RECEIVES FOR THE       *72840000
728500*    SOCKET PACKET.                                              *72850000
728600*----------------------------------------------------------------*72860000
728700                                                                  72870000
728800 6200-ASSEMBLE-DATA.                                              72880000
728900                                                                  72890000
729000     MOVE PT-TCP-RECEIVE-CHAR (PT-RECEIVE-IDX) TO                 72900000
729100          PT-TCP-DATA-CHAR (PT-ASSEMBLE-IDX).                     72910000
729200     SET PT-ASSEMBLE-IDX UP BY 1.                                 72920000
729300                                                                  72930000
729400                                                                  72940000
729500 7000-CALL-STORE-ON-HAND-MOD.                                     72950000
729600     INITIALIZE XL088-ITEM-COMMAREA.                              72960000
729700     SET  XL088-ONHAND-YES        TO TRUE                         72970000
729800     SET  XL088-PROCESS-MSG-NO    TO TRUE                         72980000
729900     MOVE LBPTDA-DEST-OPER-UNT-ID TO XL088-KEY-STR-NBR            72990000
730000     MOVE LBPTDA-OPER-UNT-ID      TO XL088-OPER-UNT-ID            73000000
730100                                                                  73010000
730200     SET XL088-BY-OTBND-CRTN TO TRUE                              73020000
730300     MOVE LBPTDA-BRCDE-NBR TO PV-OTBND-CRTN                       73030000
730400     MOVE PV-OTBND-SML     TO XL088-OTBND-CRTN                    73040000
730500     MOVE LBPTDA-PO-NBR    TO XL088-KEY-PO                        73050000
730600     MOVE LBPTDA-RCVR-SEQ-NBR TO XL088-KEY-REC-SEQ-NBR            73060000
730700                                                                  73070000
730800                                                                  73080000
730900     CALL XL088-USER-PGM USING DFHEIBLK                           73090000
731000                               XL088-COMMAREA                     73100000
731100                               XL088-ITEM-COMMAREA.               73110000
731200     EVALUATE TRUE                                                73120000
731300        WHEN XL088-SUCCESSFUL                                     73130000
731400           CONTINUE                                               73140000
731500        WHEN OTHER                                                73150000
731600           MOVE XL088-KEY-STR-NBR TO PV-DISPLAY-DEST              73160000
731700           MOVE XL088-KEY-SKU     TO PV-DISPLAY-SKU               73170000
731800           MOVE XL088-OTBND-CRTN  TO PV-DISPLAY-CRTN              73180000
731900           SET  PS-SOCKET-ERROR         TO TRUE                   73190000
732000           STRING PC-CURRENT-PROGRAM-NAME                         73200000
732100                  ' - ERROR FROM XLKUT088 - '                     73210000
732200                  XL088-RETURN-SQLCODE                            73220000
732300                  ' STORE = '                                     73230000
732400                  PV-DISPLAY-DEST                                 73240000
732500                  ' CRTN = '                                      73250000
732600                  PV-DISPLAY-CRTN                                 73260000
732700                  ' SKU  = '                                      73270000
732800                  PV-DISPLAY-SKU                                  73280000
732900                  DELIMITED BY SIZE                               73290000
733000                  INTO PV-CICS-MSG-AREA                           73300000
733100           PERFORM 9990-WRITE-CICS                                73310000
733200                                                                  73320000
733300           MOVE XL088-CRA-RET-MSG TO PV-CICS-MSG-AREA             73330000
733400           PERFORM 9990-WRITE-CICS                                73340000
733500                                                                  73350000
733600           MOVE '7000-CALL-STORE-ON-HAND-MOD '                    73360000
733700                           TO DP013-PARAGRAPH                     73370000
733800           MOVE 'SUKRF527 - CALL BALANCE ON HAND '                73380000
733900                                 TO DP013-MESSAGE-TEXT(1)         73390000
734000           MOVE   SU001-MANIFEST TO PV-DISPLAY-MANIFEST           73400000
734100           STRING ' TRIP-'                                        73410000
734200                  PV-DISPLAY-MANIFEST                             73420000
734300                  ' USER ID-'                                     73430000
734400                  SU001-USER-ID                                   73440000
734500                  ' USER ID REQ-'                                 73450000
734600                  SU001-USER-ID-USE                               73460000
734700                  ' BATCH NUMBER-'                                73470000
734800                  PV-BATCH-NUMBER-N     DELIMITED BY SIZE         73480000
734900                               INTO DP013-MESSAGE-TEXT (2)        73490000
735000           MOVE SQLCA            TO DP013-SQLCA                   73500000
735100           SET DP013-DB2-ABEND             TO TRUE                73510000
735200           SET DP013-NO-ROLLBACK           TO TRUE                73520000
735300             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              73530000
735400           PERFORM DP014-0000-PROCESS-ABEND                       73540000
735500     END-EVALUATE.                                                73550000
735600                                                                  73560000
735700                                                                  73570000
735800                                                                  73580000
735900 7100-CHECK-AUDIT-CRTN.                                           73590000
736000                                                                  73600000
736100     MOVE ZEROES          TO PV-DB2-COUNT-AUDIT.                  73610000
736200                                                                  73620000
736300     EXEC SQL                                                     73630000
736400        SELECT COUNT(*)                                           73640000
736500          INTO :PV-DB2-COUNT-AUDIT                                73650000
736600          FROM SUT_PO_AUD_REQ A                                   73660000
736700             , TSUATRN B                                          73670000
736800         WHERE A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                73680000
736900           AND B.SHIPT_UNT_ID     = :LBPTDA-SHIPT-UNT-ID          73690000
737000         WITH UR                                                  73700000
737100     END-EXEC.                                                    73710000
737200                                                                  73720000
737300                                                                  73730000
737400     EVALUATE TRUE                                                73740000
737500         WHEN SQLCODE = ZERO                                      73750000
737600           IF PV-DB2-COUNT-AUDIT > 0                              73760000
737700              SET PS-AUDIT-CRTN-FOUND-YES TO TRUE                 73770000
737800           ELSE                                                   73780000
737900              SET PS-AUDIT-CRTN-FOUND-NO  TO TRUE                 73790000
738000           END-IF                                                 73800000
738100         WHEN SQLWARN0 NOT = SPACES                               73810000
738200         WHEN SQLCODE NOT EQUAL ZERO                              73820000
738300             MOVE ' 7100-CHECK-AUDIT-CRTN '                       73830000
738400                             TO DP013-PARAGRAPH                   73840000
738500             MOVE                                                 73850000
738600                'SUKRF502-SELECT IF PROMPTED AUDIT CARTON'        73860000
738700                             TO DP013-MESSAGE-TEXT(1)             73870000
738800             MOVE SU001-MANIFEST                                  73880000
738900                             TO DP013-MESSAGE-TEXT(2)             73890000
739000             MOVE SU001-USER-ID                                   73900000
739100                             TO DP013-MESSAGE-TEXT(3)             73910000
739200             MOVE SQLCA      TO DP013-SQLCA                       73920000
739300             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           73930000
739400             SET DP013-DB2-ABEND                                  73940000
739500                             TO TRUE                              73950000
739600             SET DP013-NO-ROLLBACK                                73960000
739700                             TO TRUE                              73970000
739800             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              73980000
739900             PERFORM DP014-0000-PROCESS-ABEND                     73990000
740000     END-EVALUATE.                                                74000000
740100*----------------------------------------------------------------*74010000
740200*                                                                *74020000
740300*----------------------------------------------------------------*74030000
740400 8000-SEND-MAP.                                                   74040000
740500                                                                  74050000
740600     EXEC CICS                                                    74060000
740700         SEND MAP       ('SU527A')                                74070000
740800              MAPSET    ('SUKM527')                               74080000
740900              ERASE                                               74090000
741000              RESP      (PV-CICS-RESPONSE)                        74100000
741100     END-EXEC.                                                    74110000
741200                                                                  74120000
741300     EVALUATE TRUE                                                74130000
741400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 74140000
741500              CONTINUE                                            74150000
741600         WHEN OTHER                                               74160000
741700              MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH           74170000
741800              MOVE 'UNABLE TO SEND MAP'                           74180000
741900                                     TO DP013-MESSAGE-TEXT (1)    74190000
742000              SET DP013-CICS-ABEND   TO TRUE                      74200000
742100              SET DP013-NO-ROLLBACK  TO TRUE                      74210000
742200              PERFORM 9999-WRITE-CICS-LOG-MSG                     74220000
742300     END-EVALUATE.                                                74230000
742400                                                                  74240000
742500                                                                  74250000
742600*----------------------------------------------------------------*74260000
742700*                                                                *74270000
742800*----------------------------------------------------------------*74280000
742900 8100-SEND-DATA-ONLY.                                             74290000
743000                                                                  74300000
743100     EXEC CICS                                                    74310000
743200         SEND MAP       ('SU527A')                                74320000
743300              MAPSET    ('SUKM527')                               74330000
743400              CURSOR                                              74340000
743500              DATAONLY                                            74350000
743600              RESP      (PV-CICS-RESPONSE)                        74360000
743700     END-EXEC.                                                    74370000
743800                                                                  74380000
743900     EVALUATE TRUE                                                74390000
744000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 74400000
744100              CONTINUE                                            74410000
744200         WHEN OTHER                                               74420000
744300              MOVE '8100-SEND-DATA-ONLY'                          74430000
744400                                     TO DP013-PARAGRAPH           74440000
744500              MOVE 'UNABLE TO SEND DATA'                          74450000
744600                                     TO DP013-MESSAGE-TEXT (1)    74460000
744700              SET DP013-CICS-ABEND   TO TRUE                      74470000
744800              SET DP013-NO-ROLLBACK  TO TRUE                      74480000
744900              PERFORM 9999-WRITE-CICS-LOG-MSG                     74490000
745000     END-EVALUATE.                                                74500000
745100                                                                  74510000
745200                                                                  74520000
745300*----------------------------------------------------------------*74530000
745400*                                                                *74540000
745500*----------------------------------------------------------------*74550000
745600 8200-RETURN-TRANID.                                              74560000
745700                                                                  74570000
745800*LMM                                                              74580000
745900     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           74590000
746000     EXEC CICS                                                    74600000
746100         RETURN TRANSID   (PC-SU-PRT-DISPLAY)                     74610000
746200                COMMAREA  (CA-COMMAREA)                           74620000
746300                LENGTH    (PV-COMMAREA-LENGTH)                    74630000
746400                RESP      (PV-CICS-RESPONSE)                      74640000
746500     END-EXEC.                                                    74650000
746600                                                                  74660000
746700     EVALUATE TRUE                                                74670000
746800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 74680000
746900              CONTINUE                                            74690000
747000         WHEN OTHER                                               74700000
747100              MOVE '8200-RETURN-TRANID'                           74710000
747200                                     TO DP013-PARAGRAPH           74720000
747300              MOVE 'UNABLE TO RETURN TO TRANID'                   74730000
747400                                     TO DP013-MESSAGE-TEXT (1)    74740000
747500              SET DP013-CICS-ABEND   TO TRUE                      74750000
747600              SET DP013-NO-ROLLBACK  TO TRUE                      74760000
747700              PERFORM 9999-WRITE-CICS-LOG-MSG                     74770000
747800     END-EVALUATE.                                                74780000
747900                                                                  74790000
748000                                                                  74800000
748100 9100-SYNCPOINT.                                                  74810000
748200                                                                  74820000
748300     EXEC CICS                                                    74830000
748400         SYNCPOINT                                                74840000
748500     END-EXEC.                                                    74850000
748600                                                                  74860000
748700                                                                  74870000
748800 9200-SYNCPOINT-ROLLBACK.                                         74880000
748900                                                                  74890000
749000     EXEC CICS                                                    74900000
749100         SYNCPOINT ROLLBACK                                       74910000
749200     END-EXEC.                                                    74920000
749300                                                                  74930000
749400                                                                  74940000
749500*----------------------------------------------------------------*74950000
749600*                                                                *74960000
749700*----------------------------------------------------------------*74970000
749800 9990-WRITE-CICS.                                                 74980000
749900     MOVE LENGTH OF PV-CICS-MSG-AREA  TO  PV-COMMAREA-LENGTH.     74990000
750000                                                                  75000000
750100     EXEC CICS WRITEQ TD                                          75010000
750200                      QUEUE('CSSL')                               75020000
750300                      FROM(PV-CICS-MSG-AREA)                      75030000
750400                      LENGTH(PV-COMMAREA-LENGTH)                  75040000
750500                      RESP (PV-CICS-RESPONSE)                     75050000
750600     END-EXEC.                                                    75060000
750700                                                                  75070000
750800     MOVE SPACES TO PV-CICS-MSG-AREA.                             75080000
750900                                                                  75090000
751000                                                                  75100000
751100*----------------------------------------------------------------*75110000
751200*                                                                *75120000
751300*----------------------------------------------------------------*75130000
751400 9999-WRITE-CICS-LOG-MSG.                                         75140000
751500     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            75150000
751600     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           75160000
751700     INITIALIZE DP013-SRC-TASK-NUMBER                             75170000
751800                DP013-STACK.                                      75180000
751900                                                                  75190000
752000     EXEC CICS                                                    75200000
752100         LINK                                                     75210000
752200             PROGRAM   (DP013-NAME)                               75220000
752300             COMMAREA  (DP013-PARAMETERS)                         75230000
752400             LENGTH    (DP013-LENGTH)                             75240000
752500     END-EXEC.                                                    75250000
752600                                                                  75260000
752700                                                                  75270000
752800*----------------------------------------------------------------*75280000
752900*    ABEND PROCESSOR MODULE                                      *75290000
753000*----------------------------------------------------------------*75300000
753100                                                                  75310000
753200     COPY DPPD014.                                                75320000
753300                                                                  75330000
