000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             RCKUT102.                                00020000
000300 AUTHOR.                 BUDDY BARNES.                            00030000
000400 DATE-WRITTEN.           OCT 1998.                                00040000
000500 DATE-COMPILED.                                                   00050000
001100*----------------------------------------------------------------*00060002
001200* THIS PROGRAM WRITES THE EXTENDED STORE RECORD WITH A 'M'       *00070002
001300* IN RC043-MTD-CDE TO INDICATE THAT IT HAS PROCESSED FOR THE     *00080002
001300* CURRENT WEEK.                                                  *00090002
001320*----------------------------------------------------------------*00100002
001600******************************************************************00110000
001700**               P R O G R A M    C H A N G E S                  *00120000
001800******************************************************************00130000
001900** DATE   |      CHANGES                             | REFERENCE *00140000
002000**---------------------------------------------------------------*00150000
002100** 11/98  | ORIGINAL VERSION                         |           *00160002
002300**---------------------------------------------------------------*00170000
005000******************************************************************00180000
005100 ENVIRONMENT DIVISION.                                            00190000
005200 CONFIGURATION SECTION.                                           00200000
005300 OBJECT-COMPUTER.            IBM-370.                             00210000
005400 SOURCE-COMPUTER.            IBM-370.                             00220000
005500 INPUT-OUTPUT SECTION.                                            00230000
005600 FILE-CONTROL.                                                    00240000
005700 SKIP1                                                            00250000
005800     SELECT STORE-EXTRACT-IN     ASSIGN TO INP01.                 00260003
005900     SELECT STORE-EXTRACT-OUT    ASSIGN TO OUT01.                 00270003
006000 EJECT                                                            00280000
006100 DATA DIVISION.                                                   00290000
006200 FILE SECTION.                                                    00300000
006300 SKIP3                                                            00310000
006400 FD  STORE-EXTRACT-IN                                             00320000
006500     RECORDING MODE IS F                                          00330000
006600     RECORD CONTAINS 550 CHARACTERS                               00340000
006700     BLOCK CONTAINS  0 RECORDS                                    00350000
006800     LABEL RECORDS ARE STANDARD.                                  00360000
006900 SKIP1                                                            00370000
007000 01  STORE-EXTRACT-REC-IN        PIC X(550).                      00380000
007100 SKIP3                                                            00390000
006400 FD  STORE-EXTRACT-OUT                                            00400000
006500     RECORDING MODE IS F                                          00410000
006600     RECORD CONTAINS 550 CHARACTERS                               00420000
006700     BLOCK CONTAINS  0 RECORDS                                    00430000
006800     LABEL RECORDS ARE STANDARD.                                  00440000
006900 SKIP1                                                            00450000
007000 01  STORE-EXTRACT-REC-OUT       PIC X(550).                      00460000
007100 SKIP3                                                            00470000
008000 EJECT                                                            00480000
008100 WORKING-STORAGE SECTION.                                         00490000
008200                                                                  00500000
008300 01  PROGRAM-SWITCHES.                                            00510000
008400     05  PS-EOF-SW               PIC X(01) VALUE 'N'.             00520000
008500         88  PS-EOF              VALUE 'Y'.                       00530000
                                                                        00540000
009500 77  WS-RECS-IN                  PIC  9(9)           VALUE 0.     00550001
009500 77  WS-RECS-OUT                 PIC  9(9)           VALUE 0.     00560001
021200*********************** STORE WORK RECORD IN ******************** 00570000
021400     COPY RCRD043.                                                00580000
021500                                                                  00590000
0348   PROCEDURE DIVISION.                                              00600000
034900 0000-OPEN-FILES.                                                 00610000
035000     OPEN INPUT  STORE-EXTRACT-IN                                 00620000
035000          OUTPUT STORE-EXTRACT-OUT.                               00630000
035200                                                                  00640000
036400     PERFORM UNTIL PS-EOF                                         00650000
036500         PERFORM 0200-READ-STORE-EXTRACT THRU 0200-EXIT           00660000
036600         IF PS-EOF                                                00670000
036700             CONTINUE                                             00680000
036800         ELSE                                                     00690000
036900             CONTINUE                                             00700000
037000         END-IF                                                   00710000
037100     END-PERFORM.                                                 00720000
                                                                        00730000
037200     CLOSE STORE-EXTRACT-IN                                       00740000
035000           STORE-EXTRACT-OUT.                                     00750000
           DISPLAY '*** NUMBER OF INPUT RECS = ' WS-RECS-IN ' ***'.     00760000
           DISPLAY '*** NUMBER OF OUTPUT RECS = ' WS-RECS-OUT ' ***'.   00770000
037600     GOBACK.                                                      00780000
                                                                        00790000
037700 0200-READ-STORE-EXTRACT.                                         00800000
037800     READ STORE-EXTRACT-IN INTO RC043-EXP-STORE-EXTRACT-RECORD    00810000
037900         AT END                                                   00820000
038000             SET PS-EOF TO TRUE.                                  00830000
                                                                        00840000
038100     IF PS-EOF                                                    00850000
038200         CONTINUE                                                 00860000
038300     ELSE                                                         00870000
038400         ADD +1 TO WS-RECS-IN                                     00880000
038600         MOVE 'M'                        TO RC043-MTD-CDE         00890000
037800         WRITE STORE-EXTRACT-REC-OUT FROM                         00900000
037800                                RC043-EXP-STORE-EXTRACT-RECORD    00910000
038400         ADD +1 TO WS-RECS-OUT                                    00920000
040000     END-IF.                                                      00930000
036824 0200-EXIT. EXIT.                                                 00940000
