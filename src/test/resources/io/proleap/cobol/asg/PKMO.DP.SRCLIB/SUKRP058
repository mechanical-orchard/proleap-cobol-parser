000100***************************************************************** 00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300***************************************************************** 00030004
000400*                                                                 00040004
000500 PROGRAM-ID.             SUKRP058.                                00050004
000600 AUTHOR.                 CLARK SCHWENN.                           00060004
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070004
000800 DATE-WRITTEN.           NOVEMBER 2008.                           00080004
000900 DATE-COMPILED.                                                   00090004
001000*                                                                 00100004
001100***************************************************************** 00110004
001200*  THIS PROGRAM WILL TAKE THE OUTPUT FILE FROM SUKUT131 AFTER IT  00120004
001300*  HAS BEEN SORTED AND USE IT TO CREATE THE DUAL FEED PRINT AND   00130004
001400*  APPLY TRAILER/CARTON RELATIONSHIP DURING UNLOAD REPORT.        00140004
001500***************************************************************** 00150004
001600 ENVIRONMENT DIVISION.                                            00160004
001700***************************************************************** 00170004
001800 CONFIGURATION SECTION.                                           00180004
001900 SOURCE-COMPUTER.                        IBM-3090.                00190004
002000 OBJECT-COMPUTER.                        IBM-3090.                00200004
002100 INPUT-OUTPUT SECTION.                                            00210004
002200 FILE-CONTROL.                                                    00220004
002300                                                                  00230004
002400     SELECT EXTRACT-FILE                                          00240004
002500         ASSIGN TO INP01.                                         00250004
002600                                                                  00260004
002700     SELECT REPORT-FILE-1                                         00270004
002800         ASSIGN TO RPT01.                                         00280004
002900/                                                                 00290004
003000***************************************************************** 00300004
003100 DATA DIVISION.                                                   00310004
003200***************************************************************** 00320004
003300 FILE SECTION.                                                    00330004
003400                                                                  00340004
003500 FD  EXTRACT-FILE                                                 00350004
003600     RECORDING MODE IS F                                          00360004
003700     LABEL RECORDS ARE STANDARD                                   00370004
003800     BLOCK CONTAINS 0 RECORDS.                                    00380004
003900 01  EXTRACT-RECORD                   PIC X(137).                 00390004
004000                                                                  00400004
004100 FD  REPORT-FILE-1                                                00410004
004200     RECORDING MODE IS F                                          00420004
004300     BLOCK CONTAINS 0 RECORDS.                                    00430004
004400 01  REPORT-RECORD-1                  PIC X(132).                 00440004
004500                                                                  00450004
004600/                                                                 00460004
004700***************************************************************** 00470004
004800 WORKING-STORAGE SECTION.                                         00480004
004900***************************************************************** 00490004
005000                                                                  00500004
005010 01  AC-ABEND-CODE                    PIC S9(04) VALUE +4008.     00501011
005020                                                                  00502012
005030 01  PS-SWITCHES.                                                 00503012
005040     05  PS-PRINT-DETAILS-SW          PIC X(01) VALUE 'N'.        00504012
005050         88  PS-PRINT-DETAILS-NO                VALUE 'Y'.        00505012
005060         88  PS-PRINT-DETAILS                   VALUE 'N'.        00506012
005070     05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00507012
005080         88  PS-END-OF-INPUT                    VALUE 'Y'.        00508012
005090         88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00509012
005100     05  PS-PAGE-SW                   PIC X(01) VALUE 'N'.        00510012
005200         88  PS-NEW-PAGE                        VALUE 'Y'.        00520012
005300         88  PS-SAME-PAGE                       VALUE 'N'.        00530012
005400                                                                  00540012
005500 01  SD-SYSTEM-DATE.                                              00550012
005600     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00560012
005700     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00570012
005800     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00580012
005900                                                                  00590012
006000 01  ST-SYSTEM-TIME.                                              00600012
006100     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00610012
006200     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00620012
006300     05  FILLER                     PIC  9(04)   VALUE ZERO.      00630012
006400                                                                  00640012
006500 01  PV-VARIABLES.                                                00650012
006600     05  PV-READ-COUNT                PIC S9(7) COMP-3            00660012
006700                                                VALUE ZERO.       00670012
006800     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00680012
006900                                                VALUE ZERO.       00690012
007000     05  PV-PAGE-COUNT                PIC S9(3) COMP-3            00700012
007100                                                VALUE ZERO.       00710012
007200     05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO.      00720012
007300                                                                  00730012
007400     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            00740012
007500     05  PV-PREV-OPER                 PIC X(04) VALUE ZERO.       00750012
007600                                                                  00760012
007700     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     00770012
007800                                                                  00780012
007900     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     00790012
008000     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     00800012
008100                                                                  00810012
008200     05  PV-LOCATION-TOTALS.                                      00820012
008300         10  PV-TOT-CARTONS-LOC       PIC S9(07)  VALUE ZERO.     00830012
008400                                                                  00840012
008500     05  PV-TOT-FIRST-TRAILER-DC      PIC S9(07)  VALUE ZERO.     00850012
008600     05  PV-TOT-VNDR-DC               PIC S9(07)  VALUE ZERO.     00860012
008700     05  PV-TOT-PO-DC                 PIC S9(07)  VALUE ZERO.     00870012
008800     05  PV-TOT-PO-ALL                PIC S9(07)  VALUE ZERO.     00880012
008900                                                                  00890012
009000     05  PV-SHIPT-UNT-ID             PIC S9(18)V   VALUE ZEROS    00900012
009100                                                   COMP-3.        00910012
009200     05  PV-INBD-TRIP-ID             PIC 9(09)     VALUE ZEROS    00920012
009300                                                   COMP.          00930012
009400     05  PV-DETAIL-VERFY-DTE.                                     00940012
009500         10 PV-DETAIL-VERFY-CC       PIC X(02)     VALUE SPACES.  00950012
009600         10 PV-DETAIL-VERFY-YY       PIC X(02)     VALUE SPACES.  00960012
009700         10 PV-DETAIL-VERFY-MM       PIC X(02)     VALUE SPACES.  00970012
009800         10 PV-DETAIL-VERFY-DD       PIC X(02)     VALUE SPACES.  00980012
009900                                                                  00990012
010000 01  PV-VERY-FIELD.                                               01000012
010100     05  PV-VERY-DATE.                                            01010012
010200         10 PV-VERY-DATE-MM              PIC  X(02) VALUE SPACES. 01020012
010300         10 PV-VERY-DATE-DD              PIC  X(02) VALUE SPACES. 01030012
010400         10 PV-VERY-DATE-YY              PIC  X(02) VALUE SPACES. 01040012
010500******************************************************************01050012
010600 01  PV-DATE-FIELD.                                               01060012
010700     05  PV-FROM-DATE.                                            01070012
010800         10 PV-FROM-DATE-MM              PIC  X(02) VALUE SPACES. 01080012
010900         10 PV-FROM-DATE-DD              PIC  X(02) VALUE SPACES. 01090012
011000         10 PV-FROM-DATE-YY              PIC  X(02) VALUE SPACES. 01100012
011100                                                                  01110012
011200     05  PV-TO-DATE.                                              01120012
011300         10 PV-TO-DATE-MM                PIC  X(02) VALUE SPACES. 01130012
011400         10 PV-TO-DATE-DD                PIC  X(02) VALUE SPACES. 01140012
011500         10 PV-TO-DATE-YY                PIC  X(02) VALUE SPACES. 01150012
011600                                                                  01160012
011700     05  PV-FORMAT-DATE.                                          01170012
011800         10 PV-FORMAT-DATE-MM         PIC  9(02).                 01180012
011900         10 FILLER                    PIC  X(01) VALUE '/'.       01190012
012000         10 PV-FORMAT-DATE-DD         PIC  9(02).                 01200012
012100         10 FILLER                    PIC  X(01) VALUE '/'.       01210012
012200         10 PV-FORMAT-DATE-YY         PIC  9(02).                 01220012
012300/                                                                 01230012
012400 01  PC-CONSTANTS.                                                01240012
012500     05  PC-CURRENT-PROGRAM-NAME PIC X(08) VALUE 'SUKRP058'.      01250012
012600     05  PC-END-OF-PAGE          PIC S9(3) COMP-3 VALUE +60.      01260012
012700     05  PC-MAX-LINE-COUNT       PIC S9(3) VALUE +60              01270012
012800                                                COMP-3.           01280012
012900     05  PC-DAILY                PIC X(01)     VALUE 'D'.         01290012
013000     05  PC-DAILY-WORD           PIC X(07)     VALUE '  DAILY'.   01300012
013100     05  PC-WEEKLY               PIC X(01)     VALUE 'W'.         01310012
013200     05  PC-WEEKLY-WORD          PIC X(07)     VALUE ' WEEKLY'.   01320012
013300     05  PC-MONTHLY              PIC X(01)     VALUE 'M'.         01330012
013400     05  PC-MONTHLY-WORD         PIC X(07)     VALUE 'MONTHLY'.   01340012
013500     05  PC-HEADING              PIC X(01)     VALUE '1'.         01350012
013600     05  PC-DETAIL               PIC X(01)     VALUE '2'.         01360012
013700     05  PC-CART-MTCH-FIRST-TRLR PIC X(01)     VALUE '1'.         01370012
013800     05  PC-CART-MTCH-VNDR       PIC X(01)     VALUE '2'.         01380012
013900     05  PC-CART-MTCH-PO         PIC X(01)     VALUE '3'.         01390012
014000     05  PC-CART-MTCH-ALL        PIC X(01)     VALUE '4'.         01400012
014100     05  PC-CART-MATCH-FIRST-TRLR PIC X(01)     VALUE 'T'.        01410012
014200     05  PC-CART-MATCH-VNDR       PIC X(01)     VALUE 'V'.        01420012
014300     05  PC-CART-MATCH-PO         PIC X(01)     VALUE 'P'.        01430012
014400     05  PC-CART-MATCH-ALL        PIC X(01)     VALUE 'A'.        01440012
014500/                                                                 01450012
014600******************************************************************01460012
014700*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01470012
014800******************************************************************01480012
014900     COPY DPWS132O.                                               01490012
015000*                                                                 01500012
015100 01  HL-HEADING-LINE-1.                                           01510012
015200     05  FILLER                      PIC  X(44)  VALUE SPACES.    01520012
015300     05  HL-HDG-LINE-1-RPT-TYPE      PIC  X(07)  VALUE SPACES.    01530012
015400     05  FILLER                      PIC  X(51)  VALUE            01540012
015500      '-DUAL FEED TRLR/CARTON UNLOAD RELATIONSHIP'.               01550012
015600     05  FILLER                      PIC  X(30)  VALUE SPACES.    01560012
015700                                                                  01570012
015800 01  HL-HEADING-LINE-2.                                           01580012
015900     05  FILLER                      PIC  X(41)  VALUE            01590012
016000      'MATCH CODE T=1ST TRLR V=VENDOR P=PO A=ALL'.                01600012
016100     05  FILLER                      PIC  X(18)  VALUE SPACES.    01610012
016200     05  HL-HDG-LINE-2-DAILY-DATE    PIC  X(08)  VALUE SPACES.    01620012
016300     05  FILLER                      PIC  X(65)  VALUE SPACES.    01630012
016400                                                                  01640012
016500 01  HL-HEADING-LINE-3.                                           01650012
016600     05  FILLER                      PIC  X(41)  VALUE            01660012
016700      'MATCH CODE T=1ST TRLR V=VENDOR P=PO A=ALL'.                01670012
016800*    05  FILLER                      PIC  X(31)  VALUE SPACES.    01680012
016900     05  FILLER                      PIC  X(10)  VALUE SPACES.    01690012
017000     05  FILLER                      PIC  X(05)  VALUE            01700012
017100      'FROM '.                                                    01710012
017200*    05  FILLER                      PIC  X(07)  VALUE            01720012
017210*     '( FROM '.                                                  01721012
017220     05  HL-HDG-LINE-3-FROM-DATE     PIC  X(08)  VALUE SPACES.    01722012
017230     05  FILLER                      PIC  X(04)  VALUE            01723012
017240      ' TO '.                                                     01724012
017250     05  HL-HDG-LINE-3-TO-DATE       PIC  X(08)  VALUE SPACES.    01725012
017260     05  FILLER                      PIC  X(25)  VALUE SPACES.    01726012
017270*    05  FILLER                      PIC  X(02)  VALUE SPACES.    01727012
017280*    05  FILLER                      PIC  X(23)  VALUE            01728012
017290*     'WHEN WEEKLY OR MONTHLY)'.                                  01729012
017300     05  FILLER                      PIC  X(31)  VALUE SPACES.    01730012
017400                                                                  01740012
017500 01  HL-HEADING-LINE-4.                                           01750012
017600     05  FILLER                      PIC  X(01)  VALUE SPACES.    01760012
017700     05  FILLER                      PIC  X(45)  VALUE            01770012
017800      'DC  M  PO NBR   RCVR LINE TYP VE DTE  DPT PNA'.            01780012
017900     05  FILLER                      PIC  X(05)  VALUE SPACES.    01790012
018000     05  FILLER                      PIC  X(43)  VALUE            01800012
018100      'CARTON ID       ASSIGNED-TRAILER  TRIP ID  '.              01810012
018200     05  FILLER                      PIC  X(33)  VALUE            01820012
018300      'ALTERNATE-TRLR  TRIP ID  VENDOR  '.                        01830012
018400     05  FILLER                      PIC  X(05)  VALUE SPACES.    01840012
018500                                                                  01850012
018600                                                                  01860012
018700 01  DL-DETAIL-LINE-1.                                            01870012
018800        05  DL1-DC                       PIC Z(04) VALUE SPACES.  01880012
018900        05  FILLER                       PIC X(01) VALUE SPACES.  01890012
019000        05  DL1-MATCH-CDE                PIC X(01) VALUE SPACES.  01900012
019100        05  FILLER                       PIC X(01) VALUE SPACES.  01910012
019200        05  DL1-PO-NBR                   PIC Z(09) VALUE SPACES.  01920012
019300        05  FILLER                       PIC X(01) VALUE SPACES.  01930012
019400        05  DL1-REC-SEQ-NBR              PIC ZZZ9.                01940012
019500        05  FILLER                       PIC X(01) VALUE SPACES.  01950012
019600        05  DL1-LINE                     PIC X(04).               01960012
019700        05  FILLER                       PIC X(02) VALUE SPACES.  01970012
019800        05  DL1-LINE-TYPE                PIC X(01).               01980012
019900        05  FILLER                       PIC X(02) VALUE SPACES.  01990012
020000        05  DL1-VEFYD-DATE               PIC X(06).               02000012
020100        05  FILLER                       PIC X(02) VALUE SPACES.  02010012
020200        05  DL1-DEPT                     PIC Z(03).               02020012
020300        05  FILLER                       PIC X(01) VALUE SPACES.  02030012
020400        05  DL1-PNA                      PIC Z(04).               02040012
020500        05  FILLER                       PIC X(01) VALUE SPACES.  02050012
020600        05  DL1-CARTON-ID                PIC X(18).               02060012
020700        05  FILLER                       PIC X(01) VALUE SPACES.  02070012
020800        05  DL1-CARR-SCAC                PIC X(04).               02080012
020900        05  FILLER                       PIC X(01) VALUE SPACES.  02090012
021000        05  DL1-VEH-NUMBER               PIC X(10).               02100012
021100        05  FILLER                       PIC X(01) VALUE SPACES.  02110012
021200        05  DL1-TRIP-ID                  PIC Z(09).               02120012
021300        05  FILLER                       PIC X(02) VALUE SPACES.  02130012
021400        05  DL1-ALT-CARR-SCAC            PIC X(04).               02140012
021500        05  FILLER                       PIC X(01) VALUE SPACES.  02150012
021600        05  DL1-ALT-VEH-NUMBER           PIC X(10).               02160012
021700        05  DL1-ALT-TRIP-ID              PIC Z(09).               02170012
021800        05  FILLER                       PIC X(01) VALUE SPACES.  02180012
021900        05  DL1-VENDOR-SHRT-NAME         PIC X(10).               02190012
022000        05  FILLER                       PIC X(03) VALUE SPACES.  02200012
022100                                                                  02210012
022200 01  TL-DC-CRTN-TOTAL-LINE.                                       02220012
022300     05  FILLER                       PIC X(01) VALUE SPACES.     02230012
022400     05  FILLER                       PIC X(19) VALUE             02240012
022500            'TOTAL DC CARTONS = '.                                02250012
022600     05  TL-DC-CRTN-TOTALS            PIC ZZZ,ZZ9.                02260012
022700     05  FILLER                       PIC X(04) VALUE SPACES.     02270012
022800     05  FILLER                       PIC X(41) VALUE             02280012
022900            'TOTAL MATCH CODE CARTONS - 1ST TRAILER = '.          02290012
023000     05  TL-FIRST-CRTN-TOTALS         PIC ZZZ,ZZ9.                02300012
023100     05  FILLER                       PIC X(04) VALUE SPACES.     02310012
023200     05  FILLER                       PIC X(09) VALUE             02320012
023300            'VENDOR = '.                                          02330012
023400     05  TL-VENDOR-CRTN-TOTALS        PIC ZZZ,ZZ9.                02340012
023500     05  FILLER                       PIC X(04) VALUE SPACES.     02350012
023600     05  FILLER                       PIC X(05) VALUE             02360012
023700            'PO = '.                                              02370012
023800     05  TL-PO-CRTN-TOTALS            PIC ZZZ,ZZ9.                02380012
023900     05  FILLER                       PIC X(01)  VALUE SPACES.    02390012
024000     05  FILLER                       PIC X(06) VALUE             02400012
024100            'ALL = '.                                             02410012
024200     05  TL-ALL-CRTN-TOTALS           PIC ZZZ,ZZ9.                02420012
024300     05  FILLER                       PIC X(03)  VALUE SPACES.    02430012
024400                                                                  02440012
024500                                                                  02450012
024600 01  ER-END-OF-REPORT-LINE.                                       02460012
024700     05  FILLER                       PIC X(19)  VALUE            02470012
024800         '** END OF REPORT **'.                                   02480012
024900     05  FILLER                       PIC X(113)  VALUE SPACES.   02490012
025000                                                                  02500012
025100 01  EP-EMPTY-REPORT-LINE.                                        02510012
025200     05  FILLER                       PIC X(34)  VALUE SPACES.    02520012
025300     05  FILLER                       PIC X(52)  VALUE            02530012
025400      '*************** EMPTY INPUT FILE *******************'.     02540012
025500     05  FILLER                       PIC X(46)  VALUE SPACES.    02550012
025600                                                                  02560012
025700 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    02570012
025800                                                                  02580012
025900/                                                                 02590012
026000******************************************************************02600012
026100*  RECORD LAYOUT FOR INPUT FILE                                   02610012
026200******************************************************************02620012
026300     COPY SURD087.                                                02630012
026400/                                                                 02640012
026500******************************************************************02650012
026600 PROCEDURE DIVISION.                                              02660012
026700******************************************************************02670012
026800 0000-MAINLINE.                                                   02680012
026900                                                                  02690012
027000     OPEN INPUT  EXTRACT-FILE.                                    02700012
027100                                                                  02710012
027200     PERFORM 2100-READ-EXTRACT.                                   02720012
027300                                                                  02730012
027400     IF PS-END-OF-INPUT                                           02740012
027500         DISPLAY '** PROGRAM = SUKRP058 **********'               02750012
027600         DISPLAY '** PARAGRAPH = 0000-MAINLINE ***'               02760012
027700         DISPLAY '** NO HEADING OR DETAIL RECORDS*'               02770012
027800         DISPLAY '** ON TRAILER/CARTON INPUT DATA*'               02780012
027900         PERFORM 1300-NO-DETAIL-LINE                              02790012
028000     ELSE                                                         02800012
028100         OPEN OUTPUT REPORT-FILE-1                                02810012
028200         PERFORM 1000-INITIALIZE                                  02820012
028300         PERFORM 8000-WRITE-MAIN-HEADINGS                         02830012
028400         IF SU087-REPORT-RECORD-TYPE = PC-HEADING                 02840012
028500             PERFORM 2100-READ-EXTRACT                            02850012
028600             MOVE SU087-OPER-UNT-ID  TO PV-PREV-OPER              02860012
028700             PERFORM 2000-PROCESS-EXTRACT                         02870012
028800                 UNTIL PS-END-OF-INPUT                            02880012
028900             PERFORM 6000-LOCATION-TOTALS                         02890012
029000         END-IF                                                   02900012
029100     END-IF.                                                      02910012
029200                                                                  02920012
029300     PERFORM 9000-EOJ.                                            02930012
029400                                                                  02940012
029500     GOBACK.                                                      02950012
029600/                                                                 02960012
029700******************************************************************02970012
029800 1000-INITIALIZE.                                                 02980012
029900******************************************************************02990012
030000*                                                                 03000012
030100* LOAD SYSTEM DATE INTO HEADINGS                                  03010012
030200     ACCEPT SD-SYSTEM-DATE FROM DATE.                             03020012
030300     ACCEPT ST-SYSTEM-TIME FROM TIME.                             03030012
030400                                                                  03040012
030500     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              03050012
030600     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             03060012
030700     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               03070012
030800     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              03080012
030900     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            03090012
031000                                                                  03100012
031100     MOVE PC-CURRENT-PROGRAM-NAME                                 03110012
031200                                 TO DP132O-PROGRAM-NAME.          03120012
031300     MOVE 1                      TO DP132O-REPORT-NUMBER          03130012
031400                                    DP132O-PAGE-NUMBER.           03140012
031500                                                                  03150012
031600                                                                  03160012
032400     INITIALIZE  PV-FORMAT-DATE                                   03240004
032500                 PV-FROM-DATE                                     03250004
032600                 PV-TO-DATE.                                      03260004
032700                                                                  03270004
032800     IF SU087-REPORT-RECORD-TYPE = PC-HEADING                     03280004
032900        IF SU087-RPT-TYP-CDE        = PC-DAILY                    03290004
033000            MOVE PC-DAILY-WORD         TO HL-HDG-LINE-1-RPT-TYPE  03300004
033100            MOVE SU087-FROM-MATCH-DATE TO PV-FROM-DATE            03310004
033200            MOVE PV-FROM-DATE-MM       TO PV-FORMAT-DATE-MM       03320004
033300            MOVE PV-FROM-DATE-DD       TO PV-FORMAT-DATE-DD       03330004
033400            MOVE PV-FROM-DATE-YY       TO PV-FORMAT-DATE-YY       03340004
033500            MOVE PV-FORMAT-DATE        TO                         03350004
033600                                         HL-HDG-LINE-2-DAILY-DATE 03360004
033700        ELSE                                                      03370004
033800           IF SU087-RPT-TYP-CDE     = PC-WEEKLY                   03380004
033900                MOVE PC-WEEKLY-WORD TO HL-HDG-LINE-1-RPT-TYPE     03390004
034000                MOVE SU087-FROM-MATCH-DATE TO PV-FROM-DATE        03400004
034100                MOVE PV-FROM-DATE-MM       TO PV-FORMAT-DATE-MM   03410004
034200                MOVE PV-FROM-DATE-DD       TO PV-FORMAT-DATE-DD   03420004
034300                MOVE PV-FROM-DATE-YY       TO PV-FORMAT-DATE-YY   03430004
034400                MOVE PV-FORMAT-DATE        TO                     03440004
034500                                       HL-HDG-LINE-3-FROM-DATE    03450004
034600                MOVE SU087-TO-MATCH-DATE   TO PV-TO-DATE          03460004
034700                MOVE PV-TO-DATE-MM         TO PV-FORMAT-DATE-MM   03470004
034800                MOVE PV-TO-DATE-DD         TO PV-FORMAT-DATE-DD   03480004
034900                MOVE PV-TO-DATE-YY         TO PV-FORMAT-DATE-YY   03490004
035000                MOVE PV-FORMAT-DATE        TO                     03500004
035100                                       HL-HDG-LINE-3-TO-DATE      03510004
035200           ELSE                                                   03520004
035300               IF SU087-RPT-TYP-CDE     = PC-MONTHLY              03530004
035400                    MOVE PC-MONTHLY-WORD TO HL-HDG-LINE-1-RPT-TYPE03540004
035500                    MOVE SU087-FROM-MATCH-DATE TO PV-FROM-DATE    03550004
035600                    MOVE PV-FROM-DATE-MM       TO                 03560004
035700                                                 PV-FORMAT-DATE-MM03570004
035800                    MOVE PV-FROM-DATE-DD       TO                 03580004
035900                                                 PV-FORMAT-DATE-DD03590004
036000                    MOVE PV-FROM-DATE-YY       TO                 03600004
036100                                                 PV-FORMAT-DATE-YY03610004
036200                    MOVE PV-FORMAT-DATE        TO                 03620004
036300                                       HL-HDG-LINE-3-FROM-DATE    03630004
036400                    MOVE SU087-TO-MATCH-DATE   TO PV-TO-DATE      03640004
036500                    MOVE PV-TO-DATE-MM         TO                 03650004
036600                                                 PV-FORMAT-DATE-MM03660004
036700                    MOVE PV-TO-DATE-DD         TO                 03670004
036800                                                 PV-FORMAT-DATE-DD03680004
036900                    MOVE PV-TO-DATE-YY         TO                 03690004
037000                                                PV-FORMAT-DATE-YY 03700004
037100                    MOVE PV-FORMAT-DATE        TO                 03710004
037200                                       HL-HDG-LINE-3-TO-DATE      03720004
037300               END-IF                                             03730004
037400           END-IF                                                 03740004
037500        END-IF                                                    03750004
037600     END-IF.                                                      03760004
037700******************************************************************03770004
037800*  PRINT A 'NO INPUT' REPORT LINE.                                03780004
037900******************************************************************03790004
038000 1300-NO-DETAIL-LINE.                                             03800004
038100*                                                                 03810004
038200     PERFORM 8000-WRITE-MAIN-HEADINGS.                            03820004
038300                                                                  03830004
038400     WRITE REPORT-RECORD-1                                        03840004
038500       FROM EP-EMPTY-REPORT-LINE                                  03850004
038600         AFTER ADVANCING 3 LINES.                                 03860004
038700*                                                                 03870004
039800******************************************************************03980004
039900 2000-PROCESS-EXTRACT.                                            03990004
040000******************************************************************04000004
040100                                                                  04010004
040200     IF SU087-OPER-UNT-ID  = PV-PREV-OPER                         04020004
040300            PERFORM 5500-PROCESS-REPORT-ROW                       04030004
040400     ELSE                                                         04040004
040500         PERFORM 6000-LOCATION-TOTALS                             04050004
040600         SET PS-NEW-PAGE TO TRUE                                  04060004
040700         PERFORM 8000-WRITE-MAIN-HEADINGS                         04070004
040800         PERFORM 5500-PROCESS-REPORT-ROW                          04080004
040900         MOVE SU087-OPER-UNT-ID     TO PV-PREV-OPER               04090004
041000     END-IF.                                                      04100004
041100                                                                  04110004
041200     PERFORM 2100-READ-EXTRACT.                                   04120004
041300*                                                                 04130004
041400******************************************************************04140004
041500*  READ NEXT INPUT FILE RECORD.                                   04150004
041600******************************************************************04160004
041700 2100-READ-EXTRACT.                                               04170004
041800                                                                  04180004
041900     READ EXTRACT-FILE INTO SU087-REPORT-FILE-DATA                04190004
042000        AT END                                                    04200004
042100           SET PS-END-OF-INPUT TO TRUE                            04210004
042200        NOT AT END                                                04220004
042300           ADD +1                   TO PV-READ-COUNT              04230004
042400     END-READ.                                                    04240004
042500*                                                                 04250004
042600******************************************************************04260004
042700*  PROCESS REPORT ROW                                             04270004
042800******************************************************************04280004
042900 5500-PROCESS-REPORT-ROW.                                         04290004
043000*                                                                 04300004
043100     IF SU087-SHIPT-UNT-ID =  PV-SHIPT-UNT-ID                     04310004
043200         IF SU087-ALT-TRIP-ID NOT EQUAL PV-INBD-TRIP-ID           04320004
043300             MOVE SU087-ALT-CARR-SCAC       TO DL1-ALT-CARR-SCAC  04330004
043400             MOVE SU087-ALT-VEH-NBR         TO DL1-ALT-VEH-NUMBER 04340004
043500             MOVE SU087-ALT-TRIP-ID         TO DL1-ALT-TRIP-ID    04350004
043600             PERFORM 7000-PRINT-DETAILS                           04360004
043700             PERFORM 5600-INTIALIZE-DETAILS                       04370004
043800         ELSE                                                     04380004
043900             PERFORM 5550-BUILD-REPORT-ROW                        04390004
044000         END-IF                                                   04400004
044100     ELSE                                                         04410004
044200         PERFORM 5550-BUILD-REPORT-ROW                            04420004
044300     END-IF.                                                      04430004
044400                                                                  04440004
044500     MOVE SU087-SHIPT-UNT-ID       TO PV-SHIPT-UNT-ID.            04450004
044600     MOVE SU087-ALT-TRIP-ID        TO PV-INBD-TRIP-ID.            04460004
044700*                                                                 04470004
044800******************************************************************04480004
044900*  BUILD REPORT ROW.                                              04490004
045000******************************************************************04500004
045100 5550-BUILD-REPORT-ROW.                                           04510004
045200*                                                                 04520004
045300     MOVE SU087-OPER-UNT-ID         TO DL1-DC.                    04530004
045400     MOVE SU087-CART-MTCH-CDE       TO DL1-MATCH-CDE.             04540004
045500     MOVE SU087-PO-NBR              TO DL1-PO-NBR.                04550004
045600     MOVE SU087-RCVR-SEQ-NBR        TO DL1-REC-SEQ-NBR.           04560004
045610*AME                                                              04561010
045620     IF SU087-LINE-OR-PCK-ID = SPACES                             04562010
045630        MOVE '   0'                 TO DL1-LINE                   04563010
045640     ELSE                                                         04564010
045700        MOVE SU087-LINE-OR-PCK-ID   TO DL1-LINE                   04570010
045710     END-IF.                                                      04571010
045800     MOVE SU087-LINE-PCK-TYP        TO DL1-LINE-TYPE.             04580004
045900     MOVE SU087-VERFYD-DTE          TO PV-DETAIL-VERFY-DTE.       04590004
046000     IF PV-DETAIL-VERFY-CC  = 'NO'                                04600004
046100        MOVE SU087-VERFYD-DTE       TO DL1-VEFYD-DATE             04610004
046200     ELSE                                                         04620004
046300        MOVE PV-DETAIL-VERFY-MM     TO PV-VERY-DATE-MM            04630004
046400        MOVE PV-DETAIL-VERFY-DD     TO PV-VERY-DATE-DD            04640004
046500        MOVE PV-DETAIL-VERFY-YY     TO PV-VERY-DATE-YY            04650004
046600        MOVE PV-VERY-DATE           TO DL1-VEFYD-DATE             04660004
046700     END-IF.                                                      04670004
046800     MOVE SU087-DEPT-NBR            TO DL1-DEPT.                  04680004
046900     MOVE SU087-ACM-LBL-STA-NBR     TO DL1-PNA.                   04690004
047000     MOVE SU087-SHIPT-UNT-ID        TO DL1-CARTON-ID.             04700004
047100     MOVE SU087-CARR-SCAC           TO DL1-CARR-SCAC.             04710004
047200     MOVE SU087-VEH-NBR             TO DL1-VEH-NUMBER.            04720004
047300     MOVE SU087-TRIP-ID             TO DL1-TRIP-ID.               04730004
047400     MOVE SU087-ALT-CARR-SCAC       TO DL1-ALT-CARR-SCAC.         04740004
047500     MOVE SU087-ALT-VEH-NBR         TO DL1-ALT-VEH-NUMBER.        04750004
047600     MOVE SU087-ALT-TRIP-ID         TO DL1-ALT-TRIP-ID.           04760004
047700     MOVE SU087-VNDR-SHRT-NME       TO DL1-VENDOR-SHRT-NAME.      04770004
047710     IF SU087-VNDR-SHRT-NME         = 'NO DLY RPT'                04771011
047720                           OR                                     04772011
047730        SU087-VNDR-SHRT-NME         = 'NO REPORT '                04773011
047740        MOVE 0                      TO PV-TOT-CARTONS-LOC         04774011
047750     ELSE                                                         04775011
047800        ADD 1                       TO PV-TOT-CARTONS-LOC         04780011
047810     END-IF.                                                      04781011
047900                                                                  04790004
048000     IF SU087-CART-MTCH-CDE = PC-CART-MTCH-FIRST-TRLR             04800004
048100         MOVE PC-CART-MATCH-FIRST-TRLR TO DL1-MATCH-CDE           04810004
048200         ADD 1 TO PV-TOT-FIRST-TRAILER-DC                         04820004
048300     END-IF.                                                      04830004
048400     IF SU087-CART-MTCH-CDE = PC-CART-MTCH-VNDR                   04840004
048500         MOVE PC-CART-MATCH-VNDR       TO DL1-MATCH-CDE           04850004
048600         ADD 1 TO PV-TOT-VNDR-DC                                  04860004
048700     END-IF.                                                      04870004
048800     IF SU087-CART-MTCH-CDE = PC-CART-MTCH-PO                     04880004
048900         MOVE PC-CART-MATCH-PO         TO DL1-MATCH-CDE           04890004
049000         ADD 1 TO PV-TOT-PO-DC                                    04900004
049100     END-IF.                                                      04910004
049200     IF SU087-CART-MTCH-CDE = PC-CART-MTCH-ALL                    04920004
049300         MOVE PC-CART-MATCH-ALL        TO DL1-MATCH-CDE           04930004
049400         ADD 1 TO PV-TOT-PO-ALL                                   04940004
049500     END-IF.                                                      04950004
049600                                                                  04960004
049700     PERFORM 7000-PRINT-DETAILS.                                  04970004
049800     PERFORM 5600-INTIALIZE-DETAILS.                              04980004
049900     MOVE SU087-SHIPT-UNT-ID   TO PV-SHIPT-UNT-ID.                04990004
050000     MOVE SU087-ALT-TRIP-ID        TO PV-INBD-TRIP-ID.            05000004
050100*                                                                 05010004
050200******************************************************************05020004
050300*  INITIALIZE REPORT ROW.                                         05030004
050400******************************************************************05040004
050500 5600-INTIALIZE-DETAILS.                                          05050004
050600*                                                                 05060004
050700     INITIALIZE  DL-DETAIL-LINE-1.                                05070004
050800*                                                                 05080004
050900******************************************************************05090004
051000*  WRITE DC CARTON TOTALS.                                        05100004
051100******************************************************************05110004
051200 6000-LOCATION-TOTALS.                                            05120004
051300*                                                                 05130004
051400     MOVE PV-TOT-CARTONS-LOC          TO TL-DC-CRTN-TOTALS.       05140004
051500     MOVE PV-TOT-FIRST-TRAILER-DC     TO TL-FIRST-CRTN-TOTALS.    05150004
051600     MOVE PV-TOT-VNDR-DC              TO TL-VENDOR-CRTN-TOTALS.   05160004
051700     MOVE PV-TOT-PO-DC                TO TL-PO-CRTN-TOTALS.       05170004
051800     MOVE PV-TOT-PO-ALL               TO TL-ALL-CRTN-TOTALS.      05180004
051900                                                                  05190004
052000     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     05200004
052100        AFTER ADVANCING 1 LINES.                                  05210004
052200                                                                  05220004
052300     WRITE REPORT-RECORD-1 FROM TL-DC-CRTN-TOTAL-LINE             05230004
052400         AFTER ADVANCING 2 LINES.                                 05240004
052500                                                                  05250004
052600     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     05260004
052700        AFTER ADVANCING 1 LINES.                                  05270004
052800                                                                  05280004
052900     ADD 4                            TO PV-LINE-COUNT.           05290004
053000*                                                                 05300004
053100     INITIALIZE  PV-TOT-CARTONS-LOC                               05310004
053200                 PV-TOT-FIRST-TRAILER-DC                          05320004
053300                 PV-TOT-VNDR-DC                                   05330004
053400                 PV-TOT-PO-DC                                     05340004
053500                 PV-TOT-PO-ALL                                    05350004
053600                 TL-DC-CRTN-TOTALS                                05360004
053700                 TL-FIRST-CRTN-TOTALS                             05370004
053800                 TL-VENDOR-CRTN-TOTALS                            05380004
053900                 TL-PO-CRTN-TOTALS                                05390004
054000                 TL-ALL-CRTN-TOTALS.                              05400004
054100******************************************************************05410004
054200*  PRINT DETAIL REPORT LINE.                                      05420004
054300******************************************************************05430004
054400 7000-PRINT-DETAILS.                                              05440004
054500*                                                                 05450004
054600*CHECK FOR OVERFLOW.                                              05460004
054700     ADD 1 TO PV-LINE-COUNT.                                      05470004
054800     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         05480004
054900         SET PS-NEW-PAGE TO TRUE                                  05490004
055000         PERFORM 8000-WRITE-MAIN-HEADINGS                         05500004
055100     END-IF.                                                      05510004
055200                                                                  05520004
055300*IF NEW PAGE, DISPLAY WEEK-END DATE.                              05530004
055400     IF PS-NEW-PAGE                                               05540004
055500         SET PS-SAME-PAGE             TO TRUE                     05550004
055600     END-IF.                                                      05560004
055700                                                                  05570004
055800*WRITE DETAIL LINE.                                               05580004
055900             WRITE REPORT-RECORD-1                                05590004
056000               FROM DL-DETAIL-LINE-1.                             05600004
056100*                AFTER ADVANCING 1 LINES.                         05610004
056200*                                                                 05620004
056300******************************************************************05630004
056400 8000-WRITE-MAIN-HEADINGS.                                        05640004
056500******************************************************************05650004
056600*                                                                 05660004
056700     ADD 1                         TO PV-PAGE-COUNT.              05670004
056800     MOVE PV-PAGE-COUNT            TO DP132O-PAGE-NUMBER.         05680004
056900     MOVE ZERO                     TO PV-LINE-COUNT.              05690004
057000                                                                  05700004
057100     WRITE REPORT-RECORD-1 FROM                                   05710004
057200         DP132O-STANDRD-HEADER-132-COLS                           05720004
057300         AFTER ADVANCING PAGE.                                    05730004
057400                                                                  05740004
057500     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1                 05750004
057600        AFTER ADVANCING 1 LINES.                                  05760004
057700                                                                  05770004
057800     IF SU087-RPT-TYP-CDE     = PC-WEEKLY                         05780004
057900     OR SU087-RPT-TYP-CDE     = PC-MONTHLY                        05790004
058000           WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-3           05800004
058100            AFTER ADVANCING 1 LINES                               05810004
058200         ELSE IF SU087-RPT-TYP-CDE     = PC-DAILY                 05820004
058300               WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2       05830004
058400                 AFTER ADVANCING 1 LINES                          05840004
058500              ELSE IF HL-HDG-LINE-2-DAILY-DATE > SPACES           05850004
058600                 WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2     05860004
058700                   AFTER ADVANCING 1 LINES                        05870004
058800                  ELSE IF  HL-HDG-LINE-3-TO-DATE  > SPACES        05880004
058900                      WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-305890004
059000                         AFTER ADVANCING 1 LINES                  05900004
059100                  END-IF                                          05910004
059200              END-IF                                              05920004
059300         END-IF                                                   05930004
059400     END-IF.                                                      05940004
059500                                                                  05950004
059600     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     05960004
059700         AFTER ADVANCING 1 LINE.                                  05970004
059800                                                                  05980004
059900     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4                 05990004
060000        AFTER ADVANCING 1 LINES.                                  06000004
060100                                                                  06010004
060200     ADD 05                           TO PV-LINE-COUNT.           06020004
060300*                                                                 06030004
060400******************************************************************06040004
060500 9000-EOJ.                                                        06050004
060600******************************************************************06060004
060700*                                                                 06070004
060800     WRITE REPORT-RECORD-1 FROM ER-END-OF-REPORT-LINE             06080004
060900        AFTER ADVANCING 2 LINES                                   06090004
061000                                                                  06100004
061100     CLOSE EXTRACT-FILE                                           06110004
061200                                                                  06120004
061300     CLOSE REPORT-FILE-1                                          06130004
061400                                                                  06140004
061500                                                                  06150004
061600     MOVE PV-READ-COUNT      TO PV-DISPLAY-COUNT.                 06160004
061700     DISPLAY 'TOTAL INPUT RECORDS READ ' PV-DISPLAY-COUNT.        06170004
061800                                                                  06180004
062000*                                                                 06200004
