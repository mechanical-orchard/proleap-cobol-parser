000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.    TRKRP221.                                         00050002
000600 AUTHOR.        DAVE PHELPS                                       00060001
000700 INSTALLATION.  KOHLS.                                            00070001
000800 DATE-WRITTEN   JUNE,1998.                                        00080011
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100*----------------------------------------------------------------*00110001
001200*  THIS PROGRAM CREATES AN ERROR REPORT OF DATA THAT WAS NOT      00120001
001300*  LOADED TO THE DB2 TABLES IN TRKUP225.                          00130011
001400*----------------------------------------------------------------*00140001
001500                                                                  00150001
001600******************************************************************00160001
001700 ENVIRONMENT DIVISION.                                            00170001
001800******************************************************************00180001
001900                                                                  00190001
002000 CONFIGURATION SECTION.                                           00200001
002100                                                                  00210001
002200 SOURCE-COMPUTER.        IBM-3090.                                00220001
002300 OBJECT-COMPUTER.        IBM-3090.                                00230001
002400                                                                  00240001
002500 INPUT-OUTPUT SECTION.                                            00250001
002600                                                                  00260001
002700 FILE-CONTROL.                                                    00270001
002800                                                                  00280001
002900     SELECT ERROR-FILE                                            00290001
003000         ASSIGN TO INP01.                                         00300001
003100                                                                  00310001
003200     SELECT ERROR-REPORT-FILE                                     00320001
003300         ASSIGN TO RPT01.                                         00330001
003400                                                                  00340001
003500******************************************************************00350001
003600 DATA DIVISION.                                                   00360001
003700******************************************************************00370001
003800                                                                  00380001
003900 FILE SECTION.                                                    00390001
004000                                                                  00400001
004100 FD  ERROR-FILE                                                   00410001
004200     RECORDING MODE IS F                                          00420001
004300     LABEL RECORDS ARE STANDARD                                   00430001
004400     BLOCK CONTAINS 0 RECORDS.                                    00440001
004500                                                                  00450001
004600 01  ERROR-RECORD                     PIC  X(254).                00460001
004700                                                                  00470001
004800                                                                  00480001
004900 FD  ERROR-REPORT-FILE                                            00490001
005000     RECORDING MODE IS F                                          00500001
005100     LABEL RECORDS ARE STANDARD                                   00510001
005200     BLOCK CONTAINS 0 RECORDS.                                    00520001
005300                                                                  00530001
005400 01  ERROR-REPORT-RECORD              PIC  X(132).                00540001
005500*                                                                 00550001
005600*                                                                 00560001
005700*----------------------------------------------------------------*00570001
005800 WORKING-STORAGE SECTION.                                         00580001
005900*----------------------------------------------------------------*00590001
005901*                                                                 00600001
005902*----------------------------------------------------------------*00610001
005903*   PURCHASE ORDER HEADER TABLE.                                  00620001
005904*----------------------------------------------------------------*00630001
005905                                                                  00640001
005906     EXEC SQL                                                     00650001
005907         INCLUDE TPURCHS                                          00660001
005908     END-EXEC.                                                    00670001
005909                                                                  00680001
005910*----------------------------------------------------------------*00690001
005920*   VENDOR NAME HEADER TABLE.                                     00700001
005930*----------------------------------------------------------------*00710001
005940                                                                  00720001
005950     EXEC SQL                                                     00730001
005960         INCLUDE TENTNME                                          00740001
005970     END-EXEC.                                                    00750001
005971                                                                  00760001
005972*----------------------------------------------------------------*00770001
005973*   POL HEADER TABLE.                                             00780001
005974*----------------------------------------------------------------*00790001
005975                                                                  00800001
005976     EXEC SQL                                                     00810001
005977         INCLUDE TIMFOB                                           00820001
005978     END-EXEC.                                                    00830001
005979                                                                  00840001
006100*----------------------------------------------------------------*00850001
006200***  WORK FIELDS FOR THE ERROR REPORT                             00860001
006400*----------------------------------------------------------------*00870001
006500     COPY TRRD221.                                                00880034
006600*                                                                 00890001
006800*----------------------------------------------------------------*00900001
006900***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 00910001
007000*----------------------------------------------------------------*00920001
007100     COPY DPWS132O.                                               00930033
007200*                                                                 00940001
007400 01  HL1-HEADING-LINE-1.                                          00950001
007815         10 FILLER                   PIC  X(02)      VALUE SPACES.00960001
007816     05  HL1-TRANS-DATE.                                          00970001
007817         10 HL-TRANS-MM              PIC  X(02)      VALUE SPACE. 00980001
007818         10 FILLER                   PIC  X(01)      VALUE '/'.   00990001
007819         10 HL-TRANS-DD              PIC  X(02)      VALUE SPACE. 01000001
007820         10 FILLER                   PIC  X(01)      VALUE '/'.   01010001
007821         10 HL-TRANS-YY              PIC  X(02)      VALUE SPACE. 01020001
007822     05  FILLER                      PIC  X(02)      VALUE SPACE. 01030001
007823     05  HL1-TRANS-TIME.                                          01040001
007830         10 HL-TRANS-TIME-HH         PIC  X(02)      VALUE SPACE. 01050001
007840         10 FILLER                   PIC  X(01)      VALUE ':'.   01060001
007841         10 HL-TRANS-TIME-MM         PIC  X(02)      VALUE SPACE. 01070001
007842     05  FILLER                      PIC  X(01)      VALUE SPACE. 01080001
007843     05  FILLER                      PIC  X(13)      VALUE        01090001
007844         'TRANSMIT DATE'.                                         01100001
007845     05  FILLER                      PIC  X(16)      VALUE SPACE. 01110001
007846     05  FILLER                      PIC  X(38)      VALUE        01120001
007847         '    IMPORT PURCHASE ORDER TRACKING    '.                01130001
007848     05  FILLER                      PIC  X(16)      VALUE SPACE. 01140001
007849     05  FILLER                      PIC  X(07)      VALUE        01150001
007850         'FILE ID'.                                               01160001
007851     05  FILLER                      PIC  X(02)      VALUE SPACE. 01170001
007852     05  HL1-FILE-ID                 PIC  X(09)      VALUE SPACE. 01180001
007853     05  FILLER                      PIC  X(01)      VALUE SPACE. 01190001
007854*                                                                 01200001
007855 01  HL1-HEADING-LINE-2.                                          01210001
007856         10 FILLER                   PIC  X(02)      VALUE SPACES.01220001
007857     05  HL1-LOAD-DATE.                                           01230001
007858         10 HL-LOAD-MM               PIC  X(02)      VALUE SPACE. 01240001
007859         10 FILLER                   PIC  X(01)      VALUE '/'.   01250001
007860         10 HL-LOAD-DD               PIC  X(02)      VALUE SPACE. 01260001
007861         10 FILLER                   PIC  X(01)      VALUE '/'.   01270001
007862         10 HL-LOAD-YY               PIC  X(02)      VALUE SPACE. 01280001
007863     05  FILLER                      PIC  X(02)      VALUE SPACE. 01290001
007864     05  HL1-LOAD-TIME.                                           01300001
007865         10 HL-LOAD-TIME-HH          PIC  X(02)      VALUE SPACE. 01310001
007866         10 FILLER                   PIC  X(01)      VALUE ':'.   01320001
007867         10 HL-LOAD-TIME-MM          PIC  X(02)      VALUE SPACE. 01330001
007868     05  FILLER                      PIC  X(01)      VALUE SPACE. 01340001
007869     05  FILLER                      PIC  X(13)      VALUE        01350001
007870         'LOAD DATE    '.                                         01360001
007871     05  FILLER                      PIC  X(16)      VALUE SPACE. 01370001
007872     05  FILLER                      PIC  X(38)      VALUE        01380001
007873         '         RECEIVING LOAD ERRORS        '.                01390002
007874     05  FILLER                      PIC  X(16)      VALUE SPACE. 01400001
007875     05  HL1-EXPEDITOR               PIC  X(30)      VALUE SPACES.01410001
007876                                                                  01420001
007877*                                                                 01430001
007878 01  HL2-HEADING-LINE-1.                                          01440001
007879     05  FILLER                      PIC  X(31)      VALUE SPACE. 01450001
007880     05  HL2-RECD-1                  PIC  X(04)      VALUE        01460007
007881         'RCVD'.                                                  01470006
007882     05  FILLER                      PIC  X(04)      VALUE SPACE. 01480007
007883     05  FILLER                      PIC  X(04)      VALUE        01490001
007884         'SHPD'.                                                  01500001
007885     05  FILLER                      PIC  X(28)      VALUE SPACE. 01510001
007886*                                                                 01520001
007887 01  HL2-HEADING-LINE-2.                                          01530001
007888     05  FILLER                      PIC  X(03)      VALUE SPACE. 01540001
007889     05  HL2-RECD-2                  PIC  X(02)      VALUE        01550001
007890         'PO'.                                                    01560001
007891     05  FILLER                      PIC  X(06)      VALUE SPACE. 01570001
007892     05  HL2-TRN                     PIC  X(09)      VALUE        01580001
007893         'REFERENCE'.                                             01590001
007894     05  FILLER                      PIC  X(08)      VALUE SPACE. 01600001
007895     05  FILLER                      PIC  X(08)      VALUE        01610001
007896         'DELY DTE'.                                              01620001
007897     05  FILLER                      PIC  X(03)      VALUE SPACE. 01630001
007898     05  FILLER                      PIC  X(04)      VALUE        01640001
007899         'FROM'.                                                  01650001
007900     05  FILLER                      PIC  X(10)      VALUE SPACE. 01660001
007901     05  FILLER                      PIC  X(11)      VALUE        01670001
007902         'VENDOR NAME'.                                           01680001
007903     05  FILLER                      PIC  X(33)      VALUE SPACE. 01690001
007980*                                                                 01700001
007981 01  HL3-HEADING-LINE-1.                                          01710001
007982     05  HL3-TYPE-1-LNE-1            PIC  X(04).                  01720001
007983     05  FILLER                      PIC  X(04)      VALUE SPACE. 01730001
007984     05  HL3-TYPE-2-LNE-1            PIC  X(04).                  01740001
008300     05  FILLER                      PIC  X(49)      VALUE SPACE. 01750023
008302     05  FILLER                      PIC  X(06)      VALUE        01760001
008303         'CONSOL'.                                                01770001
008304     05  FILLER                      PIC  X(06)      VALUE SPACE. 01780001
008305*                                                                 01790001
008306 01  HL3-HEADING-LINE-2.                                          01800001
008307     05  HL3-TYPE-1-LNE-2            PIC  X(04).                  01810001
008308     05  FILLER                      PIC  X(04)      VALUE SPACE. 01820001
008309     05  HL3-TYPE-2-LNE-2            PIC  X(04).                  01830001
008310     05  FILLER                      PIC  X(02)      VALUE SPACE. 01840001
008320     05  FILLER                      PIC  X(05)      VALUE        01850001
008321         'CNTRY'.                                                 01860001
008325     05  FILLER                      PIC  X(17)      VALUE SPACE. 01870025
008326     05  FILLER                      PIC  X(12)      VALUE        01880001
008327         'FACTORY NAME'.                                          01890001
008328     05  FILLER                      PIC  X(14)      VALUE SPACE. 01900001
008329     05  FILLER                      PIC  X(06)      VALUE        01910001
008330         'SCAC'.                                                  01920001
008331     05  FILLER                      PIC  X(02)      VALUE SPACE. 01930026
008332     05  FILLER                      PIC  X(07)      VALUE        01940001
008333         'CARTONS'.                                               01950001
008322     05  FILLER                      PIC  X(07)      VALUE SPACE. 01960001
008323     05  FILLER                      PIC  X(05)      VALUE        01970001
008324         'UNITS'.                                                 01980001
008334     05  FILLER                      PIC  X(09)      VALUE SPACE. 01990001
008335     05  FILLER                      PIC  X(04)      VALUE        02000001
008336         'CBMS'.                                                  02010001
008337     05  FILLER                      PIC  X(06)      VALUE SPACE. 02020001
008338     05  FILLER                      PIC  X(05)      VALUE        02030001
008339         'KGRMS'.                                                 02040001
008340     05  FILLER                      PIC  X(70)      VALUE SPACE. 02050001
008341*                                                                 02060001
008342 01  HL3-HEADING-DATA-IN-ERROR.                                   02070001
008343     05  FILLER                      PIC  X(14)      VALUE SPACE. 02080001
008344     05  FILLER                      PIC  X(13)      VALUE        02090001
008345         'DATA IN ERROR'.                                         02100001
008346     05  FILLER                      PIC  X(09)      VALUE SPACE. 02110001
008347     05  FILLER                      PIC  X(10)      VALUE        02120001
008348         'DATA VALUE'.                                            02130001
008349     05  FILLER                      PIC  X(07)      VALUE SPACE. 02140001
008350     05  FILLER                      PIC  X(04)      VALUE        02150001
008351         'TYPE'.                                                  02160001
008352     05  FILLER                      PIC  X(23)      VALUE SPACE. 02170001
008353     05  FILLER                      PIC  X(07)      VALUE        02180001
008354         'MESSAGE'.                                               02190001
008355     05  FILLER                      PIC  X(48)      VALUE SPACE. 02200001
008356*                                                                 02210001
008357 01  HL4-HEADING-LINE-1.                                          02220001
008358     05  FILLER                      PIC  X(09)      VALUE SPACE. 02230001
008359     05  HL4-TYPE-1-LNE-1            PIC  X(04).                  02240001
008360     05  FILLER                      PIC  X(04)      VALUE SPACE. 02250001
008361     05  HL4-TYPE-2-LNE-1            PIC  X(03).                  02260001
008362     05  FILLER                      PIC  X(71)      VALUE SPACE. 02270001
008363*                                                                 02280001
008364 01  HL4-HEADING-LINE-2.                                          02290001
008365     05  FILLER                      PIC  X(09)      VALUE SPACE. 02300001
008366     05  HL4-TYPE-1-LNE-2            PIC  X(04).                  02310001
008367     05  FILLER                      PIC  X(04)      VALUE SPACE. 02320001
008368     05  HL4-TYPE-2-LNE-2            PIC  X(04).                  02330001
008369     05  FILLER                      PIC  X(07)      VALUE SPACE. 02340001
008370     05  FILLER                      PIC  X(12)      VALUE        02350001
008371         'VENDOR STYLE'.                                          02360001
008372     05  FILLER                      PIC  X(30)      VALUE SPACE. 02370001
008373     05  FILLER                      PIC  X(07)      VALUE        02380001
008374         'CARTONS'.                                               02390001
008375     05  FILLER                      PIC  X(07)      VALUE SPACE. 02400001
008376     05  FILLER                      PIC  X(05)      VALUE        02410001
008377         'UNITS'.                                                 02420001
008378     05  FILLER                      PIC  X(09)      VALUE SPACE. 02430001
008379     05  FILLER                      PIC  X(04)      VALUE        02440001
008380         'CBMS'.                                                  02450001
008381     05  FILLER                      PIC  X(06)      VALUE SPACE. 02460001
008382     05  FILLER                      PIC  X(05)      VALUE        02470001
008383         'KGRMS'.                                                 02480001
008385*                                                                 02490001
008386 01  HL4-HEADING-DATA-IN-ERROR.                                   02500001
008387     05  FILLER                      PIC  X(24)      VALUE SPACE. 02510001
008388     05  FILLER                      PIC  X(13)      VALUE        02520001
008389         'DATA IN ERROR'.                                         02530001
008390     05  FILLER                      PIC  X(04)      VALUE SPACE. 02540001
008391     05  FILLER                      PIC  X(10)      VALUE        02550001
008392         'DATA VALUE'.                                            02560001
008393     05  FILLER                      PIC  X(12)      VALUE SPACE. 02570001
008394     05  FILLER                      PIC  X(04)      VALUE        02580001
008395         'TYPE'.                                                  02590001
008396     05  FILLER                      PIC  X(10)      VALUE SPACE. 02600001
008397     05  FILLER                      PIC  X(07)      VALUE        02610001
008398         'MESSAGE'.                                               02620001
008399     05  FILLER                      PIC  X(48)      VALUE SPACE. 02630001
008400*                                                                 02640001
008401 01  HL5-HEADING-LINE-1.                                          02650001
008402     05  FILLER                      PIC  X(17)      VALUE SPACE. 02660001
008403     05  HL5-RECD                    PIC  X(04).                  02670001
008404     05  FILLER                      PIC  X(04)      VALUE SPACE. 02680001
008405     05  HL5-TRN                     PIC  X(03).                  02690001
008406     05  FILLER                      PIC  X(02)      VALUE SPACE. 02700001
008407*                                                                 02710001
008408 01  HL5-HEADING-LINE-2.                                          02720001
008409     05  FILLER                      PIC  X(17)      VALUE SPACE. 02730001
008410     05  HL5-TYPE-1                  PIC  X(04).                  02740001
008411     05  FILLER                      PIC  X(04)      VALUE SPACE. 02750001
008412     05  HL5-TYPE-2                  PIC  X(04).                  02760001
008413     05  FILLER                      PIC  X(07)      VALUE SPACE. 02770001
008414     05  FILLER                      PIC  X(12)      VALUE        02780001
008415         'VENDOR STYLE'.                                          02790001
008416     05  FILLER                      PIC  X(10)      VALUE SPACE. 02800001
008417     05  FILLER                      PIC  X(03)      VALUE        02810001
008418         'UPC'.                                                   02820001
008419     05  FILLER                      PIC  X(09)      VALUE SPACE. 02830001
008420     05  FILLER                      PIC  X(07)      VALUE        02840001
008421         'CARTONS'.                                               02850001
008422     05  FILLER                      PIC  X(07)      VALUE SPACE. 02860001
008423     05  FILLER                      PIC  X(05)      VALUE        02870001
008424         'UNITS'.                                                 02880001
008425     05  FILLER                      PIC  X(09)      VALUE SPACE. 02890001
008426     05  FILLER                      PIC  X(04)      VALUE        02900001
008427         'CBMS'.                                                  02910001
008428     05  FILLER                      PIC  X(06)      VALUE SPACE. 02920001
008429     05  FILLER                      PIC  X(05)      VALUE        02930001
008430         'KGRMS'.                                                 02940001
008431     05  FILLER                      PIC  X(71)      VALUE SPACE. 02950001
008432*                                                                 02960001
008433 01  HL5-HEADING-DATA-IN-ERROR.                                   02970001
008434     05  FILLER                      PIC  X(30)      VALUE SPACE. 02980001
008435     05  FILLER                      PIC  X(13)      VALUE        02990001
008436         'DATA IN ERROR'.                                         03000001
008437     05  FILLER                      PIC  X(09)      VALUE SPACE. 03010001
008438     05  FILLER                      PIC  X(10)      VALUE        03020001
008439         'DATA VALUE'.                                            03030001
008440     05  FILLER                      PIC  X(07)      VALUE SPACE. 03040001
008441     05  FILLER                      PIC  X(04)      VALUE        03050001
008442         'TYPE'.                                                  03060001
008443     05  FILLER                      PIC  X(21)      VALUE SPACE. 03070001
008444     05  FILLER                      PIC  X(07)      VALUE        03080001
008445         'MESSAGE'.                                               03090001
008446     05  FILLER                      PIC  X(46)      VALUE SPACE. 03100001
008447*                                                                 03110001
008448*                                                                 03120001
008449 01  HL6-HEADING-LINE-1.                                          03130001
008450     05  HL6-REC                     PIC  X(04)      VALUE        03140001
008451         'RECD'.                                                  03150001
008452     05  FILLER                      PIC  X(04)      VALUE SPACE. 03160001
008453     05  HL6-TRN                     PIC  X(04)      VALUE        03170001
008454         'TRN '.                                                  03180001
008455     05  FILLER                      PIC  X(02)      VALUE SPACE. 03190001
008456     05  HL6-TYPE-3                  PIC  X(03)      VALUE        03200001
008457         'VSL'.                                                   03210001
008458     05  FILLER                      PIC  X(13)      VALUE SPACE. 03220001
008459     05  FILLER                      PIC  X(04)      VALUE        03230001
008460         'CARR'.                                                  03240001
008461     05  FILLER                      PIC  X(74)      VALUE SPACE. 03250001
008482     05  FILLER                      PIC  X(07)      VALUE        03260001
008483         'EST LBD'.                                               03270001
008461     05  FILLER                      PIC  X(10)      VALUE SPACE. 03280001
008482     05  FILLER                      PIC  X(03)      VALUE        03290001
008483         'EST'.                                                   03300001
008462*                                                                 03310001
008463 01  HL6-HEADING-LINE-2-A.                                        03320001
008464     05  HL6-A-TYPE-1                PIC  X(04)      VALUE        03330001
008465         'TYPE'.                                                  03340001
008466     05  FILLER                      PIC  X(04)      VALUE SPACE. 03350001
008467     05  HL6-A-TYPE-2                PIC  X(04)      VALUE        03360001
008468         'TYPE'.                                                  03370001
008469     05  FILLER                      PIC  X(01)      VALUE SPACE. 03380001
008470     05  HL6-A-TYPE-3                PIC  X(04)      VALUE        03390001
008471         'TYPE'.                                                  03400001
008472     05  FILLER                      PIC  X(02)      VALUE SPACE. 03410001
008473     05  FILLER                      PIC  X(10)      VALUE        03420001
008474         'VOYAGE NBR'.                                            03430001
008475     05  FILLER                      PIC  X(01)      VALUE SPACE. 03440001
008476     05  FILLER                      PIC  X(04)      VALUE        03450001
008477         'SCAC'.                                                  03460001
008478     05  FILLER                      PIC  X(10)      VALUE SPACE. 03470001
008479     05  FILLER                      PIC  X(11)      VALUE        03480001
008480         'VESSEL NAME'.                                           03490001
008481     05  FILLER                      PIC  X(13)      VALUE SPACE. 03500001
008488     05  FILLER                      PIC  X(03)      VALUE        03510001
008489         'POL'.                                                   03520001
008484     05  FILLER                      PIC  X(08)      VALUE SPACE. 03530001
008485     05  FILLER                      PIC  X(03)      VALUE        03540001
008486         'ETD'.                                                   03550001
008490     05  FILLER                      PIC  X(06)      VALUE SPACE. 03560001
008491     05  FILLER                      PIC  X(03)      VALUE        03570001
008492         'POE'.                                                   03580001
008487     05  FILLER                      PIC  X(04)      VALUE SPACE. 03590001
008482     05  FILLER                      PIC  X(03)      VALUE        03600001
008483         'ETA'.                                                   03610001
008487     05  FILLER                      PIC  X(11)      VALUE SPACE. 03620001
008482     05  FILLER                      PIC  X(04)      VALUE        03630001
008483         'DEST'.                                                  03640001
008487     05  FILLER                      PIC  X(12)      VALUE SPACE. 03650001
008482     05  FILLER                      PIC  X(03)      VALUE        03660001
008483         'LBD'.                                                   03670001
008493     05  FILLER                      PIC  X(09)      VALUE SPACE. 03680001
008494*                                                                 03690001
008495 01  HL6-HEADING-DATA-IN-ERROR.                                   03700001
008496     05  FILLER                      PIC  X(19)      VALUE SPACE. 03710001
008497     05  FILLER                      PIC  X(13)      VALUE        03720001
008498         'DATA IN ERROR'.                                         03730001
008499     05  FILLER                      PIC  X(04)      VALUE SPACE. 03740001
008500     05  FILLER                      PIC  X(10)      VALUE        03750001
008501         'DATA VALUE'.                                            03760001
008502     05  FILLER                      PIC  X(12)      VALUE SPACE. 03770001
008503     05  FILLER                      PIC  X(04)      VALUE        03780001
008504         'TYPE'.                                                  03790001
008505     05  FILLER                      PIC  X(16)      VALUE SPACE. 03800001
008506     05  FILLER                      PIC  X(07)      VALUE        03810001
008507         'MESSAGE'.                                               03820001
008508     05  FILLER                      PIC  X(46)      VALUE SPACE. 03830001
008509*                                                                 03840001
008510 01  HL7-HEADING-LINE-1.                                          03850001
008511     05  FILLER                      PIC  X(04)      VALUE        03860001
008512         'RECD'.                                                  03870001
008513     05  FILLER                      PIC  X(04)      VALUE SPACE. 03880001
008514     05  FILLER                      PIC  X(03)      VALUE        03890001
008515         'TRN'.                                                   03900001
008516     05  FILLER                      PIC  X(16)      VALUE SPACE. 03910001
008517     05  FILLER                      PIC  X(04)      VALUE        03920001
008518         'CARR'.                                                  03930001
008519     05  FILLER                      PIC  X(12)      VALUE SPACE. 03940001
008520*                                                                 03950001
008521 01  HL7-HEADING-LINE-2.                                          03960001
008522     05  FILLER                      PIC  X(04)      VALUE        03970001
008523         'TYPE'.                                                  03980001
008524     05  FILLER                      PIC  X(04)      VALUE SPACE. 03990001
008525     05  FILLER                      PIC  X(04)      VALUE        04000001
008526         'TYPE'.                                                  04010001
008527     05  FILLER                      PIC  X(03)      VALUE SPACE. 04020001
008528     05  FILLER                      PIC  X(10)      VALUE        04030001
008529         'VOYAGE NBR'.                                            04040001
008530     05  FILLER                      PIC  X(02)      VALUE SPACE. 04050001
008531     05  FILLER                      PIC  X(04)      VALUE        04060001
008532         'SCAC'.                                                  04070001
008533     05  FILLER                      PIC  X(05)      VALUE SPACE. 04080001
008534     05  FILLER                      PIC  X(03)      VALUE        04090001
008535         'ETA'.                                                   04100001
008536     05  FILLER                      PIC  X(09)      VALUE SPACE. 04110001
008537     05  FILLER                      PIC  X(03)      VALUE        04120001
008538         'ETD'.                                                   04130001
008539     05  FILLER                      PIC  X(08)      VALUE SPACE. 04140001
008540     05  FILLER                      PIC  X(20)      VALUE        04150001
008541         'VOYAGE CHANGE REASON'.                                  04160001
008542     05  FILLER                      PIC  X(11)      VALUE SPACE. 04170001
008543*                                                                 04180001
008544 01  HL7-HEADING-DATA-IN-ERROR.                                   04190001
008545     05  FILLER                      PIC  X(13)      VALUE SPACE. 04200001
008546     05  FILLER                      PIC  X(13)      VALUE        04210001
008547         'DATA IN ERROR'.                                         04220001
008548     05  FILLER                      PIC  X(09)      VALUE SPACE. 04230001
008549     05  FILLER                      PIC  X(10)      VALUE        04240001
008550         'DATA VALUE'.                                            04250001
008551     05  FILLER                      PIC  X(07)      VALUE SPACE. 04260001
008552     05  FILLER                      PIC  X(04)      VALUE        04270001
008553         'TYPE'.                                                  04280001
008554     05  FILLER                      PIC  X(09)      VALUE SPACE. 04290001
008555     05  FILLER                      PIC  X(07)      VALUE        04300001
008556         'MESSAGE'.                                               04310001
008557     05  FILLER                      PIC  X(46)      VALUE SPACE. 04320001
009990*                                                                 04330001
009991 01  DL-DETAIL-LINE-2.                                            04340001
009992     05  DL02-PO-NBR-9              PIC  ZZZZZZZZZ  VALUE ZEROES. 04350001
013306     05  DL02-PO-NBR-X REDEFINES DL02-PO-NBR-9                    04360001
013307                                    PIC  XXXXXXXXX.               04370001
013308     05  FILLER                     PIC  X(02)    VALUE SPACES.   04380001
013309     05  DL02-REFERENCE-NBR         PIC  X(15)    VALUE SPACES.   04390001
013310     05  FILLER                     PIC  X(01)    VALUE SPACES.   04400001
013320     05  DL02-EST-DELIVERY-DATE.                                  04410001
013330         10  DL02-EST-DEL-MON       PIC  X(02)    VALUE SPACES.   04420001
013340         10  DL02-EST-SLASH-1       PIC  X(01)    VALUE '/'.      04430001
013350         10  DL02-EST-DEL-DAY       PIC  X(02)    VALUE SPACES.   04440001
013360         10  DL02-EST-SLASH-2       PIC  X(01)    VALUE '/'.      04450001
013361         10  DL02-EST-DEL-YEAR      PIC  X(04)    VALUE SPACES.   04460001
013362     05  FILLER                     PIC  X(02)    VALUE SPACES.   04470001
013363     05  DL02-SHPD-FR-CDE           PIC  X(03)    VALUE SPACES.   04480001
013364     05  FILLER                     PIC  X(02)    VALUE SPACES.   04490001
013365     05  DL02-VENDOR-NAME           PIC  X(30)    VALUE SPACES.   04500001
013366     05  FILLER                     PIC  X(10)    VALUE SPACES.   04510001
013367*                                                                 04520001
013368 01  DL-DETAIL-LINE-3.                                            04530001
013369     05  DL03-RECD-TYPE             PIC  X(06)    VALUE SPACES.   04540001
013370     05  FILLER                     PIC  X(03)    VALUE SPACES.   04550001
013371     05  DL03-TRN-TYPE              PIC  X(01)    VALUE SPACES.   04560001
013372     05  FILLER                     PIC  X(05)    VALUE SPACES.   04570001
013373     05  DL03-PROD-CNTRY-CDE        PIC  X(03).                   04580001
013378     05  FILLER                     PIC  X(07)    VALUE SPACES.   04590025
013379     05  DL03-PROD-FCTRY-CDE        PIC  X(35).                   04600001
013380     05  FILLER                     PIC  X(02)    VALUE SPACES.   04610025
013381     05  DL03-SCAC                  PIC  X(04).                   04620001
013382     05  FILLER                     PIC  X(02)    VALUE SPACES.   04630024
013383     05  DL03-CARTONS-9             PIC ZZZZZZZZ9.                04640001
013384     05  DL03-CARTONS-X REDEFINES DL03-CARTONS-9                  04650001
013385                                    PIC XXXXXXXXX.                04660001
013374     05  FILLER                     PIC  X(03)    VALUE SPACES.   04670001
013375     05  DL03-UNITS-9               PIC  ZZZZZZZZ9.               04680001
013376     05  DL03-UNITS-X   REDEFINES DL03-UNITS-9                    04690001
013377                                    PIC XXXXXXXXX.                04700001
013386     05  FILLER                     PIC  X(03)    VALUE SPACES.   04710001
013387     05  DL03-CBMS-9                PIC ZZZZZZ9.99.               04720001
013388     05  DL03-CBMS-X   REDEFINES DL03-CBMS-9                      04730001
013389                                    PIC XXXXXXXXXX.               04740001
013390     05  FILLER                     PIC  X(02)    VALUE SPACES.   04750001
013391     05  DL03-KGRMS-9               PIC ZZZZZZZZ9.                04760001
013392     05  DL03-KGRMS-X  REDEFINES DL03-KGRMS-9                     04770001
013393                                    PIC XXXXXXXXX.                04780001
013394     05  FILLER                     PIC  X(02)    VALUE SPACES.   04790001
013395*                                                                 04800001
013396 01  DL-DETAIL-LINE-WITH-ERROR-3.                                 04810001
013397     05  FILLER                     PIC  X(14)    VALUE SPACES.   04820001
013398     05  DL03-DATA-ERROR-3          PIC  X(15)    VALUE SPACES.   04830001
013399     05  FILLER                     PIC  X(02)    VALUE SPACES.   04840001
013400     05  DL03-DATA-VALUE-3          PIC  X(20)    VALUE SPACES.   04850001
013401     05  FILLER                     PIC  X(02)    VALUE SPACES.   04860001
013402     05  DL03-DATA-TYPE-3           PIC  X(03)    VALUE SPACES.   04870001
013403     05  FILLER                     PIC  X(02)    VALUE SPACES.   04880001
013404     05  DL03-DATA-MSG-3            PIC  X(50)    VALUE SPACES.   04890001
013405     05  FILLER                     PIC  X(02)    VALUE SPACES.   04900001
013406*                                                                 04910001
013407 01  DL-DETAIL-LINE-4.                                            04920001
013408     05  FILLER                     PIC  X(09)    VALUE SPACES.   04930001
013409     05  DL04-RECD-TYPE             PIC  X(06)    VALUE SPACES.   04940001
013410     05  FILLER                     PIC  X(03)    VALUE SPACES.   04950001
013411     05  DL04-TRN-TYPE              PIC  X(01)    VALUE SPACES.   04960001
013412     05  FILLER                     PIC  X(06)    VALUE SPACES.   04970001
013413     05  DL04-VENDOR-STYLE          PIC  X(20)    VALUE SPACES.   04980001
013414     05  FILLER                     PIC  X(23)    VALUE SPACES.   04990001
013415     05  DL04-CARTONS-9             PIC ZZZZZZZZ9.                05000001
013416     05  DL04-CARTONS-X REDEFINES DL04-CARTONS-9                  05010001
013417                                    PIC XXXXXXXXX.                05020001
013418     05  FILLER                     PIC  X(03)    VALUE SPACES.   05030001
013419     05  DL04-UNITS-9               PIC ZZZZZZZZ9.                05040001
013420     05  DL04-UNITS-X   REDEFINES DL04-UNITS-9                    05050001
013421                                    PIC XXXXXXXXX.                05060001
013422     05  FILLER                     PIC  X(01)    VALUE SPACES.   05070001
013423     05  DL04-CBMS-9                PIC ZZZZZZZZ9.99.             05080001
013424     05  DL04-CBMS-X    REDEFINES DL04-CBMS-9                     05090001
013425                                    PIC XXXXXXXXXXXX.             05100001
013426     05  FILLER                     PIC  X(02)    VALUE SPACES.   05110001
013427     05  DL04-KGRMS-9               PIC ZZZZZZZZ9.                05120001
013428     05  DL04-KGRMS-X   REDEFINES DL04-KGRMS-9                    05130001
013429                                    PIC XXXXXXXXX.                05140001
013430     05  FILLER                     PIC  X(02)    VALUE SPACES.   05150001
013431*                                                                 05160001
013432 01  DL-DETAIL-LINE-WITH-ERROR-4.                                 05170001
013433     05  FILLER                     PIC  X(24)    VALUE SPACES.   05180001
013434     05  DL04-DATA-ERROR-4          PIC  X(15)    VALUE SPACES.   05190001
013435     05  FILLER                     PIC  X(02)    VALUE SPACES.   05200001
013436     05  DL04-DATA-VALUE-4          PIC  X(20)    VALUE SPACES.   05210001
013437     05  FILLER                     PIC  X(02)    VALUE SPACES.   05220001
013438     05  DL04-DATA-TYPE-4           PIC  X(03)    VALUE SPACES.   05230001
013439     05  FILLER                     PIC  X(04)    VALUE SPACES.   05240001
013440     05  DL04-DATA-MSG-4            PIC  X(50)    VALUE SPACES.   05250001
013441     05  FILLER                     PIC  X(02)    VALUE SPACES.   05260001
013442*                                                                 05270001
013443 01  DL-DETAIL-LINE-5.                                            05280001
013444     05  FILLER                     PIC  X(17)    VALUE SPACES.   05290001
013445     05  DL05-RECD-TYPE             PIC  X(06)    VALUE SPACES.   05300001
013446     05  FILLER                     PIC  X(03)    VALUE SPACES.   05310001
013447     05  DL05-TRN-TYPE              PIC  X(01)    VALUE SPACES.   05320001
013448     05  FILLER                     PIC  X(04)    VALUE SPACES.   05330001
013449     05  DL05-VENDOR-STYLE          PIC  X(20).                   05340001
013450     05  FILLER                     PIC  X(01)    VALUE SPACES.   05350001
013451     05  DL05-UPC                   PIC  999999999999999.         05360001
013452     05  FILLER                     PIC  X(01)    VALUE SPACES.   05370001
013453     05  DL05-CARTONS-9             PIC ZZZZZZZZ9.                05380001
013454     05  DL05-CARTONS-X  REDEFINES DL05-CARTONS-9                 05390001
013455                                    PIC XXXXXXXXX.                05400001
013456     05  FILLER                     PIC  X(03)    VALUE SPACES.   05410001
013457     05  DL05-UNITS-9               PIC ZZZZZZZZ9.                05420001
013458     05  DL05-UNITS-X   REDEFINES DL05-UNITS-9                    05430001
013459                                    PIC XXXXXXXXX.                05440001
013460     05  FILLER                     PIC  X(03)    VALUE SPACES.   05450001
013461     05  DL05-CBMS-9                PIC ZZZZZZ9.99.               05460001
013462     05  DL05-CBMS-X    REDEFINES DL05-CBMS-9                     05470001
013463                                    PIC XXXXXXXXXX.               05480001
013464     05  FILLER                     PIC  X(02)    VALUE SPACES.   05490001
013465     05  DL05-KGRMS-9               PIC ZZZZZZZZ9.                05500001
013466     05  DL05-KGRMS-X   REDEFINES DL05-KGRMS-9                    05510001
013467                                    PIC XXXXXXXXX.                05520001
013468     05  FILLER                     PIC  X(02)    VALUE SPACES.   05530001
013469*                                                                 05540001
013470 01  DL-DETAIL-LINE-WITH-ERROR-5.                                 05550001
013471     05  FILLER                     PIC  X(30)    VALUE SPACES.   05560001
013472     05  DL05-DATA-ERROR-5          PIC  X(15)    VALUE SPACES.   05570001
013473     05  FILLER                     PIC  X(02)    VALUE SPACES.   05580001
013474     05  DL05-DATA-VALUE-5          PIC  X(20)    VALUE SPACES.   05590001
013475     05  FILLER                     PIC  X(02)    VALUE SPACES.   05600001
013476     05  DL05-DATA-TYPE-5           PIC  X(03)    VALUE SPACES.   05610001
013477     05  FILLER                     PIC  X(10)    VALUE SPACES.   05620001
013478     05  DL05-DATA-MSG-5            PIC  X(50)    VALUE SPACES.   05630001
013479     05  FILLER                     PIC  X(02)    VALUE SPACES.   05640001
013480*                                                                 05650001
013481 01  DL-DETAIL-LINE-6-A.                                          05660001
013482     05  DL06-A-RECD-TYPE           PIC  X(06)    VALUE SPACES.   05670001
013483     05  FILLER                     PIC  X(03)    VALUE SPACES.   05680001
013484     05  DL06-A-TRN-TYPE            PIC  X(01)    VALUE SPACES.   05690001
013485     05  FILLER                     PIC  X(04)    VALUE SPACES.   05700001
013486     05  DL06-A-VSL-TYPE            PIC  X(01)    VALUE SPACES.   05710001
013487     05  FILLER                     PIC  X(04)    VALUE SPACES.   05720001
013488     05  DL06-A-VOYAGE-NBR          PIC  X(10)    VALUE SPACES.   05730001
013489     05  FILLER                     PIC  X(01)    VALUE SPACES.   05740001
013490     05  DL06-A-SCAC                PIC  X(04)    VALUE SPACES.   05750001
013491     05  FILLER                     PIC  X(03)    VALUE SPACES.   05760001
013492     05  DL06-A-VESSEL-NAME         PIC  X(25)    VALUE SPACES.   05770001
013507     05  FILLER                     PIC  X(06)    VALUE SPACES.   05780001
013508     05  DL06-A-POL                 PIC  X(05)    VALUE SPACES.   05790001
013500     05  FILLER                     PIC  X(03)    VALUE SPACES.   05800001
013501     05  DL06-A-ETD-DTE.                                          05810001
013502         10  DL06-A-ETD-DTE-MM      PIC  X(02)    VALUE SPACES.   05820001
013503         10  DL06-A-ETD-SLASH-1     PIC  X(01)    VALUE '/'.      05830001
013504         10  DL06-A-ETD-DTE-DD      PIC  X(02)    VALUE SPACES.   05840001
013505         10  DL06-A-ETD-SLASH-2     PIC  X(01)    VALUE '/'.      05850001
013506         10  DL06-A-ETD-DTE-YY      PIC  X(04)    VALUE SPACES.   05860001
013509     05  FILLER                     PIC  X(01)    VALUE SPACES.   05870001
013510     05  DL06-A-POE                 PIC  X(04)    VALUE SPACES.   05880001
013493     05  FILLER                     PIC  X(01)    VALUE SPACES.   05890001
013494     05  DL06-A-ETA-DTE.                                          05900001
013495         10  DL06-A-ETA-DTE-MM      PIC  X(02)    VALUE SPACES.   05910001
013496         10  DL06-A-ETA-SLASH-1     PIC  X(01)    VALUE '/'.      05920001
013497         10  DL06-A-ETA-DTE-DD      PIC  X(02)    VALUE SPACES.   05930001
013498         10  DL06-A-ETA-SLASH-2     PIC  X(01)    VALUE '/'.      05940001
013499         10  DL06-A-ETA-DTE-YY      PIC  X(04)    VALUE SPACES.   05950001
013509     05  FILLER                     PIC  X(01)    VALUE SPACES.   05960001
013510     05  DL06-A-EST-LBD-DEST        PIC  X(18)    VALUE SPACES.   05970001
013509     05  FILLER                     PIC  X(01)    VALUE SPACES.   05980001
013510     05  DL06-A-EST-LBD.                                          05990001
013527         10  DL06-A-EST-DTE-MM      PIC  X(02)    VALUE SPACES.   06000001
013528         10  DL06-A-EST-SLASH-1     PIC  X(01)    VALUE '/'.      06010001
013529         10  DL06-A-EST-DTE-DD      PIC  X(02)    VALUE SPACES.   06020001
013530         10  DL06-A-EST-SLASH-2     PIC  X(01)    VALUE '/'.      06030001
013531         10  DL06-A-EST-DTE-YY      PIC  X(04)    VALUE SPACES.   06040001
013511     05  FILLER                     PIC  X(02)    VALUE SPACES.   06050001
013512*                                                                 06060001
013513 01  DL-DETAIL-LINE-6-B.                                          06070001
013514     05  DL06-B-RECD-TYPE           PIC  X(06)    VALUE SPACES.   06080001
013515     05  FILLER                     PIC  X(03)    VALUE SPACES.   06090001
013516     05  DL06-B-TRN-TYPE            PIC  X(01)    VALUE SPACES.   06100001
013517     05  FILLER                     PIC  X(04)    VALUE SPACES.   06110001
013518     05  DL06-B-VSL-TYPE            PIC  X(01)    VALUE SPACES.   06120001
013519     05  FILLER                     PIC  X(04)    VALUE SPACES.   06130001
013520     05  DL06-B-VOYAGE-NBR          PIC  X(10)    VALUE SPACES.   06140001
013521     05  FILLER                     PIC  X(01)    VALUE SPACES.   06150001
013522     05  DL06-B-SCAC                PIC  X(04)    VALUE SPACES.   06160001
013523     05  FILLER                     PIC  X(03)    VALUE SPACES.   06170001
013524     05  DL06-B-VESSEL-NAME         PIC  X(20)    VALUE SPACES.   06180001
013525     05  FILLER                     PIC  X(03)    VALUE SPACES.   06190001
013526     05  DL06-B-ETA-DTE.                                          06200001
013527         10  DL06-B-ETA-DTE-MM      PIC  X(02)    VALUE SPACES.   06210001
013528         10  DL06-B-ETA-SLASH-1     PIC  X(01)    VALUE '/'.      06220001
013529         10  DL06-B-ETA-DTE-DD      PIC  X(02)    VALUE SPACES.   06230001
013530         10  DL06-B-ETA-SLASH-2     PIC  X(01)    VALUE '/'.      06240001
013531         10  DL06-B-ETA-DTE-YY      PIC  X(04)    VALUE SPACES.   06250001
013532     05  FILLER                     PIC  X(01)    VALUE SPACES.   06260001
013533     05  DL06-B-ETD-DTE.                                          06270001
013534         10  DL06-B-ETD-DTE-MM      PIC  X(02)    VALUE SPACES.   06280001
013535         10  DL06-B-ETD-SLASH-1     PIC  X(01)    VALUE '/'.      06290001
013536         10  DL06-B-ETD-DTE-DD      PIC  X(02)    VALUE SPACES.   06300001
013537         10  DL06-B-ETD-SLASH-2     PIC  X(01)    VALUE '/'.      06310001
013538         10  DL06-B-ETD-DTE-YY      PIC  X(04)    VALUE SPACES.   06320001
013539     05  FILLER                     PIC  X(01)    VALUE SPACES.   06330001
013540     05  DL06-B-POL                 PIC  X(05)    VALUE SPACES.   06340001
013541     05  FILLER                     PIC  X(01)    VALUE SPACES.   06350001
013542     05  DL06-B-POE                 PIC  X(04)    VALUE SPACES.   06360001
013543     05  FILLER                     PIC  X(02)    VALUE SPACES.   06370001
013544*                                                                 06380001
013545 01  DL-DETAIL-LINE-WITH-ERROR-6.                                 06390001
013546     05  FILLER                     PIC  X(19)    VALUE SPACES.   06400001
013547     05  DL06-DATA-ERROR-6          PIC  X(15)    VALUE SPACES.   06410001
013548     05  FILLER                     PIC  X(02)    VALUE SPACES.   06420001
013549     05  DL06-DATA-VALUE-6          PIC  X(20)    VALUE SPACES.   06430001
013550     05  FILLER                     PIC  X(02)    VALUE SPACES.   06440001
013551     05  DL06-DATA-TYPE-6           PIC  X(03)    VALUE SPACES.   06450001
013552     05  FILLER                     PIC  X(04)    VALUE SPACES.   06460001
013553     05  DL06-DATA-MSG-6            PIC  X(50)    VALUE SPACES.   06470001
013554     05  FILLER                     PIC  X(02)    VALUE SPACES.   06480001
013555*                                                                 06490001
013556 01  DL-DETAIL-LINE-7.                                            06500001
013557     05  DL07-A-RECD-TYPE           PIC  X(06)    VALUE SPACES.   06510001
013558     05  FILLER                     PIC  X(03)    VALUE SPACES.   06520001
013559     05  DL07-A-TRN-TYPE            PIC  X(01)    VALUE SPACES.   06530001
013560     05  FILLER                     PIC  X(05)    VALUE SPACES.   06540001
013561     05  DL07-A-VOYAGE-NBR          PIC  X(10)    VALUE SPACES.   06550001
013562     05  FILLER                     PIC  X(02)    VALUE SPACES.   06560001
013563     05  DL07-A-SCAC                PIC  X(04)    VALUE SPACES.   06570001
013564     05  FILLER                     PIC  X(02)    VALUE SPACES.   06580001
013565     05  DL07-A-ETA-DTE.                                          06590001
013566         10  DL07-A-ETA-DTE-MM      PIC  X(02)    VALUE SPACES.   06600001
013567         10  DL07-A-ETA-SLASH-1     PIC  X(01)    VALUE '/'.      06610001
013568         10  DL07-A-ETA-DTE-DD      PIC  X(02)    VALUE SPACES.   06620001
013569         10  DL07-A-ETA-SLASH-2     PIC  X(01)    VALUE '/'.      06630001
013570         10  DL07-A-ETA-DTE-YY      PIC  X(04)    VALUE SPACES.   06640001
013571     05  FILLER                     PIC  X(02)    VALUE SPACES.   06650001
013572     05  DL07-A-ETD-DTE.                                          06660001
013573         10  DL07-A-ETD-DTE-MM      PIC  X(02)    VALUE SPACES.   06670001
013574         10  DL07-A-ETD-SLASH-1     PIC  X(01)    VALUE '/'.      06680001
013575         10  DL07-A-ETD-DTE-DD      PIC  X(02)    VALUE SPACES.   06690001
013576         10  DL07-A-ETD-SLASH-2     PIC  X(01)    VALUE '/'.      06700001
013577         10  DL07-A-ETD-DTE-YY      PIC  X(04)    VALUE SPACES.   06710001
013578     05  FILLER                     PIC  X(01)    VALUE SPACES.   06720001
013579     05  DL07-A-VOYAGE-CHANGE       PIC  X(30)    VALUE SPACES.   06730001
013580     05  FILLER                     PIC  X(01)    VALUE SPACES.   06740001
013581*                                                                 06750001
013582 01  DL-DETAIL-LINE-WITH-ERROR-7.                                 06760001
013583     05  FILLER                     PIC  X(13)    VALUE SPACES.   06770001
013584     05  DL07-DATA-ERROR-7          PIC  X(15)    VALUE SPACES.   06780001
013585     05  FILLER                     PIC  X(02)    VALUE SPACES.   06790001
013586     05  DL07-DATA-VALUE-7          PIC  X(20)    VALUE SPACES.   06800001
013587     05  FILLER                     PIC  X(02)    VALUE SPACES.   06810001
013588     05  DL07-DATA-TYPE-7           PIC  X(03)    VALUE SPACES.   06820001
013589     05  FILLER                     PIC  X(04)    VALUE SPACES.   06830001
013590     05  DL07-DATA-MSG-7            PIC  X(50)    VALUE SPACES.   06840001
013591     05  FILLER                     PIC  X(02)    VALUE SPACES.   06850001
013592*                                                                 06860015
008306 01  TRL-HEADING-LINE-1.                                          06870015
008320     05  FILLER                      PIC  X(45)      VALUE        06880015
008321         'A = ADD, B/Z = CHANGE, C = CHANGE, D = DELETE'.         06890015
008325     05  FILLER                      PIC  X(01)      VALUE SPACE. 06900015
008326     05  FILLER                      PIC  X(20)      VALUE        06910015
008327         'E = CHANGE TO DELETE'.                                  06920015
008328     05  FILLER                      PIC  X(14)      VALUE SPACE. 06930015
013592*                                                                 06940001
013593 01  ER-END-OF-REPORT-LINE.                                       06950001
013594     05  FILLER                     PIC  X(54)    VALUE SPACE.    06960001
013595     05  FILLER                     PIC  X(25)    VALUE           06970001
013596         '***** END OF REPORT *****'.                             06980001
013597     05  FILLER                     PIC  X(53)    VALUE SPACE.    06990001
013598*                                                                 07000001
013599 01  EP-EMPTY-REPORT-LINE.                                        07010001
013600     05  FILLER                     PIC  X(25)    VALUE           07020001
013601         '******* NO DATA *********'.                             07030001
013602     05  FILLER                     PIC  X(87)    VALUE SPACE.    07040001
013603*                                                                 07050001
013604 01  PS-PROGRAM-SWITCHES.                                         07060001
013605     05  PS-EOF-ERROR-FILE-SW       PIC  X(01)    VALUE SPACE.    07070001
013606         88  PS-EOF-ERROR-FILE                    VALUE 'Y'.      07080001
014201     05  PS-NEW-PAGE-SW             PIC  X(01)    VALUE SPACE.    07090001
014202         88  PS-NEW-PAGE                          VALUE 'Y'.      07100001
014203         88  PS-NOT-NEW-PAGE                      VALUE 'N'.      07110001
014204     05  PS-NEW-PO-SW               PIC  X(01)    VALUE SPACE.    07120001
014205         88  PS-NEW-PO                            VALUE 'Y'.      07130001
014206         88  PS-NOT-NEW-PO                        VALUE 'N'.      07140001
014270     05  PS-ERD-SW                  PIC  X(01)    VALUE SPACE.    07150003
014280         88  PS-ERD-YES                           VALUE 'Y'.      07160003
014290         88  PS-ERD-NO                            VALUE 'N'.      07170003
014291     05  PS-LOG-SW                  PIC  X(01)    VALUE SPACE.    07180003
014292         88  PS-LOG-YES                           VALUE 'Y'.      07190003
014293         88  PS-LOG-NO                            VALUE 'N'.      07200003
014294     05  PS-LOGVS-SW                PIC  X(01)    VALUE SPACE.    07210005
014295         88  PS-LOGVS-YES                         VALUE 'Y'.      07220005
014296         88  PS-LOGVS-NO                          VALUE 'N'.      07230005
014297     05  PS-LOGUPC-SW               PIC  X(01)    VALUE SPACE.    07240005
014298         88  PS-LOGUPC-YES                        VALUE 'Y'.      07250005
014299         88  PS-LOGUPC-NO                         VALUE 'N'.      07260005
014300     05  PS-ERDRSN-SW               PIC  X(01)    VALUE SPACE.    07270005
014301         88  PS-ERDRSN-YES                        VALUE 'Y'.      07280005
014302         88  PS-ERDRSN-NO                         VALUE 'N'.      07290005
014400*                                                                 07300001
014500 01 PC-PROGRAM-CONSTANTS.                                         07310001
014600     05  PC-PAGE-SIZE-055           PIC S9(04)    VALUE +055      07320001
014700                                                  COMP SYNC.      07330001
014701     05  PC-PAGE-SIZE-060           PIC S9(04)    VALUE +060      07340001
014702                                                  COMP SYNC.      07350001
014800     05  PC-HEADING-SIZE            PIC S9(04)    VALUE +006      07360020
014900                                                  COMP SYNC.      07370001
015000     05  PC-MAX-RETRIES             PIC S9(04)    VALUE +3        07380001
015100                                                  COMP SYNC.      07390001
015200     05  PC-MAX-TABLE-ENTRIES       PIC S9(04)    VALUE +20       07400001
015300                                                  COMP SYNC.      07410001
015600     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)    VALUE           07420001
015700         'TRKRP221'.                                              07430002
015800     05  PC-A                       PIC  X(01)    VALUE 'A'.      07440001
015900     05  PC-01                      PIC  X(02)    VALUE '01'.     07450001
016300*                                                                 07460001
016400 01  PV-PROGRAM-VARIABLES.                                        07470001
016500     05  PV-LINES-USED              PIC S9(04)    VALUE ZERO      07480001
016600                                                  COMP SYNC.      07490001
016700     05  PV-DELY-DTE-PREV           PIC  X(08)    VALUE SPACES.   07500001
016800     05  PV-SHPD-FR-CDE-PREV        PIC  X(03)    VALUE SPACES.   07510001
016900     05  PV-TRN-TYPE-PREV           PIC  X(01)    VALUE SPACES.   07520001
016901     05  PV-REC-TYP-CDE-PREV        PIC  X(06)    VALUE SPACES.   07530001
016902         88 PV-LOG-REC-TYP-CDE-LOG       VALUE 'LOG  '.           07540003
016903         88 PV-LOGVS-REC-TYP-CDE-LOGVS   VALUE 'LOGVS '.          07550005
016904         88 PV-LOGUPC-REC-TYP-CDE-LOGUPC VALUE 'LOGUPC'.          07560005
016905         88 PV-ERD-REC-TYP-CDE-ERD       VALUE 'ERD  '.           07570003
016906         88 PV-ERDRSN-REC-TYP-CD-ERDRSN  VALUE 'ERDRSN'.          07580005
016907     05  PV-PO-NBR-X                PIC  X(09)    VALUE ZERO.     07590001
016908     05  PV-CONTAINER-NBR           PIC  X(12)    VALUE SPACES.   07600001
016909     05  PV-EXTL-REF-NBR            PIC  X(15)    VALUE SPACES.   07610001
016910     05  PV-BLANK-LINE              PIC  X(132)   VALUE SPACES.   07620001
016920     05  PV-NO-OF-POS-IN-ERROR      PIC  S9(06)   VALUE ZEROES.   07630001
017100     05  PV-PAGE-COUNT              PIC  9(05)    VALUE ZERO.     07640001
020200*                                                                 07650001
020300 01  SD-SYSTEM-DATE.                                              07660001
020400     05  SD-SYSTEM-DATE-YY          PIC  9(02)      VALUE ZERO.   07670001
020500     05  SD-SYSTEM-DATE-MM          PIC  9(02)      VALUE ZERO.   07680001
020600     05  SD-SYSTEM-DATE-DD          PIC  9(02)      VALUE ZERO.   07690001
020800*                                                                 07700001
020900 01  ST-SYSTEM-TIME.                                              07710001
021000     05  ST-SYSTEM-HOUR             PIC  9(02)      VALUE ZERO.   07720001
021100     05  ST-SYSTEM-MINUTE           PIC  9(02)      VALUE ZERO.   07730001
021200     05  FILLER                     PIC  9(04)      VALUE ZERO.   07740001
021300*----------------------------------------------------------------*07750001
033200*  COMMUNICATION AREAS FOR DB2                                    07760001
033300*----------------------------------------------------------------*07770001
033400     EXEC SQL                                                     07780001
033500         INCLUDE SQLCA                                            07790001
033600     END-EXEC.                                                    07800001
033800*----------------------------------------------------------------*07810001
033900*  DB2 COMMUNICATION AREA 2                                       07820001
034000*----------------------------------------------------------------*07830001
034100     COPY SQLCA2.                                                 07840033
034101*                                                                 07850001
034102******************************************************************07860001
034103 PROCEDURE DIVISION.                                              07870001
034104******************************************************************07880001
034105*                                                                 07890001
034106*----------------------------------------------------------------*07900001
034107* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     07910001
034108*      PROGRAM.                                                   07920001
034109*----------------------------------------------------------------*07930001
034110 0000-PROGRAM-MAINLINE.                                           07940001
034120                                                                  07950001
034130     PERFORM 1000-INITIALIZE.                                     07960001
034140*                                                                 07970001
034141     PERFORM 2000-PROCESS-REPORT-DATA                             07980001
034142       UNTIL PS-EOF-ERROR-FILE.                                   07990001
034143*                                                                 08000001
034144     PERFORM 9000-EOJ-ROUTINE.                                    08010001
034145*                                                                 08020001
034146     STOP RUN.                                                    08030001
034147*                                                                 08040001
034148*0000-EXIT.                                                       08050001
034149*                                                                 08060001
034150******************************************************************08070001
034151*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    08080001
034152*    -- OPEN FILES                                                08090001
034153*    -- SET UP AND PRINT REPORT HEADINGS                          08100001
034154******************************************************************08110001
034155 1000-INITIALIZE.                                                 08120001
034156                                                                  08130001
034157     OPEN INPUT  ERROR-FILE                                       08140001
034158          OUTPUT ERROR-REPORT-FILE.                               08150001
034159*                                                                 08160001
034160     ACCEPT SD-SYSTEM-DATE FROM DATE.                             08170001
034161     ACCEPT ST-SYSTEM-TIME FROM TIME.                             08180001
034162     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              08190001
034163     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             08200001
034164     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               08210001
034165     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              08220001
034166     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            08230001
034167     MOVE PC-CURRENT-PROGRAM-NAME                                 08240001
034168                                 TO DP132O-PROGRAM-NAME.          08250001
034169     MOVE 1                      TO DP132O-REPORT-NUMBER.         08260001
034170     INITIALIZE     PS-ERD-SW                                     08270003
034171                    PS-LOG-SW                                     08280003
034172                    PS-LOGVS-SW                                   08290005
034173                    PS-ERDRSN-SW                                  08300005
034174                    PS-LOGUPC-SW                                  08310005
034175                    PS-NEW-PAGE-SW.                               08320001
034176*                                                                 08330001
034177     PERFORM 7000-READ-ERROR-FILE UNTIL                           08340001
034190             PS-EOF-ERROR-FILE OR                                 08350001
034200            (TR221-RPT-TYP-ERROR AND                              08360002
034300             NOT TR221-REC-TYP-HDR-CDE-HDR)                       08370002
034400*                                                                 08380001
034500     IF NOT PS-EOF-ERROR-FILE                                     08390001
034600         IF TR221-PO-NBR NUMERIC                                  08400002
034700            MOVE TR221-PO-NBR     TO DL02-PO-NBR-9                08410002
034800         ELSE                                                     08420001
034900            MOVE TR221-PO-NBR-X   TO DL02-PO-NBR-X                08430002
035000         END-IF                                                   08440001
035100         MOVE TR221-PO-NBR-X      TO PV-PO-NBR-X                  08450002
035200         MOVE TR221-EXTL-REF-NBR TO PV-EXTL-REF-NBR               08460002
035300                                     DL02-REFERENCE-NBR           08470001
035400                                                                  08480001
035500         MOVE TR221-TRN-TYP          TO PV-TRN-TYPE-PREV          08490002
035600                                                                  08500001
035700         MOVE TR221-PO-RCVD-DELY-DTE (5:2) TO                     08510004
035800                                     PV-DELY-DTE-PREV (5:2)       08520001
035900                                     DL02-EST-DEL-MON             08530001
036000         MOVE TR221-PO-RCVD-DELY-DTE (7:2) TO                     08540004
036100                                     PV-DELY-DTE-PREV (7:2)       08550001
036200                                     DL02-EST-DEL-DAY             08560001
036300         MOVE TR221-PO-RCVD-DELY-DTE (1:4) TO                     08570004
036400                                     PV-DELY-DTE-PREV (1:4)       08580001
036500                                     DL02-EST-DEL-YEAR            08590001
036600         MOVE TR221-ORGN-SHPD-FR-CDE TO                           08600028
036700                                     PV-SHPD-FR-CDE-PREV          08610001
036800                                     DL02-SHPD-FR-CDE             08620001
036900                                                                  08630001
               IF TR221-PO-RCVD-DELY-DTE (1:4) = '0001' OR              08640028
                 TR221-PO-RCVD-DELY-DTE (1:4) = SPACES                  08650028
                    MOVE SPACES TO DL02-EST-SLASH-1                     08660028
                                   DL02-EST-SLASH-2                     08670028
                                   DL02-EST-DEL-MON                     08680028
                                   DL02-EST-DEL-DAY                     08690028
                                   DL02-EST-DEL-YEAR                    08700028
               ELSE                                                     08710028
                    MOVE '/'    TO DL02-EST-SLASH-1                     08720028
                                   DL02-EST-SLASH-2                     08730028
               END-IF                                                   08740028
037902*                                                                 08750001
037903         IF TR221-ERROR-TYPE NOT = 'EMT' AND                      08760028
037904            TR221-ERROR-TYPE NOT = 'IEA' OR                       08770028
037904            TR221-ERROR-TYPE = '   '                              08780028
037905              PERFORM  8000-WRITE-PAGE-HEADINGS                   08790028
037906         END-IF                                                   08800028
037907*                                                                 08810001
037908     ELSE                                                         08820027
037905          PERFORM  8000-WRITE-PAGE-HEADINGS                       08820127
037908     END-IF                                                       08821027
037909*                                                                 08830001
           IF TR221-ERROR-TYPE = 'EMT' OR                               08931032
037970        TR221-ERROR-TYPE = 'IEA' OR                               08931132
              PS-EOF-ERROR-FILE                                         08932032
037980        PERFORM 9100-EOJ-ROUTINE                                  08932132
037990        STOP RUN                                                  08932232
           ELSE                                                         08934032
              PERFORM 2025-BUILD-ERROR-RPT-DATA                         08935032
           END-IF.                                                      08936032
037992*                                                                 08940001
037993*1000-EXIT.                                                       08950001
037994*                                                                 08960001
037995* **************************************************************  08970001
037996*  PROCESSING FOR ERROR RECORDS.                                  08980001
037997******************************************************************08990001
037998 2000-PROCESS-REPORT-DATA.                                        09000001
037999                                                                  09010001
038000     MOVE SPACES TO TR221-RPT-TYP                                 09020002
038100*                                                                 09030001
038200     PERFORM 7000-READ-ERROR-FILE UNTIL                           09040001
038300             PS-EOF-ERROR-FILE OR                                 09050001
038400            (TR221-RPT-TYP-ERROR AND                              09060002
038500             NOT TR221-REC-TYP-HDR-CDE-HDR)                       09070002
038600*                                                                 09080001
038700     IF TR221-RPT-TYP-ERROR                                       09090002
038800        PERFORM 2025-BUILD-ERROR-RPT-DATA                         09100001
038900     END-IF.                                                      09110001
039000*                                                                 09120001
039100******************************************************************09130001
039200*  BUILD THE LINES FOR THE REPORT.                                09140001
039300******************************************************************09150001
039400 2025-BUILD-ERROR-RPT-DATA.                                       09160001
039500                                                                  09170001
043115     IF TR221-REC-TYP-ERD-CDE-ERD                                 09180003
043116         PERFORM 3250-MOVE-ERD-TO-DETAIL                          09190003
043117     END-IF.                                                      09200001
043118                                                                  09210001
043119     IF TR221-REC-TYP-ERDRSN-CD-ERDRSN                            09220005
043120         PERFORM 3300-MOVE-ERDRSN-TO-DETAIL                       09230005
043130     END-IF.                                                      09240001
043131                                                                  09250001
043132     IF TR221-REC-TYP-LOG-CDE-LOG                                 09260003
043133         PERFORM 3100-MOVE-LOG-TO-DETAIL                          09270003
043134     END-IF.                                                      09280001
043135                                                                  09290001
043136     IF TR221-REC-TYP-LOGVS-CDE-LOGVS                             09300005
043137         PERFORM 3150-MOVE-LOGVS-TO-DETAIL                        09310005
043138     END-IF.                                                      09320001
043139                                                                  09330001
043140     IF TR221-REC-TYP-LOGUPC-CD-LOGUPC                            09340005
043141         PERFORM 3200-MOVE-LOGUPC-TO-DETAIL                       09350005
043142     END-IF.                                                      09360001
043143*                                                                 09370001
043144     IF NOT TR221-REC-TYP-ERD-CDE-ERD AND                         09380003
043145        NOT TR221-REC-TYP-LOG-CDE-LOG AND                         09390003
043146        NOT TR221-REC-TYP-LOGUPC-CD-LOGUPC AND                    09400005
043147        NOT TR221-REC-TYP-ERDRSN-CD-ERDRSN                        09410005
043148         PERFORM 3650-MOVE-ERROR-TO-DETAIL                        09420001
043149     END-IF.                                                      09430001
043150                                                                  09440001
043151     PERFORM 2050-CHECK-FOR-PREVIOUS.                             09450001
043152     PERFORM 8100-WRITE-ERROR-RPT-DETAIL.                         09460001
043153*                                                                 09470001
043154*2000-EXIT.                                                       09480001
043155*                                                                 09490001
043156* **************************************************************  09500001
043157*  CHECKS TO SEE IF THERE IS A BREAK, IF THERE IS NOT             09510001
043158*  DATA IS NOT REPEATED FOR CONTAINER-NO AND REFERNCE-NO          09520001
043159* *************************************************************** 09530001
043160 2050-CHECK-FOR-PREVIOUS.                                         09540001
043170                                                                  09550001
043180     IF  TR221-PO-NBR-X = PV-PO-NBR-X AND                         09560002
043190         TR221-EXTL-REF-NBR = PV-EXTL-REF-NBR AND                 09570002
043200         TR221-PO-RCVD-DELY-DTE (5:2) = PV-DELY-DTE-PREV (5:2) AND09580004
043300         TR221-PO-RCVD-DELY-DTE (7:2) = PV-DELY-DTE-PREV (7:2) AND09590004
043400         TR221-PO-RCVD-DELY-DTE (1:4) = PV-DELY-DTE-PREV (1:4) AND09600004
043500         TR221-TRN-TYP               = PV-TRN-TYPE-PREV AND       09610002
043600         TR221-ORGN-SHPD-FR-CDE      = PV-SHPD-FR-CDE-PREV AND    09620002
043700        (TR221-REC-TYP-ERD-CDE-ERD OR                             09630003
043800         TR221-REC-TYP-ERDRSN-CD-ERDRSN OR                        09640005
043900         TR221-REC-TYP-LOG-CDE-LOG OR                             09650003
044000         TR221-REC-TYP-LOGVS-CDE-LOGVS OR                         09660005
044100         TR221-REC-TYP-LOGUPC-CD-LOGUPC)                          09670005
044200         CONTINUE                                                 09680001
044300     ELSE                                                         09690001
044400         IF TR221-PO-NBR NUMERIC                                  09700002
044500            MOVE TR221-PO-NBR        TO DL02-PO-NBR-9             09710002
044600         ELSE                                                     09720001
044700            MOVE TR221-PO-NBR-X      TO DL02-PO-NBR-X             09730002
044800         END-IF                                                   09740001
044900         MOVE TR221-PO-NBR-X      TO PV-PO-NBR-X                  09750002
045000         MOVE TR221-EXTL-REF-NBR TO PV-EXTL-REF-NBR               09760002
045100                                    DL02-REFERENCE-NBR            09770001
045200                                                                  09780001
045300         MOVE TR221-PO-RCVD-DELY-DTE (5:2) TO                     09790004
045400                                     PV-DELY-DTE-PREV (5:2)       09800001
045500                                     DL02-EST-DEL-MON             09810001
045600         MOVE TR221-PO-RCVD-DELY-DTE (7:2) TO                     09820004
045700                                     PV-DELY-DTE-PREV (7:2)       09830001
045800                                     DL02-EST-DEL-DAY             09840001
045900         MOVE TR221-PO-RCVD-DELY-DTE (1:4) TO                     09850004
046000                                     PV-DELY-DTE-PREV (1:4)       09860001
046100                                     DL02-EST-DEL-YEAR            09870001
046200                                                                  09880001
046300         MOVE TR221-TRN-TYP          TO PV-TRN-TYPE-PREV          09890002
046400                                                                  09900001
046500         MOVE TR221-ORGN-SHPD-FR-CDE TO                           09910002
046600                                     PV-SHPD-FR-CDE-PREV          09920001
046700                                     DL02-SHPD-FR-CDE             09930001
046800                                                                  09940001
046900        IF TR221-PO-RCVD-DELY-DTE (1:4) = '0001' OR               09950004
047000          TR221-PO-RCVD-DELY-DTE (1:4) = SPACES                   09960004
047100             MOVE SPACES TO DL02-EST-SLASH-1                      09970001
047200                            DL02-EST-SLASH-2                      09980001
047300                            DL02-EST-DEL-MON                      09990001
047400                            DL02-EST-DEL-DAY                      10000001
047500                            DL02-EST-DEL-YEAR                     10010001
047600        ELSE                                                      10020001
047700             MOVE '/'    TO DL02-EST-SLASH-1                      10030001
047800                            DL02-EST-SLASH-2                      10040001
047900        END-IF                                                    10050001
048000                                                                  10060001
048100         INITIALIZE     PS-ERD-SW                                 10070003
048200                        PS-LOG-SW                                 10080003
048300                        PS-LOGVS-SW                               10090005
048400                        PS-LOGUPC-SW                              10100005
048500                        PS-ERDRSN-SW                              10110005
048600         SET PS-NEW-PO           TO TRUE                          10120001
048700         SET PS-NEW-PAGE         TO TRUE                          10130001
048800         PERFORM  8000-WRITE-PAGE-HEADINGS                        10140001
048900     END-IF.                                                      10150001
049000                                                                  10160001
049100     IF PV-LINES-USED >= PC-PAGE-SIZE-055                         10170001
049200        SET PS-NEW-PAGE  TO TRUE                                  10180001
049300        SET PS-LOG-NO TO TRUE                                     10190003
049400        SET PS-LOGVS-NO TO TRUE                                   10200005
049500        SET PS-LOGUPC-NO TO TRUE                                  10210005
049600        SET PS-ERD-NO TO TRUE                                     10220003
049700        SET PS-ERDRSN-NO TO TRUE                                  10230005
049800        PERFORM 8000-WRITE-PAGE-HEADINGS                          10240001
049900     END-IF.                                                      10250001
049901*                                                                 10260001
049902******************************************************************10270001
049903* SELECT VENDOR NAME FROM TPURCHS.                                10280001
049904******************************************************************10290001
049905*                                                                 10300001
049906 2060-SELECT-VENDOR-NAME.                                         10310001
049907                                                                  10320001
049908     MOVE TR221-PO-NBR         TO  PURCHS-PO-NBR.                 10330002
049909     MOVE PC-A                 TO  PURCHS-VER-STATUS-CDE.         10340001
049910                                                                  10350001
049911     EXEC SQL                                                     10360001
049912           SELECT DISTINCT                                        10370001
049913                  A.ENT_NAME_DESC                                 10380001
050300           INTO   :ENTNME-ENT-NAME-DESC                           10390001
050800           FROM   TENTNME A,                                      10400001
050900                  TPURCHS B                                       10410001
051000           WHERE  B.PO_NBR       = :PURCHS-PO-NBR                 10420001
051100           AND    A.ENT_ID       = B.ENT_ID                       10430001
051200           AND    VER_STATUS_CDE = :PURCHS-VER-STATUS-CDE         10440001
051300           AND    A.TYPE_CDE    = :PC-01                          10450001
051400                                                                  10460001
051900     END-EXEC.                                                    10470001
052000                                                                  10480001
052100     EVALUATE TRUE                                                10490001
052200         WHEN SQLCODE = 0                                         10500001
052300             MOVE ENTNME-ENT-NAME-DESC   TO DL02-VENDOR-NAME      10510001
052400         WHEN SQLCODE = +100                                      10520001
052500             MOVE SPACES                 TO DL02-VENDOR-NAME      10530001
053000         WHEN SQLCODE = -904                                      10540001
053100         WHEN SQLCODE = -911                                      10550001
053200             MOVE SPACES                 TO DL02-VENDOR-NAME      10560001
053300             CONTINUE                                             10570001
054600     END-EVALUATE.                                                10580001
054700*                                                                 10590001
208800******************************************************************10600001
208900* CHECKS TO SEE IF THE POE-CDE ON MAINFRAME IS VALID (ACTIVE).   *10610001
208910* ALSO, CHECKS THE LANDBRIGDE NAME.                              *10620001
209000******************************************************************10630001
209100 3010-EDIT-POE-LBD.                                               10640001
209200                                                                  10650001
013527     MOVE SPACES TO               DL06-A-EST-DTE-MM               10660001
013529                                  DL06-A-EST-DTE-DD               10670001
013531                                  DL06-A-EST-DTE-YY               10680001
013527     MOVE SPACES TO               DL06-A-EST-SLASH-1              10690001
                                        DL06-A-EST-SLASH-2              10700001
209200                                                                  10710001
209210     IF TR221-ERD-DEST-POE-CDE = SPACES  AND                      10720003
209220        TR221-ERD-EST-LBD-NM   = SPACES                           10730003
210420         CONTINUE                                                 10740001
210600     ELSE                                                         10750001
210610         IF TR221-ERD-EST-LBD-NM = SPACES                         10760003
210620             PERFORM 3015-POE-CHECK                               10770001
210621         ELSE                                                     10780001
210622             IF TR221-ERD-DEST-POE-CDE = SPACES                   10790003
                        MOVE TR221-ERD-POE-DELY-DTE (1:4)  TO           10800003
                              DL06-A-EST-DTE-YY                         10810001
                        MOVE TR221-ERD-POE-DELY-DTE (5:2)  TO           10820003
                              DL06-A-EST-DTE-MM                         10830001
                        MOVE TR221-ERD-POE-DELY-DTE (7:2)  TO           10840003
                              DL06-A-EST-DTE-DD                         10850001
                                                                        10860001
                     IF TR221-ERD-POE-DELY-DTE(1:4) = '0001' OR         10870003
                       TR221-ERD-POE-DELY-DTE(1:4) = SPACES             10880003
                          MOVE SPACES TO DL06-A-EST-SLASH-1             10890001
                                         DL06-A-EST-SLASH-2             10900001
                                         DL06-A-EST-DTE-MM              10910001
                                         DL06-A-EST-DTE-DD              10920001
                                         DL06-A-EST-DTE-YY              10930001
                     ELSE                                               10940001
                          MOVE '/'    TO DL06-A-EST-SLASH-1             10950001
                                         DL06-A-EST-SLASH-2             10960001
                     END-IF                                             10970001
                   ELSE                                                 10980001
                   IF TR221-ERD-DEST-POE-CDE = SPACES                   10990003
                        MOVE TR221-ERD-POE-DELY-DTE (1:4)  TO           11000003
                              DL06-A-EST-DTE-YY                         11010001
                        MOVE TR221-ERD-POE-DELY-DTE (5:2)  TO           11020003
                              DL06-A-EST-DTE-MM                         11030001
                        MOVE TR221-ERD-POE-DELY-DTE (7:2)  TO           11040003
                              DL06-A-EST-DTE-DD                         11050001
                                                                        11060001
                     IF TR221-ERD-POE-DELY-DTE(1:4) = '0001' OR         11070003
                       TR221-ERD-POE-DELY-DTE(1:4) = SPACES             11080003
                          MOVE SPACES TO DL06-A-EST-SLASH-1             11090001
                                         DL06-A-EST-SLASH-2             11100001
                                         DL06-A-EST-DTE-MM              11110001
                                         DL06-A-EST-DTE-DD              11120001
                                         DL06-A-EST-DTE-YY              11130001
                     ELSE                                               11140001
                          MOVE '/'    TO DL06-A-EST-SLASH-1             11150001
                                         DL06-A-EST-SLASH-2             11160001
                     END-IF                                             11170001
                       PERFORM 3015-POE-CHECK                           11180001
                   END-IF                                               11190001
               END-IF                                                   11200001
           END-IF.                                                      11210001
213300                                                                  11220001
213310******************************************************************11230001
213320* CHECKS TO SEE IF THE POE-CDE ON MAINFRAME IS VALID (ACTIVE).   *11240001
213330* ALSO, CHECKS THE LANDBRIGDE NAME.                              *11250001
213340******************************************************************11260001
213350 3015-POE-CHECK.                                                  11270001
213395                                                                  11280001
068000     IF TR221-ERD-DEST-POE-CDE NOT = SPACES                       11290003
213399         MOVE TR221-ERD-POE-DELY-DTE (1:4)  TO                    11300003
                     DL06-A-EST-DTE-YY                                  11310001
213403         MOVE TR221-ERD-POE-DELY-DTE (5:2)  TO                    11320003
                     DL06-A-EST-DTE-MM                                  11330001
213407         MOVE TR221-ERD-POE-DELY-DTE (7:2)  TO                    11340003
013529               DL06-A-EST-DTE-DD                                  11350001
                                                                        11360001
                   IF TR221-ERD-POE-DELY-DTE(1:4) = '0001' OR           11370003
                     TR221-ERD-POE-DELY-DTE(1:4) = SPACES               11380003
                        MOVE SPACES TO DL06-A-EST-SLASH-1               11390001
                                       DL06-A-EST-SLASH-2               11400001
                                       DL06-A-EST-DTE-MM                11410001
                                       DL06-A-EST-DTE-DD                11420001
                                       DL06-A-EST-DTE-YY                11430001
                   ELSE                                                 11440001
                        MOVE '/'    TO DL06-A-EST-SLASH-1               11450001
                                       DL06-A-EST-SLASH-2               11460001
                  END-IF                                                11470001
213426     ELSE                                                         11480001
213429         MOVE TR221-ERD-POE-DELY-DTE (1:4)  TO                    11490003
                     DL06-A-EST-DTE-YY                                  11500001
213433         MOVE TR221-ERD-POE-DELY-DTE (5:2)  TO                    11510003
                     DL06-A-EST-DTE-MM                                  11520001
213437         MOVE TR221-ERD-POE-DELY-DTE (7:2)  TO                    11530003
013529               DL06-A-EST-DTE-DD                                  11540001
                                                                        11550001
                   IF TR221-ERD-POE-DELY-DTE(1:4) = '0001' OR           11560003
                     TR221-ERD-POE-DELY-DTE(1:4) = SPACES               11570003
                        MOVE SPACES TO DL06-A-EST-SLASH-1               11580001
                                       DL06-A-EST-SLASH-2               11590001
                                       DL06-A-EST-DTE-MM                11600001
                                       DL06-A-EST-DTE-DD                11610001
                                       DL06-A-EST-DTE-YY                11620001
                   ELSE                                                 11630001
                        MOVE '/'    TO DL06-A-EST-SLASH-1               11640001
                                       DL06-A-EST-SLASH-2               11650001
                  END-IF                                                11660001
213466     END-IF.                                                      11670001
054701*                                                                 11680001
054701*                                                                 11690001
054702******************************************************************11700001
054703*MOVE LOG DATA TO REPORT DETAIL LINE                              11710003
054704******************************************************************11720001
054705 3100-MOVE-LOG-TO-DETAIL.                                         11730003
054706                                                                  11740001
054707     MOVE TR221-REC-TYP-LOG-CDE      TO                           11750003
054708                                     PV-REC-TYP-CDE-PREV          11760001
054709                                     DL03-RECD-TYPE.              11770001
054710     MOVE TR221-TRN-TYP              TO                           11780002
054720                                     DL03-TRN-TYPE                11790001
054730     MOVE TR221-LOG-C-O-PROD-CDE     TO                           11800003
054740                                     DL03-PROD-CNTRY-CDE          11810001
054750                                                                  11820001
054760     IF TR221-LOG-PO-UNT-QTY NUMERIC                              11830003
054770        MOVE TR221-LOG-PO-UNT-QTY      TO DL03-UNITS-9            11840003
054780     ELSE                                                         11850001
054790        MOVE TR221-LOG-PO-UNT-QTY-X    TO DL03-UNITS-X            11860003
054800     END-IF                                                       11870001
054900                                                                  11880001
055000     MOVE TR221-LOG-PROD-FCTRY-NM    TO                           11890003
055100                                     DL03-PROD-FCTRY-CDE          11900001
055200     MOVE TR221-LOG-CONSOL-SCAC-ID   TO                           11910003
055300                                     DL03-SCAC                    11920001
055400                                                                  11930001
055500     IF TR221-LOG-PO-CART-CNT NUMERIC                             11940003
055600        MOVE TR221-LOG-PO-CART-CNT     TO DL03-CARTONS-9          11950003
055700     ELSE                                                         11960001
055800        MOVE TR221-LOG-PO-CART-CNT-X   TO DL03-CARTONS-X          11970003
055900     END-IF                                                       11980001
056000                                                                  11990001
056100     IF TR221-LOG-PO-CBMT-QTY NUMERIC                             12000003
056200        MOVE TR221-LOG-PO-CBMT-QTY     TO DL03-CBMS-9             12010003
056300     ELSE                                                         12020001
056400        MOVE TR221-LOG-PO-CBMT-QTY-X   TO DL03-CBMS-X             12030003
056500     END-IF                                                       12040001
056600                                                                  12050001
056700     IF TR221-LOG-PO-WT-KGRM-QTY NUMERIC                          12060003
056800        MOVE TR221-LOG-PO-WT-KGRM-QTY   TO DL03-KGRMS-9           12070003
056900     ELSE                                                         12080001
057000        MOVE TR221-LOG-PO-WT-KGRM-QTY-X TO DL03-KGRMS-X           12090003
057100     END-IF                                                       12100001
057200                                                                  12110001
057300     MOVE TR221-DATA-IN-ERROR        TO                           12120002
057400                                     DL03-DATA-ERROR-3.           12130001
057500     MOVE TR221-DATA-VALUE-NUM       TO                           12140002
057600                                     DL03-DATA-VALUE-3.           12150001
057700     MOVE TR221-ERROR-TYPE           TO                           12160002
057800                                     DL03-DATA-TYPE-3.            12170001
057900     MOVE TR221-ERROR-MSG            TO                           12180002
058000                                     DL03-DATA-MSG-3.             12190001
058001*                                                                 12200001
058002******************************************************************12210001
058003*MOVE LOGVS DATA TO REPORT DETAIL LINE                            12220005
058004******************************************************************12230001
058005 3150-MOVE-LOGVS-TO-DETAIL.                                       12240005
058006                                                                  12250001
058007         MOVE TR221-REC-TYP-LOGVS-CDE    TO                       12260005
058008                                         PV-REC-TYP-CDE-PREV      12270001
058009                                         DL04-RECD-TYPE           12280001
058010         MOVE TR221-TRN-TYP              TO                       12290002
058020                                         DL04-TRN-TYPE            12300001
058030         MOVE TR221-LOGVS-VS-NBR         TO                       12310005
058040                                         DL04-VENDOR-STYLE        12320001
058050                                                                  12330001
058060         IF TR221-LOGVS-VS-CART-CNT NUMERIC                       12340005
058070            MOVE TR221-LOGVS-VS-CART-CNT TO DL04-CARTONS-9        12350005
058080         ELSE                                                     12360001
058090            MOVE TR221-LOGVS-VS-CART-CNT-X TO DL04-CARTONS-X      12370005
058100         END-IF                                                   12380001
058200                                                                  12390001
058300         IF TR221-LOGVS-VS-UNT-QTY NUMERIC                        12400005
058400            MOVE TR221-LOGVS-VS-UNT-QTY  TO DL04-UNITS-9          12410005
058500         ELSE                                                     12420001
058600            MOVE TR221-LOGVS-VS-UNT-QTY-X TO DL04-UNITS-X         12430005
058700         END-IF                                                   12440001
058800                                                                  12450001
058900         IF TR221-LOGVS-VS-CBMT-QTY NUMERIC                       12460005
059000            MOVE TR221-LOGVS-VS-CBMT-QTY  TO DL04-CBMS-9          12470005
059100         ELSE                                                     12480001
059200            MOVE TR221-LOGVS-VS-CBMT-QTY-X TO DL04-CBMS-X         12490005
059300         END-IF                                                   12500001
059400                                                                  12510001
059500         IF TR221-LOGVS-VS-WT-KGRM-QTY NUMERIC                    12520005
059600            MOVE TR221-LOGVS-VS-WT-KGRM-QTY TO DL04-KGRMS-9       12530005
059700         ELSE                                                     12540001
059800            MOVE TR221-LOGVS-VS-WT-KGRM-QTY-X TO DL04-KGRMS-X     12550005
059900         END-IF                                                   12560001
060000                                                                  12570001
060100         MOVE TR221-DATA-IN-ERROR        TO                       12580002
060200                                         DL04-DATA-ERROR-4.       12590001
060300         MOVE TR221-DATA-VALUE-NUM       TO                       12600002
060400                                         DL04-DATA-VALUE-4.       12610001
060500         MOVE TR221-ERROR-TYPE           TO                       12620002
060600                                         DL04-DATA-TYPE-4.        12630001
060700         MOVE TR221-ERROR-MSG            TO                       12640002
060800                                         DL04-DATA-MSG-4.         12650001
060801*                                                                 12660001
060802******************************************************************12670001
060803*MOVE LOGUPC DATA TO REPORT DETAIL LINE                           12680005
060804******************************************************************12690001
060805 3200-MOVE-LOGUPC-TO-DETAIL.                                      12700005
060806                                                                  12710001
060807         MOVE TR221-REC-TYP-LOGUPC-CDE      TO                    12720005
060808                                            PV-REC-TYP-CDE-PREV   12730001
060809                                            DL05-RECD-TYPE.       12740001
060810         MOVE TR221-TRN-TYP                 TO                    12750002
060820                                            DL05-TRN-TYPE.        12760001
060830         MOVE TR221-LOGUPC-VS-NBR           TO                    12770005
060840                                            DL05-VENDOR-STYLE     12780001
060850         MOVE TR221-LOGUPC-UPC-NBR          TO                    12790005
060860                                            DL05-UPC              12800001
060870                                                                  12810001
060880         IF TR221-LOGUPC-UPC-CART-CNT  NUMERIC                    12820005
060890            MOVE TR221-LOGUPC-UPC-CART-CNT  TO DL05-CARTONS-9     12830005
060900         ELSE                                                     12840001
061000            MOVE TR221-LOGUPC-UPC-CART-CNT-X TO DL05-CARTONS-X    12850005
061100         END-IF                                                   12860001
061200                                                                  12870001
061300         IF TR221-LOGUPC-UPC-UNT-QTY  NUMERIC                     12880005
061400            MOVE TR221-LOGUPC-UPC-UNT-QTY   TO DL05-UNITS-9       12890005
061500         ELSE                                                     12900001
061600            MOVE TR221-LOGUPC-UPC-UNT-QTY-X TO DL05-UNITS-X       12910005
061700         END-IF                                                   12920001
061800                                                                  12930001
061900         IF TR221-LOGUPC-UPC-CBMT-QTY NUMERIC                     12940005
062000            MOVE TR221-LOGUPC-UPC-CBMT-QTY  TO DL05-CBMS-9        12950005
062100         ELSE                                                     12960001
062200            MOVE TR221-LOGUPC-UPC-CBMT-QTY-X TO DL05-CBMS-X       12970005
062300         END-IF                                                   12980001
062400                                                                  12990001
062500         IF TR221-LOGUPC-UPC-WT-KGRM-QTY NUMERIC                  13000005
062600            MOVE TR221-LOGUPC-UPC-WT-KGRM-QTY TO DL05-KGRMS-9     13010005
062700         ELSE                                                     13020001
062800            MOVE TR221-LOGUPC-UPC-WT-KGRM-QTY-X TO DL05-KGRMS-X   13030005
062900         END-IF                                                   13040001
063000                                                                  13050001
063100         MOVE TR221-DATA-IN-ERROR           TO                    13060002
063200                                            DL05-DATA-ERROR-5.    13070001
063300         MOVE TR221-DATA-VALUE-NUM          TO                    13080002
063400                                            DL05-DATA-VALUE-5.    13090001
063500         MOVE TR221-ERROR-TYPE              TO                    13100002
063600                                            DL05-DATA-TYPE-5.     13110001
063700         MOVE TR221-ERROR-MSG               TO                    13120002
063800                                            DL05-DATA-MSG-5.      13130001
063801*                                                                 13140001
063802******************************************************************13150001
063803*MOVE ERD DATA TO REPORT DETAIL LINE                              13160003
063804******************************************************************13170001
063805 3250-MOVE-ERD-TO-DETAIL.                                         13180003
063806                                                                  13190001
063807         MOVE TR221-REC-TYP-ERD-CDE       TO                      13200003
063808                                          PV-REC-TYP-CDE-PREV     13210001
063809                                          DL06-A-RECD-TYPE.       13220001
063810         MOVE TR221-TRN-TYP               TO                      13230002
063820                                          DL06-A-TRN-TYPE.        13240001
063830         MOVE TR221-ERD-TRIP-TYP-CDE      TO                      13250003
063840                                          DL06-A-VSL-TYPE         13260001
063850         MOVE TR221-ERD-IMPRT-TRIP-ID     TO                      13270003
063860                                          DL06-A-VOYAGE-NBR       13280001
063870         MOVE TR221-ERD-CARR-SCAC-ID      TO                      13290003
063880                                          DL06-A-SCAC             13300001
061290         MOVE TR221-ERD-IMPRT-VEH-NM       TO                     13310013
063900                                          DL06-A-VESSEL-NAME      13320001
064000         MOVE TR221-ERD-POE-DELY-DTE (5:2) TO                     13330003
064100                                          DL06-A-ETA-DTE-MM       13340001
064200         MOVE TR221-ERD-POE-DELY-DTE (7:2) TO                     13350003
064300                                          DL06-A-ETA-DTE-DD       13360001
064400         MOVE TR221-ERD-POE-DELY-DTE (1:4) TO                     13370003
064500                                          DL06-A-ETA-DTE-YY       13380001
064600                                                                  13390001
064700       IF TR221-ERD-POE-DELY-DTE (1:4) = '0001' OR                13400003
064800         TR221-ERD-POE-DELY-DTE (1:4) = SPACES                    13410003
064900            MOVE SPACES TO DL06-A-ETA-SLASH-1                     13420001
065000                           DL06-A-ETA-SLASH-2                     13430001
065100                           DL06-A-ETA-DTE-MM                      13440001
065200                           DL06-A-ETA-DTE-DD                      13450001
065300                           DL06-A-ETA-DTE-YY                      13460001
065400       ELSE                                                       13470001
065500            MOVE '/'    TO DL06-A-ETA-SLASH-1                     13480001
065600                           DL06-A-ETA-SLASH-2                     13490001
065700       END-IF                                                     13500001
065800                                                                  13510001
065900         MOVE TR221-ERD-DPRTR-DTE (5:2)   TO                      13520003
066000                                          DL06-A-ETD-DTE-MM       13530001
066100         MOVE TR221-ERD-DPRTR-DTE (7:2)   TO                      13540003
066200                                          DL06-A-ETD-DTE-DD       13550001
066300         MOVE TR221-ERD-DPRTR-DTE (1:4)   TO                      13560003
066400                                          DL06-A-ETD-DTE-YY       13570001
066500                                                                  13580001
066600       IF TR221-ERD-DPRTR-DTE (1:4) = '0001' OR                   13590003
066700         TR221-ERD-DPRTR-DTE (1:4) = SPACES                       13600003
066800            MOVE SPACES TO DL06-A-ETD-SLASH-1                     13610001
066900                           DL06-A-ETD-SLASH-2                     13620001
067000                           DL06-A-ETD-DTE-MM                      13630001
067100                           DL06-A-ETD-DTE-DD                      13640001
067200                           DL06-A-ETD-DTE-YY                      13650001
067300       ELSE                                                       13660001
067400            MOVE '/'    TO DL06-A-ETD-SLASH-1                     13670001
067500                           DL06-A-ETD-SLASH-2                     13680001
067600       END-IF                                                     13690001
067700                                                                  13700001
067800       MOVE TR221-ERD-FOB-CDE           TO                        13710003
067900                                        DL06-A-POL                13720001
068000       MOVE TR221-ERD-DEST-POE-CDE      TO                        13730003
068100                                        DL06-A-POE                13740001
068000       MOVE TR221-ERD-EST-LBD-NM        TO                        13750003
                                              DL06-A-EST-LBD-DEST       13760001
208200       PERFORM 3010-EDIT-POE-LBD                                  13770001
068200                                                                  13780001
068300       MOVE TR221-DATA-IN-ERROR         TO                        13790002
068400                                        DL06-DATA-ERROR-6.        13800001
068500       MOVE TR221-DATA-VALUE-NUM        TO                        13810002
068600                                        DL06-DATA-VALUE-6.        13820001
068700       MOVE TR221-ERROR-TYPE            TO                        13830002
068800                                        DL06-DATA-TYPE-6.         13840001
068900       MOVE TR221-ERROR-MSG             TO                        13850002
069000                                        DL06-DATA-MSG-6.          13860001
069001*                                                                 13870001
069002******************************************************************13880001
069003*MOVE ERDRSN DATA TO REPORT DETAIL LINE                           13890005
069004******************************************************************13900001
069005 3300-MOVE-ERDRSN-TO-DETAIL.                                      13910005
069006                                                                  13920001
069007         IF TR221-PO-NBR-X = PV-PO-NBR-X                          13930002
069008            SET PS-NOT-NEW-PO        TO TRUE                      13940001
069009         ELSE                                                     13950001
069010            SET PS-NEW-PO            TO TRUE                      13960001
069020            SET PS-ERDRSN-NO         TO TRUE                      13970005
069030         END-IF.                                                  13980001
069040                                                                  13990001
069050         IF TR221-PO-NBR NUMERIC                                  14000002
069060            MOVE TR221-PO-NBR        TO DL02-PO-NBR-9             14010002
069070         ELSE                                                     14020001
069080            MOVE TR221-PO-NBR-X      TO DL02-PO-NBR-X             14030002
069090         END-IF.                                                  14040001
069100                                                                  14050001
069400                                                                  14060001
069500       MOVE TR221-REC-TYP-ERDRSN-CDE TO                           14070005
069600                                     PV-REC-TYP-CDE-PREV          14080001
069700                                     DL07-A-RECD-TYPE.            14090001
069800       MOVE TR221-TRN-TYP            TO                           14100002
069900                                     DL07-A-TRN-TYPE              14110001
070000       MOVE TR221-ERDRSN-IMPRT-TRIP-ID TO                         14120005
070100                                     DL07-A-VOYAGE-NBR            14130001
070200       MOVE TR221-ERDRSN-CARR-SCAC-ID TO                          14140005
070300                                     DL07-A-SCAC                  14150001
070400       MOVE TR221-ERDRSN-POE-DELY-DTE (5:2) TO                    14160005
070500                                     DL07-A-ETA-DTE-MM            14170001
070600       MOVE TR221-ERDRSN-POE-DELY-DTE (7:2) TO                    14180005
070700                                     DL07-A-ETA-DTE-DD            14190001
070800       MOVE TR221-ERDRSN-POE-DELY-DTE (1:4) TO                    14200005
070900                                     DL07-A-ETA-DTE-YY            14210001
071000                                                                  14220001
071100       IF TR221-ERDRSN-POE-DELY-DTE (1:4) = '0001' OR             14230005
071200         TR221-ERDRSN-POE-DELY-DTE (1:4) = SPACES                 14240005
071300            MOVE SPACES TO DL07-A-ETA-SLASH-1                     14250001
071400                           DL07-A-ETA-SLASH-2                     14260001
071500                           DL07-A-ETA-DTE-MM                      14270001
071600                           DL07-A-ETA-DTE-DD                      14280001
071700                           DL07-A-ETA-DTE-YY                      14290001
071800       ELSE                                                       14300001
071900            MOVE '/'    TO DL07-A-ETA-SLASH-1                     14310001
072000                           DL07-A-ETA-SLASH-2                     14320001
072100       END-IF                                                     14330001
072200                                                                  14340001
072300       MOVE TR221-ERDRSN-DPRTR-DTE (5:2) TO                       14350005
072400                                     DL07-A-ETD-DTE-MM            14360001
072500       MOVE TR221-ERDRSN-DPRTR-DTE (7:2) TO                       14370005
072600                                     DL07-A-ETD-DTE-DD            14380001
072700       MOVE TR221-ERDRSN-DPRTR-DTE (1:4) TO                       14390005
072800                                     DL07-A-ETD-DTE-YY            14400001
072900                                                                  14410001
073000       IF TR221-ERDRSN-DPRTR-DTE (1:4) = '0001' OR                14420005
073100         TR221-ERDRSN-DPRTR-DTE (1:4) = SPACES                    14430005
073200            MOVE SPACES TO DL07-A-ETD-SLASH-1                     14440001
073300                           DL07-A-ETD-SLASH-2                     14450001
073400                           DL07-A-ETD-DTE-MM                      14460001
073500                           DL07-A-ETD-DTE-DD                      14470001
073600                           DL07-A-ETD-DTE-YY                      14480001
073700       ELSE                                                       14490001
073800            MOVE '/'    TO DL07-A-ETD-SLASH-1                     14500001
073900                           DL07-A-ETD-SLASH-2                     14510001
074000       END-IF                                                     14520001
074100                                                                  14530001
074200       MOVE TR221-ERDRSN-VOY-CHG-RSN-DESC TO                      14540005
074300                                     DL07-A-VOYAGE-CHANGE         14550001
074400       MOVE TR221-DATA-IN-ERROR          TO                       14560002
074500                                     DL07-DATA-ERROR-7.           14570001
074600       MOVE TR221-DATA-VALUE-NUM         TO                       14580002
074700                                     DL07-DATA-VALUE-7.           14590001
074800       MOVE TR221-ERROR-TYPE             TO                       14600002
074900                                     DL07-DATA-TYPE-7.            14610001
075000       MOVE TR221-ERROR-MSG              TO                       14620002
075100                                     DL07-DATA-MSG-7.             14630001
075200*                                                                 14640001
075300                                                                  14650001
091702******************************************************************14660001
091703*3650-MOVE-ERROR-TO-DETAIL.                                       14670001
091704******************************************************************14680001
091705 3650-MOVE-ERROR-TO-DETAIL.                                       14690001
091706                                                                  14700001
091707     SET PS-NEW-PO               TO TRUE.                         14710014
091708     SET PS-ERD-NO               TO TRUE.                         14720014
091709     SET PS-LOG-NO               TO TRUE.                         14730014
091710*    SET PS-LOGVS-NO             TO TRUE.                         14740014
091720*    SET PS-LOGUPC-NO            TO TRUE.                         14750014
091730*    SET PS-ERDRSN-NO            TO TRUE.                         14760014
091740                                                                  14770001
091750     MOVE TR221-DATA-IN-ERROR    TO DL03-DATA-ERROR-3.            14780002
091760     MOVE TR221-DATA-VALUE-NUM   TO DL03-DATA-VALUE-3.            14790002
091770     MOVE TR221-ERROR-TYPE       TO DL03-DATA-TYPE-3.             14800002
091780     MOVE TR221-ERROR-MSG        TO DL03-DATA-MSG-3.              14810002
091781                                                                  14820001
091782******************************************************************14830001
091783*MOVE DATA TO REPORT DETAIL LINE                                  14840001
091784                                                                  14850001
091785******************************************************************14860001
091786*  READ THE ERROR-FILE                                           *14870001
091787******************************************************************14880001
091788 7000-READ-ERROR-FILE.                                            14890001
091789                                                                  14900001
091790     READ ERROR-FILE                                              14910001
091791       INTO TR221-RECORD                                          14920002
091792         AT END                                                   14930001
091793           SET PS-EOF-ERROR-FILE TO TRUE.                         14940001
092320                                                                  14950001
092330     IF TR221-REC-TYP-HDR-CDE-HDR                                 14960002
092340        MOVE TR221-HDR-CONSOL-TRNS-DTE (5:2) TO                   14970002
092350             HL-TRANS-MM                                          14980001
092360        MOVE TR221-HDR-CONSOL-TRNS-DTE (7:2) TO                   14990002
092370             HL-TRANS-DD                                          15000001
092380        MOVE TR221-HDR-CONSOL-TRNS-DTE (3:2) TO                   15010002
092390             HL-TRANS-YY                                          15020001
092400        MOVE TR221-HDR-CONSOL-TRNS-TM (1:2) TO                    15030002
092500             HL-TRANS-TIME-HH                                     15040001
092600        MOVE TR221-HDR-CONSOL-TRNS-TM (3:2) TO                    15050002
092700             HL-TRANS-TIME-MM                                     15060001
092800        MOVE TR221-HDR-CONSOL-FIL-ID TO                           15070002
092900             HL1-FILE-ID                                          15080001
093000        MOVE TR221-HDR-LOAD-DTE (5:2) TO                          15090002
093100             HL-LOAD-MM                                           15100001
093200        MOVE TR221-HDR-LOAD-DTE (7:2) TO                          15110002
093300             HL-LOAD-DD                                           15120001
093400        MOVE TR221-HDR-LOAD-DTE (3:2) TO                          15130002
093500             HL-LOAD-YY                                           15140001
093600        MOVE TR221-HDR-LOAD-TM (1:2) TO                           15150002
093700             HL-LOAD-TIME-HH                                      15160001
093800        MOVE TR221-HDR-LOAD-TM (3:2) TO                           15170002
093900             HL-LOAD-TIME-MM                                      15180001
094000        MOVE TR221-HDR-CONSOL-ENTNME TO                           15190002
094100             HL1-EXPEDITOR                                        15200001
094101     END-IF.                                                      15210001
094102*                                                                 15220001
094103***************************************************************** 15230001
094104*  PRINT THE HEADINGS ON EACH PAGE.                             * 15240001
094105***************************************************************** 15250001
094106 8000-WRITE-PAGE-HEADINGS.                                        15260001
094107                                                                  15270001
094108     ADD 1                TO PV-PAGE-COUNT.                       15280001
094109     MOVE PV-PAGE-COUNT   TO DP132O-PAGE-NUMBER.                  15290001
094110*                                                                 15300015
094108     IF PV-PAGE-COUNT > 1                                         15300116
094110*                                                                 15300217
              PERFORM                                                   15300316
                  WITH TEST AFTER                                       15300516
                  VARYING PV-LINES-USED                                 15300616
                  FROM PV-LINES-USED BY 1                               15300716
                  UNTIL PV-LINES-USED GREATER THAN PC-PAGE-SIZE-060     15300821
094110*                                                                 15300917
                   IF PV-LINES-USED > PC-PAGE-SIZE-060                  15301021
                     WRITE ERROR-REPORT-RECORD                          15301116
                       FROM TRL-HEADING-LINE-1                          15301216
                         AFTER ADVANCING 2 LINES                        15301316
                   ELSE                                                 15301416
                     WRITE ERROR-REPORT-RECORD                          15301516
                       FROM PV-BLANK-LINE                               15301616
                         AFTER ADVANCING 1 LINE                         15301716
                   END-IF                                               15301816
094114*                                                                 15301917
              END-PERFORM                                               15302016
094108     END-IF.                                                      15310016
094114*                                                                 15360008
094111     WRITE ERROR-REPORT-RECORD                                    15370001
094112       FROM DP132O-STANDRD-HEADER-132-COLS                        15380001
094113         AFTER ADVANCING PAGE.                                    15390001
094114*                                                                 15400001
094115     MOVE PC-HEADING-SIZE TO PV-LINES-USED.                       15410001
094116*                                                                 15420010
069200     MOVE TR221-PO-NBR-X  TO       PV-PO-NBR-X.                   15430010
069300     PERFORM 2060-SELECT-VENDOR-NAME.                             15440010
094116*                                                                 15450001
094117     WRITE ERROR-REPORT-RECORD                                    15460001
094118       FROM HL1-HEADING-LINE-1                                    15470001
094119         AFTER ADVANCING 1 LINE.                                  15480001
094120*                                                                 15490001
094121     WRITE ERROR-REPORT-RECORD                                    15500001
094122       FROM HL1-HEADING-LINE-2                                    15510001
094123         AFTER ADVANCING 1 LINE.                                  15520001
094124                                                                  15530001
094125     WRITE ERROR-REPORT-RECORD                                    15540001
094126       FROM HL2-HEADING-LINE-1                                    15550001
094127         AFTER ADVANCING 2 LINES.                                 15560001
094128                                                                  15570001
094129     WRITE ERROR-REPORT-RECORD                                    15580001
094130       FROM HL2-HEADING-LINE-2                                    15590001
094140         AFTER ADVANCING 1 LINES.                                 15600001
094150                                                                  15610001
094160     WRITE ERROR-REPORT-RECORD                                    15620001
094170       FROM DL-DETAIL-LINE-2                                      15630001
094171         AFTER ADVANCING 1 LINES.                                 15640001
094172*                                                                 15650001
094173     WRITE ERROR-REPORT-RECORD                                    15660001
094174       FROM PV-BLANK-LINE                                         15670001
094175         AFTER ADVANCING 1 LINES.                                 15680001
094178*                                                                 15710001
094179     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   15720001
094180*                                                                 15730001
094181*8000-EXIT.                                                       15740001
094182*                                                                 15750001
094183******************************************************************15760001
094184*  WRITE THE ERROR REPORT DETAIL RECORD.                          15770001
094185******************************************************************15780001
094186 8100-WRITE-ERROR-RPT-DETAIL.                                     15790001
094187                                                                  15800001
094188                                                                  15810001
094189     IF TR221-REC-TYP-LOG-CDE-LOG                                 15820003
094190        PERFORM 8200-WRITE-LOG-RECORD                             15830003
094191     END-IF.                                                      15840001
094192                                                                  15850001
094193     IF TR221-REC-TYP-LOGVS-CDE-LOGVS                             15860005
094194        PERFORM 8250-WRITE-LOGVS-RECORD                           15870005
094195     END-IF.                                                      15880001
094200                                                                  15890001
094300     IF TR221-REC-TYP-LOGUPC-CD-LOGUPC                            15900005
094400        PERFORM 8300-WRITE-LOGUPC-RECORD                          15910005
094500     END-IF.                                                      15920001
094600                                                                  15930001
094700     IF TR221-REC-TYP-ERD-CDE-ERD                                 15940003
094800        PERFORM 8350-WRITE-ERD-RECORD                             15950003
094900     END-IF.                                                      15960001
095000                                                                  15970001
095100     IF TR221-REC-TYP-ERDRSN-CD-ERDRSN                            15980005
095200        PERFORM 8400-WRITE-ERDRSN-RECORD                          15990005
095300     END-IF.                                                      16000001
095400                                                                  16010001
098000     IF NOT TR221-REC-TYP-LOG-CDE-LOG AND                         16020003
098100        NOT TR221-REC-TYP-LOGVS-CDE-LOGVS AND                     16030005
098200        NOT TR221-REC-TYP-LOGUPC-CD-LOGUPC AND                    16040005
098300        NOT TR221-REC-TYP-ERD-CDE-ERD AND                         16050003
098400        NOT TR221-REC-TYP-ERDRSN-CD-ERDRSN                        16060005
098900        PERFORM 8750-WRITE-ERROR-RECORD                           16070001
099000     END-IF.                                                      16080001
099100                                                                  16090001
099101     IF PV-LINES-USED >= PC-PAGE-SIZE-060                         16100001
099102        SET PS-NEW-PAGE  TO TRUE                                  16110001
099103        SET PS-ERDRSN-NO TO TRUE                                  16120005
099109     END-IF.                                                      16130001
099110*                                                                 16140001
099111*                                                                 16150001
099112*8100-EXIT.                                                       16160001
099113*                                                                 16170001
099114******************************************************************16180001
099115*  WRITE THE ERROR REPORT DETAIL RECORD.                          16190001
099116******************************************************************16200001
099117 8150-WRITE-ERROR-RPT-DETAIL.                                     16210001
099118                                                                  16220001
099119     IF PV-LOG-REC-TYP-CDE-LOG                                    16230003
099120        PERFORM 8200-WRITE-LOG-RECORD                             16240003
099130     END-IF.                                                      16250001
099140                                                                  16260001
099150     IF PV-LOGVS-REC-TYP-CDE-LOGVS                                16270005
099160        PERFORM 8250-WRITE-LOGVS-RECORD                           16280005
099170     END-IF.                                                      16290001
099180                                                                  16300001
099190     IF PV-LOGUPC-REC-TYP-CDE-LOGUPC                              16310005
099200        PERFORM 8300-WRITE-LOGUPC-RECORD                          16320005
099300     END-IF.                                                      16330001
099400                                                                  16340001
099500     IF PV-ERD-REC-TYP-CDE-ERD                                    16350003
099600        PERFORM 8350-WRITE-ERD-RECORD                             16360003
099700     END-IF.                                                      16370001
099800                                                                  16380001
099900     IF PV-ERDRSN-REC-TYP-CD-ERDRSN                               16390005
100000        PERFORM 8400-WRITE-ERDRSN-RECORD                          16400005
100100     END-IF.                                                      16410001
100101                                                                  16420001
100102*    IF PV-LINES-USED > PC-PAGE-SIZE-051 AND                      16430001
100103     IF PV-LINES-USED > PC-PAGE-SIZE-060                          16440001
100104        SET PS-NEW-PAGE  TO TRUE                                  16450001
100105        SET PS-ERDRSN-NO TO TRUE                                  16460005
100106        PERFORM 8000-WRITE-PAGE-HEADINGS                          16470001
100107     END-IF.                                                      16480001
100108*                                                                 16490001
100109*8150-EXIT.                                                       16500001
100110*                                                                 16510001
100111******************************************************************16520001
100112*  PRINT LOG ERROR RECORD                                         16530003
100113******************************************************************16540001
100114 8200-WRITE-LOG-RECORD.                                           16550003
100115                                                                  16560001
100116     IF PS-ERD-YES AND                                            16570003
100117       NOT PS-NEW-PAGE                                            16580001
100118        MOVE SPACES TO HL3-TYPE-1-LNE-1                           16590001
100119                       HL3-TYPE-1-LNE-2                           16600001
100120                       HL3-TYPE-2-LNE-1                           16610001
100130                       HL3-TYPE-2-LNE-2                           16620001
100140     ELSE                                                         16630001
100150        MOVE 'RECD' TO HL3-TYPE-1-LNE-1                           16640001
100160        MOVE 'TYPE' TO HL3-TYPE-1-LNE-2                           16650001
100170        MOVE 'TRN'  TO HL3-TYPE-2-LNE-1                           16660001
100180        MOVE 'TYPE' TO HL3-TYPE-2-LNE-2                           16670001
100190     END-IF.                                                      16680001
100200                                                                  16690001
100300     WRITE ERROR-REPORT-RECORD                                    16700001
100400         FROM HL3-HEADING-LINE-1                                  16710001
100500             AFTER ADVANCING 2 LINES.                             16720001
100600     WRITE ERROR-REPORT-RECORD                                    16730001
100700         FROM HL3-HEADING-LINE-2                                  16740001
100800             AFTER ADVANCING 1 LINES.                             16750001
100900     WRITE ERROR-REPORT-RECORD                                    16760001
101000         FROM DL-DETAIL-LINE-3                                    16770001
101100             AFTER ADVANCING 1 LINES.                             16780001
101200                                                                  16790001
101300     WRITE ERROR-REPORT-RECORD                                    16800001
101400         FROM HL3-HEADING-DATA-IN-ERROR                           16810001
101500             AFTER ADVANCING 1 LINES.                             16820001
101600                                                                  16830001
101700     WRITE ERROR-REPORT-RECORD                                    16840001
101800         FROM DL-DETAIL-LINE-WITH-ERROR-3                         16850001
101900             AFTER ADVANCING 1 LINES.                             16860001
102000                                                                  16870001
102100     ADD 6 TO PV-LINES-USED.                                      16880001
102200                                                                  16890001
102300     SET PS-LOG-YES TO TRUE.                                      16900003
102400     SET PS-NOT-NEW-PAGE TO TRUE.                                 16910001
102401                                                                  16920001
102402******************************************************************16930001
102403*  PRINT LOGVS ERROR RECORD                                       16940005
102404******************************************************************16950001
102405 8250-WRITE-LOGVS-RECORD.                                         16960005
102406                                                                  16970001
102407     IF PS-LOGVS-YES AND                                          16980005
102408       NOT PS-NEW-PAGE                                            16990001
102409        MOVE SPACES TO HL4-TYPE-1-LNE-1                           17000001
102410                       HL4-TYPE-1-LNE-2                           17010001
102420                       HL4-TYPE-2-LNE-1                           17020001
102430                       HL4-TYPE-2-LNE-2                           17030001
102440     ELSE                                                         17040001
102450        MOVE 'RECD' TO HL4-TYPE-1-LNE-1                           17050001
102460        MOVE 'TYPE' TO HL4-TYPE-1-LNE-2                           17060001
102470        MOVE 'TRN'  TO HL4-TYPE-2-LNE-1                           17070001
102480        MOVE 'TYPE' TO HL4-TYPE-2-LNE-2                           17080001
102490     END-IF.                                                      17090001
102500                                                                  17100001
102600     WRITE ERROR-REPORT-RECORD                                    17110001
102700         FROM HL4-HEADING-LINE-1                                  17120001
102800     AFTER ADVANCING 2 LINES.                                     17130001
102900                                                                  17140001
103000     WRITE ERROR-REPORT-RECORD                                    17150001
103100         FROM HL4-HEADING-LINE-2                                  17160001
103200     AFTER ADVANCING 1 LINES.                                     17170001
103300                                                                  17180001
103400     WRITE ERROR-REPORT-RECORD                                    17190001
103500         FROM DL-DETAIL-LINE-4                                    17200001
103600     AFTER ADVANCING 1 LINES.                                     17210001
103700                                                                  17220001
103800     WRITE ERROR-REPORT-RECORD                                    17230001
103900         FROM HL4-HEADING-DATA-IN-ERROR                           17240001
104000     AFTER ADVANCING 1 LINES.                                     17250001
104100                                                                  17260001
104200     WRITE ERROR-REPORT-RECORD                                    17270001
104300         FROM DL-DETAIL-LINE-WITH-ERROR-4                         17280001
104400     AFTER ADVANCING 1 LINES.                                     17290001
104500                                                                  17300001
104600     ADD 6 TO PV-LINES-USED.                                      17310001
104700                                                                  17320001
104800     SET PS-LOGVS-YES TO TRUE.                                    17330005
104900     SET PS-NOT-NEW-PAGE TO TRUE.                                 17340001
104901                                                                  17350001
104902******************************************************************17360001
104903*  PRINT LOGUPC ERROR RECORD                                      17370005
104904******************************************************************17380001
104905 8300-WRITE-LOGUPC-RECORD.                                        17390005
104906                                                                  17400001
104907     IF PS-LOGUPC-YES AND                                         17410005
104908       NOT PS-NEW-PAGE                                            17420001
104909        MOVE SPACES TO HL5-RECD                                   17430001
104910        MOVE SPACES TO HL5-TRN                                    17440001
104920        MOVE SPACES TO HL5-TYPE-1                                 17450001
104930                       HL5-TYPE-2                                 17460001
104940     ELSE                                                         17470001
104950        MOVE 'RECD' TO HL5-RECD                                   17480001
104960        MOVE 'TRN'  TO HL5-TRN                                    17490001
104970        MOVE 'TYPE' TO HL5-TYPE-1                                 17500001
104980                       HL5-TYPE-2                                 17510001
104990     END-IF.                                                      17520001
105000                                                                  17530001
105100     WRITE ERROR-REPORT-RECORD                                    17540001
105200         FROM HL5-HEADING-LINE-1                                  17550001
105300     AFTER ADVANCING 2 LINES.                                     17560001
105400                                                                  17570001
105500     WRITE ERROR-REPORT-RECORD                                    17580001
105600         FROM HL5-HEADING-LINE-2                                  17590001
105700     AFTER ADVANCING 1 LINES.                                     17600001
105800                                                                  17610001
105900     WRITE ERROR-REPORT-RECORD                                    17620001
106000         FROM DL-DETAIL-LINE-5                                    17630001
106100     AFTER ADVANCING 1 LINES.                                     17640001
106200                                                                  17650001
106300     WRITE ERROR-REPORT-RECORD                                    17660001
106400         FROM HL5-HEADING-DATA-IN-ERROR                           17670001
106500     AFTER ADVANCING 1 LINES.                                     17680001
106600                                                                  17690001
106700     WRITE ERROR-REPORT-RECORD                                    17700001
106800         FROM DL-DETAIL-LINE-WITH-ERROR-5                         17710001
106900     AFTER ADVANCING 1 LINES.                                     17720001
107000                                                                  17730001
107100     ADD 6 TO PV-LINES-USED.                                      17740001
107200                                                                  17750001
107300     SET PS-LOGUPC-YES TO TRUE.                                   17760005
107400     SET PS-NOT-NEW-PAGE TO TRUE.                                 17770001
107401                                                                  17780001
107402******************************************************************17790001
107403*  PRINT ERD ERROR RECORD                                         17800003
107404******************************************************************17810001
107405 8350-WRITE-ERD-RECORD.                                           17820003
107406                                                                  17830001
107407     IF (PS-ERD-YES OR                                            17840003
107408       PS-LOG-YES) AND                                            17850003
107409       NOT PS-NEW-PAGE                                            17860001
107410        MOVE SPACES TO HL6-REC                                    17870001
107420        MOVE SPACES TO HL6-TRN                                    17880001
107430        MOVE SPACES TO HL6-TYPE-3                                 17890001
107440        MOVE SPACES TO HL6-A-TYPE-1                               17900001
107450                       HL6-A-TYPE-2                               17910001
107460                       HL6-A-TYPE-3                               17920001
107470     ELSE                                                         17930001
107480        MOVE 'RECD' TO HL6-REC                                    17940001
107490        MOVE 'TRN'  TO HL6-TRN                                    17950001
107500        MOVE 'VSL'  TO HL6-TYPE-3                                 17960001
107600        MOVE 'TYPE' TO HL6-A-TYPE-1                               17970001
107700                       HL6-A-TYPE-2                               17980001
107800                       HL6-A-TYPE-3                               17990001
107900     END-IF.                                                      18000001
108000                                                                  18010001
108100     WRITE ERROR-REPORT-RECORD                                    18020001
108200         FROM HL6-HEADING-LINE-1                                  18030001
108300     AFTER ADVANCING 2 LINES.                                     18040001
108400                                                                  18050001
108500     WRITE ERROR-REPORT-RECORD                                    18060001
108600         FROM HL6-HEADING-LINE-2-A                                18070001
108700     AFTER ADVANCING 1 LINES.                                     18080001
108800                                                                  18090001
108900     WRITE ERROR-REPORT-RECORD                                    18100001
109000         FROM DL-DETAIL-LINE-6-A                                  18110001
109100     AFTER ADVANCING 1 LINES.                                     18120001
109200                                                                  18130001
109300     WRITE ERROR-REPORT-RECORD                                    18140001
109400         FROM HL6-HEADING-DATA-IN-ERROR                           18150001
109500     AFTER ADVANCING 1 LINES.                                     18160001
109600                                                                  18170001
109700     WRITE ERROR-REPORT-RECORD                                    18180001
109800         FROM DL-DETAIL-LINE-WITH-ERROR-6                         18190001
109900     AFTER ADVANCING 1 LINES.                                     18200001
110000                                                                  18210001
110100     ADD 6 TO PV-LINES-USED.                                      18220001
110200                                                                  18230001
110300     SET PS-ERD-YES TO TRUE.                                      18240003
110400     SET PS-NOT-NEW-PAGE TO TRUE.                                 18250001
110401                                                                  18260001
110402******************************************************************18270001
110403*  PRINT ERDRSN ERROR RECORD                                      18280005
110404******************************************************************18290001
110405 8400-WRITE-ERDRSN-RECORD.                                        18300005
110406                                                                  18310001
110407     WRITE ERROR-REPORT-RECORD                                    18320001
110408           FROM HL7-HEADING-LINE-1                                18330001
110409     AFTER ADVANCING 2 LINES                                      18340001
110410                                                                  18350001
110420     WRITE ERROR-REPORT-RECORD                                    18360001
110430           FROM HL7-HEADING-LINE-2                                18370001
110440     AFTER ADVANCING 1 LINES.                                     18380001
110450                                                                  18390001
110460     WRITE ERROR-REPORT-RECORD                                    18400001
110470           FROM DL-DETAIL-LINE-7                                  18410001
110480     AFTER ADVANCING 1 LINES.                                     18420001
110490                                                                  18430001
110500     WRITE ERROR-REPORT-RECORD                                    18440001
110600           FROM HL7-HEADING-DATA-IN-ERROR                         18450001
110700           AFTER ADVANCING 1 LINES.                               18460001
110800                                                                  18470001
110900     WRITE ERROR-REPORT-RECORD                                    18480001
111000           FROM DL-DETAIL-LINE-WITH-ERROR-7                       18490001
111100           AFTER ADVANCING 1 LINES.                               18500001
111200                                                                  18510001
111300     ADD 9 TO PV-LINES-USED.                                      18520001
111400                                                                  18530001
111500     SET PS-ERDRSN-YES TO TRUE.                                   18540005
111600     SET PS-NOT-NEW-PAGE TO TRUE.                                 18550001
111700                                                                  18560001
145101*                                                                 18570001
145102******************************************************************18580001
145103*  PRINT ERROR  ERROR RECORD                                      18590001
145104******************************************************************18600001
145105 8750-WRITE-ERROR-RECORD.                                         18610001
145106                                                                  18620001
145107      IF  PS-NEW-PAGE OR                                          18630001
145108          PS-ERD-NO OR                                            18640003
145109          PS-NEW-PO                                               18650001
145110            WRITE ERROR-REPORT-RECORD                             18660001
145120                  FROM HL6-HEADING-LINE-1                         18670001
145130            AFTER ADVANCING 2 LINES                               18680001
145140                                                                  18690001
145150            SET PS-NOT-NEW-PAGE TO TRUE                           18700001
145160                                                                  18710001
145170            ADD 3 TO PV-LINES-USED                                18720001
145180     END-IF.                                                      18730001
145190                                                                  18740001
145200     WRITE ERROR-REPORT-RECORD                                    18750001
145300         FROM HL2-HEADING-LINE-1                                  18760001
145400             AFTER ADVANCING 2 LINES.                             18770001
145500                                                                  18780001
145600     WRITE ERROR-REPORT-RECORD                                    18790001
145700         FROM HL3-HEADING-DATA-IN-ERROR                           18800001
145800             AFTER ADVANCING 1 LINES.                             18810001
145900                                                                  18820001
146000     WRITE ERROR-REPORT-RECORD                                    18830001
146100         FROM DL-DETAIL-LINE-WITH-ERROR-3                         18840001
146200             AFTER ADVANCING 1 LINES.                             18850001
146300                                                                  18860001
146400     ADD 4 TO PV-LINES-USED.                                      18870001
146401                                                                  18880001
146402******************************************************************18890001
146403*  PRINT END OF REPORT MESSAGE, CLOSE THE OUTPUT FILE, AND CLOSE  18900001
146404*  THE CURSOR.                                                    18910001
146405******************************************************************18920001
146406 9000-EOJ-ROUTINE.                                                18930001
146407                                                                  18940001
146408     IF NOT TR221-RPT-TYP-ERROR AND                               18950002
146409       TR221-RPT-TYP NOT = SPACES                                 18960002
146410        PERFORM  8150-WRITE-ERROR-RPT-DETAIL                      18970001
146411     END-IF.                                                      18980001
146412                                                                  18990001
146413     ADD 2 TO PV-LINES-USED.                                      19000001
146414                                                                  19010001
146415     IF PV-LINES-USED > PC-PAGE-SIZE-060                          19020001
146416        PERFORM 8000-WRITE-PAGE-HEADINGS                          19030001
146417     END-IF.                                                      19040001
146418                                                                  19050001
146419     WRITE ERROR-REPORT-RECORD                                    19060001
146420         FROM ER-END-OF-REPORT-LINE                               19070001
146421             AFTER ADVANCING 2 LINES.                             19080001
146422                                                                  19090001
146423     CLOSE ERROR-FILE                                             19100001
146424           ERROR-REPORT-FILE.                                     19110001
146425*                                                                 19120001
146426*9000-EXIT.                                                       19130001
146427*                                                                 19140001
146428******************************************************************19150001
146429*  PRINTS REPORT MESSAGE IF THERE IS NO DATA ON THE FILE          19160001
146430******************************************************************19170001
146431 9100-EOJ-ROUTINE.                                                19180001
146432*                                                                 19190001
146433     WRITE ERROR-REPORT-RECORD                                    19200001
146434         FROM EP-EMPTY-REPORT-LINE                                19210001
146435             AFTER ADVANCING 2 LINES.                             19220001
146436                                                                  19230001
146437                                                                  19240001
146438     WRITE ERROR-REPORT-RECORD                                    19250001
146439         FROM ER-END-OF-REPORT-LINE                               19260001
146440             AFTER ADVANCING 2 LINES.                             19270001
146441                                                                  19280001
146442     CLOSE ERROR-FILE                                             19290001
146443           ERROR-REPORT-FILE.                                     19300001
146444*                                                                 19310001
146445*9100-EXIT.                                                       19320001
146446                                                                  19330001
