000100 IDENTIFICATION DIVISION.                                         00010003
000200 PROGRAM-ID.      XSKRP009.                                       00020003
000300 AUTHOR.          DOUG JONES.                                     00030003
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040003
000500 DATE-WRITTEN.    01/17/2003.                                     00050003
000600 DATE-COMPILED.                                                   00060003
000700******************************************************************00070003
000800**XS DOMAIN TABLE INTEGRITY PROCESS - FOR TABLE XST_VND           00080003
000900******************************************************************00090003
001000**THIS PROGRAM VALIDATES THE DATA IN THE XS DOMAIN IS THE SAME    00100003
001100**AS THE DATA IN THE SOR                                          00110003
001200******************************************************************00120003
001300 ENVIRONMENT DIVISION.                                            00130003
001400 CONFIGURATION SECTION.                                           00140003
001500 SOURCE-COMPUTER.        IBM-3090.                                00150003
001600 OBJECT-COMPUTER.        IBM-3090.                                00160003
001700 INPUT-OUTPUT SECTION.                                            00170003
001800 FILE-CONTROL.                                                    00180003
001900                                                                  00190003
002000     SELECT SKIP-RECD-CNTL-FILE                                   00200005
002100            ASSIGN TO INP01.                                      00210003
002400     SELECT SOR-VND-EXTRACT-FILE                                  00240009
002500            ASSIGN TO INP02.                                      00250061
002600     SELECT XS-VND-EXTRACT-FILE                                   00260009
002700            ASSIGN TO INP03.                                      00270061
002800     SELECT XS-VND-INTEG-RPT-FILE                                 00280006
002900            ASSIGN TO RPT01.                                      00290006
003000                                                                  00300003
003100 DATA DIVISION.                                                   00310003
003200 FILE SECTION.                                                    00320003
003300                                                                  00330003
003400 FD  SKIP-RECD-CNTL-FILE                                          00340005
003500     RECORDING MODE F                                             00350003
003600     BLOCK CONTAINS 0 RECORDS                                     00360003
003700     LABEL RECORDS ARE OMITTED                                    00370003
003800     DATA RECORD IS SKIP-RECD-CNTL-RECORD.                        00380005
003900 01  SKIP-RECD-CNTL-RECORD            PIC X(080).                 00390034
004700                                                                  00470005
004800 FD  SOR-VND-EXTRACT-FILE                                         00480009
004900     RECORDING MODE F                                             00490003
005000     BLOCK CONTAINS 0 RECORDS                                     00500003
005100     LABEL RECORDS ARE OMITTED                                    00510003
005200     DATA RECORD IS SOR-VND-EXTRACT-RECORD.                       00520011
005300 01  SOR-VND-EXTRACT-RECORD          PIC X(150).                  00530009
005400                                                                  00540034
005500 FD  XS-VND-EXTRACT-FILE                                          00550009
005600     RECORDING MODE F                                             00560003
005700     BLOCK CONTAINS 0 RECORDS                                     00570003
005800     LABEL RECORDS ARE OMITTED                                    00580003
005900     DATA RECORD IS XS-VND-EXTRACT-RECORD.                        00590011
006000 01  XS-VND-EXTRACT-RECORD           PIC X(043).                  00600009
006100                                                                  00610003
006200 FD  XS-VND-INTEG-RPT-FILE                                        00620006
006300     RECORDING MODE IS F                                          00630006
006400     BLOCK CONTAINS 0  RECORDS.                                   00640006
006500 01  XS-VND-INTEG-RPT-RECORD         PIC  X(200).                 00650006
006600                                                                  00660006
006700 WORKING-STORAGE SECTION.                                         00670003
006800                                                                  00680003
006900 01  FILLER                              PIC X(41)                00690034
007000     VALUE 'WORKING STORAGE STARTS HERE FOR XSKRP009'.            00700003
007100                                                                  00710003
007200 01  PS-PROGRAM-SWITCHES.                                         00720003
007300     05  PS-END-SKIP-RECD-FILE-SW        PIC X(01) VALUE 'N'.     00730005
007400         88  PS-END-SKIP-RECD-FILE                 VALUE 'Y'.     00740005
007500         88  PS-NOT-END-SKIP-RECD-FILE             VALUE 'N'.     00750005
007900     05  PS-END-OF-SOR-VND-EXTRACT-SW    PIC X(01) VALUE 'N'.     00790009
008000         88  PS-END-OF-SOR-VND-EXTRACT             VALUE 'Y'.     00800009
008100         88  PS-NOT-END-OF-SOR-VND-EXTRACT         VALUE 'N'.     00810009
008200     05  PS-END-OF-XS-VND-EXRACT-SW      PIC X(01) VALUE 'N'.     00820003
008300         88  PS-END-OF-XS-VND-EXRACT               VALUE 'Y'.     00830003
008400         88  PS-NOT-END-OF-XS-VND-EXRACT           VALUE 'N'.     00840003
008500     05  PS-VENDOR-DESCRIPTION-ERROR-SW  PIC X(01) VALUE 'N'.     00850018
008600         88  PS-VENDOR-DESCRIPTION-ERROR           VALUE 'Y'.     00860018
008700         88  PS-NO-VENDOR-DESCRIPTION-ERROR        VALUE 'N'.     00870018
008800     05  PS-VENDOR-NUMBER-ERROR-SW       PIC X(01) VALUE 'N'.     00880018
008900         88  PS-VENDOR-NUMBER-ERROR                VALUE 'Y'.     00890018
009000         88  PS-NO-VENDOR-NUMBER-ERROR             VALUE 'N'.     00900018
009100     05  PS-ERROR-FOUND-SW               PIC X(01) VALUE 'N'.     00910003
009200         88  PS-ERROR-FOUND                        VALUE 'Y'.     00920003
009300         88  PS-NO-ERROR-FOUND                     VALUE 'N'.     00930018
009400                                                                  00940003
009500 01  CC-SKIP-RECD-CNTL-FILE-LAYOUT.                               00950006
009600     05  CC-START-POINT                  PIC 9(05) VALUE ZEROS.   00960003
009700     05  FILLER                          PIC X(01) VALUE SPACES.  00970003
009800     05  CC-READ-FREQUENCY               PIC 9(05) VALUE ZEROS.   00980003
009900     05  FILLER                          PIC X(69) VALUE SPACES.  00990003
010000                                                                  01000003
010500 01  PC-PROGRAM-CONSTANTS.                                        01050003
010600     05  PC-CURRENT-PROGRAM-NAME         PIC X(08)  VALUE         01060007
010700                                                    'XSKRP009'.   01070007
010800     05  PC-REPORT-NBR-1                 PIC  9(01) VALUE 1.      01080007
010900     05  PC-ONE                          PIC  9(01) VALUE 1.      01090046
011200     05  PC-MAX-REPORT-LINES             PIC S9(05) VALUE +74     01120034
011300                                                    COMP-3.       01130034
011400                                                                  01140021
011500     05  PC-NO-ERROR-MESSAGE             PIC  X(200) VALUE        01150036
011600         'NO ERRORS'.                                             01160036
011700     05  PC-MISMATCHED-VENDOR-DESC       PIC  X(41) VALUE         01170035
011800         'THE VENDOR DESCRIPTIOINS ARE NOT IN SYNCH'.             01180035
011900                                                                  01190035
012000     05  PC-MISMATCHED-VENDOR-NBR        PIC  X(35) VALUE         01200018
012100         'THE VENDOR NUMBERS ARE NOT IN SYNCH'.                   01210018
012200                                                                  01220021
012300     05  PC-MISMATCHED-VND-NBR-AND-DESC  PIC  X(50) VALUE         01230018
012400         'THE VENDOR NUMBER AND DESCRIPTION ARE NOT IN SYNCH'.    01240018
012500                                                                  01250021
012600     05  PC-RECORD-MISSING-FROM-SOR-VND  PIC  X(53) VALUE         01260021
012700         'THE MATCHING DATA IS NOT FOUND ON THE SOR VND EXTRACT'. 01270021
012800                                                                  01280021
012900     05  PC-RECORD-MISSING-FROM-XS-VND   PIC  X(52) VALUE         01290021
013000         'THE MATCHING DATA IS NOT FOUND ON THE XS VND EXTRACT'.  01300021
013100                                                                  01310007
013200 01  PV-MISCELANEOUS.                                             01320007
013300     05  PV-TEMP-ENT-ID                  PIC  9(09) VALUE ZEROS.  01330010
013400     05  PV-PRINT-RECORD                 PIC X(200) VALUE SPACE.  01340012
013500     05  PV-LINE-SPACING                 PIC S9(04) VALUE ZEROES  01350034
013600                                                    COMP SYNC.    01360015
013700     05  PV-CURR-TIME.                                            01370025
013800        10  PV-CURR-TIME-HH              PIC  9(02) VALUE ZEROES. 01380034
013900        10  PV-CURR-TIME-MM              PIC  9(02) VALUE ZEROES. 01390034
014000        10  PV-CURR-TIME-SSHH            PIC  9(04) VALUE ZEROES. 01400034
014100                                                                  01410025
014200     05  PV-CURR-DATE-CCYYMMDD.                                   01420025
014300         10  PV-CURR-DATE-CCYY           PIC  9(04) VALUE ZEROES. 01430034
014400         10  PV-CURR-DATE-MM             PIC  9(02) VALUE ZEROES. 01440034
014500         10  PV-CURR-DATE-DD             PIC  9(02) VALUE ZEROES. 01450034
014600                                                                  01460003
014700 01  PV-PROGRAM-COUNTER.                                          01470007
014800     05  PV-PAGE-CNT                     PIC  9(05) VALUE ZEROS.  01480040
014900     05  PV-LINE-CNT                     PIC S9(07) VALUE ZEROS.  01490010
015000     05  PV-SOR-VND-RECS-READ-CNT        PIC  9(07) VALUE ZEROS.  01500039
015100     05  PV-SOR-VND-EXT-READ-SKIP-CNT    PIC  9(09) VALUE ZEROS.  01510039
015200     05  PV-XS-EXTRACT-REC-READ-CNT      PIC  9(07) VALUE ZEROS.  01520039
015300     05  PV-ERROR-RECORD-WRITTEN-CNT     PIC  9(07) VALUE ZEROS.  01530039
015400     05  PV-VALID-MATCH-CNT              PIC  9(07) VALUE ZEROS.  01540056
015500                                                                  01550007
015600 01  PV-MISC-ABEND-FIELDS.                                        01560003
015700     05  PV-PARAGRAPH-NAME               PIC  X(30) VALUE SPACE.  01570040
015800     05  PV-OPERATION-MSG-1              PIC  X(40) VALUE SPACE.  01580040
015900     05  PV-OPERATION-MSG-2              PIC  X(40) VALUE SPACE.  01590040
016000     05  PV-DB2-OPERATION                PIC  X(30) VALUE SPACE.  01600040
016100                                                                  01610003
016200 01  PV-ABEND-CODE   COMP  SYNC          PIC S9(04) VALUE +0000.  01620007
016300     88  PV-ABEND-4008-DATA-ERROR                   VALUE +4008.  01630009
016400     88  PV-ABEND-4009-CARD-ERROR                   VALUE +4009.  01640007
016600     88  PV-ABEND-4013-DB2-ERROR                    VALUE +4013.  01660007
016700                                                                  01670003
016800******************************************************************01680007
016900*  TOP OF PAGE HEADING LINE FOR PRINTING A 200 CHARACTER REPORT.  01690007
017000******************************************************************01700007
017100     COPY DPWS200.                                                01710007
017200                                                                  01720007
017300 01  HL2-HEADING-LINE-2.                                          01730007
017400     05  FILLER                  PIC X(85)   VALUE SPACES.        01740009
017500     05  FILLER                  PIC X(31)   VALUE                01750009
017600         'XS VENDOR DATA INTEGRITY ERRORS'.                       01760009
017700     05  FILLER                  PIC X(84)   VALUE SPACES.        01770009
017800                                                                  01780007
017900 01  HL3-HEADING-LINE-3.                                          01790010
018000     05  FILLER                  PIC X(01)   VALUE SPACES.        01800009
018100     05  FILLER                  PIC X(14)   VALUE                01810007
018200         '---- KEY -----'.                                        01820007
018300     05  FILLER                  PIC X(05)   VALUE SPACES.        01830007
018400     05  FILLER                  PIC X(43)   VALUE                01840007
018500         '---------- SYSTEM OF RECORD VALUE ---------'.           01850032
018600     05  FILLER                  PIC X(05)   VALUE SPACES.        01860007
018700     05  FILLER                  PIC X(43)   VALUE                01870007
018800         '------------- XS DOMAIN VALUE -------------'.           01880032
018900     05  FILLER                  PIC X(05)   VALUE SPACES.        01890007
019000     05  FILLER                  PIC X(45)   VALUE                01900007
019100         '------------------------------- ERROR MESSAGE'.         01910007
019200     05  FILLER                  PIC X(31)   VALUE                01920007
019300         ' ------------------------------'.                       01930007
019400     05  FILLER                  PIC X(08)   VALUE SPACES.        01940009
019500                                                                  01950007
019600******************************************************************01960034
019700*  DETAIL LINE LAYOUT FOR THE ERROR REPORT.                       01970034
019800******************************************************************01980034
019900 01  DL1-DETAIL-LINE-1.                                           01990010
020000     05  FILLER                  PIC X(06)     VALUE SPACES.      02000030
020100     05  DL1-VND-ENT-ID-KEY      PIC ZZZZZZZZ9 VALUE ZEROES.      02010030
020200     05  FILLER                  PIC X(05)     VALUE SPACES.      02020030
020300     05  DL1-SOR-VND-ENT-NM-DESC PIC X(30)     VALUE SPACES.      02030030
020400     05  FILLER                  PIC X(04)     VALUE SPACES.      02040030
020500     05  DL1-SOR-VND-NUMBER      PIC ZZZZZZZZZ VALUE ZEROES.      02050031
020600     05  FILLER                  PIC X(05)     VALUE SPACES.      02060030
020700     05  DL1-XS-VND-ENT-NM-DESC  PIC X(30)     VALUE SPACES.      02070030
020800     05  FILLER                  PIC X(04)     VALUE SPACES.      02080030
020900     05  DL1-XS-VND-NUMBER       PIC ZZZZZZZZZ VALUE ZEROES.      02090031
021000     05  FILLER                  PIC X(05)     VALUE SPACES.      02100030
021100     05  DL1-ERROR-MESSAGE       PIC X(75)     VALUE SPACES.      02110030
021200     05  FILLER                  PIC X(09)     VALUE SPACES.      02120030
021300                                                                  02130010
021400******************************************************************02140034
021500*  TRAILER LAYOUT FOR THE ERROR REPORT.                           02150034
021600******************************************************************02160034
021700 01  TR1-TRAILER-LINE-1.                                          02170007
021800     05  FILLER                  PIC X(25)   VALUE                02180010
021900         ' TOTAL NUMBER OF ERRORS: '.                             02190010
022000     05  TR1-TOTAL-ERROR-CNT     PIC Z(09)   VALUE ZEROS.         02200053
022100     05  FILLER                  PIC X(166)  VALUE SPACES.        02210010
022200                                                                  02220007
022300******************************************************************02230007
022400**COPYBOOKS                                                       02240003
022500******************************************************************02250003
022600                                                                  02260003
022700***VND EXTRACT FILE LAYOUT                                        02270003
022800     COPY VNRD100.                                                02280003
022900                                                                  02290003
023000***XS EXTRACT FILE LAYOUT                                         02300003
023100     COPY XSRD026.                                                02310003
023200                                                                  02320003
023300***************************************************************** 02330007
023400 PROCEDURE DIVISION.                                              02340003
023500***************************************************************** 02350003
023600 0000-MAINLINE.                                                   02360007
023700                                                                  02370003
023800     PERFORM 1000-INITIALIZATION.                                 02380003
023900                                                                  02390040
024000     PERFORM 2000-PROCESS-RECORDS                                 02400003
024100             UNTIL PS-END-OF-SOR-VND-EXTRACT                      02410009
024200                OR PS-END-OF-XS-VND-EXRACT.                       02420003
024300                                                                  02430040
024400     PERFORM 2500-PROCESS-EXTRA-RECORDS                           02440054
024500             UNTIL PS-END-OF-SOR-VND-EXTRACT                      02450021
024600               AND PS-END-OF-XS-VND-EXRACT.                       02460021
024700                                                                  02470003
024710     IF PV-ERROR-RECORD-WRITTEN-CNT = 0                           02471058
024720         MOVE PC-NO-ERROR-MESSAGE TO DL1-DETAIL-LINE-1            02472058
024730         MOVE DL1-DETAIL-LINE-1   TO PV-PRINT-RECORD              02473058
024740         PERFORM 8900-WRITE-REPORT-LINE                           02474058
024750     ELSE                                                         02475058
024760         MOVE PV-ERROR-RECORD-WRITTEN-CNT TO                      02476058
024770                TR1-TOTAL-ERROR-CNT                               02477058
024780         MOVE TR1-TRAILER-LINE-1  TO PV-PRINT-RECORD              02478058
024790         PERFORM 8900-WRITE-REPORT-LINE                           02479058
024791     END-IF.                                                      02479158
024792                                                                  02479258
024800     PERFORM 9000-END-OF-PGM.                                     02480003
024900                                                                  02490003
025000     GOBACK.                                                      02500003
025100                                                                  02510003
025200******************************************************************02520003
025300*1000-INITIALIZATION.                                             02530017
025400* INITIALIZATION AREA                                             02540017
025500******************************************************************02550003
025600 1000-INITIALIZATION.                                             02560003
025700                                                                  02570003
025800     INITIALIZE PV-PROGRAM-COUNTER.                               02580007
025900                                                                  02590003
026000     OPEN INPUT  SKIP-RECD-CNTL-FILE                              02600005
026200                 SOR-VND-EXTRACT-FILE                             02620009
026300                 XS-VND-EXTRACT-FILE.                             02630009
026400                                                                  02640009
026500     OPEN OUTPUT XS-VND-INTEG-RPT-FILE.                           02650009
026600                                                                  02660003
026700     READ SKIP-RECD-CNTL-FILE INTO CC-SKIP-RECD-CNTL-FILE-LAYOUT  02670007
026800        AT END                                                    02680005
026900           SET PS-END-SKIP-RECD-FILE TO TRUE.                     02690005
027000                                                                  02700005
027100     IF PS-END-SKIP-RECD-FILE                                     02710005
027200         MOVE '1000-INITIALIZE' TO PV-PARAGRAPH-NAME              02720005
027300         MOVE 'NO SKIP RECD CNTL FILE DATA' TO PV-OPERATION-MSG-1 02730005
027400         SET PV-ABEND-4009-CARD-ERROR TO TRUE                     02740005
027500         PERFORM 9999-ABEND                                       02750005
027600     END-IF.                                                      02760005
027700                                                                  02770006
027800     CLOSE SKIP-RECD-CNTL-FILE.                                   02780006
029200                                                                  02920006
029300     PERFORM 7000-READ-SOR-VND-EXTRACT                            02930009
029400        UNTIL PV-SOR-VND-EXT-READ-SKIP-CNT  = CC-START-POINT      02940014
029500                OR PS-END-OF-SOR-VND-EXTRACT.                     02950009
029600                                                                  02960005
029700     IF PS-END-OF-SOR-VND-EXTRACT                                 02970009
029800         MOVE '1000-INITIALIZE' TO PV-PARAGRAPH-NAME              02980009
029900         MOVE 'END OF SOR VND FILE HIT' TO PV-OPERATION-MSG-1     02990009
030000         SET PV-ABEND-4008-DATA-ERROR TO TRUE                     03000009
030100         PERFORM 9999-ABEND                                       03010009
030200     END-IF.                                                      03020009
030300                                                                  03030009
030400     IF CC-READ-FREQUENCY = PC-ONE                                03040046
030500        PERFORM 7100-READ-XS-VND-EXTRACT CC-START-POINT TIMES     03050046
030600     ELSE                                                         03060046
030700        PERFORM 7100-READ-XS-VND-EXTRACT UNTIL                    03070046
030800                 XS026-ENT-ID >= VN100-ENT-ID                     03080047
030900     END-IF.                                                      03090046
031000                                                                  03100044
031100     ACCEPT PV-CURR-TIME FROM TIME.                               03110025
031200     MOVE PV-CURR-TIME-HH          TO DP200-RUN-HOUR.             03120025
031300     MOVE PV-CURR-TIME-MM          TO DP200-RUN-MINUTE.           03130025
031400                                                                  03140025
031500     MOVE FUNCTION CURRENT-DATE (1:8)                             03150025
031600                                   TO PV-CURR-DATE-CCYYMMDD.      03160025
031700                                                                  03170025
031800     MOVE PV-CURR-DATE-MM          TO DP200-RUN-MONTH.            03180025
031900     MOVE PV-CURR-DATE-DD          TO DP200-RUN-DAY.              03190025
032000     MOVE PV-CURR-DATE-CCYY        TO DP200-RUN-YEAR.             03200025
032100                                                                  03210025
032200     MOVE PC-CURRENT-PROGRAM-NAME  TO DP200-PROGRAM-NAME.         03220026
032300                                                                  03230026
032400     PERFORM 8700-REPORT-HEADER-ROUTINE.                          03240022
032500                                                                  03250003
032600******************************************************************03260003
032700*2000-PROCESS-RECORDS.                                            03270017
032800* THIS SECTION COMPARES RECORDS ON THE SOR VENDOR FILE AND XS     03280035
032900* DOMAIN VENDOR EXTRACT FILE.  IF THE KEYS MATCH, THE PROGRAM     03290035
033000* WILL DO A FIELD BY FIELD COMPARE.  ANY DIFFERENCES WILL CAUSE   03300035
033100* A MESSAGE TO BE WRITTEN TO THE ERROR FILE, ALONG WITH THE DATA  03310035
033200* ON THE CORRESPONDING FILES.                                     03320035
033300******************************************************************03330003
033400 2000-PROCESS-RECORDS.                                            03340003
033500                                                                  03350003
033600     INITIALIZE DL1-DETAIL-LINE-1.                                03360012
033700     MOVE ZEROS TO PV-SOR-VND-EXT-READ-SKIP-CNT.                  03370020
033800                                                                  03380003
033900     EVALUATE TRUE                                                03390003
034000        WHEN VN100-ENT-ID = XS026-ENT-ID                          03400012
034100             PERFORM 2100-COMPARE-FIELDS                          03410003
034200             PERFORM 7000-READ-SOR-VND-EXTRACT                    03420018
034300                UNTIL PV-SOR-VND-EXT-READ-SKIP-CNT  =             03430018
034400                       CC-READ-FREQUENCY OR                       03440044
034500                       PS-END-OF-SOR-VND-EXTRACT                  03450044
034600             IF CC-READ-FREQUENCY = PC-ONE                        03460046
034700                PERFORM 7100-READ-XS-VND-EXTRACT                  03470046
034800                   CC-START-POINT TIMES                           03480046
034900             ELSE                                                 03490046
035000                PERFORM 7100-READ-XS-VND-EXTRACT UNTIL            03500046
035100                   XS026-ENT-ID >= VN100-ENT-ID                   03510047
035200             END-IF                                               03520046
035300        WHEN VN100-ENT-ID < XS026-ENT-ID                          03530020
035400             PERFORM 2600-CHECK-IF-NEW-PG-NEEDED                  03540024
035500             PERFORM 2700-MOVE-SOR-VALUES                         03550032
035600             MOVE PC-RECORD-MISSING-FROM-XS-VND                   03560032
035700                TO DL1-ERROR-MESSAGE                              03570032
035800             MOVE DL1-DETAIL-LINE-1 TO PV-PRINT-RECORD            03580022
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                03590022
036000             PERFORM 8900-WRITE-REPORT-LINE                       03600022
036100             PERFORM 7000-READ-SOR-VND-EXTRACT                    03610020
036200        WHEN VN100-ENT-ID > XS026-ENT-ID                          03620012
036300             PERFORM 2600-CHECK-IF-NEW-PG-NEEDED                  03630024
036400             PERFORM 2800-MOVE-XS-VALUES                          03640020
036500             MOVE PC-RECORD-MISSING-FROM-SOR-VND                  03650032
036600                TO DL1-ERROR-MESSAGE                              03660032
036700             MOVE DL1-DETAIL-LINE-1 TO PV-PRINT-RECORD            03670022
036800             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                03680022
036900             PERFORM 8900-WRITE-REPORT-LINE                       03690022
037000             PERFORM 7100-READ-XS-VND-EXTRACT                     03700003
037100     END-EVALUATE.                                                03710003
037200                                                                  03720003
037300******************************************************************03730003
037400*2100-COMPARE-FIELDS.                                             03740017
037500* COMPARES FIELDS BETWEEN FILES TO SEE IF ANY DIFFERENCES EXIST   03750017
037600******************************************************************03760003
037700 2100-COMPARE-FIELDS.                                             03770003
037800                                                                  03780018
037900     SET PS-NO-VENDOR-DESCRIPTION-ERROR                           03790018
038000         PS-NO-VENDOR-NUMBER-ERROR                                03800018
038100         PS-NO-ERROR-FOUND               TO TRUE.                 03810018
038200                                                                  03820003
038300     IF  VN100-PRIMARY-NAME  NOT EQUAL XS026-ENT-NM-DESC          03830010
038400         SET PS-ERROR-FOUND                                       03840018
038500             PS-VENDOR-DESCRIPTION-ERROR TO TRUE                  03850018
038600     END-IF.                                                      03860003
038700                                                                  03870003
038800     IF  VN100-VND-NBR       NOT EQUAL XS026-VND-NBR              03880010
038900         SET PS-ERROR-FOUND                                       03890018
039000         PS-VENDOR-NUMBER-ERROR          TO TRUE                  03900019
039100     END-IF.                                                      03910003
039200                                                                  03920003
039300     IF  PS-ERROR-FOUND                                           03930003
039400         PERFORM 2600-CHECK-IF-NEW-PG-NEEDED                      03940023
039500         PERFORM 2700-MOVE-SOR-VALUES                             03950010
039600         PERFORM 2800-MOVE-XS-VALUES                              03960010
039700         PERFORM 2900-MOVE-ERROR-MSG                              03970018
039800         MOVE DL1-DETAIL-LINE-1 TO PV-PRINT-RECORD                03980010
039900         ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                    03990016
040000         PERFORM 8900-WRITE-REPORT-LINE                           04000022
040100     ELSE                                                         04010056
040200         ADD +1 TO PV-VALID-MATCH-CNT                             04020056
040300     END-IF.                                                      04030003
040400                                                                  04040003
040500     MOVE ZEROS TO PV-SOR-VND-EXT-READ-SKIP-CNT.                  04050018
040600                                                                  04060018
040700******************************************************************04070055
040800**COMPARES FIELDS BETWEEN FILES TO SEE IF ANY DIFFERENCES EXIST   04080055
040900******************************************************************04090055
041000 2500-PROCESS-EXTRA-RECORDS.                                      04100055
041100                                                                  04110055
041200     INITIALIZE DL1-DETAIL-LINE-1.                                04120055
041300     MOVE ZEROS TO PV-SOR-VND-EXT-READ-SKIP-CNT.                  04130055
041400                                                                  04140055
041500     IF  PS-NOT-END-OF-SOR-VND-EXTRACT                            04150055
041600         IF VN100-ENT-ID NOT = XS026-ENT-ID                       04160055
041700            PERFORM 2700-MOVE-SOR-VALUES                          04170055
041800            MOVE PC-RECORD-MISSING-FROM-XS-VND                    04180055
041900               TO DL1-ERROR-MESSAGE                               04190055
042000            MOVE DL1-DETAIL-LINE-1   TO PV-PRINT-RECORD           04200055
042010            ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                 04201062
042100            PERFORM 8900-WRITE-REPORT-LINE                        04210055
042200         END-IF                                                   04220055
042300         PERFORM 7000-READ-SOR-VND-EXTRACT                        04230055
042400     END-IF.                                                      04240055
042500                                                                  04250055
042600     IF  PS-NOT-END-OF-XS-VND-EXRACT                              04260055
042700         IF VN100-ENT-ID NOT = XS026-ENT-ID                       04270055
042800            PERFORM 2800-MOVE-XS-VALUES                           04280055
042900            MOVE PC-RECORD-MISSING-FROM-SOR-VND                   04290055
043000                TO DL1-ERROR-MESSAGE                              04300055
043100            MOVE DL1-DETAIL-LINE-1   TO PV-PRINT-RECORD           04310055
043110            ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                 04311062
043200            PERFORM 8900-WRITE-REPORT-LINE                        04320055
043300         END-IF                                                   04330055
043400         PERFORM 7100-READ-XS-VND-EXTRACT                         04340055
043500     END-IF.                                                      04350055
043600                                                                  04360055
043700******************************************************************04370017
043800* 2600-CHECK-IF-NEW-PG-NEEDED.                                    04380023
043900*     CHECKS TO SEE IF A NEW PAGE IS NEEDED.                      04390023
044000***************************************************************** 04400017
044100 2600-CHECK-IF-NEW-PG-NEEDED.                                     04410023
044200                                                                  04420017
044300     IF PV-LINE-CNT > PC-MAX-REPORT-LINES                         04430023
044400        PERFORM 8700-REPORT-HEADER-ROUTINE                        04440023
044500     END-IF.                                                      04450023
044600                                                                  04460017
044700******************************************************************04470023
044800* 2700-MOVE-SOR-VALUES.                                           04480023
044900*     MOVES THE SOR VENDOR VALUES TO THE ERROR RECORD.            04490023
045000***************************************************************** 04500023
045100 2700-MOVE-SOR-VALUES.                                            04510023
045200                                                                  04520023
045300     MOVE VN100-ENT-ID          TO PV-TEMP-ENT-ID.                04530023
045400     MOVE PV-TEMP-ENT-ID        TO DL1-VND-ENT-ID-KEY.            04540023
045500     MOVE VN100-PRIMARY-NAME    TO DL1-SOR-VND-ENT-NM-DESC.       04550023
045600     MOVE VN100-VND-NBR         TO DL1-SOR-VND-NUMBER.            04560023
045700                                                                  04570023
045800******************************************************************04580023
045900* 2800-MOVE-XS-VALUES.                                            04590023
046000*     MOVES THE XS VENDOR VALUES TO THE ERROR RECORD.             04600023
046100***************************************************************** 04610023
046200 2800-MOVE-XS-VALUES.                                             04620023
046300                                                                  04630023
046400     MOVE XS026-ENT-ID          TO PV-TEMP-ENT-ID.                04640023
046500     MOVE PV-TEMP-ENT-ID        TO DL1-VND-ENT-ID-KEY.            04650023
046600     MOVE XS026-ENT-NM-DESC     TO DL1-XS-VND-ENT-NM-DESC.        04660023
046700     MOVE XS026-VND-NBR         TO DL1-XS-VND-NUMBER.             04670023
046800                                                                  04680023
046900******************************************************************04690023
047000* 2900-MOVE-ERROR-MSG.                                            04700023
047100*     MOVES THE ERROR MESSAGE TO THE ERROR RECORD.                04710023
047200***************************************************************** 04720023
047300 2900-MOVE-ERROR-MSG.                                             04730023
047400                                                                  04740023
047500     IF PS-VENDOR-DESCRIPTION-ERROR AND PS-VENDOR-NUMBER-ERROR    04750023
047600        MOVE PC-MISMATCHED-VND-NBR-AND-DESC TO DL1-ERROR-MESSAGE  04760023
047700     ELSE                                                         04770023
047800        IF PS-VENDOR-DESCRIPTION-ERROR                            04780023
047900           MOVE PC-MISMATCHED-VENDOR-DESC   TO DL1-ERROR-MESSAGE  04790023
048000        ELSE                                                      04800023
048100           MOVE PC-MISMATCHED-VENDOR-NBR    TO DL1-ERROR-MESSAGE  04810023
048200        END-IF                                                    04820023
048300     END-IF.                                                      04830023
048400                                                                  04840023
048500***************************************************************** 04850003
048600*7000-READ-SOR-VND-EXTRACT.                                       04860017
048700*  READ SOR VND EXTRACT FILE                                      04870017
048800*  READS THE VND EXTRACT FILE, SKIPPING THE NUMBER OF RECORDS     04880017
048900*  SPECIFIED IN THE START/SKIP RECORD CONTROL CARD.               04890060
049100***************************************************************** 04910003
049200 7000-READ-SOR-VND-EXTRACT.                                       04920009
049300                                                                  04930003
049400     IF  PS-NOT-END-OF-SOR-VND-EXTRACT                            04940009
049500         READ SOR-VND-EXTRACT-FILE INTO VN100-VENDOR-EXTRACT-RECD 04950009
049600              AT END                                              04960003
049700                 SET PS-END-OF-SOR-VND-EXTRACT TO TRUE            04970009
049800         END-READ                                                 04980003
049900     END-IF.                                                      04990003
050000                                                                  05000003
050100     IF  PS-NOT-END-OF-SOR-VND-EXTRACT                            05010009
050900         ADD +1 TO PV-SOR-VND-EXT-READ-SKIP-CNT                   05090060
052200         ADD +1 TO PV-SOR-VND-RECS-READ-CNT                       05220060
052300     ELSE                                                         05230005
052400         CONTINUE                                                 05240005
052500     END-IF.                                                      05250003
052600                                                                  05260003
052700***************************************************************** 05270003
052800*7100-READ-XS-VND-EXTRACT.                                        05280017
052900* READ XS EXTRACT FILE                                            05290017
053000***************************************************************** 05300003
053100 7100-READ-XS-VND-EXTRACT.                                        05310003
053200                                                                  05320003
053300     IF  PS-NOT-END-OF-XS-VND-EXRACT                              05330003
053400         READ XS-VND-EXTRACT-FILE INTO XS026-VND-UNLOAD           05340015
053500              AT END                                              05350003
053600                 SET PS-END-OF-XS-VND-EXRACT TO TRUE              05360003
053700         END-READ                                                 05370003
053800     END-IF.                                                      05380003
053900                                                                  05390003
054000     IF  PS-NOT-END-OF-XS-VND-EXRACT                              05400003
054100         ADD +1                   TO PV-XS-EXTRACT-REC-READ-CNT   05410013
054200     END-IF.                                                      05420003
054300                                                                  05430003
054400******************************************************************05440007
054500* 8700-REPORT-HEADER-ROUTINE.                                     05450022
054600*     PRINT THE HEADINGS FOR THE REPORT.                          05460007
054700******************************************************************05470007
054800 8700-REPORT-HEADER-ROUTINE.                                      05480022
054900                                                                  05490007
055000     MOVE ZEROS                  TO PV-LINE-CNT.                  05500023
055100     ADD +1                      TO PV-PAGE-CNT.                  05510007
055200     MOVE PV-PAGE-CNT            TO DP200-PAGE-NUMBER.            05520007
055300                                                                  05530007
055400     MOVE PC-REPORT-NBR-1        TO DP200-REPORT-NUMBER.          05540007
055500     MOVE DP200-STANDRD-HEADER-200-COLS                           05550007
055600                                 TO PV-PRINT-RECORD.              05560007
055700                                                                  05570007
055800     PERFORM 8800-WRITE-RPT-TOP-OF-PAGE.                          05580022
055900                                                                  05590007
056000     MOVE HL2-HEADING-LINE-2     TO PV-PRINT-RECORD.              05600010
056100     MOVE +2                     TO PV-LINE-SPACING.              05610010
056200     PERFORM 8900-WRITE-REPORT-LINE.                              05620022
056300                                                                  05630007
056400     MOVE HL3-HEADING-LINE-3     TO PV-PRINT-RECORD.              05640010
056500     MOVE +3                     TO PV-LINE-SPACING.              05650010
056600     PERFORM 8900-WRITE-REPORT-LINE.                              05660022
056700                                                                  05670007
056800******************************************************************05680022
056900* 8800-WRITE-RPT-TOP-OF-PAGE                                      05690022
057000*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   05700022
057100******************************************************************05710022
057200 8800-WRITE-RPT-TOP-OF-PAGE.                                      05720022
057300                                                                  05730022
057400     WRITE XS-VND-INTEG-RPT-RECORD                                05740022
057500       FROM PV-PRINT-RECORD                                       05750022
057600         AFTER ADVANCING PAGE.                                    05760022
057700                                                                  05770022
057800     MOVE +1 TO PV-LINE-CNT.                                      05780022
057900                                                                  05790022
058000******************************************************************05800010
058100* 8900-WRITE-REPORT-LINE                                          05810022
058200*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             05820010
058300******************************************************************05830010
058400 8900-WRITE-REPORT-LINE.                                          05840022
058500                                                                  05850010
058600     WRITE XS-VND-INTEG-RPT-RECORD                                05860010
058700       FROM PV-PRINT-RECORD                                       05870010
058800         AFTER ADVANCING PV-LINE-SPACING.                         05880010
058900                                                                  05890010
059000     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          05900010
059100                                                                  05910023
059200****************************************************************  05920003
059300*END OF PROGRAM ROUTINE                                           05930003
059400****************************************************************  05940003
059500 9000-END-OF-PGM.                                                 05950003
059600                                                                  05960003
060800     DISPLAY '******** COUNTS **************************'.        06080051
060900     DISPLAY '   SOR REC READ CNT= ' PV-SOR-VND-RECS-READ-CNT.    06090035
061000     DISPLAY 'XS VND EXT READ CNT= ' PV-XS-EXTRACT-REC-READ-CNT.  06100035
061100     DISPLAY ' ERROR RECS WRITTEN= ' PV-ERROR-RECORD-WRITTEN-CNT. 06110042
061200     DISPLAY '  VALID MATCH COUNT= ' PV-VALID-MATCH-CNT.          06120056
061300     DISPLAY '                              '.                    06130056
061400     DISPLAY '    START RECORD POINT= ' CC-START-POINT.           06140056
061500     DISPLAY 'SKIP  RECORD FREQUENCY= ' CC-READ-FREQUENCY.        06150056
061700     DISPLAY '******************************************'.        06170051
061800                                                                  06180003
061900     IF  PV-ERROR-RECORD-WRITTEN-CNT > 0                          06190016
062000         MOVE 04               TO RETURN-CODE                     06200003
062100     END-IF.                                                      06210003
062200                                                                  06220003
062300     CLOSE SOR-VND-EXTRACT-FILE                                   06230052
062400           XS-VND-EXTRACT-FILE                                    06240052
062500           XS-VND-INTEG-RPT-FILE.                                 06250052
062600                                                                  06260052
062700******************************************************************06270006
062800*     9999-ABEND                                                 *06280006
062900* ==> PROCESSES:                                                 *06290006
063000*     -PERFORMS ABEND PROCESSING FOR NON-SQL-ERRORS.             *06300006
063100******************************************************************06310006
063200 9999-ABEND.                                                      06320006
063300                                                                  06330006
063400     DISPLAY '9999-ABEND'.                                        06340006
063500     DISPLAY '**  ABEND     **'.                                  06350006
063600     DISPLAY '**  PARAGRAPH ** ' PV-PARAGRAPH-NAME.               06360006
063700     DISPLAY '**  OPERATION ** ' PV-OPERATION-MSG-1.              06370006
063800     DISPLAY '**            ** ' PV-OPERATION-MSG-2.              06380006
063900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06390006
