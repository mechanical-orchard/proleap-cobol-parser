000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400 PROGRAM-ID.    IQKCS419.                                         00040099
000500 AUTHOR.        JIM ARENDT.                                       00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
000700 DATE-WRITTEN.  05-18-16.                                         00070099
000800 DATE-COMPILED.                                                   00080099
000900******************************************************************00090099
001000*    I419 - IQ - UPC / OUTLET STORE "CLEARANCE LABEL" PRINT       00100099
001100*                                                                 00110099
001200*    ACCESS THIS SCREEN FROM THE IQMENU                           00120099
001300*                                                                 00130099
001400*  FUNCTION OF THE KEYS IS AS FOLLOWS:                            00140099
001500*      F14 - RETRIEVE ONHAND INFORMATION                          00150099
001600*      F18 - PRINT MONARCH "CLEARANCE LABEL" FOR UPC              00160099
001700*                                                                 00170099
001800******************************************************************00180099
001900* DATE:        05/2016                                            00190099
002000* WR/IR#:      CHG0XXXXXX                                         00200099
002100* DESCRIPTION: INITIAL IMPLEMENTATION.                            00210099
002200******************************************************************00220099
002210*---------------------------------------------------------------* 00221099
002220* DATE:        09/14/2021                                         00222099
002230* WR/IR#:      CHG0261678                                         00223099
002240* PROGRAMMER:  GERMAN BANDA                                       00224099
002250* DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         00225099
002260*              CALL DP010I-NUMERIC-EDIT-ROUTINE                   00226099
002270*              MAKING THE CALL DYNAMIC VS STATIC                  00227099
002280*---------------------------------------------------------------* 00228099
002220* DATE:        11/11/2021                                         00229199
002230* WR/IR#:      CHG0263774                                         00229299
002240* PROGRAMMER:  JEAN KURK                                          00229399
002250* DESCRIPTION: REMOVE FUNCTIONALITY FOR F18 - PRINT LABELS        00229499
002280*---------------------------------------------------------------* 00229799
CICS  * CHANGED 11/01/2022    BY JIM HUNTER      WR: CHG0277565         00229899
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00229999
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00230099
CICS  ******************************************************************00230199
002300 ENVIRONMENT DIVISION.                                            00231099
002400                                                                  00240099
002500 DATA DIVISION.                                                   00250099
002600                                                                  00260099
002700 WORKING-STORAGE SECTION.                                         00270099
002800                                                                  00280099
002900 01  PC-PROGRAM-CONSTANTS.                                        00290099
003000     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'IQ419A  '.  00300099
003100     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'IQKM419 '.  00310099
003200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'IQKCS419'.  00320099
003300     05  PC-CORPORATE-LOCATION     PIC  9(04)  VALUE 90.          00330099
003400     05  PC-RED                    PIC  X(10)  VALUE 'RED'.       00340099
003500     05  PC-WHITE                  PIC  X(10)  VALUE 'WHITE'.     00350099
003600     05  PC-YELLOW                 PIC  X(10)  VALUE 'YELLOW'.    00360099
003700     05  PC-XMKCS001               PIC  X(08)  VALUE 'XMKCS001'.  00370099
003800     05  PC-XMKCS004               PIC  X(08)  VALUE 'XMKCS004'.  00380099
003900     05  PC-DEFAULT-DATE-0         PIC  X(10)  VALUE '0000-00-00'.00390099
004000     05  PC-STATUS-25              PIC  X(02)  VALUE  '25'.       00400099
004100     05  PC-TSYMSG-NUMBERS.                                       00410099
004300         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00430099
004400         10  PC-TSYMSG-00036       PIC  9(05)  VALUE  00036.      00440099
004600         10  PC-TSYMSG-00070       PIC  9(05)  VALUE  00070.      00460099
004700         10  PC-TSYMSG-00073       PIC  9(05)  VALUE  00073.      00470099
004900         10  PC-TSYMSG-00100       PIC  9(05)  VALUE  00100.      00490099
005000         10  PC-TSYMSG-00695       PIC  9(05)  VALUE  00695.      00500099
005100         10  PC-TSYMSG-01063       PIC  9(05)  VALUE  01063.      00510099
005500         10  PC-TSYMSG-03388       PIC  9(05)  VALUE  03388.      00550099
005700                                                                  00570099
005800 01  DK-VARIABLES.                                                00580099
005900     05  DK-LOCATION-NBR           PIC S9(04)  VALUE  0 COMP.     00590099
006000     05  DK-LOC-NBR-PIC9           PIC  9(04)  VALUE  0.          00600099
006100     05  DK-STORE-NBR-PIC9         PIC  9(04)  VALUE  0.          00610099
006200     05  DK-ENT-ID-PIC9            PIC  9(10)  VALUE  0.          00620099
006300     05  DK-INTR-UPC-ID-PIC9       PIC  9(10)  VALUE  0.          00630099
006400     05  DK-UPC-NBR                PIC S9(15)  VALUE  0 COMP-3.   00640099
006500     05  DK-UPC-NBR-PIC9           PIC  9(15)  VALUE  0.          00650099
006600     05  DK-SKU-NBR                PIC S9(09)  VALUE  0.          00660099
006700                                                                  00670099
006800 01  PV-VARIABLES.                                                00680099
006900     05  PV-CICS-RESP              PIC S9(04)  VALUE  0 COMP.     00690099
007000     05  PV-WORK-DATE              PIC  X(10)  VALUE  SPACES.     00700099
007100     05  PV-STAT-CHNGD-DATE        PIC  X(10)  VALUE  SPACES.     00710099
007200     05  PV-VENDOR-NAME            PIC  X(20)  VALUE  SPACES.     00720099
007300     05  PV-STATUS-CODE            PIC  X(02)  VALUE  SPACES.     00730099
007400     05  PV-PRICE-CHG-DATE         PIC  X(10)  VALUE  SPACES.     00740099
007500     05  PV-GP-RTL-AMT-NULL        PIC S9(04)  VALUE  0 COMP.     00750099
007600     05  PV-LAST-NCLR-RTL-AMT-NULL PIC S9(04)  VALUE  0 COMP.     00760099
007700     05  PV-STORE-NUMBER           PIC S9(04)  VALUE  0 COMP.     00770099
007800     05  PV-INTR-UPC-ID            PIC S9(09)  VALUE  0 COMP.     00780099
007900     05  PV-CICS-RESPONSE          PIC S9(09)  VALUE  0 COMP.     00790099
008000     05  PV-CICS-RESPONSE-9        PIC S9(09)  VALUE  0.          00800099
008100     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE  0 COMP.     00810099
008200     05  PV-UNT-RTL-AMT            PIC S9(07)V99 VALUE 0 COMP-3.  00820099
008300     05  PV-GP-RTL-AMT             PIC S9(07)V99 VALUE 0 COMP-3.  00830099
008400     05  PV-ORIG-RTL-AMT           PIC S9(07)V99 VALUE 0 COMP-3.  00840099
008500     05  PV-LOW-RTL-AMT            PIC S9(07)V99 VALUE 0 COMP-3.  00850099
008600     05  PV-SETUP-DATE             PIC  X(10)    VALUE SPACES.    00860099
008700     05  PV-ONHAND-QTY             PIC S9(09)    VALUE 0 COMP-3.  00870099
008800     05  PV-STORE-EXPECTED-QTY     PIC S9(09)    VALUE 0 COMP-3.  00880099
008900     05  PV-INTRANSIT-QTY          PIC S9(09)    VALUE 0 COMP-3.  00890099
009000     05  PV-WORK-QTY-X             PIC  X(07)    VALUE SPACES.    00900099
009100     05  PV-WORK-QTY-Z REDEFINES PV-WORK-QTY-X  PIC -(7).         00910099
009200     05  PV-WORK-QTY-9 REDEFINES PV-WORK-QTY-X  PIC ------9.      00920099
009300                                                                  00930099
009400     05  PV-WORK-DATE-YMD          PIC  9(06)  VALUE 0.           00940099
009500     05  PV-WORK-DATE-CCYYMMDD     PIC  X(10)  VALUE SPACES.      00950099
009600                                                                  00960099
009700     05  PV-SYSTEM-ID.                                            00970099
009800         10  FILLER                PIC  X(04)  VALUE SPACES.      00980099
009900         10  PV-REGION-IND         PIC  X(01).                    00990099
010000             88  PV-TEST-CICS                  VALUE 'T'.         01000099
010100             88  PV-QA-CICS                    VALUE 'Q'.         01010099
010200             88  PV-PROD-CICS                  VALUE 'P'.         01020099
010300             88  PV-LEARN-CICS                 VALUE 'L'.         01030099
010400         10  FILLER                PIC  X(01)  VALUE SPACES.      01040099
010500     05  PV-STKR-ID-9              PIC S9(09)  COMP-3 VALUE 0.    01050099
010600     05  PV-STKR-ID                PIC  9(04)         VALUE 0.    01060099
010700     05  PV-CURRENT-DATE           PIC  X(10).                    01070099
010800     05  PV-SQLCODE                PIC +9(09)  VALUE ZERO.        01080099
010900     05  PV-ERROR-TEXT             PIC  X(100) VALUE SPACE.       01090099
011000                                                                  01100099
011100 01  PS-PROGRAM-SWITCHES.                                         01110099
011200     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01120099
011300         88  PS-ERROR                          VALUE  'Y'.        01130099
011400         88  PS-NO-ERROR                       VALUE  'N'.        01140099
011500     05  PS-UPC-FOUND-SW           PIC  X(01)  VALUE  'N'.        01150099
011600         88  PS-UPC-FOUND                      VALUE  'Y'.        01160099
011700         88  PS-UPC-NOT-FOUND                  VALUE  'N'.        01170099
011800     05  PS-SKU-FOUND-SW           PIC  X(01)  VALUE  'N'.        01180099
011900         88  PS-SKU-FOUND                      VALUE  'Y'.        01190099
012000         88  PS-SKU-NOT-FOUND                  VALUE  'N'.        01200099
012100     05  PS-CURRENT-RETAIL-SW      PIC  X(01)  VALUE  'N'.        01210099
012200         88  PS-CURRENT-RETAIL-FOUND           VALUE  'Y'.        01220099
012300         88  PS-CURRENT-RETAIL-NOT-FOUND       VALUE  'N'.        01230099
012400     05  PS-NEW-SKU-FOUND-SW       PIC  X(01)  VALUE  'N'.        01240099
012500         88  PS-NEW-SKU-FOUND                  VALUE  'Y'.        01250099
012600     05  PS-NEW-UPC-FOUND-SW       PIC  X(01)  VALUE  'N'.        01260099
012700         88  PS-NEW-UPC-FOUND                  VALUE  'Y'.        01270099
012800     05  PS-FIRST-TIME-SW          PIC  X(01)  VALUE  'N'.        01280099
012900         88  PS-FIRST-TIME                     VALUE  'Y'.        01290099
013000                                                                  01300099
013100 01  PM-PROGRAM-MESSAGES.                                         01310099
013200     05  PM-ABEND-INFO-A.                                         01320099
013300         10  FILLER                PIC X(15)   VALUE              01330099
013400                                   'DP020-SRC-AID: '.             01340099
013500         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01350099
013600         10  FILLER                PIC X(19)   VALUE              01360099
013700                                   '. DP020-FK-ACTION: '.         01370099
013800         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01380099
013900         10  FILLER                PIC X(22)   VALUE              01390099
014000                                   '. DP020-FK-DISPN-IND: '.      01400099
014100         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      01410099
014200         10  FILLER                PIC X(01)   VALUE '.'.         01420099
014300         10  FILLER                PIC X(19)   VALUE SPACE.       01430099
014400                                                                  01440099
014500******************************************************************01450089
014600*    MAP LAYOUT                                                   01460099
014700******************************************************************01470089
014800     COPY IQKM419.                                                01480099
014900                                                                  01490099
015500******************************************************************01550089
015600**   COMMAREA USED TO CALL XMKCS001.                              01560099
015700******************************************************************01570089
015800     COPY XMWS003.                                                01580099
015900                                                                  01590099
016000******************************************************************01600089
016100**   COMMAREA USED TO CALL XMKCS004.                              01610099
016200******************************************************************01620089
016300     COPY XMWS002.                                                01630099
016400                                                                  01640099
016500******************************************************************01650089
016600**   COMMAREA USED TO CALL XLKCS074.                              01660099
016700******************************************************************01670089
016800     COPY XLWS074.                                                01680099
016900                                                                  01690099
017000******************************************************************01700089
017100*    ATTRIBUTE SETTINGS COPYBOOK.                                 01710099
017200******************************************************************01720089
017300     COPY DPWS015.                                                01730099
017400                                                                  01740099
017500     COPY DPWS500.                                                01750099
017600                                                                  01760099
017700******************************************************************01770089
017800*    FUNCTION KEYS COPYBOOK                                       01780099
017900******************************************************************01790089
018000     COPY DPWS016.                                                01800099
018100                                                                  01810099
018200******************************************************************01820089
018300*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC         01830099
018400*    EDIT SUB-ROUTINE (DPKUT100).                                 01840099
018500******************************************************************01850089
018600     COPY DPWS010I.                                               01860099
018700                                                                  01870099
018800******************************************************************01880089
018900*    THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            01890099
019000*    ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    01900099
019100******************************************************************01910089
019200     COPY DPWS030.                                                01920099
CICS       COPY DPWS930.                                                01921099
019300                                                                  01930099
019400******************************************************************01940089
019500*    STANDARD COMMAREA.                                           01950099
019600******************************************************************01960089
019700     COPY DPWS020.                                                01970099
019800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01980099
019900                                                                  01990099
020000******************************************************************02000089
020100*    INTER-APPLICATION COMMAREA.                                  02010099
020200******************************************************************02020089
020300         10  INTER-APPL-COMM-AREA PIC X(200).                     02030099
020400                                                                  02040099
020500******************************************************************02050089
020600*    SPECIFIC COMMMAREA FOR IQKCS419. CAN BE UP TO 2866.          02060099
020700*    CURRENTLY IT IS 310 BYTES.                                   02070099
020800******************************************************************02080089
020900         10  ASC-SPECIFIC-COMMAREA.                               02090099
021000             15  ASC-STATUS                PIC  X(02).            02100099
021100             15  ASC-LOCATION-NBR-X.                              02110099
021200                 20  ASC-LOCATION-NBR      PIC  9(04).            02120099
021300             15  ASC-UPC-NO                PIC  9(13).            02130099
021400             15  ASC-UPC-NBR               PIC  9(15).            02140099
021500             15  ASC-UPC-NBR-DEF REDEFINES                        02150099
021600                            ASC-UPC-NBR.                          02160099
021700                 20  ASC-UPC-FILLER        PIC  9(02).            02170099
021800                 20  ASC-UPC-NBR-01-X.                            02180099
021900                     25  ASC-UPC-NBR-01    PIC  9(02).            02190099
022000                 20  ASC-UPC-NBR-02-X.                            02200099
022100                     25  ASC-UPC-NBR-02    PIC  9(05).            02210099
022200                 20  ASC-UPC-NBR-03-X.                            02220099
022300                     25  ASC-UPC-NBR-03    PIC  9(05).            02230099
022400                 20  ASC-UPC-NBR-04-X.                            02240099
022500                     25  ASC-UPC-NBR-04    PIC  9(01).            02250099
022600             15  ASC-SKU-NBR               PIC  9(09).            02260099
022700             15  ASC-SKU-NBR-DEF REDEFINES                        02270099
022800                            ASC-SKU-NBR.                          02280099
022900                 20  ASC-SKU-FILLER        PIC  9(01).            02290099
023000                 20  ASC-SKU-NBR-X.                               02300099
023100                     25  ASC-SKU-NBR-8     PIC  9(08).            02310099
023200             15  ASC-DEPT-NBR              PIC  9(04).            02320099
023300             15  ASC-MAJ-CL-NBR            PIC  9(04).            02330099
023400             15  ASC-SUB-CL-NBR            PIC  9(04).            02340099
023500             15  ASC-RETAIL-PRICE          PIC S9(07)V99 COMP-3.  02350099
023600             15  ASC-COLOR-DESC            PIC  X(10).            02360099
023700             15  ASC-SIZE-DESC             PIC  X(10).            02370099
023800             15  ASC-INTR-UPC-ID           PIC S9(09) COMP.       02380099
023900             15  ASC-LIST-QUEUE-NAME.                             02390099
024000                 20  ASC-LIST-TERM-ID      PIC  X(04).            02400099
024100                 20  ASC-LIST-TASK-NUMBER  PIC S9(05)             02410099
024200                                                         COMP-3.  02420099
024300                 20  ASC-LIST-SEQ          PIC  9(01).            02430099
024400             15  ASC-SEL-QUEUE-NAME.                              02440099
024500                 20  ASC-SEL-TERM-ID       PIC  X(04).            02450099
024600                 20  ASC-SEL-TASK-NUMBER   PIC S9(05)    COMP-3.  02460099
024700                 20  ASC-SEL-SEQ           PIC  9(01).            02470099
024800                                                                  02480099
024900             15  ASC-SEL-QUEUE-NAME-IN.                           02490099
025000                 20  ASC-SEL-TERM-ID-IN    PIC X(04).             02500099
025100                 20  ASC-SEL-TASK-NUMBER-IN                       02510099
025200                                           PIC S9(05) COMP-3.     02520099
025300                 20  ASC-SEL-SEQ-IN        PIC  9(01).            02530099
025400             15  ASC-USE-SELECTION-QUEUE-IND                      02540099
025500                                           PIC  X(01).            02550099
025600                 88  ASC-USE-SELECTION-QUEUE          VALUE 'Y'.  02560099
025700             15  ASC-START-ITEM-REQUEST.                          02570099
025800                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         02580099
025900             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    02590099
026000             15  ASC-HIGHEST-BLOCK-WRITTEN PIC S9(04)  COMP.      02600099
026100             15  ASC-SEL-SUB               PIC S9(04)  COMP.      02610099
026200             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      02620099
026300             15  ASC-STORE-NBR             PIC S9(04)  COMP.      02630099
026400             15  ASC-STORE-NAME            PIC  X(20).            02640099
026500             15  ASC-SKU-DESC              PIC  X(30).            02650099
026600             15  ASC-VS-NBR                PIC  X(20).            02660099
026700             15  ASC-STKR-NBR              PIC S9(09)    COMP.    02670099
026800             15  ASC-GP-RTL-AMT            PIC S9(07)V99 COMP-3.  02680099
026900             15  ASC-ORIG-RTL-AMT          PIC S9(07)V99 COMP-3.  02690099
027000             15  ASC-LOW-RTL-AMT           PIC S9(07)V99 COMP-3.  02700099
027100             15  ASC-UNT-RTL-CHG-DTE       PIC  X(10).            02710099
027200             15  ASC-UPC-STAT-CHG-DTE      PIC  X(10).            02720099
027300             15  ASC-VENDOR-NAME           PIC  X(20).            02730099
027400             15  ASC-DATA-MOVED-SW         PIC  X(01).            02740099
027500                 88  ASC-DATA-MOVED                   VALUE 'Y'.  02750099
027600                 88  ASC-NO-DATA-MOVED                VALUE 'N'.  02760099
027700             15  ASC-ON-HAND               PIC  X(07).            02770099
027800             15  ASC-ON-ORDER              PIC  X(07).            02780099
027900             15  ASC-LAST-RCVD-DATE        PIC  X(10).            02790099
028000             15  ASC-LAST-SALE-DATE        PIC  X(10).            02800099
028100             15  ASC-STORE-ON-HAND         PIC  X(07).            02810099
028200             15  ASC-IN-TRANSIT-QTY        PIC  X(07).            02820099
028300         10  FILLER                        PIC  X(2555).          02830099
028400                                                                  02840099
028500******************************************************************02850089
028600*    ABEND PROCESSING COPYBOOK.                                   02860099
028700******************************************************************02870089
028800     COPY DPWS013.                                                02880099
028900                                                                  02890099
029000******************************************************************02900089
029100** XST00001 - XST_LOC  - LOCATION TABLE                           02910099
029200******************************************************************02920089
029300     EXEC SQL                                                     02930099
029400          INCLUDE XST00001                                        02940099
029500     END-EXEC.                                                    02950099
029600                                                                  02960099
029700******************************************************************02970089
029800** XST00003 - XST_DIST - DISTRICT TABLE                           02980099
029900******************************************************************02990089
030000     EXEC SQL                                                     03000099
030100          INCLUDE XST00003                                        03010099
030200     END-EXEC.                                                    03020099
030300                                                                  03030099
030400******************************************************************03040089
030500** XST00004 - XST_DIST_REGN - DISTRICT REGION TABLE               03050099
030600******************************************************************03060089
030700     EXEC SQL                                                     03070099
030800          INCLUDE XST00004                                        03080099
030900     END-EXEC.                                                    03090099
031000                                                                  03100099
031100******************************************************************03110089
031200** XST00005 - XST_REGN      - REGION TABLE                        03120099
031300******************************************************************03130089
031400     EXEC SQL                                                     03140099
031500          INCLUDE XST00005                                        03150099
031600     END-EXEC.                                                    03160099
031700                                                                  03170099
031800******************************************************************03180089
031900** XST00008 - XST_SKU_LOC   - SKU LOCATION TABLE                  03190099
032000******************************************************************03200089
032100     EXEC SQL                                                     03210099
032200          INCLUDE XST00008                                        03220099
032300     END-EXEC.                                                    03230099
032400                                                                  03240099
032500******************************************************************03250089
032600** XST00010 - XST_SKU       - SKU TABLE                           03260099
032700******************************************************************03270089
032800     EXEC SQL                                                     03280099
032900          INCLUDE XST00010                                        03290099
033000     END-EXEC.                                                    03300099
033100                                                                  03310099
033200******************************************************************03320089
033300** XST00011 - XST_SKU_ATTR  - SKU ATTRIBUTES TABLE                03330099
033400******************************************************************03340089
033500     EXEC SQL                                                     03350099
033600          INCLUDE XST00011                                        03360099
033700     END-EXEC.                                                    03370099
033800                                                                  03380099
033900******************************************************************03390089
034000** XST00012 - XST_UPC       - UPC TABLE                           03400099
034100******************************************************************03410089
034200     EXEC SQL                                                     03420099
034300          INCLUDE XST00012                                        03430099
034400     END-EXEC.                                                    03440099
034500                                                                  03450099
034600******************************************************************03460089
034700** XST00013 - XST_VND_STYL  - VENDOR STYLE                        03470099
034800******************************************************************03480089
034900     EXEC SQL                                                     03490099
035000          INCLUDE XST00013                                        03500099
035100     END-EXEC.                                                    03510099
035200                                                                  03520099
035300******************************************************************03530089
035400** XST00018 - XST_VND       - VENDOR                              03540099
035500******************************************************************03550089
035600     EXEC SQL                                                     03560099
035700          INCLUDE XST00018                                        03570099
035800     END-EXEC.                                                    03580099
035900                                                                  03590099
036000******************************************************************03600089
036100** XST00020 - XST_DC_LOC_ASGMT - DC LOCATION ASSIGNMENT           03610099
036200******************************************************************03620089
036300     EXEC SQL                                                     03630099
036400          INCLUDE XST00020                                        03640099
036500     END-EXEC.                                                    03650099
036600                                                                  03660099
036700******************************************************************03670089
036800** TSK      - FASHION SKU                                         03680099
036900******************************************************************03690089
037000     EXEC SQL                                                     03700099
037100          INCLUDE TSK                                             03710099
037200     END-EXEC.                                                    03720099
037300                                                                  03730099
037400******************************************************************03740089
037500** TUPCPLS  - PHYSICAL LOCATION STATUS                            03750099
037600******************************************************************03760089
037700     EXEC SQL                                                     03770099
037800          INCLUDE TUPCPLS                                         03780099
037900     END-EXEC.                                                    03790099
038000                                                                  03800099
038100******************************************************************03810089
038200** TUPCSKU  - UPC - SKU XREF                                      03820099
038300******************************************************************03830089
038400     EXEC SQL                                                     03840099
038500          INCLUDE TUPCSKU                                         03850099
038600     END-EXEC.                                                    03860099
038700                                                                  03870099
038800******************************************************************03880089
038900     EXEC SQL                                                     03890099
039000          INCLUDE PXT00003                                        03900099
039100     END-EXEC.                                                    03910099
039200                                                                  03920099
039300******************************************************************03930089
039400     EXEC SQL                                                     03940099
039500          INCLUDE SQLCA                                           03950099
039600     END-EXEC.                                                    03960099
039700                                                                  03970099
039800******************************************************************03980089
039900 LINKAGE SECTION.                                                 03990099
040000                                                                  04000099
040100 01  DFHCOMMAREA.                                                 04010099
040200     05  FILLER                         OCCURS  1 TO 4072 TIMES   04020099
040300                                        DEPENDING ON EIBCALEN.    04030099
040400         10  FILLER                     PIC X.                    04040099
040500                                                                  04050099
040600                                                                  04060099
040700 PROCEDURE DIVISION.                                              04070099
040800******************************************************************04080089
040900** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.    04090099
041000** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API     04100099
041100** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.               04110099
041200**                                                                04120099
041300** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE     04130099
041400** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.          04140099
041500******************************************************************04150089
041600 0000-MAIN-MODULE.                                                04160099
041700                                                                  04170099
041800     INITIALIZE DP030-CICS-API-FIELDS.                            04180099
041900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04190099
042000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04200099
042100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04210099
042200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04220099
042300     MOVE LENGTH OF IQ419AI        TO DP030-MAP-LENGTH (1).       04230099
042400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04240099
042500     PERFORM 0001-CALL-CICS-ARCH-API.                             04250099
042600     PERFORM 1000-CONTROL-PROCESSING                              04260099
042700                                                                  04270099
042800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04280099
042900     PERFORM 0001-CALL-CICS-ARCH-API.                             04290099
043000                                                                  04300099
043100******************************************************************04310089
043200 0001-CALL-CICS-ARCH-API.                                         04320099
043300                                                                  04330099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04340099
043500                                    DFHCOMMAREA                   04350099
043600                                    DP030-CICS-API-FIELDS         04360099
043700                                    DP020-STANDARD-COMMAREA       04370099
043800                                    IQ419AI.                      04380099
043900                                                                  04390099
044000     IF  DP030-RC-CALL-SUCCESSFUL                                 04400099
044100         CONTINUE                                                 04410099
044200     ELSE                                                         04420099
044300         SET DP013-NO-ROLLBACK                                    04430099
044400             DP013-XCTL-DISPLAY-RESTART                           04440099
044500             DP013-CICS-ABEND      TO TRUE                        04450099
044600         MOVE 'BEFORE 0000-MAIN-MODULE'                           04460099
044700                                   TO DP013-PARAGRAPH             04470099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04471099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04472099
045200         MOVE DP030-RETURN-CODE                                   04520099
045300                                   TO DP013-MESSAGE-TEXT (3)      04530099
045400         PERFORM DP013-0000-PROCESS-ABEND                         04540099
045500     END-IF.                                                      04550099
045600                                                                  04560099
045700******************************************************************04570089
045800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    04580099
045900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                    04590099
046000******************************************************************04600089
046100 1000-CONTROL-PROCESSING.                                         04610099
046200                                                                  04620099
046300     EVALUATE TRUE                                                04630099
046400         WHEN DP020-NEXT-ACT-INITIAL                              04640099
046500             INITIALIZE ASC-SPECIFIC-COMMAREA                     04650099
046600             SET PS-FIRST-TIME TO TRUE                            04660099
046700             PERFORM 4000-BUILD-INITIAL-PANEL                     04670099
046800                                                                  04680099
046900         WHEN DP020-NEXT-ACT-READ-MAP                             04690099
047000             PERFORM 2000-FKEY-PROCESSING                         04700099
047100                                                                  04710099
047200         WHEN DP020-NEXT-ACT-RETURN                               04720099
047300             PERFORM 3200-RESET-ATTRIBUTES                        04730099
047400             MOVE -1                   TO ACSRUPCL                04740099
047500             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 04750099
047600                                                                  04760099
047700         WHEN OTHER                                               04770099
047800             SET DP013-LOGIC-ABEND                                04780099
047900                 DP013-NO-ROLLBACK TO TRUE                        04790099
048000             MOVE '1000-CONTROL-PROCESSING'                       04800099
048100                                   TO  DP013-PARAGRAPH            04810099
048200             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04820099
048300                                   TO  DP013-MESSAGE-TEXT(1)      04830099
048400             MOVE DP020-NEXT-APPL-ACTIVITY                        04840099
048500                                   TO DP013-MESSAGE-TEXT(2)       04850099
048600             PERFORM DP013-0000-PROCESS-ABEND                     04860099
048700     END-EVALUATE.                                                04870099
048800                                                                  04880099
048900******************************************************************04890089
049000* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY         04900099
049100* ACTIONS SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON       04910099
049200* REGARDLESS OF EDITS.                                            04920099
049300******************************************************************04930089
049400 2000-FKEY-PROCESSING.                                            04940099
049500                                                                  04950099
049600     EVALUATE TRUE                                                04960099
049700                                                                  04970099
049800         WHEN DP020-SRC-AID = DP016-CLEAR                         04980099
049900              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  04990099
050000                                                                  05000099
050100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05010099
050200*             INITIALIZE ASC-SPECIFIC-COMMAREA                    05020099
050300              SET PS-FIRST-TIME TO TRUE                           05030099
050400              PERFORM 4000-BUILD-INITIAL-PANEL                    05040099
050500*             PERFORM 3200-RESET-ATTRIBUTES                       05050099
050600                                                                  05060099
050700         WHEN OTHER                                               05070099
050800              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                05080099
050900              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  05090099
051000              PERFORM 4000-BUILD-INITIAL-PANEL                    05100099
051100              IF PS-NO-ERROR                                      05110099
051200                 SET DP030-CONTINUE-GO TO TRUE                    05120099
051300                 PERFORM 2100-CHECK-FUNCTION-KEY                  05130099
051400              ELSE                                                05140099
051500                  SET DP030-OVERRIDE-GO TO TRUE                   05150099
051600              END-IF                                              05160099
051700     END-EVALUATE.                                                05170099
051800                                                                  05180099
051900******************************************************************05190089
052000*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                      05200099
052100******************************************************************05210089
052200 2050-DELETE-LIST-QUEUE.                                          05220099
052300                                                                  05230099
052400     EXEC CICS                                                    05240099
052500         DELETEQ TS                                               05250099
052600             QUEUE (ASC-LIST-QUEUE-NAME)                          05260099
052700             RESP  (PV-CICS-RESP)                                 05270099
052800     END-EXEC.                                                    05280099
052900                                                                  05290099
053000     IF (PV-CICS-RESP = DFHRESP(NORMAL))                          05300099
053100     OR (PV-CICS-RESP = DFHRESP(QIDERR))                          05310099
053200         CONTINUE                                                 05320099
053300     ELSE                                                         05330099
053400         SET DP013-CICS-ABEND      TO TRUE                        05340099
053500         SET DP013-NO-ROLLBACK     TO TRUE                        05350099
053600                                                                  05360099
053700         MOVE '2050-DELETE-LIST-QUEUE'                            05370099
053800                                   TO DP013-PARAGRAPH             05380099
053900         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    05390099
054000                                   TO DP013-MESSAGE-TEXT (1)      05400099
054100         PERFORM DP013-0000-PROCESS-ABEND                         05410099
054200     END-IF.                                                      05420099
054300                                                                  05430099
054400     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  05440099
054500                                                                  05450099
054600******************************************************************05460089
054700*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     05470099
054800*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE          05480099
054900*    RETURNED FROM THE CICS ARCHITECTURE API.                     05490099
055000******************************************************************05500089
055100 2100-CHECK-FUNCTION-KEY.                                         05510099
055200                                                                  05520099
055300     EVALUATE TRUE                                                05530099
055400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05540099
055500**  F14     DISPLAY ONHAND QUANTITIES                             05550099
055600              PERFORM 7000-CALL-XMKCS001                          05560099
055700              PERFORM 7400-CALL-XLKCS074                          05570099
055800                                                                  05580099
055900              COMPUTE PV-WORK-QTY-9 = PV-ONHAND-QTY -             05590099
056000                                      PV-STORE-EXPECTED-QTY       05600099
056100                                                                  05610099
056200              MOVE PV-WORK-QTY-X     TO ASTROHO                   05620099
056300                                        ASC-STORE-ON-HAND         05630099
056400              MOVE PV-INTRANSIT-QTY  TO PV-WORK-QTY-9             05640099
056500              MOVE PV-WORK-QTY-X     TO AINTRANO                  05650099
056600                                        ASC-IN-TRANSIT-QTY        05660099
056700                                                                  05670099
056700         WHEN DP020-SRC-AID = DP016-ENTER                         05680099
056700              CONTINUE                                            05690099
061600         WHEN OTHER                                               06160099
061700              SET DP013-NO-ROLLBACK                               06170099
061800                  DP013-XCTL-DISPLAY-RESTART                      06180099
061900                  DP013-CICS-ABEND  TO TRUE                       06190099
062000              MOVE '2100-CHECK-FUNCTION-KEY'                      06200099
062100                                    TO DP013-PARAGRAPH            06210099
062200              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'     06220099
062300                                    TO DP013-MESSAGE-TEXT (1)     06230099
062400              STRING 'OR CODE MISSING FROM THIS '                 06240099
062500                     'PROGRAM TO PROCESS:'                        06250099
062600                      DELIMITED BY SIZE                           06260099
062700                      INTO DP013-MESSAGE-TEXT (2)                 06270099
062800              MOVE DP020-SRC-AID    TO PM-A-SRC-AID               06280099
062900              MOVE DP020-FK-ACTION (DP020-SRC-AID)                06290099
063000                                    TO PM-A-FK-ACTION             06300099
063100              MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)             06310099
063200                                    TO PM-A-FK-DISPN              06320099
063300              MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)     06330099
063400              MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'       06340099
063500                                    TO DP013-MESSAGE-TEXT (4)     06350099
063600              PERFORM DP013-0000-PROCESS-ABEND                    06360099
063700     END-EVALUATE.                                                06370099
063800                                                                  06380099
063900******************************************************************06390089
064000* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS    06400099
064100* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN    06410099
064200* THE APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.           06420099
064300******************************************************************06430089
064400 2200-MOVE-SCREEN-TO-COMMAREA.                                    06440099
064500                                                                  06450099
064600     IF AUPC01L > ZERO                                            06460099
064700        SET PS-NEW-UPC-FOUND      TO TRUE                         06470099
064800        MOVE AUPC01I              TO ASC-UPC-NBR-01-X             06480099
064900     ELSE                                                         06490099
065000        IF AUPC01F = DP015-ERASE-EOF                              06500099
065100           SET PS-NEW-UPC-FOUND   TO TRUE                         06510099
065200           MOVE SPACE             TO ASC-UPC-NBR-01-X             06520099
065300        END-IF                                                    06530099
065400     END-IF.                                                      06540099
065500                                                                  06550099
065600     IF AUPC02L > ZERO                                            06560099
065700        SET PS-NEW-UPC-FOUND      TO TRUE                         06570099
065800        MOVE AUPC02I              TO ASC-UPC-NBR-02-X             06580099
065900     ELSE                                                         06590099
066000        IF AUPC02F = DP015-ERASE-EOF                              06600099
066100           SET PS-NEW-UPC-FOUND   TO TRUE                         06610099
066200           MOVE SPACE             TO ASC-UPC-NBR-02-X             06620099
066300        END-IF                                                    06630099
066400     END-IF.                                                      06640099
066500                                                                  06650099
066600     IF AUPC03L > ZERO                                            06660099
066700        SET PS-NEW-UPC-FOUND      TO TRUE                         06670099
066800        MOVE AUPC03I              TO ASC-UPC-NBR-03-X             06680099
066900     ELSE                                                         06690099
067000        IF AUPC03F = DP015-ERASE-EOF                              06700099
067100           SET PS-NEW-UPC-FOUND   TO TRUE                         06710099
067200           MOVE SPACE             TO ASC-UPC-NBR-03-X             06720099
067300        END-IF                                                    06730099
067400     END-IF.                                                      06740099
067500                                                                  06750099
067600     IF AUPC04L > ZERO                                            06760099
067700        SET PS-NEW-UPC-FOUND      TO TRUE                         06770099
067800        MOVE AUPC04I              TO ASC-UPC-NBR-04-X             06780099
067900     ELSE                                                         06790099
068000        IF AUPC04F = DP015-ERASE-EOF                              06800099
068100           SET PS-NEW-UPC-FOUND   TO TRUE                         06810099
068200           MOVE SPACE             TO ASC-UPC-NBR-04-X             06820099
068300        END-IF                                                    06830099
068400     END-IF.                                                      06840099
068500                                                                  06850099
068600     IF ASKUNBRL > ZERO                                           06860099
068700        SET PS-NEW-SKU-FOUND TO TRUE                              06870099
068800        MOVE ASKUNBRI             TO ASC-SKU-NBR-X                06880099
068900     ELSE                                                         06890099
069000        IF ASKUNBRF = DP015-ERASE-EOF                             06900099
069100           SET PS-NEW-SKU-FOUND   TO TRUE                         06910099
069200           MOVE SPACE             TO ASC-SKU-NBR-X                06920099
069300        END-IF                                                    06930099
069400     END-IF.                                                      06940099
069500                                                                  06950099
069600     IF DP020-LOCATION-NBR > ZERO                                 06960099
069700        MOVE DP020-LOCATION-NBR   TO ASC-LOCATION-NBR-X           06970099
069800     END-IF.                                                      06980099
069900                                                                  06990099
070000******************************************************************07000089
070100* ENSURE THE ENTERED DATA IS CORRECT.                             07010099
070200******************************************************************07020089
070300 3000-EDIT-DATA-IN-COMMAREA.                                      07030099
070400                                                                  07040099
070500     PERFORM 3200-RESET-ATTRIBUTES.                               07050099
070600                                                                  07060099
070700     PERFORM 3030-VALIDATE-UPC.                                   07070099
070800                                                                  07080099
070900     IF PS-NO-ERROR                                               07090099
071000         MOVE -1                      TO ACSRUPCL                 07100099
071100         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     07110099
071200     END-IF.                                                      07120099
071300                                                                  07130099
071400******************************************************************07140089
071500*    ENSURE THAT THE UPC NUMBER AND/OR SKU NUMBER IS NUMERIC.     07150099
071600******************************************************************07160089
071700 3030-VALIDATE-UPC.                                               07170099
071800                                                                  07180099
071900     MOVE 0                      TO ASC-UPC-FILLER                07190099
072000     MOVE ASC-UPC-NBR-01-X       TO DP010I-UNEDITED-FIELD         07200099
072100     MOVE 2                      TO DP010I-MAXIMUM-DIGITS         07210099
072200     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS       07220099
072300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      07230099
072410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07241099
072420                         USING DP010I-NUMERIC-EDIT-AREA           07242099
072500     IF DP010I-ERROR-DETECTED                                     07250099
072600*         MUST BE NUMERIC                                         07260099
072700        MOVE PC-TSYMSG-00008     TO DP020-MSG-NUMBER              07270099
072800        MOVE DP015-UNP-ALP-BRT-MDT                                07280099
072900                                 TO AUPC01A                       07290099
073000                                    AUPC02A                       07300099
073100                                    AUPC03A                       07310099
073200                                    AUPC04A                       07320099
073300        MOVE DP015-RED           TO AUPC01C                       07330099
073400        MOVE DP015-REVERSE       TO AUPC01H                       07340099
073500        MOVE -1                  TO AUPC01L                       07350099
073600        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       07360099
073700        SET PS-ERROR                                              07370099
073800            DP020-MSG-FATAL      TO TRUE                          07380099
073900     ELSE                                                         07390099
074000        MOVE DP010I-NUMERIC-FIELD                                 07400099
074100                                 TO ASC-UPC-NBR-01                07410099
074200        MOVE ASC-UPC-NBR-01      TO AUPC01O                       07420099
074300                                                                  07430099
074400     END-IF.                                                      07440099
074500                                                                  07450099
074600     IF PS-NO-ERROR                                               07460099
074700        MOVE ASC-UPC-NBR-02-X    TO DP010I-UNEDITED-FIELD         07470099
074800        MOVE 5                   TO DP010I-MAXIMUM-DIGITS         07480099
074900        MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS       07490099
075000        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   07500099
075110        CALL DP010I-NUMERIC-EDIT-ROUTINE                          07511099
075120                         USING DP010I-NUMERIC-EDIT-AREA           07512099
075200        IF DP010I-ERROR-DETECTED                                  07520099
075300*         MUST BE NUMERIC                                         07530099
075400           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              07540099
075500           MOVE DP015-UNP-ALP-BRT-MDT                             07550099
075600                                 TO AUPC01A                       07560099
075700                                    AUPC02A                       07570099
075800                                    AUPC03A                       07580099
075900                                    AUPC04A                       07590099
076000           MOVE DP015-RED        TO AUPC02C                       07600099
076100           MOVE DP015-REVERSE    TO AUPC02H                       07610099
076200           MOVE -1               TO AUPC02L                       07620099
076300           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    07630099
076400           SET PS-ERROR                                           07640099
076500               DP020-MSG-FATAL   TO TRUE                          07650099
076600        ELSE                                                      07660099
076700           MOVE DP010I-NUMERIC-FIELD                              07670099
076800                                 TO ASC-UPC-NBR-02                07680099
076900           MOVE ASC-UPC-NBR-02   TO AUPC02O                       07690099
077000                                                                  07700099
077100     END-IF.                                                      07710099
077200                                                                  07720099
077300     IF PS-NO-ERROR                                               07730099
077400        MOVE ASC-UPC-NBR-03-X    TO DP010I-UNEDITED-FIELD         07740099
077500        MOVE 5                   TO DP010I-MAXIMUM-DIGITS         07750099
077600        MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS       07760099
077700        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   07770099
077810        CALL DP010I-NUMERIC-EDIT-ROUTINE                          07781099
077820                         USING DP010I-NUMERIC-EDIT-AREA           07782099
077900        IF DP010I-ERROR-DETECTED                                  07790099
078000*         MUST BE NUMERIC                                         07800099
078100           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              07810099
078200           MOVE DP015-UNP-ALP-BRT-MDT                             07820099
078300                                 TO AUPC01A                       07830099
078400                                    AUPC02A                       07840099
078500                                    AUPC03A                       07850099
078600                                    AUPC04A                       07860099
078700           MOVE DP015-RED        TO AUPC03C                       07870099
078800           MOVE DP015-REVERSE    TO AUPC03H                       07880099
078900           MOVE -1               TO AUPC03L                       07890099
079000           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    07900099
079100           SET PS-ERROR                                           07910099
079200               DP020-MSG-FATAL   TO TRUE                          07920099
079300        ELSE                                                      07930099
079400           MOVE DP010I-NUMERIC-FIELD                              07940099
079500                                 TO ASC-UPC-NBR-03                07950099
079600           MOVE ASC-UPC-NBR-03   TO AUPC03O                       07960099
079700                                                                  07970099
079800     END-IF.                                                      07980099
079900                                                                  07990099
080000     IF PS-NO-ERROR                                               08000099
080100        MOVE ASC-UPC-NBR-04-X    TO DP010I-UNEDITED-FIELD         08010099
080200        MOVE 1                   TO DP010I-MAXIMUM-DIGITS         08020099
080300        MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS       08030099
080400        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   08040099
080510        CALL DP010I-NUMERIC-EDIT-ROUTINE                          08051099
080520                         USING DP010I-NUMERIC-EDIT-AREA           08052099
080600        IF DP010I-ERROR-DETECTED                                  08060099
080700*         MUST BE NUMERIC                                         08070099
080800           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              08080099
080900           MOVE DP015-UNP-ALP-BRT-MDT                             08090099
081000                                 TO AUPC01A                       08100099
081100                                    AUPC02A                       08110099
081200                                    AUPC03A                       08120099
081300                                    AUPC04A                       08130099
081400           MOVE DP015-RED        TO AUPC04C                       08140099
081500           MOVE DP015-REVERSE    TO AUPC04H                       08150099
081600           MOVE -1               TO AUPC04L                       08160099
081700           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    08170099
081800           SET PS-ERROR                                           08180099
081900               DP020-MSG-FATAL   TO TRUE                          08190099
082000        ELSE                                                      08200099
082100           MOVE DP010I-NUMERIC-FIELD                              08210099
082200                                 TO ASC-UPC-NBR-04                08220099
082300           MOVE ASC-UPC-NBR-04   TO AUPC04O                       08230099
082400                                                                  08240099
082500     END-IF.                                                      08250099
082600                                                                  08260099
082700     IF ASC-SKU-NBR-X IS NOT NUMERIC                              08270099
082800        MOVE ASC-SKU-NBR-X        TO DP010I-UNEDITED-FIELD        08280099
082900        MOVE 8                    TO DP010I-MAXIMUM-DIGITS        08290099
083000        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      08300099
083100        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   08310099
083210        CALL DP010I-NUMERIC-EDIT-ROUTINE                          08321099
083220                         USING DP010I-NUMERIC-EDIT-AREA           08322099
083300        IF DP010I-ERROR-DETECTED                                  08330099
083400           MOVE PC-TSYMSG-00695       TO DP020-MSG-NUMBER         08340099
083500           MOVE DP015-UNP-ALP-BRT-MDT TO ASKUNBRA                 08350099
083600           MOVE DP015-RED        TO ASKUNBRC                      08360099
083700           MOVE DP015-REVERSE    TO ASKUNBRH                      08370099
083800           MOVE -1               TO ASKUNBRL                      08380099
083900           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    08390099
084000           SET PS-ERROR                                           08400099
084100               DP020-MSG-FATAL   TO TRUE                          08410099
084200        END-IF                                                    08420099
084300     END-IF.                                                      08430099
084400                                                                  08440099
084500     IF PS-NO-ERROR                                               08450099
084600        MOVE ZERO                 TO ASC-SKU-FILLER               08460099
084700        MOVE ASC-SKU-NBR-X        TO DP010I-UNEDITED-FIELD        08470099
084800        MOVE 8                    TO DP010I-MAXIMUM-DIGITS        08480099
084900        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      08490099
085000        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   08500099
085110        CALL DP010I-NUMERIC-EDIT-ROUTINE                          08511099
085120                         USING DP010I-NUMERIC-EDIT-AREA           08512099
085200        IF DP010I-ERROR-DETECTED                                  08520099
085300**        SKU MUST BE NUMERIC                                     08530099
085400           MOVE PC-TSYMSG-00695  TO DP020-MSG-NUMBER              08540099
085500           MOVE DP015-UNP-ALP-BRT-MDT TO ASKUNBRA                 08550099
085600           MOVE DP015-RED        TO ASKUNBRC                      08560099
085700           MOVE DP015-REVERSE    TO ASKUNBRH                      08570099
085800           MOVE -1               TO ASKUNBRL                      08580099
085900           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    08590099
086000           SET PS-ERROR                                           08600099
086100               DP020-MSG-FATAL   TO TRUE                          08610099
086200        ELSE                                                      08620099
086300           MOVE DP010I-NUMERIC-FIELD                              08630099
086400                                 TO ASC-SKU-NBR-8                 08640099
086500           MOVE ASC-SKU-NBR-8    TO ASKUNBRO                      08650099
086600                                                                  08660099
086700     END-IF.                                                      08670099
086800                                                                  08680099
086900                                                                  08690099
087000     IF PS-NO-ERROR                                               08700099
087100        IF  ASC-UPC-NBR = ZEROS                                   08710099
087200        AND ASC-SKU-NBR = ZEROS                                   08720099
087300**       AT LEAST ONE LINE MUST BE ENTERED                        08730099
087400           MOVE PC-TSYMSG-00036    TO DP020-MSG-NUMBER            08740099
087500           PERFORM 3060-UPC-ERROR                                 08750099
087600           PERFORM 3070-SKU-ERROR                                 08760099
087700        ELSE                                                      08770099
087800           IF ASC-UPC-NBR > ZERO                                  08780099
087900              MOVE ASC-UPC-NBR     TO DK-UPC-NBR                  08790099
088000           ELSE                                                   08800099
088100               IF ASC-SKU-NBR > ZERO                              08810099
088200                  MOVE ASC-SKU-NBR TO DK-SKU-NBR                  08820099
088300               END-IF                                             08830099
088400           END-IF                                                 08840099
088500        END-IF                                                    08850099
088600     END-IF.                                                      08860099
088700                                                                  08870099
088800******************************************************************08880099
088900 3060-UPC-ERROR.                                                  08890099
089000                                                                  08900099
089100     INITIALIZE ASC-SPECIFIC-COMMAREA.                            08910099
089200     MOVE DP020-LOCATION-NBR       TO ASC-STORE-NBR.              08920099
089300                                                                  08930099
089400     MOVE AUPC01O                  TO ASC-UPC-NBR-01.             08940099
089500     MOVE AUPC02O                  TO ASC-UPC-NBR-02.             08950099
089600     MOVE AUPC03O                  TO ASC-UPC-NBR-03.             08960099
089700     MOVE AUPC04O                  TO ASC-UPC-NBR-04.             08970099
089800     SET PS-ERROR                                                 08980099
089900         DP020-MSG-FATAL                                          08990099
090000         DP030-SET-CURSOR-APPL-1   TO TRUE.                       09000099
090100                                                                  09010099
090200     MOVE DP015-RED                TO AUPC01C                     09020099
090300                                      AUPC02C                     09030099
090400                                      AUPC03C                     09040099
090500                                      AUPC04C.                    09050099
090600     MOVE DP015-REVERSE            TO AUPC01H                     09060099
090700                                      AUPC02H                     09070099
090800                                      AUPC03H                     09080099
090900                                      AUPC04H.                    09090099
091000     MOVE -1                       TO AUPC01L.                    09100099
091100                                                                  09110099
091200******************************************************************09120089
091300 3070-SKU-ERROR.                                                  09130099
091400                                                                  09140099
091500     INITIALIZE ASC-SPECIFIC-COMMAREA.                            09150099
091600     MOVE DP020-LOCATION-NBR       TO ASC-STORE-NBR.              09160099
091700                                                                  09170099
091800     MOVE ASKUNBRO                 TO ASC-SKU-NBR.                09180099
091900     SET PS-ERROR                                                 09190099
092000         DP020-MSG-FATAL                                          09200099
092100         DP030-SET-CURSOR-APPL-1   TO TRUE.                       09210099
092200                                                                  09220099
092300     MOVE DP015-RED                TO ASKUNBRC.                   09230099
092400     MOVE DP015-REVERSE            TO ASKUNBRH.                   09240099
092500     MOVE -1                       TO ASKUNBRL.                   09250099
092600                                                                  09260099
092700******************************************************************09270089
092800*    MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS        09280099
092900*    ON THE MAP.                                                  09290099
093000******************************************************************09300089
093100 3200-RESET-ATTRIBUTES.                                           09310099
093200                                                                  09320099
093300     MOVE DP015-PRO-NOR-OFF        TO ADPTNBRA                    09330099
093400                                      AMAJCLSA                    09340099
093500                                      ASUBCLSA                    09350099
093600                                      ASTRNMA                     09360099
093700                                      ADESCA                      09370099
093800                                      ASIZEA                      09380099
093900                                      ACOLORA                     09390099
094000                                      ASTATUSA                    09400099
094100                                      ASTADSCA                    09410099
094200                                      AVNDNMA                     09420099
094300                                      ATKTCLRA                    09430099
094400                                      AVNDSTYA                    09440099
094500                                      ASTACHGA                    09450099
094600                                      ABOXIDA                     09460099
094700                                      ACURRTLA                    09470099
094800                                      APRCCHGA                    09480099
094900                                      AGRPRTLA                    09490099
095000                                      AORGRTLA                    09500099
095100                                      ALOWRTLA                    09510099
095200                                      AONQTYA                     09520099
095300                                      ASTROHA                     09530099
095400                                      ARCPDTEA                    09540099
095500                                      AONORDRA                    09550099
095600                                      AINTRANA                    09560099
095700                                      ASALDTEA                    09570099
095800                                      ASTRNBRA.                   09580099
095900                                                                  09590099
096000     MOVE DP015-UNP-ALP-NOR-OFF    TO AUPC01A                     09600099
096100                                      AUPC02A                     09610099
096200                                      AUPC03A                     09620099
096300                                      AUPC04A                     09630099
096400                                      ASKUNBRA.                   09640099
096500                                                                  09650099
096600     MOVE DP015-BLUE               TO ADPTNBRC                    09660099
096700                                      AMAJCLSC                    09670099
096800                                      ASUBCLSC                    09680099
096900                                      ASTRNMC                     09690099
097000                                      ADESCC                      09700099
097100                                      ASIZEC                      09710099
097200                                      ACOLORC                     09720099
097300                                      ASTATUSC                    09730099
097400                                      ASTADSCC                    09740099
097500                                      AVNDNMC                     09750099
097600                                      AVNDSTYC                    09760099
097700                                      ASTACHGC                    09770099
097800                                      ABOXIDC                     09780099
097900                                      ACURRTLC                    09790099
098000                                      AGRPRTLC                    09800099
098100                                      AORGRTLC                    09810099
098200                                      ALOWRTLC                    09820099
098300                                      AONQTYC                     09830099
098400                                      ASTROHC                     09840099
098500                                      ARCPDTEC                    09850099
098600                                      AONORDRC                    09860099
098700                                      AINTRANC                    09870099
098800                                      ASALDTEC                    09880099
098900                                      ASTRNBRC.                   09890099
099000                                                                  09900099
099100     MOVE DP015-GREEN              TO AUPC01C                     09910099
099200                                      AUPC02C                     09920099
099300                                      AUPC03C                     09930099
099400                                      AUPC04C                     09940099
099500                                      ASKUNBRC.                   09950099
099600                                                                  09960099
099700     MOVE DP015-UNDERLINE          TO AUPC01H                     09970099
099800                                      AUPC02H                     09980099
099900                                      AUPC03H                     09990099
100000                                      AUPC04H                     10000099
100100                                      ASKUNBRH.                   10010099
100200                                                                  10020099
100300******************************************************************10030089
100400 3480-GET-STORE-NAME.                                             10040099
100500                                                                  10050099
100600     EXEC SQL                                                     10060099
100700         SELECT LOC_NM                                            10070099
100800           INTO :XST00001-LOC-NM                                  10080099
100900           FROM XST_LOC                                           10090099
101000          WHERE LOC_NBR    = :DK-LOCATION-NBR                     10100099
101100            AND (CHAR(CURRENT_DATE, ISO)                          10110099
101200                BETWEEN CHAR(OPN_DTE,ISO)                         10120099
101300                    AND CHAR(CLO_DTE,ISO))                        10130099
101400            WITH UR                                               10140099
101500     END-EXEC.                                                    10150099
101600                                                                  10160099
101700     EVALUATE SQLCODE                                             10170099
101800         WHEN +0                                                  10180099
101900              CONTINUE                                            10190099
102000                                                                  10200099
102100         WHEN +100                                                10210099
102200              MOVE SPACES          TO XST00001-LOC-NM             10220099
102300                                                                  10230099
102400         WHEN OTHER                                               10240099
102500              MOVE '3480-GET-STORE-NAME' TO DP013-PARAGRAPH       10250099
102600              SET   DP013-DB2-ABEND                               10260099
102700                    DP013-XCTL-DISPLAY-RESTART TO TRUE            10270099
102800              MOVE  SQLCA            TO DP013-SQLCA               10280099
102900              MOVE  'XST_LOC'        TO DP013-DB2-TABLE-NAME (1)  10290099
103000              MOVE  DK-LOCATION-NBR  TO DK-LOC-NBR-PIC9           10300099
103100              STRING 'SELECT ON '                                 10310099
103200                      DP013-DB2-TABLE-NAME (1)                    10320099
103300                     ' TABLE HAD BAD SQLCODE '                    10330099
103400                      DELIMITED BY SIZE                           10340099
103500                      INTO DP013-MESSAGE-TEXT (1)                 10350099
103600              STRING 'KEYS ARE - LOC - '                          10360099
103700                      DK-LOC-NBR-PIC9                             10370099
103800                      DELIMITED BY SIZE                           10380099
103900                      INTO DP013-MESSAGE-TEXT (2)                 10390099
104000              PERFORM DP013-0000-PROCESS-ABEND                    10400099
104100                                                                  10410099
104200     END-EVALUATE.                                                10420099
104300                                                                  10430099
104400******************************************************************10440089
104500*   POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 10450099
104600*   IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL,        10460099
104700*   MOVE IT HERE.                                                 10470099
104800******************************************************************10480089
104900 4000-BUILD-INITIAL-PANEL.                                        10490099
105000                                                                  10500099
105100     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        10510099
105200     MOVE -1                       TO ACSRUPCL.                   10520099
105300                                                                  10530099
105400     MOVE DP015-UNP-ALP-NOR-OFF    TO AUPC01A                     10540099
105500                                      AUPC02A                     10550099
105600                                      AUPC03A                     10560099
105700                                      AUPC04A                     10570099
105800                                      ASKUNBRA.                   10580099
105900                                                                  10590099
106000     MOVE ASC-UPC-NBR              TO DK-UPC-NBR.                 10600099
106100     MOVE ASC-SKU-NBR              TO XST00010-SKU-NBR.           10610099
106200                                                                  10620099
106300     IF PS-NEW-UPC-FOUND                                          10630099
106400     OR PS-NEW-SKU-FOUND                                          10640099
106500     OR PS-FIRST-TIME                                             10650099
106600         IF  ASC-UPC-NBR IS NUMERIC                               10660099
106700         AND PS-NEW-UPC-FOUND                                     10670099
106800             PERFORM 4100-SELECT-UPC                              10680099
106900         ELSE                                                     10690099
107000             IF  ASC-SKU-NBR IS NUMERIC                           10700099
107100             AND PS-NEW-SKU-FOUND                                 10710099
107200                 PERFORM 4110-SELECT-SKU                          10720099
107300             ELSE                                                 10730099
107400                 IF PS-FIRST-TIME                                 10740099
107500                    IF ASC-UPC-NBR > ZEROS                        10750099
107600                        PERFORM 4100-SELECT-UPC                   10760099
107700                    ELSE                                          10770099
107800                        IF ASC-SKU-NBR > ZEROS                    10780099
107900                            PERFORM 4110-SELECT-SKU               10790099
108000                        END-IF                                    10800099
108100                    END-IF                                        10810099
108200                 END-IF                                           10820099
108300             END-IF                                               10830099
108400         END-IF                                                   10840099
108500         PERFORM 4300-MOVE-UPC-SKU-DATA                           10850099
108600     ELSE                                                         10860099
108700         PERFORM 4400-MOVE-MAP-DATA                               10870099
108800     END-IF.                                                      10880099
108900                                                                  10890099
109000     IF DP020-LOCATION-NBR > ZERO                                 10900099
109100        MOVE DP020-LOCATION-NBR     TO DK-LOCATION-NBR            10910099
109200                                       DK-LOC-NBR-PIC9            10920099
109300        PERFORM 3480-GET-STORE-NAME                               10930099
109400        MOVE DK-LOC-NBR-PIC9        TO ASTRNBRO                   10940099
109500                                       ASC-STORE-NBR              10950099
109600        MOVE XST00001-LOC-NM        TO ASTRNMO                    10960099
109700                                       ASC-STORE-NAME             10970099
109800     END-IF.                                                      10980099
109900                                                                  10990099
110000******************************************************************11000089
110100 4100-SELECT-UPC.                                                 11010099
110200                                                                  11020099
110300     EXEC SQL                                                     11030099
110400         SELECT  UPC.UPC_NBR                                      11040099
110500                ,VNDSTYL.DEPT_NBR                                 11050099
110600                ,VNDSTYL.MAJ_CL_NBR                               11060099
110700                ,VNDSTYL.SUB_CL_NBR                               11070099
110800                ,VNDSTYL.STYL_ID                                  11080099
110900                ,VNDSTYL.VS_NBR                                   11090099
111000                ,VNDSTYL.LBL_NM                                   11100099
111100                ,VNDSTYL.STKR_NBR                                 11110099
111200                ,VNDSTYL.ENT_ID                                   11120099
111300                ,SKU.SIZE_DESC                                    11130099
111400                ,SKU.SKU_NBR                                      11140099
111500                ,SKU.SKU_DESC                                     11150099
111600                ,SKU.NRF_CLOR_DESC                                11160099
111700                ,SKU.INTR_UPC_ID                                  11170099
111800                ,SKU.REGN_PRIC_IND                                11180099
111900            INTO                                                  11190099
112000                 :XST00012-UPC-NBR                                11200099
112100                ,:XST00013-DEPT-NBR                               11210099
112200                ,:XST00013-MAJ-CL-NBR                             11220099
112300                ,:XST00013-SUB-CL-NBR                             11230099
112400                ,:XST00013-STYL-ID                                11240099
112500                ,:XST00013-VS-NBR                                 11250099
112600                ,:XST00013-LBL-NM                                 11260099
112700                ,:XST00013-STKR-NBR                               11270099
112800                ,:XST00013-ENT-ID                                 11280099
112900                ,:XST00010-SIZE-DESC                              11290099
113000                ,:XST00010-SKU-NBR                                11300099
113100                ,:XST00010-SKU-DESC                               11310099
113200                ,:XST00010-NRF-CLOR-DESC                          11320099
113300                ,:XST00010-INTR-UPC-ID                            11330099
113400                ,:XST00010-REGN-PRIC-IND                          11340099
113500           FROM  XST_VND_STYL  VNDSTYL                            11350099
113600                ,XST_SKU       SKU                                11360099
113700                ,XST_UPC       UPC                                11370099
113800          WHERE  UPC.UPC_NBR       = :DK-UPC-NBR                  11380099
113900            AND (UPC.UPC_TYP_CDE   = 'I'                          11390099
114000             OR  UPC.UPC_TYP_CDE   = 'V')                         11400099
114100            AND  UPC.LAST_ACTN_CDE <> 'D'                         11410099
114200            AND  UPC.INTR_UPC_ID   =  SKU.INTR_UPC_ID             11420099
114300            AND  SKU.STYL_ID       =  VNDSTYL.STYL_ID             11430099
114400           WITH UR                                                11440099
114500     END-EXEC.                                                    11450099
114600                                                                  11460099
114700     EVALUATE TRUE                                                11470099
114800       WHEN SQLCODE = ZERO                                        11480099
114900            SET PS-UPC-FOUND        TO TRUE                       11490099
115000            IF XST00013-LBL-NM = SPACES                           11500099
115100               PERFORM 4120-FIND-VENDOR-NAME                      11510099
115200            ELSE                                                  11520099
115300               MOVE XST00013-LBL-NM TO PV-VENDOR-NAME             11530099
115400            END-IF                                                11540099
115500                                                                  11550099
115600       WHEN SQLCODE = +100                                        11560099
115700            SET PS-UPC-NOT-FOUND    TO TRUE                       11570099
115800                                                                  11580099
115900       WHEN OTHER                                                 11590099
116000            MOVE '4100-SELECT-UPC'  TO DP013-PARAGRAPH            11600099
116100            MOVE SQLCA            TO DP013-SQLCA                  11610099
116200            MOVE 'XST_VND_STYL  ' TO DP013-DB2-TABLE-NAME (1)     11620099
116300            MOVE 'XST_SKU       ' TO DP013-DB2-TABLE-NAME (2)     11630099
116400            MOVE 'XST_UPC       ' TO DP013-DB2-TABLE-NAME (3)     11640099
116500            STRING 'SELECT ON '                                   11650099
116600                    DP013-DB2-TABLE-NAME (1)                      11660099
116700                    DP013-DB2-TABLE-NAME (2)                      11670099
116800                    DP013-DB2-TABLE-NAME (3)                      11680099
116900                   ' HAD BAD SQLCODE'                             11690099
117000                    DELIMITED BY SIZE                             11700099
117100                    INTO DP013-MESSAGE-TEXT (1)                   11710099
117200            MOVE DK-UPC-NBR       TO DK-UPC-NBR-PIC9              11720099
117300            STRING 'KEYS ARE - UPC - '                            11730099
117400                    DK-UPC-NBR-PIC9                               11740099
117500                    DELIMITED BY SIZE                             11750099
117600                    INTO DP013-MESSAGE-TEXT (2)                   11760099
117700            SET DP013-DB2-ABEND   TO TRUE                         11770099
117800            PERFORM DP013-0000-PROCESS-ABEND                      11780099
117900     END-EVALUATE.                                                11790099
118000                                                                  11800099
118100******************************************************************11810089
118200 4110-SELECT-SKU.                                                 11820099
118300                                                                  11830099
118400     EXEC SQL                                                     11840099
118500         SELECT  UPC.UPC_NBR                                      11850099
118600                ,VNDSTYL.DEPT_NBR                                 11860099
118700                ,VNDSTYL.MAJ_CL_NBR                               11870099
118800                ,VNDSTYL.SUB_CL_NBR                               11880099
118900                ,VNDSTYL.STYL_ID                                  11890099
119000                ,VNDSTYL.VS_NBR                                   11900099
119100                ,VNDSTYL.LBL_NM                                   11910099
119200                ,VNDSTYL.STKR_NBR                                 11920099
119300                ,VNDSTYL.ENT_ID                                   11930099
119400                ,SKU.SIZE_DESC                                    11940099
119500                ,SKU.SKU_NBR                                      11950099
119600                ,SKU.SKU_DESC                                     11960099
119700                ,SKU.NRF_CLOR_DESC                                11970099
119800                ,SKU.INTR_UPC_ID                                  11980099
119900                ,SKU.REGN_PRIC_IND                                11990099
120000            INTO                                                  12000099
120100                 :XST00012-UPC-NBR                                12010099
120200                ,:XST00013-DEPT-NBR                               12020099
120300                ,:XST00013-MAJ-CL-NBR                             12030099
120400                ,:XST00013-SUB-CL-NBR                             12040099
120500                ,:XST00013-STYL-ID                                12050099
120600                ,:XST00013-VS-NBR                                 12060099
120700                ,:XST00013-LBL-NM                                 12070099
120800                ,:XST00013-STKR-NBR                               12080099
120900                ,:XST00013-ENT-ID                                 12090099
121000                ,:XST00010-SIZE-DESC                              12100099
121100                ,:XST00010-SKU-NBR                                12110099
121200                ,:XST00010-SKU-DESC                               12120099
121300                ,:XST00010-NRF-CLOR-DESC                          12130099
121400                ,:XST00010-INTR-UPC-ID                            12140099
121500                ,:XST00010-REGN-PRIC-IND                          12150099
121600           FROM  XST_VND_STYL  VNDSTYL                            12160099
121700                ,XST_SKU       SKU                                12170099
121800                ,XST_UPC       UPC                                12180099
121900          WHERE  VNDSTYL.STYL_ID   =  SKU.STYL_ID                 12190099
122000            AND  SKU.INTR_UPC_ID   =  UPC.INTR_UPC_ID             12200099
122100            AND  SKU.SKU_NBR       = :XST00010-SKU-NBR            12210099
122200            AND  UPC.UPC_TYP_CDE   = 'I'                          12220099
122300           WITH  UR                                               12230099
122400     END-EXEC.                                                    12240099
122500                                                                  12250099
122600     EVALUATE TRUE                                                12260099
122700       WHEN SQLCODE = ZERO                                        12270099
122800            SET PS-SKU-FOUND          TO TRUE                     12280099
122900            IF XST00013-LBL-NM = SPACES                           12290099
123000               PERFORM 4120-FIND-VENDOR-NAME                      12300099
123100            ELSE                                                  12310099
123200               MOVE XST00013-LBL-NM      TO PV-VENDOR-NAME        12320099
123300            END-IF                                                12330099
123400                                                                  12340099
123500       WHEN SQLCODE = +100                                        12350099
123600            SET PS-SKU-NOT-FOUND      TO TRUE                     12360099
123700                                                                  12370099
123800       WHEN OTHER                                                 12380099
123900            MOVE '4110-SELECT-SKU' TO DP013-PARAGRAPH             12390099
124000            MOVE SQLCA             TO DP013-SQLCA                 12400099
124100            MOVE 'XST_VND_STYL  '  TO DP013-DB2-TABLE-NAME (1)    12410099
124200            MOVE 'XST_SKU       '  TO DP013-DB2-TABLE-NAME (2)    12420099
124300            MOVE 'XST_UPC       '  TO DP013-DB2-TABLE-NAME (3)    12430099
124400            STRING 'SELECT ON '                                   12440099
124500                    DP013-DB2-TABLE-NAME (1)                      12450099
124600                    DP013-DB2-TABLE-NAME (2)                      12460099
124700                    DP013-DB2-TABLE-NAME (3)                      12470099
124800                   ' HAD BAD SQLCODE'                             12480099
124900                    DELIMITED BY SIZE                             12490099
125000                    INTO DP013-MESSAGE-TEXT (1)                   12500099
125100            STRING 'KEYS ARE - UPC - '                            12510099
125200                    DK-SKU-NBR                                    12520099
125300                    DELIMITED BY SIZE                             12530099
125400                    INTO DP013-MESSAGE-TEXT (2)                   12540099
125500            SET DP013-DB2-ABEND TO TRUE                           12550099
125600            PERFORM DP013-0000-PROCESS-ABEND                      12560099
125700     END-EVALUATE.                                                12570099
125800                                                                  12580099
125900******************************************************************12590089
126000 4120-FIND-VENDOR-NAME.                                           12600099
126100                                                                  12610099
126200     EXEC SQL                                                     12620099
126300         SELECT ENT_NM_DESC                                       12630099
126400           INTO :XST00018-ENT-NM-DESC                             12640099
126500           FROM XST_VND                                           12650099
126600          WHERE ENT_ID   = :XST00013-ENT-ID                       12660099
126700     END-EXEC.                                                    12670099
126800                                                                  12680099
126900     EVALUATE TRUE                                                12690099
127000       WHEN SQLCODE = ZERO                                        12700099
127100            IF XST00018-ENT-NM-DESC = SPACES                      12710099
127200               MOVE 'NO VENDOR NAME'     TO PV-VENDOR-NAME        12720099
127300            ELSE                                                  12730099
127400               MOVE XST00018-ENT-NM-DESC TO PV-VENDOR-NAME        12740099
127500            END-IF                                                12750099
127600                                                                  12760099
127700       WHEN SQLCODE = +100                                        12770099
127800            MOVE 'NO VENDOR NAME'        TO PV-VENDOR-NAME        12780099
127900                                                                  12790099
128000       WHEN OTHER                                                 12800099
128100            MOVE '4120-FIND-VENDOR-NAME' TO DP013-PARAGRAPH       12810099
128200            MOVE SQLCA            TO DP013-SQLCA                  12820099
128300            MOVE 'XST_VND       ' TO DP013-DB2-TABLE-NAME (1)     12830099
128400            STRING 'SELECT ON '                                   12840099
128500                    DP013-DB2-TABLE-NAME (1)                      12850099
128600                   ' HAD BAD SQLCODE'                             12860099
128700                    DELIMITED BY SIZE                             12870099
128800                    INTO DP013-MESSAGE-TEXT (1)                   12880099
128900            MOVE XST00013-ENT-ID TO DK-ENT-ID-PIC9                12890099
129000            STRING 'KEYS ARE - ENT ID - '                         12900099
129100                    DK-ENT-ID-PIC9                                12910099
129200                    DELIMITED BY SIZE                             12920099
129300                    INTO DP013-MESSAGE-TEXT (2)                   12930099
129400            SET DP013-DB2-ABEND TO TRUE                           12940099
129500            PERFORM DP013-0000-PROCESS-ABEND                      12950099
129600     END-EVALUATE.                                                12960099
129700                                                                  12970099
129800******************************************************************12980089
129900*    ORIGINAL RETAIL AND LOWEST RETAIL ARE RETRIEVED BY USING     12990099
130000*        XMKCS002.                                                13000099
130100*                                                                 13010099
130200*    IF THE REGION PRICE INDICATOR IS SET TO "Y"                  13020099
130300*       TRY TO READ THE XST_SKU_LOC ROW FOR THAT SPECIFIC         13030099
130400*       STORE.  IF IT IS FOUND, THAT'S THE CURRENT RETAIL TO      13040099
130500*       DISPLAY ON THE SCREEN.  IF IT ISN'T FOUND, READ THE       13050099
130600*       ROW FOR STORE 0 AND DISPLAY THAT PRICE FOR CURRENT        13060099
130700*       RETAIL.                                                   13070099
130800*    ELSE                                                         13080099
130900*       READ THE ROW FOR STORE 0 AND DISPLAY THAT PRICE FOR       13090099
131000*       THE CURRENT RETAIL.                                       13100099
131100******************************************************************13110089
131200 4200-FIND-CURRENT-RETAIL.                                        13120099
131300                                                                  13130099
131400     MOVE XST00010-INTR-UPC-ID TO PV-INTR-UPC-ID.                 13140099
131500                                                                  13150099
131600     IF XST00010-REGN-PRIC-IND = 'Y'                              13160099
131700        MOVE ASC-STORE-NBR    TO PV-STORE-NUMBER                  13170099
131800                                                                  13180099
131900        PERFORM 4220-SELECT-CURRENT-RETAIL                        13190099
132000        IF PS-CURRENT-RETAIL-FOUND                                13200099
132100           IF PV-STATUS-CODE = PC-STATUS-25                       13210099
132200              MOVE '20' TO PV-STATUS-CODE                         13220099
132300           END-IF                                                 13230099
132400        ELSE                                                      13240099
132500           MOVE 0       TO PV-STORE-NUMBER                        13250099
132600           PERFORM 4220-SELECT-CURRENT-RETAIL                     13260099
132700           IF PV-STATUS-CODE = PC-STATUS-25                       13270099
132800              MOVE '20' TO PV-STATUS-CODE                         13280099
132900           END-IF                                                 13290099
133000        END-IF                                                    13300099
133100                                                                  13310099
133200     ELSE                                                         13320099
133300        MOVE 0          TO PV-STORE-NUMBER                        13330099
133400        PERFORM 4220-SELECT-CURRENT-RETAIL                        13340099
133500     END-IF.                                                      13350099
133600                                                                  13360099
133700******************************************************************13370089
133800*    NOTE: STORE 0 IS ALWAYS PRESENT FOR ALL UPCS.                13380099
133900*          THERE MAY BE OR MAY NOT BE ROWS FOR STORES FOR A       13390099
134000*          SPECIFIC UPC.                                          13400099
134100******************************************************************13410089
134200 4220-SELECT-CURRENT-RETAIL.                                      13420099
134300                                                                  13430099
134400     MOVE SPACES TO XST00008-UNT-RTL-CHG-DTE                      13440099
134500                    XST00008-UPC-STAT-CHG-DTE.                    13450099
134600                                                                  13460099
134700     EXEC SQL                                                     13470099
134800        SELECT LOC_SKU_STAT_CDE                                   13480099
134900              ,UNT_RTL_AMT                                        13490099
135000              ,UNT_RTL_CHG_DTE                                    13500099
135100              ,UPC_STAT_CHG_DTE                                   13510099
135200              ,GP_RTL_AMT                                         13520099
135300              ,BEG_TMST                                           13530099
135400          INTO :XST00008-LOC-SKU-STAT-CDE                         13540099
135500              ,:XST00008-UNT-RTL-AMT                              13550099
135600              ,:XST00008-UNT-RTL-CHG-DTE                          13560099
135700              ,:XST00008-UPC-STAT-CHG-DTE                         13570099
135800              ,:XST00008-GP-RTL-AMT  :PV-GP-RTL-AMT-NULL          13580099
135900              ,:XST00008-BEG-TMST                                 13590099
136000          FROM XST_SKU_LOC                                        13600099
136100         WHERE INTR_UPC_ID  = :PV-INTR-UPC-ID                     13610099
136200           AND LOC_NBR      = :PV-STORE-NUMBER                    13620099
136300           AND ((BEG_TMST  <= CURRENT TIMESTAMP                   13630099
136400           AND   END_TMST  >= CURRENT TIMESTAMP)                  13640099
136500            OR  (BEG_TMST  <= CURRENT TIMESTAMP                   13650099
136600           AND   END_TMST IS NULL))                               13660099
136700     END-EXEC.                                                    13670099
136800                                                                  13680099
136900     EVALUATE TRUE                                                13690099
137000         WHEN SQLCODE = ZERO                                      13700099
137100              SET PS-CURRENT-RETAIL-FOUND TO TRUE                 13710099
137200              MOVE XST00008-LOC-SKU-STAT-CDE                      13720099
137300                                          TO PV-STATUS-CODE       13730099
137400              MOVE XST00008-UNT-RTL-AMT   TO PV-UNT-RTL-AMT       13740099
137500              IF PV-GP-RTL-AMT-NULL = -1                          13750099
137600                 MOVE 0                   TO PV-GP-RTL-AMT        13760099
137700              ELSE                                                13770099
137800                 MOVE XST00008-GP-RTL-AMT TO PV-GP-RTL-AMT        13780099
137900              END-IF                                              13790099
138000                                                                  13800099
138100         WHEN SQLCODE = +100                                      13810099
138200              SET PS-CURRENT-RETAIL-NOT-FOUND TO TRUE             13820099
138300              MOVE 0                      TO PV-UNT-RTL-AMT       13830099
138400                                             PV-GP-RTL-AMT        13840099
138500                                                                  13850099
138600         WHEN OTHER                                               13860099
138700              MOVE '4220-SELECT-CURRENT-RETAIL'                   13870099
138800                                    TO DP013-PARAGRAPH            13880099
138900              SET  DP013-DB2-ABEND                                13890099
139000                   DP013-XCTL-DISPLAY-RESTART TO TRUE             13900099
139100              MOVE SQLCA            TO DP013-SQLCA                13910099
139200              MOVE 'XST_SKU_LOC  '  TO DP013-DB2-TABLE-NAME (1)   13920099
139300              STRING 'SELECT STATUS FROM '                        13930099
139400                      DP013-DB2-TABLE-NAME (1)                    13940099
139500                     ' TABLE HAD BAD SQLCODE '                    13950099
139600                     ' - '                                        13960099
139700                      DELIMITED BY SIZE                           13970099
139800                      INTO DP013-MESSAGE-TEXT (1)                 13980099
139900              MOVE PV-INTR-UPC-ID   TO DK-INTR-UPC-ID-PIC9        13990099
140000              MOVE PV-STORE-NUMBER  TO DK-STORE-NBR-PIC9          14000099
140100              STRING 'KEYS ARE - INTR UPC ID - '                  14010099
140200                      DK-INTR-UPC-ID-PIC9                         14020099
140300                     ' STORE NBR - '                              14030099
140400                      DK-STORE-NBR-PIC9                           14040099
140500                      DELIMITED BY SIZE                           14050099
140600                      INTO DP013-MESSAGE-TEXT (2)                 14060099
140700              PERFORM DP013-0000-PROCESS-ABEND                    14070099
140800     END-EVALUATE.                                                14080099
140900                                                                  14090099
141000******************************************************************14100089
141100 4300-MOVE-UPC-SKU-DATA.                                          14110099
141200                                                                  14120099
141300     SET ASC-NO-DATA-MOVED          TO TRUE.                      14130099
141400                                                                  14140099
141500     IF PS-UPC-FOUND                                              14150099
141600     OR PS-SKU-FOUND                                              14160099
141700        SET ASC-DATA-MOVED          TO TRUE                       14170099
141800        MOVE XST00012-UPC-NBR       TO ASC-UPC-NBR                14180099
141900        MOVE XST00013-DEPT-NBR      TO ASC-DEPT-NBR               14190099
142000        MOVE XST00013-MAJ-CL-NBR    TO ASC-MAJ-CL-NBR             14200099
142100        MOVE XST00013-SUB-CL-NBR    TO ASC-SUB-CL-NBR             14210099
142200        MOVE XST00010-SIZE-DESC     TO ASC-SIZE-DESC              14220099
142300        MOVE XST00010-NRF-CLOR-DESC TO ASC-COLOR-DESC             14230099
142400        MOVE XST00010-SKU-DESC      TO ASC-SKU-DESC               14240099
142500        MOVE XST00010-SKU-NBR       TO ASC-SKU-NBR                14250099
142600        MOVE XST00010-INTR-UPC-ID   TO ASC-INTR-UPC-ID            14260099
142700                                                                  14270099
142800        MOVE PV-VENDOR-NAME         TO ASC-VENDOR-NAME            14280099
142900                                                                  14290099
143000        MOVE XST00013-VS-NBR        TO ASC-VS-NBR                 14300099
143100        MOVE XST00013-STKR-NBR      TO ASC-STKR-NBR               14310099
143200                                                                  14320099
143300        PERFORM 7200-CALL-XMKCS004                                14330099
143400                                                                  14340099
143500        PERFORM 4200-FIND-CURRENT-RETAIL                          14350099
143600                                                                  14360099
143700        MOVE PV-STATUS-CODE         TO ASC-STATUS                 14370099
143800        MOVE PV-UNT-RTL-AMT         TO ASC-RETAIL-PRICE           14380099
143900        MOVE PV-GP-RTL-AMT          TO ASC-GP-RTL-AMT             14390099
144000        MOVE PV-ORIG-RTL-AMT        TO ASC-ORIG-RTL-AMT           14400099
144100        MOVE PV-LOW-RTL-AMT         TO ASC-LOW-RTL-AMT            14410099
144200                                                                  14420099
144300        PERFORM 4500-FORMAT-TICKET-COLOR                          14430099
144400                                                                  14440099
144500*       *------------------------------------------------------*  14450099
144600*       *  IF THE SETUP IS EQUAL TO THE UNIT RETAIL CHANGE     *  14460099
144700*       *  DATE AND UPC STATUS CHANGE DATE, THERE HAVEN'T BEEN *  14470099
144800*       *  ANY PRICE CHANGES SO DISPLAY ALL ZEROS.             *  14480099
144900*       *                                                      *  14490099
145000*       *------------------------------------------------------*  14500099
145100        IF  PV-SETUP-DATE = XST00008-UNT-RTL-CHG-DTE              14510099
145200        AND PV-SETUP-DATE = XST00008-UPC-STAT-CHG-DTE             14520099
145300           MOVE PC-DEFAULT-DATE-0         TO ASC-UNT-RTL-CHG-DTE  14530099
145400                                             ASC-UPC-STAT-CHG-DTE 14540099
145500        ELSE                                                      14550099
145600           MOVE XST00008-UNT-RTL-CHG-DTE  TO ASC-UNT-RTL-CHG-DTE  14560099
145700           MOVE XST00008-UPC-STAT-CHG-DTE TO ASC-UPC-STAT-CHG-DTE 14570099
145800        END-IF                                                    14580099
145900                                                                  14590099
146000*--------------------------------------------------------------*  14600099
146100*       WHEN FIRST READING A UPC, ALWAY CLEAR THE FIELDS       *  14610099
146200*            POPULATED BY F14.                                 *  14620099
146300*--------------------------------------------------------------*  14630099
146400        MOVE 0              TO PV-WORK-QTY-Z                      14640099
146500        MOVE PV-WORK-QTY-X  TO ASC-ON-HAND                        14650099
146600                               ASC-ON-ORDER                       14660099
146700                               ASC-STORE-ON-HAND                  14670099
146800                               ASC-IN-TRANSIT-QTY                 14680099
146900        MOVE SPACES         TO ASC-LAST-RCVD-DATE                 14690099
147000                               ASC-LAST-SALE-DATE                 14700099
147100     END-IF.                                                      14710099
147200                                                                  14720099
147300     PERFORM 4400-MOVE-MAP-DATA.                                  14730099
147400                                                                  14740099
147500******************************************************************14750089
147600 4400-MOVE-MAP-DATA.                                              14760099
147700                                                                  14770099
147800     IF ASC-DATA-MOVED                                            14780099
147900         MOVE ASC-UPC-NBR-01         TO AUPC01O                   14790099
148000         MOVE ASC-UPC-NBR-02         TO AUPC02O                   14800099
148100         MOVE ASC-UPC-NBR-03         TO AUPC03O                   14810099
148200         MOVE ASC-UPC-NBR-04         TO AUPC04O                   14820099
148300         MOVE ASC-DEPT-NBR           TO ADPTNBRO                  14830099
148400         MOVE ASC-MAJ-CL-NBR         TO AMAJCLSO                  14840099
148500         MOVE ASC-SUB-CL-NBR         TO ASUBCLSO                  14850099
148600         MOVE ASC-SKU-NBR-8          TO ASKUNBRO                  14860099
148700         MOVE ASC-SKU-DESC           TO ADESCO                    14870099
148800         MOVE ASC-SIZE-DESC          TO ASIZEO                    14880099
148900         MOVE ASC-COLOR-DESC         TO ACOLORO                   14890099
149000         MOVE ASC-VENDOR-NAME        TO AVNDNMO                   14900099
149100         MOVE ASC-VS-NBR             TO AVNDSTYO                  14910099
149200         MOVE ASC-STKR-NBR           TO PV-STKR-ID-9              14920099
149300         MOVE PV-STKR-ID-9           TO PV-STKR-ID                14930099
149400         MOVE PV-STKR-ID             TO ABOXIDO                   14940099
149500         MOVE ASC-STATUS             TO ASTATUSO                  14950099
149600         MOVE ASC-RETAIL-PRICE       TO ACURRTLO                  14960099
149700         MOVE ASC-GP-RTL-AMT         TO AGRPRTLO                  14970099
149800         MOVE ASC-ORIG-RTL-AMT       TO AORGRTLO                  14980099
149900         MOVE ASC-LOW-RTL-AMT        TO ALOWRTLO                  14990099
150000         MOVE ASC-UNT-RTL-CHG-DTE    TO APRCCHGO                  15000099
150100         MOVE ASC-UPC-STAT-CHG-DTE   TO ASTACHGO                  15010099
150200         MOVE ASC-LOCATION-NBR       TO ASTRNBRO                  15020099
150300         MOVE ASC-STORE-NAME         TO ASTRNMO                   15030099
150400         MOVE ASC-ON-HAND            TO AONQTYO                   15040099
150500         MOVE ASC-ON-ORDER           TO AONORDRO                  15050099
150600         MOVE ASC-STORE-ON-HAND      TO ASTROHO                   15060099
150700         MOVE ASC-IN-TRANSIT-QTY     TO AINTRANO                  15070099
150800         MOVE ASC-LAST-RCVD-DATE     TO ARCPDTEO                  15080099
150900         MOVE ASC-LAST-SALE-DATE     TO ASALDTEO                  15090099
151000                                                                  15100099
151100         EVALUATE ASC-STATUS                                      15110099
151200             WHEN '10'                                            15120099
151300                  MOVE 'NEW   '          TO ASTADSCO              15130099
151400             WHEN '20'                                            15140099
151500                  MOVE 'ACTIVE'          TO ASTADSCO              15150099
151600             WHEN '25'                                            15160099
151700                  MOVE 'MIXED'           TO ASTADSCO              15170099
151800             WHEN '30'                                            15180099
151900                  MOVE 'CLEAR '          TO ASTADSCO              15190099
152000             WHEN '40'                                            15200099
152100                  MOVE 'PROMO '          TO ASTADSCO              15210099
152200             WHEN '90'                                            15220099
152300                  MOVE 'DISCON'          TO ASTADSCO              15230099
152400             WHEN '98'                                            15240099
152500                  MOVE 'RENUM '          TO ASTADSCO              15250099
152600             WHEN OTHER                                           15260099
152700                  MOVE 'UNKNWN'          TO ASTADSCO              15270099
152800         END-EVALUATE                                             15280099
152900     ELSE                                                         15290099
153000         PERFORM 4450-CLEAR-FIELDS                                15300099
153100         IF ASC-UPC-NBR IS NOT NUMERIC                            15310099
153200**         MUST BE NUMERIC                                        15320099
153300             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      15330099
153400             MOVE ASC-UPC-NBR-01         TO AUPC01O               15340099
153500             MOVE ASC-UPC-NBR-02         TO AUPC02O               15350099
153600             MOVE ASC-UPC-NBR-03         TO AUPC03O               15360099
153700             MOVE ASC-UPC-NBR-04         TO AUPC04O               15370099
153800             PERFORM 3060-UPC-ERROR                               15380099
153900         ELSE                                                     15390099
154000         IF ASC-UPC-NBR > ZEROS AND PS-NEW-UPC-FOUND              15400099
154100**         UPC DOES NOT EXIST                                     15410099
154200             MOVE PC-TSYMSG-00100        TO DP020-MSG-NUMBER      15420099
154300             MOVE ASC-UPC-NBR-01         TO AUPC01O               15430099
154400             MOVE ASC-UPC-NBR-02         TO AUPC02O               15440099
154500             MOVE ASC-UPC-NBR-03         TO AUPC03O               15450099
154600             MOVE ASC-UPC-NBR-04         TO AUPC04O               15460099
154700             PERFORM 3060-UPC-ERROR                               15470099
154800         ELSE                                                     15480099
154900             IF ASC-SKU-NBR IS NUMERIC AND PS-NEW-SKU-FOUND       15490099
155000**             MUST BE NUMERIC                                    15500099
155100                 MOVE PC-TSYMSG-00073    TO DP020-MSG-NUMBER      15510099
155200                 MOVE ZEROS              TO ASC-UPC-NBR           15520099
155300                 MOVE ASC-SKU-NBR-8      TO ASKUNBRO              15530099
155400                 PERFORM 3070-SKU-ERROR                           15540099
155500             ELSE                                                 15550099
155600                 IF ASC-SKU-NBR IS NOT NUMERIC                    15560099
155700**                SKU MUST BE NUMERIC                             15570099
155800                    MOVE PC-TSYMSG-00695 TO DP020-MSG-NUMBER      15580099
155900                    MOVE ASC-SKU-NBR-8   TO ASKUNBRO              15590099
156000                    PERFORM 3070-SKU-ERROR                        15600099
156100                 END-IF                                           15610099
156200             END-IF                                               15620099
156300         END-IF                                                   15630099
156400      END-IF                                                      15640099
156500     END-IF.                                                      15650099
156600                                                                  15660099
156700******************************************************************15670089
156800* CLEAR SCREEN FIELDS WHEN THERE IS AN ERROR                      15680099
156900******************************************************************15690089
157000 4450-CLEAR-FIELDS.                                               15700099
157100                                                                  15710099
157200     INITIALIZE AUPC01O                                           15720099
157300                AUPC02O                                           15730099
157400                AUPC03O                                           15740099
157500                AUPC04O                                           15750099
157600                ADPTNBRO                                          15760099
157700                AMAJCLSO                                          15770099
157800                ASUBCLSO                                          15780099
157900                ASKUNBRO                                          15790099
158000                ADESCO                                            15800099
158100                ASIZEO                                            15810099
158200                ACOLORO                                           15820099
158300                ATKTCLRO                                          15830099
158400                AVNDNMO                                           15840099
158500                AVNDSTYO                                          15850099
158600                ABOXIDO                                           15860099
158700                ASTATUSO                                          15870099
158800                ACURRTLI                                          15880099
158900                AGRPRTLI                                          15890099
159000                AORGRTLI                                          15900099
159100                ALOWRTLI                                          15910099
159200                APRCCHGO                                          15920099
159300                ASTACHGO                                          15930099
159400                ASTRNBRO                                          15940099
159500                ASTRNMO                                           15950099
159600                AONQTYO                                           15960099
159700                AONORDRO                                          15970099
159800                ASTROHO                                           15980099
159900                AINTRANO                                          15990099
160000                ARCPDTEO                                          16000099
160100                ASALDTEO                                          16010099
160200                ASTADSCO.                                         16020099
160300                                                                  16030099
160400******************************************************************16040089
160500*    THE TICKET COLOR IS ALWAYS WHITE FOR ANY STATUS OTHER        16050099
160600*        THAN '30' CLEARANCE.                                     16060099
160700*                                                                 16070099
160800*    FOR CLEARANCE ITEMS ("30"), WHEN THE STATUS CHANGE DATE      16080099
160900*        AND THE PRICE CHANGE DATE AREN'T EQUAL, THIS             16090099
161000*        INDICATES A CONTINUOUS MARKDOWN.  THIS HELPS IDENTIFY    16100099
161100*        SKUS THAT SHOULD HAVE RED TICKETS.                       16110099
161200******************************************************************16120089
161300 4500-FORMAT-TICKET-COLOR.                                        16130099
161400                                                                  16140099
161500     EVALUATE PV-STATUS-CODE                                      16150099
161600         WHEN '30'                                                16160099
161700              IF XST00008-UNT-RTL-CHG-DTE >                       16170099
161800                                        XST00008-UPC-STAT-CHG-DTE 16180099
161900                 MOVE PC-RED       TO ATKTCLRO                    16190099
162000                 MOVE DP015-RED    TO ATKTCLRC                    16200099
162100              ELSE                                                16210099
162200                 MOVE PC-YELLOW    TO ATKTCLRO                    16220099
162300                 MOVE DP015-YELLOW TO ATKTCLRC                    16230099
162400              END-IF                                              16240099
162500                                                                  16250099
162600         WHEN OTHER                                               16260099
162700              MOVE PC-WHITE        TO ATKTCLRO                    16270099
162800              MOVE DP015-WHITE     TO ATKTCLRC                    16280099
162900     END-EVALUATE.                                                16290099
163000                                                                  16300099
169300******************************************************************16930089
169400*    XMKCS001 RETRIEVES THE ON HAND, ON ORDER QUANTITIES,         16940099
169500*        LAST RECEIVED DATE AND LAST SALE DATE.                   16950099
169600******************************************************************16960089
169700 7000-CALL-XMKCS001.                                              16970099
169800                                                                  16980099
169900     INITIALIZE XM003-ITEM-COMMAREA.                              16990099
170000     SET XM003-ONORDER-YES                                        17000099
170100         XM003-ONHAND-YES               TO TRUE.                  17010099
170200     MOVE ASC-STORE-NBR                 TO XM003-KEY-STR-NBR.     17020099
170300     MOVE ASC-SKU-NBR                   TO XM003-KEY-SKU.         17030099
170400     MOVE LENGTH OF XM003-ITEM-COMMAREA TO PV-COMMAREA-LENGTH.    17040099
170500                                                                  17050099
170600     EXEC CICS                                                    17060099
170700          LINK                                                    17070099
170800               PROGRAM (PC-XMKCS001)                              17080099
170900              COMMAREA (XM003-ITEM-COMMAREA)                      17090099
171000                LENGTH (PV-COMMAREA-LENGTH)                       17100099
171100                  RESP (PV-CICS-RESPONSE)                         17110099
171200     END-EXEC.                                                    17120099
171300                                                                  17130099
171400     EVALUATE TRUE                                                17140099
171500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17150099
171600              EVALUATE TRUE                                       17160099
171700                  WHEN XM003-SUCCESSFUL                           17170099
171800                       MOVE XM003-ONHAND    TO PV-WORK-QTY-9      17180099
171900                                               PV-ONHAND-QTY      17190099
172000                       MOVE PV-WORK-QTY-X   TO AONQTYO            17200099
172100                                               ASC-ON-HAND        17210099
172200                       MOVE XM003-ONORDER   TO PV-WORK-QTY-9      17220099
172300                       MOVE PV-WORK-QTY-X   TO AONORDRO           17230099
172400                                               ASC-ON-ORDER       17240099
172500                                                                  17250099
172600                       MOVE XM003-LAST-RCVD-DATE TO ARCPDTEO      17260099
172700                                               ASC-LAST-RCVD-DATE 17270099
172800                       MOVE XM003-LAST-SALE-DATE TO ASALDTEO      17280099
172900                                               ASC-LAST-SALE-DATE 17290099
173000                                                                  17300099
173100                  WHEN OTHER                                      17310099
173200                       IF XM003-RETURN-SQLCODE = +100             17320099
173300                          MOVE 0 TO PV-WORK-QTY-9                 17330099
173400                                    PV-ONHAND-QTY                 17340099
173500                          MOVE PV-WORK-QTY-X  TO AONQTYO          17350099
173600                                                 ASC-ON-HAND      17360099
173700                          MOVE 0              TO PV-WORK-QTY-9    17370099
173800                          MOVE PV-WORK-QTY-X  TO AONORDRO         17380099
173900                                                 ASC-ON-ORDER     17390099
174000                                                                  17400099
174100                          MOVE SPACES        TO ARCPDTEO          17410099
174200                                                ASALDTEO          17420099
174300                                                ASC-LAST-RCVD-DATE17430099
174400                                                ASC-LAST-SALE-DATE17440099
174500                       ELSE                                       17450099
174600                         MOVE 0               TO PV-WORK-QTY-9    17460099
174700                                                 PV-ONHAND-QTY    17470099
174800                         MOVE PV-WORK-QTY-X   TO AONQTYO          17480099
174900                                                 ASC-ON-HAND      17490099
175000                         MOVE 0               TO PV-WORK-QTY-9    17500099
175100                         MOVE PV-WORK-QTY-X   TO AONORDRO         17510099
175200                                                 ASC-ON-ORDER     17520099
175300                                                                  17530099
175400                         MOVE SPACES TO ARCPDTEO                  17540099
175500                                        ASALDTEO                  17550099
175600                                        ASC-LAST-RCVD-DATE        17560099
175700                                        ASC-LAST-SALE-DATE        17570099
175800**                  ONHAND INFORMATION NOT AVAILABLE AT THIS TIME 17580099
175900                         MOVE PC-TSYMSG-03388 TO DP020-MSG-NUMBER 17590099
176000                         SET DP020-MSG-WARNING  TO TRUE           17600099
176100                       END-IF                                     17610099
176200              END-EVALUATE                                        17620099
176300                                                                  17630099
176400         WHEN OTHER                                               17640099
176500              MOVE PV-CICS-RESPONSE TO PV-CICS-RESPONSE-9         17650099
176600              STRING 'INVALID CICS RETURN CODE ON CALL '          17660099
176700                     'TO XMKCS001 - '                             17670099
176800                      PV-CICS-RESPONSE-9                          17680099
176900                      DELIMITED BY SIZE                           17690099
177000                      INTO DP013-MESSAGE-TEXT (2)                 17700099
177100              PERFORM 7100-FORMAT-ERROR                           17710099
177200     END-EVALUATE.                                                17720099
177300                                                                  17730099
177400******************************************************************17740089
177500 7100-FORMAT-ERROR.                                               17750099
177600                                                                  17760099
177700     MOVE '7000-CALL-XMKCS001'      TO DP013-PARAGRAPH.           17770099
177800     MOVE 'RETRIEVE ONHAND, ON ORDER QUANTITIES ERROR'            17780099
177900                                    TO DP013-MESSAGE-TEXT (1).    17790099
178000     SET DP013-DB2-ABEND                                          17800099
178100         DP013-XCTL-DISPLAY-RESTART TO TRUE.                      17810099
178200     PERFORM DP013-0000-PROCESS-ABEND.                            17820099
178300                                                                  17830099
178400******************************************************************17840089
178500*    XMKCS004 RETRIEVES THE ORIGINAL RETAIL AND LOWEST RETAIL     17850099
178600*        AMOUNTS FROM FASHION.                                    17860099
178700******************************************************************17870089
178800 7200-CALL-XMKCS004.                                              17880099
178900                                                                  17890099
179000     INITIALIZE XM002-ITEM-COMMAREA.                              17900099
179100     MOVE ASC-SKU-NBR                   TO XM002-SKU.             17910099
179200     MOVE LENGTH OF XM002-ITEM-COMMAREA TO PV-COMMAREA-LENGTH.    17920099
179300                                                                  17930099
179400     EXEC CICS                                                    17940099
179500          LINK                                                    17950099
179600               PROGRAM (PC-XMKCS004)                              17960099
179700              COMMAREA (XM002-ITEM-COMMAREA)                      17970099
179800                LENGTH (PV-COMMAREA-LENGTH)                       17980099
179900                  RESP (PV-CICS-RESPONSE)                         17990099
180000     END-EXEC.                                                    18000099
180100                                                                  18010099
180200     EVALUATE TRUE                                                18020099
180300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 18030099
180400              EVALUATE TRUE                                       18040099
180500                  WHEN XM002-SUCCESSFUL                           18050099
180600                       MOVE XM002-ORIG-UNT-RTL-AMT TO             18060099
180700                                                   PV-ORIG-RTL-AMT18070099
180800                       MOVE XM002-LOWST-UNT-RTL-AMT TO ALOWRTLO   18080099
180900                                                   PV-LOW-RTL-AMT 18090099
181000                       MOVE XM002-SETUP-DATE TO PV-SETUP-DATE     18100099
181100                                                                  18110099
181200                  WHEN OTHER                                      18120099
181300                       MOVE 0  TO PV-ORIG-RTL-AMT                 18130099
181400                                  PV-LOW-RTL-AMT                  18140099
181500                       MOVE SPACES TO PV-SETUP-DATE               18150099
181600                       IF XM002-RETURN-SQLCODE = -911 OR          18160099
181700                                                 -913             18170099
181800**                      RESOURCE IS UNAVAILABLE                   18180099
181900                          MOVE PC-TSYMSG-01063 TO                 18190099
182000                                               DP020-MSG-NUMBER   18200099
182100                          SET DP020-MSG-INFORMATIONAL TO TRUE     18210099
182200                       END-IF                                     18220099
182300              END-EVALUATE                                        18230099
182400                                                                  18240099
182500         WHEN OTHER                                               18250099
182600              MOVE PV-CICS-RESPONSE TO PV-CICS-RESPONSE-9         18260099
182700              STRING 'INVALID CICS RETURN CODE ON CALL '          18270099
182800                     'TO XMKCS004 - '                             18280099
182900                      PV-CICS-RESPONSE-9                          18290099
183000                      DELIMITED BY SIZE                           18300099
183100                      INTO DP013-MESSAGE-TEXT (2)                 18310099
183200              PERFORM 7500-FORMAT-ERROR                           18320099
183300     END-EVALUATE.                                                18330099
183400                                                                  18340099
183500******************************************************************18350089
183600 7300-FORMAT-ERROR.                                               18360099
183700                                                                  18370099
183800     MOVE '7200-CALL-XMKCS004'      TO DP013-PARAGRAPH.           18380099
183900     MOVE 'RETRIEVE ORIGINAL AND LOWEST RETAIL AMOUNT ERROR'      18390099
184000                                    TO DP013-MESSAGE-TEXT (1).    18400099
184100     SET DP013-DB2-ABEND                                          18410099
184200         DP013-XCTL-DISPLAY-RESTART TO TRUE.                      18420099
184300     PERFORM DP013-0000-PROCESS-ABEND.                            18430099
184400                                                                  18440099
184500******************************************************************18450089
184600*    XLKCS074 RETRIEVES THE INTRANSIT QUANTITY AND STORE          18460099
184700*        EXPECTED QUANTITY.                                       18470099
184800******************************************************************18480089
184900 7400-CALL-XLKCS074.                                              18490099
185000                                                                  18500099
185100     INITIALIZE XL074-ITEM-COMMAREA.                              18510099
185200     SET XL074-BY-SKU            TO TRUE.                         18520099
185300     SET XL074-BY-STORE          TO TRUE.                         18530099
185400     MOVE ASC-STORE-NBR          TO XL074-KEY-LOC-NBR.            18540099
185500     MOVE ASC-SKU-NBR            TO XL074-KEY-SKU.                18550099
185600                                                                  18560099
185700     CALL XL074-ONLINE-PGM USING DFHEIBLK                         18570099
185800                                 XL074-COMMAREA                   18580099
185900                                 XL074-ITEM-COMMAREA.             18590099
186000                                                                  18600099
186100     EVALUATE TRUE                                                18610099
186200         WHEN XL074-SUCCESSFUL                                    18620099
186300              MOVE XL074-SE-QTY  TO PV-STORE-EXPECTED-QTY         18630099
186400              MOVE XL074-IT-QTY  TO PV-INTRANSIT-QTY              18640099
186500                                                                  18650099
186600         WHEN XL074-SQL-ERROR                                     18660099
186700              MOVE XL074-KEY-SKU TO DK-SKU-NBR                    18670099
186800              STRING 'INVALID RETURN CODE FROM XLKCS074 '         18680099
186900                      XL074-SQLCODE                               18690099
187000                     ' - '                                        18700099
187100                      DK-SKU-NBR                                  18710099
187200                     ' - '                                        18720099
187300                      DELIMITED BY SIZE                           18730099
187400                      INTO DP013-MESSAGE-TEXT (2)                 18740099
187500              PERFORM 7500-FORMAT-ERROR                           18750099
187600                                                                  18760099
187700         WHEN OTHER                                               18770099
187800**          BOTTOM OF LIST                                        18780099
187900              MOVE PC-TSYMSG-00070        TO DP020-MSG-NUMBER     18790099
188000              SET DP020-MSG-INFORMATIONAL TO TRUE                 18800099
188100     END-EVALUATE.                                                18810099
188200                                                                  18820099
188300******************************************************************18830089
188400 7500-FORMAT-ERROR.                                               18840099
188500                                                                  18850099
188600     MOVE '7400-CALL-XLKCS074'      TO DP013-PARAGRAPH.           18860099
188700     STRING 'RETRIEVE INTRANSIT AND STORE EXPECTED QTY ERROR'     18870099
188800            'IN PARAGRAPH '                                       18880099
188900             XL074-ERROR-PARAGRAPH-NBR                            18890099
189000             DELIMITED BY SIZE                                    18900099
189100             INTO DP013-MESSAGE-TEXT (1).                         18910099
189200     SET DP013-DB2-ABEND                                          18920099
189300         DP013-XCTL-DISPLAY-RESTART TO TRUE.                      18930099
189400     MOVE XL074-SQLCA               TO SQLCA.                     18940099
189500     MOVE XL074-SQLCODE             TO SQLCODE.                   18950099
189600     PERFORM DP013-0000-PROCESS-ABEND.                            18960099
189700                                                                  18970099
189800******************************************************************18980089
189900*    ABEND PROCESSOR MODULE                                       18990099
190000******************************************************************19000089
190100     COPY DPPD013.                                                19010099
