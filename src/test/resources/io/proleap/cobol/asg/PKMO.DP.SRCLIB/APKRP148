000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.     APKRP148.                                        00020001
000300 AUTHOR.         JILL JUEL                                        00030001
000400 DATE-WRITTEN.   08/15/1999.                                      00040001
000500 DATE-COMPILED.                                                   00050001
000600******************************************************************00060001
000700*    COBOL II WITH SQL                                           *00070001
000800******************************************************************00080001
000900*        DAILY ADDITONS TO ADJUSTMENTS JOURNAL REPORT            *00090001
001000******************************************************************00100001
001100*                                                                *00110001
001200*    THIS PROGRAM PRODUCES THE DAILY ADJUSTMENT JOURNAL          *00120001
001300*    REPORT.  THE REPORT WILL BE IN POSTING PERIOD,              *00130001
001400*    DEPARTMENT/ACCOUNT, VENDOR, PO SEQUENCE, WITH TOTALS        *00140001
001500*    AT EACH CONTROL BREAK ON PERIOD, AND DEPT/ACCOUNT,          *00150001
001600*    WHEN APPROPRIATE. A CONTROL CARD WILL PROVIDE               *00160001
001700*    THE SUBTITLE FOR THE REPORT.  A SEPARATE INPUT FILE         *00170001
001800*    WILL ALLOW FOR THE REPORTING OF TOTALS BY ORIGIN            *00180001
001900*    CODE AT THE END OF THE REPORT.                              *00190001
002000*                                                                *00200001
002100* INPUT:                                                         *00210001
002200*  1. A CONTROL CARD CONTAINING THE SUBTITLE FOR THE REPORT      *00220001
002300*     CENTERED IN THE FIRST 40 BYTES.                            *00230001
002400*  2. ADJUSTMENT TRANSACTIONS, SORTED BY POSTING PERIOD,         *00240001
002500*     DEPARTMENT, ACCOUNT, VENDOR NUMBER, PO, DOCUMENT           *00250001
002600*     NUMBER, ORIGIN, AND TRANCODE.  COPYBOOK IS APRD045.        *00260001
002700*  3. ADJUSMENTS BY ORIGIN, SORTED AND SUMMED BY ORIGIN          *00270001
002800*     AND TRANCODE.  COPYBOOK IS APRD045.                        *00280001
002900*                                                                *00290001
003000* OUTPUT:                                                        *00300001
003100*  1. DAILY ADDITIONS TO ADJUSTMENT JOURNAL REPORT               *00310001
003200*                                                                *00320001
003300* DB2 TABLES                                                     *00330010
003400*  1. TAPCNTL                                                    *00340001
003500*  2. APT_ACCT_TBL                                               *00350010
003600*                                                                *00360001
003700******************************************************************00370001
003800* CHANGES                                                        *00380001
003900* 09/15/1999  JILL JUEL                                          *00390001
004000*    ADDED THE DESCRIPTION FOR THE GL ACCOUNT NUMBER TO THE      *00400001
004100*    REPORT.  IN ORDER TO DO THIS I NEEDED TO ADD A CALL TO      *00410001
004200*    THE PS_GL_ACCOUNT_TBL, S200-SELECT-ACCT-NBR-DESC            *00420001
004300*    ROUTINE, WHEN THE TRANSACTION IS AN EXPENSE.                *00430001
004400*                                                                *00440001
004500* 08/31/2000  JILL JUEL                WR/IR #: 20224            *00450001
004600*    ADDED LOGIC TO PROCESS THE NEW MOS-DISC FIELDS. THE         *00460001
004700*    NEW FIELDS ARE HANDLED THE SAME WAY THE NEW STORE           *00470001
004800*    DISCOUNT IS HANDLED.                                        *00480001
004900*                                                                *00490001
005000* 07/25/2001  ALEXIS KEIKER            WR/IR #: 22467            *00500001
005100*    INCREASED THE RECORD SIZES OF THE TWO INPUT FILES FROM      *00510001
005200*    400 TO 500.  THIS CHANGE WAS MADE BECAUSE COPYBOOK          *00520001
005300*    APRD045 WAS INCREASED TO 500.  ALSO GOT RID OF              *00530001
005400*    COPYBOOK APRD040 SINCE IT WAS NOT NEEDED.  CHANGED          *00540001
005500*    ALL REFERENCES TO AP040 TO ORGN-SUM SO IT WOULD USE         *00550001
005600*    COPYBOOK APRD045 INSTEAD.  ALSO CHANGED ALL                 *00560001
005700*    REFERENCES TO AP-TRAN TO ORIGIN-SUM SINCE COPYBOOK          *00570001
005800*    APRD040 IS NO LONGER BEING USED.                            *00580001
005900*                                                                *00590001
006000* 08/07/2001  ALEXIS KEIKER            WR/IR #: 22467            *00600001
006100*    SOME OF THE VARIABLES THAT ARE ORGN-SUM NEEDED TO BE        *00610001
006200*    REFERENCING THE TOTAL VARIABLE IN THE COPYBOOK AND NOT      *00620001
006300*    THE ORIGINAL.  CHANGED ALL THESE INSTANCES.                 *00630001
006400*                                                                *00640001
006500* 05/16/2002                                                     *00650001
006600*   CHANGE MADE:  NI-SKU CHANGES.  RECOMPILE FROM PRODUCTION     *00660001
006700*   TO INCORPORATE CHANGES TO COPYBOOK APRD045.                  *00670001
006800* MADE BY:  KEVIN CATLIN                   WR/IR #: 21278        *00680001
006900*                                                                *00690001
007000*   02/10/2003                                                   *00700001
007100*      CHANGED CALL TO PEOPLESOFT TABLE TO USE NEW ALIAS         *00710001
007200*      NAMING STANDARD.                                          *00720001
007300*   MADE BY: L SCHALLHORN                 WR#: 23417             *00730001
007400*                                                                *00740001
007500*   DATE  09/17/2003                                             *00750001
007600*       CHANGE MADE: RECOMPILE FROM PRODUCTION TO PICK UP        *00760001
007700*       CHANGE TO COPYBOOK APRD045.                              *00770001
007800*       MADE BY: MIKE BESKE              WR/IR #: WR21316        *00780001
007900*                                                                *00790001
008000*   DATE  02/01/2005                                             *00800001
008100*       CHANGE MADE: EXPANDED ALL RETAIL FIELDS TO PREVENT       *00810001
008200*       TRUNCATION.                                              *00820001
008300*       MADE BY: NANCY EILBES        WR/IR #: P000732934         *00830001
008400*                                                                *00840001
008500*   DATE  04/21/2008                                             *00850001
008600*       CHANGE MADE: INCREASED THE SIZE OF CC-REPORT-TITLE &     *00860001
008700*       REPORT-TITLE IN ORDER TO HANDLE SLIGHTLY LARGER          *00870001
008800*       REPORT SUB TITLES.                                       *00880001
008900*       MADE BY: MIKE BESKE              WR/IR #: WR34309        *00890001
009000*                                                                *00900001
009010*   DATE  02/01/2011                                             *00901001
009020*       CHANGE MADE: INCREASED THE SIZE OF THE AMOUNT FIELDS     *00902001
009030*       IN THE TOTAL LINES - NEGATIVE AMOUNTS OVER 99 MILLION    *00903001
009040*       WERE BEING TRUNCATED.                                    *00904001
009050*       MADE BY: NANCY EILBES            WR/IR #: INC000001579235*00905001
009060*                                                                *00906001
009070*   DATE 07/06/2011                                               00907001
009080*       CHANGE MADE: CONVERTED TO ORACLE FOR PEOPLESOFT FINANCIAL 00908001
009090*       UPGRADE TO 9.1. CHANGES INCLUDE, TAPCNTL IN S100 IS       00909001
009091*       BEING ACCESSED THOUGH ORACLE TRANSPARENT GATEWAY TO DB2P. 00909101
009092*       S100 AND S200 ARE CHANGED FOR ORACLE. Z999 PARA ADDED     00909201
009093*       TO HANDLE ORACLE DATABASE ABENDS. B150 PARA WAS ADDED     00909301
009094*       TO SIGN INTO ORACLE. GL ACCOUNT TABLE ON DB3P REPLACED BY 00909401
009095*       GL ACCOUNT TABLE ON ORACLE.                               00909501
009096*       MADE BY: MADHURA PETHE           WR/IR #: WR37038         00909601
009000*                                                                *00909702
009010*   DATE  02/13/2019                                             *00909802
009020*       CHANGE MADE: REPLACING THE ORACLE TABLE PS_GL_ACCOUNT_TBL*00909902
009030*       WITH THE NEWLY CREATED DB2 TABLE APT_ACCT_TBL AND        *00910012
009040*       REMOVING ORACLE RELATED LOGICS                           *00910112
009050*       MADE BY: COGNIZANT               WR/IR #: CHG0220043     *00910213
009000*                                                                *00910317
009010*   DATE  02/02/2022                                             *00910417
009020*       CHANGE MADE: ALLOW FOR BOTH A GL ACCT# & DEPT# ON A GL   *00910517
009030*       ENTRY.  USE THE TRAN TYPE CODE TO DETERMINE IF THE TRAN  *00910617
009040*       IS EXPENSE OR MERCHANDISE.                               *00910717
009050*       MADE BY: JEAN KURK               WR/IR #: CHG0266411     *00910820
009100******************************************************************00910901
009200   EJECT                                                          00911001
009300 ENVIRONMENT DIVISION.                                            00911101
009400                                                                  00912001
009500 CONFIGURATION SECTION.                                           00920001
009600 SOURCE-COMPUTER.    IBM-3090.                                    00930001
009700 OBJECT-COMPUTER.    IBM-3090.                                    00940001
009800                                                                  00950001
009900 INPUT-OUTPUT SECTION.                                            00960001
010000                                                                  00970001
010100 FILE-CONTROL.                                                    00980001
010200     SELECT ADJ-JRNL-TRAN-FILE      ASSIGN TO INP01.              00990001
010300     SELECT ORIGIN-SUM-FILE         ASSIGN TO INP02.              01000001
010400     SELECT REPORT-FILE             ASSIGN TO RPT01.              01020001
010500                                                                  01030001
010600 EJECT                                                            01040001
010700 DATA DIVISION.                                                   01050001
010800 FILE SECTION.                                                    01060001
010900                                                                  01070001
011000 FD  ADJ-JRNL-TRAN-FILE                                           01080001
011100     RECORDING MODE IS F                                          01090001
011200     LABEL RECORDS ARE STANDARD                                   01100001
011300     BLOCK CONTAINS 0 RECORDS                                     01110001
011400     DATA RECORD IS ADJ-JRNL-TRAN-REC.                            01120001
011500 01  ADJ-JRNL-TRAN-REC.                                           01130001
011600     05  FILLER                           PIC  X(500).            01140001
011700                                                                  01150001
011800 FD  ORIGIN-SUM-FILE                                              01160001
011900     RECORDING MODE IS F                                          01170001
012000     LABEL RECORDS ARE STANDARD                                   01180001
012100     BLOCK CONTAINS 0 RECORDS                                     01190001
012200     DATA RECORD IS ORIGIN-SUM-REC.                               01200001
012300 01  ORIGIN-SUM-REC.                                              01210001
012400     05  FILLER                           PIC  X(500).            01220001
012500                                                                  01230001
013210 FD  REPORT-FILE                                                  01320001
013220     RECORDING MODE IS F                                          01321001
013230     LABEL RECORDS ARE STANDARD                                   01322001
013240     BLOCK CONTAINS 0 RECORDS                                     01323001
013250     DATA RECORD IS REPORT-REC.                                   01324001
013260 01  REPORT-REC.                                                  01325001
013270     05  FILLER                           PIC  X(200).            01326001
013300                                                                  01327001
013400 EJECT                                                            01328001
013500 WORKING-STORAGE SECTION.                                         01329001
013600                                                                  01330001
013700 01  PC-PROGRAM-CONSTANTS.                                        01340001
013800     05  PC-PROGRAM-NAME         PIC X(08) VALUE 'APKRP148'.      01350001
013900                                                                  01360001
014000 01  PS-PROGRAM-SWITCHES.                                         01370001
014100     05  PS-ADJ-JRNL-EOF-SW      PIC X(01) VALUE 'N'.             01380001
014200         88  ADJ-JRNL-EOF                  VALUE 'Y'.             01390001
014300     05  PS-ADJ-JRNL-EMPTY-SW    PIC X(01) VALUE 'N'.             01400001
014400         88  ADJ-JRNL-EMPTY                VALUE 'Y'.             01410001
014500     05  PS-ORIGIN-SUM-EOF-SW    PIC X(01) VALUE 'N'.             01420001
014600         88  ORIGIN-SUM-EOF                VALUE 'Y'.             01430001
014700     05  PS-MERCH-EXP-SW         PIC X(01) VALUE 'E'.             01460001
014800         88  MERCHANDISE-ENTRY             VALUE 'E'.             01470001
014900         88  EXPENSE-ENTRY                 VALUE 'M'.             01480001
015000     05  HOLD-MERCH-EXP-SW       PIC X(01) VALUE 'E'.             01490001
015100         88  HOLD-MERCHANDISE-ENTRY        VALUE 'E'.             01500001
015200         88  HOLD-EXPENSE-ENTRY            VALUE 'M'.             01510001
015300                                                                  01520001
015400 01  DATE-WORKAREA.                                               01530001
015500     05  DB2-DATE                PIC  X(10)  VALUE SPACES.        01540001
015600     05  FILLER REDEFINES DB2-DATE.                               01550001
015700         10  DB2-DATE-YEAR       PIC  X(04).                      01560001
015800         10  FILLER              PIC  X(01).                      01570001
015900         10  DB2-DATE-MONTH      PIC  X(02).                      01580001
016000         10  FILLER              PIC  X(01).                      01590001
016100         10  DB2-DATE-DAY        PIC  X(02).                      01600001
016200                                                                  01610001
016300 01  PV-PROGRAM-VARIABLES.                                        01620001
016400     05  PV-DISC-AMT              PIC S9(15)V99 VALUE ZERO.       01630001
016500     05  PV-ORIGIN.                                               01640001
016600         10  PV-ORGN-CDE         PIC X(01)   VALUE SPACES.        01650001
016700         10  PV-TRAN-CDE         PIC X(02)   VALUE SPACES.        01660001
016800     05  PV-GL-ACCT-NBR          PIC X(07)   VALUE SPACES.        01670001
016900     05  FILLER REDEFINES PV-GL-ACCT-NBR.                         01680001
017000         10  PV-ACCT-NBR         PIC X(06).                       01690001
017100         10  FILLER              PIC X(01).                       01700001
017200                                                                  01712001
017300 01  PC-PROGRAM-COUNTERS.                                         01713001
017400     05  PC-RETRY-MAX            PIC S9(04)  VALUE 3              01714001
017500                                             COMP SYNC.           01715001
017600     05  PC-RETRY-COUNT          PIC S9(04)  VALUE ZERO           01716001
017700                                             COMP SYNC.           01717001
017800     05  PC-MAX-LINES            PIC S9(03)  VALUE +66            01718001
017900                                             COMP-3.              01719001
018000     05  PC-LINE-COUNT           PIC S9(03)  VALUE +99            01720001
018100                                             COMP-3.              01730001
018200     05  PC-PAGE-COUNT           PIC S9(05)  VALUE ZERO           01740001
018300                                             COMP-3.              01750001
018400     05  PO-COUNTER              PIC S9(05)  VALUE ZERO           01760001
018500                                             COMP-3.              01770001
018600     05  PC-AP045-IN             PIC S9(05)  VALUE ZERO           01780001
018700                                             COMP-3.              01790001
018800     05  PC-ORGN-SUM-IN          PIC S9(05)  VALUE ZERO           01800001
018900                                             COMP-3.              01810001
019000                                                                  01820001
019100 01  HOLD-VARIABLES.                                              01830001
019200     05  HOLD-PERIOD             PIC  X(02)    VALUE SPACES.      01840001
019300     05  HOLD-ACCT-NBR           PIC  X(06)    VALUE SPACES.      01850001
019400     05  HOLD-DEPT-NBR           PIC  X(03)    VALUE SPACES.      01860001
019500     05  HOLD-PO-NBR             PIC  X(09)    VALUE SPACES.      01870001
019600                                                                  01880001
019700 01  PERIOD-TOTALS.                                               01890001
019800     05  PER-GRO-COST-AMT        PIC S9(15)V99 VALUE ZERO.        01900001
019900     05  PER-DISC-AMT            PIC S9(15)V99 VALUE ZERO.        01910001
020000     05  PER-FRGT-AMT            PIC S9(15)V99 VALUE ZERO.        01920001
020100     05  PER-MISC-CHRG-AMT       PIC S9(15)V99 VALUE ZERO.        01930001
020200     05  PER-NET-COST-AMT        PIC S9(15)V99 VALUE ZERO.        01940001
020300     05  PER-RETL-AMT            PIC S9(15)V99 VALUE ZERO.        01950001
020400                                                                  01960001
020500 01  MERCH-EXP-TOTALS.                                            01970001
020600     05  MER-GRO-COST-AMT        PIC S9(15)V99 VALUE ZERO.        01980001
020700     05  MER-DISC-AMT            PIC S9(15)V99 VALUE ZERO.        01990001
020800     05  MER-FRGT-AMT            PIC S9(15)V99 VALUE ZERO.        02000001
020900     05  MER-MISC-CHRG-AMT       PIC S9(15)V99 VALUE ZERO.        02010001
021000     05  MER-NET-COST-AMT        PIC S9(15)V99 VALUE ZERO.        02020001
021100     05  MER-RETL-AMT            PIC S9(15)V99 VALUE ZERO.        02030001
021200                                                                  02040001
021300 01  ACCOUNT-TOTALS.                                              02050001
021400     05  ACCT-GRO-COST-AMT       PIC S9(15)V99 VALUE ZERO.        02060001
021500     05  ACCT-DISC-AMT           PIC S9(15)V99 VALUE ZERO.        02070001
021600     05  ACCT-FRGT-AMT           PIC S9(15)V99 VALUE ZERO.        02080001
021700     05  ACCT-MISC-CHRG-AMT      PIC S9(15)V99 VALUE ZERO.        02090001
021800     05  ACCT-NET-COST-AMT       PIC S9(15)V99 VALUE ZERO.        02100001
021900     05  ACCT-RETL-AMT           PIC S9(15)V99 VALUE ZERO.        02110001
022000                                                                  02120001
022100 01  GRAND-TOTALS.                                                02130001
022200     05  GRAND-GRO-COST-AMT      PIC S9(15)V99 VALUE ZERO.        02140001
022300     05  GRAND-DISC-AMT          PIC S9(15)V99 VALUE ZERO.        02150001
022400     05  GRAND-FRGT-AMT          PIC S9(15)V99 VALUE ZERO.        02160001
022500     05  GRAND-MISC-CHRG-AMT     PIC S9(15)V99 VALUE ZERO.        02170001
022600     05  GRAND-NET-COST-AMT      PIC S9(15)V99 VALUE ZERO.        02180001
022700     05  GRAND-RETL-AMT          PIC S9(15)V99 VALUE ZERO.        02190001
022800                                                                  02200001
022900 01  SUMMARY-TOTALS.                                              02210001
023000     05  SUMMARY-GRO-COST-AMT    PIC S9(15)V99 VALUE ZERO.        02220001
023100     05  SUMMARY-DISC-AMT        PIC S9(15)V99 VALUE ZERO.        02230001
023200     05  SUMMARY-FRGT-AMT        PIC S9(15)V99 VALUE ZERO.        02240001
023300     05  SUMMARY-MISC-CHRG-AMT   PIC S9(15)V99 VALUE ZERO.        02250001
023400     05  SUMMARY-NET-COST-AMT    PIC S9(15)V99 VALUE ZERO.        02260001
023500     05  SUMMARY-RETL-AMT        PIC S9(15)V99 VALUE ZERO.        02270001
023600 EJECT                                                            02280001
023700                                                                  02290001
023800*----------------------------------------------------------------*02300001
023900*  RECORD LAYOUT FOR ADJUSTMENT JOURNAL TRANSACTION FILE         *02310001
024000*----------------------------------------------------------------*02320001
024100     COPY APRD045.                                                02330001
024200 EJECT                                                            02340001
024300                                                                  02350001
024400*----------------------------------------------------------------*02360001
024500*  RECORD LAYOUT FOR ACCOUNTS PAYABLE TRANSACTION FILE           *02370001
024600*----------------------------------------------------------------*02380001
024700     COPY APRD045 REPLACING 'AP045-' BY 'ORGN-SUM-'.              02390001
024800 EJECT                                                            02400001
024900                                                                  02410001
025000*----------------------------------------------------------------*02420001
025100*  STANDARD REPORT HEADER LAYOUT                                 *02430001
025200*----------------------------------------------------------------*02440001
025300     COPY DPWS200O.                                               02450001
025400 EJECT                                                            02460001
025500                                                                  02470001
008102*----------------------------------------------------------------*02471006
008103*  COMMUNICATIONS AREA2 FOR DB2                                  *02472006
008104*----------------------------------------------------------------*02473006
008105     COPY SQLCA2.                                                 02474006
008106                                                                  02475006
025600*----------------------------------------------------------------*02480001
025700* WORKING STORAGE FOR KOHLS CALENDAR ROUTINE (DPKUT500)          *02490001
025800*----------------------------------------------------------------*02500001
025900     COPY DPWS500.                                                02510001
026000 EJECT                                                            02520001
026100                                                                  02530001
026200 01  CONTROL-CARD-RECORD.                                         02540001
026300     05  CC-REPORT-TITLE         PIC  X(46).                      02550001
026400     05  FILLER                  PIC  X(34).                      02560001
026500                                                                  02570001
026600 01  REPORT-HEADER1.                                              02580001
026700     05  FILLER                  PIC  X(92) VALUE SPACES.         02590001
026800     05  FILLER                  PIC  X(16) VALUE                 02600001
026900             'ACCOUNTS PAYABLE'.                                  02610001
027000     05  FILLER                  PIC  X(92) VALUE SPACES.         02620001
027100                                                                  02630001
027200 01  REPORT-HEADER2.                                              02640001
027300     05  FILLER                  PIC  X(80) VALUE SPACES.         02650001
027400     05  FILLER                  PIC  X(41) VALUE                 02660001
027500             'DAILY ADDITIONS TO THE ADJUSTMENT JOURNAL'.         02670001
027600     05  FILLER                  PIC  X(79) VALUE SPACES.         02680001
027700                                                                  02690001
027800 01  REPORT-HEADER3.                                              02700001
027900     05  FILLER                  PIC  X(93) VALUE SPACES.         02710001
028000     05  FILLER                  PIC  X(03) VALUE 'FOR'.          02720001
028100     05  FILLER                  PIC  X(01) VALUE SPACES.         02730001
028200     05  REPORT-MONTH            PIC  X(02) VALUE SPACES.         02740001
028300     05  FILLER                  PIC  X(01) VALUE '/'.            02750001
028400     05  REPORT-DAY              PIC  X(02) VALUE SPACES.         02760001
028500     05  FILLER                  PIC  X(01) VALUE '/'.            02770001
028600     05  REPORT-YEAR             PIC  X(04) VALUE SPACES.         02780001
028700     05  FILLER                  PIC  X(93) VALUE SPACES.         02790001
028800                                                                  02800001
028900 01  REPORT-HEADER4.                                              02810001
029000     05  FILLER                  PIC  X(77) VALUE SPACES.         02820001
029100     05  REPORT-TITLE            PIC  X(46) VALUE SPACES.         02830001
029200     05  FILLER                  PIC  X(77) VALUE SPACES.         02840001
029300                                                                  02850001
029400 01  REPORT-PERIOD-HDR.                                           02860001
029500     05  FILLER                  PIC  X(16) VALUE                 02870001
029600             'POSTING PERIOD: '.                                  02880001
029700     05  RH-PERIOD-MONTH         PIC  X(03) VALUE SPACES.         02890001
029800     05  FILLER                  PIC  X(03) VALUE ' - '.          02900001
029900     05  RH-PERIOD-YR            PIC  X(04) VALUE SPACES.         02910001
030000     05  FILLER                  PIC  X(174) VALUE SPACES.        02920001
030100                                                                  02930001
030200 01  REPORT-DEPT-HDR.                                             02940001
030300     05  FILLER                  PIC  X(19) VALUE                 02950001
030400             'DEPARTMENT NUMBER: '.                               02960001
030500     05  RH-DEPT-NBR             PIC  X(03) VALUE SPACES.         02970001
030600     05  FILLER                  PIC  X(178) VALUE SPACES.        02980001
030700                                                                  02990001
030800 01  REPORT-ACCT-HDR.                                             03000001
030900     05  FILLER                  PIC  X(16) VALUE                 03010001
031000             'ACCOUNT NUMBER: '.                                  03020001
031100     05  RH-ACCT-NBR             PIC  X(06) VALUE SPACES.         03030001
031200     05  FILLER                  PIC  X(02) VALUE SPACES.         03040001
031300     05  RH-ACCT-DESC            PIC  X(30) VALUE SPACES.         03050001
031400     05  FILLER                  PIC  X(146) VALUE SPACES.        03060001
031500                                                                  03070001
031600 01  REPORT-SUMMARY-HDR.                                          03080001
031700     05  FILLER                  PIC  X(29) VALUE                 03090001
031800             'SUMMARY TOTALS BY ORIGIN CODE'.                     03100001
031900     05  FILLER                  PIC  X(171) VALUE SPACES.        03110001
032000                                                                  03120001
032100 01  REPORT-COLUMN-HDR1.                                          03130001
032200     05  FILLER                  PIC   X(01) VALUE SPACES.        03140001
032300     05  FILLER                  PIC   X(05) VALUE 'TRANS'.       03150001
032400     05  FILLER                  PIC   X(02) VALUE SPACES.        03160001
032500     05  FILLER                  PIC   X(06) VALUE 'VENDOR'.      03170001
032600     05  FILLER                  PIC   X(05) VALUE SPACES.        03180001
032700     05  FILLER                  PIC   X(06) VALUE 'VENDOR'.      03190001
032800     05  FILLER                  PIC   X(29) VALUE SPACES.        03200001
032900     05  FILLER                  PIC   X(02) VALUE 'PO'.          03210001
033000     05  FILLER                  PIC   X(06) VALUE SPACES.        03220001
033100     05  FILLER                  PIC   X(08) VALUE 'DOCUMENT'.    03230001
033200     05  FILLER                  PIC   X(10) VALUE SPACES.        03240001
033300     05  FILLER                  PIC   X(06) VALUE 'ORIGIN'.      03250001
033400     05  FILLER                  PIC   X(02) VALUE SPACES.        03260001
033500     05  FILLER                  PIC   X(05) VALUE SPACES.        03270001
033600     05  FILLER                  PIC   X(07) VALUE SPACES.        03280001
033700     05  FILLER                  PIC   X(05) VALUE 'GROSS'.       03290001
033800     05  FILLER                  PIC   X(11) VALUE SPACES.        03300001
033900     05  FILLER                  PIC   X(08) VALUE 'DISCOUNT'.    03310001
034000     05  FILLER                  PIC   X(09) VALUE SPACES.        03320001
034100     05  FILLER                  PIC   X(07) VALUE 'FREIGHT'.     03330001
034200     05  FILLER                  PIC   X(12) VALUE SPACES.        03340001
034300     05  FILLER                  PIC   X(04) VALUE 'MISC'.        03350001
034400     05  FILLER                  PIC   X(13) VALUE SPACES.        03360001
034500     05  FILLER                  PIC   X(03) VALUE 'NET'.         03370001
034600     05  FILLER                  PIC   X(17) VALUE SPACES.        03380001
034700     05  FILLER                  PIC   X(06) VALUE 'RETAIL'.      03390001
034800     05  FILLER                  PIC   X(03) VALUE SPACES.        03400001
034900                                                                  03410001
035000 01  REPORT-COLUMN-HDR2.                                          03420001
035100     05  FILLER                  PIC   X(01) VALUE SPACES.        03430001
035200     05  FILLER                  PIC   X(04) VALUE 'TYPE'.        03440001
035300     05  FILLER                  PIC   X(03) VALUE SPACES.        03450001
035400     05  FILLER                  PIC   X(06) VALUE 'NUMBER'.      03460001
035500     05  FILLER                  PIC   X(05) VALUE SPACES.        03470001
035600     05  FILLER                  PIC   X(04) VALUE 'NAME'.        03480001
035700     05  FILLER                  PIC   X(29) VALUE SPACES.        03490001
035800     05  FILLER                  PIC   X(06) VALUE 'NUMBER'.      03500001
035900     05  FILLER                  PIC   X(05) VALUE SPACES.        03510001
036000     05  FILLER                  PIC   X(06) VALUE 'NUMBER'.      03520001
036100     05  FILLER                  PIC   X(12) VALUE SPACES.        03530001
036200     05  FILLER                  PIC   X(04) VALUE 'CODE'.        03540001
036300     05  FILLER                  PIC   X(03) VALUE SPACES.        03550001
036400     05  FILLER                  PIC   X(05) VALUE 'STORE'.       03560001
036500     05  FILLER                  PIC   X(07) VALUE SPACES.        03570001
036600     05  FILLER                  PIC   X(04) VALUE 'COST'.        03580001
036700     05  FILLER                  PIC   X(13) VALUE SPACES.        03590001
036800     05  FILLER                  PIC   X(06) VALUE 'AMOUNT'.      03600001
036900     05  FILLER                  PIC   X(10) VALUE SPACES.        03610001
037000     05  FILLER                  PIC   X(06) VALUE 'AMOUNT'.      03620001
037100     05  FILLER                  PIC   X(12) VALUE SPACES.        03630001
037200     05  FILLER                  PIC   X(06) VALUE 'AMOUNT'.      03640001
037300     05  FILLER                  PIC   X(12) VALUE SPACES.        03650001
037400     05  FILLER                  PIC   X(04) VALUE 'COST'.        03660001
037500     05  FILLER                  PIC   X(16) VALUE SPACES.        03670001
037600     05  FILLER                  PIC   X(06) VALUE 'AMOUNT'.      03680001
037700     05  FILLER                  PIC   X(03) VALUE SPACES.        03690001
037800                                                                  03700001
037900 01  REPORT-COLUMN-SUMMARY-HDR1.                                  03710001
038000     05  FILLER                  PIC   X(80) VALUE SPACES.        03720001
038100     05  FILLER                  PIC   X(06) VALUE 'ORIGIN'.      03730001
038200     05  FILLER                  PIC   X(14) VALUE SPACES.        03740001
038300     05  FILLER                  PIC   X(05) VALUE 'GROSS'.       03750001
038400     05  FILLER                  PIC   X(11) VALUE SPACES.        03760001
038500     05  FILLER                  PIC   X(08) VALUE 'DISCOUNT'.    03770001
038600     05  FILLER                  PIC   X(09) VALUE SPACES.        03780001
038700     05  FILLER                  PIC   X(07) VALUE 'FREIGHT'.     03790001
038800     05  FILLER                  PIC   X(12) VALUE SPACES.        03800001
038900     05  FILLER                  PIC   X(04) VALUE 'MISC'.        03810001
039000     05  FILLER                  PIC   X(13) VALUE SPACES.        03820001
039100     05  FILLER                  PIC   X(03) VALUE 'NET'.         03830001
039200     05  FILLER                  PIC   X(17) VALUE SPACES.        03840001
039300     05  FILLER                  PIC   X(06) VALUE 'RETAIL'.      03850001
039400     05  FILLER                  PIC   X(03) VALUE SPACES.        03860001
039500                                                                  03870001
039600 01  REPORT-COLUMN-SUMMARY-HDR2.                                  03880001
039700     05  FILLER                  PIC   X(81) VALUE SPACES.        03890001
039800     05  FILLER                  PIC   X(04) VALUE 'CODE'.        03900001
039900     05  FILLER                  PIC   X(15) VALUE SPACES.        03910001
040000     05  FILLER                  PIC   X(04) VALUE 'COST'.        03920001
040100     05  FILLER                  PIC   X(13) VALUE SPACES.        03930001
040200     05  FILLER                  PIC   X(06) VALUE 'AMOUNT'.      03940001
040300     05  FILLER                  PIC   X(10) VALUE SPACES.        03950001
040400     05  FILLER                  PIC   X(06) VALUE 'AMOUNT'.      03960001
040500     05  FILLER                  PIC   X(12) VALUE SPACES.        03970001
040600     05  FILLER                  PIC   X(06) VALUE 'AMOUNT'.      03980001
040700     05  FILLER                  PIC   X(12) VALUE SPACES.        03990001
040800     05  FILLER                  PIC   X(04) VALUE 'COST'.        04000001
040900     05  FILLER                  PIC   X(16) VALUE SPACES.        04010001
041000     05  FILLER                  PIC   X(06) VALUE 'AMOUNT'.      04020001
041100     05  FILLER                  PIC   X(03) VALUE SPACES.        04030001
041200                                                                  04040001
041300 01  REPORT-DETAIL-EMPTY-INPUT.                                   04050001
041400     05  FILLER                  PIC   X(61) VALUE SPACES.        04060001
041500     05  FILLER                  PIC   X(27) VALUE                04070001
041600                          'NO DATA TO REPORT FOR TODAY'.          04080001
041700     05  FILLER                  PIC   X(62) VALUE SPACES.        04090001
041800                                                                  04100001
041900 01  REPORT-DETAIL-LINE.                                          04110001
042000     05  FILLER                  PIC   X(02)   VALUE SPACES.      04120001
042100     05  DL-TRAN-TYPE            PIC   X(02)   VALUE ZERO.        04130001
042200     05  FILLER                  PIC   X(04)   VALUE SPACES.      04140001
042300     05  DL-VND-NBR              PIC   X(09)   VALUE SPACES.      04150001
042400     05  FILLER                  PIC   X(02)   VALUE SPACES.      04160001
042500     05  DL-VND-NAME             PIC   X(30)   VALUE SPACES.      04170001
042600     05  FILLER                  PIC   X(01)   VALUE SPACES.      04180001
042700     05  DL-PO-NBR               PIC   ZZZZ99999 VALUE ZEROES.    04190001
042800     05  FILLER                  PIC   X(03)   VALUE SPACES.      04200001
042900     05  DL-DOC-NBR              PIC   X(16)   VALUE SPACES.      04210001
043000     05  FILLER                  PIC   X(03)   VALUE SPACES.      04220001
043100     05  DL-ORIGIN               PIC   X(03)   VALUE SPACES.      04230001
043200     05  FILLER                  PIC   X(04)   VALUE SPACES.      04240001
043300     05  DL-STR-NBR              PIC   ZZ999   VALUE ZERO.        04250001
043400     05  FILLER                  PIC   X(02)   VALUE SPACES.      04260001
043500     05  DL-GRO-COST-AMT         PIC   ---,---,--9.99             04270001
043600                                               BLANK WHEN ZERO.   04280001
043700     05  DL-GRO-COST-AMT-P       PIC   X(01)   VALUE SPACES.      04290001
043800     05  FILLER                  PIC   X(02)   VALUE SPACES.      04300001
043900     05  DL-DISC-AMT             PIC   ---,---,--9.99             04310001
044000                                               BLANK WHEN ZERO.   04320001
044100     05  DL-DISC-AMT-P           PIC   X(01)   VALUE SPACES.      04330001
044200     05  FILLER                  PIC   X(02)   VALUE SPACES.      04340001
044300     05  DL-FRGT-AMT             PIC   ---,---,--9.99             04350001
044400                                               BLANK WHEN ZERO.   04360001
044500     05  DL-FRGT-AMT-P           PIC   X(01)   VALUE SPACES.      04370001
044600     05  FILLER                  PIC   X(02)   VALUE SPACES.      04380001
044700     05  DL-MISC-CHRG-AMT        PIC   ---,---,--9.99             04390001
044800                                               BLANK WHEN ZERO.   04400001
044900     05  DL-MISC-CHRG-AMT-P      PIC   X(01)   VALUE SPACES.      04410001
045000     05  FILLER                  PIC   X(02)   VALUE SPACES.      04420001
045100     05  DL-NET-COST-AMT         PIC   ---,---,--9.99             04430001
045200                                               BLANK WHEN ZERO.   04440001
045300     05  DL-NET-COST-AMT-P       PIC   X(01)   VALUE SPACES.      04450001
045400     05  FILLER                  PIC   X(02)   VALUE SPACES.      04460001
045500     05  DL-RETL-AMT             PIC   ---,---,---,--9.99         04470001
045600                                               BLANK WHEN ZERO.   04480001
045700     05  DL-RETL-AMT-P           PIC   X(01)   VALUE SPACES.      04490001
045800                                                                  04500001
045900 01  REPORT-SUMMARY-DETAIL-LINE.                                  04510001
046000     05  FILLER                  PIC   X(81)   VALUE SPACES.      04520001
046100     05  SDL-ORIGIN              PIC   X(03)   VALUE SPACES.      04530001
046200     05  FILLER                  PIC   X(11)   VALUE SPACES.      04540001
046300     05  SDL-GRO-COST-AMT        PIC   ---,---,--9.99             04550001
046400                                               BLANK WHEN ZERO.   04560001
046500     05  SDL-GRO-COST-AMT-P      PIC   X(01)   VALUE SPACES.      04570001
046600     05  FILLER                  PIC   X(02)   VALUE SPACES.      04580001
046700     05  SDL-DISC-AMT            PIC   ---,---,--9.99             04590001
046800                                               BLANK WHEN ZERO.   04600001
046900     05  SDL-DISC-AMT-P          PIC   X(01)   VALUE SPACES.      04610001
047000     05  FILLER                  PIC   X(02)   VALUE SPACES.      04620001
047100     05  SDL-FRGT-AMT            PIC   ---,---,--9.99             04630001
047200                                               BLANK WHEN ZERO.   04640001
047300     05  SDL-FRGT-AMT-P          PIC   X(01)   VALUE SPACES.      04650001
047400     05  FILLER                  PIC   X(02)   VALUE SPACES.      04660001
047500     05  SDL-MISC-CHRG-AMT       PIC   ---,---,--9.99             04670001
047600                                               BLANK WHEN ZERO.   04680001
047700     05  SDL-MISC-CHRG-AMT-P     PIC   X(01)   VALUE SPACES.      04690001
047800     05  FILLER                  PIC   X(02)   VALUE SPACES.      04700001
047900     05  SDL-NET-COST-AMT        PIC   ---,---,--9.99             04710001
048000                                               BLANK WHEN ZERO.   04720001
048100     05  SDL-NET-COST-AMT-P      PIC   X(01)   VALUE SPACES.      04730001
048200     05  FILLER                  PIC   X(02)   VALUE SPACES.      04740001
048300     05  SDL-RETL-AMT            PIC   ---,---,---,--9.99         04750001
048400                                               BLANK WHEN ZERO.   04760001
048500     05  SDL-RETL-AMT-P          PIC   X(01)   VALUE SPACES.      04770001
048600                                                                  04780001
048700 01  REPORT-TOTAL-TITLES.                                         04790001
048800     05  TIT-DEPT-TOTAL.                                          04800001
048900         10  FILLER              PIC  X(10)  VALUE SPACES.        04810001
049000         10  FILLER              PIC  X(22)  VALUE                04820001
049100             'TOTALS FOR DEPARTMENT '.                            04830001
049200         10  RT-DEPT-NBR         PIC  X(09)  VALUE SPACES.        04840001
049300         10  FILLER              PIC  X(54)  VALUE SPACES.        04850001
049400     05  TIT-ACCT-TOTAL.                                          04860001
049500         10  FILLER              PIC  X(10)  VALUE SPACES.        04870001
049600         10  FILLER              PIC  X(19)  VALUE                04880001
049700             'TOTALS FOR ACCOUNT '.                               04890001
049800         10  RT-ACCOUNT          PIC  X(06)  VALUE SPACES.        04900001
049900         10  FILLER              PIC  X(60)  VALUE SPACES.        04910001
050000     05  TIT-MERCHANDISE-TOTAL.                                   04920001
050100         10  FILLER              PIC  X(10)  VALUE SPACES.        04930001
050200         10  FILLER              PIC  X(25)  VALUE                04940001
050300             'TOTAL OF ALL MERCHANDISE '.                         04950001
050400         10  FILLER              PIC  X(65)  VALUE SPACES.        04960001
050500     05  TIT-EXPENSE-TOTAL.                                       04970001
050600         10  FILLER              PIC  X(10)  VALUE SPACES.        04980001
050700         10  FILLER              PIC  X(21)  VALUE                04990001
050800             'TOTAL OF ALL EXPENSE '.                             05000001
050900         10  FILLER              PIC  X(69)  VALUE SPACES.        05010001
051000     05  TIT-PERIOD-TOTAL.                                        05020001
051100         10  FILLER              PIC  X(05)  VALUE SPACES.        05030001
051200         10  FILLER              PIC  X(26)  VALUE                05040001
051300             'TOTALS FOR POSTING PERIOD '.                        05050001
051400         10  RT-PERIOD-MONTH     PIC  X(03)  VALUE SPACES.        05060001
051500         10  FILLER              PIC  X(03)  VALUE ' - '.         05070001
051600         10  RT-PERIOD-YR        PIC  X(04)  VALUE SPACES.        05080001
051700         10  FILLER              PIC  X(54)  VALUE SPACES.        05090001
051800     05  TIT-GRAND-TOTAL.                                         05100001
051900         10  FILLER              PIC  X(15)  VALUE SPACES.        05110001
052000         10  FILLER              PIC  X(15)  VALUE                05120001
052100             'REPORT TOTALS '.                                    05130001
052200         10  FILLER              PIC  X(65)  VALUE SPACES.        05140001
052300     05  TIT-SUMMARY-TOTAL.                                       05150001
052400         10  FILLER              PIC  X(15)  VALUE SPACES.        05160001
052500         10  FILLER              PIC  X(22)  VALUE                05170001
052600             'TOTAL FOR ALL ORIGINS '.                            05180001
052700         10  FILLER              PIC  X(58)  VALUE SPACES.        05190001
052800                                                                  05200001
052900 01  REPORT-TOTALS.                                               05210001
053000     05  TOTALS-DESC             PIC  X(93)  VALUE SPACES.        05220001
053100     05  RT-GRO-COST-AMT         PIC -,---,---,--9.99             05230001
053200                                               BLANK WHEN ZERO.   05240001
053300     05  RT-GRO-COST-AMT-P       PIC   X(01)   VALUE SPACES.      05250001
053400**   05  FILLER                  PIC   X(02)   VALUE SPACES.      05260001
053500     05  RT-DISC-AMT             PIC -,---,---,--9.99             05270001
053600                                               BLANK WHEN ZERO.   05280001
053700     05  RT-DISC-AMT-P           PIC   X(01)   VALUE SPACES.      05290001
053800**   05  FILLER                  PIC   X(02)   VALUE SPACES.      05300001
053900     05  RT-FRGT-AMT             PIC -,---,---,--9.99             05310001
054000                                               BLANK WHEN ZERO.   05320001
054100     05  RT-FRGT-AMT-P           PIC   X(01)   VALUE SPACES.      05330001
054200**   05  FILLER                  PIC   X(02)   VALUE SPACES.      05340001
054300     05  RT-MISC-CHRG-AMT        PIC -,---,---,--9.99             05350001
054400                                               BLANK WHEN ZERO.   05360001
054500     05  RT-MISC-CHRG-AMT-P      PIC   X(01)   VALUE SPACES.      05370001
054600**   05  FILLER                  PIC   X(02)   VALUE SPACES.      05380001
054700     05  RT-NET-COST-AMT         PIC -,---,---,--9.99             05390001
054800                                               BLANK WHEN ZERO.   05400001
054900     05  RT-NET-COST-AMT-P       PIC   X(01)   VALUE SPACES.      05410001
055000     05  FILLER                  PIC   X(02)   VALUE SPACES.      05420001
055100     05  RT-RETL-AMT             PIC   ---,---,---,--9.99         05430001
055200                                               BLANK WHEN ZERO.   05440001
055300     05  RT-RETL-AMT-P           PIC   X(01)   VALUE SPACES.      05450001
055400                                                                  05460001
055500 01  BLANK-LINE.                                                  05470001
055600     05  FILLER                  PIC   X(200)  VALUE SPACES.      05480001
055700 EJECT                                                            05490001
055800                                                                  05500001
058800*----------------------------------------------------------------*05510001
058900*  ABEND DATA AREAS                                              *05520001
059000*----------------------------------------------------------------*05530001
059100                                                                  05540001
059200** WORKING STORAGE FOR ABEND PROCESSING                           05550001
059300 01  ABEND-CODE                PIC S9(04)  VALUE ZERO COMP SYNC.  05560001
059310     88  AC-ANY-ERROR                      VALUE +4001            05570001
059320                                           THRU  +4019.           05580001
059330     88  AC-BAD-WRITE                      VALUE +4001.           05590001
059340     88  AC-BAD-READ                       VALUE +4002.           05600001
059350     88  AC-CONTROL-CARD-ERROR             VALUE +4003.           05610001
059360     88  AC-OPEN-ERROR                     VALUE +4005.           05620001
059370     88  AC-CLOSE-ERROR                    VALUE +4006.           05630001
059400     88  AC-BAD-DATA                       VALUE +4008.           05640001
059600     88  AC-UNSUCCESSFUL-SELECT            VALUE +4015.           05660001
059610     88  AC-MAX-RETRIES-EXCEEDED           VALUE +4016.           05670001
059700     88  AC-DATE-ERROR                     VALUE +4019.           05680001
059710*    88  AC-BAD-DATA                       VALUE +4003.           05690001
059800                                                                  05700001
059900 01  ABEND-AREAS.                                                 05710001
060000     05  AA-ABEND-LIT          PIC  X(40)  VALUE                  05720001
060100             '*****       ABEND'.                                 05730001
060200     05  AA-PROGRAM-LIT        PIC  X(40)  VALUE                  05740001
060300             '*****   PROGRAM: APKRP148'.                         05750001
060400     05  AA-PARAGRAPH-LIT.                                        05760001
060500         10  FILLER            PIC  X(17)  VALUE                  05770001
060600             '***** PARAGRAPH: '.                                 05780001
060700         10  AA-PARAGRAPH-NAME PIC  X(35)  VALUE SPACES.          05790001
060718                                                                  05800001
060719     05  AA-MESSAGE-LINE-1.                                       05810001
060720         10  FILLER            PIC  X(06)   VALUE '*****'.        05820001
060730         10  AA-MESSAGE-1      PIC  X(80)   VALUE SPACES.         05830001
060740     05  AA-MESSAGE-LINE-2.                                       05840001
060750         10  FILLER            PIC  X(06)   VALUE '*****'.        05850001
060760         10  AA-MESSAGE-2      PIC  X(80)   VALUE SPACES.         05860001
062600 EJECT                                                            05980001
062610                                                                  05990001
062620     COPY DPWS004.                                                06000001
062630 EJECT                                                            06010001
017600*--------------------------------------------------------------*  06241006
017700*  DB2 AREA FOR COMMUNICATIONS                                 *  06242006
017800*--------------------------------------------------------------*  06243006
017900     EXEC SQL                                                     06244006
018000          INCLUDE SQLCA                                           06245006
018100     END-EXEC.                                                    06246006
018200                                                                  06247006
062992*--------------------------------------------------------------*  06250001
062993*     TAPCNTL DCLGEN                                           *  06260001
062994*--------------------------------------------------------------*  06270001
062995     EXEC SQL                                                     06280001
062996         INCLUDE TAPCNTL                                          06290001
062997     END-EXEC.                                                    06291001
062999                                                                  06293001
063000*--------------------------------------------------------------*  06294001
063001*     APT_ACCT_TBL DCLGEN                                      *  06295010
063002*--------------------------------------------------------------*  06296001
063003     EXEC SQL                                                     06297001
063004         INCLUDE APT00002                                         06298105
063005     END-EXEC.                                                    06299001
063007                                                                  06300101
063010*********************                                             06300401
063100 PROCEDURE DIVISION.                                              06300501
063200*********************                                             06300601
063300 A100-MAINLINE.                                                   06300701
063400                                                                  06300801
063500     PERFORM B100-INITIALIZATION.                                 06300901
063620                                                                  06301001
063700     PERFORM B200-PROCESS-ADJ-JRNL                                06302001
063800         UNTIL ADJ-JRNL-EOF.                                      06303001
063900                                                                  06304001
064000     IF  PC-AP045-IN > 0                                          06305001
064100         PERFORM W600-WRITE-ACCOUNT-TOTALS                        06306001
064200         PERFORM W800-WRITE-MERCH-EXP-TOTALS                      06307001
064300         PERFORM W700-WRITE-PERIOD-TOTALS                         06308001
064400         PERFORM W800-WRITE-REPORT-TOTALS                         06309001
064500     END-IF.                                                      06310001
064600                                                                  06320001
064700     PERFORM R200-READ-ORIGIN-SUM-FILE.                           06330001
064800     IF ORIGIN-SUM-EOF                                            06340001
064900        IF ADJ-JRNL-EMPTY                                         06350001
065000            CONTINUE                                              06360001
065100        ELSE                                                      06370001
065200            PERFORM W100-WRITE-HEADERS                            06380001
065300            PERFORM W300-WRITE-SUMMARY-HEADERS                    06390001
065400            PERFORM W000-WRITE-EMPTY-INPUT-FILE                   06400001
065500        END-IF                                                    06410001
065600     ELSE                                                         06420001
065700         PERFORM W100-WRITE-HEADERS                               06430001
065800         PERFORM W300-WRITE-SUMMARY-HEADERS                       06440001
065900     END-IF.                                                      06450001
066000                                                                  06460001
066100     PERFORM B300-PROCESS-ORIGIN-SUM                              06470001
066200         UNTIL ORIGIN-SUM-EOF.                                    06480001
066300                                                                  06490001
066400     IF PC-ORGN-SUM-IN > 0                                        06500001
066500        PERFORM W900-WRITE-SUMMARY-TOTALS                         06510001
066600     END-IF.                                                      06520001
066700                                                                  06530001
066800     PERFORM B400-END-PROGRAM.                                    06540001
066900                                                                  06550001
067000     GOBACK.                                                      06560001
067100 EJECT                                                            06570001
067200******************************************************************06580001
067300*    INITIALIZATION PROCESSING                                   *06590001
067400******************************************************************06600001
067500 B100-INITIALIZATION.                                             06610001
067600                                                                  06620001
067700     OPEN INPUT  ADJ-JRNL-TRAN-FILE                               06630001
067800                 ORIGIN-SUM-FILE                                  06640001
067900          OUTPUT REPORT-FILE.                                     06660001
068000                                                                  06670001
068100     INITIALIZE PERIOD-TOTALS                                     06680001
068200                MERCH-EXP-TOTALS                                  06690001
068300                ACCOUNT-TOTALS                                    06700001
068400                GRAND-TOTALS                                      06710001
068500                SUMMARY-TOTALS.                                   06720001
068600                                                                  06730001
068700     ACCEPT CONTROL-CARD-RECORD.                                  06740001
068800     MOVE CC-REPORT-TITLE TO REPORT-TITLE.                        06750001
068900                                                                  06760001
069000     MOVE FUNCTION CURRENT-DATE(1:4)  TO DP200O-RUN-YEAR.         06770001
069100     MOVE FUNCTION CURRENT-DATE(5:2)  TO DP200O-RUN-MONTH.        06780001
069200     MOVE FUNCTION CURRENT-DATE(7:2)  TO DP200O-RUN-DAY.          06790001
069300                                                                  06800001
069400     MOVE FUNCTION CURRENT-DATE(9:2)  TO DP200O-RUN-HOUR.         06810001
069500     MOVE FUNCTION CURRENT-DATE(11:2) TO DP200O-RUN-MINUTE.       06820001
069600     MOVE PC-PROGRAM-NAME             TO DP200O-PROGRAM-NAME.     06830001
069700     MOVE 1                           TO DP200O-REPORT-NUMBER.    06840001
069810                                                                  06850001
069900     PERFORM S100-SELECT-BATCH-PROCESS-DATE.                      06880001
070010     MOVE APCNTL-BTCH-PRC-DTE         TO DB2-DATE.                06890007
070100     MOVE DB2-DATE-MONTH              TO REPORT-MONTH.            06900001
070200     MOVE DB2-DATE-DAY                TO REPORT-DAY.              06910001
070300     MOVE DB2-DATE-YEAR               TO REPORT-YEAR.             06920001
070400                                                                  06930001
070500     PERFORM R100-READ-ADJ-JRNL-TRAN-FILE.                        06940001
070600     IF ADJ-JRNL-EOF                                              06950001
070700         SET ADJ-JRNL-EMPTY TO TRUE                               06960001
070800         MOVE SPACES TO RH-PERIOD-MONTH                           06970001
070900         MOVE SPACES TO RH-PERIOD-YR                              06980001
071000         MOVE SPACES TO RH-DEPT-NBR                               06990001
071100         PERFORM W100-WRITE-HEADERS                               07000001
071200         PERFORM W200-WRITE-PERIOD-HEADERS                        07010001
071300         PERFORM W000-WRITE-EMPTY-INPUT-FILE                      07020001
071400     ELSE                                                         07030001
071500         MOVE AP045-PSTG-FMN-NBR TO  HOLD-PERIOD                  07040001
071600         MOVE AP045-GL-ACCT-NBR  TO  HOLD-ACCT-NBR                07050001
071700         MOVE AP045-DEPT-NBR     TO  HOLD-DEPT-NBR                07060001
071800         MOVE AP045-PO-NBR       TO  HOLD-PO-NBR                  07070001
071900                                                                  07080001
072000         PERFORM Y100-CONVERT-PERIOD-TO-MONTH                     07090001
072100                                                                  07100001
072200         PERFORM W100-WRITE-HEADERS                               07110001
072300         PERFORM W200-WRITE-PERIOD-HEADERS                        07120001
072400     END-IF.                                                      07130001
072500                                                                  07140001
072600 EJECT                                                            07150001
072700                                                                  07160001
072840******************************************************************07282601
072900*  THIS ROUTINE CONTROLS THE MAIN LOGIC TO CREATE THE CONTROL    *07282701
073000*  BREAKS ON THE ADJUSTMENT REPORT.                              *07282801
073100******************************************************************07282901
073200 B200-PROCESS-ADJ-JRNL.                                           07283001
073300                                                                  07284001
073400     IF  AP045-PSTG-FMN-NBR = HOLD-PERIOD                         07285001
073500*        IF  (AP045-DEPT-NBR = HOLD-DEPT-NBR) AND                 07286014
073600*            (AP045-GL-ACCT-NBR = HOLD-ACCT-NBR)                  07286115
073500         IF  (AP045-DEPT-NBR = HOLD-DEPT-NBR  AND                 07286215
073500              AP045-GL-ACCT-NBR = SPACES)                         07286315
073600          OR (AP045-GL-ACCT-NBR = HOLD-ACCT-NBR AND               07287015
073600              AP045-GL-ACCT-NBR NOT = SPACES)                     07287115
073700             PERFORM C100-CREATE-ADJUSTMENT-REPORT                07288001
073800         ELSE                                                     07289001
073900             PERFORM W600-WRITE-ACCOUNT-TOTALS                    07290001
074000*            IF (AP045-DEPT-NBR NOT = HOLD-DEPT-NBR) AND          07300017
074100*               (AP045-GL-ACCT-NBR NOT = HOLD-ACCT-NBR)           07310017
074000             IF AP045-GL-ACCT-NBR = SPACES AND                    07311018
074000                 HOLD-ACCT-NBR NOT = SPACES                       07311119
074200                PERFORM W800-WRITE-MERCH-EXP-TOTALS               07320001
074300                INITIALIZE MERCH-EXP-TOTALS                       07330001
074400                PERFORM W100-WRITE-HEADERS                        07340001
074500                PERFORM W200-WRITE-PERIOD-HEADERS                 07350001
074600             ELSE                                                 07360001
074700                PERFORM W200-WRITE-DEPT-ACCT-HEADERS              07370001
074800             END-IF                                               07380001
074900             INITIALIZE ACCOUNT-TOTALS                            07390001
075000             PERFORM C100-CREATE-ADJUSTMENT-REPORT                07400001
075100         END-IF                                                   07410001
075200     ELSE                                                         07420001
075300         PERFORM W600-WRITE-ACCOUNT-TOTALS                        07430001
075400         PERFORM W800-WRITE-MERCH-EXP-TOTALS                      07440001
075500         PERFORM W700-WRITE-PERIOD-TOTALS                         07450001
075600                                                                  07460001
075700         INITIALIZE PERIOD-TOTALS                                 07470001
075800                    ACCOUNT-TOTALS                                07480001
075900                    MERCH-EXP-TOTALS                              07490001
076000                                                                  07500001
076100         PERFORM Y100-CONVERT-PERIOD-TO-MONTH                     07510001
076200                                                                  07520001
076300         PERFORM W100-WRITE-HEADERS                               07530001
076400         PERFORM W200-WRITE-PERIOD-HEADERS                        07540001
076500                                                                  07550001
076600         PERFORM C100-CREATE-ADJUSTMENT-REPORT                    07560001
076700     END-IF.                                                      07570001
076800                                                                  07580001
076900     MOVE AP045-PSTG-FMN-NBR TO  HOLD-PERIOD.                     07590001
077000     MOVE AP045-GL-ACCT-NBR  TO  HOLD-ACCT-NBR.                   07600001
077100     MOVE AP045-DEPT-NBR     TO  HOLD-DEPT-NBR.                   07610001
077200     MOVE AP045-PO-NBR       TO  HOLD-PO-NBR.                     07620001
077300     PERFORM R100-READ-ADJ-JRNL-TRAN-FILE.                        07630001
077400 EJECT                                                            07640001
077500                                                                  07650001
077600******************************************************************07660001
077700*  PROCESSES THE ACCOUNTS PAYABLE ADJUSTMENTS SUMMED BY ORIGIN.  *07670001
077800******************************************************************07680001
077900 B300-PROCESS-ORIGIN-SUM.                                         07690001
078000     MOVE ORGN-SUM-ORGN-CDE     TO PV-ORGN-CDE.                   07700001
078100     MOVE ORGN-SUM-AP-TRN-CDE   TO PV-TRAN-CDE.                   07710001
078200     MOVE PV-ORIGIN             TO SDL-ORIGIN.                    07720001
078300                                                                  07730001
078400     MOVE ORGN-SUM-TOT-GRO-COST-AMT TO SDL-GRO-COST-AMT           07740001
078500     IF ORGN-SUM-TOT-GRO-COST-AMT < 0                             07750001
078600         INSPECT SDL-GRO-COST-AMT REPLACING ALL '-' BY '('        07760001
078700         MOVE ')' TO SDL-GRO-COST-AMT-P                           07770001
078800     ELSE                                                         07780001
078900         MOVE ' ' TO SDL-GRO-COST-AMT-P                           07790001
079000     END-IF.                                                      07800001
079100                                                                  07810001
079200     COMPUTE PV-DISC-AMT = ORGN-SUM-TOT-TERM-DISC-AMT             07820001
079300                         + ORGN-SUM-TOT-NW-STR-DISC-AMT           07830001
079400                         + ORGN-SUM-TOT-TRD-DISC-AMT              07840001
079500                         + ORGN-SUM-TOT-MOS-DISC-AMT.             07850001
079600                                                                  07860001
079700     MOVE PV-DISC-AMT TO SDL-DISC-AMT                             07870001
079800     IF PV-DISC-AMT < 0                                           07880001
079900         INSPECT SDL-DISC-AMT REPLACING ALL '-' BY '('            07890001
080000         MOVE ')' TO SDL-DISC-AMT-P                               07900001
080100     ELSE                                                         07910001
080200         MOVE ' ' TO SDL-DISC-AMT-P                               07920001
080300     END-IF.                                                      07930001
080400                                                                  07940001
080500     MOVE ORGN-SUM-TOT-FRGT-AMT TO SDL-FRGT-AMT                   07950001
080600     IF ORGN-SUM-TOT-FRGT-AMT < 0                                 07960001
080700         INSPECT SDL-FRGT-AMT REPLACING ALL '-' BY '('            07970001
080800         MOVE ')' TO SDL-FRGT-AMT-P                               07980001
080900     ELSE                                                         07990001
081000         MOVE ' ' TO SDL-FRGT-AMT-P                               08000001
081100     END-IF.                                                      08010001
081200                                                                  08020001
081300     MOVE ORGN-SUM-TOT-MISC-CHRG-AMT TO SDL-MISC-CHRG-AMT         08030001
081400     IF ORGN-SUM-TOT-MISC-CHRG-AMT < 0                            08040001
081500         INSPECT SDL-MISC-CHRG-AMT REPLACING ALL '-' BY '('       08050001
081600         MOVE ')' TO SDL-MISC-CHRG-AMT-P                          08060001
081700     ELSE                                                         08070001
081800         MOVE ' ' TO SDL-MISC-CHRG-AMT-P                          08080001
081900     END-IF.                                                      08090001
082000                                                                  08100001
082100     MOVE ORGN-SUM-TOT-NET-COST-AMT TO SDL-NET-COST-AMT           08110001
082200     IF ORGN-SUM-TOT-NET-COST-AMT < 0                             08120001
082300         INSPECT SDL-NET-COST-AMT REPLACING ALL '-' BY '('        08130001
082400         MOVE ')' TO SDL-NET-COST-AMT-P                           08140001
082500     ELSE                                                         08150001
082600         MOVE ' ' TO SDL-NET-COST-AMT-P                           08160001
082700     END-IF.                                                      08170001
082800                                                                  08180001
082900     MOVE ORGN-SUM-TOT-RETL-AMT TO SDL-RETL-AMT                   08190001
083000     IF ORGN-SUM-TOT-RETL-AMT < 0                                 08200001
083100         INSPECT SDL-RETL-AMT REPLACING ALL '-' BY '('            08210001
083200         MOVE ')' TO SDL-RETL-AMT-P                               08220001
083300     ELSE                                                         08230001
083400         MOVE ' ' TO SDL-RETL-AMT-P                               08240001
083500     END-IF.                                                      08250001
083600                                                                  08260001
083700     ADD ORGN-SUM-TOT-GRO-COST-AMT                                08270001
083800                                  TO SUMMARY-GRO-COST-AMT         08280001
083900     ADD PV-DISC-AMT              TO SUMMARY-DISC-AMT             08290001
084000     ADD ORGN-SUM-TOT-FRGT-AMT    TO SUMMARY-FRGT-AMT             08300001
084100     ADD ORGN-SUM-TOT-MISC-CHRG-AMT                               08310001
084200                                  TO SUMMARY-MISC-CHRG-AMT        08320001
084300     ADD ORGN-SUM-TOT-NET-COST-AMT                                08330001
084400                                  TO SUMMARY-NET-COST-AMT         08340001
084500     ADD ORGN-SUM-TOT-RETL-AMT    TO SUMMARY-RETL-AMT             08350001
084600                                                                  08360001
084700                                                                  08370001
084800     PERFORM W900-WRITE-SUMMARY-DETAIL-LINE.                      08380001
084900     PERFORM R200-READ-ORIGIN-SUM-FILE.                           08390001
085000 EJECT                                                            08400001
085100                                                                  08410001
085200******************************************************************08420001
085300*    ENDING PROCESSING:                                          *08430001
085400*      1) DISPLAYS TOTALS                                        *08440001
085500*      2) CLOSES FILES                                           *08450001
085600******************************************************************08460001
085700 B400-END-PROGRAM.                                                08470001
085800                                                                  08480001
085900     DISPLAY '**********************************************'     08490001
086000     DISPLAY 'PROGRAM NAME = APKRP148'                            08500001
086100     DISPLAY 'APRD045 RECORDS IN = '  PC-AP045-IN.                08510001
086200     DISPLAY 'ORGN-SUM RECORDS IN = ' PC-ORGN-SUM-IN.             08520001
086300     DISPLAY '**********************************************'     08530001
086400                                                                  08540001
086500     CLOSE ADJ-JRNL-TRAN-FILE                                     08550001
086600           ORIGIN-SUM-FILE                                        08560001
086700           REPORT-FILE.                                           08580001
086800 EJECT                                                            08590001
086900                                                                  08600001
087000******************************************************************08610001
087100*  FILLS ALL THE FIELDS FOR THE ADJUSTMENT REPORT.               *08620001
087200******************************************************************08630001
087300 C100-CREATE-ADJUSTMENT-REPORT.                                   08640001
087400     MOVE AP045-PSTG-TYP-CDE TO DL-TRAN-TYPE.                     08650001
087500     MOVE AP045-VND-NBR      TO DL-VND-NBR.                       08660001
087600     MOVE AP045-ENT-NME-DESC TO DL-VND-NAME.                      08670001
087700     MOVE AP045-PO-NBR       TO DL-PO-NBR.                        08680001
087800     MOVE AP045-DOC-NBR      TO DL-DOC-NBR.                       08690001
087900     MOVE AP045-ORGN-CDE     TO PV-ORGN-CDE.                      08700001
088000     MOVE AP045-AP-TRN-CDE   TO PV-TRAN-CDE.                      08710001
088100     MOVE PV-ORIGIN          TO DL-ORIGIN.                        08720001
088200*    DISPLAY '********************************'                   08730001
088300*    DISPLAY 'AP045-VND-NBR ' AP045-VND-NBR                       08740001
088400*    DISPLAY 'STORE NUMBER  ' AP045-HDR-STR-NBR                   08750001
088500     MOVE AP045-HDR-STR-NBR  TO DL-STR-NBR.                       08760001
088600                                                                  08770001
088700     MOVE AP045-TOT-GRO-COST-AMT TO DL-GRO-COST-AMT               08780001
088800     IF AP045-TOT-GRO-COST-AMT < 0                                08790001
088900         INSPECT DL-GRO-COST-AMT REPLACING ALL '-' BY '('         08800001
089000         MOVE ')' TO DL-GRO-COST-AMT-P                            08810001
089100     ELSE                                                         08820001
089200         MOVE ' ' TO DL-GRO-COST-AMT-P                            08830001
089300     END-IF.                                                      08840001
089400                                                                  08850001
089500     COMPUTE PV-DISC-AMT = AP045-TOT-TERM-DISC-AMT                08860001
089600                         + AP045-TOT-NW-STR-DISC-AMT              08870001
089700                         + AP045-TOT-TRD-DISC-AMT                 08880001
089800                         + AP045-TOT-MOS-DISC-AMT.                08890001
089900                                                                  08900001
090000     MOVE PV-DISC-AMT TO DL-DISC-AMT                              08910001
090100     IF PV-DISC-AMT < 0                                           08920001
090200         INSPECT DL-DISC-AMT REPLACING ALL '-' BY '('             08930001
090300         MOVE ')' TO DL-DISC-AMT-P                                08940001
090400     ELSE                                                         08950001
090500         MOVE ' ' TO DL-DISC-AMT-P                                08960001
090600     END-IF.                                                      08970001
090700                                                                  08980001
090800     MOVE AP045-TOT-FRGT-AMT TO DL-FRGT-AMT                       08990001
090900     IF AP045-TOT-FRGT-AMT < 0                                    09000001
091000         INSPECT DL-FRGT-AMT REPLACING ALL '-' BY '('             09010001
091100         MOVE ')' TO DL-FRGT-AMT-P                                09020001
091200     ELSE                                                         09030001
091300         MOVE ' ' TO DL-FRGT-AMT-P                                09040001
091400     END-IF.                                                      09050001
091500                                                                  09060001
091600     MOVE AP045-TOT-MISC-CHRG-AMT TO DL-MISC-CHRG-AMT             09070001
091700     IF AP045-TOT-MISC-CHRG-AMT < 0                               09080001
091800         INSPECT DL-MISC-CHRG-AMT REPLACING ALL '-' BY '('        09090001
091900         MOVE ')' TO DL-MISC-CHRG-AMT-P                           09100001
092000     ELSE                                                         09110001
092100         MOVE ' ' TO DL-MISC-CHRG-AMT-P                           09120001
092200     END-IF.                                                      09130001
092300                                                                  09140001
092400     MOVE AP045-TOT-NET-COST-AMT TO DL-NET-COST-AMT               09150001
092500     IF AP045-TOT-NET-COST-AMT < 0                                09160001
092600         INSPECT DL-NET-COST-AMT REPLACING ALL '-' BY '('         09170001
092700         MOVE ')' TO DL-NET-COST-AMT-P                            09180001
092800     ELSE                                                         09190001
092900         MOVE ' ' TO DL-NET-COST-AMT-P                            09200001
093000     END-IF.                                                      09210001
093100                                                                  09220001
093200     MOVE AP045-TOT-RETL-AMT TO DL-RETL-AMT                       09230001
093300     IF AP045-TOT-RETL-AMT < 0                                    09240001
093400         INSPECT DL-RETL-AMT REPLACING ALL '-' BY '('             09250001
093500         MOVE ')' TO DL-RETL-AMT-P                                09260001
093600     ELSE                                                         09270001
093700         MOVE ' ' TO DL-RETL-AMT-P                                09280001
093800     END-IF.                                                      09290001
093900                                                                  09300001
094000     ADD AP045-TOT-GRO-COST-AMT  TO PER-GRO-COST-AMT              09310001
094100     ADD PV-DISC-AMT             TO PER-DISC-AMT                  09320001
094200     ADD AP045-TOT-FRGT-AMT      TO PER-FRGT-AMT                  09330001
094300     ADD AP045-TOT-MISC-CHRG-AMT TO PER-MISC-CHRG-AMT             09340001
094400     ADD AP045-TOT-NET-COST-AMT  TO PER-NET-COST-AMT              09350001
094500     ADD AP045-TOT-RETL-AMT      TO PER-RETL-AMT                  09360001
094600                                                                  09370001
094700     ADD AP045-TOT-GRO-COST-AMT  TO ACCT-GRO-COST-AMT             09380001
094800     ADD PV-DISC-AMT             TO ACCT-DISC-AMT                 09390001
094900     ADD AP045-TOT-FRGT-AMT      TO ACCT-FRGT-AMT                 09400001
095000     ADD AP045-TOT-MISC-CHRG-AMT TO ACCT-MISC-CHRG-AMT            09410001
095100     ADD AP045-TOT-NET-COST-AMT  TO ACCT-NET-COST-AMT             09420001
095200     ADD AP045-TOT-RETL-AMT      TO ACCT-RETL-AMT                 09430001
095300                                                                  09440001
095400     ADD AP045-TOT-GRO-COST-AMT  TO GRAND-GRO-COST-AMT            09450001
095500     ADD PV-DISC-AMT             TO GRAND-DISC-AMT                09460001
095600     ADD AP045-TOT-FRGT-AMT      TO GRAND-FRGT-AMT                09470001
095700     ADD AP045-TOT-MISC-CHRG-AMT TO GRAND-MISC-CHRG-AMT           09480001
095800     ADD AP045-TOT-NET-COST-AMT  TO GRAND-NET-COST-AMT            09490001
095900     ADD AP045-TOT-RETL-AMT      TO GRAND-RETL-AMT                09500001
096000                                                                  09510001
096100     ADD AP045-TOT-GRO-COST-AMT  TO MER-GRO-COST-AMT              09520001
096200     ADD PV-DISC-AMT             TO MER-DISC-AMT                  09530001
096300     ADD AP045-TOT-FRGT-AMT      TO MER-FRGT-AMT                  09540001
096400     ADD AP045-TOT-MISC-CHRG-AMT TO MER-MISC-CHRG-AMT             09550001
096500     ADD AP045-TOT-NET-COST-AMT  TO MER-NET-COST-AMT              09560001
096600     ADD AP045-TOT-RETL-AMT      TO MER-RETL-AMT                  09570001
096700                                                                  09580001
096800     PERFORM W400-WRITE-DETAIL-LINE.                              09590001
096900 EJECT                                                            09600001
097000                                                                  09610001
097100******************************************************************09620001
097200*  READ ADJUSTMENT JOURNAL TRANSACTION FILE (APRD045)            *09630001
097300******************************************************************09640001
097400 R100-READ-ADJ-JRNL-TRAN-FILE.                                    09650001
097500                                                                  09660001
097600     MOVE PS-MERCH-EXP-SW TO HOLD-MERCH-EXP-SW.                   09670001
097700                                                                  09680001
097800     READ ADJ-JRNL-TRAN-FILE INTO AP045-TRANSACTION-FILE          09690001
097900        AT END                                                    09700001
098000            SET ADJ-JRNL-EOF TO TRUE                              09710001
098100        NOT AT END                                                09720001
098200            ADD 1 TO PC-AP045-IN                                  09730001
098300*           IF AP045-DEPT-NBR = SPACES OR ZERO                    09740016
098300            IF AP045-TRN-TYP-CDE = 'EXP'                          09741016
098400                SET EXPENSE-ENTRY TO TRUE                         09750001
098500            ELSE                                                  09760001
098600                SET MERCHANDISE-ENTRY TO TRUE                     09770001
098700            END-IF                                                09780001
098800     END-READ.                                                    09790001
098900                                                                  09800001
099000 EJECT                                                            09810001
099100******************************************************************09820001
099200*  READ ACCOUNTS PAYABLE TRANSACTION FILE (APRD045 = ORIGIN SUM) *09830001
099300******************************************************************09840001
099400 R200-READ-ORIGIN-SUM-FILE.                                       09850001
099500                                                                  09860001
099600     READ ORIGIN-SUM-FILE INTO ORGN-SUM-TRANSACTION-FILE          09870001
099700        AT END                                                    09880001
099800            SET ORIGIN-SUM-EOF TO TRUE                            09890001
099900        NOT AT END                                                09900001
100000            ADD 1 TO PC-ORGN-SUM-IN                               09910001
100100     END-READ.                                                    09920001
100200                                                                  09930001
100300 EJECT                                                            09940001
100400******************************************************************09950001
100500*  SELECT BATCH PROCESS DATE FROM TAPCNTL TABLE                  *09960001
100600******************************************************************09990001
100700 S100-SELECT-BATCH-PROCESS-DATE.                                  10000001
101300                                                                  10010001
101310     EXEC SQL                                                     10020001
101320         SELECT BTCH_PRC_DTE                                      10030012
101330           INTO :APCNTL-BTCH-PRC-DTE                              10040007
101340           FROM TAPCNTL                                           10050001
101350     END-EXEC.                                                    10060001
101360                                                                  10070001
101400     EVALUATE TRUE                                                10080001
101500         WHEN SQLCODE = ZERO                                      10090001
101600              CONTINUE                                            10100001
101700         WHEN OTHER                                               10110001
101800             SET AC-UNSUCCESSFUL-SELECT TO TRUE                   10120001
101900             MOVE 'S100-SELECT-BATCH-PROCESS-DATE'                10130001
102000                                        TO AA-PARAGRAPH-NAME      10140001
102100             MOVE 'UNSUCCESSFUL SELECT ON TAPCNTL'                10150012
                                              TO AA-MESSAGE-1           10160012
102500             PERFORM Z999-ABEND                                   10190001
102600     END-EVALUATE.                                                10200001
102700 EJECT                                                            10210001
102800                                                                  10220001
102900******************************************************************10230001
103000*  SELECT DESCRPTION FROM APT_ACCT_TBL TABLE                     *10240011
103100******************************************************************10260001
103200 S200-SELECT-ACCT-NBR-DESC.                                       10270001
104400                                                                  10280001
104410     EXEC SQL                                                     10290001
104420         SELECT A.DESCR                                           10300001
104430           INTO :APT00002-DESCR                                   10310005
104440*          FROM PS_GL_ACCOUNT_TBL A                               10320005
104440           FROM APT_ACCT_TBL      A                               10321005
104450          WHERE A.ACCOUNT = :PV-GL-ACCT-NBR                       10330001
104460          AND   A.EFFDT =                                         10340001
104470                (SELECT MAX(A1.EFFDT)                             10350001
104480*                FROM PS_GL_ACCOUNT_TBL A1                        10360005
104480                 FROM APT_ACCT_TBL      A1                        10361005
104490                 WHERE A1.ACCOUNT = A.ACCOUNT                     10370001
104491                 AND   A1.EFFDT  <= CURRENT_DATE)                 10380001
104492     END-EXEC.                                                    10390001
104493                                                                  10400001
104500     EVALUATE TRUE                                                10410001
104600         WHEN SQLCODE = ZERO                                      10420001
104700              CONTINUE                                            10430001
104810         WHEN SQLCODE = 100                                       10440009
104900              MOVE SPACES TO APT00002-DESCR                       10450005
105000              DISPLAY 'GL-ACCT-NBR, ' PV-GL-ACCT-NBR              10460001
105100                      ' NOT FOUND ON FI_GL_ACCOUNT_TBL'           10470001
105200         WHEN OTHER                                               10480001
105300             SET AC-UNSUCCESSFUL-SELECT TO TRUE                   10490001
105400             MOVE 'S200-SELECT-ACCT-NBR-DESC'                     10500001
105500                                        TO AA-PARAGRAPH-NAME      10510001
106110             MOVE 'UNSUCCESSFUL SELECT ON APT_ACCT_TBL'           10520012
                                              TO AA-MESSAGE-1           10530012
106130             DISPLAY 'GL-ACCT-NBR, ' PV-GL-ACCT-NBR               10540001
106160             PERFORM Z999-ABEND                                   10570001
106200     END-EVALUATE.                                                10580001
106300 EJECT                                                            10590001
106400                                                                  10600001
106500******************************************************************10610001
106600*  WRITES EMPTY FILE DETAIL LINE                                 *10620001
106700******************************************************************10630001
106800 W000-WRITE-EMPTY-INPUT-FILE.                                     10640001
106900     WRITE REPORT-REC FROM REPORT-DETAIL-EMPTY-INPUT AFTER 2.     10650001
107000 EJECT                                                            10660001
107100                                                                  10670001
107200******************************************************************10680001
107300*  WRITES THE HEADINGS FOR THE ADJUSTMENT JOURNAL REPORT         *10690001
107400******************************************************************10700001
107500 W100-WRITE-HEADERS.                                              10710001
107600     ADD 1                            TO PC-PAGE-COUNT.           10720001
107700     MOVE PC-PAGE-COUNT               TO DP200O-PAGE-NUMBER.      10730001
107800                                                                  10740001
107900     WRITE REPORT-REC FROM DP200O-STANDRD-HEADER-200-COLS         10750001
108000           AFTER PAGE.                                            10760001
108100                                                                  10770001
108200     WRITE REPORT-REC FROM REPORT-HEADER1  AFTER 1.               10780001
108300     WRITE REPORT-REC FROM REPORT-HEADER2  AFTER 1.               10790001
108400     WRITE REPORT-REC FROM REPORT-HEADER3  AFTER 1.               10800001
108500     WRITE REPORT-REC FROM REPORT-HEADER4  AFTER 1.               10810001
108600                                                                  10820001
108700     MOVE 5 TO PC-LINE-COUNT.                                     10830001
108800 EJECT                                                            10840001
108900******************************************************************10850001
109000*  WRITES THE DETAIL HEADERS FOR THE ADJUSTMENT JOURNAL REPORT   *10860001
109100*  BUT NOT DEPARTMENT HEADER - THIS IS NEEDED IN PARAGRAPHS      *10870001
109200*  W700-WRITE-PERIOD-TOTALS, W800-WRITE-REPORT-TOTALS, &         *10880001
109300*  W800-WRITE-MERCH-EXP-TOTALS.                                  *10890001
109400******************************************************************10900001
109500 W150-WRITE-PER-HDRS-NO-DEPT.                                     10910001
109600                                                                  10920001
109700     WRITE REPORT-REC FROM REPORT-PERIOD-HDR AFTER 1.             10930001
109800                                                                  10940001
109900     WRITE REPORT-REC FROM REPORT-COLUMN-HDR1 AFTER 2.            10950001
110000     WRITE REPORT-REC FROM REPORT-COLUMN-HDR2 AFTER 1.            10960001
110100     WRITE REPORT-REC FROM BLANK-LINE         AFTER 1.            10970001
110200                                                                  10980001
110300     ADD 5  TO PC-LINE-COUNT.                                     10990001
110400 EJECT                                                            11000001
110500                                                                  11010001
110600******************************************************************11020001
110700*  WRITES THE DETAIL HEADERS FOR THE ADJUSTMENT JOURNAL REPORT   *11030001
110800******************************************************************11040001
110900 W200-WRITE-PERIOD-HEADERS.                                       11050001
111000                                                                  11060001
111100     WRITE REPORT-REC FROM REPORT-PERIOD-HDR  AFTER 1.            11070001
111200     WRITE REPORT-REC FROM REPORT-COLUMN-HDR1 AFTER 2.            11080001
111300     WRITE REPORT-REC FROM REPORT-COLUMN-HDR2 AFTER 1.            11090001
111400     WRITE REPORT-REC FROM BLANK-LINE         AFTER 1.            11100001
111500                                                                  11110001
111600     PERFORM W200-WRITE-DEPT-ACCT-HEADERS.                        11120001
111700                                                                  11130001
111800     ADD 5  TO PC-LINE-COUNT.                                     11140001
111900 EJECT                                                            11150001
112000                                                                  11160001
112100******************************************************************11170001
112200*  WRITES THE DETAIL HEADERS FOR THE ADJUSTMENT JOURNAL REPORT   *11180001
112300******************************************************************11190001
112400 W200-WRITE-DEPT-ACCT-HEADERS.                                    11200001
112500                                                                  11210001
112600     IF EXPENSE-ENTRY                                             11220001
112700         MOVE AP045-GL-ACCT-NBR TO RH-ACCT-NBR                    11230001
112800                                   PV-ACCT-NBR                    11240001
112900         PERFORM S200-SELECT-ACCT-NBR-DESC                        11250001
113000         MOVE APT00002-DESCR         TO RH-ACCT-DESC              11260005
113100         WRITE REPORT-REC FROM REPORT-ACCT-HDR AFTER 1            11270001
113200         WRITE REPORT-REC FROM BLANK-LINE      AFTER 1            11280001
113300     ELSE                                                         11290001
113400         MOVE AP045-DEPT-NBR TO RH-DEPT-NBR                       11300001
113500         WRITE REPORT-REC FROM REPORT-DEPT-HDR AFTER 1            11310001
113600         WRITE REPORT-REC FROM BLANK-LINE      AFTER 1            11320001
113700     END-IF.                                                      11330001
113800                                                                  11340001
113900     ADD 2  TO PC-LINE-COUNT.                                     11350001
114000 EJECT                                                            11360001
114100                                                                  11370001
114200******************************************************************11380001
114300*  WRITES THE DETAIL HEADER FOR THE SUMMARY PAGE OF THE          *11390001
114400*  ADJUSTMENT JOURNAL REPORT.                                    *11400001
114500******************************************************************11410001
114600 W300-WRITE-SUMMARY-HEADERS.                                      11420001
114700                                                                  11430001
114800     WRITE REPORT-REC FROM REPORT-SUMMARY-HDR AFTER 1.            11440001
114900     WRITE REPORT-REC FROM REPORT-COLUMN-SUMMARY-HDR1 AFTER 2.    11450001
115000     WRITE REPORT-REC FROM REPORT-COLUMN-SUMMARY-HDR2 AFTER 1.    11460001
115100     WRITE REPORT-REC FROM BLANK-LINE AFTER 1.                    11470001
115200                                                                  11480001
115300     ADD 4  TO PC-LINE-COUNT.                                     11490001
115400 EJECT                                                            11500001
115500                                                                  11510001
115600******************************************************************11520001
115700*  WRITES THE DETAIL LINE OF THE DAILY ADJUSTMENT JOURNAL REPORT *11530001
115800******************************************************************11540001
115900 W400-WRITE-DETAIL-LINE.                                          11550001
116000     IF PC-LINE-COUNT > PC-MAX-LINES                              11560001
116100         PERFORM W100-WRITE-HEADERS                               11570001
116200         PERFORM W200-WRITE-PERIOD-HEADERS                        11580001
116300     END-IF.                                                      11590001
116400                                                                  11600001
116500     WRITE REPORT-REC FROM  REPORT-DETAIL-LINE AFTER 1.           11610001
116600     ADD 1  TO PC-LINE-COUNT.                                     11620001
116700 EJECT.                                                           11630001
116800                                                                  11640001
116900******************************************************************11650001
117000*  WRITES THE AMOUNT TOTALS FOR THE ACCOUNT/DEPARTMENT           *11660001
117100*  CURRENTLY PROCESSED.                                          *11670001
117200*  (THIS IS DONE WHEN THE ACCOUNT/DEPARTMENT CHANGES)            *11680001
117300******************************************************************11690001
117400 W600-WRITE-ACCOUNT-TOTALS.                                       11700001
117500                                                                  11710001
117600     MOVE ACCT-GRO-COST-AMT TO RT-GRO-COST-AMT                    11720001
117700     IF ACCT-GRO-COST-AMT < 0                                     11730001
117800         INSPECT RT-GRO-COST-AMT REPLACING ALL '-' BY '('         11740001
117900         MOVE ')' TO RT-GRO-COST-AMT-P                            11750001
118000     ELSE                                                         11760001
118100         MOVE ' ' TO RT-GRO-COST-AMT-P                            11770001
118200     END-IF.                                                      11780001
118300                                                                  11790001
118400     MOVE ACCT-DISC-AMT TO RT-DISC-AMT                            11800001
118500     IF ACCT-DISC-AMT < 0                                         11810001
118600         INSPECT RT-DISC-AMT REPLACING ALL '-' BY '('             11820001
118700         MOVE ')' TO RT-DISC-AMT-P                                11830001
118800     ELSE                                                         11840001
118900         MOVE ' ' TO RT-DISC-AMT-P                                11850001
119000     END-IF.                                                      11860001
119100                                                                  11870001
119200     MOVE ACCT-FRGT-AMT TO RT-FRGT-AMT                            11880001
119300     IF ACCT-FRGT-AMT < 0                                         11890001
119400         INSPECT RT-FRGT-AMT REPLACING ALL '-' BY '('             11900001
119500         MOVE ')' TO RT-FRGT-AMT-P                                11910001
119600     ELSE                                                         11920001
119700         MOVE ' ' TO RT-FRGT-AMT-P                                11930001
119800     END-IF.                                                      11940001
119900                                                                  11950001
120000     MOVE ACCT-MISC-CHRG-AMT TO RT-MISC-CHRG-AMT                  11960001
120100     IF ACCT-MISC-CHRG-AMT < 0                                    11970001
120200         INSPECT RT-MISC-CHRG-AMT REPLACING ALL '-' BY '('        11980001
120300         MOVE ')' TO RT-MISC-CHRG-AMT-P                           11990001
120400     ELSE                                                         12000001
120500         MOVE ' ' TO RT-MISC-CHRG-AMT-P                           12010001
120600     END-IF.                                                      12020001
120700                                                                  12030001
120800     MOVE ACCT-NET-COST-AMT TO RT-NET-COST-AMT                    12040001
120900     IF ACCT-NET-COST-AMT < 0                                     12050001
121000         INSPECT RT-NET-COST-AMT REPLACING ALL '-' BY '('         12060001
121100         MOVE ')' TO RT-NET-COST-AMT-P                            12070001
121200     ELSE                                                         12080001
121300         MOVE ' ' TO RT-NET-COST-AMT-P                            12090001
121400     END-IF.                                                      12100001
121500                                                                  12110001
121600     MOVE ACCT-RETL-AMT TO RT-RETL-AMT                            12120001
121700     IF ACCT-RETL-AMT < 0                                         12130001
121800         INSPECT RT-RETL-AMT REPLACING ALL '-' BY '('             12140001
121900         MOVE ')' TO RT-RETL-AMT-P                                12150001
122000     ELSE                                                         12160001
122100         MOVE ' ' TO RT-RETL-AMT-P                                12170001
122200     END-IF.                                                      12180001
122300                                                                  12190001
122400     IF PC-LINE-COUNT > PC-MAX-LINES                              12200001
122500         PERFORM W100-WRITE-HEADERS                               12210001
122600         PERFORM W200-WRITE-PERIOD-HEADERS                        12220001
122700     END-IF.                                                      12230001
122800                                                                  12240001
122900     IF HOLD-EXPENSE-ENTRY                                        12250001
123000         MOVE HOLD-ACCT-NBR TO RT-ACCOUNT                         12260001
123100         MOVE TIT-ACCT-TOTAL TO TOTALS-DESC                       12270001
123200         WRITE REPORT-REC FROM REPORT-TOTALS AFTER 2              12280001
123300     ELSE                                                         12290001
123400         MOVE HOLD-DEPT-NBR TO RT-DEPT-NBR                        12300001
123500         MOVE TIT-DEPT-TOTAL TO TOTALS-DESC                       12310001
123600         WRITE REPORT-REC FROM REPORT-TOTALS AFTER 2              12320001
123700     END-IF.                                                      12330001
123800     WRITE REPORT-REC FROM BLANK-LINE AFTER 2.                    12340001
123900                                                                  12350001
124000     ADD 4  TO PC-LINE-COUNT.                                     12360001
124100 EJECT.                                                           12370001
124200                                                                  12380001
124300******************************************************************12390001
124400*  WRITES THE AMOUNT TOTALS FOR THE PERIOD CURRENTLY PROCESSED.  *12400001
124500*  (THIS IS DONE WHEN THE PERIOD CHANGES)                        *12410001
124600******************************************************************12420001
124700 W700-WRITE-PERIOD-TOTALS.                                        12430001
124800                                                                  12440001
124900     MOVE PER-GRO-COST-AMT TO RT-GRO-COST-AMT                     12450001
125000     IF PER-GRO-COST-AMT < 0                                      12460001
125100         INSPECT RT-GRO-COST-AMT REPLACING ALL '-' BY '('         12470001
125200         MOVE ')' TO RT-GRO-COST-AMT-P                            12480001
125300     ELSE                                                         12490001
125400         MOVE ' ' TO RT-GRO-COST-AMT-P                            12500001
125500     END-IF.                                                      12510001
125600                                                                  12520001
125700     MOVE PER-DISC-AMT TO RT-DISC-AMT                             12530001
125800     IF PER-DISC-AMT < 0                                          12540001
125900         INSPECT RT-DISC-AMT REPLACING ALL '-' BY '('             12550001
126000         MOVE ')' TO RT-DISC-AMT-P                                12560001
126100     ELSE                                                         12570001
126200         MOVE ' ' TO RT-DISC-AMT-P                                12580001
126300     END-IF.                                                      12590001
126400                                                                  12600001
126500     MOVE PER-FRGT-AMT TO RT-FRGT-AMT                             12610001
126600     IF PER-FRGT-AMT < 0                                          12620001
126700         INSPECT RT-FRGT-AMT REPLACING ALL '-' BY '('             12630001
126800         MOVE ')' TO RT-FRGT-AMT-P                                12640001
126900     ELSE                                                         12650001
127000         MOVE ' ' TO RT-FRGT-AMT-P                                12660001
127100     END-IF.                                                      12670001
127200                                                                  12680001
127300     MOVE PER-MISC-CHRG-AMT TO RT-MISC-CHRG-AMT                   12690001
127400     IF PER-MISC-CHRG-AMT < 0                                     12700001
127500         INSPECT RT-MISC-CHRG-AMT REPLACING ALL '-' BY '('        12710001
127600         MOVE ')' TO RT-MISC-CHRG-AMT-P                           12720001
127700     ELSE                                                         12730001
127800         MOVE ' ' TO RT-MISC-CHRG-AMT-P                           12740001
127900     END-IF.                                                      12750001
128000                                                                  12760001
128100     MOVE PER-NET-COST-AMT TO RT-NET-COST-AMT                     12770001
128200     IF PER-NET-COST-AMT < 0                                      12780001
128300         INSPECT RT-NET-COST-AMT REPLACING ALL '-' BY '('         12790001
128400         MOVE ')' TO RT-NET-COST-AMT-P                            12800001
128500     ELSE                                                         12810001
128600         MOVE ' ' TO RT-NET-COST-AMT-P                            12820001
128700     END-IF.                                                      12830001
128800                                                                  12840001
128900     MOVE PER-RETL-AMT TO RT-RETL-AMT                             12850001
129000     IF PER-RETL-AMT < 0                                          12860001
129100         INSPECT RT-RETL-AMT REPLACING ALL '-' BY '('             12870001
129200         MOVE ')' TO RT-RETL-AMT-P                                12880001
129300     ELSE                                                         12890001
129400         MOVE ' ' TO RT-RETL-AMT-P                                12900001
129500     END-IF.                                                      12910001
129600                                                                  12920001
129700     IF PC-LINE-COUNT > PC-MAX-LINES                              12930001
129800         PERFORM W100-WRITE-HEADERS                               12940001
129900         PERFORM W150-WRITE-PER-HDRS-NO-DEPT                      12950001
130000     END-IF.                                                      12960001
130100                                                                  12970001
130200     MOVE DPG55-ALPHA-MONTH-ABBR3 TO RT-PERIOD-MONTH.             12980001
130300     MOVE AP045-PSTG-FYR-NBR      TO RT-PERIOD-YR.                12990001
130400     MOVE TIT-PERIOD-TOTAL TO TOTALS-DESC.                        13000001
130500     WRITE REPORT-REC FROM REPORT-TOTALS AFTER 2                  13010001
130600     WRITE REPORT-REC FROM BLANK-LINE AFTER 1.                    13020001
130700                                                                  13030001
130800     ADD 3  TO PC-LINE-COUNT.                                     13040001
130900 EJECT.                                                           13050001
131000                                                                  13060001
131100******************************************************************13070001
131200*  WRITES THE GRAND TOTALS FOR THE REPORT.                       *13080001
131300******************************************************************13090001
131400 W800-WRITE-REPORT-TOTALS.                                        13100001
131500                                                                  13110001
131600     MOVE GRAND-GRO-COST-AMT TO RT-GRO-COST-AMT                   13120001
131700     IF GRAND-GRO-COST-AMT < 0                                    13130001
131800         INSPECT RT-GRO-COST-AMT REPLACING ALL '-' BY '('         13140001
131900         MOVE ')' TO RT-GRO-COST-AMT-P                            13150001
132000     ELSE                                                         13160001
132100         MOVE ' ' TO RT-GRO-COST-AMT-P                            13170001
132200     END-IF.                                                      13180001
132300                                                                  13190001
132400     MOVE GRAND-DISC-AMT TO RT-DISC-AMT                           13200001
132500     IF GRAND-DISC-AMT < 0                                        13210001
132600         INSPECT RT-DISC-AMT REPLACING ALL '-' BY '('             13220001
132700         MOVE ')' TO RT-DISC-AMT-P                                13230001
132800     ELSE                                                         13240001
132900         MOVE ' ' TO RT-DISC-AMT-P                                13250001
133000     END-IF.                                                      13260001
133100                                                                  13270001
133200     MOVE GRAND-FRGT-AMT TO RT-FRGT-AMT                           13280001
133300     IF GRAND-FRGT-AMT < 0                                        13290001
133400         INSPECT RT-FRGT-AMT REPLACING ALL '-' BY '('             13300001
133500         MOVE ')' TO RT-FRGT-AMT-P                                13310001
133600     ELSE                                                         13320001
133700         MOVE ' ' TO RT-FRGT-AMT-P                                13330001
133800     END-IF.                                                      13340001
133900                                                                  13350001
134000     MOVE GRAND-MISC-CHRG-AMT TO RT-MISC-CHRG-AMT                 13360001
134100     IF GRAND-MISC-CHRG-AMT < 0                                   13370001
134200         INSPECT RT-MISC-CHRG-AMT REPLACING ALL '-' BY '('        13380001
134300         MOVE ')' TO RT-MISC-CHRG-AMT-P                           13390001
134400     ELSE                                                         13400001
134500         MOVE ' ' TO RT-MISC-CHRG-AMT-P                           13410001
134600     END-IF.                                                      13420001
134700                                                                  13430001
134800     MOVE GRAND-NET-COST-AMT TO RT-NET-COST-AMT                   13440001
134900     IF GRAND-NET-COST-AMT < 0                                    13450001
135000         INSPECT RT-NET-COST-AMT REPLACING ALL '-' BY '('         13460001
135100         MOVE ')' TO RT-NET-COST-AMT-P                            13470001
135200     ELSE                                                         13480001
135300         MOVE ' ' TO RT-NET-COST-AMT-P                            13490001
135400     END-IF.                                                      13500001
135500                                                                  13510001
135600     MOVE GRAND-RETL-AMT TO RT-RETL-AMT                           13520001
135700     IF GRAND-RETL-AMT < 0                                        13530001
135800         INSPECT RT-RETL-AMT REPLACING ALL '-' BY '('             13540001
135900         MOVE ')' TO RT-RETL-AMT-P                                13550001
136000     ELSE                                                         13560001
136100         MOVE ' ' TO RT-RETL-AMT-P                                13570001
136200     END-IF.                                                      13580001
136300                                                                  13590001
136400     IF PC-LINE-COUNT > PC-MAX-LINES                              13600001
136500         PERFORM W100-WRITE-HEADERS                               13610001
136600         PERFORM W150-WRITE-PER-HDRS-NO-DEPT                      13620001
136700     END-IF.                                                      13630001
136800                                                                  13640001
136900     MOVE TIT-GRAND-TOTAL TO TOTALS-DESC.                         13650001
137000     WRITE REPORT-REC FROM REPORT-TOTALS AFTER 2                  13660001
137100     WRITE REPORT-REC FROM BLANK-LINE AFTER 1.                    13670001
137200                                                                  13680001
137300     ADD 3  TO PC-LINE-COUNT.                                     13690001
137400 EJECT.                                                           13700001
137500                                                                  13710001
137600******************************************************************13720001
137700******************************************************************13730001
137800 W800-WRITE-MERCH-EXP-TOTALS.                                     13740001
137900                                                                  13750001
138000     MOVE MER-GRO-COST-AMT TO RT-GRO-COST-AMT                     13760001
138100     IF MER-GRO-COST-AMT < 0                                      13770001
138200         INSPECT RT-GRO-COST-AMT REPLACING ALL '-' BY '('         13780001
138300         MOVE ')' TO RT-GRO-COST-AMT-P                            13790001
138400     ELSE                                                         13800001
138500         MOVE ' ' TO RT-GRO-COST-AMT-P                            13810001
138600     END-IF.                                                      13820001
138700                                                                  13830001
138800     MOVE MER-DISC-AMT TO RT-DISC-AMT                             13840001
138900     IF MER-DISC-AMT < 0                                          13850001
139000         INSPECT RT-DISC-AMT REPLACING ALL '-' BY '('             13860001
139100         MOVE ')' TO RT-DISC-AMT-P                                13870001
139200     ELSE                                                         13880001
139300         MOVE ' ' TO RT-DISC-AMT-P                                13890001
139400     END-IF.                                                      13900001
139500                                                                  13910001
139600     MOVE MER-FRGT-AMT TO RT-FRGT-AMT                             13920001
139700     IF MER-FRGT-AMT < 0                                          13930001
139800         INSPECT RT-FRGT-AMT REPLACING ALL '-' BY '('             13940001
139900         MOVE ')' TO RT-FRGT-AMT-P                                13950001
140000     ELSE                                                         13960001
140100         MOVE ' ' TO RT-FRGT-AMT-P                                13970001
140200     END-IF.                                                      13980001
140300                                                                  13990001
140400     MOVE MER-MISC-CHRG-AMT TO RT-MISC-CHRG-AMT                   14000001
140500     IF MER-MISC-CHRG-AMT < 0                                     14010001
140600         INSPECT RT-MISC-CHRG-AMT REPLACING ALL '-' BY '('        14020001
140700         MOVE ')' TO RT-MISC-CHRG-AMT-P                           14030001
140800     ELSE                                                         14040001
140900         MOVE ' ' TO RT-MISC-CHRG-AMT-P                           14050001
141000     END-IF.                                                      14060001
141100                                                                  14070001
141200     MOVE MER-NET-COST-AMT TO RT-NET-COST-AMT                     14080001
141300     IF MER-NET-COST-AMT < 0                                      14090001
141400         INSPECT RT-NET-COST-AMT REPLACING ALL '-' BY '('         14100001
141500         MOVE ')' TO RT-NET-COST-AMT-P                            14110001
141600     ELSE                                                         14120001
141700         MOVE ' ' TO RT-NET-COST-AMT-P                            14130001
141800     END-IF.                                                      14140001
141900                                                                  14150001
142000     MOVE MER-RETL-AMT TO RT-RETL-AMT                             14160001
142100     IF MER-RETL-AMT < 0                                          14170001
142200         INSPECT RT-RETL-AMT REPLACING ALL '-' BY '('             14180001
142300         MOVE ')' TO RT-RETL-AMT-P                                14190001
142400     ELSE                                                         14200001
142500         MOVE ' ' TO RT-RETL-AMT-P                                14210001
142600     END-IF.                                                      14220001
142700                                                                  14230001
142800     IF PC-LINE-COUNT > PC-MAX-LINES                              14240001
142900         PERFORM W100-WRITE-HEADERS                               14250001
143000         PERFORM W150-WRITE-PER-HDRS-NO-DEPT                      14260001
143100     END-IF.                                                      14270001
143200                                                                  14280001
143300     IF HOLD-EXPENSE-ENTRY                                        14290001
143400         MOVE TIT-EXPENSE-TOTAL TO TOTALS-DESC                    14300001
143500         WRITE REPORT-REC FROM REPORT-TOTALS AFTER 2              14310001
143600     ELSE                                                         14320001
143700         MOVE TIT-MERCHANDISE-TOTAL TO TOTALS-DESC                14330001
143800         WRITE REPORT-REC FROM REPORT-TOTALS AFTER 2              14340001
143900     END-IF.                                                      14350001
144000     WRITE REPORT-REC FROM BLANK-LINE AFTER 1.                    14360001
144100                                                                  14370001
144200     ADD 3  TO PC-LINE-COUNT.                                     14380001
144300 EJECT.                                                           14390001
144400                                                                  14400001
144500******************************************************************14410001
144600*  WRITES THE DETAIL LINE FOR THE SUMMARY PAGE.                  *14420001
144700******************************************************************14430001
144800 W900-WRITE-SUMMARY-DETAIL-LINE.                                  14440001
144900     IF PC-LINE-COUNT > PC-MAX-LINES                              14450001
145000         PERFORM W100-WRITE-HEADERS                               14460001
145100         PERFORM W300-WRITE-SUMMARY-HEADERS                       14470001
145200     END-IF.                                                      14480001
145300                                                                  14490001
145400     WRITE REPORT-REC FROM  REPORT-SUMMARY-DETAIL-LINE AFTER 1.   14500001
145500     ADD 1  TO PC-LINE-COUNT.                                     14510001
145600 EJECT.                                                           14520001
145700                                                                  14530001
145800******************************************************************14540001
145900*  WRITES THE DETAIL LINE FOR THE SUMMARY PAGE.                  *14550001
146000******************************************************************14560001
146100 W900-WRITE-SUMMARY-TOTALS.                                       14570001
146200                                                                  14580001
146300     MOVE SUMMARY-GRO-COST-AMT TO RT-GRO-COST-AMT                 14590001
146400     IF SUMMARY-GRO-COST-AMT < 0                                  14600001
146500         INSPECT RT-GRO-COST-AMT REPLACING ALL '-' BY '('         14610001
146600         MOVE ')' TO RT-GRO-COST-AMT-P                            14620001
146700     ELSE                                                         14630001
146800         MOVE ' ' TO RT-GRO-COST-AMT-P                            14640001
146900     END-IF.                                                      14650001
147000                                                                  14660001
147100     MOVE SUMMARY-DISC-AMT TO RT-DISC-AMT                         14670001
147200     IF SUMMARY-DISC-AMT < 0                                      14680001
147300         INSPECT RT-DISC-AMT REPLACING ALL '-' BY '('             14690001
147400         MOVE ')' TO RT-DISC-AMT-P                                14700001
147500     ELSE                                                         14710001
147600         MOVE ' ' TO RT-DISC-AMT-P                                14720001
147700     END-IF.                                                      14730001
147800                                                                  14740001
147900     MOVE SUMMARY-FRGT-AMT TO RT-FRGT-AMT                         14750001
148000     IF SUMMARY-FRGT-AMT < 0                                      14760001
148100         INSPECT RT-FRGT-AMT REPLACING ALL '-' BY '('             14770001
148200         MOVE ')' TO RT-FRGT-AMT-P                                14780001
148300     ELSE                                                         14790001
148400         MOVE ' ' TO RT-FRGT-AMT-P                                14800001
148500     END-IF.                                                      14810001
148600                                                                  14820001
148700     MOVE SUMMARY-MISC-CHRG-AMT TO RT-MISC-CHRG-AMT               14830001
148800     IF SUMMARY-MISC-CHRG-AMT < 0                                 14840001
148900         INSPECT RT-MISC-CHRG-AMT REPLACING ALL '-' BY '('        14850001
149000         MOVE ')' TO RT-MISC-CHRG-AMT-P                           14860001
149100     ELSE                                                         14870001
149200         MOVE ' ' TO RT-MISC-CHRG-AMT-P                           14880001
149300     END-IF.                                                      14890001
149400                                                                  14900001
149500     MOVE SUMMARY-NET-COST-AMT TO RT-NET-COST-AMT                 14910001
149600     IF SUMMARY-NET-COST-AMT < 0                                  14920001
149700         INSPECT RT-NET-COST-AMT REPLACING ALL '-' BY '('         14930001
149800         MOVE ')' TO RT-NET-COST-AMT-P                            14940001
149900     ELSE                                                         14950001
150000         MOVE ' ' TO RT-NET-COST-AMT-P                            14960001
150100     END-IF.                                                      14970001
150200                                                                  14980001
150300     MOVE SUMMARY-RETL-AMT TO RT-RETL-AMT                         14990001
150400     IF SUMMARY-RETL-AMT < 0                                      15000001
150500         INSPECT RT-RETL-AMT REPLACING ALL '-' BY '('             15010001
150600         MOVE ')' TO RT-RETL-AMT-P                                15020001
150700     ELSE                                                         15030001
150800         MOVE ' ' TO RT-RETL-AMT-P                                15040001
150900     END-IF.                                                      15050001
151000                                                                  15060001
151100     IF PC-LINE-COUNT > PC-MAX-LINES                              15070001
151200         PERFORM W100-WRITE-HEADERS                               15080001
151300         PERFORM W300-WRITE-SUMMARY-HEADERS                       15090001
151400     END-IF.                                                      15100001
151500                                                                  15110001
151600     MOVE TIT-SUMMARY-TOTAL TO TOTALS-DESC.                       15120001
151700     WRITE REPORT-REC FROM  REPORT-TOTALS AFTER 2.                15130001
151800     ADD 2  TO PC-LINE-COUNT.                                     15140001
151900 EJECT.                                                           15150001
152000                                                                  15160001
152100******************************************************************15170001
152200* THIS ROUTINE CALLS THE CALENDAR ROUTINE TO CONVERT THE POSTING  15180001
152300* PERIOD TO A 3 CHARACTER MONTH.                                  15190001
152400******************************************************************15200001
152500 Y100-CONVERT-PERIOD-TO-MONTH.                                    15210001
152600     INITIALIZE DPG51                                             15220001
152700                DPG52                                             15230001
152800                DPG53                                             15240001
152900                DPG54                                             15250001
153000                DPG55                                             15260001
153100                DPG56.                                            15270001
153200     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       15280001
153300     SET DPG52-LK-DTE-FISC-PRD-CC TO TRUE.                        15290001
153400     MOVE AP045-PSTG-FMN-NBR TO DPG52-FISCAL-CC-PRD-PP.           15300001
153500     MOVE AP045-PSTG-FYR-NBR TO DPG52-FISCAL-CC-PRD-YR.           15310001
153600                                                                  15320001
153700     DISPLAY 'AP045-PSTG-FMN-NBR  ' AP045-PSTG-FMN-NBR            15330001
153800     DISPLAY 'AP045-PSTG-FYR-NBR  ' AP045-PSTG-FMN-NBR            15340001
153900     DISPLAY 'DPG52-FISCAL-CC-PRD ' DPG52-FISCAL-CC-PRD           15350001
154000                                                                  15360001
154100     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    15370001
154200                                             DPG54 DPG55 DPG56.   15380001
154300                                                                  15390001
154400     IF DPG54-SEVERE-ERROR OR DPG54-WARNING-ERROR                 15400001
154500        DISPLAY 'PO NUMBER ' HOLD-PO-NBR                          15410001
154600        DISPLAY 'DPKUT500 DTE ERROR= ' DPG54-ERROR-MESSAGE        15420001
154700        CALL 'ILBOABN0' USING ABEND-CODE                          15430001
154800     END-IF.                                                      15440001
154900                                                                  15450001
155000     MOVE DPG55-ALPHA-MONTH-ABBR3 TO RH-PERIOD-MONTH.             15460001
155100     MOVE AP045-PSTG-FYR-NBR      TO RH-PERIOD-YR.                15470001
155200 EJECT                                                            15480001
160900******************************************************************15490001
161000*  ABEND ROUTINE                                                  15500011
161100******************************************************************15510001
161200 Z999-ABEND.                                                      15520001
161300     DISPLAY '**********************************************'     15530001
161400     DISPLAY 'PROGRAM NAME = APKRP148'                            15540001
161500     DISPLAY 'APRD045 RECORDS IN = '  PC-AP045-IN.                15550001
161600     DISPLAY 'ORGN-SUM RECORDS IN = ' PC-ORGN-SUM-IN.             15560001
161700     DISPLAY '**********************************************'     15570001
161800                                                                  15580001
161900     CLOSE ADJ-JRNL-TRAN-FILE                                     15590001
162000           ORIGIN-SUM-FILE                                        15600001
162100           REPORT-FILE.                                           15610001
162200                                                                  15620001
162300     DISPLAY AA-ABEND-LIT.                                        15630001
162400     DISPLAY AA-MESSAGE-LINE-1.                                   15640001
162500     DISPLAY AA-MESSAGE-LINE-2.                                   15650001
162700     DISPLAY AA-PROGRAM-LIT.                                      15670001
162800     DISPLAY AA-PARAGRAPH-LIT.                                    15680001
163400                                                                  15740001
163410     COPY DPPD004.                                                15750001
163420                                                                  15760001
163500     CALL 'ILBOABN0' USING ABEND-CODE.                            15770001
163600 EJECT                                                            15780001
