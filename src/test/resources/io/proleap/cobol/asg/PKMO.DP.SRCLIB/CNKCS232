000100*-----------------------*                                         00010048
000200 IDENTIFICATION DIVISION.                                         00020048
000300*-----------------------*                                         00030048
000400 PROGRAM-ID.    CNKCS232.                                         00040048
000500 AUTHOR.        DENISE HAHN.                                      00050048
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060048
000700 DATE-WRITTEN.  JULY, 2018.                                       00070048
000800 DATE-COMPILED.                                                   00080048
000900*---------------------------------------------------------------* 00090048
001000*    Y232 - UPDATE OUTBOUND TRAILER                               00100048
001500*---------------------------------------------------------------* 00150048
263455* CHANGED 11/03/2021    BY JIM HUNTER      WR: CHG0263455         00151076
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00152075
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00153075
263455*----------------------------------------------------------------*00154075
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00155077
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00156077
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00157077
CICS  *-----------------------------------------------------------------00158077
001600 ENVIRONMENT DIVISION.                                            00160048
001700 DATA DIVISION.                                                   00170048
001800                                                                  00180048
001900 WORKING-STORAGE SECTION.                                         00190048
002000                                                                  00200048
002100 01  DK-DB2-KEYS.                                                 00210048
002200     05  DK-SCAC                  PIC   X(04)      VALUE SPACES.  00220049
002300     05  DK-TRLR-ID               PIC   X(12)      VALUE SPACES.  00230049
002400     05  DK-TRLR-SRL-NBR          PIC  S9(09) COMP VALUE ZEROES.  00240050
002800                                                                  00280048
002900 01  PC-PROGRAM-CONSTANTS.                                        00290048
003000     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'CNKCS232'.  00300048
003100     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'CN232A  '.  00310060
003200     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'CNKM232 '.  00320048
003300     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00330048
003400                                              COMP.               00340048
003500     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00350048
003600                                              COMP.               00360048
003700     05  PC-INTER-APPL-CODES.                                     00370048
003800         10  PC-INTER-APPL-CRIT-SPEC-UPD  PIC  X(01)  VALUE '1'.  00380048
004100         10  PC-INTER-APPL-LIST-UPDATE    PIC  X(01)  VALUE '2'.  00410048
004101     05  PC-DEFAULT-TMST          PIC X(26)                       00410155
004102                              VALUE '9999-09-09-09.09.09.999999'. 00410255
004110*                                                                 00411049
005400                                                                  00540048
005500*----------------------------------------------------------------*00550048
005600*  SYSTEM MESSAGES                                                00560048
005700*----------------------------------------------------------------*00570048
005900*   00005 - data entered is not valid for this field              00590074
005910*   00007 - REQUIRED ENTRY                                        00591074
006000*   00008 - MUST BE NUMERIC                                       00600048
006200*   00045 - INVALID FUNCTION                                      00620048
006300*   00059 - UPDATE(S) SUCCESSFUL                                  00630048
006400*   00069 - TOP OF LIST                                           00640048
006500*   00070 - BOTTOM OF LIST                                        00650048
006600*   03552 - INVALID TRAILER LENGTH MUST BE 01,28,48 OR 53         00660073
007805*   03808 - UPDATE TRAILER LENGTH - F2 TO CONFIRM                 00780554
007807*----------------------------------------------------------------*00780753
007808     05  PC-TSYMSG-NUMBERS.                                       00780853
007810         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00781074
007811         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00781174
007812         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00781274
007830         10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       00783053
007840         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00784054
007850         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00785053
007860         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00786053
009310         10  PC-TSYMSG-03552      PIC  9(05)  VALUE  03552.       00931073
009320         10  PC-TSYMSG-03808      PIC  9(05)  VALUE  03808.       00932073
009500*                                                                 00950048
009600 01  PS-PROGRAM-SWITCHES.                                         00960052
009700     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00970052
009800         88  PS-ERROR                         VALUE  'Y'.         00980052
009900         88  PS-NO-ERROR                      VALUE  'N'.         00990052
010000     05  PS-COMMAREA-SW           PIC  X(01)  VALUE  'N'.         01000052
010100         88  PS-COMMAREA-VALID                VALUE  'Y'.         01010052
010200         88  PS-COMMAREA-NOT-VALID            VALUE  'N'.         01020052
010300     05  PS-LIST-END-SW           PIC  X(01)  VALUE  'N'.         01030053
010400         88  PS-LIST-END                      VALUE  'Y'.         01040053
010500         88  PS-NO-LIST-END                   VALUE  'N'.         01050053
011800     05  PS-LENGTH-CHANGED-SW      PIC X(01)  VALUE  'N'.         01180050
011900         88  PS-LENGTH-CHANGED-YES            VALUE  'Y'.         01190050
012000         88  PS-LENGTH-CHANGED-NO             VALUE  'N'.         01200050
012001     05  PS-TRLR-LGTH-SW           PIC  X(01)  VALUE  'N'.        01200173
012002         88  PS-VALID-TRLR-LGTH                VALUE  'Y'.        01200273
012003         88  PS-NOT-VALID-TRLR-LGTH            VALUE  'N'.        01200373
012100                                                                  01210050
012200 01  PV-PROGRAM-VARIABLES.                                        01220052
012300     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01230053
012400                                              COMP SYNC.          01240053
014400******************************************************************01440048
014500*PV-INP VARIABLES HOLD COMMAREA VALUES                            01450048
014600*       ONLY PV-INP VARIABLES READ FROM AND WRITE TO ASC-'S       01460048
014700******************************************************************01470048
014800     05  PV-OPER-UNT-ID           PIC S9(04) COMP.                01480050
014900     05  PV-FCLTY-ID              PIC S9(04) COMP.                01490050
015000     05  PV-FCLTY-NME             PIC  X(25).                     01500050
015100     05  PV-SCAC                  PIC  X(04).                     01510050
015200     05  PV-SCAC-NAME             PIC  X(30).                     01520050
015300     05  PV-TRLR-ID               PIC  X(12).                     01530050
015400     05  PV-TRLR-SRL-NBR          PIC S9(09) COMP.                01540050
015500     05  PV-PRINTER-ID            PIC  X(08).                     01550050
015600     05  PV-TRLR-LENGTH           PIC  9(04).                     01560050
015601     05  PV-TRLR-LENGTH-CHAR.                                     01560173
015602         10  PV-TRLR-LENGTH-NUM   PIC  9(02).                     01560273
015610                                                                  01561055
015620     05  PV-CAPTURE-CNT           PIC S9(09) COMP VALUE ZEROES.   01562055
015700     05  PV-RANDOM-TMST           PIC  X(26) VALUE SPACES.        01570055
015800     05  PC-RANDOM-PGM            PIC  X(08) VALUE 'DPKUT902'.    01580055
015900     05  PV-CAPTURE-RANDOM-NBR    PIC  9(09) VALUE ZEROES.        01590055
016300                                                                  01630048
016301******************************************************************01630156
016302*PV-capture - data area used to track updates to outbound trlrs   01630256
016304******************************************************************01630456
016310 01  PV-CAPTURE-RECORD.                                           01631058
016380     05  PV-CAPT-OPER-UNT-ID      PIC  9(04).                     01638058
016381     05  FILLER                   PIC  X(01) value space.         01638167
016390     05  PV-CAPT-USER-ID          PIC  X(08).                     01639058
016391     05  FILLER                   PIC  X(01) value space.         01639167
016392     05  PV-CAPT-SCAC             PIC  X(04).                     01639258
016393     05  FILLER                   PIC  X(01) value space.         01639367
016394     05  PV-CAPT-TRLR-ID          PIC  X(12).                     01639458
016395     05  FILLER                   PIC  X(01) value space.         01639567
016396     05  PV-CAPT-TRLR-SRL-NBR     PIC  9(09).                     01639658
016397     05  FILLER                   PIC  X(01) value space.         01639767
016398     05  PV-CAPT-OLD-TRLR-LENGTH  PIC  9(04).                     01639858
016399     05  FILLER                   PIC  X(01) value space.         01639967
016400     05  PV-CAPT-NEW-TRLR-LENGTH  PIC  9(04).                     01640058
016401     05  FILLER                   PIC  X(01) value space.         01640167
016410*---------------------------------------------------------------* 01641048
016500* SELECTON QUEUE LAYOUT                                         * 01650048
016600*---------------------------------------------------------------* 01660048
016700     COPY CNWS010.                                                01670048
016800                                                                  01680048
016900*----------------------------------------------------------------*01690048
017000*    MAP LAYOUT                                                  *01700048
017100*----------------------------------------------------------------*01710048
017200     COPY CNKM232.                                                01720048
017300                                                                  01730048
017400*----------------------------------------------------------------*01740048
017500*    ATTRIBUTE SETTINGS COPYBOOK.                                *01750048
017600*----------------------------------------------------------------*01760048
017700     COPY DPWS015.                                                01770048
017800                                                                  01780048
017900*----------------------------------------------------------------*01790048
018000*    FUNCTION KEYS COPYBOOK                                      *01800048
018100*----------------------------------------------------------------*01810048
018200     COPY DPWS016.                                                01820048
018300                                                                  01830048
018400**--------------------------------------------------------------**01840048
018500** THE CVLLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01850048
018600** SUB-ROUTINE (DPKUT100).                                      **01860048
018700**--------------------------------------------------------------**01870048
018800     COPY DPWS010I.                                               01880048
018900                                                                  01890048
019000**--------------------------------------------------------------**01900048
019100** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*01910048
019200** APPLICATION PROGRAMMING INTERFACE MODULE.                    **01920077
019300**--------------------------------------------------------------**01930048
019400     COPY DPWS030.                                                01940048
CICS       COPY DPWS930.                                                01941077
019500                                                                  01950048
019600**--------------------------------------------------------------**01960048
019700*    STANDARD COMMAREA.                                           01970048
019800**--------------------------------------------------------------**01980048
019900     COPY DPWS020.                                                01990048
020000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02000048
020100                                                                  02010048
020200*---------------------------------------------------------------* 02020048
020300* INTER-APPLICATION COMMAREA.                                     02030048
020400*   CNWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02040048
020500*             SPEC SCREEN.                                        02050048
020600*   CNWS009 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM        02060048
020700*             THE LIST SCREEN                                     02070048
020800*---------------------------------------------------------------* 02080048
020900                                                                  02090048
021000         10  INTER-APPL-COMM-AREA PIC X(200).                     02100048
021100     COPY CNWS008.                                                02110048
021200     COPY CNWS009.                                                02120048
021300***************************************************************** 02130048
021400*    SPECIFIC COMMMAREA FOR CNKCS232.                             02140048
021500***************************************************************** 02150048
021600         10  ASC-SPECIFIC-COMMAREA.                               02160048
021800             15  ASC-OPER-UNT-ID           PIC S9(04) COMP.       02180049
021900             15  ASC-FCLTY-ID              PIC S9(04) COMP.       02190049
022000             15  ASC-FCLTY-NME             PIC  X(25).            02200049
022100             15  ASC-SCAC                  PIC  X(04).            02210049
022200             15  ASC-SCAC-NAME             PIC  X(30).            02220049
022300             15  ASC-TRLR-ID               PIC  X(12).            02230049
022400             15  ASC-TRLR-SRL-NBR          PIC S9(09) COMP.       02240049
022500             15  ASC-PRINTER-ID            PIC  X(08).            02250049
022600             15  ASC-TRLR-LENGTH           PIC  X(04).            02260055
022601             15  ASC-TRLR-LENGTH-R REDEFINES ASC-TRLR-LENGTH.     02260155
022602                 20  ASC-TRLR-LENGTH-N     PIC  9(04).            02260255
022603             15  ASC-ORIG-TRLR-SIZE-MU     PIC S9(04) COMP.       02260350
022604             15  ASC-PRTR-ID               PIC  X(08).            02260451
022605             15  ASC-DC-PRTD-AT            PIC  X(02).            02260551
022606             15  ASC-USER-ID               PIC  X(08).            02260651
022607                                                                  02260751
022610             15  ASC-ACTION-SW          PIC X(03).                02261049
022620                 88  ASC-ADD            VALUE 'ADD'.              02262049
022630                 88  ASC-DELETE         VALUE 'DEL'.              02263049
022640                 88  ASC-UPDATE         VALUE 'UPD'.              02264049
022650             15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            02265053
022660             15  ASC-TERM-ID               PIC  X(04).            02266053
022700*                                                                 02270049
024600             15  ASC-MSG-NUMBER.                                  02460053
024700                 20  ASC-MSG-NUMBER-N      PIC  9(05).            02470053
024800             15  ASC-INT-APPL-FORMAT-SAVE  PIC  X(01).            02480053
025000             15  ASC-SYSTEM-ID             PIC  X(02).            02500053
025100             15  ASC-MSG-TEXT              PIC  X(70).            02510053
025200             15  ASC-USE-SELECTION-QUEUE-IND                      02520053
025300                                           PIC  X(01).            02530053
025400                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02540053
025500             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            02550053
025600             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    02560053
025700             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02570053
025800                                           PIC S9(09)  COMP-3.    02580053
025900             15  ASC-ITEM-SUB                 PIC S9(04)  COMP    02590053
026000                                                          SYNC.   02600053
026100             15  ASC-SEL-SUB               PIC S9(04)  COMP.      02610053
026200             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      02620053
026300             15  ASC-TEMP-QUEUE-UPDATE-SW  PIC  X(01).            02630053
026400                 88  ASC-UPDATE-TSQ                   VALUE 'Y'.  02640053
026500                 88  ASC-NO-TSQ-UPDATE                VALUE ' '.  02650053
026600*                                                                 02660049
027000             15  ASC-TCNTRID-UPDATED-SW   PIC  X(01).             02700049
027100                 88  ASC-TCNTRID-UPDATED              VALUE  'Y'. 02710049
027200                 88  ASC-TCNTRID-NOT-UPDATED          VALUE  'N'. 02720049
028110             15  ASC-F2-CONFIRM-SW            PIC  X(01).         02811048
028120                 88  ASC-F2-CONFIRM-YES               VALUE 'Y'.  02812048
028130                 88  ASC-F2-CONFIRM-NO                VALUE 'N'.  02813048
028140                                                                  02814048
028150*----------------------------------------------------------------*02815048
028160*    ABEND PROCESSING COPYBOOK.                                  *02816048
028170*----------------------------------------------------------------*02817048
028180     COPY DPWS013.                                                02818048
028190                                                                  02819048
028191*----------------------------------------------------------------*02819155
028192*    COMMAREA USED TO CALL XLKUT071                               02819255
028193*----------------------------------------------------------------*02819355
028194*    COPY XLWS071.                                                02819455
028195                                                                  02819555
028196*----------------------------------------------------------------*02819655
028197*  RANDOM NUMBER AREA                                            *02819755
028198*----------------------------------------------------------------*02819855
028199     COPY DPWS902.                                                02819955
028200                                                                  02820055
028210*----------------------------------------------------------------*02821048
028300*    OURBOUND TRAILER DEFINITION                                  02830049
028400*----------------------------------------------------------------*02840048
028500     EXEC SQL                                                     02850048
028600          INCLUDE TCNTRID                                         02860049
028700     END-EXEC.                                                    02870048
028800                                                                  02880048
028810******************************************************************02881055
028820*    wft_dat_cntl - 1 header                                      02882055
028830******************************************************************02883055
028840     EXEC SQL                                                     02884055
028850         INCLUDE wft00004                                         02885055
028860     END-EXEC.                                                    02886055
028870                                                                  02887055
028900******************************************************************02890055
029000*    wft_dat_xfer - 1 to many detail                              02900055
029100******************************************************************02910055
029200     EXEC SQL                                                     02920055
029300         INCLUDE wft00005                                         02930055
029400     END-EXEC.                                                    02940055
029500                                                                  02950055
029600******************************************************************02960074
029700*    tkrprpm                                                      02970074
029800******************************************************************02980074
029900     EXEC SQL                                                     02990074
030000         INCLUDE tkrprpm                                          03000074
030100     END-EXEC.                                                    03010074
030200                                                                  03020074
034100*----------------------------------------------------------------*03410048
034200*    DB2 AREA FOR COMMUNICATIONS                                  03420048
034300*----------------------------------------------------------------*03430048
034400     EXEC SQL                                                     03440048
034500          INCLUDE SQLCA                                           03450048
034600     END-EXEC.                                                    03460048
034700                                                                  03470048
034800*----------------------------------------------------------------*03480048
034900 LINKAGE SECTION.                                                 03490048
035000                                                                  03500048
035100 01  DFHCOMMAREA.                                                 03510048
035200     05  FILLER                         OCCURS  1 TO 4072 TIMES   03520048
035300                                        DEPENDING ON EIBCALEN.    03530048
035400         10  FILLER                     PIC X.                    03540048
035500                                                                  03550048
035600 PROCEDURE DIVISION.                                              03560048
035700***************************************************************** 03570048
035800** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03580048
035900** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03590048
036000** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03600048
036100**                                                             ** 03610048
036200** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03620048
036300** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03630048
036400***************************************************************** 03640048
036500 0000-MAIN-MODULE.                                                03650048
036600     INITIALIZE DP030-CICS-API-FIELDS.                            03660048
036700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03670048
036800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03680048
036900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03690048
037000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03700048
037100     MOVE LENGTH OF CN232AI        TO DP030-MAP-LENGTH (1).       03710054
037200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03720048
037300     PERFORM 0001-CALL-CICS-ARCH-API.                             03730048
037400                                                                  03740048
037500     PERFORM 1000-CONTROL-PROCESSING                              03750048
037600                                                                  03760048
037700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03770048
037800     PERFORM 0001-CALL-CICS-ARCH-API.                             03780048
037900                                                                  03790048
038000 0001-CALL-CICS-ARCH-API.                                         03800048
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03810077
038200                                    DFHCOMMAREA                   03820077
038300                                    DP030-CICS-API-FIELDS         03830077
038400                                    DP020-STANDARD-COMMAREA       03840077
038500                                    CN232AI.                      03850077
038600                                                                  03860048
038700     IF  DP030-RC-CALL-SUCCESSFUL                                 03870048
038800         CONTINUE                                                 03880048
038900     ELSE                                                         03890048
039000         SET DP013-NO-ROLLBACK                                    03900048
039100             DP013-XCTL-DISPLAY-RESTART                           03910048
039200             DP013-CICS-ABEND      TO TRUE                        03920048
039300         MOVE 'BEFORE 0000-MAIN-MODULE'                           03930048
039400                                   TO DP013-PARAGRAPH             03940048
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03941077
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03942077
039700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03970048
039800         PERFORM DP013-0000-PROCESS-ABEND                         03980048
039900     END-IF.                                                      03990048
040000*                                                                 04000048
040100*----------------------------------------------------------------*04010048
040200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04020048
040300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04030048
040400*----------------------------------------------------------------*04040048
040500 1000-CONTROL-PROCESSING.                                         04050048
040600                                                                  04060048
040700     EVALUATE TRUE                                                04070048
040800         WHEN DP020-NEXT-ACT-INITIAL                              04080048
040900              INITIALIZE ASC-SPECIFIC-COMMAREA                    04090048
041000              MOVE EIBTRMID TO ASC-TERM-ID                        04100053
041100              PERFORM 1100-PROCESS-INTER-APPL-COMM                04110048
041200                                                                  04120048
041300              IF  PS-COMMAREA-NOT-VALID                           04130048
041400                  SET DP020-NEXT-ACT-APPL-ERROR TO TRUE           04140048
041500              ELSE                                                04150048
041600                  PERFORM 4000-BUILD-INITIAL-PANEL                04160048
041700                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            04170048
042300                  PERFORM 3200-RESET-ATTRIBUTES                   04230048
042400              END-IF                                              04240048
042500                                                                  04250048
042600         WHEN DP020-NEXT-ACT-READ-MAP                             04260048
042700             PERFORM 2000-PROCESS-PANEL                           04270048
042800*F3-END                                                           04280048
042900         WHEN DP020-NEXT-ACT-RETURN                               04290048
043000             PERFORM 4000-BUILD-INITIAL-PANEL                     04300048
043100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04310048
043200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04320048
043300             MOVE -1                   TO CNLNGTHL                04330053
043400                                                                  04340048
043500         WHEN OTHER                                               04350048
043600             SET DP013-LOGIC-ABEND TO TRUE                        04360048
043700             SET DP013-NO-ROLLBACK TO TRUE                        04370048
043800             MOVE '1000-CONTROL-PROCESSING'                       04380048
043900                                   TO DP013-PARAGRAPH             04390048
044000             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    04400048
044100                                   TO DP013-MESSAGE-TEXT(1)       04410048
044200             MOVE DP020-NEXT-APPL-ACTIVITY                        04420048
044300                                   TO DP013-MESSAGE-TEXT(2)       04430048
044400             PERFORM DP013-0000-PROCESS-ABEND                     04440048
044500     END-EVALUATE.                                                04450048
044600*                                                                 04460048
044700******************************************************************04470048
044800** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **04480048
044900** INTER-APPLICATION FORMAT CODE.                               **04490048
045000******************************************************************04500048
045100 1100-PROCESS-INTER-APPL-COMM.                                    04510048
045200     INITIALIZE ASC-SPECIFIC-COMMAREA.                            04520048
045300     MOVE DP020-INT-APPL-FORMAT-IND                               04530048
045400                                   TO ASC-INT-APPL-FORMAT-IND.    04540048
045500                                                                  04550048
045600     SET PS-COMMAREA-VALID                                        04560048
045700         ASC-F2-CONFIRM-NO         TO TRUE.                       04570048
046100     EVALUATE ASC-INT-APPL-FORMAT-IND                             04610048
046300         WHEN PC-INTER-APPL-CRIT-SPEC-UPD                         04630048
046500             MOVE CN008-OPER-UNT-ID       TO ASC-OPER-UNT-ID      04650049
046600             MOVE CN008-FCLTY-ID          TO ASC-FCLTY-ID         04660049
046700             MOVE CN008-FCLTY-NME         TO ASC-FCLTY-NME        04670049
046800             MOVE CN008-SCAC              TO ASC-SCAC             04680049
046900             MOVE CN008-SCAC-NAME         TO ASC-SCAC-NAME        04690049
047000             MOVE CN008-TRLR-ID           TO ASC-TRLR-ID          04700049
047100             MOVE CN008-TRLR-SRL-NBR      TO ASC-TRLR-SRL-NBR     04710049
047200             MOVE CN008-PRINTER-ID        TO ASC-PRINTER-ID       04720049
047300             MOVE CN008-TRLR-LENGTH       TO ASC-TRLR-LENGTH      04730049
047900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04790048
048000             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   04800048
048100                                                                  04810048
048200*WHEN COMING FROM TRLR LIST SCREEN                                04820048
048300         WHEN PC-INTER-APPL-LIST-UPDATE                           04830048
048400           IF CN009-NUMBER-OF-SELECTED-ITEMS > 0                  04840048
048500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  04850048
048600             MOVE CN009-NUMBER-OF-SELECTED-ITEMS                  04860048
048700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04870048
048800             MOVE CN009-NUMBER-OF-TS-ITEMS                        04880048
048900                                   TO ASC-NUMBER-OF-TS-ITEMS      04890048
049000             MOVE CN009-SEL-QUEUE-NAME                            04900048
049100                                   TO ASC-SEL-QUEUE-NAME          04910048
049200             MOVE CN009-CURR-OPER-UNT-ID TO ASC-OPER-UNT-ID       04920053
049300             MOVE CN009-CURR-FCLTY-ID    TO ASC-FCLTY-ID          04930053
049500                                                                  04950049
049640             MOVE CN009-PRTR-ID          TO ASC-PRTR-ID           04964049
049650             MOVE CN009-DC-PRTD-AT       TO ASC-DC-PRTD-AT        04965049
049660             MOVE CN009-USER-ID          TO ASC-USER-ID           04966049
049700             MOVE 'UPD' TO  ASC-ACTION-SW                         04970048
049800             PERFORM 1120-PREPARE-LIST-ENTRY                      04980048
049900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04990048
050000             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   05000048
050100         END-IF                                                   05010048
050200     END-EVALUATE.                                                05020048
050300                                                                  05030048
050400*----------------------------------------------------------------*05040048
050500* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *05050048
050600* STORAGE QUEUE PASSED FROM THE LIST.                            *05060048
050700*----------------------------------------------------------------*05070048
050800 1120-PREPARE-LIST-ENTRY.                                         05080048
050900     MOVE CN010-MAX-ITEMS          TO ASC-SEL-SUB.                05090048
051000     MOVE ZERO                     TO ASC-SEL-ITEM.               05100048
051100     PERFORM 1130-GET-NEXT-RECORD.                                05110048
051200                                                                  05120048
051300*---------------------------------------------------------------- 05130048
051400*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*05140048
051500*---------------------------------------------------------------- 05150048
051600 1130-GET-NEXT-RECORD.                                            05160048
051700     ADD +1                        TO ASC-SEL-SUB.                05170048
051800                                                                  05180048
051900     SET ASC-UPDATE-TSQ TO TRUE.                                  05190048
052000                                                                  05200048
052100     IF  ASC-SEL-SUB > CN010-MAX-ITEMS                            05210048
052200         ADD +1                    TO ASC-SEL-ITEM                05220048
052300         MOVE +1                   TO ASC-SEL-SUB                 05230048
052400     END-IF.                                                      05240048
052500                                                                  05250048
052600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                05260048
052700         PERFORM 9100-READ-SEL-QUEUE                              05270048
052800         IF  CN010-ITEM (ASC-SEL-SUB) > ZERO                      05280048
052900             MOVE CN010-SCAC(ASC-SEL-SUB)        TO ASC-SCAC      05290071
052910             MOVE CN010-TRAILER-ID(ASC-SEL-SUB)  TO ASC-TRLR-ID   05291071
053000             MOVE CN010-SERIAL-NBR(ASC-SEL-SUB)                   05300049
053100                                             TO ASC-TRLR-SRL-NBR  05310049
053200             MOVE CN010-TRLR-LENGTH(ASC-SEL-SUB)                  05320072
053300                                             TO ASC-TRLR-length   05330072
054200             SET CN010-INQ (ASC-SEL-SUB) TO TRUE                  05420048
054300             PERFORM 9200-REWRITE-SEL-QUEUE                       05430048
054400         ELSE                                                     05440048
054500             SUBTRACT +1 FROM ASC-SEL-SUB                         05450048
054600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            05460048
054700             SET DP020-MSG-INFORMATIONAL                          05470048
054800                 PS-LIST-END       TO TRUE                        05480048
054900         END-IF                                                   05490048
055000     ELSE                                                         05500048
055100         SUBTRACT +1 FROM ASC-SEL-ITEM                            05510048
055200         MOVE CN010-MAX-ITEMS      TO ASC-SEL-SUB                 05520048
055300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            05530048
055400         SET DP020-MSG-INFORMATIONAL                              05540048
055500                 PS-LIST-END       TO TRUE                        05550048
055600     END-IF.                                                      05560048
055700                                                                  05570048
055800******************************************************************05580048
055900*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         05590048
056000*  PROCESSED.                                                     05600048
056100******************************************************************05610048
056200 1140-GET-PREV-RECORD.                                            05620048
056300     SUBTRACT +1 FROM ASC-SEL-SUB.                                05630048
056400                                                                  05640048
056500     IF  ASC-SEL-SUB < +1                                         05650048
056600         SUBTRACT +1 FROM ASC-SEL-ITEM                            05660048
056700         MOVE CN010-MAX-ITEMS      TO ASC-SEL-SUB                 05670048
056800     END-IF.                                                      05680048
056900                                                                  05690048
057000     IF  ASC-SEL-ITEM > ZERO                                      05700048
057100         PERFORM 9100-READ-SEL-QUEUE                              05710048
057200         IF  CN010-ITEM (ASC-SEL-SUB) > ZERO                      05720048
057210         IF  CN010-ITEM (ASC-SEL-SUB) > ZERO                      05721049
057220             MOVE CN010-SCAC(ASC-SEL-SUB)        TO ASC-SCAC      05722071
057221             MOVE CN010-TRAILER-ID(ASC-SEL-SUB)  TO ASC-TRLR-ID   05722171
057230             MOVE CN010-SERIAL-NBR(ASC-SEL-SUB)                   05723049
057240                                             TO ASC-TRLR-SRL-NBR  05724049
057241             MOVE CN010-TRLR-LENGTH(ASC-SEL-SUB)                  05724172
057242                                             TO ASC-TRLR-length   05724272
057250             SET CN010-INQ (ASC-SEL-SUB) TO TRUE                  05725049
058600         END-IF                                                   05860048
058700                                                                  05870048
058800         SET CN010-INQ (ASC-SEL-SUB) TO TRUE                      05880048
058900         PERFORM 9200-REWRITE-SEL-QUEUE                           05890048
059000     ELSE                                                         05900048
059100         MOVE +1                   TO ASC-SEL-ITEM                05910048
059200                                      ASC-SEL-SUB                 05920048
059300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            05930048
059400         SET DP020-MSG-INFORMATIONAL                              05940048
059500             PS-LIST-END             TO TRUE                      05950048
059600     END-IF.                                                      05960048
059700                                                                  05970048
059800*----------------------------------------------------------------*05980048
059900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *05990048
060000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *06000048
060100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *06010048
060200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *06020048
060300* FUNCTION KEYS CAN GET THIS FAR.                                *06030048
060400*----------------------------------------------------------------*06040048
060500 2000-PROCESS-PANEL.                                              06050048
060600                                                                  06060048
060700     EVALUATE TRUE                                                06070048
060800                                                                  06080048
060900         WHEN DP020-SRC-AID = DP016-CLEAR                         06090048
061000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06100048
061100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06110048
061200                                                                  06120048
061300*F5 REFRESH -                                                     06130048
061400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06140048
061600              SET  ASC-F2-CONFIRM-NO     TO  TRUE                 06160053
061700              PERFORM 4000-BUILD-INITIAL-PANEL                    06170048
061800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06180048
061900              PERFORM 3200-RESET-ATTRIBUTES                       06190048
063100                                                                  06310048
063200*F20-NEXT SEL                                                     06320048
063300         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             06330048
063400             MOVE DP020-INT-APPL-FORMAT-IND                       06340048
063500                                      TO ASC-INT-APPL-FORMAT-IND  06350048
063600             IF ASC-INT-APPL-FORMAT-IND = '2'                     06360048
063700               IF  ASC-USE-SELECTION-QUEUE                        06370048
063800                   PERFORM 1130-GET-NEXT-RECORD                   06380048
063900                   PERFORM 3000-EDIT-DATA-IN-COMMAREA             06390048
064000                   IF PS-LIST-END                                 06400048
064100                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       06410048
064200                       SET PS-NO-LIST-END TO TRUE                 06420048
064300                   ELSE                                           06430048
064400                       PERFORM 4000-BUILD-INITIAL-PANEL           06440048
064500                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       06450048
064600                       PERFORM 3200-RESET-ATTRIBUTES              06460048
064700                   END-IF                                         06470048
064800               ELSE                                               06480048
064900*                --- BOTTOM OF LIST ---                           06490048
065000                   MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER       06500048
065100                   SET DP020-MSG-INFORMATIONAL TO TRUE            06510048
065200               END-IF                                             06520048
065300           ELSE                                                   06530048
065400               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           06540048
065500               SET DP020-MSG-FATAL TO TRUE                        06550048
065600           END-IF                                                 06560048
065700                                                                  06570048
065800*F19-PREV SEL                                                     06580048
065900         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             06590048
066000             MOVE DP020-INT-APPL-FORMAT-IND                       06600048
066100                                      TO ASC-INT-APPL-FORMAT-IND  06610048
066200             IF ASC-INT-APPL-FORMAT-IND = '2'                     06620048
066300                IF  ASC-USE-SELECTION-QUEUE                       06630048
066400                   PERFORM 1140-GET-PREV-RECORD                   06640048
066500                   PERFORM 3000-EDIT-DATA-IN-COMMAREA             06650048
066600                   IF PS-LIST-END                                 06660048
066700                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       06670048
066800                       SET PS-NO-LIST-END TO TRUE                 06680048
066900                   ELSE                                           06690048
067000                       PERFORM 4000-BUILD-INITIAL-PANEL           06700048
067100                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       06710048
067200                       PERFORM 3200-RESET-ATTRIBUTES              06720048
067300                   END-IF                                         06730048
067400               ELSE                                               06740048
067500                   MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER       06750048
067600                   SET DP020-MSG-INFORMATIONAL TO TRUE            06760048
067700               END-IF                                             06770048
067800           ELSE                                                   06780048
067900               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           06790048
068000               SET DP020-MSG-FATAL TO TRUE                        06800048
068100           END-IF                                                 06810048
068200                                                                  06820048
068300         WHEN OTHER                                               06830048
068400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06840048
068500             PERFORM 3200-RESET-ATTRIBUTES                        06850048
068600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06860048
068700             IF PS-NO-ERROR                                       06870048
068800                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               06880048
068900                 PERFORM 2100-CHECK-FUNCTION-KEY                  06890048
069000                 IF PS-NO-ERROR                                   06900048
069100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06910048
069200                     SET DP030-CONTINUE-GO TO TRUE                06920048
069300                 ELSE                                             06930048
069400                     SET DP030-OVERRIDE-GO TO TRUE                06940048
069500                 END-IF                                           06950048
069600             ELSE                                                 06960048
069700                 SET DP030-OVERRIDE-GO TO TRUE                    06970048
069800             END-IF                                               06980048
069900     END-EVALUATE.                                                06990048
070000                                                                  07000048
070100*----------------------------------------------------------------*07010048
070200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *07020048
070300* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *07030048
070400* FROM THE CICS ARCHITECTURE API.                                *07040048
070500*----------------------------------------------------------------*07050048
070600 2100-CHECK-FUNCTION-KEY.                                         07060048
070700     EVALUATE TRUE                                                07070048
070800         WHEN DP020-SRC-AID = DP016-ENTER                         07080048
073400              SET PS-NO-ERROR       TO TRUE                       07340055
073500              MOVE SPACES           TO DP020-MSG-SEVERITY-IND     07350055
073600              MOVE ZEROES           TO DP020-MSG-NUMBER           07360055
074500              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 07450055
074700                                                                  07470055
074800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07480055
074810              PERFORM 3200-RESET-ATTRIBUTES                       07481061
074900                                                                  07490048
075000*-F02 = CONFIRM UPDATE                                            07500048
075100         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID)                   07510048
075200              AND ASC-F2-CONFIRM-YES                              07520048
075300             IF ASC-ACTION-SW = 'UPD'                             07530048
075310                 EVALUATE ASC-INT-APPL-FORMAT-IND                 07531065
075320                     WHEN PC-INTER-APPL-CRIT-SPEC-UPD             07532065
075330                          PERFORM 4005-CK-TYPE-CHANGED            07533066
075340                          PERFORM 5100-PROCESS-UPDATE             07534066
076810                     WHEN OTHER                                   07681065
076850                          PERFORM 9100-READ-SEL-QUEUE             07685066
076860                          PERFORM 4005-CK-TYPE-CHANGED            07686066
076870                          PERFORM 5100-PROCESS-UPDATE             07687066
076880                          SET CN010-UPD (ASC-SEL-SUB) TO TRUE     07688066
076890                          MOVE ASC-SCAC    TO CN010-SCAC          07689071
076891                                                     (ASC-SEL-SUB)07689166
076892                          MOVE ASC-TRLR-ID TO CN010-TRAILER-ID    07689271
076893                                                     (ASC-SEL-SUB)07689371
076894                          MOVE ASC-TRLR-SRL-NBR                   07689466
076895                                  TO CN010-SERIAL-NBR(ASC-SEL-SUB)07689566
076896                          MOVE ASC-TRLR-length                    07689672
076897                                 TO CN010-trlr-length(ASC-SEL-SUB)07689772
076898                          PERFORM 9200-REWRITE-SEL-QUEUE          07689866
076900                 END-EVALUATE                                     07690065
076910             END-IF                                               07691065
077000                                                                  07700048
098600                                                                  09860048
098700*-F15 = UPDATE TRAILER                                            09870048
098800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09880063
098900             SET ASC-F2-CONFIRM-NO TO TRUE                        09890048
098901                                                                  09890158
100810           IF  ASC-TRLR-LENGTH = ZEROES                           10081058
100900                 SET PS-ERROR                                     10090048
101000                     DP020-MSG-FATAL         TO TRUE              10100048
101100                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  10110048
101200                 MOVE DP015-UNP-ALP-BRT-OFF  TO CNLNGTHA          10120053
101300                 MOVE DP015-RED              TO CNLNGTHC          10130053
101400                 MOVE DP015-REVERSE          TO CNLNGTHH          10140053
101500                 MOVE -1                     TO CNLNGTHL          10150053
101600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10160048
101700           END-IF                                                 10170048
113125           IF  PS-NO-ERROR                                        11312548
113126                SET ASC-F2-CONFIRM-YES      TO TRUE               11312648
113127                SET PS-ERROR                                      11312764
113128                    ASC-UPDATE              TO TRUE               11312864
113129                SET DP020-MSG-FATAL         TO TRUE               11312964
113130                MOVE PC-TSYMSG-03808        TO DP020-MSG-NUMBER   11313064
113131                MOVE DP015-PRO-NOR-OFF      TO CNLNGTHA           11313164
113140                MOVE DP015-BLUE             TO CNLNGTHC           11314053
113150                MOVE -1                     TO CNLNGTHL           11315053
113160                SET DP030-SET-CURSOR-APPL-1 TO TRUE               11316048
113170           END-IF                                                 11317048
113180                                                                  11318048
117000         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID) AND               11700048
117100              ASC-F2-CONFIRM-NO                                   11710048
117200               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           11720048
117300               SET DP020-MSG-FATAL TO TRUE                        11730048
117400         WHEN OTHER                                               11740048
117500             SET DP013-NO-ROLLBACK                                11750048
117600                 DP013-XCTL-DISPLAY-RESTART                       11760048
117700                 DP013-CICS-ABEND      TO TRUE                    11770048
117800             MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         11780048
117900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11790048
118000                                   TO DP013-MESSAGE-TEXT (1)      11800048
118100             PERFORM DP013-0000-PROCESS-ABEND                     11810048
118200                                                                  11820048
118300     END-EVALUATE.                                                11830048
118400                                                                  11840048
118401                                                                  11840158
118520******************************************************************11852048
118600** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **11860048
118700** INTER-APPLICATION COMMAREA.                                  **11870048
118800******************************************************************11880048
118900 2110-PREPARE-INTER-APPL-COMM.                                    11890048
119000                                                                  11900048
119100     INITIALIZE CN008-INTER-APPL-COMMAREA.                        11910048
119200                                                                  11920048
119400     MOVE ASC-OPER-UNT-ID         TO CN008-OPER-UNT-ID.           11940053
119500     MOVE ASC-FCLTY-ID            TO CN008-FCLTY-ID.              11950053
119600     MOVE ASC-FCLTY-NME           TO CN008-FCLTY-NME.             11960053
119700     MOVE ASC-SCAC                TO CN008-SCAC.                  11970053
119800     MOVE ASC-SCAC-NAME           TO CN008-SCAC-NAME.             11980053
119900     MOVE ASC-TRLR-ID             TO CN008-TRLR-ID.               11990053
120000     MOVE ASC-TRLR-SRL-NBR        TO CN008-TRLR-SRL-NBR.          12000053
120100     MOVE ASC-PRINTER-ID          TO CN008-PRINTER-ID.            12010053
120200     MOVE ASC-TRLR-LENGTH         TO CN008-TRLR-LENGTH.           12020053
120700                                                                  12070048
120800*----------------------------------------------------------------*12080048
120900* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *12090048
121000* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *12100048
121100* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *12110048
121200* THIS PARAGRAPH DOES NOT USE TEMPORARY VARIABLES.               *12120048
121300*----------------------------------------------------------------*12130048
121400 2200-MOVE-SCREEN-TO-COMMAREA.                                    12140048
121500*TRAILER LENGTH                                                   12150051
121600         IF  CNLNGTHL > ZERO                                      12160051
121700             MOVE CNLNGTHI             TO ASC-TRLR-LENGTH         12170051
121900         ELSE                                                     12190048
122000             IF  CNLNGTHF = DP015-ERASE-EOF                       12200051
122100                 MOVE ZEROES           TO ASC-TRLR-LENGTH         12210051
122200             END-IF                                               12220048
122300         END-IF.                                                  12230051
122400                                                                  12240048
122500                                                                  12250051
127000*----------------------------------------------------------------*12700048
127100* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *12710048
127200* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *12720048
127300* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *12730048
127400*----------------------------------------------------------------*12740048
127500 3000-EDIT-DATA-IN-COMMAREA.                                      12750048
127600                                                                  12760048
132700     IF  PS-NO-ERROR                                              13270048
132800         IF  ASC-TRLR-LENGTH  >  SPACES                           13280053
132900             MOVE ASC-TRLR-LENGTH        TO DP010I-UNEDITED-FIELD 13290053
133000             MOVE LENGTH OF ASC-TRLR-LENGTH                       13300053
133100                                       TO DP010I-MAXIMUM-DIGITS   13310048
133200             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 13320048
133300             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              13330048
263455             CALL DP010I-NUMERIC-EDIT-ROUTINE                     13341075
263455                  USING DP010I-NUMERIC-EDIT-AREA                  13342075
133500             IF  DP010I-ERROR-DETECTED                            13350048
133600                 SET PS-ERROR                                     13360048
133700                     DP020-MSG-FATAL         TO TRUE              13370048
133800                MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER   13380048
133900                MOVE DP015-UNP-ALP-BRT-OFF  TO CNLNGTHA           13390053
134000                MOVE DP015-RED              TO CNLNGTHC           13400053
134100                MOVE DP015-REVERSE          TO CNLNGTHH           13410053
134200                MOVE -1                     TO CNLNGTHL           13420053
134300                MOVE +1                     TO CNLNGTHL           13430053
134500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               13450048
134600             ELSE                                                 13460048
134700                 MOVE DP010I-NUMERIC-FIELD TO ASC-TRLR-LENGTH-N   13470053
134800             END-IF                                               13480048
134900         END-IF                                                   13490048
135000     END-IF.                                                      13500048
135001                                                                  13500173
135010     EVALUATE TRUE                                                13501073
135020        WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               13502073
135040                                                                  13504073
135050        IF  PS-NO-ERROR                                           13505074
135051            IF  ASC-TRLR-LENGTH  >  SPACES                        13505174
135070                PERFORM 3090-VALIDATE-TRLR-LGTH                   13507074
135080                IF  PS-VALID-TRLR-LGTH                            13508074
135090                    CONTINUE                                      13509074
135091                ELSE                                              13509174
135092                    SET PS-ERROR                                  13509274
135093                        DP020-MSG-FATAL        TO TRUE            13509374
135094                    MOVE PC-TSYMSG-03552       TO DP020-MSG-NUMBER13509474
135095                    MOVE DP015-UNP-ALP-BRT-OFF TO CNLNGTHA        13509574
135096                    MOVE DP015-RED             TO CNLNGTHC        13509674
135097                    MOVE DP015-REVERSE         TO CNLNGTHH        13509774
135098                    MOVE -1                    TO CNLNGTHL        13509874
135099                    MOVE +1                    TO CNLNGTHL        13509974
135100                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           13510074
135110                END-IF                                            13511074
135193            END-IF                                                13519374
135194        END-IF                                                    13519474
135195     END-EVALUATE.                                                13519574
135200                                                                  13520073
135210                                                                  13521073
135400*----------------------------------------------------------------*13540073
135500*  CHECK THE TKRPRPM TABLE TO VERIFY THE TRAILER LENGTH          *13550073
135600*  ENTERED IS VALID.                                             *13560073
135700*----------------------------------------------------------------*13570073
135800 3090-VALIDATE-TRLR-LGTH.                                         13580073
135900     SET PS-NOT-VALID-TRLR-LGTH TO TRUE.                          13590073
136000     MOVE ASC-TRLR-LENGTH             TO PV-TRLR-LENGTH-NUM       13600073
136200                                                                  13620073
136300     EXEC SQL                                                     13630073
136400        SELECT  FUNC_TXT                                          13640073
136500          INTO  :KRPRPM-FUNC-TXT                                  13650073
136600          FROM  TKRPRPM                                           13660073
136700         WHERE  LOC_ID             = 90                           13670073
136800           AND  INTFC_SYS_CDE      = 'KHL'                        13680073
136900           AND  FUNC_PRC_STAT_CDE  = 'AC'                         13690073
137000           AND  SYS_PRC_FUNC_CDE   = 'CNTLNG'                     13700073
137100     END-EXEC.                                                    13710073
137200                                                                  13720073
137300     EVALUATE TRUE                                                13730073
137400         WHEN SQLCODE = +0                                        13740073
137410              IF PV-TRLR-LENGTH-CHAR = KRPRPM-FUNC-TXT (1:2)      13741073
137420                                OR KRPRPM-FUNC-TXT (4:2)          13742073
137430                                OR KRPRPM-FUNC-TXT (7:2)          13743073
137440                                OR KRPRPM-FUNC-TXT (10:2)         13744073
137450                                OR KRPRPM-FUNC-TXT (13:2)         13745073
137460                                OR KRPRPM-FUNC-TXT (16:2)         13746073
137470                                OR KRPRPM-FUNC-TXT (19:2)         13747073
137480                                OR KRPRPM-FUNC-TXT (22:2)         13748073
137490                 SET PS-VALID-TRLR-LGTH TO TRUE                   13749073
137491              END-IF                                              13749173
137492                                                                  13749273
137493         WHEN SQLCODE = +100                                      13749373
137494             SET PS-NOT-VALID-TRLR-LGTH TO TRUE                   13749473
137495                                                                  13749573
137496         WHEN SQLWARN0 NOT = SPACES                               13749673
137497         WHEN SQLCODE < +0                                        13749773
137498         WHEN SQLCODE > +0                                        13749873
137499             MOVE '3090-VALIDATE-TRLR-LGTH'                       13749973
137500                             TO DP013-PARAGRAPH                   13750073
137510             MOVE 'SELECT FUNC_TXT'                               13751073
137520                             TO DP013-MESSAGE-TEXT (1)            13752073
137530             MOVE DK-SCAC     TO DP013-MESSAGE-TEXT (2)           13753074
137540             MOVE SQLCA      TO DP013-SQLCA                       13754073
137550             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          13755073
137560             SET DP013-DB2-ABEND                                  13756073
137570                             TO TRUE                              13757073
137580             SET DP013-XCTL-DISPLAY-RESTART                       13758073
137590                             TO TRUE                              13759073
137591                                                                  13759173
137592             SET  PS-ERROR                                        13759273
137593              DP020-MSG-FATAL         TO TRUE                     13759373
137594         MOVE PC-TSYMSG-00005         TO DP020-MSG-NUMBER         13759473
137595         MOVE DP015-UNP-ALP-BRT-OFF   TO CNSCACA                  13759573
137596         MOVE DP015-RED               TO CNSCACC                  13759673
137597         MOVE DP015-REVERSE           TO CNSCACH                  13759773
137598         MOVE -1                      TO CNSCACL                  13759873
137599         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     13759973
137600                                                                  13760073
137610         PERFORM DP013-0000-PROCESS-ABEND                         13761073
137620     END-EVALUATE.                                                13762073
137630                                                                  13763073
137640                                                                  13764073
137700                                                                  13770049
160470*----------------------------------------------------------------*16047048
160480* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *16048048
160490* MAP.                                                           *16049048
160500*----------------------------------------------------------------*16050048
160600 3200-RESET-ATTRIBUTES.                                           16060048
160700     IF  PS-NO-ERROR                                              16070053
161000         MOVE DP015-UNP-ALP-NOR-OFF    TO CNLNGTHA                16100053
161200         MOVE DP015-GREEN              TO CNLNGTHC                16120053
161400         MOVE DP015-UNDERLINE          TO CNLNGTHH                16140053
162400         MOVE DP015-PRO-NOR-OFF        TO CNOPERA                 16240053
162410                                          CNOPDSA                 16241053
162420                                          CNSCACA                 16242053
162430                                          CNSCDSA                 16243053
162440                                          CNVEIDA                 16244053
162450                                          CNTRLRA                 16245053
162500         MOVE DP015-BLUE               TO CNOPERC                 16250053
162510                                          CNOPDSC                 16251053
162520                                          CNSCACC                 16252053
162530                                          CNSCDSC                 16253053
162540                                          CNVEIDC                 16254053
162550                                          CNTRLRC                 16255053
162600         MOVE DP015-HL-OFF             TO CNOPERH                 16260053
162610                                          CNOPDSH                 16261053
162620                                          CNSCACH                 16262053
162640                                          CNSCDSH                 16264053
162650                                          CNVEIDH                 16265053
162660                                          CNTRLRH                 16266053
162700         SET DP030-SET-CURSOR-APPL-1   TO TRUE                    16270053
162800         MOVE -1                       TO CNLNGTHL                16280053
165100     END-IF.                                                      16510048
165200                                                                  16520048
165300*----------------------------------------------------------------*16530048
165400*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *16540048
165500*    ENTRY.                                                      *16550048
165600*----------------------------------------------------------------*16560048
165700 4000-BUILD-INITIAL-PANEL.                                        16570048
165900     MOVE DP015-PRO-NOR-OFF       TO CNOPERA                      16590053
166000                                     CNOPDSA                      16600053
166100                                     CNSCACA                      16610053
166110                                     CNSCDSA                      16611053
166120                                     CNVEIDA                      16612053
166130                                     CNTRLRA.                     16613053
166200     MOVE DP015-BLUE              TO CNOPERC                      16620053
166300                                     CNOPDSC                      16630053
166400                                     CNSCACC                      16640053
166410                                     CNSCDSC                      16641053
166420                                     CNVEIDC                      16642053
166430                                     CNTRLRC.                     16643053
166500     MOVE DP015-HL-OFF            TO CNOPERH                      16650053
166600                                     CNOPDSH                      16660053
166610                                     CNSCACH                      16661053
166620                                     CNSCDSH                      16662053
166630                                     CNVEIDH                      16663053
166640                                     CNTRLRH.                     16664053
166800     MOVE -1                      TO CNLNGTHL.                    16680053
166900     SET DP030-SET-CURSOR-APPL-1  TO TRUE.                        16690053
168400                                                                  16840048
168603                                                                  16860368
168604*----------------------------------------------------------------*16860468
168605* CHECK TO SEE IF TRAILER LENGTH HAS CHANGED                      16860568
168606*----------------------------------------------------------------*16860668
168607 4005-CK-TYPE-CHANGED.                                            16860768
168608     MOVE ASC-SCAC           TO DK-SCAC.                          16860868
168609     MOVE ASC-TRLR-ID        TO DK-TRLR-ID.                       16860968
168610     MOVE ASC-TRLR-SRL-NBR   TO DK-TRLR-SRL-NBR.                  16861068
168611                                                                  16861168
168612     EXEC SQL                                                     16861268
168613         SELECT TRLR_SIZE_MU                                      16861368
168614           INTO :ASC-ORIG-TRLR-SIZE-MU                            16861468
168615           FROM TCNTRID                                           16861568
168616          WHERE SCAC_CDE       = :DK-SCAC                         16861668
168617            AND TRLR_ID        = :DK-TRLR-ID                      16861768
168618            AND TRLR_SRL_NBR   = :DK-TRLR-SRL-NBR                 16861868
168619     END-EXEC.                                                    16861968
168620                                                                  16862068
168621     EVALUATE TRUE                                                16862168
168622         WHEN SQLCODE = ZERO                                      16862268
168623              IF  ASC-ORIG-TRLR-SIZE-MU = ASC-TRLR-LENGTH-N       16862368
168624                  SET  PS-LENGTH-CHANGED-NO TO TRUE               16862468
168625              ELSE                                                16862568
168626                  SET  PS-LENGTH-CHANGED-YES TO TRUE              16862668
168630               END-IF                                             16863048
168631         WHEN SQLWARN0 NOT = SPACES                               16863148
168632         WHEN SQLCODE < +0                                        16863248
168633         WHEN SQLCODE > +0                                        16863348
168634             MOVE '4005-CK-TYPE-CHANGED      ' TO DP013-PARAGRAPH 16863448
168635             MOVE 'CHECK IF DOOR TYPE WAS CHANGED'                16863548
168636                                      TO DP013-MESSAGE-TEXT (1)   16863648
168637             MOVE SQLCA        TO DP013-SQLCA                     16863748
168638             MOVE 'TCNTRID '   TO DP013-DB2-TABLE-NAME (1)        16863849
168639             SET DP013-DB2-ABEND                                  16863948
168640                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16864048
168650             PERFORM DP013-0000-PROCESS-ABEND                     16865048
168651         END-EVALUATE.                                            16865148
168652                                                                  16865248
168653                                                                  16865348
213500*----------------------------------------------------------------*21350048
213600*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *21360048
213700*----------------------------------------------------------------*21370048
213800 4400-MOVE-COMMAREA-TO-SCREEN.                                    21380048
213900     MOVE ASC-OPER-UNT-ID          TO CNOPERO.                    21390051
214100     MOVE ASC-FCLTY-NME            TO CNOPDSO.                    21410051
214200     MOVE ASC-SCAC                 TO CNSCACO.                    21420051
214300     MOVE ASC-SCAC-NAME            TO CNSCDSO.                    21430051
214400     MOVE ASC-TRLR-ID              TO CNVEIDO.                    21440051
214500     MOVE ASC-TRLR-SRL-NBR         TO CNTRLRO.                    21450051
214700     MOVE ASC-TRLR-LENGTH          TO CNLNGTHO.                   21470051
215000                                                                  21500048
215100*------------------------------------------------------------     21510048
215200*  MOVE COMMAREA TO TEMP AREA                                     21520048
215300*------------------------------------------------------------     21530048
215400 4500-MOVE-COMMAREA-TO-TEMP.                                      21540048
215500     MOVE ASC-OPER-UNT-ID             TO PV-OPER-UNT-ID.          21550053
215600     MOVE ASC-FCLTY-ID                TO PV-FCLTY-ID.             21560053
215700     MOVE ASC-FCLTY-NME               TO PV-FCLTY-NME.            21570053
215800     MOVE ASC-SCAC                    TO PV-SCAC.                 21580053
215900     MOVE ASC-SCAC-NAME               TO PV-SCAC-NAME.            21590053
216000     MOVE ASC-TRLR-ID                 TO PV-TRLR-ID.              21600053
216100     MOVE ASC-TRLR-SRL-NBR            TO PV-TRLR-SRL-NBR.         21610053
216200     MOVE ASC-PRINTER-ID              TO PV-PRINTER-ID.           21620053
216300     MOVE ASC-TRLR-LENGTH             TO PV-TRLR-LENGTH.          21630053
216700                                                                  21670048
221200*----------------------------------------------------------------*22120048
221300* PROCESS TABLE UPDATES                                          *22130048
221400*----------------------------------------------------------------*22140048
221500 5100-PROCESS-UPDATE.                                             22150048
221600     PERFORM 7100-UPDATE-TCNTRID.                                 22160056
221610     PERFORM 5200-CAPTURE-DATA.                                   22161056
221700                                                                  22170048
221800     IF ASC-TCNTRID-UPDATED                                       22180049
221900        SET ASC-F2-CONFIRM-NO       TO TRUE                       22190048
222000        MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER                  22200048
222100        SET DP020-MSG-INFORMATIONAL TO TRUE                       22210048
223100        MOVE -1                      TO CNLNGTHL                  22310053
223200        SET DP030-SET-CURSOR-APPL-1  TO TRUE                      22320048
223300     END-IF.                                                      22330048
223400                                                                  22340048
223410                                                                  22341055
223500*---------------------------------------------------------------* 22350055
223600* CAPTURE WHEN THE TRAILER LENGTH HAS CHANGED                   * 22360055
223700*---------------------------------------------------------------* 22370055
223800 5200-CAPTURE-DATA.                                               22380055
223900                                                                  22390055
224000      add  1  to  pv-capture-cnt.                                 22400055
224100                                                                  22410055
224200      if  pv-capture-cnt  =  1                                    22420055
224300          PERFORM 5210-WFT-DAT-CNTL                               22430055
224400          PERFORM 5220-WFT-DAT-XFER                               22440055
224500      else                                                        22450055
224600          PERFORM 5220-WFT-DAT-XFER                               22460055
224700      end-if.                                                     22470055
224800                                                                  22480055
224900                                                                  22490055
225000 5210-WFT-DAT-CNTL.                                               22500055
225100                                                                  22510055
225200     CALL PC-RANDOM-PGM USING DFHEIBLK                            22520055
225300                              DFHCOMMAREA                         22530055
225400                              DP902-RANDNBR-ROUTINE-FIELDS.       22540055
225500                                                                  22550055
225600     move DP902-RANDOM-NUMBER     to PV-CAPTURE-RANDOM-NBR        22560055
225700                                                                  22570055
225800     EXEC SQL                                                     22580055
225900          SET :PV-RANDOM-TMST = CURRENT TIMESTAMP                 22590055
226000     END-EXEC.                                                    22600055
226100                                                                  22610055
226200     MOVE 'TRLRLGTH'               TO WFT00004-TRN-TYP-CDE        22620056
226300     MOVE PV-CAPTURE-RANDOM-NBR    TO WFT00004-PRC-GP-ID          22630055
226400     MOVE PV-RANDOM-TMST           TO WFT00004-PRC-CNTL-TMST      22640055
226500     MOVE 0                        TO WFT00004-STR-NBR            22650055
226600     MOVE 'READY'                  TO WFT00004-STAT-CDE           22660055
226700     MOVE PV-RANDOM-TMST           TO WFT00004-BEG-PRC-TMST       22670055
226800     MOVE PC-DEFAULT-TMST          TO WFT00004-END-PRC-TMST       22680055
226900     MOVE 0                        TO WFT00004-DAT-LOD-VER-NBR    22690055
227000                                                                  22700055
227100     EXEC SQL                                                     22710055
227200        INSERT INTO WFT_DAT_CNTL                                  22720055
227300               ( TRN_TYP_CDE                                      22730055
227400                ,PRC_GP_ID                                        22740055
227500                ,PRC_CNTL_TMST                                    22750055
227600                ,STR_NBR                                          22760055
227700                ,STAT_CDE                                         22770055
227800                ,BEG_PRC_TMST                                     22780055
227900                ,END_PRC_TMST                                     22790055
228000                ,DAT_LOD_VER_NBR)                                 22800055
228100        VALUES (:WFT00004-TRN-TYP-CDE                             22810055
228200              , :WFT00004-PRC-GP-ID                               22820055
228300              , :WFT00004-PRC-CNTL-TMST                           22830055
228400              , :WFT00004-STR-NBR                                 22840055
228500              , :WFT00004-STAT-CDE                                22850055
228600              , :WFT00004-BEG-PRC-TMST                            22860055
228700              , :WFT00004-END-PRC-TMST                            22870055
228710              , :WFT00004-DAT-LOD-VER-NBR)                        22871055
228720     END-EXEC.                                                    22872055
228730                                                                  22873055
228740         EVALUATE TRUE                                            22874055
228750             WHEN SQLCODE = ZERO                                  22875055
228760                 CONTINUE                                         22876055
228770             WHEN SQLWARN0 NOT = SPACES                           22877055
228780             WHEN SQLCODE < ZERO                                  22878055
228790             WHEN SQLCODE > ZERO                                  22879055
228791                                                                  22879155
228792             MOVE '5210-WFT-DAT-CNTL  '      TO DP013-PARAGRAPH   22879255
228793             MOVE 'WRITE HEADER TO WFT_DAT_CNTL'                  22879355
228794                                      TO DP013-MESSAGE-TEXT (1)   22879455
228795             MOVE SQLCA        TO DP013-SQLCA                     22879555
228796             MOVE 'WFT_DAT_CNTL      '  TO                        22879655
228797                                  DP013-DB2-TABLE-NAME (1)        22879755
228798             SET DP013-DB2-ABEND        to true                   22879855
228799                                                                  22879955
228800         END-EVALUATE.                                            22880055
228801                                                                  22880155
228802                                                                  22880255
228803 5220-WFT-DAT-XFER.                                               22880355
228817                                                                  22881755
228818     move spaces to PV-CAPTURE-RECORD.                            22881867
228819     MOVE ASC-OPER-UNT-ID          TO PV-capt-OPER-UNT-ID.        22881958
228820     MOVE DP020-USERID             TO PV-capt-user-id.            22882058
228821     MOVE ASC-SCAC                 TO PV-capt-SCAC.               22882158
228822     MOVE ASC-TRLR-ID              TO PV-capt-TRLR-ID.            22882258
228823     MOVE ASC-TRLR-SRL-NBR         TO PV-capt-TRLR-SRL-NBR.       22882358
228824     MOVE ASC-ORIG-TRLR-SIZE-MU    TO PV-capt-old-TRLR-LENGTH.    22882458
228825     MOVE ASC-TRLR-LENGTH-N        TO PV-capt-new-TRLR-LENGTH.    22882558
228826                                                                  22882656
228827     MOVE 'TRLRLGTH'               TO WFT00005-TRN-TYP-CDE        22882756
228828     MOVE PV-CAPTURE-RANDOM-NBR    TO WFT00005-PRC-GP-ID          22882855
228829     MOVE PV-RANDOM-TMST           TO WFT00005-PRC-CNTL-TMST      22882955
228830     MOVE PV-CAPTURE-CNT           TO WFT00005-PRC-LOD-SEQ-ID     22883055
228831     MOVE 'DETAIL'                 TO WFT00005-RDM-PRC-TYP-CDE    22883155
228832     MOVE LENGTH OF pv-capture-record                             22883256
228833                                   TO WFT00005-LOD-DAT-TXT-LEN    22883356
228834     MOVE pv-capture-record        TO WFT00005-LOD-DAT-TXT-TEXT   22883456
228835                                                                  22883556
228836     EXEC SQL                                                     22883656
228837        INSERT INTO WFT_dat_XFER                                  22883756
228838               ( TRN_TYP_CDE                                      22883856
228839                ,PRC_GP_ID                                        22883956
228840                ,PRC_CNTL_TMST                                    22884056
228841                ,PRC_LOD_SEQ_ID                                   22884156
228842                ,RDM_PRC_TYP_CDE                                  22884256
228843                ,LOD_DAT_TXT)                                     22884356
228844        VALUES (:WFT00005-TRN-TYP-CDE                             22884456
228845               ,:WFT00005-PRC-GP-ID                               22884556
228846               ,:WFT00005-PRC-CNTL-TMST                           22884656
228847               ,:WFT00005-PRC-LOD-SEQ-ID                          22884756
228848               ,:WFT00005-RDM-PRC-TYP-CDE                         22884856
228849               ,:WFT00005-LOD-DAT-TXT)                            22884956
228850     END-EXEC.                                                    22885056
228851                                                                  22885156
228852         EVALUATE TRUE                                            22885256
228853             WHEN SQLCODE = ZERO                                  22885356
228854                 CONTINUE                                         22885456
228855             WHEN SQLWARN0 NOT = SPACES                           22885556
228856             WHEN SQLCODE < ZERO                                  22885656
228857             WHEN SQLCODE > ZERO                                  22885756
228858                                                                  22885856
228859             MOVE '5220-WFT-DAT-XFER  '      TO DP013-PARAGRAPH   22885956
228860             MOVE 'WRITE detail TO WFT_DAT_xfer'                  22886056
228861                                      TO DP013-MESSAGE-TEXT (1)   22886156
228862             MOVE SQLCA        TO DP013-SQLCA                     22886256
228863             MOVE 'WFT_DAT_CNTL      '  TO                        22886356
228864                                  DP013-DB2-TABLE-NAME (1)        22886456
228865             SET DP013-DB2-ABEND        to true                   22886556
228866                                                                  22886656
228867         END-EVALUATE.                                            22886756
228868                                                                  22886856
228869                                                                  22886956
228870******************************************************************22887048
228900** UPDATE A ROW ON THE CONTROL DC DOOR TABLE                      22890048
229000******************************************************************22900048
229100 7100-UPDATE-TCNTRID.                                             22910049
229310     MOVE ASC-SCAC           TO DK-SCAC.                          22931049
229330     MOVE ASC-TRLR-ID        TO DK-TRLR-ID.                       22933049
229340     MOVE ASC-TRLR-SRL-NBR   TO DK-TRLR-SRL-NBR.                  22934049
229350                                                                  22935049
229360     MOVE ASC-TRLR-LENGTH    TO CNTRID-TRLR-SIZE-MU.              22936049
229400                                                                  22940048
230300     EXEC SQL                                                     23030049
230400          UPDATE TCNTRID                                          23040049
230500             SET TRLR_SIZE_MU   = :CNTRID-TRLR-SIZE-MU            23050049
231100            WHERE SCAC_CDE       = :DK-SCAC                       23110049
231200              AND TRLR_ID        = :DK-TRLR-ID                    23120049
231210              AND TRLR_SRL_NBR   = :DK-TRLR-SRL-NBR               23121049
231300      END-EXEC.                                                   23130049
231400                                                                  23140048
231500      EVALUATE TRUE                                               23150049
231600          WHEN SQLCODE = +0                                       23160049
231700               SET ASC-TCNTRID-UPDATED TO TRUE                    23170049
231800          WHEN SQLWARN0 NOT = SPACES                              23180049
231900          WHEN SQLCODE < +0                                       23190049
232000          WHEN SQLCODE > +0                                       23200049
232100               MOVE '7100-UPDATE-TCNTRID' TO DP013-PARAGRAPH      23210049
232200               MOVE 'ERROR UPDATING THE DC DOOR TABLE'            23220049
232300                                 TO DP013-MESSAGE-TEXT (1)        23230049
232400               MOVE SQLCA        TO DP013-SQLCA                   23240049
232500               MOVE 'TCNTRID'    TO DP013-DB2-TABLE-NAME (1)      23250049
232600               SET DP013-DB2-ABEND                                23260049
232700                   DP013-XCTL-DISPLAY-RESTART TO TRUE             23270049
232800               PERFORM DP013-0000-PROCESS-ABEND                   23280049
232900     END-EVALUATE.                                                23290049
233100                                                                  23310048
234300                                                                  23430048
234400*----------------------------------------------------------------*23440048
234500* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *23450048
234600*----------------------------------------------------------------*23460048
234700 9100-READ-SEL-QUEUE.                                             23470048
234800     EXEC CICS                                                    23480048
234900         READQ TS                                                 23490048
235000             QUEUE (ASC-SEL-QUEUE-NAME)                           23500048
235100             INTO  (CN010-SELECT-RECORD)                          23510048
235200             ITEM  (ASC-SEL-ITEM)                                 23520048
235300             RESP  (PV-CICS-RESPONSE)                             23530048
235400     END-EXEC.                                                    23540048
235500                                                                  23550048
235600     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       23560048
235700         CONTINUE                                                 23570048
235800     ELSE                                                         23580048
235900         SET DP013-LOGIC-ABEND                                    23590048
236000             DP013-NO-ROLLBACK     TO TRUE                        23600048
236100         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            23610048
236200         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   23620048
236300                                   TO DP013-MESSAGE-TEXT (1)      23630048
236400         PERFORM DP013-0000-PROCESS-ABEND                         23640048
236500     END-IF.                                                      23650048
236600                                                                  23660048
236700*----------------------------------------------------------------*23670048
236800* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *23680048
236900*----------------------------------------------------------------*23690048
237000 9200-REWRITE-SEL-QUEUE.                                          23700048
237100     EXEC CICS                                                    23710048
237200          WRITEQ TS                                               23720048
237300              QUEUE  (ASC-SEL-QUEUE-NAME)                         23730048
237400              FROM   (CN010-SELECT-RECORD)                        23740048
237500              ITEM   (ASC-SEL-ITEM)                               23750048
237600              RESP   (PV-CICS-RESPONSE)                           23760048
237700              REWRITE                                             23770048
237800     END-EXEC.                                                    23780048
237900                                                                  23790048
238000     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   23800048
238100         SET DP013-CICS-ABEND                                     23810048
238200             DP013-NO-ROLLBACK     TO TRUE                        23820048
238300         MOVE '9200-REWRITE-SEL-QUEUE'  TO DP013-PARAGRAPH        23830048
238400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   23840048
238500                                   TO DP013-MESSAGE-TEXT (1)      23850048
238600         PERFORM DP013-0000-PROCESS-ABEND                         23860048
238700     END-IF.                                                      23870048
238800                                                                  23880048
238900     COPY DPPD013.                                                23890048
239000*----------------------------------------------------------------*23900048
239100*    ABEND PROCESSOR MODULE                                      *23910048
239200*----------------------------------------------------------------*23920048
