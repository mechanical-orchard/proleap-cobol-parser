000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000400 PROGRAM-ID.    RCKCS280.                                         00040099
000500 AUTHOR.        MARY SARDINA - KOHLS.                             00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
000700 DATE-WRITTEN.  04/96.                                            00070099
000800 DATE-COMPILED.                                                   00080099
000900                                                                  00090099
001000*---------------------------------------------------------------* 00100099
001100* E280 -  STORE ADJUSTMENTS                                       00110099
001200*                                                                 00120099
001300* RCKCS280 - THIS PROGRAM WILL BE USED FOR A SCREEN WHICH WILL  * 00130099
001400*            LIST LINES FOR A SELECTED STORE WITHIN A RECEIVER  * 00140099
001500*            ASSOCIATED TO THE ADJUSTMENT OF A VERIFIED POSTED  * 00150099
001600*            RECEIVER.                                          * 00160099
001700*                                                               * 00170099
001800*---------------------------------------------------------------*C00180099
001900* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00190099
001910* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00191099
001920* MAKING THE CALL DYNAMIC VS STATIC.                              00192099
001930*---------------------------------------------------------------* 00193099
002000 ENVIRONMENT DIVISION.                                            00200099
002200 DATA DIVISION.                                                   00220099
002300                                                                  00230099
002400 WORKING-STORAGE SECTION.                                         00240099
002500                                                                  00250099
002510 01  PA-PROGRAM-ACCUMULATORS.                                     00251099
002520     05  PA-FCSE-QTY                  PIC S9(9) VALUE +0.         00252099
002530     05  PA-ODD-QTY                   PIC S9(9) VALUE +0.         00253099
002540     05  PA-TOT-QTY                   PIC S9(9) VALUE +0.         00254099
002550     05  PA-UPDATE-TO-QTY             PIC S9(9) VALUE +0.         00255099
002560     05  PA-UPDATE-FROM-QTY           PIC S9(9) VALUE +0.         00256099
002570     05  PA-UPDATE-DIFF-QTY           PIC S9(9) VALUE +0.         00257099
002580                                                                  00258099
002600 01  PC-PROGRAM-CONSTANTS.                                        00260099
002700     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00270099
002800                                                    'RC280A  '.   00280099
002900     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00290099
003000                                                    'RCKM280 '.   00300099
003100     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00310099
003200                                                    'RCKCS280'.   00320099
003300     05  PC-TMKCS520                    PIC  X(08)  VALUE         00330099
003400                                                    'TMKCS520'.   00340099
003500     05  PC-AUDIT-RTN                 PIC X(08) VALUE 'RCKCS290'. 00350099
003600     05  PC-AUDIT-RTN-LENGTH          PIC S9(04) VALUE +300       00360099
003700                                                    COMP SYNC.    00370099
003800     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00380099
003900     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00390099
004000     05  PC-TRB-QUEUE-SEQ               PIC  9(01)  VALUE 3.      00400099
004010     05  PC-VRFY-ADJ-QUEUE-SEQ          PIC  9(01)  VALUE 6.      00401099
004100     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00410099
004200     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00420099
004300                                                    COMP SYNC.    00430099
004400     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00440099
004500                                                    COMP SYNC.    00450099
004600     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00460099
004700                                                    +1000000      00470099
004800                                                    COMP-3.       00480099
004900     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00490099
005000                                                    COMP SYNC.    00500099
005100     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00510099
005200                                                    COMP-3.       00520099
005210*----------------------------------------------------------------*00521099
005220* INCLUDED NEW CONSTANTS PC-000 AND PC-999.          WR # 21361  *00522099
005230*----------------------------------------------------------------*00523099
005240     05  PC-000                         PIC X(03)   VALUE '000'.  00524099
005250     05  PC-999                         PIC X(03)   VALUE '999'.  00525099
005260*----------------------------------------------------------------*00526099
005270* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *00527099
005280*----------------------------------------------------------------*00528099
005300     05  PC-9999                        PIC S9(04)  VALUE 9999    00530099
005400                                                    COMP.         00540099
005500     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00550099
005600     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00560099
005700     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00570099
005800     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00580099
005900     05  PC-01                          PIC  X(02)  VALUE '01'.   00590099
006000     05  PC-01-COMP                     PIC S9(4)   COMP VALUE 1. 00600099
006100     05  PC-4                           PIC  9(01)  VALUE 4.      00610099
006200     05  PC-5                           PIC  9(01)  VALUE 5.      00620099
006300     05  PC-N                           PIC  X(01)  VALUE 'N'.    00630099
006400     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    00640099
006500     05  PC-A                           PIC  X(01)  VALUE 'A'.    00650099
006600     05  PC-I                           PIC  X(01)  VALUE 'I'.    00660099
006700     05  PC-J                           PIC  X(01)  VALUE 'J'.    00670099
006800     05  PC-M                           PIC  X(01)  VALUE 'M'.    00680099
006900     05  PC-W                           PIC  X(01)  VALUE 'W'.    00690099
007000     05  PC-AC                          PIC  X(02)  VALUE 'AC'.   00700099
007100     05  PC-CA                          PIC  X(02)  VALUE 'CA'.   00710099
007200     05  PC-CB                          PIC  X(02)  VALUE 'CB'.   00720099
007300     05  PC-CM                          PIC  X(02)  VALUE 'CM'.   00730099
007400     05  PC-VE                          PIC  X(02)  VALUE 'VE'.   00740099
007410     05  PC-DISPLAY-PO                PIC 9(8)   VALUE ZEROS.     00741099
007420     05  PC-DISPLAY-RCVR              PIC 9(8)   VALUE ZEROS.     00742099
007430     05  PC-DISPLAY-LINE              PIC 9(8)   VALUE ZEROS.     00743099
007440     05  PC-DISPLAY-OPER              PIC 9(4)   VALUE ZEROS.     00744099
007450     05  PC-DISPLAY-SQL-CODE          PIC 9999-  VALUE ZEROS.     00745099
007460     05  PC-DISPLAY-CICS-RESP         PIC 999999999-              00746099
007470                                                 VALUE ZEROS.     00747099
007500                                                                  00750099
007600     05  PC-TSYMSG-NUMBERS.                                       00760099
007700         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00770099
007800         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00780099
007900         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  00790099
008000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00800099
008100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00810099
008200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00820099
008300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00830099
008400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00840099
008500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00850099
008600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00860099
008700         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  00870099
008800         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00880099
008900         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00890099
009000         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00900099
009100         10  PC-TSYMSG-00223            PIC  9(05)  VALUE 00223.  00910099
009200         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00920099
009300         10  PC-TSYMSG-00463            PIC  9(05)  VALUE 00463.  00930099
009400         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  00940099
009500         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  00950099
009600         10  PC-TSYMSG-01264            PIC 9(5)  VALUE 01264.    00960099
009700*            ADJUSTMENT WILL CREATE PACK-BY-STORE OVERAGE,        00970099
009800*            PRESS F2 TO CONFIRM                                  00980099
009900         10  PC-TSYMSG-01265            PIC 9(5)  VALUE 01265.    00990099
010000*            ADJUSTMENTS NOT UPDATED - FAILED TO PRESS F2 TO      01000099
010100*            CONFIRM UPDATES                                      01010099
010110         10  PC-TSYMSG-02875          PIC 9(05)  VALUE 02875.     01011099
010120*            PROBLEM ENCOUNTED WITH UNITS WORKED PROCESSING -     01012099
010130*            CONTACT HELP DESK                                    01013099
010200*                                                                 01020099
010300 01  PS-PROGRAM-SWITCHES.                                         01030099
010400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01040099
010500         88  PS-NO-ERROR                            VALUE 'Y'.    01050099
010600         88  PS-ERROR                               VALUE 'N'.    01060099
010700     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01070099
010800         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01080099
010900         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01090099
011000     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01100099
011100         88  PS-DONE                                VALUE 'Y'.    01110099
011200         88  PS-NOT-DONE                            VALUE 'N'.    01120099
011300     05  PS-STORE-REC-SW                PIC  X(01)  VALUE 'N'.    01130099
011400         88  PS-STORE-REC                           VALUE 'Y'.    01140099
011500         88  PS-NO-STORE-REC                        VALUE 'N'.    01150099
011600     05  PS-DATA-OK-SW                  PIC  X(01)  VALUE 'N'.    01160099
011700         88  PS-DATA-OK                             VALUE 'Y'.    01170099
011800         88  PS-DATA-NOT-OK                         VALUE 'N'.    01180099
011900     05  PS-VERIFY-SW                   PIC  X(01)  VALUE 'N'.    01190099
012000         88  PS-CAN-VERIFY                          VALUE 'Y'.    01200099
012100         88  PS-CANT-VERIFY                         VALUE 'N'.    01210099
012200     05  PS-RECITM-UPDATE-SW            PIC  X(01)  VALUE 'N'.    01220099
012300         88  PS-RECITM-UPDATED                      VALUE 'Y'.    01230099
012400         88  PS-RECITM-NOT-UPDATED                  VALUE 'N'.    01240099
012500     05  PS-ALL-LINES-PROTECTED-SW      PIC  X(01)  VALUE 'N'.    01250099
012600         88  PS-ALL-LINES-PROTECTED                 VALUE 'Y'.    01260099
012700         88  PS-ALL-LINES-NOT-PROTECTED             VALUE 'N'.    01270099
012800     05  PS-UPDATE-SW                 PIC  X    VALUE 'N'.        01280099
012900         88  PS-NO-UPDATES-DONE                 VALUE 'N'.        01290099
013000         88  PS-UPDATES-DONE                    VALUE 'Y'.        01300099
013100     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        01310099
013200         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        01320099
013300         88  PS-NEXT-SCREEN                     VALUE 'Y'.        01330099
013400     05  PS-TABLE-LOADED-SW           PIC X.                      01340099
013500         88  PS-TABLE-LOADED                    VALUE 'Y'.        01350099
013600         88  PS-TABLE-NOT-LOADED                VALUE 'N'.        01360099
013700     05  PS-EOT-TRB-SW                PIC X.                      01370099
013800         88  PS-EOT-TRB-TABLE                   VALUE 'Y'.        01380099
013900         88  PS-NOT-EOT-TRB-TABLE               VALUE 'N'.        01390099
013910     05  PS-UNITS-WORKED-ERROR-SW     PIC X(01)  VALUE 'N'.       01391099
013920         88  PS-UNITS-WORKED-ERROR               VALUE 'Y'.       01392099
013930         88  PS-NO-UNITS-WORKED-ERROR            VALUE 'N'.       01393099
013940     05  PS-FIRST-TIME-UPDATE-SW      PIC X(01)  VALUE 'Y'.       01394099
013950         88 PS-FIRST-TIME-UPDATE                 VALUE 'Y'.       01395099
013960         88 PS-NOT-FIRST-TIME-UPDATE             VALUE 'N'.       01396099
013970*----------------------------------------------------------------*01397099
013980*  INCLUDED PROGRAM SWITCHES FOR XLKUT001       **   WR # 21361  *01398099
013990*----------------------------------------------------------------*01399099
013991     05  PS-CALL-API-SW               PIC  X     VALUE 'N'.       01399199
013992         88  PS-CALL-API-NO                      VALUE 'N'.       01399299
013993         88  PS-CALL-API-YES                     VALUE 'Y'.       01399399
013994*----------------------------------------------------------------*01399499
013995* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01399599
013996*----------------------------------------------------------------*01399699
014000     05  PC-TRBL-ALREADY-EXISTS-MSG     PIC  X(56)  VALUE         01400099
014100       'NNNNN-I-REQUESTED TRBL ALREADY EXISTS FOR PO OR PO LINE'. 01410099
014200*                                                                 01420099
014300 01  PV-PROGRAM-VARIABLES.                                        01430099
014400     05  PV-SUB                         PIC S9(04)  VALUE +0      01440099
014500                                                    COMP SYNC.    01450099
014600     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01460099
014700                                                    COMP SYNC.    01470099
014800     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      01480099
014900                                                    COMP SYNC.    01490099
015000     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01500099
015100                                                    COMP-3.       01510099
015200     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01520099
015300                                                    COMP-3.       01530099
015400     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01540099
015500                                                    COMP-3.       01550099
015600     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01560099
015700                                                    COMP-3.       01570099
015800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01580099
015900                                                    COMP-3.       01590099
016000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01600099
016100                                                    COMP-3.       01610099
016200     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01620099
016300                                                    COMP-3.       01630099
016400     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01640099
016500                                                    COMP SYNC.    01650099
016600     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01660099
016700                                                    COMP SYNC.    01670099
016710     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 01671099
016720     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 01672099
016730     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01673099
016740                                                     COMP SYNC.   01674099
016750     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     01675099
016760                                                    COMP SYNC.    01676099
016800     05  PV-ITEM                        PIC S9(04)  VALUE +0      01680099
016900                                                    COMP SYNC.    01690099
016910     05  PV-VRFY-ITEM                   PIC S9(4) VALUE ZERO      01691099
016920                                                    COMP SYNC.    01692099
017000     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01700099
017100                                                    COMP SYNC.    01710099
017200     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01720099
017300                                                    COMP SYNC.    01730099
017400     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01740099
017500                                                    COMP SYNC.    01750099
017600     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01760099
017700                                                    COMP SYNC.    01770099
017800     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01780099
017900                                                    COMP SYNC.    01790099
018000     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01800099
018100                                                    COMP SYNC.    01810099
018200     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01820099
018300                                                    COMP SYNC.    01830099
018400     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01840099
018500                                                    COMP SYNC.    01850099
018600     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01860099
018700                                                    COMP SYNC.    01870099
018800     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01880099
018900                                                    COMP SYNC.    01890099
019000     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01900099
019100                                                    COMP SYNC.    01910099
019200     05  PV-NBR-FALLOUTS                PIC S9(05)  VALUE ZERO    01920099
019300                                                    COMP-3.       01930099
019400     05  PV-NBR-TO-CORRECT              PIC S9(05)  VALUE ZERO    01940099
019500                                                    COMP-3.       01950099
019600     05  PV-HOLD-AREA-NBR               PIC S9(08)  VALUE ZERO    01960099
019700                                                    COMP SYNC.    01970099
019800     05  PV-START-ITEM-REQUEST          PIC  X(05).               01980099
019900     05  PV-DB2-COUNT                   PIC S9(9)   VALUE +0      01990099
020000                                                    COMP-3.       02000099
020100                                                                  02010099
020110*----------------------------------------------------------------*02011099
020111*                                          ** WR # 21361.        *02011199
020112* COMMENTED OUT VARIABLE - PV-DISPLAY-SKU.                       *02011299
020120* CHANGED THE STRUCTURE OF PV-CLASS-SKU. ADDED NEW VARIABLE      *02012099
020130* PV-TEMP-SEQ-NBR.                                               *02013099
020140*----------------------------------------------------------------*02014099
020200     05  PV-DISPLAY-SKU.                                          02020099
020300         10  PV-DS-DEPT-NBR             PIC  X(03).               02030099
020400         10  FILLER                     PIC  X(01)  VALUE '-'.    02040099
020500         10  PV-DS-CL-NBR               PIC  X(02).               02050099
020600         10  FILLER                     PIC  X(01)  VALUE '-'.    02060099
020700         10  PV-DS-SEQ-NBR              PIC  X(03).               02070099
020800*                                                                 02080099
021210     05  PV-CLASS-SKU.                                            02121099
021220         10  PV-CS-CLASS                PIC X(02).                02122099
021230         10  FILLER                     PIC X(01)   VALUE SPACE.  02123099
021240         10  PV-CS-SKU                  PIC X(08).                02124099
021260*----------------------------------------------------------------*02126099
021270*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        02127099
021280*----------------------------------------------------------------*02128099
021300     05  PV-WORK-QTY-X.                                           02130099
021400         10  PV-WORK-QTY                PIC 9(05).                02140099
021500     05  PV-ENT-ID                      PIC 9(08).                02150099
021600     05  PV-DB2-CURRENT-TMST            PIC X(26).                02160099
021700     05  PV-RCPT-DISTR-UPD-CDE          PIC X(01).                02170099
021800     05  PV-CURRENT-TIMESTAMP           PIC X(26).                02180099
021900     05  PV-NOTIF-NBR                   PIC S9(9) VALUE ZERO      02190099
022000                                                COMP SYNC.        02200099
022100     05  PV-CYC-ADJ-NBR                 PIC S9(9) VALUE ZERO      02210099
022200                                                COMP SYNC.        02220099
022300     05  PV-NOTIF-BEF                   PIC S9(9) VALUE ZERO      02230099
022400                                                COMP SYNC.        02240099
022500     05  PV-CYC-ADJ-BEF                 PIC S9(9) VALUE ZERO      02250099
022600                                                COMP SYNC.        02260099
022820     05  PV-CURR-OPER-UNT-ID          PIC S9(4)  COMP             02282099
022830                                                 VALUE ZERO.      02283099
022840     05  PV-XLT00010-TYPE-CODE        PIC X(2)   VALUE SPACES.    02284099
022841         88  PV-XLT00010-TYPE-DC                 VALUE 'DC'.      02284199
022850     05  PV-DISPLAY-NO-ZERO           PIC Z(5).                   02285099
022860     05  PV-DISPLAY-ZERO              PIC Z(4)9.                  02286099
022870     05  PV-PCKCS756                  PIC X(08)  VALUE 'PCKCS756'.02287099
022880     05  PV-TMST                      PIC X(26).                  02288099
022890     05  FILLER REDEFINES PV-TMST.                                02289099
022891         10  PV-CCYY                  PIC X(04).                  02289199
022892         10  FILLER                   PIC X(01).                  02289299
022893         10  PV-MM                    PIC X(02).                  02289399
022894         10  FILLER                   PIC X(01).                  02289499
022895         10  PV-DD                    PIC X(02).                  02289599
022896         10  FILLER                   PIC X(01).                  02289699
022897         10  PV-HH                    PIC X(02).                  02289799
022898         10  FILLER                   PIC X(01).                  02289899
022899         10  PV-MIN                   PIC X(02).                  02289999
022900         10  FILLER                   PIC X(01).                  02290099
022901         10  PV-SEC                   PIC X(02).                  02290199
022902         10  FILLER                   PIC X(01).                  02290299
022903         10  FILLER                   PIC X(06).                  02290399
022904                                                                  02290499
022910 01  MSG-QUEUE-ITEM.                                              02291099
023000     05  FILLER                       PIC X(11)  VALUE            02300099
023100         'QUEUE NAME '.                                           02310099
023200     05  MSG-QUEUE-NAME               PIC X(08).                  02320099
023300     05  FILLER                       PIC X(14)  VALUE            02330099
023400         '  ITEM NUMBER '.                                        02340099
023500     05  MSG-SEL-ITEM                 PIC 9(04).                  02350099
023600                                                                  02360099
023700 01  MSG1-PO-REC.                                                 02370099
023800     05  FILLER                       PIC X(07)  VALUE            02380099
023900         'PO NBR '.                                               02390099
024000     05  MSG1-PO-NBR                  PIC 9(09).                  02400099
024100     05  FILLER                       PIC X(11)  VALUE            02410099
024200         '  REC SEQ  '.                                           02420099
024300     05  MSG1-REC-SEQ-NBR-N           PIC 9(09).                  02430099
024400     05  FILLER                       PIC X(12)  VALUE            02440099
024500         '  OPER UNIT '.                                          02450099
024600     05  MSG1-OPER-UNT-ID             PIC X(04).                  02460099
024700     05  FILLER                       PIC X(11)  VALUE            02470099
024800         '  FACILITY '.                                           02480099
024900     05  MSG1-FACILITY-ID             PIC X(04).                  02490099
025000                                                                  02500099
025100*----------------------------------------------------------------*02510099
025200*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.    *02520099
025300*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE            *02530099
025400*   APPLICATION-SPECIFIC COMMAREA.                               *02540099
025500*----------------------------------------------------------------*02550099
025510*----------------------------------------------------------------*02551099
025520*                                                **   WR # 21361 *02552099
025530* CHANGE THE STRUCTURE OF LQW TO MATCH WITH ASC STRUCTURE        *02553099
025540*----------------------------------------------------------------*02554099
025600 01  LQW-LIST-QUEUE-WORK-AREA.                                    02560099
025700     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02570099
025800     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           02580099
025900                                        INDEXED BY LQW-IDX.       02590099
026000         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02600099
026100         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02610099
026200         10  LQW-SELECTED-SW            PIC  X(01).               02620099
026300             88  LQW-SELECT                         VALUE 'S'.    02630099
026400             88  LQW-DESELECT                       VALUE ' '.    02640099
026500         10  LQW-UPDATE-SW              PIC  X(01).               02650099
026600             88  LQW-UPDATE-YES                    VALUE 'Y'.     02660099
026700             88  LQW-UPDATE-NO                     VALUE 'N'.     02670099
026800         10  LQW-ACTION                 PIC  X(03).               02680099
026900             88  LQW-UPDATE                         VALUE 'UPD'.  02690099
027000             88  LQW-ERROR                          VALUE 'ERR'.  02700099
027100         10  LQW-ADJ-QTY                PIC  X(05).               02710099
027200         10  LQW-ADJ-QTY-N REDEFINES LQW-ADJ-QTY                  02720099
027300                                        PIC 9(05).                02730099
027400         10  LQW-PO-LNE-NBR             PIC S9(09)  COMP.         02740099
027510         10  LQW-CLASS-SKU              PIC  X(11).               02751099
027600         10  LQW-PCKSLP-ITM-QTY         PIC S9(05).               02760099
027700         10  LQW-ACTUAL-ITM-QTY         PIC S9(05).               02770099
027800         10  LQW-VERIFY-ITM-QTY         PIC S9(05).               02780099
027900         10  LQW-PACK-BY-ST-OVERAGE-SW                            02790099
028000                                        PIC X(01).                02800099
028100             88  LQW-PACK-BY-ST-OVERAGE                           02810099
028200                                        VALUE 'Y'.                02820099
028300             88  LQW-NO-PACK-BY-ST-OVERAGE                        02830099
028400                                        VALUE 'N'.                02840099
028500*DC-XXX                                                           02850099
028600         10  LQW-PURITM-UNT-QTY         PIC S9(09)  COMP.         02860099
028700         10  LQW-PURITM-STATUS-CDE      PIC  X(02).               02870099
028800         10  LQW-PURCHS-STATUS-CDE      PIC  X(02).               02880099
028900*DC-XXX                                                           02890099
028910*----------------------------------------------------------------*02891099
028920*   CHANGES MADE FOR WR # 21361 ENDS HERE.                       *02892099
028930*----------------------------------------------------------------*02893099
029000/                                                                 02900099
029100*---------------------------------------------------------------* 02910099
029200*    RECORD LAYOUT FOR THE SELECTION TEMP STORAGE QUEUE.        * 02920099
029300*---------------------------------------------------------------* 02930099
029400                                                                  02940099
029500     COPY RCWS026.                                                02950099
029600                                                                  02960099
029700     COPY RCWS031.                                                02970099
029710                                                                  02971099
029720******************************************************************02972099
029730*  TEMPORARY STORAGE QUEUE - STORE UNIT ADJUSTMENTS TO BE SENT    02973099
029740*  TO RMS PO BY PCKCS759.                                         02974099
029750******************************************************************02975099
029760     COPY PCWS241.                                                02976099
029800                                                                  02980099
029900/                                                                 02990099
029910*----------------------------------------------------------------*02991099
029920*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE  WR # 21361  *02992099
029930*----------------------------------------------------------------*02993099
029940     COPY XLWS001.                                                02994099
029950*----------------------------------------------------------------*02995099
029960* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *02996099
029970*----------------------------------------------------------------*02997099
030000*---------------------------------------------------------------* 03000099
030100*    MAP LAYOUT                                                 * 03010099
030200*---------------------------------------------------------------* 03020099
030300                                                                  03030099
030400     COPY RCKM280.                                                03040099
030500*                                                                 03050099
030510*----------------------------------------------------------------*03051099
030520*                                                    WR # 21361  *03052099
030530* CHANGED THE STRUCTURE OF MR-SKU FROM X(06) TO X(11)            *03053099
030540*----------------------------------------------------------------*03054099
030600 01  MR-OCCURS-LAYOUT                   REDEFINES  RC280AO.       03060099
030700     05  FILLER                         PIC X(136).               03070099
030800     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          03080099
030900         10  MR-SELECT-L                PIC S9(04) COMP.          03090099
031000         10  MR-SELECT-A                PIC  X(01).               03100099
031100         10  MR-SELECT-C                PIC  X(01).               03110099
031200         10  MR-SELECT-H                PIC  X(01).               03120099
031300         10  MR-SELECT-I                PIC  X(01).               03130099
031400                                                                  03140099
031500         10  MR-ACTION-L                PIC S9(04) COMP.          03150099
031600         10  MR-ACTION-A                PIC  X(01).               03160099
031700         10  MR-ACTION-C                PIC  X(01).               03170099
031800         10  MR-ACTION-H                PIC  X(01).               03180099
031900         10  MR-ACTION-I                PIC  X(03).               03190099
032000                                                                  03200099
032100         10  MR-ADJ-QTY-L              PIC S9(04) COMP.           03210099
032200         10  MR-ADJ-QTY-A              PIC  X(01).                03220099
032300         10  MR-ADJ-QTY-C              PIC  X(01).                03230099
032400         10  MR-ADJ-QTY-H              PIC  X(01).                03240099
032500         10  MR-ADJ-QTY-X.                                        03250099
032600             15  MR-ADJ-QTY-I          PIC  9(05).                03260099
032700             15  MR-ADJ-QTY-O REDEFINES                           03270099
032800                 MR-ADJ-QTY-I          PIC  ZZZZ9.                03280099
032900                                                                  03290099
033000         10  MR-PO-LNE-NBR-L            PIC S9(04) COMP.          03300099
033100         10  MR-PO-LNE-NBR-A            PIC  X(01).               03310099
033200         10  MR-PO-LNE-NBR-C            PIC  X(01).               03320099
033300         10  MR-PO-LNE-NBR-H            PIC  X(01).               03330099
033400         10  MR-PO-LNE-NBR-X.                                     03340099
033500             15  MR-PO-LNE-NBR          PIC ZZZZ9.                03350099
033600                                                                  03360099
033700         10  MR-SKU-L                   PIC S9(04) COMP.          03370099
033800         10  MR-SKU-A                   PIC  X(01).               03380099
033900         10  MR-SKU-C                   PIC  X(01).               03390099
034000         10  MR-SKU-H                   PIC  X(01).               03400099
034110         10  MR-SKU                     PIC  X(11).               03411099
034200                                                                  03420099
034300                                                                  03430099
034400         10  MR-PCK-QTYL                PIC S9(04) COMP.          03440099
034500         10  MR-PCK-QTYA                PIC  X(01).               03450099
034600         10  MR-PCK-QTYC                PIC  X(01).               03460099
034700         10  MR-PCK-QTYH                PIC  X(01).               03470099
034800         10  MR-PCK-QTY-X.                                        03480099
034900             15  MR-PCK-QTY             PIC  ZZZZZ9.              03490099
035000                                                                  03500099
035100         10  MR-ACT-QTYL                PIC S9(04) COMP.          03510099
035200         10  MR-ACT-QTYA                PIC  X(01).               03520099
035300         10  MR-ACT-QTYC                PIC  X(01).               03530099
035400         10  MR-ACT-QTYH                PIC  X(01).               03540099
035500         10  MR-ACT-QTY-X.                                        03550099
035600             15  MR-ACT-QTY             PIC  ZZZZZ9.              03560099
035700                                                                  03570099
035800         10  MR-VFY-QTYL                PIC S9(04) COMP.          03580099
035900         10  MR-VFY-QTYA                PIC  X(01).               03590099
036000         10  MR-VFY-QTYC                PIC  X(01).               03600099
036100         10  MR-VFY-QTYH                PIC  X(01).               03610099
036200         10  MR-VFY-QTY-X.                                        03620099
036300             15  MR-VFY-QTY             PIC  ZZZZZ9.              03630099
036310*----------------------------------------------------------------*03631099
036320* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *03632099
036330*----------------------------------------------------------------*03633099
036400/                                                                 03640099
036500*---------------------------------------------------------------* 03650099
036600*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03660099
036700*---------------------------------------------------------------* 03670099
036800                                                                  03680099
036900     COPY DPWS015.                                                03690099
037000                                                                  03700099
037100*---------------------------------------------------------------* 03710099
037200*    FUNCTION KEYS COPYBOOK.                                    * 03720099
037300*---------------------------------------------------------------* 03730099
037400                                                                  03740099
037500     COPY DPWS016.                                                03750099
037600                                                                  03760099
037700*---------------------------------------------------------------* 03770099
037800*    NUMERIC EDIT LAYOUT.                                       * 03780099
037900*---------------------------------------------------------------* 03790099
038000                                                                  03800099
038100     COPY DPWS010I.                                               03810099
038200/                                                                 03820099
038300******************************************************************03830099
038400** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **03840099
038410** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **03841099
038500******************************************************************03850099
038600                                                                  03860099
038700     COPY DPWS030.                                                03870099
038710     COPY DPWS930.                                                03871099
038800/                                                                 03880099
038900*---------------------------------------------------------------* 03890099
039000*    STANDARD COMMAREA.                                         * 03900099
039100*---------------------------------------------------------------* 03910099
039200                                                                  03920099
039300     COPY DPWS020.                                                03930099
039400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03940099
039500                                                                  03950099
039610         10  INTER-APPL-COMM-AREA       PIC X(200).               03961099
039700     COPY RCWS017.                                                03970099
039800     COPY RCWS012.                                                03980099
039900*---------------------------------------------------------------* 03990099
040000*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04000099
040100*---------------------------------------------------------------* 04010099
040200         10  ASC-SPECIFIC-COMMAREA.                               04020099
040300*            15  ASC-STATUS-CDE-VE-SW                PIC X(01).   04030099
040400*                88  ASC-STATUS-CDE-VE-YES           VALUE 'Y'.   04040099
040500*                88  ASC-STATUS-CDE-VE-NO            VALUE 'N'.   04050099
040600                                                                  04060099
040700             15  ASC-LIST-KEYS.                                   04070099
040800                 20  ASC-OPER-UNT-ID                 PIC S9(04)   04080099
040900                                                     COMP.        04090099
041000                 20  ASC-FCLTY-ID                    PIC S9(04)   04100099
041100                                                     COMP.        04110099
041200                 20  ASC-PO-NBR                      PIC S9(09)   04120099
041300                                                     COMP.        04130099
041400                 20  ASC-STR-NBR                     PIC S9(04)   04140099
041500                                                     COMP.        04150099
041600                 20  ASC-REC-SEQ-NBR                 PIC S9(09)   04160099
041700                                                     COMP.        04170099
041800                 20  ASC-ORD-LNE-NBR-LOW             PIC S9(09)   04180099
041900                                                     COMP.        04190099
042000                 20  ASC-ORD-LNE-NBR-HIGH            PIC S9(09)   04200099
042100                                                     COMP.        04210099
042200                 20  ASC-ENT-ID                      PIC S9(09)   04220099
042300                                                     COMP.        04230099
042400                 20  ASC-DEPT-NBR                    PIC  X(03).  04240099
042500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04250099
042600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  04260099
042700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04270099
042800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04280099
042900                                                                  04290099
043000                 20  ASC-ITEM-ARRAY.                              04300099
043100                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        04310099
043200                         30  ASC-LIST-ITEM-NUMBER                 04320099
043300                                                     PIC S9(09)   04330099
043400                                                     COMP-3.      04340099
043500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  04350099
043600                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   04360099
043700                             88  ASC-TEMP-SELECT     VALUE 'S'.   04370099
043800                             88  ASC-TEMP-BEGIN      VALUE 'B'.   04380099
043900                             88  ASC-TEMP-END        VALUE 'E'.   04390099
044000                         30  ASC-SELECTED-SW         PIC  X(01).  04400099
044100                             88  ASC-NO-SELECT       VALUE ' '.   04410099
044200                             88  ASC-SELECT          VALUE 'S'.   04420099
044300                             88  ASC-BEGIN           VALUE 'B'.   04430099
044400                             88  ASC-END             VALUE 'E'.   04440099
044500                         30  ASC-UPDATE-SW           PIC  X(01).  04450099
044600                             88  ASC-UPDATE-YES      VALUE 'Y'.   04460099
044700                             88  ASC-UPDATE-NO       VALUE 'N'.   04470099
044800                         30  ASC-ACTION              PIC  X(03).  04480099
044900                         30  ASC-ADJ-QTY-X           PIC  X(05).  04490099
045000                         30  ASC-ADJ-QTY REDEFINES ASC-ADJ-QTY-X  04500099
045100                                                     PIC 9(05).   04510099
045200                         30  ASC-ORD-LNE-NBR         PIC S9(09)   04520099
045300                                                          COMP.   04530099
045310*----------------------------------------------------------------*04531099
045320*                                             WR # 21361         *04532099
045330* CHANGED THE STRUCTURE OF ASC TO MATCH THE APPL COMMAREA.       *04533099
045340* ASC-CLASS-SKU FIELD IS INCREASED FROM X(06) TO X(11).          *04534099
045350*----------------------------------------------------------------*04535099
045410                         30  ASC-CLASS-SKU           PIC  X(11).  04541099
045420*----------------------------------------------------------------*04542099
045430* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *04543099
045440*----------------------------------------------------------------*04544099
045500                         30  ASC-PCKSLP-ITM-QTY      PIC S9(05).  04550099
045600                         30  ASC-ACTUAL-ITM-QTY      PIC S9(05).  04560099
045700                         30  ASC-VERIFY-ITM-QTY      PIC S9(05).  04570099
045800                         30  ASC-PACK-BY-ST-OVERAGE-SW            04580099
045900                                                     PIC X(01).   04590099
046000                             88  ASC-PACK-BY-ST-OVERAGE           04600099
046100                                                     VALUE 'Y'.   04610099
046200                             88  ASC-NO-PACK-BY-ST-OVERAGE        04620099
046300                                                     VALUE 'N'.   04630099
046400*DC-XXX                                                           04640099
046500                         30  ASC-PURITM-UNT-QTY      PIC S9(09)   04650099
046600                                                          COMP.   04660099
046700                         30  ASC-PURITM-STATUS-CDE   PIC  X(02).  04670099
046800                         30  ASC-PURCHS-STATUS-CDE   PIC  X(02).  04680099
046900*DC-XXX                                                           04690099
047000                                                                  04700099
047100             15  ASC-BLK-SUB                         PIC S9(04)   04710099
047200                                                          COMP    04720099
047300                                                          SYNC.   04730099
047400             15  ASC-ITEM-SUB                        PIC S9(04)   04740099
047500                                                          COMP    04750099
047600                                                          SYNC.   04760099
047700             15  ASC-SEL-SUB                         PIC S9(04)   04770099
047800                                                          COMP    04780099
047900                                                          SYNC.   04790099
048000             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   04800099
048100                                                          COMP-3. 04810099
048200             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   04820099
048300                                                          COMP-3. 04830099
048400             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   04840099
048500                                                          COMP-3. 04850099
048600             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   04860099
048700                                                          COMP-3. 04870099
048800             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   04880099
048900                                                          COMP-3. 04890099
049000             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   04900099
049100                                                          COMP-3. 04910099
049200             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   04920099
049300                                                          COMP    04930099
049400                                                          SYNC.   04940099
049500             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   04950099
049600                                                          COMP-3. 04960099
049700             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   04970099
049800                                                          COMP-3. 04980099
049900             15  ASC-KEY-NOTIF-NBR                   PIC S9(09)   04990099
050000                                                          COMP.   05000099
050100             15  ASC-SEL-ITEM                        PIC S9(4)    05010099
050200                                                     COMP.        05020099
050300                                                                  05030099
050400             15  ASC-TOT-ORG-QTY                     PIC S9(09)   05040099
050500                                                        COMP-3.   05050099
050600             15  ASC-TOT-ADJ-QTY                     PIC S9(09)   05060099
050700                                                        COMP-3.   05070099
050800                                                                  05080099
050900             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  05090099
051000                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   05100099
051100                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   05110099
051200             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  05120099
051300                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05130099
051400                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05140099
051500             15  ASC-AREA-ASTERISK-SW                PIC  X(01).  05150099
051600                 88  ASC-AREA-ASTERISK               VALUE 'Y'.   05160099
051700             15  ASC-DISPLAY-COMPLETE-SW             PIC  X(01).  05170099
051800                 88  ASC-DISPLAY-COMPLETE            VALUE 'Y'.   05180099
051900             15  ASC-VERIFY-SW                       PIC  X(01).  05190099
052000                 88  ASC-CAN-VERIFY                  VALUE 'Y'.   05200099
052100                 88  ASC-CANT-VERIFY                 VALUE 'N'.   05210099
052200             15 ASC-TRBL-FOUND-SW                    PIC  X.      05220099
052300                 88 ASC-TRBL-EXISTS                  VALUE 'Y'.   05230099
052400                 88 ASC-NO-TRBL-EXISTS               VALUE 'N'.   05240099
052500             15  ASC-TRBL-LVL-IND                    PIC X(01).   05250099
052600                 88  ASC-PO-LEVEL-TRBL               VALUE 'P'.   05260099
052700                 88  ASC-LINE-LEVEL-TRBL             VALUE 'L'.   05270099
052800                                                                  05280099
052900             15  ASC-CAN-UPDATE-SW                   PIC X.       05290099
053000                 88  ASC-CAN-UPDATE                  VALUE 'Y'.   05300099
053100                 88  ASC-CANT-UPDATE                 VALUE 'N'.   05310099
053200                                                                  05320099
053300             15  ASC-LIST-QUEUE-NAME.                             05330099
053400                 20  ASC-LIST-TERM-ID                PIC  X(04).  05340099
053500                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   05350099
053600                                                          COMP-3. 05360099
053700                 20  ASC-LIST-SEQ                    PIC  9(01).  05370099
053800             15  ASC-SEL-QUEUE-NAME.                              05380099
053900                 20  ASC-SEL-TERM-ID                 PIC  X(04).  05390099
054000                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   05400099
054100                                                          COMP-3. 05410099
054200                 20  ASC-SEL-SEQ                     PIC  9(01).  05420099
054300                                                                  05430099
054400             15  ASC-TRB-QUEUE-NAME-IN               PIC X(8).    05440099
054500             15  ASC-TRB-QUEUE-NAME.                              05450099
054600                 20  ASC-TRB-TERM-ID                 PIC  X(04).  05460099
054700                 20  ASC-TRB-TASK-NUMBER             PIC S9(05)   05470099
054800                                                          COMP-3. 05480099
054900                 20  ASC-TRB-SEQ                     PIC  9(01).  05490099
055000                                                                  05500099
055100             15  ASC-SEL-QUEUE-NAME-OUT.                          05510099
055200                 20  ASC-SEL-TERM-ID-OUT             PIC X(4).    05520099
055300                 20  ASC-SEL-TASK-NUMBER-OUT         PIC S9(5)    05530099
055400                                                     COMP-3.      05540099
055500                 20  ASC-SEL-SEQ-OUT                 PIC 9.       05550099
055600                                                                  05560099
055700             15  ASC-FCLTY-NME                       PIC  X(25).  05570099
055800             15  ASC-ENT-NAME-DESC                   PIC  X(30).  05580099
055900             15  ASC-CURSOR-SW                       PIC  X(01).  05590099
056000                 88  ASC-NO-CURSOR                   VALUE 'Z'.   05600099
056100                 88  ASC-SYSTEM-ID-CURSOR            VALUE 'S'.   05610099
056200                 88  ASC-MESSAGE-NUMBER-CURSOR       VALUE 'N'.   05620099
056300                 88  ASC-MESSAGE-TEXT-CURSOR         VALUE 'T'.   05630099
056400             15  ASC-START-ITEM-REQUEST.                          05640099
056500                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  05650099
056600             15  ASC-HOLD-RECEIV-STATUS-CDE          PIC  X(02).  05660099
056700             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(1).    05670099
056800                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   05680099
056900             15  ASC-HOLD-INTER-APPL                 PIC X(200).  05690099
057000             15  ASC-CONFIRM-SWITCH                  PIC X.       05700099
057100                 88  ASC-CONFIRMED                   VALUE 'Y'.   05710099
057200                 88  ASC-NOT-CONFIRMED               VALUE 'N'.   05720099
057300             15  ASC-OVERAGE-SW                      PIC X.       05730099
057400                 88  ASC-OVERAGE           VALUE 'Y'.             05740099
057500                 88  ASC-NO-OVERAGE        VALUE 'N'.             05750099
057600             15  ASC-OVERAGE-COUNT                   PIC 9.       05760099
057700                 88  ASC-OVERAGE-1         VALUE 1.               05770099
057800                 88  ASC-OVERAGE-2         VALUE 2.               05780099
057900                 88  ASC-OVERAGE-3         VALUE 3.               05790099
057910             15  ASC-VRFY-ADJ-QUEUE-NAME.                         05791099
057920                 20  ASC-VRFY-ADJ-TERM-ID            PIC X(4).    05792099
057930                 20  ASC-VRFY-ADJ-TASK-NUMBER        PIC S9(5)    05793099
057940                                                      COMP-3.     05794099
057950                 20  ASC-VRFY-ADJ-SEQ                PIC 9.       05795099
058000/                                                                 05800099
058100*----------------------------------------------------------------*05810099
058200*    COMMAREA FOR TMKCS520.                                      *05820099
058300*----------------------------------------------------------------*05830099
058400                                                                  05840099
058500     COPY TMWS500.                                                05850099
058600/                                                                 05860099
058700******************************************************************05870099
058800*    HELD TROUBLE SCREEN                                          05880099
058900******************************************************************05890099
059000     COPY TMWS003.                                                05900099
059100/                                                                 05910099
059200******************************************************************05920099
059300*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           05930099
059400******************************************************************05940099
059500     COPY RCWS013.                                                05950099
059600/                                                                 05960099
059700*---------------------------------------------------------------* 05970099
059800*    ABEND DROCESSING COPYBOOK.                                 * 05980099
059900*---------------------------------------------------------------* 05990099
060000                                                                  06000099
060100     COPY DPWS013.                                                06010099
060300/                                                                 06030099
060310******************************************************************06031099
060330*  COMMAREA LAYOUT FOR THE UNITS WORKED MODULE (PCKCS756)        *06033099
060331******************************************************************06033199
060332                                                                  06033299
060350     COPY PCWS238.                                                06035099
060351/                                                                 06035199
060400*---------------------------------------------------------------* 06040099
060500*    DB2 AREA FOR RECEIPT HEADER TABLE                          * 06050099
060600*---------------------------------------------------------------* 06060099
060700     EXEC SQL                                                     06070099
060800          INCLUDE TRECEIV                                         06080099
060900     END-EXEC.                                                    06090099
061000*---------------------------------------------------------------* 06100099
061100*    DB2 AREA FOR RECEIPT ITEM TABLE                            * 06110099
061200*---------------------------------------------------------------* 06120099
061300     EXEC SQL                                                     06130099
061400          INCLUDE TRECITM                                         06140099
061500     END-EXEC.                                                    06150099
061600*---------------------------------------------------------------* 06160099
061700*    DB2 AREA FOR RECEIPT DISTRIBUTION TABLE                    * 06170099
061800*---------------------------------------------------------------* 06180099
061900     EXEC SQL                                                     06190099
062000          INCLUDE TRECDIS                                         06200099
062100     END-EXEC.                                                    06210099
062200*---------------------------------------------------------------* 06220099
062300*    DB2 AREA FOR VENDOR NAME TABLE                             * 06230099
062400*---------------------------------------------------------------* 06240099
062500     EXEC SQL                                                     06250099
062600          INCLUDE TENTNME                                         06260099
062700     END-EXEC.                                                    06270099
062800*---------------------------------------------------------------* 06280099
062900*    DB2 AREA FOR PURCHASE HEADER TABLE                         * 06290099
063000*---------------------------------------------------------------* 06300099
063100     EXEC SQL                                                     06310099
063200          INCLUDE TPURCHS                                         06320099
063300     END-EXEC.                                                    06330099
063400*---------------------------------------------------------------* 06340099
063500*    DB2 AREA FOR PURCHASE ITEM TABLE                           * 06350099
063600*---------------------------------------------------------------* 06360099
063700     EXEC SQL                                                     06370099
063800          INCLUDE TPURITM                                         06380099
063900     END-EXEC.                                                    06390099
064000/                                                                 06400099
064100*----------------------------------------------------------------*06410099
064200*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                06420099
064300*----------------------------------------------------------------*06430099
064400     EXEC SQL                                                     06440099
064500          INCLUDE TTRBNTF                                         06450099
064600     END-EXEC.                                                    06460099
064700/                                                                 06470099
064800*----------------------------------------------------------------*06480099
064900*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      06490099
065000*----------------------------------------------------------------*06500099
065100     EXEC SQL                                                     06510099
065200          INCLUDE TTRBRSN                                         06520099
065300     END-EXEC.                                                    06530099
065310/                                                                 06531099
065320*----------------------------------------------------------------*06532099
065330*    DB2 DCLGEN FOR THE LOCATION TABLE - XLT_LOC                  06533099
065340*----------------------------------------------------------------*06534099
065350     EXEC SQL                                                     06535099
065360          INCLUDE XLT00010                                        06536099
065370     END-EXEC.                                                    06537099
065400*---------------------------------------------------------------* 06540099
065500*    DB2 AREA FOR COMMUNICATIONS                                * 06550099
065600*---------------------------------------------------------------* 06560099
065700     EXEC SQL                                                     06570099
065800          INCLUDE SQLCA                                           06580099
065900     END-EXEC.                                                    06590099
066000                                                                  06600099
066100*---------------------------------------------------------------* 06610099
066200*    TRECITM CURSOR DECLARATION.                                * 06620099
066300*---------------------------------------------------------------* 06630099
066310*---------------------------------------------------------------* 06631099
066320*                                              ** WR # 21361    * 06632099
066330* ADDED CODE TO RETRIEVE ITEM NUMBER FROM TPURITM TABLE.        * 06633099
066340*---------------------------------------------------------------* 06634099
066400                                                                  06640099
066500     EXEC SQL                                                     06650099
066600          DECLARE LIST-CSR CURSOR                                 06660099
066700          FOR SELECT                                              06670099
066800                A.STATUS_CDE                                      06680099
066900              , A.ML_POST_TMST                                    06690099
067000              , A.FS_POST_TMST                                    06700099
067100              , B.ORD_LNE_NBR                                     06710099
067200              , B.STATUS_CDE                                      06720099
067300              , C.EXPTED_ITM_QTY                                  06730099
067400              , C.VERIFY_ITM_QTY                                  06740099
067500              , C.AP_VERIFY_ITM_QTY                               06750099
067600              , C.AP_PRC_CDE                                      06760099
067700              , D.DEPT_NBR                                        06770099
067800              , D.ENT_ID                                          06780099
067900              , D.STATUS_CDE                                      06790099
068000              , E.CL_NBR                                          06800099
068100              , E.SKU_SEQ_NBR                                     06810099
068200              , E.UNT_QTY                                         06820099
068300              , E.STATUS_CDE                                      06830099
068310              , E.ITM_NBR                                         06831099
068400          FROM                                                    06840099
068500                  TRECEIV  A                                      06850099
068600              ,   TRECITM  B                                      06860099
068700              ,   TRECDIS  C                                      06870099
068800              ,   TPURCHS  D                                      06880099
068900              ,   TPURITM  E                                      06890099
069000          WHERE                                                   06900099
069100                A.ORD_NBR          =  :ASC-PO-NBR                 06910099
069200           AND  A.ORD_NBR          =  B.ORD_NBR                   06920099
069300           AND  A.ORD_NBR          =  C.ORD_NBR                   06930099
069400           AND  A.ORD_NBR          =  D.PO_NBR                    06940099
069500           AND  A.ORD_NBR          =  E.PO_NBR                    06950099
069600*                                                                 06960099
069700           AND  A.VER_STATUS_CDE   =  :PC-A                       06970099
069800           AND  B.VER_STATUS_CDE   =  :PC-A                       06980099
070000           AND  D.VER_STATUS_CDE   =  :PC-A                       07000099
070100           AND  E.VER_STATUS_CDE   =  :PC-A                       07010099
070200*                                                                 07020099
070300           AND  A.OPER_UNT_ID      =  :ASC-OPER-UNT-ID            07030099
070400           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               07040099
070500           AND  A.OPER_UNT_ID      =  C.OPER_UNT_ID               07050099
070600           AND  A.FCLTY_ID         =  :ASC-FCLTY-ID               07060099
070700           AND  A.FCLTY_ID         =  B.FCLTY_ID                  07070099
070800           AND  A.FCLTY_ID         =  C.FCLTY_ID                  07080099
070900*                                                                 07090099
071000           AND  C.STR_NBR          =  :ASC-STR-NBR                07100099
071100           AND  A.REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR            07110099
071200           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               07120099
071300           AND  A.REC_SEQ_NBR      =  C.REC_SEQ_NBR               07130099
071400           AND  E.APP_PO_LNE_NBR   =  B.ORD_LNE_NBR               07140099
071500           AND  C.ORD_LNE_NBR      =  B.ORD_LNE_NBR               07150099
071600           AND  B.ORD_LNE_NBR BETWEEN :ASC-ORD-LNE-NBR-LOW        07160099
071700                                 AND  :ASC-ORD-LNE-NBR-HIGH       07170099
071800          ORDER BY                                                07180099
071900                B.ORD_LNE_NBR                                     07190099
072000     END-EXEC.                                                    07200099
072010*----------------------------------------------------------------*07201099
072020* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *07202099
072030*----------------------------------------------------------------*07203099
072100/                                                                 07210099
072200 LINKAGE SECTION.                                                 07220099
072300                                                                  07230099
072400 01  DFHCOMMAREA.                                                 07240099
072500     05  FILLER                         OCCURS  1 TO 4072 TIMES   07250099
072600                                        DEPENDING ON EIBCALEN.    07260099
072700         10  FILLER                     PIC X.                    07270099
072800                                                                  07280099
072900 PROCEDURE DIVISION.                                              07290099
073000******************************************************************07300099
073100**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07310099
073200**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07320099
073300**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07330099
073400******************************************************************07340099
073500                                                                  07350099
073600 0000-MAIN-MODULE.                                                07360099
073700                                                                  07370099
073800     INITIALIZE DP030-CICS-API-FIELDS.                            07380099
073900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07390099
074000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07400099
074100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07410099
074200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07420099
074300                                                                  07430099
074400     MOVE LENGTH OF RC280AI        TO DP030-MAP-LENGTH (1).       07440099
074500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07450099
074600     PERFORM 0001-CALL-CICS-ARCH-API.                             07460099
074700                                                                  07470099
074800     EXEC SQL                                                     07480099
074900          SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP            07490099
075000     END-EXEC.                                                    07500099
075100                                                                  07510099
075200     PERFORM 1000-CONTROL-PROCESSING                              07520099
075300                                                                  07530099
075400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07540099
075500     PERFORM 0001-CALL-CICS-ARCH-API.                             07550099
075600                                                                  07560099
075700*----------------------------------------------------------------*07570099
075800*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *07580099
075900*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *07590099
076000*----------------------------------------------------------------*07600099
076100                                                                  07610099
076200 0001-CALL-CICS-ARCH-API.                                         07620099
076300                                                                  07630099
076410     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07641099
076500                                    DFHCOMMAREA                   07650099
076600                                    DP030-CICS-API-FIELDS         07660099
076700                                    DP020-STANDARD-COMMAREA       07670099
076800                                    RC280AI.                      07680099
076900                                                                  07690099
077000     IF  DP030-RC-CALL-SUCCESSFUL                                 07700099
077100         CONTINUE                                                 07710099
077200     ELSE                                                         07720099
077300         SET DP013-NO-ROLLBACK                                    07730099
077400             DP013-XCTL-DISPLAY-RESTART                           07740099
077500             DP013-CICS-ABEND      TO TRUE                        07750099
077600         MOVE '0001-CALL-CICS-ARCH-API'                           07760099
077700                                   TO DP013-PARAGRAPH             07770099
077720         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O07772099
077730-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07773099
078000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07800099
078100         PERFORM DP013-0000-PROCESS-ABEND                         07810099
078200     END-IF.                                                      07820099
078300                                                                  07830099
078400*----------------------------------------------------------------*07840099
078500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07850099
078600* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07860099
078700*                                                                *07870099
078800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07880099
078900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07890099
079000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07900099
079100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07910099
079200*----------------------------------------------------------------*07920099
079300                                                                  07930099
079400 1000-CONTROL-PROCESSING.                                         07940099
079500                                                                  07950099
079600     EVALUATE TRUE                                                07960099
079700         WHEN DP020-NEXT-ACT-INITIAL                              07970099
079800              INITIALIZE ASC-SPECIFIC-COMMAREA                    07980099
079900              MOVE EIBTRMID        TO ASC-LIST-TERM-ID            07990099
080000                                      ASC-SEL-TERM-ID-OUT         08000099
080010                                      ASC-VRFY-ADJ-TERM-ID        08001099
080100              MOVE DP020-SRC-TASK-NUMBER                          08010099
080200                                   TO ASC-LIST-TASK-NUMBER        08020099
080300                                      ASC-SEL-TASK-NUMBER-OUT     08030099
080310                                      ASC-VRFY-ADJ-TASK-NUMBER    08031099
080400              MOVE PC-LIST-QUEUE-SEQ                              08040099
080500                                   TO ASC-LIST-SEQ                08050099
080600              MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT            08060099
080610              MOVE PC-VRFY-ADJ-QUEUE-SEQ TO ASC-VRFY-ADJ-SEQ      08061099
080700              SET PS-NO-ERROR      TO TRUE                        08070099
080800                                                                  08080099
080900              PERFORM 1100-PROCESS-INTER-APPL-COMM                08090099
081000              IF PS-NO-ERROR                                      08100099
081100                  MOVE INTER-APPL-COMM-AREA                       08110099
081200                                   TO ASC-HOLD-INTER-APPL         08120099
081300                   PERFORM 4000-BUILD-INITIAL-PANEL               08130099
081400                   PERFORM 3200-RESET-ATTRIBUTES                  08140099
081500              END-IF                                              08150099
081600                                                                  08160099
081700         WHEN DP020-NEXT-ACT-READ-MAP                             08170099
081800              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       08180099
081900                                   TO PV-TOP-ITEM                 08190099
082000              PERFORM 2000-PROCESS-PANEL                          08200099
082100                                                                  08210099
082200         WHEN DP020-NEXT-ACT-RETURN                               08220099
082300              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       08230099
082400                                   TO PV-TOP-ITEM                 08240099
082500              MOVE ZERO            TO ASC-ITEM-AT-TOP-OF-PANEL    08250099
082600              MOVE ASC-HOLD-INTER-APPL                            08260099
082700                                   TO INTER-APPL-COMM-AREA        08270099
082800              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  08280099
082900              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08290099
083000                                                                  08300099
083100         WHEN OTHER                                               08310099
083200              SET DP013-LOGIC-ABEND TO TRUE                       08320099
083300              SET DP013-NO-ROLLBACK TO TRUE                       08330099
083400              MOVE '1000-CONTROL-PROCESSING'                      08340099
083500                                   TO DP013-PARAGRAPH             08350099
083600              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   08360099
083700                                   TO DP013-MESSAGE-TEXT(1)       08370099
083800              PERFORM DP013-0000-PROCESS-ABEND                    08380099
083900     END-EVALUATE.                                                08390099
084000                                                                  08400099
084100/                                                                 08410099
084200*----------------------------------------------------------------*08420099
084300*    CHECK TO SEE IF VALID STATUS FOR UPDATE                     *08430099
084400*----------------------------------------------------------------*08440099
084500 1100-PROCESS-INTER-APPL-COMM.                                    08450099
084600                                                                  08460099
084700     PERFORM 4100-PREPARE-CURSOR.                                 08470099
084800     INITIALIZE PV-DB2-COUNT.                                     08480099
084900     PERFORM 1140-CHECK-STATUS.                                   08490099
085000/                                                                 08500099
085100*----------------------------------------------------------------*08510099
085200*    CHECK TO SEE IF VALID STATUS FOR UPDATE                     *08520099
085300*----------------------------------------------------------------*08530099
085400 1140-CHECK-STATUS.                                               08540099
085500                                                                  08550099
085600         EXEC SQL                                                 08560099
085700              SELECT COUNT(*)                                     08570099
085800                INTO :PV-DB2-COUNT :PV-NULL-IND                   08580099
085900                FROM TRECEIV                                      08590099
086000               WHERE OPER_UNT_ID    = :ASC-OPER-UNT-ID            08600099
086100                 AND FCLTY_ID       = :ASC-FCLTY-ID               08610099
086200                 AND ORD_NBR        = :ASC-PO-NBR                 08620099
086300                 AND REC_SEQ_NBR    = :ASC-REC-SEQ-NBR            08630099
086400                 AND VER_STATUS_CDE = 'A'                         08640099
086500                 AND STATUS_CDE     = 'VE'                        08650099
086600         END-EXEC.                                                08660099
086700                                                                  08670099
086800         EVALUATE TRUE                                            08680099
086900             WHEN SQLCODE = +0                                    08690099
087000             WHEN SQLCODE = +100                                  08700099
087100                 CONTINUE                                         08710099
087200             WHEN SQLCODE = -904                                  08720099
087300             WHEN SQLCODE = -911                                  08730099
087400             WHEN SQLCODE = -913                                  08740099
087500                 PERFORM 9900-SOFT-ABORT                          08750099
087600             WHEN SQLWARN0 NOT = SPACES                           08760099
087700             WHEN SQLCODE < +0                                    08770099
087800             WHEN SQLCODE > +0                                    08780099
087900                  MOVE '1140-CHECK-STATUS'                        08790099
088000                                  TO DP013-PARAGRAPH              08800099
088100                  MOVE 'UNSUCCESSFUL SELECT ON TRECEIV  '         08810099
088200                                  TO DP013-MESSAGE-TEXT (1)       08820099
088300                  MOVE SQLCA      TO DP013-SQLCA                  08830099
088400                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     08840099
088500                  SET DP013-DB2-ABEND                             08850099
088600                      DP013-XCTL-DISPLAY-RESTART                  08860099
088700                                  TO TRUE                         08870099
088800                  PERFORM DP013-0000-PROCESS-ABEND                08880099
088900         END-EVALUATE.                                            08890099
089000/                                                                 08900099
089100*----------------------------------------------------------------*08910099
089200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08920099
089300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08930099
089400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08940099
089500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08950099
089600* FUNCTION KEYS CAN GET THIS FAR.                                *08960099
089700*----------------------------------------------------------------*08970099
089800                                                                  08980099
089900 2000-PROCESS-PANEL.                                              08990099
090000     SET PS-NEXT-SCREEN TO TRUE.                                  09000099
090100                                                                  09010099
090200     MOVE ASC-HOLD-INTER-APPL     TO INTER-APPL-COMM-AREA.        09020099
090300                                                                  09030099
090400     EVALUATE TRUE                                                09040099
090500         WHEN DP020-SRC-AID = DP016-CLEAR                         09050099
090600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09060099
090700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09070099
090800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09080099
090900                                                                  09090099
091000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09100099
091100             PERFORM 2050-DELETE-LIST-QUEUE                       09110099
091200             PERFORM 4000-BUILD-INITIAL-PANEL                     09120099
091300                                                                  09130099
091400         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    09140099
091500             PERFORM 2140-DESELECT-ALL-ITEMS                      09150099
091600             PERFORM 3200-RESET-ATTRIBUTES                        09160099
091700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09170099
091800                                                                  09180099
091900         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  09190099
092000             PERFORM 2150-SELECT-ALL-ITEMS                        09200099
092100             PERFORM 3200-RESET-ATTRIBUTES                        09210099
092200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09220099
092300                                                                  09230099
092400         WHEN OTHER                                               09240099
092500              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                09250099
092600                  PERFORM 3000-EDIT-DATA-IN-COMMAREA              09260099
092700                  IF  PS-NO-ERROR                                 09270099
092800                      SET DP030-CONTINUE-GO                       09280099
092900                                 TO TRUE                          09290099
093000                      PERFORM 2100-CHECK-FUNCTION-KEY             09300099
093100                  ELSE                                            09310099
093200                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        09320099
093300                      SET DP030-OVERRIDE-GO                       09330099
093400                                 TO TRUE                          09340099
093500                  END-IF                                          09350099
093600     END-EVALUATE.                                                09360099
093700 EJECT                                                            09370099
093800*----------------------------------------------------------------*09380099
093900*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *09390099
094000*----------------------------------------------------------------*09400099
094100 2050-DELETE-LIST-QUEUE.                                          09410099
094200                                                                  09420099
094300     EXEC CICS                                                    09430099
094400         DELETEQ TS                                               09440099
094500             QUEUE (ASC-LIST-QUEUE-NAME)                          09450099
094600             RESP  (PV-CICS-RESP)                                 09460099
094700     END-EXEC.                                                    09470099
094800                                                                  09480099
094900     IF (PV-CICS-RESP = DFHRESP(NORMAL)                           09490099
095000     OR  PV-CICS-RESP = DFHRESP(QIDERR))                          09500099
095100         CONTINUE                                                 09510099
095200     ELSE                                                         09520099
095300         SET DP013-CICS-ABEND      TO TRUE                        09530099
095400         SET DP013-NO-ROLLBACK     TO TRUE                        09540099
095500                                                                  09550099
095600         MOVE '2050-DELETE-LIST-QUEUE'                            09560099
095700                                   TO DP013-PARAGRAPH             09570099
095800         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    09580099
095900                                   TO DP013-MESSAGE-TEXT (1)      09590099
096000         PERFORM DP013-0000-PROCESS-ABEND                         09600099
096100     END-IF.                                                      09610099
096200                                                                  09620099
096300     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  09630099
096400/                                                                 09640099
096500*----------------------------------------------------------------*09650099
096600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*09660099
096700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *09670099
096800* CICS ARCHITECTURE API.                                         *09680099
096900*----------------------------------------------------------------*09690099
097000                                                                  09700099
097100 2100-CHECK-FUNCTION-KEY.                                         09710099
097200                                                                  09720099
097300     SET PS-NEXT-SCREEN TO TRUE.                                  09730099
097400     EVALUATE TRUE                                                09740099
097500                                                                  09750099
097600         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               09760099
097700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              09770099
097800                 IF RC017-PACK-BY-STORE                           09780099
097900                      PERFORM 5005-PREPARE-SEL-QUEUE              09790099
098000                      IF ASC-OVERAGE                              09800099
098100                          SET ASC-CONFIRMED                       09810099
098200                               TO TRUE                            09820099
098300                           MOVE PC-TSYMSG-01264                   09830099
098400                           TO  DP020-MSG-NUMBER                   09840099
098500                            SET PS-ERROR                          09850099
098600                            DP030-OVERRIDE-GO                     09860099
098700                            DP020-MSG-FATAL                       09870099
098800                                     TO TRUE                      09880099
098900                      ELSE                                        09890099
099000                          PERFORM 5050-ADJUST-QTYS                09900099
099100                          SET ASC-CONFIRMED TO TRUE               09910099
099200                          SET ASC-NO-OVERAGE TO TRUE              09920099
099300                          IF  NOT PS-ERROR                        09930099
099400                              MOVE PC-TSYMSG-00059                09940099
099500                                            TO  DP020-MSG-NUMBER  09950099
099600                              SET DP020-MSG-INFORMATIONAL         09960099
099700                                            TO  TRUE              09970099
099800                          END-IF                                  09980099
099900                          SET ASC-CONFIRMED TO TRUE               09990099
100000                          SET ASC-NO-OVERAGE TO TRUE              10000099
100100                 ELSE                                             10010099
100200                     PERFORM 5050-ADJUST-QTYS                     10020099
100300                     IF  NOT PS-ERROR                             10030099
100400                         MOVE PC-TSYMSG-00059                     10040099
100500                                       TO  DP020-MSG-NUMBER       10050099
100600                         SET DP020-MSG-INFORMATIONAL              10060099
100700                                       TO  TRUE                   10070099
100800                     END-IF                                       10080099
100900             ELSE                                                 10090099
101000                 SET DP030-OVERRIDE-GO                            10100099
101100                                   TO TRUE                        10110099
101200                 MOVE PC-TSYMSG-00057                             10120099
101300                                   TO DP020-MSG-NUMBER            10130099
101400                 SET DP020-MSG-WARNING                            10140099
101500                                   TO TRUE                        10150099
101600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10160099
101700             END-IF                                               10170099
101800                                                                  10180099
101900         WHEN  DP020-FK-CONFIRM(DP020-SRC-AID)                    10190099
102000            SET ASC-NO-OVERAGE TO TRUE                            10200099
102100            IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO                10210099
102200                 SET ASC-NO-TSQ-UPDATE                            10220099
102300                                TO TRUE                           10230099
102400                 SET DP030-OVERRIDE-GO                            10240099
102500                      DP020-MSG-WARNING                           10250099
102600                                 TO TRUE                          10260099
102700                 MOVE PC-TSYMSG-00057                             10270099
102800                                 TO DP020-MSG-NUMBER              10280099
102810                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10281099
102820                 PERFORM 3200-RESET-ATTRIBUTES                    10282099
102900            ELSE                                                  10290099
103000                  IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          10300099
103100                      IF ASC-CONFIRMED                            10310099
103200                          MOVE ASC-NUMBER-OF-SELECTED-ITEMS       10320099
103300                            TO RC017-NUMBER-OF-SELECTED-ITEMS     10330099
103400                          MOVE ASC-PO-NBR                         10340099
103500                             TO RC017-PO-NBR                      10350099
103600                          MOVE ASC-STR-NBR                        10360099
103700                              TO RC017-STR-NBR                    10370099
103800                          PERFORM 5050-ADJUST-QTYS                10380099
103900                          IF  NOT PS-ERROR                        10390099
104000                              MOVE PC-TSYMSG-00059                10400099
104100                                            TO  DP020-MSG-NUMBER  10410099
104200                              SET DP020-MSG-INFORMATIONAL         10420099
104300                                            TO  TRUE              10430099
104400                          END-IF                                  10440099
104500                          SET ASC-NOT-CONFIRMED TO TRUE           10450099
104600                      ELSE                                        10460099
104700                         SET DP030-OVERRIDE-GO                    10470099
104800                             DP020-MSG-WARNING                    10480099
104900                             TO TRUE                              10490099
105000                         MOVE PC-TSYMSG-00045                     10500099
105100                             TO DP020-MSG-NUMBER                  10510099
105200                     END-IF                                       10520099
105300                  END-IF                                          10530099
105400            END-IF                                                10540099
105500                                                                  10550099
105600         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10560099
105700             MOVE +1               TO PV-TOP-ITEM                 10570099
105800             IF ASC-OVERAGE                                       10580099
105900                 MOVE PC-TSYMSG-01264                             10590099
106000                          TO DP020-MSG-NUMBER                     10600099
106100                SET DP020-MSG-FATAL                               10610099
106200                                     TO TRUE                      10620099
106300             ELSE                                                 10630099
106400                 MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER      10640099
106500                 SET DP020-MSG-INFORMATIONAL                      10650099
106600                                     TO TRUE                      10660099
106700                                                                  10670099
106800             END-IF                                               10680099
106900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10690099
107000             PERFORM 3200-RESET-ATTRIBUTES                        10700099
107100                                                                  10710099
107200         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10720099
107300             PERFORM 2110-BROWSE-BACKWARD                         10730099
107400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10740099
107500             PERFORM 3200-RESET-ATTRIBUTES                        10750099
107600                                                                  10760099
107700         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10770099
107800             PERFORM 2120-BROWSE-FORWARD                          10780099
107900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10790099
108000             PERFORM 3200-RESET-ATTRIBUTES                        10800099
108100                                                                  10810099
108200         WHEN DP020-SRC-AID = DP016-ENTER                         10820099
108300             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   10830099
108400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10840099
108500                                                                  10850099
108600         WHEN OTHER                                               10860099
108700             SET DP013-NO-ROLLBACK                                10870099
108800                 DP013-XCTL-DISPLAY-RESTART                       10880099
108900                 DP013-CICS-ABEND  TO TRUE                        10890099
109000             MOVE '2100-CHECK-FUNCTION-KEY'                       10900099
109100                                   TO DP013-PARAGRAPH             10910099
109200             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10920099
109300                                   TO DP013-MESSAGE-TEXT (1)      10930099
109400             PERFORM DP013-0000-PROCESS-ABEND                     10940099
109500     END-EVALUATE.                                                10950099
109600                                                                  10960099
109700*----------------------------------------------------------------*10970099
109800*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *10980099
109900*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *10990099
110000*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *11000099
110100*    MESSAGE.                                                    *11010099
110200*----------------------------------------------------------------*11020099
110300                                                                  11030099
110400 2110-BROWSE-BACKWARD.                                            11040099
110500                                                                  11050099
110600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    11060099
110700         GIVING PV-TOP-ITEM.                                      11070099
110800                                                                  11080099
110900     IF  ((PV-TOP-ITEM < +1)                                      11090099
111000       OR (PV-TOP-ITEM = +1))                                     11100099
111100         MOVE +1                   TO PV-TOP-ITEM                 11110099
111200         IF ASC-OVERAGE                                           11120099
111300             MOVE PC-TSYMSG-01264                                 11130099
111400                      TO DP020-MSG-NUMBER                         11140099
111500            SET DP020-MSG-FATAL                                   11150099
111600                                 TO TRUE                          11160099
111700         ELSE                                                     11170099
111800*        -- TOP OF LIST --                                        11180099
111900             MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER          11190099
112000             SET DP020-MSG-INFORMATIONAL                          11200099
112100                                 TO TRUE                          11210099
112200         END-IF                                                   11220099
112300     END-IF.                                                      11230099
112400                                                                  11240099
112500/                                                                 11250099
112600*----------------------------------------------------------------*11260099
112700*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *11270099
112800*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11280099
112900*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11290099
113000*----------------------------------------------------------------*11300099
113100                                                                  11310099
113200 2120-BROWSE-FORWARD.                                             11320099
113300                                                                  11330099
113400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11340099
113500         GIVING PV-TOP-ITEM.                                      11350099
113600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11360099
113700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11370099
113800                                   TO PV-TOP-ITEM                 11380099
113900         IF ASC-OVERAGE                                           11390099
114000             MOVE PC-TSYMSG-01264                                 11400099
114100                      TO DP020-MSG-NUMBER                         11410099
114200            SET DP020-MSG-FATAL                                   11420099
114300                                 TO TRUE                          11430099
114400         ELSE                                                     11440099
114500*        -- BOTTOM OF LIST --                                     11450099
114600             MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER          11460099
114700             SET DP020-MSG-INFORMATIONAL                          11470099
114800                                 TO TRUE                          11480099
114900         END-IF                                                   11490099
115000     ELSE                                                         11500099
115100         COMPUTE PV-BOTTOM-ITEM =                                 11510099
115200             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11520099
115300         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11530099
115400             IF ASC-OVERAGE                                       11540099
115500                 MOVE PC-TSYMSG-01264                             11550099
115600                          TO DP020-MSG-NUMBER                     11560099
115700                SET DP020-MSG-FATAL                               11570099
115800                                     TO TRUE                      11580099
115900             ELSE                                                 11590099
116000*            -- BOTTOM OF LIST --                                 11600099
116100                 MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER      11610099
116200                 SET DP020-MSG-INFORMATIONAL                      11620099
116300                                     TO TRUE                      11630099
116400             END-IF                                               11640099
116500         END-IF                                                   11650099
116600     END-IF.                                                      11660099
116700/                                                                 11670099
116800*----------------------------------------------------------------*11680099
116900*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11690099
117000*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11700099
117100*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11710099
117200*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11720099
117300*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11730099
117400*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11740099
117500*----------------------------------------------------------------*11750099
117600                                                                  11760099
117700 2130-CHECK-FOR-JUMP-BROWSE.                                      11770099
117800                                                                  11780099
117900     SET PS-NO-ERROR               TO TRUE.                       11790099
118000     IF  ASC-START-ITEM-REQUEST = SPACE                           11800099
118100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11810099
118200                                   TO PV-TOP-ITEM                 11820099
118300     ELSE                                                         11830099
118400         MOVE ASC-START-ITEM-REQUEST                              11840099
118500                                   TO DP010I-UNEDITED-FIELD       11850099
118600                                      PV-START-ITEM-REQUEST       11860099
118700         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11870099
118800         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     11880099
118900         SET DP010I-NEGATIVE-NOT-ALLOWED                          11890099
119000                                   TO TRUE                        11900099
119100         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11910099
119110              USING DP010I-NUMERIC-EDIT-AREA                      11911099
119200                                                                  11920099
119300         IF  NOT DP010I-ERROR-DETECTED                            11930099
119400             MOVE DP010I-NUMERIC-FIELD                            11940099
119500                                   TO  ASC-START-ITEM-REQUEST-N   11950099
119600             IF  ASC-START-ITEM-REQUEST-N > ZERO                  11960099
119700                 IF  ASC-START-ITEM-REQUEST-N >                   11970099
119800                                          ASC-NUMBER-OF-ITEMS-READ11980099
119900                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11990099
120000                     COMPUTE PV-TOP-ITEM =                        12000099
120100                             ASC-NUMBER-OF-ITEMS-READ             12010099
120200                             - PC-ITEMS-PER-PANEL + 1             12020099
120300                     IF  PV-TOP-ITEM < +1                         12030099
120400                         MOVE +1   TO PV-TOP-ITEM                 12040099
120500                         MOVE PC-TSYMSG-00070                     12050099
120600                                   TO DP020-MSG-NUMBER            12060099
120700                         SET DP020-MSG-INFORMATIONAL              12070099
120800                                   TO TRUE                        12080099
120900                     END-IF                                       12090099
121000                 ELSE                                             12100099
121100                     MOVE ASC-START-ITEM-REQUEST-N                12110099
121200                                   TO PV-TOP-ITEM                 12120099
121300                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      12130099
121400                     COMPUTE PV-BOTTOM-ITEM =                     12140099
121500                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     12150099
121600                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ12160099
121700*                        -- BOTTOM OF LIST --                     12170099
121800                         MOVE PC-TSYMSG-00070                     12180099
121900                                   TO DP020-MSG-NUMBER            12190099
122000                         SET DP020-MSG-INFORMATIONAL              12200099
122100                                   TO TRUE                        12210099
122200                     END-IF                                       12220099
122300                 END-IF                                           12230099
122400             ELSE                                                 12240099
122500*                --- VALUE OUT OF RANGE ----                      12250099
122600                 MOVE PC-TSYMSG-00101                             12260099
122700                                   TO DP020-MSG-NUMBER            12270099
122800                 MOVE -1           TO ASTRTITL                    12280099
122900                 SET DP030-SET-CURSOR-APPL-1                      12290099
123000                                   TO TRUE                        12300099
123100                 MOVE DP015-REVERSE                               12310099
123200                                   TO ASTRTITH                    12320099
123300                 MOVE DP015-RED    TO ASTRTITC                    12330099
123400                 MOVE DP015-UNP-NUM-BRT-OFF                       12340099
123500                                   TO ASTRTITA                    12350099
123600                 SET DP020-MSG-FATAL                              12360099
123700                                   TO TRUE                        12370099
123800                 SET PS-ERROR      TO TRUE                        12380099
123900             END-IF                                               12390099
124000                                                                  12400099
124100         ELSE                                                     12410099
124200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12420099
124300             MOVE -1               TO ASTRTITL                    12430099
124400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12440099
124500             MOVE DP015-REVERSE    TO ASTRTITH                    12450099
124600             MOVE DP015-RED        TO ASTRTITC                    12460099
124700             MOVE DP015-UNP-NUM-BRT-OFF                           12470099
124800                                   TO ASTRTITA                    12480099
124900             SET DP020-MSG-FATAL   TO TRUE                        12490099
125000             SET PS-ERROR          TO TRUE                        12500099
125100         END-IF                                                   12510099
125200     END-IF.                                                      12520099
125300/                                                                 12530099
125400*----------------------------------------------------------------*12540099
125500*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *12550099
125600*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *12560099
125700*----------------------------------------------------------------*12570099
125800                                                                  12580099
125900 2140-DESELECT-ALL-ITEMS.                                         12590099
126000                                                                  12600099
126100     MOVE +1                       TO ASC-BLK-SUB.                12610099
126200                                                                  12620099
126300     PERFORM 2141-CLEAR-SELECTED-INDS                             12630099
126400         VARYING ASC-ITEM-SUB                                     12640099
126500         FROM 1 BY 1                                              12650099
126600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12660099
126700                                                                  12670099
126800     ADD +1                        TO ASC-BLK-SUB.                12680099
126900                                                                  12690099
127000     PERFORM 2141-CLEAR-SELECTED-INDS                             12700099
127100         VARYING ASC-ITEM-SUB                                     12710099
127200         FROM 1 BY 1                                              12720099
127300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12730099
127400                                                                  12740099
127500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12750099
127600                                   TO PV-LIST-ITEM-NUMBER.        12760099
127700                                                                  12770099
127800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12780099
127900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12790099
128000                                                                  12800099
128100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12810099
128200        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      12820099
128300         MOVE +1                   TO ASC-BLK-SUB                 12830099
128400                                                                  12840099
128500         PERFORM 5100-WRITE-TEMP-STORAGE                          12850099
128600                                                                  12860099
128700         MOVE +1                   TO PV-BLOCK-NUMBER             12870099
128800                                                                  12880099
128900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12890099
129000             PV-FIRST-BLOCK-IN-ARRAY - 1                          12900099
129100                                                                  12910099
129200         PERFORM                                                  12920099
129300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12930099
129400                                                                  12940099
129500             PERFORM 4410-READ-TEMP-STORAGE                       12950099
129600                                                                  12960099
129700             PERFORM 2141-CLEAR-SELECTED-INDS                     12970099
129800                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 12980099
129900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12990099
130000                                                                  13000099
130100             PERFORM 5100-WRITE-TEMP-STORAGE                      13010099
130200                                                                  13020099
130300             ADD +1                TO PV-BLOCK-NUMBER             13030099
130400                                                                  13040099
130500         END-PERFORM                                              13050099
130600                                                                  13060099
130700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13070099
130800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13080099
130900                                                                  13090099
131000         PERFORM                                                  13100099
131100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13110099
131200                   ASC-HIGHEST-BLOCK-WRITTEN                      13120099
131300                                                                  13130099
131400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13140099
131500                                   TO PV-BLOCK-NUMBER             13150099
131600                                                                  13160099
131700             PERFORM 4410-READ-TEMP-STORAGE                       13170099
131800                                                                  13180099
131900             PERFORM 2141-CLEAR-SELECTED-INDS                     13190099
132000                 VARYING ASC-ITEM-SUB                             13200099
132100                 FROM 1 BY 1                                      13210099
132200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13220099
132300                                                                  13230099
132400             PERFORM 5100-WRITE-TEMP-STORAGE                      13240099
132500                                                                  13250099
132600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13260099
132700                                                                  13270099
132800         END-PERFORM                                              13280099
132900                                                                  13290099
133000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13300099
133100                                   TO PV-BLOCK-NUMBER             13310099
133200                                                                  13320099
133300         PERFORM 4410-READ-TEMP-STORAGE                           13330099
133400     END-IF.                                                      13340099
133500                                                                  13350099
133600     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 13360099
133700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.13370099
133800     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  13380099
133900                                                                  13390099
134000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13400099
134100                                                                  13410099
134200/                                                                 13420099
134300*----------------------------------------------------------------*13430099
134400*    MARK EACH ITEM AS BEING NOT SELECTED.                       *13440099
134500*----------------------------------------------------------------*13450099
134600                                                                  13460099
134700 2141-CLEAR-SELECTED-INDS.                                        13470099
134800                                                                  13480099
134900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13490099
135000             NOT EQUAL ZERO                                       13500099
135100         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13510099
135200             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13520099
135300                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    13530099
135400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13540099
135500                                   TO TRUE                        13550099
135600         END-IF                                                   13560099
135700     END-IF.                                                      13570099
135800                                                                  13580099
135900/                                                                 13590099
136000*----------------------------------------------------------------*13600099
136100*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *13610099
136200*  FOR ALL ITEMS.                                                *13620099
136300*----------------------------------------------------------------*13630099
136400                                                                  13640099
136500 2150-SELECT-ALL-ITEMS.                                           13650099
136600                                                                  13660099
136700     MOVE +1                       TO ASC-BLK-SUB.                13670099
136800                                                                  13680099
136900     PERFORM 2151-SET-SELECTED-INDS                               13690099
137000         VARYING ASC-ITEM-SUB                                     13700099
137100         FROM 1 BY 1                                              13710099
137200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13720099
137300                                                                  13730099
137400     ADD +1                        TO ASC-BLK-SUB.                13740099
137500                                                                  13750099
137600     PERFORM 2151-SET-SELECTED-INDS                               13760099
137700         VARYING ASC-ITEM-SUB                                     13770099
137800         FROM 1 BY 1                                              13780099
137900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13790099
138000                                                                  13800099
138100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13810099
138200                                   TO PV-LIST-ITEM-NUMBER.        13820099
138300                                                                  13830099
138400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13840099
138500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13850099
138600                                                                  13860099
138700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13870099
138800        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    13880099
138900         MOVE +1                   TO ASC-BLK-SUB                 13890099
139000                                                                  13900099
139100         PERFORM 5100-WRITE-TEMP-STORAGE                          13910099
139200                                                                  13920099
139300         MOVE +1                   TO PV-BLOCK-NUMBER             13930099
139400                                                                  13940099
139500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13950099
139600             PV-FIRST-BLOCK-IN-ARRAY - 1                          13960099
139700                                                                  13970099
139800         PERFORM                                                  13980099
139900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13990099
140000                                                                  14000099
140100             PERFORM 4410-READ-TEMP-STORAGE                       14010099
140200                                                                  14020099
140300             PERFORM 2151-SET-SELECTED-INDS                       14030099
140400                 VARYING ASC-ITEM-SUB                             14040099
140500                 FROM 1 BY 1                                      14050099
140600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14060099
140700                                                                  14070099
140800             PERFORM 5100-WRITE-TEMP-STORAGE                      14080099
140900                                                                  14090099
141000             ADD +1                TO PV-BLOCK-NUMBER             14100099
141100                                                                  14110099
141200         END-PERFORM                                              14120099
141300                                                                  14130099
141400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14140099
141500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14150099
141600                                                                  14160099
141700         PERFORM                                                  14170099
141800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14180099
141900                   ASC-HIGHEST-BLOCK-WRITTEN                      14190099
142000                                                                  14200099
142100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14210099
142200                                   TO PV-BLOCK-NUMBER             14220099
142300                                                                  14230099
142400             PERFORM 4410-READ-TEMP-STORAGE                       14240099
142500                                                                  14250099
142600             PERFORM 2151-SET-SELECTED-INDS                       14260099
142700                 VARYING ASC-ITEM-SUB                             14270099
142800                 FROM 1 BY 1                                      14280099
142900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14290099
143000                                                                  14300099
143100             PERFORM 5100-WRITE-TEMP-STORAGE                      14310099
143200                                                                  14320099
143300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14330099
143400                                                                  14340099
143500         END-PERFORM                                              14350099
143600                                                                  14360099
143700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14370099
143800                                   TO PV-BLOCK-NUMBER             14380099
143900                                                                  14390099
144000         PERFORM 4410-READ-TEMP-STORAGE                           14400099
144100     END-IF.                                                      14410099
144200                                                                  14420099
144300                                                                  14430099
144400     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             14440099
144500                       ASC-NUMBER-OF-SELECTED-ITEMS.              14450099
144600                                                                  14460099
144700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14470099
144800                                                                  14480099
144900/                                                                 14490099
145000*----------------------------------------------------------------*14500099
145100*    MARK EACH ITEM AS BEING SELECTED.                           *14510099
145200*----------------------------------------------------------------*14520099
145300                                                                  14530099
145400 2151-SET-SELECTED-INDS.                                          14540099
145500                                                                  14550099
145600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14560099
145700             NOT EQUAL ZERO                                       14570099
145800         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14580099
145900             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14590099
146000                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        14600099
146100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14610099
146200                               TO  TRUE                           14620099
146300         END-IF                                                   14630099
146400     END-IF.                                                      14640099
146500                                                                  14650099
146600*----------------------------------------------------------------*14660099
146700*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *14670099
146800*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *14680099
146900*----------------------------------------------------------------*14690099
147000                                                                  14700099
147100 2200-MOVE-SCREEN-TO-COMMAREA.                                    14710099
147200                                                                  14720099
147300     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             14730099
147400     MOVE +1                       TO PV-SUB.                     14740099
147500                                                                  14750099
147600     IF  ASTRTITL > ZERO                                          14760099
147700         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          14770099
147800     ELSE                                                         14780099
147900         IF  ASTRTITF EQUAL DP015-ERASE-EOF                       14790099
148000             INITIALIZE ASC-START-ITEM-REQUEST                    14800099
148100         END-IF                                                   14810099
148200     END-IF.                                                      14820099
148300                                                                  14830099
148400     PERFORM 3100-SET-SUBSCRIPTS.                                 14840099
148500                                                                  14850099
148600     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          14860099
148700         VARYING PV-SUB                                           14870099
148800         FROM 1 BY 1                                              14880099
148900         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      14890099
149000                                                                  14900099
149100******************************************************************14910099
149200** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**14920099
149300******************************************************************14930099
149400                                                                  14940099
149500 2210-MOVE-LINES-TO-COMMAREA.                                     14950099
149600                                                                  14960099
149700     IF  MR-SELECT-L (PV-SUB) > ZERO                              14970099
149800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             14980099
149900         MOVE MR-SELECT-I (PV-SUB)                                14990099
150000                                   TO ASC-TEMP-SELECTED-SW        15000099
150100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15010099
150200     ELSE                                                         15020099
150300         IF  MR-SELECT-A (PV-SUB) = DP015-ERASE-EOF               15030099
150400                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     15040099
150500                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        15050099
150600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15060099
150700         END-IF                                                   15070099
150800     END-IF.                                                      15080099
150900                                                                  15090099
151000***** CHANGED MR-ADJ-QTY-I TO X                                   15100099
151100                                                                  15110099
151200     IF  MR-ADJ-QTY-L (PV-SUB) > ZERO                             15120099
151300         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             15130099
151400         MOVE MR-ADJ-QTY-X (PV-SUB)                               15140099
151500                                   TO ASC-ADJ-QTY-X               15150099
151600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15160099
151700     ELSE                                                         15170099
151800         IF  MR-ADJ-QTY-A (PV-SUB) = DP015-ERASE-EOF              15180099
151900                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     15190099
152000                 MOVE SPACES       TO  ASC-ADJ-QTY-X              15200099
152100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15210099
152200                                       MR-ADJ-QTY-X (PV-SUB)      15220099
152300         END-IF                                                   15230099
152400     END-IF.                                                      15240099
152500                                                                  15250099
152600     ADD +1                        TO ASC-ITEM-SUB.               15260099
152700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        15270099
152800         ADD +1                    TO ASC-BLK-SUB                 15280099
152900         MOVE +1                   TO ASC-ITEM-SUB                15290099
153000     END-IF.                                                      15300099
153100                                                                  15310099
153200*----------------------------------------------------------------*15320099
153300*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *15330099
153400*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *15340099
153500*----------------------------------------------------------------*15350099
153600                                                                  15360099
153700 3000-EDIT-DATA-IN-COMMAREA.                                      15370099
153800                                                                  15380099
153900     SET PS-NO-ERROR               TO TRUE.                       15390099
154000     PERFORM 3200-RESET-ATTRIBUTES.                               15400099
154100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     15410099
154200**                                                                15420099
154300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              15430099
154400* EDITTING IS DONE FROM THE BOTTOM UP.                            15440099
154500**                                                                15450099
154600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       15460099
154700         ASC-ITEMS-DISPLAYED - 1.                                 15470099
154800     PERFORM 3100-SET-SUBSCRIPTS.                                 15480099
154900     PERFORM 3300-EDIT-SELECTIONS                                 15490099
155000         VARYING PV-SUB                                           15500099
155100         FROM PV-SUB BY -1                                        15510099
155200         UNTIL PV-SUB < +1.                                       15520099
155300                                                                  15530099
155400     IF  PS-NO-ERROR                                              15540099
155500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        15550099
155600     END-IF.                                                      15560099
155700                                                                  15570099
155800     IF  ((PS-NO-ERROR)                                           15580099
155900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   15590099
156000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    15600099
156100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  15610099
156200     END-IF.                                                      15620099
156300/                                                                 15630099
156400*----------------------------------------------------------------*15640099
156500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *15650099
156600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*15660099
156700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *15670099
156800*                                                                *15680099
156900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *15690099
157000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *15700099
157100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *15710099
157200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *15720099
157300*----------------------------------------------------------------*15730099
157400                                                                  15740099
157500 3100-SET-SUBSCRIPTS.                                             15750099
157600                                                                  15760099
157700     COMPUTE ASC-ITEM-SUB =                                       15770099
157800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        15780099
157900                                                                  15790099
158000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         15800099
158100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            15810099
158200                                                                  15820099
158300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               15830099
158400     ELSE                                                         15840099
158500         MOVE +1                     TO ASC-BLK-SUB               15850099
158600     END-IF.                                                      15860099
158700                                                                  15870099
158800*----------------------------------------------------------------*15880099
158900*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *15890099
159000*----------------------------------------------------------------*15900099
159100                                                                  15910099
159200 3200-RESET-ATTRIBUTES.                                           15920099
159300                                                                  15930099
159400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   15940099
159500     MOVE DP015-GREEN              TO ASTRTITC.                   15950099
159600     MOVE DP015-UNDERLINE          TO ASTRTITH.                   15960099
159700     SET PS-ALL-LINES-PROTECTED    TO TRUE.                       15970099
159800                                                                  15980099
159900     PERFORM                                                      15990099
160000         VARYING PV-SUB                                           16000099
160100         FROM 1 BY 1                                              16010099
160200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                       16020099
160300         IF MR-ADJ-QTY-A (PV-SUB) = DP015-ASK-DRK-OFF             16030099
160400              CONTINUE                                            16040099
160500            ELSE                                                  16050099
160600             IF ASC-OVERAGE                                       16060099
160700                 IF MR-ADJ-QTY-C (PV-SUB) = DP015-YELLOW          16070099
160800                     MOVE DP015-PRO-NOR-OFF                       16080099
160900                                     TO MR-SELECT-A  (PV-SUB)     16090099
161000                     MOVE DP015-PRO-NOR-OFF                       16100099
161100                                     TO MR-ADJ-QTY-A (PV-SUB)     16110099
161200                     MOVE DP015-UNDERLINE                         16120099
161300                                     TO MR-SELECT-H  (PV-SUB)     16130099
161400                                        MR-ADJ-QTY-H (PV-SUB)     16140099
161500                     MOVE DP015-BLUE                              16150099
161600                                     TO MR-SELECT-C  (PV-SUB)     16160099
161700                 ELSE                                             16170099
161800                     MOVE DP015-PRO-NOR-OFF                       16180099
161900                                     TO MR-SELECT-A  (PV-SUB)     16190099
162000                     MOVE SPACE      TO MR-SELECT-I  (PV-SUB)     16200099
162100                     MOVE DP015-PRO-NOR-OFF                       16210099
162200                                     TO MR-ADJ-QTY-A (PV-SUB)     16220099
162300                     IF MR-ADJ-QTY-C (PV-SUB) =                   16230099
162400                                        DP015-GREEN               16240099
162500                          MOVE DP015-BLUE                         16250099
162600                                         TO MR-ADJ-QTY-C (PV-SUB) 16260099
162700                          ELSE                                    16270099
162800                             CONTINUE                             16280099
162900                     END-IF                                       16290099
163000                     MOVE DP015-BLUE                              16300099
163100                                      TO MR-SELECT-C  (PV-SUB)    16310099
163200                     MOVE DP015-UNDERLINE                         16320099
163300                                       TO MR-SELECT-H  (PV-SUB)   16330099
163400                                            MR-ADJ-QTY-H (PV-SUB) 16340099
163500                     END-IF                                       16350099
163600             ELSE                                                 16360099
163700                     MOVE DP015-UNP-ALP-NOR-OFF                   16370099
163800                                     TO MR-SELECT-A  (PV-SUB)     16380099
163900                     MOVE DP015-UNP-NUM-NOR-OFF                   16390099
164000                                     TO MR-ADJ-QTY-A (PV-SUB)     16400099
164100                     MOVE DP015-GREEN                             16410099
164200                                     TO MR-SELECT-C  (PV-SUB)     16420099
164300                                        MR-ADJ-QTY-C (PV-SUB)     16430099
164400                     MOVE DP015-BLUE                              16440099
164500                                     TO MR-PO-LNE-NBR-C (PV-SUB)  16450099
164600                     MOVE DP015-UNDERLINE                         16460099
164700                                     TO MR-SELECT-H  (PV-SUB)     16470099
164800                                        MR-ADJ-QTY-H (PV-SUB)     16480099
164900             END-IF                                               16490099
165000        END-IF                                                    16500099
165100     END-PERFORM.                                                 16510099
165200                                                                  16520099
165300*----------------------------------------------------------------*16530099
165400*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *16540099
165500*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *16550099
165600*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *16560099
165700*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *16570099
165800*----------------------------------------------------------------*16580099
165900                                                                  16590099
166000 3300-EDIT-SELECTIONS.                                            16600099
166100                                                                  16610099
166200     EVALUATE TRUE                                                16620099
166300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16630099
166400             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         16640099
166500               IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      16650099
166600                   CONTINUE                                       16660099
166700               END-IF                                             16670099
166800                                                                  16680099
166900         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         16690099
167000             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        16700099
167100                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   16710099
167200                 MOVE ASC-TEMP-SELECTED-SW                        16720099
167300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16730099
167400                                TO ASC-SELECTED-SW                16740099
167500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16750099
167600             END-IF                                               16760099
167700                                                                  16770099
167800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16780099
167900                 = SPACE                                          16790099
168000             EVALUATE TRUE                                        16800099
168100                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       16810099
168200                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS16820099
168300                     MOVE SPACE TO ASC-SELECTED-SW                16830099
168400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16840099
168500                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        16850099
168600                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    16860099
168700                     MOVE SPACE TO ASC-SELECTED-SW                16870099
168800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16880099
168900                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          16890099
169000                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      16900099
169100                     MOVE SPACE TO ASC-SELECTED-SW                16910099
169200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16920099
169300             END-EVALUATE                                         16930099
169400                                                                  16940099
169500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           16950099
169600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16960099
169700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    16970099
169800             END-IF                                               16980099
169900             PERFORM 3310-EDIT-RANGE                              16990099
170000                                                                  17000099
170100         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             17010099
170200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17020099
170300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    17030099
170400             END-IF                                               17040099
170500             PERFORM 3310-EDIT-RANGE                              17050099
170600                                                                  17060099
170700         WHEN OTHER                                               17070099
170800             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           17080099
170900             SET DP020-MSG-FATAL    TO TRUE                       17090099
171000             MOVE -1                TO MR-SELECT-L (PV-SUB)       17100099
171100             SET DP030-SET-CURSOR-APPL-1                          17110099
171200                                    TO TRUE                       17120099
171300             MOVE DP015-RED         TO MR-SELECT-C (PV-SUB)       17130099
171400             MOVE DP015-REVERSE     TO MR-SELECT-H (PV-SUB)       17140099
171500             SET PS-ERROR TO TRUE                                 17150099
171600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17160099
171700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     17170099
171800                 MOVE SPACE         TO ASC-SELECTED-SW            17180099
171900                                        (ASC-BLK-SUB ASC-ITEM-SUB)17190099
172000             END-IF                                               17200099
172100                                                                  17210099
172200     END-EVALUATE.                                                17220099
172300                                                                  17230099
172400     IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                    17240099
172500         MOVE ASC-ADJ-QTY-X  (ASC-BLK-SUB ASC-ITEM-SUB)           17250099
172600                                    TO  PV-WORK-QTY-X             17260099
172700         PERFORM 3320-VALIDATE-QUANTITY                           17270099
172800     END-IF.                                                      17280099
172900                                                                  17290099
173000     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 17300099
173100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               17310099
173200     IF  ASC-ITEM-SUB < 1                                         17320099
173300         SUBTRACT +1 FROM ASC-BLK-SUB                             17330099
173400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                17340099
173500     END-IF.                                                      17350099
173600                                                                  17360099
173700*----------------------------------------------------------------*17370099
173800*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *17380099
173900*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *17390099
174000*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *17400099
174100*  THE ENDING.                                                   *17410099
174200*----------------------------------------------------------------*17420099
174300                                                                  17430099
174400 3310-EDIT-RANGE.                                                 17440099
174500                                                                  17450099
174600     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                17460099
174700         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   17470099
174800             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)17480099
174900                                   TO ASC-SELECTED-SW             17490099
175000                                        (ASC-BLK-SUB ASC-ITEM-SUB)17500099
175100             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 17510099
175200         ELSE                                                     17520099
175300             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     17530099
175400                 CONTINUE                                         17540099
175500             ELSE                                                 17550099
175600*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        17560099
175700                 MOVE PC-TSYMSG-00054                             17570099
175800                                   TO DP020-MSG-NUMBER            17580099
175900                 SET DP020-MSG-FATAL                              17590099
176000                                   TO TRUE                        17600099
176100                 MOVE -1           TO MR-SELECT-L (PV-SUB)        17610099
176200                 SET DP030-SET-CURSOR-APPL-1                      17620099
176300                                   TO TRUE                        17630099
176400                 MOVE DP015-RED    TO MR-SELECT-C (PV-SUB)        17640099
176500                 MOVE DP015-UNDERLINE                             17650099
176600                                   TO MR-SELECT-H (PV-SUB)        17660099
176700                 SET PS-ERROR      TO TRUE                        17670099
176800             END-IF                                               17680099
176900         END-IF                                                   17690099
177000     ELSE                                                         17700099
177100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     17710099
177200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 17720099
177300                                   TO ASC-SELECTED-SW             17730099
177400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   17740099
177500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   17750099
177600         ELSE                                                     17760099
177700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       17770099
177800                 CONTINUE                                         17780099
177900             ELSE                                                 17790099
178000*                -- ONLY ONE END-OF-RANGE ALLOWED --              17800099
178100                 MOVE PC-TSYMSG-00055                             17810099
178200                                   TO DP020-MSG-NUMBER            17820099
178300                 SET DP020-MSG-FATAL                              17830099
178400                                   TO TRUE                        17840099
178500                 MOVE -1           TO MR-SELECT-L (PV-SUB)        17850099
178600                 SET DP030-SET-CURSOR-APPL-1                      17860099
178700                                   TO TRUE                        17870099
178800                 SET PS-ERROR      TO TRUE                        17880099
178900             END-IF                                               17890099
179000         END-IF                                                   17900099
179100     END-IF.                                                      17910099
179200                                                                  17920099
179300 3320-VALIDATE-QUANTITY.                                          17930099
179400                                                                  17940099
179500     MOVE PV-WORK-QTY-X          TO  DP010I-UNEDITED-FIELD.       17950099
179600     MOVE LENGTH OF ASC-ADJ-QTY  TO  DP010I-MAXIMUM-DIGITS.       17960099
179700     MOVE ZERO                   TO  DP010I-MAXIMUM-DECIMALS.     17970099
179800     SET DP010I-NEGATIVE-NOT-ALLOWED                              17980099
179900                                 TO  TRUE.                        17990099
180000     CALL DP010I-NUMERIC-EDIT-ROUTINE                             18000099
180010          USING DP010I-NUMERIC-EDIT-AREA.                         18001099
180100                                                                  18010099
180200     IF  DP010I-ERROR-DETECTED                                    18020099
180300         MOVE PC-TSYMSG-00008    TO  DP020-MSG-NUMBER             18030099
180400         SET DP020-MSG-FATAL                                      18040099
180500             PS-ERROR            TO  TRUE                         18050099
180600         MOVE -1                 TO  MR-ADJ-QTY-L (PV-SUB)        18060099
180700         MOVE DP015-RED          TO  MR-ADJ-QTY-C (PV-SUB)        18070099
180800         MOVE DP015-REVERSE      TO  MR-ADJ-QTY-H (PV-SUB)        18080099
180900         SET DP030-SET-CURSOR-APPL-1                              18090099
181000                                 TO  TRUE                         18100099
181100     ELSE                                                         18110099
181200         MOVE DP010I-NUMERIC-FIELD                                18120099
181300                                 TO  ASC-ADJ-QTY                  18130099
181400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18140099
181500                                     MR-ADJ-QTY-O(PV-SUB)         18150099
181600     END-IF.                                                      18160099
181700                                                                  18170099
181800*----------------------------------------------------------------*18180099
181900*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *18190099
182000*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *18200099
182100*----------------------------------------------------------------*18210099
182200                                                                  18220099
182300 3400-CHECK-RANGE-SEQUENCE.                                       18230099
182400                                                                  18240099
182500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       18250099
182600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      18260099
182700       AND  ASC-START-OF-SELECTED-RANGE >                         18270099
182800                                         ASC-END-OF-SELECTED-RANGE18280099
182900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                18290099
183000         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 18300099
183100         SET DP020-MSG-FATAL TO TRUE                              18310099
183200         SET PS-ERROR TO TRUE                                     18320099
183300         PERFORM 3410-POSITION-AT-ERROR                           18330099
183400     END-IF.                                                      18340099
183500                                                                  18350099
183600*----------------------------------------------------------------*18360099
183700*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *18370099
183800*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *18380099
183900*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *18390099
184000*----------------------------------------------------------------*18400099
184100                                                                  18410099
184200 3410-POSITION-AT-ERROR.                                          18420099
184300                                                                  18430099
184400     SET DP030-SET-CURSOR-APPL-1                                  18440099
184500                                   TO TRUE.                       18450099
184600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 18460099
184700                    - PV-TOP-ITEM + 1.                            18470099
184800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      18480099
184900         CONTINUE                                                 18490099
185000     ELSE                                                         18500099
185100         MOVE -1                   TO MR-SELECT-L (PV-SUB)        18510099
185200         MOVE DP015-REVERSE        TO MR-SELECT-H (PV-SUB)        18520099
185300         MOVE DP015-RED            TO MR-SELECT-C (PV-SUB)        18530099
185400     END-IF.                                                      18540099
185500                                                                  18550099
185600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   18560099
185700                    - PV-TOP-ITEM + 1.                            18570099
185800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      18580099
185900         CONTINUE                                                 18590099
186000     ELSE                                                         18600099
186100         MOVE -1                   TO MR-SELECT-L (PV-SUB)        18610099
186200         MOVE DP015-REVERSE        TO MR-SELECT-H (PV-SUB)        18620099
186300         MOVE DP015-RED            TO MR-SELECT-C (PV-SUB)        18630099
186400     END-IF.                                                      18640099
186500/                                                                 18650099
186600*----------------------------------------------------------------*18660099
186700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *18670099
186800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *18680099
186900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *18690099
187000*----------------------------------------------------------------*18700099
187100                                                                  18710099
187200 3500-MARK-RANGE-AS-SELECTED.                                     18720099
187300                                                                  18730099
187400     MOVE +1                       TO  ASC-BLK-SUB.               18740099
187500     PERFORM 3510-MARK-SELECTED-INDS                              18750099
187600         VARYING ASC-ITEM-SUB                                     18760099
187700         FROM 1 BY 1                                              18770099
187800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18780099
187900                                                                  18790099
188000     ADD +1                        TO ASC-BLK-SUB.                18800099
188100     PERFORM 3510-MARK-SELECTED-INDS                              18810099
188200         VARYING ASC-ITEM-SUB                                     18820099
188300         FROM 1 BY 1                                              18830099
188400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18840099
188500                                                                  18850099
188600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18860099
188700                                   TO  PV-LIST-ITEM-NUMBER.       18870099
188800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18880099
188900         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         18890099
189000               PC-ITEMS-PER-PANEL).                               18900099
189100                                                                  18910099
189200     MOVE ASC-START-OF-SELECTED-RANGE                             18920099
189300                                   TO PV-START-OF-SELECTED-RANGE. 18930099
189400     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            18940099
189500         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  18950099
189600               PC-ITEMS-PER-PANEL).                               18960099
189700                                                                  18970099
189800     MOVE ASC-END-OF-SELECTED-RANGE                               18980099
189900                                   TO  PV-END-OF-SELECTED-RANGE.  18990099
190000     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             19000099
190100         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    19010099
190200               PC-ITEMS-PER-PANEL).                               19020099
190300     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             19030099
190400         PV-FIRST-BLOCK-IN-ARRAY + 1.                             19040099
190500                                                                  19050099
190600     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    19060099
190700        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        19070099
190800         MOVE +1                   TO ASC-BLK-SUB                 19080099
190900         PERFORM 5100-WRITE-TEMP-STORAGE                          19090099
191000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19100099
191100             PV-FIRST-BLOCK-IN-ARRAY - 1                          19110099
191200                                                                  19120099
191300         PERFORM                                                  19130099
191400             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      19140099
191500                   PV-PREV-BLOCK-IN-ARRAY                         19150099
191600             MOVE PV-FIRST-BLOCK-IN-RANGE                         19160099
191700                                   TO PV-BLOCK-NUMBER             19170099
191800             PERFORM 4410-READ-TEMP-STORAGE                       19180099
191900             PERFORM 3510-MARK-SELECTED-INDS                      19190099
192000                 VARYING ASC-ITEM-SUB                             19200099
192100                 FROM 1 BY 1                                      19210099
192200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19220099
192300             PERFORM 5100-WRITE-TEMP-STORAGE                      19230099
192400             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     19240099
192500         END-PERFORM                                              19250099
192600                                                                  19260099
192700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19270099
192800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19280099
192900         PERFORM                                                  19290099
193000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19300099
193100                   PV-LAST-BLOCK-IN-RANGE                         19310099
193200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19320099
193300                                   TO PV-BLOCK-NUMBER             19330099
193400             PERFORM 4410-READ-TEMP-STORAGE                       19340099
193500             PERFORM 3510-MARK-SELECTED-INDS                      19350099
193600                 VARYING ASC-ITEM-SUB                             19360099
193700                 FROM 1 BY 1                                      19370099
193800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19380099
193900             PERFORM 5100-WRITE-TEMP-STORAGE                      19390099
194000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19400099
194100         END-PERFORM                                              19410099
194200                                                                  19420099
194300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19430099
194400                                   TO PV-BLOCK-NUMBER             19440099
194500         PERFORM 4410-READ-TEMP-STORAGE                           19450099
194600     END-IF.                                                      19460099
194700                                                                  19470099
194800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 19480099
194900                                      ASC-END-OF-SELECTED-RANGE.  19490099
195000/                                                                 19500099
195100*----------------------------------------------------------------*19510099
195200* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *19520099
195300*----------------------------------------------------------------*19530099
195400                                                                  19540099
195500 3510-MARK-SELECTED-INDS.                                         19550099
195600                                                                  19560099
195700     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         19570099
195800                                ASC-ITEM-SUB) >                   19580099
195900         ASC-START-OF-SELECTED-RANGE)                             19590099
196000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         19600099
196100                                ASC-ITEM-SUB) =                   19610099
196200         ASC-START-OF-SELECTED-RANGE)                             19620099
196300                                                                  19630099
196400         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     19640099
196500                                    ASC-ITEM-SUB) <               19650099
196600             ASC-END-OF-SELECTED-RANGE)                           19660099
196700         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     19670099
196800                                    ASC-ITEM-SUB) =               19680099
196900             ASC-END-OF-SELECTED-RANGE)                           19690099
197000                                                                  19700099
197100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19710099
197200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   19720099
197300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   19730099
197400                               TO TRUE                            19740099
197500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              19750099
197600                               TO TRUE                            19760099
197700                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    19770099
197800             END-IF                                               19780099
197900         END-IF                                                   19790099
198000     END-IF.                                                      19800099
198100/                                                                 19810099
198200*----------------------------------------------------------------*19820099
198300*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *19830099
198400*    INITIALIZE ALL COUNTERS AND FLAGS.                          *19840099
198500*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *19850099
198600*    DISPLAY THE PANEL TO USER.                                  *19860099
198700*----------------------------------------------------------------*19870099
198800                                                                  19880099
198900 4000-BUILD-INITIAL-PANEL.                                        19890099
199000                                                                  19900099
199100     PERFORM 5810-GET-STR-RECDIS-QTY.                             19910099
199200     MOVE RECDIS-AP-VERIFY-ITM-QTY     TO  ASC-TOT-ADJ-QTY        19920099
199300                                           ASC-TOT-ORG-QTY.       19930099
199400                                                                  19940099
199500     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            19950099
199600                                 ASC-BLOCK-ENTRIES (2).           19960099
199700     MOVE +1                 TO ASC-BLK-SUB.                      19970099
199800     SET ASC-ITEMS-LEFT-ON-DB                                     19980099
199900         ASC-CAN-VERIFY      TO TRUE.                             19990099
200000                                                                  20000099
200100     MOVE +0                 TO ASC-ITEM-SUB                      20010099
200200                                ASC-NUMBER-OF-ITEMS-READ          20020099
200300                                ASC-NUMBER-OF-SELECTED-ITEMS      20030099
200400                                ASC-HIGHEST-BLOCK-WRITTEN         20040099
200500                                ASC-START-OF-SELECTED-RANGE       20050099
200600                                ASC-END-OF-SELECTED-RANGE         20060099
200700                                ASC-ITEM-AT-TOP-OF-PANEL.         20070099
200800     PERFORM 4010-OPEN-CURSOR.                                    20080099
200900                                                                  20090099
201000     PERFORM 4300-READ-ITEMS-FROM-DB.                             20100099
201100                                                                  20110099
201200     PERFORM 4020-CLOSE-CURSOR.                                   20120099
201300                                                                  20130099
201400     MOVE +1                   TO  PV-TOP-ITEM.                   20140099
201500     MOVE SPACE                TO  ASC-START-ITEM-REQUEST.        20150099
201600     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          20160099
201700         SET DP020-FK-RETURN (DP020-SRC-AID)                      20170099
201800             DP020-MSG-FATAL   TO  TRUE                           20180099
201900         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               20190099
202000     ELSE                                                         20200099
202100         SET DP030-SET-CURSOR-APPL-1                              20210099
202200                               TO TRUE                            20220099
202300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     20230099
202400     END-IF.                                                      20240099
202500/                                                                 20250099
202600*----------------------------------------------------------------*20260099
202700* OPEN THE CURSOR.                                               *20270099
202800*----------------------------------------------------------------*20280099
202900                                                                  20290099
203000 4010-OPEN-CURSOR.                                                20300099
203100                                                                  20310099
203200     EXEC SQL                                                     20320099
203300          OPEN LIST-CSR                                           20330099
203400     END-EXEC.                                                    20340099
203500                                                                  20350099
203600     EVALUATE TRUE                                                20360099
203700         WHEN SQLCODE = ZERO                                      20370099
203800            MOVE PURCHS-DEPT-NBR       TO  ASC-DEPT-NBR           20380099
203900         WHEN SQLCODE = +100                                      20390099
204000              CONTINUE                                            20400099
204100         WHEN SQLCODE = -904                                      20410099
204200         WHEN SQLCODE = -911                                      20420099
204300         WHEN SQLCODE = -913                                      20430099
204400              PERFORM 9900-SOFT-ABORT                             20440099
204500         WHEN SQLWARN0 NOT = SPACES                               20450099
204600         WHEN SQLCODE < ZERO                                      20460099
204700         WHEN SQLCODE > ZERO                                      20470099
204800              MOVE '4010-OPEN-CURSOR'                             20480099
204900                                   TO  DP013-PARAGRAPH            20490099
205000              MOVE 'OPEN LIST CURSOR - '                          20500099
205100                                   TO  DP013-MESSAGE-TEXT (1)     20510099
205200              MOVE SQLCA           TO  DP013-SQLCA                20520099
205300              MOVE 'TRECEIV '      TO  DP013-DB2-TABLE-NAME (1)   20530099
205400              MOVE 'TRECITM '      TO  DP013-DB2-TABLE-NAME (2)   20540099
205500              SET DP013-DB2-ABEND                                 20550099
205600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              20560099
205700                 PERFORM DP013-0000-PROCESS-ABEND                 20570099
205800         END-EVALUATE.                                            20580099
205900/                                                                 20590099
206000*----------------------------------------------------------------*20600099
206100* CLOSE THE TRECITM CURSOR.                                      *20610099
206200*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *20620099
206300*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *20630099
206400*   USER.                                                        *20640099
206500*----------------------------------------------------------------*20650099
206600                                                                  20660099
206700 4020-CLOSE-CURSOR.                                               20670099
206800                                                                  20680099
206900     EXEC SQL                                                     20690099
207000          CLOSE LIST-CSR                                          20700099
207100     END-EXEC.                                                    20710099
207200                                                                  20720099
207300     EVALUATE TRUE                                                20730099
207400         WHEN SQLCODE = ZERO                                      20740099
207500             CONTINUE                                             20750099
207600         WHEN SQLCODE = -904                                      20760099
207700         WHEN SQLCODE = -911                                      20770099
207800         WHEN SQLCODE = -913                                      20780099
207900              PERFORM 9900-SOFT-ABORT                             20790099
208000         WHEN SQLWARN0 NOT = SPACES                               20800099
208100         WHEN SQLCODE < ZERO                                      20810099
208200         WHEN SQLCODE > ZERO                                      20820099
208300             MOVE '4020-CLOSE-CURSOR'                             20830099
208400                               TO DP013-PARAGRAPH                 20840099
208500             MOVE 'CLOSE LIST CURSOR '                            20850099
208600                               TO DP013-MESSAGE-TEXT (1)          20860099
208700             MOVE SQLCA        TO DP013-SQLCA                     20870099
208800             MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)        20880099
208900             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        20890099
209000             SET DP013-DB2-ABEND                                  20900099
209100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20910099
209200             PERFORM DP013-0000-PROCESS-ABEND                     20920099
209300     END-EVALUATE.                                                20930099
209400/                                                                 20940099
209500*----------------------------------------------------------------*20950099
209600*    SET UP THE HOST VARIABLES.                                  *20960099
209700*----------------------------------------------------------------*20970099
209800                                                                  20980099
209900 4100-PREPARE-CURSOR.                                             20990099
210000                                                                  21000099
210100     MOVE RC017-OPER-UNT-ID       TO  ASC-OPER-UNT-ID.            21010099
210200     MOVE RC017-FCLTY-ID          TO  ASC-FCLTY-ID.               21020099
210300     MOVE RC017-PO-NBR            TO  ASC-PO-NBR.                 21030099
210400                                                                  21040099
210500     MOVE RC017-STR-NBR           TO  ASC-STR-NBR.                21050099
210600     MOVE RC017-REC-SEQ-NBR       TO  ASC-REC-SEQ-NBR.            21060099
210700     MOVE RC017-FCLTY-NME         TO  ASC-FCLTY-NME.              21070099
210800                                                                  21080099
210900     IF  RC017-PO-LNE-NBR GREATER THAN ZERO                       21090099
211000         MOVE RC017-PO-LNE-NBR    TO  ASC-ORD-LNE-NBR-LOW         21100099
211100                                      ASC-ORD-LNE-NBR-HIGH        21110099
211200     ELSE                                                         21120099
211300         MOVE ZERO                TO  ASC-ORD-LNE-NBR-LOW         21130099
211400         MOVE PC-9999             TO  ASC-ORD-LNE-NBR-HIGH        21140099
211500     END-IF.                                                      21150099
211600                                                                  21160099
211700                                                                  21170099
211800/                                                                 21180099
211900*----------------------------------------------------------------*21190099
212000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *21200099
212100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *21210099
212200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *21220099
212300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *21230099
212400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *21240099
212500*                                                                *21250099
212600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *21260099
212700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *21270099
212800*    UPON INITIALIZATION.                                        *21280099
212900*----------------------------------------------------------------*21290099
213000                                                                  21300099
213100 4300-READ-ITEMS-FROM-DB.                                         21310099
213200                                                                  21320099
213300     PERFORM                                                      21330099
213400         VARYING PV-READ-COUNT                                    21340099
213500         FROM 1 BY 1                                              21350099
213600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21360099
213700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         21370099
213800                                                                  21380099
213900         PERFORM 4310-FETCH                                       21390099
214000                                                                  21400099
214010*----------------------------------------------------------------*21401099
214020*                                               **   WR # 21361  *21402099
214030* ADDED CODE TO CHECK FOR THE DUMMY SKU AND CALL TO XLKUT001     *21403099
214040*----------------------------------------------------------------*21404099
214050         IF PURITM-ITM-NBR < 0                                    21405099
214060            MOVE '4300-READ-ITEMS-FROM-DB'                        21406099
214070                             TO DP013-PARAGRAPH                   21407099
214080            MOVE 'PURITM-ITM-NBR < 0  '                           21408099
214090                             TO DP013-MESSAGE-TEXT (1)            21409099
214091            MOVE SQLCA       TO DP013-SQLCA                       21409199
214092            SET DP013-DB2-ABEND                                   21409299
214093                             TO TRUE                              21409399
214094            PERFORM DP013-0000-PROCESS-ABEND                      21409499
214095         END-IF                                                   21409599
214096                                                                  21409699
214106         IF PURITM-ITM-NBR = 0                                    21410699
214107            IF PURITM-SKU-SEQ-NBR = PC-000                        21410799
214108               MOVE '00000000'    TO PV-CS-SKU                    21410899
214109            ELSE                                                  21410999
214110               IF PURITM-SKU-SEQ-NBR = PC-999                     21411099
214120                  MOVE '99999999' TO PV-CS-SKU                    21412099
214121               ELSE                                               21412199
214122                  MOVE '4300-READ-ITEMS-FROM-DB'                  21412299
214123                                  TO DP013-PARAGRAPH              21412399
214124                  MOVE 'PURITM-ITM-NBR = 0  '                     21412499
214125                                  TO DP013-MESSAGE-TEXT (1)       21412599
214128                  MOVE SQLCA      TO DP013-SQLCA                  21412899
214129                  SET DP013-DB2-ABEND                             21412999
214130                                  TO TRUE                         21413099
214131                  PERFORM DP013-0000-PROCESS-ABEND                21413199
214132               END-IF                                             21413299
214133            END-IF                                                21413399
214134         END-IF                                                   21413499
214135                                                                  21413599
214136         IF PURITM-ITM-NBR > 0 AND                                21413699
214137            PS-CALL-API-YES    AND                                21413799
214138            ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                21413899
214139             (PURITM-SKU-SEQ-NBR NOT = PC-999))                   21413999
214140              PERFORM 4315-CALL-XLKUT-DOMAIN-PGM                  21414099
214141         END-IF                                                   21414199
214142                                                                  21414299
214150         IF  ASC-ITEMS-LEFT-ON-DB                                 21415099
214200                                                                  21420099
214300             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                21430099
214400                 ADD +1            TO  ASC-ITEM-SUB               21440099
214500             ELSE                                                 21450099
214600                 ADD +1            TO  ASC-BLK-SUB                21460099
214700                 MOVE +1           TO  ASC-ITEM-SUB               21470099
214800                                                                  21480099
214900                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         21490099
215000                     MOVE +1       TO  ASC-BLK-SUB                21500099
215100                     SET ASC-BLOCK-MODIFIED (1)                   21510099
215200                                   TO  TRUE                       21520099
215300                     PERFORM 5100-WRITE-TEMP-STORAGE              21530099
215400                     MOVE ASC-BLOCK-ENTRIES                       21540099
215500                               (PC-MAX-BLOCKS-IN-ARRAY)           21550099
215600                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 21560099
215700                     ADD +1        TO  ASC-BLK-SUB                21570099
215800                     INITIALIZE ASC-BLOCK-ENTRIES(ASC-BLK-SUB)    21580099
215900                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      21590099
216000                                   TO  TRUE                       21600099
216100                 END-IF                                           21610099
216200             END-IF                                               21620099
216300                                                                  21630099
216400                 ADD +1            TO ASC-NUMBER-OF-ITEMS-READ    21640099
216500                 MOVE ASC-NUMBER-OF-ITEMS-READ                    21650099
216600                                   TO  ASC-LIST-ITEM-NUMBER       21660099
216700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21670099
216800                 MOVE RECITM-ORD-LNE-NBR                          21680099
216900                                   TO  ASC-ORD-LNE-NBR            21690099
217000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21700099
217100                 MOVE RECDIS-AP-VERIFY-ITM-QTY                    21710099
217200                                   TO  ASC-VERIFY-ITM-QTY         21720099
217300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21730099
217400                 MOVE RECDIS-EXPTED-ITM-QTY                       21740099
217500                                   TO  ASC-PCKSLP-ITM-QTY         21750099
217600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21760099
217700                 MOVE RECDIS-VERIFY-ITM-QTY                       21770099
217800                                   TO  ASC-ACTUAL-ITM-QTY         21780099
217900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21790099
218000                 MOVE PURITM-CL-NBR                               21800099
218100                                   TO  PV-CS-CLASS                21810099
218400                 MOVE PV-CLASS-SKU   TO  ASC-CLASS-SKU            21840099
218500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21850099
218600                 MOVE RECEIV-STATUS-CDE                           21860099
218700                                  TO  ASC-HOLD-RECEIV-STATUS-CDE  21870099
218800                 PERFORM 4305-CHECK-AP-CODE                       21880099
218900         END-IF                                                   21890099
219000     END-PERFORM.                                                 21900099
219100                                                                  21910099
219200     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          21920099
219300         MOVE +1               TO ASC-BLK-SUB                     21930099
219400         PERFORM 5100-WRITE-TEMP-STORAGE                          21940099
219500         ADD +1                TO ASC-BLK-SUB                     21950099
219600         PERFORM 5100-WRITE-TEMP-STORAGE                          21960099
219700                                                                  21970099
219800         MOVE 1                TO ASC-BLK-SUB                     21980099
219900                                  PV-BLOCK-NUMBER                 21990099
220000         PERFORM 4410-READ-TEMP-STORAGE                           22000099
220100         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             22010099
220200             MOVE 2            TO ASC-BLK-SUB                     22020099
220300                                  PV-BLOCK-NUMBER                 22030099
220400             PERFORM 4410-READ-TEMP-STORAGE                       22040099
220500         END-IF                                                   22050099
220600                                                                  22060099
220700         PERFORM 4320-GET-VENDOR-NAME                             22070099
220800     END-IF.                                                      22080099
220810*----------------------------------------------------------------*22081099
220820* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *22082099
220830*----------------------------------------------------------------*22083099
220900/                                                                 22090099
221000*----------------------------------------------------------------*22100099
221100*    CHECK THE RECDIS-AP-PRC-CDE                                 *22110099
221200*----------------------------------------------------------------*22120099
221300 4305-CHECK-AP-CODE.                                              22130099
221400     IF RECDIS-AP-PRC-CDE = PC-W OR PC-J OR PC-M                  22140099
221500         SET ASC-UPDATE-NO (ASC-BLK-SUB ASC-ITEM-SUB)             22150099
221600                                TO TRUE                           22160099
221700     END-IF.                                                      22170099
221800/                                                                 22180099
221900*----------------------------------------------------------------*22190099
222000*    FETCH THE CURSOR.                                           *22200099
222100*----------------------------------------------------------------*22210099
222110*---------------------------------------------------------------* 22211099
222120*                                              ** WR # 21361    * 22212099
222130* ADDED CODE TO RETRIEVE ITEM NUMBER FROM TPURITM TABLE.        * 22213099
222140*---------------------------------------------------------------* 22214099
222200                                                                  22220099
222300 4310-FETCH.                                                      22230099
222400                                                                  22240099
222410     SET PS-CALL-API-NO      TO TRUE                              22241099
222420                                                                  22242099
222500     EXEC SQL                                                     22250099
222600          FETCH                                                   22260099
222700                LIST-CSR                                          22270099
222800          INTO                                                    22280099
222900                :RECEIV-STATUS-CDE                                22290099
223000              , :RECEIV-ML-POST-TMST                              22300099
223100              , :RECEIV-FS-POST-TMST                              22310099
223200              , :RECITM-ORD-LNE-NBR                               22320099
223300              , :RECITM-STATUS-CDE                                22330099
223400              , :RECDIS-EXPTED-ITM-QTY                            22340099
223500              , :RECDIS-VERIFY-ITM-QTY                            22350099
223600              , :RECDIS-AP-VERIFY-ITM-QTY                         22360099
223700              , :RECDIS-AP-PRC-CDE                                22370099
223800              , :PURCHS-DEPT-NBR                                  22380099
223900              , :PURCHS-ENT-ID                                    22390099
224000              , :PURCHS-STATUS-CDE                                22400099
224100              , :PURITM-CL-NBR                                    22410099
224200              , :PURITM-SKU-SEQ-NBR                               22420099
224300              , :PURITM-UNT-QTY                                   22430099
224400              , :PURITM-STATUS-CDE                                22440099
224410              , :PURITM-ITM-NBR                                   22441099
224500     END-EXEC.                                                    22450099
224510******************************************************************22451099
224520* IF THE SQL STATEMENT IS SUCCESSFUL, THEN SET PS-CALL-API-YES   *22452099
224530* TO TRUE.                                ** WR # 21361          *22453099
224540******************************************************************22454099
224600                                                                  22460099
224700     EVALUATE TRUE                                                22470099
224800         WHEN SQLCODE = ZERO                                      22480099
224810              SET PS-CALL-API-YES TO TRUE                         22481099
224900         WHEN SQLCODE = +100                                      22490099
225000              CONTINUE                                            22500099
225100         WHEN SQLCODE = -904                                      22510099
225200         WHEN SQLCODE = -911                                      22520099
225300         WHEN SQLCODE = -913                                      22530099
225400              PERFORM 9900-SOFT-ABORT                             22540099
225500         WHEN SQLWARN0 NOT = SPACE                                22550099
225600         WHEN SQLCODE NOT = ZERO                                  22560099
225700              MOVE '4310-FETCH-CURSOR'                            22570099
225800                               TO DP013-PARAGRAPH                 22580099
225900              MOVE 'FETCH LIST CURSOR'                            22590099
226000                               TO DP013-MESSAGE-TEXT (1)          22600099
226100              MOVE SQLCA       TO DP013-SQLCA                     22610099
226200              SET DP013-DB2-ABEND                                 22620099
226300                               TO TRUE                            22630099
226400              PERFORM DP013-0000-PROCESS-ABEND                    22640099
226500     END-EVALUATE.                                                22650099
226600                                                                  22660099
226700     IF  SQLCODE EQUAL +100                                       22670099
226800         SET ASC-NO-ITEMS-LEFT-ON-DB                              22680099
226900             PS-STORE-REC      TO  TRUE                           22690099
227000     END-IF.                                                      22700099
227010*----------------------------------------------------------------*22701099
227020* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *22702099
227030*----------------------------------------------------------------*22703099
227100/                                                                 22710099
227110*----------------------------------------------------------------*22711099
227120*                                               **   WR # 21361  *22712099
227130* CODE FOR ACCESSING LOGISTICS DOMAIN ITEM ACCESS MODULE         *22713099
227140*----------------------------------------------------------------*22714099
227150 4315-CALL-XLKUT-DOMAIN-PGM.                                      22715099
227160                                                                  22716099
227170     INITIALIZE XL001-ITEM-COMMAREA                               22717099
227180                PV-CS-SKU                                         22718099
227190                                                                  22719099
227191     MOVE PURITM-ITM-NBR            TO XL001-KEY-ITM-NBR          22719199
227192                                                                  22719299
227193     SET  XL001-BY-ITEM                                           22719399
227194          XL001-SELECT-SKU          TO TRUE                       22719499
227195                                                                  22719599
227196     CALL XL001-VSM-PGM USING  DFHEIBLK                           22719699
227197                               XL001-COMMAREA                     22719799
227198                               XL001-ITEM-COMMAREA                22719899
227199                                                                  22719999
227200     EVALUATE TRUE                                                22720099
227201         WHEN XL001-SUCCESSFUL                                    22720199
227202               MOVE XL001-SKU-NBR   TO PV-CS-SKU                  22720299
227204                                                                  22720499
227205         WHEN XL001-SKU-SQLCODE = +100                            22720599
227206               MOVE SPACES          TO PV-CS-SKU                  22720699
227207                                                                  22720799
227208         WHEN XL001-SKU-CONTENTION                                22720899
227209               MOVE '7020-SELECT-SKU-BY-ITM'                      22720999
227210                                    TO DP013-PARAGRAPH            22721099
227211               MOVE 'SKU CONTENTION'                              22721199
227212                                    TO DP013-MESSAGE-TEXT (1)     22721299
227213               MOVE XL001-SQLCA     TO DP013-SQLCA                22721399
227214               SET DP013-DB2-ABEND  TO TRUE                       22721499
227215               PERFORM DP013-0000-PROCESS-ABEND                   22721599
227216                                                                  22721699
227217         WHEN OTHER                                               22721799
227218               MOVE '7020-SELECT-SKU-BY-ITM'                      22721899
227219                                    TO DP013-PARAGRAPH            22721999
227220               MOVE 'SELECT ROW FROM XLV_SKU'                     22722099
227221                                    TO DP013-MESSAGE-TEXT (1)     22722199
227222               MOVE XL001-SQLCA     TO DP013-SQLCA                22722299
227223               SET DP013-DB2-ABEND  TO TRUE                       22722399
227224               PERFORM DP013-0000-PROCESS-ABEND                   22722499
227225                                                                  22722599
227226     END-EVALUATE.                                                22722699
227227*----------------------------------------------------------------*22722799
227228* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *22722899
227229*----------------------------------------------------------------*22722999
227230*----------------------------------------------------------------*22723099
227300*    GET THE VENDOR NAME.                                        *22730099
227400*----------------------------------------------------------------*22740099
227500                                                                  22750099
227600 4320-GET-VENDOR-NAME.                                            22760099
227700                                                                  22770099
227800     MOVE PURCHS-ENT-ID             TO  ASC-ENT-ID.               22780099
227900     MOVE PURCHS-DEPT-NBR           TO  ASC-DEPT-NBR.             22790099
228000                                                                  22800099
228100     EXEC SQL                                                     22810099
228200          SELECT                                                  22820099
228300                ENT_NAME_DESC                                     22830099
228400          INTO                                                    22840099
228500                :ENTNME-ENT-NAME-DESC                             22850099
228600          FROM                                                    22860099
228700                TENTNME                                           22870099
228800          WHERE                                                   22880099
228900                ENT_ID            =  :ASC-ENT-ID                  22890099
229000           AND  TYPE_CDE          =  :PC-01                       22900099
229100     END-EXEC.                                                    22910099
229200                                                                  22920099
229300     EVALUATE TRUE                                                22930099
229400         WHEN SQLCODE = ZERO                                      22940099
229500              MOVE ENTNME-ENT-NAME-DESC                           22950099
229600                                    TO  ASC-ENT-NAME-DESC         22960099
229700         WHEN SQLCODE = +100                                      22970099
229800              MOVE ASC-ENT-ID       TO  PV-ENT-ID                 22980099
229900              STRING 'VENDOR NOT FOUND: '                         22990099
230000                      PV-ENT-ID  DELIMITED BY SIZE                23000099
230100                                  INTO  ASC-ENT-NAME-DESC         23010099
230200         WHEN SQLWARN0 NOT = SPACE                                23020099
230300         WHEN SQLCODE NOT = ZERO                                  23030099
230400              MOVE '4320-GET-VENDOR-NAME'                         23040099
230500                               TO DP013-PARAGRAPH                 23050099
230600              MOVE 'SELECT TRECITM'                               23060099
230700                               TO DP013-MESSAGE-TEXT (1)          23070099
230800              MOVE SQLCA       TO DP013-SQLCA                     23080099
230900              SET DP013-DB2-ABEND                                 23090099
231000                               TO TRUE                            23100099
231100              PERFORM DP013-0000-PROCESS-ABEND                    23110099
231200     END-EVALUATE.                                                23120099
231300/                                                                 23130099
231400*----------------------------------------------------------------*23140099
231500* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *23150099
231600*----------------------------------------------------------------*23160099
231700                                                                  23170099
231800 4400-MOVE-COMMAREA-TO-SCREEN.                                    23180099
231900                                                                  23190099
232000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             23200099
232100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          23210099
232200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          23220099
232300             MOVE +1    TO ASC-BLK-SUB                            23230099
232400             PERFORM 5100-WRITE-TEMP-STORAGE                      23240099
232500             ADD +1     TO ASC-BLK-SUB                            23250099
232600             PERFORM 5100-WRITE-TEMP-STORAGE                      23260099
232700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             23270099
232800                 GIVING PV-BLOCK-NUMBER                           23280099
232900                 REMAINDER PV-REMAINDER                           23290099
233000             IF  PV-REMAINDER > ZERO                              23300099
233100                 ADD +1 TO PV-BLOCK-NUMBER                        23310099
233200             END-IF                                               23320099
233300             MOVE +1    TO ASC-BLK-SUB                            23330099
233400             PERFORM 4410-READ-TEMP-STORAGE                       23340099
233500             ADD +1     TO ASC-BLK-SUB                            23350099
233600                           PV-BLOCK-NUMBER                        23360099
233700             PERFORM 4410-READ-TEMP-STORAGE                       23370099
233800     END-IF.                                                      23380099
233900                                                                  23390099
234000     MOVE +1            TO ASC-BLK-SUB.                           23400099
234100     COMPUTE ASC-ITEM-SUB =                                       23410099
234200         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              23420099
234300         + PC-ITEMS-PER-PANEL).                                   23430099
234400                                                                  23440099
234500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        23450099
234600         ADD +1         TO ASC-BLK-SUB                            23460099
234700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23470099
234800     END-IF.                                                      23480099
234900                                                                  23490099
235000     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           23500099
235100         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                23510099
235200     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        23520099
235300     SET PS-ALL-LINES-PROTECTED TO TRUE.                          23530099
235400     PERFORM 4420-FORMAT-LIST-LINES                               23540099
235500         VARYING PV-SUB                                           23550099
235600         FROM PC-ITEMS-PER-PANEL BY -1                            23560099
235700         UNTIL PV-SUB < +1.                                       23570099
235800                                                                  23580099
235900     IF PS-ALL-LINES-PROTECTED                                    23590099
236000         MOVE -1                   TO ASTRTITL                    23600099
236100     END-IF.                                                      23610099
236200                                                                  23620099
236300     COMPUTE ASC-ITEMS-DISPLAYED =                                23630099
236400         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          23640099
236500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL.   23650099
236600     IF  PS-NO-ERROR                                              23660099
236700         MOVE PV-TOP-ITEM          TO ASTRTITO                    23670099
236800     END-IF.                                                      23680099
236900     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    23690099
237000     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    23700099
237100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            23710099
237200                                   TO ASELITO.                    23720099
237300     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     23730099
237400                                                                  23740099
237500     IF  DP020-MSG-NUMBER-X = SPACE                               23750099
237600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  23760099
237700*            --- MORE ITEMS TO DISPLAY ----                       23770099
237800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            23780099
237900             SET DP020-MSG-INFORMATIONAL TO TRUE                  23790099
238000         END-IF                                                   23800099
238100     END-IF.                                                      23810099
238200                                                                  23820099
238300     MOVE ASC-PO-NBR               TO  ARCVNBRO.                  23830099
238400     MOVE ASC-REC-SEQ-NBR          TO  ARCVSEQO.                  23840099
238500     MOVE ASC-OPER-UNT-ID          TO  AOPERO.                    23850099
238600     MOVE ASC-FCLTY-ID             TO  AFCLTYO.                   23860099
238700     MOVE ASC-FCLTY-NME            TO  AFCLNAMO.                  23870099
238800     MOVE ASC-STR-NBR              TO  ASTRO.                     23880099
238900     MOVE ASC-DEPT-NBR             TO  ADEPTO.                    23890099
239000     MOVE ASC-HOLD-RECEIV-STATUS-CDE TO  ARVSTO.                  23900099
239100                                                                  23910099
239200*----------------------------------------------------------------*23920099
239300*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *23930099
239400*----------------------------------------------------------------*23940099
239500                                                                  23950099
239600 4405-READ-TEMP-STORAGE.                                          23960099
239700     MOVE ASC-ITEM-AT-TOP-OF-PANEL                                23970099
239800                   TO  PV-TOP-ITEM                                23980099
239900     MOVE ZERO     TO  ASC-ITEM-AT-TOP-OF-PANEL                   23990099
240000                                                                  24000099
240100     DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                     24010099
240200         GIVING PV-BLOCK-NUMBER                                   24020099
240300         REMAINDER PV-REMAINDER                                   24030099
240400     IF  PV-REMAINDER > ZERO                                      24040099
240500         ADD +1 TO PV-BLOCK-NUMBER                                24050099
240600     END-IF                                                       24060099
240700                                                                  24070099
240800     MOVE +1    TO ASC-BLK-SUB                                    24080099
240900     PERFORM 4410-READ-TEMP-STORAGE                               24090099
241000     ADD +1     TO ASC-BLK-SUB                                    24100099
241100                   PV-BLOCK-NUMBER                                24110099
241200     PERFORM 4410-READ-TEMP-STORAGE                               24120099
241300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        24130099
241400                                                                  24140099
241500*----------------------------------------------------------------*24150099
241600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *24160099
241700*----------------------------------------------------------------*24170099
241800                                                                  24180099
241900 4410-READ-TEMP-STORAGE.                                          24190099
242000                                                                  24200099
242100     EXEC CICS                                                    24210099
242200         READQ TS                                                 24220099
242300             QUEUE (ASC-LIST-QUEUE-NAME)                          24230099
242400             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               24240099
242500             ITEM  (PV-BLOCK-NUMBER)                              24250099
242600             RESP  (PV-CICS-RESP)                                 24260099
242700     END-EXEC.                                                    24270099
242800                                                                  24280099
242900     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       24290099
243000       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     24300099
243100         CONTINUE                                                 24310099
243200     ELSE                                                         24320099
243300         SET DP013-CICS-ABEND     TO TRUE                         24330099
243400         SET DP013-NO-ROLLBACK    TO TRUE                         24340099
243500         MOVE '4410-READ-TEMP-STORAGE'                            24350099
243600                                  TO DP013-PARAGRAPH              24360099
243700         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      24370099
243800                                  TO DP013-MESSAGE-TEXT(1)        24380099
243900         PERFORM DP013-0000-PROCESS-ABEND                         24390099
244000     END-IF.                                                      24400099
244100                                                                  24410099
244200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             24420099
244300                                                                  24430099
244400     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         24440099
244500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               24450099
244600     END-IF.                                                      24460099
244700/                                                                 24470099
244800*----------------------------------------------------------------*24480099
244900*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *24490099
245000*----------------------------------------------------------------*24500099
245100                                                                  24510099
245200 4420-FORMAT-LIST-LINES.                                          24520099
245300                                                                  24530099
245400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      24540099
245500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                24550099
245600         MOVE DP015-ASK-DRK-OFF  TO MR-SELECT-A        (PV-SUB)   24560099
245700                                    MR-ADJ-QTY-A       (PV-SUB)   24570099
245800         MOVE SPACE              TO MR-SELECT-I        (PV-SUB)   24580099
245900                                    MR-ACTION-I        (PV-SUB)   24590099
246000                                    MR-PO-LNE-NBR-X    (PV-SUB)   24600099
246100                                    MR-SKU             (PV-SUB)   24610099
246200                                    MR-VFY-QTY-X       (PV-SUB)   24620099
246300                                    MR-PCK-QTY-X       (PV-SUB)   24630099
246400                                    MR-ACT-QTY-X       (PV-SUB)   24640099
246500     ELSE                                                         24650099
246600         IF ASC-UPDATE-NO (ASC-BLK-SUB ASC-ITEM-SUB)              24660099
246700             MOVE DP015-ASK-DRK-OFF TO MR-SELECT-A (PV-SUB)       24670099
246800                                       MR-ADJ-QTY-A (PV-SUB)      24680099
246900         ELSE                                                     24690099
247000             MOVE -1                TO MR-SELECT-L (PV-SUB)       24700099
247100             SET PS-ALL-LINES-NOT-PROTECTED TO TRUE               24710099
247200         END-IF                                                   24720099
247300         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      24730099
247400                                                   > SPACE        24740099
247500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 24750099
247600                                 TO MR-SELECT-I (PV-SUB)          24760099
247700         ELSE                                                     24770099
247800             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      24780099
247900                                 TO MR-SELECT-I (PV-SUB)          24790099
248000         END-IF                                                   24800099
248100                                                                  24810099
248200         IF  DP030-SET-CURSOR-TRAILER                             24820099
248300             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)24830099
248400                 > SPACE)                                         24840099
248500               OR (PV-SUB = 1))                                   24850099
248600                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             24860099
248700             END-IF                                               24870099
248800         END-IF                                                   24880099
248900                                                                  24890099
249000         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           24900099
249100             MOVE ASC-ACTION  (ASC-BLK-SUB ASC-ITEM-SUB)          24910099
249200                                 TO MR-ACTION-I      (PV-SUB)     24920099
249300             MOVE ASC-ORD-LNE-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)     24930099
249400                                 TO MR-PO-LNE-NBR     (PV-SUB)    24940099
249500             IF ASC-PACK-BY-ST-OVERAGE                            24950099
249600                                    (ASC-BLK-SUB ASC-ITEM-SUB)    24960099
249700                  MOVE DP015-YELLOW                               24970099
249800                                  TO MR-PO-LNE-NBR-C (PV-SUB)     24980099
249900              ELSE                                                24990099
250000                  MOVE DP015-BLUE                                 25000099
250100                                  TO MR-PO-LNE-NBR-C (PV-SUB)     25010099
250200             END-IF                                               25020099
250300             MOVE ASC-CLASS-SKU    (ASC-BLK-SUB ASC-ITEM-SUB)     25030099
250400                                 TO MR-SKU            (PV-SUB)    25040099
250500             MOVE ASC-VERIFY-ITM-QTY(ASC-BLK-SUB ASC-ITEM-SUB)    25050099
250600                                 TO MR-VFY-QTY        (PV-SUB)    25060099
250700             MOVE ASC-ACTUAL-ITM-QTY(ASC-BLK-SUB ASC-ITEM-SUB)    25070099
250800                                 TO MR-ACT-QTY        (PV-SUB)    25080099
250900             MOVE ASC-PCKSLP-ITM-QTY(ASC-BLK-SUB ASC-ITEM-SUB)    25090099
251000                                 TO MR-PCK-QTY        (PV-SUB)    25100099
251100             IF  MR-ADJ-QTY-C(PV-SUB) EQUAL DP015-RED             25110099
251200                 CONTINUE                                         25120099
251300             ELSE                                                 25130099
251400                 IF ASC-ADJ-QTY-X  (ASC-BLK-SUB ASC-ITEM-SUB)     25140099
251500                               = SPACES                           25150099
251600                     MOVE SPACES TO MR-ADJ-QTY-X (PV-SUB)         25160099
251700                 ELSE                                             25170099
251800                     MOVE ASC-ADJ-QTY                             25180099
251900                         (ASC-BLK-SUB ASC-ITEM-SUB)               25190099
252000                                 TO MR-ADJ-QTY-O     (PV-SUB)     25200099
252100                 END-IF                                           25210099
252200             END-IF                                               25220099
252300             IF ASC-PACK-BY-ST-OVERAGE                            25230099
252400                                    (ASC-BLK-SUB ASC-ITEM-SUB)    25240099
252500                  MOVE DP015-YELLOW                               25250099
252600                                       TO MR-ADJ-QTY-C (PV-SUB)   25260099
252700              ELSE                                                25270099
252800                  MOVE DP015-GREEN                                25280099
252900                                       TO MR-ADJ-QTY-C (PV-SUB)   25290099
253000             END-IF                                               25300099
253100             IF ASC-OVERAGE                                       25310099
253200                  CONTINUE                                        25320099
253300             ELSE                                                 25330099
253400                  SET  ASC-NO-PACK-BY-ST-OVERAGE                  25340099
253500                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE         25350099
253600             END-IF                                               25360099
253700         END-IF                                                   25370099
253800     END-IF.                                                      25380099
253900                                                                  25390099
254000     SUBTRACT +1 FROM ASC-ITEM-SUB                                25400099
254100     IF  ASC-ITEM-SUB < + 1                                       25410099
254200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  25420099
254300         MOVE +1                 TO ASC-BLK-SUB                   25430099
254400     END-IF.                                                      25440099
254500                                                                  25450099
254600******************************************************************25460099
254700** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **25470099
254800** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **25480099
254900** ISSUE A WARNING.                                             **25490099
255000******************************************************************25500099
255100                                                                  25510099
255200 4430-CHECK-FOR-BEGIN-AND-END.                                    25520099
255300                                                                  25530099
255400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       25540099
255500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     25550099
255600*            -- NO END-OF-RANGE SPECFIED ---                      25560099
255700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            25570099
255800             SET DP020-MSG-WARNING TO TRUE                        25580099
255900             PERFORM 4431-POSITION-AT-WARNING                     25590099
256000         END-IF                                                   25600099
256100     ELSE                                                         25610099
256200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     25620099
256300*            -- NO BEGINNING-OF-RANGE SPECFIED ---                25630099
256400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            25640099
256500             SET DP020-MSG-WARNING TO TRUE                        25650099
256600             PERFORM 4431-POSITION-AT-WARNING                     25660099
256700         END-IF                                                   25670099
256800     END-IF.                                                      25680099
256900******************************************************************25690099
257000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **25700099
257100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **25710099
257200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **25720099
257300** POSITION THE CURSOR THERE.                                   **25730099
257400******************************************************************25740099
257500                                                                  25750099
257600 4431-POSITION-AT-WARNING.                                        25760099
257700                                                                  25770099
257800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 25780099
257900                    - PV-TOP-ITEM + 1.                            25790099
258000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25800099
258100         CONTINUE                                                 25810099
258200     ELSE                                                         25820099
258300         SET DP030-SET-CURSOR-APPL-1                              25830099
258400                                   TO TRUE                        25840099
258500         MOVE -1                   TO MR-SELECT-L (PV-SUB)        25850099
258600         MOVE DP015-REVERSE        TO MR-SELECT-H (PV-SUB)        25860099
258700         MOVE DP015-YELLOW         TO MR-SELECT-C (PV-SUB)        25870099
258800     END-IF.                                                      25880099
258900                                                                  25890099
259000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25900099
259100                    - PV-TOP-ITEM + 1.                            25910099
259200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25920099
259300         CONTINUE                                                 25930099
259400     ELSE                                                         25940099
259500         SET DP030-SET-CURSOR-APPL-1                              25950099
259600                                   TO TRUE                        25960099
259700         MOVE -1                   TO MR-SELECT-L (PV-SUB)        25970099
259800         MOVE DP015-REVERSE        TO MR-SELECT-H (PV-SUB)        25980099
259900         MOVE DP015-YELLOW         TO MR-SELECT-C (PV-SUB)        25990099
260000     END-IF.                                                      26000099
260100/                                                                 26010099
260200*----------------------------------------------------------------*26020099
260300*                                                                *26030099
260400*    ENSURE EACH SELECTED ITEM HAS A STATUS CODE OF CM.  IF SO,  *26040099
260500*    UPDATE THE VERIFIED ITEM QUANTITY AND THE AP VERIFIED ITEM  *26050099
260600*    QUANTITY ON TRECDIS; SET THE STATUS TO VE                   *26060099
260700*    NEXT, CHECK IF ALL TRECITM ROWS FOR THIS RECEIVER HAVE A    *26070099
260800*    VE STATUS CODE.  IF SO, UPDATE THE TRECEIV ROW TO A STATUS  *26080099
260900*    OF VE.                                                      *26090099
261000*                                                                *26100099
261100*----------------------------------------------------------------*26110099
261200 5005-PREPARE-SEL-QUEUE.                                          26120099
261300                                                                  26130099
261400     MOVE +1                     TO ASC-BLK-SUB.                  26140099
261500                                                                  26150099
261600     PERFORM 5100-WRITE-TEMP-STORAGE.                             26160099
261700                                                                  26170099
261800     ADD +1                      TO ASC-BLK-SUB.                  26180099
261900                                                                  26190099
262000     PERFORM 5100-WRITE-TEMP-STORAGE.                             26200099
262100                                                                  26210099
262200     MOVE ASC-SEL-QUEUE-NAME-OUT TO RC017-SEL-QUEUE-NAME.         26220099
262300                                                                  26230099
262400     PERFORM 6010-DELETE-SEL-QUEUE.                               26240099
262500                                                                  26250099
262600     SET ASC-UPDATE-TSQ          TO TRUE.                         26260099
262700     SET RC013-IDX               TO 1.                            26270099
262800     MOVE ZERO                   TO RC017-NUMBER-OF-TS-ITEMS.     26280099
262900     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        26290099
263000                                                                  26300099
263100     EVALUATE TRUE                                                26310099
263200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              26320099
263300             PERFORM 5035-CK-PACK-BY-STORE-OVERAGE                26330099
263400                 VARYING PV-ITEM  FROM 1 BY 1                     26340099
263500                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      26350099
263600                                                                  26360099
263700             INITIALIZE ASC-BLOCK-ENTRIES (1)                     26370099
263800                        ASC-BLOCK-ENTRIES (2)                     26380099
263900             MOVE +1             TO ASC-BLK-SUB                   26390099
264000                                    PV-TOP-ITEM                   26400099
264100                                                                  26410099
264200             MOVE ZERO           TO ASC-ITEM-SUB                  26420099
264300                                    ASC-START-OF-SELECTED-RANGE   26430099
264400                                    ASC-END-OF-SELECTED-RANGE     26440099
264500                                    ASC-ITEM-AT-TOP-OF-PANEL      26450099
264600                                                                  26460099
264700             PERFORM 4410-READ-TEMP-STORAGE                       26470099
264800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 26480099
264900             PERFORM 3200-RESET-ATTRIBUTES                        26490099
265000                                                                  26500099
265100                                                                  26510099
265200     IF RC013-IDX > 1                                             26520099
265300         PERFORM 5205-WRITE-SEL-QUEUE                             26530099
265400         ADD +1                  TO RC017-NUMBER-OF-TS-ITEMS      26540099
265500     END-IF.                                                      26550099
265600                                                                  26560099
265700                                                                  26570099
265800                                                                  26580099
265900 5035-CK-PACK-BY-STORE-OVERAGE.                                   26590099
266000                                                                  26600099
266100     PERFORM 6112-READ-LIST-QUEUE.                                26610099
266200                                                                  26620099
266300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       26630099
266400         PERFORM                                                  26640099
266500         VARYING LQW-IDX                                          26650099
266600         FROM 1 BY 1                                              26660099
266700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            26670099
266800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          26680099
266900                                                                  26690099
267000             IF  LQW-SELECT (LQW-IDX)                             26700099
267100                 MOVE LQW-PO-LNE-NBR(LQW-IDX)                     26710099
267200                              TO  RECDIS-ORD-LNE-NBR              26720099
267300                 PERFORM 5400-SELECT-RECDIS                       26730099
267400                 IF LQW-ADJ-QTY-N (LQW-IDX) >                     26740099
267500                                RECDIS-EXPTED-ITM-QTY             26750099
267600                      SET  LQW-PACK-BY-ST-OVERAGE (LQW-IDX)       26760099
267700                                  TO TRUE                         26770099
267800                      SET  ASC-OVERAGE TO TRUE                    26780099
267900                 END-IF                                           26790099
268000                 ADD +1 TO RC017-NUMBER-OF-TS-ITEMS               26800099
268100                 MOVE LQW-SELECTED-SW (LQW-IDX)                   26810099
268200                              TO  LQW-TEMP-SELECTED-SW (LQW-IDX)  26820099
268300             END-IF                                               26830099
268400         END-PERFORM                                              26840099
268500     END-IF.                                                      26850099
268600                                                                  26860099
268700     MOVE PV-ITEM                TO  PV-SAVE-ITEM.                26870099
268800     PERFORM 6111-WRITE-LIST-QUEUE.                               26880099
268900                                                                  26890099
269000 5010-PREPARE-SEL-QUEUE-UPDATE.                                   26900099
269100                                                                  26910099
269200     MOVE +1                     TO ASC-BLK-SUB.                  26920099
269300                                                                  26930099
269400     PERFORM 5100-WRITE-TEMP-STORAGE.                             26940099
269500                                                                  26950099
269600     ADD +1                      TO ASC-BLK-SUB.                  26960099
269700                                                                  26970099
269800     PERFORM 5100-WRITE-TEMP-STORAGE.                             26980099
269900                                                                  26990099
270000     MOVE ASC-SEL-QUEUE-NAME-OUT TO RC017-SEL-QUEUE-NAME.         27000099
270100                                                                  27010099
270200     MOVE RC017-TRB-QUEUE-NAME                                    27020099
270300             TO ASC-TRB-QUEUE-NAME-IN.                            27030099
270400                                                                  27040099
270500     PERFORM 6010-DELETE-SEL-QUEUE.                               27050099
270600                                                                  27060099
270700     SET ASC-UPDATE-TSQ          TO TRUE.                         27070099
270800     SET RC013-IDX               TO 1.                            27080099
270900     MOVE ZERO                   TO RC017-NUMBER-OF-TS-ITEMS.     27090099
271000     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        27100099
271100                                                                  27110099
271200             PERFORM 5055-PROCESS-TRECDIS                         27120099
271300                VARYING PV-ITEM                                   27130099
271400                FROM 1 BY 1                                       27140099
271500                UNTIL PV-ITEM GREATER                             27150099
271600                ASC-HIGHEST-BLOCK-WRITTEN.                        27160099
271700                                                                  27170099
271800                INITIALIZE ASC-BLOCK-ENTRIES (1)                  27180099
271900                            ASC-BLOCK-ENTRIES (2).                27190099
272000                MOVE +1             TO ASC-BLK-SUB                27200099
272100                                       PV-TOP-ITEM.               27210099
272200                                                                  27220099
272300                MOVE ZERO        TO ASC-ITEM-SUB                  27230099
272400                                    ASC-START-OF-SELECTED-RANGE   27240099
272500                                    ASC-END-OF-SELECTED-RANGE     27250099
272600                                    ASC-ITEM-AT-TOP-OF-PANEL.     27260099
272700                                                                  27270099
272800             PERFORM 4410-READ-TEMP-STORAGE.                      27280099
272900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                27290099
273000             SET ASC-NO-OVERAGE TO TRUE.                          27300099
273100             PERFORM 3200-RESET-ATTRIBUTES.                       27310099
273200                                                                  27320099
273300                                                                  27330099
273400     IF RC013-IDX > 1                                             27340099
273500         PERFORM 5205-WRITE-SEL-QUEUE                             27350099
273600         ADD +1                  TO RC017-NUMBER-OF-TS-ITEMS      27360099
273700     END-IF.                                                      27370099
273800                                                                  27380099
273900 5050-ADJUST-QTYS.                                                27390099
274000                                                                  27400099
274100     PERFORM 5010-PREPARE-SEL-QUEUE-UPDATE.                       27410099
274200     SET ASC-NO-TSQ-UPDATE                                        27420099
274300         TO TRUE.                                                 27430099
274400                                                                  27440099
274500     MOVE +1 TO PV-SEL-QUEUE-ITEM.                                27450099
274600     PERFORM 9600-WRITE-TRB-QUEUE.                                27460099
274700/                                                                 27470099
274800*----------------------------------------------------------------*27480099
274900*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *27490099
275000*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *27500099
275100*----------------------------------------------------------------*27510099
275200                                                                  27520099
275300 5100-WRITE-TEMP-STORAGE.                                         27530099
275400                                                                  27540099
275500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     27550099
275600                                   TO PV-LIST-ITEM-NUMBER.        27560099
275700     COMPUTE PV-BLOCK-NUMBER =                                    27570099
275800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    27580099
275900                                                                  27590099
276000     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             27600099
276100     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             27610099
276200         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      27620099
276300             PERFORM 5105-REWRITE-ASC-LISTQ                       27630099
276400         END-IF                                                   27640099
276500     ELSE                                                         27650099
276600         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       27660099
276700         ASC-HIGHEST-BLOCK-WRITTEN + 1                            27670099
276800         PERFORM 5110-WRITE-ASC-LISTQ                             27680099
276900         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   27690099
277000     END-IF.                                                      27700099
277100                                                                  27710099
277200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             27720099
277300                                                                  27730099
277400******************************************************************27740099
277500** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **27750099
277600** SPECIFIC COMMAREA.                                           **27760099
277700******************************************************************27770099
277800                                                                  27780099
277900 5105-REWRITE-ASC-LISTQ.                                          27790099
278000                                                                  27800099
278100     EXEC CICS                                                    27810099
278200         WRITEQ TS                                                27820099
278300             QUEUE (ASC-LIST-QUEUE-NAME)                          27830099
278400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27840099
278500             ITEM  (PV-BLOCK-NUMBER)                              27850099
278600             REWRITE                                              27860099
278700             RESP  (PV-CICS-RESP)                                 27870099
278800     END-EXEC.                                                    27880099
278900                                                                  27890099
279000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           27900099
279100         CONTINUE                                                 27910099
279200     ELSE                                                         27920099
279300         SET DP013-CICS-ABEND            TO TRUE                  27930099
279400         SET DP013-NO-ROLLBACK           TO TRUE                  27940099
279500         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       27950099
279600         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     27960099
279700                                         TO DP013-MESSAGE-TEXT(1) 27970099
279800         PERFORM DP013-0000-PROCESS-ABEND                         27980099
279900     END-IF.                                                      27990099
280000                                                                  28000099
280100******************************************************************28010099
280200** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **28020099
280300** SPECIFIC COMMAREA.                                           **28030099
280400******************************************************************28040099
280500                                                                  28050099
280600 5110-WRITE-ASC-LISTQ.                                            28060099
280700                                                                  28070099
280800     EXEC CICS                                                    28080099
280900         WRITEQ TS                                                28090099
281000             QUEUE (ASC-LIST-QUEUE-NAME)                          28100099
281100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28110099
281200             ITEM  (PV-BLOCK-NUMBER)                              28120099
281300             RESP  (PV-CICS-RESP)                                 28130099
281400     END-EXEC.                                                    28140099
281500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      28150099
281600         SET DP013-CICS-ABEND      TO TRUE                        28160099
281700         SET DP013-NO-ROLLBACK     TO TRUE                        28170099
281800         MOVE '5110-WRITE-ASC-LISTQ'                              28180099
281900                                   TO DP013-PARAGRAPH             28190099
282000         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           28200099
282100                                   TO DP013-MESSAGE-TEXT(1)       28210099
282200         PERFORM DP013-0000-PROCESS-ABEND                         28220099
282300     END-IF.                                                      28230099
282400/                                                                 28240099
282500*----------------------------------------------------------------*28250099
282600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *28260099
282700*----------------------------------------------------------------*28270099
282800                                                                  28280099
282900 5205-WRITE-SEL-QUEUE.                                            28290099
283000                                                                  28300099
283100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            28310099
283200                                   TO RC013-SELECTED-ITEMS.       28320099
283300                                                                  28330099
283400     EXEC CICS                                                    28340099
283500          WRITEQ TS                                               28350099
283600              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      28360099
283700              FROM  (RC013-DC-SELECT-RECORD)                      28370099
283800              ITEM  (PV-SEL-QUEUE-ITEM)                           28380099
283900              RESP  (PV-CICS-RESP)                                28390099
284000     END-EXEC.                                                    28400099
284100                                                                  28410099
284200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28420099
284300         CONTINUE                                                 28430099
284400     ELSE                                                         28440099
284500         SET DP013-CICS-ABEND      TO TRUE                        28450099
284600         SET DP013-NO-ROLLBACK     TO TRUE                        28460099
284700         MOVE '5205-WRITE-SEL-QUEUE'                              28470099
284800                                   TO DP013-PARAGRAPH             28480099
284900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          28490099
285000                                   TO DP013-MESSAGE-TEXT(1)       28500099
285100         PERFORM DP013-0000-PROCESS-ABEND                         28510099
285200     END-IF.                                                      28520099
285300/                                                                 28530099
285400*----------------------------------------------------------------*28540099
285500*    UPDATE TRECDIS FOR EACH SELECTED ITEM.                      *28550099
285600*----------------------------------------------------------------*28560099
285700                                                                  28570099
285800 5055-PROCESS-TRECDIS.                                            28580099
285900                                                                  28590099
286000     PERFORM 6112-READ-LIST-QUEUE.                                28600099
286100                                                                  28610099
286200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       28620099
286300         PERFORM                                                  28630099
286400         VARYING LQW-IDX                                          28640099
286500         FROM 1 BY 1                                              28650099
286600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            28660099
286700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          28670099
286800                                                                  28680099
286900             IF  LQW-SELECT (LQW-IDX)                             28690099
287000                 SET LQW-UPDATE(LQW-IDX) TO TRUE                  28700099
287100                 MOVE LQW-PO-LNE-NBR(LQW-IDX)                     28710099
287200                              TO  RECDIS-ORD-LNE-NBR              28720099
287300                 PERFORM 4013-LOOK-FOR-TROUBLE                    28730099
287400                 PERFORM 5400-SELECT-RECDIS                       28740099
287500                 IF ASC-NO-TRBL-EXISTS                            28750099
287600                      PERFORM 4014-CREATE-TROUBLE-ROW             28760099
287700                      PERFORM 4015-UPDATE-TRB-QUEUE               28770099
287800                 END-IF                                           28780099
287900                 IF  PS-DATA-OK                                   28790099
288000                     PERFORM 5505-ADD-TO-RECD-AUDIT-BEFORE        28800099
288100                 END-IF                                           28810099
288110                 MOVE LQW-VERIFY-ITM-QTY (LQW-IDX)                28811099
288120                              TO PA-UPDATE-FROM-QTY               28812099
288200                 MOVE LQW-ADJ-QTY-N (LQW-IDX)                     28820099
288300                              TO  RECDIS-AP-VERIFY-ITM-QTY        28830099
288400                                  LQW-VERIFY-ITM-QTY              28840099
288500                                      (LQW-IDX)                   28850099
288510                                  PA-UPDATE-TO-QTY                28851099
288520                 SUBTRACT PA-UPDATE-FROM-QTY                      28852099
288530                     FROM PA-UPDATE-TO-QTY                        28853099
288540                   GIVING PA-UPDATE-DIFF-QTY                      28854099
288600                 PERFORM 5500-UPDATE-TRECDIS                      28860099
288700                 IF  PS-DATA-OK                                   28870099
288800                     PERFORM 5515-ADD-TO-RECD-AUDIT-AFTER         28880099
288900                 END-IF                                           28890099
288910                 IF  PA-UPDATE-DIFF-QTY NOT EQUAL TO ZERO         28891099
288920                     PERFORM 6150-WRITE-VRFY-ADJ-QUEUE            28892099
288921                     PERFORM 7500-PROCESS-UNITS-WORK              28892199
288930                 END-IF                                           28893099
289000                 IF PS-RECITM-NOT-UPDATED                         28900099
289100                     PERFORM 5600-UPDATE-TRECITM                  28910099
289200                 END-IF                                           28920099
289300                                                                  28930099
289400                 ADD +1          TO RC017-NUMBER-OF-TS-ITEMS      28940099
289500                 SET LQW-DESELECT (LQW-IDX)                       28950099
289600                              TO  TRUE                            28960099
289700                 MOVE LQW-SELECTED-SW (LQW-IDX)                   28970099
289800                                 TO LQW-TEMP-SELECTED-SW (LQW-IDX)28980099
289900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    28990099
290000             END-IF                                               29000099
290100         END-PERFORM                                              29010099
290200     END-IF.                                                      29020099
290300                                                                  29030099
290400     MOVE PV-ITEM                TO  PV-SAVE-ITEM.                29040099
290500     PERFORM 6111-WRITE-LIST-QUEUE.                               29050099
290600/                                                                 29060099
290700 4013-LOOK-FOR-TROUBLE.                                           29070099
290800      PERFORM 9500-READ-TRB-QUEUE.                                29080099
290900      IF TM003-CYC-ADJ-NBR = 0                                    29090099
291000           SET ASC-NO-TRBL-EXISTS TO TRUE                         29100099
291100      ELSE                                                        29110099
291200          SET LINE-INDEX TO 1                                     29120099
291300          PERFORM 4014-SEARCH-TRB-TABLE                           29130099
291400             UNTIL PS-EOT-TRB-TABLE                               29140099
291500      END-IF.                                                     29150099
291600/                                                                 29160099
291700 4014-SEARCH-TRB-TABLE.                                           29170099
291800      IF TM003-TBL-LNE-NBR (LINE-INDEX) =                         29180099
291900                      LQW-PO-LNE-NBR(LQW-IDX)                     29190099
292000           AND TM003-TBL-LNE-UPDATED (LINE-INDEX)                 29200099
292100                 SET ASC-TRBL-EXISTS TO TRUE                      29210099
292200                 MOVE TM003-CYC-ADJ-NBR TO PV-CYC-ADJ-NBR         29220099
292300                                           PV-CYC-ADJ-BEF         29230099
292400                 MOVE TM003-TBL-NOTIF-NBR (LINE-INDEX) TO         29240099
292500                                     PV-NOTIF-NBR                 29250099
292600                                     PV-NOTIF-BEF                 29260099
292700                 SET PS-EOT-TRB-TABLE TO TRUE                     29270099
292800       ELSE                                                       29280099
292900           IF TM003-TBL-LNE-NBR (LINE-INDEX) = 0                  29290099
293000               SET ASC-NO-TRBL-EXISTS TO TRUE                     29300099
293100               SET PS-EOT-TRB-TABLE TO TRUE                       29310099
293200     END-IF.                                                      29320099
293300     SET LINE-INDEX UP BY 1.                                      29330099
293400 4014-CREATE-TROUBLE-ROW.                                         29340099
293500     INITIALIZE TM500-FIELDS.                                     29350099
293600     SET TM500-ADD-DETAILS                                        29360099
293700         TM500-CREATE-MANUAL       TO  TRUE.                      29370099
293800                                                                  29380099
293900     MOVE ASC-KEY-NOTIF-NBR        TO  TM500-NOTIF-NBR.           29390099
294000     MOVE ASC-OPER-UNT-ID          TO  TM500-OPER-UNT-ID.         29400099
294100     MOVE ASC-FCLTY-ID             TO  TM500-FCLTY-ID.            29410099
294200                                                                  29420099
294300     MOVE ASC-PO-NBR                                              29430099
294400                                   TO  TM500-PO-NBR.              29440099
294500                                                                  29450099
294600     IF  ASC-PO-LEVEL-TRBL                                        29460099
294700         SET TM500-PO-LEVEL        TO  TRUE                       29470099
294800         MOVE ZERO                 TO  TM500-PO-LNE-NBR           29480099
294900     ELSE                                                         29490099
295000         SET TM500-LINE-LEVEL      TO  TRUE                       29500099
295100         MOVE LQW-PO-LNE-NBR(LQW-IDX)                             29510099
295200                                   TO  TM500-PO-LNE-NBR           29520099
295300     END-IF                                                       29530099
295400                                                                  29540099
295500     MOVE RC017-REC-SEQ-NBR        TO  TM500-REC-SEQ-NBR.         29550099
295600     MOVE TM003-TRBL-RSN-CDE       TO  TM500-TRBL-RSN-CDE.        29560099
295700                                                                  29570099
295800     MOVE DP020-USERID             TO  TM500-CRE-UID              29580099
295900                                       TM500-NOTIF-UID.           29590099
296000                                                                  29600099
296100     IF TM003-FREEFORM-TEXT = SPACES                              29610099
296200         MOVE '.'                      TO TM500-FREEFORM-TEXT     29620099
296300     ELSE                                                         29630099
296400         MOVE TM003-FREEFORM-TEXT      TO  TM500-FREEFORM-TEXT.   29640099
296500                                                                  29650099
296600     PERFORM 5060-LINK-TO-UPDATE.                                 29660099
296700     IF TM500-CALL-SUCCESSFUL         OR                          29670099
296800         TM500-TPURCHS-SELECT-NOT-FND OR                          29680099
296900         TM500-TTRBNTF-UPDATE-NOT-FND OR                          29690099
297000         TM500-DIDNT-ALLOC-DUE-TO-TRBL                            29700099
297100             CONTINUE                                             29710099
297200     ELSE                                                         29720099
297300         IF  TM500-DUPLICATE-TROUBLE                              29730099
297400             SET DP020-MSG-FATAL                                  29740099
297500                 PS-ERROR          TO  TRUE                       29750099
297600             MOVE PC-TRBL-ALREADY-EXISTS-MSG                      29760099
297700                                   TO  DP020-MSG-MESSAGE          29770099
297800         ELSE                                                     29780099
297900             PERFORM 5070-FORMAT-ERROR                            29790099
298000         END-IF                                                   29800099
298100     END-IF.                                                      29810099
298200                                                                  29820099
298300 4015-UPDATE-TRB-QUEUE.                                           29830099
298400     SET TM003-UPDATE TO TRUE.                                    29840099
298500     IF TM003-CYC-ADJ-NBR = 0                                     29850099
298600         MOVE TM500-NOTIF-NBR TO TM003-CYC-ADJ-NBR                29860099
298700                                     PV-CYC-ADJ-NBR               29870099
298800         MOVE  0                 TO PV-CYC-ADJ-BEF                29880099
298900         MOVE  0                 TO PV-NOTIF-BEF                  29890099
299000     ELSE                                                         29900099
299100         MOVE TM003-CYC-ADJ-NBR TO                                29910099
299200                                     PV-CYC-ADJ-NBR               29920099
299300     END-IF.                                                      29930099
299400     SET LINE-INDEX TO 1.                                         29940099
299500     PERFORM 4015-LOAD-QUEUE-TBL                                  29950099
299600        UNTIL PS-TABLE-LOADED.                                    29960099
299700                                                                  29970099
299800 4015-LOAD-QUEUE-TBL.                                             29980099
299900     IF TM003-TBL-LNE-NBR (LINE-INDEX) = 0                        29990099
300000        MOVE TM500-PO-LNE-NBR TO TM003-TBL-LNE-NBR (LINE-INDEX)   30000099
300100        MOVE TM500-NOTIF-NBR TO TM003-TBL-NOTIF-NBR (LINE-INDEX)  30010099
300200                                PV-NOTIF-NBR                      30020099
300300        SET TM003-TBL-LNE-UPDATED (LINE-INDEX) TO TRUE            30030099
300400        SET PS-TABLE-LOADED TO TRUE                               30040099
300500     ELSE                                                         30050099
300600        SET LINE-INDEX UP BY 1                                    30060099
300700     END-IF.                                                      30070099
300800 5060-LINK-TO-UPDATE.                                             30080099
300900                                                                  30090099
301000     EXEC CICS LINK                                               30100099
301100          PROGRAM (PC-TMKCS520)                                   30110099
301200          COMMAREA(TM500-FIELDS)                                  30120099
301300          RESP    (PV-CICS-RESP)                                  30130099
301400     END-EXEC.                                                    30140099
301500                                                                  30150099
301600     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               30160099
301700         SET DP013-LOGIC-ABEND                                    30170099
301800             DP013-NO-ROLLBACK     TO TRUE                        30180099
301900         MOVE '5060-LINK-TO-UPDATE'                               30190099
302000                                   TO DP013-PARAGRAPH             30200099
302100         MOVE 'ATTEMPTING TO LINK TO CENTRAL PROCESSING'          30210099
302200                                   TO DP013-MESSAGE-TEXT (1)      30220099
302300         PERFORM DP013-0000-PROCESS-ABEND                         30230099
302400     END-IF.                                                      30240099
302500                                                                  30250099
302600/                                                                 30260099
302700 5070-FORMAT-ERROR.                                               30270099
302800                                                                  30280099
302900     SET PS-ERROR                                                 30290099
303000         DP020-MSG-FATAL           TO  TRUE.                      30300099
303100     STRING 'NNNNN-E-'                                            30310099
303200            TM500-RETURN-MSG                                      30320099
303300            '-'                                                   30330099
303400            TM500-RETURN-CODE                                     30340099
303500            ', SQLCODE='                                          30350099
303600            TM500-SQLCODE DELIMITED BY SIZE                       30360099
303700                                 INTO  DP020-MSG-MESSAGE.         30370099
303800/                                                                 30380099
303900 5400-SELECT-RECDIS.                                              30390099
304000                                                                  30400099
304100     EXEC SQL                                                     30410099
304200         SELECT ORD_NBR,                                          30420099
304300                ORD_LNE_NBR,                                      30430099
304400                REC_SEQ_NBR,                                      30440099
304500                OPER_UNT_ID,                                      30450099
304600                FCLTY_ID,                                         30460099
304700                CRE_TMST,                                         30470099
304800                CRE_UID,                                          30480099
304900                VER_STATUS_CDE,                                   30490099
305000                EXPTED_ITM_QTY,                                   30500099
305100                VERIFY_ITM_QTY,                                   30510099
305200                AP_VERIFY_ITM_QTY,                                30520099
305300                STR_NBR,                                          30530099
305400                STR_FCLTY_ID,                                     30540099
305500                PLAN_ITM_QTY,                                     30550099
305600                AP_PRC_CDE,                                       30560099
305700                AP_PRC_DTE,                                       30570099
305800                CURRENT TIMESTAMP                                 30580099
305900          INTO      :RECDIS-ORD-NBR,                              30590099
306000                :RECDIS-ORD-LNE-NBR,                              30600099
306100                :RECDIS-REC-SEQ-NBR,                              30610099
306200                :RECDIS-OPER-UNT-ID,                              30620099
306300                :RECDIS-FCLTY-ID,                                 30630099
306400                :RECDIS-CRE-TMST,                                 30640099
306500                :RECDIS-CRE-UID,                                  30650099
306600                :RECDIS-VER-STATUS-CDE,                           30660099
306700                :RECDIS-EXPTED-ITM-QTY,                           30670099
306800                :RECDIS-VERIFY-ITM-QTY,                           30680099
306900                :RECDIS-AP-VERIFY-ITM-QTY,                        30690099
307000                :RECDIS-STR-NBR,                                  30700099
307100                :RECDIS-STR-FCLTY-ID,                             30710099
307200                :RECDIS-PLAN-ITM-QTY,                             30720099
307300                :RECDIS-AP-PRC-CDE,                               30730099
307400                :RECDIS-AP-PRC-DTE,                               30740099
307500                :PV-CURRENT-TIMESTAMP                             30750099
307600           FROM TRECDIS                                           30760099
307700         WHERE   ORD_NBR             =  :ASC-PO-NBR               30770099
307800          AND    ORD_LNE_NBR         =  :RECDIS-ORD-LNE-NBR       30780099
307900          AND    REC_SEQ_NBR         =  :ASC-REC-SEQ-NBR          30790099
308000          AND    OPER_UNT_ID         =  :ASC-OPER-UNT-ID          30800099
308100          AND    FCLTY_ID            =  :ASC-FCLTY-ID             30810099
308300          AND    STR_NBR             =  :ASC-STR-NBR              30830099
308400     END-EXEC                                                     30840099
308500                                                                  30850099
308600     EVALUATE TRUE                                                30860099
308700         WHEN SQLCODE = ZERO                                      30870099
308800             SET PS-DATA-OK TO TRUE                               30880099
308900         WHEN SQLCODE = +100                                      30890099
309000              CONTINUE                                            30900099
309100         WHEN SQLCODE = -904                                      30910099
309200         WHEN SQLCODE = -911                                      30920099
309300         WHEN SQLCODE = -913                                      30930099
309400             PERFORM 9900-SOFT-ABORT                              30940099
309500         WHEN SQLWARN0 NOT = SPACES                               30950099
309600         WHEN SQLCODE      NOT = ZERO                             30960099
309700              MOVE '5400-SELECT-RECDIS'                           30970099
309800                             TO DP013-PARAGRAPH                   30980099
309900              MOVE 'UNSUCCESSFUL SELECT OF TRECDIS'               30990099
310000                             TO DP013-MESSAGE-TEXT (1)            31000099
310100              MOVE SQLCA         TO DP013-SQLCA                   31010099
310200              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          31020099
310300              SET DP013-DB2-ABEND                                 31030099
310400                  DP013-XCTL-DISPLAY-RESTART                      31040099
310500                             TO TRUE                              31050099
310600              PERFORM DP013-0000-PROCESS-ABEND                    31060099
310700     END-EVALUATE.                                                31070099
310800/                                                                 31080099
310900 5500-UPDATE-TRECDIS.                                             31090099
311000                                                                  31100099
311100     EXEC SQL                                                     31110099
311200          UPDATE TRECDIS                                          31120099
311300          SET    AP_VERIFY_ITM_QTY   =  :RECDIS-AP-VERIFY-ITM-QTY 31130099
311400          WHERE                                                   31140099
311500                 ORD_NBR             =  :ASC-PO-NBR               31150099
311600          AND    ORD_LNE_NBR         =  :RECDIS-ORD-LNE-NBR       31160099
311700          AND    REC_SEQ_NBR         =  :ASC-REC-SEQ-NBR          31170099
311800          AND    OPER_UNT_ID         =  :ASC-OPER-UNT-ID          31180099
311900          AND    FCLTY_ID            =  :ASC-FCLTY-ID             31190099
312100          AND    STR_NBR             =  :ASC-STR-NBR              31210099
312200     END-EXEC.                                                    31220099
312300                                                                  31230099
312400     EVALUATE TRUE                                                31240099
312500         WHEN SQLCODE = ZERO                                      31250099
312600              CONTINUE                                            31260099
312700         WHEN SQLCODE = -904                                      31270099
312800         WHEN SQLCODE = -911                                      31280099
312900         WHEN SQLCODE = -913                                      31290099
313000              SET PS-UPDATES-DONE TO TRUE                         31300099
313100              PERFORM 9900-SOFT-ABORT                             31310099
313200         WHEN SQLWARN0 NOT = SPACE                                31320099
313300         WHEN SQLCODE NOT = ZERO                                  31330099
313400              MOVE '5500-UPDATE-TRECDIS'                          31340099
313500                               TO DP013-PARAGRAPH                 31350099
313600              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            31360099
313700                               TO DP013-MESSAGE-TEXT (1)          31370099
313800              MOVE SQLCA       TO DP013-SQLCA                     31380099
313900              SET DP013-DB2-ABEND                                 31390099
314000                               TO TRUE                            31400099
314100              PERFORM DP013-0000-PROCESS-ABEND                    31410099
314200     END-EVALUATE.                                                31420099
314300/                                                                 31430099
314400 5505-ADD-TO-RECD-AUDIT-BEFORE.                                   31440099
314500     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       31450099
314600     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          31460099
314700     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         31470099
314800     MOVE RECDIS-ORD-NBR           TO RC031-PO-NBR.               31480099
314900     MOVE RECDIS-ORD-LNE-NBR       TO RC031-PO-LNE-NBR.           31490099
315000     MOVE RECDIS-REC-SEQ-NBR       TO RC031-REC-SEQ-NBR.          31500099
315100     MOVE RECDIS-OPER-UNT-ID       TO RC031-OPER-UNT-ID.          31510099
315200     MOVE RECDIS-FCLTY-ID          TO RC031-FCLTY-ID.             31520099
315300     MOVE RECDIS-STR-NBR           TO RC031-STR-NBR.              31530099
315400     MOVE DP020-USERID             TO RC031-UPD-UID.              31540099
315500     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID.           31550099
315600     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             31560099
315700     MOVE PV-NOTIF-NBR             TO RC031-NOTIF-NBR.            31570099
315800     MOVE PV-CYC-ADJ-NBR           TO RC031-ADJ-CYC-NBR.          31580099
315900     EXEC CICS                                                    31590099
316000         LINK PROGRAM  (PC-AUDIT-RTN)                             31600099
316100              COMMAREA (RC031-FIELDS)                             31610099
316200              LENGTH   (PC-AUDIT-RTN-LENGTH)                      31620099
316300     END-EXEC.                                                    31630099
316400     EVALUATE TRUE                                                31640099
316500         WHEN RC031-CALL-SUCCESSFUL                               31650099
316600             CONTINUE                                             31660099
316700                                                                  31670099
316800         WHEN OTHER                                               31680099
316900              MOVE '5505-ADD-TO-RECD-AUDIT-BEFORE'                31690099
317000                                    TO DP013-PARAGRAPH            31700099
317100              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               31710099
317200                                TO DP013-MESSAGE-TEXT (1)         31720099
317300              MOVE RC031-RETURN-DESC                              31730099
317400                                TO DP013-MESSAGE-TEXT (2)         31740099
317500              MOVE RC031-SQLCA      TO DP013-SQLCA                31750099
317600              SET DP013-DB2-ABEND                                 31760099
317700                  DP013-XCTL-DISPLAY-RESTART                      31770099
317800                                    TO TRUE                       31780099
317900              PERFORM DP013-0000-PROCESS-ABEND                    31790099
318000     END-EVALUATE.                                                31800099
318100                                                                  31810099
318200                                                                  31820099
318300 5515-ADD-TO-RECD-AUDIT-AFTER.                                    31830099
318400     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       31840099
318500     MOVE 'A'                      TO RC031-AUD-TYP-CDE.          31850099
318600     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         31860099
318700     MOVE RECDIS-ORD-NBR           TO RC031-PO-NBR.               31870099
318800     MOVE RECDIS-ORD-LNE-NBR       TO RC031-PO-LNE-NBR.           31880099
318900     MOVE RECDIS-REC-SEQ-NBR       TO RC031-REC-SEQ-NBR.          31890099
319000     MOVE RECDIS-OPER-UNT-ID       TO RC031-OPER-UNT-ID.          31900099
319100     MOVE RECDIS-FCLTY-ID          TO RC031-FCLTY-ID.             31910099
319200     MOVE RECDIS-STR-NBR           TO RC031-STR-NBR.              31920099
319300     MOVE DP020-USERID             TO RC031-UPD-UID.              31930099
319400     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID.           31940099
319500     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             31950099
319600     MOVE PV-NOTIF-NBR             TO RC031-NOTIF-NBR.            31960099
319700     MOVE PV-CYC-ADJ-NBR           TO RC031-ADJ-CYC-NBR.          31970099
319800     EXEC CICS                                                    31980099
319900         LINK PROGRAM  (PC-AUDIT-RTN)                             31990099
320000              COMMAREA (RC031-FIELDS)                             32000099
320100              LENGTH   (PC-AUDIT-RTN-LENGTH)                      32010099
320200     END-EXEC.                                                    32020099
320300     EVALUATE TRUE                                                32030099
320400         WHEN RC031-CALL-SUCCESSFUL                               32040099
320500             CONTINUE                                             32050099
320600                                                                  32060099
320700         WHEN OTHER                                               32070099
320800              MOVE '5515-ADD-TO-RECD-AUDIT-AFTER'                 32080099
320900                                    TO DP013-PARAGRAPH            32090099
321000              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               32100099
321100                                TO DP013-MESSAGE-TEXT (1)         32110099
321200              MOVE RC031-RETURN-DESC                              32120099
321300                                TO DP013-MESSAGE-TEXT (2)         32130099
321400              MOVE RC031-SQLCA      TO DP013-SQLCA                32140099
321500              SET DP013-DB2-ABEND                                 32150099
321600                  DP013-XCTL-DISPLAY-RESTART                      32160099
321700                                    TO TRUE                       32170099
321800              PERFORM DP013-0000-PROCESS-ABEND                    32180099
321900     END-EVALUATE.                                                32190099
322000                                                                  32200099
322100/                                                                 32210099
322200 5600-UPDATE-TRECITM.                                             32220099
322300                                                                  32230099
322400     SET PS-DATA-OK          TO  TRUE.                            32240099
322500     PERFORM 5610-SELECT-TRECITM.                                 32250099
322600     IF RECITM-RCPT-DISTR-UPD-CDE = 'U'                           32260099
322700     OR RECITM-RCPT-DISTR-UPD-CDE = 'A'                           32270099
322800         CONTINUE                                                 32280099
322900     ELSE                                                         32290099
323000         PERFORM 5610-PROCESS-TRECITM                             32300099
323100         SET PS-RECITM-UPDATED TO TRUE                            32310099
323200     END-IF.                                                      32320099
323300                                                                  32330099
323400 5610-PROCESS-TRECITM.                                            32340099
323500     MOVE 'I'                      TO RC031-TABLE-TO-AUDIT.       32350099
323600     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          32360099
323700     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         32370099
323800     MOVE RECITM-ORD-NBR           TO RC031-PO-NBR.               32380099
323900     MOVE RECITM-ORD-LNE-NBR       TO RC031-PO-LNE-NBR.           32390099
324000     MOVE RECITM-REC-SEQ-NBR       TO RC031-REC-SEQ-NBR.          32400099
324100     MOVE RECITM-OPER-UNT-ID       TO RC031-OPER-UNT-ID.          32410099
324200     MOVE RECITM-FCLTY-ID          TO RC031-FCLTY-ID.             32420099
324300     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID.           32430099
324400                                                                  32440099
324500     EXEC CICS                                                    32450099
324600         LINK PROGRAM  (PC-AUDIT-RTN)                             32460099
324700              COMMAREA (RC031-FIELDS)                             32470099
324800              LENGTH   (PC-AUDIT-RTN-LENGTH)                      32480099
324900     END-EXEC.                                                    32490099
325000     EVALUATE TRUE                                                32500099
325100         WHEN RC031-CALL-SUCCESSFUL                               32510099
325200             CONTINUE                                             32520099
325300                                                                  32530099
325400         WHEN OTHER                                               32540099
325500              MOVE '5610-PROCESS-TRECITM'                         32550099
325600                                   TO DP013-PARAGRAPH             32560099
325700              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               32570099
325800                                   TO DP013-MESSAGE-TEXT (1)      32580099
325900              MOVE RC031-RETURN-DESC                              32590099
326000                                   TO DP013-MESSAGE-TEXT (2)      32600099
326100              MOVE RC031-SQLCA     TO DP013-SQLCA                 32610099
326200              SET DP013-DB2-ABEND                                 32620099
326300                  DP013-XCTL-DISPLAY-RESTART                      32630099
326400                                   TO TRUE                        32640099
326500              PERFORM DP013-0000-PROCESS-ABEND                    32650099
326600     END-EVALUATE.                                                32660099
326700                                                                  32670099
326800     MOVE PC-A                     TO PV-RCPT-DISTR-UPD-CDE.      32680099
326900     PERFORM 5620-UPDATE-TRECITM.                                 32690099
327000                                                                  32700099
327100/                                                                 32710099
327200*----------------------------------------------------------------*32720099
327300*    GET THE CURRENT ROW FOR PROCESSING.                         *32730099
327400*----------------------------------------------------------------*32740099
327500                                                                  32750099
327600 5610-SELECT-TRECITM.                                             32760099
327700                                                                  32770099
327800     EXEC SQL                                                     32780099
327900          SELECT                                                  32790099
328000                ORD_NBR                                           32800099
328100              , ORD_LNE_NBR                                       32810099
328200              , REC_SEQ_NBR                                       32820099
328300              , OPER_UNT_ID                                       32830099
328400              , FCLTY_ID                                          32840099
328500              , CRE_TMST                                          32850099
328600              , CRE_UID                                           32860099
328700              , PO_VER_NBR                                        32870099
328800              , ITM_NBR                                           32880099
328900              , PRE_TKT_IND                                       32890099
329000              , TKT_FMT_ID                                        32900099
329100              , RTV_IND                                           32910099
329200              , STATUS_CDE                                        32920099
329300              , VER_STATUS_CDE                                    32930099
329400              , PKSL_ITM_QTY                                      32940099
329500              , DTL_CK_ITM_QTY                                    32950099
329600              , INNR_PACK_QTY                                     32960099
329700              , CASE_PACK_QTY                                     32970099
329800              , RTV_QTY                                           32980099
329900              , EXPTED_CART_CNT                                   32990099
330000              , ACTL_CART_CNT                                     33000099
330100              , MKING_APRON_TMST                                  33010099
330200              , UNT_COST_AMT                                      33020099
330300              , COLOR_DESC                                        33030099
330400              , SIZE_DESC                                         33040099
330500              , VEND_STYL_NAME                                    33050099
330600              , VEND_DESC                                         33060099
330700              , VERFYD_TMST                                       33070099
330800              , PKSL_NBR                                          33080099
330900              , REC_INV_LNE_NBR                                   33090099
331000              , DMG_ITM_QTY                                       33100099
331100              , UPD_TMST                                          33110099
331200              , UPD_UID                                           33120099
331300              , UPD_PGM_ID                                        33130099
331400              , RCPT_DISTR_UPD_CDE                                33140099
331500              , CURRENT TIMESTAMP                                 33150099
331600          INTO                                                    33160099
331700                :RECITM-ORD-NBR                                   33170099
331800              , :RECITM-ORD-LNE-NBR                               33180099
331900              , :RECITM-REC-SEQ-NBR                               33190099
332000              , :RECITM-OPER-UNT-ID                               33200099
332100              , :RECITM-FCLTY-ID                                  33210099
332200              , :RECITM-CRE-TMST                                  33220099
332300              , :RECITM-CRE-UID                                   33230099
332400              , :RECITM-PO-VER-NBR                                33240099
332500              , :RECITM-ITM-NBR                                   33250099
332600              , :RECITM-PRE-TKT-IND                               33260099
332700              , :RECITM-TKT-FMT-ID                                33270099
332800              , :RECITM-RTV-IND                                   33280099
332900              , :RECITM-STATUS-CDE                                33290099
333000              , :RECITM-VER-STATUS-CDE                            33300099
333100              , :RECITM-PKSL-ITM-QTY                              33310099
333200              , :RECITM-DTL-CK-ITM-QTY                            33320099
333300              , :RECITM-INNR-PACK-QTY                             33330099
333400              , :RECITM-CASE-PACK-QTY                             33340099
333500              , :RECITM-RTV-QTY                                   33350099
333600              , :RECITM-EXPTED-CART-CNT                           33360099
333700              , :RECITM-ACTL-CART-CNT                             33370099
333800              , :RECITM-MKING-APRON-TMST                          33380099
333900              , :RECITM-UNT-COST-AMT                              33390099
334000              , :RECITM-COLOR-DESC                                33400099
334100              , :RECITM-SIZE-DESC                                 33410099
334200              , :RECITM-VEND-STYL-NAME                            33420099
334300              , :RECITM-VEND-DESC                                 33430099
334400              , :RECITM-VERFYD-TMST                               33440099
334500              , :RECITM-PKSL-NBR                                  33450099
334600              , :RECITM-REC-INV-LNE-NBR                           33460099
334700              , :RECITM-DMG-ITM-QTY                               33470099
334800              , :RECITM-UPD-TMST                                  33480099
334900              , :RECITM-UPD-UID                                   33490099
335000              , :RECITM-UPD-PGM-ID                                33500099
335100              , :RECITM-RCPT-DISTR-UPD-CDE                        33510099
335200              , :PV-CURRENT-TIMESTAMP                             33520099
335300          FROM                                                    33530099
335400                TRECITM                                           33540099
335500          WHERE                                                   33550099
335600                 ORD_NBR             =  :ASC-PO-NBR               33560099
335700          AND    ORD_LNE_NBR         =  :RECDIS-ORD-LNE-NBR       33570099
335800          AND    REC_SEQ_NBR         =  :ASC-REC-SEQ-NBR          33580099
335900          AND    OPER_UNT_ID         =  :ASC-OPER-UNT-ID          33590099
336000          AND    FCLTY_ID            =  :ASC-FCLTY-ID             33600099
336100          AND    VER_STATUS_CDE      =  :PC-A                     33610099
336200     END-EXEC.                                                    33620099
336300                                                                  33630099
336400     EVALUATE TRUE                                                33640099
336500         WHEN SQLCODE = ZERO                                      33650099
336600              CONTINUE                                            33660099
336700         WHEN SQLCODE = +100                                      33670099
336800              SET PS-DATA-NOT-OK    TO  TRUE                      33680099
336900         WHEN SQLCODE = -904                                      33690099
337000         WHEN SQLCODE = -911                                      33700099
337100         WHEN SQLCODE = -913                                      33710099
337200              PERFORM 9900-SOFT-ABORT                             33720099
337300         WHEN SQLWARN0 NOT = SPACE                                33730099
337400         WHEN SQLCODE NOT = ZERO                                  33740099
337500              MOVE '5610-SELECT-TRECITM'                          33750099
337600                               TO DP013-PARAGRAPH                 33760099
337700              MOVE 'SELECT TRECITM'                               33770099
337800                               TO DP013-MESSAGE-TEXT (1)          33780099
337900              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        33790099
338000              MOVE SQLCA       TO DP013-SQLCA                     33800099
338100              SET DP013-DB2-ABEND                                 33810099
338200                               TO TRUE                            33820099
338300              PERFORM DP013-0000-PROCESS-ABEND                    33830099
338400     END-EVALUATE.                                                33840099
338500/                                                                 33850099
338600*----------------------------------------------------------------*33860099
338700*    UPDATE THE CURRENT ROW.                                     *33870099
338800*----------------------------------------------------------------*33880099
338900                                                                  33890099
339000 5620-UPDATE-TRECITM.                                             33900099
339100                                                                  33910099
339200     EXEC SQL                                                     33920099
339300          UPDATE                                                  33930099
339400                TRECITM                                           33940099
339500          SET   RCPT_DISTR_UPD_CDE =  :PV-RCPT-DISTR-UPD-CDE      33950099
339600          WHERE                                                   33960099
339700                 ORD_NBR             =  :ASC-PO-NBR               33970099
339800          AND    ORD_LNE_NBR         =  :RECDIS-ORD-LNE-NBR       33980099
339900          AND    REC_SEQ_NBR         =  :ASC-REC-SEQ-NBR          33990099
340000          AND    OPER_UNT_ID         =  :ASC-OPER-UNT-ID          34000099
340100          AND    FCLTY_ID            =  :ASC-FCLTY-ID             34010099
340200          AND    VER_STATUS_CDE      =  :PC-A                     34020099
340300     END-EXEC.                                                    34030099
340400                                                                  34040099
340500     EVALUATE TRUE                                                34050099
340600         WHEN SQLCODE = ZERO                                      34060099
340700              CONTINUE                                            34070099
340800         WHEN SQLCODE = -904                                      34080099
340900         WHEN SQLCODE = -911                                      34090099
341000         WHEN SQLCODE = -913                                      34100099
341100              SET PS-UPDATES-DONE TO TRUE                         34110099
341200              PERFORM 9900-SOFT-ABORT                             34120099
341300         WHEN SQLWARN0 NOT = SPACE                                34130099
341400         WHEN SQLCODE NOT = ZERO                                  34140099
341500              MOVE '5620-UPDATE-TRECITM'                          34150099
341600                               TO DP013-PARAGRAPH                 34160099
341700              MOVE 'UPDATE TRECITM STATUS CODE'                   34170099
341800                               TO DP013-MESSAGE-TEXT (1)          34180099
341900              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        34190099
342000              MOVE SQLCA       TO DP013-SQLCA                     34200099
342100              SET DP013-DB2-ABEND                                 34210099
342200                               TO TRUE                            34220099
342300              PERFORM DP013-0000-PROCESS-ABEND                    34230099
342400     END-EVALUATE.                                                34240099
342500/                                                                 34250099
342600 5810-GET-STR-RECDIS-QTY.                                         34260099
342700                                                                  34270099
342800     EXEC SQL                                                     34280099
342900          SELECT                                                  34290099
343000                 SUM(AP_VERIFY_ITM_QTY)                           34300099
343100                ,SUM(VERIFY_ITM_QTY)                              34310099
343200                ,SUM(EXPTED_ITM_QTY)                              34320099
343300           INTO                                                   34330099
343400                 :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND           34340099
343500                ,:RECDIS-VERIFY-ITM-QTY :PV-NULL-IND              34350099
343600                ,:RECDIS-EXPTED-ITM-QTY :PV-NULL-IND              34360099
343700           FROM                                                   34370099
343800                 TRECDIS                                          34380099
343900           WHERE                                                  34390099
344000                 ORD_NBR         =  :ASC-PO-NBR                   34400099
344200            AND  STR_NBR         =  :ASC-STR-NBR                  34420099
344300            AND  REC_SEQ_NBR     =  :ASC-REC-SEQ-NBR              34430099
344400     END-EXEC.                                                    34440099
344500                                                                  34450099
344600     EVALUATE TRUE                                                34460099
344700         WHEN SQLCODE = ZERO                                      34470099
344800         WHEN SQLCODE = +100                                      34480099
344900              CONTINUE                                            34490099
345000         WHEN SQLCODE = -904                                      34500099
345100         WHEN SQLCODE = -911                                      34510099
345200         WHEN SQLCODE = -913                                      34520099
345300              PERFORM 9900-SOFT-ABORT                             34530099
345400         WHEN SQLWARN0 NOT = SPACE                                34540099
345500         WHEN SQLCODE NOT = ZERO                                  34550099
345600              MOVE '5810-GET-STR-RECDIS-QTY'                      34560099
345700                               TO DP013-PARAGRAPH                 34570099
345800              MOVE 'SUM RECDIS VERIFY QUANTITY'                   34580099
345900                               TO DP013-MESSAGE-TEXT (1)          34590099
346000              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        34600099
346100              MOVE SQLCA       TO DP013-SQLCA                     34610099
346200              SET DP013-DB2-ABEND                                 34620099
346300                               TO TRUE                            34630099
346400              PERFORM DP013-0000-PROCESS-ABEND                    34640099
346500     END-EVALUATE.                                                34650099
346600/                                                                 34660099
346700 5820-GET-RECDIS-QTY.                                             34670099
346800                                                                  34680099
346900     EXEC SQL                                                     34690099
347000          SELECT                                                  34700099
347100                 SUM(C.AP_VERIFY_ITM_QTY)                         34710099
347200           INTO                                                   34720099
347300                 :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND           34730099
347400           FROM                                                   34740099
347500                 TRECEIV A                                        34750099
347600               , TRECITM B                                        34760099
347700               , TRECDIS C                                        34770099
347800           WHERE                                                  34780099
347900                 A.ORD_NBR         =  :ASC-PO-NBR                 34790099
348000            AND  A.ORD_NBR         =  B.ORD_NBR                   34800099
348100            AND  A.ORD_NBR         =  C.ORD_NBR                   34810099
348200            AND  B.ORD_LNE_NBR     =  :RECDIS-ORD-LNE-NBR         34820099
348300            AND  B.ORD_LNE_NBR     =  C.ORD_LNE_NBR               34830099
348400            AND  A.VER_STATUS_CDE  =  :PC-A                       34840099
348500            AND  B.VER_STATUS_CDE  =  :PC-A                       34850099
348700            AND  B.STATUS_CDE      =  :PC-VE                      34870099
348800            AND  A.REC_SEQ_NBR     =  B.REC_SEQ_NBR               34880099
348900            AND  A.REC_SEQ_NBR     =  C.REC_SEQ_NBR               34890099
349000     END-EXEC.                                                    34900099
349100                                                                  34910099
349200     EVALUATE TRUE                                                34920099
349300         WHEN SQLCODE = ZERO                                      34930099
349400         WHEN SQLCODE = +100                                      34940099
349500              CONTINUE                                            34950099
349600         WHEN SQLCODE = -904                                      34960099
349700         WHEN SQLCODE = -911                                      34970099
349800         WHEN SQLCODE = -913                                      34980099
349900              PERFORM 9900-SOFT-ABORT                             34990099
350000         WHEN SQLWARN0 NOT = SPACE                                35000099
350100         WHEN SQLCODE NOT = ZERO                                  35010099
350200              MOVE '5820-GET-RECDIS-QTY'                          35020099
350300                               TO DP013-PARAGRAPH                 35030099
350400              MOVE 'SUM RECDIS VERIFY QUANTITY'                   35040099
350500                               TO DP013-MESSAGE-TEXT (1)          35050099
350600              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        35060099
350700              MOVE SQLCA       TO DP013-SQLCA                     35070099
350800              SET DP013-DB2-ABEND                                 35080099
350900                               TO TRUE                            35090099
351000              PERFORM DP013-0000-PROCESS-ABEND                    35100099
351100     END-EVALUATE.                                                35110099
351200/                                                                 35120099
351300                                                                  35130099
351400*----------------------------------------------------------------*35140099
351500*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *35150099
351600*----------------------------------------------------------------*35160099
351700                                                                  35170099
351800 6010-DELETE-SEL-QUEUE.                                           35180099
351900                                                                  35190099
352000     EXEC CICS                                                    35200099
352100         DELETEQ TS                                               35210099
352200             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       35220099
352300             RESP  (PV-CICS-RESP)                                 35230099
352400     END-EXEC.                                                    35240099
352500                                                                  35250099
352600     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      35260099
352700        (PV-CICS-RESP = DFHRESP(QIDERR)))                         35270099
352800         CONTINUE                                                 35280099
352900     ELSE                                                         35290099
353000         SET DP013-CICS-ABEND TO TRUE                             35300099
353100         SET DP013-NO-ROLLBACK TO TRUE                            35310099
353200         MOVE '6010-DELETE-SEL-QUEUE'                             35320099
353300                        TO DP013-PARAGRAPH                        35330099
353400         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         35340099
353500                        TO DP013-MESSAGE-TEXT (1)                 35350099
353600         PERFORM DP013-0000-PROCESS-ABEND                         35360099
353700     END-IF.                                                      35370099
353800                                                                  35380099
353900*----------------------------------------------------------------*35390099
354000*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *35400099
354100*----------------------------------------------------------------*35410099
354200                                                                  35420099
354300 6111-WRITE-LIST-QUEUE.                                           35430099
354400                                                                  35440099
354500     EXEC CICS                                                    35450099
354600         WRITEQ TS                                                35460099
354700             QUEUE (ASC-LIST-QUEUE-NAME)                          35470099
354800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     35480099
354900             ITEM  (PV-SAVE-ITEM)                                 35490099
355000             REWRITE                                              35500099
355100             RESP  (PV-CICS-RESP)                                 35510099
355200     END-EXEC.                                                    35520099
355300                                                                  35530099
355400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          35540099
355500         CONTINUE                                                 35550099
355600     ELSE                                                         35560099
355700         SET DP013-CICS-ABEND  TO  TRUE                           35570099
355800         SET DP013-NO-ROLLBACK TO  TRUE                           35580099
355900         MOVE '6111-WRITE-LIST-QUEUE'                             35590099
356000                               TO  DP013-PARAGRAPH                35600099
356100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  35610099
356200                               TO  DP013-MESSAGE-TEXT(1)          35620099
356300         PERFORM DP013-0000-PROCESS-ABEND                         35630099
356400     END-IF.                                                      35640099
356500/                                                                 35650099
356600*----------------------------------------------------------------*35660099
356700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*35670099
356800*----------------------------------------------------------------*35680099
356900                                                                  35690099
357000 6112-READ-LIST-QUEUE.                                            35700099
357100                                                                  35710099
357200     EXEC CICS                                                    35720099
357300         READQ TS                                                 35730099
357400             QUEUE (ASC-LIST-QUEUE-NAME)                          35740099
357500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     35750099
357600             ITEM  (PV-ITEM)                                      35760099
357700             RESP  (PV-CICS-RESP)                                 35770099
357800     END-EXEC.                                                    35780099
357900                                                                  35790099
358000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          35800099
358100         CONTINUE                                                 35810099
358200     ELSE                                                         35820099
358300         SET DP013-CICS-ABEND        TO TRUE                      35830099
358400         SET DP013-NO-ROLLBACK       TO TRUE                      35840099
358500         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           35850099
358600         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    35860099
358700                                     TO DP013-MESSAGE-TEXT(1)     35870099
358800         PERFORM DP013-0000-PROCESS-ABEND                         35880099
358900     END-IF.                                                      35890099
358910                                                                  35891099
358920******************************************************************35892099
358930* WRITE ENTRIES TO VERIFY ADJUSTMENT QUEUE                       *35893099
358940******************************************************************35894099
358950 6150-WRITE-VRFY-ADJ-QUEUE.                                       35895099
358960*                                                                 35896099
358970     MOVE  ASC-PO-NBR                                             35897099
358980                                       TO PC241-PO-NBR            35898099
358990     MOVE  LQW-PO-LNE-NBR(LQW-IDX)                                35899099
358991                                       TO PC241-PO-LNE-NBR        35899199
358992     MOVE  ASC-REC-SEQ-NBR                                        35899299
358993                                       TO PC241-REC-SEQ-NBR       35899399
358994     MOVE  ASC-OPER-UNT-ID                                        35899499
358995                                       TO PC241-OPER-UNT-ID       35899599
358996     MOVE  ASC-FCLTY-ID                                           35899699
358997                                       TO PC241-FCLTY-ID          35899799
358998     MOVE  ASC-STR-NBR                                            35899899
358999                                       TO PC241-STR-NBR           35899999
359000     MOVE  PA-UPDATE-DIFF-QTY                                     35900099
359001                                       TO PC241-STR-ADJ-QTY       35900199
359002     ADD   1               TO PV-VRFY-ITEM                        35900299
359003*                                                                 35900399
359004     EXEC CICS WRITEQ TS                                          35900499
359005               QUEUE (ASC-VRFY-ADJ-QUEUE-NAME)                    35900599
359006               FROM  (PC241-FIELDS)                               35900699
359007               ITEM  (PV-VRFY-ITEM)                               35900799
359008               RESP  (PV-CICS-RESP)                               35900899
359009     END-EXEC.                                                    35900999
359010                                                                  35901099
359011     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       35901199
359012         SET DP013-CICS-ABEND                                     35901299
359013             DP013-NO-ROLLBACK   TO TRUE                          35901399
359014         MOVE '6150-WRITE-VRFY-ADJ-QUEUE'                         35901499
359015                                 TO DP013-PARAGRAPH               35901599
359016         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE'        35901699
359017                                 TO DP013-MESSAGE-TEXT(1)         35901799
359018         PERFORM DP013-0000-PROCESS-ABEND                         35901899
359019     END-IF.                                                      35901999
359020/                                                                 35902099
359021******************************************************************35902199
359022* THIS PARAGRAPH WILL CONTROL THE PROCESSING ASSOCIATED TO THE   *35902299
359023* UNITS WORKED ROUTINE.                                           35902399
359024******************************************************************35902499
359025 7500-PROCESS-UNITS-WORK.                                         35902599
359026                                                                  35902699
359027     PERFORM 7600-RECEIV-PURITM-JOIN.                             35902799
359028     PERFORM 7800-UNITS-WORK-ROUTINE.                             35902899
359029                                                                  35902999
359030*    IF  PV-XLT00010-TYPE-DC                                      35903099
359031*        PERFORM 7800-UNITS-WORK-ROUTINE                          35903199
359032*    ELSE                                                         35903299
359033*        MOVE 'Y'                   TO PC238-DIRECT-STORE-SW      35903399
359034*        PERFORM 7800-UNITS-WORK-ROUTINE                          35903499
359035*    END-IF.                                                      35903599
359036/                                                                 35903699
359037******************************************************************35903799
359038*  THIS PARAGRAPH WILL BE USED TO GET SOME FIELDS TO DETERMINE   *35903899
359039*  IF THE UNITS WORKED MODULE NEEDS TO BE CALLED (IF THE FULL-   *35903999
359040*  CASE TIMESTAMP IS A VALUE OTHER THAN 9'S, THEN THE LINE IS    *35904099
359041*  CONFIRMED AND THE UNITS WORKED MODULE WILL NEED TO BE CALLED  *35904199
359042*  FOR CONFIRMATION UNIT ADJUSTMENTS.  THE OTHER FIELDS ARE USED *35904299
359043*  BY THE MODULE TO DETERMINE THE RETAIL VALUE OF THE ADJUSTMENT *35904399
359044*  AND WHAT OPER UNIT AND PROCESS AREA THE ADJUSTMENT SHOULD BE  *35904499
359045*  POSTED TO WITHIN THE UNITS WORKED SYSTEM.                     *35904599
359046******************************************************************35904699
359047 7600-RECEIV-PURITM-JOIN.                                         35904799
359048                                                                  35904899
359049     EXEC SQL                                                     35904999
359050     SELECT A.CURR_OPER_UNT_ID,                                   35905099
359051            C.UNT_RTL_PR_AMT,                                     35905199
359052            D.LOC_TYP_CDE                                         35905299
359053         INTO :PV-CURR-OPER-UNT-ID                                35905399
359054         ,    :PURITM-UNT-RTL-PR-AMT                              35905499
359055         ,    :PV-XLT00010-TYPE-CODE                              35905599
359056         FROM                                                     35905699
359057             TRECEIV A                                            35905799
359058         ,   TRECITM B                                            35905899
359059         ,   TPURITM C                                            35905999
359060         ,   XLT_LOC D                                            35906099
359061         WHERE A.ORD_NBR          = :ASC-PO-NBR                   35906199
359062           AND A.REC_SEQ_NBR      = :ASC-REC-SEQ-NBR              35906299
359063           AND B.ORD_NBR          = A.ORD_NBR                     35906399
359064           AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR                 35906499
359065           AND B.ORD_LNE_NBR      = :RECDIS-ORD-LNE-NBR           35906599
359066           AND C.PO_NBR           = B.ORD_NBR                     35906699
359067           AND C.APP_PO_LNE_NBR   = B.ORD_LNE_NBR                 35906799
359068           AND C.VER_NBR          = B.PO_VER_NBR                  35906899
359069           AND D.LOC_NBR          = A.CURR_OPER_UNT_ID            35906999
359070     END-EXEC.                                                    35907099
359071*                                                                 35907199
359072     EVALUATE TRUE                                                35907299
359073         WHEN SQLCODE = ZERO                                      35907399
359074             CONTINUE                                             35907499
359075         WHEN SQLCODE = -904                                      35907599
359076         WHEN SQLCODE = -911                                      35907699
359077         WHEN SQLCODE = -913                                      35907799
359078             PERFORM 9900-SOFT-ABORT                              35907899
359079                                                                  35907999
359080         WHEN SQLWARN0 NOT = SPACES                               35908099
359081         WHEN SQLCODE < ZERO                                      35908199
359082         WHEN SQLCODE > ZERO                                      35908299
359083             MOVE '7600-RECEIV-PURITM-JOIN'                       35908399
359084                                  TO DP013-PARAGRAPH              35908499
359085             MOVE 'UNSUCCESSFUL JOIN OF 3 TABLES'                 35908599
359086                                  TO DP013-MESSAGE-TEXT (1)       35908699
359087             MOVE SQLCA      TO DP013-SQLCA                       35908799
359088             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)          35908899
359089             SET DP013-DB2-ABEND                                  35908999
359090                 DP013-NO-ROLLBACK                                35909099
359091                                  TO TRUE                         35909199
359092             PERFORM DP013-0000-PROCESS-ABEND                     35909299
359093     END-EVALUATE.                                                35909399
359094                                                                  35909499
359095******************************************************************35909599
359096* THIS PARAGRAPH WILL FORMAT ALL OF THE DATA NEEDED FOR THE      *35909699
359097* UNITS WORKED ROUTINE AND WILL THEN CALL THE ROUTINE AND        *35909799
359098* THE RESULTS RETURNED FROM THE ROUTINE.                         *35909899
359099******************************************************************35909999
359100 7800-UNITS-WORK-ROUTINE.                                         35910099
359101                                                                  35910199
359102     INITIALIZE PC238-COMM-AREA.                                  35910299
359103                                                                  35910399
359104     EXEC SQL                                                     35910499
359105         SET :PV-TMST =  CURRENT_TIMESTAMP                        35910599
359106     END-EXEC                                                     35910699
359107                                                                  35910799
359108     MOVE PV-TMST                 TO PC238-WRKD-TMST.             35910899
359109                                                                  35910999
359110     IF  PV-XLT00010-TYPE-DC                                      35911099
359111         NEXT SENTENCE                                            35911199
359112     ELSE                                                         35911299
359113         MOVE 'Y'                   TO PC238-DIRECT-STORE-SW      35911399
359115     END-IF.                                                      35911599
359116                                                                  35911699
359117     MOVE PV-CURR-OPER-UNT-ID     TO PC238-WRKD-OPER-UNT-ID.      35911799
359118     MOVE ASC-PO-NBR              TO PC238-PO-NBR.                35911899
359119     MOVE ASC-REC-SEQ-NBR         TO PC238-RCVR-SEQ-NBR.          35911999
359120     MOVE RECDIS-ORD-LNE-NBR      TO PC238-PO-LNE-NBR.            35912099
359121                                                                  35912199
359122     MOVE PA-UPDATE-DIFF-QTY      TO PC238-WRKD-UNT-QTY.          35912299
359123     MOVE PURITM-UNT-RTL-PR-AMT   TO PC238-UNT-RETAIL-PRC.        35912399
359124     SET  PC238-TRANS-POST-VRFY-ADJ TO TRUE.                      35912499
359125     SET  PC238-MANUAL-VERIFY     TO TRUE.                        35912599
359126     MOVE ASC-VRFY-ADJ-QUEUE-NAME TO PC238-VRFY-ADJ-QUEUE-NAME.   35912699
359127     MOVE PV-VRFY-ITEM            TO PC238-TOT-QUEUE-ITEMS.       35912799
359128                                                                  35912899
359129************************************************                  35912999
359130*                                                                 35913099
359131*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    35913199
359132*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  35913299
359133*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  35913399
359134*    MOVE PC238-WRKD-OPER-UNT-ID                                  35913499
359135*                            TO PC-DISPLAY-OPER.                  35913599
359136*    STRING ' RCKCS280 - '      DELIMITED BY SIZE                 35913699
359137*           ' CALLING PCKCS756 WITH KEY INFO - '                  35913799
359138*                               DELIMITED BY SIZE                 35913899
359139*           PC-DISPLAY-PO       DELIMITED BY SIZE                 35913999
359140*           ' - '               DELIMITED BY SIZE                 35914099
359141*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 35914199
359142*           ' - '               DELIMITED BY SIZE                 35914299
359143*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 35914399
359144*           ' - '               DELIMITED BY SIZE                 35914499
359145*           PC-DISPLAY-OPER     DELIMITED BY SIZE                 35914599
359146*                        INTO PV-CICS-MSG-AREA.                   35914699
359147*    MOVE LENGTH OF PV-CICS-MSG-AREA                              35914799
359148*                          TO PV-COMMAREA-LENGTH.                 35914899
359149*    PERFORM 9700-WRITE-TO-CICS-LOG.                              35914999
359150*                                                                 35915099
359151************************************************                  35915199
359152                                                                  35915299
359153     MOVE LENGTH OF PC238-COMM-AREA                               35915399
359154                                  TO PV-COMMAREA-LENGTH.          35915499
359155                                                                  35915599
359156     EXEC CICS                                                    35915699
359157         LINK PROGRAM  (PV-PCKCS756)                              35915799
359158              COMMAREA (PC238-COMM-AREA)                          35915899
359159              LENGTH   (PV-COMMAREA-LENGTH)                       35915999
359160              RESP     (PV-CICS-RESPONSE)                         35916099
359161     END-EXEC.                                                    35916199
359162                                                                  35916299
359163************************************************                  35916399
359164*                                                                 35916499
359165*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    35916599
359166*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  35916699
359167*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  35916799
359168*    MOVE PC238-WRKD-OPER-UNT-ID                                  35916899
359169*                            TO PC-DISPLAY-OPER.                  35916999
359170*    STRING ' RCKCS280 - '      DELIMITED BY SIZE                 35917099
359171*           ' RETURN FROM PCKCS756 - '                            35917199
359172*                               DELIMITED BY SIZE                 35917299
359173*           PC-DISPLAY-PO       DELIMITED BY SIZE                 35917399
359174*           ' - '               DELIMITED BY SIZE                 35917499
359175*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 35917599
359176*           ' - '               DELIMITED BY SIZE                 35917699
359177*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 35917799
359178*           ' - '               DELIMITED BY SIZE                 35917899
359179*           PC238-MOD-SUCCESS-CDE                                 35917999
359180*                               DELIMITED BY SIZE                 35918099
359181*           ' - '               DELIMITED BY SIZE                 35918199
359182*           PC238-UNSUCCESSFUL-CDE                                35918299
359183*                               DELIMITED BY SIZE                 35918399
359184*                        INTO PV-CICS-MSG-AREA.                   35918499
359185*    MOVE LENGTH OF PV-CICS-MSG-AREA                              35918599
359186*                          TO PV-COMMAREA-LENGTH.                 35918699
359187*    PERFORM 9700-WRITE-TO-CICS-LOG.                              35918799
359188*                                                                 35918899
359189************************************************                  35918999
359190                                                                  35919099
359191     EVALUATE TRUE                                                35919199
359192         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 35919299
359193              IF  PC238-MOD-UNSUCCESSFUL                          35919399
359194                  PERFORM 7810-MOD-UNSUCCESSFUL                   35919499
359195              END-IF                                              35919599
359196         WHEN OTHER                                               35919699
359197              MOVE PC238-PO-NBR       TO PC-DISPLAY-PO            35919799
359198              MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR          35919899
359199              MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE          35919999
359200              MOVE PC238-WRKD-OPER-UNT-ID                         35920099
359201                                      TO PC-DISPLAY-OPER          35920199
359202              MOVE PC238-BAD-SQL-CDE  TO PC-DISPLAY-SQL-CODE      35920299
359203              MOVE PV-CICS-RESPONSE   TO PC-DISPLAY-CICS-RESP     35920399
359204              SET PS-UNITS-WORKED-ERROR  TO TRUE                  35920499
359205              STRING ' RCKCS280 - '      DELIMITED BY SIZE        35920599
359206                     ' 7800-UNITS-WORK-ROUTINE '                  35920699
359207                                         DELIMITED BY SIZE        35920799
359208                     ' BAD CALL TO UNITS WORKED MODULE '          35920899
359209                                         DELIMITED BY SIZE        35920999
359210                     ' - CICS RESP '                              35921099
359211                                         DELIMITED BY SIZE        35921199
359212                     PC-DISPLAY-CICS-RESP                         35921299
359213                                         DELIMITED BY SIZE        35921399
359214                                      INTO PV-CICS-MSG-AREA       35921499
359215              MOVE LENGTH OF PV-CICS-MSG-AREA                     35921599
359216                                        TO PV-COMMAREA-LENGTH     35921699
359217              PERFORM 9700-WRITE-TO-CICS-LOG                      35921799
359218              MOVE SPACES TO PV-CICS-MSG-AREA                     35921899
359219              STRING ' RCKCS280 - '      DELIMITED BY SIZE        35921999
359220                     ' 7800-UNITS-WORK-ROUTINE '                  35922099
359221                                         DELIMITED BY SIZE        35922199
359222                     ' KEY INFO - '      DELIMITED BY SIZE        35922299
359223                     PC-DISPLAY-PO       DELIMITED BY SIZE        35922399
359224                     ' - '               DELIMITED BY SIZE        35922499
359225                     PC-DISPLAY-RCVR     DELIMITED BY SIZE        35922599
359226                     ' - '               DELIMITED BY SIZE        35922699
359227                     PC-DISPLAY-LINE     DELIMITED BY SIZE        35922799
359228                                  INTO PV-CICS-MSG-AREA           35922899
359229              MOVE LENGTH OF PV-CICS-MSG-AREA                     35922999
359230                                    TO PV-COMMAREA-LENGTH         35923099
359231              PERFORM 9700-WRITE-TO-CICS-LOG                      35923199
359232              PERFORM 9900-SOFT-ABORT                             35923299
359233     END-EVALUATE.                                                35923399
359234                                                                  35923499
359235******************************************************************35923599
359236* THIS PARAGRAPH WILL MANAGE THE DISPLAY OF INFORMATION TO CSSL  *35923699
359237* FOR WHEN THE UNITS WORKED ROUTINE WAS UNSUCCESSFUL.  THIS      *35923799
359238* PARAGRAPH WILL FORMAT A MESSAGE AND GET IT WRITTEN TO THE      *35923899
359239* CICS LOG AND THEN SOFT ABORT THE PROGRAM.                      *35923999
359240******************************************************************35924099
359241 7810-MOD-UNSUCCESSFUL.                                           35924199
359242                                                                  35924299
359243     MOVE PC238-PO-NBR              TO PC-DISPLAY-PO.             35924399
359244     MOVE PC238-RCVR-SEQ-NBR        TO PC-DISPLAY-RCVR.           35924499
359245     MOVE PC238-PO-LNE-NBR          TO PC-DISPLAY-LINE.           35924599
359246     MOVE PC238-WRKD-OPER-UNT-ID    TO PC-DISPLAY-OPER.           35924699
359247     MOVE PC238-BAD-SQL-CDE         TO PC-DISPLAY-SQL-CODE.       35924799
359248     SET  PS-UNITS-WORKED-ERROR     TO TRUE.                      35924899
359249     SET  PS-UPDATES-DONE           TO TRUE.                      35924999
359250                                                                  35925099
359251     IF  PC238-MOD-BAD-TMST                                       35925199
359252         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35925299
359253                ' 7800-UNITS-WORK-ROUTINE '                       35925399
359254                                    DELIMITED BY SIZE             35925499
359255                ' BAD TIMESTAMP '   DELIMITED BY SIZE             35925599
359256                PC238-WRKD-TMST     DELIMITED BY SIZE             35925699
359257                             INTO PV-CICS-MSG-AREA                35925799
359258         MOVE LENGTH OF PV-CICS-MSG-AREA                          35925899
359259                               TO PV-COMMAREA-LENGTH              35925999
359260         PERFORM 9700-WRITE-TO-CICS-LOG                           35926099
359261         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35926199
359262                ' 7800-UNITS-WORK-ROUTINE '                       35926299
359263                                    DELIMITED BY SIZE             35926399
359264                ' KEY INFO - '      DELIMITED BY SIZE             35926499
359265                PC-DISPLAY-PO       DELIMITED BY SIZE             35926599
359266                ' - '               DELIMITED BY SIZE             35926699
359267                PC-DISPLAY-RCVR     DELIMITED BY SIZE             35926799
359268                ' - '               DELIMITED BY SIZE             35926899
359269                PC-DISPLAY-LINE     DELIMITED BY SIZE             35926999
359270                             INTO PV-CICS-MSG-AREA                35927099
359271         MOVE LENGTH OF PV-CICS-MSG-AREA                          35927199
359272                               TO PV-COMMAREA-LENGTH              35927299
359273         PERFORM 9700-WRITE-TO-CICS-LOG                           35927399
359274         PERFORM 9900-SOFT-ABORT                                  35927499
359275     ELSE                                                         35927599
359276     IF  PC238-MOD-BAD-OPER                                       35927699
359277         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35927799
359278                ' 7800-UNITS-WORK-ROUTINE '                       35927899
359279                                    DELIMITED BY SIZE             35927999
359280                ' BAD OPER UNIT '   DELIMITED BY SIZE             35928099
359281                PC-DISPLAY-OPER     DELIMITED BY SIZE             35928199
359282                             INTO PV-CICS-MSG-AREA                35928299
359283         MOVE LENGTH OF PV-CICS-MSG-AREA                          35928399
359284                               TO PV-COMMAREA-LENGTH              35928499
359285         PERFORM 9700-WRITE-TO-CICS-LOG                           35928599
359286         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35928699
359287                ' 7800-UNITS-WORK-ROUTINE '                       35928799
359288                                    DELIMITED BY SIZE             35928899
359289                ' KEY INFO - '      DELIMITED BY SIZE             35928999
359290                PC-DISPLAY-PO       DELIMITED BY SIZE             35929099
359291                ' - '               DELIMITED BY SIZE             35929199
359292                PC-DISPLAY-RCVR     DELIMITED BY SIZE             35929299
359293                ' - '               DELIMITED BY SIZE             35929399
359294                PC-DISPLAY-LINE     DELIMITED BY SIZE             35929499
359295                             INTO PV-CICS-MSG-AREA                35929599
359296         MOVE LENGTH OF PV-CICS-MSG-AREA                          35929699
359297                               TO PV-COMMAREA-LENGTH              35929799
359298         PERFORM 9700-WRITE-TO-CICS-LOG                           35929899
359299         PERFORM 9900-SOFT-ABORT                                  35929999
359300     ELSE                                                         35930099
359301     IF  PC238-MOD-BAD-TRANS-TYPE                                 35930199
359302         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35930299
359303                ' 7800-UNITS-WORK-ROUTINE '                       35930399
359304                                    DELIMITED BY SIZE             35930499
359305                ' BAD TRAN TYPE '   DELIMITED BY SIZE             35930599
359306                PC238-TRANS-TYPE-CDE                              35930699
359307                                    DELIMITED BY SIZE             35930799
359308                             INTO PV-CICS-MSG-AREA                35930899
359309         MOVE LENGTH OF PV-CICS-MSG-AREA                          35930999
359310                               TO PV-COMMAREA-LENGTH              35931099
359311         PERFORM 9700-WRITE-TO-CICS-LOG                           35931199
359312         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35931299
359313                ' 7800-UNITS-WORK-ROUTINE '                       35931399
359314                                    DELIMITED BY SIZE             35931499
359315                ' KEY INFO - '      DELIMITED BY SIZE             35931599
359316                PC-DISPLAY-PO       DELIMITED BY SIZE             35931699
359317                ' - '               DELIMITED BY SIZE             35931799
359318                PC-DISPLAY-RCVR     DELIMITED BY SIZE             35931899
359319                ' - '               DELIMITED BY SIZE             35931999
359320                PC-DISPLAY-LINE     DELIMITED BY SIZE             35932099
359321                             INTO PV-CICS-MSG-AREA                35932199
359322         MOVE LENGTH OF PV-CICS-MSG-AREA                          35932299
359323                               TO PV-COMMAREA-LENGTH              35932399
359324         PERFORM 9700-WRITE-TO-CICS-LOG                           35932499
359325         PERFORM 9900-SOFT-ABORT                                  35932599
359326     ELSE                                                         35932699
359327     IF  PC238-MOD-BAD-PO                                         35932799
359328         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35932899
359329                ' 7800-UNITS-WORK-ROUTINE '                       35932999
359330                                    DELIMITED BY SIZE             35933099
359331                ' BAD PO NUMBER '   DELIMITED BY SIZE             35933199
359332                PC-DISPLAY-PO       DELIMITED BY SIZE             35933299
359333                             INTO PV-CICS-MSG-AREA                35933399
359334         MOVE LENGTH OF PV-CICS-MSG-AREA                          35933499
359335                               TO PV-COMMAREA-LENGTH              35933599
359336         PERFORM 9700-WRITE-TO-CICS-LOG                           35933699
359337         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35933799
359338                ' 7800-UNITS-WORK-ROUTINE '                       35933899
359339                                    DELIMITED BY SIZE             35933999
359340                ' KEY INFO - '      DELIMITED BY SIZE             35934099
359341                PC-DISPLAY-PO       DELIMITED BY SIZE             35934199
359342                ' - '               DELIMITED BY SIZE             35934299
359343                PC-DISPLAY-RCVR     DELIMITED BY SIZE             35934399
359344                ' - '               DELIMITED BY SIZE             35934499
359345                PC-DISPLAY-LINE     DELIMITED BY SIZE             35934599
359346                             INTO PV-CICS-MSG-AREA                35934699
359347         MOVE LENGTH OF PV-CICS-MSG-AREA                          35934799
359348                               TO PV-COMMAREA-LENGTH              35934899
359349         PERFORM 9700-WRITE-TO-CICS-LOG                           35934999
359350         PERFORM 9900-SOFT-ABORT                                  35935099
359351     ELSE                                                         35935199
359352     IF  PC238-MOD-BAD-RCVR                                       35935299
359353         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35935399
359354                ' 7800-UNITS-WORK-ROUTINE '                       35935499
359355                                    DELIMITED BY SIZE             35935599
359356                ' BAD RCVR NBR  '   DELIMITED BY SIZE             35935699
359357                PC-DISPLAY-RCVR     DELIMITED BY SIZE             35935799
359358                             INTO PV-CICS-MSG-AREA                35935899
359359         MOVE LENGTH OF PV-CICS-MSG-AREA                          35935999
359360                               TO PV-COMMAREA-LENGTH              35936099
359361         PERFORM 9700-WRITE-TO-CICS-LOG                           35936199
359362         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35936299
359363                ' 7800-UNITS-WORK-ROUTINE '                       35936399
359364                                    DELIMITED BY SIZE             35936499
359365                ' KEY INFO - '      DELIMITED BY SIZE             35936599
359366                PC-DISPLAY-PO       DELIMITED BY SIZE             35936699
359367                ' - '               DELIMITED BY SIZE             35936799
359368                PC-DISPLAY-RCVR     DELIMITED BY SIZE             35936899
359369                ' - '               DELIMITED BY SIZE             35936999
359370                PC-DISPLAY-LINE     DELIMITED BY SIZE             35937099
359371                             INTO PV-CICS-MSG-AREA                35937199
359372         MOVE LENGTH OF PV-CICS-MSG-AREA                          35937299
359373                               TO PV-COMMAREA-LENGTH              35937399
359374         PERFORM 9700-WRITE-TO-CICS-LOG                           35937499
359375         PERFORM 9900-SOFT-ABORT                                  35937599
359376     ELSE                                                         35937699
359377     IF  PC238-MOD-BAD-LINE                                       35937799
359378         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35937899
359379                ' 7800-UNITS-WORK-ROUTINE '                       35937999
359380                                    DELIMITED BY SIZE             35938099
359381                ' BAD LINE NBR  '   DELIMITED BY SIZE             35938199
359382                PC-DISPLAY-LINE     DELIMITED BY SIZE             35938299
359383                             INTO PV-CICS-MSG-AREA                35938399
359384         MOVE LENGTH OF PV-CICS-MSG-AREA                          35938499
359385                               TO PV-COMMAREA-LENGTH              35938599
359386         PERFORM 9700-WRITE-TO-CICS-LOG                           35938699
359387         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35938799
359388                ' 7800-UNITS-WORK-ROUTINE '                       35938899
359389                                    DELIMITED BY SIZE             35938999
359390                ' KEY INFO - '      DELIMITED BY SIZE             35939099
359391                PC-DISPLAY-PO       DELIMITED BY SIZE             35939199
359392                ' - '               DELIMITED BY SIZE             35939299
359393                PC-DISPLAY-RCVR     DELIMITED BY SIZE             35939399
359394                ' - '               DELIMITED BY SIZE             35939499
359395                PC-DISPLAY-LINE     DELIMITED BY SIZE             35939599
359396                             INTO PV-CICS-MSG-AREA                35939699
359397         MOVE LENGTH OF PV-CICS-MSG-AREA                          35939799
359398                               TO PV-COMMAREA-LENGTH              35939899
359399         PERFORM 9700-WRITE-TO-CICS-LOG                           35939999
359400         PERFORM 9900-SOFT-ABORT                                  35940099
359401     ELSE                                                         35940199
359402     IF  PC238-MOD-BAD-NO-SHIFT                                   35940299
359403         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35940399
359404                ' 7800-UNITS-WORK-ROUTINE '                       35940499
359405                                    DELIMITED BY SIZE             35940599
359406                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             35940699
359407                PC238-WRKD-TMST     DELIMITED BY SIZE             35940799
359408                ' FOR OPER '        DELIMITED BY SIZE             35940899
359409                PC-DISPLAY-OPER     DELIMITED BY SIZE             35940999
359410                             INTO PV-CICS-MSG-AREA                35941099
359411         MOVE LENGTH OF PV-CICS-MSG-AREA                          35941199
359412                               TO PV-COMMAREA-LENGTH              35941299
359413         PERFORM 9700-WRITE-TO-CICS-LOG                           35941399
359414         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35941499
359415                ' 7800-UNITS-WORK-ROUTINE '                       35941599
359416                                    DELIMITED BY SIZE             35941699
359417                ' KEY INFO - '      DELIMITED BY SIZE             35941799
359418                PC-DISPLAY-PO       DELIMITED BY SIZE             35941899
359419                ' - '               DELIMITED BY SIZE             35941999
359420                PC-DISPLAY-RCVR     DELIMITED BY SIZE             35942099
359421                ' - '               DELIMITED BY SIZE             35942199
359422                PC-DISPLAY-LINE     DELIMITED BY SIZE             35942299
359423                             INTO PV-CICS-MSG-AREA                35942399
359424         MOVE LENGTH OF PV-CICS-MSG-AREA                          35942499
359425                               TO PV-COMMAREA-LENGTH              35942599
359426         PERFORM 9700-WRITE-TO-CICS-LOG                           35942699
359427         PERFORM 9900-SOFT-ABORT                                  35942799
359428     ELSE                                                         35942899
359429         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35942999
359430                ' 7800-UNITS-WORK-ROUTINE '                       35943099
359431                                    DELIMITED BY SIZE             35943199
359432                ' DB ERROR - SQL CODE '                           35943299
359433                                    DELIMITED BY SIZE             35943399
359434                PC-DISPLAY-SQL-CODE DELIMITED BY SIZE             35943499
359435                ' FUNC: '           DELIMITED BY SIZE             35943599
359436                PC238-BAD-TABLE-FUNCTION                          35943699
359437                                    DELIMITED BY SIZE             35943799
359438                ' TABLE: '          DELIMITED BY SIZE             35943899
359439                PC238-BAD-TABLE-NAME                              35943999
359440                                    DELIMITED BY SIZE             35944099
359441                             INTO PV-CICS-MSG-AREA                35944199
359442         MOVE LENGTH OF PV-CICS-MSG-AREA                          35944299
359443                               TO PV-COMMAREA-LENGTH              35944399
359444         PERFORM 9700-WRITE-TO-CICS-LOG                           35944499
359445         STRING ' RCKCS280 - '      DELIMITED BY SIZE             35944599
359446                ' 7800-UNITS-WORK-ROUTINE '                       35944699
359447                                    DELIMITED BY SIZE             35944799
359448                ' KEY INFO - '      DELIMITED BY SIZE             35944899
359449                PC-DISPLAY-PO       DELIMITED BY SIZE             35944999
359450                ' - '               DELIMITED BY SIZE             35945099
359451                PC-DISPLAY-RCVR     DELIMITED BY SIZE             35945199
359452                ' - '               DELIMITED BY SIZE             35945299
359453                PC-DISPLAY-LINE     DELIMITED BY SIZE             35945399
359454                             INTO PV-CICS-MSG-AREA                35945499
359455         MOVE LENGTH OF PV-CICS-MSG-AREA                          35945599
359456                               TO PV-COMMAREA-LENGTH              35945699
359457         PERFORM 9700-WRITE-TO-CICS-LOG                           35945799
359458         PERFORM 9900-SOFT-ABORT                                  35945899
359459     END-IF                                                       35945999
359460     END-IF                                                       35946099
359461     END-IF                                                       35946199
359462     END-IF                                                       35946299
359463     END-IF                                                       35946399
359464     END-IF                                                       35946499
359465     END-IF.                                                      35946599
359466/                                                                 35946699
359467******************************************************************35946799
359468* READ AN ITEM FROM THE INPUT TROUBLE RECORD                     *35946899
359469* TEMP STORAGE QUEUE.                                            *35946999
359470******************************************************************35947099
359500 9500-READ-TRB-QUEUE.                                             35950099
359600                                                                  35960099
359700     EXEC CICS                                                    35970099
359800         READQ TS                                                 35980099
359900             QUEUE (ASC-TRB-QUEUE-NAME-IN)                        35990099
360000             INTO  (TM003-TRB-QUEUE-WORK-AREA)                    36000099
360100             ITEM  (PC-01-COMP)                                   36010099
360200             RESP  (PV-CICS-RESP)                                 36020099
360300     END-EXEC.                                                    36030099
360400                                                                  36040099
360500     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        36050099
360600         CONTINUE                                                 36060099
360700     ELSE                                                         36070099
360800         SET DP013-LOGIC-ABEND                                    36080099
360900             DP013-NO-ROLLBACK   TO TRUE                          36090099
361000         MOVE '9500-READ-TRB-QUEUE'                               36100099
361100                                 TO DP013-PARAGRAPH               36110099
361200         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    36120099
361300                                 TO DP013-MESSAGE-TEXT (1)        36130099
361400         MOVE ASC-TRB-QUEUE-NAME-IN TO MSG-QUEUE-NAME             36140099
361500         MOVE PC-01-COMP         TO MSG-SEL-ITEM                  36150099
361600         MOVE MSG-QUEUE-ITEM     TO DP013-MESSAGE-TEXT (2)        36160099
361700         MOVE RC017-PO-NBR       TO MSG1-PO-NBR                   36170099
361800         MOVE RC017-REC-SEQ-NBR                                   36180099
361900                                 TO MSG1-REC-SEQ-NBR-N            36190099
362000         MOVE RC017-OPER-UNT-ID                                   36200099
362100                                 TO MSG1-OPER-UNT-ID              36210099
362200         MOVE RC017-FCLTY-ID     TO MSG1-FACILITY-ID              36220099
362300         MOVE MSG1-PO-REC        TO DP013-MESSAGE-TEXT (3)        36230099
362400         PERFORM DP013-0000-PROCESS-ABEND                         36240099
362500     END-IF.                                                      36250099
362600                                                                  36260099
362700/                                                                 36270099
362800 9600-WRITE-TRB-QUEUE.                                            36280099
362900                                                                  36290099
363000     EXEC CICS WRITEQ TS                                          36300099
363100             QUEUE (ASC-TRB-QUEUE-NAME-IN)                        36310099
363200             FROM  (TM003-TRB-QUEUE-WORK-AREA)                    36320099
363300             ITEM  (PV-SEL-QUEUE-ITEM)                            36330099
363400             RESP  (PV-CICS-RESP)                                 36340099
363500             REWRITE                                              36350099
363600     END-EXEC.                                                    36360099
363700                                                                  36370099
363800     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       36380099
363900         SET DP013-CICS-ABEND                                     36390099
364000             DP013-NO-ROLLBACK   TO TRUE                          36400099
364100         MOVE '9600-WRITE-LIST-QUEUE'                             36410099
364200                                 TO DP013-PARAGRAPH               36420099
364300         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'36430099
364400                                 TO DP013-MESSAGE-TEXT(1)         36440099
364500         PERFORM DP013-0000-PROCESS-ABEND                         36450099
364600     END-IF.                                                      36460099
364610*----------------------------------------------------------------*36461099
364620 9700-WRITE-TO-CICS-LOG.                                          36462099
364630                                                                  36463099
364640     EXEC CICS                                                    36464099
364650          WRITEQ TD                                               36465099
364660          QUEUE  ('CSSL')                                         36466099
364670          FROM  (PV-CICS-MSG-AREA)                                36467099
364680          LENGTH  (PV-COMMAREA-LENGTH)                            36468099
364690          RESP  (PV-CICS-RESP)                                    36469099
364691     END-EXEC.                                                    36469199
364692                                                                  36469299
364693     MOVE SPACES TO PV-CICS-MSG-AREA.                             36469399
364694                                                                  36469499
364700*----------------------------------------------------------------*36470099
364800*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *36480099
364900*    AND THE ERROR SWITCHES.                                     *36490099
365000*----------------------------------------------------------------*36500099
365100                                                                  36510099
365200 9900-SOFT-ABORT.                                                 36520099
365300     SET PS-ERROR         TO TRUE.                                36530099
365400     SET DP020-MSG-FATAL  TO TRUE.                                36540099
365410                                                                  36541099
365420     IF  PS-UNITS-WORKED-ERROR                                    36542099
365430         MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER                 36543099
365440     ELSE                                                         36544099
365450         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 36545099
365460     END-IF.                                                      36546099
365470                                                                  36547099
365600     IF PS-NO-NEXT-SCREEN                                         36560099
365700        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     36570099
365800     END-IF.                                                      36580099
365900     PERFORM 9901-BACKUP.                                         36590099
366000     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          36600099
366100     PERFORM 0001-CALL-CICS-ARCH-API.                             36610099
366295                                                                  36629599
366296*----------------------------------------------------------------*36629699
366300 9901-BACKUP.                                                     36630099
366400     EXEC CICS SYNCPOINT                                          36640099
366500          ROLLBACK                                                36650099
366600     END-EXEC.                                                    36660099
366700/                                                                 36670099
366800*----------------------------------------------------------------*36680099
366900*    ABEND PROCESSOR MODULE                                      *36690099
367000*----------------------------------------------------------------*36700099
367100                                                                  36710099
367200     COPY DPPD013.                                                36720099
