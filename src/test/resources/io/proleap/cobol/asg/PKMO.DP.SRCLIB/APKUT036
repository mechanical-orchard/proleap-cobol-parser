000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.     APKUT036.                                        00020001
000300 AUTHOR.         NANCY EILBES.                                    00030001
000400 DATE-WRITTEN.   JANUARY 2001.                                    00040001
000500 DATE-COMPILED.                                                   00050001
000600***************************************************************** 00060001
000700*   REFORMAT UNJOURNALIZED AGING FILE TO TEXT FORMAT            * 00070003
000800*                                                               * 00080001
000900*   COBOL 2                                                     * 00090001
001000*                                                               * 00100001
001100*  THIS PROGRAM WILL READ THE AGED UNJOURNALIZED FILE AND       * 00110001
001200*  CREATE A NEW FILE IN TEXT FORMAT WHICH CONTAINS ONLY THE     * 00120001
001300*  NECESSARY FIELDS.  THIS FILE WILL THEN BE FTP'D TO THE       * 00130001
001400*  SERVER.                                                      * 00140001
001500*                                                               * 00150001
001600* INPUT:                                                        * 00160001
001700*  1. AGED-IN-FILE                                (APRD003)     * 00170003
001800*                                                               * 00180001
001900* OUTPUT:                                                       * 00190001
002000*  1. AGED-OUT-FILE                               (APRD004)     * 00200003
002100*                                                               * 00210001
002200***************************************************************** 00220001
002300* CHANGE LOG:                                                   * 00230001
002400*                                                               * 00240001
002500* 02/06/2003                                                    * 00250003
002600*    CHANGE MADE: ARKPO PHASE3 PROJECT.                         * 00260003
002700*    UPDATED PGM COMMENT BLOCK WITH THE FILENAMES. INCREASED    * 00270003
002800*    THE LRECL FOR APRD004 TO 112 BYTES.                        * 00280003
002900* MADE BY:  MIKE BESKE                          WR#: 23500      * 00290003
003000***************************************************************** 00300001
003100   EJECT                                                          00310001
003200 ENVIRONMENT DIVISION.                                            00320001
003300 CONFIGURATION SECTION.                                           00330001
003400 SOURCE-COMPUTER.    IBM-3090.                                    00340001
003500 OBJECT-COMPUTER.    IBM-3090.                                    00350001
003600                                                                  00360001
003700 INPUT-OUTPUT SECTION.                                            00370001
003800 FILE-CONTROL.                                                    00380001
003900     SELECT AGED-IN-FILE  ASSIGN TO UT-S-INP01.                   00390002
004000     SELECT AGED-OUT-FILE ASSIGN TO UT-S-OUT01.                   00400002
004100                                                                  00410001
004200 DATA DIVISION.                                                   00420001
004300 FILE SECTION.                                                    00430001
004400                                                                  00440001
004500 FD  AGED-IN-FILE                                                 00450001
004600     RECORDING MODE IS F                                          00460001
004700     LABEL RECORDS ARE STANDARD                                   00470001
004800     BLOCK CONTAINS 0 RECORDS                                     00480001
004900     DATA RECORD IS AGED-IN-REC.                                  00490001
005000 01  AGED-IN-REC.                                                 00500001
005100     05  FILLER                       PIC  X(135).                00510001
005200                                                                  00520001
005300 FD  AGED-OUT-FILE                                                00530001
005400     RECORDING MODE IS F                                          00540001
005500     LABEL RECORDS ARE STANDARD                                   00550001
005600     BLOCK CONTAINS 0 RECORDS                                     00560001
005700     DATA RECORD IS AGED-OUT-REC.                                 00570001
005800 01  AGED-OUT-REC.                                                00580001
005900     05  FILLER                       PIC  X(112).                00590003
006000                                                                  00600001
006100 EJECT                                                            00610001
006200 WORKING-STORAGE SECTION.                                         00620001
006300                                                                  00630001
006400 01  EOF-SW                           PIC X     VALUE 'N'.        00640001
006500     88  IN-EOF                                 VALUE 'Y'.        00650001
006600                                                                  00660001
006700     COPY APRD003.                                                00670001
006800                                                                  00680001
006900     COPY APRD004.                                                00690001
007000 EJECT                                                            00700001
007100 PROCEDURE DIVISION.                                              00710001
007200 A100-MAIN.                                                       00720001
007300                                                                  00730001
007400     PERFORM B100-INITIALIZE.                                     00740001
007500                                                                  00750001
007600     PERFORM B200-PROCESS                                         00760001
007700         UNTIL IN-EOF.                                            00770001
007800                                                                  00780001
007900     GOBACK.                                                      00790001
008000 EJECT                                                            00800001
008100*----------------------------------------------------------------*00810001
008200*    INITIALIZATION PROCESSING                                   *00820001
008300*----------------------------------------------------------------*00830001
008400 B100-INITIALIZE.                                                 00840001
008500                                                                  00850001
008600     OPEN INPUT  AGED-IN-FILE                                     00860001
008700          OUTPUT AGED-OUT-FILE.                                   00870001
008800                                                                  00880001
008900     INITIALIZE AP003-UNJRNLD-DUEDATE-RECORD                      00890002
009000                AP004-INTR-AGING-TEXT-FILE.                       00900001
009100                                                                  00910001
009200     PERFORM R100-READ-INPUT.                                     00920001
009300                                                                  00930001
009400*----------------------------------------------------------------*00940002
009500*    REFORMAT EACH INPUT RECORD TO THE OUTPUT TEXT FORMAT.       *00950002
009600*----------------------------------------------------------------*00960002
009700 B200-PROCESS.                                                    00970001
009800                                                                  00980001
009900     MOVE AP003-VND-NBR           TO  AP004-VND-NBR.              00990001
010000     MOVE AP003-ENT-NM-DESC       TO  AP004-ENT-NM-DESC.          01000001
010100     MOVE AP003-PO-NBR            TO  AP004-PO-NBR.               01010001
010200     MOVE AP003-REC-SEQ-NBR       TO  AP004-REC-SEQ-NBR.          01020001
010300     MOVE AP003-REC-DTE           TO  AP004-REC-DTE.              01030001
010400     MOVE AP003-RTL-AMT           TO  AP004-RTL-AMT.              01040001
010500     MOVE AP003-COST-AMT          TO  AP004-COST-AMT.             01050001
010600     MOVE AP003-DUE-DAYS          TO  AP004-DUE-DAYS.             01060001
010700     MOVE AP003-EXTENDED-DAYS     TO  AP004-EXTENDED-DAYS.        01070001
010800     MOVE AP003-EOM-IND           TO  AP004-EOM-IND.              01080001
010900     MOVE AP003-CALC-DUE-DTE      TO  AP004-CALC-DUE-DTE.         01090001
011000     MOVE AP003-CALC-OTP-DTE      TO  AP004-CALC-OTP-DTE.         01100001
011100                                                                  01110001
011200     PERFORM W100-WRITE-OUTPUT.                                   01120001
011300                                                                  01130001
011400     PERFORM R100-READ-INPUT.                                     01140001
011500                                                                  01150001
011600*----------------------------------------------------------------*01160002
011700*    READ UNJOURNALIZED AGED FILE.                               *01170002
011800*----------------------------------------------------------------*01180002
011900 R100-READ-INPUT.                                                 01190001
012000                                                                  01200001
012100                                                                  01210001
012200     READ AGED-IN-FILE INTO AP003-UNJRNLD-DUEDATE-RECORD          01220002
012300         AT END SET IN-EOF TO TRUE.                               01230001
012400                                                                  01240001
012500*----------------------------------------------------------------*01250002
012600*    WRITE TEXT FILE OUT.                                        *01260002
012700*----------------------------------------------------------------*01270002
012800 W100-WRITE-OUTPUT.                                               01280001
012900                                                                  01290001
013000     WRITE AGED-OUT-REC FROM AP004-INTR-AGING-TEXT-FILE.          01300001
013100                                                                  01310001
