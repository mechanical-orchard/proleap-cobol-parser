000100******************************************************************00010065
000200*  THIS VERSION IS NOT MEANT TO BE EVER MOVED TO PRODUCTION. IT'S 00020066
000300*  A COPY OF SUKCS574.  IT WILL CREATE AN OUTPUT FILE             00030066
000400*  THERE IS A PROGRAM CALLED SUKUT574 IN PRODUCTION. DON'T CONFUSE00040066
000500*  THAT ONE WITH THIS ONE. THEY ARE NOT THE SAME                  00050066
000600******************************************************************00060066
000700 IDENTIFICATION DIVISION.                                         00070000
000800 TITLE 'SUMMARIZE THE TRAILER'.                                   00080000
000900 PROGRAM-ID.    SUKUT574.                                         00090000
001000 AUTHOR.        VIRGENE LENNEMAN.                                 00100000
001100 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00110000
001200 DATE-WRITTEN.  APRIL 2009.                                       00120000
001300 DATE-COMPILED.                                                   00130000
001400******************************************************************00140000
001500*  THIS PROGRAM WILL SUMMARIZE ALL OF THE ITEMS FOR A TRAILER AND 00150000
001600*  INSERT THE INFORMATION INTO THE SUMMARY TABLES                 00160000
001700******************************************************************00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900 CONFIGURATION SECTION.                                           00190000
002000 SOURCE-COMPUTER. IBM-3090.                                       00200000
002100 OBJECT-COMPUTER. IBM-3090.                                       00210000
002200                                                                  00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400 FILE-CONTROL.                                                    00240000
002500                                                                  00250000
002600     SELECT  SU-OUTPUT-FILE                                       00260004
002700         ASSIGN TO OUT01.                                         00270000
002800                                                                  00280000
002900****************************************************************  00290000
003000 DATA DIVISION.                                                   00300000
003100****************************************************************  00310000
003200                                                                  00320000
003300 FILE SECTION.                                                    00330000
003400                                                                  00340000
003500 FD  SU-OUTPUT-FILE                                               00350004
003600     RECORDING MODE IS F                                          00360000
003700     LABEL RECORDS ARE STANDARD                                   00370000
003800     BLOCK CONTAINS 0 RECORDS.                                    00380000
003900 01  SU-OUT-RECORD                    PIC  X(153).                00390072
004000                                                                  00400000
004100 WORKING-STORAGE SECTION.                                         00410000
004200                                                                  00420000
004300 01  DK-FIELDS.                                                   00430000
004400     05  DK-TRIP-OCRNC-ID                   PIC S9(09)  COMP.     00440000
004500     05  DK-OTBND-TRIP-ID                   PIC S9(09)  COMP.     00450000
004600                                                                  00460000
004700 01  PROGRAM-VARIABLES.                                           00470000
004800     05  PV-AD-EVNT-DTE                     PIC  X(10).           00480000
004900     05  PV-RETAIL                          PIC  9(08).           00490000
005000     05  PV-RETAIL-X REDEFINES PV-RETAIL    PIC X(08).            00500000
005100     05  PV-CICS-MSG-AREA                   PIC  X(80).           00510000
005200     05  PV-UNIT-QTY-SUM                    PIC S9(09) COMP.      00520000
005300     05  PV-COMMAREA-LENGTH                 PIC S9(04)  VALUE +0  00530000
005400                                               COMP SYNC.         00540000
005500     05  PV-RETAIL-SUM                      PIC S9(13)V99 COMP-3. 00550000
005600     05  PV-COST-SUM                        PIC S9(13)V99 COMP-3. 00560000
005700     05  PV-SKU-COUNT                       PIC S9(04) COMP.      00570000
005800     05  PV-UNT-QTY                         PIC S9(09) COMP.      00580000
005900     05  PV-RTL-DOL-AMT                     PIC S9(13)V9(2)       00590000
006000                                                     COMP-3.      00600000
006100     05  PV-COST-DOL-AMT                    PIC S9(13)V9(2)       00610000
006200                                                     COMP-3.      00620000
006210     05  PV-UNT-RTL-AMT                     PIC S9(07)V9(2)       00621050
006220                                                     COMP-3.      00622050
006230     05  PV-UNT-COST-AMT                    PIC S9(07)V9(3)       00623050
006240                                                     COMP-3.      00624050
006300     05  PV-CARTON-COUNT                    PIC S9(04) COMP.      00630000
006400     05  PV-RANDOM-NUMBER                   PIC  9(09)            00640000
006500                                                 VALUE ZEROES.    00650000
006600     05  PV-USERID                          PIC  X(08).           00660000
006700     05  PV-STARTCODE                       PIC  X(02).           00670000
006800     05  PV-CURRENT-TIMESTAMP               PIC  X(26).           00680000
006900     05  PV-CURRENT-DATE                    PIC  X(10).           00690004
007000     05  PV-PARAGRAPH-NAME                  PIC  X(30)            00700000
007100                                                   VALUE SPACES.  00710000
007200     05  PV-DB2-OPERATION-ATTEMPTED         PIC  X(30)            00720000
007300                                                   VALUE SPACES.  00730000
007400     05  PV-ITEM-NMBR                       PIC S9(09)  COMP.     00740000
007500     05  PV-SHIPT-UNT-ID                    PIC  9(18).           00750000
007600     05  PV-SKU-NBR                         PIC  9(08).           00760000
007700     05  PV-FIELD-VALUE                     PIC -9(18).           00770000
007800     05  PV-FIELD-VALUE-1                   PIC -9(09).           00780000
007900     05  PV-FIELD-VALUE-2                   PIC -9(09).           00790000
008000     05  PV-CICS-RESP                       PIC S9(09) COMP       00800000
008100                                                 VALUE ZERO.      00810000
008200     05  PV-WRITE-COUNT-7970                PIC  9(4) VALUE ZERO. 00820009
008300     05  PV-WRITE-COUNT-8800                PIC  9(4) VALUE ZERO. 00830009
008400     05  PV-WRITE-COUNT-8820                PIC  9(4) VALUE ZERO. 00840005
008500     05  PV-WRITE-COUNT-8825                PIC  9(4) VALUE ZERO. 00850005
008600     05  PV-WRITE-COUNT-8840                PIC  9(4) VALUE ZERO. 00860005
008700     05  PV-WRITE-COUNT-8845                PIC  9(4) VALUE ZERO. 00870005
008800     05  PV-WRITE-COUNT-8870                PIC  9(4) VALUE ZERO. 00880005
008900     05  PV-WRITE-COUNT-8880                PIC  9(4) VALUE ZERO. 00890005
009000     05  PV-RECS-WRITTEN                    PIC  9(4) VALUE ZERO. 00900005
009100     05  PV-DISP-UPC                        PIC  9(15).           00910005
009200     05  PV-DISP-TRIP                       PIC  9(09).           00920000
009300     05  PV-DISP-BUS-AREA-ID                PIC  9(09).           00930001
009400     05  PV-DISP-DEPT-NBR                   PIC  9(09).           00940001
009500     05  PV-DISP-MAJ-CL-NBR                 PIC  9(09).           00950001
009600     05  PV-DISP-UNT-QTY                    PIC  9(09).           00960001
009700     05  PV-DISP-SKU-QTY                    PIC  9(09).           00970001
009800     05  PV-DISP-CART-QTY                   PIC  9(09).           00980001
009900     05  PV-DISP-RTL-DOL-AMT                PIC  9(09)V99.        00990001
010000     05  PV-DISP-COST-DOL-AMT               PIC  9(09)V99.        01000001
010100     05  PV-DISP-BRND-ID                    PIC  9(05).           01010075
010200     05  PV-DISP-AD-EVNT-DTE                PIC  X(10).           01020006
010300     05  PV-DISP-SQLCODE                    PIC  -9(03).          01030001
010400     05  PV-SAVE-BUS-AREA-ID                PIC  S9(2)V COMP-3.   01040000
010500     05  PV-SAVE-DEPT-NBR                   PIC  S9(4)V COMP-3.   01050000
010600*CLP 07/08/2015 START                                             01060075
010610     05  PV-SAVE-BRND-ID                    PIC  S9(4)  COMP.     01061075
010620*CLP 07/08/2015 END                                               01062071
010700     05  PV-SAVE-UPC-NBR                    PIC  S9(15)V COMP-3.  01070000
010800     05  PV-SAVE-SKU-NBR                    PIC  S9(8)V COMP-3.   01080000
010900     05  PV-SAVE-TRN-NBR                    PIC  S9(9) COMP.      01090000
011000     05  PV-SAVE-TRN-LNE-NBR                PIC  S9(9) COMP.      01100000
011100     05  PV-SU-TRIP-CNTL-CARD.                                    01110004
011200         10 PV-SU-OPER-UNT            PIC   9(4) VALUE ZERO.      01120004
011300         10 PV-SU-TRIP-NBR            PIC   9(9) VALUE ZERO.      01130004
011400         10 PV-SU-TRIP-OCRNC-NBR      PIC   9(9) VALUE ZERO.      01140004
011500         10 PV-SU-TIMESTAMP           PIC  X(26) VALUE SPACES.    01150004
013300                                                                  01330000
013400 01  PV-LOG-MSG.                                                  01340000
013500     05  FILLER                       PIC X(10) VALUE             01350000
013600         ' SUKUT574-'.                                            01360069
013700     05  PV-LOG-PARA                  PIC X(05) VALUE SPACES.     01370000
013800     05  FILLER                       PIC X(05) VALUE             01380000
013900         '-BY: '.                                                 01390000
014000     05  PV-LOG-CALLING-PGM           PIC X(08) VALUE SPACES.     01400000
014100     05  FILLER                       PIC X(04) VALUE             01410000
014200         ' AT '.                                                  01420000
014300     05  PV-TIME-PARM                 PIC X(08).                  01430000
014400     05  FILLER                       PIC X(10) VALUE             01440000
014500         ' SQLCODE= '.                                            01450000
014600     05  PV-LOG-SQLCODE               PIC -999.                   01460000
014700     05  FILLER                       PIC X(06) VALUE             01470000
014800         ' TASK='.                                                01480000
014900     05  PV-LOG-TASK                  PIC ZZZ9.                   01490000
015000     05  FILLER                       PIC X(06) VALUE             01500000
015100         ' TRIP='.                                                01510000
015200     05  PV-LOG-TRIP                  PIC 9(09) VALUE ZERO.       01520000
015300     05  FILLER                       PIC X(01) VALUE SPACES.     01530000
015400     05  PV-LOG-TEXT                  PIC X(20) VALUE SPACES.     01540000
015500                                                                  01550000
015600                                                                  01560000
015700 01  PC-PROGRAM-CONSTANTS.                                        01570000
015800     05  PC-RANDOM-PGM                      PIC  X(08)            01580000
015900                                               VALUE  'DPKUT902'. 01590000
016000     05  PC-MAX-RETRIES          PIC S9(4)     COMP SYNC VALUE +2.01600000
016100     05  PC-DK-START-TMST        PIC X(26)     VALUE              01610000
016200                                '0001-01-01-01.01.01.000001'.     01620000
016300     05  PC-HANG                     PIC X(20)  VALUE             01630000
016400         'HANG                '.                                  01640000
016500     05  PC-FOLD                     PIC X(20)  VALUE             01650000
016600         'FOLD                '.                                  01660000
016700                                                                  01670000
016800 01  ABEND-CODE                      PIC S9(04)    VALUE +0       01680000
016900                                                   COMP SYNC.     01690000
017000 01  PROGRAM-SWITCHES.                                            01700000
017010*CLP 07/07/2015 START                                             01701071
017020     05  PS-EXISTS                    PIC S9 COMP-3 VALUE ZERO.   01702071
017030         88  PS-ROW-EXISTS-YES              VALUE 1.              01703071
017040         88  PS-ROW-EXISTS-NO               VALUE ZERO.           01704071
017050*CLP 07/07/2015 END                                               01705071
017100     05  PS-TRIP-USED-SW                    PIC X(01).            01710000
017200         88  PS-TRIP-ALREADY-USED           VALUE 'Y'.            01720000
017300         88  PS-TRIP-NOT-USED               VALUE 'N'.            01730000
017400     05  PS-INSERT-DONE-SW                  PIC X(01).            01740000
017500         88  PS-NO-INSERT-DONE              VALUE 'N'.            01750000
017600         88  PS-INSERT-DONE                 VALUE 'Y'.            01760000
017700     05  PS-DEPT-FOUND-SW                   PIC X(01).            01770000
017800         88  PS-DEPT-NOT-FOUND              VALUE 'N'.            01780000
017900         88  PS-DEPT-FOUND                  VALUE 'Y'.            01790000
018000     05  PS-CARTON-INFO-SW                  PIC X(01).            01800000
018100         88  PS-NO-CARTON-INFO              VALUE 'N'.            01810000
018200         88  PS-CARTON-INFO                 VALUE 'Y'.            01820000
018300     05  PS-EOF-DATE-CSR-SW                 PIC X(01).            01830000
018400         88  PS-NOT-EOF-DATE-CSR            VALUE 'N'.            01840000
018500         88  PS-EOF-DATE-CSR                VALUE 'Y'.            01850000
018600     05  PS-EOF-SKU-CURSOR-SW               PIC X(01).            01860000
018700         88  PS-NOT-EOF-SKU-CURSOR          VALUE 'N'.            01870000
018800         88  PS-EOF-SKU-CURSOR              VALUE 'Y'.            01880000
018900     05  PS-EOF-UNT-DOL-CLASS-CSR-SW        PIC X(01).            01890000
019000         88  PS-NOT-EOF-UNT-DOL-CLASS-CSR   VALUE 'N'.            01900000
019100         88  PS-EOF-UNT-DOL-CLASS-CSR       VALUE 'Y'.            01910000
019200     05  PS-EOF-UNT-DOL-MDSE-CSR-SW         PIC X(01).            01920000
019300         88  PS-NOT-EOF-UNT-DOL-MDSE-CSR    VALUE 'N'.            01930000
019400         88  PS-EOF-UNT-DOL-MDSE-CSR        VALUE 'Y'.            01940000
019500     05  PS-NOT-EOF-ITEM-DET-CSR-SW         PIC X(01).            01950000
019600         88  PS-NOT-EOF-ITEM-DET-CSR        VALUE 'N'.            01960000
019700         88  PS-EOF-ITEM-DET-CSR            VALUE 'Y'.            01970000
019800     05  PS-FIRST-TIME-THRU-CSR-SW          PIC X(01).            01980000
019900         88  PS-NOT-FIRST-TIME-THRU-CSR     VALUE 'N'.            01990000
020000         88  PS-FIRST-TIME-THRU-CSR         VALUE 'Y'.            02000000
020010     05  PS-UPC-FOUND-SW                    PIC X(01).            02001041
020020         88  PS-NOT-UPC-FOUND               VALUE 'N'.            02002041
020030         88  PS-UPC-FOUND                   VALUE 'Y'.            02003041
020100                                                                  02010000
020200     COPY SUWS574.                                                02020013
020300                                                                  02030013
020400                                                                  02040013
020500******************************************************************02050000
020600* PCWS049 - WORK FIELDS USED TO DETERMINE TRAILER CONTENTS        02060000
020700******************************************************************02070000
020800     COPY PCWS049.                                                02080000
020900                                                                  02090000
021000     COPY PCWS047.                                                02100000
021100                                                                  02110000
021200     COPY DPWS004.                                                02120000
021300                                                                  02130000
021400*----------------------------------------------------------------*02140000
021500*  RANDOM NUMBER AREA                                             02150000
021600*----------------------------------------------------------------*02160000
021700     COPY DPWS902.                                                02170000
021800                                                                  02180000
022510*CLP 07/07/2015 START                                             02251071
022520******************************************************************02252071
022530* XLT_BRND           BRAND TABLE                                  02253071
022540******************************************************************02254071
022550     EXEC SQL                                                     02255071
022560          INCLUDE XLT00043                                        02256071
022570     END-EXEC.                                                    02257071
022580*CLP 07/07/2015 END                                               02258071
022590                                                                  02259071
022600******************************************************************02260000
022700* SUT_OTBND_LOC - OUTBOUND SHIPPING UNIT LOCATION TABLE           02270000
022800******************************************************************02280000
022900     EXEC SQL                                                     02290000
023000          INCLUDE SUT00027                                        02300000
023100     END-EXEC.                                                    02310000
023200                                                                  02320000
023300******************************************************************02330000
023400* SUT_OTBND_CARTON - OTBND SHIPPING UNIT CARTON TABLE             02340000
023500******************************************************************02350000
023600     EXEC SQL                                                     02360000
023700          INCLUDE SUT00024                                        02370000
023800     END-EXEC.                                                    02380000
023900                                                                  02390000
024000******************************************************************02400000
024100* SUT_TRIP_DTL_SUM - TRIP DETAIL SUMMARY TABLE                    02410000
024200******************************************************************02420000
024300     EXEC SQL                                                     02430000
024400          INCLUDE SUT00095                                        02440000
024500     END-EXEC.                                                    02450000
024600                                                                  02460000
025310*CLP 07/07/2015 START                                             02531071
025320******************************************************************02532071
025330* SUT_BRND_MDSE_SUM - BRND MERCHANDISE SUM TABLE                  02533071
025340******************************************************************02534071
025350     EXEC SQL                                                     02535071
025360          INCLUDE SUT00066                                        02536071
025370     END-EXEC.                                                    02537071
025380*CLP 07/07/2015 END                                               02538071
025400******************************************************************02540000
025500* SUT_PRC_MSG_CDE  - PRC MESSAGE CODE TABLE                       02550000
025600******************************************************************02560000
025700     EXEC SQL                                                     02570000
025800          INCLUDE SUT00094                                        02580000
025900     END-EXEC.                                                    02590000
026000                                                                  02600000
026100******************************************************************02610000
026200* TSUCDOT - CARTON DIVERT/OUTBOUND TRIP ASSOCIATION TABLE         02620000
026300******************************************************************02630000
026400     EXEC SQL                                                     02640000
026500          INCLUDE TSUCDOT                                         02650000
026600     END-EXEC.                                                    02660000
026700                                                                  02670000
026800******************************************************************02680000
026900* TSUOBTR - OUTBOUND TRAILER TRIP TABLE                           02690000
027000******************************************************************02700000
027100     EXEC SQL                                                     02710000
027200          INCLUDE TSUOBTR                                         02720000
027300     END-EXEC.                                                    02730000
027400                                                                  02740000
027500******************************************************************02750000
027600* TSUOBTR - OUTBOUND TRAILER TRIP STATUS TABLE                    02760000
027700******************************************************************02770000
027800     EXEC SQL                                                     02780000
027900          INCLUDE TSUOBTS                                         02790000
028000     END-EXEC.                                                    02800000
028100                                                                  02810000
028200******************************************************************02820000
028300* TSUOBSC - OUTBOUND TRAILER TRIP STATUS CODE TABLE               02830000
028400******************************************************************02840000
028500     EXEC SQL                                                     02850000
028600          INCLUDE TSUOBSC                                         02860000
028700     END-EXEC.                                                    02870000
028800                                                                  02880000
028900******************************************************************02890000
029000* TSUCRDV - CARTON DIVERTS FROM CONVEYOR SYSTEM TABLE             02900000
029100******************************************************************02910000
029200     EXEC SQL                                                     02920000
029300          INCLUDE TSUCRDV                                         02930000
029400     END-EXEC.                                                    02940000
029500                                                                  02950000
029600******************************************************************02960000
029700* TCNDCDR - DISTRIBUTION CENTER DOOR TABLE                        02970000
029800******************************************************************02980000
029900     EXEC SQL                                                     02990000
030000          INCLUDE TCNDCDR                                         03000000
030100     END-EXEC.                                                    03010000
030200                                                                  03020000
030300******************************************************************03030000
030400* TCNDRST - DISTRIBUTION CENTER DOOR TO STORE ASSOCIATION TABLE   03040000
030500******************************************************************03050000
030600     EXEC SQL                                                     03060000
030700          INCLUDE TCNDRST                                         03070000
030800     END-EXEC.                                                    03080000
030900                                                                  03090000
031000     EXEC SQL                                                     03100000
031100          INCLUDE XLT00001                                        03110000
031200     END-EXEC.                                                    03120000
031300                                                                  03130000
031400     EXEC SQL                                                     03140000
031500          INCLUDE XLT00002                                        03150000
031600     END-EXEC.                                                    03160000
031700                                                                  03170000
031800     EXEC SQL                                                     03180000
031900          INCLUDE XLT00003                                        03190000
032000     END-EXEC.                                                    03200000
032100                                                                  03210000
032200     EXEC SQL                                                     03220000
032300          INCLUDE XLT00004                                        03230000
032400     END-EXEC.                                                    03240000
032500                                                                  03250000
032510* * * XLT_UPC                                                     03251039
032600     EXEC SQL                                                     03260000
032700          INCLUDE XLT00006                                        03270000
032800     END-EXEC.                                                    03280000
032900                                                                  03290000
032910* * * XLV_SKU_STR                                                 03291040
032920     EXEC SQL                                                     03292040
032930          INCLUDE XLV00002                                        03293040
032940     END-EXEC.                                                    03294040
032950                                                                  03295040
033000     EXEC SQL                                                     03300000
033100          INCLUDE SUT00028                                        03310000
033200     END-EXEC.                                                    03320000
033300                                                                  03330000
033400     EXEC SQL                                                     03340000
033500          INCLUDE TPURITM                                         03350000
033600     END-EXEC.                                                    03360000
033700                                                                  03370000
033800     EXEC SQL                                                     03380000
033900          INCLUDE SUT00006                                        03390068
034000     END-EXEC.                                                    03400000
034100                                                                  03410000
034110     EXEC SQL                                                     03411068
034120          INCLUDE SUT00007                                        03412068
034130     END-EXEC.                                                    03413068
034140                                                                  03414068
034200     EXEC SQL                                                     03420000
034300          INCLUDE SUT00008                                        03430000
034400     END-EXEC.                                                    03440000
034500                                                                  03450000
034600     EXEC SQL                                                     03460000
034700          INCLUDE SUT00009                                        03470000
034800     END-EXEC.                                                    03480000
034900                                                                  03490000
035000     EXEC SQL                                                     03500000
035100          INCLUDE SUT00010                                        03510000
035200     END-EXEC.                                                    03520000
035300                                                                  03530000
035400     EXEC SQL                                                     03540000
035500          INCLUDE SUT00011                                        03550000
035600     END-EXEC.                                                    03560000
035601                                                                  03560157
035610* *  CENTRAL STOCK - PULL LINE ITEM TABLE                         03561057
035620     EXEC SQL                                                     03562057
035630          INCLUDE TCEPLIT                                         03563057
035640     END-EXEC.                                                    03564057
035650                                                                  03565057
035700                                                                  03570000
035800     EXEC SQL                                                     03580000
035900          INCLUDE SQLCA                                           03590000
036000     END-EXEC.                                                    03600000
036100                                                                  03610000
036200******************************************************************03620000
036300* PCWS050 - CURSOR USED TO DETERMINE TRAILER CONTENTS             03630000
036400******************************************************************03640000
036500     COPY PCWS050.                                                03650000
036600                                                                  03660000
036700     EXEC SQL                                                     03670000
036800         DECLARE AD-DATE-CSR CURSOR FOR                           03680000
036900         SELECT DISTINCT                                          03690000
037000               BUS_AREA_ID                                        03700000
037100            ,  DEPT_NBR                                           03710000
037200            ,  MAJ_CL_NBR                                         03720000
037300            ,  AD_DTE                                             03730000
037400         FROM SUT_TRIP_DTL_SUM                                    03740000
037500         WHERE TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                  03750000
037600          AND  AD_DTE                <> '0001-01-01'              03760000
037700        WITH UR                                                   03770000
037800     END-EXEC.                                                    03780000
037900                                                                  03790000
038000     EXEC SQL                                                     03800000
038100         DECLARE UNT-DOL-CLASS-CSR CURSOR FOR                     03810000
038200         SELECT                                                   03820000
038300               BUS_AREA_ID                                        03830000
038400            ,  DEPT_NBR                                           03840000
038500            ,  MAJ_CL_NBR                                         03850000
038600            ,  SUM(UNT_QTY)                                       03860000
038700            ,  SUM(RTL_DOL_AMT)                                   03870000
038800            ,  SUM(COST_DOL_AMT)                                  03880000
038900         FROM SUT_TRIP_DTL_SUM                                    03890000
039000         WHERE TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                  03900000
039100         GROUP BY                                                 03910000
039200               BUS_AREA_ID                                        03920000
039300            ,  DEPT_NBR                                           03930000
039400            ,  MAJ_CL_NBR                                         03940000
039500         ORDER BY                                                 03950000
039600               BUS_AREA_ID                                        03960000
039700            ,  DEPT_NBR                                           03970000
039800            ,  MAJ_CL_NBR                                         03980000
039900        WITH UR                                                   03990000
040000     END-EXEC.                                                    04000000
040100                                                                  04010000
042010*CLP 07/07/2015 START                                             04201071
042020     EXEC SQL                                                     04202071
042030         DECLARE UNT-DOL-BRND-CSR CURSOR FOR                      04203071
042040         SELECT                                                   04204071
042050               BUS_AREA_ID                                        04205071
042060            ,  BRND_ID                                            04206071
042070            ,  SUM(UNT_QTY)                                       04207071
042080            ,  SUM(RTL_DOL_AMT)                                   04208071
042090            ,  SUM(COST_DOL_AMT)                                  04209071
042091         FROM SUT_TRIP_DTL_SUM                                    04209171
042092         WHERE TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                  04209271
042093         GROUP BY                                                 04209371
042094               BUS_AREA_ID                                        04209471
042095            ,  BRND_ID                                            04209571
042096         ORDER BY                                                 04209671
042097               BUS_AREA_ID                                        04209771
042098            ,  BRND_ID                                            04209871
042099        WITH UR                                                   04209971
042100     END-EXEC.                                                    04210071
042101*CLP 07/07/2015 END                                               04210171
042110                                                                  04211004
042200 PROCEDURE DIVISION.                                              04220000
042300                                                                  04230000
042400 0000-PROGRAM-MAINLINE.                                           04240000
042500                                                                  04250000
042600     PERFORM 1000-INITIALIZE.                                     04260000
042700                                                                  04270000
042800     PERFORM 2000-PROCESS-TRIP-CARTONS.                           04280000
042900                                                                  04290000
043000     PERFORM 4000-PROCESS-TEMP-TABLE.                             04300000
043100     DISPLAY ' RECORDS WRITTEN 7970 = ' PV-WRITE-COUNT-7970.      04310012
043200     DISPLAY ' RECORDS WRITTEN 8800 = ' PV-WRITE-COUNT-8800.      04320012
043300     DISPLAY ' RECORDS WRITTEN 8820 = ' PV-WRITE-COUNT-8820.      04330004
043400     DISPLAY ' RECORDS WRITTEN 8825 = ' PV-WRITE-COUNT-8825.      04340004
043500     DISPLAY ' RECORDS WRITTEN 8840 = ' PV-WRITE-COUNT-8840.      04350004
043600     DISPLAY ' RECORDS WRITTEN 8845 = ' PV-WRITE-COUNT-8845.      04360004
043700     DISPLAY ' RECORDS WRITTEN 8870 = ' PV-WRITE-COUNT-8870.      04370004
043800     DISPLAY ' RECORDS WRITTEN 8880 = ' PV-WRITE-COUNT-8880.      04380004
043900     DISPLAY ' RECORDS WRITTEN OUT  = ' PV-RECS-WRITTEN.          04390012
044000                                                                  04400000
044100     PERFORM 9000-FINIS.                                          04410000
044200                                                                  04420000
044300******************************************************************04430000
044400*                                                                 04440000
044500******************************************************************04450000
044600 1000-INITIALIZE.                                                 04460000
044700     OPEN OUTPUT SU-OUTPUT-FILE.                                  04470004
044800     ACCEPT PV-SU-TRIP-CNTL-CARD FROM SYSIN.                      04480011
044900     PERFORM 8900-SELECT-CURRENT-TMST.                            04490011
045000     PERFORM 8950-SELECT-CURRENT-DATE.                            04500004
045100     MOVE 'START'                     TO PV-LOG-PARA.             04510000
045200                                                                  04520000
045300     PERFORM 9999-WRITE-TO-CSSL.                                  04530000
045310*                                                                 04531068
045320*** DMH BEGIN - 7/25/13                                           04532068
045330*                                                                 04533068
045340     PERFORM 7990-INSERT-WRKR-AUD.                                04534068
045350*                                                                 04535068
045360*** DMH END - 7/25/13                                             04536068
045370*                                                                 04537068
045400                                                                  04540000
045500     MOVE PV-SU-OPER-UNT              TO PC049-DK-OPER-UNT-ID.    04550011
045600     MOVE PC047-OPER-UNT-ID           TO PC049-DK-OPER-UNT-ID.    04560066
045700     MOVE PC047-DOOR-ID               TO PC049-DK-DOOR-ID.        04570066
045800     MOVE PC047-DEST-OPER-UNT-ID      TO PC049-DK-TRLR-DEST.      04580066
045810     MOVE PC047-DOOR-TYPE-CDE         TO PC049-DK-TRLR-TYPE.      04581066
045820                                                                  04582066
045900     PERFORM P3000-DOOR-STR-CSR.                                  04590000
046000     MOVE PV-SU-TRIP-NBR              TO PC049-DK-OTBND-TRIP-ID   04600004
046100                                         DK-OTBND-TRIP-ID.        04610000
046200     PERFORM P4000-STRT-END-DVRT.                                 04620000
046300                                                                  04630000
046400     IF PC049-DIVERT-CUTOFFS-NO                                   04640000
046500         MOVE PC-DK-START-TMST       TO PC049-DK-START-TMST       04650000
046600         MOVE PC049-PC-DEFAULT-TMST  TO PC049-DK-END-TMST         04660000
046700     END-IF.                                                      04670000
046800                                                                  04680000
046900 2000-PROCESS-TRIP-CARTONS.                                       04690000
047000     MOVE 0    TO  PV-SAVE-UPC-NBR                                04700000
047100                   PV-SAVE-TRN-NBR                                04710000
047200                   PV-SAVE-TRN-LNE-NBR                            04720000
047300                   PV-SAVE-SKU-NBR.                               04730000
047400     PERFORM 5000-CREATE-TRIP-OCCURENCE-ID.                       04740000
047500     MOVE DK-TRIP-OCRNC-ID       TO SUT00007-TRIP-OCRNC-ID.       04750000
047600     MOVE DK-OTBND-TRIP-ID       TO SUT00007-OTBND-TRIP-ID.       04760000
047700     MOVE 0                      TO SUT00007-UNT-QTY              04770000
047800                                    SUT00007-SKU-QTY              04780000
047900                                    SUT00007-CART-QTY             04790000
048000                                    SUT00007-RTL-DOL-AMT          04800000
048100                                    SUT00007-COST-DOL-AMT.        04810000
048200**   PERFORM 8860-INSERT-SUT00007                                 04820004
048300**           UNTIL PS-INSERT-DONE.                                04830004
048400                                                                  04840000
048500     SET PC049-NOT-EOF-SHP-ACTV-CRT-UPC                           04850066
048510         PC049-NOT-EOF-SHL-ACTV-CRT-UPC                           04851066
048600         PS-DEPT-NOT-FOUND    TO TRUE.                            04860066
048610                                                                  04861066
048620     IF  PC049-DK-SHIPPING-TRLR                                   04862066
048700         PERFORM P7360-OPEN-SHP-ACV-CR-UPC-CSR                    04870066
048800         PERFORM 2100-FETCH-TRIP-CARTONS                          04880066
048900            UNTIL PC049-EOF-SHP-ACTV-CRTN-UPC                     04890066
049000         PERFORM P7380-CLOSE-SHP-ACV-CR-UPC-CSR                   04900066
049010     ELSE                                                         04901066
049011         PERFORM P7390-OPEN-SHL-ACV-CR-UPC-CSR                    04901166
049012         PERFORM 2100-FETCH-TRIP-CARTONS                          04901266
049013            UNTIL PC049-EOF-SHL-ACTV-CRTN-UPC                     04901366
049014         PERFORM P7410-CLOSE-SHL-ACV-CR-UPC-CSR                   04901466
049020     END-IF.                                                      04902066
049100                                                                  04910066
049200 2100-FETCH-TRIP-CARTONS.                                         04920066
049210                                                                  04921066
049220     IF  PC049-DK-SHIPPING-TRLR                                   04922066
049300         PERFORM P7370-FETCH-SHP-ACV-CR-UPC-CSR                   04930066
049400         IF  PC049-NOT-EOF-SHP-ACTV-CRT-UPC                       04940066
050100             PERFORM 3000-DET-CARTON-CHARACTERISTCS               05010066
050110         END-IF                                                   05011066
050120     ELSE                                                         05012066
050140         PERFORM P7400-FETCH-SHL-ACV-CR-UPC-CSR                   05014066
050150         IF  PC049-NOT-EOF-SHL-ACTV-CRT-UPC                       05015066
050160             PERFORM 3000-DET-CARTON-CHARACTERISTCS               05016066
050170         END-IF                                                   05017066
050200     END-IF.                                                      05020066
050300                                                                  05030066
050400 3000-DET-CARTON-CHARACTERISTCS.                                  05040066
050500                                                                  05050066
050600*** FOR TESTING ONLY                                              05060066
050700*    IF PC049-PV-REC-TYPE = 'B'                                   05070066
050800*        STRING 'B '                     DELIMITED BY SIZE        05080066
050900*               SUCRDV-BRCDE-NBR         DELIMITED BY SIZE        05090066
051000*                                       INTO PV-CICS-MSG-AREA     05100066
051100*        PERFORM 9997-CSSL                                        05110066
051200*    END-IF.                                                      05120066
051300*** FOR TESTING ONLY                                              05130066
051400     SET PS-NO-CARTON-INFO       TO TRUE.                         05140066
051500     PERFORM 7000-SELECT-CARTON-INFO.                             05150066
051600     PERFORM 3100-PROCESS-ITEMS.                                  05160066
051700                                                                  05170066
051800 3100-PROCESS-ITEMS.                                              05180066
051900     IF SUT00028-UPC-NBR NOT = PV-SAVE-UPC-NBR                    05190066
052000         PERFORM 7230-SELECT-DEPT                                 05200066
052100     END-IF.                                                      05210066
052200*** DOES BELOW NEED TO BE COMMENTED OUT                           05220066
052300     IF  SUT00028-UPC-NBR = ZEROES                                05230066
052400         MOVE ZEROES  TO  XLT00003-SKU-NBR                        05240066
052500                          XLT00004-DEPT-NBR                       05250066
052600                          XLT00004-MAJ-CL-NBR                     05260066
052700                          XLT00001-BUS-AREA-ID                    05270066
052800         MOVE SPACES  TO  XLT00004-HNG-FOLD-DESC                  05280066
052900         MOVE 'H'     TO  XLT00002-MDSE-LNE-CDE                   05290066
053000     END-IF.                                                      05300066
053100*** DOES ABOVE NEED TO BE COMMENTED OUT                           05310066
053110*CLP 07/07/2015 START - GET BRAND ID                              05311071
053200     IF XLT00003-SKU-NBR NOT = PV-SAVE-SKU-NBR                    05320066
053300         PERFORM 7280-SELECT-BRAND-ID                             05330071
053400     END-IF.                                                      05340066
053500     IF PS-DEPT-NOT-FOUND                                         05350066
053600         PERFORM 3200-PROCESS-DUMMY-CARTON                        05360066
053700     ELSE                                                         05370066
053800         IF (SUT00028-TRN-NBR = 0 AND                             05380066
053900             SUT00028-TRN-LNE-NBR = 0)                            05390066
054000            OR SUT00024-CART-SRC-CDE = 'FXR'                      05400066
054010*           OR (SUT00024-CART-SRC-CDE = 'FXR' OR                  05401066
054100*               SUT00024-CART-SRC-CDE = 'RDM')                    05410066
054200            OR PS-NO-CARTON-INFO                                  05420066
054300             MOVE '0001-01-01' TO PV-AD-EVNT-DTE                  05430066
054400             MOVE 0   TO PURITM-UNT-RTL-PR-AMT                    05440066
054500                         PURITM-UNT-COST-AMT                      05450066
054600         ELSE                                                     05460066
054700             IF SUT00028-UPC-NBR NOT = PV-SAVE-UPC-NBR OR         05470066
054800                SUT00028-TRN-NBR NOT = PV-SAVE-TRN-NBR OR         05480066
054900                SUT00028-TRN-LNE-NBR NOT = PV-SAVE-TRN-LNE-NBR    05490066
055000                 MOVE SUT00028-UPC-NBR TO PV-SAVE-UPC-NBR         05500066
055100                 MOVE SUT00028-TRN-NBR TO PV-SAVE-TRN-NBR         05510066
055200                 MOVE SUT00028-TRN-LNE-NBR TO PV-SAVE-TRN-LNE-NBR 05520066
055210                 IF SUT00024-CART-SRC-CDE NOT = 'RDM'             05521066
055300                     PERFORM 7260-SELECT-TPURITM                  05530066
055301                     MOVE PURITM-UNT-RTL-PR-AMT                   05530166
055302                                    TO PV-UNT-RTL-AMT             05530266
055303                     MOVE PURITM-UNT-COST-AMT                     05530366
055304                                    TO PV-UNT-COST-AMT            05530466
055310                 ELSE                                             05531066
055320                     MOVE '0001-01-01' TO PV-AD-EVNT-DTE          05532066
055330                     PERFORM 7250-RDM-COST-AND-RETAIL             05533066
055331                     MOVE CEPLIT-UNT-RTL-AMT                      05533166
055332                                    TO PV-UNT-RTL-AMT             05533266
055333                     MOVE XLV00002-UNT-COST-AMT                   05533366
055334                                    TO PV-UNT-COST-AMT            05533466
055340                 END-IF                                           05534066
055400             END-IF                                               05540066
055500         END-IF                                                   05550066
055600         PERFORM 7270-PRC-MSG-CDE                                 05560066
055700         MOVE XLT00004-DEPT-NBR     TO SUT00095-DEPT-NBR          05570066
055800         MOVE XLT00004-MAJ-CL-NBR   TO SUT00095-MAJ-CL-NBR        05580066
055900         MOVE XLT00001-BUS-AREA-ID  TO SUT00095-BUS-AREA-ID       05590066
056000         MOVE SUT00028-SHPD-UNT-QTY TO SUT00095-UNT-QTY           05600066
056100         COMPUTE SUT00095-RTL-DOL-AMT =                           05610066
056200*             PURITM-UNT-RTL-PR-AMT * SUT00028-SHPD-UNT-QTY       05620066
056210              PV-UNT-RTL-AMT * SUT00028-SHPD-UNT-QTY              05621066
056300         COMPUTE SUT00095-COST-DOL-AMT  =                         05630066
056400*             PURITM-UNT-COST-AMT   * SUT00028-SHPD-UNT-QTY       05640066
056410              PV-UNT-COST-AMT   * SUT00028-SHPD-UNT-QTY           05641066
056500         MOVE XLT00003-SKU-NBR      TO SUT00095-SKU-NBR           05650066
056600                                       PV-SAVE-SKU-NBR            05660066
056700         MOVE SUCRDV-SHIPT-UNT-ID   TO SUT00095-SHIPT-UNT-ID      05670066
056800         MOVE PV-AD-EVNT-DTE        TO SUT00095-AD-DTE            05680066
056900         MOVE XLT00002-MDSE-LNE-CDE TO SUT00095-MDSE-LNE-CDE      05690066
057000         MOVE DK-TRIP-OCRNC-ID      TO SUT00095-TRIP-OCRNC-ID     05700066
057100         EVALUATE XLT00004-HNG-FOLD-DESC                          05710066
057200             WHEN PC-HANG                                         05720066
057300                 MOVE 1            TO SUT00095-HNG-FOLD-SEQ-NBR   05730066
057400             WHEN PC-FOLD                                         05740066
057500                 MOVE 2            TO SUT00095-HNG-FOLD-SEQ-NBR   05750066
057600             WHEN OTHER                                           05760066
057700                 MOVE 0            TO SUT00095-HNG-FOLD-SEQ-NBR   05770066
057800         END-EVALUATE                                             05780066
057810*CLP 07/07/2015 START                                             05781071
057820         MOVE XLT00043-BRND-ID      TO SUT00095-BRND-ID           05782071
057830*CLP 07/07/2015 END                                               05783071
058000         MOVE SUT00024-EAS-TAG-IND  TO SUT00095-EAS-TAG-IND       05800066
058100         MOVE SUT00094-PRC-MSG-CDE  TO SUT00095-PRC-MSG-CDE       05810066
058200         MOVE SUCRDV-DIVERT-TMST    TO SUT00095-DIVERT-TMST       05820066
058300         PERFORM 7900-INSERT-SUT00095                             05830066
058400     END-IF.                                                      05840066
058500                                                                  05850066
058600 3200-PROCESS-DUMMY-CARTON.                                       05860066
058700     MOVE 9999                  TO SUT00095-DEPT-NBR.             05870066
058800     MOVE 9999                  TO SUT00095-MAJ-CL-NBR.           05880066
058900     MOVE 9999                  TO SUT00095-BUS-AREA-ID.          05890066
059000     MOVE 0                     TO SUT00095-UNT-QTY.              05900066
059100     MOVE 0                     TO SUT00095-RTL-DOL-AMT.          05910066
059200     MOVE 0                     TO SUT00095-COST-DOL-AMT.         05920066
059300     MOVE 0                     TO SUT00095-SKU-NBR.              05930066
059400     MOVE SUCRDV-SHIPT-UNT-ID   TO SUT00095-SHIPT-UNT-ID.         05940066
059500     MOVE '0001-01-01'          TO SUT00095-AD-DTE.               05950066
059600**************************** IS THE BELOW NEEDED                  05960066
059700     MOVE SPACES                TO SUT00095-MDSE-LNE-CDE.         05970066
059800     MOVE 0                     TO SUT00095-HNG-FOLD-SEQ-NBR.     05980066
059810*CLP 07/07/2015 START                                             05981071
059820     MOVE 9999999999            TO SUT00095-BRND-ID.              05982071
059830*CLP 07/07/2015 END                                               05983071
060000     MOVE SUT00024-EAS-TAG-IND  TO SUT00095-EAS-TAG-IND.          06000066
060100     PERFORM 7270-PRC-MSG-CDE.                                    06010066
060200     MOVE SUT00094-PRC-MSG-CDE  TO SUT00095-PRC-MSG-CDE.          06020066
060300     MOVE SUCRDV-DIVERT-TMST    TO SUT00095-DIVERT-TMST.          06030066
060400**************************** IS THE ABOVE NEEDED                  06040066
060500     PERFORM 7900-INSERT-SUT00095.                                06050066
060600                                                                  06060066
060700 4000-PROCESS-TEMP-TABLE.                                         06070066
060800                                                                  06080066
060900     PERFORM 8600-SUMM-TRIP-QTY-DOL.                              06090066
061000     PERFORM 8700-SELECT-SKU-CNT-TRIP.                            06100066
061100     PERFORM 8750-SELECT-CARTON-CNT-TRIP.                         06110066
061200     MOVE DK-TRIP-OCRNC-ID       TO SUT00007-TRIP-OCRNC-ID.       06120066
061300     MOVE DK-OTBND-TRIP-ID       TO SUT00007-OTBND-TRIP-ID.       06130066
061400     MOVE PV-UNIT-QTY-SUM        TO SUT00007-UNT-QTY              06140066
061500                                    PV-DISP-UNT-QTY.              06150066
061600     MOVE PV-SKU-COUNT           TO SUT00007-SKU-QTY              06160066
061700                                    PV-DISP-SKU-QTY.              06170066
061800     MOVE PV-CARTON-COUNT        TO SUT00007-CART-QTY             06180066
061900                                    PV-DISP-CART-QTY.             06190066
062000     MOVE PV-RETAIL-SUM          TO SUT00007-RTL-DOL-AMT          06200066
062100                                    PV-DISP-RTL-DOL-AMT.          06210066
062200     MOVE PV-COST-SUM            TO SUT00007-COST-DOL-AMT         06220066
062300                                    PV-DISP-COST-DOL-AMT.         06230066
062400**   PERFORM 8870-UPDATE-SUT00007.                                06240066
062500         ADD   1   TO PV-WRITE-COUNT-8870                         06250066
062600         DISPLAY '8870- ' PV-DISP-UNT-QTY ' ' PV-DISP-SKU-QTY     06260066
062700             ' '   PV-DISP-CART-QTY                               06270066
062800         DISPLAY '   '                                            06280066
062900                   PV-DISP-RTL-DOL-AMT ' '                        06290066
063000                   PV-DISP-COST-DOL-AMT                           06300066
063100                                                                  06310066
063200                                                                  06320066
063300     MOVE 0          TO PV-SAVE-BUS-AREA-ID                       06330066
063400                        PV-SAVE-DEPT-NBR                          06340066
063410*CLP 07/07/2015 START                                             06341071
063500                        PV-SAVE-BRND-ID.                          06350071
063600     SET PS-NOT-EOF-UNT-DOL-CLASS-CSR TO TRUE.                    06360066
063700     PERFORM 8000-OPEN-SKU-QTY-CLASS-CURSOR.                      06370066
063800     PERFORM 4100-DETERMINE-CLASS-VALUES                          06380066
063900         UNTIL PS-EOF-UNT-DOL-CLASS-CSR.                          06390066
064000     PERFORM 8060-CLOSE-SKU-QTY-CLASS-CSR.                        06400066
064100                                                                  06410066
064200     MOVE 0          TO PV-SAVE-BUS-AREA-ID                       06420066
064300                        PV-SAVE-BRND-ID.                          06430071
064400     SET PS-NOT-EOF-UNT-DOL-MDSE-CSR TO TRUE.                     06440066
064500     PERFORM 8100-OPEN-SKU-QTY-BRND-CURSOR.                       06450071
064600     PERFORM 4200-DETERMINE-PGM-BRND-VALUES                       06460071
064700         UNTIL PS-EOF-UNT-DOL-MDSE-CSR.                           06470066
064800     PERFORM 8160-CLOSE-SKU-QTY-BRND-CSR.                         06480071
064900                                                                  06490066
065000                                                                  06500066
065100     SET PS-NOT-EOF-DATE-CSR TO TRUE.                             06510066
065200     PERFORM 7300-OPEN-AD-DATE-CURSOR.                            06520066
065300     PERFORM 4400-PROCESS-DATE-CURSOR                             06530066
065400         UNTIL PS-EOF-DATE-CSR.                                   06540066
065500     PERFORM 7500-CLOSE-AD-DATE.                                  06550066
065600                                                                  06560066
065700                                                                  06570066
065800 4100-DETERMINE-CLASS-VALUES.                                     06580066
065900     PERFORM 8030-FETCH-SKU-QTY-CLASS-CSR.                        06590066
066000     IF PS-NOT-EOF-UNT-DOL-CLASS-CSR                              06600066
066100         PERFORM 8200-SELECT-SKU-CNT-CLASS                        06610066
066200         PERFORM 8250-SELECT-CARTON-CNT-CLASS                     06620066
066300         MOVE DK-TRIP-OCRNC-ID       TO SUT00010-TRIP-OCRNC-ID    06630066
066400         MOVE SUT00095-BUS-AREA-ID   TO SUT00010-BUS-AREA-ID      06640066
066500                                        PV-DISP-BUS-AREA-ID       06650066
066600         MOVE SUT00095-DEPT-NBR      TO SUT00010-DEPT-NBR         06660066
066700                                        PV-DISP-DEPT-NBR          06670066
066800         MOVE SUT00095-MAJ-CL-NBR    TO SUT00010-MAJ-CL-NBR       06680066
066900                                        PV-DISP-MAJ-CL-NBR        06690066
067000         MOVE PV-UNIT-QTY-SUM        TO SUT00010-UNT-QTY          06700066
067100         MOVE PV-SKU-COUNT           TO SUT00010-SKU-QTY          06710066
067200         MOVE PV-CARTON-COUNT        TO SUT00010-CART-QTY         06720066
067300         MOVE PV-RETAIL-SUM          TO SUT00010-RTL-DOL-AMT      06730066
067400         MOVE PV-COST-SUM            TO SUT00010-COST-DOL-AMT     06740066
067500         IF SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID        06750066
067600             IF PV-SAVE-BUS-AREA-ID > 0                           06760066
067700                 PERFORM 8550-SELECT-CARTON-CNT-BUS-GP            06770066
067800                 MOVE PV-CARTON-COUNT        TO SUT00008-CART-QTY 06780066
067900**               PERFORM 8845-UPDATE-SUT00008                     06790066
068000                 ADD   1   TO PV-WRITE-COUNT-8845                 06800066
068100                 MOVE SUT00008-UNT-QTY     TO   PV-DISP-UNT-QTY   06810066
068200                 MOVE SUT00008-SKU-QTY      TO PV-DISP-SKU-QTY    06820066
068300                 MOVE SUT00008-CART-QTY     TO PV-DISP-CART-QTY   06830066
068400                 MOVE SUT00008-RTL-DOL-AMT  TO PV-DISP-RTL-DOL-AMT06840066
068500                 MOVE SUT00008-COST-DOL-AMT TO                    06850066
068600                                       PV-DISP-COST-DOL-AMT       06860066
068700                 DISPLAY '8845- ' PV-DISP-BUS-AREA-ID             06870066
068800                   ' '     PV-DISP-UNT-QTY                        06880066
068900                 DISPLAY '   '                                    06890066
069000                   PV-DISP-SKU-QTY ' '                            06900066
069100                   PV-DISP-CART-QTY   ' '                         06910066
069200                   PV-DISP-RTL-DOL-AMT   ' '                      06920066
069300                   PV-DISP-COST-DOL-AMT                           06930066
069400             END-IF                                               06940066
069500             INITIALIZE DCLSUT00008                               06950066
069600             MOVE DK-TRIP-OCRNC-ID     TO SUT00008-TRIP-OCRNC-ID  06960066
069700             MOVE SUT00095-BUS-AREA-ID TO SUT00008-BUS-AREA-ID    06970066
069800**           PERFORM 8840-INSERT-SUT00008                         06980066
069900             ADD   1   TO PV-WRITE-COUNT-8840                     06990066
070000             MOVE    SUT00008-UNT-QTY TO    PV-DISP-UNT-QTY       07000066
070100             DISPLAY '8840-' PV-DISP-BUS-AREA-ID ' '              07010066
070200                                          PV-DISP-UNT-QTY         07020066
070300         END-IF                                                   07030066
070400         IF SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID OR     07040066
070500            SUT00095-DEPT-NBR    NOT = PV-SAVE-DEPT-NBR           07050066
070600             IF PV-SAVE-BUS-AREA-ID > 0 AND                       07060066
070700                PV-SAVE-DEPT-NBR > 0                              07070066
070800                 PERFORM 8350-SELECT-CARTON-CNT-DEPT              07080066
070900                 MOVE PV-CARTON-COUNT        TO SUT00009-CART-QTY 07090066
071000**               PERFORM 8825-UPDATE-SUT00009                     07100066
071100                 ADD 1 TO PV-WRITE-COUNT-8825                     07110066
071200                 MOVE SUT00009-UNT-QTY TO   PV-DISP-UNT-QTY       07120066
071300                 MOVE SUT00009-BUS-AREA-ID TO PV-DISP-BUS-AREA-ID 07130066
071400                 MOVE SUT00009-DEPT-NBR TO PV-DISP-DEPT-NBR       07140066
071500                 MOVE SUT00009-CART-QTY TO PV-DISP-CART-QTY       07150066
071600                 MOVE SUT00009-RTL-DOL-AMT TO PV-DISP-RTL-DOL-AMT 07160066
071700                MOVE SUT00009-COST-DOL-AMT TO PV-DISP-COST-DOL-AMT07170066
071800                 MOVE SUT00009-SKU-QTY  TO PV-DISP-SKU-QTY        07180066
071900                 DISPLAY '8825- ' PV-DISP-BUS-AREA-ID ' '         07190066
072000                         PV-DISP-DEPT-NBR '  ' PV-DISP-UNT-QTY    07200066
072100                 DISPLAY '   '                                    07210066
072200             PV-DISP-SKU-QTY ' '                                  07220066
072300             PV-DISP-CART-QTY ' '                                 07230066
072400             PV-DISP-RTL-DOL-AMT ' '                              07240066
072500             PV-DISP-COST-DOL-AMT                                 07250066
072600             END-IF                                               07260066
072700             INITIALIZE DCLSUT00009                               07270066
072800             MOVE DK-TRIP-OCRNC-ID     TO SUT00009-TRIP-OCRNC-ID  07280066
072900             MOVE SUT00095-BUS-AREA-ID TO SUT00009-BUS-AREA-ID    07290066
073000             MOVE SUT00095-DEPT-NBR    TO SUT00009-DEPT-NBR       07300066
073100**           PERFORM 8820-INSERT-SUT00009                         07310066
073200             ADD   1   TO PV-WRITE-COUNT-8820                     07320066
073300             MOVE    SUT00009-UNT-QTY TO    PV-DISP-UNT-QTY       07330066
073400             DISPLAY '8820- ' PV-DISP-BUS-AREA-ID                 07340066
073500                     ' ' PV-DISP-DEPT-NBR                         07350066
073600               ' '     PV-DISP-UNT-QTY                            07360066
073700         END-IF                                                   07370066
073800**       PERFORM 8800-INSERT-SUT00010                             07380066
073900         ADD   1   TO PV-WRITE-COUNT-8800                         07390066
074000         MOVE SUT00010-SKU-QTY   TO PV-DISP-SKU-QTY               07400066
074100         MOVE SUT00010-CART-QTY    TO PV-DISP-CART-QTY            07410066
074200         MOVE SUT00010-RTL-DOL-AMT TO PV-DISP-RTL-DOL-AMT         07420066
074300         MOVE SUT00010-COST-DOL-AMT TO PV-DISP-COST-DOL-AMT       07430066
074400         MOVE SUT00010-UNT-QTY      TO PV-DISP-UNT-QTY            07440066
074500         DISPLAY '8800- ' PV-DISP-BUS-AREA-ID ' ' PV-DISP-DEPT-NBR07450066
074600             ' '   PV-DISP-MAJ-CL-NBR ' ' PV-DISP-UNT-QTY         07460066
074700         DISPLAY '   '                                            07470066
074800              PV-DISP-SKU-QTY         ' '                         07480066
074900              PV-DISP-CART-QTY       ' '                          07490066
075000              PV-DISP-RTL-DOL-AMT    ' '                          07500066
075100              PV-DISP-COST-DOL-AMT                                07510066
075200                                                                  07520066
075300         IF SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID OR     07530066
075400            SUT00095-DEPT-NBR    NOT = PV-SAVE-DEPT-NBR           07540066
075500             MOVE DK-TRIP-OCRNC-ID       TO SUT00009-TRIP-OCRNC-ID07550066
075600             MOVE SUT00095-BUS-AREA-ID   TO SUT00009-BUS-AREA-ID  07560066
075700             MOVE SUT00095-DEPT-NBR      TO SUT00009-DEPT-NBR     07570066
075800             MOVE PV-UNIT-QTY-SUM        TO SUT00009-UNT-QTY      07580066
075900             MOVE PV-SKU-COUNT           TO SUT00009-SKU-QTY      07590066
076000             MOVE PV-CARTON-COUNT        TO SUT00009-CART-QTY     07600066
076100             MOVE PV-RETAIL-SUM          TO SUT00009-RTL-DOL-AMT  07610066
076200             MOVE PV-COST-SUM            TO SUT00009-COST-DOL-AMT 07620066
076300             IF SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID    07630066
076400                 MOVE DK-TRIP-OCRNC-ID                            07640066
076500                                         TO SUT00008-TRIP-OCRNC-ID07650066
076600                 MOVE SUT00095-BUS-AREA-ID TO SUT00008-BUS-AREA-ID07660066
076700                 MOVE PV-UNIT-QTY-SUM      TO SUT00008-UNT-QTY    07670066
076800                 MOVE PV-SKU-COUNT         TO SUT00008-SKU-QTY    07680066
076900                 MOVE PV-RETAIL-SUM        TO SUT00008-RTL-DOL-AMT07690066
077000                 MOVE PV-COST-SUM         TO SUT00008-COST-DOL-AMT07700066
077100             ELSE                                                 07710066
077200                 ADD  PV-UNIT-QTY-SUM      TO SUT00008-UNT-QTY    07720066
077300                 ADD  PV-SKU-COUNT         TO SUT00008-SKU-QTY    07730066
077400                 ADD  PV-RETAIL-SUM        TO SUT00008-RTL-DOL-AMT07740066
077500                 ADD  PV-COST-SUM         TO SUT00008-COST-DOL-AMT07750066
077600             END-IF                                               07760066
077700             MOVE SUT00095-BUS-AREA-ID    TO PV-SAVE-BUS-AREA-ID  07770066
077800             MOVE SUT00095-DEPT-NBR       TO PV-SAVE-DEPT-NBR     07780066
077900         ELSE                                                     07790066
078000             ADD  PV-UNIT-QTY-SUM        TO SUT00009-UNT-QTY      07800066
078100             ADD  PV-SKU-COUNT           TO SUT00009-SKU-QTY      07810066
078200             ADD  PV-CARTON-COUNT        TO SUT00009-CART-QTY     07820066
078300             ADD  PV-RETAIL-SUM          TO SUT00009-RTL-DOL-AMT  07830066
078400             ADD  PV-COST-SUM            TO SUT00009-COST-DOL-AMT 07840066
078500             ADD  PV-UNIT-QTY-SUM        TO SUT00008-UNT-QTY      07850066
078600             ADD  PV-SKU-COUNT           TO SUT00008-SKU-QTY      07860066
078700             ADD  PV-RETAIL-SUM          TO SUT00008-RTL-DOL-AMT  07870066
078800             ADD  PV-COST-SUM            TO SUT00008-COST-DOL-AMT 07880066
078900         END-IF                                                   07890066
079000     ELSE                                                         07900066
079100         IF PV-SAVE-DEPT-NBR > 0                                  07910066
079200             PERFORM 8350-SELECT-CARTON-CNT-DEPT                  07920066
079300             MOVE PV-CARTON-COUNT        TO SUT00009-CART-QTY     07930066
079400**           PERFORM 8825-UPDATE-SUT00009                         07940066
079500             ADD 1 TO PV-WRITE-COUNT-8825                         07950066
079600             MOVE SUT00009-UNT-QTY TO   PV-DISP-UNT-QTY           07960066
079700             MOVE SUT00009-BUS-AREA-ID TO PV-DISP-BUS-AREA-ID     07970066
079800             MOVE SUT00009-DEPT-NBR TO PV-DISP-DEPT-NBR           07980066
079900             MOVE SUT00009-CART-QTY TO PV-DISP-CART-QTY           07990066
080000             MOVE SUT00009-RTL-DOL-AMT TO PV-DISP-RTL-DOL-AMT     08000066
080100             MOVE SUT00009-COST-DOL-AMT TO PV-DISP-COST-DOL-AMT   08010066
080200             MOVE SUT00009-SKU-QTY  TO PV-DISP-SKU-QTY            08020066
080300             DISPLAY '8825- ' PV-DISP-BUS-AREA-ID ' '             08030066
080400                         PV-DISP-DEPT-NBR '  ' PV-DISP-UNT-QTY    08040066
080500             DISPLAY '   '                                        08050066
080600             PV-DISP-SKU-QTY ' '                                  08060066
080700             PV-DISP-CART-QTY ' '                                 08070066
080800             PV-DISP-RTL-DOL-AMT ' '                              08080066
080900             PV-DISP-COST-DOL-AMT                                 08090066
081000         END-IF                                                   08100066
081100         IF PV-SAVE-BUS-AREA-ID > 0                               08110066
081200             PERFORM 8550-SELECT-CARTON-CNT-BUS-GP                08120066
081300             MOVE PV-CARTON-COUNT        TO SUT00008-CART-QTY     08130066
081400**           PERFORM 8845-UPDATE-SUT00008                         08140066
081500             MOVE SUT00008-BUS-AREA-ID TO PV-DISP-BUS-AREA-ID     08150066
081600             ADD 1 TO PV-WRITE-COUNT-8845                         08160066
081700             MOVE SUT00008-UNT-QTY TO   PV-DISP-UNT-QTY           08170066
081800             MOVE SUT00008-SKU-QTY  TO PV-DISP-SKU-QTY            08180066
081900             MOVE SUT00008-CART-QTY TO PV-DISP-CART-QTY           08190066
082000             MOVE SUT00008-RTL-DOL-AMT TO PV-DISP-RTL-DOL-AMT     08200066
082100             MOVE SUT00008-COST-DOL-AMT TO                        08210066
082200                                   PV-DISP-COST-DOL-AMT           08220066
082300             DISPLAY '8845- ' PV-DISP-BUS-AREA-ID                 08230066
082400               ' ' PV-DISP-UNT-QTY                                08240066
082500             DISPLAY '   '                                        08250066
082600               PV-DISP-SKU-QTY ' '                                08260066
082700               PV-DISP-CART-QTY ' '                               08270066
082800               PV-DISP-RTL-DOL-AMT ' '                            08280066
082900               PV-DISP-COST-DOL-AMT                               08290066
083000         END-IF                                                   08300066
083100     END-IF.                                                      08310066
083200                                                                  08320066
083210*CLP 07/07/2015 START                                             08321071
083300 4200-DETERMINE-PGM-BRND-VALUES.                                  08330071
083400     PERFORM 8130-FETCH-SKU-QTY-BRND-CSR.                         08340071
083500     IF PS-NOT-EOF-UNT-DOL-MDSE-CSR                               08350066
083600         INITIALIZE DCLSUT00066                                   08360071
083700         MOVE SUT00095-BUS-AREA-ID   TO PV-SAVE-BUS-AREA-ID       08370066
083800         MOVE SUT00095-BRND-ID       TO PV-SAVE-BRND-ID           08380071
083900         PERFORM 8450-SELECT-CARTON-CNT-BRND                      08390071
084000         MOVE PV-CARTON-COUNT        TO SUT00066-CART-QTY         08400071
084100                                        PV-DISP-CART-QTY          08410066
084200         PERFORM 8400-SELECT-SKU-CNT-BRND                         08420071
084300         MOVE PV-SKU-COUNT           TO SUT00066-SKU-QTY          08430071
084400                                        PV-DISP-SKU-QTY           08440066
084500         MOVE DK-TRIP-OCRNC-ID       TO SUT00066-TRIP-OCRNC-ID    08450071
084600         MOVE SUT00095-BUS-AREA-ID   TO SUT00066-BUS-AREA-ID      08460071
084700                                        PV-DISP-BUS-AREA-ID       08470066
084800         MOVE SUT00095-BRND-ID       TO SUT00066-BRND-ID          08480071
084900                                        PV-DISP-BRND-ID           08490071
085000         MOVE PV-UNIT-QTY-SUM        TO SUT00066-UNT-QTY          08500071
085100                                        PV-DISP-UNT-QTY           08510066
085200         MOVE PV-RETAIL-SUM          TO SUT00066-RTL-DOL-AMT      08520071
085300                                        PV-DISP-RTL-DOL-AMT       08530066
085400         MOVE PV-COST-SUM            TO SUT00066-COST-DOL-AMT     08540071
085500                                        PV-DISP-COST-DOL-AMT      08550066
085600**       PERFORM 8890-INSERT-SUT00096                             08560066
085700         ADD   1   TO PV-WRITE-COUNT-8845                         08570066
085800         DISPLAY '8890- ' PV-DISP-BUS-AREA-ID ' '                 08580066
085900                        PV-DISP-BRND-ID                           08590071
086000                        ' ' PV-DISP-UNT-QTY                       08600066
086100         DISPLAY '   '                                            08610066
086200           PV-DISP-SKU-QTY ' '                                    08620066
086300           PV-DISP-CART-QTY   ' '                                 08630066
086400           PV-DISP-RTL-DOL-AMT   ' '                              08640066
086500           PV-DISP-COST-DOL-AMT                                   08650066
086600     END-IF.                                                      08660066
086700                                                                  08670066
086800                                                                  08680066
086900 4400-PROCESS-DATE-CURSOR.                                        08690066
087000     PERFORM 7400-FETCH-AD-DATE.                                  08700066
087100     IF PS-NOT-EOF-DATE-CSR                                       08710066
087200         MOVE DK-TRIP-OCRNC-ID       TO SUT00011-TRIP-OCRNC-ID    08720066
087300         MOVE SUT00095-BUS-AREA-ID   TO SUT00011-BUS-AREA-ID      08730066
087400                                        PV-DISP-BUS-AREA-ID       08740066
087500         MOVE SUT00095-DEPT-NBR      TO SUT00011-DEPT-NBR         08750066
087600                                        PV-DISP-DEPT-NBR          08760066
087700         MOVE SUT00095-MAJ-CL-NBR    TO SUT00011-MAJ-CL-NBR       08770066
087800                                        PV-DISP-MAJ-CL-NBR        08780066
087900         MOVE SUT00095-AD-DTE        TO SUT00011-AD-EVNT-DTE      08790066
088000                                        PV-DISP-AD-EVNT-DTE       08800066
088100**       PERFORM 8880-INSERT-SUT00011                             08810066
088200         DISPLAY '8880- ' PV-DISP-BUS-AREA-ID ' ' PV-DISP-DEPT-NBR08820066
088300              ' '  PV-DISP-MAJ-CL-NBR ' ' SUT00095-AD-DTE         08830066
088400         ADD   1   TO PV-WRITE-COUNT-8880                         08840066
088500     END-IF.                                                      08850066
088600                                                                  08860066
088700                                                                  08870066
088800 5000-CREATE-TRIP-OCCURENCE-ID.                                   08880066
088900*    CALL PC-RANDOM-PGM USING DFHEIBLK                            08890066
089000*                             DFHCOMMAREA                         08900066
089100*                             DP902-RANDNBR-ROUTINE-FIELDS.       08910066
089200*                                                                 08920066
089300*    IF DP902-SUCCESSFUL                                          08930066
089400*        MOVE DP902-RANDOM-NUMBER    TO PV-RANDOM-NUMBER          08940066
089500*        MOVE PV-RANDOM-NUMBER       TO DK-TRIP-OCRNC-ID          08950066
089600*        IF DK-TRIP-OCRNC-ID  > 300000000                         08960066
089700*           CONTINUE                                              08970066
089800*        ELSE                                                     08980066
089900*           ADD  300000000           TO  DK-TRIP-OCRNC-ID         08990066
090000            MOVE PV-SU-TRIP-OCRNC-NBR   TO  DK-TRIP-OCRNC-ID.     09000066
090100*        END-IF                                                   09010066
090200                                                                  09020066
090300*    ELSE                                                         09030066
090400*        MOVE ' SUKUT574 - ERROR GENERATING RANDOM NBR'           09040069
090500*                                    TO PV-CICS-MSG-AREA          09050066
090600*        PERFORM 9997-CSSL                                        09060066
090700*    END-IF.                                                      09070066
090800                                                                  09080066
090900                                                                  09090066
091000 7000-SELECT-CARTON-INFO.                                         09100066
091100     EXEC SQL                                                     09110066
091200         SELECT CART_SRC_CDE                                      09120066
091300            ,   EAS_TAG_IND                                       09130066
091400            ,   CRE_DTE                                           09140066
091500         INTO   :SUT00024-CART-SRC-CDE                            09150066
091600            ,   :SUT00024-EAS-TAG-IND                             09160066
091700            ,   :SUT00024-CRE-DTE                                 09170066
091800         FROM                                                     09180066
091900              SUT_OTBND_CART                                      09190066
092000         WHERE                                                    09200066
092100               SHIPT_UNT_ID          = :SUCRDV-SHIPT-UNT-ID       09210066
092200     END-EXEC.                                                    09220066
092300                                                                  09230066
092400     EVALUATE TRUE                                                09240066
092500         WHEN SQLCODE = ZEROS                                     09250066
092600              SET PS-CARTON-INFO   TO TRUE                        09260066
092700         WHEN SQLCODE = +100                                      09270066
092800              MOVE SPACES TO SUT00024-CART-SRC-CDE                09280066
092900              MOVE PV-CURRENT-DATE TO SUT00024-CRE-DTE            09290066
093000                                                                  09300066
093100         WHEN OTHER                                               09310066
093200              MOVE '7000-SELECT-CARTON-INFO'                      09320066
093300                                   TO PV-PARAGRAPH-NAME           09330066
093400              MOVE 'SELECT FROM SUT_OTBND_CART'                   09340066
093500                                   TO PV-DB2-OPERATION-ATTEMPTED  09350066
093600              MOVE SUCRDV-SHIPT-UNT-ID                            09360066
093700                                    TO PV-SHIPT-UNT-ID            09370066
093800              MOVE PV-SHIPT-UNT-ID  TO PV-FIELD-VALUE             09380066
093900              MOVE SQLCODE          TO PV-DISP-SQLCODE            09390066
094000              PERFORM 9200-SQL-ABEND                              09400066
094100     END-EVALUATE.                                                09410066
094200                                                                  09420066
094300                                                                  09430066
094400 7210-DISPLAY-INFO.                                               09440066
094500     MOVE SPACES                     TO PV-CICS-MSG-AREA.         09450066
094600     STRING ' SUKUT574 - '           DELIMITED BY SIZE            09460069
094700            PV-PARAGRAPH-NAME        DELIMITED BY SIZE            09470066
094800                                        INTO PV-CICS-MSG-AREA.    09480066
094900     PERFORM 9997-CSSL.                                           09490066
095000     MOVE SPACES                     TO PV-CICS-MSG-AREA.         09500066
095100     MOVE SUT00028-UPC-NBR            TO PV-DISP-UPC.             09510066
095200     STRING ' SUKUT574 - '           DELIMITED BY SIZE            09520069
095300          PV-DB2-OPERATION-ATTEMPTED DELIMITED BY SIZE            09530066
095400          ' '                        DELIMITED BY SIZE            09540066
095500          PV-DISP-UPC                DELIMITED BY SIZE            09550066
095600                                        INTO PV-CICS-MSG-AREA.    09560066
095700     PERFORM 9997-CSSL.                                           09570066
095800                                                                  09580066
095900 7230-SELECT-DEPT.                                                09590066
096000     EXEC SQL                                                     09600066
096100         SELECT B.SKU_NBR                                         09610066
096200           ,    C.DEPT_NBR                                        09620066
096300           ,    C.MAJ_CL_NBR                                      09630066
096400           ,    C.HNG_FOLD_DESC                                   09640066
096500           ,    D.MDSE_LNE_CDE                                    09650066
096600           ,    E.BUS_AREA_ID                                     09660066
096700         INTO  :XLT00003-SKU-NBR                                  09670066
096800           ,   :XLT00004-DEPT-NBR                                 09680066
096900           ,   :XLT00004-MAJ-CL-NBR                               09690066
097000           ,   :XLT00004-HNG-FOLD-DESC                            09700066
097100           ,   :XLT00002-MDSE-LNE-CDE                             09710066
097200           ,   :XLT00001-BUS-AREA-ID                              09720066
097300         FROM  XLT_UPC  A                                         09730066
097400           ,   XLT_SKU  B                                         09740066
097500           ,   XLT_VND_STYL C                                     09750066
097600           ,   XLT_DEPT D                                         09760066
097700           ,   XLT_BUS_GP E                                       09770066
097800        WHERE  A.UPC_NBR             = :SUT00028-UPC-NBR          09780066
097900          AND  A.INTR_UPC_ID         = B.INTR_UPC_ID              09790066
098000          AND  B.STYL_ID             = C.STYL_ID                  09800066
098100          AND  C.DEPT_NBR            = D.DEPT_NBR                 09810066
098200          AND  D.BUS_GP_NBR          = E.BUS_GP_NBR               09820066
098300     END-EXEC.                                                    09830066
098400                                                                  09840066
098500                                                                  09850066
098600     EVALUATE TRUE                                                09860066
098700         WHEN SQLCODE = ZERO                                      09870066
098800              SET PS-DEPT-FOUND    TO TRUE                        09880066
098900         WHEN SQLCODE = +100                                      09890066
099000              SET PS-DEPT-NOT-FOUND    TO TRUE                    09900066
099100               MOVE ZEROES  TO  XLT00003-SKU-NBR                  09910066
099200                                XLT00004-DEPT-NBR                 09920066
099300                                XLT00004-MAJ-CL-NBR               09930066
099400                                XLT00001-BUS-AREA-ID              09940066
099500               MOVE SPACES  TO  XLT00004-HNG-FOLD-DESC            09950066
099600               MOVE 'H'     TO  XLT00002-MDSE-LNE-CDE             09960066
099700         WHEN SQLWARN0 NOT = SPACE                                09970066
099800         WHEN SQLCODE  NOT = +0                                   09980066
099900              MOVE '7230-SELECT-DEPT'                             09990066
100000                                   TO PV-PARAGRAPH-NAME           10000066
100100              MOVE 'READ 5 XLT TABL' TO PV-DB2-OPERATION-ATTEMPTED10010066
100200              MOVE SUT00028-UPC-NBR  TO PV-DISP-UPC               10020066
100300              MOVE PV-DISP-UPC     TO PV-FIELD-VALUE              10030066
100400              PERFORM 9200-SQL-ABEND                              10040066
100500     END-EVALUATE.                                                10050066
100600                                                                  10060066
100601 7250-RDM-COST-AND-RETAIL.                                        10060166
100686                                                                  10068666
100687     EXEC SQL                                                     10068766
100688         SELECT UNT_RTL_AMT                                       10068866
100689           INTO :CEPLIT-UNT-RTL-AMT                               10068966
100690           FROM TCEPLIT                                           10069066
100691          WHERE CNSTK_REQ_PL_NBR = :SUT00028-TRN-NBR              10069166
100692            AND PL_LNE_NBR       = :SUT00028-TRN-LNE-NBR          10069266
100693     END-EXEC                                                     10069366
100694                                                                  10069466
100695     EVALUATE TRUE                                                10069566
100696         WHEN SQLCODE = ZERO                                      10069666
100697             CONTINUE                                             10069766
100698         WHEN SQLCODE = +100                                      10069866
100700             MOVE 0                  TO CEPLIT-UNT-RTL-AMT        10070066
100701         WHEN SQLWARN0 NOT = SPACE                                10070166
100702         WHEN SQLCODE  NOT = +0                                   10070266
100703              MOVE '7250-RDM-COST-AND-RETAIL'                     10070366
100704                                     TO PV-PARAGRAPH-NAME         10070466
100705              MOVE 'SELECT FROM TCEPLIT '                         10070566
100706                                     TO PV-DB2-OPERATION-ATTEMPTED10070666
100707              MOVE SUT00028-TRN-NBR  TO PV-FIELD-VALUE-1          10070766
100708              MOVE SUT00028-TRN-LNE-NBR                           10070866
100709                                     TO PV-FIELD-VALUE-2          10070966
100710              PERFORM 9200-SQL-ABEND                              10071066
100711     END-EVALUATE.                                                10071166
100712                                                                  10071266
100713     EXEC SQL                                                     10071366
100714         SELECT DISTINCT                                          10071466
100715                INTR_UPC_ID                                       10071566
100716           INTO :XLV00002-INTR-UPC-ID                             10071666
100717           FROM XLT_UPC                                           10071766
100718          WHERE UPC_NBR  = :SUT00028-UPC-NBR                      10071866
100719     END-EXEC                                                     10071966
100720                                                                  10072066
100721     EVALUATE TRUE                                                10072166
100722         WHEN SQLCODE = ZERO                                      10072266
100723             SET PS-UPC-FOUND        TO TRUE                      10072366
100724         WHEN SQLCODE = +100                                      10072466
100725             SET PS-NOT-UPC-FOUND    TO TRUE                      10072566
100726             MOVE 0                  TO XLV00002-UNT-COST-AMT     10072666
100727         WHEN SQLWARN0 NOT = SPACE                                10072766
100728         WHEN SQLCODE  NOT = +0                                   10072866
100729              MOVE '7250-RDM-COST-AND-RETAIL'                     10072966
100730                                     TO PV-PARAGRAPH-NAME         10073066
100731              MOVE 'SELECT FROM XLT_UPC '                         10073166
100732                                     TO PV-DB2-OPERATION-ATTEMPTED10073266
100733              MOVE SUT00028-UPC-NBR  TO PV-FIELD-VALUE            10073366
100734              PERFORM 9200-SQL-ABEND                              10073466
100735     END-EVALUATE.                                                10073566
100736                                                                  10073666
100737     IF PS-UPC-FOUND                                              10073766
100738         PERFORM 7252-RDM-COST-AMT                                10073866
100739     END-IF.                                                      10073966
100740                                                                  10074066
100741 7252-RDM-COST-AMT.                                               10074166
100742                                                                  10074266
100743     EXEC SQL                                                     10074366
100744         SELECT  UNT_COST_AMT                                     10074466
100745         INTO   :XLV00002-UNT-COST-AMT                            10074566
100746         FROM                                                     10074666
100747         XLV_SKU_STR                                              10074766
100748         WHERE STR_NBR       = 0                                  10074866
100749           AND INTR_UPC_ID   = :XLV00002-INTR-UPC-ID              10074966
100750          WITH UR                                                 10075067
100751     END-EXEC.                                                    10075166
100752                                                                  10075266
100753     EVALUATE TRUE                                                10075366
100754         WHEN SQLCODE = ZERO                                      10075466
100755             CONTINUE                                             10075566
100756         WHEN SQLCODE = +100                                      10075666
100757             SET PS-NOT-UPC-FOUND TO TRUE                         10075766
100758             MOVE 0                  TO XLV00002-UNT-COST-AMT     10075866
100759         WHEN SQLWARN0 NOT = SPACE                                10075966
100760         WHEN SQLCODE  NOT = +0                                   10076066
100761              MOVE '7252-COST-AND-RETAIL'                         10076166
100762                                     TO PV-PARAGRAPH-NAME         10076266
100763              MOVE 'SELECT FROM XLV_SKU_STR'                      10076366
100764                                     TO PV-DB2-OPERATION-ATTEMPTED10076466
100765              MOVE XLV00002-INTR-UPC-ID TO PV-FIELD-VALUE         10076566
100766              PERFORM 9200-SQL-ABEND                              10076666
100767     END-EVALUATE.                                                10076766
100768                                                                  10076866
100770 7260-SELECT-TPURITM.                                             10077066
100800     EXEC SQL                                                     10080066
100900         SELECT AD_EVNT_DTE                                       10090066
101000         ,      UNT_RTL_PR_AMT                                    10100066
101100         ,      UNT_COST_AMT                                      10110066
101200         INTO  :PV-AD-EVNT-DTE                                    10120066
101300         ,     :PURITM-UNT-RTL-PR-AMT                             10130066
101400         ,     :PURITM-UNT-COST-AMT                               10140066
101500         FROM  TPURITM                                            10150066
101600         WHERE PO_NBR              = :SUT00028-TRN-NBR            10160066
101700           AND APP_PO_LNE_NBR      = :SUT00028-TRN-LNE-NBR        10170066
101800           AND VER_STATUS_CDE      = 'A'                          10180066
101900     END-EXEC.                                                    10190066
102000                                                                  10200066
102100                                                                  10210066
102200     EVALUATE TRUE                                                10220066
102300         WHEN SQLCODE = ZERO                                      10230066
102400              CONTINUE                                            10240066
102500         WHEN SQLCODE = +100                                      10250066
102600              MOVE '0001-01-01' TO PV-AD-EVNT-DTE                 10260066
102700              MOVE 0   TO PURITM-UNT-RTL-PR-AMT                   10270066
102800                          PURITM-UNT-COST-AMT                     10280066
102900         WHEN SQLWARN0 NOT = SPACE                                10290066
103000         WHEN SQLCODE  NOT = +0                                   10300066
103100              MOVE '7260-SELECT-TPURITM'                          10310066
103200                                   TO PV-PARAGRAPH-NAME           10320066
103300              MOVE 'READ TPURITM ' TO PV-DB2-OPERATION-ATTEMPTED  10330066
103400              MOVE SUT00028-TRN-NBR TO PV-ITEM-NMBR               10340066
103500              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              10350066
103600              PERFORM 9200-SQL-ABEND                              10360066
103700     END-EVALUATE.                                                10370066
103800                                                                  10380066
103900 7270-PRC-MSG-CDE.                                                10390066
104000                                                                  10400066
104100     EXEC SQL                                                     10410066
104200         SELECT DISTINCT(PRC_MSG_CDE)                             10420066
104300         INTO  :SUT00094-PRC-MSG-CDE                              10430066
104400         FROM  SUT_PRC_MSG_CNTL A                                 10440066
104500         WHERE SHIPT_UNT_ID        = :SUCRDV-SHIPT-UNT-ID         10450066
104510         FETCH FIRST 1 ROW ONLY                                   10451066
104600     END-EXEC.                                                    10460066
104700                                                                  10470066
104800                                                                  10480066
104900     EVALUATE TRUE                                                10490066
105000         WHEN SQLCODE = ZERO                                      10500066
105100         WHEN SQLCODE = -811                                      10510066
105200              CONTINUE                                            10520066
105300         WHEN SQLCODE = +100                                      10530066
105400              MOVE SPACES       TO SUT00094-PRC-MSG-CDE           10540066
105500         WHEN SQLWARN0 NOT = SPACE                                10550066
105600         WHEN SQLCODE  NOT = +0                                   10560066
105700              MOVE '7270-PRC-MSG-CDE'                             10570066
105800                                   TO PV-PARAGRAPH-NAME           10580066
105900              MOVE 'READ PROCESS MSG'                             10590066
106000                                     TO PV-DB2-OPERATION-ATTEMPTED10600066
106100              MOVE SUCRDV-SHIPT-UNT-ID                            10610066
106200                                    TO PV-SHIPT-UNT-ID            10620066
106300              MOVE PV-SHIPT-UNT-ID TO PV-FIELD-VALUE              10630066
106400              PERFORM 9200-SQL-ABEND                              10640066
106500     END-EVALUATE.                                                10650066
106600                                                                  10660066
106610***************************************************************** 10661074
106620* STYLES WITH '0' BRND_ID ARE ACTUALLY NO BRAND ASSIGNED AND    * 10662074
106630* ARE GIVEN A DESCRIPTION OF 'UNKNOWN' ON THE XLT_BRND TABLE    * 10663074
106640* THEY WILL BE FOUND IN A SQLCODE OF 0 CONDITION                * 10664074
106650***************************************************************** 10665074
106700 7280-SELECT-BRAND-ID.                                            10670071
106800*NEW                                                              10680066
106810     EXEC SQL                                                     10681071
106820        SELECT  B.BRND_ID                                         10682071
106830         INTO   :XLT00043-BRND-ID                                 10683073
106840          FROM  XLT_SKU      A                                    10684071
106850             ,  XLT_VND_STYL B                                    10685071
106860             ,  XLT_BRND     C                                    10686071
106870         WHERE  SKU_NBR           =  :XLT00003-SKU-NBR            10687071
106880           AND  A.STYL_ID         =  B.STYL_ID                    10688071
106890           AND  B.BRND_ID         =  C.BRND_ID                    10689071
106891     END-EXEC.                                                    10689171
106892                                                                  10689271
109200     EVALUATE TRUE                                                10920066
109300         WHEN SQLCODE = ZERO                                      10930066
109400         WHEN SQLCODE = -811                                      10940066
109500              CONTINUE                                            10950066
109600         WHEN SQLCODE = +100                                      10960066
109700              MOVE 0          TO XLT00043-BRND-ID                 10970074
109800         WHEN SQLWARN0 NOT = SPACE                                10980066
109900         WHEN SQLCODE  NOT = +0                                   10990066
110000              MOVE '7280-SELECT-BRAND-ID'                         11000071
110100                                   TO PV-PARAGRAPH-NAME           11010066
110200              MOVE 'READ XLT00043' TO PV-DB2-OPERATION-ATTEMPTED  11020071
110300              MOVE XLT00003-SKU-NBR TO PV-SKU-NBR                 11030066
110400              MOVE PV-SKU-NBR      TO PV-FIELD-VALUE              11040066
110500              PERFORM 9200-SQL-ABEND                              11050066
110600     END-EVALUATE.                                                11060066
110700                                                                  11070066
110800 7300-OPEN-AD-DATE-CURSOR.                                        11080066
110900                                                                  11090066
111000     EXEC SQL                                                     11100066
111100         OPEN AD-DATE-CSR                                         11110066
111200     END-EXEC.                                                    11120066
111300                                                                  11130066
111400     EVALUATE TRUE                                                11140066
111500         WHEN SQLCODE = ZEROS                                     11150066
111600              SET PS-NOT-EOF-DATE-CSR TO TRUE                     11160066
111700                                                                  11170066
111800         WHEN OTHER                                               11180066
111900              MOVE '7300-OPEN-AD-DATE-CURSOR   '                  11190066
112000                                   TO PV-PARAGRAPH-NAME           11200066
112100              MOVE 'OPEN AD-DATE-CSR'                             11210066
112200                                   TO PV-DB2-OPERATION-ATTEMPTED  11220066
112300              MOVE SQLCODE         TO PV-DISP-SQLCODE             11230066
112400              PERFORM 9200-SQL-ABEND                              11240066
112500     END-EVALUATE.                                                11250066
112600                                                                  11260066
112700                                                                  11270066
112800 7400-FETCH-AD-DATE.                                              11280066
112900     EXEC SQL                                                     11290066
113000         FETCH AD-DATE-CSR                                        11300066
113100         INTO                                                     11310066
113200             :SUT00095-BUS-AREA-ID                                11320066
113300          ,  :SUT00095-DEPT-NBR                                   11330066
113400          ,  :SUT00095-MAJ-CL-NBR                                 11340066
113500          ,  :SUT00095-AD-DTE                                     11350066
113600     END-EXEC.                                                    11360066
113700                                                                  11370066
113800     EVALUATE TRUE                                                11380066
113900         WHEN SQLCODE = ZERO                                      11390066
114000              CONTINUE                                            11400066
114100         WHEN SQLCODE = +100                                      11410066
114200              SET PS-EOF-DATE-CSR TO TRUE                         11420066
114300         WHEN SQLWARN0 NOT = SPACE                                11430066
114400         WHEN SQLCODE  NOT = +0                                   11440066
114500              MOVE '7400-FETCH-AD-DATE'                           11450066
114600                                   TO PV-PARAGRAPH-NAME           11460066
114700              MOVE 'FETCH AD-DATE-CSR'                            11470066
114800                                   TO PV-DB2-OPERATION-ATTEMPTED  11480066
114900              MOVE SQLCODE         TO PV-DISP-SQLCODE             11490066
115000              PERFORM 9200-SQL-ABEND                              11500066
115100     END-EVALUATE.                                                11510066
115200                                                                  11520066
115300 7500-CLOSE-AD-DATE.                                              11530066
115400                                                                  11540066
115500     EXEC SQL                                                     11550066
115600         CLOSE AD-DATE-CSR                                        11560066
115700     END-EXEC.                                                    11570066
115800                                                                  11580066
115900     EVALUATE TRUE                                                11590066
116000         WHEN SQLCODE = ZEROS                                     11600066
116100              CONTINUE                                            11610066
116200                                                                  11620066
116300         WHEN OTHER                                               11630066
116400              MOVE '7500-CLOSE-AD-DATE         '                  11640066
116500                                   TO PV-PARAGRAPH-NAME           11650066
116600              MOVE 'CLOSE AD-DATE-CSR'                            11660066
116700                                   TO PV-DB2-OPERATION-ATTEMPTED  11670066
116800              MOVE SQLCODE         TO PV-DISP-SQLCODE             11680066
116900              PERFORM 9200-SQL-ABEND                              11690066
117000     END-EVALUATE.                                                11700066
117100                                                                  11710066
117200                                                                  11720066
117300                                                                  11730066
117400 7900-INSERT-SUT00095.                                            11740066
117500     MOVE SUT00095-TRIP-OCRNC-ID    TO SU574-TRIP-OCRNC-ID.       11750066
117600     MOVE SUT00095-SHIPT-UNT-ID     TO SU574-SHIPT-UNT-ID.        11760066
117700     MOVE SUT00095-SKU-NBR          TO SU574-SKU-NBR.             11770066
117800     MOVE SUT00095-BUS-AREA-ID      TO SU574-BUS-AREA-ID.         11780066
117900     MOVE SUT00095-DEPT-NBR         TO SU574-DEPT-NBR.            11790066
118000     MOVE SUT00095-MAJ-CL-NBR       TO SU574-MAJ-CL-NBR.          11800066
118100     MOVE SUT00095-MDSE-LNE-CDE     TO SU574-MDSE-LNE-CDE.        11810066
118200     MOVE SUT00095-HNG-FOLD-SEQ-NBR TO SU574-HNG-FOLD-SEQ-NBR.    11820066
118210*CLP 07/07/2015 START                                             11821071
118300     MOVE SUT00095-BRND-ID          TO SU574-BRND-ID.             11830071
118310*CLP 07/07/2015 END                                               11831071
118400     MOVE SUT00095-EAS-TAG-IND      TO SU574-EAS-TAG-IND.         11840066
118500     MOVE SUT00095-PRC-MSG-CDE      TO SU574-PRC-MSG-CDE.         11850066
118600     MOVE SUT00095-DIVERT-TMST      TO SU574-DIVERT-TMST.         11860066
118700     MOVE SUT00095-UNT-QTY          TO SU574-UNT-QTY.             11870066
118800     MOVE SUT00095-RTL-DOL-AMT      TO SU574-RTL-DOL-AMT.         11880066
118900     MOVE SUT00095-AD-DTE           TO SU574-AD-DTE.              11890066
119000     MOVE SUT00095-COST-DOL-AMT     TO SU574-COST-DOL-AMT.        11900066
119100                                                                  11910066
119200     WRITE SU-OUT-RECORD FROM SU574-OUTPUT-RECORD.                11920066
119300     ADD 1 TO PV-RECS-WRITTEN.                                    11930066
119400                                                                  11940066
119500                                                                  11950066
119600*    EXEC SQL                                                     11960066
119700*         INSERT INTO SUT_TRIP_DTL_SUM                            11970066
119800*                (TRIP_OCRNC_ID                                   11980066
119900*              ,  SHIPT_UNT_ID                                    11990066
120000*              ,  SKU_NBR                                         12000066
120100*              ,  BUS_AREA_ID                                     12010066
120200*              ,  DEPT_NBR                                        12020066
120300*              ,  MAJ_CL_NBR                                      12030066
120400*              ,  MDSE_LNE_CDE                                    12040066
120500*              ,  HNG_FOLD_SEQ_NBR                                12050066
120600*              ,  MDSE_PGM_ID                                     12060066
120700*              ,  EAS_TAG_IND                                     12070066
120800*              ,  PRC_MSG_CDE                                     12080066
120900*              ,  DIVERT_TMST                                     12090066
121000*              ,  UNT_QTY                                         12100066
121100*              ,  RTL_DOL_AMT                                     12110066
121200*              ,  AD_DTE                                          12120066
121300*              ,  COST_DOL_AMT)                                   12130066
121400*         VALUES (                                                12140066
121500*                :SUT00095-TRIP-OCRNC-ID                          12150066
121600*             ,  :SUT00095-SHIPT-UNT-ID                           12160066
121700*             ,  :SUT00095-SKU-NBR                                12170066
121800*             ,  :SUT00095-BUS-AREA-ID                            12180066
121900*             ,  :SUT00095-DEPT-NBR                               12190066
122000*             ,  :SUT00095-MAJ-CL-NBR                             12200066
122100*             ,  :SUT00095-MDSE-LNE-CDE                           12210066
122200*             ,  :SUT00095-HNG-FOLD-SEQ-NBR                       12220066
122300*             ,  :SUT00095-MDSE-PGM-ID                            12230066
122400*             ,  :SUT00095-EAS-TAG-IND                            12240066
122500*             ,  :SUT00095-PRC-MSG-CDE                            12250066
122600*             ,  :SUT00095-DIVERT-TMST                            12260066
122700*             ,  :SUT00095-UNT-QTY                                12270066
122800*             ,  :SUT00095-RTL-DOL-AMT                            12280066
122900*             ,  :SUT00095-AD-DTE                                 12290066
123000*             ,  :SUT00095-COST-DOL-AMT)                          12300066
123100*    END-EXEC.                                                    12310066
123200*                                                                 12320066
123300*    EVALUATE TRUE                                                12330066
123400*        WHEN SQLCODE = +0                                        12340066
123500*             CONTINUE                                            12350066
123600*                                                                 12360066
123700*        WHEN SQLCODE = -803                                      12370066
123800*             PERFORM 7930-PROCESS-UPDATE                         12380066
123900*                                                                 12390066
124000*        WHEN SQLWARN0 NOT = SPACES                               12400066
124100*        WHEN SQLCODE < +0                                        12410066
124200*        WHEN SQLCODE > +0                                        12420066
124300*            MOVE '7900-INSERT-SUT00095          '                12430066
124400*                                 TO PV-PARAGRAPH-NAME            12440066
124500*            MOVE 'INSERT SUT_TRIP_DTL_SUM'                       12450066
124600*                              TO PV-DB2-OPERATION-ATTEMPTED      12460066
124700*            MOVE SQLCODE      TO PV-DISP-SQLCODE                 12470066
124800*            PERFORM 9200-SQL-ABEND                               12480066
124900*    END-EVALUATE.                                                12490066
125000                                                                  12500066
125100 7930-PROCESS-UPDATE.                                             12510066
125200     PERFORM 7950-SELECT-DETAIL-SUM.                              12520066
125300     ADD PV-UNT-QTY       TO SUT00095-UNT-QTY.                    12530066
125400     MOVE SUT00095-UNT-QTY TO PV-UNT-QTY.                         12540066
125500     ADD PV-RTL-DOL-AMT   TO SUT00095-RTL-DOL-AMT.                12550066
125600     MOVE SUT00095-RTL-DOL-AMT TO PV-DISP-RTL-DOL-AMT.            12560066
125700     ADD PV-COST-DOL-AMT  TO SUT00095-COST-DOL-AMT.               12570066
125800     MOVE SUT00095-COST-DOL-AMT TO PV-COST-DOL-AMT.               12580066
125900*    PERFORM 7970-UPDATE-DETAIL-SUM.                              12590066
126000         ADD   1   TO PV-WRITE-COUNT-7970                         12600066
126100         DISPLAY '7970- ' PV-DISP-UNT-QTY     ' '                 12610066
126200                        PV-DISP-RTL-DOL-AMT                       12620066
126300                        ' ' PV-DISP-COST-DOL-AMT.                 12630066
126400                                                                  12640066
126500 7950-SELECT-DETAIL-SUM.                                          12650066
126600                                                                  12660066
126700     EXEC SQL                                                     12670066
126800         SELECT UNT_QTY                                           12680066
126900             ,  RTL_DOL_AMT                                       12690066
127000             ,  COST_DOL_AMT                                      12700066
127100         INTO  :PV-UNT-QTY                                        12710066
127200            ,  :PV-RTL-DOL-AMT                                    12720066
127300            ,  :PV-COST-DOL-AMT                                   12730066
127400         FROM SUT_TRIP_DTL_SUM                                    12740066
127500        WHERE  TRIP_OCRNC_ID         = :SUT00095-TRIP-OCRNC-ID    12750066
127600         AND   SHIPT_UNT_ID          = :SUT00095-SHIPT-UNT-ID     12760066
127700         AND   SKU_NBR               = :SUT00095-SKU-NBR          12770066
127800     END-EXEC.                                                    12780066
127900                                                                  12790066
128000     EVALUATE TRUE                                                12800066
128100         WHEN SQLCODE = ZERO                                      12810066
128200              CONTINUE                                            12820066
128300         WHEN SQLWARN0 NOT = SPACE                                12830066
128400         WHEN SQLCODE  NOT = +0                                   12840066
128500              MOVE '7950-SELECT-DETAIL-SUM '                      12850066
128600                                   TO PV-PARAGRAPH-NAME           12860066
128700              MOVE 'SELECT SUT00095' TO PV-DB2-OPERATION-ATTEMPTED12870066
128800              MOVE SUT00095-TRIP-OCRNC-ID TO PV-ITEM-NMBR         12880066
128900              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              12890066
129000              MOVE SUT00095-SHIPT-UNT-ID  TO PV-ITEM-NMBR         12900066
129100              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-1            12910066
129200              MOVE SUT00095-SKU-NBR       TO PV-ITEM-NMBR         12920066
129300              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-2            12930066
129400              PERFORM 9200-SQL-ABEND                              12940066
129500     END-EVALUATE.                                                12950066
129600                                                                  12960066
129700                                                                  12970066
129800*7970-UPDATE-DETAIL-SUM.                                          12980066
129900*                                                                 12990066
130000*    EXEC SQL                                                     13000066
130100*         UPDATE SUT_TRIP_DTL_SUM                                 13010066
130200*           SET UNT_QTY            = :SUT00095-UNT-QTY            13020066
130300*            ,  RTL_DOL_AMT        = :SUT00095-RTL-DOL-AMT        13030066
130400*            ,  COST_DOL_AMT       = :SUT00095-COST-DOL-AMT       13040066
130500*       WHERE  TRIP_OCRNC_ID         = :SUT00095-TRIP-OCRNC-ID    13050066
130600*        AND   SHIPT_UNT_ID          = :SUT00095-SHIPT-UNT-ID     13060066
130700*        AND   SKU_NBR               = :SUT00095-SKU-NBR          13070066
130800*    END-EXEC.                                                    13080066
130900*                                                                 13090066
131000*    EVALUATE TRUE                                                13100066
131100*        WHEN SQLCODE = ZERO                                      13110066
131200*             CONTINUE                                            13120066
131300*        WHEN SQLWARN0 NOT = SPACE                                13130066
131400*        WHEN SQLCODE  NOT = +0                                   13140066
131500*             MOVE '7970-UPDATE-DETAIL-SUM '                      13150066
131600*                                  TO PV-PARAGRAPH-NAME           13160066
131700*             MOVE 'UPDATE SUT00095' TO PV-DB2-OPERATION-ATTEMPTED13170066
131800*             MOVE SUT00095-TRIP-OCRNC-ID TO PV-ITEM-NMBR         13180066
131900*             MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              13190066
132000*             MOVE SUT00095-SHIPT-UNT-ID  TO PV-ITEM-NMBR         13200066
132100*             MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-1            13210066
132200*             MOVE SUT00095-SKU-NBR       TO PV-ITEM-NMBR         13220066
132300*             MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-2            13230066
132400*             PERFORM 9200-SQL-ABEND                              13240066
132500*    END-EVALUATE.                                                13250066
132600                                                                  13260066
132601                                                                  13260168
132610**************************************************************    13261068
132620* INSERT ROW INTO SUT_TRIP_WRKR_AUD TO SHOW WHO REQUESTED A  *    13262068
132630* TRAILER SUMMARIZATION                                      *    13263068
132640* 7/25/13                                                    *    13264068
132650**************************************************************    13265068
132660 7990-INSERT-WRKR-AUD.                                            13266068
132670                                                                  13267068
132680     MOVE  PC047-OTBND-TRIP-ID  TO  SUT00006-OTBND-TRIP-ID.       13268070
132681     MOVE  PV-USERID            TO  SUT00006-USR-ID.              13268170
132691                                                                  13269168
132692     EXEC SQL                                                     13269268
132693          INSERT INTO SUT_TRIP_WRKR_AUD                           13269368
132694                 (                                                13269468
132695                   OTBND_TRIP_ID                                  13269568
132696                  ,USR_ID                                         13269668
132697                  ,CRE_TMST                                       13269768
132698                  ,CRE_BY_PGM_NM                                  13269868
132699                 )                                                13269968
132700          VALUES (                                                13270068
132701                   :SUT00006-OTBND-TRIP-ID                        13270168
132702                  ,'BATCH'                                        13270268
132703                  , CURRENT TIMESTAMP                             13270368
132704                  ,'SUKUT574'                                     13270469
132705                 )                                                13270568
132706     END-EXEC.                                                    13270668
132707                                                                  13270768
132708     EVALUATE TRUE                                                13270868
132709         WHEN SQLCODE = +0                                        13270968
132710              CONTINUE                                            13271068
132711                                                                  13271168
132712                                                                  13271268
132713         WHEN SQLWARN0 NOT = SPACES                               13271368
132714         WHEN SQLCODE < +0                                        13271468
132715         WHEN SQLCODE > +0                                        13271568
132716             MOVE '7990-INSERT-WRKR-AUD          '                13271668
132717                                  TO PV-PARAGRAPH-NAME            13271768
132718             MOVE 'INSERT SUT_TRIP_WRKR_AUD'                      13271868
132719                               TO PV-DB2-OPERATION-ATTEMPTED      13271968
132720             MOVE SQLCODE      TO PV-DISP-SQLCODE                 13272068
132721             PERFORM 9200-SQL-ABEND                               13272168
132728     END-EVALUATE.                                                13272868
132729                                                                  13272968
132730                                                                  13273068
132740 8000-OPEN-SKU-QTY-CLASS-CURSOR.                                  13274066
132800                                                                  13280066
132900     EXEC SQL                                                     13290066
133000         OPEN UNT-DOL-CLASS-CSR                                   13300066
133100     END-EXEC.                                                    13310066
133200                                                                  13320066
133300     EVALUATE TRUE                                                13330066
133400         WHEN SQLCODE = ZEROS                                     13340066
133500              SET PS-NOT-EOF-UNT-DOL-CLASS-CSR TO TRUE            13350066
133600                                                                  13360066
133700         WHEN OTHER                                               13370066
133800              MOVE '8000-OPEN-SKU-QTY-CLASS-CURSOR'               13380066
133900                                   TO PV-PARAGRAPH-NAME           13390066
134000              MOVE 'OPEN UNT-DOL-CLASS-CSR'                       13400066
134100                                   TO PV-DB2-OPERATION-ATTEMPTED  13410066
134200              MOVE SQLCODE         TO PV-DISP-SQLCODE             13420066
134300              PERFORM 9200-SQL-ABEND                              13430066
134400     END-EVALUATE.                                                13440066
134500                                                                  13450066
134600 8030-FETCH-SKU-QTY-CLASS-CSR.                                    13460066
134700     EXEC SQL                                                     13470066
134800         FETCH UNT-DOL-CLASS-CSR                                  13480066
134900         INTO  :SUT00095-BUS-AREA-ID                              13490066
135000            ,  :SUT00095-DEPT-NBR                                 13500066
135100            ,  :SUT00095-MAJ-CL-NBR                               13510066
135200            ,  :PV-UNIT-QTY-SUM                                   13520066
135300            ,  :PV-RETAIL-SUM                                     13530066
135400            ,  :PV-COST-SUM                                       13540066
135500     END-EXEC.                                                    13550066
135600                                                                  13560066
135700     EVALUATE TRUE                                                13570066
135800         WHEN SQLCODE = ZERO                                      13580066
135900              CONTINUE                                            13590066
136000         WHEN SQLCODE = +100                                      13600066
136100              SET PS-EOF-UNT-DOL-CLASS-CSR TO TRUE                13610066
136200         WHEN SQLWARN0 NOT = SPACE                                13620066
136300         WHEN SQLCODE  NOT = +0                                   13630066
136400              MOVE '8030-FETCH-SKU-QTY-CLASS-CSR'                 13640066
136500                                   TO PV-PARAGRAPH-NAME           13650066
136600              MOVE 'FETCH UNT-DOL-CLASS-CSR'                      13660066
136700                                   TO PV-DB2-OPERATION-ATTEMPTED  13670066
136800              MOVE SQLCODE         TO PV-DISP-SQLCODE             13680066
136900              PERFORM 9200-SQL-ABEND                              13690066
137000     END-EVALUATE.                                                13700066
137100                                                                  13710066
137200 8060-CLOSE-SKU-QTY-CLASS-CSR.                                    13720066
137300                                                                  13730066
137400     EXEC SQL                                                     13740066
137500         CLOSE UNT-DOL-CLASS-CSR                                  13750066
137600     END-EXEC.                                                    13760066
137700                                                                  13770066
137800     EVALUATE TRUE                                                13780066
137900         WHEN SQLCODE = ZEROS                                     13790066
138000              CONTINUE                                            13800066
138100                                                                  13810066
138200         WHEN OTHER                                               13820066
138300              MOVE '8060-CLOSE-SKU-QTY-CLASS-CURSOR'              13830066
138400                                   TO PV-PARAGRAPH-NAME           13840066
138500              MOVE 'CLOSE UNT-DOL-CLASS-CSR'                      13850066
138600                                   TO PV-DB2-OPERATION-ATTEMPTED  13860066
138700              MOVE SQLCODE         TO PV-DISP-SQLCODE             13870066
138800              PERFORM 9200-SQL-ABEND                              13880066
138900     END-EVALUATE.                                                13890066
139000                                                                  13900066
139100 8100-OPEN-SKU-QTY-BRND-CURSOR.                                   13910071
139200                                                                  13920066
139300     EXEC SQL                                                     13930066
139400         OPEN UNT-DOL-BRND-CSR                                    13940071
139500     END-EXEC.                                                    13950066
139600                                                                  13960066
139700     EVALUATE TRUE                                                13970066
139800         WHEN SQLCODE = ZEROS                                     13980066
139900              SET PS-NOT-EOF-UNT-DOL-MDSE-CSR TO TRUE             13990066
140000                                                                  14000066
140100         WHEN OTHER                                               14010066
140200              MOVE '8100-OPEN-SKU-QTY-BRND-CURSOR'                14020071
140300                                   TO PV-PARAGRAPH-NAME           14030066
140400              MOVE 'OPEN UNT-DOL-BRND-CSR'                        14040071
140500                                   TO PV-DB2-OPERATION-ATTEMPTED  14050066
140600              MOVE SQLCODE         TO PV-DISP-SQLCODE             14060066
140700              PERFORM 9200-SQL-ABEND                              14070066
140800     END-EVALUATE.                                                14080066
140900                                                                  14090066
141000 8130-FETCH-SKU-QTY-BRND-CSR.                                     14100071
141100     EXEC SQL                                                     14110066
141200         FETCH UNT-DOL-BRND-CSR                                   14120071
141300         INTO  :SUT00095-BUS-AREA-ID                              14130066
141400            ,  :SUT00095-BRND-ID                                  14140071
141500            ,  :PV-UNIT-QTY-SUM                                   14150066
141600            ,  :PV-RETAIL-SUM                                     14160066
141700            ,  :PV-COST-SUM                                       14170066
141800     END-EXEC.                                                    14180066
141900                                                                  14190066
142000     EVALUATE TRUE                                                14200066
142100         WHEN SQLCODE = ZERO                                      14210066
142200              CONTINUE                                            14220066
142300         WHEN SQLCODE = +100                                      14230066
142400              SET PS-EOF-UNT-DOL-MDSE-CSR TO TRUE                 14240066
142500         WHEN SQLWARN0 NOT = SPACE                                14250066
142600         WHEN SQLCODE  NOT = +0                                   14260066
142700              MOVE '8130-FETCH-SKU-QTY-BRND-CSR'                  14270071
142800                                   TO PV-PARAGRAPH-NAME           14280066
142900              MOVE 'FETCH UNT-DOL-BRND-CSR'                       14290071
143000                                   TO PV-DB2-OPERATION-ATTEMPTED  14300066
143100              MOVE SQLCODE         TO PV-DISP-SQLCODE             14310066
143200              PERFORM 9200-SQL-ABEND                              14320066
143300     END-EVALUATE.                                                14330066
143400                                                                  14340066
143500 8160-CLOSE-SKU-QTY-BRND-CSR.                                     14350071
143600                                                                  14360066
143700     EXEC SQL                                                     14370066
143800         CLOSE UNT-DOL-BRND-CSR                                   14380071
143900     END-EXEC.                                                    14390066
144000                                                                  14400066
144100     EVALUATE TRUE                                                14410066
144200         WHEN SQLCODE = ZEROS                                     14420066
144300              CONTINUE                                            14430066
144400                                                                  14440066
144500         WHEN OTHER                                               14450066
144600              MOVE '8160-CLOSE-SKU-QTY-BRND-CURSOR'               14460071
144700                                   TO PV-PARAGRAPH-NAME           14470066
144800              MOVE 'CLOSE UNT-DOL-BRND-CSR'                       14480071
144900                                   TO PV-DB2-OPERATION-ATTEMPTED  14490066
145000              MOVE SQLCODE         TO PV-DISP-SQLCODE             14500066
145100              PERFORM 9200-SQL-ABEND                              14510066
145200     END-EVALUATE.                                                14520066
145300                                                                  14530066
145400 8200-SELECT-SKU-CNT-CLASS.                                       14540066
145500                                                                  14550066
145600                                                                  14560066
145700     EXEC SQL                                                     14570066
145800         SELECT COUNT(DISTINCT SKU_NBR)                           14580066
145900         INTO  :PV-SKU-COUNT                                      14590066
146000         FROM SUT_TRIP_DTL_SUM                                    14600066
146100        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          14610066
146200         AND   BUS_AREA_ID           = :SUT00095-BUS-AREA-ID      14620066
146300         AND   DEPT_NBR              = :SUT00095-DEPT-NBR         14630066
146400         AND   MAJ_CL_NBR            = :SUT00095-MAJ-CL-NBR       14640066
146500        WITH UR                                                   14650066
146600     END-EXEC.                                                    14660066
146700                                                                  14670066
146800     EVALUATE TRUE                                                14680066
146900         WHEN SQLCODE = ZERO                                      14690066
147000              CONTINUE                                            14700066
147100         WHEN SQLWARN0 NOT = SPACE                                14710066
147200         WHEN SQLCODE  NOT = +0                                   14720066
147300              MOVE '8200-SELECT-SKU-CNT-CLASS'                    14730066
147400                                   TO PV-PARAGRAPH-NAME           14740066
147500              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  14750066
147600              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               14760066
147700              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              14770066
147800              PERFORM 9200-SQL-ABEND                              14780066
147900     END-EVALUATE.                                                14790066
148000                                                                  14800066
148100 8250-SELECT-CARTON-CNT-CLASS.                                    14810066
148200                                                                  14820066
148300     EXEC SQL                                                     14830066
148400         SELECT COUNT(DISTINCT SHIPT_UNT_ID)                      14840066
148500         INTO  :PV-CARTON-COUNT                                   14850066
148600         FROM SUT_TRIP_DTL_SUM                                    14860066
148700        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          14870066
148800         AND   BUS_AREA_ID           = :SUT00095-BUS-AREA-ID      14880066
148900         AND   DEPT_NBR              = :SUT00095-DEPT-NBR         14890066
149000         AND   MAJ_CL_NBR            = :SUT00095-MAJ-CL-NBR       14900066
149100        WITH UR                                                   14910066
149200     END-EXEC.                                                    14920066
149300                                                                  14930066
149400     EVALUATE TRUE                                                14940066
149500         WHEN SQLCODE = ZERO                                      14950066
149600              CONTINUE                                            14960066
149700         WHEN SQLWARN0 NOT = SPACE                                14970066
149800         WHEN SQLCODE  NOT = +0                                   14980066
149900              MOVE '8250-SELECT-CARTON-CNT-CLASS'                 14990066
150000                                   TO PV-PARAGRAPH-NAME           15000066
150100              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  15010066
150200              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               15020066
150300              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              15030066
150400              PERFORM 9200-SQL-ABEND                              15040066
150500     END-EVALUATE.                                                15050066
150600                                                                  15060066
150700 8300-SELECT-SKU-CNT-DEPT.                                        15070066
150800                                                                  15080066
150900                                                                  15090066
151000     EXEC SQL                                                     15100066
151100         SELECT COUNT(DISTINCT SKU_NBR)                           15110066
151200         INTO  :PV-SKU-COUNT                                      15120066
151300         FROM SUT_TRIP_DTL_SUM                                    15130066
151400        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          15140066
151500         AND   BUS_AREA_ID           = :SUT00095-BUS-AREA-ID      15150066
151600         AND   DEPT_NBR              = :SUT00095-DEPT-NBR         15160066
151700        WITH UR                                                   15170066
151800     END-EXEC.                                                    15180066
151900                                                                  15190066
152000                                                                  15200066
152100     EVALUATE TRUE                                                15210066
152200         WHEN SQLCODE = ZERO                                      15220066
152300              CONTINUE                                            15230066
152400         WHEN SQLWARN0 NOT = SPACE                                15240066
152500         WHEN SQLCODE  NOT = +0                                   15250066
152600              MOVE '8300-SELECT-SKU-CNT-DEPT'                     15260066
152700                                   TO PV-PARAGRAPH-NAME           15270066
152800              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  15280066
152900              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               15290066
153000              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              15300066
153100              PERFORM 9200-SQL-ABEND                              15310066
153200     END-EVALUATE.                                                15320066
153300                                                                  15330066
153400 8350-SELECT-CARTON-CNT-DEPT.                                     15340066
153500                                                                  15350066
153600     EXEC SQL                                                     15360066
153700         SELECT COUNT(DISTINCT SHIPT_UNT_ID)                      15370066
153800         INTO  :PV-CARTON-COUNT                                   15380066
153900         FROM SUT_TRIP_DTL_SUM                                    15390066
154000        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          15400066
154100         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       15410066
154200         AND   DEPT_NBR              = :PV-SAVE-DEPT-NBR          15420066
154300        WITH UR                                                   15430066
154400     END-EXEC.                                                    15440066
154500                                                                  15450066
154600     EVALUATE TRUE                                                15460066
154700         WHEN SQLCODE = ZERO                                      15470066
154800              CONTINUE                                            15480066
154900         WHEN SQLWARN0 NOT = SPACE                                15490066
155000         WHEN SQLCODE  NOT = +0                                   15500066
155100              MOVE '8350-SELECT-CARTON-CNT-DEPT'                  15510066
155200                                   TO PV-PARAGRAPH-NAME           15520066
155300              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  15530066
155400              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               15540066
155500              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              15550066
155600              PERFORM 9200-SQL-ABEND                              15560066
155700     END-EVALUATE.                                                15570066
155800                                                                  15580066
155900 8400-SELECT-SKU-CNT-BRND.                                        15590071
156000                                                                  15600066
156100     EXEC SQL                                                     15610066
156200         SELECT COUNT(DISTINCT SKU_NBR)                           15620066
156300         INTO  :PV-SKU-COUNT                                      15630066
156400         FROM SUT_TRIP_DTL_SUM                                    15640066
156500        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          15650066
156600         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       15660066
156700         AND   BRND_ID               = :PV-SAVE-BRND-ID           15670071
156800        WITH UR                                                   15680066
156900     END-EXEC.                                                    15690066
157000                                                                  15700066
157100     EVALUATE TRUE                                                15710066
157200         WHEN SQLCODE = ZERO                                      15720066
157300              CONTINUE                                            15730066
157400         WHEN SQLWARN0 NOT = SPACE                                15740066
157500         WHEN SQLCODE  NOT = +0                                   15750066
157600              MOVE '8400-SELECT-SKU-CNT-BRND'                     15760071
157700                                   TO PV-PARAGRAPH-NAME           15770066
157800              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  15780066
157900              MOVE PV-SAVE-BUS-AREA-ID                            15790066
158000                                   TO  PV-ITEM-NMBR               15800066
158100              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              15810066
158200              MOVE PV-SAVE-BRND-ID                                15820071
158300                                   TO  PV-ITEM-NMBR               15830066
158400              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-1            15840066
158500              PERFORM 9200-SQL-ABEND                              15850066
158600     END-EVALUATE.                                                15860066
158700                                                                  15870066
158800 8450-SELECT-CARTON-CNT-BRND.                                     15880071
158900                                                                  15890066
159000     EXEC SQL                                                     15900066
159100         SELECT COUNT(DISTINCT SHIPT_UNT_ID)                      15910066
159200         INTO  :PV-CARTON-COUNT                                   15920066
159300         FROM SUT_TRIP_DTL_SUM                                    15930066
159400        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          15940066
159500         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       15950066
159600         AND   BRND_ID               = :PV-SAVE-BRND-ID           15960071
159700        WITH UR                                                   15970066
159800     END-EXEC.                                                    15980066
159900                                                                  15990066
160000     EVALUATE TRUE                                                16000066
160100         WHEN SQLCODE = ZERO                                      16010066
160200              CONTINUE                                            16020066
160300         WHEN SQLWARN0 NOT = SPACE                                16030066
160400         WHEN SQLCODE  NOT = +0                                   16040066
160500              MOVE '8450-SELECT-CARTON-CNT-BRND'                  16050071
160600                                   TO PV-PARAGRAPH-NAME           16060066
160700              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  16070066
160800              MOVE PV-SAVE-BUS-AREA-ID                            16080066
160900                                   TO PV-ITEM-NMBR                16090066
161000              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              16100066
161100              MOVE PV-SAVE-BRND-ID                                16110071
161200                                   TO PV-ITEM-NMBR                16120066
161300              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-1            16130066
161400              PERFORM 9200-SQL-ABEND                              16140066
161500     END-EVALUATE.                                                16150066
161600                                                                  16160066
161700 8500-SELECT-SKU-CNT-BUS-GP.                                      16170066
161800                                                                  16180066
161900     EXEC SQL                                                     16190066
162000         SELECT COUNT(DISTINCT SKU_NBR)                           16200066
162100         INTO  :PV-SKU-COUNT                                      16210066
162200         FROM SUT_TRIP_DTL_SUM                                    16220066
162300        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          16230066
162400         AND   BUS_AREA_ID           = :SUT00095-BUS-AREA-ID      16240066
162500        WITH UR                                                   16250066
162600     END-EXEC.                                                    16260066
162700                                                                  16270066
162800     EVALUATE TRUE                                                16280066
162900         WHEN SQLCODE = ZERO                                      16290066
163000              CONTINUE                                            16300066
163100         WHEN SQLWARN0 NOT = SPACE                                16310066
163200         WHEN SQLCODE  NOT = +0                                   16320066
163300              MOVE '8500-SELECT-SKU-CNT-BUS-GP'                   16330066
163400                                   TO PV-PARAGRAPH-NAME           16340066
163500              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  16350066
163600              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               16360066
163700              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              16370066
163800              PERFORM 9200-SQL-ABEND                              16380066
163900     END-EVALUATE.                                                16390066
164000                                                                  16400066
164100 8550-SELECT-CARTON-CNT-BUS-GP.                                   16410066
164200                                                                  16420066
164300     EXEC SQL                                                     16430066
164400         SELECT COUNT(DISTINCT SHIPT_UNT_ID)                      16440066
164500         INTO  :PV-CARTON-COUNT                                   16450066
164600         FROM SUT_TRIP_DTL_SUM                                    16460066
164700        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          16470066
164800         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       16480066
164900        WITH UR                                                   16490066
165000     END-EXEC.                                                    16500066
165100                                                                  16510066
165200     EVALUATE TRUE                                                16520066
165300         WHEN SQLCODE = ZERO                                      16530066
165400              CONTINUE                                            16540066
165500         WHEN SQLWARN0 NOT = SPACE                                16550066
165600         WHEN SQLCODE  NOT = +0                                   16560066
165700              MOVE '8550-SELECT-CARTON-CNT-BUS-GP'                16570066
165800                                   TO PV-PARAGRAPH-NAME           16580066
165900              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  16590066
166000              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               16600066
166100              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              16610066
166200              PERFORM 9200-SQL-ABEND                              16620066
166300     END-EVALUATE.                                                16630066
166400                                                                  16640066
166500 8600-SUMM-TRIP-QTY-DOL.                                          16650066
166600     EXEC SQL                                                     16660066
166700         SELECT                                                   16670066
166800               SUM(UNT_QTY)                                       16680066
166900            ,  SUM(RTL_DOL_AMT)                                   16690066
167000            ,  SUM(COST_DOL_AMT)                                  16700066
167100         INTO                                                     16710066
167200               :PV-UNIT-QTY-SUM                                   16720066
167300            ,  :PV-RETAIL-SUM                                     16730066
167400            ,  :PV-COST-SUM                                       16740066
167500         FROM SUT_TRIP_DTL_SUM                                    16750066
167600        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          16760066
167700        WITH UR                                                   16770066
167800     END-EXEC.                                                    16780066
167900                                                                  16790066
168000                                                                  16800066
168100     EVALUATE TRUE                                                16810066
168200         WHEN SQLCODE = ZERO                                      16820066
168300              CONTINUE                                            16830066
168400         WHEN SQLCODE = -305                                      16840066
168500             MOVE ZERO             TO PV-UNIT-QTY-SUM             16850066
168600                                      PV-RETAIL-SUM               16860066
168700                                      PV-COST-SUM                 16870066
168800              CONTINUE                                            16880066
168900         WHEN SQLWARN0 NOT = SPACE                                16890066
169000         WHEN SQLCODE  NOT = +0                                   16900066
169100* DMH 1/25/05 - BEGIN                                             16910066
169200     MOVE SPACES                     TO PV-CICS-MSG-AREA          16920066
169300     MOVE DK-OTBND-TRIP-ID           TO PV-DISP-TRIP              16930066
169400     MOVE SQLCODE                    TO PV-DISP-SQLCODE           16940066
169500     STRING ' SUKUT574 - '                                        16950069
169600            '8600-SUMM-TRIP-QTY-DOL - '                           16960066
169700                                             DELIMITED BY SIZE    16970066
169800                                        INTO PV-CICS-MSG-AREA     16980066
169900     PERFORM 9997-CSSL                                            16990066
170000     MOVE SPACES                     TO PV-CICS-MSG-AREA          17000066
170100     STRING ' SUKUT574 - '                                        17010069
170200            'TRIP=' PV-DISP-TRIP                                  17020066
170300            '  SQLCODE= ' PV-DISP-SQLCODE                         17030066
170400            '  TMST='  PV-CURRENT-TIMESTAMP                       17040066
170500                                             DELIMITED BY SIZE    17050066
170600                                        INTO PV-CICS-MSG-AREA     17060066
170700     PERFORM 9997-CSSL                                            17070066
170800* DMH 1/25/05 - END                                               17080066
170900              MOVE '8600-SUMM-TRIP-QTY-DOL'                       17090066
171000                                   TO PV-PARAGRAPH-NAME           17100066
171100              MOVE 'SUM SUT_WRK_SUM' TO PV-DB2-OPERATION-ATTEMPTED17110066
171200              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               17120066
171300              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              17130066
171400              PERFORM 9200-SQL-ABEND                              17140066
171500     END-EVALUATE.                                                17150066
171600                                                                  17160066
171700 8700-SELECT-SKU-CNT-TRIP.                                        17170066
171800                                                                  17180066
171900     EXEC SQL                                                     17190066
172000         SELECT COUNT(DISTINCT SKU_NBR)                           17200066
172100         INTO  :PV-SKU-COUNT                                      17210066
172200         FROM SUT_TRIP_DTL_SUM                                    17220066
172300        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          17230066
172400        WITH UR                                                   17240066
172500     END-EXEC.                                                    17250066
172600                                                                  17260066
172700                                                                  17270066
172800     EVALUATE TRUE                                                17280066
172900         WHEN SQLCODE = ZERO                                      17290066
173000              CONTINUE                                            17300066
173100         WHEN SQLCODE = -304                                      17310066
173200              MOVE 9999  TO  PV-SKU-COUNT                         17320066
173300         WHEN SQLWARN0 NOT = SPACE                                17330066
173400         WHEN SQLCODE  NOT = +0                                   17340066
173500              MOVE '8700-SELECT-SKU-CNT-TRIP'                     17350066
173600                                   TO PV-PARAGRAPH-NAME           17360066
173700              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  17370066
173800              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               17380066
173900              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              17390066
174000              PERFORM 9200-SQL-ABEND                              17400066
174100     END-EVALUATE.                                                17410066
174200                                                                  17420066
174300 8750-SELECT-CARTON-CNT-TRIP.                                     17430066
174400                                                                  17440066
174500     EXEC SQL                                                     17450066
174600         SELECT COUNT(DISTINCT SHIPT_UNT_ID)                      17460066
174700         INTO  :PV-CARTON-COUNT                                   17470066
174800         FROM SUT_TRIP_DTL_SUM                                    17480066
174900        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          17490066
175000        WITH UR                                                   17500066
175100     END-EXEC.                                                    17510066
175200                                                                  17520066
175300     EVALUATE TRUE                                                17530066
175400         WHEN SQLCODE = ZERO                                      17540066
175500              CONTINUE                                            17550066
175600         WHEN SQLWARN0 NOT = SPACE                                17560066
175700         WHEN SQLCODE  NOT = +0                                   17570066
175800              MOVE '8750-SELECT-CARTON-CNT-TRIP'                  17580066
175900                                   TO PV-PARAGRAPH-NAME           17590066
176000              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  17600066
176100              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               17610066
176200              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              17620066
176300              PERFORM 9200-SQL-ABEND                              17630066
176400     END-EVALUATE.                                                17640066
176500                                                                  17650066
176600*8800-INSERT-SUT00010.                                            17660066
176700                                                                  17670066
176800*    EXEC SQL                                                     17680066
176900*         INSERT INTO SUT_MAJ_CL_SUM                              17690066
177000*                (TRIP_OCRNC_ID                                   17700066
177100*              ,  BUS_AREA_ID                                     17710066
177200*              ,  DEPT_NBR                                        17720066
177300*              ,  MAJ_CL_NBR                                      17730066
177400*              ,  UNT_QTY                                         17740066
177500*              ,  SKU_QTY                                         17750066
177600*              ,  CART_QTY                                        17760066
177700*              ,  RTL_DOL_AMT                                     17770066
177800*              ,  COST_DOL_AMT)                                   17780066
177900*         VALUES (                                                17790066
178000*                :SUT00010-TRIP-OCRNC-ID                          17800066
178100*             ,  :SUT00010-BUS-AREA-ID                            17810066
178200*             ,  :SUT00010-DEPT-NBR                               17820066
178300*             ,  :SUT00010-MAJ-CL-NBR                             17830066
178400*             ,  :SUT00010-UNT-QTY                                17840066
178500*             ,  :SUT00010-SKU-QTY                                17850066
178600*             ,  :SUT00010-CART-QTY                               17860066
178700*             ,  :SUT00010-RTL-DOL-AMT                            17870066
178800*             ,  :SUT00010-COST-DOL-AMT)                          17880066
178900*    END-EXEC.                                                    17890066
179000*                                                                 17900066
179100*    EVALUATE TRUE                                                17910066
179200*        WHEN SQLCODE = +0                                        17920066
179300*             CONTINUE                                            17930066
179400*                                                                 17940066
179500*        WHEN SQLWARN0 NOT = SPACES                               17950066
179600*        WHEN SQLCODE < +0                                        17960066
179700*        WHEN SQLCODE > +0                                        17970066
179800*            MOVE '8800-INSERT-SUT00010'                          17980066
179900*                                 TO PV-PARAGRAPH-NAME            17990066
180000*            MOVE 'INSERT SUT_MAJ_CL_SUM'                         18000066
180100*                              TO PV-DB2-OPERATION-ATTEMPTED      18010066
180200*            MOVE SUT00010-TRIP-OCRNC-ID  TO PV-FIELD-VALUE       18020066
180300*            MOVE SUT00010-BUS-AREA-ID TO PV-FIELD-VALUE-1        18030066
180400*            MOVE SUT00010-DEPT-NBR    TO PV-FIELD-VALUE-2        18040066
180500*            MOVE SQLCODE      TO PV-DISP-SQLCODE                 18050066
180600*            PERFORM 9200-SQL-ABEND                               18060066
180700*    END-EVALUATE.                                                18070066
180800*                                                                 18080066
180900*8820-INSERT-SUT00009.                                            18090066
181000*                                                                 18100066
181100*    EXEC SQL                                                     18110066
181200*         INSERT INTO SUT_DEPT_SUM                                18120066
181300*                (TRIP_OCRNC_ID                                   18130066
181400*              ,  BUS_AREA_ID                                     18140066
181500*              ,  DEPT_NBR                                        18150066
181600*              ,  UNT_QTY                                         18160066
181700*              ,  SKU_QTY                                         18170066
181800*              ,  CART_QTY                                        18180066
181900*              ,  RTL_DOL_AMT                                     18190066
182000*              ,  COST_DOL_AMT)                                   18200066
182100*         VALUES (                                                18210066
182200*                :SUT00009-TRIP-OCRNC-ID                          18220066
182300*             ,  :SUT00009-BUS-AREA-ID                            18230066
182400*             ,  :SUT00009-DEPT-NBR                               18240066
182500*             ,  :SUT00009-UNT-QTY                                18250066
182600*             ,  :SUT00009-SKU-QTY                                18260066
182700*             ,  :SUT00009-CART-QTY                               18270066
182800*             ,  :SUT00009-RTL-DOL-AMT                            18280066
182900*             ,  :SUT00009-COST-DOL-AMT)                          18290066
183000*    END-EXEC.                                                    18300066
183100*                                                                 18310066
183200*    EVALUATE TRUE                                                18320066
183300*        WHEN SQLCODE = +0                                        18330066
183400*             CONTINUE                                            18340066
183500*                                                                 18350066
183600*        WHEN SQLWARN0 NOT = SPACES                               18360066
183700*        WHEN SQLCODE < +0                                        18370066
183800*        WHEN SQLCODE > +0                                        18380066
183900*            MOVE '8820-INSERT-SUT00009'                          18390066
184000*                                 TO PV-PARAGRAPH-NAME            18400066
184100*            MOVE 'INSERT SUT_DEPT_SUM'                           18410066
184200*                              TO PV-DB2-OPERATION-ATTEMPTED      18420066
184300*            MOVE SQLCODE            TO PV-DISP-SQLCODE           18430066
184400*            PERFORM 9200-SQL-ABEND                               18440066
184500*    END-EVALUATE.                                                18450066
184600*                                                                 18460066
184700*8825-UPDATE-SUT00009.                                            18470066
184800*                                                                 18480066
184900*    EXEC SQL                                                     18490066
185000*         UPDATE SUT_DEPT_SUM                                     18500066
185100*            SET  UNT_QTY         = :SUT00009-UNT-QTY             18510066
185200*              ,  SKU_QTY         = :SUT00009-SKU-QTY             18520066
185300*              ,  CART_QTY        = :SUT00009-CART-QTY            18530066
185400*              ,  RTL_DOL_AMT     = :SUT00009-RTL-DOL-AMT         18540066
185500*              ,  COST_DOL_AMT    = :SUT00009-COST-DOL-AMT        18550066
185600*          WHERE  TRIP_OCRNC_ID = :SUT00009-TRIP-OCRNC-ID         18560066
185700*            AND  BUS_AREA_ID   = :SUT00009-BUS-AREA-ID           18570066
185800*            AND  DEPT_NBR      = :SUT00009-DEPT-NBR              18580066
185900*    END-EXEC.                                                    18590066
186000*                                                                 18600066
186100*    EVALUATE TRUE                                                18610066
186200*        WHEN SQLCODE = +0                                        18620066
186300*             CONTINUE                                            18630066
186400*                                                                 18640066
186500*        WHEN SQLWARN0 NOT = SPACES                               18650066
186600*        WHEN SQLCODE < +0                                        18660066
186700*        WHEN SQLCODE > +0                                        18670066
186800*            MOVE '8825-UPDATE-SUT00009'                          18680066
186900*                                 TO PV-PARAGRAPH-NAME            18690066
187000*            MOVE 'UPDATE SUT_DEPT_SUM'                           18700066
187100*                              TO PV-DB2-OPERATION-ATTEMPTED      18710066
187200*            MOVE SQLCODE            TO PV-DISP-SQLCODE           18720066
187300*            PERFORM 9200-SQL-ABEND                               18730066
187400*    END-EVALUATE.                                                18740066
187500*                                                                 18750066
187600*8840-INSERT-SUT00008.                                            18760066
187700*                                                                 18770066
187800*    EXEC SQL                                                     18780066
187900*         INSERT INTO SUT_BUS_AREA_SUM                            18790066
188000*                (TRIP_OCRNC_ID                                   18800066
188100*              ,  BUS_AREA_ID                                     18810066
188200*              ,  UNT_QTY                                         18820066
188300*              ,  SKU_QTY                                         18830066
188400*              ,  CART_QTY                                        18840066
188500*              ,  RTL_DOL_AMT                                     18850066
188600*              ,  COST_DOL_AMT)                                   18860066
188700*         VALUES (                                                18870066
188800*                :SUT00008-TRIP-OCRNC-ID                          18880066
188900*             ,  :SUT00008-BUS-AREA-ID                            18890066
189000*             ,  :SUT00008-UNT-QTY                                18900066
189100*             ,  :SUT00008-SKU-QTY                                18910066
189200*             ,  :SUT00008-CART-QTY                               18920066
189300*             ,  :SUT00008-RTL-DOL-AMT                            18930066
189400*             ,  :SUT00008-COST-DOL-AMT)                          18940066
189500*    END-EXEC.                                                    18950066
189600*                                                                 18960066
189700*    EVALUATE TRUE                                                18970066
189800*        WHEN SQLCODE = +0                                        18980066
189900*             CONTINUE                                            18990066
190000*                                                                 19000066
190100*        WHEN SQLWARN0 NOT = SPACES                               19010066
190200*        WHEN SQLCODE < +0                                        19020066
190300*        WHEN SQLCODE > +0                                        19030066
190400*            MOVE '8840-INSERT-SUT00008'                          19040066
190500*                                 TO PV-PARAGRAPH-NAME            19050066
190600*            MOVE 'INSERT SUT_BUS_AREA_SUM'                       19060066
190700*                              TO PV-DB2-OPERATION-ATTEMPTED      19070066
190800*            MOVE SQLCODE            TO PV-DISP-SQLCODE           19080066
190900*            PERFORM 9200-SQL-ABEND                               19090066
191000*    END-EVALUATE.                                                19100066
191100*                                                                 19110066
191200*8845-UPDATE-SUT00008.                                            19120066
191300*                                                                 19130066
191400*    EXEC SQL                                                     19140066
191500*         UPDATE SUT_BUS_AREA_SUM                                 19150066
191600*            SET  UNT_QTY          = :SUT00008-UNT-QTY            19160066
191700*              ,  SKU_QTY          = :SUT00008-SKU-QTY            19170066
191800*              ,  CART_QTY         = :SUT00008-CART-QTY           19180066
191900*              ,  RTL_DOL_AMT      = :SUT00008-RTL-DOL-AMT        19190066
192000*              ,  COST_DOL_AMT     = :SUT00008-COST-DOL-AMT       19200066
192100*          WHERE  TRIP_OCRNC_ID    = :SUT00008-TRIP-OCRNC-ID      19210066
192200*            AND  BUS_AREA_ID      = :SUT00008-BUS-AREA-ID        19220066
192300*    END-EXEC.                                                    19230066
192400*                                                                 19240066
192500*    EVALUATE TRUE                                                19250066
192600*        WHEN SQLCODE = +0                                        19260066
192700*             CONTINUE                                            19270066
192800*                                                                 19280066
192900*        WHEN SQLWARN0 NOT = SPACES                               19290066
193000*        WHEN SQLCODE < +0                                        19300066
193100*        WHEN SQLCODE > +0                                        19310066
193200*            MOVE '8845-UPDATE-SUT00008'                          19320066
193300*                                 TO PV-PARAGRAPH-NAME            19330066
193400*            MOVE 'UPDATE SUT_BUS_AREA_SUM'                       19340066
193500*                              TO PV-DB2-OPERATION-ATTEMPTED      19350066
193600*            MOVE SQLCODE            TO PV-DISP-SQLCODE           19360066
193700*            PERFORM 9200-SQL-ABEND                               19370066
193800*    END-EVALUATE.                                                19380066
193900*                                                                 19390066
194000*8860-INSERT-SUT00007.                                            19400066
194100*                                                                 19410066
194200*    EXEC SQL                                                     19420066
194300*         INSERT INTO SUT_TRIP_SUM                                19430066
194400*                (TRIP_OCRNC_ID                                   19440066
194500*              ,  OTBND_TRIP_ID                                   19450066
194600*              ,  CRE_TMST                                        19460066
194700*              ,  UNT_QTY                                         19470066
194800*              ,  SKU_QTY                                         19480066
194900*              ,  CART_QTY                                        19490066
195000*              ,  RTL_DOL_AMT                                     19500066
195100*              ,  COST_DOL_AMT)                                   19510066
195200*         VALUES (                                                19520066
195300*                :SUT00007-TRIP-OCRNC-ID                          19530066
195400*             ,  :SUT00007-OTBND-TRIP-ID                          19540066
195500*             ,  :PV-CURRENT-TIMESTAMP                            19550066
195600*             ,  :SUT00007-UNT-QTY                                19560066
195700*             ,  :SUT00007-SKU-QTY                                19570066
195800*             ,  :SUT00007-CART-QTY                               19580066
195900*             ,  :SUT00007-RTL-DOL-AMT                            19590066
196000*             ,  :SUT00007-COST-DOL-AMT)                          19600066
196100*    END-EXEC.                                                    19610066
196200*                                                                 19620066
196300*    EVALUATE TRUE                                                19630066
196400*        WHEN SQLCODE = +0                                        19640066
196500*             SET PS-INSERT-DONE      TO TRUE                     19650066
196600*                                                                 19660066
196700*        WHEN SQLCODE = -803                                      19670066
196800*             SET PS-NO-INSERT-DONE   TO TRUE                     19680066
196900*             PERFORM 5000-CREATE-TRIP-OCCURENCE-ID               19690066
197000*             MOVE DK-TRIP-OCRNC-ID TO SUT00007-TRIP-OCRNC-ID     19700066
197100*                                                                 19710066
197200*        WHEN SQLWARN0 NOT = SPACES                               19720066
197300*        WHEN SQLCODE < +0                                        19730066
197400*        WHEN SQLCODE > +0                                        19740066
197500*            MOVE '8860-INSERT-SUT00007'                          19750066
197600*                                 TO PV-PARAGRAPH-NAME            19760066
197700*            MOVE 'INSERT SUT_TRIP_SUM'                           19770066
197800*                              TO PV-DB2-OPERATION-ATTEMPTED      19780066
197900*            MOVE SQLCODE            TO PV-DISP-SQLCODE           19790066
198000*            PERFORM 9200-SQL-ABEND                               19800066
198100*    END-EVALUATE.                                                19810066
198200*                                                                 19820066
198300*8870-UPDATE-SUT00007.                                            19830066
198400*                                                                 19840066
198500*    EXEC SQL                                                     19850066
198600*         UPDATE  SUT_TRIP_SUM                                    19860066
198700*            SET  UNT_QTY         = :SUT00007-UNT-QTY             19870066
198800*              ,  SKU_QTY         = :SUT00007-SKU-QTY             19880066
198900*              ,  CART_QTY        = :SUT00007-CART-QTY            19890066
199000*              ,  RTL_DOL_AMT     = :SUT00007-RTL-DOL-AMT         19900066
199100*              ,  COST_DOL_AMT    = :SUT00007-COST-DOL-AMT        19910066
199200*          WHERE TRIP_OCRNC_ID    = :SUT00007-TRIP-OCRNC-ID       19920066
199300*            AND OTBND_TRIP_ID    = :SUT00007-OTBND-TRIP-ID       19930066
199400*    END-EXEC.                                                    19940066
199500*                                                                 19950066
199600*    EVALUATE TRUE                                                19960066
199700*        WHEN SQLCODE = +0                                        19970066
199800*             CONTINUE                                            19980066
199900*                                                                 19990066
200000*        WHEN SQLWARN0 NOT = SPACES                               20000066
200100*        WHEN SQLCODE < +0                                        20010066
200200*        WHEN SQLCODE > +0                                        20020066
200300*            MOVE '8870-UPDATE-SUT00007'                          20030066
200400*                                 TO PV-PARAGRAPH-NAME            20040066
200500*            MOVE 'UPDATE SUT_TRIP_SUM'                           20050066
200600*                              TO PV-DB2-OPERATION-ATTEMPTED      20060066
200700*            MOVE SQLCODE            TO PV-DISP-SQLCODE           20070066
200800*            PERFORM 9200-SQL-ABEND                               20080066
200900*    END-EVALUATE.                                                20090066
201000*                                                                 20100066
201100*8880-INSERT-SUT00011.                                            20110066
201200*                                                                 20120066
201300*    EXEC SQL                                                     20130066
201400*         INSERT INTO SUT_MAJ_CL_AD_DTE                           20140066
201500*                (TRIP_OCRNC_ID                                   20150066
201600*              ,  BUS_AREA_ID                                     20160066
201700*              ,  DEPT_NBR                                        20170066
201800*              ,  MAJ_CL_NBR                                      20180066
201900*              ,  AD_EVNT_DTE)                                    20190066
202000*         VALUES (                                                20200066
202100*                :SUT00011-TRIP-OCRNC-ID                          20210066
202200*             ,  :SUT00011-BUS-AREA-ID                            20220066
202300*             ,  :SUT00011-DEPT-NBR                               20230066
202400*             ,  :SUT00011-MAJ-CL-NBR                             20240066
202500*             ,  :SUT00011-AD-EVNT-DTE)                           20250066
202600*    END-EXEC.                                                    20260066
202700*                                                                 20270066
202800*    EVALUATE TRUE                                                20280066
202900*        WHEN SQLCODE = +0                                        20290066
203000*             CONTINUE                                            20300066
203100*                                                                 20310066
203200*        WHEN SQLWARN0 NOT = SPACES                               20320066
203300*        WHEN SQLCODE < +0                                        20330066
203400*        WHEN SQLCODE > +0                                        20340066
203500*            MOVE '8880-INSERT-SUT00011'                          20350066
203600*                                 TO PV-PARAGRAPH-NAME            20360066
203700*            MOVE 'INSERT SUT_MAJ_CL_AD_DTE'                      20370066
203800*                              TO PV-DB2-OPERATION-ATTEMPTED      20380066
203900*            MOVE SQLCODE            TO PV-DISP-SQLCODE           20390066
204000*            PERFORM 9200-SQL-ABEND                               20400066
204100*    END-EVALUATE.                                                20410066
204200*                                                                 20420066
204300*8890-INSERT-SUT00096.                                            20430066
204400*                                                                 20440066
204500*    EXEC SQL                                                     20450066
204600*         INSERT INTO SUT_PGM_MDSE_SUM                            20460066
204700*                (BUS_AREA_ID                                     20470066
204800*              ,  TRIP_OCRNC_ID                                   20480066
204900*              ,  MDSE_PGM_ID                                     20490066
205000*              ,  UNT_QTY                                         20500066
205100*              ,  SKU_QTY                                         20510066
205200*              ,  CART_QTY                                        20520066
205300*              ,  RTL_DOL_AMT                                     20530066
205400*              ,  COST_DOL_AMT)                                   20540066
205500*         VALUES (                                                20550066
205600*                :SUT00096-BUS-AREA-ID                            20560066
205700*             ,  :SUT00096-TRIP-OCRNC-ID                          20570066
205800*             ,  :SUT00096-MDSE-PGM-ID                            20580066
205900*             ,  :SUT00096-UNT-QTY                                20590066
206000*             ,  :SUT00096-SKU-QTY                                20600066
206100*             ,  :SUT00096-CART-QTY                               20610066
206200*             ,  :SUT00096-RTL-DOL-AMT                            20620066
206300*             ,  :SUT00096-COST-DOL-AMT)                          20630066
206400*    END-EXEC.                                                    20640066
206500*                                                                 20650066
206600*    EVALUATE TRUE                                                20660066
206700*        WHEN SQLCODE = +0                                        20670066
206800*             CONTINUE                                            20680066
206900*                                                                 20690066
207000*        WHEN SQLWARN0 NOT = SPACES                               20700066
207100*        WHEN SQLCODE < +0                                        20710066
207200*        WHEN SQLCODE > +0                                        20720066
207300*            MOVE '8890-INSERT-SUT00096'                          20730066
207400*                                 TO PV-PARAGRAPH-NAME            20740066
207500*            MOVE 'INSERT SUT_PGM_MDSE_SUM'                       20750066
207600*                              TO PV-DB2-OPERATION-ATTEMPTED      20760066
207700*            MOVE SQLCODE            TO PV-DISP-SQLCODE           20770066
207800*            PERFORM 9200-SQL-ABEND                               20780066
207900*    END-EVALUATE.                                                20790066
208000*                                                                 20800066
210900                                                                  21090066
211000 8900-SELECT-CURRENT-TMST.                                        21100066
211100                                                                  21110066
211200     EXEC SQL                                                     21120066
211300         SELECT DISTINCT CURRENT TIMESTAMP                        21130066
211400           INTO :PV-CURRENT-TIMESTAMP                             21140066
211500         FROM  SYSIBM.SYSDUMMY1                                   21150066
211600     END-EXEC.                                                    21160066
211700                                                                  21170066
211800     EVALUATE TRUE                                                21180066
211900         WHEN SQLCODE = ZEROS                                     21190066
212000              CONTINUE                                            21200066
212100                                                                  21210066
212200         WHEN OTHER                                               21220066
212300              MOVE '8900-SELECT-CURRENT-TMST'                     21230066
212400                                   TO PV-PARAGRAPH-NAME           21240066
212500              MOVE 'SELECT CURRENT TIMESTAMP'                     21250066
212600                                   TO PV-DB2-OPERATION-ATTEMPTED  21260066
212700              MOVE SQLCODE            TO PV-DISP-SQLCODE          21270066
212800              PERFORM 9200-SQL-ABEND                              21280066
212900     END-EVALUATE.                                                21290066
213000                                                                  21300066
213100 8950-SELECT-CURRENT-DATE.                                        21310066
213200      EXEC SQL                                                    21320066
213300        SET :PV-CURRENT-DATE = CURRENT DATE                       21330066
213400      END-EXEC.                                                   21340066
213500                                                                  21350066
213600     EVALUATE TRUE                                                21360066
213700         WHEN SQLCODE = ZERO                                      21370066
213800             CONTINUE                                             21380066
213900                                                                  21390066
214000         WHEN SQLWARN0 NOT EQUAL SPACE                            21400066
214100         WHEN SQLCODE NOT EQUAL ZERO                              21410066
214200             DISPLAY '**************************************'     21420066
214300             DISPLAY '** ABEND                            **'     21430066
214400             DISPLAY '** PROGRAM = SUKUT574               **'     21440066
214500             DISPLAY '** PARAGRAPH = 8950-SELECT-CURRENT-DATE'    21450066
214600             DISPLAY '** GET DB2 CURRENT DATE             **'     21460066
214700             DISPLAY '**************************************'     21470066
214800             PERFORM 9200-SQL-ABEND                               21480066
214900     END-EVALUATE.                                                21490066
215000                                                                  21500066
215100 9000-FINIS.                                                      21510066
215200     PERFORM 9998-RETURN.                                         21520066
215300                                                                  21530066
215400                                                                  21540066
215500 9200-SQL-ABEND.                                                  21550066
215600******************************************************************21560066
215700*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    21570066
215800*  ERROR OR WARNING CODE OCCURS.                                  21580066
215900******************************************************************21590066
216000                                                                  21600066
216100     MOVE SPACES                     TO PV-CICS-MSG-AREA.         21610066
216200     STRING ' SUKUT574 - '           DELIMITED BY SIZE            21620069
216300            PV-PARAGRAPH-NAME        DELIMITED BY SIZE            21630066
216400                                        INTO PV-CICS-MSG-AREA.    21640066
216500     PERFORM 9997-CSSL.                                           21650066
216600     MOVE SPACES                     TO PV-CICS-MSG-AREA.         21660066
216700     STRING ' SUKUT574 - '           DELIMITED BY SIZE            21670069
216800          PV-DB2-OPERATION-ATTEMPTED DELIMITED BY SIZE            21680066
216900          ' '                        DELIMITED BY SIZE            21690066
217000          PV-FIELD-VALUE             DELIMITED BY SIZE            21700066
217100          ' '                        DELIMITED BY SIZE            21710066
217200          PV-FIELD-VALUE-1           DELIMITED BY SIZE            21720066
217300          ' '                        DELIMITED BY SIZE            21730066
217400          PV-FIELD-VALUE-2           DELIMITED BY SIZE            21740066
217500          ' '                        DELIMITED BY SIZE            21750066
217600          PV-DISP-SQLCODE            DELIMITED BY SIZE            21760066
217700                                        INTO PV-CICS-MSG-AREA.    21770066
217800     PERFORM 9997-CSSL.                                           21780066
217900                                                                  21790066
218000     MOVE +4013                  TO ABEND-CODE.                   21800066
218100     CALL 'ILBOABN0' USING ABEND-CODE.                            21810066
218200                                                                  21820066
218300******************************************************************21830066
218400* DISPLAY MESSAGE IN CICS MESSAGE LOG                             21840066
218500******************************************************************21850066
218600 9997-CSSL.                                                       21860066
218700     DISPLAY 'CICS MSG AREA:  '  PV-CICS-MSG-AREA.                21870066
218800                                                                  21880066
218900*    EXEC CICS                                                    21890066
219000*         WRITEQ TD                                               21900066
219100*          QUEUE   ('CSSL')                                       21910066
219200*           FROM   (PV-CICS-MSG-AREA)                             21920066
219300*         LENGTH   (80)                                           21930066
219400*           RESP   (PV-CICS-RESP)                                 21940066
219500*    END-EXEC.                                                    21950066
219600                                                                  21960066
219700******************************************************************21970066
219800*                                                                 21980066
219900******************************************************************21990066
220000 9998-RETURN.                                                     22000066
220100                                                                  22010066
220200     PERFORM 8950-SELECT-CURRENT-DATE.                            22020066
220300     MOVE 'ENDED'                     TO PV-LOG-PARA              22030066
220400                                                                  22040066
220500     PERFORM 9999-WRITE-TO-CSSL                                   22050066
220600*    MOVE PC047-COMMAREA                TO DFHCOMMAREA.           22060066
220700                                                                  22070066
220800*    IF PV-STARTCODE = 'TD'                                       22080066
220900*        EXEC CICS                                                22090066
221000*             RETURN                                              22100066
221100*        END-EXEC                                                 22110066
221200*    ELSE                                                         22120066
221300*        GOBACK                                                   22130066
221400*    END-IF.                                                      22140066
221500                                                                  22150066
221600         GOBACK.                                                  22160066
221700                                                                  22170066
221800******************************************************************22180066
221900*                                                                 22190066
222000******************************************************************22200066
222100 9999-WRITE-TO-CSSL.                                              22210066
222200                                                                  22220066
222300*    MOVE EIBTASKN                    TO PV-LOG-TASK              22230066
222400     MOVE PV-CURRENT-TIMESTAMP (12:8) TO PV-TIME-PARM             22240066
222500**   MOVE PC047-CALLING-PROGRAM       TO PV-LOG-CALLING-PGM       22250066
222600     MOVE 'SUKUT574'                  TO PV-LOG-CALLING-PGM       22260066
222700**   MOVE PC047-OTBND-TRIP-ID         TO PV-LOG-TRIP              22270066
222800     MOVE PV-SU-TRIP-NBR              TO PV-LOG-TRIP              22280066
222900     MOVE PV-USERID                   TO PV-LOG-TEXT              22290066
223000     MOVE SQLCODE                     TO PV-LOG-SQLCODE           22300066
223100     IF PV-LOG-PARA =  'ENDED' OR                                 22310066
223200        PV-LOG-PARA =  'START'                                    22320066
223300         CONTINUE                                                 22330066
223400     ELSE                                                         22340066
223500         MOVE PC047-PARAGRAPH         TO PV-LOG-PARA              22350066
223600     END-IF                                                       22360066
223700                                                                  22370066
223800*    EXEC CICS                                                    22380066
223900*         WRITEQ TD                                               22390066
224000*          QUEUE   ('CSSL')                                       22400066
224100*           FROM   (PV-LOG-MSG)                                   22410066
224200*         LENGTH   (100)                                          22420066
224300*           RESP   (PV-CICS-RESP)                                 22430066
224400*    END-EXEC.                                                    22440066
224500                                                                  22450066
224600                                                                  22460066
224700     DISPLAY 'LOG  MSG:  '  PV-LOG-MSG.                           22470066
224800                                                                  22480066
224900                                                                  22490066
225000***************************************************************** 22500066
225100* PCPD049 - PROCEDURE DIVISION USED TO DETERMINE TRAILER CONTENTS 22510066
225200     COPY PCPD049.                                                22520066
