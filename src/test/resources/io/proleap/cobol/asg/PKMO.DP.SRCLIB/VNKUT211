000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     VNKUT211.                                        00020001
000300 AUTHOR.         MIKE BESKE.                                      00030001
000400 DATE-WRITTEN.   JUNE 2007.                                       00040001
000500*************************************************************     00050000
000600*    COBOL 2 WITH DB2 SQL                                   *     00060001
000700*                                                           *     00070001
000700*  VENDOR LEGACY CODE EXTRACT FOR EDW SYSTEM                *     00080040
000700*                                                           *     00090040
000800*  THE PURPOSE OF THIS PROGRAM IS TO PRODUCE MANY CODE FILES*     00100021
000900*  CONTAINING INFORMATION FROM THE VENDOR LEGACY SYSTEM FOR *     00110001
001000*  DATA WAREHOUSE EDW TABLES.                               *     00120021
001100*                                                           *     00130006
001200*************************************************************     00140000
001300*                                                           *     00150000
001400* DB2 TABLES:                                               *     00160000
001500*  1. VENDOR CAPABILITIES CODE TABLE            (VNT00003)  *     00170005
001600*  2. VENDOR PAYMENT TERMS TABLE                (TPAYTRM)   *     00180026
001700*  3. VENDOR FREIGHT TERMS TABLE                (TFRGTRM)   *     00190026
001800*                                                           *     00200005
001900* OUTPUT:                                                   *     00210000
002000*  1. CAPABILITIES CODE EXTRACT FILE            (VNRD206)   *     00220009
002100*  2. POSTING FREQUENCY CODE FILE               (VNRD200)   *     00230009
002200*  3. PROGRAM TYPE CODE FILE                    (VNRD201)   *     00240013
002300*  4. INCENTIVE TYPE CODE FILE                  (VNRD202)   *     00250013
002400*  5. CHARGE FACTOR CODE FILE                   (VNRD203)   *     00260013
002500*  6. AGREEMENT TYPE CODE FILE                  (VNRD204)   *     00270013
002600*  7. DC MERCHANDISE RETURN TYPE CODE FILE      (VNRD205)   *     00280013
002700*  8. EXENT ROLE CODE FILE                      (VNRD207)   *     00290013
002800*  9. PAYMENT TERMS FILE                        (VNRD208)   *     00300027
002900* 10. FREIGHT TERMS FILE                        (VNRD209)   *     00310028
003000*                                                           *     00320005
003100*************************************************************     00330005
003200* CHANGE LOG:                                               *     00340005
003300*                                                           *     00350005
003400* DATE  06/26/2007                                          *     00360005
003500*     CHANGE MADE: INITIAL IMPLEMENTATION.                  *     00370005
003600*     MADE BY: MIKE BESKE              WR/IR #: WR31780     *     00380005
003700*************************************************************     00390005
003800                                                                  00400005
003900 ENVIRONMENT DIVISION.                                            00410005
004000                                                                  00420005
004100 INPUT-OUTPUT SECTION.                                            00430005
004200                                                                  00440005
004300 FILE-CONTROL.                                                    00450005
004400     SELECT CPBL-CD-EXTRCT-FILE      ASSIGN TO OUT01.             00460006
004500     SELECT PSTG-FRQ-CD-FILE         ASSIGN TO OUT02.             00470006
004600     SELECT PGM-TYP-CD-FILE          ASSIGN TO OUT03.             00480013
004700     SELECT INCTV-TYP-CD-FILE        ASSIGN TO OUT04.             00490013
004800     SELECT CHRG-FCTR-CD-FILE        ASSIGN TO OUT05.             00500013
004900     SELECT AGRMT-TYP-CD-FILE        ASSIGN TO OUT06.             00510013
005000     SELECT MDSE-RET-TYP-CD-FILE     ASSIGN TO OUT07.             00520013
005100     SELECT EXENT-ROL-CD-FILE        ASSIGN TO OUT08.             00530013
005200     SELECT PAYMENT-TERM-FILE        ASSIGN TO OUT09.             00540028
005300     SELECT FREIGHT-TERM-FILE        ASSIGN TO OUT10.             00550028
005400                                                                  00560005
005500 DATA DIVISION.                                                   00570005
005600                                                                  00580005
005700 FILE SECTION.                                                    00590005
005800 FD  CPBL-CD-EXTRCT-FILE                                          00600006
005900     RECORDING MODE IS F                                          00610005
006000     LABEL RECORDS ARE STANDARD                                   00620005
006100     DATA RECORD IS CPBL-CD-EXTRCT-REC.                           00630006
006200 01  CPBL-CD-EXTRCT-REC      PIC  X(068).                         00640006
006300                                                                  00650005
006400 FD  PSTG-FRQ-CD-FILE                                             00660006
006500     RECORDING MODE IS F                                          00670005
006600     LABEL RECORDS ARE STANDARD                                   00680005
006700     DATA RECORD IS PSTG-FRQ-CD-REC.                              00690006
006800 01  PSTG-FRQ-CD-REC         PIC  X(032).                         00700006
006900                                                                  00710005
007000 FD  PGM-TYP-CD-FILE                                              00720013
007100     RECORDING MODE IS F                                          00730013
007200     LABEL RECORDS ARE STANDARD                                   00740013
007300     DATA RECORD IS PGM-TYP-CD-REC.                               00750013
007400 01  PGM-TYP-CD-REC          PIC  X(036).                         00760013
007500                                                                  00770013
007600 FD  INCTV-TYP-CD-FILE                                            00780013
007700     RECORDING MODE IS F                                          00790013
007800     LABEL RECORDS ARE STANDARD                                   00800013
007900     DATA RECORD IS INCTV-TYP-CD-REC.                             00810013
008000 01  INCTV-TYP-CD-REC        PIC  X(036).                         00820013
008100                                                                  00830013
008200 FD  CHRG-FCTR-CD-FILE                                            00840013
008300     RECORDING MODE IS F                                          00850013
008400     LABEL RECORDS ARE STANDARD                                   00860013
008500     DATA RECORD IS CHRG-FCTR-CD-REC.                             00870013
008600 01  CHRG-FCTR-CD-REC        PIC  X(031).                         00880013
008700                                                                  00890013
008800 FD  AGRMT-TYP-CD-FILE                                            00900013
008900     RECORDING MODE IS F                                          00910013
009000     LABEL RECORDS ARE STANDARD                                   00920013
009100     DATA RECORD IS AGRMT-TYP-CD-REC.                             00930013
009200 01  AGRMT-TYP-CD-REC        PIC  X(026).                         00940013
009300                                                                  00950013
009400 FD  MDSE-RET-TYP-CD-FILE                                         00960013
009500     RECORDING MODE IS F                                          00970013
009600     LABEL RECORDS ARE STANDARD                                   00980013
009700     DATA RECORD IS MDSE-RET-TYP-CD-REC.                          00990013
009800 01  MDSE-RET-TYP-CD-REC     PIC  X(032).                         01000013
009900                                                                  01010013
010000 FD  EXENT-ROL-CD-FILE                                            01020013
010100     RECORDING MODE IS F                                          01030013
010200     LABEL RECORDS ARE STANDARD                                   01040013
010300     DATA RECORD IS EXENT-ROL-CD-REC.                             01050013
010400 01  EXENT-ROL-CD-REC        PIC  X(033).                         01060013
010500                                                                  01070013
010600 FD  PAYMENT-TERM-FILE                                            01080028
010700     RECORDING MODE IS F                                          01090028
010800     LABEL RECORDS ARE STANDARD                                   01100028
010900     DATA RECORD IS PAYMENT-TERM-REC.                             01110028
011000 01  PAYMENT-TERM-REC        PIC  X(056).                         01120028
011100                                                                  01130028
011200 FD  FREIGHT-TERM-FILE                                            01140028
011300     RECORDING MODE IS F                                          01150028
011400     LABEL RECORDS ARE STANDARD                                   01160028
011500     DATA RECORD IS FREIGHT-TERM-REC.                             01170028
011600 01  FREIGHT-TERM-REC        PIC  X(022).                         01180028
011700                                                                  01190028
011800/                                                                 01200028
011900 WORKING-STORAGE SECTION.                                         01210028
012000                                                                  01220028
012100 01  FILLER                        PIC X(25)  VALUE               01230028
012200                             'WS FOR VNKUT211 BEGINS==>'.         01240028
012300                                                                  01250028
012400 01  WS-RETRY-COUNTER              PIC S9(4)  COMP VALUE ZERO.    01260028
012500 01  WS-RETRY-MAX                  PIC S9(4)  COMP VALUE 3.       01270028
012600                                                                  01280028
012700 01  PS-SWITCH-AREA.                                              01290028
012800     05  WS-END-OF-CPBL-CD-SW          PIC X(1)   VALUE 'N'.      01300028
012900         88  WS-END-OF-CPBL-CD-CSR                VALUE 'Y'.      01310028
013000     05  WS-END-OF-PAYTRM-SW           PIC X(1)   VALUE 'N'.      01320028
013100         88  WS-END-OF-PAYTRM-CSR                 VALUE 'Y'.      01330028
013200     05  WS-END-OF-FRGTRM-SW           PIC X(1)   VALUE 'N'.      01340028
013300         88  WS-END-OF-FRGTRM-CSR                 VALUE 'Y'.      01350028
013400                                                                  01360028
013500 01  WS-INTEGER-UNPK               PIC S9(10).                    01370032
013600 01  WS-SMALLINT-UNPK              PIC S9(4).                     01380032
013700 01  WS-CHARGE-UNPK                PIC S9(3)V9(4).                01390035
013800 01  WS-DISCOUNT-UNPK              PIC S9(2)V9(2).                01400032
013900 01  WS-CHRG-PCT                   PIC S9(3)V9(4) COMP-3.         01410035
014000 01  WS-DISC-PCT                   PIC S9(2)V9(2) COMP-3.         01420032
014100                                                                  01430032
014200 01  WS-INTEGER-EDIT               PIC ++++++++++9.               01440032
014300 01  WS-SMALLINT-EDIT              PIC +++++9.                    01450032
014400 01  WS-PERCENT-EDIT               PIC ++++.999.                  01460032
014500                                                                  01470032
014600 01  WS-PROGRAM-COUNTERS.                                         01480028
014700     05  WS-CPBL-CD-REC-ROWS-FETCHED    PIC  9(09) VALUE ZEROS.   01490028
014800     05  WS-PAYMENT-TERM-ROWS-FETCHED   PIC  9(09) VALUE ZEROS.   01500031
014900     05  WS-FREIGHT-TERM-ROWS-FETCHED   PIC  9(09) VALUE ZEROS.   01510031
015000     05  WS-CPBL-CD-REC-WRITTEN         PIC  9(09) VALUE ZEROS.   01520031
015100     05  WS-PSTG-FRQ-CD-REC-WRITTEN     PIC  9(09) VALUE ZEROS.   01530031
015200     05  WS-PGM-TYP-CD-REC-WRITTEN      PIC  9(09) VALUE ZEROS.   01540031
015300     05  WS-INCTV-TYP-CD-REC-WRITTEN    PIC  9(09) VALUE ZEROS.   01550031
015400     05  WS-CHRG-FCTR-CD-REC-WRITTEN    PIC  9(09) VALUE ZEROS.   01560031
015500     05  WS-AGRMT-TYP-CD-REC-WRITTEN    PIC  9(09) VALUE ZEROS.   01570031
015600     05  WS-MDSE-RET-TYP-CD-REC-WRITTEN PIC  9(09) VALUE ZEROS.   01580031
015700     05  WS-EXENT-ROL-CD-REC-WRITTEN    PIC  9(09) VALUE ZEROS.   01590031
015800     05  WS-PAYMENT-TERM-REC-WRITTEN    PIC  9(09) VALUE ZEROS.   01600031
015900     05  WS-FREIGHT-TERM-REC-WRITTEN    PIC  9(09) VALUE ZEROS.   01610031
016000                                                                  01620031
016100 01  TABLE-AREA.                                                  01630031
016200***************************************************************** 01640031
016300*** INTERNAL ARRAY HOLDS POSTING FREQUENCY CODES AND DESCRIPTIONS 01650031
016400     05  PSTG-FRQ-CODES.                                          01660031
016500         10  PSTG-FRQ-1          PIC X(02)  VALUE 'CA'.           01670031
016600         10  PSTG-FRQ-DESC-1     PIC X(30)  VALUE                 01680031
016700                      'CALENDAR ANNUAL               '.           01690031
016800         10  PSTG-FRQ-2          PIC X(02)  VALUE 'CM'.           01700031
016900         10  PSTG-FRQ-DESC-2     PIC X(30)  VALUE                 01710031
017000                      'CALENDAR MONTH                '.           01720031
017100         10  PSTG-FRQ-3          PIC X(02)  VALUE 'CQ'.           01730031
017200         10  PSTG-FRQ-DESC-3     PIC X(30)  VALUE                 01740031
017300                      'CALENDAR QUARTER              '.           01750031
017400         10  PSTG-FRQ-4          PIC X(02)  VALUE 'CS'.           01760031
017500         10  PSTG-FRQ-DESC-4     PIC X(30)  VALUE                 01770031
017600                      'CALENDAR SEASON               '.           01780031
017700         10  PSTG-FRQ-5          PIC X(02)  VALUE 'FA'.           01790031
017800         10  PSTG-FRQ-DESC-5     PIC X(30)  VALUE                 01800031
017900                      'FISCAL ANNUAL                 '.           01810031
018000         10  PSTG-FRQ-6          PIC X(02)  VALUE 'FM'.           01820031
018100         10  PSTG-FRQ-DESC-6     PIC X(30)  VALUE                 01830031
018200                      'FISCAL MONTH                  '.           01840031
018300         10  PSTG-FRQ-7          PIC X(02)  VALUE 'FQ'.           01850031
018400         10  PSTG-FRQ-DESC-7     PIC X(30)  VALUE                 01860031
018500                      'FISCAL QUARTER                '.           01870031
018600         10  PSTG-FRQ-8          PIC X(02)  VALUE 'FS'.           01880031
018700         10  PSTG-FRQ-DESC-8     PIC X(30)  VALUE                 01890031
018800                      'FISCAL SEASON                 '.           01900031
018900         10  PSTG-FRQ-9          PIC X(02)  VALUE 'IV'.           01910031
019000         10  PSTG-FRQ-DESC-9     PIC X(30)  VALUE                 01920031
019100                      'OFF INVOICE                   '.           01930031
019200         10  PSTG-FRQ-10         PIC X(02)  VALUE 'RO'.           01940031
019300         10  PSTG-FRQ-DESC-10    PIC X(30)  VALUE                 01950031
019400                      'REPORT ONLY                   '.           01960031
019500     05  PSTG-FRQ-TABLE REDEFINES                                 01970031
019600                        PSTG-FRQ-CODES.                           01980031
019700         10  PSTG-FRQ-ENTRIES OCCURS 10 TIMES                     01990031
019800                               INDEXED BY IDX1.                   02000031
019900             15  TBL-PSTG-FRQ-CD      PIC X(02).                  02010031
020000             15  TBL-PSTG-FRQ-DESC    PIC X(30).                  02020031
020100                                                                  02030031
020200***************************************************************** 02040031
020300*** INTERNAL ARRAY HOLDS PROGRAM TYPE CODES AND DESCRIPTIONS      02050031
020400     05  PGM-TYP-CODES.                                           02060031
020500         10  PGM-TYP-1           PIC X(06)  VALUE '    +6'.       02070031
020600         10  PGM-TYP-DESC-1      PIC X(30)  VALUE                 02080031
020700                      'VENDOR ALLOWANCE              '.           02090031
020800     05  PGM-TYP-TABLE REDEFINES                                  02100031
020900                        PGM-TYP-CODES.                            02110031
021000         10  PGM-TYP-ENTRIES OCCURS 01 TIMES                      02120031
021100                               INDEXED BY IDX2.                   02130031
021200             15  TBL-PGM-TYP-CD       PIC X(06).                  02140031
021300             15  TBL-PGM-TYP-DESC     PIC X(30).                  02150031
021400                                                                  02160031
021500***************************************************************** 02170031
021600*** INTERNAL ARRAY HOLDS INCENTIVE TYPE CODES AND DESCRIPTIONS    02180031
021700     05  INCTV-TYP-CODES.                                         02190031
021800         10  INCTV-TYP-1         PIC X(06)  VALUE '    +1'.       02200031
021900         10  INCTV-TYP-DESC-1    PIC X(30)  VALUE                 02210031
022000                      'NEW STORE DISCOUNT            '.           02220031
022100         10  INCTV-TYP-2         PIC X(06)  VALUE '    +7'.       02230031
022200         10  INCTV-TYP-DESC-2    PIC X(30)  VALUE                 02240031
022300                      'MARK OUT OF STOCK DISCOUNT    '.           02250031
022400         10  INCTV-TYP-3         PIC X(06)  VALUE '    +8'.       02260031
022500         10  INCTV-TYP-DESC-3    PIC X(30)  VALUE                 02270031
022600                      'TRADE DISCOUNT                '.           02280031
022700         10  INCTV-TYP-4         PIC X(06)  VALUE '    +9'.       02290031
022800         10  INCTV-TYP-DESC-4    PIC X(30)  VALUE                 02300031
022900                      'BROADCAST OFF INVOICE         '.           02310031
023000         10  INCTV-TYP-5         PIC X(06)  VALUE '   +10'.       02320031
023100         10  INCTV-TYP-DESC-5    PIC X(30)  VALUE                 02330031
023200                      'CO-OP OFF INVOICE             '.           02340031
023300         10  INCTV-TYP-6         PIC X(06)  VALUE '   +11'.       02350031
023400         10  INCTV-TYP-DESC-6    PIC X(30)  VALUE                 02360031
023500                      'PROFIT ASSIST/AD CO-OP        '.           02370031
023600         10  INCTV-TYP-7         PIC X(06)  VALUE '   +12'.       02380031
023700         10  INCTV-TYP-DESC-7    PIC X(30)  VALUE                 02390031
023800                      'TABLE AND TOWER               '.           02400031
023900         10  INCTV-TYP-8         PIC X(06)  VALUE '   +13'.       02410031
024000         10  INCTV-TYP-DESC-8    PIC X(30)  VALUE                 02420031
024100                      'BRIDAL OFF INVOICE            '.           02430031
024200     05  INCTV-TYP-TABLE REDEFINES                                02440031
024300                        INCTV-TYP-CODES.                          02450031
024400         10  INCTV-TYP-ENTRIES OCCURS 08 TIMES                    02460031
024500                               INDEXED BY IDX3.                   02470031
024600             15  TBL-INCTV-TYP-CD     PIC X(06).                  02480031
024700             15  TBL-INCTV-TYP-DESC   PIC X(30).                  02490031
024800                                                                  02500031
024900***************************************************************** 02510031
025000*** INTERNAL ARRAY HOLDS CHARGE FACTOR CODES AND DESCRIPTIONS     02520031
025100     05  CHRG-FCTR-CODES.                                         02530031
025200         10  CHRG-FCTR-1         PIC X(01)  VALUE 'C'.            02540031
025300         10  CHRG-FCTR-DESC-1    PIC X(30)  VALUE                 02550031
025400                      'PER COST PERCENT              '.           02560031
025500         10  CHRG-FCTR-2         PIC X(01)  VALUE 'D'.            02570031
025600         10  CHRG-FCTR-DESC-2    PIC X(30)  VALUE                 02580031
025700                      'PER DAILY                     '.           02590031
025800         10  CHRG-FCTR-3         PIC X(01)  VALUE 'I'.            02600031
025900         10  CHRG-FCTR-DESC-3    PIC X(30)  VALUE                 02610031
026000                      'PER ITEM                      '.           02620031
026100         10  CHRG-FCTR-4         PIC X(01)  VALUE 'S'.            02630031
026200         10  CHRG-FCTR-DESC-4    PIC X(30)  VALUE                 02640031
026300                      'PER SHIPMENT                  '.           02650031
026400         10  CHRG-FCTR-5         PIC X(01)  VALUE 'W'.            02660031
026500         10  CHRG-FCTR-DESC-5    PIC X(30)  VALUE                 02670031
026600                      'PER WEEKLY                    '.           02680031
026700     05  CHRG-FCTR-TABLE REDEFINES                                02690031
026800                        CHRG-FCTR-CODES.                          02700031
026900         10  CHRG-FCTR-ENTRIES OCCURS 05 TIMES                    02710031
027000                               INDEXED BY IDX4.                   02720031
027100             15  TBL-CHRG-FCTR-CD     PIC X(01).                  02730031
027200             15  TBL-CHRG-FCTR-DESC   PIC X(30).                  02740031
027300                                                                  02750031
027400***************************************************************** 02760031
027500*** INTERNAL ARRAY HOLDS AGREEMENT TYPE CODES AND DESCRIPTIONS    02770031
027600     05  AGRMT-TYP-CODES.                                         02780031
027700         10  AGRMT-TYP-1         PIC X(01)  VALUE '1'.            02790031
027800         10  AGRMT-TYP-DESC-1    PIC X(25)  VALUE                 02800031
027900                      'SHIPPING                 '.                02810031
028000         10  AGRMT-TYP-2         PIC X(01)  VALUE '2'.            02820031
028100         10  AGRMT-TYP-DESC-2    PIC X(25)  VALUE                 02830031
028200                      'PAYMENT                  '.                02840031
028300         10  AGRMT-TYP-3         PIC X(01)  VALUE '3'.            02850031
028400         10  AGRMT-TYP-DESC-3    PIC X(25)  VALUE                 02860031
028500                      'PURCHASE                 '.                02870031
028600         10  AGRMT-TYP-4         PIC X(01)  VALUE '5'.            02880031
028700         10  AGRMT-TYP-DESC-4    PIC X(25)  VALUE                 02890031
028800                      'INCENTIVE                '.                02900031
028900         10  AGRMT-TYP-5         PIC X(01)  VALUE '6'.            02910031
029000         10  AGRMT-TYP-DESC-5    PIC X(25)  VALUE                 02920031
029100                      'PROGRAMS                 '.                02930031
029200     05  AGRMT-TYP-TABLE REDEFINES                                02940031
029300                        AGRMT-TYP-CODES.                          02950031
029400         10  AGRMT-TYP-ENTRIES OCCURS 05 TIMES                    02960031
029500                               INDEXED BY IDX5.                   02970031
029600             15  TBL-AGRMT-TYP-CD     PIC X(01).                  02980031
029700             15  TBL-AGRMT-TYP-DESC   PIC X(25).                  02990031
029800                                                                  03000031
029900***************************************************************** 03010031
030000*** INTERNAL ARRAY HOLDS DC MDSE RETURN TYPE CODES AND            03020031
030100*** DESCRIPTIONS                                                  03030031
030200     05  MDSE-RET-TYP-CODES.                                      03040031
030300         10  MDSE-RET-TYP-1      PIC X(02)  VALUE 'DD'.           03050031
030400         10  MDSE-RET-TYP-DESC-1 PIC X(30)  VALUE                 03060031
030500                      'DEBIT AND DESTROY             '.           03070031
030600         10  MDSE-RET-TYP-2      PIC X(02)  VALUE 'MO'.           03080031
030700         10  MDSE-RET-TYP-DESC-2 PIC X(30)  VALUE                 03090031
030800                      'MARKOUT                       '.           03100031
030900         10  MDSE-RET-TYP-3      PIC X(02)  VALUE 'RA'.           03110031
031000         10  MDSE-RET-TYP-DESC-3 PIC X(30)  VALUE                 03120031
031100                      'RTV WITH AUTHORIZATION        '.           03130031
031200         10  MDSE-RET-TYP-4      PIC X(02)  VALUE 'RV'.           03140031
031300         10  MDSE-RET-TYP-DESC-4 PIC X(30)  VALUE                 03150031
031400                      'RTV NO AUTHORIZATION REQUIRED '.           03160031
031500     05  MDSE-RET-TYP-TABLE REDEFINES                             03170031
031600                        MDSE-RET-TYP-CODES.                       03180031
031700         10  MDSE-RET-TYP-ENTRIES OCCURS 04 TIMES                 03190031
031800                               INDEXED BY IDX6.                   03200031
031900             15  TBL-MDSE-RET-TYP-CD   PIC X(02).                 03210031
032000             15  TBL-MDSE-RET-TYP-DESC PIC X(30).                 03220031
032100                                                                  03230031
032200***************************************************************** 03240031
032300*** INTERNAL ARRAY HOLDS EXENT ROLE CODES AND DESCRIPTIONS        03250031
032400     05  EXENT-ROL-TYP-CODES.                                     03260031
032500         10  EXENT-ROL-TYP-1     PIC X(03)  VALUE 'AG '.          03270031
032600         10  EXENT-ROL-TYP-DESC-1 PIC X(30) VALUE                 03280031
032700                      'AGENT                         '.           03290031
032800         10  EXENT-ROL-TYP-2     PIC X(03)  VALUE 'BK '.          03300031
032900         10  EXENT-ROL-TYP-DESC-2 PIC X(30) VALUE                 03310031
033000                      'BANK                          '.           03320031
033100         10  EXENT-ROL-TYP-3     PIC X(03)  VALUE 'BR '.          03330031
033200         10  EXENT-ROL-TYP-DESC-3 PIC X(30) VALUE                 03340031
033300                      'BROKER                        '.           03350031
033400         10  EXENT-ROL-TYP-4     PIC X(03)  VALUE 'CO '.          03360031
033500         10  EXENT-ROL-TYP-DESC-4 PIC X(30) VALUE                 03370031
033600                      'CONSOLIDATOR                  '.           03380031
033700         10  EXENT-ROL-TYP-5     PIC X(03)  VALUE 'CR '.          03390031
033800         10  EXENT-ROL-TYP-DESC-5 PIC X(30) VALUE                 03400031
033900                      'CARRIER                       '.           03410031
034000         10  EXENT-ROL-TYP-6     PIC X(03)  VALUE 'DE '.          03420031
034100         10  EXENT-ROL-TYP-DESC-6 PIC X(30) VALUE                 03430031
034200                      'DECONSOLIDATOR                '.           03440031
034300         10  EXENT-ROL-TYP-7     PIC X(03)  VALUE 'E  '.          03450031
034400         10  EXENT-ROL-TYP-DESC-7 PIC X(30) VALUE                 03460031
034500                      'EXPENSE                       '.           03470031
034600         10  EXENT-ROL-TYP-8     PIC X(03)  VALUE 'F  '.          03480031
034700         10  EXENT-ROL-TYP-DESC-8 PIC X(30) VALUE                 03490031
034800                      'FACTOR                        '.           03500031
034900         10  EXENT-ROL-TYP-9     PIC X(03)  VALUE 'FA '.          03510031
035000         10  EXENT-ROL-TYP-DESC-9 PIC X(30) VALUE                 03520031
035100                      'FACTORY                       '.           03530031
035200         10  EXENT-ROL-TYP-10    PIC X(03)  VALUE 'FF '.          03540031
035300         10  EXENT-ROL-TYP-DESC-10 PIC X(30) VALUE                03550031
035400                      'FREIGHT FORWARDER             '.           03560031
035500         10  EXENT-ROL-TYP-11    PIC X(03)  VALUE 'K  '.          03570031
035600         10  EXENT-ROL-TYP-DESC-11 PIC X(30) VALUE                03580031
035700                      'KOHLS EMPLOYEE                '.           03590031
035800         10  EXENT-ROL-TYP-12    PIC X(03)  VALUE 'M  '.          03600031
035900         10  EXENT-ROL-TYP-DESC-12 PIC X(30) VALUE                03610031
036000                      'MERCHANDISE                   '.           03620031
036100         10  EXENT-ROL-TYP-13    PIC X(03)  VALUE 'OP '.          03630031
036200         10  EXENT-ROL-TYP-DESC-13 PIC X(30) VALUE                03640031
036300                      'OFFICE OF PLACEMENT           '.           03650031
036400         10  EXENT-ROL-TYP-14    PIC X(03)  VALUE 'P  '.          03660031
036500         10  EXENT-ROL-TYP-DESC-14 PIC X(30) VALUE                03670031
036600                      'PARTNER                       '.           03680031
036700         10  EXENT-ROL-TYP-15    PIC X(03)  VALUE 'S1 '.          03690031
036800         10  EXENT-ROL-TYP-DESC-15 PIC X(30) VALUE                03700031
036900                      'MAKER                         '.           03710031
037000         10  EXENT-ROL-TYP-16    PIC X(03)  VALUE 'S2 '.          03720031
037100         10  EXENT-ROL-TYP-DESC-16 PIC X(30) VALUE                03730031
037200                      'IMPORT PARENT CO              '.           03740031
037300         10  EXENT-ROL-TYP-17    PIC X(03)  VALUE 'TM '.          03750031
037400         10  EXENT-ROL-TYP-DESC-17 PIC X(30) VALUE                03760031
037500                      'TICKET MAKER                  '.           03770031
037600     05  EXENT-ROL-TYP-TABLE REDEFINES                            03780031
037700                        EXENT-ROL-TYP-CODES.                      03790031
037800         10  EXENT-ROL-TYP-ENTRIES OCCURS 17 TIMES                03800031
037900                               INDEXED BY IDX7.                   03810031
038000             15  TBL-EXENT-ROL-TYP-CD   PIC X(03).                03820031
038100             15  TBL-EXENT-ROL-TYP-DESC PIC X(30).                03830031
038200                                                                  03840031
038300                                                                  03850031
038400*---------------------------------------------------------------* 03860031
038500* SQLA MESSAGE MODULE                                           * 03870031
038600*---------------------------------------------------------------* 03880031
038700     COPY DPWS004.                                                03890031
038800                                                                  03900031
038900*---------------------------------------------------------------* 03910031
039000* VENDOR CAPABILITIES CODE COPYBOOK                               03920031
039100*---------------------------------------------------------------* 03930031
039200     COPY VNRD206.                                                03940031
039300                                                                  03950031
039400*---------------------------------------------------------------* 03960031
039500* POSTING FREQUENCY CODE COPYBOOK                                 03970031
039600*---------------------------------------------------------------* 03980031
039700     COPY VNRD200.                                                03990031
039800                                                                  04000031
039900*---------------------------------------------------------------* 04010031
040000* PROGRAM TYPE CODE COPYBOOK                                      04020031
040100*---------------------------------------------------------------* 04030031
040200     COPY VNRD201.                                                04040031
040300                                                                  04050031
040400*---------------------------------------------------------------* 04060031
040500* INCENTIVE TYPE CODE COPYBOOK                                    04070031
040600*---------------------------------------------------------------* 04080031
040700     COPY VNRD202.                                                04090031
040800                                                                  04100031
040900*---------------------------------------------------------------* 04110031
041000* CHARGE FACTOR CODE COPYBOOK                                     04120031
041100*---------------------------------------------------------------* 04130031
041200     COPY VNRD203.                                                04140031
041300                                                                  04150031
041400*---------------------------------------------------------------* 04160031
041500* AGREEMENT TYPE CODE COPYBOOK                                    04170031
041600*---------------------------------------------------------------* 04180031
041700     COPY VNRD204.                                                04190031
041800                                                                  04200031
041900*---------------------------------------------------------------* 04210031
042000* DC MERCHANDISE RETURN TYPE CODE COPYBOOK                        04220031
042100*---------------------------------------------------------------* 04230031
042200     COPY VNRD205.                                                04240031
042300                                                                  04250031
042400*---------------------------------------------------------------* 04260031
042500* EXENT ROLE CODE COPYBOOK                                        04270031
042600*---------------------------------------------------------------* 04280031
042700     COPY VNRD207.                                                04290031
042800                                                                  04300031
042900*---------------------------------------------------------------* 04310031
043000* PAYMENT TERM COPYBOOK                                           04320031
043100*---------------------------------------------------------------* 04330031
043200     COPY VNRD208.                                                04340031
043300                                                                  04350031
043400*---------------------------------------------------------------* 04360031
043500* FREIGHT TERM COPYBOOK                                           04370031
043600*---------------------------------------------------------------* 04380031
043700     COPY VNRD209.                                                04390031
043800                                                                  04400031
043900 01  WS-ABEND-FIELDS.                                             04410031
044000     05  WS-ABEND-PROGRAM          PIC X(8)   VALUE 'VNKUT211'.   04420031
044100     05  WS-ABEND-PARAGRAPH        PIC X(50)  VALUE SPACES.       04430031
044200     05  WS-ABEND-OPERATION        PIC X(50)  VALUE SPACES.       04440031
044300     05  WS-ABEND-STRUCTURE-1      PIC X(8)   VALUE SPACES.       04450031
044400     05  WS-ABEND-STRUCTURE-2      PIC X(8)   VALUE SPACES.       04460031
044500     05  WS-ABEND-STATUS           PIC XX     VALUE SPACES.       04470031
044600                                                                  04480031
044700 01  ABEND-CODE                    PIC S9(4)  COMP SYNC           04490031
044800                                              VALUE ZEROS.        04500031
044900     88 AP-TABLE-FULL              VALUE +4004.                   04510031
045000     88 AP-EMPTY-FILE              VALUE +4005.                   04520031
045100     88 AP-DB2-ERROR               VALUE +4013.                   04530031
045200                                                                  04540031
045300*---------------------------------------------------------------* 04550031
045400*  COMMUNICATIONS AREA2 FOR DB2                                 * 04560031
045500*---------------------------------------------------------------* 04570031
045600     COPY SQLCA2.                                                 04580031
045700                                                                  04590031
045800*---------------------------------------------------------------* 04600031
045900* SQL COMMUNICATIONS AREA DCLGEN                                * 04610031
046000*---------------------------------------------------------------* 04620031
046100     EXEC SQL                                                     04630031
046200          INCLUDE SQLCA                                           04640031
046300     END-EXEC.                                                    04650031
046400                                                                  04660031
046500*---------------------------------------------------------------* 04670031
046600* VENDOR CAPABILITIES CODE TABLE                                * 04680031
046700*---------------------------------------------------------------* 04690031
046800     EXEC SQL                                                     04700031
046900          INCLUDE VNT00003                                        04710031
047000     END-EXEC.                                                    04720031
047100                                                                  04730031
047200*---------------------------------------------------------------* 04740031
047300* VENDOR PAYMENT TERMS TABLE                                    * 04750031
047400*---------------------------------------------------------------* 04760031
047500     EXEC SQL                                                     04770031
047600          INCLUDE TPAYTRM                                         04780031
047700     END-EXEC.                                                    04790031
047800                                                                  04800031
047900*---------------------------------------------------------------* 04810031
048000* VENDOR FREIGHT TERMS TABLE                                    * 04820031
048100*---------------------------------------------------------------* 04830031
048200     EXEC SQL                                                     04840031
048300          INCLUDE TFRGTRM                                         04850031
048400     END-EXEC.                                                    04860031
048500                                                                  04870031
048600*---------------------------------------------------------------* 04880031
048700*   THIS IS THE CURSOR THAT RETRIEVES THE VENDOR CAPABILITY     * 04890031
048800*   CODE DATA NEEDED FOR THE EXTRACT FILE                       * 04900031
048900*---------------------------------------------------------------* 04910031
049000     EXEC SQL                                                     04920031
049100        DECLARE CPBL_CDE_CSR CURSOR FOR                           04930031
049200          SELECT VND_CPBL_CDE                                     04940031
049300                ,VND_CPBL_DESC                                    04950031
049400                ,ACTV_IND                                         04960031
049500                ,LAST_UPD_BY_USR_ID                               04970031
049600                ,LAST_UPD_TMST                                    04980031
049700            FROM VNT_VND_CPBL_CDE                                 04990031
049800           ORDER BY VND_CPBL_CDE                                  05000031
049900     END-EXEC.                                                    05010031
050000                                                                  05020031
050100*---------------------------------------------------------------* 05030031
050200*   THIS IS THE CURSOR THAT RETRIEVES THE VENDOR PAYMENT TERMS  * 05040031
050300*   NEEDED FOR THE EXTRACT FILE                                 * 05050031
050400*---------------------------------------------------------------* 05060031
050500     EXEC SQL                                                     05070031
050600        DECLARE PAYTRM_CSR CURSOR FOR                             05080031
050700          SELECT PAY_TERM_ID                                      05090031
050800                ,DISCOUNT_PCT                                     05100031
050900                ,DISCOUNT_DAYS_QTY                                05110031
051000                ,DUE_DAY_QTY                                      05120031
051100                ,OTHER_TXT                                        05130031
051200                ,DUE_DAY_FR_DTE_TXT                               05140038
051300            FROM TPAYTRM                                          05150031
051400           ORDER BY PAY_TERM_ID                                   05160031
051500     END-EXEC.                                                    05170031
051600                                                                  05180031
051700*---------------------------------------------------------------* 05190031
051800*   THIS IS THE CURSOR THAT RETRIEVES THE VENDOR FREIGHT TERMS  * 05200031
051900*   NEEDED FOR THE EXTRACT FILE                                 * 05210031
052000*---------------------------------------------------------------* 05220031
052100     EXEC SQL                                                     05230031
052200        DECLARE FRGTRM_CSR CURSOR FOR                             05240031
052300          SELECT FRGT_TERM_ID                                     05250031
052400                ,KOHLS_FRGT_PCT                                   05260031
052500                ,VND_FRGT_PCT                                     05270031
052600            FROM TFRGTRM                                          05280031
052700           ORDER BY FRGT_TERM_ID                                  05290031
052800     END-EXEC.                                                    05300031
052900                                                                  05310031
053000 01  FILLER                        PIC X(25) VALUE                05320031
053100          '<====WS FOR VNKUT211 ENDS'.                            05330031
053200                                                                  05340031
053300*********************************                                 05350031
053400 PROCEDURE DIVISION.                                              05360031
053500*********************************                                 05370031
053600 A100-MAINLINE.                                                   05380031
053700                                                                  05390031
053800     PERFORM B100-INITIALIZATION.                                 05400031
053900                                                                  05410031
054000     PERFORM B200-CREATE-CPBL-CD-EXTRCT                           05420031
054100       UNTIL WS-END-OF-CPBL-CD-CSR.                               05430031
054200                                                                  05440031
054300     PERFORM Y200-CLOSE-CPBL-CD-CSR.                              05450031
054400                                                                  05460031
054500     PERFORM C100-CREATE-PSTG-FRQ-CD-FILE.                        05470031
054600     PERFORM C200-CREATE-PGM-TYP-CD-FILE.                         05480031
054700     PERFORM C300-CREATE-INCTV-TYP-CD-FILE.                       05490031
054800     PERFORM C400-CREATE-CHRG-FCTR-CD-FILE.                       05500031
054900     PERFORM C500-CREATE-AGRMT-TYP-CD-FILE.                       05510031
055000     PERFORM C600-CREATE-MDSE-RET-TYP-FILE.                       05520031
055100     PERFORM C700-CREATE-EXENT-ROL-CD-FILE.                       05530031
055200                                                                  05540031
055300     PERFORM Y300-OPEN-PAYTRM-CSR.                                05550036
055400     PERFORM R200-FETCH-PAYTRM-CSR.                               05560037
055500                                                                  05570036
055600     PERFORM C800-CREATE-PAYTRM-EXTRCT                            05580036
055700       UNTIL WS-END-OF-PAYTRM-CSR.                                05590036
055800                                                                  05600036
055900     PERFORM Y400-CLOSE-PAYTRM-CSR.                               05610036
056000                                                                  05620034
056100     PERFORM Y500-OPEN-FRGTRM-CSR.                                05630034
056200     PERFORM R300-FETCH-FRGTRM-CSR.                               05640037
056300                                                                  05650032
056400     PERFORM C900-CREATE-FRGTRM-EXTRCT                            05660032
056500       UNTIL WS-END-OF-FRGTRM-CSR.                                05670032
056600                                                                  05680032
056700     PERFORM Y600-CLOSE-FRGTRM-CSR.                               05690032
056800                                                                  05700031
056900     PERFORM B300-END-OF-JOB.                                     05710031
057000                                                                  05720031
057100     GOBACK.                                                      05730031
057200        EJECT                                                     05740031
057300                                                                  05750031
057400*                                                                 05760031
057500***************************************************************** 05770031
057600*  INITIALIZATION PROCESSING                                    * 05780031
057700*  - OPEN EXTRACT FILES                                         * 05790031
057800*  - INITIALIZE DCLGENS                                         * 05800031
057900*  - OPEN CAPABILITIES CURSOR AND FETCH FIRST ROW               * 05810031
058000***************************************************************** 05820031
058100*                                                                 05830031
058200 B100-INITIALIZATION.                                             05840031
058300                                                                  05850031
058400     DISPLAY '**********************************'                 05860031
058500     DISPLAY '*   STARTING PROGRAM VNKUT211    *'                 05870031
058600     DISPLAY '**********************************'                 05880031
058700                                                                  05890031
058800     OPEN OUTPUT CPBL-CD-EXTRCT-FILE                              05900031
058900                 PSTG-FRQ-CD-FILE                                 05910031
059000                 PGM-TYP-CD-FILE                                  05920031
059100                 INCTV-TYP-CD-FILE                                05930031
059200                 CHRG-FCTR-CD-FILE                                05940031
059300                 AGRMT-TYP-CD-FILE                                05950031
059400                 MDSE-RET-TYP-CD-FILE                             05960031
059500                 EXENT-ROL-CD-FILE                                05970031
059600                 PAYMENT-TERM-FILE                                05980031
059700                 FREIGHT-TERM-FILE.                               05990031
059800                                                                  06000031
059900     INITIALIZE DCLVNT00003                                       06010038
060000                DCLTPAYTRM                                        06020038
060100                DCLTFRGTRM.                                       06030038
060200                                                                  06040031
060300     PERFORM Y100-OPEN-CPBL-CD-CSR.                               06050031
060400     PERFORM R100-FETCH-CPBL-CD-CSR.                              06060031
060500                                                                  06070031
060600     IF WS-END-OF-CPBL-CD-CSR                                     06080031
060700        DISPLAY '**********************************'              06090031
060800        DISPLAY '*      PROGRAM = VNKUT211        *'              06100031
060900        DISPLAY '**********************************'              06110031
061000        DISPLAY '* NO ROWS WERE SELECTED FROM     *'              06120031
061100        DISPLAY '* THE VENDOR CAPABILITIES CODE   *'              06130031
061200        DISPLAY '* CURSOR.                        *'              06140031
061300        DISPLAY '**********************************'              06150031
061400     END-IF.                                                      06160031
061500                                                                  06170031
061600*                                                                 06180031
061700***************************************************************** 06190031
061800*  PROCESS CPBL_CDE_CSR RESULTS. MOVES RETRIEVED INFORMATION    * 06200031
061900*  TO THE VNRD206 COPYBOOK USED TO WRITE THE OUTPUT FILE        * 06210031
062000***************************************************************** 06220031
062100*                                                                 06230031
062200 B200-CREATE-CPBL-CD-EXTRCT.                                      06240031
062300                                                                  06250031
062400     INITIALIZE VN206-RECORD.                                     06260038
062500                                                                  06270038
062600     MOVE VNT00003-VND-CPBL-CDE       TO VN206-EXENT-CPBL-CDE.    06280031
062700     MOVE VNT00003-VND-CPBL-DESC      TO VN206-EXENT-CPBL-DESC.   06290031
062800     MOVE VNT00003-ACTV-IND           TO VN206-ACTV-CDE.          06300031
062900     MOVE VNT00003-LAST-UPD-BY-USR-ID TO VN206-SOR-LAST-UPD-USRID.06310031
063000     MOVE VNT00003-LAST-UPD-TMST      TO VN206-SOR-LAST-UPD-TMST. 06320031
063100                                                                  06330031
063200     PERFORM W100-WRITE-CPBL-CD-EXTRCT-REC.                       06340031
063300     PERFORM R100-FETCH-CPBL-CD-CSR.                              06350031
063400                                                                  06360031
063500*                                                                 06370031
063600***************************************************************** 06380031
063700*  END OF PROGRAM PROCESSING.                                   * 06390031
063800***************************************************************** 06400031
063900*                                                                 06410031
064000 B300-END-OF-JOB.                                                 06420031
064100                                                                  06430031
064200     CLOSE CPBL-CD-EXTRCT-FILE                                    06440031
064300           PSTG-FRQ-CD-FILE                                       06450031
064400           PGM-TYP-CD-FILE                                        06460031
064500           INCTV-TYP-CD-FILE                                      06470031
064600           CHRG-FCTR-CD-FILE                                      06480031
064700           AGRMT-TYP-CD-FILE                                      06490031
064800           MDSE-RET-TYP-CD-FILE                                   06500031
064900           EXENT-ROL-CD-FILE                                      06510031
065000           PAYMENT-TERM-FILE                                      06520031
065100           FREIGHT-TERM-FILE.                                     06530031
065200                                                                  06540031
065300     DISPLAY 'CAPABILITY CODE ROWS FETCHED   = '                  06550039
065400                         WS-CPBL-CD-REC-ROWS-FETCHED.             06560031
065500     DISPLAY 'PAYMENT TERM CODE ROWS FETCHED = '                  06570039
065600                         WS-PAYMENT-TERM-ROWS-FETCHED.            06580039
065700     DISPLAY 'FREIGHT TERM CODE ROWS FETCHED = '                  06590039
065800                         WS-FREIGHT-TERM-ROWS-FETCHED.            06600039
065900     DISPLAY 'CAPABILITY CODE RECORDS WRITTEN             = '     06610031
066000                         WS-CPBL-CD-REC-WRITTEN.                  06620031
066100     DISPLAY 'POSTING FREQ CODE RECORDS WRITTEN           = '     06630031
066200                         WS-PSTG-FRQ-CD-REC-WRITTEN.              06640031
066300     DISPLAY 'PROGRAM TYPE CODE RECORDS WRITTEN           = '     06650031
066400                         WS-PGM-TYP-CD-REC-WRITTEN.               06660031
066500     DISPLAY 'INCENTIVE TYPE CODE RECORDS WRITTEN         = '     06670031
066600                         WS-INCTV-TYP-CD-REC-WRITTEN.             06680031
066700     DISPLAY 'CHARGE FACTOR CODE RECORDS WRITTEN          = '     06690031
066800                         WS-CHRG-FCTR-CD-REC-WRITTEN.             06700031
066900     DISPLAY 'AGREEMENT TYPE CODE RECORDS WRITTEN         = '     06710031
067000                         WS-AGRMT-TYP-CD-REC-WRITTEN.             06720031
067100     DISPLAY 'DC MERCH RETURN TYPE CODE RECORDS WRITTEN   = '     06730031
067200                         WS-MDSE-RET-TYP-CD-REC-WRITTEN.          06740031
067300     DISPLAY 'EXENT ROLE CODE RECORDS WRITTEN             = '     06750031
067400                         WS-EXENT-ROL-CD-REC-WRITTEN.             06760031
067500     DISPLAY 'PAYMENT TERM RECORDS WRITTEN                = '     06770031
067600                         WS-PAYMENT-TERM-REC-WRITTEN.             06780031
067700     DISPLAY 'FREIGHT TERM RECORDS WRITTEN                = '     06790031
067800                         WS-FREIGHT-TERM-REC-WRITTEN.             06800031
067900                                                                  06810031
068000     DISPLAY 'PROGRAM VNKUT211 ENDS NORMALLY '.                   06820031
068100                                                                  06830031
068200*                                                                 06840031
068300***************************************************************** 06850031
068400*  PROCESS PSTG-FRQ-TABLE TO WRITE OUT THE ARRAY DATA TO THE      06860031
068500*  TO THE POSTING FREQUENCY CODE FILE                             06870031
068600***************************************************************** 06880031
068700*                                                                 06890031
068800 C100-CREATE-PSTG-FRQ-CD-FILE.                                    06900031
068900                                                                  06910031
069000     PERFORM VARYING IDX1 FROM 1 BY 1                             06920031
069100        UNTIL IDX1 > 10                                           06930031
069200        INITIALIZE VN200-RECORD                                   06940038
069300        MOVE TBL-PSTG-FRQ-CD (IDX1)   TO VN200-PSTG-FRQ-CDE       06950031
069400        MOVE TBL-PSTG-FRQ-DESC (IDX1) TO VN200-PSTG-FRQ-DESC      06960031
069500        PERFORM W101-WRITE-PSTG-FRQ-CD-REC                        06970031
069600     END-PERFORM.                                                 06980031
069700                                                                  06990031
069800*                                                                 07000031
069900***************************************************************** 07010031
070000*  PROCESS PGM-TYP-TABLE TO WRITE OUT THE ARRAY DATA TO THE       07020031
070100*  TO THE PROGRAM TYPE CODE FILE                                  07030031
070200***************************************************************** 07040031
070300*                                                                 07050031
070400 C200-CREATE-PGM-TYP-CD-FILE.                                     07060031
070500                                                                  07070031
070600     PERFORM VARYING IDX2 FROM 1 BY 1                             07080031
070700        UNTIL IDX2 > 1                                            07090031
070800        INITIALIZE VN201-RECORD                                   07100038
070900        MOVE TBL-PGM-TYP-CD (IDX2)   TO                           07110031
071000                                  VN201-EXENT-PGM-TYP-CDE         07120031
071100        MOVE TBL-PGM-TYP-DESC (IDX2) TO                           07130031
071200                                  VN201-EXENT-PGM-DESC            07140031
071300        PERFORM W102-WRITE-PGM-TYP-CD-REC                         07150031
071400     END-PERFORM.                                                 07160031
071500                                                                  07170031
071600*                                                                 07180031
071700***************************************************************** 07190031
071800*  PROCESS INCTV-TYP-TABLE TO WRITE OUT THE ARRAY DATA TO THE     07200031
071900*  TO THE INCENTIVE TYPE CODE FILE                                07210031
072000***************************************************************** 07220031
072100*                                                                 07230031
072200 C300-CREATE-INCTV-TYP-CD-FILE.                                   07240031
072300                                                                  07250031
072400     PERFORM VARYING IDX3 FROM 1 BY 1                             07260031
072500        UNTIL IDX3 > 8                                            07270031
072600        INITIALIZE VN202-RECORD                                   07280038
072700        MOVE TBL-INCTV-TYP-CD (IDX3)   TO                         07290031
072800                                  VN202-INCTV-TYP-CDE             07300031
072900        MOVE TBL-INCTV-TYP-DESC (IDX3) TO                         07310031
073000                                  VN202-INCTV-TYP-DESC            07320031
073100        PERFORM W103-WRITE-INCTV-TYP-CD-REC                       07330031
073200     END-PERFORM.                                                 07340031
073300                                                                  07350031
073400*                                                                 07360031
073500***************************************************************** 07370031
073600*  PROCESS CHRG-FCTR-TABLE TO WRITE OUT THE ARRAY DATA TO THE     07380031
073700*  TO THE CHARGE FACTOR CODE FILE                                 07390031
073800***************************************************************** 07400031
073900*                                                                 07410031
074000 C400-CREATE-CHRG-FCTR-CD-FILE.                                   07420031
074100                                                                  07430031
074200     PERFORM VARYING IDX4 FROM 1 BY 1                             07440031
074300        UNTIL IDX4 > 5                                            07450031
074400        INITIALIZE VN203-RECORD                                   07460038
074500        MOVE TBL-CHRG-FCTR-CD (IDX4)   TO                         07470031
074600                                  VN203-CHRG-FCTR-CDE             07480031
074700        MOVE TBL-CHRG-FCTR-DESC (IDX4) TO                         07490031
074800                                  VN203-CHRG-FCTR-DESC            07500031
074900        PERFORM W104-WRITE-CHRG-FCTR-CD-REC                       07510031
075000     END-PERFORM.                                                 07520031
075100                                                                  07530031
075200*                                                                 07540031
075300***************************************************************** 07550031
075400*  PROCESS AGRMT-TYP-TABLE TO WRITE OUT THE ARRAY DATA TO THE     07560031
075500*  TO THE AGREEMENT TYPE CODE FILE                                07570031
075600***************************************************************** 07580031
075700*                                                                 07590031
075800 C500-CREATE-AGRMT-TYP-CD-FILE.                                   07600031
075900                                                                  07610031
076000     PERFORM VARYING IDX5 FROM 1 BY 1                             07620031
076100        UNTIL IDX5 > 5                                            07630031
076200        INITIALIZE VN204-RECORD                                   07640038
076300        MOVE TBL-AGRMT-TYP-CD (IDX5)   TO                         07650031
076400                                  VN204-VND-AGRMT-TYP-CDE         07660031
076500        MOVE TBL-AGRMT-TYP-DESC (IDX5) TO                         07670031
076600                                  VN204-VND-AGRMT-TYP-CDE-DESC    07680031
076700        PERFORM W105-WRITE-AGRMT-TYP-CD-REC                       07690031
076800     END-PERFORM.                                                 07700031
076900                                                                  07710031
077000*                                                                 07720031
077100***************************************************************** 07730031
077200*  PROCESS MDSE-RET-TYP-TABLE TO WRITE OUT THE ARRAY DATA TO THE  07740031
077300*  TO THE DC MERCHANDISE RETURN TYPE CODE FILE                    07750031
077400***************************************************************** 07760031
077500*                                                                 07770031
077600 C600-CREATE-MDSE-RET-TYP-FILE.                                   07780031
077700                                                                  07790031
077800     PERFORM VARYING IDX6 FROM 1 BY 1                             07800031
077900        UNTIL IDX6 > 4                                            07810031
078000        INITIALIZE VN205-RECORD                                   07820038
078100        MOVE TBL-MDSE-RET-TYP-CD (IDX6)   TO                      07830031
078200                                  VN205-DC-MDSE-RET-TYP-CDE       07840031
078300        MOVE TBL-MDSE-RET-TYP-DESC (IDX6) TO                      07850031
078400                                  VN205-DC-MDSE-RET-TYP-DESC      07860031
078500        PERFORM W106-WRITE-MDSE-RET-TYP-CD-REC                    07870031
078600     END-PERFORM.                                                 07880031
078700                                                                  07890031
078800*                                                                 07900031
078900***************************************************************** 07910031
079000*  PROCESS EXENT-ROL-TYP-TABLE TO WRITE OUT THE ARRAY DATA TO THE 07920031
079100*  TO THE EXENT ROLE CODE FILE                                    07930031
079200***************************************************************** 07940031
079300*                                                                 07950031
079400 C700-CREATE-EXENT-ROL-CD-FILE.                                   07960031
079500                                                                  07970031
079600     PERFORM VARYING IDX7 FROM 1 BY 1                             07980031
079700        UNTIL IDX7 > 17                                           07990031
079800        INITIALIZE VN207-RECORD                                   08000038
079900        MOVE TBL-EXENT-ROL-TYP-CD (IDX7)   TO                     08010031
080000                                  VN207-EXENT-ROL-CDE             08020031
080100        MOVE TBL-EXENT-ROL-TYP-DESC (IDX7) TO                     08030031
080200                                  VN207-EXENT-ROL-DESC            08040031
080300        PERFORM W107-WRITE-EXENT-ROL-CD-REC                       08050031
080400     END-PERFORM.                                                 08060031
080500                                                                  08070031
080600*                                                                 08080032
080700***************************************************************** 08090032
080800*  PROCESS PAYTRM_CSR RESULTS.   MOVES RETRIEVED INFORMATION    * 08100033
080900*  TO THE VNRD208 COPYBOOK USED TO WRITE THE OUTPUT FILE        * 08110033
081000***************************************************************** 08120032
081100*                                                                 08130032
081200 C800-CREATE-PAYTRM-EXTRCT.                                       08140033
081300                                                                  08150032
081400     INITIALIZE VN208-RECORD.                                     08160038
081500                                                                  08170038
081600     MOVE PAYTRM-PAY-TERM-ID     TO WS-SMALLINT-UNPK.             08180038
081700     MOVE WS-SMALLINT-UNPK       TO WS-SMALLINT-EDIT.             08190038
081800     MOVE WS-SMALLINT-EDIT       TO VN208-PAYT-TERM-ID.           08200038
081900                                                                  08210038
082000     COMPUTE WS-CHRG-PCT = PAYTRM-DISCOUNT-PCT * 100.             08220038
082100     MOVE WS-CHRG-PCT            TO WS-CHARGE-UNPK.               08230038
082200     MOVE WS-CHARGE-UNPK         TO WS-PERCENT-EDIT.              08240038
082300     MOVE WS-PERCENT-EDIT        TO VN208-PAYT-TERM-DISC-PCT.     08250038
082400                                                                  08260038
082500     MOVE PAYTRM-DISCOUNT-DAYS-QTY TO WS-SMALLINT-UNPK.           08270038
082600     MOVE WS-SMALLINT-UNPK       TO WS-SMALLINT-EDIT.             08280038
082700     MOVE WS-SMALLINT-EDIT       TO VN208-PAYT-TERM-DISC-DAY-QTY. 08290038
082800                                                                  08300038
082900     MOVE PAYTRM-DUE-DAY-QTY     TO WS-SMALLINT-UNPK.             08310038
083000     MOVE WS-SMALLINT-UNPK       TO WS-SMALLINT-EDIT.             08320038
083100     MOVE WS-SMALLINT-EDIT       TO VN208-PAYT-TERM-DUE-DAY-QTY.  08330038
083200                                                                  08340038
083300     MOVE PAYTRM-OTHER-TXT             TO VN208-PAYT-TERM-TXT     08350038
083400     IF PAYTRM-DUE-DAY-FR-DTE-TXT NOT = SPACE                     08360038
083500        MOVE SPACE                     TO VN208-PAYT-TERM-TXT     08370038
083600        MOVE PAYTRM-DUE-DAY-FR-DTE-TXT TO VN208-PAYT-TERM-TXT     08380038
083700     END-IF.                                                      08390038
083800                                                                  08400038
083900     PERFORM W108-WRITE-PAYMENT-TERM-REC.                         08410038
084000     PERFORM R200-FETCH-PAYTRM-CSR.                               08420038
084100                                                                  08430038
084200*                                                                 08440038
084300***************************************************************** 08450038
084400*  PROCESS FRGTRM_CSR RESULTS.   MOVES RETRIEVED INFORMATION    * 08460038
084500*  TO THE VNRD209 COPYBOOK USED TO WRITE THE OUTPUT FILE        * 08470038
084600***************************************************************** 08480038
084700*                                                                 08490038
084800 C900-CREATE-FRGTRM-EXTRCT.                                       08500038
084900                                                                  08510038
085000     INITIALIZE VN209-RECORD.                                     08520038
085100                                                                  08530038
085200     MOVE FRGTRM-FRGT-TERM-ID     TO WS-SMALLINT-UNPK.            08540038
085300     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            08550038
085400     MOVE WS-SMALLINT-EDIT        TO VN209-FRGT-TERM-ID.          08560038
085500                                                                  08570038
085600     COMPUTE WS-CHRG-PCT = FRGTRM-KOHLS-FRGT-PCT * 100.           08580038
085700     MOVE WS-CHRG-PCT             TO WS-CHARGE-UNPK.              08590038
085800     MOVE WS-CHARGE-UNPK          TO WS-PERCENT-EDIT.             08600038
085900     MOVE WS-PERCENT-EDIT         TO VN209-FRGT-TERM-KOHLS-PCT.   08610038
086000                                                                  08620038
086100     COMPUTE WS-CHRG-PCT = FRGTRM-VND-FRGT-PCT * 100.             08630038
086200     MOVE WS-CHRG-PCT             TO WS-CHARGE-UNPK.              08640038
086300     MOVE WS-CHARGE-UNPK          TO WS-PERCENT-EDIT.             08650038
086400     MOVE WS-PERCENT-EDIT         TO VN209-FRGT-TERM-VND-PCT.     08660038
086500                                                                  08670038
086600     PERFORM W109-WRITE-FREIGHT-TERM-REC.                         08680038
086700     PERFORM R300-FETCH-FRGTRM-CSR.                               08690038
086800                                                                  08700038
086900*                                                                 08710038
087000***************************************************************** 08720038
087100* FETCH THE VENDOR REFERENCE INFO FROM THE CPBL_CDE_CSR         * 08730038
087200* CURSOR                                                        * 08740038
087300***************************************************************** 08750038
087400*                                                                 08760038
087500 R100-FETCH-CPBL-CD-CSR.                                          08770038
087600                                                                  08780038
087700     EXEC SQL                                                     08790038
087800         FETCH CPBL_CDE_CSR                                       08800038
087900          INTO :VNT00003-VND-CPBL-CDE                             08810038
088000              ,:VNT00003-VND-CPBL-DESC                            08820038
088100              ,:VNT00003-ACTV-IND                                 08830038
088200              ,:VNT00003-LAST-UPD-BY-USR-ID                       08840038
088300              ,:VNT00003-LAST-UPD-TMST                            08850038
088400     END-EXEC.                                                    08860038
088500                                                                  08870038
088600     EVALUATE TRUE                                                08880038
088700         WHEN SQLCODE = ZERO                                      08890038
088800              ADD 1 TO WS-CPBL-CD-REC-ROWS-FETCHED                08900038
088900         WHEN SQLCODE = +100                                      08910038
089000               SET WS-END-OF-CPBL-CD-CSR TO TRUE                  08920038
089100         WHEN SQLWARN0 NOT = SPACES                               08930038
089200         WHEN SQLCODE  NOT = ZERO                                 08940038
089300           MOVE 'R100-FETCH-CPBL-CD-CSR     '                     08950038
089400                                           TO WS-ABEND-PARAGRAPH  08960038
089500           MOVE 'UNSUCCESSFUL FETCH'       TO WS-ABEND-OPERATION  08970038
089600           MOVE 'VNT00003'               TO WS-ABEND-STRUCTURE-1  08980038
089700           MOVE '       '                TO WS-ABEND-STRUCTURE-2  08990038
089800           PERFORM Z999-SQL-ERROR                                 09000038
089900     END-EVALUATE.                                                09010038
090000                                                                  09020038
090100*                                                                 09030038
090200***************************************************************** 09040038
090300* FETCH THE VENDOR PAYMENT TERMS FROM THE PAYTRM_CSR              09050038
090400***************************************************************** 09060038
090500*                                                                 09070038
090600 R200-FETCH-PAYTRM-CSR.                                           09080038
090700                                                                  09090038
090800     EXEC SQL                                                     09100038
090900         FETCH PAYTRM_CSR                                         09110038
091000          INTO :PAYTRM-PAY-TERM-ID                                09120038
091100              ,:PAYTRM-DISCOUNT-PCT                               09130038
091200              ,:PAYTRM-DISCOUNT-DAYS-QTY                          09140038
091300              ,:PAYTRM-DUE-DAY-QTY                                09150038
091400              ,:PAYTRM-OTHER-TXT                                  09160038
091500              ,:PAYTRM-DUE-DAY-FR-DTE-TXT                         09170038
091600     END-EXEC.                                                    09180038
091700                                                                  09190038
091800     EVALUATE TRUE                                                09200038
091900         WHEN SQLCODE = ZERO                                      09210038
092000              ADD 1 TO WS-PAYMENT-TERM-ROWS-FETCHED               09220038
092100         WHEN SQLCODE = +100                                      09230038
092200               SET WS-END-OF-PAYTRM-CSR TO TRUE                   09240038
092300         WHEN SQLWARN0 NOT = SPACES                               09250038
092400         WHEN SQLCODE  NOT = ZERO                                 09260038
092500           MOVE 'R200-FETCH-PAYTRM-CSR      '                     09270038
092600                                           TO WS-ABEND-PARAGRAPH  09280038
092700           MOVE 'UNSUCCESSFUL FETCH'       TO WS-ABEND-OPERATION  09290038
092800           MOVE 'TPAYTRM '               TO WS-ABEND-STRUCTURE-1  09300038
092900           MOVE '       '                TO WS-ABEND-STRUCTURE-2  09310038
093000           PERFORM Z999-SQL-ERROR                                 09320038
093100     END-EVALUATE.                                                09330038
093200                                                                  09340038
093300*                                                                 09350038
093400***************************************************************** 09360038
093500* FETCH THE VENDOR FREIGHT TERMS FROM THE FRGTRM_CSR              09370038
093600***************************************************************** 09380038
093700*                                                                 09390038
093800 R300-FETCH-FRGTRM-CSR.                                           09400038
093900                                                                  09410038
094000     EXEC SQL                                                     09420038
094100         FETCH FRGTRM_CSR                                         09430038
094200          INTO :FRGTRM-FRGT-TERM-ID                               09440038
094300              ,:FRGTRM-KOHLS-FRGT-PCT                             09450038
094400              ,:FRGTRM-VND-FRGT-PCT                               09460038
094500     END-EXEC.                                                    09470038
094600                                                                  09480038
094700     EVALUATE TRUE                                                09490038
094800         WHEN SQLCODE = ZERO                                      09500038
094900              ADD 1 TO WS-FREIGHT-TERM-ROWS-FETCHED               09510038
095000         WHEN SQLCODE = +100                                      09520038
095100               SET WS-END-OF-FRGTRM-CSR TO TRUE                   09530038
095200         WHEN SQLWARN0 NOT = SPACES                               09540038
095300         WHEN SQLCODE  NOT = ZERO                                 09550038
095400           MOVE 'R300-FETCH-FRGTRM-CSR      '                     09560038
095500                                           TO WS-ABEND-PARAGRAPH  09570038
095600           MOVE 'UNSUCCESSFUL FETCH'       TO WS-ABEND-OPERATION  09580038
095700           MOVE 'TFRGTRM '               TO WS-ABEND-STRUCTURE-1  09590038
095800           MOVE '       '                TO WS-ABEND-STRUCTURE-2  09600038
095900           PERFORM Z999-SQL-ERROR                                 09610038
096000     END-EVALUATE.                                                09620038
096100                                                                  09630038
096200*                                                                 09640038
096300***************************************************************** 09650038
096400* WRITE RETRIEVED INFORMATION TO THE VENDOR CAPABILITIES CODE   * 09660038
096500* EXTRACT RECORD                                                * 09670038
096600***************************************************************** 09680038
096700*                                                                 09690038
096800 W100-WRITE-CPBL-CD-EXTRCT-REC.                                   09700038
096900                                                                  09710038
097000     WRITE CPBL-CD-EXTRCT-REC FROM VN206-RECORD.                  09720038
097100                                                                  09730038
097200     ADD 1 TO WS-CPBL-CD-REC-WRITTEN.                             09740038
097300                                                                  09750038
097400*                                                                 09760038
097500***************************************************************** 09770038
097600* WRITE ARRAY INFORMATION TO THE POSTING FREQUENCY CODE           09780038
097700* RECORD                                                          09790038
097800***************************************************************** 09800038
097900*                                                                 09810038
098000 W101-WRITE-PSTG-FRQ-CD-REC.                                      09820038
098100                                                                  09830038
098200     WRITE PSTG-FRQ-CD-REC FROM VN200-RECORD.                     09840038
098300                                                                  09850038
098400     ADD 1 TO WS-PSTG-FRQ-CD-REC-WRITTEN.                         09860038
098500                                                                  09870038
098600*                                                                 09880038
098700***************************************************************** 09890038
098800* WRITE ARRAY INFORMATION TO THE PROGRAM TYPE CODE                09900038
098900* RECORD                                                          09910038
099000***************************************************************** 09920038
099100*                                                                 09930038
099200 W102-WRITE-PGM-TYP-CD-REC.                                       09940038
099300                                                                  09950038
099400     WRITE PGM-TYP-CD-REC FROM VN201-RECORD.                      09960038
099500                                                                  09970038
099600     ADD 1 TO WS-PGM-TYP-CD-REC-WRITTEN.                          09980038
099700                                                                  09990038
099800*                                                                 10000038
099900***************************************************************** 10010038
100000* WRITE ARRAY INFORMATION TO THE INCENTIVE TYPE CODE              10020038
100100* RECORD                                                          10030038
100200***************************************************************** 10040038
100300*                                                                 10050038
100400 W103-WRITE-INCTV-TYP-CD-REC.                                     10060038
100500                                                                  10070038
100600     WRITE INCTV-TYP-CD-REC FROM VN202-RECORD.                    10080038
100700                                                                  10090038
100800     ADD 1 TO WS-INCTV-TYP-CD-REC-WRITTEN.                        10100038
100900                                                                  10110038
101000*                                                                 10120038
101100***************************************************************** 10130038
101200* WRITE ARRAY INFORMATION TO THE CHARGE FACTOR CODE               10140038
101300* RECORD                                                          10150038
101400***************************************************************** 10160038
101500*                                                                 10170038
101600 W104-WRITE-CHRG-FCTR-CD-REC.                                     10180038
101700                                                                  10190038
101800     WRITE CHRG-FCTR-CD-REC FROM VN203-RECORD.                    10200038
101900                                                                  10210038
102000     ADD 1 TO WS-CHRG-FCTR-CD-REC-WRITTEN.                        10220038
102100                                                                  10230038
102200*                                                                 10240038
102300***************************************************************** 10250038
102400* WRITE ARRAY INFORMATION TO THE AGREEMENT TYPE CODE              10260038
102500* RECORD                                                          10270038
102600***************************************************************** 10280038
102700*                                                                 10290038
102800 W105-WRITE-AGRMT-TYP-CD-REC.                                     10300038
102900                                                                  10310038
103000     WRITE AGRMT-TYP-CD-REC FROM VN204-RECORD.                    10320038
103100                                                                  10330038
103200     ADD 1 TO WS-AGRMT-TYP-CD-REC-WRITTEN.                        10340038
103300                                                                  10350038
103400*                                                                 10360038
103500***************************************************************** 10370038
103600* WRITE ARRAY INFORMATION TO THE DC MERCHANDISE RETURN TYPE       10380038
103700* CODE RECORD                                                     10390038
103800***************************************************************** 10400038
103900*                                                                 10410038
104000 W106-WRITE-MDSE-RET-TYP-CD-REC.                                  10420038
104100                                                                  10430038
104200     WRITE MDSE-RET-TYP-CD-REC FROM VN205-RECORD.                 10440038
104300                                                                  10450038
104400     ADD 1 TO WS-MDSE-RET-TYP-CD-REC-WRITTEN.                     10460038
104500                                                                  10470038
104600*                                                                 10480038
104700***************************************************************** 10490038
104800* WRITE ARRAY INFORMATION TO THE EXENT ROLE CODE                  10500038
104900* RECORD                                                          10510038
105000***************************************************************** 10520038
105100*                                                                 10530038
105200 W107-WRITE-EXENT-ROL-CD-REC.                                     10540038
105300                                                                  10550038
105400     WRITE EXENT-ROL-CD-REC FROM VN207-RECORD.                    10560038
105500                                                                  10570038
105600     ADD 1 TO WS-EXENT-ROL-CD-REC-WRITTEN.                        10580038
105700                                                                  10590038
105800*                                                                 10600038
105900***************************************************************** 10610038
106000* WRITE RETRIEVED INFORMATION TO THE PAYMENT TERMS              * 10620038
106100* EXTRACT RECORD                                                * 10630038
106200***************************************************************** 10640038
106300*                                                                 10650038
106400 W108-WRITE-PAYMENT-TERM-REC.                                     10660038
106500                                                                  10670038
106600     WRITE PAYMENT-TERM-REC FROM VN208-RECORD.                    10680038
106700                                                                  10690038
106800     ADD 1 TO WS-PAYMENT-TERM-REC-WRITTEN.                        10700038
106900                                                                  10710038
107000*                                                                 10720038
107100***************************************************************** 10730038
107200* WRITE RETRIEVED INFORMATION TO THE FREIGHT TERMS              * 10740038
107300* EXTRACT RECORD                                                * 10750038
107400***************************************************************** 10760038
107500*                                                                 10770038
107600 W109-WRITE-FREIGHT-TERM-REC.                                     10780038
107700                                                                  10790038
107800     WRITE FREIGHT-TERM-REC FROM VN209-RECORD.                    10800038
107900                                                                  10810038
108000     ADD 1 TO WS-FREIGHT-TERM-REC-WRITTEN.                        10820038
108100                                                                  10830038
108200*                                                                 10840038
108300***************************************************************** 10850038
108400*  OPEN VENDOR CAPABILITIES CODE CURSOR                         * 10860038
108500***************************************************************** 10870038
108600*                                                                 10880038
108700 Y100-OPEN-CPBL-CD-CSR.                                           10890038
108800                                                                  10900038
108900     PERFORM WITH TEST AFTER                                      10910038
109000        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      10920038
109100          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   10930038
109200             OR SQLCODE = ZERO                                    10940038
109300                                                                  10950038
109400         EXEC SQL                                                 10960038
109500            OPEN CPBL_CDE_CSR                                     10970038
109600         END-EXEC                                                 10980038
109700                                                                  10990038
109800         EVALUATE TRUE                                            11000038
109900             WHEN SQLCODE = ZERO                                  11010038
110000                  CONTINUE                                        11020038
110100             WHEN SQLCODE = -904                                  11030038
110200             WHEN SQLCODE = -913                                  11040038
110300                  CONTINUE                                        11050038
110400             WHEN SQLWARN0 NOT = SPACES                           11060038
110500             WHEN SQLCODE  NOT = ZERO                             11070038
110600                  MOVE 'Y100-OPEN-CPBL-CD-CSR     '               11080038
110700                                           TO WS-ABEND-PARAGRAPH  11090038
110800                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  11100038
110900                  MOVE 'VNT00003'        TO WS-ABEND-STRUCTURE-1  11110038
111000                  MOVE '       '         TO WS-ABEND-STRUCTURE-2  11120038
111100                  PERFORM Z999-SQL-ERROR                          11130038
111200         END-EVALUATE                                             11140038
111300     END-PERFORM.                                                 11150038
111400                                                                  11160038
111500     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           11170038
111600        MOVE 'Y100-OPEN-CPBL-CD-CSR     '                         11180038
111700              TO WS-ABEND-PARAGRAPH                               11190038
111800        MOVE 'MAX RETRIES EXCEEDED ON OPEN'                       11200038
111900              TO WS-ABEND-OPERATION                               11210038
112000        PERFORM Z999-SQL-ERROR                                    11220038
112100     END-IF.                                                      11230038
112200                                                                  11240038
112300*                                                                 11250038
112400****************************************************************  11260038
112500*  CLOSE VENDOR CAPABILITIES CODE CURSOR                       *  11270038
112600****************************************************************  11280038
112700*                                                                 11290038
112800 Y200-CLOSE-CPBL-CD-CSR.                                          11300038
112900                                                                  11310038
113000     EXEC SQL                                                     11320038
113100        CLOSE CPBL_CDE_CSR                                        11330038
113200     END-EXEC.                                                    11340038
113300                                                                  11350038
113400     EVALUATE TRUE                                                11360038
113500         WHEN SQLCODE = ZERO                                      11370038
113600              CONTINUE                                            11380038
113700         WHEN SQLWARN0 NOT = SPACES                               11390038
113800         WHEN SQLCODE  NOT = ZERO                                 11400038
113900              MOVE 'Y200-CLOSE-CBPL-CD-CSR     '                  11410038
114000                                         TO WS-ABEND-PARAGRAPH    11420038
114100              MOVE 'UNSUCCESSFUL CLOSE'  TO WS-ABEND-OPERATION    11430038
114200              MOVE 'VNT00003'            TO WS-ABEND-STRUCTURE-1  11440038
114300              MOVE '       '             TO WS-ABEND-STRUCTURE-2  11450038
114400              PERFORM Z999-SQL-ERROR                              11460038
114500     END-EVALUATE.                                                11470038
114600                                                                  11480038
114700*                                                                 11490038
114800***************************************************************** 11500038
114900*  OPEN VENDOR PAYTRM CURSOR                                      11510038
115000***************************************************************** 11520038
115100*                                                                 11530038
115200 Y300-OPEN-PAYTRM-CSR.                                            11540038
115300                                                                  11550038
115400     PERFORM WITH TEST AFTER                                      11560038
115500        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      11570038
115600          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   11580038
115700             OR SQLCODE = ZERO                                    11590038
115800                                                                  11600038
115900         EXEC SQL                                                 11610038
116000            OPEN PAYTRM_CSR                                       11620038
116100         END-EXEC                                                 11630038
116200                                                                  11640038
116300         EVALUATE TRUE                                            11650038
116400             WHEN SQLCODE = ZERO                                  11660038
116500                  CONTINUE                                        11670038
116600             WHEN SQLCODE = -904                                  11680038
116700             WHEN SQLCODE = -913                                  11690038
116800                  CONTINUE                                        11700038
116900             WHEN SQLWARN0 NOT = SPACES                           11710038
117000             WHEN SQLCODE  NOT = ZERO                             11720038
117100                  MOVE 'Y300-OPEN-PAYTRM-CSR      '               11730038
117200                                           TO WS-ABEND-PARAGRAPH  11740038
117300                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  11750038
117400                  MOVE 'TPAYTRM '        TO WS-ABEND-STRUCTURE-1  11760038
117500                  MOVE '       '         TO WS-ABEND-STRUCTURE-2  11770038
117600                  PERFORM Z999-SQL-ERROR                          11780038
117700         END-EVALUATE                                             11790038
117800     END-PERFORM.                                                 11800038
117900                                                                  11810038
118000     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           11820038
118100        MOVE 'Y300-OPEN-PAYTRM-CSR      '                         11830038
118200              TO WS-ABEND-PARAGRAPH                               11840038
118300        MOVE 'MAX RETRIES EXCEEDED ON OPEN'                       11850038
118400              TO WS-ABEND-OPERATION                               11860038
118500        PERFORM Z999-SQL-ERROR                                    11870038
118600     END-IF.                                                      11880038
118700                                                                  11890038
118800*                                                                 11900038
118900****************************************************************  11910038
119000*  CLOSE VENDOR PAYTRM CURSOR                                     11920038
119100****************************************************************  11930038
119200*                                                                 11940038
119300 Y400-CLOSE-PAYTRM-CSR.                                           11950038
119400                                                                  11960038
119500     EXEC SQL                                                     11970038
119600        CLOSE PAYTRM_CSR                                          11980038
119700     END-EXEC.                                                    11990038
119800                                                                  12000038
119900     EVALUATE TRUE                                                12010038
120000         WHEN SQLCODE = ZERO                                      12020038
120100              CONTINUE                                            12030038
120200         WHEN SQLWARN0 NOT = SPACES                               12040038
120300         WHEN SQLCODE  NOT = ZERO                                 12050038
120400              MOVE 'Y400-CLOSE-PAYTRM-CSR      '                  12060038
120500                                         TO WS-ABEND-PARAGRAPH    12070038
120600              MOVE 'UNSUCCESSFUL CLOSE'  TO WS-ABEND-OPERATION    12080038
120700              MOVE 'TPAYTRM '            TO WS-ABEND-STRUCTURE-1  12090038
120800              MOVE '       '             TO WS-ABEND-STRUCTURE-2  12100038
120900              PERFORM Z999-SQL-ERROR                              12110038
121000     END-EVALUATE.                                                12120038
121100                                                                  12130038
121200*                                                                 12140038
121300***************************************************************** 12150038
121400*  OPEN VENDOR FRGTRM CURSOR                                      12160038
121500***************************************************************** 12170038
121600*                                                                 12180038
121700 Y500-OPEN-FRGTRM-CSR.                                            12190038
121800                                                                  12200038
121900     PERFORM WITH TEST AFTER                                      12210038
122000        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      12220038
122100          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   12230038
122200             OR SQLCODE = ZERO                                    12240038
122300                                                                  12250038
122400         EXEC SQL                                                 12260038
122500            OPEN FRGTRM_CSR                                       12270038
122600         END-EXEC                                                 12280038
122700                                                                  12290038
122800         EVALUATE TRUE                                            12300038
122900             WHEN SQLCODE = ZERO                                  12310038
123000                  CONTINUE                                        12320038
123100             WHEN SQLCODE = -904                                  12330038
123200             WHEN SQLCODE = -913                                  12340038
123300                  CONTINUE                                        12350038
123400             WHEN SQLWARN0 NOT = SPACES                           12360038
123500             WHEN SQLCODE  NOT = ZERO                             12370038
123600                  MOVE 'Y500-OPEN-FRGTRM-CSR      '               12380038
123700                                           TO WS-ABEND-PARAGRAPH  12390038
123800                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  12400038
123900                  MOVE 'TFRGTRM '        TO WS-ABEND-STRUCTURE-1  12410038
124000                  MOVE '       '         TO WS-ABEND-STRUCTURE-2  12420038
124100                  PERFORM Z999-SQL-ERROR                          12430038
124200         END-EVALUATE                                             12440038
124300     END-PERFORM.                                                 12450038
124400                                                                  12460038
124500     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           12470038
124600        MOVE 'Y500-OPEN-FRGTRM-CSR      '                         12480038
124700              TO WS-ABEND-PARAGRAPH                               12490038
124800        MOVE 'MAX RETRIES EXCEEDED ON OPEN'                       12500038
124900              TO WS-ABEND-OPERATION                               12510038
125000        PERFORM Z999-SQL-ERROR                                    12520038
125100     END-IF.                                                      12530038
125200                                                                  12540038
125300*                                                                 12550038
125400****************************************************************  12560038
125500*  CLOSE VENDOR FRGTRM CURSOR                                     12570038
125600****************************************************************  12580038
125700*                                                                 12590038
125800 Y600-CLOSE-FRGTRM-CSR.                                           12600038
125900                                                                  12610038
126000     EXEC SQL                                                     12620038
126100        CLOSE FRGTRM_CSR                                          12630038
126200     END-EXEC.                                                    12640038
126300                                                                  12650038
126400     EVALUATE TRUE                                                12660038
126500         WHEN SQLCODE = ZERO                                      12670038
126600              CONTINUE                                            12680038
126700         WHEN SQLWARN0 NOT = SPACES                               12690038
126800         WHEN SQLCODE  NOT = ZERO                                 12700038
126900              MOVE 'Y600-CLOSE-FRGTRM-CSR      '                  12710038
127000                                         TO WS-ABEND-PARAGRAPH    12720038
127100              MOVE 'UNSUCCESSFUL CLOSE'  TO WS-ABEND-OPERATION    12730038
127200              MOVE 'TFRGTRM '            TO WS-ABEND-STRUCTURE-1  12740038
127300              MOVE '       '             TO WS-ABEND-STRUCTURE-2  12750038
127400              PERFORM Z999-SQL-ERROR                              12760038
127500     END-EVALUATE.                                                12770038
127600                                                                  12780038
127700*                                                                 12790038
127800***************************************************************** 12800038
127900*  PROCESS DB2 ABENDS.                                          * 12810038
128000***************************************************************** 12820038
128100*                                                                 12830038
128200 Z999-SQL-ERROR.                                                  12840038
128300                                                                  12850038
128400     DISPLAY '*** DB2 ERROR '.                                    12860038
128500     DISPLAY '*** PROGRAM   = ' WS-ABEND-PROGRAM.                 12870038
128600     DISPLAY '*** PARAGRAPH = ' WS-ABEND-PARAGRAPH.               12880038
128700     DISPLAY '*** OPERATION = ' WS-ABEND-OPERATION.               12890038
128800     DISPLAY '*** TABLE 1   = ' WS-ABEND-STRUCTURE-1.             12900038
128900     IF WS-ABEND-STRUCTURE-2 > SPACES                             12910038
129000         DISPLAY '*** TABLE 2   = ' WS-ABEND-STRUCTURE-2          12920038
129100     END-IF.                                                      12930038
129200     SET AP-DB2-ERROR              TO TRUE.                       12940038
129300                                                                  12950038
129400     COPY DPPD004.                                                12960038
129500     CALL 'ILBOABN0' USING ABEND-CODE.                            12970038
