      *************************                                         00010004
       IDENTIFICATION DIVISION.                                         00020004
      *************************                                         00030004
       PROGRAM-ID.    MBKCS134.                                         00040004
       AUTHOR.        MIKE FURLICK.                                     00050004
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060004
       DATE-WRITTEN.  11-06-91.                                         00070004
       DATE-COMPILED.                                                   00080004
                                                                        00090004
      ***************************************************************** 00100004
      *    R134 - WORKER RESPONSIBILITY LIST                            00110004
      *                                                                 00120004
      *    THIS PROGRAM GENERATES A LIST OF THE AREAS FOR WHICH A WORKER00130004
      *    HAS AN ASSIGNED RESPONSIBLITY.  TABLES TMDSEAR, TRSPBAR, AND 00140004
      *    TWORKER ARE USED.                                            00150004
      *                                                                 00160004
      *    THE OPERATOR MAY INVOKE THE MERCHANDISE AREA RESPONBIBILITY  00170004
      *    INQUIRY OR UPDATE SCREENS FROM THIS PROGRAM.  AT LEAST ONE   00180004
      *    ITEM MUST BE SELECTED FROM THE LIST TO PASS CONTROL.         00190004
      *                                                                 00200004
      ***************************************************************** 00210004
262978* CHANGED 10/22/2021    BY JIM HUNTER      WR: CHG0262978                 
262978* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
262978* MAKING THE CALL DYNAMIC VS STATIC.                                      
262978******************************************************************        
                                                                        00220004
      *                                                                 00230004
      *                                                                 00240004
      *                                                                 00250004
       ENVIRONMENT DIVISION.                                            00260004
      *                                                                 00270004
      *                                                                 00280004
      *                                                                 00290004
       DATA DIVISION.                                                   00300004
      *                                                                 00310004
      *                                                                 00320004
       WORKING-STORAGE SECTION.                                         00330004
      *                                                                 00340004
       01  PC-PROGRAM-CONSTANTS.                                        00350004
           05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.00360004
           05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  00370004
                                                           COMP SYNC.   00380004
           05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        00390004
           'MB134A  '.                                                  00400004
           05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        00410004
           'MBKM134 '.                                                  00420004
           05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        00430004
           'MBKCS134'.                                                  00440004
           05  PC-BEGINNING                   PIC X(01)    VALUE 'B'.   00450004
           05  PC-ENDING                      PIC X(01)    VALUE 'E'.   00460004
           05  PC-SELECTED                    PIC X(01)    VALUE 'S'.   00470004
           05  PC-ITEMS-PER-PANEL             PIC S9(04)   VALUE +11    00480004
                                                           COMP SYNC.   00490004
           05  PC-ITEMS-PER-BLOCK             PIC S9(04)   VALUE +20    00500004
                                                           COMP SYNC.   00510004
           05  PC-MAX-ITEMS-TO-BE-READ        PIC S9(04)   VALUE +100   00520004
                                                           COMP SYNC.   00530004
           05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)   VALUE +2     00540004
                                                           COMP SYNC.   00550004
           05  PC-MAX-WR-ITEMS                PIC S9(03)   VALUE +200   00560004
                                                           COMP-3.      00570004
           05  PC-MAX-ITEMS                   PIC S9(09)   VALUE        00580004
                                                           +1000000     00590004
                                                           COMP-3.      00600004
           05  PC-BLOCK-LENGTH                PIC S9(04)   VALUE +1314  00610004
                                                           COMP SYNC.   00620004
           05  PC-FIELD-LENGTH                PIC S9(04)   VALUE +5     00630004
                                                           COMP SYNC.   00640004
           05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   00650004
                                                           COMP SYNC.   00660004
           05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      00670004
               10  FILLER                     PIC X(01).                00680004
               10  PC-ERASE-EOF               PIC X(01).                00690004
           05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      00700004
                                                           COMP-3.      00710004
           05  PC-COMPANY                     PIC X(2)     VALUE '03'.  00720004
           05  PC-GMA                         PIC X(3)     VALUE 'GMA'. 00730004
           05  PC-DMA                         PIC X(3)     VALUE 'DMA'. 00740004
           05  PC-DPT                         PIC X(3)     VALUE 'DPT'. 00750004
           05  PC-MCL                         PIC X(3)     VALUE 'MCL'. 00760004
           05  PC-SCL                         PIC X(3)     VALUE 'SCL'. 00770004
           05  PC-NO-DISPLAY-DATE             PIC X(10)    VALUE        00780004
                                                           '9999-09-09'.00790004
      *                                                                 00800004
       01  PC-TSYMSG-NUMBERS.                                           00810004
           05  PC-TSYMSG-00005                PIC 9(5)    VALUE 00005.  00820004
           05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  00830004
           05  PC-TSYMSG-00045                PIC 9(5)    VALUE 00045.  00840004
           05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  00850004
           05  PC-TSYMSG-00051                PIC 9(5)    VALUE 00051.  00860004
           05  PC-TSYMSG-00052                PIC 9(5)    VALUE 00052.  00870004
           05  PC-TSYMSG-00053                PIC 9(5)    VALUE 00053.  00880004
           05  PC-TSYMSG-00054                PIC 9(5)    VALUE 00054.  00890004
           05  PC-TSYMSG-00055                PIC 9(5)    VALUE 00055.  00900004
           05  PC-TSYMSG-00057                PIC 9(5)    VALUE 00057.  00910004
           05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  00920004
           05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  00930004
           05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.  00940004
           05  PC-TSYMSG-00146                PIC 9(5)    VALUE 00146.  00950004
           05  PC-TSYMSG-00207                PIC 9(5)    VALUE 00207.  00960004
           05  PC-TSYMSG-99901                PIC 9(5)    VALUE 99901.  00970004
      *                                                                 00980004
       01  PM-PROGRAM-MESSAGES.                                         00990004
           05  PM-PROGRAM-MESSAGE-9           PIC X(78)    VALUE        01000004
           'ERROR TRYING TO REWRITE  TEMP STORAGE QUEUE - RESP '.       01010004
           05  FILLER REDEFINES PM-PROGRAM-MESSAGE-9.                   01020004
               10  FILLER                     PIC X(51).                01030004
               10  PM-RESP-9                  PIC Z(03)9-.              01040004
               10  FILLER                     PIC X(22).                01050004
           05  PM-PROGRAM-MESSAGE-10          PIC X(78)    VALUE        01060004
           'ERROR TRYING TO WRITE TO TEMP STORAGE QUEUE - RESP '.       01070004
           05  FILLER REDEFINES PM-PROGRAM-MESSAGE-10.                  01080004
               10  FILLER                     PIC X(51).                01090004
               10  PM-RESP-10                 PIC Z(03)9-.              01100004
               10  FILLER                     PIC X(22).                01110004
           05  PM-PROGRAM-MESSAGE-11          PIC X(78)    VALUE        01120004
           'LOGIC ERROR IN TRYING TO WRITE TO TEMP STORAGE QUEUE - BLOCK01130004
      -    '     '.                                                     01140004
           05  FILLER REDEFINES PM-PROGRAM-MESSAGE-11.                  01150004
               10  FILLER                     PIC X(61).                01160004
               10  PM-BLOCK-NUMBER            PIC Z(03)9-.              01170004
               10  FILLER                     PIC X(12).                01180004
           05  PM-PROGRAM-MESSAGE-12          PIC X(78)    VALUE        01190004
           'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                01200004
           05  PM-PROGRAM-MESSAGE-23          PIC X(78)    VALUE        01210004
           'ERROR TRYING TO DELETE TEMP STORAGE QUEUE - RESP '.         01220004
           05  FILLER REDEFINES PM-PROGRAM-MESSAGE-23.                  01230004
               10  FILLER                     PIC X(49).                01240004
               10  PM-RESP-23                 PIC Z(03)9-.              01250004
               10  FILLER                     PIC X(24).                01260004
           05  PM-PROGRAM-MESSAGE-24          PIC X(78)    VALUE        01270004
           'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE - RESP '.      01280004
           05  FILLER REDEFINES PM-PROGRAM-MESSAGE-24.                  01290004
               10  FILLER                     PIC X(52).                01300004
               10  PM-RESP-24                 PIC Z(03)9-.              01310004
               10  FILLER                     PIC X(21).                01320004
           05  PM-PROGRAM-MESSAGE-28          PIC X(78)    VALUE        01330004
           'ERROR OCCURRED DURING TS QUEUE PROCESSING'.                 01340004
      *                                                                 01350004
       01  PS-PROGRAM-SUBSCRIPTS.                                       01360004
           05  PS-SUB                         PIC S9(04)   VALUE +0     01370004
                                                           COMP SYNC.   01380004
           05  PS-SUB1                        PIC S9(04)   VALUE +0     01390004
                                                           COMP SYNC.   01400004
           05  PS-SUB2                        PIC S9(04)   VALUE +0     01410004
                                                           COMP SYNC.   01420004
           05  PS-ITEM-SUB                    PIC S9(09)   VALUE +0     01430004
                                                           COMP-3.      01440004
                                                                        01450004
       01  PS-PROGRAM-SWITCHES.                                         01460004
           05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   01470004
               88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   01480004
               88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   01490004
               88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   01500004
               88  PS-SEND-DATA-ONLY                       VALUE '4'.   01510004
               88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   01520004
               88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   01530004
           05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   01540004
               88  PS-ERROR                                VALUE 'Y'.   01550004
               88  PS-NO-ERROR                             VALUE 'N'.   01560004
           05  PS-INTER-APPL-VALID-SW         PIC X(01)    VALUE 'N'.   01570004
               88  PS-INTER-APPL-VALID                     VALUE 'Y'.   01580004
               88  PS-INTER-APPL-NOT-VALID                 VALUE 'N'.   01590004
           05  PS-SAME-ITEMS-DISPLAYED-SW     PIC X(01)    VALUE 'N'.   01600004
               88  PS-SAME-ITEMS-DISPLAYED                 VALUE 'Y'.   01610004
               88  PS-DIFFERENT-ITEMS-DISPLAYED            VALUE 'N'.   01620004
           05  PS-CURSOR-POSITIONED-SW        PIC X(01)    VALUE 'N'.   01630004
               88  PS-CURSOR-POSITIONED                    VALUE 'Y'.   01640004
               88  PS-CURSOR-NOT-POSITIONED                VALUE 'N'.   01650004
           05  PS-VALID-SELECTIONS-SW         PIC X(01)    VALUE 'Y'.   01660004
               88  PS-VALID-SELECTIONS                     VALUE 'Y'.   01670004
               88  PS-INVALID-SELECTIONS                   VALUE 'N'.   01680004
           05  PS-VALID-BEG-ITEM-SW           PIC X(01)    VALUE 'N'.   01690004
               88  PS-VALID-BEG-ITEM                       VALUE 'Y'.   01700004
               88  PS-INVALID-BEG-ITEM                     VALUE 'N'.   01710004
           05  PS-TOP-ITEM-IN-ARRAY-SW        PIC X(01)    VALUE 'N'.   01720004
               88  PS-TOP-ITEM-IN-ARRAY                    VALUE 'Y'.   01730004
               88  PS-TOP-ITEM-NOT-IN-ARRAY                VALUE 'N'.   01740004
           05  PS-BOTTOM-ITEM-IN-ARRAY-SW     PIC X(01)    VALUE 'N'.   01750004
               88  PS-BOTTOM-ITEM-IN-ARRAY                 VALUE 'Y'.   01760004
               88  PS-BOTTOM-ITEM-NOT-IN-ARRAY             VALUE 'N'.   01770004
           05  PS-TOP-ITEM-IN-TEMP-SW         PIC X(01)    VALUE 'N'.   01780004
               88  PS-TOP-ITEM-IN-TEMP                     VALUE 'Y'.   01790004
               88  PS-TOP-ITEM-NOT-IN-TEMP                 VALUE 'N'.   01800004
           05  PS-BOTTOM-ITEM-IN-TEMP-SW      PIC X(01)    VALUE 'N'.   01810004
               88  PS-BOTTOM-ITEM-IN-TEMP                  VALUE 'Y'.   01820004
               88  PS-BOTTOM-ITEM-NOT-IN-TEMP              VALUE 'N'.   01830004
           05  PS-LAST-BLOCK-IN-ARRAY-SW      PIC X(01)    VALUE 'N'.   01840004
               88  PS-LAST-BLOCK-IN-ARRAY                  VALUE 'Y'.   01850004
               88  PS-LAST-BLOCK-NOT-IN-ARRAY              VALUE 'N'.   01860004
           05  PS-SELECTION-FOUND-SW          PIC X(01)    VALUE 'N'.   01870004
               88  PS-SELECTION-FOUND                      VALUE 'Y'.   01880004
               88  PS-NO-SELECTION-FOUND                   VALUE 'N'.   01890004
           05  PS-WARNING-SW                  PIC X(01)    VALUE 'N'.   01900004
               88  PS-WARNING                              VALUE 'Y'.   01910004
               88  PS-NO-WARNING                           VALUE 'N'.   01920004
           05  PS-INFORMATIONAL-SW            PIC X(01)    VALUE 'N'.   01930004
               88  PS-INFORMATIONAL                        VALUE 'Y'.   01940004
               88  PS-NOT-INFORMATIONAL                    VALUE 'N'.   01950004
           05  PS-PROCESSING-SW               PIC X(01)    VALUE 'N'.   01960004
               88  PS-CONTINUE                             VALUE 'Y'.   01970004
               88  PS-DONT-PROCESS                         VALUE 'N'.   01980004
           05  PS-PROCESS-ITEM-SW             PIC X(01)    VALUE 'N'.   01990004
               88  PS-END-OF-ITEMS                         VALUE 'Y'.   02000004
               88  PS-NOT-END                              VALUE 'N'.   02010004
           05  PS-HISTORY-SELECT-SW           PIC X(01)    VALUE 'N'.   02020004
               88  PS-HISTORY-SELECTED                     VALUE 'Y'.   02030004
               88  PS-DIDNT-SELECT-HISTORY                 VALUE 'N'.   02040004
           05  PS-COMMAREA-SW                 PIC X(01)    VALUE 'N'.   02050004
               88  PS-COMMAREA-VALID                       VALUE 'Y'.   02060004
               88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   02070004
           EJECT                                                        02080004
       01  PV-PROGRAM-VARIABLES.                                        02090004
           05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     02100004
                                                           COMP SYNC.   02110004
           05  PV-HIGHEST-ITEM-TO-BE-READ     PIC S9(09)   VALUE +0     02120004
                                                           COMP-3.      02130004
           05  PV-ENDING-ITEM-ON-PANEL        PIC S9(09)   VALUE +0     02140004
                                                           COMP-3.      02150004
           05  PV-ITEM-IN-USE                 PIC S9(09)   VALUE +0     02160004
                                                           COMP-3.      02170004
           05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     02180004
                                                           COMP-3.      02190004
           05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     02200004
                                                           COMP-3.      02210004
           05  PV-MAX-ITEMS-TO-BE-READ        PIC S9(09)   VALUE +0     02220004
                                                           COMP-3.      02230004
           05  PV-FIRST-ITEM-IN-ARRAY         PIC S9(09)   VALUE +0     02240004
                                                           COMP-3.      02250004
           05  PV-LAST-ITEM-IN-ARRAY          PIC S9(09)   VALUE +0     02260004
                                                           COMP-3.      02270004
           05  PV-LAST-ITEM-IN-TEMP           PIC S9(09)   VALUE +0     02280004
                                                           COMP-3.      02290004
           05  PV-BEGINNING-ITEM              PIC S9(09)   VALUE +0     02300004
                                                           COMP-3.      02310004
           05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)   VALUE +0     02320004
                                                           COMP-3.      02330004
           05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     02340004
                                                           COMP SYNC.   02350004
           05  PV-RESP                        PIC S9(04)   VALUE +0     02360004
                                                           COMP SYNC.   02370004
           05  PV-ITEM                        PIC S9(04)   VALUE +0     02380004
                                                           COMP SYNC.   02390004
           05  PV-WR-ITEM                     PIC S9(04)   VALUE +0     02400004
                                                           COMP SYNC.   02410004
           05  PV-SAVE-ITEM                   PIC S9(04)   VALUE +0     02420004
                                                           COMP SYNC.   02430004
           05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     02440004
                                                           COMP SYNC.   02450004
           05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     02460004
                                                           COMP SYNC.   02470004
           05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)   VALUE +0     02480004
                                                           COMP SYNC.   02490004
           05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)   VALUE +0     02500004
                                                           COMP SYNC.   02510004
           05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)   VALUE +0     02520004
                                                           COMP SYNC.   02530004
           05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)   VALUE +0     02540004
                                                           COMP SYNC.   02550004
           05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)   VALUE +0     02560004
                                                           COMP SYNC.   02570004
           05  PV-START-OF-SELECTED-RANGE     PIC S9(04)   VALUE +0     02580004
                                                           COMP SYNC.   02590004
           05  PV-END-OF-SELECTED-RANGE       PIC S9(04)   VALUE +0     02600004
                                                           COMP SYNC.   02610004
           05  PV-ITEMS-READ                  PIC S9(04)   VALUE +0     02620004
                                                           COMP SYNC.   02630004
           05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.02640004
           05  PV-SQL-SUB                     PIC S9(4)    COMP.        02650004
           05  PV-RETRY-COUNTER               PIC S9(3)    COMP-3.      02660004
           05  PV-BEGITMI.                                              02670004
               10  PV-BEGITMI-N               PIC 9(5).                 02680004
           05  PV-DISPLAY5                    PIC ZZZZ9.                02690004
           05  PV-BG-QUEUE-NAME.                                        02700004
               10  PV-BG-TERM-ID              PIC X(4).                 02710004
               10  PV-BG-TASK-NUMBER          PIC S9(7)    COMP-3.      02720004
      *                                                                 02730004
           05  PV-DB2-HISTORY-DATE            PIC X(10)  VALUE          02740004
               '1900-01-01'.                                            02750004
           05  PV-DB2-CURRENT-DATE            PIC X(10).                02760004
           05  PV-WORK-DATE.                                            02770004
               10  PV-WD-MM                   PIC XX.                   02780004
               10  FILLER                     PIC X      VALUE '/'.     02790004
               10  PV-WD-DD                   PIC XX.                   02800004
               10  FILLER                     PIC X      VALUE '/'.     02810004
               10  PV-WD-YY                   PIC XX.                   02820004
      *                                                                 02830004
       01  PV-DB2-DATE                        PIC X(10).                02840004
       01  FILLER REDEFINES PV-DB2-DATE.                                02850004
           05  PV-DD-CC                       PIC XX.                   02860004
           05  PV-DD-YY                       PIC XX.                   02870004
           05  FILLER                         PIC X.                    02880004
           05  PV-DD-MM                       PIC XX.                   02890004
           05  FILLER                         PIC X.                    02900004
           05  PV-DD-DD                       PIC XX.                   02910004
      *                                                                 02920004
       01  PV-TEMP-WORK-AREA.                                           02930004
           05  PV-BLOCK-MODIFIED              PIC X.                    02940004
           05  PV-TW-ITEM-ENTRIES OCCURS 20 TIMES                       02950004
                                  INDEXED BY PV-TW-IDX.                 02960004
               10  PV-TW-LIST-ITEM-NUMBER     PIC S9(9)    COMP-3.      02970004
               10  PV-TW-SELECTED-SW          PIC X.                    02980004
                   88  PV-TW-SELECT                        VALUE 'S'.   02990004
                   88  PV-TW-DESELECT                      VALUE ' '.   03000004
               10  PV-TW-RESP-LEVEL           PIC X(3).                 03010004
               10  PV-TW-START-DATE           PIC X(8).                 03020004
               10  PV-TW-END-DATE             PIC X(8).                 03030004
               10  PV-TW-RESP-DESC            PIC X(25).                03040004
               10  PV-TW-COLOR                PIC X.                    03050004
               10  PV-TW-GMA                  PIC XX.                   03060004
               10  PV-TW-DMA                  PIC XX.                   03070004
               10  PV-TW-DEPT                 PIC X(3).                 03080004
               10  PV-TW-AAA                  PIC X(3).                 03090004
               10  PV-TW-MDSELV               PIC X(3).                 03100004
      *                                                                 03110004
       EJECT                                                            03120004
      ***************************************************************** 03130004
      *    STANDARD COMMAREA.                                           03140004
      ***************************************************************** 03150004
                                                                        03160004
           COPY DPWS020.                                                03170004
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03180004
                                                                        03190004
      ***************************************************************** 03200004
      *    INTER-APPLICATION COMMAREA.                                  03210004
      ***************************************************************** 03220004
                                                                        03230004
               10  INTER-APPL-COMM-AREA       PIC X(200).               03240004
           COPY MBWS005.                                                03250004
      ***************************************************************** 03260004
      *    SPECIFIC COMMMAREA FOR MBKCS134.                             03270004
      ***************************************************************** 03280004
               10  MB134-SPECIFIC-COMMAREA.                             03290004
                   15  MB134-APPL-CURSOR-POSITION          PIC S9(04)   03300004
                                                           COMP.        03310004
                   15  MB134-BLOCK-ENTRIES OCCURS 2 TIMES.              03320004
                       20  MB134-BLOCK-MODIFIED-SW         PIC X(01).   03330004
                           88  MB134-BLOCK-NOT-MODIFIED    VALUE 'N'.   03340004
                           88  MB134-BLOCK-MODIFIED        VALUE 'Y'.   03350004
                       20  MB134-ITEM-ARRAY.                            03360004
                           25  MB134-ITEM-ENTRIES OCCURS 20 TIMES.      03370004
                               30  MB134-LIST-ITEM-NUMBER               03380004
                                                           PIC S9(09)   03390004
                                                               COMP-3.  03400004
                               30  MB134-SELECTED-SW       PIC X(01).   03410004
                                   88  MB134-NO-SELECT     VALUE ' '.   03420004
                                   88  MB134-SELECT        VALUE 'S'.   03430004
                                   88  MB134-BEGIN         VALUE 'B'.   03440004
                                   88  MB134-END           VALUE 'E'.   03450004
                               30  MB134-RESP-LEVEL        PIC XXX.     03460004
                               30  MB134-START-DATE        PIC X(8).    03470004
                               30  MB134-END-DATE          PIC X(8).    03480004
                               30  MB134-RESP-DESC         PIC X(25).   03490004
                               30  MB134-COLOR             PIC X.       03500004
                               30  MB134-GMA               PIC XX.      03510004
                               30  MB134-DMA               PIC XX.      03520004
                               30  MB134-DEPT              PIC X(3).    03530004
                               30  MB134-AAA               PIC X(3).    03540004
                               30  MB134-MDSELV            PIC X(3).    03550004
      *                                                                 03560004
                   15  MB134-BLK-SUB                       PIC S9(04)   03570004
                                                               COMP     03580004
                                                               SYNC.    03590004
                   15  MB134-ITEM-SUB                      PIC S9(04)   03600004
                                                               COMP     03610004
                                                               SYNC.    03620004
                   15  MB134-NUMBER-OF-ITEMS-READ          PIC S9(09)   03630004
                                                               COMP-3.  03640004
                   15  MB134-NUMBER-OF-SELECTED-ITEMS      PIC S9(09)   03650004
                                                               COMP-3.  03660004
                   15  MB134-ITEM-AT-TOP-OF-PANEL          PIC S9(09)   03670004
                                                               COMP-3.  03680004
                   15  MB134-ITEM-AT-BOT-OF-PANEL          PIC S9(09)   03690004
                                                               COMP-3.  03700004
                   15  MB134-HIGHEST-BLOCK-WRITTEN         PIC S9(04)   03710004
                                                               COMP     03720004
                                                               SYNC.    03730004
                   15  MB134-START-OF-SELECTED-RANGE       PIC S9(09)   03740004
                                                               COMP-3.  03750004
                   15  MB134-END-OF-SELECTED-RANGE         PIC S9(09)   03760004
                                                               COMP-3.  03770004
                   15  MB134-ITEMS-LEFT-INDICATOR          PIC X.       03780004
                       88  MB134-ITEMS-LEFT-ON-DB            VALUE 'Y'. 03790004
                       88  MB134-NO-ITEMS-LEFT-ON-DB         VALUE 'N'. 03800004
                   15  MB134-TEMP-QUEUE-UPDATE-SW          PIC X.       03810004
                       88  MB134-UPDATE-TSQ                  VALUE 'Y'. 03820004
                       88  MB134-NO-TSQ-UPDATE               VALUE 'N'. 03830004
                   15  MB134-TEMP-QUEUE-NAME.                           03840004
                       20  MB134-TERM-ID                   PIC X(4).    03850004
                       20  MB134-TASK-NUMBER               PIC S9(7)    03860004
                                                               COMP-3.  03870004
                   15  MB134-WORKER-NUMBER                 PIC S9(7)    03880004
                                                               COMP-3.  03890004
                   15  MB134-LAST-NAME                     PIC X(18).   03900004
                   15  MB134-FIRST-NAME                    PIC X(12).   03910004
                   15  MB134-AAA-HEADING                   PIC X(3).    03920004
                   15  MB134-LIST-QUEUE-NAME               PIC X(8).    03930004
                   15  MB134-SAVE-INTER-APPL-COMMAREA      PIC X(200).  03940004
      *                                                                 03950004
           EJECT                                                        03960004
      ***************************************************************** 03970004
      *    APPLICATION SYSTEM TS QUEUE RECORD LAYOUT.                   03980004
      ***************************************************************** 03990004
       01 RSPBAR-RECORD.                                                04000004
           COPY MBWS003.                                                04010004
                                                                        04020004
      *                                                                 04030004
           EJECT                                                        04040004
      ***************************************************************** 04050004
      *    WORKING STORAGE AREA FOR PROCEDURE DIVISION COPYBOOK         04060004
      *    DPPD005.                                                     04070004
      ***************************************************************** 04080004
                                                                        04090004
           COPY DPWS006.                                                04100004
                                                                        04110004
           EJECT                                                        04120004
      ***************************************************************** 04130004
      *    ABEND PROCESSING COPYBOOK.                                   04140004
      ***************************************************************** 04150004
                                                                        04160004
           COPY DPWS013.                                                04170004
                                                                        04180004
           EJECT                                                        04190004
      ***************************************************************** 04200004
      *    ATTRIBUTE SETTINGS COPYBOOK.                                 04210004
      ***************************************************************** 04220004
                                                                        04230004
           COPY DPWS015.                                                04240004
                                                                        04250004
      ***************************************************************** 04260004
      *    CURRENT DATE AND TIME COPYBOOK.                              04270004
      ***************************************************************** 04280004
                                                                        04290004
           COPY DPWS017.                                                04300004
                                                                        04310004
      ***************************************************************** 04320004
      *    TOGGLE FUNCTION KEY LINES COPYBOOK.                          04330004
      ***************************************************************** 04340004
                                                                        04350004
           COPY DPWS009.                                                04360004
                                                                        04370004
      ***************************************************************** 04380004
      *    FUNCTION KEYS COPYBOOK.                                      04390004
      ***************************************************************** 04400004
                                                                        04410004
           COPY DPWS016.                                                04420004
                                                                        04430004
      ***************************************************************** 04440004
      *    DPKUT045 COPYBOOK.                                           04450004
      ***************************************************************** 04460004
                                                                        04470004
           COPY DPWS045.                                                04480004
                                                                        04490004
      ***************************************************************** 04500004
      *    NUMERIC EDIT LAYOUT.                                         04510004
      ***************************************************************** 04520004
                                                                        04530004
           COPY DPWS010I.                                               04540004
                                                                        04550004
      ***************************************************************** 04560004
      *    MESSAGE RECORD LAYOUT                                        04570004
      ***************************************************************** 04580004
                                                                        04590004
           COPY DPRD507I.                                               04600004
                                                                        04610004
      ***************************************************************** 04620004
      *    STANDARD ATTENTION IDENTIFIER LIST                           04630004
      ***************************************************************** 04640004
                                                                        04650004
           COPY DFHAID.                                                 04660004
                                                                        04670004
      ***************************************************************** 04680004
      *    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        04690004
      ***************************************************************** 04700004
                                                                        04710004
           COPY DFHBMSCA.                                               04720004
                                                                        04730004
      ***************************************************************** 04740004
      *    MAP LAYOUT                                                   04750004
      ***************************************************************** 04760004
                                                                        04770004
           COPY MBKM134.                                                04780004
       01  MD-MAP-DATA-AREA  REDEFINES MB134AO PIC X(1400).             04790004
      *                                                                 04800004
       01  MBKM134-OCCURS-LAYOUT  REDEFINES  MD-MAP-DATA-AREA.          04810004
           05  FILLER                PIC X(195).                        04820004
           05  MBKM134-SCROLL-AREA OCCURS 11 TIMES.                     04830004
               10  MBKM134-SELECTL   PIC S9(4) COMP.                    04840004
               10  MBKM134-SELECTA   PIC X.                             04850004
               10  MBKM134-SELECTC   PIC X.                             04860004
               10  MBKM134-SELECTH   PIC X.                             04870004
               10  MBKM134-SELECTI   PIC X.                             04880004
      *                                                                 04890004
               10  FILLER            PIC X(3).                          04900004
               10  MBKM134-RESP-LEVELC                                  04910004
                                     PIC X.                             04920004
               10  MBKM134-RESP-LEVELH                                  04930004
                                     PIC X.                             04940004
               10  MBKM134-RESP-LEVEL                                   04950004
                                     PIC X(3).                          04960004
      *                                                                 04970004
               10  FILLER            PIC X(3).                          04980004
               10  MBKM134-START-DATEC                                  04990004
                                     PIC X.                             05000004
               10  MBKM134-START-DATEH                                  05010004
                                     PIC X.                             05020004
               10  MBKM134-START-DATE                                   05030004
                                     PIC X(8).                          05040004
      *                                                                 05050004
               10  FILLER            PIC X(3).                          05060004
               10  MBKM134-END-DATEC PIC X.                             05070004
               10  MBKM134-END-DATEH PIC X.                             05080004
               10  MBKM134-END-DATE  PIC X(8).                          05090004
      *                                                                 05100004
               10  FILLER            PIC X(3).                          05110004
               10  MBKM134-AREAC     PIC X.                             05120004
               10  MBKM134-AREAH     PIC X.                             05130004
               10  MBKM134-AREA      PIC X(3).                          05140004
      *                                                                 05150004
               10  FILLER            PIC X(3).                          05160004
               10  MBKM134-AREA-DESCC                                   05170004
                                     PIC X.                             05180004
               10  MBKM134-AREA-DESCL                                   05190004
                                     PIC X.                             05200004
               10  MBKM134-AREA-DESC PIC X(25).                         05210004
       EJECT                                                            05220004
      *                                                                 05230004
      *    DB2 AREA FOR TMDSEAR                                         05240004
      *                                                                 05250004
           EXEC SQL                                                     05260004
                INCLUDE TMDSEAR                                         05270004
           END-EXEC.                                                    05280004
      *                                                                 05290004
      *    DB2 AREA FOR TRSPBAR                                         05300004
      *                                                                 05310004
           EXEC SQL                                                     05320004
                INCLUDE TRSPBAR                                         05330004
           END-EXEC.                                                    05340004
      *                                                                 05350004
      *    DB2 AREA FOR TWORKER                                         05360004
      *                                                                 05370004
           EXEC SQL                                                     05380004
                INCLUDE TWORKER                                         05390004
           END-EXEC.                                                    05400004
      *                                                                 05410004
      *    DB2 AREA FOR COMMUNICATIONS                                  05420004
      *                                                                 05430004
           EXEC SQL                                                     05440004
                INCLUDE SQLCA                                           05450004
           END-EXEC.                                                    05460004
      *                                                                 05470004
      *    CURSOR DECLARE FOR TRSPBAR                                   05480004
      *                                                                 05490004
           EXEC SQL                                                     05500004
                DECLARE WORKER-LIST CURSOR                              05510004
                FOR SELECT                                              05520004
                    A.GMA_NBR,                                          05530004
                    A.DMA_NBR,                                          05540004
                    A.DEPT_NBR,                                         05550004
                    A.MDSEAR_DESC,                                      05560004
                    A.MDSELV_CDE,                                       05570004
                    A.LIST_SEQ_NBR,                                     05580004
                    R.RSPLVL_CDE,                                       05590004
                    R.WORKER_STRT_DTE,                                  05600004
                    R.WORKER_END_DTE                                    05610004
                FROM                                                    05620004
                    TMDSEAR A,                                          05630004
                    TRSPBAR R                                           05640004
                WHERE                                                   05650004
                        A.OPERCO_NBR      =  :PC-COMPANY                05660004
                  AND   A.MDSEAR_DKEY     =  R.MDSEAR_DKEY              05670004
                  AND   R.WORKER_END_DTE  >  :PV-DB2-DATE               05680004
                  AND   R.WORKER_NBR      =  :MB134-WORKER-NUMBER       05690004
                ORDER BY                                                05700004
                        R.RSPLVL_CDE,                                   05710004
                        R.WORKER_STRT_DTE,                              05720004
                        R.WORKER_END_DTE,                               05730004
                        A.LIST_SEQ_NBR                                  05740004
           END-EXEC.                                                    05750004
      *                                                                 05760004
       EJECT                                                            05770004
       LINKAGE SECTION.                                                 05780004
                                                                        05790004
       01  DFHCOMMAREA.                                                 05800004
           05  FILLER                         OCCURS  1 TO 4072 TIMES   05810004
                                              DEPENDING ON EIBCALEN.    05820004
               10  FILLER                     PIC X.                    05830004
                                                                        05840004
      *                                                                 05850004
      *                                                                 05860004
      *                                                                 05870004
       PROCEDURE DIVISION.                                              05880004
                                                                        05890004
                                                                        05900004
       A100-MAIN-MODULE.                                                05910004
                                                                        05920004
      ******************************************************************05930004
      *    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.           05940004
      ******************************************************************05950004
                                                                        05960004
           PERFORM DP015-0000-CHECK-COMMAREA.                           05970004
                                                                        05980004
           IF DP020-SRC-RETURN-W-TRAN-ID                                05990004
               PERFORM B100-CONTROL-PROCESSING                          06000004
           END-IF.                                                      06010004
                                                                        06020004
           PERFORM DP003-0000-RETURN-TO-CICS.                           06030004
       EJECT                                                            06040004
      ******************************************************************06050004
      *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    06060004
      *    COURSE OF ACTION IS FOR THIS TRANSACTION.                    06070004
      *                                                                 06080004
      *    PERFORMED BY A100-MAIN-MODULE.                               06090004
      ******************************************************************06100004
      *                                                                 06110004
       B100-CONTROL-PROCESSING.                                         06120004
      *                                                                 06130004
           SET PS-CONTINUE           TO  TRUE.                          06140004
           MOVE LENGTH OF MB134-BLOCK-ENTRIES (1)                       06150004
                                     TO  PC-BLOCK-LENGTH.               06160004
           EVALUATE TRUE                                                06170004
               WHEN DP020-NEXT-ACT-INITIAL                              06180004
                   PERFORM C100-VALIDATE-COMMAREA                       06190004
                   IF  PS-COMMAREA-NOT-VALID                            06200004
                       MOVE PC-TSYMSG-99901                             06210004
                                     TO  DP020-MSG-NUMBER               06220004
                       SET DP020-MSG-FATAL                              06230004
                                     TO  TRUE                           06240004
                       MOVE DP016-PF3                                   06250004
                                     TO  DP020-SRC-AID                  06260004
                       PERFORM DP015-1000-START-NAVIGATOR               06270004
                   ELSE                                                 06280004
                       INITIALIZE MB134-SPECIFIC-COMMAREA               06290004
                       SET PS-CONTINUE                                  06300004
                                     TO  TRUE                           06310004
                       SET PS-SEND-MAP-N-DATA-FRSET                     06320004
                                     TO  TRUE                           06330004
                       SET DP020-NEXT-ACT-READ-MAP                      06340004
                                     TO  TRUE                           06350004
                       PERFORM D100-SETUP-INIT-PANEL                    06360004
                   END-IF                                               06370004
      *                                                                 06380004
               WHEN DP020-NEXT-ACT-READ-MAP                             06390004
                   PERFORM C300-PROCESS-PANEL                           06400004
      *                                                                 06410004
               WHEN DP020-NEXT-ACT-RETURN                               06420004
                   SET PS-SEND-MAP-N-DATA-FRSET                         06430004
                                     TO  TRUE                           06440004
                   PERFORM C400-REFRESH-PANEL-FROM-TEMP                 06450004
      *                                                                 06460004
               WHEN DP020-NEXT-ACT-ERROR                                06470004
                   MOVE DP020-MSG-MESSAGE TO PV-MESSAGE                 06480004
                   IF DP020-NAV-MNEMONIC = SPACES                       06490004
                       MOVE SPACES   TO  ANAVCMDO                       06500004
                       MOVE DP015-UNDERLINE                             06510004
                                     TO  ANAVCMDH                       06520004
                       MOVE DP015-GREEN                                 06530004
                                     TO  ANAVCMDC                       06540004
                   ELSE                                                 06550004
                       MOVE DP015-REVERSE                               06560004
                                     TO  ANAVCMDH                       06570004
                       MOVE DP015-RED                                   06580004
                                     TO  ANAVCMDC                       06590004
                   END-IF                                               06600004
      *                                                                 06610004
                   PERFORM E100-EDIT-SELECTIONS                         06620004
                   MOVE -1           TO  ANAVCMDL                       06630004
                   MOVE PV-MESSAGE   TO  DP020-MSG-MESSAGE              06640004
                                                                        06650004
                   SET DP020-MSG-FATAL                                  06660004
                                     TO  TRUE                           06670004
                   SET PS-SEND-DATA-ONLY-FRSET                          06680004
                                     TO  TRUE                           06690004
                   SET PS-SAME-ITEMS-DISPLAYED                          06700004
                                     TO  TRUE                           06710004
                   SET PS-CURSOR-POSITIONED                             06720004
                                     TO  TRUE                           06730004
                   PERFORM G100-DISPLAY-PANEL                           06740004
      *                                                                 06750004
               WHEN OTHER                                               06760004
                   SET DP013-LOGIC-ABEND TO TRUE                        06770004
                   SET DP013-NO-ROLLBACK TO TRUE                        06780004
                   MOVE 'B100-CONTROL-PROCESSING'                       06790004
                                     TO  DP013-PARAGRAPH                06800004
                   MOVE PM-PROGRAM-MESSAGE-12                           06810004
                                     TO  DP013-MESSAGE-TEXT(1)          06820004
                   PERFORM DP013-0000-PROCESS-ABEND                     06830004
           END-EVALUATE.                                                06840004
      *                                                                 06850004
       EJECT                                                            06860004
      ******************************************************************06870004
      *    ENSURE THAT THIS PROGRAM WAS ENTERED ACCORDING TO HOYLE.     06880004
      *                                                                 06890004
      *    PERFORMED BY B100-CONTROL-PROCESSING.                        06900004
      ******************************************************************06910004
      *                                                                 06920004
       C100-VALIDATE-COMMAREA.                                          06930004
      *                                                                 06940004
           IF  DP020-MB-WORKER-RSPBL-SELECT                             06950004
               SET PS-COMMAREA-VALID TO  TRUE                           06960004
           ELSE                                                         06970004
               SET PS-COMMAREA-NOT-VALID                                06980004
                                     TO  TRUE                           06990004
           END-IF.                                                      07000004
      *                                                                 07010004
       EJECT                                                            07020004
      ******************************************************************07030004
      *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED  07040004
      *    ON WHAT FUNCTION KEY WAS SELECTED.                           07050004
      *                                                                 07060004
      *    PERFORMED BY B100-CONTROL-PROCESSING.                        07070004
      ******************************************************************07080004
      *                                                                 07090004
       C300-PROCESS-PANEL.                                              07100004
      *                                                                 07110004
           PERFORM DP007-0000-GET-PANEL.                                07120004
           SET PS-SEND-DATA-ONLY-FRSET                                  07130004
                                     TO TRUE.                           07140004
           EVALUATE TRUE                                                07150004
      *                                                                 07160004
               WHEN DP020-SRC-AID = DP016-CLEAR                         07170004
                   SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 07180004
                   SET PS-SAME-ITEMS-DISPLAYED  TO TRUE                 07190004
                   PERFORM E100-EDIT-SELECTIONS                         07200004
                   MOVE MB134-LAST-NAME                                 07210004
                                     TO  ALASTNMO                       07220004
                   MOVE MB134-FIRST-NAME                                07230004
                                     TO  AFRSTNMO                       07240004
                   MOVE MB134-AAA-HEADING                               07250004
                                     TO  AAAAO                          07260004
                   MOVE PC-COMPANY   TO  AOPERCOO                       07270004
                   MOVE MB005-USERID TO  AWORKERO                       07280004
                   PERFORM G100-DISPLAY-PANEL                           07290004
      *                                                                 07300004
               WHEN DP020-SRC-AID = DP016-PF5                           07310004
                   MOVE SPACES       TO  ANAVCMDO                       07320004
                                         ANAVKEYO                       07330004
                   PERFORM Z050-DELETE-TEMP-STORAGE                     07340004
                   PERFORM D100-SETUP-INIT-PANEL                        07350004
      *                                                                 07360004
               WHEN DP020-SRC-AID = DP016-PA2                           07370004
                   PERFORM DP009-0000-LOAD-FK-LINES                     07380004
                   PERFORM DP017-0000-GET-CURR-DATE-TIME                07390004
                   SET PS-SEND-DATA-ONLY                                07400004
                                     TO  TRUE                           07410004
                   MOVE -1           TO  ANAVCMDL                       07420004
                   PERFORM DP008-0000-WRITE-PANEL                       07430004
      *                                                                 07440004
               WHEN OTHER                                               07450004
                   PERFORM D200-RECORD-SELECTIONS                       07460004
                   IF PS-VALID-SELECTIONS                               07470004
                       PERFORM D300-CHECK-FUNCTION-KEY                  07480004
                   ELSE                                                 07490004
                       SET PS-SAME-ITEMS-DISPLAYED TO TRUE              07500004
                       PERFORM G100-DISPLAY-PANEL                       07510004
                   END-IF                                               07520004
           END-EVALUATE.                                                07530004
      *                                                                 07540004
       EJECT                                                            07550004
      ******************************************************************07560004
      *    WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, 07570004
      *    SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.       07580004
      *    EDIT THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL  07590004
      *    TO THE USER.  ALSO, RESTORE THE REQUESTED UPC AND SKU NBRS.  07600004
      *                                                                 07610004
      *    PERFORMED BY B100-CONTROL-PROCESSING.                        07620004
      ******************************************************************07630004
      *                                                                 07640004
       C400-REFRESH-PANEL-FROM-TEMP.                                    07650004
      *                                                                 07660004
           IF  MB134-NO-TSQ-UPDATE                                      07670004
               MOVE MB134-SAVE-INTER-APPL-COMMAREA                      07680004
                                     TO  MB005-INTER-APPL-COMMAREA      07690004
           ELSE                                                         07700004
               MOVE ZERO             TO  PV-SAVE-ITEM                   07710004
                                         PV-WR-ITEM                     07720004
               SET PS-NOT-END        TO TRUE                            07730004
               PERFORM C500-UPDATE-TSQ                                  07740004
                       UNTIL PS-END-OF-ITEMS                            07750004
               PERFORM X900-DELETE-LIST-QUEUE                           07760004
               MOVE SPACES           TO  MB005-LIST-QUEUE-NAME          07770004
           END-IF.                                                      07780004
      *                                                                 07790004
           MOVE MB134-LAST-NAME      TO  ALASTNMO.                      07800004
           MOVE MB134-FIRST-NAME     TO  AFRSTNMO.                      07810004
           MOVE MB134-AAA-HEADING    TO  AAAAO.                         07820004
           MOVE MB005-USERID         TO  AWORKERO.                      07830004
           MOVE PC-COMPANY           TO  AOPERCOO.                      07840004
      *                                                                 07850004
           PERFORM D400-REFRESH-BLOCK-ARRAY.                            07860004
           PERFORM E100-EDIT-SELECTIONS.                                07870004
      *                                                                 07880004
           SET PS-DIFFERENT-ITEMS-DISPLAYED TO TRUE.                    07890004
           MOVE MB134-LIST-QUEUE-NAME                                   07900004
                                     TO  MB005-LIST-QUEUE-NAME.         07910004
      *                                                                 07920004
           PERFORM G100-DISPLAY-PANEL.                                  07930004
      *                                                                 07940004
       EJECT                                                            07950004
      *                                                                 07960004
      ******************************************************************07970004
      *    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.       07980004
      *    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER   07990004
      *    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN     08000004
      *    THE TEMP QUEUE.                                              08010004
      *                                                                 08020004
      *    PERFORMED BY C400                                            08030004
      ******************************************************************08040004
      *                                                                 08050004
       C500-UPDATE-TSQ.                                                 08060004
      *                                                                 08070004
           ADD 1                     TO  PV-WR-ITEM.                    08080004
           PERFORM X600-READ-LIST-QUEUE.                                08090004
           IF  PV-RESP EQUAL DFHRESP(NORMAL)                            08100004
               SET MB003-IDX         TO  1                              08110004
               PERFORM C600-PROCESS-ITEMS                               08120004
                   UNTIL MB003-KEY-DATA (MB003-IDX) EQUAL SPACE         08130004
                   OR MB003-IDX GREATER THAN MB003-MAX-ITEMS            08140004
               PERFORM X550-WRITE-TS-QUEUE                              08150004
           ELSE                                                         08160004
               SET PS-END-OF-ITEMS   TO  TRUE.                          08170004
      *                                                                 08180004
       EJECT                                                            08190004
      *                                                                 08200004
      ******************************************************************08210004
      *    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT. 08220004
      *    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE 08230004
      *    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.            08240004
      *                                                                 08250004
      *    PERFORMED BY C500                                            08260004
      ******************************************************************08270004
      *                                                                 08280004
       C600-PROCESS-ITEMS.                                              08290004
      *                                                                 08300004
           COMPUTE PV-ITEM = 1 + ((MB003-ITEM (MB003-IDX) - 1)          08310004
                           / PC-ITEMS-PER-BLOCK).                       08320004
      *                                                                 08330004
           IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           08340004
               IF  PV-SAVE-ITEM NOT EQUAL ZERO                          08350004
                   PERFORM X550-WRITE-TS-QUEUE                          08360004
               END-IF                                                   08370004
               MOVE PV-ITEM          TO  PV-SAVE-ITEM                   08380004
      *                                                                 08390004
               PERFORM X300-READ-TS-QUEUE                               08400004
               IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                    08410004
                   SET PS-END-OF-ITEMS TO TRUE                          08420004
               END-IF                                                   08430004
           END-IF.                                                      08440004
      *                                                                 08450004
           IF  PS-NOT-END                                               08460004
               COMPUTE PS-SUB = (MB003-ITEM (MB003-IDX)                 08470004
                              - PV-TW-LIST-ITEM-NUMBER (1)) + 1         08480004
               SET PV-TW-DESELECT (PS-SUB)                              08490004
                                     TO  TRUE                           08500004
               SUBTRACT 1          FROM  MB005-NUMBER-PROCESSED-ITEMS   08510004
                                         MB134-NUMBER-OF-SELECTED-ITEMS 08520004
               IF  MB005-NUMBER-PROCESSED-ITEMS EQUAL ZERO              08530004
                   SET PS-END-OF-ITEMS TO TRUE                          08540004
                   SET MB003-IDX     TO  MB003-MAX-ITEMS                08550004
               END-IF                                                   08560004
               SET MB003-IDX      UP BY  1                              08570004
           END-IF.                                                      08580004
      *                                                                 08590004
       EJECT                                                            08600004
      *                                                                 08610004
      ******************************************************************08620004
      *    INITIALIZE BOTH BLOCKS IN THE ARRAY.                         08630004
      *    INITIALIZE ALL COUNTERS AND FLAGS.                           08640004
      *    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.   08650004
      *    DISPLAY THE PANEL TO USER.                                   08660004
      *                                                                 08670004
      *    PERFORMED BY B100-CONTROL-PROCESSING.                        08680004
      *    PERFORMED BY C300-PROCESS-PANEL.                             08690004
      ******************************************************************08700004
      *                                                                 08710004
       D100-SETUP-INIT-PANEL.                                           08720004
                                                                        08730004
           INITIALIZE                  MB134-BLOCK-ENTRIES (1).         08740004
           INITIALIZE                  MB134-BLOCK-ENTRIES (2).         08750004
           MOVE SPACES             TO  MB134-LIST-QUEUE-NAME.           08760004
           MOVE +1                 TO  MB134-BLK-SUB.                   08770004
           MOVE PC-ITEMS-PER-PANEL TO  PV-HIGHEST-ITEM-TO-BE-READ.      08780004
           SET MB134-ITEMS-LEFT-ON-DB                                   08790004
                                   TO  TRUE.                            08800004
                                                                        08810004
           MOVE +0                 TO  MB134-ITEM-SUB                   08820004
                                       MB134-NUMBER-OF-ITEMS-READ       08830004
                                       MB134-NUMBER-OF-SELECTED-ITEMS   08840004
                                       MB134-HIGHEST-BLOCK-WRITTEN      08850004
                                       MB134-START-OF-SELECTED-RANGE    08860004
                                       MB134-END-OF-SELECTED-RANGE.     08870004
                                                                        08880004
           PERFORM L300-READ-WORKER.                                    08890004
                                                                        08900004
           MOVE MB134-LAST-NAME      TO  ALASTNMO.                      08910004
           MOVE MB134-FIRST-NAME     TO  AFRSTNMO.                      08920004
           MOVE MB005-USERID         TO  AWORKERO.                      08930004
           MOVE PC-COMPANY           TO  AOPERCOO.                      08940004
                                                                        08950004
           PERFORM DP017-0000-GET-CURR-DATE-TIME.                       08960004
           MOVE DP017-EDITED-DATE-YYYYMMDD                              08970004
                                   TO  PV-DB2-CURRENT-DATE.             08980004
           IF  MB005-INCLUDE-HISTORY                                    08990004
               MOVE PV-DB2-HISTORY-DATE                                 09000004
                                   TO  PV-DB2-DATE                      09010004
           ELSE                                                         09020004
               MOVE PV-DB2-CURRENT-DATE                                 09030004
                                   TO  PV-DB2-DATE                      09040004
           END-IF.                                                      09050004
                                                                        09060004
           PERFORM L100-OPEN-CURSOR.                                    09070004
                                                                        09080004
           PERFORM H100-READ-ITEMS-FROM-DB.                             09090004
           SET PS-DIFFERENT-ITEMS-DISPLAYED                             09100004
                                   TO  TRUE.                            09110004
           MOVE +1 TO PV-TOP-ITEM.                                      09120004
           PERFORM G700-GET-TOP-ITEMS-BLOCK.                            09130004
                                                                        09140004
           MOVE +1                 TO  MB134-ITEM-AT-TOP-OF-PANEL.      09150004
           MOVE MB134-AAA-HEADING  TO  AAAAO.                           09160004
                                                                        09170004
           PERFORM G100-DISPLAY-PANEL.                                  09180004
                                                                        09190004
       EJECT                                                            09200004
      ******************************************************************09210004
      *    IF THE USER HIT THE DESELECT KEY, OR A KEY WHICH INVOLVES    09220004
      *    LEAVING THIS TRANSACTION AND GOING TO ANOTHER, SET A FLAG    09230004
      *    INDICATING THAT ALL SELECTIONS ARE VALID.  IF ANY OTHER KEY  09240004
      *    IS HIT, MOVE THE SELECTIONS MADE TO THE COMMAREA, AND EDIT   09250004
      *    THOSE SELECTIONS.                                            09260004
      *                                                                 09270004
      *    IF THE USER ENTERED SOMETHING IN THE COMMAND LINE OR HIT     09280004
      *    AN INVALID FUNCTION KEY, DO NOT EDIT THE SELECTIONS.         09290004
      *                                                                 09300004
      *    PERFORMED BY C300-PROCESS-PANEL.                             09310004
      ******************************************************************09320004
      *                                                                 09330004
       D200-RECORD-SELECTIONS.                                          09340004
      *                                                                 09350004
           IF (DP020-FK-DESELECT(DP020-SRC-AID))   OR                   09360004
              (DP020-FK-SELECT-ALL(DP020-SRC-AID)) OR                   09370004
              (DP020-FK-GO-TO-TRAN(DP020-SRC-AID)) OR                   09380004
              (DP020-FK-RETURN(DP020-SRC-AID))                          09390004
               SET PS-VALID-SELECTIONS TO TRUE                          09400004
           ELSE                                                         09410004
      *                                                                 09420004
               PERFORM E200-MOVE-SELECTS-TO-COMMAREA                    09430004
               IF (DP020-SRC-AID          = DP016-ENTER) AND            09440004
                  (DP020-NAV-MNEMONIC NOT = SPACES)      AND            09450004
                  (DP020-NAV-MNEMONIC NOT = LOW-VALUES)                 09460004
                   SET PS-VALID-SELECTIONS TO TRUE                      09470004
               ELSE                                                     09480004
      *                                                                 09490004
      *            IF (DP020-FK-FIRST-PAGE(DP020-SRC-AID)) OR           09500004
      *               (DP020-FK-PREV-PAGE(DP020-SRC-AID))  OR           09510004
      *               (DP020-FK-NEXT-PAGE(DP020-SRC-AID))  OR           09520004
      *               (DP020-FK-EDIT-GOTO(DP020-SRC-AID))  OR           09530004
      *               (DP020-SRC-AID = DP016-ENTER)                     09540004
                       PERFORM E100-EDIT-SELECTIONS                     09550004
      *            ELSE                                                 09560004
      *                SET PS-VALID-SELECTIONS TO TRUE                  09570004
      *            END-IF                                               09580004
               END-IF                                                   09590004
           END-IF.                                                      09600004
       EJECT                                                            09610004
      ******************************************************************09620004
      *    PERFORM THE APPROPRIATE PARAGRAPH BASED ON WHICH FUNCTION    09630004
      *    KEY HAD BEEN SELECTED BY THE USER.                           09640004
      *                                                                 09650004
      *    PERFORMED BY C300-PROCESS-PANEL.                             09660004
      ******************************************************************09670004
      *                                                                 09680004
       D300-CHECK-FUNCTION-KEY.                                         09690004
      *                                                                 09700004
           EVALUATE TRUE                                                09710004
      *                                                                 09720004
               WHEN DP020-FK-GO-TO-TRAN(DP020-SRC-AID)                  09730004
                    PERFORM E300-NAVIGATE                               09740004
      *                                                                 09750004
      *    FOR THE ADD FUNCTION (PF13) NO SELECTED ITEMS REQUIRED.      09760004
      *                                                                 09770004
               WHEN DP020-FK-EDIT-GOTO(DP020-SRC-AID)                   09780004
                   IF  PS-CONTINUE                                      09790004
                       IF  MB134-NUMBER-OF-SELECTED-ITEMS > ZERO        09800004
                           PERFORM X100-PREPARE-LIST-QUEUE              09810004
                           IF  PS-CONTINUE                              09820004
                               IF (PS-HISTORY-SELECTED                  09830004
                               AND DP020-SRC-AID = DP016-PF15)          09840004
                                   MOVE PC-TSYMSG-00146                 09850004
                                        TO  DP020-MSG-NUMBER            09860004
                                   SET DP020-MSG-FATAL TO TRUE          09870004
                                   PERFORM G100-DISPLAY-PANEL           09880004
                               ELSE                                     09890004
                                   PERFORM E300-NAVIGATE                09900004
                               END-IF                                   09910004
                           ELSE                                         09920004
      *                                                                 09930004
                               SET DP013-LOGIC-ABEND TO TRUE            09940004
                               SET DP013-NO-ROLLBACK TO TRUE            09950004
                               MOVE 'D300-CHECK-FUNCTION-KEY'           09960004
                                     TO  DP013-PARAGRAPH                09970004
                               MOVE PM-PROGRAM-MESSAGE-28               09980004
                                     TO  DP013-MESSAGE-TEXT(1)          09990004
                               PERFORM DP013-0000-PROCESS-ABEND         10000004
                           END-IF                                       10010004
                       ELSE                                             10020004
      *                                                                 10030004
                           MOVE PC-TSYMSG-00057                         10040004
                                     TO  DP020-MSG-NUMBER               10050004
                           SET DP020-MSG-WARNING                        10060004
                                     TO TRUE                            10070004
                           PERFORM G100-DISPLAY-PANEL                   10080004
                       END-IF                                           10090004
                   ELSE                                                 10100004
                       PERFORM G100-DISPLAY-PANEL                       10110004
                 END-IF                                                 10120004
      *                                                                 10130004
               WHEN DP020-FK-RETURN(DP020-SRC-AID)                      10140004
                    PERFORM X900-DELETE-LIST-QUEUE                      10150004
                    PERFORM E300-NAVIGATE                               10160004
      *                                                                 10170004
               WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10180004
                    PERFORM E400-DISPLAY-TOP-OF-LIST                    10190004
      *                                                                 10200004
               WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10210004
                    PERFORM E500-BROWSE-BACKWARD                        10220004
      *                                                                 10230004
               WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10240004
                    PERFORM E600-BROWSE-FORWARD                         10250004
      *                                                                 10260004
               WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    10270004
                    PERFORM E700-DESELECT-ALL-ITEMS                     10280004
      *                                                                 10290004
               WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  10300004
                    PERFORM E900-SELECT-ALL-ITEMS                       10310004
      *                                                                 10320004
               WHEN DP020-SRC-AID = DP016-ENTER                         10330004
                   IF (DP020-NAV-MNEMONIC = LOW-VALUES) OR              10340004
                      (DP020-NAV-MNEMONIC = SPACES)                     10350004
                       PERFORM E800-CHECK-FOR-JUMP-BROWSE               10360004
                   ELSE                                                 10370004
                       PERFORM E300-NAVIGATE                            10380004
                   END-IF                                               10390004
      *                                                                 10400004
               WHEN OTHER                                               10410004
                   MOVE PC-TSYMSG-00045                                 10420004
                                     TO  DP020-MSG-NUMBER               10430004
                   SET DP020-MSG-FATAL                                  10440004
                                     TO  TRUE                           10450004
                   PERFORM G100-DISPLAY-PANEL                           10460004
      *                                                                 10470004
           END-EVALUATE.                                                10480004
       EJECT                                                            10490004
      ******************************************************************10500004
      *    WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, 10510004
      *    READ TEMPORARY STORAGE FILLING IN BOTH BLOCKS IN THE ARRAY   10520004
      *    WITH THE ITEMS THAT WERE AT THE TOP OF THE LIST WHEN WE      10530004
      *    HAD LEFT PREVIOUSLY.                                         10540004
      *                                                                 10550004
      *    PERFORMED BY C400-REFRESH-PANEL-FROM-TEMP.                   10560004
      ******************************************************************10570004
      *                                                                 10580004
       D400-REFRESH-BLOCK-ARRAY.                                        10590004
      *                                                                 10600004
           COMPUTE PV-TEMP-BLOCK-NUMBER =                               10610004
               1 + ((MB134-LIST-ITEM-NUMBER(1 1) - 1) /                 10620004
                     PC-ITEMS-PER-BLOCK).                               10630004
                                                                        10640004
           MOVE PV-TEMP-BLOCK-NUMBER TO PV-BLOCK-NUMBER.                10650004
           MOVE +1                   TO MB134-BLK-SUB.                  10660004
                                                                        10670004
           PERFORM Z100-READ-TEMP-STORAGE.                              10680004
                                                                        10690004
           ADD +1 TO PV-BLOCK-NUMBER.                                   10700004
                                                                        10710004
           IF (PV-BLOCK-NUMBER < MB134-HIGHEST-BLOCK-WRITTEN) OR        10720004
              (PV-BLOCK-NUMBER = MB134-HIGHEST-BLOCK-WRITTEN)           10730004
               ADD +1 TO MB134-BLK-SUB                                  10740004
                                                                        10750004
               PERFORM Z100-READ-TEMP-STORAGE                           10760004
           END-IF.                                                      10770004
      *                                                                 10780004
       EJECT                                                            10790004
      ******************************************************************10800004
      *    EDIT EACH SELECTION ENTRY.  IF EACH ENTRY IS CONSIDERED      10810004
      *    VALID, CHECK IF A BEGINNING AND ENDING ENTRY WAS ENTERED,    10820004
      *    AND CHECK THE FOLLOWING.                                     10830004
      *                                                                 10840004
      *    1) IF THERE IS A BEGINNING RANGE, THERE MUST BE AN ENDING.   10850004
      *    2) IF THERE IS A ENDING RANGE, THERE MUST BE AN BEGINNING.   10860004
      *    3) BEGINNING RANGE MUST PRECEDE ENDING RANGE.                10870004
      *                                                                 10880004
      *    IF A VALID BEGINNING AND ENDING RANGE HAVE BEEN SELECTED,    10890004
      *    MARK ALL ITEMS IN THAT RANGE AS BEING SELECTED.              10900004
      *                                                                 10910004
      *    PERFORMED BY B100-CONTROL-PROCESSING.                        10920004
      *    PERFORMED BY C300-PROCESS-PANEL.                             10930004
      *    PERFORMED BY C400-REFRESH-PANEL-FROM-TEMP.                   10940004
      *    PERFORMED BY D200-RECORD-SELECTIONS.                         10950004
      ******************************************************************10960004
      *                                                                 10970004
       E100-EDIT-SELECTIONS.                                            10980004
      *                                                                 10990004
           SET PS-VALID-SELECTIONS TO TRUE.                             11000004
                                                                        11010004
           COMPUTE PV-ENDING-ITEM-ON-PANEL =                            11020004
               (MB134-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.   11030004
           MOVE MB134-ITEM-AT-TOP-OF-PANEL                              11040004
                                     TO  PV-ITEM-IN-USE.                11050004
           MOVE +1                   TO  PS-SUB.                        11060004
      *                                                                 11070004
           PERFORM F100-EDIT                                            11080004
               UNTIL (PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL)         11090004
                  OR (PV-ITEM-IN-USE > MB134-NUMBER-OF-ITEMS-READ).     11100004
      *                                                                 11110004
           IF  PS-VALID-SELECTIONS                                      11120004
               IF  MB134-START-OF-SELECTED-RANGE GREATER ZERO           11130004
                   IF  MB134-END-OF-SELECTED-RANGE GREATER              11140004
                       MB134-START-OF-SELECTED-RANGE                    11150004
                       PERFORM F200-MARK-RANGE-AS-SELECTED              11160004
                   ELSE                                                 11170004
      *                                                                 11180004
                       IF  MB134-END-OF-SELECTED-RANGE = +0             11190004
                           SET PS-CURSOR-POSITIONED                     11200004
                                     TO  TRUE                           11210004
                           SET PS-WARNING                               11220004
                                     TO  TRUE                           11230004
                           MOVE PC-TSYMSG-00051                         11240004
                                     TO  DP020-MSG-NUMBER               11250004
                           IF  NOT DP020-NEXT-ACT-ERROR                 11260004
                               SET DP020-MSG-WARNING TO TRUE            11270004
                           END-IF                                       11280004
                       ELSE                                             11290004
      *                                                                 11300004
                           SET PS-CURSOR-POSITIONED                     11310004
                                     TO  TRUE                           11320004
                           SET PS-INVALID-SELECTIONS                    11330004
                                     TO  TRUE                           11340004
                           SET DP020-MSG-FATAL                          11350004
                                     TO  TRUE                           11360004
                           MOVE PC-TSYMSG-00052                         11370004
                                     TO  DP020-MSG-NUMBER               11380004
                           IF  NOT DP020-NEXT-ACT-ERROR                 11390004
                               MOVE MB134-ITEM-AT-TOP-OF-PANEL          11400004
                                     TO  PV-ITEM-IN-USE                 11410004
                               MOVE +1                                  11420004
                                     TO  PS-SUB                         11430004
      *                                                                 11440004
                               PERFORM                                  11450004
                                   UNTIL (PV-ITEM-IN-USE >              11460004
                                          PV-ENDING-ITEM-ON-PANEL)      11470004
                                      OR (PV-ITEM-IN-USE >              11480004
                                          MB134-NUMBER-OF-ITEMS-READ)   11490004
      *                                                                 11500004
                                   PERFORM K100-SET-SUBSCRIPTS          11510004
                                   IF (MB134-BEGIN(MB134-BLK-SUB        11520004
                                                   MB134-ITEM-SUB))     11530004
                                   OR (MB134-END(MB134-BLK-SUB          11540004
                                                 MB134-ITEM-SUB))       11550004
                                       MOVE -1                          11560004
                                          TO  MBKM134-SELECTL(PS-SUB)   11570004
                                       MOVE PV-ENDING-ITEM-ON-PANEL     11580004
                                          TO  PV-ITEM-IN-USE            11590004
                                   END-IF                               11600004
                                   ADD +1 TO  PS-SUB                    11610004
                                   ADD +1 TO  PV-ITEM-IN-USE            11620004
                               END-PERFORM                              11630004
      *                                                                 11640004
                           END-IF                                       11650004
                       END-IF                                           11660004
                   END-IF                                               11670004
               ELSE                                                     11680004
      *                                                                 11690004
                   IF MB134-END-OF-SELECTED-RANGE > +0                  11700004
                       SET PS-CURSOR-POSITIONED TO TRUE                 11710004
                       SET PS-WARNING           TO TRUE                 11720004
                       MOVE PC-TSYMSG-00053                             11730004
                                     TO  DP020-MSG-NUMBER               11740004
                       IF NOT DP020-NEXT-ACT-ERROR                      11750004
                           SET DP020-MSG-WARNING TO TRUE                11760004
                       END-IF                                           11770004
                   END-IF                                               11780004
               END-IF                                                   11790004
           END-IF.                                                      11800004
      *                                                                 11810004
           IF  DP020-MSG-SEVERITY-IND GREATER THAN SPACES               11820004
               SET PS-DONT-PROCESS   TO  TRUE                           11830004
           END-IF.                                                      11840004
      *                                                                 11850004
       EJECT                                                            11860004
      ******************************************************************11870004
      *    MOVE THE SELECTIONS MADE FROM THE CURRENT PAGE INTO          11880004
      *    THE COMMAREA.                                                11890004
      *                                                                 11900004
      *    PERFORMED BY D200-RECORD-SELECTIONS.                         11910004
      ******************************************************************11920004
      *                                                                 11930004
       E200-MOVE-SELECTS-TO-COMMAREA.                                   11940004
      *                                                                 11950004
           COMPUTE PV-ENDING-ITEM-ON-PANEL =                            11960004
               (MB134-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.   11970004
                                                                        11980004
           MOVE +1                         TO PS-SUB.                   11990004
           MOVE MB134-ITEM-AT-TOP-OF-PANEL TO PV-ITEM-IN-USE.           12000004
                                                                        12010004
           PERFORM F300-CHECK-SELECTIONS                                12020004
               UNTIL PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL.          12030004
       EJECT                                                            12040004
      ******************************************************************12050004
      *    IF THE USER HITS A KEY THAT REQUIRES US TO GO TO ANOTHER     12060004
      *    TRANSACTION, WRITE OUT THE LAST 2 BLOCKS FROM THE ARRAY TO   12070004
      *    TEMPORARY STORAGE, SET UP THE INTER APPLICATION COMMAREA,    12080004
      *    AND START THE NAVIGATOR.                                     12090004
      *                                                                 12100004
      *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        12110004
      ******************************************************************12120004
      *                                                                 12130004
       E300-NAVIGATE.                                                   12140004
      *                                                                 12150004
           MOVE +1 TO MB134-BLK-SUB.                                    12160004
           PERFORM Z150-WRITE-TEMP-STORAGE.                             12170004
      *                                                                 12180004
           ADD +1 TO MB134-BLK-SUB.                                     12190004
           PERFORM Z150-WRITE-TEMP-STORAGE.                             12200004
      *                                                                 12210004
           MOVE MB005-INTER-APPL-COMMAREA                               12220004
                                     TO  MB134-SAVE-INTER-APPL-COMMAREA.12230004
           SET DP020-MB-WORKER-RSPBL-LIST                               12240004
                                     TO  TRUE.                          12250004
           PERFORM DP015-1000-START-NAVIGATOR.                          12260004
       EJECT                                                            12270004
      ******************************************************************12280004
      *    IF THE USER HITS THE 1ST PAGE KEY, COMPUTE THE TOP ITEM      12290004
      *    NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM           12300004
      *    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS  12310004
      *    TO BE READ.                                                  12320004
      *                                                                 12330004
      *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        12340004
      ******************************************************************12350004
      *                                                                 12360004
       E400-DISPLAY-TOP-OF-LIST.                                        12370004
      *                                                                 12380004
           IF  MB134-NUMBER-OF-ITEMS-READ > +0                          12390004
               MOVE +1 TO PV-TOP-ITEM                                   12400004
               PERFORM F500-BROWSE                                      12410004
           ELSE                                                         12420004
               SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      12430004
               PERFORM G100-DISPLAY-PANEL                               12440004
           END-IF.                                                      12450004
       EJECT                                                            12460004
      ******************************************************************12470004
      *    IF THE USER HITS THE PAGE BACKARD KEY, COMPUTE THE TOP       12480004
      *    ITEM NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM      12490004
      *    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS  12500004
      *    TO BE READ.                                                  12510004
      *                                                                 12520004
      *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        12530004
      ******************************************************************12540004
      *                                                                 12550004
       E500-BROWSE-BACKWARD.                                            12560004
      *                                                                 12570004
           IF  MB134-NUMBER-OF-ITEMS-READ > +0                          12580004
               COMPUTE PV-TOP-ITEM =                                    12590004
                   MB134-ITEM-AT-TOP-OF-PANEL - PC-ITEMS-PER-PANEL      12600004
               PERFORM F500-BROWSE                                      12610004
           ELSE                                                         12620004
               SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      12630004
               PERFORM G100-DISPLAY-PANEL                               12640004
           END-IF.                                                      12650004
      *                                                                 12660004
       EJECT                                                            12670004
      ******************************************************************12680004
      *    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP       12690004
      *    ITEM NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM      12700004
      *    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS  12710004
      *    TO BE READ.                                                  12720004
      *                                                                 12730004
      *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        12740004
      ******************************************************************12750004
      *                                                                 12760004
       E600-BROWSE-FORWARD.                                             12770004
      *                                                                 12780004
           IF  MB134-NUMBER-OF-ITEMS-READ > +0                          12790004
               COMPUTE PV-TOP-ITEM =                                    12800004
                   MB134-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL      12810004
               PERFORM F500-BROWSE                                      12820004
           ELSE                                                         12830004
               SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      12840004
               PERFORM G100-DISPLAY-PANEL                               12850004
           END-IF.                                                      12860004
      *                                                                 12870004
       EJECT                                                            12880004
      ******************************************************************12890004
      *    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION       12900004
      *    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.          12910004
      *                                                                 12920004
      *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        12930004
      ******************************************************************12940004
      *                                                                 12950004
       E700-DESELECT-ALL-ITEMS.                                         12960004
      *                                                                 12970004
           IF  MB134-NUMBER-OF-ITEMS-READ > +0                          12980004
               MOVE +1               TO  MB134-BLK-SUB                  12990004
                                                                        13000004
               PERFORM F600-CLEAR-SELECTED-INDS                         13010004
                   VARYING MB134-ITEM-SUB FROM 1 BY 1                   13020004
                   UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK            13030004
                                                                        13040004
               ADD +1                TO  MB134-BLK-SUB                  13050004
                                                                        13060004
               PERFORM F600-CLEAR-SELECTED-INDS                         13070004
                   VARYING MB134-ITEM-SUB FROM 1 BY 1                   13080004
                   UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK            13090004
                                                                        13100004
               MOVE MB134-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER  13110004
                                                                        13120004
               COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                        13130004
                   1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK) 13140004
                                                                        13150004
               IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                 13160004
                  (MB134-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)13170004
                   MOVE +1 TO MB134-BLK-SUB                             13180004
                                                                        13190004
                   PERFORM Z150-WRITE-TEMP-STORAGE                      13200004
                                                                        13210004
                   MOVE +1 TO PV-BLOCK-NUMBER                           13220004
                                                                        13230004
                   COMPUTE PV-PREV-BLOCK-IN-ARRAY =                     13240004
                       PV-FIRST-BLOCK-IN-ARRAY - 1                      13250004
                                                                        13260004
                   PERFORM                                              13270004
                       UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY   13280004
                                                                        13290004
                       PERFORM Z100-READ-TEMP-STORAGE                   13300004
                                                                        13310004
                       PERFORM F600-CLEAR-SELECTED-INDS                 13320004
                           VARYING MB134-ITEM-SUB FROM 1 BY 1           13330004
                           UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK    13340004
                                                                        13350004
                       PERFORM Z150-WRITE-TEMP-STORAGE                  13360004
                                                                        13370004
                       ADD +1 TO PV-BLOCK-NUMBER                        13380004
                                                                        13390004
                   END-PERFORM                                          13400004
                                                                        13410004
                   COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                     13420004
                       PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY 13430004
                                                                        13440004
                   PERFORM                                              13450004
                       UNTIL PV-NEXT-BLOCK-IN-ARRAY >                   13460004
                             MB134-HIGHEST-BLOCK-WRITTEN                13470004
                                                                        13480004
                       MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER   13490004
                                                                        13500004
                       PERFORM Z100-READ-TEMP-STORAGE                   13510004
                                                                        13520004
                       PERFORM F600-CLEAR-SELECTED-INDS                 13530004
                           VARYING MB134-ITEM-SUB FROM 1 BY 1           13540004
                           UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK    13550004
                                                                        13560004
                       PERFORM Z150-WRITE-TEMP-STORAGE                  13570004
                                                                        13580004
                       ADD +1 TO PV-NEXT-BLOCK-IN-ARRAY                 13590004
                                                                        13600004
                   END-PERFORM                                          13610004
                                                                        13620004
                   MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER      13630004
                                                                        13640004
                   PERFORM Z100-READ-TEMP-STORAGE                       13650004
               END-IF                                                   13660004
                                                                        13670004
           END-IF.                                                      13680004
                                                                        13690004
           MOVE +0 TO MB134-NUMBER-OF-SELECTED-ITEMS.                   13700004
           MOVE +0 TO MB134-START-OF-SELECTED-RANGE.                    13710004
           MOVE +0 TO MB134-END-OF-SELECTED-RANGE.                      13720004
                                                                        13730004
           SET PS-SAME-ITEMS-DISPLAYED TO TRUE.                         13740004
                                                                        13750004
           PERFORM G100-DISPLAY-PANEL.                                  13760004
       EJECT                                                            13770004
      ******************************************************************13780004
      *    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO     13790004
      *    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.    13800004
      *    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST   13810004
      *    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.       13820004
      *    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT      13830004
      *    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.           13840004
      *                                                                 13850004
      *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        13860004
      ******************************************************************13870004
      *                                                                 13880004
       E800-CHECK-FOR-JUMP-BROWSE.                                      13890004
      *                                                                 13900004
           SET PS-VALID-BEG-ITEM TO TRUE.                               13910004
                                                                        13920004
           IF (ABEGITMA                   = PC-ERASE-EOF) OR            13930004
              (MB134-NUMBER-OF-ITEMS-READ = +0)                         13940004
               SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      13950004
               PERFORM G100-DISPLAY-PANEL                               13960004
           ELSE                                                         13970004
      *                                                                 13980004
               MOVE ABEGITMI         TO  DP010I-UNEDITED-FIELD          13990004
               MOVE PC-FIELD-LENGTH  TO  DP010I-MAXIMUM-DIGITS          14000004
               MOVE +0               TO  DP010I-MAXIMUM-DECIMALS        14010004
               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14020004
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
262978              USING DP010I-NUMERIC-EDIT-AREA                              
      *                                                                 14040004
               IF  NOT DP010I-ERROR-DETECTED                            14050004
                   MOVE DP010I-NUMERIC-FIELD                            14060004
                                     TO  PV-BEGITMI-N                   14070004
                   MOVE PV-BEGITMI-N TO  PV-BEGINNING-ITEM              14080004
      *                                                                 14090004
                   IF (PV-BEGINNING-ITEM >  0)          AND             14100004
                      (PV-BEGINNING-ITEM <  PC-MAX-ITEMS)               14110004
                       MOVE PV-BEGINNING-ITEM TO PV-TOP-ITEM            14120004
                                                                        14130004
                       COMPUTE PV-MAX-ITEMS-TO-BE-READ =                14140004
                           ((MB134-NUMBER-OF-ITEMS-READ +               14150004
                             PC-MAX-ITEMS-TO-BE-READ)   -               14160004
                             PC-ITEMS-PER-PANEL)        + 1             14170004
      *                                                                 14180004
                       IF PV-TOP-ITEM > PV-MAX-ITEMS-TO-BE-READ         14190004
                           MOVE PV-MAX-ITEMS-TO-BE-READ                 14200004
                                     TO  PV-TOP-ITEM                    14210004
                           MOVE -1   TO  ABEGITML                       14220004
      *                                                                 14230004
                           IF MB134-NO-ITEMS-LEFT-ON-DB                 14240004
                               MOVE PC-TSYMSG-00070                     14250004
                                     TO  DP020-MSG-NUMBER               14260004
                           ELSE                                         14270004
                               MOVE PC-TSYMSG-00207                     14280004
                                     TO  DP020-MSG-NUMBER               14290004
                           END-IF                                       14300004
      *                                                                 14310004
                           SET PS-CURSOR-POSITIONED                     14320004
                                     TO  TRUE                           14330004
                           SET DP020-MSG-INFORMATIONAL                  14340004
                                     TO  TRUE                           14350004
                       END-IF                                           14360004
                       PERFORM F500-BROWSE                              14370004
                   ELSE                                                 14380004
                       MOVE PC-TSYMSG-00101                             14390004
                                     TO  DP020-MSG-NUMBER               14400004
                       MOVE -1       TO  ABEGITML                       14410004
                       MOVE DP015-REVERSE                               14420004
                                     TO  ABEGITMH                       14430004
                       MOVE DP015-RED                                   14440004
                                     TO  ABEGITMC                       14450004
                       MOVE DP015-UNP-NUM-BRT-MDT                       14460004
                                     TO  ABEGITMA                       14470004
                       SET PS-CURSOR-POSITIONED                         14480004
                                     TO  TRUE                           14490004
                       SET DP020-MSG-FATAL                              14500004
                                     TO  TRUE                           14510004
                       SET PS-INVALID-BEG-ITEM                          14520004
                                     TO  TRUE                           14530004
                   END-IF                                               14540004
      *                                                                 14550004
               ELSE                                                     14560004
                   MOVE PC-TSYMSG-00008                                 14570004
                                     TO  DP020-MSG-NUMBER               14580004
                   MOVE -1           TO  ABEGITML                       14590004
                   MOVE DP015-REVERSE                                   14600004
                                     TO  ABEGITMH                       14610004
                   MOVE DP015-RED    TO  ABEGITMC                       14620004
                   MOVE DP015-UNP-NUM-BRT-MDT                           14630004
                                     TO  ABEGITMA                       14640004
                   SET PS-CURSOR-POSITIONED                             14650004
                                     TO  TRUE                           14660004
                   SET DP020-MSG-FATAL                                  14670004
                                     TO  TRUE                           14680004
                   SET PS-INVALID-BEG-ITEM                              14690004
                                     TO  TRUE                           14700004
               END-IF                                                   14710004
           END-IF.                                                      14720004
      *                                                                 14730004
           IF  PS-INVALID-BEG-ITEM                                      14740004
               SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      14750004
               PERFORM DP017-0000-GET-CURR-DATE-TIME                    14760004
               PERFORM I200-FORMAT-LIST-LINES                           14770004
               PERFORM I300-FORMAT-NR-SELECTED                          14780004
               PERFORM DP005-0000-FORMAT-MSG-LINES                      14790004
               PERFORM DP008-0000-WRITE-PANEL                           14800004
           END-IF.                                                      14810004
      *                                                                 14820004
       EJECT                                                            14830004
      ******************************************************************14840004
      *    IF THE USER HITS THE SELECT KEY, SET THE SELECTION SWITCH    14850004
      *    FOR ALL ITEMS.                                               14860004
      *                                                                 14870004
      *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        14880004
      ******************************************************************14890004
      *                                                                 14900004
       E900-SELECT-ALL-ITEMS.                                           14910004
      *                                                                 14920004
           IF  MB134-NUMBER-OF-ITEMS-READ > +0                          14930004
               MOVE +1 TO MB134-BLK-SUB                                 14940004
                                                                        14950004
               PERFORM F700-SET-SELECTED-INDS                           14960004
                   VARYING MB134-ITEM-SUB FROM 1 BY 1                   14970004
                   UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK            14980004
                                                                        14990004
               ADD +1 TO MB134-BLK-SUB                                  15000004
                                                                        15010004
               PERFORM F700-SET-SELECTED-INDS                           15020004
                   VARYING MB134-ITEM-SUB FROM 1 BY 1                   15030004
                   UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK            15040004
                                                                        15050004
               MOVE MB134-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER  15060004
                                                                        15070004
               COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                        15080004
                   1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK) 15090004
                                                                        15100004
               IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                 15110004
                  (MB134-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)15120004
                   MOVE +1 TO MB134-BLK-SUB                             15130004
                                                                        15140004
                   PERFORM Z150-WRITE-TEMP-STORAGE                      15150004
                                                                        15160004
                   MOVE +1 TO PV-BLOCK-NUMBER                           15170004
                                                                        15180004
                   COMPUTE PV-PREV-BLOCK-IN-ARRAY =                     15190004
                       PV-FIRST-BLOCK-IN-ARRAY - 1                      15200004
                                                                        15210004
                   PERFORM                                              15220004
                       UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY   15230004
                                                                        15240004
                       PERFORM Z100-READ-TEMP-STORAGE                   15250004
                                                                        15260004
                       PERFORM F700-SET-SELECTED-INDS                   15270004
                           VARYING MB134-ITEM-SUB FROM 1 BY 1           15280004
                           UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK    15290004
                                                                        15300004
                       PERFORM Z150-WRITE-TEMP-STORAGE                  15310004
                                                                        15320004
                       ADD +1 TO PV-BLOCK-NUMBER                        15330004
                                                                        15340004
                   END-PERFORM                                          15350004
                                                                        15360004
                   COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                     15370004
                       PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY 15380004
                                                                        15390004
                   PERFORM                                              15400004
                       UNTIL PV-NEXT-BLOCK-IN-ARRAY >                   15410004
                             MB134-HIGHEST-BLOCK-WRITTEN                15420004
                                                                        15430004
                       MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER   15440004
                                                                        15450004
                       PERFORM Z100-READ-TEMP-STORAGE                   15460004
                                                                        15470004
                       PERFORM F700-SET-SELECTED-INDS                   15480004
                           VARYING MB134-ITEM-SUB FROM 1 BY 1           15490004
                           UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK    15500004
                                                                        15510004
                       PERFORM Z150-WRITE-TEMP-STORAGE                  15520004
                                                                        15530004
                       ADD +1 TO PV-NEXT-BLOCK-IN-ARRAY                 15540004
                                                                        15550004
                   END-PERFORM                                          15560004
                                                                        15570004
                   MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER      15580004
                                                                        15590004
                   PERFORM Z100-READ-TEMP-STORAGE                       15600004
               END-IF                                                   15610004
                                                                        15620004
           END-IF.                                                      15630004
                                                                        15640004
           MOVE MB134-NUMBER-OF-ITEMS-READ TO                           15650004
                             MB134-NUMBER-OF-SELECTED-ITEMS.            15660004
                                                                        15670004
           SET PS-SAME-ITEMS-DISPLAYED TO TRUE.                         15680004
                                                                        15690004
           PERFORM G100-DISPLAY-PANEL.                                  15700004
      *                                                                 15710004
       EJECT                                                            15720004
      ******************************************************************15730004
      *    EDIT THE SELECTION ENTRIES.                                  15740004
      *                                                                 15750004
      *    1) VALID ENTRIES ARE 'S' 'B' OR 'E'.                         15760004
      *    2) THERE CAN ONLY BE 1 BEGINNING AND 1 ENDING RANGE.         15770004
      *                                                                 15780004
      *    PERFORMED BY E100-EDIT-SELECTIONS.                           15790004
      ******************************************************************15800004
      *                                                                 15810004
       F100-EDIT.                                                       15820004
      *                                                                 15830004
           PERFORM K100-SET-SUBSCRIPTS.                                 15840004
                                                                        15850004
           IF NOT (MB134-NO-SELECT(MB134-BLK-SUB MB134-ITEM-SUB)) AND   15860004
              NOT (MB134-SELECT(MB134-BLK-SUB MB134-ITEM-SUB))          15870004
      *                                                                 15880004
               IF  MB134-BEGIN(MB134-BLK-SUB MB134-ITEM-SUB)            15890004
                   IF  MB134-START-OF-SELECTED-RANGE                    15900004
                       NOT EQUAL PV-ITEM-IN-USE                         15910004
      *                                                                 15920004
                       IF  MB134-START-OF-SELECTED-RANGE = +0           15930004
                           MOVE PV-ITEM-IN-USE                          15940004
                                     TO  MB134-START-OF-SELECTED-RANGE  15950004
                       ELSE                                             15960004
                           IF PS-VALID-SELECTIONS                       15970004
                               MOVE PC-TSYMSG-00054                     15980004
                                     TO  DP020-MSG-NUMBER               15990004
                               IF  NOT DP020-NEXT-ACT-ERROR             16000004
                                   MOVE -1                              16010004
                                     TO  MBKM134-SELECTL(PS-SUB)        16020004
                               END-IF                                   16030004
                           END-IF                                       16040004
      *                                                                 16050004
                           SET DP020-MSG-FATAL                          16060004
                                     TO  TRUE                           16070004
                           SET PS-INVALID-SELECTIONS                    16080004
                                     TO  TRUE                           16090004
                           SET PS-CURSOR-POSITIONED                     16100004
                                     TO  TRUE                           16110004
                       END-IF                                           16120004
                   END-IF                                               16130004
               ELSE                                                     16140004
      *                                                                 16150004
                   IF  MB134-END(MB134-BLK-SUB MB134-ITEM-SUB)          16160004
                       IF  MB134-END-OF-SELECTED-RANGE                  16170004
                           NOT EQUAL PV-ITEM-IN-USE                     16180004
      *                                                                 16190004
                           IF MB134-END-OF-SELECTED-RANGE = +0          16200004
                               MOVE PV-ITEM-IN-USE                      16210004
                                     TO  MB134-END-OF-SELECTED-RANGE    16220004
                           ELSE                                         16230004
      *                                                                 16240004
                               IF  PS-VALID-SELECTIONS                  16250004
                                   MOVE PC-TSYMSG-00055                 16260004
                                     TO  DP020-MSG-NUMBER               16270004
                                                                        16280004
                                   IF  NOT DP020-NEXT-ACT-ERROR         16290004
                                       MOVE -1                          16300004
                                          TO  MBKM134-SELECTL(PS-SUB)   16310004
                                   END-IF                               16320004
                               END-IF                                   16330004
                               SET PS-INVALID-SELECTIONS                16340004
                                          TO  TRUE                      16350004
                               SET PS-CURSOR-POSITIONED                 16360004
                                          TO  TRUE                      16370004
                               SET DP020-MSG-FATAL                      16380004
                                          TO  TRUE                      16390004
                           END-IF                                       16400004
                       END-IF                                           16410004
                   ELSE                                                 16420004
      *                                                                 16430004
                       IF  PS-VALID-SELECTIONS                          16440004
                           MOVE PC-TSYMSG-00005                         16450004
                                     TO  DP020-MSG-NUMBER               16460004
                           IF  NOT DP020-NEXT-ACT-ERROR                 16470004
                               MOVE -1                                  16480004
                                     TO  MBKM134-SELECTL(PS-SUB)        16490004
                           END-IF                                       16500004
                       END-IF                                           16510004
                       SET PS-INVALID-SELECTIONS                        16520004
                                     TO  TRUE                           16530004
                       SET PS-CURSOR-POSITIONED                         16540004
                                     TO  TRUE                           16550004
                       SET DP020-MSG-FATAL                              16560004
                                     TO  TRUE                           16570004
                       MOVE DP015-RED                                   16580004
                                     TO  MBKM134-SELECTC(PS-SUB)        16590004
                       MOVE DP015-REVERSE                               16600004
                                     TO  MBKM134-SELECTH(PS-SUB)        16610004
                   END-IF                                               16620004
               END-IF                                                   16630004
           END-IF.                                                      16640004
                                                                        16650004
           ADD +1                    TO  PV-ITEM-IN-USE.                16660004
           ADD +1                    TO  PS-SUB.                        16670004
       EJECT                                                            16680004
      ******************************************************************16690004
      *    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE     16700004
      *    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS     16710004
      *    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.              16720004
      *                                                                 16730004
      *    PERFORMED BY E100-EDIT-SELECTIONS.                           16740004
      ******************************************************************16750004
      *                                                                 16760004
       F200-MARK-RANGE-AS-SELECTED.                                     16770004
      *                                                                 16780004
           MOVE +1                   TO  MB134-BLK-SUB.                 16790004
           PERFORM G200-MARK-SELECTED-INDS                              16800004
               VARYING MB134-ITEM-SUB FROM 1 BY 1                       16810004
               UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK.               16820004
      *                                                                 16830004
           ADD +1 TO MB134-BLK-SUB.                                     16840004
           PERFORM G200-MARK-SELECTED-INDS                              16850004
               VARYING MB134-ITEM-SUB FROM 1 BY 1                       16860004
               UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK.               16870004
      *                                                                 16880004
           MOVE MB134-LIST-ITEM-NUMBER(1 1)                             16890004
                                     TO  PV-LIST-ITEM-NUMBER.           16900004
           COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16910004
               1 + ((PV-LIST-ITEM-NUMBER - 1) /                         16920004
                     PC-ITEMS-PER-BLOCK).                               16930004
      *                                                                 16940004
           MOVE MB134-START-OF-SELECTED-RANGE                           16950004
                                     TO  PV-START-OF-SELECTED-RANGE.    16960004
           COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            16970004
               1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  16980004
                     PC-ITEMS-PER-BLOCK).                               16990004
      *                                                                 17000004
           MOVE MB134-END-OF-SELECTED-RANGE                             17010004
                                     TO  PV-END-OF-SELECTED-RANGE.      17020004
           COMPUTE PV-LAST-BLOCK-IN-RANGE =                             17030004
               1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    17040004
                     PC-ITEMS-PER-BLOCK).                               17050004
           COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             17060004
               PV-FIRST-BLOCK-IN-ARRAY + 1.                             17070004
      *                                                                 17080004
           IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    17090004
              (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        17100004
               MOVE +1               TO  MB134-BLK-SUB                  17110004
               PERFORM Z150-WRITE-TEMP-STORAGE                          17120004
               COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17130004
                   PV-FIRST-BLOCK-IN-ARRAY - 1                          17140004
      *                                                                 17150004
               PERFORM                                                  17160004
                   UNTIL PV-FIRST-BLOCK-IN-RANGE >                      17170004
                         PV-PREV-BLOCK-IN-ARRAY                         17180004
                   MOVE PV-FIRST-BLOCK-IN-RANGE                         17190004
                                     TO  PV-BLOCK-NUMBER                17200004
                   PERFORM Z100-READ-TEMP-STORAGE                       17210004
                   PERFORM G200-MARK-SELECTED-INDS                      17220004
                       VARYING MB134-ITEM-SUB FROM 1 BY 1               17230004
                       UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK        17240004
                   PERFORM Z150-WRITE-TEMP-STORAGE                      17250004
                   ADD +1            TO PV-FIRST-BLOCK-IN-RANGE         17260004
               END-PERFORM                                              17270004
      *                                                                 17280004
               COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17290004
                   PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17300004
               PERFORM                                                  17310004
                   UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17320004
                         PV-LAST-BLOCK-IN-RANGE                         17330004
                   MOVE PV-NEXT-BLOCK-IN-ARRAY                          17340004
                                     TO  PV-BLOCK-NUMBER                17350004
                   PERFORM Z100-READ-TEMP-STORAGE                       17360004
                   PERFORM G200-MARK-SELECTED-INDS                      17370004
                       VARYING MB134-ITEM-SUB FROM 1 BY 1               17380004
                       UNTIL MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK        17390004
                   PERFORM Z150-WRITE-TEMP-STORAGE                      17400004
                   ADD +1            TO  PV-NEXT-BLOCK-IN-ARRAY         17410004
               END-PERFORM                                              17420004
      *                                                                 17430004
               MOVE PV-FIRST-BLOCK-IN-ARRAY                             17440004
                                     TO  PV-BLOCK-NUMBER                17450004
               PERFORM Z100-READ-TEMP-STORAGE                           17460004
           END-IF.                                                      17470004
                                                                        17480004
           MOVE +0                   TO  MB134-START-OF-SELECTED-RANGE  17490004
                                         MB134-END-OF-SELECTED-RANGE.   17500004
       EJECT                                                            17510004
      ******************************************************************17520004
      *    CHECK EACH ENTRY TO DETERMINE IF THE SELECTION CRITERIA IN   17530004
      *    THE MAP DIFFERS FROM THAT IN THE ARRAY.  IF THEY DO DIFFER,  17540004
      *    AND THE ARRAY ENTRY SHOWS THAT THE ITEM WAS PREVIOUSLY       17550004
      *    SELECTED, SUBTRACT 1 FROM THE SELECTED COUNTER.  IF THEY DO  17560004
      *    DIFFER, AND THE ARRAY ENTRY SHOWS THAT THIS ITEM WAS MARKED  17570004
      *    AS EITHER THE BEGINNING OR ENDING SELECTION POINT, ZERO OUT  17580004
      *    THE STARTING RANGE AND/OR ENDING RANGE.  IF THE ENTRY ON     17590004
      *    THE MAP SHOWS THAT THIS ITEM WAS SELECTED, ADD 1 TO THE      17600004
      *    SELECTED COUNTER.                                            17610004
      *                                                                 17620004
      *    PERFORMED BY E200-MOVE-SELECTS-TO-COMMAREA.                  17630004
      ******************************************************************17640004
      *                                                                 17650004
       F300-CHECK-SELECTIONS.                                           17660004
      *                                                                 17670004
           IF (PV-ITEM-IN-USE < MB134-NUMBER-OF-ITEMS-READ) OR          17680004
              (PV-ITEM-IN-USE = MB134-NUMBER-OF-ITEMS-READ)             17690004
               PERFORM K100-SET-SUBSCRIPTS                              17700004
      *                                                                 17710004
               IF  MB134-SELECTED-SW(MB134-BLK-SUB MB134-ITEM-SUB)      17720004
                   NOT EQUAL MBKM134-SELECTI(PS-SUB)                    17730004
                   SET MB134-BLOCK-MODIFIED(MB134-BLK-SUB)              17740004
                                     TO  TRUE                           17750004
                   IF  MB134-SELECT(MB134-BLK-SUB MB134-ITEM-SUB)       17760004
                       SUBTRACT +1 FROM MB134-NUMBER-OF-SELECTED-ITEMS  17770004
                   ELSE                                                 17780004
      *                                                                 17790004
                       IF  MB134-BEGIN(MB134-BLK-SUB MB134-ITEM-SUB)    17800004
                           IF  MB134-LIST-ITEM-NUMBER(MB134-BLK-SUB     17810004
                                                     MB134-ITEM-SUB) =  17820004
                               MB134-START-OF-SELECTED-RANGE            17830004
                               MOVE +0                                  17840004
                                     TO  MB134-START-OF-SELECTED-RANGE  17850004
                           END-IF                                       17860004
                       ELSE                                             17870004
      *                                                                 17880004
                           IF  MB134-END(MB134-BLK-SUB MB134-ITEM-SUB)  17890004
                               IF  MB134-LIST-ITEM-NUMBER               17900004
                                       (MB134-BLK-SUB MB134-ITEM-SUB)   17910004
                               =  MB134-END-OF-SELECTED-RANGE           17920004
                                   MOVE +0                              17930004
                                     TO MB134-END-OF-SELECTED-RANGE     17940004
                               END-IF                                   17950004
                           END-IF                                       17960004
                       END-IF                                           17970004
                   END-IF                                               17980004
      *                                                                 17990004
                   IF MBKM134-SELECTI(PS-SUB) = PC-SELECTED             18000004
                       ADD +1        TO MB134-NUMBER-OF-SELECTED-ITEMS  18010004
                   END-IF                                               18020004
      *                                                                 18030004
                   IF (MBKM134-SELECTA(PS-SUB) = PC-ERASE-EOF) OR       18040004
                      (MBKM134-SELECTI(PS-SUB) = SPACES)                18050004
                       MOVE SPACES   TO                                 18060004
                            MB134-SELECTED-SW(MB134-BLK-SUB             18070004
                                              MB134-ITEM-SUB)           18080004
                   ELSE                                                 18090004
                       MOVE MBKM134-SELECTI(PS-SUB) TO                  18100004
                            MB134-SELECTED-SW(MB134-BLK-SUB             18110004
                                              MB134-ITEM-SUB)           18120004
                   END-IF                                               18130004
               END-IF                                                   18140004
           END-IF.                                                      18150004
      *                                                                 18160004
           ADD +1                    TO  PV-ITEM-IN-USE.                18170004
           ADD +1                    TO  PS-SUB.                        18180004
      *                                                                 18190004
       EJECT                                                            18200004
      ******************************************************************18210004
      *    CALCULATE THE NEW TOP AND BOTTOM ITEM NUMBERS BASED ON WHERE 18220004
      *    THE USER SPECIFIED TO GO ON THE LIST AND DETERMINE WHERE     18230004
      *    THESE ITEMS CAN BE FOUND (I.E. ARRAY, TEMPORARY STORAGE).    18240004
      *                                                                 18250004
      *    PERFORMED BY E400-DISPLAY-TOP-OF-LIST.                       18260004
      *    PERFORMED BY E500-BROWSE-BACKWARD.                           18270004
      *    PERFORMED BY E600-BROWSE-FORWARD.                            18280004
      *    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                     18290004
      ******************************************************************18300004
      *                                                                 18310004
       F500-BROWSE.                                                     18320004
      *                                                                 18330004
           IF  PV-TOP-ITEM < +1                                         18340004
               MOVE +1               TO  PV-TOP-ITEM                    18350004
               IF  PS-CURSOR-NOT-POSITIONED                             18360004
                   MOVE PC-TSYMSG-00069                                 18370004
                                     TO  DP020-MSG-NUMBER               18380004
                   SET DP020-MSG-INFORMATIONAL                          18390004
                                     TO  TRUE                           18400004
                   SET PS-INFORMATIONAL                                 18410004
                                     TO  TRUE                           18420004
                   SET PS-CURSOR-POSITIONED                             18430004
                                     TO  TRUE                           18440004
               END-IF                                                   18450004
           END-IF.                                                      18460004
      *                                                                 18470004
           IF  MB134-NO-ITEMS-LEFT-ON-DB                                18480004
               IF  PV-TOP-ITEM > MB134-NUMBER-OF-ITEMS-READ             18490004
                   IF  DP020-SRC-AID EQUAL DP016-ENTER                  18500004
                       MOVE MB134-NUMBER-OF-ITEMS-READ                  18510004
                                     TO  PV-TOP-ITEM                    18520004
                   ELSE                                                 18530004
                       MOVE MB134-ITEM-AT-TOP-OF-PANEL                  18540004
                                     TO  PV-TOP-ITEM                    18550004
                   END-IF                                               18560004
      *                                                                 18570004
                   IF  PS-CURSOR-NOT-POSITIONED                         18580004
                       MOVE -1       TO  ANAVCMDL                       18590004
                       SET DP020-MSG-INFORMATIONAL                      18600004
                                     TO  TRUE                           18610004
                       SET PS-CURSOR-POSITIONED                         18620004
                                     TO  TRUE                           18630004
      *                IF  DP020-FK-NEXT-PAGE(DP020-SRC-AID)            18640004
                           MOVE PC-TSYMSG-00070                         18650004
                                     TO  DP020-MSG-NUMBER               18660004
                           SET PS-INFORMATIONAL                         18670004
                                     TO  TRUE                           18680004
      *                ELSE                                             18690004
      *                    MOVE PC-TSYMSG-00061                         18700004
      *                              TO  DP020-MSG-NUMBER               18710004
      *                END-IF                                           18720004
                   END-IF                                               18730004
               END-IF                                                   18740004
           END-IF.                                                      18750004
      *                                                                 18760004
           COMPUTE PV-BOTTOM-ITEM =                                     18770004
               (PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1.                  18780004
                                                                        18790004
           IF  MB134-NO-ITEMS-LEFT-ON-DB                                18800004
               IF  PV-BOTTOM-ITEM > MB134-NUMBER-OF-ITEMS-READ          18810004
                   MOVE MB134-NUMBER-OF-ITEMS-READ                      18820004
                                     TO  PV-BOTTOM-ITEM                 18830004
                   IF  PS-CURSOR-NOT-POSITIONED                         18840004
                       IF  PV-TOP-ITEM NOT = +1                         18850004
      *                    IF  DP020-FK-NEXT-PAGE(DP020-SRC-AID)        18860004
                               MOVE PC-TSYMSG-00070                     18870004
                                     TO  DP020-MSG-NUMBER               18880004
                               SET PS-INFORMATIONAL                     18890004
                                     TO  TRUE                           18900004
                               SET DP020-MSG-INFORMATIONAL              18910004
                                     TO  TRUE                           18920004
                               SET PS-CURSOR-POSITIONED                 18930004
                                     TO  TRUE                           18940004
      *                    END-IF                                       18950004
                       END-IF                                           18960004
                   END-IF                                               18970004
               END-IF                                                   18980004
           END-IF.                                                      18990004
      *                                                                 19000004
           PERFORM G300-DETERMINE-WHAT-IS-WHERE.                        19010004
                                                                        19020004
           IF  PS-TOP-ITEM-IN-ARRAY                                     19030004
               IF  PS-BOTTOM-ITEM-NOT-IN-ARRAY                          19040004
                   IF  PS-BOTTOM-ITEM-IN-TEMP                           19050004
                       PERFORM G500-SCROLL-FORWARD                      19060004
                   ELSE                                                 19070004
                       IF  PS-LAST-BLOCK-NOT-IN-ARRAY                   19080004
                           PERFORM G500-SCROLL-FORWARD                  19090004
                       END-IF                                           19100004
                       PERFORM G400-READ-ITEMS-INTO-ARRAY               19110004
                   END-IF                                               19120004
               END-IF                                                   19130004
           ELSE                                                         19140004
      *                                                                 19150004
               IF  PS-BOTTOM-ITEM-IN-ARRAY                              19160004
                   PERFORM G600-SCROLL-BACKWARD                         19170004
               ELSE                                                     19180004
                   IF  PS-TOP-ITEM-IN-TEMP                              19190004
                       PERFORM G700-GET-TOP-ITEMS-BLOCK                 19200004
                       PERFORM G300-DETERMINE-WHAT-IS-WHERE             19210004
                       IF  PS-BOTTOM-ITEM-NOT-IN-ARRAY                  19220004
                           PERFORM G400-READ-ITEMS-INTO-ARRAY           19230004
                       END-IF                                           19240004
                   ELSE                                                 19250004
                       IF  PS-LAST-BLOCK-NOT-IN-ARRAY                   19260004
                           PERFORM G800-GET-LAST-BLOCK-IN-TEMP          19270004
                       END-IF                                           19280004
                       PERFORM G400-READ-ITEMS-INTO-ARRAY               19290004
                   END-IF                                               19300004
               END-IF                                                   19310004
           END-IF.                                                      19320004
      *                                                                 19330004
           IF  PV-TOP-ITEM = MB134-ITEM-AT-TOP-OF-PANEL                 19340004
               SET PS-SAME-ITEMS-DISPLAYED                              19350004
                                     TO  TRUE                           19360004
           ELSE                                                         19370004
               SET PS-DIFFERENT-ITEMS-DISPLAYED                         19380004
                                     TO  TRUE                           19390004
               MOVE PV-TOP-ITEM      TO  MB134-ITEM-AT-TOP-OF-PANEL     19400004
           END-IF.                                                      19410004
      *                                                                 19420004
           PERFORM G100-DISPLAY-PANEL.                                  19430004
      *                                                                 19440004
       EJECT                                                            19450004
      ******************************************************************19460004
      *    MARK EACH ITEM AS BEING NOT SELECTED.                        19470004
      *                                                                 19480004
      *    PERFORMED BY E700-DESELECT-ALL-ITEMS.                        19490004
      ******************************************************************19500004
      *                                                                 19510004
       F600-CLEAR-SELECTED-INDS.                                        19520004
      *                                                                 19530004
           IF  MB134-LIST-ITEM-NUMBER(MB134-BLK-SUB MB134-ITEM-SUB)     19540004
                   NOT EQUAL ZERO                                       19550004
               IF  NOT MB134-NO-SELECT(MB134-BLK-SUB MB134-ITEM-SUB)    19560004
                   SET MB134-NO-SELECT(MB134-BLK-SUB MB134-ITEM-SUB)    19570004
                                     TO  TRUE                           19580004
                   SET MB134-BLOCK-MODIFIED(MB134-BLK-SUB)              19590004
                                     TO  TRUE                           19600004
               END-IF                                                   19610004
           END-IF.                                                      19620004
      *                                                                 19630004
       EJECT                                                            19640004
      ******************************************************************19650004
      *    MARK EACH ITEM AS BEING SELECTED.                            19660004
      *                                                                 19670004
      *    PERFORMED BY E900-SELECT-ALL-ITEMS.                          19680004
      ******************************************************************19690004
      *                                                                 19700004
       F700-SET-SELECTED-INDS.                                          19710004
      *                                                                 19720004
           IF  MB134-LIST-ITEM-NUMBER(MB134-BLK-SUB MB134-ITEM-SUB)     19730004
                   NOT EQUAL ZERO                                       19740004
               IF  NOT MB134-SELECT(MB134-BLK-SUB MB134-ITEM-SUB)       19750004
                   SET MB134-SELECT(MB134-BLK-SUB MB134-ITEM-SUB)       19760004
                                     TO  TRUE                           19770004
                   SET MB134-BLOCK-MODIFIED(MB134-BLK-SUB)              19780004
                                     TO  TRUE                           19790004
               END-IF                                                   19800004
           END-IF.                                                      19810004
      *                                                                 19820004
       EJECT                                                            19830004
      ******************************************************************19840004
      *    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.       19850004
      *                                                                 19860004
      *    PERFORMED BY B100-CONTROL-PROCESSING.                        19870004
      *    PERFORMED BY C300-PROCESS-PANEL.                             19880004
      *    PERFORMED BY C400-REFRESH-PANEL-FROM-TEMP.                   19890004
      *    PERFORMED BY D100-SETUP-INIT-PANEL.                          19900004
      *    PERFORMED BY E400-DISPLAY-TOP-OF-LIST.                       19910004
      *    PERFORMED BY E500-BROWSE-BACKWARD.                           19920004
      *    PERFORMED BY E600-BROWSE-FORWARD.                            19930004
      *    PERFORMED BY E700-DESELECT-ALL-ITEMS.                        19940004
      *    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                     19950004
      *    PERFORMED BY F500-BROWSE.                                    19960004
      ******************************************************************19970004
      *                                                                 19980004
       G100-DISPLAY-PANEL.                                              19990004
      *                                                                 20000004
           PERFORM DP017-0000-GET-CURR-DATE-TIME.                       20010004
           MOVE DP017-EDITED-TIME-HMS                                   20020004
                                     TO  ATIMEO.                        20030004
                                                                        20040004
           IF PS-SEND-MAP-N-DATA-FRSET                                  20050004
               PERFORM DP002-0000-FORMAT-TITLE-LINES                    20060004
               PERFORM DP009-0000-LOAD-FK-LINES                         20070004
           END-IF.                                                      20080004
                                                                        20090004
           PERFORM H200-FORMAT-PANEL-BODY.                              20100004
      *                                                                 20110004
           PERFORM DP005-0000-FORMAT-MSG-LINES.                         20120004
                                                                        20130004
           PERFORM DP008-0000-WRITE-PANEL.                              20140004
       EJECT                                                            20150004
      ******************************************************************20160004
      *    MARK EACH ITEM THAT FALLS WITHIN THE BEGINNING AND ENDING    20170004
      *    RANGE AS BEING SELECTED.                                     20180004
      *                                                                 20190004
      *    PERFORMED BY F200-MARK-RANGE-AS-SELECTED.                    20200004
      ******************************************************************20210004
      *                                                                 20220004
       G200-MARK-SELECTED-INDS.                                         20230004
      *                                                                 20240004
           IF (MB134-LIST-ITEM-NUMBER(MB134-BLK-SUB                     20250004
                                      MB134-ITEM-SUB) >                 20260004
               MB134-START-OF-SELECTED-RANGE)                           20270004
           OR (MB134-LIST-ITEM-NUMBER(MB134-BLK-SUB                     20280004
                                      MB134-ITEM-SUB) =                 20290004
               MB134-START-OF-SELECTED-RANGE)                           20300004
      *                                                                 20310004
               IF (MB134-LIST-ITEM-NUMBER(MB134-BLK-SUB                 20320004
                                          MB134-ITEM-SUB) <             20330004
                   MB134-END-OF-SELECTED-RANGE)                         20340004
               OR (MB134-LIST-ITEM-NUMBER(MB134-BLK-SUB                 20350004
                                          MB134-ITEM-SUB) =             20360004
                   MB134-END-OF-SELECTED-RANGE)                         20370004
      *                                                                 20380004
                   IF NOT MB134-SELECT(MB134-BLK-SUB MB134-ITEM-SUB)    20390004
                       SET MB134-SELECT(MB134-BLK-SUB                   20400004
                                        MB134-ITEM-SUB)                 20410004
                                     TO  TRUE                           20420004
                       SET MB134-BLOCK-MODIFIED(MB134-BLK-SUB)          20430004
                                     TO  TRUE                           20440004
                       ADD +1        TO MB134-NUMBER-OF-SELECTED-ITEMS  20450004
                   END-IF                                               20460004
               END-IF                                                   20470004
           END-IF.                                                      20480004
       EJECT                                                            20490004
      ******************************************************************20500004
      *    DETERMINE WHETHER THE TOP ITEM AND BOTTOM ITEM CAN BE FOUND  20510004
      *    IN THE ARRAY, IN TEMPORARY STORAGE, OR NEITHER.              20520004
      *                                                                 20530004
      *    PERFORMED BY F500-BROWSE.                                    20540004
      ******************************************************************20550004
      *                                                                 20560004
       G300-DETERMINE-WHAT-IS-WHERE.                                    20570004
      *                                                                 20580004
           MOVE MB134-LIST-ITEM-NUMBER(1 1)                             20590004
                                     TO  PV-FIRST-ITEM-IN-ARRAY.        20600004
           COMPUTE PV-LAST-ITEM-IN-ARRAY =                              20610004
               (PV-FIRST-ITEM-IN-ARRAY +                                20620004
               (PC-MAX-BLOCKS-IN-ARRAY * PC-ITEMS-PER-BLOCK)) - 1.      20630004
           IF  PV-LAST-ITEM-IN-ARRAY > MB134-NUMBER-OF-ITEMS-READ       20640004
               MOVE MB134-NUMBER-OF-ITEMS-READ                          20650004
                                     TO  PV-LAST-ITEM-IN-ARRAY          20660004
           END-IF.                                                      20670004
      *                                                                 20680004
           COMPUTE PV-LAST-ITEM-IN-TEMP =                               20690004
               MB134-HIGHEST-BLOCK-WRITTEN * PC-ITEMS-PER-BLOCK.        20700004
           IF  PV-LAST-ITEM-IN-TEMP > MB134-NUMBER-OF-ITEMS-READ        20710004
               MOVE MB134-NUMBER-OF-ITEMS-READ                          20720004
                                     TO  PV-LAST-ITEM-IN-TEMP           20730004
           END-IF.                                                      20740004
      *                                                                 20750004
           IF (PV-TOP-ITEM > PV-FIRST-ITEM-IN-ARRAY)                    20760004
           OR (PV-TOP-ITEM = PV-FIRST-ITEM-IN-ARRAY)                    20770004
               IF (PV-TOP-ITEM < PV-LAST-ITEM-IN-ARRAY)                 20780004
               OR (PV-TOP-ITEM = PV-LAST-ITEM-IN-ARRAY)                 20790004
                   SET PS-TOP-ITEM-IN-ARRAY                             20800004
                                     TO  TRUE                           20810004
               ELSE                                                     20820004
                   SET PS-TOP-ITEM-NOT-IN-ARRAY                         20830004
                                     TO  TRUE                           20840004
               END-IF                                                   20850004
           ELSE                                                         20860004
               SET PS-TOP-ITEM-NOT-IN-ARRAY                             20870004
                                     TO  TRUE                           20880004
           END-IF.                                                      20890004
      *                                                                 20900004
           IF (PV-BOTTOM-ITEM > PV-FIRST-ITEM-IN-ARRAY)                 20910004
           OR (PV-BOTTOM-ITEM = PV-FIRST-ITEM-IN-ARRAY)                 20920004
               IF (PV-BOTTOM-ITEM < PV-LAST-ITEM-IN-ARRAY)              20930004
               OR (PV-BOTTOM-ITEM = PV-LAST-ITEM-IN-ARRAY)              20940004
                   SET PS-BOTTOM-ITEM-IN-ARRAY                          20950004
                                     TO  TRUE                           20960004
               ELSE                                                     20970004
                   SET PS-BOTTOM-ITEM-NOT-IN-ARRAY                      20980004
                                     TO  TRUE                           20990004
               END-IF                                                   21000004
           ELSE                                                         21010004
               SET PS-BOTTOM-ITEM-NOT-IN-ARRAY                          21020004
                                     TO  TRUE                           21030004
           END-IF.                                                      21040004
      *                                                                 21050004
           IF (PV-TOP-ITEM < PV-LAST-ITEM-IN-TEMP)                      21060004
           OR (PV-TOP-ITEM = PV-LAST-ITEM-IN-TEMP)                      21070004
               SET PS-TOP-ITEM-IN-TEMP                                  21080004
                                     TO  TRUE                           21090004
           ELSE                                                         21100004
               SET PS-TOP-ITEM-NOT-IN-TEMP                              21110004
                                     TO  TRUE                           21120004
           END-IF.                                                      21130004
      *                                                                 21140004
           IF (PV-BOTTOM-ITEM < PV-LAST-ITEM-IN-TEMP)                   21150004
           OR (PV-BOTTOM-ITEM = PV-LAST-ITEM-IN-TEMP)                   21160004
               SET PS-BOTTOM-ITEM-IN-TEMP                               21170004
                                     TO  TRUE                           21180004
           ELSE                                                         21190004
               SET PS-BOTTOM-ITEM-NOT-IN-TEMP                           21200004
                                     TO  TRUE                           21210004
           END-IF.                                                      21220004
      *                                                                 21230004
           IF PV-LAST-ITEM-IN-TEMP > PV-LAST-ITEM-IN-ARRAY              21240004
               SET PS-LAST-BLOCK-NOT-IN-ARRAY                           21250004
                                     TO  TRUE                           21260004
           ELSE                                                         21270004
               SET PS-LAST-BLOCK-IN-ARRAY                               21280004
                                     TO  TRUE                           21290004
           END-IF.                                                      21300004
      *                                                                 21310004
       EJECT                                                            21320004
      ******************************************************************21330004
      *    DETERMINE THE SPOT IN THE ARRAY WHERE THE LAST ITEM FROM     21340004
      *    THE DATA BASE WAS ADDED SO WE KNOW WHERE TO ADD THE NEW      21350004
      *    ITEMS.  USE THE SAVED UPC KEY TO START THE BROWSE.  H600     21360004
      *    MUST BE PERFORMED TO POSITION TO THE FIRST UPC TO PROCESS.   21370004
      *                                                                 21380004
      *    PERFORMED BY F500-BROWSE.                                    21390004
      ******************************************************************21400004
      *                                                                 21410004
       G400-READ-ITEMS-INTO-ARRAY.                                      21420004
      *                                                                 21430004
           COMPUTE PS-ITEM-SUB =                                        21440004
               (MB134-NUMBER-OF-ITEMS-READ -                            21450004
                MB134-LIST-ITEM-NUMBER(1 1)) + 1.                       21460004
                                                                        21470004
           MOVE PS-ITEM-SUB TO MB134-ITEM-SUB.                          21480004
                                                                        21490004
           IF  MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK                      21500004
               SUBTRACT PC-ITEMS-PER-BLOCK                              21510004
                                   FROM  MB134-ITEM-SUB                 21520004
               MOVE PC-MAX-BLOCKS-IN-ARRAY                              21530004
                                     TO  MB134-BLK-SUB                  21540004
           ELSE                                                         21550004
               MOVE +1               TO  MB134-BLK-SUB                  21560004
           END-IF.                                                      21570004
      *                                                                 21580004
           MOVE PV-BOTTOM-ITEM       TO  PV-HIGHEST-ITEM-TO-BE-READ.    21590004
      *                                                                 21600004
           PERFORM L100-OPEN-CURSOR.                                    21610004
           PERFORM H100-READ-ITEMS-FROM-DB.                             21620004
           IF  PV-ITEMS-READ EQUAL ZERO                                 21630004
               MOVE MB134-ITEM-AT-TOP-OF-PANEL                          21640004
                                     TO  PV-TOP-ITEM                    21650004
           END-IF.                                                      21660004
      *                                                                 21670004
           IF  MB134-NO-ITEMS-LEFT-ON-DB                                21680004
               IF  PV-TOP-ITEM > MB134-NUMBER-OF-ITEMS-READ             21690004
                   MOVE MB134-NUMBER-OF-ITEMS-READ                      21700004
                                     TO  PV-TOP-ITEM                    21710004
               END-IF                                                   21720004
      *        IF  DP020-FK-NEXT-PAGE(DP020-SRC-AID)                    21730004
                   MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER           21740004
                   SET DP020-MSG-INFORMATIONAL                          21750004
                                     TO  TRUE                           21760004
                   SET PS-INFORMATIONAL                                 21770004
                                     TO  TRUE                           21780004
      *        END-IF                                                   21790004
           END-IF.                                                      21800004
      *                                                                 21810004
       EJECT                                                            21820004
      ******************************************************************21830004
      *    IF THE TOP ITEM WE NEED IS IN THE ARRAY, BUT THE BOTTOM      21840004
      *    ITEM WE NEED IS IN TEMPORARY STORAGE OR HAS NOT BEEN READ    21850004
      *    YET, WRITE OUT THE 1ST BLOCK IN THE ARRAY TO TEMPORARY       21860004
      *    STORAGE.  MOVE THE 2ND BLOCK IN THE ARRAY TO THE 1ST BLOCK   21870004
      *    AND READ THE BLOCK NEEDED INTO THE 2ND BLOCK OF THE ARRAY.   21880004
      *    THE TOP ITEM WILL BE LOCATED IN THE 1ST BLOCK, AND THE       21890004
      *    BOTTOM ITEM WILL EITHER BE LOCATED IN THE 2ND BLOCK OR       21900004
      *    WILL BE PLACED IN THE 2ND BLOCK.                             21910004
      *                                                                 21920004
      *    PERFORMED BY F500-BROWSE.                                    21930004
      ******************************************************************21940004
      *                                                                 21950004
       G500-SCROLL-FORWARD.                                             21960004
      *                                                                 21970004
           MOVE +1                   TO  MB134-BLK-SUB.                 21980004
           SET MB134-BLOCK-MODIFIED (1)                                 21990004
                                     TO  TRUE.                          22000004
           PERFORM Z150-WRITE-TEMP-STORAGE.                             22010004
      *                                                                 22020004
           MOVE MB134-BLOCK-ENTRIES(PC-MAX-BLOCKS-IN-ARRAY) TO          22030004
                MB134-BLOCK-ENTRIES(MB134-BLK-SUB).                     22040004
      *                                                                 22050004
           COMPUTE PV-TEMP-BLOCK-NUMBER =                               22060004
               1 + ((PV-BOTTOM-ITEM - 1) / PC-ITEMS-PER-BLOCK).         22070004
      *                                                                 22080004
           MOVE PV-TEMP-BLOCK-NUMBER TO  PV-BLOCK-NUMBER.               22090004
           ADD +1                    TO  MB134-BLK-SUB.                 22100004
           PERFORM Z100-READ-TEMP-STORAGE.                              22110004
      *                                                                 22120004
       EJECT                                                            22130004
      ******************************************************************22140004
      *    IF TOP ITEM WE NEED IS NOT IN THE ARRAY, BUT THE BOTTOM      22150004
      *    ITEM IS, WRITE BOTH BLOCKS TO TEMPORARY STORAGE.  MOVE       22160004
      *    THE 1ST BLOCK IN THE ARRAY TO THE 2ND BLOCK OF THE ARRAY.    22170004
      *    READ THE BLOCK THAT CONTAINS THE TOP ITEM INTO THE 1ST BLOCK 22180004
      *    OF THE ARRAY.                                                22190004
      *                                                                 22200004
      *    PERFORMED BY F500-BROWSE.                                    22210004
      ******************************************************************22220004
                                                                        22230004
       G600-SCROLL-BACKWARD.                                            22240004
                                                                        22250004
           MOVE +1                   TO  MB134-BLK-SUB.                 22260004
      *    SET MB134-BLOCK-MODIFIED (1)                                 22270004
      *                              TO  TRUE.                          22280004
           PERFORM Z150-WRITE-TEMP-STORAGE.                             22290004
                                                                        22300004
           ADD +1 TO MB134-BLK-SUB.                                     22310004
      *    SET MB134-BLOCK-MODIFIED (2)                                 22320004
      *                              TO  TRUE.                          22330004
           PERFORM Z150-WRITE-TEMP-STORAGE.                             22340004
                                                                        22350004
           MOVE +1                   TO  MB134-BLK-SUB.                 22360004
           MOVE MB134-BLOCK-ENTRIES(MB134-BLK-SUB) TO                   22370004
                MB134-BLOCK-ENTRIES(PC-MAX-BLOCKS-IN-ARRAY).            22380004
                                                                        22390004
           COMPUTE PV-TEMP-BLOCK-NUMBER =                               22400004
               1 + ((PV-TOP-ITEM - 1) / PC-ITEMS-PER-BLOCK).            22410004
                                                                        22420004
           MOVE PV-TEMP-BLOCK-NUMBER TO PV-BLOCK-NUMBER.                22430004
           PERFORM Z100-READ-TEMP-STORAGE.                              22440004
                                                                        22450004
       EJECT                                                            22460004
      ******************************************************************22470004
      *    IF BOTH THE TOP AND BOTTOM ITEMS WE NEED ARE NOT IN THE      22480004
      *    ARRAY, BUT THE TOP ITEM IS IN TEMPORARY STORAGE, WRITE BOTH  22490004
      *    BLOCKS IN THE ARRAY TO TEMPORARY STORAGE.  READ THE BLOCK    22500004
      *    THAT CONTAINS THE TOP ITEM INTO THE 1ST BLOCK OF THE ARRAY.  22510004
      *    IF THERE IS ANOTHER BLOCK IN TEMPORARY STORAGE FOLLOWING     22520004
      *    THE ONE JUST READ, READ THAT ONE INTO THE 2ND BLOCK OF THE   22530004
      *    ARRAY, OTHERWISE INITIALIZE THE 2ND BLOCK OF THE ARRAY.      22540004
      *                                                                 22550004
      *    PERFORMED BY F500-BROWSE.                                    22560004
      ******************************************************************22570004
                                                                        22580004
       G700-GET-TOP-ITEMS-BLOCK.                                        22590004
                                                                        22600004
      *    SET MB134-BLOCK-MODIFIED (1)                                 22610004
      *                              TO  TRUE.                          22620004
           MOVE +1                   TO  MB134-BLK-SUB.                 22630004
           PERFORM Z150-WRITE-TEMP-STORAGE.                             22640004
                                                                        22650004
      *    SET MB134-BLOCK-MODIFIED (2)                                 22660004
      *                              TO  TRUE.                          22670004
           ADD +1                    TO  MB134-BLK-SUB.                 22680004
           PERFORM Z150-WRITE-TEMP-STORAGE.                             22690004
                                                                        22700004
           COMPUTE PV-TEMP-BLOCK-NUMBER =                               22710004
               1 + ((PV-TOP-ITEM - 1) / PC-ITEMS-PER-BLOCK).            22720004
                                                                        22730004
           MOVE PV-TEMP-BLOCK-NUMBER TO  PV-BLOCK-NUMBER.               22740004
           MOVE +1                   TO  MB134-BLK-SUB.                 22750004
                                                                        22760004
           PERFORM Z100-READ-TEMP-STORAGE.                              22770004
                                                                        22780004
           ADD +1                    TO  PV-BLOCK-NUMBER.               22790004
           ADD +1                    TO  MB134-BLK-SUB.                 22800004
                                                                        22810004
           IF (PV-BLOCK-NUMBER < MB134-HIGHEST-BLOCK-WRITTEN) OR        22820004
              (PV-BLOCK-NUMBER = MB134-HIGHEST-BLOCK-WRITTEN)           22830004
               PERFORM Z100-READ-TEMP-STORAGE                           22840004
           ELSE                                                         22850004
               PERFORM I100-INITIALIZE-BLOCK                            22860004
           END-IF.                                                      22870004
                                                                        22880004
       EJECT                                                            22890004
      ******************************************************************22900004
      *    IF BOTH THE TOP AND BOTTOM ITEMS WE NEED ARE NOT IN THE      22910004
      *    ARRAY AND BOTH ITEMS ARE NOT IN TEMPORARY STORAGE (THE       22920004
      *    ITEMS HAVE NOT BEEN READ FROM THE DATA BASE YET), AND THE    22930004
      *    LAST ITEM READ FROM THE DATA BASE IS IN TEMPORARY STORAGE,   22940004
      *    WRITE BOTH BLOCKS IN THE ARRAY TO TEMPORARY STORAGE.  READ   22950004
      *    THE HIGHEST BLOCK IN TEMPORARY STORAGE INTO THE 1ST BLOCK    22960004
      *    OF THE ARRAY, AND INITIALIZE THE 2ND BLOCK IN THE ARRAY.     22970004
      *    THE 2ND BLOCK WILL BE USED FOR THE NEW ITEMS TO BE READ.     22980004
      *    THE 1ST BLOCK WILL NOW CONTAIN THE ITEMS THAT WERE LAST      22990004
      *    READ FROM THE DATA BASE.                                     23000004
      *                                                                 23010004
      *    PERFORMED BY F500-BROWSE.                                    23020004
      ******************************************************************23030004
      *                                                                 23040004
       G800-GET-LAST-BLOCK-IN-TEMP.                                     23050004
      *                                                                 23060004
           SET MB134-BLOCK-MODIFIED (1)                                 23070004
                                     TO  TRUE.                          23080004
           MOVE +1                   TO  MB134-BLK-SUB.                 23090004
           PERFORM Z150-WRITE-TEMP-STORAGE.                             23100004
           SET MB134-BLOCK-MODIFIED (2)                                 23110004
                                     TO  TRUE.                          23120004
           ADD +1                    TO  MB134-BLK-SUB.                 23130004
           PERFORM Z150-WRITE-TEMP-STORAGE.                             23140004
      *                                                                 23150004
           MOVE MB134-HIGHEST-BLOCK-WRITTEN                             23160004
                                     TO  PV-BLOCK-NUMBER.               23170004
           MOVE +1                   TO  MB134-BLK-SUB.                 23180004
           PERFORM Z100-READ-TEMP-STORAGE.                              23190004
      *                                                                 23200004
           ADD +1                    TO  MB134-BLK-SUB.                 23210004
           PERFORM I100-INITIALIZE-BLOCK.                               23220004
      *                                                                 23230004
       EJECT                                                            23240004
      ******************************************************************23250004
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE     23260004
      *    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,      23270004
      *    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND   23280004
      *    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE      23290004
      *    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                    23300004
      *                                                                 23310004
      *    PERFORMED BY D100-SETUP-INIT-PANEL.                          23320004
      *    PERFORMED BY G400-READ-ITEMS-INTO-ARRAY.                     23330004
      ******************************************************************23340004
                                                                        23350004
       H100-READ-ITEMS-FROM-DB.                                         23360004
                                                                        23370004
           PERFORM                                                      23380004
               UNTIL (MB134-NO-ITEMS-LEFT-ON-DB)                        23390004
                                                                        23420004
               PERFORM L200-FETCH                                       23430004
               IF  MB134-ITEMS-LEFT-ON-DB                               23440004
                   IF MB134-ITEM-SUB < PC-ITEMS-PER-BLOCK               23450004
                       ADD +1            TO  MB134-ITEM-SUB             23460004
                   ELSE                                                 23470004
                       ADD +1            TO  MB134-BLK-SUB              23480004
                       MOVE +1           TO  MB134-ITEM-SUB             23490004
                                                                        23500004
                       IF MB134-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY        23510004
                           MOVE +1       TO  MB134-BLK-SUB              23520004
                           PERFORM Z150-WRITE-TEMP-STORAGE              23550004
                           MOVE MB134-BLOCK-ENTRIES                     23560004
                                             (PC-MAX-BLOCKS-IN-ARRAY)   23560004
                           TO   MB134-BLOCK-ENTRIES(MB134-BLK-SUB)      23570004
                           ADD +1        TO  MB134-BLK-SUB              23580004
                           PERFORM I100-INITIALIZE-BLOCK                23590004
                       END-IF                                           23600004
                   END-IF                                               23610004
                   SET MB134-BLOCK-MODIFIED (MB134-BLK-SUB)             23530004
                                         TO  TRUE                       23540004
                                                                        23620004
                   ADD 1             TO  MB134-NUMBER-OF-ITEMS-READ     23630004
                                         PV-ITEMS-READ                  23640004
                   MOVE MB134-NUMBER-OF-ITEMS-READ                      23650004
                                     TO  MB134-LIST-ITEM-NUMBER         23660004
                                             (MB134-BLK-SUB             23670004
                                              MB134-ITEM-SUB)           23680004
                                                                        23690004
                   MOVE RSPBAR-RSPLVL-CDE                               23700004
                                     TO  MB134-RESP-LEVEL               23710004
                                             (MB134-BLK-SUB             23720004
                                              MB134-ITEM-SUB)           23730004
                                                                        23740004
                   MOVE RSPBAR-WORKER-STRT-DTE                          23750004
                                     TO  PV-DB2-DATE                    23760004
                   MOVE PV-DD-MM     TO  PV-WD-MM                       23770004
                   MOVE PV-DD-DD     TO  PV-WD-DD                       23780004
                   MOVE PV-DD-YY     TO  PV-WD-YY                       23790004
                   MOVE PV-WORK-DATE TO  MB134-START-DATE               23800004
                                             (MB134-BLK-SUB             23810004
                                              MB134-ITEM-SUB)           23820004
                                                                        23830004
                   IF  RSPBAR-WORKER-END-DTE = PC-NO-DISPLAY-DATE       23840004
                       MOVE SPACES   TO  MB134-END-DATE                 23850004
                                             (MB134-BLK-SUB             23860004
                                              MB134-ITEM-SUB)           23870004
                   ELSE                                                 23880004
                       MOVE RSPBAR-WORKER-END-DTE                       23890004
                                     TO  PV-DB2-DATE                    23900004
                       MOVE PV-DD-MM TO  PV-WD-MM                       23910004
                       MOVE PV-DD-DD TO  PV-WD-DD                       23920004
                       MOVE PV-DD-YY TO  PV-WD-YY                       23930004
                       MOVE PV-WORK-DATE                                23940004
                                     TO  MB134-END-DATE                 23950004
                                             (MB134-BLK-SUB             23960004
                                              MB134-ITEM-SUB)           23970004
                   END-IF                                               23980004
                                                                        23990004
                   MOVE MDSEAR-DESC  TO  MB134-RESP-DESC                24000004
                                             (MB134-BLK-SUB             24010004
                                              MB134-ITEM-SUB)           24020004
                                                                        24030004
                   MOVE MDSEAR-GMA-NBR                                  24040004
                                     TO  MB134-GMA                      24050004
                                             (MB134-BLK-SUB             24060004
                                              MB134-ITEM-SUB)           24070004
                                                                        24080004
                   MOVE MDSEAR-DMA-NBR                                  24090004
                                     TO  MB134-DMA                      24100004
                                             (MB134-BLK-SUB             24110004
                                              MB134-ITEM-SUB)           24120004
                                                                        24130004
                   MOVE MDSEAR-DEPT-NBR                                 24140004
                                     TO  MB134-DEPT                     24150004
                                             (MB134-BLK-SUB             24160004
                                              MB134-ITEM-SUB)           24170004
                                                                        24180004
                   MOVE MDSEAR-MDSELV-CDE                               24190004
                                     TO  MB134-MDSELV                   24200004
                                             (MB134-BLK-SUB             24210004
                                              MB134-ITEM-SUB)           24220004
                                                                        24230004
                   IF  PV-DB2-CURRENT-DATE LESS THAN                    24240004
                       RSPBAR-WORKER-END-DTE                            24250004
                       MOVE DP015-BLUE                                  24260004
                                     TO  MB134-COLOR                    24270004
                                             (MB134-BLK-SUB             24280004
                                              MB134-ITEM-SUB)           24290004
                   ELSE                                                 24300004
                       MOVE DP015-TURQUOISE                             24310004
                                     TO  MB134-COLOR                    24320004
                                             (MB134-BLK-SUB             24330004
                                              MB134-ITEM-SUB)           24340004
                   END-IF                                               24350004
                                                                        24360004
                   EVALUATE TRUE                                        24370004
                       WHEN MDSEAR-MDSELV-CDE EQUAL PC-GMA              24380004
                            MOVE MDSEAR-GMA-NBR                         24390004
                                     TO  MB134-AAA                      24400004
                                             (MB134-BLK-SUB             24410004
                                              MB134-ITEM-SUB)           24420004
                                                                        24430004
                       WHEN MDSEAR-MDSELV-CDE EQUAL PC-DMA              24440004
                            MOVE MDSEAR-DMA-NBR                         24450004
                                     TO  MB134-AAA                      24460004
                                             (MB134-BLK-SUB             24470004
                                              MB134-ITEM-SUB)           24480004
                                                                        24490004
                       WHEN MDSEAR-MDSELV-CDE EQUAL PC-DPT              24500004
                            MOVE MDSEAR-DEPT-NBR                        24510004
                                     TO  MB134-AAA                      24520004
                                             (MB134-BLK-SUB             24530004
                                              MB134-ITEM-SUB)           24540004
                                                                        24550004
                       WHEN MDSEAR-MDSELV-CDE EQUAL PC-MCL              24560004
                            MOVE MDSEAR-MAJ-CL-NBR                      24570004
                                     TO  MB134-AAA                      24580004
                                             (MB134-BLK-SUB             24590004
                                              MB134-ITEM-SUB)           24600004
                                                                        24610004
                       WHEN MDSEAR-MDSELV-CDE EQUAL PC-SCL              24620004
                            MOVE MDSEAR-SUB-CL-NBR                      24630004
                                     TO  MB134-AAA                      24640004
                                             (MB134-BLK-SUB             24650004
                                              MB134-ITEM-SUB)           24660004
                   END-EVALUATE                                         24670004
               END-IF                                                   24680004
           END-PERFORM.                                                 24690004
                                                                        24700004
           MOVE MDSEAR-MDSELV-CDE    TO  MB134-AAA-HEADING              24710004
                                         AAAAO.                         24720004
                                                                        24730004
       EJECT                                                            24740004
      *                                                                 24750004
      ******************************************************************24760004
      *    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.            24770004
      *                                                                 24780004
      *    PERFORMED BY G100-DISPLAY-PANEL.                             24790004
      ******************************************************************24800004
      *                                                                 24810004
       H200-FORMAT-PANEL-BODY.                                          24820004
      *                                                                 24830004
           PERFORM I700-FORMAT-FROM-TO-LINE.                            24840004
           PERFORM I200-FORMAT-LIST-LINES.                              24850004
           PERFORM I300-FORMAT-NR-SELECTED.                             24860004
                                                                        24870004
           IF NOT DP020-NEXT-ACT-ERROR                                  24880004
               PERFORM I800-SET-CURSOR-POSITION                         24890004
           END-IF.                                                      24900004
      *                                                                 24910004
       EJECT                                                            24920004
      ******************************************************************24930004
      *    INITIALIZE A BLOCK IN THE ARRAY.                             24940004
      *                                                                 24950004
      *    PERFORMED BY D100-SETUP-INIT-PANEL.                          24960004
      *    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                       24970004
      *    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                    24980004
      *    PERFORMED BY H100-READ-ITEMS-FROM-DB.                        24990004
      ******************************************************************25000004
      *                                                                 25010004
       I100-INITIALIZE-BLOCK.                                           25020004
      *                                                                 25030004
           INITIALIZE  MB134-BLOCK-ENTRIES (MB134-BLK-SUB).             25040004
           SET MB134-BLOCK-NOT-MODIFIED(MB134-BLK-SUB) TO TRUE.         25050004
       EJECT                                                            25060004
      ******************************************************************25070004
      *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.     25080004
      *                                                                 25090004
      *    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                     25100004
      *    PERFORMED BY H200-FORMAT-PANEL-BODY.                         25110004
      ******************************************************************25120004
      *                                                                 25130004
       I200-FORMAT-LIST-LINES.                                          25140004
      *                                                                 25150004
           COMPUTE PV-ENDING-ITEM-ON-PANEL =                            25160004
               (MB134-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.   25170004
      *                                                                 25180004
           MOVE MB134-ITEM-AT-TOP-OF-PANEL                              25190004
                                     TO  PV-ITEM-IN-USE.                25200004
           MOVE +1                   TO  PS-SUB.                        25210004
      *                                                                 25220004
           PERFORM J100-PROCESS-ITEMS                                   25230004
               UNTIL PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL.          25240004
      *                                                                 25250004
       EJECT                                                            25260004
      ******************************************************************25270004
      *    FORMAT THE FIELD WHICH WILL SHOW THE NUMBER OF ITEMS THAT    25280004
      *    WERE SELECTED BY THE USER.                                   25290004
      *                                                                 25300004
      *    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                     25310004
      *    PERFORMED BY H200-FORMAT-PANEL-BODY.                         25320004
      ******************************************************************25330004
      *                                                                 25340004
       I300-FORMAT-NR-SELECTED.                                         25350004
      *                                                                 25360004
           MOVE MB134-NUMBER-OF-SELECTED-ITEMS                          25370004
                                     TO  PV-DISPLAY5.                   25380004
           MOVE PV-DISPLAY5          TO  TOTSELO.                       25390004
       EJECT                                                            25400004
      ******************************************************************25410004
      *    FORMAT THE LINE THAT WILL SHOW THE TOTAL NUMBER OF ITEMS WE  25420004
      *    HAVE ON OUR LIST AND SHOW THE NUMBERS ASSOCIATED WITH THE    25430004
      *    FIRST AND LAST ITEMS ON CURRENT PAGE.  THIS WILL HELP THE    25440004
      *    USER DETERMINE HOW FAR THEY ARE INTO THE LIST.               25450004
      *                                                                 25460004
      *    PERFORMED BY H200-FORMAT-PANEL-BODY.                         25470004
      ******************************************************************25480004
      *                                                                 25490004
       I700-FORMAT-FROM-TO-LINE.                                        25500004
      *                                                                 25510004
           MOVE MB134-ITEM-AT-TOP-OF-PANEL                              25520004
                                     TO  PV-DISPLAY5.                   25530004
           MOVE PV-DISPLAY5          TO  ABEGITMO.                      25540004
      *                                                                 25550004
           MOVE DP015-GREEN          TO  ABEGITMC.                      25560004
           MOVE DP015-UNDERLINE      TO  ABEGITMH.                      25570004
           MOVE DP015-UNP-NUM-BRT-MDT                                   25580004
                                     TO  ABEGITMA.                      25590004
      *                                                                 25600004
           COMPUTE PV-ENDING-ITEM-ON-PANEL =                            25610004
               (MB134-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.   25620004
      *                                                                 25630004
           IF PV-ENDING-ITEM-ON-PANEL < MB134-NUMBER-OF-ITEMS-READ      25640004
               MOVE PV-ENDING-ITEM-ON-PANEL                             25650004
                                     TO  PV-DISPLAY5                    25660004
           ELSE                                                         25670004
               MOVE MB134-NUMBER-OF-ITEMS-READ                          25680004
                                     TO  PV-DISPLAY5                    25690004
           END-IF.                                                      25700004
           MOVE PV-DISPLAY5          TO  ATOITMO.                       25710004
      *                                                                 25720004
           MOVE MB134-NUMBER-OF-ITEMS-READ                              25730004
                                     TO  PV-DISPLAY5.                   25740004
           MOVE PV-DISPLAY5          TO  ATOTITMO.                      25750004
      *                                                                 25760004
       EJECT                                                            25770004
      ******************************************************************25780004
      *    IF NO ITEMS WERE READ FROM THE DATA BASE, POINT THE CURSOR   25790004
      *    TO THE COMMAND LINE, OTHERWISE POINT THE CURSOR TO ONE OF    25800004
      *    THE SELECTION ENTRIES.                                       25810004
      *                                                                 25820004
      *    PERFORMED BY H200-FORMAT-PANEL-BODY.                         25830004
      ******************************************************************25840004
      *                                                                 25850004
       I800-SET-CURSOR-POSITION.                                        25860004
      *                                                                 25870004
           IF MB134-NUMBER-OF-ITEMS-READ = +0                           25880004
           AND DP020-MSG-NUMBER NOT NUMERIC                             25890004
               MOVE -1               TO  ANAVCMDL                       25900004
               MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               25910004
               SET DP020-MSG-WARNING TO  TRUE                           25920004
           ELSE                                                         25930004
      *                                                                 25940004
               IF (PS-CURSOR-NOT-POSITIONED) OR                         25950004
                  (PS-WARNING)               OR                         25960004
                  (PS-INFORMATIONAL)                                    25970004
                   PERFORM J200-FIND-LAST-SELECTION                     25980004
               END-IF                                                   25990004
           END-IF.                                                      26000004
      *                                                                 26010004
       EJECT                                                            26020004
      ******************************************************************26030004
      *    PROCESS EACH ITEM IN THE ARRAY AND MOVE IT TO THE MAP.       26040004
      *    FILL THE MAP UNTIL WE HAVE REACHED THE MAXIMUM NUMBER OF     26050004
      *    MAP ENTRIES.                                                 26060004
      *                                                                 26070004
      *    PERFORMED BY I200-FORMAT-LIST-LINES.                         26080004
      ******************************************************************26090004
      *                                                                 26100004
       J100-PROCESS-ITEMS.                                              26110004
      *                                                                 26120004
           IF (PV-ITEM-IN-USE < MB134-NUMBER-OF-ITEMS-READ) OR          26130004
              (PV-ITEM-IN-USE = MB134-NUMBER-OF-ITEMS-READ)             26140004
               PERFORM K100-SET-SUBSCRIPTS                              26150004
               MOVE DP015-UNP-ALP-BRT-MDT                               26160004
                                     TO  MBKM134-SELECTA(PS-SUB)        26170004
      *                                                                 26180004
               IF (MB134-SELECT(MB134-BLK-SUB MB134-ITEM-SUB))          26190004
               OR (MB134-NO-SELECT(MB134-BLK-SUB MB134-ITEM-SUB))       26200004
                   MOVE DP015-UNDERLINE TO MBKM134-SELECTH(PS-SUB)      26210004
                   MOVE DP015-GREEN     TO MBKM134-SELECTC(PS-SUB)      26220004
               ELSE                                                     26230004
      *                                                                 26240004
                   IF (MB134-BEGIN(MB134-BLK-SUB MB134-ITEM-SUB))       26250004
                   OR (MB134-END(MB134-BLK-SUB MB134-ITEM-SUB))         26260004
                       MOVE DP015-UNDERLINE   TO MBKM134-SELECTH(PS-SUB)26270004
                       MOVE DP015-GREEN       TO MBKM134-SELECTC(PS-SUB)26280004
                       IF (DP020-MSG-NUMBER  =    PC-TSYMSG-00051       26290004
                                               OR PC-TSYMSG-00053       26300004
                          )                                             26310004
      *                    UNPAIRED RANGE CHARACTER, SET WARNING        26320004
      *                    ATTRIBUTES FOR RANGE CHARACTER:              26330004
                           MOVE DP015-REVERSE TO MBKM134-SELECTH(PS-SUB)26340004
                           MOVE DP015-YELLOW  TO MBKM134-SELECTC(PS-SUB)26350004
                       END-IF                                           26360004
      *                                                                 26370004
                       IF (    DP020-MSG-NUMBER  = PC-TSYMSG-00054      26380004
                           AND MB134-BEGIN( MB134-BLK-SUB               26390004
                                            MB134-ITEM-SUB   )          26400004
                          )                                             26410004
      *                    TWO OR MORE START-OF-RANGE CHARACTERS, SET   26420004
      *                    ATTRIBUTES FOR START-OF-RANGE CHARACTERS:    26430004
                           MOVE DP015-REVERSE TO MBKM134-SELECTH(PS-SUB)26440004
                           MOVE DP015-RED     TO MBKM134-SELECTC(PS-SUB)26450004
                       END-IF                                           26460004
      *                                                                 26470004
                       IF (    DP020-MSG-NUMBER  = PC-TSYMSG-00055      26480004
                           AND MB134-END( MB134-BLK-SUB                 26490004
                                          MB134-ITEM-SUB   )            26500004
                          )                                             26510004
      *                    TWO OR MORE END-OF-RANGE CHARACTERS, SET     26520004
      *                    ATTRIBUTES FOR END-OF-RANGE CHARACTERS:      26530004
                           MOVE DP015-REVERSE TO MBKM134-SELECTH(PS-SUB)26540004
                           MOVE DP015-RED     TO MBKM134-SELECTC(PS-SUB)26550004
                       END-IF                                           26560004
      *                                                                 26570004
                       IF  DP020-MSG-NUMBER  =  PC-TSYMSG-00052         26580004
      *                    END-OF-RANGE PRECEDES START OF RANGE, SET    26590004
      *                    ATTRIBUTES OF RANGE CHARACTERS:              26600004
                           MOVE DP015-REVERSE TO MBKM134-SELECTH(PS-SUB)26610004
                           MOVE DP015-RED     TO MBKM134-SELECTC(PS-SUB)26620004
                       END-IF                                           26630004
                   END-IF                                               26640004
                                                                        26650004
               END-IF                                                   26660004
                                                                        26670004
               MOVE MB134-SELECTED-SW(MB134-BLK-SUB MB134-ITEM-SUB)     26680004
                                     TO  MBKM134-SELECTI(PS-SUB)        26690004
      *                                                                 26700004
               IF (PS-SEND-MAP-N-DATA-FRSET)                            26710004
               OR (PS-DIFFERENT-ITEMS-DISPLAYED)                        26720004
                  MOVE MB134-RESP-LEVEL  (MB134-BLK-SUB MB134-ITEM-SUB) 26730004
                                     TO  MBKM134-RESP-LEVEL  (PS-SUB)   26740004
      *                                                                 26750004
                  MOVE MB134-START-DATE  (MB134-BLK-SUB MB134-ITEM-SUB) 26760004
                                     TO  MBKM134-START-DATE  (PS-SUB)   26770004
      *                                                                 26780004
                  MOVE MB134-END-DATE    (MB134-BLK-SUB MB134-ITEM-SUB) 26790004
                                     TO  MBKM134-END-DATE    (PS-SUB)   26800004
      *                                                                 26810004
                  MOVE MB134-AAA         (MB134-BLK-SUB MB134-ITEM-SUB) 26820004
                                     TO  MBKM134-AREA        (PS-SUB)   26830004
      *                                                                 26840004
                  MOVE MB134-RESP-DESC   (MB134-BLK-SUB MB134-ITEM-SUB) 26850004
                                     TO  MBKM134-AREA-DESC   (PS-SUB)   26860004
      *                                                                 26870004
                  MOVE MB134-COLOR       (MB134-BLK-SUB MB134-ITEM-SUB) 26880004
                                     TO  MBKM134-RESP-LEVELC (PS-SUB)   26890004
                                         MBKM134-START-DATEC (PS-SUB)   26900004
                                         MBKM134-END-DATEC   (PS-SUB)   26910004
                                         MBKM134-AREAC       (PS-SUB)   26920004
                                         MBKM134-AREA-DESCC  (PS-SUB)   26930004
      *                                                                 26940004
               END-IF                                                   26950004
                                                                        26960004
           ELSE                                                         26970004
                                                                        26980004
               IF (PS-SEND-MAP-N-DATA-FRSET)     OR                     26990004
                  (PS-DIFFERENT-ITEMS-DISPLAYED)                        27000004
                   MOVE SPACES       TO  MBKM134-RESP-LEVEL  (PS-SUB)   27010004
                                         MBKM134-START-DATE  (PS-SUB)   27020004
                                         MBKM134-END-DATE    (PS-SUB)   27030004
                                         MBKM134-AREA        (PS-SUB)   27040004
                                         MBKM134-AREA-DESC   (PS-SUB)   27050004
                                         MBKM134-SELECTI     (PS-SUB)   27060004
                   MOVE DP015-ASK-DRK-OFF                               27070004
                                     TO  MBKM134-SELECTA(PS-SUB)        27080004
               END-IF                                                   27090004
                                                                        27100004
           END-IF.                                                      27110004
                                                                        27120004
           ADD +1 TO PV-ITEM-IN-USE.                                    27130004
           ADD +1 TO PS-SUB.                                            27140004
       EJECT                                                            27150004
      ******************************************************************27160004
      *    FIND THE LAST SELECTION ENTRY IN THE MAP THAT IS NOT         27170004
      *    SPACES OR LOW VALUES AND POINT THE CURSOR TO THIS ENTRY.     27180004
      *    IF ALL ENTRIES ARE SPACES OR LOW VALUES, POINT THE CURSOR    27190004
      *    TO THE 1ST SELECTION ENTRY IN THE MAP.                       27200004
      *                                                                 27210004
      *    PERFORMED BY I800-SET-CURSOR-POSITION.                       27220004
      ******************************************************************27230004
      *                                                                 27240004
       J200-FIND-LAST-SELECTION.                                        27250004
      *                                                                 27260004
           MOVE PC-ITEMS-PER-PANEL TO PS-SUB.                           27270004
                                                                        27280004
           SET PS-NO-SELECTION-FOUND TO TRUE.                           27290004
                                                                        27300004
           PERFORM                                                      27310004
               UNTIL (PS-SUB = +1)                                      27320004
                  OR (PS-SELECTION-FOUND)                               27330004
      *                                                                 27340004
               IF (MBKM134-SELECTI(PS-SUB) NOT EQUAL SPACES             27350004
               AND MBKM134-SELECTI(PS-SUB) NOT EQUAL LOW-VALUE)         27360004
                   SET PS-SELECTION-FOUND                               27370004
                                     TO  TRUE                           27380004
               ELSE                                                     27390004
                   SUBTRACT +1     FROM  PS-SUB                         27400004
               END-IF                                                   27410004
           END-PERFORM.                                                 27420004
                                                                        27430004
           MOVE -1                 TO  MBKM134-SELECTL(PS-SUB).         27440004
      *                                                                 27450004
       EJECT                                                            27460004
      ******************************************************************27470004
      *    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM  27480004
      *    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL 27490004
      *    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                   27500004
      *                                                                 27510004
      *    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS    27520004
      *    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT     27530004
      *    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION   27540004
      *    US IN THE 2ND BLOCK OF THE ARRAY.                            27550004
      *                                                                 27560004
      *    PERFORMED BY E100-EDIT-SELECTIONS.                           27570004
      *    PERFORMED BY F100-EDIT.                                      27580004
      *    PERFORMED BY F300-CHECK-SELECTIONS.                          27590004
      *    PERFORMED BY J100-PROCESS-ITEMS.                             27600004
      ******************************************************************27610004
      *                                                                 27620004
       K100-SET-SUBSCRIPTS.                                             27630004
      *                                                                 27640004
           COMPUTE PS-ITEM-SUB =                                        27650004
               (PV-ITEM-IN-USE - MB134-LIST-ITEM-NUMBER(1 1)) + 1.      27660004
                                                                        27670004
           MOVE PS-ITEM-SUB TO MB134-ITEM-SUB.                          27680004
                                                                        27690004
           IF MB134-ITEM-SUB > PC-ITEMS-PER-BLOCK                       27700004
               SUBTRACT PC-ITEMS-PER-BLOCK FROM MB134-ITEM-SUB          27710004
                                                                        27720004
               MOVE PC-MAX-BLOCKS-IN-ARRAY TO MB134-BLK-SUB             27730004
           ELSE                                                         27740004
               MOVE +1                     TO MB134-BLK-SUB             27750004
           END-IF.                                                      27760004
      *                                                                 27770004
       EJECT                                                            27780004
      ******************************************************************27790004
      *    OPEN THE APPLICATION SYSTEM LIST CURSOR.                     27800004
      *                                                                 27810004
      *    PERFORMED BY D100                                            27820004
      ******************************************************************27830004
      *                                                                 27840004
       L100-OPEN-CURSOR.                                                27850004
      *                                                                 27860004
           PERFORM                                                      27870004
               WITH TEST AFTER                                          27880004
               VARYING PV-SQL-SUB                                       27890004
               FROM 1 BY 1                                              27900004
               UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             27910004
                  OR SQLCODE = 0                                        27920004
                  OR SQLCODE = +100                                     27930004
      *                                                                 27940004
               EXEC SQL                                                 27950004
                    OPEN WORKER-LIST                                    27960004
               END-EXEC                                                 27970004
      *                                                                 27980004
               EVALUATE TRUE                                            27990004
                   WHEN SQLCODE = -904                                  28000004
                   WHEN SQLCODE = -913                                  28010004
                   WHEN SQLCODE = ZERO                                  28020004
                   WHEN SQLCODE = +100                                  28030004
                        CONTINUE                                        28040004
                   WHEN SQLWARN0 NOT EQUAL SPACE                        28050004
                   WHEN SQLCODE NOT EQUAL ZERO                          28060004
                        MOVE 'L100-OPEN-CURSOR'                         28070004
                                     TO  DP013-PARAGRAPH                28080004
                        MOVE 'OPEN WORKER-LIST CURSOR'                  28090004
                                     TO  DP013-MESSAGE-TEXT (1)         28100004
                        MOVE SQLCA   TO  DP013-SQLCA                    28110004
                        SET DP013-DB2-ABEND                             28120004
                                     TO  TRUE                           28130004
                        PERFORM DP013-0000-PROCESS-ABEND                28140004
               END-EVALUATE                                             28150004
           END-PERFORM.                                                 28160004
      *                                                                 28170004
           IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   28180004
               MOVE 'L100-OPEN-CURSOR'                                  28190004
                                     TO  DP013-PARAGRAPH                28200004
               MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              28210004
                                     TO  DP013-MESSAGE-TEXT (1)         28220004
               MOVE SQLCA            TO  DP013-SQLCA                    28230004
               SET DP013-DB2-ABEND   TO  TRUE                           28240004
               PERFORM DP013-0000-PROCESS-ABEND                         28250004
           END-IF.                                                      28260004
      *                                                                 28270004
       EJECT                                                            28280004
      ******************************************************************28290004
      *    FETCH THE ROWS.                                              28300004
      *                                                                 28310004
      *    PERFORMED BY H100                                            28320004
      ******************************************************************28330004
      *                                                                 28340004
       L200-FETCH.                                                      28350004
      *                                                                 28360004
           PERFORM                                                      28370004
               WITH TEST AFTER                                          28380004
               VARYING PV-SQL-SUB                                       28390004
               FROM 1 BY 1                                              28400004
               UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             28410004
                  OR SQLCODE = 0                                        28420004
                  OR SQLCODE = +100                                     28430004
      *                                                                 28440004
               EXEC SQL                                                 28450004
                    FETCH WORKER-LIST                                   28460004
                    INTO                                                28470004
                          :MDSEAR-GMA-NBR,                              28480004
                          :MDSEAR-DMA-NBR,                              28490004
                          :MDSEAR-DEPT-NBR,                             28500004
                          :MDSEAR-DESC,                                 28510004
                          :MDSEAR-MDSELV-CDE,                           28520004
                          :MDSEAR-LIST-SEQ-NBR,                         28530004
                          :RSPBAR-RSPLVL-CDE,                           28540004
                          :RSPBAR-WORKER-STRT-DTE,                      28550004
                          :RSPBAR-WORKER-END-DTE                        28560004
               END-EXEC                                                 28570004
      *                                                                 28580004
               EVALUATE TRUE                                            28590004
                   WHEN SQLCODE = -904                                  28600004
                   WHEN SQLCODE = -913                                  28610004
                   WHEN SQLCODE = ZERO                                  28620004
                   WHEN SQLCODE = +100                                  28630004
                        CONTINUE                                        28640004
                   WHEN SQLWARN0 NOT EQUAL SPACE                        28650004
                   WHEN SQLCODE NOT EQUAL ZERO                          28660004
                        MOVE 'L200-FETCH'                               28670004
                                     TO  DP013-PARAGRAPH                28680004
                        MOVE 'FETCH WORKER-LIST CURSOR'                 28690004
                                     TO  DP013-MESSAGE-TEXT (1)         28700004
                        MOVE SQLCA   TO  DP013-SQLCA                    28710004
                        SET DP013-DB2-ABEND                             28720004
                                     TO  TRUE                           28730004
                        PERFORM DP013-0000-PROCESS-ABEND                28740004
               END-EVALUATE                                             28750004
           END-PERFORM.                                                 28760004
      *                                                                 28770004
           IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   28780004
               MOVE 'L200-FETCH'                                        28790004
                                     TO  DP013-PARAGRAPH                28800004
               MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             28810004
                                     TO  DP013-MESSAGE-TEXT (1)         28820004
               MOVE SQLCA            TO  DP013-SQLCA                    28830004
               SET DP013-DB2-ABEND   TO  TRUE                           28840004
               PERFORM DP013-0000-PROCESS-ABEND                         28850004
           END-IF.                                                      28860004
      *                                                                 28870004
           IF  SQLCODE EQUAL +100                                       28880004
               SET MB134-NO-ITEMS-LEFT-ON-DB                            28890004
                                     TO  TRUE                           28900004
           END-IF.                                                      28910004
      *                                                                 28920004
       EJECT                                                            28930004
      ******************************************************************28940004
      *    OBTAIN THE WORKER DATA                                       28950004
      *                                                                 28960004
      *    PERFORMED BY D100                                            28970004
      ******************************************************************28980004
      *                                                                 28990004
       L300-READ-WORKER.                                                29000004
      *                                                                 29010004
           PERFORM                                                      29020004
               WITH TEST AFTER                                          29030004
               VARYING PV-SQL-SUB                                       29040004
               FROM 1 BY 1                                              29050004
               UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             29060004
                  OR SQLCODE = 0                                        29070004
                  OR SQLCODE = +100                                     29080004
      *                                                                 29090004
               EXEC SQL                                                 29100004
                    SELECT                                              29110004
                          WORKER_NBR,                                   29120004
                          LAST_NAME,                                    29130004
                          FIR_NAME                                      29140004
                    INTO                                                29150004
                          :WORKER-NBR,                                  29160004
                          :WORKER-LAST-NAME,                            29170004
                          :WORKER-FIR-NAME                              29180004
                    FROM                                                29190004
                          TWORKER                                       29200004
                    WHERE                                               29210004
                          OPERCO_NBR     =  :PC-COMPANY                 29220004
                     AND  UID_NBR        =  :MB005-USERID               29230004
               END-EXEC                                                 29240004
      *                                                                 29250004
               EVALUATE TRUE                                            29260004
                   WHEN SQLCODE = -904                                  29270004
                   WHEN SQLCODE = -913                                  29280004
                   WHEN SQLCODE = ZERO                                  29290004
                   WHEN SQLCODE = +100                                  29300004
                        CONTINUE                                        29310004
                   WHEN SQLWARN0 NOT EQUAL SPACE                        29320004
                   WHEN SQLCODE NOT EQUAL ZERO                          29330004
                        MOVE 'L300-READ-WORKER'                         29340004
                                     TO  DP013-PARAGRAPH                29350004
                        MOVE 'READ WORKER'                              29360004
                                     TO  DP013-MESSAGE-TEXT (1)         29370004
                        MOVE SQLCA   TO  DP013-SQLCA                    29380004
                        SET DP013-DB2-ABEND                             29390004
                                     TO  TRUE                           29400004
                        PERFORM DP013-0000-PROCESS-ABEND                29410004
               END-EVALUATE                                             29420004
           END-PERFORM.                                                 29430004
      *                                                                 29440004
           IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   29450004
               MOVE 'L300-READ-WORKER'                                  29460004
                                     TO  DP013-PARAGRAPH                29470004
               MOVE 'MAX RETRIES EXCEEDED FOR READ WORKER'              29480004
                                     TO  DP013-MESSAGE-TEXT (1)         29490004
               MOVE SQLCA            TO  DP013-SQLCA                    29500004
               SET DP013-DB2-ABEND   TO  TRUE                           29510004
               PERFORM DP013-0000-PROCESS-ABEND                         29520004
           END-IF.                                                      29530004
      *                                                                 29540004
           MOVE WORKER-NBR           TO  MB134-WORKER-NUMBER.           29550004
           MOVE WORKER-LAST-NAME     TO  MB134-LAST-NAME.               29560004
           MOVE WORKER-FIR-NAME      TO  MB134-FIRST-NAME.              29570004
      *                                                                 29580004
       EJECT                                                            29590004
      ******************************************************************29600004
      *    PREPARE THE TEMPORARY STORAGE QUEUE.  MOVE ALL SELECTED      29610004
      *    APLSYS FROM EITHER TEMP STORAGE OR THE ARRAY IN THE COMM     29620004
      *    AREA TO THE LIST TS QUEUE RECORD(S).                         29630004
      *                                                                 29640004
      *    PERFORMED BY D300                                            29650004
      ******************************************************************29660004
      *                                                                 29670004
       X100-PREPARE-LIST-QUEUE.                                         29680004
      *                                                                 29690004
           MOVE +1                   TO  MB134-BLK-SUB.                 29700004
           PERFORM Z150-WRITE-TEMP-STORAGE.                             29710004
           ADD +1                    TO  MB134-BLK-SUB.                 29720004
           PERFORM Z150-WRITE-TEMP-STORAGE.                             29730004
      *                                                                 29740004
           IF  MB134-HIGHEST-BLOCK-WRITTEN = ZERO                       29750004
               MOVE EIBTRMID         TO  PV-BG-TERM-ID                  29760004
               MOVE EIBTASKN         TO  PV-BG-TASK-NUMBER              29770004
           ELSE                                                         29780004
               MOVE MB134-TERM-ID    TO  PV-BG-TERM-ID                  29790004
               MOVE MB134-TASK-NUMBER                                   29800004
                                     TO  PV-BG-TASK-NUMBER              29810004
           END-IF.                                                      29820004
           SUBTRACT 1              FROM  PV-BG-TASK-NUMBER.             29830004
      *                                                                 29840004
           MOVE PV-BG-QUEUE-NAME     TO  MB005-LIST-QUEUE-NAME          29850004
                                         MB134-LIST-QUEUE-NAME.         29860004
           MOVE LENGTH OF RSPBAR-RECORD                                 29870004
                                     TO  MB005-LIST-QUEUE-LENGTH.       29880004
           PERFORM X900-DELETE-LIST-QUEUE.                              29890004
      *                                                                 29900004
           SET MB003-IDX             TO  1.                             29910004
           INITIALIZE RSPBAR-RECORD.                                    29920004
           PERFORM X200-PROCESS-TS-QUEUE                                29930004
                   VARYING PV-ITEM                                      29940004
                   FROM 1 BY 1                                          29950004
                   UNTIL PV-ITEM GREATER MB134-HIGHEST-BLOCK-WRITTEN.   29960004
      *                                                                 29970004
           PERFORM X500-WRITE-LIST-QUEUE.                               29980004
      *                                                                 29990004
       EJECT                                                            30000004
      ******************************************************************30010004
      *    READ A TS QUEUE RECORD, MOVE SELECTED RECORDS TO THE         30020004
      *    APPLICATIONS SYSTEM LIST QUEUE RECORD.                       30030004
      *                                                                 30040004
      *    PERFORMED BY X100                                            30050004
      ******************************************************************30060004
      *                                                                 30070004
       X200-PROCESS-TS-QUEUE.                                           30080004
      *                                                                 30090004
           PERFORM X300-READ-TS-QUEUE.                                  30100004
           IF  PV-RESP EQUAL DFHRESP(NORMAL)                            30110004
               PERFORM                                                  30120004
               VARYING PV-TW-IDX                                        30130004
               FROM 1 BY 1                                              30140004
               UNTIL PV-TW-IDX GREATER THAN PC-ITEMS-PER-BLOCK          30150004
                 OR  PV-TW-LIST-ITEM-NUMBER (PV-TW-IDX) EQUAL ZERO      30160004
      *                                                                 30170004
                   IF  PV-TW-SELECT (PV-TW-IDX)                         30180004
                       MOVE PV-TW-GMA (PV-TW-IDX)                       30190004
                                     TO  MB003-GMA-NUMBER               30200004
                                              (MB003-IDX)               30210004
                       MOVE PV-TW-DMA (PV-TW-IDX)                       30220004
                                     TO  MB003-DMA-NUMBER               30230004
                                              (MB003-IDX)               30240004
                       MOVE PV-TW-DEPT (PV-TW-IDX)                      30250004
                                     TO  MB003-DEPT-NUMBER              30260004
                                              (MB003-IDX)               30270004
                       MOVE PV-TW-MDSELV (PV-TW-IDX)                    30280004
                                     TO  MB003-MDSELV-NUMBER            30290004
                                              (MB003-IDX)               30300004
                       MOVE PV-TW-LIST-ITEM-NUMBER (PV-TW-IDX)          30310004
                                     TO  MB003-ITEM (MB003-IDX)         30320004
                       MOVE ZERO     TO  MB003-MCLASS-NUMBER            30330004
                                                      (MB003-IDX)       30340004
                                         MB003-SCLASS-NUMBER            30350004
                                                      (MB003-IDX)       30360004
      *                                                                 30370004
                       IF  PV-TW-COLOR (PV-TW-IDX) = DP015-TURQUOISE    30380004
                           SET PS-HISTORY-SELECTED TO TRUE              30390004
                       END-IF                                           30400004
                       SET MB003-IDX UP BY 1                            30410004
                       IF  MB003-IDX GREATER PC-MAX-WR-ITEMS            30420004
                           PERFORM X500-WRITE-LIST-QUEUE                30430004
                       END-IF                                           30440004
                   END-IF                                               30450004
      *                                                                 30460004
               END-PERFORM                                              30470004
           END-IF.                                                      30480004
      *                                                                 30490004
       EJECT                                                            30500004
      ******************************************************************30510004
      *    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA. 30520004
      *                                                                 30530004
      *    PERFORMED BY C500, X200                                      30540004
      ******************************************************************30550004
      *                                                                 30560004
       X300-READ-TS-QUEUE.                                              30570004
      *                                                                 30580004
           EXEC CICS                                                    30590004
               READQ TS                                                 30600004
               QUEUE(MB134-TEMP-QUEUE-NAME)                             30610004
               INTO(PV-TEMP-WORK-AREA)                                  30620004
               LENGTH(PC-BLOCK-LENGTH)                                  30630004
               ITEM(PV-ITEM)                                            30640004
               RESP(PV-RESP)                                            30650004
           END-EXEC.                                                    30660004
      *                                                                 30670004
       EJECT                                                            30680004
      ******************************************************************30690004
      *    WRITE THE SKU LIST QUEUE RECORD.                             30700004
      *                                                                 30710004
      *    PERFORMED BY X100                                            30720004
      ******************************************************************30730004
      *                                                                 30740004
       X500-WRITE-LIST-QUEUE.                                           30750004
      *                                                                 30760004
           IF  MB003-IDX GREATER THAN 1                                 30770004
               MOVE PC-MAX-WR-ITEMS  TO  MB003-MAX-ITEMS                30780004
               MOVE MB134-NUMBER-OF-SELECTED-ITEMS                      30790004
                                     TO  MB003-SELECTED-ITEMS           30800004
      *                                                                 30810004
               IF  DP020-SRC-AID EQUAL DP016-PF15                       30820004
                   SET MB003-UPDATE    TO  TRUE                         30830004
               ELSE                                                     30840004
                   SET MB003-INQUIRY TO    TRUE                         30850004
               END-IF                                                   30860004
      *                                                                 30870004
               EXEC CICS                                                30880004
                    WRITEQ TS                                           30890004
                    QUEUE(MB005-LIST-QUEUE-NAME)                        30900004
                    FROM(RSPBAR-RECORD)                                 30910004
                    LENGTH(MB005-LIST-QUEUE-LENGTH)                     30920004
                    ITEM(PV-WR-ITEM)                                    30930004
                    RESP(PV-RESP)                                       30940004
               END-EXEC                                                 30950004
      *                                                                 30960004
               IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                    30970004
                   SET PS-DONT-PROCESS                                  30980004
                                     TO  TRUE                           30990004
               END-IF                                                   31000004
      *                                                                 31010004
               INITIALIZE RSPBAR-RECORD                                 31020004
               SET MB003-IDX         TO  1                              31030004
           END-IF.                                                      31040004
      *                                                                 31050004
       EJECT                                                            31060004
      ******************************************************************31070004
      *    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.              31080004
      *                                                                 31090004
      *    PERFORMED BY C500, C600                                      31100004
      ******************************************************************31110004
      *                                                                 31120004
       X550-WRITE-TS-QUEUE.                                             31130004
      *                                                                 31140004
           EXEC CICS                                                    31150004
               WRITEQ TS                                                31160004
               REWRITE                                                  31170004
               QUEUE(MB134-TEMP-QUEUE-NAME)                             31180004
               FROM(PV-TEMP-WORK-AREA)                                  31190004
               LENGTH(PC-BLOCK-LENGTH)                                  31200004
               ITEM(PV-SAVE-ITEM)                                       31210004
               RESP(PV-RESP)                                            31220004
           END-EXEC.                                                    31230004
      *                                                                 31240004
       EJECT                                                            31250004
      ******************************************************************31260004
      *    READ THE LIST QUEUE RECORD.                                  31270004
      *                                                                 31280004
      *    PERFORMED BY C500                                            31290004
      ******************************************************************31300004
      *                                                                 31310004
       X600-READ-LIST-QUEUE.                                            31320004
      *                                                                 31330004
           EXEC CICS                                                    31340004
                READQ TS                                                31350004
                QUEUE(MB005-LIST-QUEUE-NAME)                            31360004
                INTO(RSPBAR-RECORD)                                     31370004
                LENGTH(MB005-LIST-QUEUE-LENGTH)                         31380004
                ITEM(PV-WR-ITEM)                                        31390004
                RESP(PV-RESP)                                           31400004
           END-EXEC.                                                    31410004
      *                                                                 31420004
       EJECT                                                            31430004
      ******************************************************************31440004
      *    DELETE THE SKU LIST TEMP STORAGE QUEUE.                      31450004
      *                                                                 31460004
      *    PERFORMED BY X100                                            31470004
      ******************************************************************31480004
      *                                                                 31490004
       X900-DELETE-LIST-QUEUE.                                          31500004
      *                                                                 31510004
           EXEC CICS                                                    31520004
               DELETEQ TS                                               31530004
               QUEUE(MB005-LIST-QUEUE-NAME)                             31540004
               RESP(PV-RESP)                                            31550004
           END-EXEC.                                                    31560004
       EJECT                                                            31570004
      *                                                                 31580004
      ******************************************************************31590004
      *    DELETE THE TEMPORARY STORAGE QUEUE.                          31600004
      *                                                                 31610004
      *    PERFORMED BY C300-PROCESS-PANEL.                             31620004
      ******************************************************************31630004
      *                                                                 31640004
       Z050-DELETE-TEMP-STORAGE.                                        31650004
      *                                                                 31660004
           EXEC CICS                                                    31670004
               DELETEQ TS                                               31680004
               QUEUE(MB134-TEMP-QUEUE-NAME)                             31690004
               RESP(PV-RESP)                                            31700004
           END-EXEC.                                                    31710004
                                                                        31720004
           IF (PV-RESP NOT = DFHRESP(NORMAL)) AND                       31730004
              (PV-RESP NOT = DFHRESP(QIDERR))                           31740004
               MOVE PV-RESP TO PM-RESP-23                               31750004
                                                                        31760004
               SET DP013-LOGIC-ABEND TO TRUE                            31770004
               SET DP013-NO-ROLLBACK TO TRUE                            31780004
                                                                        31790004
               MOVE 'Z050-DELETE-TEMP-STORAGE' TO DP013-PARAGRAPH       31800004
               MOVE PM-PROGRAM-MESSAGE-23      TO DP013-MESSAGE-TEXT(1) 31810004
                                                                        31820004
               PERFORM DP013-0000-PROCESS-ABEND                         31830004
           END-IF.                                                      31840004
                                                                        31850004
           MOVE +0 TO MB134-HIGHEST-BLOCK-WRITTEN.                      31860004
       EJECT                                                            31870004
      ******************************************************************31880004
      *    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.          31890004
      *                                                                 31900004
      *    PERFORMED BY D400-REFRESH-BLOCK-ARRAY.                       31910004
      *    PERFORMED BY E700-DESELECT-ALL-ITEMS.                        31920004
      *    PERFORMED BY F200-MARK-RANGE-AS-SELECTED.                    31930004
      *    PERFORMED BY G500-SCROLL-FORWARD.                            31940004
      *    PERFORMED BY G600-SCROLL-BACKWARD.                           31950004
      *    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                       31960004
      *    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                    31970004
      ******************************************************************31980004
      *                                                                 31990004
       Z100-READ-TEMP-STORAGE.                                          32000004
      *                                                                 32010004
           EXEC CICS                                                    32020004
               READQ TS                                                 32030004
               QUEUE(MB134-TEMP-QUEUE-NAME)                             32040004
               INTO(MB134-BLOCK-ENTRIES(MB134-BLK-SUB))                 32050004
               LENGTH(PC-BLOCK-LENGTH)                                  32060004
               ITEM(PV-BLOCK-NUMBER)                                    32070004
               RESP(PV-RESP)                                            32080004
           END-EXEC.                                                    32090004
      *                                                                 32100004
           IF PV-RESP NOT = DFHRESP(NORMAL)                             32110004
               MOVE PV-RESP          TO  PM-RESP-24                     32120004
               EXEC CICS                                                32130004
                    DELETEQ TS                                          32140004
                    QUEUE(MB134-TEMP-QUEUE-NAME)                        32150004
                    RESP(PV-RESP)                                       32160004
               END-EXEC                                                 32170004
               SET DP013-LOGIC-ABEND TO  TRUE                           32180004
               SET DP013-NO-ROLLBACK TO  TRUE                           32190004
               MOVE 'Z100-READ-TEMP-STORAGE'                            32200004
                                     TO  DP013-PARAGRAPH                32210004
               MOVE PM-PROGRAM-MESSAGE-24                               32220004
                                     TO  DP013-MESSAGE-TEXT(1)          32230004
               PERFORM DP013-0000-PROCESS-ABEND                         32240004
           END-IF.                                                      32250004
                                                                        32260004
           SET MB134-BLOCK-NOT-MODIFIED(MB134-BLK-SUB) TO TRUE.         32270004
       EJECT                                                            32280004
      ******************************************************************32290004
      *    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.       32300004
      *    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.     32310004
      *                                                                 32320004
      *    PERFORMED BY E300-NAVIGATE.                                  32330004
      *    PERFORMED BY E700-DESELECT-ALL-ITEMS.                        32340004
      *    PERFORMED BY F200-MARK-RANGE-AS-SELECTED.                    32350004
      *    PERFORMED BY G500-SCROLL-FORWARD.                            32360004
      *    PERFORMED BY G600-SCROLL-BACKWARD.                           32370004
      *    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                       32380004
      *    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                    32390004
      *    PERFORMED BY H100-READ-ITEMS-FROM-DB.                        32400004
      ******************************************************************32410004
      *                                                                 32420004
       Z150-WRITE-TEMP-STORAGE.                                         32430004
      *                                                                 32440004
           IF MB134-HIGHEST-BLOCK-WRITTEN = +0                          32450004
               MOVE EIBTASKN         TO  DP020-SRC-TASK-NUMBER          32460004
               MOVE EIBTASKN         TO  MB134-TASK-NUMBER              32470004
               MOVE EIBTRMID         TO  MB134-TERM-ID                  32480004
           END-IF.                                                      32490004
      *                                                                 32500004
           MOVE MB134-LIST-ITEM-NUMBER(MB134-BLK-SUB 1)                 32510004
                                     TO  PV-LIST-ITEM-NUMBER.           32520004
           COMPUTE PV-BLOCK-NUMBER =                                    32530004
               1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK).    32540004
      *                                                                 32550004
           IF (PV-BLOCK-NUMBER < MB134-HIGHEST-BLOCK-WRITTEN)           32560004
           OR (PV-BLOCK-NUMBER = MB134-HIGHEST-BLOCK-WRITTEN)           32570004
               IF  MB134-BLOCK-MODIFIED(MB134-BLK-SUB)                  32580004
                   EXEC CICS                                            32590004
                       WRITEQ TS                                        32600004
                       QUEUE(MB134-TEMP-QUEUE-NAME)                     32610004
                       FROM(MB134-BLOCK-ENTRIES(MB134-BLK-SUB))         32620004
                       LENGTH(PC-BLOCK-LENGTH)                          32630004
                       ITEM(PV-BLOCK-NUMBER)                            32640004
                       REWRITE                                          32650004
                       RESP(PV-RESP)                                    32660004
                   END-EXEC                                             32670004
      *                                                                 32680004
                   IF  PV-RESP NOT = DFHRESP(NORMAL)                    32690004
                       MOVE PV-RESP  TO  PM-RESP-9                      32700004
                       EXEC CICS                                        32710004
                           DELETEQ TS                                   32720004
                           QUEUE(MB134-TEMP-QUEUE-NAME)                 32730004
                           RESP(PV-RESP)                                32740004
                       END-EXEC                                         32750004
      *                                                                 32760004
                       SET DP013-LOGIC-ABEND                            32770004
                                     TO  TRUE                           32780004
                       SET DP013-NO-ROLLBACK                            32790004
                                     TO  TRUE                           32800004
                       MOVE 'Z150-WRITE-TEMP-STORAGE'                   32810004
                                     TO  DP013-PARAGRAPH                32820004
                       MOVE PM-PROGRAM-MESSAGE-9                        32830004
                                     TO  DP013-MESSAGE-TEXT(1)          32840004
                       PERFORM DP013-0000-PROCESS-ABEND                 32850004
                   END-IF                                               32860004
               END-IF                                                   32870004
           ELSE                                                         32880004
      *                                                                 32890004
               COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       32900004
                   MB134-HIGHEST-BLOCK-WRITTEN + 1                      32910004
               IF  PV-BLOCK-NUMBER = PV-HIGHEST-BLOCK-WRITTEN           32920004
                   EXEC CICS                                            32930004
                       WRITEQ TS                                        32940004
                       QUEUE(MB134-TEMP-QUEUE-NAME)                     32950004
                       FROM(MB134-BLOCK-ENTRIES(MB134-BLK-SUB))         32960004
                       LENGTH(PC-BLOCK-LENGTH)                          32970004
                       ITEM(PV-BLOCK-NUMBER)                            32980004
                       RESP(PV-RESP)                                    32990004
                   END-EXEC                                             33000004
      *                                                                 33010004
                   IF  PV-RESP NOT = DFHRESP(NORMAL)                    33020004
                       MOVE PV-RESP  TO  PM-RESP-10                     33030004
                       EXEC CICS                                        33040004
                           DELETEQ TS                                   33050004
                           QUEUE(MB134-TEMP-QUEUE-NAME)                 33060004
                           RESP(PV-RESP)                                33070004
                       END-EXEC                                         33080004
      *                                                                 33090004
                       SET DP013-LOGIC-ABEND                            33100004
                                     TO  TRUE                           33110004
                       SET DP013-NO-ROLLBACK                            33120004
                                     TO  TRUE                           33130004
                       MOVE 'Z150-WRITE-TEMP-STORAGE'                   33140004
                                     TO  DP013-PARAGRAPH                33150004
                       MOVE PM-PROGRAM-MESSAGE-10                       33160004
                                     TO  DP013-MESSAGE-TEXT(1)          33170004
                       PERFORM DP013-0000-PROCESS-ABEND                 33180004
                   END-IF                                               33190004
                   ADD +1            TO  MB134-HIGHEST-BLOCK-WRITTEN    33200004
               ELSE                                                     33210004
                   SET DP013-LOGIC-ABEND                                33220004
                                     TO  TRUE                           33230004
                   SET DP013-NO-ROLLBACK                                33240004
                                     TO  TRUE                           33250004
                   MOVE 'Z150-WRITE-TEMP-STORAGE'                       33260004
                                     TO  DP013-PARAGRAPH                33270004
                   MOVE PV-BLOCK-NUMBER                                 33280004
                                     TO  PM-BLOCK-NUMBER                33290004
                   MOVE PM-PROGRAM-MESSAGE-11                           33300004
                                     TO  DP013-MESSAGE-TEXT(1)          33310004
                   PERFORM DP013-0000-PROCESS-ABEND                     33320004
               END-IF                                                   33330004
           END-IF.                                                      33340004
                                                                        33350004
           SET MB134-BLOCK-NOT-MODIFIED(MB134-BLK-SUB) TO TRUE.         33360004
      *                                                                 33370004
       EJECT                                                            33380004
      ******************************************************************33390004
      *    FILL IN SCREEN HEADER MODULE                                 33400004
      ******************************************************************33410004
                                                                        33420004
           COPY DPPD002.                                                33430004
       EJECT                                                            33440004
      ******************************************************************33450004
      *    RETURN TO CICS MODULE                                        33460004
      ******************************************************************33470004
                                                                        33480004
           COPY DPPD003.                                                33490004
       EJECT                                                            33500004
      ******************************************************************33510004
      *    FORMAT MESSAGE LINES MODULE                                  33520004
      ******************************************************************33530004
                                                                        33540004
           COPY DPPD005.                                                33550004
       EJECT                                                            33560004
      ******************************************************************33570004
      *    GET PANEL MODULE                                             33580004
      ******************************************************************33590004
                                                                        33600004
           COPY DPPD007.                                                33610004
       EJECT                                                            33620004
      ******************************************************************33630004
      *    WRITE PANEL MODULE                                           33640004
      ******************************************************************33650004
                                                                        33660004
           COPY DPPD008.                                                33670004
       EJECT                                                            33680004
      ******************************************************************33690004
      *    TOGGLE THE FUNCTION KEY LINE MODULE                          33700004
      ******************************************************************33710004
                                                                        33720004
           COPY DPPD009.                                                33730004
       EJECT                                                            33740004
      ******************************************************************33750004
      *    ABEND PROCESSOR MODULE                                       33760004
      ******************************************************************33770004
                                                                        33780004
           COPY DPPD013.                                                33790004
       EJECT                                                            33800004
      ******************************************************************33810004
      *    CHECK COMMUNICATION AREA MODULE                              33820004
      ******************************************************************33830004
                                                                        33840004
           COPY DPPD015.                                                33850004
       EJECT                                                            33860004
      ******************************************************************33870004
      *    UPDATE TIME AND DATE MODULE                                  33880004
      ******************************************************************33890004
                                                                        33900004
           COPY DPPD017.                                                33910004
