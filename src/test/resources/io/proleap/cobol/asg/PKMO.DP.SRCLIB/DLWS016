000100**************************************************************            
000200*    ******                IMPORTANT                 ******  *            
000300*   THIS IS THE COMMUNICATION AREA TO BE USED BY A CALLING   *            
000400*   PROGRAM THAT WILL USE ROUTINE DLKCS410 TO MANAGE ALL     *            
000500*   OF THE CODE NEEDED TO DETERMINE IF ASSIGNMENTS NEED      *            
000600*   TO BE CREATED AND/OR IF THE ASSOCIATE NEEDS TO BE        *            
000700*   ASSIGNED TO THE ASSIGNMENT BEING CHECKED OUT.            *            
000800*                                                            *            
000900*   THIS IS STRICTLY A MODULE TO BE USED IN CICS ONLY.       *            
001000*                                                            *            
001100*   TO INVOKE THIS PROGRAM FROM A CICS EXIT YOU MUST USE THIS*            
001200*   FORMAT:                                                  *            
001300*                                                            *            
001400*    MOVE LENGTH OF DL016-PGM-COMMAREA TO PV-COMMAREA-LENGTH *            
001500*    EXEC CICS LINK                                          *            
001600*        PROGRAM  (DL016-USER-PGM)                           *            
001700*        COMMAREA (DL016-PGM-COMMAREA)                       *            
001800*        LENGTH   (PV-COMMAREA-LENGTH)                       *            
001900*    END-EXEC.                                               *            
002000*                                                            *            
002100*     INITIALIZE DL016-USER-COMMAREA BEFORE LINKING DLKCS410.*            
002200*                                                            *            
002300*     THE DL016-PROCESS-CDE FIELD WILL BE USED TO TELL THE   *            
002400*     DLKCS410 MODULE WHAT TYPE OF PROCESSING TO DO AS       *            
002500*     FOLLOWS:                                               *            
002600*                                                            *            
002700*     DL016-ESTABLISH-ASGMT                                  *            
002800*       THIS OPTION WILL TAKE THE DC NUMBER, WORK TYPE AND   *            
002900*       WORK LOCATION ALONG WITH THE ASSOCIATE ID AND DO     *            
003000*       ALL PROCESSING TO DETERMINE IF AN ASSIGNMENT EXISTS, *            
003100*       IF NOT CREATE ONE, IS ASSOCIATE ON ASSIGNMENT, IF    *            
003200*       NOT ADD ASSOCIATE AND IF NEEDED END ASSOCIATE FROM   *            
003300*       CURRENT ASSIGNMENT.                                  *            
003400*     DL016-ESTABLISH-TEAM                                   *            
003500*       THIS OPTION WILL TAKE THE ASSIGNMENT NUMBER AND THE  *            
003600*       ASSOCIATE ID AND DO ALL PROCESSING TO DETERMINE IF   *            
003700*       THE ASSOCIATE IS ALREADY PART OF THE ASSIGNMENT AND  *            
003800*       IF NOT, ADD ASSOCIATE AND IF NEEDED END ASSOCIATE    *            
003900*       FROM CURRENT ASSIGNMENT.                             *            
004000*                                                            *            
004100*     REGARDING DL016-OUTPUT-FIELDS:                         *            
004200*       THE APPROPRIATE OUTPUT FIELDS WILL BE RETURNED TO    *            
004300*       THE CALLING PROGRAM BASED ON WHAT THE PROCESSING     *            
004400*       PERFORMED BY THIS MODULE.                            *            
004500*                                                            *            
004600*     NOTE: IF FIELD(S) ARE ADDED TO THIS COPYBOOK           *            
004700*           DECREMENT THE FILLER NEAR THE END OF THIS        *            
004800*           COPYBOOK SO THE TOTAL LENGTH REMAINS THE SAME    *            
004900*           AT LENGTH OF 650                                 *            
005000**************************************************************            
005100 01  DL016-PGM-COMMAREA.                                                  
005200     05  DL016-PROCESS-CDE                PIC  X(01).                     
005300         88  DL016-VALID-PROCESS-CDE      VALUES 'A' 'B'.                 
005400         88  DL016-ESTABLISH-ASGMT        VALUE 'A'.                      
005500         88  DL016-ESTABLISH-TEAM         VALUE 'B'.                      
005600     05  DL016-COMMIT-CDE                 PIC  X(01).                     
005700         88  DL016-VALID-COMMIT-CDE       VALUES 'C' 'N'.                 
005800         88  DL016-COMMIT-UPDATE          VALUE 'C'.                      
005900         88  DL016-DO-NOT-COMMIT-UPDATE   VALUE 'N'.                      
006000     05  DL016-CALLING-PGM-NM             PIC  X(08).                     
006100         88  DL016-NO-CALLING-PGM         VALUE SPACES.                   
006200     05  DL016-SIGN-ON-USR-ID             PIC  X(08).                     
006300         88  DL016-NO-SIGN-ON-USR         VALUE SPACES.                   
006400     05  DL016-ASGMT-NBR-WRK-TYP          PIC  X(06).                     
006500         88  DL016-NO-ASGMT-NBR-WRK-TYP   VALUE SPACES.                   
006600     05  DL016-FILLER-01                  PIC  X(25).                     
006700                                                                          
006800     05  DL016-EST-ASGMT-INPUT-FIELDS.                                    
006900         10  DL016-EAI-WK-TYP-DESC        PIC  X(15).                     
007000             88  DL016-EAI-NO-WK-TYP      VALUE SPACES.                   
007100         10  DL016-EAI-WK-AREA-DESC       PIC  X(20).                     
007200             88  DL016-EAI-NO-WK-AREA     VALUE SPACES.                   
007300         10  DL016-EAI-DC-NBR             PIC S9(04)     COMP.            
007400             88  DL016-EAI-NO-DC-NBR      VALUE ZEROS.                    
007500         10  DL016-EAI-CRE-BY-USR-ID      PIC  X(08).                     
007600             88  DL016-EAI-NO-CRE-USR     VALUE SPACES.                   
007700         10  DL016-EAI-USR-TYP-CDE        PIC  X(01).                     
007800             88  DL016-VALID-EAI-USR-TYP  VALUES 'K' 'T' 'U'.             
007900             88  DL016-EAI-USR-IS-KOHLS   VALUE 'K'.                      
008000             88  DL016-EAI-USR-IS-TMP     VALUE 'T'.                      
008100             88  DL016-EAI-USR-IS-UNKNOWN VALUE 'U'.                      
008200     05  DL016-FILLER-02                  PIC  X(25).                     
008300                                                                          
008400     05  DL016-EST-TEAM-INPUT-FIELDS.                                     
008500         10  DL016-ETI-ASGMT-START-DTE.                                   
008600             15  DL016-ETI-ASGMT-SDTE-YYYY PIC X(04).                     
008700                 88  DL016-ETI-ASGMT-NO-STY          VALUE SPACES.        
008800             15  DL016-FILLER-03          PIC  X(01).                     
008900             15  DL016-ETI-ASGMT-SDTE-MM  PIC  X(02).                     
009000                 88  DL016-ETI-ASGMT-NO-STM          VALUE SPACES.        
009100             15  DL016-FILLER-04          PIC  X(01).                     
009200             15  DL016-ETI-ASGMT-SDTE-DD  PIC  X(02).                     
009300                 88  DL016-ETI-ASGMT-NO-STD          VALUE SPACES.        
009400         10  DL016-ETI-ASGMT-NBR-TXT      PIC  X(10).                     
009500             88  DL016-ETI-ASGMT-NO-NBR-TXT        VALUE SPACES.          
009600         10  DL016-ETI-ASGMT-NBR-SEQ-NBR  PIC S9(09)     COMP.            
009700             88  DL016-ETI-ASGMT-NO-SEQ-NBR        VALUE ZEROS.           
009800         10  DL016-ETI-USR-ID             PIC  X(08).                     
009900             88  DL016-ETI-NO-USR         VALUE SPACES.                   
010000         10  DL016-ETI-USR-TYP-CDE        PIC  X(01).                     
010100             88  DL016-VALID-ETI-USR-TYP  VALUES 'K' 'T' 'U'.             
010200             88  DL016-ETI-USR-IS-KOHLS   VALUE 'K'.                      
010300             88  DL016-ETI-USR-IS-TMP     VALUE 'T'.                      
010400             88  DL016-ETI-USR-IS-UNKNOWN VALUE 'U'.                      
010500         10  DL016-FILLER-05              PIC  X(25).                     
010600                                                                          
010700     05  DL016-RETURN-CODE                PIC  X(02).                     
010800         88  DL016-SUCCESSFUL             VALUES ZERO.                    
010900         88  DL016-SQL-ERROR              VALUE '01'.                     
011000         88  DL016-MISSING-EAI-FIELDS     VALUE '02'.                     
011100         88  DL016-MISSING-ETI-FIELDS     VALUE '03'.                     
011200         88  DL016-COMMIT-CODE-INVALID    VALUE '04'.                     
011300         88  DL016-PROCESS-CODE-INVALID   VALUE '05'.                     
011400         88  DL016-MISSING-CALL-PROGRAM   VALUE '06'.                     
011500         88  DL016-MISSING-SIGN-ON-USR    VALUE '07'.                     
011600         88  DL016-INVALID-SIGN-ON-USR    VALUE '08'.                     
011700         88  DL016-MISSING-ASGMT-WRK-TYP  VALUE '08'.                     
011800         88  DL016-CALLED-MODULE-FAILURE  VALUE '98'.                     
011900         88  DL016-INVALID-ACCESS         VALUE '99'.                     
012000     05  DL016-RETURN-SQLCODES.                                           
012100         10  DL016-ASGMT-SQLCODE          PIC  S9(9).                     
012200             88  DL016-ASGMT-NOT-FOUND    VALUE  +100.                    
012300             88  DL016-ASGMT-CONTENTION   VALUES -904 -911 -913.          
012400         10  DL016-FILLER-06              PIC  X(25).                     
012500* THE FOLLOWING ARE TO CONTAIN PARAGRAPH NUMBERS ASSOCIATED TO            
012600* THE ABOVE SQL RETURN CODES.                                             
012700     05  DL016-CALL-MOD-FAIL-SQL-PARA     PIC  X(05).                     
012800     05  DL016-CALL-MOD-FAIL-NM           PIC  X(08).                     
012900     05  DL016-CALL-MOD-FAIL-ERR-CDE      PIC  X(02).                     
013000     05  DL016-CALL-MOD-FAIL-SQL-CDE      PIC  S9(9).                     
013100     05  DL016-FILLER-07                  PIC  X(10).                     
013200                                                                          
013300     05  DL016-EST-ASGMT-OUTPUT-FIELDS.                                   
013400         10  DL016-ESO-ASGMT-PROCESS-SW   PIC  X(01).                     
013500             88  DL016-ESO-NEW-ASGMT-CREATE    VALUE 'A'.                 
013600             88  DL016-ESO-EXIST-ASGMT-FOUND   VALUE 'B'.                 
013700         10  DL016-ESO-EMP-PROCESS-SW     PIC  X(01).                     
013800             88  DL016-ESO-EMP-NEW-TO-ASGMT    VALUE 'A'.                 
013900             88  DL016-ESO-EMP-EXIST-ON-ASGMT  VALUE 'B'.                 
014000             88  DL016-ESO-EMP-ENDADD-ASGMT    VALUE 'C'.                 
014100         10  DL016-ESO-ASGMT-START-DTE.                                   
014200             15  DL016-ESO-ASGMT-SDTE-YYYY PIC X(04).                     
014300             15  DL016-FILLER-08          PIC  X(01).                     
014400             15  DL016-ESO-ASGMT-SDTE-MM  PIC  X(02).                     
014500             15  DL016-FILLER-09          PIC  X(01).                     
014600             15  DL016-ESO-ASGMT-SDTE-DD  PIC  X(02).                     
014700         10  DL016-ESO-ASGMT-NBR-TXT      PIC  X(10).                     
014800         10  DL016-ESO-ASGMT-NBR-SEQ-NBR  PIC S9(09)     COMP.            
014900         10  DL016-FILLER-10              PIC  X(25).                     
015000                                                                          
015100     05  DL016-EST-TEAM-OUTPUT-FIELDS.                                    
015200         10  DL016-ETO-ASGMT-PROCESS-SW   PIC  X(01).                     
015300             88  DL016-ETO-NEW-ASGMT-CREATE    VALUE 'A'.                 
015400             88  DL016-ETO-EXIST-ASGMT-USED    VALUE 'B'.                 
015500         10  DL016-ETO-EMP-PROCESS-SW     PIC  X(01).                     
015600             88  DL016-ETO-NEW-TO-ASGMT        VALUE 'A'.                 
015700             88  DL016-ETO-EXIST-ON-ASGMT      VALUE 'B'.                 
015800             88  DL016-ETO-END-AND-ADD-ASGMT   VALUE 'C'.                 
015900         10  DL016-ETO-ASGMT-START-DTE.                                   
016000             15  DL016-ETO-ASGMT-SDTE-YYYY PIC X(04).                     
016100             15  DL016-FILLER-11          PIC  X(01).                     
016200             15  DL016-ETO-ASGMT-SDTE-MM  PIC  X(02).                     
016300             15  DL016-FILLER-12          PIC  X(01).                     
016400             15  DL016-ETO-ASGMT-SDTE-DD  PIC  X(02).                     
016500         10  DL016-ETO-ASGMT-NBR-TXT      PIC  X(10).                     
016600         10  DL016-ETO-ASGMT-NBR-SEQ-NBR  PIC S9(09)     COMP.            
016700         10  DL016-FILLER-13              PIC  X(25).                     
016800                                                                          
016900     05  DL016-FILLER                     PIC  X(162).                    
017000     05  DL016-SQLCA                      PIC  X(138).                    
017100                                                                          
017200 01  DL016-COMMAREA                       PIC  X(01).                     
017300                                                                          
017400 01  DL016-USER-PGM                       PIC  X(08)                      
017500                                          VALUE 'DLKCS410'.               
