000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SEKRP011.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           06-10-10.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       THIS PROGRAM WILL CREATE THE RACF USER GROUP AUDIT       *00120026
001201*  REPORT AND ALLOW A DETAIL FILE TO BE CREATED THAT CAN BE USED *00120126
001202*  FOR AUTOMATED COMMUNICATION TO RESOURCE OWNERS, OR PARED      *00120226
001203*  DOWN TO A REPORT FILE.                                        *00120326
001210******************************************************************00121000
001220                                                                  00122000
001230******************************************************************00123000
001240 ENVIRONMENT DIVISION.                                            00124000
001250******************************************************************00125000
001260                                                                  00126000
001270 CONFIGURATION SECTION.                                           00127000
001280                                                                  00128000
001290 SOURCE-COMPUTER.        IBM-3090.                                00129000
001300 OBJECT-COMPUTER.        IBM-3090.                                00130000
001400                                                                  00140000
001500 INPUT-OUTPUT SECTION.                                            00150000
001600                                                                  00160000
001700 FILE-CONTROL.                                                    00170000
001800                                                                  00180000
001900     SELECT RACF-AUDIT-EXTRACT-FILE                               00190000
002000         ASSIGN TO INP01.                                         00200000
002100                                                                  00210000
002200     SELECT RESOURCE-OWNER-FILE                                   00220000
002300         ASSIGN TO INP02.                                         00230000
002430                                                                  00243000
002440     SELECT AUDIT-DETAIL-FILE                                     00244000
002450         ASSIGN TO OUT01.                                         00245000
002460                                                                  00246000
002462     SELECT CERTIFICATION-FILE                                    00246220
002463         ASSIGN TO OUT02.                                         00246320
002464                                                                  00246420
002470     SELECT AUDIT-REPORT-FILE                                     00247000
002480         ASSIGN TO RPT01.                                         00248000
002490                                                                  00249000
002500******************************************************************00250000
002600 DATA DIVISION.                                                   00260000
002700******************************************************************00270000
002800                                                                  00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  RACF-AUDIT-EXTRACT-FILE                                      00310000
003200     RECORDING MODE IS F                                          00320000
003300     LABEL RECORDS ARE STANDARD                                   00330000
003400     BLOCK CONTAINS 0 RECORDS                                     00340000
003500     RECORD CONTAINS 163 CHARACTERS                               00350001
003600     DATA RECORD IS RA-RACF-AUDIT-EXTRACT-RECORD.                 00360000
003700                                                                  00370000
003800 01  RA-RACF-AUDIT-EXTRACT-RECORD                                 00380000
003900                                 PIC X(163).                      00390001
004000                                                                  00400000
004100 FD  RESOURCE-OWNER-FILE                                          00410000
004200     RECORDING MODE IS F                                          00420000
004300     LABEL RECORDS ARE STANDARD                                   00430000
004310     BLOCK CONTAINS 0 RECORDS                                     00431000
004320     RECORD CONTAINS 200 CHARACTERS                               00432000
004330     DATA RECORD IS RO-RESOURCE-OWNER-RECORD.                     00433000
004340                                                                  00434000
004350 01  RO-RESOURCE-OWNER-RECORD    PIC X(200).                      00435000
004396                                                                  00439600
004397 FD  AUDIT-DETAIL-FILE                                            00439700
004398     RECORDING MODE IS F                                          00439800
004399     LABEL RECORDS ARE STANDARD                                   00439900
004400     BLOCK CONTAINS 0 RECORDS                                     00440000
004500     RECORD CONTAINS 185 CHARACTERS                               00450000
004600     DATA RECORD IS AD-AUDIT-DETAIL-RECORD.                       00460000
004700                                                                  00470000
004800 01  AD-AUDIT-DETAIL-RECORD      PIC X(141).                      00480001
004810                                                                  00481020
004820 FD  CERTIFICATION-FILE                                           00482020
004830     RECORDING MODE IS F                                          00483020
004840     LABEL RECORDS ARE STANDARD                                   00484020
004850     BLOCK CONTAINS 0 RECORDS                                     00485020
004860     RECORD CONTAINS 91 CHARACTERS                                00486020
004870     DATA RECORD IS CF-CERTIFICATION-RECORD.                      00487020
004880                                                                  00488020
004890 01  CF-CERTIFICATION-RECORD     PIC X(91).                       00489020
004900                                                                  00490000
005000 FD  AUDIT-REPORT-FILE                                            00500000
005100     RECORDING MODE IS F                                          00510000
005110     LABEL RECORDS ARE STANDARD                                   00511000
005120     BLOCK CONTAINS 0 RECORDS                                     00512000
005130     RECORD CONTAINS 132 CHARACTERS                               00513000
005140     DATA RECORD IS AR-AUDIT-REPORT-LINE.                         00514000
005150                                                                  00515000
005160 01  AR-AUDIT-REPORT-LINE        PIC X(132).                      00516000
005170                                                                  00517000
005180 WORKING-STORAGE SECTION.                                         00518000
005190                                                                  00519000
005200*                                                                 00520000
005300*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT                 00530000
005400*                                                                 00540000
005500                                                                  00550000
005600     COPY DPWS132.                                                00560000
005700                                                                  00570000
005800 01  ABEND-CODE                  PIC S9(04)   VALUE ZERO          00580000
005900                                              COMP SYNC.          00590000
006000     88  AC-CONTROL-CARD-ERROR                VALUE +4003.        00600000
006100     88  AC-TABLE-OVERFLOW-ERROR              VALUE +4004.        00610000
006200     88  AC-FILE-SEQUENCE-ERROR               VALUE +4007.        00620000
006210     88  AC-INVLD-DATA-ON-DATASET-ERROR       VALUE +4008.        00621000
006220                                                                  00622000
006230 01  PS-PROGRAM-SWITCHES.                                         00623000
006240     05  PS-END-OF-EXTRACT-FILE-SW                                00624000
006250                                 PIC X(1)     VALUE 'N'.          00625000
006260         88  PS-END-OF-EXTRACT-FILE           VALUE 'Y'.          00626000
006270     05  PS-END-OF-OWNER-FILE-SW                                  00627000
006280                                 PIC X(1)     VALUE 'N'.          00628000
006290         88  PS-END-OF-OWNER-FILE             VALUE 'Y'.          00629000
006707     05  PS-AUDIT-RESOURCE-FOUND-SW                               00670700
006708                                 PIC X(1)     VALUE 'Y'.          00670800
006709         88  PS-AUDIT-RESOURCE-FOUND          VALUE 'Y'.          00670900
006710         88  PS-AUDIT-RESOURCE-NOT-FOUND      VALUE 'N'.          00671000
006720                                                                  00672000
006730 01  PC-PROGRAM-CONSTANTS.                                        00673000
006740     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'SEKRP011'.   00674000
006750     05  PC-PAGE-SIZE            PIC S9(4)    VALUE +63           00675000
006760                                              COMP SYNC.          00676000
006770     05  PC-MAXIMUM-RESOURCE-OWNER-CNT                            00677000
006780                                 PIC S9(4)    VALUE +1000         00678000
006790                                              COMP SYNC.          00679000
007010     05  PC-RESOURCE-NOT-FOUND-RET-CODE                           00701000
007020                                 PIC S9(4)    VALUE +4050         00702000
007030                                              COMP SYNC.          00703000
007031     05  PC-KOHLS-DOMAIN         PIC X(10)    VALUE '@KOHLS.COM'. 00703100
007032     05  PC-PERIOD               PIC X(1)     VALUE '.'.          00703200
007033     05  PC-DASH                 PIC X(1)     VALUE '.'.          00703300
007034     05  PC-OPEN-PARENTHESIS     PIC X(1)     VALUE '('.          00703400
007035     05  PC-CLOSE-PARENTHESIS    PIC X(1)     VALUE ')'.          00703500
007036     05  PC-NEW-FRONT-REQUEST.                                    00703600
007037         10  FILLER              PIC S9(4)    VALUE -1            00703700
007038                                              COMP SYNC.          00703800
007039     05  PC-COMMA                PIC X(1)     VALUE ','.          00703922
007040     05  PC-DOUBLE-QUOTE         PIC X(1)     VALUE '"'.          00704022
007041     05  PC-USER-GROUP-CLASS     PIC X(15)    VALUE               00704124
007042         'NoResourceGroup'.                                       00704224
007043     05  PC-ACCESS-LEVEL-N-A     PIC X(3)     VALUE 'N/A'.        00704322
007044     05  PC-GROUP-WITHOUT-USERS  PIC X(6)     VALUE 'NoUser'.     00704422
007045     05  PC-CATEGORY-UNKNOWN     PIC X(7)     VALUE 'UNKNOWN'.    00704523
007046                                                                  00704600
007047 01  PV-PROGRAM-VARIABLES.                                        00704700
007050     05  PV-CURRENT-USER-GROUP   PIC X(8)     VALUE SPACES.       00705005
007090     05  PV-CURRENT-GRANTED-TO-ID                                 00709000
007100                                 PIC X(8)     VALUE SPACES.       00710000
007221     05  PV-TALLY                PIC S9(4)    VALUE ZEROS         00722100
007222                                              COMP SYNC.          00722200
007223     05  PV-START-POSITION       PIC S9(4)    VALUE ZEROS         00722300
007224                                              COMP SYNC.          00722400
007225     05  PV-SEGMENT-LENGTH       PIC S9(4)    VALUE ZEROS         00722500
007226                                              COMP SYNC.          00722600
007227     05  PV-SPACE-CHECK          PIC S9(4)    VALUE ZEROS         00722700
007228                                              COMP SYNC.          00722800
007229     05  PV-PAGE-COUNT           PIC S9(4)    VALUE ZEROS         00722900
007230                                              COMP SYNC.          00723000
007231     05  PV-LINE-COUNT           PIC S9(4)    VALUE ZEROS         00723100
007232                                              COMP SYNC.          00723200
007233     05  PV-ADVANCE-COUNT        PIC S9(4)    VALUE ZEROS         00723300
007234                                              COMP SYNC.          00723400
007235         88  PV-AC-SINGLE-SPACE               VALUE +1.           00723500
007236         88  PV-AC-DOUBLE-SPACE               VALUE +2.           00723600
007237         88  PV-AC-TRIPLE-SPACE               VALUE +3.           00723700
007238     05  PV-RESOURCE-OWNER-COUNT PIC S9(4)    VALUE ZEROS         00723800
007239                                              COMP SYNC.          00723900
007240     05  PV-GRP-SUPPRESS-COUNT   PIC S9(4)    VALUE ZEROS         00724000
007250                                              COMP SYNC.          00725000
007260     05  PV-EMAIL-TO-CONVERT     PIC X(50)    VALUE SPACES.       00726000
007270     05  PV-CONVERTED-NAME       PIC X(40)    VALUE SPACES.       00727000
007280     05  PV-REMAINDER-OF-NAME    PIC X(50)    VALUE SPACES.       00728000
007290     05  PV-RESOURCE-DESC-AREA   PIC X(255)   VALUE SPACES.       00729000
007291     05  PV-LENGTH-OF-DESC-DETAIL                                 00729100
007292                                 PIC S9(4)    VALUE ZEROS         00729200
007293                                              COMP SYNC.          00729300
007294     05  PV-LENGTH-OF-DESC-AREA  PIC S9(4)    VALUE ZEROS         00729400
007295                                              COMP SYNC.          00729500
007298     05  PV-AUD-RESOURCE-NOT-FOUND-CNT                            00729800
007299                                 PIC S9(4)    VALUE ZEROS         00729900
007300                                              COMP SYNC.          00730000
007301     05  PV-CERTIFICATION-RECORD PIC X(91)    VALUE SPACES.       00730122
007302                                                                  00730200
007303 01  CC-CONTROL-CARD.                                             00730300
007304     05  CC-CONTROL-CARD-DISPLAY.                                 00730400
007309         10  CC-HR-INFORMATION-REQ-IND                            00730900
007310                                 PIC X(1)     VALUE SPACES.       00731000
007320             88  CC-SUPPRESS-HR-INFORMATION   VALUE 'S'.          00732000
007330             88  CC-INCLUDE-HR-INFORMATION    VALUE 'I'.          00733000
007340         10  FILLER              PIC X(1)     VALUE SPACES.       00734000
007350         10  CC-DISPLAY-RES-OWNER-IND                             00735000
007360                                 PIC X(1)     VALUE SPACES.       00736000
007370             88  CC-DISPLAY-RESOURCE-OWNER-INFO                   00737000
007380                                              VALUE 'Y'.          00738000
007390             88  CC-MUTE-RESOURCE-OWNER-INFO  VALUE 'N'.          00739000
007400         10  FILLER              PIC X(1)     VALUE SPACES.       00740000
007500         10  CC-APPROVAL-REQ-IND PIC X(1)     VALUE SPACES.       00750000
007600             88  CC-SEND-FOR-APPROVAL         VALUE 'S'.          00760000
007700             88  CC-AUDIT-REPORT-ONLY         VALUE 'A'.          00770000
007710         10  FILLER              PIC X(1)     VALUE SPACES.       00771017
007720         10  CC-DISCLAIMER-IND   PIC X(1)     VALUE SPACES.       00772017
007730             88  CC-INCLUDE-DISCLAIMER        VALUE 'Y'.          00773017
007740             88  CC-EXCLUDE-DISCLAIMER        VALUE 'N'.          00774017
007800     05  FILLER                  PIC X(73)    VALUE SPACES.       00780000
007900                                                                  00790000
008000 01  AE-AUDIT-EXTRACT-FILE-RECORD.                                00800000
008100     05  AE-USER-GROUP           PIC X(8)     VALUE SPACES.       00810001
008400     05  AE-USER-GROUP-DESCRIPTION                                00840001
008800                                 PIC X(92)    VALUE SPACES.       00880001
010030     05  AE-AD-USER-ID           PIC X(8)     VALUE SPACES.       01003001
010040         88  AE-AD-GROUP-WITHOUT-USERS        VALUE HIGH-VALUES.  01004001
010045     05  AE-AD-USER-NAME         PIC X(40)    VALUE SPACES.       01004505
010046         88  AE-AD-ACCOUNT-NOT-DEFINED        VALUE HIGH-VALUES.  01004601
010047     05  AE-AD-ACCOUNT-CATEGORY  PIC X(8)     VALUE SPACES.       01004701
010049         88  AE-AD-CATEGORY-NOT-DEFINED       VALUE SPACES.       01004901
010050         88  AE-AD-CATEGORY-UNKNOWN           VALUE 'UNKNOWN'.    01005001
010060     05  AE-AD-EMPLOYEE-ID-X.                                     01006001
010061         10  AE-AD-EMPLOYEE-ID   PIC 9(7)     VALUE ZEROS.        01006101
010078                                                                  01007800
010079 01  RO-RESOURCE-OWNER-RCD.                                       01007900
010080     05  RO-RESOURCE-NAME        PIC X(52)    VALUE SPACES.       01008000
010081     05  FILLER                  REDEFINES RO-RESOURCE-NAME.      01008100
010082         10  RO-RESOURCE-CLASS   PIC X(8).                        01008200
010083         10  RO-RESOURCE-GROUP   PIC X(44).                       01008300
010084     05  RO-OWNER-EMAIL          PIC X(50)    VALUE SPACES.       01008400
010085     05  RO-MGMT-BOARD-REP-EMAIL PIC X(50)    VALUE SPACES.       01008500
010086     05  FILLER                  PIC X(48)    VALUE SPACES.       01008600
010087                                                                  01008700
010088 01  OT-OWNER-TABLE.                                              01008800
010089     05  OT-OWNER-ENTRY          OCCURS 1000 TIMES                01008900
010090                                 ASCENDING KEY OT-RESOURCE-NAME   01009000
010091                                 INDEXED BY OT-INDEX.             01009100
010092         10  OT-RESOURCE-NAME    PIC X(52).                       01009200
010093         10  FILLER              REDEFINES OT-RESOURCE-NAME.      01009300
010094             15  OT-RESOURCE-CLASS                                01009400
010095                                 PIC X(8).                        01009500
010096             15  OT-RESOURCE-GROUP                                01009600
010097                                 PIC X(44).                       01009700
010098         10  OT-OWNER-EMAIL      PIC X(50).                       01009800
010099         10  OT-OWNER-NAME-DISPLAY                                01009900
010100                                 PIC X(40).                       01010000
010101         10  OT-MGMT-BOARD-REP-EMAIL                              01010100
010102                                 PIC X(50).                       01010200
010103         10  OT-MGMT-BOARD-REP-NAME-DISPLAY                       01010300
010110                                 PIC X(40).                       01011000
010200                                                                  01020000
010300 01  HL2-HEADING-LINE-2.                                          01030000
010400     05  FILLER                  PIC X(55)    VALUE SPACES.       01040002
010500     05  FILLER                  PIC X(21)    VALUE               01050002
010600         'RACF USER GROUP AUDIT'.                                 01060002
010700     05  FILLER                  PIC X(56)    VALUE SPACES.       01070002
013500                                                                  01350000
013501 01  HL3-HEADING-LINE-3.                                          01350102
013503     05  FILLER                  PIC X(54)    VALUE               01350302
013504         'IN LIEU OF THE STANDARD RACF RESOURCE AUDIT, YOU HAVE '.01350402
013505     05  FILLER                  PIC X(50)    VALUE               01350502
013506         'BEEN SENT A RACF USER GROUP AUDIT.  THE RACF USER '.    01350602
013507     05  FILLER                  PIC X(28)    VALUE               01350702
013508         'GROUP LISTED'.                                          01350802
013509                                                                  01350902
013510 01  HL4-HEADING-LINE-4.                                          01351002
013511     05  FILLER                  PIC X(53)    VALUE               01351103
013512         'WAS DEFINED FOR THE PURPOSE OF RESTRICTING ACCESS TO '. 01351203
013513     05  FILLER                  PIC X(47)    VALUE               01351303
013514         'A PARTICULAR BUSINESS FUNCTION, BUT THE ACTUAL '.       01351403
013515     05  FILLER                  PIC X(32)    VALUE               01351503
013516         'SECURITY'.                                              01351603
013517                                                                  01351703
013518 01  HL5-HEADING-LINE-5.                                          01351803
013519     05  FILLER                  PIC X(51)    VALUE               01351903
013520         'IMPLEMENTATION WILL SPAN RACF RESOURCES.  ONCE THE '.   01352003
013521     05  FILLER                  PIC X(50)    VALUE               01352103
013522         'ACCESS FOR THE FUNCTION IS VALIDATED BY REVIEWING '.    01352203
013523     05  FILLER                  PIC X(31)    VALUE               01352303
013524         'THIS ACCESS'.                                           01352403
013525                                                                  01352503
013526 01  HL6-HEADING-LINE-6.                                          01352603
013527     05  FILLER                  PIC X(52)    VALUE               01352703
013528         'LIST, CORPORATE GOVERNANCE AND SECURITY WILL VERIFY '.  01352803
013529     05  FILLER                  PIC X(80)    VALUE               01352903
013530         'THE TECHNICAL IMPLEMENTATION.'.                         01353003
013531                                                                  01353103
013532 01  RR-RESOURCE-RESPONSIBILTY-LINE.                              01353203
013533     05  FILLER                  PIC X(16)    VALUE               01353303
013534         'RESOURCE OWNER: '.                                      01353400
013540     05  RR-RESOURCE-OWNER-NAME  PIC X(40)    VALUE SPACES.       01354000
013550         88  RR-RO-NOT-IDENTIFIED             VALUE               01355000
013560             '  ** NOT IDENTIFIED **'.                            01356000
013570     05  FILLER                  PIC X(35)    VALUE               01357000
013580         '  MANAGEMENT BOARD REPRESENTATIVE: '.                   01358000
013590     05  RR-MGMT-BOARD-REP-NAME  PIC X(40)    VALUE SPACES.       01359000
013591         88  RR-MB-NOT-IDENTIFIED             VALUE               01359100
013592             '  ** NOT IDENTIFIED **'.                            01359200
013593     05  FILLER                  PIC X(1)     VALUE SPACES.       01359300
013594                                                                  01359411
013595 01  RU-REQ-USER-GROUP-ERROR-LINE.                                01359511
013596     05  FILLER                  PIC X(19)    VALUE               01359611
013597         '***** ERROR *****  '.                                   01359711
013598     05  FILLER                  PIC X(113)   VALUE               01359811
013599         'REQUESTED USER GROUP NOT FOUND IN RACF'.                01359911
013600                                                                  01360006
013601 01  RU-RACF-USER-GROUP-LINE.                                     01360106
013602     05  FILLER                  PIC X(16)    VALUE               01360210
013610         'RACF USER GROUP:'.                                      01361006
013620     05  FILLER                  PIC X(1)     VALUE SPACES.       01362006
013621     05  RU-USER-GROUP           PIC X(8)     VALUE SPACES.       01362106
013622     05  FILLER                  PIC X(15)    VALUE               01362210
013623         '   DESCRIPTION:'.                                       01362306
013631     05  RU-USER-GROUP-DESCRIPTION                                01363106
013632                                 PIC X(63).                       01363206
013633         88  RU-UG-NO-DESCRIPTION             VALUE               01363306
013634             '  ** NO USER GROUP DESCRIPTION **'.                 01363406
013635     05  FILLER                  PIC X(1)     VALUE SPACES.       01363506
013636     05  RU-USER-GROUP-NOTATION  PIC X(37).                       01363606
013640         88  RU-UG-NO-USERS                   VALUE               01364008
013641             '** NO USERS IN USER GROUP **'.                      01364106
013642         88  RU-UG-EXPANSION-CONTINUED        VALUE               01364208
013643             ' (GROUP EXPANSION CONTINUED)         '.             01364306
013644     05  FILLER                  PIC X(5)     VALUE SPACES.       01364406
013687                                                                  01368700
013688 01  GE-GROUP-EXPANSION-LINE.                                     01368800
013689     05  FILLER                  PIC X(9)     VALUE SPACES.       01368914
013690     05  GE-USER-ID              PIC X(8)     VALUE SPACES.       01369000
013691     05  GE-USER-NAME            PIC X(40)    VALUE SPACES.       01369114
013692         88  GE-UN-NO-DESCRIPTION             VALUE               01369214
013693             '  ** NO USER/PROCESS NAME **'.                      01369314
013694     05  GE-ACCOUNT-CATEGORY     PIC X(10)    VALUE SPACES.       01369414
013695     05  FILLER                  PIC X(7)     VALUE SPACES.       01369514
013696         88  GE-EMPLOYEE-ID-TAG               VALUE 'EMPLID '.    01369614
013697     05  GE-EMPLOYEE-ID          PIC X(7)     VALUE SPACES.       01369714
013698         88  GE-EMPLOYEE-ID-NOT-AVAILABLE     VALUE ' N/A '.      01369814
013701                                                                  01370100
013702 01  AD-AUDIT-DETAIL-RCD.                                         01370200
013703     05  AD-KEY.                                                  01370300
013704         10  AD-USER-GROUP       PIC X(8).                        01370401
013705         10  AD-RECORD-TYPE      PIC X(1).                        01370500
013706             88  AD-RT-ROUTING-RECORD         VALUE '1'.          01370600
013707             88  AD-RT-DETAIL-RECORD          VALUE '2'.          01370700
013708     05  AD-DETAIL-LINE          PIC X(132).                      01370800
013709     05  AD-ROUTING-INFORMATION  REDEFINES AD-DETAIL-LINE.        01370900
013710         10  AD-OWNER-EMAIL      PIC X(50).                       01371000
013711         10  AD-MGMT-BOARD-REP-EMAIL                              01371100
013712                                 PIC X(50).                       01371200
013713         10  FILLER              PIC X(32).                       01371300
013714                                                                  01371400
013715******************************************************************01371500
013716 PROCEDURE DIVISION.                                              01371600
013717******************************************************************01371700
013718                                                                  01371800
013720 0000-MAINLINE.                                                   01372000
013800                                                                  01380000
013900     PERFORM 1000-INITIALIZE.                                     01390000
014000                                                                  01400000
014100     PERFORM 2000-PROCESS-AUDIT-RESOURCE                          01410000
014200         UNTIL PS-END-OF-EXTRACT-FILE.                            01420000
014300                                                                  01430000
014400     PERFORM 9000-EOJ-ROUTINE.                                    01440000
014500                                                                  01450000
014600     IF (PV-AUD-RESOURCE-NOT-FOUND-CNT > ZERO)                    01460000
014700         MOVE PC-RESOURCE-NOT-FOUND-RET-CODE TO RETURN-CODE       01470000
014800     END-IF.                                                      01480000
014900                                                                  01490000
015000     GOBACK.                                                      01500000
015100                                                                  01510000
015200******************************************************************01520000
015300*                                                                *01530000
015400******************************************************************01540000
015500                                                                  01550000
015600 1000-INITIALIZE.                                                 01560000
015700     ACCEPT CC-CONTROL-CARD.                                      01570000
015800     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - CONTROL CARD = ('       01580000
015810               CC-CONTROL-CARD-DISPLAY  ')'.                      01581000
015820                                                                  01582000
015830     PERFORM 1100-VALIDATE-CONTROL-CARD.                          01583000
015840                                                                  01584000
015850     OPEN INPUT  RACF-AUDIT-EXTRACT-FILE                          01585000
015860                 RESOURCE-OWNER-FILE                              01586000
015880          OUTPUT AUDIT-DETAIL-FILE                                01588000
015881                 CERTIFICATION-FILE                               01588120
015890                 AUDIT-REPORT-FILE.                               01589000
015900                                                                  01590000
016000     MOVE FUNCTION CURRENT-DATE (1:4) TO DP132-RUN-YEAR.          01600000
016100     MOVE FUNCTION CURRENT-DATE (5:2) TO DP132-RUN-MONTH.         01610000
016200     MOVE FUNCTION CURRENT-DATE (7:2) TO DP132-RUN-DAY.           01620000
016300     MOVE FUNCTION CURRENT-DATE (9:2) TO DP132-RUN-HOUR.          01630000
016400     MOVE FUNCTION CURRENT-DATE (11:2) TO DP132-RUN-MINUTE.       01640000
016500     MOVE PC-CURRENT-PROGRAM-NAME TO DP132-PROGRAM-NAME.          01650000
016600     MOVE 1 TO DP132-REPORT-NUMBER.                               01660000
016700                                                                  01670000
016710     PERFORM 1200-LOAD-RESOURCE-RESP.                             01671000
016740                                                                  01674000
016750     PERFORM 7000-READ-EXTRACT-FILE.                              01675000
016760*1000-EXIT.                                                       01676000
016770                                                                  01677000
016780******************************************************************01678000
016790*                                                                *01679000
016800******************************************************************01680000
016900                                                                  01690000
017000 1100-VALIDATE-CONTROL-CARD.                                      01700000
017615     IF ((NOT CC-SUPPRESS-HR-INFORMATION)                         01761500
017616             AND (NOT CC-INCLUDE-HR-INFORMATION))                 01761600
017617         DISPLAY '** ABEND **'                                    01761700
017618         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID HR '        01761800
017619                   'INFORMATION REQUESTED INDICATOR OF "'         01761900
017620                   CC-HR-INFORMATION-REQ-IND                      01762000
017621                   '" FOUND ON CONTROL CARD'                      01762100
017622         SET AC-CONTROL-CARD-ERROR TO TRUE                        01762200
017623         CALL 'ILBOABN0' USING ABEND-CODE                         01762300
017624     END-IF.                                                      01762400
017625                                                                  01762500
017626     IF ((NOT CC-DISPLAY-RESOURCE-OWNER-INFO)                     01762600
017627             AND (NOT CC-MUTE-RESOURCE-OWNER-INFO))               01762700
017628         DISPLAY '** ABEND **'                                    01762800
017629         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID '           01762900
017630                   'DISPLAY RESOURCE OWNER INDICATOR OF "'        01763000
017640                   CC-DISPLAY-RES-OWNER-IND                       01764000
017641                   '" FOUND ON CONTROL CARD'                      01764100
017642         SET AC-CONTROL-CARD-ERROR TO TRUE                        01764200
017643         CALL 'ILBOABN0' USING ABEND-CODE                         01764300
017644     END-IF.                                                      01764400
017645                                                                  01764500
017646     IF ((NOT CC-SEND-FOR-APPROVAL)                               01764600
017647             AND (NOT CC-AUDIT-REPORT-ONLY))                      01764700
017648         DISPLAY '** ABEND **'                                    01764800
017649         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID '           01764900
017650                   'APPROVAL REQUESTED INDICATOR OF "'            01765000
017651                   CC-APPROVAL-REQ-IND                            01765100
017652                   '" FOUND ON CONTROL CARD'                      01765200
017653         SET AC-CONTROL-CARD-ERROR TO TRUE                        01765300
017654         CALL 'ILBOABN0' USING ABEND-CODE                         01765400
017655     END-IF.                                                      01765500
017656                                                                  01765617
017657     IF ((NOT CC-INCLUDE-DISCLAIMER)                              01765717
017658             AND (NOT CC-EXCLUDE-DISCLAIMER))                     01765817
017659         DISPLAY '** ABEND **'                                    01765917
017660         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID '           01766017
017661                   'DISCLAIMER INDICATOR OF "'  CC-DISCLAIMER-IND 01766117
017663                   '" FOUND ON CONTROL CARD'                      01766317
017664         SET AC-CONTROL-CARD-ERROR TO TRUE                        01766417
017665         CALL 'ILBOABN0' USING ABEND-CODE                         01766517
017666     END-IF.                                                      01766617
017668                                                                  01766817
017669     IF ((CC-SEND-FOR-APPROVAL)                                   01766917
017670             AND (CC-MUTE-RESOURCE-OWNER-INFO))                   01767017
017671         DISPLAY '** ABEND **'                                    01767117
017672         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - CANNOT '            01767217
017673                   'MUTE THE RESOURCE OWNER INFORMATION '         01767317
017674                   'WHEN REQUESTING A SEND FOR APPROVAL'          01767417
017675         SET AC-CONTROL-CARD-ERROR TO TRUE                        01767517
017676         CALL 'ILBOABN0' USING ABEND-CODE                         01767617
017677     END-IF.                                                      01767717
017678                                                                  01767817
017679     IF ((CC-SEND-FOR-APPROVAL)                                   01767917
017680             AND (CC-EXCLUDE-DISCLAIMER))                         01768017
017681         DISPLAY '** ABEND **'                                    01768117
017682         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - CANNOT '            01768217
017683                   'EXCLUDE THE DISCLAIMER INFORMATION '          01768317
017684                   'WHEN REQUESTING A SEND FOR APPROVAL'          01768417
017685         SET AC-CONTROL-CARD-ERROR TO TRUE                        01768517
017686         CALL 'ILBOABN0' USING ABEND-CODE                         01768617
017687     END-IF.                                                      01768717
017688*1100-EXIT.                                                       01768817
017689                                                                  01768917
017690******************************************************************01769017
017691*                                                                *01769117
017692******************************************************************01769217
017693                                                                  01769317
017694 1200-LOAD-RESOURCE-RESP.                                         01769417
017700     INITIALIZE OT-OWNER-TABLE                                    01770000
017800         REPLACING ALPHANUMERIC DATA BY HIGH-VALUES.              01780000
017801     INITIALIZE PV-RESOURCE-OWNER-COUNT.                          01780100
017802                                                                  01780200
017803     PERFORM 7100-READ-RESOURCE-OWNER-FILE.                       01780300
017804                                                                  01780400
017805     PERFORM                                                      01780500
017806             VARYING OT-INDEX                                     01780600
017807             FROM 1 BY 1                                          01780700
017808             UNTIL ((OT-INDEX > PC-MAXIMUM-RESOURCE-OWNER-CNT)    01780800
017809                     OR (PS-END-OF-OWNER-FILE))                   01780900
017810         IF ((OT-INDEX > 1)                                       01781000
017811                 AND (RO-RESOURCE-NAME <=                         01781100
017812                              OT-RESOURCE-NAME (OT-INDEX - 1)))   01781200
017813             DISPLAY '** ABEND **'                                01781300
017814             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - RESOURCE TO '   01781400
017815                       'RESOURCE OWNER FILE NOT IN ASCENDING '    01781500
017816                       'RESOURCE SEQUENCE'                        01781600
017817             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  01781700
017818                       'AT RESOURCE CLASS = '  RO-RESOURCE-CLASS  01781800
017819                       '; RESOURCE GROUP = '  RO-RESOURCE-GROUP   01781900
017820             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   01782000
017821             CALL 'ILBOABN0' USING ABEND-CODE                     01782100
017822         END-IF                                                   01782200
017823         MOVE RO-RESOURCE-CLASS TO                                01782300
017824                   OT-RESOURCE-CLASS (OT-INDEX)                   01782400
017825         MOVE RO-RESOURCE-GROUP TO                                01782500
017826                   OT-RESOURCE-GROUP (OT-INDEX)                   01782600
017827         MOVE RO-OWNER-EMAIL TO                                   01782700
017828                   OT-OWNER-EMAIL (OT-INDEX)                      01782800
017829                   PV-EMAIL-TO-CONVERT                            01782900
017830         IF (PV-EMAIL-TO-CONVERT NOT = SPACES)                    01783000
017831             PERFORM 1210-TRANSLATE-EMAIL-TO-NAME                 01783100
017832             MOVE PV-CONVERTED-NAME TO                            01783200
017833                       OT-OWNER-NAME-DISPLAY (OT-INDEX)           01783300
017834         END-IF                                                   01783400
017835         MOVE RO-MGMT-BOARD-REP-EMAIL TO                          01783500
017836                   OT-MGMT-BOARD-REP-EMAIL (OT-INDEX)             01783600
017837                   PV-EMAIL-TO-CONVERT                            01783700
017838         IF (PV-EMAIL-TO-CONVERT NOT = SPACES)                    01783800
017839            PERFORM 1210-TRANSLATE-EMAIL-TO-NAME                  01783900
017840            MOVE PV-CONVERTED-NAME TO                             01784000
017841                       OT-MGMT-BOARD-REP-NAME-DISPLAY (OT-INDEX)  01784100
017842         END-IF                                                   01784200
017843         ADD +1 TO PV-RESOURCE-OWNER-COUNT                        01784300
017844         PERFORM 7100-READ-RESOURCE-OWNER-FILE                    01784400
017845     END-PERFORM.                                                 01784500
017846                                                                  01784600
017847     IF ((OT-INDEX > PC-MAXIMUM-RESOURCE-OWNER-CNT)               01784700
017848             AND (NOT PS-END-OF-OWNER-FILE))                      01784800
017849         DISPLAY '** ABEND **'                                    01784900
017850         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 01785000
017851                   'DEFINED RESOURCE TO RESOURCE OWNER '          01785100
017852                   'ASSOCIATIONS EXCEEDED'                        01785200
017853         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  01785300
017854                   'AND RERUN'                                    01785400
017855         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      01785500
017856         CALL 'ILBOABN0' USING ABEND-CODE                         01785600
017857     END-IF.                                                      01785700
017858*1200-EXIT.                                                       01785800
017859                                                                  01785900
017860******************************************************************01786000
017861*                                                                *01786100
017862******************************************************************01786200
017863                                                                  01786300
017864 1210-TRANSLATE-EMAIL-TO-NAME.                                    01786400
017865     INITIALIZE PV-CONVERTED-NAME                                 01786500
017866                PV-REMAINDER-OF-NAME                              01786600
017867                PV-TALLY.                                         01786700
017868                                                                  01786800
017869     INSPECT PV-EMAIL-TO-CONVERT                                  01786900
017870         TALLYING PV-TALLY                                        01787000
017871         FOR ALL PC-KOHLS-DOMAIN.                                 01787100
017872                                                                  01787200
017873     IF (PV-TALLY NOT = 1)                                        01787300
017874         DISPLAY '** ABEND **'                                    01787400
017875         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - E-MAIL ADDRESS '    01787500
017876                   'ERROR IN RESOURCE OWNER FILE'                 01787600
017877         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - E-MAIL ADDRESS '    01787700
017878                   'DOES NOT HAVE A SINGLE KOHLS.COM DOMAIN '     01787800
017879                   'REFERENCE'                                    01787900
017880         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - REVIEW '            01788000
017881                   'RESOURCE CLASS = '  RO-RESOURCE-CLASS         01788100
017882                   '; RESOURCE GROUP = '  RO-RESOURCE-GROUP       01788200
017883         SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE               01788300
017884         CALL 'ILBOABN0' USING ABEND-CODE                         01788400
017885     END-IF.                                                      01788500
017886                                                                  01788600
017887     UNSTRING PV-EMAIL-TO-CONVERT                                 01788700
017888         DELIMITED BY PC-KOHLS-DOMAIN                             01788800
017889         INTO PV-CONVERTED-NAME                                   01788900
017890              PV-REMAINDER-OF-NAME                                01789000
017891         ON OVERFLOW                                              01789100
017892              CONTINUE                                            01789200
017893     END-UNSTRING.                                                01789300
017894                                                                  01789400
017895     IF (PV-REMAINDER-OF-NAME NOT = SPACES)                       01789500
017896         DISPLAY '** ABEND **'                                    01789600
017897         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - E-MAIL ADDRESS '    01789700
017898                   'ERROR IN RESOURCE OWNER FILE'                 01789800
017899         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - E-MAIL ADDRESS '    01789900
017900                   'HAS CHARACTERS BEYOND THE KOHLS.COM DOMAIN '  01790000
017901                   'REFERENCE'                                    01790100
017902         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - REVIEW '            01790200
017903                   'RESOURCE CLASS = '  RO-RESOURCE-CLASS         01790300
017904                   '; RESOURCE GROUP = '  RO-RESOURCE-GROUP       01790400
017905         SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE               01790500
017906         CALL 'ILBOABN0' USING ABEND-CODE                         01790600
017907     END-IF.                                                      01790700
017908                                                                  01790800
017909     INSPECT PV-CONVERTED-NAME                                    01790900
017910         REPLACING ALL PC-PERIOD BY SPACES.                       01791000
017911*1210-EXIT.                                                       01791100
017959                                                                  01795900
017960******************************************************************01796000
017961*                                                                *01796100
017962******************************************************************01796200
017963                                                                  01796300
017964 2000-PROCESS-AUDIT-RESOURCE.                                     01796400
017979     INITIALIZE AD-AUDIT-DETAIL-RCD.                              01797910
017981     MOVE AE-USER-GROUP TO PV-CURRENT-USER-GROUP                  01798101
017982                           RU-USER-GROUP                          01798208
017983                           AD-USER-GROUP.                         01798308
017986     IF (AE-USER-GROUP-DESCRIPTION = SPACES)                      01798610
017987         SET RU-UG-NO-DESCRIPTION TO TRUE                         01798708
017988     ELSE                                                         01798808
017989         MOVE AE-USER-GROUP-DESCRIPTION TO                        01798910
017990                   RU-USER-GROUP-DESCRIPTION                      01799010
018000     END-IF.                                                      01800008
018210                                                                  01821000
018220     IF ((CC-SEND-FOR-APPROVAL)                                   01822000
018221             AND (PS-AUDIT-RESOURCE-NOT-FOUND))                   01822100
018222         DISPLAY '** ABEND **'                                    01822200
018223         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID RESOURCE '  01822300
018224                   'REQUESTED - RESOURCE NOT FOUND'               01822400
018225         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ALL REQUESTED '     01822500
018226                   'RESOURCES MUST BE VALID WHEN REQUESTING A '   01822600
018227                   'SEND FOR APPROVAL'                            01822700
018228         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - RACF USER GROUP = ' 01822810
018230                   AE-USER-GROUP                                  01823010
018231         SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE               01823100
018232         CALL 'ILBOABN0' USING ABEND-CODE                         01823200
018233     END-IF.                                                      01823300
018234                                                                  01823400
018235     SEARCH ALL OT-OWNER-ENTRY                                    01823500
018236         AT END                                                   01823600
018237             SET RR-RO-NOT-IDENTIFIED                             01823700
018238                 RR-MB-NOT-IDENTIFIED TO TRUE                     01823800
018239         WHEN OT-RESOURCE-NAME (OT-INDEX) = AE-USER-GROUP         01823904
018240             MOVE OT-OWNER-NAME-DISPLAY (OT-INDEX) TO             01824000
018250                       RR-RESOURCE-OWNER-NAME                     01825000
018260             IF ((RR-RESOURCE-OWNER-NAME = HIGH-VALUES)           01826000
018261                     OR (RR-RESOURCE-OWNER-NAME = SPACES))        01826100
018262                 SET RR-RO-NOT-IDENTIFIED TO TRUE                 01826200
018263             END-IF                                               01826300
018264             MOVE OT-MGMT-BOARD-REP-NAME-DISPLAY (OT-INDEX) TO    01826400
018265                       RR-MGMT-BOARD-REP-NAME                     01826500
018266             IF ((RR-MGMT-BOARD-REP-NAME = HIGH-VALUES)           01826600
018267                     OR (RR-MGMT-BOARD-REP-NAME = SPACES))        01826700
018268                 SET RR-MB-NOT-IDENTIFIED TO TRUE                 01826800
018269             END-IF                                               01826900
018270     END-SEARCH.                                                  01827000
018280                                                                  01828000
018281     IF ((CC-SEND-FOR-APPROVAL)                                   01828100
018282             AND ((RR-RO-NOT-IDENTIFIED)                          01828200
018283             OR (RR-MB-NOT-IDENTIFIED)))                          01828300
018284         DISPLAY '** ABEND **'                                    01828400
018285         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - VALID RESOURCE '    01828500
018286                   'OWNER AND/OR MANGAGEMENT BOARD REP E-MAIL '   01828600
018287                   'ADDRESSES MISSING'                            01828700
018288         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - E-MAIL ADDRESSES '  01828800
018289                   'REQUIRED WHEN REQUESTING A SEND FOR APPROVAL' 01828900
018290         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - RACF USER GROUP = ' 01829010
018310                   AE-USER-GROUP                                  01831010
018311         SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE               01831100
018312         CALL 'ILBOABN0' USING ABEND-CODE                         01831200
018313     END-IF.                                                      01831300
018314                                                                  01831400
018315     IF (CC-SEND-FOR-APPROVAL)                                    01831500
018316         SET AD-RT-ROUTING-RECORD TO TRUE                         01831600
018317         MOVE OT-OWNER-EMAIL (OT-INDEX) TO AD-OWNER-EMAIL         01831700
018318         MOVE OT-MGMT-BOARD-REP-EMAIL (OT-INDEX) TO               01831800
018319                   AD-MGMT-BOARD-REP-EMAIL                        01831900
018320         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   01832000
018321     END-IF.                                                      01832100
018322     SET AD-RT-DETAIL-RECORD TO TRUE.                             01832200
018323     INITIALIZE AD-DETAIL-LINE.                                   01832300
018439                                                                  01843900
018440     MOVE PC-NEW-FRONT-REQUEST TO                                 01844000
018450               DP132-LASER-NEW-PAGE-INDICATR.                     01845000
018460     PERFORM 8000-PRINT-TITLE-LINES.                              01846000
018470     MOVE HL2-HEADING-LINE-2 TO AD-DETAIL-LINE.                   01847000
018480     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      01848000
018484                                                                  01848417
018485     IF (CC-INCLUDE-DISCLAIMER)                                   01848517
018486         INITIALIZE AD-DETAIL-LINE                                01848617
018487         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   01848717
018488         SET PV-AC-DOUBLE-SPACE TO TRUE                           01848817
018489         WRITE AR-AUDIT-REPORT-LINE                               01848917
018490             FROM HL3-HEADING-LINE-3                              01849017
018491             AFTER ADVANCING PV-ADVANCE-COUNT LINES               01849117
018492         ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT                    01849217
018493         SET PV-AC-SINGLE-SPACE TO TRUE                           01849317
018494         MOVE HL3-HEADING-LINE-3 TO AD-DETAIL-LINE                01849417
018495         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   01849517
018496         WRITE AR-AUDIT-REPORT-LINE                               01849617
018497             FROM HL4-HEADING-LINE-4                              01849717
018500             AFTER ADVANCING PV-ADVANCE-COUNT LINES               01850017
018600         ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT                    01860017
018710         MOVE HL4-HEADING-LINE-4 TO AD-DETAIL-LINE                01871017
018720         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   01872017
018730         WRITE AR-AUDIT-REPORT-LINE                               01873017
018740             FROM HL5-HEADING-LINE-5                              01874017
018750             AFTER ADVANCING PV-ADVANCE-COUNT LINES               01875017
018760         ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT                    01876017
018770         MOVE HL5-HEADING-LINE-5 TO AD-DETAIL-LINE                01877017
018780         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   01878017
018790         WRITE AR-AUDIT-REPORT-LINE                               01879017
018791             FROM HL6-HEADING-LINE-6                              01879117
018792             AFTER ADVANCING PV-ADVANCE-COUNT LINES               01879217
018793         ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT                    01879317
018794         MOVE HL6-HEADING-LINE-6 TO AD-DETAIL-LINE                01879417
018795         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   01879517
018796     END-IF.                                                      01879617
018800                                                                  01880000
018810     INITIALIZE RU-USER-GROUP-NOTATION.                           01881016
018811     IF (AE-AD-GROUP-WITHOUT-USERS)                               01881116
018812         SET RU-UG-NO-USERS TO TRUE                               01881216
018813     END-IF.                                                      01881316
018814                                                                  01881416
018820     SET PV-AC-DOUBLE-SPACE TO TRUE.                              01882014
018830     WRITE AR-AUDIT-REPORT-LINE                                   01883014
018840         FROM RU-RACF-USER-GROUP-LINE                             01884014
018850         AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  01885014
018851     INITIALIZE AD-DETAIL-LINE.                                   01885114
018852     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      01885214
018860     MOVE RU-RACF-USER-GROUP-LINE TO AD-DETAIL-LINE.              01886014
018870     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      01887014
018891                                                                  01889114
018900     IF (CC-DISPLAY-RESOURCE-OWNER-INFO)                          01890000
018910         SET PV-AC-DOUBLE-SPACE TO TRUE                           01891014
019000         WRITE AR-AUDIT-REPORT-LINE                               01900000
019100             FROM RR-RESOURCE-RESPONSIBILTY-LINE                  01910000
019110             AFTER ADVANCING PV-ADVANCE-COUNT  LINES              01911014
019111         ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT                    01911114
019112         INITIALIZE AD-DETAIL-LINE                                01911200
019113         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   01911300
019114         MOVE RR-RESOURCE-RESPONSIBILTY-LINE TO AD-DETAIL-LINE    01911400
019115         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   01911500
019116     END-IF.                                                      01911600
019146                                                                  01914609
019147     SET PV-AC-DOUBLE-SPACE TO TRUE.                              01914709
019148     INITIALIZE AD-DETAIL-LINE.                                   01914809
019149     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      01914909
019150                                                                  01915008
019151     PERFORM                                                      01915109
019152             UNTIL ((PS-END-OF-EXTRACT-FILE)                      01915209
019153                     OR (AE-USER-GROUP NOT =                      01915309
019154                                  PV-CURRENT-USER-GROUP))         01915410
019155         IF (NOT AE-AD-GROUP-WITHOUT-USERS)                       01915509
019160             PERFORM 3000-PROCESS-USER                            01916009
019161         ELSE                                                     01916122
019162             INITIALIZE PV-CERTIFICATION-RECORD                   01916222
019163             STRING PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01916322
019164                    PC-GROUP-WITHOUT-USERS      DELIMITED BY SPACE01916423
019165                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01916522
019166                    PC-COMMA                    DELIMITED BY SIZE 01916622
019167                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01916722
019168                    AE-USER-GROUP               DELIMITED BY SPACE01916822
019169                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01916922
019170                    PC-COMMA                    DELIMITED BY SIZE 01917022
019171                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01917122
019172                    AE-USER-GROUP               DELIMITED BY SPACE01917222
019173                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01917322
019174                    PC-COMMA                    DELIMITED BY SIZE 01917422
019175                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01917522
019176                    PC-USER-GROUP-CLASS         DELIMITED BY SIZE 01917622
019177                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01917722
019178                    PC-COMMA                    DELIMITED BY SIZE 01917822
019179                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01917922
019180                    PC-ACCESS-LEVEL-N-A         DELIMITED BY SIZE 01918022
019181                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01918122
019182                    PC-COMMA                    DELIMITED BY SIZE 01918222
019183                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01918322
019184                    PC-CATEGORY-UNKNOWN         DELIMITED BY SIZE 01918423
019185                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 01918522
019186                 INTO PV-CERTIFICATION-RECORD                     01918622
019187             PERFORM 8200-WRITE-CERTIFICATION-RCD                 01918722
019188         END-IF                                                   01918809
019189         PERFORM 7000-READ-EXTRACT-FILE                           01918909
019190     END-PERFORM.                                                 01919009
019191                                                                  01919100
019192     IF (PS-AUDIT-RESOURCE-NOT-FOUND)                             01919200
019193         WRITE AR-AUDIT-REPORT-LINE                               01919300
019200             FROM RU-REQ-USER-GROUP-ERROR-LINE                    01920011
019300             AFTER ADVANCING PV-ADVANCE-COUNT LINES               01930000
019400         ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT                    01940000
019500         MOVE RU-REQ-USER-GROUP-ERROR-LINE TO AD-DETAIL-LINE      01950011
019600         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   01960000
019727     END-IF.                                                      01972700
019728                                                                  01972800
019729     INITIALIZE AD-DETAIL-LINE.                                   01972900
019730     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      01973000
019740     INITIALIZE AD-DETAIL-LINE.                                   01974000
019750     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      01975000
019760*2000-EXIT.                                                       01976000
021015                                                                  02101500
021017******************************************************************02101700
021018*                                                                *02101800
021019******************************************************************02101900
021020                                                                  02102000
021030 3000-PROCESS-USER.                                               02103007
021800     MOVE AE-AD-USER-ID TO GE-USER-ID.                            02180007
021940                                                                  02194007
021941     IF (AE-AD-ACCOUNT-NOT-DEFINED)                               02194107
021942         SET GE-UN-NO-DESCRIPTION TO TRUE                         02194215
021943     ELSE                                                         02194307
021944         MOVE AE-AD-USER-NAME TO GE-USER-NAME                     02194415
021945     END-IF.                                                      02194507
021946                                                                  02194614
021947     INITIALIZE GE-ACCOUNT-CATEGORY.                              02194714
021948     IF ((AE-AD-ACCOUNT-NOT-DEFINED)                              02194814
021949             OR (AE-AD-CATEGORY-NOT-DEFINED))                     02194914
021950         SET AE-AD-CATEGORY-UNKNOWN TO TRUE                       02195014
021951     ELSE                                                         02195114
021952         MOVE AE-AD-ACCOUNT-CATEGORY TO GE-ACCOUNT-CATEGORY       02195214
021953     END-IF.                                                      02195314
021954                                                                  02195407
021955     IF (CC-INCLUDE-HR-INFORMATION)                               02195507
021956         SET GE-EMPLOYEE-ID-TAG TO TRUE                           02195614
021957         MOVE AE-AD-EMPLOYEE-ID-X TO GE-EMPLOYEE-ID               02195714
021958         IF ((GE-EMPLOYEE-ID = SPACES)                            02195814
021959                 OR (GE-EMPLOYEE-ID = HIGH-VALUES))               02195914
021960             SET GE-EMPLOYEE-ID-NOT-AVAILABLE TO TRUE             02196014
021961         END-IF                                                   02196107
021962     END-IF.                                                      02196207
021963                                                                  02196309
021966     IF ((PV-LINE-COUNT + PV-ADVANCE-COUNT) > PC-PAGE-SIZE)       02196609
021967         PERFORM 8000-PRINT-TITLE-LINES                           02196709
021970         WRITE AR-AUDIT-REPORT-LINE                               02197009
021971             FROM RU-RACF-USER-GROUP-LINE                         02197109
021972             AFTER ADVANCING PV-ADVANCE-COUNT LINES               02197209
021977         SET PV-AC-DOUBLE-SPACE TO TRUE                           02197709
021981     END-IF.                                                      02198109
021982     WRITE AR-AUDIT-REPORT-LINE                                   02198209
021983         FROM GE-GROUP-EXPANSION-LINE                             02198309
021984         AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  02198409
021985     ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT.                       02198509
021986     SET PV-AC-SINGLE-SPACE TO TRUE.                              02198609
021987     MOVE GE-GROUP-EXPANSION-LINE TO AD-DETAIL-LINE.              02198709
021990     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      02199009
022251                                                                  02225109
022252     SET RU-UG-EXPANSION-CONTINUED TO TRUE.                       02225209
022253                                                                  02225321
022254     INITIALIZE PV-CERTIFICATION-RECORD.                          02225421
022255     STRING PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02225521
022256            AE-AD-USER-ID                       DELIMITED BY SPACE02225621
022257            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02225721
022258            PC-COMMA                            DELIMITED BY SIZE 02225821
022259            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02225921
022260            AE-USER-GROUP                       DELIMITED BY SPACE02226022
022270            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02227021
022280            PC-COMMA                            DELIMITED BY SIZE 02228021
022290            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02229021
022300            AE-USER-GROUP                       DELIMITED BY SPACE02230022
022400            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02240021
022500            PC-COMMA                            DELIMITED BY SIZE 02250021
022600            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02260021
022700            PC-USER-GROUP-CLASS                 DELIMITED BY SPACE02270022
022800            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02280021
022810            PC-COMMA                            DELIMITED BY SIZE 02281021
022820            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02282021
022830            PC-ACCESS-LEVEL-N-A                 DELIMITED BY SPACE02283022
022840            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02284021
022841            PC-COMMA                            DELIMITED BY SIZE 02284121
022842            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02284221
022843            AE-AD-ACCOUNT-CATEGORY              DELIMITED BY SPACE02284321
022844            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 02284421
022845         INTO PV-CERTIFICATION-RECORD.                            02284521
022846     PERFORM 8200-WRITE-CERTIFICATION-RCD.                        02284621
022850*3000-EXIT.                                                       02285000
026357                                                                  02635700
026358******************************************************************02635800
026359*                                                                *02635900
026360******************************************************************02636000
026361                                                                  02636100
026362 7000-READ-EXTRACT-FILE.                                          02636200
026363     READ RACF-AUDIT-EXTRACT-FILE                                 02636300
026364         INTO AE-AUDIT-EXTRACT-FILE-RECORD                        02636400
026365         AT END                                                   02636500
026366             SET PS-END-OF-EXTRACT-FILE TO TRUE                   02636600
026367     END-READ.                                                    02636700
026368*7000-EXIT.                                                       02636800
026369                                                                  02636900
026370******************************************************************02637000
026380*                                                                *02638000
026390******************************************************************02639000
026400                                                                  02640000
026500 7100-READ-RESOURCE-OWNER-FILE.                                   02650000
026600     READ RESOURCE-OWNER-FILE                                     02660000
026700         INTO RO-RESOURCE-OWNER-RCD                               02670000
026800         AT END                                                   02680000
026900             SET PS-END-OF-OWNER-FILE TO TRUE                     02690000
026910     END-READ.                                                    02691000
026920*7100-EXIT.                                                       02692000
026933                                                                  02693300
026934******************************************************************02693400
026935*                                                                *02693500
026936******************************************************************02693600
026937                                                                  02693700
026938 8000-PRINT-TITLE-LINES.                                          02693800
026939     ADD 1 TO PV-PAGE-COUNT.                                      02693900
026940     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     02694000
026950                                                                  02695000
026960     WRITE AR-AUDIT-REPORT-LINE                                   02696000
026970         FROM DP132-STANDRD-HEADER-132-COLS                       02697000
026980         AFTER ADVANCING PAGE.                                    02698000
026990     INITIALIZE DP132-LASER-NEW-PAGE-INDICATR.                    02699000
026991     WRITE AR-AUDIT-REPORT-LINE                                   02699100
026992         FROM HL2-HEADING-LINE-2                                  02699200
026993         AFTER ADVANCING 1 LINE.                                  02699300
026994     MOVE +2 TO PV-LINE-COUNT.                                    02699400
027015                                                                  02701500
027017     SET PV-AC-DOUBLE-SPACE TO TRUE.                              02701700
027018*8000-EXIT.                                                       02701800
027019                                                                  02701900
027020******************************************************************02702000
027030*                                                                *02703000
027040******************************************************************02704000
027050                                                                  02705000
027060 8100-WRITE-AUDIT-DETAIL-RECORD.                                  02706000
027070     WRITE AD-AUDIT-DETAIL-RECORD                                 02707000
027080         FROM AD-AUDIT-DETAIL-RCD.                                02708000
027090*8100-EXIT.                                                       02709000
027091                                                                  02709120
027092******************************************************************02709220
027093*                                                                *02709320
027094******************************************************************02709420
027095                                                                  02709520
027096 8200-WRITE-CERTIFICATION-RCD.                                    02709620
027097     WRITE CF-CERTIFICATION-RECORD                                02709720
027098         FROM PV-CERTIFICATION-RECORD.                            02709820
027099*8200-EXIT.                                                       02709920
027100                                                                  02710000
027200******************************************************************02720000
027300*  CLOSE ALL FILES.                                              *02730000
027400******************************************************************02740000
027500                                                                  02750000
027600 9000-EOJ-ROUTINE.                                                02760000
027700     CLOSE RACF-AUDIT-EXTRACT-FILE                                02770000
027800           RESOURCE-OWNER-FILE                                    02780000
028000           AUDIT-DETAIL-FILE                                      02800000
028010           CERTIFICATION-FILE                                     02801020
028100           AUDIT-REPORT-FILE.                                     02810000
028200*9000-EXIT.                                                       02820000
