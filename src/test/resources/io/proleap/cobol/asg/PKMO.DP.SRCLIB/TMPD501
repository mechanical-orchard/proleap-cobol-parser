      ******************************************************************        
      * TMPD501 USES TM501-PRORATION-ERROR-NBR TO SET UP TM500 RETUR    N CODE  
      ******************************************************************        
       TM501-SET-TM500-RETURN-MSG.                                              
                                                                                
           COMPUTE TM501-WRK-OP-N = TM500-OPER-UNT-ID * 1.                      
           COMPUTE TM501-WRK-FCLTY-N = TM500-FCLTY-ID * 1.                      
           COMPUTE TM501-WRK-PO-N = TM500-PO-NBR * 1.                           
           COMPUTE TM501-WRK-LINE-N = TM500-PO-LNE-NBR * 1.                     
           COMPUTE TM501-WRK-REC-SEQ-NBR-N = TM500-REC-SEQ-NBR * 1.             
                                                                                
           MOVE TM501-WRK-OP          TO TM501-OP.                              
           MOVE TM501-WRK-FCLTY       TO TM501-FCLTY.                           
           MOVE TM501-WRK-PO          TO TM501-PO.                              
           MOVE TM501-WRK-LINE        TO TM501-LINE.                            
           MOVE TM501-WRK-REC-SEQ-NBR TO TM501-REC-SEQ-NBR.                     
                                                                                
           IF TM501-PRORATION-ERROR-NBR > TM501-MAX-ERRORS                      
             OR                                                                 
              TM501-PRORATION-ERROR-NBR < 1                                     
                 MOVE TM501-MAX-ERRORS TO                                       
                    TM501-PRORATION-ERROR-NBR                                   
           END-IF.                                                              
                                                                                
           MOVE TM501-PRORATION-ERROR-NBR                                       
                TO TM501-PRORATION-ERROR-IDX.                                   
                                                                                
           IF TM500-PKGNG-CDE = 'I' OR 'M'                                      
              MOVE PT-PREPACK-ERROR (TM501-PRORATION-ERROR-IDX)                 
                   TO TM500-RETURN-DATA                                         
              MOVE TM501-PRORATION-ERROR-NBR                                    
                   TO TM500-PREPACK-ERROR-NBR                                   
              MOVE TM501-PGM                                                    
                   TO  TM500-PREPACK-PGM-NBR                                    
           ELSE                                                                 
              MOVE PT-BULK-ERROR (TM501-PRORATION-ERROR-IDX)                    
                   TO TM500-RETURN-DATA                                         
           END-IF.                                                              
                                                                                
           MOVE TM500-RETURN-DATA       TO TM501-RC001-LOG-DATA.                
           MOVE TM501-TM500-RETURN-MSG  TO TM500-RETURN-MSG.                    
