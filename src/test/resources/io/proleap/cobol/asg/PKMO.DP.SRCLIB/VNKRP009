000100 IDENTIFICATION DIVISION.                                                 
000200                                                                          
000300 PROGRAM-ID.     VNKRP009.                                                
000400                                                                          
000500 AUTHOR.         CAROLYN GIFFORD.                                         
000600 DATE-WRITTEN.   05/13/99.                                                
000700 DATE-COMPILED.                                                           
000800******************************************************************        
000900*** VENDOR DATABASE ADDS REPORT                                ***        
001000***                                                            ***        
001100*** COBOL 2 WITH SQL                                           ***        
001200***                                                            ***        
001300*** PURPOSE IS TO CREATE A REPORT OF ANY VENDORS ADDED DURING  ***        
001400*** THE PREVIOUS WEEKLY PERIOD.                                ***        
001500***                                                            ***        
001600*** INPUT:                                                     ***        
001700***                                                            ***        
001800***    DB2 TABLES - NEW VENDOR ADD TABLE                       ***        
001900***                                                            ***        
002000*** OUTPUT:                                                    ***        
002100***                                                            ***        
002200***    VENDOR ADD/UPDATE REPORT                                ***        
002300***                                                            ***        
002400******************************************************************        
002500*    CHANGE LOG:                                                 *        
002600*                                                                *        
002700*    05/13/99   INITIAL VERSION                                  *        
002800*               BY: CAROLYN GIFFORD           WR#                *        
002900*                                                                *        
003000*    02/09/00                                                    *        
003100*               USE PREVIOUS WEEK END DATE FROM TAPCNTL TO       *        
003200*               CALCULATE BEGINNING & ENDING DATES FOR REPORT.   *        
003300*               ADDED BEGINNING & ENDING DATES TO CURSOR SO      *        
003400*               ONLY ROWS WHERE AUD_TMST DATE IS BETWEEN THESE   *        
003500*               DATES WILL BE SELECTED.                          *        
003600*               BY: CAROLYN GIFFORD           WR# 20685          *        
003700*                                                                *        
003800*    DATE  03/02/2001                                            *        
003900*                                                                *        
004000*        CHANGE MADE:                                            *        
004100*                                                                *        
004200*        CHANGE PROGRAM LOGIC FOR TABLE 'TVNDTAU' TO DROP 4      *        
004300*        COLUMNS AND ADD 3 NEW COLUMNS.  NO REPORT FORMAT        *        
004400*        CHANGES ARE REQUIRED. REPORT FIELD VALUES WILL BE       *        
004500*        DRAWN FROM THE REPLACEMENT FIELDS                       *        
004600*                                                                *        
004700*        MODIFY THE 'VNDTAU_ADD_CSR' CURSOR TO REMOVE THE OLD    *        
004800*        FIELDS AND REPLACE THEM WITH THE NEW ONES.              *        
004900*                                                                *        
005000*        REPLACE EXISTING 'ORDER BY' WITH PRIM_TYP_CDE    DESC   *        
005100*                                         PRTNR_TYP_CDE   ASC    *        
005200*                                         PRNT_CD_IND_CDE ASC    *        
005300*                                                                *        
005400*        MODIFY FETCH 'VNDTAU_ADD_CSR' CURSOR TO REMOVE THE      *        
005500*        OLD FIELDS AND REPLACE THEM WITH THE NEW ONES.          *        
005600*                                                                *        
005700*        MODIFY DETAIL REPORT LOGIC TO REPLACE THE OLD VALUES    *        
005800*        WITH:                                                   *        
005900*                                                                *        
006000*        PRIMARY TYPE CODE = 'M' -  SET 'DH-VND-TCDE = 'M'       *        
006100*                          ADD +1 TO MERCHANDISE TYPE COUNTER.   *        
006200*                                                                *        
006300*        PRIMARY TYPE CODE = 'F' -  SET 'DH-VND-TCDE = 'F'       *        
006400*                          ADD +1 TO FACTOR TYPE COUNTER.        *        
006500*                                                                *        
006600*        PRIMARY TYPE CODE = 'E' AND PARTER TYPE CODE = 'CR'     *        
006700*                                   SET 'DH-VND-TCDE = 'C'       *        
006800*                          ADD +1 TO CARRIER TYPE COUNTER.       *        
006900*                                                                *        
007000*        PARTER TYPE CODE 'NOT =' 'CR'                           *        
007100*                                   SET 'DH-VND-TCDE = 'E'       *        
007200*                          ADD +1 TO EXPENSE TYPE COUNTER.       *        
007300*                                                                *        
007400*        MADE BY: W. A. EHMKE                        WR# 21278   *        
007500*                                                                *        
007510*        NOTE:                                                   *        
007520*            REPORT 'VNKRP009' HAS NOT BE DOCUMENTED.            *        
007530*                                                                *        
007540*                                                                *        
007600******************************************************************        
007700                                                                          
007800   EJECT                                                                  
007900                                                                          
008000 ENVIRONMENT DIVISION.                                                    
008100 CONFIGURATION SECTION.                                                   
008200                                                                          
008300 SOURCE-COMPUTER.     IBM-3090.                                           
008400 OBJECT-COMPUTER.     IBM-3090.                                           
008500                                                                          
008600 INPUT-OUTPUT SECTION.                                                    
008700                                                                          
008800 FILE-CONTROL.                                                            
008900     SELECT VENDOR-REPORT-FILE           ASSIGN TO UT-S-RPT01.            
009000                                                                          
009100   EJECT                                                                  
009200                                                                          
009300 DATA DIVISION.                                                           
009400                                                                          
009500 FILE SECTION.                                                            
009600                                                                          
009700 FD VENDOR-REPORT-FILE                                                    
009800     LABEL RECORDS ARE STANDARD                                           
009900     RECORDING MODE IS F                                                  
010000     BLOCK CONTAINS 0 RECORDS                                             
010100     RECORD CONTAINS 150 CHARACTERS                                       
010200     DATA RECORD IS VENDOR-REPORT-RECORD.                                 
010300                                                                          
010400 01 VENDOR-REPORT-RECORD                  PIC X(150).                     
010500                                                                          
010600     EJECT                                                                
010700                                                                          
010800 WORKING-STORAGE SECTION.                                                 
010900                                                                          
011000 01  PV-PROGRAM-VARIABLES.                                                
011100     05  PV-MAX-RETRIES            PIC S9(4)   COMP VALUE +3.             
011200     05  PV-RETRY-COUNTER          PIC S9(04)  VALUE +0 COMP SYNC.        
011300     05  PV-UPDATE-COUNT           PIC  9(10)  VALUE ZEROES.              
011400     05  PV-BTCH-TMST              PIC  X(26)  VALUE SPACES.              
011500     05  PV-MIN-UPDATE-DATE        PIC  X(10)  VALUE SPACES.              
011600     05  PV-MIN-UPDATE-CYMD REDEFINES PV-MIN-UPDATE-DATE.                 
011700         10 PV-MIN-UPD-CC          PIC  X(02).                            
011800         10 PV-MIN-UPD-YY          PIC  X(02).                            
011900         10 PV-MIN-UPD-DASH1       PIC  X(01).                            
012000         10 PV-MIN-UPD-MM          PIC  X(02).                            
012100         10 PV-MIN-UPD-DASH2       PIC  X(01).                            
012200         10 PV-MIN-UPD-DD          PIC  X(02).                            
012300     05  PV-MAX-UPDATE-DATE        PIC  X(10)  VALUE SPACES.              
012400     05  PV-MAX-UPDATE-CYMD REDEFINES PV-MAX-UPDATE-DATE.                 
012500         10 PV-MAX-UPD-CC          PIC  X(02).                            
012600         10 PV-MAX-UPD-YY          PIC  X(02).                            
012700         10 PV-MAX-UPD-DASH1       PIC  X(01).                            
012800         10 PV-MAX-UPD-MM          PIC  X(02).                            
012900         10 PV-MAX-UPD-DASH2       PIC  X(01).                            
013000         10 PV-MAX-UPD-DD          PIC  X(02).                            
013100     05  PV-ADD-DATE               PIC  X(10).                            
013200     05  PV-ADD-CYMD REDEFINES PV-ADD-DATE.                               
013300         10 PV-ADD-CC              PIC  X(02).                            
013400         10 PV-ADD-YY              PIC  X(02).                            
013500         10 PV-ADD-DASH1           PIC  X(01).                            
013600         10 PV-ADD-MM              PIC  X(02).                            
013700         10 PV-ADD-DASH2           PIC  X(01).                            
013800         10 PV-ADD-DD              PIC  X(02).                            
013900     05  PV-EDIT-PAYT-TERM-ID      PIC  ZZ9.                              
014000     05  PV-REMIT-ADDR-COUNT       PIC  9(02)  VALUE ZEROES.              
014100     05  PV-TOTAL-ADDRESS-CNT      PIC  9(02)  VALUE ZEROES.              
014200     05  PV-PROGRAM-NAME           PIC  X(08)  VALUE 'VNKRP009'.          
014300     05  PV-CURRENT-DATE.                                                 
014400         10  PV-CURRENT-YEAR       PIC  9(02)  VALUE ZEROS.               
014500         10  PV-CURRENT-MONTH      PIC  9(02)  VALUE ZEROS.               
014600         10  PV-CURRENT-DAY        PIC  9(02)  VALUE ZEROS.               
014700     05  PV-CURRENT-TIME.                                                 
014800         10  PV-CURRENT-HOUR       PIC  9(02)  VALUE ZEROS.               
014900         10  PV-CURRENT-MINUTE     PIC  9(02)  VALUE ZEROS.               
015000         10  FILLER                PIC  9(02)  VALUE ZEROS.               
015100     05 PREV-ENT-ID                PIC S9(09)  COMP VALUE ZEROES.         
015200                                                                          
015300     EJECT                                                                
015400                                                                          
015500 01  WS-MISC-VARIABLES.                                                   
015600     05  WS-CRE-DATE.                                                     
015700         10 WS-CRE-CENT            PIC  X(02).                            
015800         10 WS-CRE-YEAR            PIC  X(02).                            
015900         10 WS-CRE-DASH1           PIC  X(01).                            
016000         10 WS-CRE-MONTH           PIC  X(02).                            
016100         10 WS-CRE-DASH2           PIC  X(01).                            
016200         10 WS-CRE-DAY             PIC  X(02).                            
016300     05  WS-LAST-UPD-DATE.                                                
016400         10 WS-LUPD-CENT           PIC  X(02).                            
016500         10 WS-LUPD-YEAR           PIC  X(02).                            
016600         10 WS-LUPD-DASH1          PIC  X(01).                            
016700         10 WS-LUPD-MONTH          PIC  X(02).                            
016800         10 WS-LUPD-DASH2          PIC  X(01).                            
016900         10 WS-LUPD-DAY            PIC  X(02).                            
017000     05  WS-ADDR-LINE-TABLE.                                              
017100         10  FILLER OCCURS 03 TIMES                                       
017200                INDEXED BY WS-ADDR-IDX.                                   
017300             15  WS-ADDR-LINE           PIC  X(40).                       
017400     05  WS-CITY-STATE-ZIP-LINE         PIC  X(51).                       
017500     05  WS-PAYT-TERM-ID-DESC           PIC X(28).                        
017600     05  WS-BLANK-LINE                  PIC X(151) VALUE SPACES.          
017700     05  WS-ADDR-DELETED                PIC  X(40).                       
017800                                                                          
017900 01  ASC-MISC-VARIABLES.                                                  
018000     05  ASC-PAYT-TERM-ID-DESC          PIC  X(28).                       
018100                                                                          
018200 01  PC-PROGRAM-CONSTANTS.                                                
018300     05  PC-CURRENT-PARAGRAPH    PIC  X(35).                              
018400     05  PC-IN-PROCESS-CODE        PIC  X(01)  VALUE '9'.                 
018500     05  PC-RUN-COMPLETE-CODE      PIC  X(01)  VALUE '0'.                 
018600     05  PC-MAX-LINES              PIC S9(03)  VALUE +66                  
018700                                               COMP-3.                    
018800     05  PC-LINE-COUNT             PIC S9(03)  VALUE +99                  
018900                                               COMP-3.                    
019000     05  PC-PAGE-COUNT             PIC  9(05)  VALUE ZEROES.              
019100                                                                          
019200 01  PC-PROGRAM-COUNTERS.                                                 
019300     05  PC-VUPD-TVNADAU-CNT     PIC  9(10)  VALUE ZEROES.                
019400     05  PC-MERCH-TYP-CNT        PIC  9(09)  VALUE ZEROS.                 
019500     05  PC-EXP-TYP-CNT          PIC  9(09)  VALUE ZEROS.                 
019600     05  PC-CAR-TYP-CNT          PIC  9(09)  VALUE ZEROS.                 
019700     05  PC-FCTR-TYP-CNT         PIC  9(09)  VALUE ZEROS.                 
019800     05  PC-PARENT-TYP-CNT       PIC  9(09)  VALUE ZEROS.                 
019900                                                                          
020000                                                                          
020100 01  PROGRAM-SWITCHES.                                                    
020200     05  PS-OUT-OF-VNDTAU-ROWS-SW   PIC X(01) VALUE 'N'.                  
020300         88  NOT-OUT-OF-VNDTAU-ROWS           VALUE 'N'.                  
020400         88  OUT-OF-VNDTAU-ROWS               VALUE 'Y'.                  
020500     05  PS-OUT-OF-VNADAU-ROWS-SW   PIC X(01) VALUE 'N'.                  
020600         88  NOT-OUT-OF-VNADAU-ROWS           VALUE 'N'.                  
020700         88  OUT-OF-VNADAU-ROWS               VALUE 'Y'.                  
020800     05  PS-VENDOR-AGMT-FOUND-SW    PIC X(01) VALUE 'N'.                  
020900         88  VENDOR-AGMT-FOUND                VALUE 'Y'.                  
021000         88  VENDOR-AGMT-NOT-FOUND            VALUE 'N'.                  
021100     05  PS-END-OF-ADDRESS-SW       PIC X(01) VALUE 'N'.                  
021200         88  END-OF-ADDRESSES                 VALUE 'Y'.                  
021300         88  NOT-END-OF-ADDRESSES             VALUE 'N'.                  
021400                                                                          
021500 01  WS-SQLCODE                      PIC S9(9) COMP-4 VALUE ZERO.         
021600 01  WS-SQLWARN0                     PIC X.                               
021700 01  WS-RETRY-COUNTER                PIC S9(4) COMP VALUE ZERO.           
021800 01  WS-DISPLAY-RETRY-COUNTER        PIC 9(9)  VALUE ZEROS.               
021900                                                                          
022000                                                                          
022100 01  WS-TIMESTAMP            PIC X(26)     VALUE SPACES.                  
022200 01  FILLER REDEFINES WS-TIMESTAMP.                                       
022300     05  FILLER              PIC X(14).                                   
022400     05  WS-MINUTE           PIC X(02).                                   
022500     05  FILLER              PIC X(02).                                   
022600     05  WS-SECOND           PIC X(01).                                   
022700     05  FILLER              PIC X(01).                                   
022800     05  WS-NANOSEC-1-3      PIC X(03).                                   
022900     05  WS-NANOSEC-4-6      PIC X(03).                                   
023000                                                                          
023100 01  WS-RANDOM-KEY           PIC 9(09)     VALUE 0.                       
023200 01  FILLER REDEFINES WS-RANDOM-KEY.                                      
023300     05  WS-RND-NANOSEC-4-6  PIC X(03).                                   
023400     05  WS-RND-NANOSEC-1-3  PIC X(03).                                   
023500     05  WS-RND-MINUTE       PIC X(02).                                   
023600     05  WS-RND-SECOND       PIC X(01).                                   
023700                                                                          
023800 01  WS-RANDOM-KEY-COMP      PIC S9(09)    VALUE 0 COMP.                  
023900                                                                          
024000     EJECT                                                                
024100                                                                          
024200******************************************************************        
024300***              PAY TERMS COPYBOOK                            ***        
024400******************************************************************        
024500                                                                          
024600     COPY POWS020.                                                        
024700                                                                          
024800     EJECT                                                                
024900                                                                          
025000******************************************************************        
025100***                STANDARD HEADER LAYOUT                      ***        
025200******************************************************************        
025300                                                                          
025400     COPY DPWS150O.                                                       
025500                                                                          
025600     EJECT                                                                
025700                                                                          
025800 01  H2-HEADER2.                                                          
025900     05  FILLER                  PIC  X(65) VALUE SPACES.                 
026000     05  FILLER                  PIC  X(18) VALUE                         
026100         'VENDOR ADD REPORT '.                                            
026200                                                                          
026300 01  H2-HEADER3.                                                          
026400     05  FILLER                  PIC  X(60) VALUE SPACES.                 
026500     05  FILLER                  PIC  X(06) VALUE                         
026600         'AS OF '.                                                        
026700     05  H2-BEGIN-MM             PIC  X(02).                              
026800     05  FILLER                  PIC  X(01) VALUE '/'.                    
026900     05  H2-BEGIN-DD             PIC  X(02).                              
027000     05  FILLER                  PIC  X(01) VALUE '/'.                    
027100     05  H2-BEGIN-YY             PIC  X(02).                              
027200     05  FILLER                  PIC  X(09) VALUE ' THROUGH '.            
027300     05  H2-END-MM               PIC  X(02).                              
027400     05  FILLER                  PIC  X(01) VALUE '/'.                    
027500     05  H2-END-DD               PIC  X(02).                              
027600     05  FILLER                  PIC  X(01) VALUE '/'.                    
027700     05  H2-END-YY               PIC  X(02).                              
027800                                                                          
027900     EJECT                                                                
028000                                                                          
028100 01  DH-DETAIL-HEADER1.                                                   
028200     05  FILLER                  PIC   X(01) VALUE SPACES.                
028300     05  FILLER                  PIC   X(07) VALUE 'USER ID'.             
028400     05  FILLER                  PIC   X(05) VALUE SPACES.                
028500     05  FILLER                  PIC   X(06) VALUE 'DATE  '.              
028600                                                                          
028700 01  DH-DETAIL-HEADER2.                                                   
028800     05  FILLER                  PIC   X(01) VALUE SPACES.                
028900     05  DH-USER-ID              PIC   X(08).                             
029000     05  FILLER                  PIC   X(02) VALUE SPACES.                
029100     05  DH-ADD-DTE.                                                      
029200         10  DH-ADD-MM           PIC   X(02).                             
029300         10  FILLER              PIC   X(01) VALUE '/'.                   
029400         10  DH-ADD-DD           PIC   X(02).                             
029500         10  FILLER              PIC   X(01) VALUE '/'.                   
029600         10  DH-ADD-YY           PIC   X(02).                             
029700     05  FILLER                  PIC   X(02) VALUE SPACES.                
029800     05  FILLER                  PIC   X(14) VALUE                        
029900                                   'PRIMARY NAME.:'.                      
030000     05  FILLER                  PIC   X(01) VALUE SPACES.                
030100     05  DH-PRIM-NAME            PIC   X(30).                             
030200     05  FILLER                  PIC   X(02) VALUE SPACES.                
030300     05  FILLER                  PIC   X(16) VALUE                        
030400                                   'STATUS.........:'.                    
030500     05  FILLER                  PIC   X(01) VALUE SPACES.                
030600     05  DH-STATUS               PIC   X(01).                             
030700     05  FILLER                  PIC   X(02) VALUE SPACES.                
030800     05  FILLER                  PIC   X(12) VALUE                        
030900                                   'VENDOR TYPE:'.                        
031000     05  FILLER                  PIC   X(01) VALUE SPACES.                
031100     05  DH-VND-TYP-TABLE.                                                
031200         10  DH-VND-TYPE  OCCURS 5 TIMES                                  
031300                INDEXED BY DH-INDX.                                       
031400            15 DH-VND-TCDE          PIC   X(01).                          
031500     05  FILLER                  PIC   X(02) VALUE SPACES.                
031600     05  FILLER                  PIC   X(14) VALUE                        
031700                                   'PAYMENT TERMS:'.                      
031800     05  FILLER                  PIC   X(01) VALUE SPACES.                
031900     05  DH-PAY-TERMS            PIC   X(28).                             
032000                                                                          
032100     EJECT                                                                
032200                                                                          
032300 01  DH-DETAIL-HEADER2B.                                                  
032400     05  FILLER                  PIC   X(01) VALUE SPACES.                
032500     05  DH-USER-ID-B            PIC   X(08).                             
032600     05  FILLER                  PIC   X(02) VALUE SPACES.                
032700     05  DH-ADD-DTE-B.                                                    
032800         10  DH-ADD-MM-B         PIC   X(02).                             
032900         10  FILLER              PIC   X(01) VALUE '/'.                   
033000         10  DH-ADD-DD-B         PIC   X(02).                             
033100         10  FILLER              PIC   X(01) VALUE '/'.                   
033200         10  DH-ADD-YY-B         PIC   X(02).                             
033300     05  FILLER                  PIC   X(02) VALUE SPACES.                
033400     05  FILLER                  PIC   X(14) VALUE                        
033500                                   'PRIMARY NAME.:'.                      
033600     05  FILLER                  PIC   X(01) VALUE SPACES.                
033700     05  DH-PRIM-NAME-B          PIC   X(30).                             
033800                                                                          
033900     EJECT                                                                
034000                                                                          
034100 01  DH-DETAIL-HEADER3.                                                   
034200     05  FILLER                  PIC   X(21) VALUE SPACES.                
034300     05  FILLER                  PIC   X(14) VALUE                        
034400                                   'USING FACTOR.:'.                      
034500     05  FILLER                  PIC   X(01) VALUE SPACES.                
034600     05  DH-FCTR-IND-CDE         PIC   X(01).                             
034700     05  FILLER                  PIC   X(08) VALUE SPACES.                
034800     05  FILLER                  PIC   X(12) VALUE                        
034900                                   'VENDOR HOLD:'.                        
035000     05  FILLER                  PIC   X(01) VALUE SPACES.                
035100     05  DH-HOLD-IND             PIC   X(01).                             
035200     05  FILLER                  PIC   X(09) VALUE SPACES.                
035300     05  FILLER                  PIC   X(16) VALUE                        
035400                                   'SEPARATE PYMTS.:'.                    
035500     05  FILLER                  PIC   X(01) VALUE SPACES.                
035600     05  DH-SEP-PYMTS            PIC   X(01).                             
035700     05  FILLER                  PIC   X(02) VALUE SPACES.                
035800     05  FILLER                  PIC   X(16) VALUE                        
035900                                   'PYMT HANDLE CDE:'.                    
036000     05  FILLER                  PIC   X(01) VALUE SPACES.                
036100     05  DH-PAY-HNDL-CD          PIC   X(02).                             
036200     05  FILLER                  PIC   X(03) VALUE SPACES.                
036300     05  FILLER                  PIC   X(12) VALUE                        
036400                                   '1099 VENDOR:'.                        
036500     05  FILLER                  PIC   X(01) VALUE SPACES.                
036600     05  DH-1099-IND             PIC   X(01).                             
036700     05  FILLER                  PIC   X(04) VALUE SPACES.                
036800     05  FILLER                  PIC   X(13) VALUE                        
036900                                   'TAX ID.....: '.                       
037000     05  DH-TAX-ID               PIC   X(09).                             
037100                                                                          
037200     EJECT                                                                
037300                                                                          
037400 01  DH-DETAIL-HEADER4.                                                   
037500     05  FILLER                  PIC   X(21) VALUE SPACES.                
037600     05  FILLER                  PIC   X(26) VALUE                        
037700                 '*** REMITTANCE ADDRESS ***'.                            
037800     05  FILLER                  PIC   X(43) VALUE SPACES.                
037900     05  FILLER                  PIC   X(20) VALUE                        
038000                 '*** 1099 ADDRESS ***'.                                  
038100                                                                          
038200 01  DH-DETAIL-HEADER4B.                                                  
038300     05  FILLER                  PIC   X(21) VALUE SPACES.                
038400     05  DH-ADDRESS-TYPE         PIC   X(26).                             
038500                                                                          
038600     EJECT                                                                
038700                                                                          
038800 01  DH-DETAIL-HEADER5.                                                   
038900     05  FILLER                  PIC   X(21) VALUE SPACES.                
039000     05  FILLER                  PIC   X(15) VALUE                        
039100                 'CONTACT NAME.: '.                                       
039200     05  DH-CONTACT-NAME         PIC   X(31) VALUE SPACES.                
039300                                                                          
039400     EJECT                                                                
039500                                                                          
039600 01  DH-DETAIL-HEADER6.                                                   
039700     05  FILLER                  PIC   X(21) VALUE SPACES.                
039800     05  FILLER                  PIC   X(15) VALUE                        
039900                 'EXT VNDR NAME: '.                                       
040000     05  DH-EXT-VND-NAME         PIC   X(40) VALUE SPACES.                
040100     05  FILLER                  PIC   X(13) VALUE SPACES.                
040200     05  FILLER                  PIC   X(15) VALUE                        
040300                 '1099 ALT NAME: '.                                       
040400     05  DH-ALT-1099-NAME        PIC   X(40) VALUE SPACES.                
040500                                                                          
040600 01  DH-DETAIL-HEADER6B.                                                  
040700     05  FILLER                  PIC   X(21) VALUE SPACES.                
040800     05  DH-NAME-TYPE            PIC   X(15).                             
040900     05  DH-NAME                 PIC   X(40) VALUE SPACES.                
041000                                                                          
041100     EJECT                                                                
041200                                                                          
041300 01  DH-DETAIL-HEADER7.                                                   
041400     05  FILLER                  PIC   X(21) VALUE SPACES.                
041500     05  FILLER                  PIC   X(15) VALUE                        
041600                 'ADDRESS......: '.                                       
041700     05  DH-REMIT-ADDRESS1       PIC   X(40) VALUE SPACES.                
041800     05  FILLER                  PIC   X(13) VALUE SPACES.                
041900     05  FILLER                  PIC   X(15) VALUE                        
042000                 'ADDRESS......: '.                                       
042100     05  DH-1099-ADDRESS1        PIC   X(40) VALUE SPACES.                
042200                                                                          
042300 01  DH-DETAIL-HEADER7B.                                                  
042400     05  FILLER                  PIC   X(21) VALUE SPACES.                
042500     05  FILLER                  PIC   X(15) VALUE                        
042600                 'ADDRESS......: '.                                       
042700     05  DH-ADDRESS1             PIC   X(40) VALUE SPACES.                
042800                                                                          
042900     EJECT                                                                
043000                                                                          
043100 01  DH-DETAIL-HEADER8.                                                   
043200     05  FILLER                  PIC   X(36) VALUE SPACES.                
043300     05  DH-REMIT-ADDRESS2       PIC   X(40) VALUE SPACES.                
043400     05  FILLER                  PIC   X(28) VALUE SPACES.                
043500     05  DH-1099-ADDRESS2        PIC   X(40) VALUE SPACES.                
043600                                                                          
043700 01  DH-DETAIL-HEADER8B.                                                  
043800     05  FILLER                  PIC   X(36) VALUE SPACES.                
043900     05  DH-ADDRESS2             PIC   X(40) VALUE SPACES.                
044000                                                                          
044100     EJECT                                                                
044200                                                                          
044300 01  DH-DETAIL-HEADER9.                                                   
044400     05  FILLER                  PIC   X(36) VALUE SPACES.                
044500     05  DH-REMIT-ADDRESS3       PIC   X(40) VALUE SPACES.                
044600     05  FILLER                  PIC   X(28) VALUE SPACES.                
044700     05  DH-1099-ADDRESS3        PIC   X(40) VALUE SPACES.                
044800                                                                          
044900 01  DH-DETAIL-HEADER9B.                                                  
045000     05  FILLER                  PIC   X(36) VALUE SPACES.                
045100     05  DH-ADDRESS3             PIC   X(40) VALUE SPACES.                
045200                                                                          
045300     EJECT                                                                
045400                                                                          
045500 01  DH-DETAIL-HEADER10.                                                  
045600     05  FILLER                  PIC   X(36) VALUE SPACES.                
045700     05  DH-REMIT-CTY-ST-ZIP     PIC   X(40) VALUE SPACES.                
045800     05  FILLER                  PIC   X(28) VALUE SPACES.                
045900     05  DH-1099-CTY-ST-ZIP      PIC   X(40) VALUE SPACES.                
046000                                                                          
046100 01  DH-DETAIL-HEADER10B.                                                 
046200     05  FILLER                  PIC   X(36) VALUE SPACES.                
046300     05  DH-CTY-ST-ZIP-CNTRY     PIC   X(40) VALUE SPACES.                
046400                                                                          
046500     EJECT                                                                
046600                                                                          
046700 01  DH-DETAIL-HEADER11.                                                  
046800     05  FILLER                  PIC   X(21) VALUE SPACES.                
046900     05  FILLER                  PIC   X(15) VALUE                        
047000                 'ATTN TO......: '.                                       
047100     05  DH-REMIT-ATTN-TO        PIC   X(40) VALUE SPACES.                
047200     05  FILLER                  PIC   X(13) VALUE SPACES.                
047300     05  FILLER                  PIC   X(15) VALUE                        
047400                 'ATTN TO......: '.                                       
047500     05  DH-1099-ATTN-TO         PIC   X(40) VALUE SPACES.                
047600                                                                          
047700 01  DH-DETAIL-HEADER11B.                                                 
047800     05  FILLER                  PIC   X(21) VALUE SPACES.                
047900     05  FILLER                  PIC   X(15) VALUE                        
048000                 'ATTN TO......: '.                                       
048100     05  DH-ATTN-TO              PIC   X(40) VALUE SPACES.                
048200                                                                          
048300     EJECT                                                                
048400                                                                          
048500 01  TL-TOTAL-LINE1.                                                      
048600     05  FILLER                  PIC   X(62) VALUE SPACES.                
048700     05  FILLER                  PIC   X(28) VALUE                        
048800                            'MERCHANDISE VENDORS ADDED = '.               
048900     05  TL-VND-COUNT1           PIC   ZZZ,ZZZ,ZZ9 VALUE ZEROES.          
049000                                                                          
049100 01  TL-TOTAL-LINE2.                                                      
049200     05  FILLER                  PIC   X(62) VALUE SPACES.                
049300     05  FILLER                  PIC   X(28) VALUE                        
049400                            '    EXPENSE VENDORS ADDED = '.               
049500     05  TL-VND-COUNT2           PIC   ZZZ,ZZZ,ZZ9 VALUE ZEROES.          
049600                                                                          
049700 01  TL-TOTAL-LINE3.                                                      
049800     05  FILLER                  PIC   X(62) VALUE SPACES.                
049900     05  FILLER                  PIC   X(28) VALUE                        
050000                            '    CARRIER VENDORS ADDED = '.               
050100     05  TL-VND-COUNT3           PIC   ZZZ,ZZZ,ZZ9 VALUE ZEROES.          
050200                                                                          
050300 01  TL-TOTAL-LINE4.                                                      
050400     05  FILLER                  PIC   X(62) VALUE SPACES.                
050500     05  FILLER                  PIC   X(28) VALUE                        
050600                            '     FACTOR VENDORS ADDED = '.               
050700     05  TL-VND-COUNT4           PIC   ZZZ,ZZZ,ZZ9 VALUE ZEROES.          
050800                                                                          
050900 01  TL-TOTAL-LINE5.                                                      
051000     05  FILLER                  PIC   X(62) VALUE SPACES.                
051100     05  FILLER                  PIC   X(28) VALUE                        
051200                            '     PARENT VENDORS ADDED = '.               
051300     05  TL-VND-COUNT5           PIC   ZZZ,ZZZ,ZZ9 VALUE ZEROES.          
051400                                                                          
051500     EJECT                                                                
051600                                                                          
051700******************************************************************        
051800*  COMMUNICATIONS AREA2 FOR DB2                                  *        
051900******************************************************************        
052000                                                                          
052100     COPY SQLCA2.                                                         
052200                                                                          
052300     EXEC SQL                                                             
052400         INCLUDE SQLCA                                                    
052500     END-EXEC.                                                            
052600                                                                          
052700     EJECT                                                                
052800                                                                          
052900******************************************************************        
053000*           DCLGEN FOR VENDOR BUSINESS LOCATION TABLE            *        
053100******************************************************************        
053200                                                                          
053300     EXEC SQL                                                             
053400         INCLUDE TBUSLOC                                                  
053500     END-EXEC.                                                            
053600                                                                          
053700     EJECT                                                                
053800                                                                          
053900******************************************************************        
054000*           DCLGEN FOR AP CONTROL TABLE                          *        
054100******************************************************************        
054200                                                                          
054300     EXEC SQL                                                             
054400         INCLUDE TAPCNTL                                                  
054500     END-EXEC.                                                            
054600                                                                          
054700     EJECT                                                                
054800                                                                          
054900******************************************************************        
055000***     DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE NAME TABLE   ***        
055100******************************************************************        
055200                                                                          
055300     EXEC SQL                                                             
055400          INCLUDE TENTNME                                                 
055500     END-EXEC.                                                            
055600                                                                          
055700     EJECT                                                                
055800                                                                          
055900******************************************************************        
056000*           DCLGEN FOR VENDOR ADDRESS ADD/UPDATE TABLE           *        
056100******************************************************************        
056200                                                                          
056300     EXEC SQL                                                             
056400         INCLUDE TVNADAU                                                  
056500     END-EXEC.                                                            
056600                                                                          
056700     EJECT                                                                
056800                                                                          
056900******************************************************************        
057000*           DCLGEN FOR VENDOR DETAIL ADD/UPDATE TABLE            *        
057100******************************************************************        
057200                                                                          
057300     EXEC SQL                                                             
057400         INCLUDE TVNDTAU                                                  
057500     END-EXEC.                                                            
057600                                                                          
057700     EJECT                                                                
057800                                                                          
057900******************************************************************        
058000*           DCLGEN FOR VENDOR AGREEMENT TABLE                    *        
058100******************************************************************        
058200                                                                          
058300     EXEC SQL                                                             
058400         INCLUDE TVNDAGR                                                  
058500     END-EXEC.                                                            
058600                                                                          
058700     EJECT                                                                
058800                                                                          
058900******************************************************************        
059000*           DCLGEN FOR PAYMENT TERMS TABLE                       *        
059100******************************************************************        
059200                                                                          
059300     EXEC SQL                                                             
059400         INCLUDE TPAYTRM                                                  
059500     END-EXEC.                                                            
059600                                                                          
059700     EJECT                                                                
059800                                                                          
059900******************************************************************        
060000*  VNDTAU ADD CURSOR -                                           *        
060100*                                                                *        
060200*  THIS CURSOR IS USED TO SELECT NEW VENDORS ADDED FROM THE      *        
060300*  VENDOR DETAIL HISTORY TABLE.                                  *        
060400*                                                                *        
060500******************************************************************        
060600                                                                          
060700     EXEC SQL                                                             
060800        DECLARE VNDTAU_ADD_CSR CURSOR WITH HOLD FOR                       
060900           SELECT ENT_ID                                                  
061000                 ,DATE(AUD_TMST)                                          
061100                 ,LAST_UPD_BY_USR_ID                                      
061200                 ,VND_NM                                                  
061300                 ,STAT_CDE                                                
061400                 ,PRNT_CO_IND_CDE                                         
061500                 ,PAY_FCTR_IND_CDE                                        
061600                 ,HLD_PAYT_IND_CDE                                        
061700                 ,SEPR_INVC_IND_CDE                                       
061800                 ,PAYT_HNDLG_CDE                                          
061900                 ,NEED_1099_IND_CDE                                       
062000                 ,FED_TX_ID_NBR                                           
062100                 ,PRIM_TYP_CDE                                            
062200                 ,PRTNR_TYP_CDE                                           
062300           FROM   TVNDTAU                                                 
062400           WHERE AUD_FUNC_CDE = 'A'                                       
062500            AND  DATE(AUD_TMST) <= :PV-MAX-UPDATE-DATE                    
062600            AND  DATE(AUD_TMST) >= :PV-MIN-UPDATE-DATE                    
062700           ORDER BY PRIM_TYP_CDE    DESC                                  
062800                   ,PRTNR_TYP_CDE   ASC                                   
062900                   ,PRNT_CO_IND_CDE ASC                                   
063000                   ,VND_NM          ASC                                   
063100     END-EXEC.                                                            
063200                                                                          
063300     EJECT                                                                
063400                                                                          
063500******************************************************************        
063600*  VNADAU ADD CURSOR -                                           *        
063700*                                                                *        
063800*  THIS CURSOR IS USED TO SELECT NEW VENDOR ADDRESSES ADDED FROM *        
063900*  THE VENDOR ADDRESS HISTORY TABLE.                             *        
064000*                                                                *        
064100******************************************************************        
064200                                                                          
064300     EXEC SQL                                                             
064400        DECLARE VNADAU_ADD_CSR CURSOR WITH HOLD FOR                       
064500           SELECT ENT_ID                                                  
064600                 ,SEQ_NBR                                                 
064700                 ,REP_1ST_NM                                              
064800                 ,REP_LAST_NM                                             
064900                 ,EXTD_VND_NM                                             
065000                 ,VND_1ST_LNE_ADDR                                        
065100                 ,VND_2ND_LNE_ADDR                                        
065200                 ,VND_3RD_LNE_ADDR                                        
065300                 ,CTY_NM                                                  
065400                 ,ST_PROV_CDE                                             
065500                 ,ZIP_CDE                                                 
065600                 ,CNTRY_CDE                                               
065700                 ,ATTN_TO_TXT                                             
065800           FROM   TVNADAU                                                 
065900           WHERE AUD_FUNC_CDE = 'A' AND                                   
066000                   ENT_ID = :VNDTAU-ENT-ID AND                            
066100                  DATE(AUD_TMST) = :PV-ADD-DATE                           
066200           FOR UPDATE OF AUD_FUNC_CDE                                     
066300     END-EXEC.                                                            
066400                                                                          
066500     EJECT                                                                
066600                                                                          
066700******************************************************************        
066800*  VNADAU ADD CURSOR 2 -                                         *        
066900*                                                                *        
067000*  THIS CURSOR IS USED TO SELECT NEW VENDOR ADDRESS ONLY ADDS    *        
067100*  FROM THE VENDOR ADDRESS HISTORY TABLE                         *        
067200*                                                                *        
067300******************************************************************        
067400                                                                          
067500     EXEC SQL                                                             
067600        DECLARE VNADAU_ADD_CSR2 CURSOR WITH HOLD FOR                      
067700           SELECT ENT_ID                                                  
067800                 ,SEQ_NBR                                                 
067900                 ,LAST_UPD_BY_USR_ID                                      
068000                 ,REP_1ST_NM                                              
068100                 ,REP_LAST_NM                                             
068200                 ,EXTD_VND_NM                                             
068300                 ,VND_1ST_LNE_ADDR                                        
068400                 ,VND_2ND_LNE_ADDR                                        
068500                 ,VND_3RD_LNE_ADDR                                        
068600                 ,CTY_NM                                                  
068700                 ,ST_PROV_CDE                                             
068800                 ,ZIP_CDE                                                 
068900                 ,CNTRY_CDE                                               
069000                 ,ATTN_TO_TXT                                             
069100           FROM   TVNADAU                                                 
069200           WHERE AUD_FUNC_CDE = 'A'                                       
069300            AND  DATE(AUD_TMST) <= :PV-MAX-UPDATE-DATE                    
069400            AND  DATE(AUD_TMST) >= :PV-MIN-UPDATE-DATE                    
069500     END-EXEC.                                                            
069600                                                                          
069700     EJECT                                                                
069800                                                                          
069900******************************************************************        
070000***    DECLARE TVNDAGR TABLE CURSOR                            ***        
070100******************************************************************        
070200                                                                          
070300     EXEC SQL                                                             
070400        DECLARE VNDR_AGRMT_CSR CURSOR WITH HOLD FOR                       
070500         SELECT MIN(SEQ_NBR)                                              
070600               ,PAYT_TERM_ID                                              
070700         FROM   TVNDAGR                                                   
070800         WHERE ENT_ID = :VNDTAU-ENT-ID AND                                
070900              CURRENT DATE BETWEEN EFFECTIVE_DATE AND                     
071000              EXPIRATION_DATE AND AGRMT_TYP_ID = '2'                      
071100         GROUP BY PAYT_TERM_ID                                            
071200     END-EXEC.                                                            
071300                                                                          
071400     EJECT                                                                
071500                                                                          
071600******************************************************************        
071700*  ABEND DATA AREAS                                              *        
071800******************************************************************        
071900                                                                          
072000 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS                  
072100                                             COMP SYNC.                   
072200     88  AC-DB2-ERROR                        VALUE +4013.                 
072300     88  AC-DATE-ERROR                       VALUE +4019.                 
072400                                                                          
072500 01  ABEND-AREAS.                                                         
072600     05  AA-ABEND-LIT            PIC  X(40)  VALUE                        
072700          '*****       ABEND'.                                            
072800     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                        
072900          '*****   PROGRAM: VNKRP009'.                                    
073000     05  AA-PARAGRAPH-LIT.                                                
073100         10  FILLER              PIC  X(17)  VALUE                        
073200          '***** PARAGRAPH: '.                                            
073300         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.                
073400     05  AA-MESSAGE-LINE.                                                 
073500         10  FILLER              PIC  X(06)  VALUE '*****'.               
073600         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.                
073700     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                        
073800           '*****    DB2 ERROR'.                                          
073900     05  AA-DB2-OPERATION-LIT.                                            
074000         10  FILLER              PIC  X(17)  VALUE                        
074100           '***** OPERATION: '.                                           
074200         10  AA-DB2-OPERATION.                                            
074300             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.                
074400             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.                
074500     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.                
074600     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.                
074700     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.                
074800                                                                          
074900     EJECT                                                                
075000                                                                          
075100     COPY DPWS004.                                                        
075200                                                                          
075300 01  FILLER                      PIC  X(25)  VALUE                        
075400     '** END OF VNKRP009 W/S **'.                                         
075500                                                                          
075600     EJECT                                                                
075700                                                                          
075800 PROCEDURE DIVISION.                                                      
075900                                                                          
076000 0000-MAIN.                                                               
076100                                                                          
076200     PERFORM 1000-INITIALIZE.                                             
076300                                                                          
076400     PERFORM 7100-OPEN-VNDTAU-ADD-CSR.                                    
076500     PERFORM 2000-PROCESS-VENDOR-ADDS UNTIL OUT-OF-VNDTAU-ROWS.           
076600     PERFORM 7200-CLOSE-VNDTAU-ADD-CSR.                                   
076700                                                                          
076800     SET NOT-END-OF-ADDRESSES TO TRUE.                                    
076900     PERFORM 7700-OPEN-VNADAU-ADD-CSR2.                                   
077000     PERFORM 2600-PROCESS-ADDRESS-ADDS UNTIL END-OF-ADDRESSES.            
077100     PERFORM 7800-CLOSE-VNADAU-ADD-CSR2.                                  
077200                                                                          
077300     PERFORM 6100-WRITE-TOTAL-LINES.                                      
077400                                                                          
077500     PERFORM 3000-END-PROGRAM.                                            
077600                                                                          
077700     GOBACK.                                                              
077800                                                                          
077900     EJECT                                                                
078000                                                                          
078100******************************************************************        
078200*    INITIALIZATION PROCESSING                                   *        
078300*    - GET CURRENT DATE & CALCULATE WEEK BEGIN DATE              *        
078400******************************************************************        
078500                                                                          
078600 1000-INITIALIZE.                                                         
078700                                                                          
078800     OPEN OUTPUT VENDOR-REPORT-FILE.                                      
078900                                                                          
079000     INITIALIZE DCLTVNDTAU                                                
079100                DCLTVNADAU                                                
079200                PV-UPDATE-COUNT                                           
079300                PC-VUPD-TVNADAU-CNT                                       
079400                WS-BLANK-LINE                                             
079500                VENDOR-REPORT-RECORD                                      
079600                DH-ALT-1099-NAME                                          
079700                DH-DETAIL-HEADER8                                         
079800                DH-DETAIL-HEADER9                                         
079900                DH-DETAIL-HEADER10                                        
080000                PC-PROGRAM-COUNTERS                                       
080100                WS-ADDR-DELETED.                                          
080200                                                                          
080300     MOVE ZEROES TO PREV-ENT-ID.                                          
080400     SET NOT-OUT-OF-VNDTAU-ROWS                                           
080500         NOT-OUT-OF-VNADAU-ROWS TO TRUE.                                  
080600                                                                          
080700     ACCEPT PV-CURRENT-DATE FROM DATE.                                    
080800     MOVE PV-CURRENT-MONTH            TO DP150O-RUN-MONTH.                
080900     MOVE PV-CURRENT-DAY              TO DP150O-RUN-DAY.                  
081000     MOVE PV-CURRENT-YEAR             TO DP150O-RUN-YEAR.                 
081100                                                                          
081200     ACCEPT PV-CURRENT-TIME FROM TIME.                                    
081300     MOVE PV-CURRENT-HOUR             TO DP150O-RUN-HOUR.                 
081400     MOVE PV-CURRENT-MINUTE           TO DP150O-RUN-MINUTE.               
081500     MOVE PV-PROGRAM-NAME             TO DP150O-PROGRAM-NAME.             
081600     MOVE 1                           TO DP150O-REPORT-NUMBER.            
081700                                                                          
081800     PERFORM 7070-GET-RPT-BEG-END-DATE.                                   
081900     MOVE PV-MAX-UPD-MM   TO   H2-END-MM.                                 
082000     MOVE PV-MAX-UPD-DD   TO   H2-END-DD.                                 
082100     MOVE PV-MAX-UPD-YY   TO   H2-END-YY.                                 
082200                                                                          
082300     MOVE PV-MIN-UPD-MM   TO   H2-BEGIN-MM.                               
082400     MOVE PV-MIN-UPD-DD   TO   H2-BEGIN-DD.                               
082500     MOVE PV-MIN-UPD-YY   TO   H2-BEGIN-YY.                               
082600                                                                          
082700     PERFORM 6000-WRITE-REPORT-HEADERS.                                   
082800                                                                          
082900     EJECT                                                                
083000                                                                          
083100******************************************************************        
083200*                                                                *        
083300* FETCH A VENDOR DETAIL HISTORY ROW THEN FETCH ALL REMIT/1099    *        
083400* ADDRESSES ADDED FOR THIS VENDOR. WRITE REPORT LINES FOR EACH   *        
083500* VENDOR/ADDRESS UNTIL THERE ARE NO MORE ADDRESSES FOUND IN THE  *        
083600* VENDOR ADDRESS HISTORY TABLE.                                  *        
083700*                                                                *        
083800******************************************************************        
083900                                                                          
084000 2000-PROCESS-VENDOR-ADDS.                                                
084100                                                                          
084200     PERFORM 7050-FETCH-VNDTAU-ADD-CSR.                                   
084300                                                                          
084400     IF NOT-OUT-OF-VNDTAU-ROWS                                            
084500        MOVE ZEROES TO PV-REMIT-ADDR-COUNT                                
084600        MOVE ZEROES TO PV-TOTAL-ADDRESS-CNT                               
084700        INITIALIZE WS-ADDR-LINE-TABLE                                     
084800        SET NOT-END-OF-ADDRESSES TO TRUE                                  
084900        PERFORM 4000-MOVES-TO-ADD-DETAIL                                  
085000        PERFORM 7300-OPEN-VNADAU-ADD-CSR                                  
085100        PERFORM 2500-GET-ADDRESS-ROWS UNTIL END-OF-ADDRESSES              
085200        PERFORM 7400-CLOSE-VNADAU-ADD-CSR                                 
085300        IF PV-TOTAL-ADDRESS-CNT = ZEROES                                  
085400           PERFORM 5000-WRITE-ADD-REPORT-LINES.                           
085500                                                                          
085600     EJECT                                                                
085700                                                                          
085800 2500-GET-ADDRESS-ROWS.                                                   
085900                                                                          
086000     PERFORM 7060-FETCH-VNADAU-ADD-CSR.                                   
086100                                                                          
086200     IF END-OF-ADDRESSES                                                  
086300       IF WS-ADDR-LINE-TABLE > SPACES                                     
086400          PERFORM 5000-WRITE-ADD-REPORT-LINES                             
086500       END-IF                                                             
086600     ELSE                                                                 
086700       ADD 1 TO PV-TOTAL-ADDRESS-CNT                                      
086800       PERFORM 7090-SELECT-TBUSLOC-ROW                                    
086900       IF BUSLOC-FUNCTION-ID = 9                                          
087000         ADD 1 TO PV-REMIT-ADDR-COUNT                                     
087100                                                                          
087200** WHEN A SECOND REMIT ADDRESS IS FOUND WRITE OUT REPORT LINES FOR        
087300** PREVIOUS REMIT ADDRESS THEN MOVE SECOND REMIT ADDRESS FIELDS TO        
087400** DETAIL LINES.                                                          
087500                                                                          
087600         IF PV-REMIT-ADDR-COUNT > 1                                       
087700           PERFORM 5000-WRITE-ADD-REPORT-LINES                            
087800           PERFORM 4100-MOVES-TO-ADDR-DETAIL                              
087900         ELSE                                                             
088000           PERFORM 4100-MOVES-TO-ADDR-DETAIL                              
088100** WRITE TO REPORT AFTER 1099 ADDRESS & REMIT ADDRESS FOUND               
088200           IF (DH-REMIT-ADDRESS1 > SPACES AND                             
088300              DH-1099-ADDRESS1 > SPACES) OR                               
088400              (DH-REMIT-ADDRESS2 > SPACES AND                             
088500              DH-1099-ADDRESS2 > SPACES) OR                               
088600              (DH-REMIT-ADDRESS3 > SPACES AND                             
088700              DH-1099-ADDRESS3 > SPACES) OR                               
088800              (DH-REMIT-CTY-ST-ZIP > SPACES AND                           
088900              DH-1099-CTY-ST-ZIP > SPACES)                                
089000              PERFORM 5000-WRITE-ADD-REPORT-LINES                         
089100           END-IF                                                         
089200         END-IF                                                           
089300       ELSE                                                               
089400         PERFORM 4100-MOVES-TO-ADDR-DETAIL                                
089500** WRITE TO REPORT AFTER 1099 ADDRESS & REMIT ADDRESS FOUND               
089600         IF (DH-REMIT-ADDRESS1 > SPACES AND                               
089700            DH-1099-ADDRESS1 > SPACES) OR                                 
089800            (DH-REMIT-ADDRESS2 > SPACES AND                               
089900            DH-1099-ADDRESS2 > SPACES) OR                                 
090000            (DH-REMIT-ADDRESS3 > SPACES AND                               
090100            DH-1099-ADDRESS3 > SPACES) OR                                 
090200            (DH-REMIT-CTY-ST-ZIP > SPACES AND                             
090300            DH-1099-CTY-ST-ZIP > SPACES)                                  
090400            PERFORM 5000-WRITE-ADD-REPORT-LINES                           
090500         END-IF                                                           
090600       END-IF                                                             
090700       PERFORM 7065-UPDATE-TVNADAU.                                       
090800                                                                          
090900     EJECT                                                                
091000                                                                          
091100 2600-PROCESS-ADDRESS-ADDS.                                               
091200     PERFORM 7075-FETCH-VNADAU-ADD-CSR2.                                  
091300                                                                          
091400     IF NOT-END-OF-ADDRESSES                                              
091500       PERFORM 7085-SELECT-VENDOR-TENTNME                                 
091600       PERFORM 7090-SELECT-TBUSLOC-ROW                                    
091700       PERFORM 4200-MOVES-TO-ADDRESS-ONLY                                 
091800       PERFORM 5500-WRITE-ADD-RPT-ADDRESS.                                
091900                                                                          
092000     EJECT                                                                
092100                                                                          
092200******************************************************************        
092300*    ENDING PROCESSING: DISPLAY BEGIN & END DATES CALCULATED &   *        
092400*    CLOSE FILES.                                                *        
092500******************************************************************        
092600                                                                          
092700 3000-END-PROGRAM.                                                        
092800                                                                          
092900     CLOSE  VENDOR-REPORT-FILE.                                           
093000                                                                          
093100     DISPLAY '*****   RECORD COUNTS FROM VNKRP009    ******'.             
093200     DISPLAY '*****   RECORD COUNTS FROM VNKRP009    ******'.             
093300     DISPLAY '---------------------------------------------'.             
093400     DISPLAY 'CALCULATED WEEK BEGIN DATE => ' PV-MIN-UPDATE-DATE.         
093500     DISPLAY 'CALCULATED WEEK END DATE => ' PV-MAX-UPDATE-DATE.           
093600     DISPLAY 'ADDRESS DETAIL ROWS UPDATED =>' PC-VUPD-TVNADAU-CNT.        
093700     DISPLAY '                                             '.             
093800                                                                          
093900     EJECT                                                                
094000                                                                          
094100 4000-MOVES-TO-ADD-DETAIL.                                                
094200                                                                          
094300     MOVE VNDTAU-LAST-UPD-BY-USR-ID     TO DH-USER-ID.                    
094400     MOVE PV-ADD-MM                     TO DH-ADD-MM.                     
094500     MOVE PV-ADD-DD                     TO DH-ADD-DD.                     
094600     MOVE PV-ADD-YY                     TO DH-ADD-YY.                     
094700     MOVE VNDTAU-VND-NM                 TO DH-PRIM-NAME.                  
094800     MOVE VNDTAU-STAT-CDE               TO DH-STATUS.                     
094900                                                                          
095000     INITIALIZE DH-VND-TYP-TABLE.                                         
095100                                                                          
095200     SET DH-INDX TO +1.                                                   
095300                                                                          
095400     IF VNDTAU-PRIM-TYP-CDE     = 'M'                                     
095500        MOVE 'M'                    TO DH-VND-TCDE (DH-INDX)              
095600        ADD 1                       TO PC-MERCH-TYP-CNT                   
095700        SET DH-INDX UP BY +1                                              
095800     END-IF.                                                              
095900                                                                          
096000     IF VNDTAU-PRIM-TYP-CDE = 'F'                                         
096100        MOVE 'F'                    TO DH-VND-TCDE (DH-INDX)              
096200        ADD 1                       TO PC-FCTR-TYP-CNT                    
096300        SET DH-INDX UP BY +1                                              
096400     END-IF.                                                              
096500                                                                          
096600     IF VNDTAU-PRIM-TYP-CDE = 'E'                                         
096700         IF VNDTAU-PRTNR-TYP-CDE = 'CR'                                   
096800             MOVE 'C'               TO DH-VND-TCDE (DH-INDX)              
096900             ADD 1                  TO PC-CAR-TYP-CNT                     
097000             SET DH-INDX UP BY +1                                         
097100         ELSE                                                             
097200             MOVE 'E'               TO DH-VND-TCDE (DH-INDX)              
097300             ADD 1                  TO PC-EXP-TYP-CNT                     
097400             SET DH-INDX UP BY +1                                         
097500         END-IF                                                           
097600     END-IF.                                                              
097700                                                                          
097800     IF VNDTAU-PRNT-CO-IND-CDE = 'Y'                                      
097900        MOVE 'P'                    TO DH-VND-TCDE (DH-INDX)              
098000        ADD 1                       TO PC-PARENT-TYP-CNT                  
098100     END-IF.                                                              
098200                                                                          
098300     SET VENDOR-AGMT-NOT-FOUND TO TRUE.                                   
098400     PERFORM 7500-OPEN-VNDR-AGRMT-CSR.                                    
098500     PERFORM 7095-FETCH-VNDAGR-CSR.                                       
098600     PERFORM 7600-CLOSE-VNDR-AGRMT-CSR.                                   
098700                                                                          
098800     IF VENDOR-AGMT-FOUND                                                 
098900       PERFORM 7055-GET-PAYTERMS                                          
099000     END-IF.                                                              
099100                                                                          
099200     IF VENDOR-AGMT-NOT-FOUND OR DH-PAY-TERMS = SPACES                    
099300       MOVE 'VENDOR AGREEMENT NOT FOUND ' TO DH-PAY-TERMS                 
099400     ELSE                                                                 
099500       PERFORM 4500-FORMAT-PAYMENT-TERM-DESC                              
099600     END-IF.                                                              
099700                                                                          
099800     MOVE VNDTAU-PAY-FCTR-IND-CDE           TO DH-FCTR-IND-CDE.           
099900     MOVE VNDTAU-HLD-PAYT-IND-CDE           TO DH-HOLD-IND.               
100000     MOVE VNDTAU-SEPR-INVC-IND-CDE          TO DH-SEP-PYMTS.              
100100     MOVE VNDTAU-PAYT-HNDLG-CDE             TO DH-PAY-HNDL-CD.            
100200     MOVE VNDTAU-NEED-1099-IND-CDE          TO DH-1099-IND.               
100300     MOVE VNDTAU-FED-TX-ID-NBR              TO DH-TAX-ID.                 
100400                                                                          
100500     EJECT                                                                
100600                                                                          
100700 4100-MOVES-TO-ADDR-DETAIL.                                               
100800                                                                          
100900     INITIALIZE WS-ADDR-LINE-TABLE                                        
101000                WS-CITY-STATE-ZIP-LINE.                                   
101100     SET WS-ADDR-IDX TO +1.                                               
101200                                                                          
101300** ADDRESS LINE 1 ************************************************        
101400     IF VNADAU-VND-1ST-LNE-ADDR = SPACES                                  
101500         CONTINUE                                                         
101600     ELSE                                                                 
101700         MOVE VNADAU-VND-1ST-LNE-ADDR                                     
101800              TO WS-ADDR-LINE (WS-ADDR-IDX)                               
101900         SET WS-ADDR-IDX UP BY +1                                         
102000     END-IF.                                                              
102100                                                                          
102200** ADDRESS LINE 2 ************************************************        
102300     IF VNADAU-VND-2ND-LNE-ADDR = SPACES                                  
102400         CONTINUE                                                         
102500     ELSE                                                                 
102600         MOVE VNADAU-VND-2ND-LNE-ADDR                                     
102700              TO WS-ADDR-LINE (WS-ADDR-IDX)                               
102800         SET WS-ADDR-IDX UP BY +1                                         
102900     END-IF.                                                              
103000                                                                          
103100** ADDRESS LINE 3 ************************************************        
103200     IF VNADAU-VND-3RD-LNE-ADDR = SPACES                                  
103300         CONTINUE                                                         
103400     ELSE                                                                 
103500         MOVE VNADAU-VND-3RD-LNE-ADDR                                     
103600              TO WS-ADDR-LINE (WS-ADDR-IDX)                               
103700         SET WS-ADDR-IDX UP BY +1                                         
103800     END-IF.                                                              
103900                                                                          
104000** CITY STATE ZIP PROVINCE COUNTRY *******************************        
104100     STRING                                                               
104200         VNADAU-CTY-NM DELIMITED BY '  '                                  
104300         ' ' DELIMITED BY SIZE                                            
104400         VNADAU-ST-PROV-CDE DELIMITED BY '  '                             
104500         ' ' DELIMITED BY SIZE                                            
104600         VNADAU-ZIP-CDE DELIMITED BY '  '                                 
104700         ' ' DELIMITED BY SIZE                                            
104800         VNADAU-CNTRY-CDE DELIMITED BY '  '                               
104900     INTO WS-CITY-STATE-ZIP-LINE.                                         
105000                                                                          
105100     IF WS-ADDR-DELETED > SPACES                                          
105200       MOVE WS-ADDR-DELETED TO DH-ADDRESS1                                
105300       MOVE SPACES TO WS-ADDR-DELETED                                     
105400     ELSE                                                                 
105500     IF BUSLOC-FUNCTION-ID = 16                                           
105600       MOVE BUSLOC-ALT-1099-VND-NM         TO DH-ALT-1099-NAME            
105700       MOVE WS-ADDR-LINE (1)               TO DH-1099-ADDRESS1            
105800       MOVE WS-ADDR-LINE (2)               TO DH-1099-ADDRESS2            
105900       MOVE WS-ADDR-LINE (3)               TO DH-1099-ADDRESS3            
106000       MOVE WS-CITY-STATE-ZIP-LINE         TO DH-1099-CTY-ST-ZIP          
106100       MOVE VNADAU-ATTN-TO-TXT             TO DH-1099-ATTN-TO             
106200     ELSE                                                                 
106300                                                                          
106400       STRING VNADAU-REP-1ST-NM DELIMITED BY ' '                          
106500            ' ' DELIMITED BY SIZE                                         
106600            VNADAU-REP-LAST-NM DELIMITED BY SIZE                          
106700         INTO DH-CONTACT-NAME                                             
106800                                                                          
106900       MOVE VNADAU-EXTD-VND-NM             TO DH-EXT-VND-NAME             
107000       MOVE WS-ADDR-LINE (1)               TO DH-REMIT-ADDRESS1           
107100       MOVE WS-ADDR-LINE (2)               TO DH-REMIT-ADDRESS2           
107200       MOVE WS-ADDR-LINE (3)               TO DH-REMIT-ADDRESS3           
107300       MOVE WS-CITY-STATE-ZIP-LINE         TO DH-REMIT-CTY-ST-ZIP         
107400       MOVE VNADAU-ATTN-TO-TXT             TO DH-REMIT-ATTN-TO.           
107500                                                                          
107600     EJECT                                                                
107700                                                                          
107800 4200-MOVES-TO-ADDRESS-ONLY.                                              
107900                                                                          
108000     MOVE ENTNME-ENT-NAME-DESC              TO DH-PRIM-NAME-B.            
108100     MOVE VNADAU-LAST-UPD-BY-USR-ID         TO DH-USER-ID-B.              
108200     MOVE PV-ADD-MM                         TO DH-ADD-MM-B.               
108300     MOVE PV-ADD-DD                         TO DH-ADD-DD-B.               
108400     MOVE PV-ADD-YY                         TO DH-ADD-YY-B.               
108500                                                                          
108600     INITIALIZE WS-ADDR-LINE-TABLE                                        
108700                WS-CITY-STATE-ZIP-LINE.                                   
108800     SET WS-ADDR-IDX TO +1.                                               
108900                                                                          
109000** ADDRESS LINE 1 ************************************************        
109100     IF VNADAU-VND-1ST-LNE-ADDR = SPACES                                  
109200         CONTINUE                                                         
109300     ELSE                                                                 
109400         MOVE VNADAU-VND-1ST-LNE-ADDR                                     
109500              TO WS-ADDR-LINE (WS-ADDR-IDX)                               
109600         SET WS-ADDR-IDX UP BY +1                                         
109700     END-IF.                                                              
109800                                                                          
109900** ADDRESS LINE 2 ************************************************        
110000     IF VNADAU-VND-2ND-LNE-ADDR = SPACES                                  
110100         CONTINUE                                                         
110200     ELSE                                                                 
110300         MOVE VNADAU-VND-2ND-LNE-ADDR                                     
110400              TO WS-ADDR-LINE (WS-ADDR-IDX)                               
110500         SET WS-ADDR-IDX UP BY +1                                         
110600     END-IF.                                                              
110700                                                                          
110800** ADDRESS LINE 3 ************************************************        
110900     IF VNADAU-VND-3RD-LNE-ADDR = SPACES                                  
111000         CONTINUE                                                         
111100     ELSE                                                                 
111200         MOVE VNADAU-VND-3RD-LNE-ADDR                                     
111300              TO WS-ADDR-LINE (WS-ADDR-IDX)                               
111400         SET WS-ADDR-IDX UP BY +1                                         
111500     END-IF.                                                              
111600                                                                          
111700** CITY STATE ZIP PROVINCE COUNTRY *******************************        
111800     STRING                                                               
111900         VNADAU-CTY-NM DELIMITED BY '  '                                  
112000         ' ' DELIMITED BY SIZE                                            
112100         VNADAU-ST-PROV-CDE DELIMITED BY '  '                             
112200         ' ' DELIMITED BY SIZE                                            
112300         VNADAU-ZIP-CDE DELIMITED BY '  '                                 
112400         ' ' DELIMITED BY SIZE                                            
112500         VNADAU-CNTRY-CDE DELIMITED BY '  '                               
112600     INTO WS-CITY-STATE-ZIP-LINE.                                         
112700                                                                          
112800     IF WS-ADDR-DELETED > SPACES                                          
112900       MOVE WS-ADDR-DELETED TO DH-ADDRESS1                                
113000       MOVE SPACES TO WS-ADDR-DELETED                                     
113100     ELSE                                                                 
113200     IF BUSLOC-FUNCTION-ID = 16                                           
113300       MOVE '*** 1099 ADDRESS ***'         TO DH-ADDRESS-TYPE             
113400       MOVE '1099 ALT NAME: '              TO DH-NAME-TYPE                
113500       MOVE BUSLOC-ALT-1099-VND-NM         TO DH-NAME                     
113600       MOVE WS-ADDR-LINE (1)               TO DH-ADDRESS1                 
113700       MOVE WS-ADDR-LINE (2)               TO DH-ADDRESS2                 
113800       MOVE WS-ADDR-LINE (3)               TO DH-ADDRESS3                 
113900       MOVE WS-CITY-STATE-ZIP-LINE         TO DH-CTY-ST-ZIP-CNTRY         
114000       MOVE VNADAU-ATTN-TO-TXT             TO DH-ATTN-TO                  
114100     ELSE                                                                 
114200                                                                          
114300       MOVE '*** REMITTANCE ADDRESS ***'   TO DH-ADDRESS-TYPE             
114400       MOVE 'EXTD VND NAME: '              TO DH-NAME-TYPE                
114500       STRING VNADAU-REP-1ST-NM DELIMITED BY ' '                          
114600            ' ' DELIMITED BY SIZE                                         
114700            VNADAU-REP-LAST-NM DELIMITED BY SIZE                          
114800         INTO DH-CONTACT-NAME                                             
114900                                                                          
115000       MOVE VNADAU-EXTD-VND-NM             TO DH-NAME                     
115100       MOVE WS-ADDR-LINE (1)               TO DH-ADDRESS1                 
115200       MOVE WS-ADDR-LINE (2)               TO DH-ADDRESS2                 
115300       MOVE WS-ADDR-LINE (3)               TO DH-ADDRESS3                 
115400       MOVE WS-CITY-STATE-ZIP-LINE         TO DH-CTY-ST-ZIP-CNTRY         
115500       MOVE VNADAU-ATTN-TO-TXT             TO DH-ATTN-TO.                 
115600                                                                          
115700     EJECT                                                                
115800                                                                          
115900******************************************************************        
116000*            FORMAT PAYMENT TERM DESCRIPTION                     *        
116100******************************************************************        
116200                                                                          
116300 4500-FORMAT-PAYMENT-TERM-DESC.                                           
116400                                                                          
116500     MOVE SPACES TO ASC-PAYT-TERM-ID-DESC .                               
116600                                                                          
116700     MOVE PAYTRM-PAY-TERM-ID       TO PV-EDIT-PAYT-TERM-ID.               
116800                                                                          
116900     COPY POPD001.                                                        
117000                                                                          
117100     MOVE ASC-PAYT-TERM-ID-DESC    TO DH-PAY-TERMS.                       
117200                                                                          
117300     EJECT                                                                
117400                                                                          
117500******************************************************************        
117600**     WRITE TO THE VENDOR ADD REPORT                           **        
117700******************************************************************        
117800                                                                          
117900 5000-WRITE-ADD-REPORT-LINES.                                             
118000                                                                          
118100* PRINT VENDOR ADD LAYOUT ONLY IF ALL 13 LINES CAN BE PRINTED ON          
118200* CURRENT PAGE                                                            
118300                                                                          
118400     ADD 14 TO PC-LINE-COUNT.                                             
118500                                                                          
118600     IF PC-LINE-COUNT > PC-MAX-LINES                                      
118700         PERFORM 6000-WRITE-REPORT-HEADERS                                
118800     ELSE                                                                 
118900         SUBTRACT 14 FROM PC-LINE-COUNT                                   
119000     END-IF.                                                              
119100                                                                          
119200     IF VNDTAU-ENT-ID NOT = PREV-ENT-ID OR                                
119300        PREV-ENT-ID = ZEROES                                              
119400       WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER1 AFTER 1          
119500       WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER2 AFTER 1          
119600       WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER3 AFTER 1          
119700     ELSE                                                                 
119800       SUBTRACT 3 FROM PC-LINE-COUNT.                                     
119900                                                                          
120000     MOVE VNDTAU-ENT-ID      TO PREV-ENT-ID.                              
120100                                                                          
120200     WRITE VENDOR-REPORT-RECORD FROM WS-BLANK-LINE AFTER 1.               
120300                                                                          
120400     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER4 AFTER 1.           
120500     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER5 AFTER 1.           
120600     INITIALIZE DH-CONTACT-NAME.                                          
120700     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER6 AFTER 1.           
120800     INITIALIZE DH-EXT-VND-NAME                                           
120900                DH-ALT-1099-NAME.                                         
121000     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER7 AFTER 1.           
121100     INITIALIZE DH-REMIT-ADDRESS1                                         
121200                DH-1099-ADDRESS1.                                         
121300                                                                          
121400     IF DH-REMIT-ADDRESS2 NOT = SPACES OR                                 
121500        DH-1099-ADDRESS2 NOT = SPACES                                     
121600       WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER8 AFTER 1          
121700       INITIALIZE DH-DETAIL-HEADER8                                       
121800     ELSE                                                                 
121900       SUBTRACT 1 FROM PC-LINE-COUNT.                                     
122000                                                                          
122100     IF DH-REMIT-ADDRESS3 NOT = SPACES OR                                 
122200        DH-1099-ADDRESS3 NOT = SPACES                                     
122300       WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER9 AFTER 1          
122400       INITIALIZE DH-DETAIL-HEADER9                                       
122500     ELSE                                                                 
122600       SUBTRACT 1 FROM PC-LINE-COUNT.                                     
122700                                                                          
122800     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER10 AFTER 1.          
122900     INITIALIZE DH-DETAIL-HEADER10.                                       
123000     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER11 AFTER 1.          
123100     INITIALIZE DH-1099-ATTN-TO.                                          
123200     WRITE VENDOR-REPORT-RECORD FROM WS-BLANK-LINE AFTER 2.               
123300                                                                          
123400     ADD 14 TO PC-LINE-COUNT.                                             
123500     INITIALIZE VENDOR-REPORT-RECORD                                      
123600                WS-ADDR-LINE-TABLE.                                       
123700                                                                          
123800     EJECT                                                                
123900                                                                          
124000******************************************************************        
124100**     WRITE TO THE VENDOR ADD REPORT - ADDRESS ONLY            **        
124200******************************************************************        
124300                                                                          
124400 5500-WRITE-ADD-RPT-ADDRESS.                                              
124500                                                                          
124600* PRINT VENDOR ADD LAYOUT ONLY IF ALL 13 LINES CAN BE PRINTED ON          
124700* CURRENT PAGE                                                            
124800     ADD 14 TO PC-LINE-COUNT.                                             
124900                                                                          
125000     IF PC-LINE-COUNT > PC-MAX-LINES                                      
125100         PERFORM 6000-WRITE-REPORT-HEADERS                                
125200     ELSE                                                                 
125300         SUBTRACT 14 FROM PC-LINE-COUNT                                   
125400     END-IF.                                                              
125500                                                                          
125600     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER1 AFTER 1.           
125700     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER2B AFTER 2.          
125800                                                                          
125900     WRITE VENDOR-REPORT-RECORD FROM WS-BLANK-LINE AFTER 1.               
126000                                                                          
126100     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER4B AFTER 1.          
126200     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER5 AFTER 1.           
126300     INITIALIZE DH-CONTACT-NAME.                                          
126400     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER6B AFTER 1.          
126500     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER7B AFTER 1.          
126600     INITIALIZE DH-ADDRESS1.                                              
126700                                                                          
126800     IF DH-ADDRESS2 NOT = SPACES                                          
126900      WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER8B AFTER 1          
127000      INITIALIZE DH-DETAIL-HEADER8B                                       
127100     ELSE                                                                 
127200      SUBTRACT 1 FROM PC-LINE-COUNT.                                      
127300                                                                          
127400     IF DH-ADDRESS3 NOT = SPACES                                          
127500      WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER9B AFTER 1          
127600      INITIALIZE DH-DETAIL-HEADER9B                                       
127700     ELSE                                                                 
127800      SUBTRACT 1 FROM PC-LINE-COUNT.                                      
127900                                                                          
128000     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER10B AFTER 1.         
128100     INITIALIZE DH-DETAIL-HEADER10B.                                      
128200     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER11B AFTER 1.         
128300     INITIALIZE DH-ATTN-TO.                                               
128400     WRITE VENDOR-REPORT-RECORD FROM WS-BLANK-LINE AFTER 2.               
128500                                                                          
128600     ADD 14 TO PC-LINE-COUNT.                                             
128700     INITIALIZE VENDOR-REPORT-RECORD                                      
128800                WS-ADDR-LINE-TABLE.                                       
128900                                                                          
129000     EJECT                                                                
129100                                                                          
129200******************************************************************        
129300**               WRITE REPORT HEADINGS                          **        
129400******************************************************************        
129500                                                                          
129600 6000-WRITE-REPORT-HEADERS.                                               
129700     ADD 1                            TO PC-PAGE-COUNT.                   
129800     MOVE PC-PAGE-COUNT               TO DP150O-PAGE-NUMBER.              
129900                                                                          
130000     WRITE VENDOR-REPORT-RECORD                                           
130100           FROM DP150O-STANDRD-HEADER-150-COLS AFTER PAGE.                
130200                                                                          
130300     WRITE VENDOR-REPORT-RECORD FROM H2-HEADER2 AFTER 1.                  
130400     WRITE VENDOR-REPORT-RECORD FROM H2-HEADER3 AFTER 1.                  
130500                                                                          
130600     MOVE SPACES TO VENDOR-REPORT-RECORD.                                 
130700     WRITE VENDOR-REPORT-RECORD AFTER 2.                                  
130800     MOVE 5  TO PC-LINE-COUNT.                                            
130900                                                                          
131000     EJECT                                                                
131100                                                                          
131200 6100-WRITE-TOTAL-LINES.                                                  
131300                                                                          
131400     ADD 6 TO PC-LINE-COUNT.                                              
131500                                                                          
131600     IF PC-LINE-COUNT > PC-MAX-LINES                                      
131700         PERFORM 6000-WRITE-REPORT-HEADERS                                
131800     ELSE                                                                 
131900         SUBTRACT 6 FROM PC-LINE-COUNT                                    
132000     END-IF.                                                              
132100                                                                          
132200     MOVE PC-MERCH-TYP-CNT           TO TL-VND-COUNT1.                    
132300     MOVE PC-EXP-TYP-CNT             TO TL-VND-COUNT2.                    
132400     MOVE PC-CAR-TYP-CNT             TO TL-VND-COUNT3.                    
132500     MOVE PC-FCTR-TYP-CNT            TO TL-VND-COUNT4.                    
132600     MOVE PC-PARENT-TYP-CNT          TO TL-VND-COUNT5.                    
132700                                                                          
132800     WRITE VENDOR-REPORT-RECORD FROM TL-TOTAL-LINE1 AFTER 2.              
132900     WRITE VENDOR-REPORT-RECORD FROM TL-TOTAL-LINE2 AFTER 1.              
133000     WRITE VENDOR-REPORT-RECORD FROM TL-TOTAL-LINE3 AFTER 1.              
133100     WRITE VENDOR-REPORT-RECORD FROM TL-TOTAL-LINE4 AFTER 1.              
133200     WRITE VENDOR-REPORT-RECORD FROM TL-TOTAL-LINE5 AFTER 1.              
133300                                                                          
133400     EJECT                                                                
133500                                                                          
133600 7050-FETCH-VNDTAU-ADD-CSR.                                               
133700                                                                          
133800     EXEC SQL                                                             
133900        FETCH VNDTAU_ADD_CSR                                              
134000         INTO :VNDTAU-ENT-ID                                              
134100             ,:PV-ADD-DATE                                                
134200             ,:VNDTAU-LAST-UPD-BY-USR-ID                                  
134300             ,:VNDTAU-VND-NM                                              
134400             ,:VNDTAU-STAT-CDE                                            
134500             ,:VNDTAU-PRNT-CO-IND-CDE                                     
134600             ,:VNDTAU-PAY-FCTR-IND-CDE                                    
134700             ,:VNDTAU-HLD-PAYT-IND-CDE                                    
134800             ,:VNDTAU-SEPR-INVC-IND-CDE                                   
134900             ,:VNDTAU-PAYT-HNDLG-CDE                                      
135000             ,:VNDTAU-NEED-1099-IND-CDE                                   
135100             ,:VNDTAU-FED-TX-ID-NBR                                       
135200             ,:VNDTAU-PRIM-TYP-CDE                                        
135300             ,:VNDTAU-PRTNR-TYP-CDE                                       
135400     END-EXEC.                                                            
135500                                                                          
135600     EVALUATE TRUE                                                        
135700      WHEN SQLCODE = ZERO                                                 
135800        CONTINUE                                                          
135900      WHEN SQLCODE = +100                                                 
136000        SET OUT-OF-VNDTAU-ROWS TO TRUE                                    
136100      WHEN SQLWARN0 NOT = SPACES                                          
136200      WHEN SQLCODE  NOT = ZERO                                            
136300        MOVE '7050-FETCH-VNDTAU-ADD-CSR'                                  
136400                           TO AA-PARAGRAPH-NAME                           
136500        MOVE                                                              
136600             'UNSUCCESSFUL FETCH WITH VNDTAU CSR'                         
136700                           TO AA-DB2-OPERATION                            
136800        MOVE 'TVNDTAU'     TO AA-DB2-TABLE-1                              
136900        MOVE SPACES        TO AA-DB2-TABLE-2                              
137000                              AA-DB2-TABLE-3                              
137100        PERFORM 9999-DB2-ABEND                                            
137200     END-EVALUATE.                                                        
137300                                                                          
137400     EJECT                                                                
137500                                                                          
137600******************************************************************        
137700* OBTAIN THE PAYMENT TERMS FOR THE VENDOR                        *        
137800******************************************************************        
137900                                                                          
138000 7055-GET-PAYTERMS.                                                       
138100                                                                          
138200     PERFORM                                                              
138300         WITH TEST AFTER                                                  
138400         VARYING PV-RETRY-COUNTER                                         
138500         FROM 1 BY 1                                                      
138600         UNTIL ((PV-RETRY-COUNTER > PV-MAX-RETRIES)                       
138700             OR (SQLCODE = +0)                                            
138800             OR (SQLCODE = +100))                                         
138900                                                                          
139000         EXEC SQL                                                         
139100               SELECT PAY_TERM_ID                                         
139200                     ,DISCOUNT_DAYS_QTY                                   
139300                     ,DISCOUNT_PCT                                        
139400                     ,DUE_DAY_QTY                                         
139500                     ,DUE_DAY_FR_DTE_TXT                                  
139600                     ,OTHER_TXT                                           
139700                INTO :PAYTRM-PAY-TERM-ID                                  
139800                    ,:PAYTRM-DISCOUNT-DAYS-QTY                            
139900                    ,:PAYTRM-DISCOUNT-PCT                                 
140000                    ,:PAYTRM-DUE-DAY-QTY                                  
140100                    ,:PAYTRM-DUE-DAY-FR-DTE-TXT                           
140200                    ,:PAYTRM-OTHER-TXT                                    
140300                FROM TPAYTRM                                              
140400            WHERE PAY_TERM_ID = :VNDAGR-PAYT-TERM-ID                      
140500         END-EXEC                                                         
140600                                                                          
140700         EVALUATE TRUE                                                    
140800             WHEN SQLCODE = +0                                            
140900                  CONTINUE                                                
141000             WHEN SQLCODE = +100                                          
141100                  MOVE SPACES TO DH-PAY-TERMS                             
141200             WHEN SQLWARN0 NOT = SPACES                                   
141300             WHEN SQLCODE  NOT = ZERO                                     
141400                  MOVE '7055-GET-PAYTERMS'                                
141500                                     TO AA-PARAGRAPH-NAME                 
141600                  MOVE    'UNSUCCESSFUL SELECT ON TPAYTRM'                
141700                                     TO AA-DB2-OPERATION                  
141800                  MOVE 'TPAYTRM'     TO AA-DB2-TABLE-1                    
141900                  MOVE SPACES        TO AA-DB2-TABLE-2                    
142000                                        AA-DB2-TABLE-3                    
142100                  PERFORM 9999-DB2-ABEND                                  
142200          END-EVALUATE                                                    
142300     END-PERFORM.                                                         
142400                                                                          
142500     IF  PV-RETRY-COUNTER > PV-MAX-RETRIES                                
142600         MOVE ' 7055-GET-PAYTERMS'                                        
142700                                   TO AA-PARAGRAPH-NAME                   
142800         MOVE 'MAX RETRIES EXCEEDED TRYING TO SELECT TPAYTRM '            
142900                                   TO AA-DB2-OPERATION                    
143000         MOVE 'TPAYTRM'            TO AA-DB2-TABLE-1                      
143100         MOVE SPACES               TO AA-DB2-TABLE-2                      
143200         PERFORM 9999-DB2-ABEND                                           
143300     END-IF.                                                              
143400                                                                          
143500     EJECT                                                                
143600                                                                          
143700 7060-FETCH-VNADAU-ADD-CSR.                                               
143800                                                                          
143900     EXEC SQL                                                             
144000        FETCH VNADAU_ADD_CSR                                              
144100         INTO :VNADAU-ENT-ID                                              
144200             ,:VNADAU-SEQ-NBR                                             
144300             ,:VNADAU-REP-1ST-NM                                          
144400             ,:VNADAU-REP-LAST-NM                                         
144500             ,:VNADAU-EXTD-VND-NM                                         
144600             ,:VNADAU-VND-1ST-LNE-ADDR                                    
144700             ,:VNADAU-VND-2ND-LNE-ADDR                                    
144800             ,:VNADAU-VND-3RD-LNE-ADDR                                    
144900             ,:VNADAU-CTY-NM                                              
145000             ,:VNADAU-ST-PROV-CDE                                         
145100             ,:VNADAU-ZIP-CDE                                             
145200             ,:VNADAU-CNTRY-CDE                                           
145300             ,:VNADAU-ATTN-TO-TXT                                         
145400     END-EXEC.                                                            
145500                                                                          
145600     EVALUATE TRUE                                                        
145700      WHEN SQLCODE = ZERO                                                 
145800        SET NOT-END-OF-ADDRESSES TO TRUE                                  
145900      WHEN SQLCODE = +100                                                 
146000        SET END-OF-ADDRESSES TO TRUE                                      
146100      WHEN SQLWARN0 NOT = SPACES                                          
146200      WHEN SQLCODE  NOT = ZERO                                            
146300        MOVE '7060-FETCH-VNADAU-ADD-CSR'                                  
146400                           TO AA-PARAGRAPH-NAME                           
146500        MOVE                                                              
146600             'UNSUCCESSFUL FETCH WITH VNADAU ADD CSR'                     
146700                           TO AA-DB2-OPERATION                            
146800        MOVE 'TVNADAU'     TO AA-DB2-TABLE-1                              
146900        MOVE SPACES        TO AA-DB2-TABLE-2                              
147000                              AA-DB2-TABLE-3                              
147100        PERFORM 9999-DB2-ABEND                                            
147200     END-EVALUATE.                                                        
147300                                                                          
147400     EJECT                                                                
147500                                                                          
147600******************************************************************        
147700***         UPDATE THE ROW ON THE ADDRESS DETAIL TABLE         ***        
147800******************************************************************        
147900                                                                          
148000 7065-UPDATE-TVNADAU.                                                     
148100                                                                          
148200     PERFORM                                                              
148300         WITH TEST AFTER                                                  
148400         VARYING PV-RETRY-COUNTER                                         
148500         FROM 1 BY 1                                                      
148600         UNTIL ((PV-RETRY-COUNTER > PV-MAX-RETRIES)                       
148700                   OR (SQLCODE = ZERO))                                   
148800         EXEC SQL                                                         
148900             UPDATE TVNADAU                                               
149000               SET AUD_FUNC_CDE = 'P'                                     
149100             WHERE CURRENT OF VNADAU_ADD_CSR                              
149200         END-EXEC                                                         
149300                                                                          
149400         EVALUATE TRUE                                                    
149500             WHEN SQLCODE = ZERO                                          
149600                ADD 1 TO PC-VUPD-TVNADAU-CNT                              
149700                ADD 1 TO PV-UPDATE-COUNT                                  
149800                PERFORM 9000-COMMIT                                       
149900             WHEN SQLCODE = -904                                          
150000             WHEN SQLCODE = -913                                          
150100                 CONTINUE                                                 
150200             WHEN SQLWARN0 NOT = SPACES                                   
150300             WHEN SQLCODE < ZERO                                          
150400             WHEN SQLCODE > ZERO                                          
150500                 MOVE ' 7065-UPDATE-TVNADAU'                              
150600                                   TO AA-PARAGRAPH-NAME                   
150700                 MOVE 'UPDATE A ROW ON THE ADDRESS HISTORY TBL'           
150800                                   TO AA-DB2-OPERATION                    
150900                 MOVE 'TVNADAU'    TO AA-DB2-TABLE-1                      
151000                 MOVE SPACES       TO AA-DB2-TABLE-2                      
151100                 PERFORM 9999-DB2-ABEND                                   
151200         END-EVALUATE                                                     
151300     END-PERFORM.                                                         
151400                                                                          
151500     IF  PV-RETRY-COUNTER > PV-MAX-RETRIES                                
151600         MOVE ' 7065-UPDATE-TVNADAU'                                      
151700                                   TO AA-PARAGRAPH-NAME                   
151800         MOVE 'MAX RETRIES EXCEEDED TRYING TO UPDATE TVNADAU '            
151900                                   TO AA-DB2-OPERATION                    
152000         MOVE 'TVNADAU'            TO AA-DB2-TABLE-1                      
152100         MOVE SPACES               TO AA-DB2-TABLE-2                      
152200         PERFORM 9999-DB2-ABEND                                           
152300     END-IF.                                                              
152400                                                                          
152500     EJECT                                                                
152600                                                                          
152700 7070-GET-RPT-BEG-END-DATE.                                               
152800                                                                          
152900     PERFORM                                                              
153000         WITH TEST AFTER                                                  
153100         VARYING PV-RETRY-COUNTER                                         
153200         FROM 1 BY 1                                                      
153300         UNTIL ((PV-RETRY-COUNTER > PV-MAX-RETRIES)                       
153400             OR (SQLCODE = +0)                                            
153500             OR (SQLCODE = -305))                                         
153600                                                                          
153700         EXEC SQL                                                         
153800           SELECT PREV_WK_END_DTE                                         
153900                 ,(PREV_WK_END_DTE - 7 DAYS)                              
154000            INTO  :PV-MAX-UPDATE-DATE                                     
154100                 ,:PV-MIN-UPDATE-DATE                                     
154200            FROM TAPCNTL                                                  
154300         END-EXEC                                                         
154400                                                                          
154500         EVALUATE TRUE                                                    
154600             WHEN SQLCODE = +0                                            
154700             WHEN SQLCODE = -904                                          
154800             WHEN SQLCODE = -913                                          
154900                  CONTINUE                                                
155000             WHEN SQLWARN0 NOT = SPACES                                   
155100             WHEN SQLCODE < +0                                            
155200             WHEN SQLCODE > +0                                            
155300                  MOVE '7070-GET-RPT-BEG-END-DATE'                        
155400                                  TO AA-PARAGRAPH-NAME                    
155500                  MOVE 'UNSUCCESSFUL SELECT TAPCNTL TBL '                 
155600                                  TO AA-DB2-OPERATION                     
155700                  MOVE 'TAPCNTL' TO AA-DB2-TABLE-1                        
155800                  MOVE SPACES     TO AA-DB2-TABLE-2                       
155900                  PERFORM 9999-DB2-ABEND                                  
156000         END-EVALUATE                                                     
156100     END-PERFORM.                                                         
156200                                                                          
156300     IF  PV-RETRY-COUNTER > PV-MAX-RETRIES                                
156400         MOVE '7070-GET-RPT-BEG-END-DATE' TO  AA-PARAGRAPH-NAME           
156500         MOVE 'MAX RETRIES EXCEEDED ON SELECT TAPCNTL TBL ROW '           
156600                                  TO AA-DB2-OPERATION                     
156700         MOVE 'TAPCNTL'           TO AA-DB2-TABLE-1                       
156800         MOVE SPACES              TO AA-DB2-TABLE-2                       
156900         PERFORM 9999-DB2-ABEND                                           
157000     END-IF.                                                              
157100                                                                          
157200     EJECT                                                                
157300                                                                          
157400 7075-FETCH-VNADAU-ADD-CSR2.                                              
157500                                                                          
157600     EXEC SQL                                                             
157700        FETCH VNADAU_ADD_CSR2                                             
157800         INTO :VNADAU-ENT-ID                                              
157900             ,:VNADAU-SEQ-NBR                                             
158000             ,:VNADAU-LAST-UPD-BY-USR-ID                                  
158100             ,:VNADAU-REP-1ST-NM                                          
158200             ,:VNADAU-REP-LAST-NM                                         
158300             ,:VNADAU-EXTD-VND-NM                                         
158400             ,:VNADAU-VND-1ST-LNE-ADDR                                    
158500             ,:VNADAU-VND-2ND-LNE-ADDR                                    
158600             ,:VNADAU-VND-3RD-LNE-ADDR                                    
158700             ,:VNADAU-CTY-NM                                              
158800             ,:VNADAU-ST-PROV-CDE                                         
158900             ,:VNADAU-ZIP-CDE                                             
159000             ,:VNADAU-CNTRY-CDE                                           
159100             ,:VNADAU-ATTN-TO-TXT                                         
159200     END-EXEC.                                                            
159300                                                                          
159400     EVALUATE TRUE                                                        
159500      WHEN SQLCODE = ZERO                                                 
159600          CONTINUE                                                        
159700      WHEN SQLCODE = +100                                                 
159800        SET END-OF-ADDRESSES TO TRUE                                      
159900      WHEN SQLWARN0 NOT = SPACES                                          
160000      WHEN SQLCODE  NOT = ZERO                                            
160100        MOVE '7075-FETCH-VNADAU-ADD-CSR2'                                 
160200                           TO AA-PARAGRAPH-NAME                           
160300        MOVE                                                              
160400             'UNSUCCESSFUL FETCH WITH VNADAU ADD CSR2'                    
160500                           TO AA-DB2-OPERATION                            
160600        MOVE 'TVNADAU'     TO AA-DB2-TABLE-1                              
160700        MOVE SPACES        TO AA-DB2-TABLE-2                              
160800                              AA-DB2-TABLE-3                              
160900        PERFORM 9999-DB2-ABEND                                            
161000     END-EVALUATE.                                                        
161100                                                                          
161200     EJECT                                                                
161300                                                                          
161400******************************************************************        
161500***                 GET THE VENDOR NAME                        ***        
161600******************************************************************        
161700                                                                          
161800 7085-SELECT-VENDOR-TENTNME.                                              
161900                                                                          
162000     EXEC SQL                                                             
162100         SELECT ENT_NAME_DESC                                             
162200          INTO  :ENTNME-ENT-NAME-DESC                                     
162300          FROM  TENTNME                                                   
162400          WHERE ENT_ID   = :VNADAU-ENT-ID                                 
162500             AND TYPE_CDE = '01'                                          
162600     END-EXEC                                                             
162700                                                                          
162800     EVALUATE TRUE                                                        
162900         WHEN SQLCODE = +0                                                
163000         WHEN SQLCODE = -904                                              
163100         WHEN SQLCODE = -913                                              
163200             CONTINUE                                                     
163300         WHEN SQLWARN0 NOT = SPACE                                        
163400         WHEN SQLCODE < +0                                                
163500         WHEN SQLCODE > +0                                                
163600             MOVE '7085-SELECT-VENDOR-TENTNME'                            
163700                             TO AA-PARAGRAPH-NAME                         
163800             MOVE 'SELECT ON ENTERPRISE NAME TABLE'                       
163900                                 TO AA-DB2-OPERATION                      
164000             MOVE 'TENTNME'  TO AA-DB2-TABLE-1                            
164100             PERFORM 9999-DB2-ABEND                                       
164200        END-EVALUATE.                                                     
164300                                                                          
164400     EJECT                                                                
164500                                                                          
164600 7090-SELECT-TBUSLOC-ROW.                                                 
164700                                                                          
164800     EXEC SQL                                                             
164900           SELECT FUNCTION_ID                                             
165000                 ,ALT_1099_VND_NM                                         
165100           INTO :BUSLOC-FUNCTION-ID                                       
165200               ,:BUSLOC-ALT-1099-VND-NM                                   
165300           FROM TBUSLOC                                                   
165400           WHERE ENT_ID = :VNADAU-ENT-ID                                  
165500                AND SEQ_NBR = :VNADAU-SEQ-NBR                             
165600     END-EXEC.                                                            
165700                                                                          
165800     EVALUATE TRUE                                                        
165900          WHEN SQLCODE = ZERO                                             
166000            CONTINUE                                                      
166100          WHEN SQLCODE = +100                                             
166200            MOVE 'ADDRESS ROW DELETED FOR VENDOR ' TO                     
166300                             WS-ADDR-DELETED                              
166400          WHEN SQLWARN0 NOT = SPACES                                      
166500          WHEN SQLCODE  NOT = ZERO                                        
166600            MOVE '7090-SELECT-TBUSLOC-ROW'                                
166700                                       TO AA-PARAGRAPH-NAME               
166800            MOVE                                                          
166900                'UNSUCCESSFUL SELECT ON TBUSLOC TABLE   '                 
167000                                    TO AA-DB2-OPERATION                   
167100            MOVE 'TBUSLOC'      TO AA-DB2-TABLE-1                         
167200            MOVE SPACES         TO AA-DB2-TABLE-2                         
167300            PERFORM 9999-DB2-ABEND                                        
167400     END-EVALUATE.                                                        
167500                                                                          
167600     EJECT                                                                
167700                                                                          
167800 7095-FETCH-VNDAGR-CSR.                                                   
167900                                                                          
168000     EXEC SQL                                                             
168100        FETCH VNDR_AGRMT_CSR                                              
168200         INTO :VNDAGR-SEQ-NBR                                             
168300             ,:VNDAGR-PAYT-TERM-ID                                        
168400     END-EXEC.                                                            
168500                                                                          
168600     EVALUATE TRUE                                                        
168700      WHEN SQLCODE = ZERO                                                 
168800        SET VENDOR-AGMT-FOUND TO TRUE                                     
168900      WHEN SQLCODE = +100                                                 
169000        SET VENDOR-AGMT-NOT-FOUND TO TRUE                                 
169100      WHEN SQLWARN0 NOT = SPACES                                          
169200      WHEN SQLCODE  NOT = ZERO                                            
169300        MOVE '7095-FETCH-VNDAGR-CSR'                                      
169400                           TO AA-PARAGRAPH-NAME                           
169500        MOVE                                                              
169600             'UNSUCCESSFUL FETCH WITH TVNDAGR CSR'                        
169700                           TO AA-DB2-OPERATION                            
169800        MOVE 'TVNDAGR'     TO AA-DB2-TABLE-1                              
169900        MOVE SPACES        TO AA-DB2-TABLE-2                              
170000                              AA-DB2-TABLE-3                              
170100        PERFORM 9999-DB2-ABEND                                            
170200     END-EVALUATE.                                                        
170300                                                                          
170400     EJECT                                                                
170500                                                                          
170600******************************************************************        
170700*    OPENS THE VENDOR ADD CURSOR.                                *        
170800******************************************************************        
170900                                                                          
171000 7100-OPEN-VNDTAU-ADD-CSR.                                                
171100                                                                          
171200     EXEC SQL                                                             
171300        OPEN VNDTAU_ADD_CSR                                               
171400     END-EXEC.                                                            
171500                                                                          
171600     EVALUATE TRUE                                                        
171700        WHEN SQLCODE = ZERO                                               
171800            CONTINUE                                                      
171900                                                                          
172000        WHEN SQLWARN0 NOT = SPACES                                        
172100        WHEN SQLCODE  NOT = ZERO                                          
172200          MOVE '7100-OPEN-VNDTAU-ADD-CSR'                                 
172300                              TO AA-PARAGRAPH-NAME                        
172400          MOVE 'UNSUCCESSFUL OPEN ON VNDTAU ADD CSR'                      
172500                              TO AA-DB2-OPERATION                         
172600          MOVE 'TVNDTAU'      TO AA-DB2-TABLE-1                           
172700          MOVE SPACES         TO AA-DB2-TABLE-2                           
172800                                 AA-DB2-TABLE-3                           
172900          PERFORM 9999-DB2-ABEND                                          
173000     END-EVALUATE.                                                        
173100                                                                          
173200   EJECT                                                                  
173300                                                                          
173400******************************************************************        
173500*    CLOSES THE VENDOR ADD CURSOR.                               *        
173600******************************************************************        
173700                                                                          
173800 7200-CLOSE-VNDTAU-ADD-CSR.                                               
173900                                                                          
174000     EXEC SQL                                                             
174100        CLOSE VNDTAU_ADD_CSR                                              
174200     END-EXEC.                                                            
174300                                                                          
174400     EVALUATE TRUE                                                        
174500       WHEN SQLCODE = ZERO                                                
174600           CONTINUE                                                       
174700       WHEN SQLWARN0 NOT = SPACES                                         
174800       WHEN SQLCODE  NOT = ZERO                                           
174900          MOVE '7200-CLOSE-VNDTAU-ADD-CSR'                                
175000                             TO AA-PARAGRAPH-NAME                         
175100          MOVE 'UNSUCCESSFUL CLOSE ON VNDTAU ADD CSR'                     
175200                             TO AA-DB2-OPERATION                          
175300          MOVE 'TVNDTAU'     TO AA-DB2-TABLE-1                            
175400          MOVE SPACES        TO AA-DB2-TABLE-2                            
175500                                AA-DB2-TABLE-3                            
175600          PERFORM 9999-DB2-ABEND                                          
175700     END-EVALUATE.                                                        
175800                                                                          
175900     EJECT                                                                
176000                                                                          
176100 7300-OPEN-VNADAU-ADD-CSR.                                                
176200                                                                          
176300     EXEC SQL                                                             
176400        OPEN VNADAU_ADD_CSR                                               
176500     END-EXEC.                                                            
176600                                                                          
176700     EVALUATE TRUE                                                        
176800        WHEN SQLCODE = ZERO                                               
176900            CONTINUE                                                      
177000                                                                          
177100        WHEN SQLWARN0 NOT = SPACES                                        
177200        WHEN SQLCODE  NOT = ZERO                                          
177300          MOVE '7300-OPEN-VNADAU-ADD-CSR'                                 
177400                              TO AA-PARAGRAPH-NAME                        
177500          MOVE 'UNSUCCESSFUL OPEN ON VNADAU ADD CSR'                      
177600                              TO AA-DB2-OPERATION                         
177700          MOVE 'TVNADAU'      TO AA-DB2-TABLE-1                           
177800          MOVE SPACES         TO AA-DB2-TABLE-2                           
177900                                 AA-DB2-TABLE-3                           
178000          PERFORM 9999-DB2-ABEND                                          
178100     END-EVALUATE.                                                        
178200                                                                          
178300   EJECT                                                                  
178400                                                                          
178500******************************************************************        
178600*    CLOSES THE VENDOR UPDATE CURSOR.                            *        
178700******************************************************************        
178800                                                                          
178900 7400-CLOSE-VNADAU-ADD-CSR.                                               
179000                                                                          
179100     EXEC SQL                                                             
179200        CLOSE VNADAU_ADD_CSR                                              
179300     END-EXEC.                                                            
179400                                                                          
179500     EVALUATE TRUE                                                        
179600       WHEN SQLCODE = ZERO                                                
179700           CONTINUE                                                       
179800       WHEN SQLWARN0 NOT = SPACES                                         
179900       WHEN SQLCODE  NOT = ZERO                                           
180000          MOVE '7400-CLOSE-VNADAU-ADD-CSR'                                
180100                             TO AA-PARAGRAPH-NAME                         
180200          MOVE 'UNSUCCESSFUL CLOSE ON VNADAU ADD CSR'                     
180300                             TO AA-DB2-OPERATION                          
180400          MOVE 'TVNADAU'     TO AA-DB2-TABLE-1                            
180500          MOVE SPACES        TO AA-DB2-TABLE-2                            
180600                                AA-DB2-TABLE-3                            
180700          PERFORM 9999-DB2-ABEND                                          
180800     END-EVALUATE.                                                        
180900                                                                          
181000     EJECT                                                                
181100                                                                          
181200 7500-OPEN-VNDR-AGRMT-CSR.                                                
181300                                                                          
181400     EXEC SQL                                                             
181500        OPEN VNDR_AGRMT_CSR                                               
181600     END-EXEC.                                                            
181700                                                                          
181800     EVALUATE TRUE                                                        
181900        WHEN SQLCODE = ZERO                                               
182000            CONTINUE                                                      
182100                                                                          
182200        WHEN SQLWARN0 NOT = SPACES                                        
182300        WHEN SQLCODE  NOT = ZERO                                          
182400          MOVE '7500-OPEN-VNDR-AGRMT-CSR'                                 
182500                              TO AA-PARAGRAPH-NAME                        
182600          MOVE 'UNSUCCESSFUL OPEN ON TVNDAGR CSR'                         
182700                              TO AA-DB2-OPERATION                         
182800          MOVE 'TVNDAGR'      TO AA-DB2-TABLE-1                           
182900          MOVE SPACES         TO AA-DB2-TABLE-2                           
183000                                 AA-DB2-TABLE-3                           
183100          PERFORM 9999-DB2-ABEND                                          
183200     END-EVALUATE.                                                        
183300                                                                          
183400   EJECT                                                                  
183500                                                                          
183600******************************************************************        
183700*    CLOSES THE VENDOR AGREEMENT TABLE CURSOR.                   *        
183800******************************************************************        
183900                                                                          
184000 7600-CLOSE-VNDR-AGRMT-CSR.                                               
184100                                                                          
184200     EXEC SQL                                                             
184300        CLOSE VNDR_AGRMT_CSR                                              
184400     END-EXEC.                                                            
184500                                                                          
184600     EVALUATE TRUE                                                        
184700       WHEN SQLCODE = ZERO                                                
184800           CONTINUE                                                       
184900       WHEN SQLWARN0 NOT = SPACES                                         
185000       WHEN SQLCODE  NOT = ZERO                                           
185100          MOVE '7500-OPEN-VNDR-AGRMT-CSR'                                 
185200                             TO AA-PARAGRAPH-NAME                         
185300          MOVE 'UNSUCCESSFUL CLOSE ON TVNDAGR CSR'                        
185400                             TO AA-DB2-OPERATION                          
185500          MOVE 'TVNDAGR'     TO AA-DB2-TABLE-1                            
185600          MOVE SPACES        TO AA-DB2-TABLE-2                            
185700                                AA-DB2-TABLE-3                            
185800          PERFORM 9999-DB2-ABEND                                          
185900     END-EVALUATE.                                                        
186000                                                                          
186100     EJECT                                                                
186200                                                                          
186300 7700-OPEN-VNADAU-ADD-CSR2.                                               
186400                                                                          
186500     EXEC SQL                                                             
186600        OPEN VNADAU_ADD_CSR2                                              
186700     END-EXEC.                                                            
186800                                                                          
186900     EVALUATE TRUE                                                        
187000        WHEN SQLCODE = ZERO                                               
187100            CONTINUE                                                      
187200                                                                          
187300        WHEN SQLWARN0 NOT = SPACES                                        
187400        WHEN SQLCODE  NOT = ZERO                                          
187500          MOVE '7700-OPEN-VNADAU-ADD-CSR2'                                
187600                              TO AA-PARAGRAPH-NAME                        
187700          MOVE 'UNSUCCESSFUL OPEN ON VNADAU ADD CSR2'                     
187800                              TO AA-DB2-OPERATION                         
187900          MOVE 'TVNADAU'      TO AA-DB2-TABLE-1                           
188000          MOVE SPACES         TO AA-DB2-TABLE-2                           
188100                                 AA-DB2-TABLE-3                           
188200          PERFORM 9999-DB2-ABEND                                          
188300     END-EVALUATE.                                                        
188400                                                                          
188500   EJECT                                                                  
188600                                                                          
188700******************************************************************        
188800*    CLOSES THE VENDOR ADDRESS ADD CURSOR #2                     *        
188900******************************************************************        
189000                                                                          
189100 7800-CLOSE-VNADAU-ADD-CSR2.                                              
189200                                                                          
189300     EXEC SQL                                                             
189400        CLOSE VNADAU_ADD_CSR2                                             
189500     END-EXEC.                                                            
189600                                                                          
189700     EVALUATE TRUE                                                        
189800       WHEN SQLCODE = ZERO                                                
189900           CONTINUE                                                       
190000       WHEN SQLWARN0 NOT = SPACES                                         
190100       WHEN SQLCODE  NOT = ZERO                                           
190200          MOVE '7800-CLOSE-VNADAU-ADD-CSR2'                               
190300                             TO AA-PARAGRAPH-NAME                         
190400          MOVE 'UNSUCCESSFUL CLOSE ON VNADAU ADD CSR2'                    
190500                             TO AA-DB2-OPERATION                          
190600          MOVE 'TVNADAU'     TO AA-DB2-TABLE-1                            
190700          MOVE SPACES        TO AA-DB2-TABLE-2                            
190800                                AA-DB2-TABLE-3                            
190900          PERFORM 9999-DB2-ABEND                                          
191000     END-EVALUATE.                                                        
191100                                                                          
191200     EJECT                                                                
191300                                                                          
191400 9000-COMMIT.                                                             
191500     IF PV-UPDATE-COUNT > 50                                              
191600         EXEC SQL                                                         
191700             COMMIT                                                       
191800         END-EXEC                                                         
191900         DISPLAY '%%%%%%%%  COMMIT PERFORMED  %%%%%%%%%%'                 
192000         MOVE ZEROES TO PV-UPDATE-COUNT                                   
192100     END-IF.                                                              
192200                                                                          
192300     EJECT                                                                
192400                                                                          
192500 9999-DB2-ABEND.                                                          
192600                                                                          
192700     CLOSE  VENDOR-REPORT-FILE.                                           
192800                                                                          
192900     DISPLAY 'VENDOR ENT ID = ' VNADAU-ENT-ID.                            
193000                                                                          
193100     DISPLAY AA-ABEND-LIT.                                                
193200     DISPLAY AA-DB2-ERROR-LIT.                                            
193300     DISPLAY AA-PROGRAM-LIT.                                              
193400     DISPLAY AA-PARAGRAPH-LIT.                                            
193500     DISPLAY AA-DB2-OPERATION-LIT.                                        
193600     DISPLAY AA-DB2-TABLE-1.                                              
193700     DISPLAY AA-DB2-TABLE-2.                                              
193800     DISPLAY AA-DB2-TABLE-3.                                              
193900     SET AC-DB2-ERROR TO TRUE.                                            
194000                                                                          
194100     COPY DPPD004.                                                        
194200     CALL 'ILBOABN0' USING ABEND-CODE.                                    
194300                                                                          
