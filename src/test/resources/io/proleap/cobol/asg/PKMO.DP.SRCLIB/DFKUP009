000100*---------------------------------------------------------------* 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*---------------------------------------------------------------* 00030000
000400 PROGRAM-ID.      DFKUP030.                                       00040000
000500 AUTHOR.          GAYLE HAUPT.                                    00050000
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
000700 DATE-WRITTEN.    08-12-2005.                                     00070000
000800                                                                  00080000
000900***************************************************************** 00090000
000910*                                                               * 00091000
001000*  THIS PROGRAM IS THE STORE CONSTRAINT COMPLIANT VERSION OF    * 00092000
001001*  EPKUP029.   EPKUP030 WILL CLEAR FIELDS ON THE STORE          * 00093000
001010*  STATISTICS DB2 TABLE (DFT_ACTL_STR_TOT).   THE FIELDS ARE    * 00094000
001100*  ACCUMULATED THROUGHOUT THE DAY.   DURING NIGHTLY PROCESSING, * 00095000
001200*  THE FIELDS WILL BE INITIALIZED.                              * 00096000
001310*                                                               * 00097000
001400***************************************************************** 00098000
001500*---------------------------------------------------------------* 00099000
001600 ENVIRONMENT DIVISION.                                            00100000
001700*---------------------------------------------------------------* 00110000
001800                                                                  00120000
001900 CONFIGURATION SECTION.                                           00130000
002000                                                                  00140000
002100 SOURCE-COMPUTER.       IBM-3090.                                 00150000
002200 OBJECT-COMPUTER.       IBM-3090.                                 00160000
002300                                                                  00170000
002400 INPUT-OUTPUT SECTION.                                            00180000
002500                                                                  00190000
002600                                                                  00200000
002700*---------------------------------------------------------------* 00210000
002800 DATA DIVISION.                                                   00220000
002900*---------------------------------------------------------------* 00230000
003000                                                                  00240000
003100*---------------------------------------------------------------* 00250000
003200 WORKING-STORAGE SECTION.                                         00260000
003300*---------------------------------------------------------------* 00270000
003400                                                                  00280000
003500 01  WS-GET-MORE-STORES-RETRY             PIC  X(01) VALUE 'N'.   00290000
003600                                                                  00300000
004000 01  PA-PROGRAM-ACCUMULATORS.                                     00310000
004100     05  PA-RETRY-COUNT                   PIC S9(03) VALUE 0      00320000
004110                                                     COMP.        00330000
004200                                                                  00340000
004300*----------------------------------------------------------------*00350000
004400*    PROGRAM CONSTANTS                                            00360000
004500*----------------------------------------------------------------*00370000
004600 01  PC-PROGRAM-CONSTANTS.                                        00380000
004700     05  PC-PGM-NAME                      PIC  X(08) VALUE        00390000
004710                                                     'DFKUP030'.  00400000
004800     05  PC-FIFTY-STARS                   PIC  X(50) VALUE        00410000
004810                                                     ALL '*'.     00420000
004900     05  PC-SUCCESSFUL-SQLCODE            PIC S9(09) VALUE ZEROS  00430000
005000                                                     COMP SYNC.   00440000
005100     05  PC-END-OF-CURSOR-SQLCODE         PIC S9(09) VALUE +100   00450000
005300                                                     COMP SYNC.   00460000
005400     05  PC-KOHLS-OPERATING-COMPANY       PIC  X(02) VALUE '03'.  00470000
005600     05  PC-DEPARTMENT-STORE-TYPE         PIC  X(02) VALUE 'DS'.  00480000
005800     05  PC-IMPACT-STATUS-LEVEL           PIC S9(04) VALUE +6     00490000
005910                                                     COMP.        00500000
006000     05  PC-MAX-RETRY                     PIC S9(04) VALUE 3      00510000
006010                                                     COMP.        00520000
006100     05  PC-13-ZEROES                     PIC S9(13) VALUE 0      00530000
006110                                                     COMP-3.      00540000
006300                                                                  00550000
006400*----------------------------------------------------------------*00560000
006500*    PROGRAM SWITCHES                                             00570000
006600*----------------------------------------------------------------*00580000
007000                                                                  00590000
007100*----------------------------------------------------------------*00600000
007200*    PROGRAM VARIABLES                                            00610000
007300*----------------------------------------------------------------*00620000
007400 01  PV-PROGRAM-VARIABLES.                                        00630000
007500     05  PV-LAST-DB2-ACTION               PIC  X(45) VALUE SPACES.00640000
007600         88  PV-OPEN-STORE-CURSOR             VALUE               00650000
007700             'OPEN THE XST_LOC STORE CURSOR'.                     00660000
007800         88  PV-CLOSE-STORE-CURSOR            VALUE               00670000
007900             'CLOSE THE XST_LOC STORE CURSOR'.                    00680000
008000         88  PV-FETCH-STORE-ROW               VALUE               00690000
008100             'FETCH A ROW FROM THE XST_LOC STORE CURSOR'.         00700000
008200         88  PV-UPDATE-ACTL-TOT               VALUE               00710000
008300             'UPDATE DFT_ACTL_STR_TOT'.                           00720000
008400         88  PV-INSERT-ACTL-TOT               VALUE               00730000
008500             'INSERT DFT_ACTL_STR_TOT'.                           00740000
008600         88  PV-DELETE-ACTL-TOT               VALUE               00750000
008700             'DELETE DFT_ACTL_STR_TOT'.                           00760000
008701         88  PV-DB2-COMMIT                    VALUE               00770000
008702             'DB2 COMMIT'.                                        00780000
008710                                                                  00790000
008800     05  PV-STORE-NUMBER                  PIC S9(04) COMP         00800000
008900                                                     VALUE ZERO.  00810000
009000     05  PV-STORE-NUM                     PIC  9(04) VALUE ZERO.  00820000
009100     05  PV-PARAGRAPH                     PIC  X(48) VALUE SPACES.00830000
009101     05  PV-AMT-CLSN-CDE                  PIC  X(01).             00840000
009102         88  PV-AMT-CLSN-CDE-N                       VALUE 'N'.   00850000
009103         88  PV-AMT-CLSN-CDE-S                       VALUE 'S'.   00860000
009104         88  PV-AMT-CLSN-CDE-R                       VALUE 'R'.   00870000
009105     05  PV-AMT-CLSN-CNT                  PIC  9(01) VALUE ZERO.  00880000
009110                                                                  00890000
009120 01  ABEND-CODE                           PIC S9(04) VALUE ZERO   00900000
009130                                                     COMP SYNC.   00910000
009140     88  AC-DB2-ERROR                                VALUE +4013. 00911000
009200                                                                  00912000
009201*----------------------------------------------------------------*00913000
009202*    DATE VARIABLES                                               00914000
009203*----------------------------------------------------------------*00915000
009210 01  CD-CPU-DATE-CCYYMMDD.                                        00916000
009220     05 CD-CPU-DATE-C                     PIC  9(02) VALUE 20.    00917000
009230     05 CD-CPU-DATE-YMD.                                          00918000
009240        10  CD-CPU-YY                     PIC  9(02) VALUE ZEROS. 00919000
009250        10  CD-CPU-MM                     PIC  9(02) VALUE ZEROS. 00920000
009260        10  CD-CPU-DD                     PIC  9(02) VALUE ZEROS. 00921000
009261 01  CD-CPU-DATE-ISO.                                             00922000
009262     05  CD-CPU-DATE-ISO-CC               PIC  X(02) VALUE SPACE. 00923000
009263     05  CD-CPU-DATE-ISO-YY               PIC  X(02) VALUE SPACE. 00924000
009264     05  FILLER                           PIC  X(01) VALUE '-'.   00925000
009265     05  CD-CPU-DATE-ISO-MM               PIC  X(02) VALUE SPACE. 00926000
009266     05  FILLER                           PIC  X(01) VALUE '-'.   00926100
009267     05  CD-CPU-DATE-ISO-DD               PIC  X(02) VALUE SPACE. 00926200
009270                                                                  00926300
009700                                                                  00926400
009800*---------------------------------------------------------------* 00926500
010000*  VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        00926600
010010*---------------------------------------------------------------* 00926700
010100                                                                  00926800
010200     COPY DPWS004.                                                00926900
010300                                                                  00927000
010310*---------------------------------------------------------------* 00928000
010400*  SQL AND COBOL DECLARATIONS FOR THE LOCATION TABLE (XST_LOC)    00929000
010410*---------------------------------------------------------------* 00930000
010500                                                                  00940000
010600     EXEC SQL                                                     00950000
010700         INCLUDE XST00001                                         00960000
010800     END-EXEC.                                                    00970000
010900                                                                  00980000
010901*---------------------------------------------------------------* 00990000
010902*  SQL AND COBOL DECLARATIONS FOR THE LOCATION ATTRIBUTE TABLE    01000000
010903*  (XST_LOC_ATTR)                                                 01010000
010904*---------------------------------------------------------------* 01020000
010905                                                                  01030000
010906     EXEC SQL                                                     01040000
010907         INCLUDE XST00025                                         01050000
010908     END-EXEC.                                                    01060000
010909                                                                  01070000
011501*---------------------------------------------------------------* 01080000
011502*  SQL AND COBOL DECLARATIONS FOR FLASH ACTUAL STORE TOTALS       01090000
011503*  TABLE (DFT_ACTL_STR_TOT)                                       01100000
011504*---------------------------------------------------------------* 01110000
011505                                                                  01120000
011506     EXEC SQL                                                     01130000
011507         INCLUDE DFT00007                                         01140000
011508     END-EXEC.                                                    01150000
011509                                                                  01150100
011510*---------------------------------------------------------------* 01150200
011600*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                01150300
011610*---------------------------------------------------------------* 01150400
011700                                                                  01150500
011800     EXEC SQL                                                     01150600
011900         INCLUDE SQLCA                                            01150700
012000     END-EXEC.                                                    01150800
012100                                                                  01150900
012110*---------------------------------------------------------------* 01151000
012200*  CURSOR USED TO RETRIEVE ALL STORE ROWS FOR DEPARTMENT          01152000
012300*  STORES WITHIN THE KOHL'S OPERATING COMPANY THAT HAVE           01153000
012400*  REACHED THE 'IMPACT' P.O.S. LEVEL.                             01154000
012410*---------------------------------------------------------------* 01155000
012500                                                                  01156000
012600     EXEC SQL                                                     01157000
012700         DECLARE STORE_CURSOR CURSOR FOR                          01158000
012800             SELECT LOC.LOC_NBR                                   01159000
012900                   ,LOC.CLO_DTE                                   01160000
013400               FROM XST_LOC       LOC                             01170000
013410                   ,XST_LOC_ATTR  ATT                             01180000
013500              WHERE LOC.LOC_NBR     = ATT.LOC_NBR                 01190000
013600               AND  LOC.LOC_TYP_CDE = :PC-DEPARTMENT-STORE-TYPE   01200000
013700               AND  ATT.POS_CAP_LVL_ID                            01210000
013800                                   >= :PC-IMPACT-STATUS-LEVEL     01220000
014000              ORDER BY LOC.LOC_NBR                                01230000
014100     END-EXEC.                                                    01240000
014200                                                                  01250000
014300*---------------------------------------------------------------* 01260000
014400 PROCEDURE DIVISION.                                              01270000
014500*---------------------------------------------------------------* 01280000
014600 0000-MAINLINE.                                                   01290000
014700                                                                  01300000
014810     ACCEPT CD-CPU-DATE-YMD    FROM DATE.                         01310000
014820     MOVE CD-CPU-DATE-C          TO CD-CPU-DATE-ISO-CC.           01320000
014830     MOVE CD-CPU-YY              TO CD-CPU-DATE-ISO-YY.           01330000
014840     MOVE CD-CPU-MM              TO CD-CPU-DATE-ISO-MM.           01340000
014850     MOVE CD-CPU-DD              TO CD-CPU-DATE-ISO-DD.           01350000
014900                                                                  01360000
015000     PERFORM 2000-UPDATE-ACTL-TOT.                                01370000
015900                                                                  01380000
015910     PERFORM 2100-UPDATE-STR-ZERO.                                01390000
015920                                                                  01400000
015930     PERFORM 8900-COMMIT-DB2.                                     01410000
015940                                                                  01420000
016000     STOP RUN.                                                    01430000
016010                                                                  01440000
016020*0000-EXIT.                                                       01450000
016600                                                                  01460000
016700*---------------------------------------------------------------* 01470000
016800*  UPDATE DFT_ACTL_STR_TOT                                        01480000
016900*---------------------------------------------------------------* 01490000
017000                                                                  01500000
017100 2000-UPDATE-ACTL-TOT.                                            01510000
017200                                                                  01520000
017300     EXEC SQL                                                     01530000
017400         OPEN STORE_CURSOR                                        01540000
017500     END-EXEC.                                                    01550000
017600                                                                  01560000
017700     IF SQLCODE NOT = PC-SUCCESSFUL-SQLCODE                       01570000
017800         SET PV-OPEN-STORE-CURSOR TO TRUE                         01580000
017900         PERFORM 9000-SQL-CHECK-RETRY                             01590000
018000     END-IF.                                                      01600000
018100                                                                  01610000
018200     PERFORM 7000-FETCH-STORE-ROW.                                01620000
018300     PERFORM                                                      01630000
018400        UNTIL SQLCODE = PC-END-OF-CURSOR-SQLCODE                  01640000
018500           MOVE XST00001-LOC-NBR   TO PV-STORE-NUMBER             01650000
018510                                      PV-STORE-NUM                01660000
018600           DISPLAY 'DFT-ACTL-STR-TOT INITIALIZED ',               01670000
018610                                      PV-STORE-NUM                01680000
018700           INITIALIZE PA-RETRY-COUNT                              01690000
018810           IF XST00001-CLO-DTE      < CD-CPU-DATE-ISO             01700000
018820               PERFORM 3000-DEL-STORE-FROM-ACTL-TOT               01710000
018830           ELSE                                                   01720000
018840               MOVE 1              TO PV-AMT-CLSN-CNT             01730000
018850               SET PV-AMT-CLSN-CDE-N                              01740000
018860                                   TO TRUE                        01750000
018900               PERFORM 8000-INITIALIZE-ACTL-TOT                   01760000
019000                 UNTIL PV-AMT-CLSN-CNT > 3                        01770000
019010           END-IF                                                 01780000
019100           PERFORM 7000-FETCH-STORE-ROW                           01790000
019200     END-PERFORM.                                                 01800000
019300                                                                  01810000
019400     EXEC SQL                                                     01820000
019500         CLOSE STORE_CURSOR                                       01830000
019600     END-EXEC.                                                    01840000
019700                                                                  01850000
019800     IF SQLCODE NOT = PC-SUCCESSFUL-SQLCODE                       01860000
019900         SET PV-CLOSE-STORE-CURSOR  TO TRUE                       01870000
020000         PERFORM 9000-SQL-CHECK-RETRY                             01880000
020100     END-IF.                                                      01890000
020200                                                                  01900000
020300*2000-EXIT.                                                       01910000
020400                                                                  01920000
020410*---------------------------------------------------------------* 01930000
020420*  UPDATE ZERO STORE ROWS ON DFT_ACTL_STR_TOT                     01940000
020430*---------------------------------------------------------------* 01950000
020440                                                                  01960000
020450 2100-UPDATE-STR-ZERO.                                            01970000
020460                                                                  01980000
020461     INITIALIZE PA-RETRY-COUNT.                                   01990000
020470     MOVE ZERO                     TO PV-STORE-NUMBER             02000000
020480                                      PV-STORE-NUM.               02010000
020508     MOVE 1                        TO PV-AMT-CLSN-CNT.            02020000
020510     SET PV-AMT-CLSN-CDE-N         TO TRUE.                       02030000
020511     PERFORM 8000-INITIALIZE-ACTL-TOT                             02040000
020512       UNTIL PV-AMT-CLSN-CNT > 3.                                 02050000
020525                                                                  02051000
020526*2100-EXIT.                                                       02052000
020527                                                                  02052100
020530*----------------------------------------------------------------*02052200
020600*  DELETE A STORE FROM THE DFT_ACTL_STR_TOT TABLE                 02052300
020610*  IF A STORE IS NO LONGER OPEN, DELETE IT FROM THE FLASH TABLE   02052400
020700*----------------------------------------------------------------*02052500
020701                                                                  02052600
020702 3000-DEL-STORE-FROM-ACTL-TOT.                                    02052700
020703     EXEC SQL                                                     02052800
020704         DELETE FROM DFT_ACTL_STR_TOT                             02052900
020705          WHERE STR_NBR            = :XST00001-LOC-NBR            02053000
020706     END-EXEC.                                                    02054000
020707                                                                  02055000
020708     IF (SQLCODE = PC-SUCCESSFUL-SQLCODE)     OR                  02056000
020709        (SQLCODE = PC-END-OF-CURSOR-SQLCODE)                      02057000
020710         CONTINUE                                                 02058000
020711     ELSE                                                         02059000
020712         SET PV-DELETE-ACTL-TOT   TO TRUE                         02060000
020713         MOVE '3000-DEL-STORE      ' TO PV-PARAGRAPH              02070000
020714         PERFORM 9000-SQL-CHECK-RETRY                             02071000
020715     END-IF.                                                      02071100
020716                                                                  02071200
020717*3000-EXIT.                                                       02071300
020718                                                                  02071400
020719*----------------------------------------------------------------*02071500
020720*  FETCH A STORE ROW FROM THE DB2 STORE TABLE CURSOR.            *02071600
020730*----------------------------------------------------------------*02071700
020800                                                                  02071800
020900 7000-FETCH-STORE-ROW.                                            02071900
021000     EXEC SQL                                                     02072000
021100         FETCH  STORE_CURSOR                                      02073000
021200          INTO :XST00001-LOC-NBR                                  02074000
021300              ,:XST00001-CLO-DTE                                  02075000
021800     END-EXEC.                                                    02076000
021900                                                                  02077000
022000     IF ((SQLCODE NOT = PC-SUCCESSFUL-SQLCODE)                    02078000
022100             AND (SQLCODE NOT = PC-END-OF-CURSOR-SQLCODE))        02079000
022200         SET PV-FETCH-STORE-ROW      TO TRUE                      02080000
022300         MOVE '7000-FETCH-STORE-ROW' TO PV-PARAGRAPH              02090000
022400         PERFORM 9000-SQL-CHECK-RETRY                             02100000
022500     END-IF.                                                      02110000
022510                                                                  02120000
022600*7000-EXIT.                                                       02130000
022700                                                                  02140000
022800*----------------------------------------------------------------*02150000
022900*  UPDATE FLASH SALES STATISTICS TABLE - DFT_ACTL_STR_TOT         02160000
022910*  SET SALES DOLLARS TO ZERO AND TIMESTAMP TO CURRENT TIME FOR    02170000
022920*  EACH AMT_CLSN_CDE (S,R,N).                                     02180000
023000*----------------------------------------------------------------*02190000
023100                                                                  02200000
023200 8000-INITIALIZE-ACTL-TOT.                                        02210000
023300                                                                  02220000
023400     EXEC SQL                                                     02230000
023500         UPDATE DFT_ACTL_STR_TOT                                  02240000
023700            SET  SLS_TMST          = CURRENT TIMESTAMP            02250000
023900                ,DOL_AMT           = 0                            02260000
025500         WHERE STR_NBR             = :PV-STORE-NUMBER             02270000
025510          AND  AMT_CLSN_CDE        = :PV-AMT-CLSN-CDE             02280000
025600     END-EXEC.                                                    02290000
025700                                                                  02300000
025800     EVALUATE TRUE                                                02310000
025900         WHEN SQLCODE = +0                                        02320000
025910             ADD 1                TO PV-AMT-CLSN-CNT              02330000
026100         WHEN SQLCODE = +100                                      02340000
026200             INITIALIZE PA-RETRY-COUNT                            02350000
026300             PERFORM 8100-INSERT-ACTL-TOT                         02360000
026400         WHEN OTHER                                               02370000
026500             MOVE '8000-INITIALIZE-ACTL-TOT'                      02380000
026510                                  TO PV-PARAGRAPH                 02390000
026600             SET PV-UPDATE-ACTL-TOT                               02400000
026610                                  TO TRUE                         02410000
026700             PERFORM 9000-SQL-CHECK-RETRY                         02420000
026800     END-EVALUATE.                                                02430000
026801                                                                  02440000
026802     IF PV-AMT-CLSN-CNT            = 2                            02450000
026803         SET PV-AMT-CLSN-CDE-S    TO TRUE                         02460000
026804     ELSE                                                         02470000
026805         IF PV-AMT-CLSN-CNT        = 3                            02480000
026806             SET PV-AMT-CLSN-CDE-R                                02490000
026807                                  TO TRUE                         02500000
026808         END-IF                                                   02510000
026809     END-IF.                                                      02520000
026810                                                                  02530000
026820*8000-EXIT.                                                       02540000
026900                                                                  02550000
027010*----------------------------------------------------------------*02560000
027100*    INSERT A NEW ROW IN THE FLASH STATISTICS TABLE               02570000
027110*----------------------------------------------------------------*02580000
027300 8100-INSERT-ACTL-TOT.                                            02590000
027400                                                                  02600000
027500     EXEC SQL                                                     02610000
027600         INSERT INTO DFT_ACTL_STR_TOT                             02620000
027700             (STR_NBR                                             02630000
027800             ,SLS_TMST                                            02640000
027900             ,AMT_CLSN_CDE                                        02650000
028000             ,DOL_AMT)                                            02660000
030300      VALUES (:PV-STORE-NUMBER                                    02670000
030400             ,CURRENT TIMESTAMP                                   02680000
030500             ,:PV-AMT-CLSN-CDE                                    02690000
030600             ,0)                                                  02700000
032900     END-EXEC.                                                    02710000
033000                                                                  02720000
033100     EVALUATE TRUE                                                02730000
033200         WHEN SQLCODE = +0                                        02740000
033300             ADD 1                TO PV-AMT-CLSN-CNT              02750000
033400         WHEN OTHER                                               02760000
033500             MOVE '8100-INSERT-ACTL-TOT'                          02770000
033510                                  TO PV-PARAGRAPH                 02780000
033600             SET PV-INSERT-ACTL-TOT                               02790000
033610                                  TO TRUE                         02800000
033700             PERFORM 9000-SQL-CHECK-RETRY                         02810000
033800     END-EVALUATE.                                                02820000
033810                                                                  02830000
033820*8100-EXIT.                                                       02840000
033830                                                                  02850000
033840*----------------------------------------------------------------*02860000
033850* 8900-COMMIT-DB2                                                 02870000
033860*     COMMIT THE ROWS IN DFT_ACTL_STR_TOT                         02880000
033870*----------------------------------------------------------------*02890000
033880 8900-COMMIT-DB2.                                                 02900000
033890                                                                  02910000
033900     EXEC SQL                                                     02920000
034000        COMMIT                                                    02930000
034100     END-EXEC.                                                    02940000
034200                                                                  02950000
034300     IF SQLCODE NOT = +0                                          02960000
034330        SET PV-DB2-COMMIT         TO TRUE                         02970000
034400        MOVE '8900-COMMIT-DB2'    TO PV-PARAGRAPH                 02980000
034610        PERFORM 9000-SQL-CHECK-RETRY                              02990000
034800     END-IF.                                                      03000000
034900                                                                  03010000
035000*8900-EXIT.                                                       03020000
043600                                                                  03030000
043610*----------------------------------------------------------------*03040000
043800*    CHECK SQLCODE.  IF -913 OR -904 TRY AGAIN ELSE  PERFORM      03050000
043900*      TO ABEND                                                   03060000
043910*----------------------------------------------------------------*03070000
044100 9000-SQL-CHECK-RETRY.                                            03080000
044200                                                                  03090000
044300     EVALUATE TRUE                                                03100000
044400         WHEN SQLCODE = -913                                      03110000
044500         WHEN SQLCODE = -904                                      03120000
044600             ADD 1 TO PA-RETRY-COUNT                              03130000
044700             IF PA-RETRY-COUNT > PC-MAX-RETRY                     03140000
044800                 PERFORM 9100-DB2-ERROR                           03150000
044900             END-IF                                               03160000
045000         WHEN ANY                                                 03170000
045100             PERFORM 9100-DB2-ERROR                               03180000
045200      END-EVALUATE.                                               03190000
045210                                                                  03200000
045220*9000-EXIT.                                                       03210000
045407                                                                  03220000
045410*----------------------------------------------------------------*03230000
045500*  FORMAT A DB2 ERROR MESSAGE, AND ABEND THE PROGRAM.            *03240000
045600*----------------------------------------------------------------*03250000
045700                                                                  03260000
045800 9100-DB2-ERROR.                                                  03270000
045900                                                                  03280000
046000     DISPLAY '9100-DB2-ERROR'.                                    03290000
046100     DISPLAY '**  ABEND     **'.                                  03300000
046200     DISPLAY '**  PROGRAM   **  = ' PC-PGM-NAME.                  03310000
046210     DISPLAY '**  STORE NBR **  = ' PV-STORE-NUM.                 03320000
046300     DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH.                 03330000
046400     DISPLAY '**  OPERATION **  = ' PV-LAST-DB2-ACTION.           03340000
046500*                                                                 03350000
046600*  ROUTINE TO CONVERT THE SQLCA INTO A READABLE FORMAT, USING     03360000
046700*  THE CALLED MODULE DSNTIAR.                                     03370000
046800*                                                                 03380000
046900     COPY DPPD004.                                                03390000
047000                                                                  03400000
047100     SET AC-DB2-ERROR TO TRUE.                                    03410000
047200     CALL 'ILBOABN0' USING ABEND-CODE.                            03420000
047300                                                                  03430000
047400*9100-EXIT.                                                       03440000
047500                                                                  03450000
