       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    MLKRP320                                                  
       AUTHOR.        DORSEY JACKSON                                            
       INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
       DATE-WRITTEN.  06-02-2002.                                               
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      * MLKRP320 - M/L PURCHASE JOURNAL TRANSACTION LIST               *        
      ******************************************************************        
      *  THIS PROGRAM READ THE M/L PURCHASE JOURNAL TRANSACTIONS FROM  *        
      *  THE KEY/MASTER DATA ENTRY FILE AND PRODUCE THE PURCHASE       *        
      *  JOURNAL TRANSACTION LIST REPORT.                              *        
      ******************************************************************        
      ******************************************************************        
      *                        CHANGE LOG                              *        
      * CHNG ID  CHANGE DTE  REASON FOR CHANGE                         *        
      * -------  ----------  ----------------------------------------- *        
W26603* W26603   03-25-2004  STORE EXPANSION.  REPLACE THE INPUT FILE  *        
W26603*                      LAYOUT WITH THE EXPANDED MLRD015.         *        
W26603*                      EXPANDED WORKING STORAGE VARIABLES.       *        
W26603*                      EXPANDED FIELDS ON THE REPORT TOO.        *        
W26603*                      - RONNA MCDONALD                          *        
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.    IBM-3090.                                            
       OBJECT-COMPUTER.    IBM-3090.                                            
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
           SELECT INP-PRCHJRNL-FILE                                             
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT OUT-PRCHJRNL-LIST-REPORT                                      
               ASSIGN TO RPT01.                                                 
                                                                                
       DATA DIVISION.                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  INP-PRCHJRNL-FILE                                                    
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK  CONTAINS   0 RECORDS                                          
           RECORD CONTAINS 150 CHARACTERS                                       
           DATA RECORD IS INPUT-PRCHJRNL-RECORD.                                
                                                                                
W26603 01  INPUT-PRCHJRNL-RECORD            PIC X(150).                         
                                                                                
       FD  OUT-PRCHJRNL-LIST-REPORT                                             
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           DATA RECORD IS OUT-PRCHJRNL-LIST-RECORD.                             
                                                                                
       01  OUT-PRCHJRNL-LIST-RECORD     PIC X(132).                             
                                                                                
       EJECT                                                                    
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  FILLER                            PIC X(40)     VALUE                
           '*** WORKING STORAGE AREA BEGIN ***'.                                
                                                                                
W26603*****************************************************************         
W26603*   PURCHASE JOURNAL TRANSACTIONS                                         
W26603*****************************************************************         
W26603     COPY MLRD015.                                                        
                                                                                
W26603*****************************************************************         
W26603*   PURCHASE JOURNAL TRANSACTIONS                                         
W26603*****************************************************************         
W26603*01  INP-PRCHJRNL-RECORD.                                                 
W26603*    05  INP-RECODE                    PIC X(01).                         
W26603*    05  INP-VENDOR                    PIC X(05).                         
W26603*    05  INP-CLASS                     PIC 9(05).                         
W26603*    05  INP-CLASSX REDEFINES INP-CLASS.                                  
W26603*        10  INP-CLASS1                PIC 9(03).                         
W26603*        10  INP-CLASS2                PIC 9(02).                         
W26603*    05  INP-NCLASS REDEFINES INP-CLASS PIC 9(05).                        
W26603*    05  FILLER                        PIC X(12).                         
W26603*    05  INP-BATCH                     PIC X(03).                         
W26603*    05  INP-KM                        PIC X(02).                         
W26603*    05  FILLER                        PIC X(03).                         
W26603*    05  INP-DATE                      PIC X(04).                         
W26603*    05  INP-DATEX REDEFINES INP-DATE.                                    
W26603*        10  INP-DATE                  PIC X(02).                         
W26603*        10  INP-MONTH                 PIC X(02).                         
W26603*    05  INP-DOC                       PIC X(05).                         
W26603*    05  INP-ACCOUNT                   PIC X(05).                         
W26603*    05  INP-MERCH                     PIC S9(05)V99.                     
W26603*    05  INP-DISCOUNT                  PIC S9(04)V99.                     
W26603*    05  INP-FREIGHT                   PIC S9(04)V99.                     
W26603*    05  INP-NET                       PIC S9(05)V99.                     
W26603*    05  INP-RETAIL                    PIC S9(05)V99.                     
W26603*    05  INP-TRCODE                    PIC X(02).                         
                                                                                
      ******************************************************************        
      *  HEADER LINES                                                           
      ******************************************************************        
       01  HL-HEADING-LINE1.                                                    
           05  FILLER                        PIC X(44)   VALUE SPACES.          
           05  FILLER                        PIC X(10)   VALUE                  
                                             'K O H L S'.                       
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  FILLER                        PIC X(19)   VALUE                  
                                             'D E P A R T M E N T'.             
           05  FILLER                        PIC X(02)   VALUE SPACES.          
           05  FILLER                        PIC X(11)   VALUE                  
                                             'S T O R E S'.                     
           05  FILLER                        PIC X(22)   VALUE SPACES.          
           05  FILLER                        PIC X(04)   VALUE 'PAGE'.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  HL-HEADING1-PAGE              PIC Z(8)    VALUE ZEROES.          
       01  HL-HEADING-LINE2.                                                    
           05  FILLER                        PIC X(49)   VALUE SPACES.          
           05  FILLER                        PIC X(08)   VALUE                  
                                             'PURCHASE'.                        
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  FILLER                        PIC X(07)   VALUE                  
                                             'JOURNAL'.                         
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  FILLER                        PIC X(11)   VALUE                  
                                             'TRANSACTION'.                     
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  FILLER                        PIC X(04)   VALUE                  
                                             'LIST'.                            
           05  FILLER                        PIC X(27)   VALUE SPACES.          
           05  HL-HEADING2-DATE.                                                
               10  HL-HEADING2-DATE-MM       PIC X(02)   VALUE SPACES.          
               10  FILLER                    PIC X(01)   VALUE '/'.             
               10  HL-HEADING2-DATE-DD       PIC X(02)   VALUE SPACES.          
               10  FILLER                    PIC X(01)   VALUE '/'.             
               10  HL-HEADING2-DATE-YY       PIC X(02)   VALUE SPACES.          
                                                                                
       01  HL-HEADING-LINE3.                                                    
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(03) VALUE                    
                                             'BCH'.                             
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(02) VALUE                    
                                             'KM'.                              
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(05) VALUE                    
                                             'VEND '.                           
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(06) VALUE                    
                                             'CLASS '.                          
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(05) VALUE                    
                                             'DOC  '.                           
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(07) VALUE                    
                                             'ACCT   '.                         
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(15) VALUE                    
                                             '     MERCH     '.                 
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(15) VALUE                    
                                             '    DISCOUNT   '.                 
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(15) VALUE                    
                                             '    FREIGHT    '.                 
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(15) VALUE                    
                                             '    NET COST   '.                 
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(15) VALUE                    
                                             '     RETAIL    '.                 
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(02) VALUE                    
                                             'TR'.                              
           05  FILLER                        PIC X(01) VALUE SPACES.            
           05  FILLER                        PIC X(07) VALUE                    
                                             'MESSAGE'.                         
       01  HL-HEADING-LINE4.                                                    
           05  FILLER                        PIC X(116) VALUE SPACES.           
           05  FILLER                        PIC X(02) VALUE                    
                                             'CD'.                              
       01  HL-HEADING-LINE5-SPACE-LINE.                                         
           05  FILLER                        PIC X(132) VALUE SPACES.           
                                                                                
       01  RP-REPORT-DETAIL.                                                    
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  RP-BATCH                      PIC X(03)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  RP-KM                         PIC X(02)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  RP-VENDOR                     PIC X(05)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  RP-CLASS1                     PIC X(03)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE '-'.             
           05  RP-CLASS2                     PIC X(02)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  RP-DOC                        PIC X(05)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  RP-ACCOUNT.                                                      
W26603         10 RP-PO-TYP-CDE              PIC X(02)   VALUE SPACES.          
W26603         10 RP-STR-NBR                 PIC X(05)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  RP-MERCH                      PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
W26603     05  RP-DISCOUNT                   PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
W26603     05  RP-FREIGHT                    PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
W26603     05  RP-NETCOST                    PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
W26603     05  RP-RETAIL                     PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  RP-TRCODE                     PIC X(02)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  RP-MESSAGE                    PIC X(05)   VALUE SPACES.          
                                                                                
       01  VEN-TOTAL-LINE.                                                      
           05  FILLER                        PIC X(05)   VALUE SPACES.          
           05  FILLER                        PIC X(10)   VALUE                  
                                             'VENDOR TOT'.                      
           05  FILLER                        PIC X(20)   VALUE SPACES.          
W26603     05  VEN-TOT-MERCH                 PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(33)   VALUE SPACES.          
W26603     05  VEN-TOT-NETCOST               PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
W26603     05  VEN-TOT-RETAIL                PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
                                                                                
       01  BAT-TOT-LINE.                                                        
           05  FILLER                        PIC X(12)  VALUE SPACES.           
           05  FILLER                        PIC X(11)   VALUE                  
                                             'BATCH TOTAL'.                     
           05  FILLER                        PIC X(12)   VALUE SPACES.          
W26603     05  BAT-TOT-MERCH                 PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(1)    VALUE SPACES.          
W26603     05  BAT-TOT-DISCOUNT              PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(1)    VALUE SPACES.          
W26603     05  BAT-TOT-FREIGHT               PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(1)    VALUE SPACES.          
W26603     05  BAT-TOT-NETCOST               PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(1)    VALUE SPACES.          
W26603     05  BAT-TOT-RETAIL                PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
       01  GND-TOT-LINE.                                                        
           05  FILLER                        PIC X(16)   VALUE SPACES.          
           05  FILLER                        PIC X(11)   VALUE                  
                                             'GRAND TOTAL'.                     
           05  FILLER                        PIC X(08)   VALUE SPACES.          
W26603     05  GND-TOT-MERCH                 PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(1)    VALUE SPACES.          
W26603     05  GND-TOT-DISCOUNT              PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(1)    VALUE SPACES.          
W26603     05  GND-TOT-FREIGHT               PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(1)    VALUE SPACES.          
W26603     05  GND-TOT-NETCOST               PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
           05  FILLER                        PIC X(1)   VALUE SPACES.           
W26603     05  GND-TOT-RETAIL                PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
                                                                                
       01  VT-VENDOR-TOTALS.                                                    
           05  VT-TOTAL-MERCH                PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  VT-TOTAL-DISCOUNT             PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  VT-TOTAL-FREIGHT              PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  VT-TOTAL-NETCOST              PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  VT-TOTAL-RETAIL               PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
       01  BAT-BATCH-TOTALS.                                                    
           05  BAT-TOTAL-MERCH               PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  BAT-TOTAL-DISCOUNT            PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  BAT-TOTAL-FREIGHT             PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  BAT-TOTAL-NETCOST             PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  BAT-TOTAL-RETAIL              PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
       01  GND-GRAND-TOTALS.                                                    
           05  GND-TOTAL-MERCH               PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  GND-TOTAL-DISCOUNT            PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  GND-TOTAL-FREIGHT             PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  GND-TOTAL-NETCOST             PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
           05  GND-TOTAL-RETAIL              PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
       01  FILLER                          PIC X(40)       VALUE                
           '*** PROGRAMMING VARIABLE BEGIN ***'.                                
                                                                                
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-LINE-MAX                   PIC S9(4)   VALUE +55              
                                                         COMP SYNC.             
           05  PC-PROGRAM-NAME               PIC X(08) VALUE 'MLKRP320'.        
       01  PS-PROGRAM-SWITCHES.                                                 
           05  INPUT-EOF-SW                  PIC X(1)     VALUE 'N'.            
               88  INPUT-EOF                              VALUE 'Y'.            
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-PAGE-COUNTER               PIC S9(4)   VALUE ZEROES           
                                                         COMP SYNC.             
           05  PV-LINE-COUNTER               PIC S9(4)   VALUE 99               
                                                         COMP SYNC.             
           05  PV-IN-COUNTER                 PIC S9(6)   VALUE ZEROES           
                                                         COMP SYNC.             
           05  PV-SAVE-FIELDS.                                                  
               10  PV-SAVE-VENDOR           PIC X(05) VALUE SPACES.             
               10  PV-SAVE-BATCH            PIC X(03) VALUE SPACES.             
           05  WS-TESTAMT                   PIC S9(05)V99 VALUE ZEROES.         
                                                                                
       01  DATE-IN.                                                             
           05 DATE-IN-YY                    PIC XX.                             
           05 DATE-IN-MM                    PIC XX.                             
           05 DATE-IN-DD                    PIC XX.                             
      *                                                                         
       01  RUN-TIME.                                                            
           05  R-HR                         PIC 99.                             
           05  R-MIN                        PIC 99.                             
           05  R-SEC                        PIC 99.                             
           05  R-TH                         PIC 99.                             
                                                                                
       EJECT                                                                    
      *                                                                         
       PROCEDURE DIVISION.                                                      
                                                                                
       0000-MLKRP320.                                                           
                                                                                
      ****************************************************************          
      *    OPEN ALL FILES.                                                      
      *    INITIALIZE PAGE HEADINGS                                             
      *    PROCESS AND PRINT RECORDS ON PURCHASE JOURNAL FILE                   
      *    PRINT THE VENDOR TOTALS ON CHANGE IN VENDOR NUMBER                   
      *    PRINT THE BATCH TOTALS ON CHANGE IN BATCH NUMBER                     
      *    PRINT THE GRAND TOTALS WHICH INCLUDE ALL BATCH TOTALS                
      *    AT END-OF-JOB.                                                       
      *    CLOSE ALL FILES.                                                     
      ****************************************************************          
                                                                                
           OPEN INPUT  INP-PRCHJRNL-FILE.                                       
           OPEN OUTPUT OUT-PRCHJRNL-LIST-REPORT.                                
                                                                                
           PERFORM 1000-INITIALIZE-HEADER.                                      
                                                                                
           PERFORM 2000-PROCESS                                                 
               UNTIL INPUT-EOF.                                                 
                                                                                
           IF PV-PAGE-COUNTER > +0                                              
               PERFORM B100-PRINT-VENDOR-TOTALS                                 
               PERFORM B200-PRINT-BATCH-TOTALS                                  
               PERFORM B300-PRINT-GRAND-TOTALS                                  
           END-IF.                                                              
                                                                                
           CLOSE INP-PRCHJRNL-FILE                                              
                 OUT-PRCHJRNL-LIST-REPORT.                                      
                                                                                
           STOP RUN.                                                            
                                                                                
       1000-INITIALIZE-HEADER.                                                  
                                                                                
      ****************************************************************          
      *    SET UP THE STANDARD PAGE HEADER.                                     
      *    ACCEPT THE RUN DATE FROM THE SYSTEM.                                 
      *    PERFORMED BY 0000-MLKRP320.                                          
      ****************************************************************          
           ACCEPT DATE-IN  FROM DATE.                                           
           MOVE DATE-IN-MM TO HL-HEADING2-DATE-MM.                              
           MOVE DATE-IN-DD TO HL-HEADING2-DATE-DD.                              
           MOVE DATE-IN-YY TO HL-HEADING2-DATE-YY.                              
           PERFORM 4000-READ-PRCHJRNL-DATA.                                     
           MOVE ML015-PURCH-VENDOR-INHSE-NMBR TO PV-SAVE-VENDOR.                
           MOVE ML015-PURCH-BATCH-NBR TO PV-SAVE-BATCH.                         
                                                                                
       EJECT                                                                    
                                                                                
       2000-PROCESS.                                                            
                                                                                
      ****************************************************************          
      *    PRINT DETAIL FOR THE CURRENT PURCHASE JOURNAL RECORD AND             
      *    READ THE NEXT INPUT RECORD.                                          
      *                                                                         
      *    PERFORMED BY 0000-MLKRP320.                                          
      ****************************************************************          
                                                                                
           IF ML015-PURCH-BATCH-NBR = PV-SAVE-BATCH                             
               IF ML015-PURCH-VENDOR-INHSE-NMBR = PV-SAVE-VENDOR                
                   CONTINUE                                                     
               ELSE                                                             
                   PERFORM B100-PRINT-VENDOR-TOTALS                             
                   MOVE ML015-PURCH-VENDOR-INHSE-NMBR TO PV-SAVE-VENDOR         
               END-IF                                                           
           ELSE                                                                 
               PERFORM B100-PRINT-VENDOR-TOTALS                                 
               PERFORM B200-PRINT-BATCH-TOTALS                                  
               MOVE ML015-PURCH-VENDOR-INHSE-NMBR TO PV-SAVE-VENDOR             
               MOVE ML015-PURCH-BATCH-NBR TO PV-SAVE-BATCH                      
           END-IF.                                                              
                                                                                
           IF ML015-PURCH-MERCH-AMT NUMERIC                                     
               CONTINUE                                                         
           ELSE                                                                 
               MOVE ZEROES TO ML015-PURCH-MERCH-AMT                             
           END-IF.                                                              
                                                                                
           IF ML015-PURCH-DISCT-AMT NUMERIC                                     
               CONTINUE                                                         
           ELSE                                                                 
               MOVE ZEROES TO ML015-PURCH-DISCT-AMT                             
           END-IF.                                                              
                                                                                
           IF ML015-PURCH-FRGHT-AMT NUMERIC                                     
               CONTINUE                                                         
           ELSE                                                                 
               MOVE ZEROES TO ML015-PURCH-FRGHT-AMT                             
           END-IF.                                                              
                                                                                
           IF ML015-PURCH-NET NUMERIC                                           
               CONTINUE                                                         
           ELSE                                                                 
               MOVE ZEROES TO ML015-PURCH-NET                                   
           END-IF.                                                              
                                                                                
           IF ML015-PURCH-RETAIL NUMERIC                                        
               CONTINUE                                                         
           ELSE                                                                 
               MOVE ZEROES TO ML015-PURCH-RETAIL                                
           END-IF.                                                              
                                                                                
           IF ML015-PURCH-CDE = ('1' OR '5')                                    
               COMPUTE WS-TESTAMT = (ML015-PURCH-MERCH-AMT                      
                                   + ML015-PURCH-FRGHT-AMT) -                   
                                     ML015-PURCH-DISCT-AMT                      
           END-IF.                                                              
      *REVIEW THE FOLLOWING STATEMENT WITH LEE.                                 
      *WHAT HAPPENS WHEN OTHER THAN 1 OR 5?.                                    
           IF WS-TESTAMT = ML015-PURCH-NET                                      
               MOVE SPACES  TO RP-MESSAGE                                       
           ELSE                                                                 
               MOVE 'ERROR' TO RP-MESSAGE                                       
           END-IF.                                                              
           IF ML015-PURCH-TRANS-CDE = ('02' OR '03' OR '04' OR '05' OR          
                            '08' OR '11')                                       
               COMPUTE ML015-PURCH-MERCH-AMT = ML015-PURCH-MERCH-AMT            
                                               * -1                             
               COMPUTE ML015-PURCH-DISCT-AMT = ML015-PURCH-DISCT-AMT            
                                               * -1                             
               COMPUTE ML015-PURCH-FRGHT-AMT = ML015-PURCH-FRGHT-AMT            
                                               * -1                             
               COMPUTE ML015-PURCH-NET = ML015-PURCH-NET * -1                   
               COMPUTE ML015-PURCH-RETAIL = ML015-PURCH-RETAIL * -1             
           END-IF.                                                              
           IF ML015-PURCH-TRANS-CDE = '01'                                      
               COMPUTE ML015-PURCH-DISCT-AMT = ML015-PURCH-DISCT-AMT            
                                               * -1                             
           END-IF.                                                              
           MOVE ML015-PURCH-BATCH-NBR TO RP-BATCH.                              
           MOVE ML015-PURCH-KOHLS-MM TO RP-KM.                                  
           MOVE ML015-PURCH-VENDOR-INHSE-NMBR TO RP-VENDOR.                     
           MOVE ML015-PURCH-DEPT-NBR TO RP-CLASS1.                              
           MOVE ML015-PURCH-CLASS-NBR TO RP-CLASS2.                             
           MOVE ML015-PURCH-DOC-5-NBR TO RP-DOC.                                
           MOVE ML015-PURCH-PO-TYP-CDE TO RP-PO-TYP-CDE.                        
           MOVE ML015-PURCH-STORE-NBR  TO RP-STR-NBR.                           
           MOVE ML015-PURCH-MERCH-AMT TO RP-MERCH.                              
           MOVE ML015-PURCH-DISCT-AMT TO RP-DISCOUNT.                           
           MOVE ML015-PURCH-FRGHT-AMT TO RP-FREIGHT.                            
           MOVE ML015-PURCH-NET  TO RP-NETCOST.                                 
           MOVE ML015-PURCH-RETAIL TO RP-RETAIL.                                
           MOVE ML015-PURCH-TRANS-CDE TO RP-TRCODE.                             
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS.                                       
           PERFORM Z300-PRINT-DETAIL                                            
           ADD ML015-PURCH-MERCH-AMT TO VT-TOTAL-MERCH.                         
           ADD ML015-PURCH-DISCT-AMT TO VT-TOTAL-DISCOUNT.                      
           ADD ML015-PURCH-FRGHT-AMT TO VT-TOTAL-FREIGHT.                       
           ADD ML015-PURCH-NET   TO VT-TOTAL-NETCOST.                           
           ADD ML015-PURCH-RETAIL TO VT-TOTAL-RETAIL.                           
           PERFORM 4000-READ-PRCHJRNL-DATA.                                     
                                                                                
           EJECT                                                                
                                                                                
       B100-PRINT-VENDOR-TOTALS.                                                
                                                                                
      ****************************************************************          
      *    FORMAT THE VENDOR TOTAL PRINT LINE AND ADD VENDOR TOTALS             
      *    TO BATCH TOTALS.                                                     
      *                                                                         
      *    PERFORMED BY 0000-MLKRP320.                                          
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
           MOVE VT-TOTAL-MERCH     TO VEN-TOT-MERCH.                            
           MOVE VT-TOTAL-NETCOST   TO VEN-TOT-NETCOST.                          
           MOVE VT-TOTAL-RETAIL    TO VEN-TOT-RETAIL.                           
                                                                                
           PERFORM Z400-PRINT-VENDOR-TOTALS.                                    
                                                                                
           ADD VT-TOTAL-MERCH      TO BAT-TOTAL-MERCH.                          
           ADD VT-TOTAL-DISCOUNT   TO BAT-TOTAL-DISCOUNT.                       
           ADD VT-TOTAL-FREIGHT    TO BAT-TOTAL-FREIGHT.                        
           ADD VT-TOTAL-NETCOST    TO BAT-TOTAL-NETCOST.                        
           ADD VT-TOTAL-RETAIL     TO BAT-TOTAL-RETAIL.                         
           MOVE ZEROES             TO VT-TOTAL-MERCH                            
                                      VT-TOTAL-DISCOUNT                         
                                      VT-TOTAL-FREIGHT                          
                                      VT-TOTAL-NETCOST                          
                                      VT-TOTAL-RETAIL.                          
       B200-PRINT-BATCH-TOTALS.                                                 
                                                                                
      ****************************************************************          
      *    FORMAT THE BATCH TOTAL PRINT LINE AND ADD BATCH TOTALS               
      *    TO FINAL TOTALS.                                                     
      *                                                                         
      *    PERFORMED BY 0000-MLKRP320.                                          
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
           MOVE BAT-TOTAL-MERCH    TO BAT-TOT-MERCH.                            
           MOVE BAT-TOTAL-DISCOUNT TO BAT-TOT-DISCOUNT.                         
           MOVE BAT-TOTAL-FREIGHT  TO BAT-TOT-FREIGHT.                          
           MOVE BAT-TOTAL-NETCOST  TO BAT-TOT-NETCOST.                          
           MOVE BAT-TOTAL-RETAIL   TO BAT-TOT-RETAIL.                           
                                                                                
           PERFORM Z500-PRINT-BATCH-TOTALS.                                     
                                                                                
           ADD BAT-TOTAL-MERCH     TO GND-TOTAL-MERCH.                          
           ADD BAT-TOTAL-DISCOUNT  TO GND-TOTAL-DISCOUNT.                       
           ADD BAT-TOTAL-FREIGHT   TO GND-TOTAL-FREIGHT.                        
           ADD BAT-TOTAL-NETCOST   TO GND-TOTAL-NETCOST.                        
           ADD BAT-TOTAL-RETAIL    TO GND-TOTAL-RETAIL.                         
           MOVE ZEROES             TO BAT-TOTAL-MERCH                           
                                      BAT-TOTAL-DISCOUNT                        
                                      BAT-TOTAL-FREIGHT                         
                                      BAT-TOTAL-NETCOST                         
                                      BAT-TOTAL-RETAIL.                         
           MOVE ML015-PURCH-VENDOR-INHSE-NMBR TO PV-SAVE-VENDOR.                
           MOVE ML015-PURCH-BATCH-NBR TO PV-SAVE-BATCH.                         
                                                                                
       B300-PRINT-GRAND-TOTALS.                                                 
      ****************************************************************          
      *    FORMAT THE GRAND TOTAL PRINT LINE                                    
      *                                                                         
      *    PERFORMED BY 0000-MLKRP320.                                          
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
           MOVE GND-TOTAL-MERCH    TO GND-TOT-MERCH.                            
           MOVE GND-TOTAL-DISCOUNT TO GND-TOT-DISCOUNT.                         
           MOVE GND-TOTAL-FREIGHT  TO GND-TOT-FREIGHT.                          
           MOVE GND-TOTAL-NETCOST  TO GND-TOT-NETCOST.                          
           MOVE GND-TOTAL-RETAIL   TO GND-TOT-RETAIL.                           
                                                                                
           PERFORM Z600-PRINT-GRAND-TOTALS.                                     
                                                                                
                                                                                
       4000-READ-PRCHJRNL-DATA.                                                 
                                                                                
      ****************************************************************          
      *    READ THE MARKET REPORT DATA FILE.                                    
      *                                                                         
      *    PERFORMED BY 1000-INITIALIZE-HEADER.                                 
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
W26603     READ INP-PRCHJRNL-FILE INTO ML015-PURCHASE-RECORD                    
               AT END                                                           
                   SET INPUT-EOF TO TRUE                                        
               NOT AT END                                                       
                   ADD 1 TO PV-IN-COUNTER.                                      
                                                                                
       6000-PRINT-HEADERS.                                                      
                                                                                
      ****************************************************************          
      *    PRINT THE PAGE HEADERS.                                              
      *                                                                         
      *    PERFORMED BY 1000-INITIALIZE-HEADER.                                 
      ****************************************************************          
                                                                                
           ADD  1               TO PV-PAGE-COUNTER.                             
                                                                                
           MOVE PV-PAGE-COUNTER TO HL-HEADING1-PAGE.                            
                                                                                
           WRITE OUT-PRCHJRNL-LIST-RECORD                                       
               FROM HL-HEADING-LINE1                                            
               AFTER ADVANCING PAGE.                                            
                                                                                
           WRITE OUT-PRCHJRNL-LIST-RECORD                                       
               FROM HL-HEADING-LINE2                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE OUT-PRCHJRNL-LIST-RECORD                                       
               FROM HL-HEADING-LINE3                                            
               AFTER ADVANCING 2 LINE.                                          
                                                                                
           WRITE OUT-PRCHJRNL-LIST-RECORD                                       
               FROM HL-HEADING-LINE4                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE OUT-PRCHJRNL-LIST-RECORD                                       
               FROM HL-HEADING-LINE5-SPACE-LINE                                 
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           MOVE 05 TO PV-LINE-COUNTER.                                          
                                                                                
           EJECT                                                                
                                                                                
       Z300-PRINT-DETAIL.                                                       
                                                                                
      ****************************************************************          
      *    PRINT DETAIL LINE.                                                   
      *                                                                         
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
           WRITE OUT-PRCHJRNL-LIST-RECORD                                       
               FROM RP-REPORT-DETAIL                                            
               AFTER ADVANCING 1 LINE.                                          
           ADD 1 TO PV-LINE-COUNTER.                                            
                                                                                
           EJECT                                                                
                                                                                
       Z400-PRINT-VENDOR-TOTALS.                                                
                                                                                
      ****************************************************************          
      *    PRINT VENDOR TOTAL LINE.                                             
      *                                                                         
      *    PERFORMED BY 2000-PROCESS.                                           
      *    PERFORMED BY 0000-MLKRP320.                                          
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS.                                       
           WRITE OUT-PRCHJRNL-LIST-RECORD                                       
               FROM VEN-TOTAL-LINE                                              
               AFTER ADVANCING 1 LINE.                                          
           ADD 2 TO PV-LINE-COUNTER.                                            
                                                                                
           EJECT                                                                
                                                                                
       Z500-PRINT-BATCH-TOTALS.                                                 
                                                                                
      ****************************************************************          
      *    PRINT BATCH TOTAL LINE.                                              
      *                                                                         
      *    PERFORMED BY 2000-PROCESS.                                           
      *    PERFORMED BY 0000-MLKRP320.                                          
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS.                                       
           WRITE OUT-PRCHJRNL-LIST-RECORD                                       
               FROM BAT-TOT-LINE                                                
               AFTER ADVANCING 3 LINE.                                          
           WRITE OUT-PRCHJRNL-LIST-RECORD                                       
               FROM HL-HEADING-LINE5-SPACE-LINE                                 
               AFTER ADVANCING 2 LINE.                                          
           ADD 5 TO PV-LINE-COUNTER.                                            
                                                                                
           EJECT                                                                
                                                                                
       Z600-PRINT-GRAND-TOTALS.                                                 
                                                                                
      ****************************************************************          
      *    PRINT GRAND TOTAL LINE.                                              
      *                                                                         
      *    PERFORMED BY 2000-PROCESS.                                           
      *    PERFORMED BY 0000-MLKRP320.                                          
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS.                                       
           WRITE OUT-PRCHJRNL-LIST-RECORD                                       
               FROM GND-TOT-LINE                                                
               AFTER ADVANCING 1 LINE.                                          
           ADD 1 TO PV-LINE-COUNTER.                                            
                                                                                
           EJECT                                                                
                                                                                
