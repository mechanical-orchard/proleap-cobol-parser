       IDENTIFICATION DIVISION.                                         00010000
                                                                        00020000
       PROGRAM-ID.             DAKRP100.                                00030016
       AUTHOR.                 BOB MCASEY.                              00040000
       INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
       DATE-WRITTEN.           JULY 2000.                               00060000
       DATE-COMPILED.                                                   00070000
                                                                        00080000
      ***************************************************************** 00090000
      *  PROGRAM NARRATIVE:                                           * 00100000
      *  THIS PROGRAM READS AN EXTRACT FROM THE DEBIT ALLOWANCE ORACLE* 00110000
      *  ONLINE APPLICATION AND CREATES A REPORT OF DEBIT ALLOWANCE   * 00120000
      *  PRICE CHANGE AMOUNTS BY DEPARTMENT WITHIN BATCH #.           * 00130000
      ***************************************************************** 00140028
      *    WR/PITS#     DATE        DESCRIPTION                       * 00150028
      *    --------   ----------   ---------------------------------  * 00160028
0701RM*   WR22467     07/20/2001   CHANGED RECORD LENGTH OF AP TRANS  * 00170028
      *                            FILE AND ALL PROCESSING ASSOCIATE  * 00180028
      *                            WITH IT.                           * 00190028
      *   WR23724     05/15/2002   RECOMPILED FOR CHANGES IN COPYBOOK * 00200029
      *                            APRD045                            * 00210029
      *---------------------------------------------------------------* 00220028
      *                                                                 00230000
      /                                                                 00240000
       ENVIRONMENT DIVISION.                                            00250000
                                                                        00260000
       CONFIGURATION SECTION.                                           00270000
                                                                        00280000
       SOURCE-COMPUTER.                        IBM-3090.                00290000
       OBJECT-COMPUTER.                        IBM-3090.                00300000
                                                                        00310000
       INPUT-OUTPUT SECTION.                                            00320000
                                                                        00330000
       FILE-CONTROL.                                                    00340000
                                                                        00350000
           SELECT  AP-TRANS-FILE             ASSIGN TO INP01.           00360023
                                                                        00370000
           SELECT CONTROL-CARD-FILE          ASSIGN TO INP02.           00380021
                                                                        00390021
           SELECT  REPORT-FILE               ASSIGN RPT01.              00400021
                                                                        00410021
      ******************************************************************00420000
       DATA DIVISION.                                                   00430000
      ******************************************************************00440000
                                                                        00450000
       FILE SECTION.                                                    00460000
      *                                                                 00470000
       FD  AP-TRANS-FILE                                                00480023
           LABEL RECORDS ARE STANDARD                                   00490000
           RECORDING MODE IS F                                          00500000
           BLOCK CONTAINS 0 RECORDS.                                    00510000
0701RM*01  AP-TRANS-REC                  PIC X(450).                    00520028
0701RM 01  AP-TRANS-REC                  PIC X(550).                    00530028
                                                                        00540000
       FD  CONTROL-CARD-FILE                                            00550021
           RECORDING MODE IS F                                          00560021
           LABEL RECORDS ARE STANDARD                                   00570021
           BLOCK CONTAINS 0 RECORDS.                                    00580021
                                                                        00590021
       01  CONTROL-CARD-RECORD           PIC X(80).                     00600021
                                                                        00610021
       FD  REPORT-FILE                                                  00620000
           RECORDING MODE F                                             00630000
           LABEL RECORDS OMITTED                                        00640000
           BLOCK CONTAINS  0 RECORDS.                                   00650000
       01  REPORT-RECORD.                                               00660000
           05  REPORT-LINE               PIC X(80).                     00670000
      *                                                                 00680000
                                                                        00690000
      *                                                                 00700000
       WORKING-STORAGE SECTION.                                         00710000
                                                                        00720000
       01  ABEND-CODE                PIC S9(04) VALUE ZERO              00730001
                                                       COMP SYNC.       00740001
                                                                        00750001
       01  PA-PROGRAM-ACCUMULATORS.                                     00760000
           05  PA-LINE-NO            PIC S9(03)    COMP-3 VALUE 0.      00770001
           05  PA-PAGE-COUNT         PIC S9(05)    COMP-3 VALUE 0.      00780001
           05  PA-IN-COUNT           PIC S9(09)    COMP-3 VALUE 0.      00790001
           05  PA-TOTAL-READ         PIC S9(09)    COMP-3 VALUE 0.      00800001
           05  PA-AP-TOTAL-WRITTEN   PIC S9(09)    COMP-3 VALUE 0.      00810001
           05  PA-DA-TOTAL-WRITTEN   PIC S9(09)    COMP-3 VALUE 0.      00820001
           05  PA-TOTAL-CREDIT-AMT   PIC S9(09)V99 COMP-3 VALUE 0.      00830001
           05  PA-TOTAL-RTL-AMT      PIC S9(09)V99 COMP-3 VALUE 0.      00840001
           05  PA-DEPT-RTL           PIC S9(09)V99 COMP-3 VALUE 0.      00850001
           05  PA-DEPT-COST          PIC S9(09)V99 COMP-3 VALUE 0.      00860001
           05  PA-TOTAL-RTL          PIC S9(09)V99 COMP-3 VALUE 0.      00870001
           05  PA-TOTAL-COST         PIC S9(09)V99 COMP-3 VALUE 0.      00880001
                                                                        00890000
       01  PC-CONSTANTS.                                                00900000
           05  PC-OPERCO-NBR         PIC  X(02) VALUE '03'.             00910002
           05  PC-MDSELV-DPT         PIC  X(03) VALUE 'DPT'.            00920002
           05  PC-DAK001-JOB         PIC  X(06) VALUE 'DAK001'.         00930018
           05  PC-DAKRP100-PGM       PIC  X(08) VALUE 'DAKRP100'.       00940016
           05  PC-DEPT-DESC          PIC  X(13) VALUE 'DEPT TOTAL:  '.  00950005
           05  PC-TOTAL-DESC         PIC  X(13) VALUE 'REPORT TOTAL:'.  00960001
           05  PC-NO-INPUT-MSG       PIC  X(80) VALUE                   00970001
               '          =====> NO INPUT <====                      '. 00980007
           05  PC-END-RPT-MSG        PIC  X(80) VALUE                   00990007
               '          * * *  END OF REPORT  * * *                '. 01000007
           05  PC-MAX-LINES          PIC S9(03)  VALUE 79.              01010014
                                                                        01020000
       01  PS-SWITCHES.                                                 01030000
           05  PS-EOF-EXTRACT-SWITCH PIC  X(01) VALUE 'N'.              01040001
               88  PS-EOF-EXTRACT                      VALUE 'Y'.       01050000
                                                                        01060000
       01  PV-VARIABLES.                                                01070000
           05  PV-PREV-DEPT-NBR       PIC X(03)     VALUE SPACES.       01080016
           05  PV-BTCH-SRC-CDE        PIC X(03)     VALUE SPACES.       01090016
           05  PV-RUN-TIME            PIC X(08)     VALUE SPACES.       01100016
           05  PV-RUN-DATE            PIC X(10)     VALUE SPACES.       01110016
           05  PV-PARAGRAPH           PIC X(30)     VALUE SPACES.       01120016
           05  PV-OPERATION-ATTEMPTED PIC X(40)     VALUE SPACES.       01130016
           05  PV-ABEND-MESSAGE       PIC X(75)     VALUE SPACES.       01140016
           05  PV-TOTAL-CREDITS       PIC S9(09)V99 COMP-3 VALUE 0.     01150016
           05  PV-TOTAL-CREDIT-AMT    PIC S9(09)V99 COMP-3 VALUE 0.     01160016
           05  PV-STMT-DTL-SEQ-NBR    PIC S9(05)    COMP-3 VALUE 0.     01170016
           05  PV-DISP-NUMBER         PIC Z,ZZZ,ZZ9.                    01180016
           05  PV-EFF-DTE-TIME.                                         01190000
               10  PV-EFF-DTE         PIC X(10).                        01200016
               10  PV-EFF-TIME        PIC X(09).                        01210016
                                                                        01220000
                                                                        01230000
      ***************************************************************** 01240000
      *  KOHL'S STANDARD FIRST HEADING LINE                             01250000
      ***************************************************************** 01260000
           COPY DPWS075O.                                               01270000
      *                                                                 01280000
       01  H2-HEADING2.                                                 01290000
           05  FILLER                PIC X(16) VALUE SPACES.            01300002
           05  FILLER                PIC X(40) VALUE                    01310002
           'DEBIT ALLOWANCE PRICE CHANGES BY DEPT'.                     01320000
           05  FILLER                PIC X(08) VALUE SPACES.            01330000
           05  FILLER                PIC X(05) VALUE 'JOB: '.           01340000
           05  H2-JOB-NAME           PIC X(06) VALUE SPACES.            01350000
                                                                        01360000
       01  H3-HEADING3.                                                 01370007
           05  FILLER                PIC X(33) VALUE SPACES.            01380007
           05  FILLER                PIC X(07) VALUE 'BATCH: '.         01390007
           05  H3-BATCH-NBR          PIC X(03) VALUE SPACES.            01400007
           05  FILLER                PIC X(32) VALUE SPACES.            01410007
                                                                        01420000
       01  H4-HEADING4.                                                 01430007
           05  FILLER                PIC X(02) VALUE SPACES.            01440007
           05  FILLER                PIC X(06) VALUE 'DEPT: '.          01450007
           05  H4-DEPT-NBR           PIC X(03) VALUE SPACES.            01460007
           05  FILLER                PIC X(01) VALUE SPACES.            01470007
           05  H4-DEPT-NAME          PIC X(25) VALUE SPACES.            01480007
           05  FILLER                PIC X(38) VALUE SPACES.            01490007
                                                                        01500007
       01  H5-HEADING5.                                                 01510007
           05  FILLER                PIC X(02) VALUE SPACES.            01520000
           05  FILLER                PIC X(12) VALUE 'PRICE CHANGE'.    01530000
           05  FILLER                PIC X(06) VALUE SPACES.            01540000
           05  FILLER                PIC X(15) VALUE                    01550000
              'DEBIT ALLOWANCE'.                                        01560000
           05  FILLER                PIC X(14) VALUE SPACES.            01570003
           05  FILLER                PIC X(04) VALUE 'COST'.            01580000
           05  FILLER                PIC X(11) VALUE SPACES.            01590000
           05  FILLER                PIC X(06) VALUE 'RETAIL'.          01600000
           05  FILLER                PIC X(05) VALUE SPACES.            01610003
                                                                        01620000
       01  DL1-DETAIL-LINE-1.                                           01630000
           05  FILLER                PIC X(05)     VALUE SPACES.        01640003
           05  DL1-CENPPC-NBR        PIC ZZZZZZ9   VALUE SPACES.        01650027
           05  FILLER                PIC X(10)     VALUE SPACES.        01660003
           05  DL1-DR-ALW-NBR        PIC X(16)     VALUE SPACES.        01670000
           05  FILLER                PIC X(05)     VALUE SPACES.        01680003
           05  DL1-COST-AMT          PIC ZZZZZZZZ9.99-.                 01690002
           05  FILLER                PIC X(05)     VALUE SPACES.        01700003
           05  DL1-RETAIL-AMT        PIC ZZZZZZZZ9.99-.                 01710002
           05  FILLER                PIC X(01)     VALUE SPACES.        01720003
                                                                        01730000
       01  TL1-TOTAL-LINE-1.                                            01740000
           05  FILLER                PIC X(02)     VALUE SPACES.        01750003
           05  TL1-DESC              PIC X(13)     VALUE SPACES.        01760001
           05  FILLER                PIC X(28)     VALUE SPACES.        01770005
           05  TL1-COST-AMT          PIC ZZZZZZZZ9.99-.                 01780002
           05  FILLER                PIC X(05)     VALUE SPACES.        01790006
           05  TL1-RETAIL-AMT        PIC ZZZZZZZZ9.99-.                 01800002
           05  FILLER                PIC X(01)     VALUE SPACES.        01810005
                                                                        01820000
      ***************************************************************** 01830000
      *  INPUT A/P RECORD LAYOUT  PLUS ADDITIONAL FIELDS              * 01840023
      ***************************************************************** 01850000
           COPY APRD045.                                                01860023
           05  PV-APRD045-BATCH-NBR    PIC X(03).                       01870023
           05  PV-APRD045-CENPPC-NBR   PIC S9(07)    COMP-3.            01880023
           05  PV-APRD045-RTL-AMT      PIC S9(09)V99 COMP-3.            01890023
           05  PV-APRD045-NET-CST-AMT  PIC S9(09)V99 COMP-3.            01900023
           05  PV-APRD045-EFF-DTE      PIC X(19).                       01910023
           05  FILLER                  PIC X(12).                       01920024
                                                                        01930000
      ****************************************************************  01940021
      * RECORD LAYOUT FOR CONTROL CARD FILE.                            01950021
      ****************************************************************  01960021
       01  CC-CONTROL-CARD.                                             01970021
           05  CC-CTL-DTE                   PIC X(10).                  01980021
           05  CC-CTL-FILLER                PIC X(70).                  01990021
                                                                        02000021
015300****************************************************************  02010001
015400* MBS MERCHANDISE AREA TABLE                                      02020001
015500****************************************************************  02030001
015600     EXEC SQL                                                     02040001
015700         INCLUDE TMDSEAR                                          02050001
015800     END-EXEC.                                                    02060001
015900                                                                  02070001
018800****************************************************************  02080001
018900*  COMMUNICATION AREAS FOR DB2                                    02090001
019000****************************************************************  02100001
019100     EXEC SQL                                                     02110001
019200         INCLUDE SQLCA                                            02120001
019300     END-EXEC.                                                    02130001
019400                                                                  02140001
046800****************************************************              02150002
046900*  ERROR MESSAGE AREA FOR DB2                      *              02160002
047000****************************************************              02170002
047100     COPY DPWS004.                                                02180002
047200                                                                  02190002
      *                                                                 02200000
       PROCEDURE DIVISION.                                              02210000
                                                                        02220000
       0000-DAKRP100.                                                   02230016
                                                                        02240000
           PERFORM 1000-INITIALIZE                                      02250000
                                                                        02260000
           PERFORM 2000-PROCESS-EXTRACT                                 02270000
               UNTIL PS-EOF-EXTRACT.                                    02280000
                                                                        02290000
           PERFORM 9000-EOJ.                                            02300000
                                                                        02310000
           GOBACK.                                                      02320000
                                                                        02330000
                                                                        02340000
       1000-INITIALIZE.                                                 02350000
                                                                        02360000
           OPEN INPUT  AP-TRANS-FILE                                    02370023
                       CONTROL-CARD-FILE.                               02380021
           OPEN OUTPUT REPORT-FILE.                                     02390000
           PERFORM 8000-READ-CONTROL-CARD-FILE.                         02400021
                                                                        02410021
           PERFORM 8200-READ-EXTRACT.                                   02420021
                                                                        02430000
           MOVE CC-CTL-DTE   (3:2)           TO DP075O-RUN-YEAR.        02440021
           MOVE CC-CTL-DTE   (6:2)           TO DP075O-RUN-MONTH.       02450022
           MOVE CC-CTL-DTE   (9:2)           TO DP075O-RUN-DAY.         02460022
           MOVE FUNCTION CURRENT-DATE (9:2)  TO DP075O-RUN-HOUR.        02470000
           MOVE FUNCTION CURRENT-DATE (11:2) TO DP075O-RUN-MINUTE.      02480000
           MOVE PC-DAKRP100-PGM              TO DP075O-PROGRAM-NAME.    02490016
           MOVE 1                            TO DP075O-REPORT-NUMBER.   02500000
                                                                        02510000
           PERFORM 4000-WRITE-REPORT-HEADING.                           02520007
           IF PS-EOF-EXTRACT                                            02530000
               DISPLAY 'NO DA INPUT -- REPORT WILL BE EMPTY'            02540001
           ELSE                                                         02550007
               PERFORM 4200-SUB-HEADINGS                                02560007
           END-IF.                                                      02570007
                                                                        02580000
       2000-PROCESS-EXTRACT.                                            02590000
                                                                        02600000
           IF AP045-DEPT-NBR =  PV-PREV-DEPT-NBR                        02610023
               CONTINUE                                                 02620000
           ELSE                                                         02630000
               PERFORM 5400-WRITE-DEPT-TOTALS                           02640001
               PERFORM 4200-SUB-HEADINGS                                02650002
           END-IF.                                                      02660000
                                                                        02670000
           MOVE PV-APRD045-CENPPC-NBR  TO DL1-CENPPC-NBR.               02680023
           MOVE AP045-DOC-NBR          TO DL1-DR-ALW-NBR.               02690023
           MOVE PV-APRD045-NET-CST-AMT TO DL1-COST-AMT.                 02700023
                                                                        02710000
           MOVE PV-APRD045-RTL-AMT     TO DL1-RETAIL-AMT.               02720023
                                                                        02730000
           ADD PV-APRD045-RTL-AMT      TO PA-DEPT-RTL.                  02740023
           ADD PV-APRD045-NET-CST-AMT  TO PA-DEPT-COST.                 02750023
                                                                        02760000
           PERFORM 5000-WRITE-REPORT-LINE.                              02770013
           PERFORM 8200-READ-EXTRACT.                                   02780021
                                                                        02790000
                                                                        02800000
       4000-WRITE-REPORT-HEADING.                                       02810000
      ******************************************************************02820000
      *   4000-WRITE-REPORT-HEADING                                    *02830000
      *      PRINT HEADING LINES                                       *02840000
      ******************************************************************02850000
                                                                        02860000
                                                                        02870000
           ADD 1                               TO PA-PAGE-COUNT.        02880000
           MOVE PA-PAGE-COUNT                  TO DP075O-PAGE-NUMBER.   02890000
           MOVE DP075O-STANDARD-HEADER-75-COLS TO REPORT-RECORD.        02900002
           WRITE REPORT-RECORD                                          02910000
                   AFTER ADVANCING PAGE.                                02920000
                                                                        02930000
           MOVE PC-DAK001-JOB                  TO H2-JOB-NAME.          02940018
           MOVE H2-HEADING2                    TO REPORT-RECORD.        02950000
           WRITE REPORT-RECORD                                          02960000
                   AFTER ADVANCING 1 LINE.                              02970000
                                                                        02980000
           MOVE PV-APRD045-BATCH-NBR TO H3-BATCH-NBR.                   02990023
           MOVE H3-HEADING3    TO REPORT-RECORD.                        03000010
           WRITE REPORT-RECORD                                          03010010
               AFTER ADVANCING 1 LINE.                                  03020010
                                                                        03030001
           MOVE 3                              TO PA-LINE-NO.           03040020
       4200-SUB-HEADINGS.                                               03050001
                                                                        03060001
           IF PA-LINE-NO > PC-MAX-LINES                                 03070002
               PERFORM 4000-WRITE-REPORT-HEADING                        03080002
           END-IF.                                                      03090002
                                                                        03100002
           MOVE AP045-DEPT-NBR  TO H4-DEPT-NBR.                         03110023
           PERFORM 7000-RETRIVE-DEPT-NAME.                              03120001
           MOVE MDSEAR-DESC    TO H4-DEPT-NAME.                         03130007
           MOVE H4-HEADING4    TO REPORT-RECORD.                        03140007
           WRITE REPORT-RECORD                                          03150001
               AFTER ADVANCING 2 LINES.                                 03160002
           MOVE H5-HEADING5    TO REPORT-RECORD.                        03170007
           WRITE REPORT-RECORD                                          03180001
               AFTER ADVANCING 1 LINES.                                 03190002
                                                                        03200001
           ADD 3 TO PA-LINE-NO.                                         03210014
           MOVE AP045-DEPT-NBR  TO PV-PREV-DEPT-NBR.                    03220025
                                                                        03230014
       5000-WRITE-REPORT-LINE.                                          03240013
                                                                        03250000
           IF PA-LINE-NO > PC-MAX-LINES                                 03260000
               PERFORM 4000-WRITE-REPORT-HEADING                        03270000
               PERFORM 4200-SUB-HEADINGS                                03280012
           END-IF.                                                      03290000
                                                                        03300000
           WRITE REPORT-RECORD FROM DL1-DETAIL-LINE-1                   03310000
                  AFTER ADVANCING 1 LINES.                              03320000
           ADD 1 TO PA-LINE-NO.                                         03330011
                                                                        03340000
       5400-WRITE-DEPT-TOTALS.                                          03350001
           MOVE PC-DEPT-DESC     TO TL1-DESC.                           03360001
           MOVE PA-DEPT-RTL      TO TL1-RETAIL-AMT.                     03370001
           MOVE PA-DEPT-COST     TO TL1-COST-AMT.                       03380001
                                                                        03390001
           IF PA-LINE-NO > PC-MAX-LINES                                 03400020
               PERFORM 4000-WRITE-REPORT-HEADING                        03410020
               PERFORM 4200-SUB-HEADINGS                                03420020
           END-IF.                                                      03430020
                                                                        03440020
           WRITE REPORT-RECORD FROM TL1-TOTAL-LINE-1                    03450003
                  AFTER ADVANCING 2 LINES.                              03460002
           ADD 2 TO PA-LINE-NO.                                         03470013
                                                                        03480001
           ADD  PA-DEPT-RTL      TO PA-TOTAL-RTL.                       03490002
           ADD  PA-DEPT-COST     TO PA-TOTAL-COST.                      03500002
                                                                        03510001
           MOVE 0                TO PA-DEPT-RTL                         03520001
                                    PA-DEPT-COST.                       03530001
                                                                        03540001
                                                                        03550001
       5600-WRITE-RPT-TOTALS.                                           03560001
           MOVE PC-TOTAL-DESC   TO TL1-DESC.                            03570002
           MOVE PA-TOTAL-RTL    TO TL1-RETAIL-AMT.                      03580002
           MOVE PA-TOTAL-COST   TO TL1-COST-AMT.                        03590002
                                                                        03600001
           IF PA-LINE-NO > PC-MAX-LINES                                 03610020
               PERFORM 4000-WRITE-REPORT-HEADING                        03620020
               PERFORM 4200-SUB-HEADINGS                                03630020
           END-IF.                                                      03640020
                                                                        03650020
           WRITE REPORT-RECORD FROM TL1-TOTAL-LINE-1                    03660003
                  AFTER ADVANCING 3 LINES.                              03670002
                                                                        03680001
046500                                                                  03690000
038000***************************************************************** 03700000
038100* GET THE DEPARTMENT NAME                                         03710017
038200***************************************************************** 03720000
038300 7000-RETRIVE-DEPT-NAME.                                          03730002
038400                                                                  03740000
           MOVE PV-APRD045-EFF-DTE            TO PV-EFF-DTE-TIME.       03750023
                                                                        03760002
038500     EXEC SQL                                                     03770000
039200        SELECT MDSEAR_DESC                                        03780000
040300        INTO  :MDSEAR-DESC                                        03790000
040800         FROM TMDSEAR                                             03800000
041500        WHERE OPERCO_NBR = :PC-OPERCO-NBR                         03810000
041800          AND MDSELV_CDE = :PC-MDSELV-DPT                         03820000
042300          AND DEPT_NBR   = :AP045-DEPT-NBR                        03830023
042500          AND :PV-EFF-DTE BETWEEN STRT_DTE AND END_DTE            03840002
042900                                                                  03850000
044400     END-EXEC.                                                    03860000
044500                                                                  03870000
044600     EVALUATE TRUE                                                03880000
044700         WHEN SQLCODE = ZERO                                      03890000
044800             CONTINUE                                             03900002
044900         WHEN SQLCODE = +100                                      03910000
045100             DISPLAY ' '                                          03920000
045200             DISPLAY 'MBS INFO NOT FOUND FOR '                    03930000
 45300                    'DEPT ' MDSEAR-DEPT-NBR                       03940000
                   MOVE 'MISSING DEPT DESC' TO MDSEAR-DESC              03950007
045800         WHEN OTHER                                               03960000
045900             MOVE '8100-GET-EFF-MBS-DEPT-INFO'                    03970000
046000                                    TO PV-PARAGRAPH               03980002
046100             MOVE 'SELECT ROW FROM TMDSEAR/TRSPBAR'               03990000
046200                                    TO PV-OPERATION-ATTEMPTED     04000002
046300             PERFORM 9999-ABEND                                   04010002
046400     END-EVALUATE.                                                04020000
046500                                                                  04030000
      *----------------------------------------------------------------*04040021
      *  READ CONTROL CARD FILE                                         04050021
      *----------------------------------------------------------------*04060021
       8000-READ-CONTROL-CARD-FILE.                                     04070021
                                                                        04080021
           READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD.                 04090021
                                                                        04100021
       8200-READ-EXTRACT.                                               04110021
           READ AP-TRANS-FILE INTO AP045-TRANSACTION-FILE               04120023
           AT END                                                       04130000
               SET PS-EOF-EXTRACT           TO TRUE                     04140000
           NOT AT END                                                   04150000
               ADD 1                        TO PA-TOTAL-READ            04160000
           END-READ.                                                    04170000
                                                                        04180000
      *************************************************************     04190000
      *  9000-EOJ IS PERFORMED FROM 0000-DAKRP100.  IT PRODUCES   *     04200016
      *  A 'NO ERROR MESSAGE' ON THE REPORT IF NONE WERE FOUND    *     04210000
      *  IF ERRORS WERE FOUND, THE RETURN CODE IS SET TO 4095     *     04220000
      *  WHICH IS USED TO ALERT THE ML TEAM VIA AN EMAIL THAT     *     04230000
      *  ERRORS OCCURED.  RECORD COUNTS ARE ALSO DISPLAYED.       *     04240000
      *************************************************************     04250000
       9000-EOJ.                                                        04260000
                                                                        04270000
           IF PA-TOTAL-READ = ZERO                                      04280001
              WRITE REPORT-RECORD FROM PC-NO-INPUT-MSG                  04290001
                    AFTER ADVANCING 5 LINES                             04300000
           ELSE                                                         04310001
               PERFORM 5400-WRITE-DEPT-TOTALS                           04320001
               PERFORM 5600-WRITE-RPT-TOTALS                            04330001
           END-IF.                                                      04340000
                                                                        04350000
           WRITE REPORT-RECORD FROM PC-END-RPT-MSG                      04360007
                AFTER ADVANCING 5 LINES                                 04370007
                                                                        04380007
           CLOSE AP-TRANS-FILE                                          04390023
                 CONTROL-CARD-FILE                                      04400021
                 REPORT-FILE.                                           04410002
                                                                        04420000
           DISPLAY SPACES.                                              04430000
           MOVE PA-TOTAL-READ        TO PV-DISP-NUMBER.                 04440000
           DISPLAY 'RECS READ    =    ' PV-DISP-NUMBER.                 04450000
                                                                        04460000
       9999-ABEND.                                                      04470002
      ******************************************************************04480000
      *   9999-ABEND.                                                  *04490002
      *      ERROR ABEND ROUTINE                                       *04500000
      ******************************************************************04510000
                                                                        04520000
           MOVE +4013                 TO ABEND-CODE.                    04530002
           DISPLAY '**  ABEND     **'.                                  04540002
           DISPLAY '**  PROGRAM   ** => ' PC-DAKRP100-PGM.              04550016
           DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH.                 04560002
           DISPLAY '**  OPERATION **  = ' PV-OPERATION-ATTEMPTED.       04570002
                                                                        04580002
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         04590002
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        04600002
                                                                        04610002
           COPY DPPD004.                                                04620002
           CALL 'ILBOABN0' USING ABEND-CODE.                            04630000
