       IDENTIFICATION DIVISION.                                         00010000
                                                                        00020000
       PROGRAM-ID.    ETKUT160.                                         00030006
       AUTHOR.        COGNIZANT.                                        00040000
       DATE-WRITTEN.  06/01/2016.                                       00050007
       DATE-COMPILED.                                                   00060000
                                                                        00070000
      ******************************************************************00080000
      *  THIS PROGRAM SPLITS THE VMI SALES HISTORY DATA INTO 4 FILES   *00090005
      *                                                                *00100005
      ******************************************************************00110000
      *   INPUT                                                        *00120000
      *     1. VMI SALES HISTORY FULL FILE                             *00130000
      *                                                                *00140000
      *   OUTPUT:                                                      *00150000
      *     1. FIRST SPLIT FILE WITH  0 TO 20 VENDORS                 * 00160004
      *                                                                *00170000
      *     2. SECOND SPLIT FILE WITH NEXT 20 - 50 VENDORS             *00171004
      *                                                                *00172000
      *     3. THIRD  SPLIT FILE WITH NEXT 51 - 90 VENDORS             *00172104
      *                                                                *00172204
      *     4. FOURTH SPLIT FILE WITH MORE THAN 90 VENDORS             *00172304
      *                                                                *00172404
      ************************************************************* * * 00200000
      **  PROD DATE  INIT  CHNG CNTL   DESCRIPTION                  *   00210000
      **  ---------- ----  ---------   ---------------------------- *   00220000
      **  06/01/2016  CTS  CHG0143054  INITIAL VERSION.                *00230007
      *                                                                *00240000
      ******************************************************************00260000
       ENVIRONMENT DIVISION.                                            00270000
      ******************************************************************00280000
       CONFIGURATION SECTION.                                           00290000
                                                                        00300000
       INPUT-OUTPUT SECTION.                                            00310000
                                                                        00320000
       FILE-CONTROL.                                                    00330000
                                                                        00340000
           SELECT INPUT-FILE                                            00350000
               ASSIGN TO INP01.                                         00360000
                                                                        00370000
           SELECT OUTPUT-FILE1                                          00380000
               ASSIGN TO OUT01.                                         00390000
                                                                        00400000
           SELECT OUTPUT-FILE2                                          00410000
               ASSIGN TO OUT02.                                         00420000
                                                                        00421000
           SELECT OUTPUT-FILE3                                          00422000
               ASSIGN TO OUT03.                                         00423000
                                                                        00423101
           SELECT OUTPUT-FILE4                                          00423201
               ASSIGN TO OUT04.                                         00423301
                                                                        00424000
      ******************************************************************00441000
       DATA DIVISION.                                                   00450000
      ******************************************************************00461000
       FILE SECTION.                                                    00470000
                                                                        00480000
       FD  INPUT-FILE                                                   00490000
           LABEL RECORDS ARE STANDARD                                   00500000
           BLOCK CONTAINS 0 RECORDS                                     00510000
           RECORD CONTAINS 150 CHARACTERS                               00520000
           DATA RECORD IS ET115-PRODUCT-ACTIVITY-RECORD.                00530000
                                                                        00540000
      ******************************************************************00541000
      * VMI SALES DATA FILE LAYOUT COPYBOOK.                            00542000
      ******************************************************************00543000
           COPY ETRD115.                                                00550000
                                                                        00560000
                                                                        00570000
       FD  OUTPUT-FILE1                                                 00580000
           LABEL RECORDS ARE STANDARD                                   00590000
           BLOCK CONTAINS 0 RECORDS                                     00600000
           RECORD CONTAINS 150 CHARACTERS                               00610000
           DATA RECORD IS OUTPUT-RECORD1.                               00620000
                                                                        00630000
       01  OUTPUT-RECORD1                   PIC X(150).                 00640000
                                                                        00650000
                                                                        00660000
       FD  OUTPUT-FILE2                                                 00670000
           LABEL RECORDS ARE STANDARD                                   00680000
           BLOCK CONTAINS 0 RECORDS                                     00690000
           RECORD CONTAINS 150 CHARACTERS                               00700000
           DATA RECORD IS OUTPUT-RECORD2.                               00710000
                                                                        00720000
       01  OUTPUT-RECORD2                   PIC X(150).                 00730000
                                                                        00731000
       FD  OUTPUT-FILE3                                                 00732000
           LABEL RECORDS ARE STANDARD                                   00733000
           BLOCK CONTAINS 0 RECORDS                                     00734000
           RECORD CONTAINS 150 CHARACTERS                               00735000
           DATA RECORD IS OUTPUT-RECORD3.                               00736000
                                                                        00737000
       01  OUTPUT-RECORD3                   PIC X(150).                 00738000
                                                                        00739000
                                                                        00740001
       FD  OUTPUT-FILE4                                                 00750001
           LABEL RECORDS ARE STANDARD                                   00751001
           BLOCK CONTAINS 0 RECORDS                                     00752001
           RECORD CONTAINS 150 CHARACTERS                               00753001
           DATA RECORD IS OUTPUT-RECORD4.                               00754001
                                                                        00755001
       01  OUTPUT-RECORD4                   PIC X(150).                 00756001
                                                                        00757001
       WORKING-STORAGE SECTION.                                         00760000
                                                                        00770000
       01  WS-HDR-RECORD-COUNT            PIC 9(3).                     00810000
                                                                        00820000
       01  WS-RECORD-COUNT1               PIC 9(10).                    00830000
                                                                        00840000
       01  WS-RECORD-COUNT2               PIC 9(10).                    00850000
                                                                        00851000
       01  WS-RECORD-COUNT3               PIC 9(10).                    00852000
                                                                        00852101
       01  WS-RECORD-COUNT4               PIC 9(10).                    00852201
                                                                        00853000
       01  OUTPUT-FILE-SW                 PIC X(1)    VALUE '1'.        00870000
           88  OUTPUT-FILE1-ACTIVE                    VALUE 'Y'.        00880000
           88  OUTPUT-FILE2-ACTIVE                    VALUE 'Y'.        00881000
           88  OUTPUT-FILE3-ACTIVE                    VALUE 'Y'.        00882000
                                                                        00890000
      ******************************************************************00890100
      *                         PROGRAM VARIABLE                        00890200
      ******************************************************************00890300
                                                                        00890400
       01  PV-VARIABLES.                                                00890500
           05  PV-READ-COUNT               PIC 9(10)   VALUE ZEROS.     00890600
           05  PV-TALLY-CNTR               PIC 9(03).                   00890700
           05  PV-TOTAL-COUNT              PIC 9(10).                   00890800
                                                                        00890900
       01  PV-INPUT-FILE.                                               00891000
           05  PV-INPUT-RECORD             PIC X(02)   VALUE SPACES.    00891100
                                                                        00891200
      ******************************************************************00891300
      *                         SWITCHES                                00892000
      ******************************************************************00893000
       01  PROGRAM-SWITCHES.                                            00900000
         05  END-OF-INPUT-FILE-SW           PIC X(1)    VALUE 'N'.      00910000
             88  PS-END-OF-INPUT-FILE                   VALUE 'Y'.      00920000
             88  PS-NOT-END-OF-FILE                     VALUE 'N'.      00930000
      ******************************************************************00940000
       PROCEDURE DIVISION.                                              00950000
      ******************************************************************00960000
      ******************************************************************00960100
      * CONTROLS THE MAIN PROCESSING OF THE PROGRAM.                    00960200
      ******************************************************************00960300
           PERFORM 1000-INITIALIZE.                                     00970000
      *                                                                 00980000
           PERFORM 1000-PROCESS-FILE                                    00990000
                 UNTIL PS-END-OF-INPUT-FILE.                            01000000
      *                                                                 01010000
           PERFORM 4000-END-OF-JOB.                                     01020000
                                                                        01030000
           GOBACK.                                                      01040000
      *                                                                 01050000
      *                                                                 01050100
      ******************************************************************01051000
      *  PERFORMS PROGRAM INITIALIZATION TASKS:                         01053000
      *    -- OPENS INPUT  FILE (SRC FILE)                              01054000
      *    -- OPENS THE 4 OUTPUT FILES (SPLIT FILE 1,2,3,4)             01055003
      *    -- PERFORMS FIRST READ OF INPUT FILE                         01056000
      ******************************************************************01057000
       1000-INITIALIZE.                                                 01060000
                                                                        01070000
                                                                        01080000
           OPEN INPUT  INPUT-FILE.                                      01090000
           OPEN OUTPUT OUTPUT-FILE1.                                    01100000
           OPEN OUTPUT OUTPUT-FILE2.                                    01110000
           OPEN OUTPUT OUTPUT-FILE3.                                    01120000
           OPEN OUTPUT OUTPUT-FILE4.                                    01121001
           PERFORM 3000-READ-INPUT-FILE.                                01130000
                                                                        01130100
      ******************************************************************01130500
      * PROCESSES THE INPUT FILE BASED ON THE TYPE OF THE HEADER RECORD 01131000
      * AND NO. OF 01'S PRESENT AND SENDS IT ACCORDINGLY TO THE SPLIT   01132000
      * FILES.                                                          01133000
      ******************************************************************01134000
       3000-READ-INPUT-FILE.                                            01160000
                                                                        01210000
           READ INPUT-FILE                                              01210100
           AT END                                                       01210200
             SET PS-END-OF-INPUT-FILE TO TRUE                           01210300
                                                                        01210400
           END-READ.                                                    01210500
           IF  PS-NOT-END-OF-FILE                                       01210600
           ADD +1                      TO  PV-TOTAL-COUNT               01210700
           MOVE ET115-PRODUCT-ACTIVITY-RECORD(1:2) TO PV-INPUT-RECORD   01210800
               INSPECT PV-INPUT-RECORD TALLYING PV-TALLY-CNTR           01210900
                                         FOR ALL '01'                   01211000
           END-IF.                                                      01211100
                                                                        01211200
      *    IF  ET115-RECORD-TYPE IS EQUAL TO '01'                       01211300
      *       ADD +1                      TO WS-HDR-RECORD-COUNT        01211400
      *    END-IF.                                                      01211500
                                                                        01212000
      ******************************************************************01380000
      *READS THE INPUT FILE TILL THE END OF RECORDS                     01381000
      ******************************************************************01382000
       1000-PROCESS-FILE.                                               01390000
                                                                        01400000
           IF PV-TALLY-CNTR <= 20                                       01431601
             MOVE ET115-PRODUCT-ACTIVITY-RECORD TO OUTPUT-RECORD1       01431700
             WRITE OUTPUT-RECORD1                                       01431800
             ADD +1 TO WS-RECORD-COUNT1                                 01431900
           ELSE                                                         01432000
           IF PV-TALLY-CNTR > 20 AND PV-TALLY-CNTR < 51                 01432102
             MOVE ET115-PRODUCT-ACTIVITY-RECORD TO OUTPUT-RECORD2       01432200
             WRITE OUTPUT-RECORD2                                       01432300
             ADD +1 TO WS-RECORD-COUNT2                                 01432400
           ELSE                                                         01432500
           IF PV-TALLY-CNTR > 50 AND PV-TALLY-CNTR < 91                 01432602
             MOVE ET115-PRODUCT-ACTIVITY-RECORD TO OUTPUT-RECORD3       01432700
             WRITE OUTPUT-RECORD3                                       01432800
             ADD +1 TO WS-RECORD-COUNT3                                 01432900
           ELSE                                                         01433201
           IF PV-TALLY-CNTR > 90                                        01433301
             MOVE ET115-PRODUCT-ACTIVITY-RECORD TO OUTPUT-RECORD4       01433401
             WRITE OUTPUT-RECORD4                                       01433501
             ADD +1 TO WS-RECORD-COUNT4                                 01433601
            END-IF                                                      01433701
             END-IF                                                     01433801
              END-IF.                                                   01434001
                                                                        01440000
             PERFORM 3000-READ-INPUT-FILE.                              01450000
                                                                        01460000
      ***************************************************************** 01500000
       4000-END-OF-JOB.                                                 01510000
      ***************************************************************** 01520000
      *DISPLAYS THE PROGRAM STATISTICS                                  01530000
      ***************************************************************** 01531000
           DISPLAY ' '                                                  01540000
           DISPLAY '**********************'                             01550000
           DISPLAY '   ETKUT160 CONTROLS  '                             01560000
           DISPLAY '**********************'                             01570000
           DISPLAY '======================'                             01580000
           DISPLAY ' '                                                  01590000
           DISPLAY 'RECORDS READ     : ' PV-TOTAL-COUNT                 01600000
           DISPLAY 'RECORDS 1ST FILE : ' WS-RECORD-COUNT1               01610000
           DISPLAY 'RECORDS 2ND FILE : ' WS-RECORD-COUNT2               01620000
           DISPLAY 'RECORDS 3RD FILE : ' WS-RECORD-COUNT3               01621000
           DISPLAY 'RECORDS 4TH FILE : ' WS-RECORD-COUNT4               01622001
           DISPLAY 'NO.OF VENDORS    : ' PV-TALLY-CNTR                  01630000
      ******************************************************************01640000
      ******************************************************************01641000
      * CLOSES ALL THE INPUT AND OUTPUT FILES AFTER PROCESSING AND READ 01641100
      ******************************************************************01642000
                                                                        01643000
           CLOSE INPUT-FILE                                             01650000
                 OUTPUT-FILE1                                           01660000
                 OUTPUT-FILE2                                           01670000
                 OUTPUT-FILE3                                           01671001
                 OUTPUT-FILE4.                                          01672001
                                                                        01680000
      ******************************************************************01681000
           STOP RUN.                                                    01690000
                                                                        01700000
