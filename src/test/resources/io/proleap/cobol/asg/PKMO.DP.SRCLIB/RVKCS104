000100*                                                                 00010069
000200*                                                                 00020069
000300*                                                                 00030069
000400 IDENTIFICATION DIVISION.                                         00040069
000500                                                                  00050069
000600 PROGRAM-ID.    RVKCS104.                                         00060069
000700 AUTHOR.        NATALIYA PALATNIK                                 00070069
000800 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00080069
000900 DATE-WRITTEN.  12-12-92.                                         00090069
001000 DATE-COMPILED.                                                   00100069
001100                                                                  00110069
001200******************************************************************00120069
001300* THIS PROGRAM IS RA HEADER INQUIRY (RETURN TO VENDOR SYSTEM)    *00130069
001400*                                                                *00140069
001500* TRANSID - T104                                                 *00150069
001600******************************************************************00160069
001700*   04/11/03 - LAXMAN BOLINENI, IGSI    -  WR NO. 23022          *00170069
001800*            - REPLACED ALL THE REFERENCES OF TSK TABLE WITH     *00180069
001900*              XLT_SKU, XLT_VND_STYL TABLES.                     *00190069
002000*                                                                *00200069
002100* 10/30/2011  STEVE ANDERSON - CODEWORKS               WR 40134  *00210069
002200*      - PROJECT # 3219: GENCO / RTV UPGRADE                     *00220069
002300*        FIX ZERO FILL DEFECT WHEN ZIP CODE IS DISPLAYED         *00230069
002400******************************************************************00240069
002500                                                                  00250069
002600*                                                                 00260069
002700 ENVIRONMENT DIVISION.                                            00270069
002800*                                                                 00280069
002900*                                                                 00290069
003000 DATA DIVISION.                                                   00300069
003100*                                                                 00310069
003200*                                                                 00320069
003300 WORKING-STORAGE SECTION.                                         00330069
003400                                                                  00340069
003500 01  PC-PROGRAM-CONSTANTS.                                        00350069
003600     05  PC-PRT-RTV-TRANID              PIC X(04)    VALUE 'T112'.00360069
003700     05  PC-01                          PIC X(02)    VALUE '01'.  00370069
003800     05  PC-OPER-UNT-ID-FINDLAY         PIC 9(04)    VALUE 0810.  00380069
003900     05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.00390069
004000     05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  00400069
004100                                                     COMP SYNC.   00410069
004200     05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        00420069
004300     'RV104A  '.                                                  00430069
004400     05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        00440069
004500     'RVKM104 '.                                                  00450069
004600     05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        00460069
004700     'RVKCS104'.                                                  00470069
004800     05  PC-RTV-REPORT-PGM              PIC X(08)    VALUE        00480069
004900     'RVKCS112'.                                                  00490069
005000     05  PC-PRTR-VALIDATION-PGM         PIC X(08)    VALUE        00500069
005100     'DPKCS060'.                                                  00510069
005200     05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   00520069
005300                                                     COMP SYNC.   00530069
005400     05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      00540069
005500         10  FILLER                     PIC X(01).                00550069
005600         10  PC-ERASE-EOF               PIC X(01).                00560069
005700     05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      00570069
005800                                                     COMP-3.      00580069
005900     05  PC-ONE                         PIC S9(01)   VALUE +1     00590069
006000                                                     COMP-3.      00600069
006100     05  PC-ZERO                        PIC S9(01)   VALUE 0      00610069
006200                                                     COMP-3.      00620069
006300                                                                  00630069
006400*                                                                 00640069
006500 01  PC-TSYMSG-NUMBERS.                                           00650069
006600     05  PC-TSYMSG-00005                PIC 9(5)    VALUE 00005.  00660069
006700     05  PC-TSYMSG-00007                PIC 9(5)    VALUE 00007.  00670069
006800     05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  00680069
006900     05  PC-TSYMSG-00034                PIC 9(5)    VALUE 00034.  00690069
007000     05  PC-TSYMSG-00045                PIC 9(5)    VALUE 00045.  00700069
007100     05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  00710069
007200     05  PC-TSYMSG-00051                PIC 9(5)    VALUE 00051.  00720069
007300     05  PC-TSYMSG-00052                PIC 9(5)    VALUE 00052.  00730069
007400     05  PC-TSYMSG-00053                PIC 9(5)    VALUE 00053.  00740069
007500     05  PC-TSYMSG-00054                PIC 9(5)    VALUE 00054.  00750069
007600     05  PC-TSYMSG-00055                PIC 9(5)    VALUE 00055.  00760069
007700     05  PC-TSYMSG-00057                PIC 9(5)    VALUE 00057.  00770069
007800     05  PC-TSYMSG-00059                PIC 9(5)    VALUE 00059.  00780069
007900     05  PC-TSYMSG-00061                PIC 9(5)    VALUE 00061.  00790069
008000     05  PC-TSYMSG-00062                PIC 9(5)    VALUE 00062.  00800069
008100     05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  00810069
008200     05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  00820069
008300     05  PC-TSYMSG-00148                PIC 9(5)    VALUE 00148.  00830069
008400     05  PC-TSYMSG-00746                PIC 9(5)    VALUE 00746.  00840069
008500     05  PC-TSYMSG-03224                PIC 9(5)    VALUE 03224.  00850069
008600     05  PC-TSYMSG-99901                PIC 9(5)    VALUE 99901.  00860069
008700*                                                                 00870069
008800 01  PM-PROGRAM-MESSAGES.                                         00880069
008900     05  PM-PROGRAM-MESSAGE-12          PIC X(78)    VALUE        00890069
009000     'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                00900069
009100     05  PM-PROGRAM-MESSAGE-22          PIC X(78)    VALUE        00910069
009200     'LOGIC ERROR IN TRYING TO READ RV     QUEUE - RESP = '.      00920069
009300     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-22.                  00930069
009400         10  FILLER                     PIC X(61).                00940069
009500         10  PM-RESP-22                 PIC 9999.                 00950069
009600         10  FILLER                     PIC X(12).                00960069
009700*                                                                 00970069
009800 01  PS-PROGRAM-SUBSCRIPTS.                                       00980069
009900     05  PS-SUB                         PIC S9(04)   VALUE +0     00990069
010000                                                     COMP SYNC.   01000069
010100     05  PS-ITEM-SUB                    PIC S9(09)   VALUE +0     01010069
010200                                                     COMP-3.      01020069
010300                                                                  01030069
010400 01  PS-PROGRAM-SWITCHES.                                         01040069
010500     05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   01050069
010600         88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   01060069
010700         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   01070069
010800         88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   01080069
010900         88  PS-SEND-DATA-ONLY                       VALUE '4'.   01090069
011000         88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   01100069
011100         88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   01110069
011200     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   01120069
011300         88  PS-ERROR                                VALUE 'Y'.   01130069
011400         88  PS-NO-ERROR                             VALUE 'N'.   01140069
011500     05  PS-INTER-APPL-VALID-SW         PIC X(01)    VALUE 'N'.   01150069
011600         88  PS-INTER-APPL-VALID                     VALUE 'Y'.   01160069
011700         88  PS-INTER-APPL-NOT-VALID                 VALUE 'N'.   01170069
011800     05  PS-WARNING-SW                  PIC X(01)    VALUE 'N'.   01180069
011900         88  PS-WARNING                              VALUE 'Y'.   01190069
012000         88  PS-NO-WARNING                           VALUE 'N'.   01200069
012100     05  PS-INFORMATIONAL-SW            PIC X(01)    VALUE 'N'.   01210069
012200         88  PS-INFORMATIONAL                        VALUE 'Y'.   01220069
012300         88  PS-NOT-INFORMATIONAL                    VALUE 'N'.   01230069
012400     05  PS-PROCESSING-SW               PIC X(01)    VALUE 'N'.   01240069
012500         88  CONTINUE-PROCESSING                     VALUE 'Y'.   01250069
012600         88  STOP-PROCESSING                         VALUE 'N'.   01260069
012700     EJECT                                                        01270069
012800 01  PV-PROGRAM-VARIABLES.                                        01280069
012900     05  PV-PRT-LIST-TRANID             PIC X(04)    VALUE SPACE. 01290069
013000     05  PV-COMMAREA-LENGTH             PIC S9(04)   VALUE ZERO   01300069
013100                                                     COMP SYNC.   01310069
013200     05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     01320069
013300                                                     COMP SYNC.   01330069
013400     05  PV-DB2-OPER-UNT-ID             PIC S9(04)   VALUE +0     01340069
013500                                                     COMP SYNC.   01350069
013600     05  PV-RESP                        PIC S9(04)   VALUE +0     01360069
013700                                                     COMP SYNC.   01370069
013800     05  PV-ITEM                        PIC S9(04)   VALUE +0     01380069
013900                                                     COMP SYNC.   01390069
014000     05  PV-AS-ITEM                     PIC S9(04)   VALUE +0     01400069
014100                                                     COMP SYNC.   01410069
014200     05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.01420069
014300     05  PV-SQL-SUB                     PIC S9(4)    COMP.        01430069
014400     05  PV-RETRY-COUNTER               PIC S9(3)    COMP-3.      01440069
014500                                                                  01450069
014600     05  PV-RETAIL                      PIC S9(9)V99 VALUE +0     01460069
014700                                                     COMP-3.      01470069
014800     05  PV-COST                        PIC S9(9)V99 VALUE +0     01480069
014900                                                     COMP-3.      01490069
015000     05  PV-QTY                         PIC S9(7)    VALUE +0     01500069
015100                                                     COMP-3.      01510069
015200     05  PV-TOT-RETAIL                  PIC S9(9)V99 VALUE +0     01520069
015300                                                     COMP-3.      01530069
015400     05  PV-TOT-COST                    PIC S9(9)V99 VALUE +0     01540069
015500                                                     COMP-3.      01550069
015600     05  PV-TOT-QTY                     PIC S9(7)    VALUE +0     01560069
015700                                                     COMP-3.      01570069
015800     05  PV-DEPT                        PIC  9(04)   VALUE ZEROS. 01580069
015900                                                                  01590069
016000     05  PV-PHONE.                                                01600069
016100         10  FILLER                     PIC X        VALUE '('.   01610069
016200         10  PV-PHN-AREA-CODE           PIC X(03)    VALUE SPACES.01620069
016300         10  FILLER                     PIC X        VALUE ')'.   01630069
016400         10  PV-PHN-EXCH-NBR            PIC X(03)    VALUE SPACES.01640069
016500         10  FILLER                     PIC X        VALUE '-'.   01650069
016600         10  PV-PHN-NBR                 PIC X(04)    VALUE SPACES.01660069
016700                                                                  01670069
016800     05  PV-FAX.                                                  01680069
016900         10  FILLER                     PIC X        VALUE '('.   01690069
017000         10  PV-FAX-PHN-AREA-CODE       PIC X(03)    VALUE SPACES.01700069
017100         10  FILLER                     PIC X        VALUE ')'.   01710069
017200         10  PV-FAX-EXCH-NBR            PIC X(03)    VALUE SPACES.01720069
017300         10  FILLER                     PIC X        VALUE '-'.   01730069
017400         10  PV-FAX-PHN-NBR             PIC X(04)    VALUE SPACES.01740069
017500                                                                  01750069
017600     05  PV-VEND-ZIP-CODE-SFX           PIC 9(9)     VALUE ZEROS. 01760069
017700     05  PV-VEND-ZIP-CODE-SFX-R         REDEFINES                 01770069
017800         PV-VEND-ZIP-CODE-SFX.                                    01780069
017900         10  PV-VEND-ZIP-CODE           PIC 9(5).                 01790069
018000         10  PV-VEND-ZIP-SFX            PIC 9(4).                 01800069
018100                                                                  01810069
018200     05  PV-VEND-ZIP-CODE-SFX-PRINT.                              01820069
018300         10  PV-VEND-ZIP-CODE-PRINT     PIC 9(05)    VALUE ZEROS. 01830069
018400         10  FILLER                     PIC X        VALUE '-'.   01840069
018500         10  PV-VEND-ZIP-SFX-PRINT      PIC 9(04)    VALUE ZEROS. 01850069
018600                                                                  01860069
018700     05  PV-DFCT-ORD-ID                 PIC S9(12)   VALUE +0     01870070
018800                                                     COMP-3.      01880069
018900     05  PV-ITEMS-ON-DB2                PIC X        VALUE 'Y'.   01890069
019000             88  PV-NO-ITEMS-LEFT                    VALUE 'N'.   01900069
019100                                                                  01910069
019200                                                                  01920069
019300*                                                                 01930069
019400 01  PV-DB2-COUNT                       PIC S9(9)    VALUE +0     01940069
019500                                                     COMP-3.      01950069
019600 01  PV-DB2-DATE                        PIC X(10).                01960069
019700 01  FILLER  REDEFINES PV-DB2-DATE.                               01970069
019800     05  PV-DD-CCYY                     PIC X(4).                 01980069
019900     05  FILLER                         PIC X.                    01990069
020000         88  PV-DD-DASH1                             VALUE '-'.   02000069
020100     05  PV-DD-MM                       PIC XX.                   02010069
020200     05  FILLER                         PIC X.                    02020069
020300         88  PV-DD-DASH2                             VALUE '-'.   02030069
020400     05  PV-DD-ML                       PIC XX.                   02040069
020500*                                                                 02050069
020600 EJECT                                                            02060069
020700                                                                  02070069
020800***************************************************************** 02080069
020900*    STANDARD COMMAREA.                                           02090069
021000***************************************************************** 02100069
021100                                                                  02110069
021200     COPY DPWS020.                                                02120069
021300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02130069
021400                                                                  02140069
021500***************************************************************** 02150069
021600*    INTER-APPLICATION COMMAREA.                                  02160069
021700***************************************************************** 02170069
021800                                                                  02180069
021900         10  INTER-APPL-COMM-AREA       PIC X(200).               02190069
022000     COPY RVWS100.                                                02200069
022100                                                                  02210069
022200***************************************************************** 02220069
022300*    SPECIFIC COMMMAREA FOR RVKCS104.                             02230069
022400***************************************************************** 02240069
022500                                                                  02250069
022600         10  RV104-SPECIFIC-COMMAREA.                             02260069
022700             15  RV104-APPL-CURSOR-POSITION  PIC S9(04)           02270069
022800                                             COMP.                02280069
022900             15  RV104-RL-SUB                PIC S9(04)           02290069
023000                                             COMP.                02300069
023100             15  RV104-RL-ITEM               PIC S9(04)           02310069
023200                                             COMP.                02320069
023300             15  RV104-REQUEST-DATA.                              02330069
023400                                                                  02340069
023500                 20  RV104-DFCT-ORD-ID       PIC 9(12).           02350071
023600                 20  RV104-TYPE-CDE          PIC X(08).           02360069
023700                 20  RV104-STATUS-CDE        PIC X(08).           02370069
023800                 20  RV104-LOCATION          PIC X(15).           02380069
023900                 20  RV104-STATUS-DATE       PIC X(10).           02390069
024000                 20  RV104-PRINTER           PIC X(05).           02400069
024100                 20  RV104-BUYER             PIC X(15).           02410069
024200                 20  RV104-VEND-NAME         PIC X(25).           02420069
024300                 20  RV104-DUNS-NBR          PIC X(09).           02430069
024400                 20  RV104-VEND-ATTN-NAME    PIC X(25).           02440069
024500                 20  RV104-TOTAL-QTY         PIC Z,ZZZ,ZZ9.       02450069
024600                 20  RV104-TOTAL-RETAIL      PIC $$$$$$,$$9.99.   02460069
024700                 20  RV104-TOTAL-COST        PIC $$$$$$,$$9.99.   02470069
024800                 20  RV104-VEND-ADDR         PIC X(25).           02480069
024900                 20  RV104-VEND-CITY         PIC X(12).           02490069
025000                 20  RV104-VEND-STATE        PIC X(02).           02500069
025100                 20  RV104-VEND-ZIP-CODE-SFX PIC 9(09).           02510069
025200                 20  RV104-PHONE             PIC X(13).           02520069
025300                 20  RV104-FAX               PIC X(13).           02530069
025400                 20  RV104-OPER-UNT-ID-X.                         02540069
025500                     25  RV104-OPER-UNT-ID   PIC 9(04).           02550069
025600                                                                  02560069
025700             15  RV104-ORDER-TYPE-CDE        PIC  X(01).          02570069
025800                 88  RV104-RTV-LISTING       VALUES 'R', 'D'.     02580069
025900                 88  RV104-MOS-LISTING       VALUE  'M'.          02590069
026000                 88  RV104-CALLBK-LISTING    VALUE  'C'.          02600069
026100             15  RV104-ORDER-STATUS-CDE      PIC  X(01).          02610069
026200                 88  RV104-NEW-LISTING       VALUE 'N'.           02620069
026300                 88  RV104-OPEN-LISTING      VALUE 'O'.           02630069
026400                 88  RV104-CLOSED-LISTING    VALUES 'C', 'D'.     02640069
026500                 88  RV104-PENDING-LISTING   VALUE 'P'.           02650069
026600                 88  RV104-SHIPPED-LISTING   VALUE 'S'.           02660069
026700                 88  RV104-APPROVED-LISTING  VALUE 'A'.           02670069
026800                 88  RV104-D-AND-D-LISTING   VALUE 'D'.           02680069
026900                                                                  02690069
027000             15  RV104-LIST-SWITCH           PIC X.               02700069
027100                 88  RV104-LIST              VALUE 'Y'.           02710069
027200                 88  RV104-NO-LIST           VALUE 'N'.           02720069
027300                                                                  02730069
027400             15  RV104-TEMP-QUEU-NAME.                            02740069
027500                 20  RV104-TERM-ID           PIC X(04).           02750069
027600                 20  RV104-TASK-NUMBER       PIC S9(07)           02760069
027700                                             COMP-3.              02770069
027800             15  RV104-SAVE-INTER-APPL-COMM  PIC X(200).          02780069
027900             15  RV104-SAVE-TS-QUEUE         PIC X(1100).         02790069
028000                                                                  02800069
028100***************************************************************** 02810069
028200*         LIST QUEUE RECORD LAYOUT.                               02820069
028300***************************************************************** 02830069
028400                                                                  02840069
028500     COPY RVWS101.                                                02850069
028600                                                                  02860069
028700***************************************************************** 02870069
028800*    ABEND PROCESSING COPYBOOK.                                   02880069
028900***************************************************************** 02890069
029000                                                                  02900069
029100     COPY DPWS013.                                                02910069
029200                                                                  02920069
029300***************************************************************** 02930069
029400*    MESSAGE-LINE COPYBOOK.                                       02940069
029500***************************************************************** 02950069
029600                                                                  02960069
029700     COPY DPWS006.                                                02970069
029800                                                                  02980069
029900***************************************************************** 02990069
030000*    COPYBOOK FOR THE CALL TO RACF SECURITY SUBROUTINE          * 03000069
030100***************************************************************** 03010069
030200                                                                  03020069
030300     COPY DPWS008.                                                03030069
030400                                                                  03040069
030500***************************************************************** 03050069
030600*    ATTRIBUTE SETTINGS COPYBOOK.                                 03060069
030700***************************************************************** 03070069
030800                                                                  03080069
030900     COPY DPWS015.                                                03090069
031000                                                                  03100069
031100***************************************************************** 03110069
031200*    CURRENT DATE AND TIME COPYBOOK.                              03120069
031300***************************************************************** 03130069
031400                                                                  03140069
031500     COPY DPWS017.                                                03150069
031600                                                                  03160069
031700***************************************************************** 03170069
031800*    TOGGLE FUNCTION KEY LINES COPYBOOK.                          03180069
031900***************************************************************** 03190069
032000                                                                  03200069
032100     COPY DPWS009.                                                03210069
032200                                                                  03220069
032300***************************************************************** 03230069
032400*    FUNCTION KEYS COPYBOOK.                                      03240069
032500***************************************************************** 03250069
032600                                                                  03260069
032700     COPY DPWS016.                                                03270069
032800                                                                  03280069
032900***************************************************************** 03290069
033000*    DPKUT045 COPYBOOK.                                           03300069
033100*                                                                 03310069
033200*    DATA AREA NECESSARY TO INTERACT WITH SUB-ROUTINE DPKUT045    03320069
033300*                                                                 03330069
033400*    DPKUT045 IS A UTILITY ROUTINE THAT CONVERTS THE EIBAID       03340069
033500*    CHARACTER RECEIVED FROM THE TERMINAL INTO A INTEGER VALUE    03350069
033600*    FROM 1 TO 29. THIS INTEGER VALUE IS STORED IN DP020-SRC-AID  03360069
033700*    AND IS USED TO INTERROGATE THE DP020-FUNCTION-KEY-ARRAY      03370069
033800*    TABLE IN THE STANDARD COMMAREA TO DETERMINE WHAT TO DO NEXT. 03380069
033900*    IN ADDITION DPKUT045 WILL PARSE THE SCREEN INPUT COMMAND     03390069
034000*    FIELD AND CONVERT RECOGNIZED SCREEN MANIPULATION COMMANDS    03400069
034100*    INTO THE DP020-SRC-AID EQUIVALENT.                           03410069
034200***************************************************************** 03420069
034300                                                                  03430069
034400     COPY DPWS045.                                                03440069
034500                                                                  03450069
034600******************************************************************03460069
034700*  SENDING/RECEIVING AREA FOR THE                                *03470069
034800*  PRINTER VALIDATION ROUTING (DPKCS060)                         *03480069
034900******************************************************************03490069
035000     COPY DPWS072.                                                03500069
035100                                                                  03510069
035200                                                                  03520069
035300***************************************************************** 03530069
035400*    SYSTEM MESSAGES RECORD LAYOUT                                03540069
035500***************************************************************** 03550069
035600                                                                  03560069
035700     COPY DPRD507I.                                               03570069
035800                                                                  03580069
035900                                                                  03590069
036000     COPY RVWS102.                                                03600069
036100                                                                  03610069
036200***************************************************************** 03620069
036300*    STANDARD ATTENTION IDENTIFIER LIST                           03630069
036400***************************************************************** 03640069
036500                                                                  03650069
036600     COPY DFHAID.                                                 03660069
036700***************************************************************** 03670069
036800*    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        03680069
036900***************************************************************** 03690069
037000                                                                  03700069
037100     COPY DFHBMSCA.                                               03710069
037200                                                                  03720069
037300***************************************************************** 03730069
037400*    MAP LAYOUT                                                   03740069
037500***************************************************************** 03750069
037600                                                                  03760069
037700     COPY RVKM104.                                                03770069
037800                                                                  03780069
037900 01  MD-MAP-DATA-AREA REDEFINES RV104AO.                          03790069
038000     05  FILLER                         PIC X(1000).              03800069
038100 EJECT                                                            03810069
038200***************************************************************** 03820069
038300*    DB2 AREA FOR DEFECT ORDER TABLE                              03830069
038400***************************************************************** 03840069
038500                                                                  03850069
038600     EXEC SQL                                                     03860069
038700         INCLUDE TDFCTOR                                          03870069
038800     END-EXEC.                                                    03880069
038900***************************************************************** 03890069
039000*    DB2 AREA FOR                                                 03900069
039100***************************************************************** 03910069
039200                                                                  03920069
039300     EXEC SQL                                                     03930069
039400         INCLUDE TDFMEIT                                          03940069
039500     END-EXEC.                                                    03950069
039600                                                                  03960069
039700***************************************************************** 03970069
039800                                                                  03980069
039900     EXEC SQL                                                     03990069
040000         INCLUDE TMDSEAR                                          04000069
040100     END-EXEC.                                                    04010069
040200                                                                  04020069
040300***************************************************************** 04030069
040400                                                                  04040069
040500     EXEC SQL                                                     04050069
040600         INCLUDE TRSPBAR                                          04060069
040700     END-EXEC.                                                    04070069
040800                                                                  04080069
040900***************************************************************** 04090069
041000*    DB2 SKU TABLE                                                04100069
041100***************************************************************** 04110069
041200*                                                                 04120069
041300     EXEC SQL                                                     04130069
041400         INCLUDE XLT00003                                         04140069
041500     END-EXEC.                                                    04150069
041600*                                                                 04160069
041700***************************************************************** 04170069
041800*    DB2 VENDOR STYLE TABLE                                       04180069
041900***************************************************************** 04190069
042000*                                                                 04200069
042100     EXEC SQL                                                     04210069
042200         INCLUDE XLT00004                                         04220069
042300     END-EXEC.                                                    04230069
042400*                                                                 04240069
042500***************************************************************** 04250069
042600*    DB2 STATE TABLE                                              04260069
042700***************************************************************** 04270069
042800                                                                  04280069
042900     EXEC SQL                                                     04290069
043000         INCLUDE TSTATE                                           04300069
043100     END-EXEC.                                                    04310069
043200***************************************************************** 04320069
043300*    DB2 COMMUNICATION AREA                                       04330069
043400***************************************************************** 04340069
043500                                                                  04350069
043600     EXEC SQL                                                     04360069
043700         INCLUDE SQLCA                                            04370069
043800     END-EXEC.                                                    04380069
043900                                                                  04390069
044000***************************************************************** 04400069
044100*    CURSOR DECLARE FOR TDFMEIT                                   04410069
044200***************************************************************** 04420069
044300     EXEC SQL                                                     04430069
044400          DECLARE DFCT-ITEM CURSOR                                04440069
044500          FOR SELECT SUM(RTL_COST_AMT),                           04450069
044600                     SUM(UNIT_COST_AMT),                          04460069
044700                     COUNT(*)                                     04470069
044800          FROM TDFMEIT                                            04480069
044900             WHERE                                                04490069
045000                 DFCT_ORD_ID  =  :DFCTOR-DFCT-ORD-ID              04500069
045100     END-EXEC.                                                    04510069
045200*                                                                 04520069
045300 EJECT                                                            04530069
045400*                                                                 04540069
045500 LINKAGE SECTION.                                                 04550069
045600                                                                  04560069
045700 01  DFHCOMMAREA.                                                 04570069
045800     05  FILLER                       OCCURS 1 TO 4072 TIMES      04580069
045900                                      DEPENDING ON EIBCALEN.      04590069
046000         10  FILLER                   PIC X.                      04600069
046100*                                                                 04610069
046200*                                                                 04620069
046300 PROCEDURE DIVISION.                                              04630069
046400                                                                  04640069
046500 A000-MAIN-MODULE.                                                04650069
046600                                                                  04660069
046700******************************************************************04670069
046800*    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.           04680069
046900******************************************************************04690069
047000                                                                  04700069
047100     PERFORM DP015-0000-CHECK-COMMAREA.                           04710069
047200                                                                  04720069
047300******************************************************************04730069
047400*    DP020-SRC-RETURN-W-TRAN-ID WILL BE TRUE IF THIS PROGRAM WAS  04740069
047500*    SENT A STANDARD COMMAREA. IF NOT SET TRUE (MEANING OTHER     04750069
047600*    THAN A STANDARD COMMAREA WAS SENT TO THIS PROGRAM, THIS      04760069
047700*    PROGRAM WILL RETURN TO CICS.                                 04770069
047800******************************************************************04780069
047900     IF DP020-SRC-RETURN-W-TRAN-ID                                04790069
048000         PERFORM B100-CONTROL-PROCESSING                          04800069
048100     END-IF.                                                      04810069
048200                                                                  04820069
048300     PERFORM DP003-0000-RETURN-TO-CICS.                           04830069
048400 EJECT                                                            04840069
048500 B100-CONTROL-PROCESSING.                                         04850069
048600                                                                  04860069
048700******************************************************************04870069
048800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    04880069
048900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                    04890069
049000******************************************************************04900069
049100                                                                  04910069
049200     EVALUATE TRUE                                                04920069
049300                                                                  04930069
049400         WHEN DP020-NEXT-ACT-INITIAL                              04940069
049500             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 04950069
049600             SET DP020-NEXT-ACT-READ-MAP  TO TRUE                 04960069
049700             SET CONTINUE-PROCESSING      TO TRUE                 04970069
049800                                                                  04980069
049900             PERFORM C100-INITIALIZE-COMMAREA                     04990069
050000             MOVE RV100-INTER-APPL-COMMAREA TO                    05000069
050100                      RV104-SAVE-INTER-APPL-COMM                  05010069
050200                                                                  05020069
050300             PERFORM C200-BUILD-INITIAL-PANEL                     05030069
050400             IF  STOP-PROCESSING                                  05040069
050500                 MOVE DP016-PF3  TO  DP020-SRC-AID                05050069
050600                 PERFORM  X400-NAVIGATE                           05060069
050700             END-IF                                               05070069
050800         WHEN DP020-NEXT-ACT-READ-MAP                             05080069
050900             PERFORM C300-PROCESS-MAP                             05090069
051000         WHEN DP020-NEXT-ACT-RETURN                               05100069
051100             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 05110069
051200             MOVE RV104-SAVE-INTER-APPL-COMM                      05120069
051300                               TO RV100-INTER-APPL-COMMAREA       05130069
051400             PERFORM F100-MOVE-COMMAREA-TO-SCREEN                 05140069
051500             PERFORM F200-EDIT-DATA-IN-COMMAREA                   05150069
051600             PERFORM F300-DISPLAY-PANEL                           05160069
051700*                                                                 05170069
051800         WHEN DP020-NEXT-ACT-ERROR                                05180069
051900                                                                  05190069
052000             MOVE DP020-MSG-MESSAGE   TO PV-MESSAGE               05200069
052100             IF DP020-NAV-MNEMONIC = SPACES                       05210069
052200                 MOVE SPACES          TO ANAVCMDO                 05220069
052300                 MOVE DP015-GREEN     TO ANAVCMDC                 05230069
052400                 MOVE DP015-UNDERLINE TO ANAVCMDH                 05240069
052500             ELSE                                                 05250069
052600                 MOVE DP015-RED       TO ANAVCMDC                 05260069
052700                 MOVE DP015-REVERSE   TO ANAVCMDH                 05270069
052800             END-IF                                               05280069
052900                                                                  05290069
053000             MOVE PV-MESSAGE          TO DP020-MSG-MESSAGE        05300069
053100             MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA        05310069
053200                                                                  05320069
053300             PERFORM F200-EDIT-DATA-IN-COMMAREA                   05330069
053400                                                                  05340069
053500             SET DP020-MSG-FATAL         TO TRUE                  05350069
053600             SET PS-ERROR                TO TRUE                  05360069
053700             SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  05370069
053800                                                                  05380069
053900             MOVE -1         TO ANAVCMDL                          05390069
054000                                                                  05400069
054100             PERFORM F300-DISPLAY-PANEL                           05410069
054200                                                                  05420069
054300         WHEN OTHER                                               05430069
054400             SET DP013-LOGIC-ABEND TO TRUE                        05440069
054500             SET DP013-NO-ROLLBACK TO TRUE                        05450069
054600                                                                  05460069
054700             MOVE 'B100-CONTROL-PROCESSING' TO                    05470069
054800                  DP013-PARAGRAPH                                 05480069
054900             MOVE PM-PROGRAM-MESSAGE-12     TO                    05490069
055000                     DP013-MESSAGE-TEXT(1)                        05500069
055100                                                                  05510069
055200             PERFORM DP013-0000-PROCESS-ABEND                     05520069
055300                                                                  05530069
055400     END-EVALUATE.                                                05540069
055500 EJECT                                                            05550069
055600******************************************************************05560069
055700 C100-INITIALIZE-COMMAREA.                                        05570069
055800                                                                  05580069
055900     INITIALIZE RV104-SPECIFIC-COMMAREA.                          05590069
056000                                                                  05600069
056100 EJECT                                                            05610069
056200******************************************************************05620069
056300 C200-BUILD-INITIAL-PANEL.                                        05630069
056400                                                                  05640069
056500     IF  DP020-INT-APPL-FORMAT-IND  NOT EQUAL  '1'                05650069
056600         MOVE 1           TO  RV104-RL-ITEM                       05660069
056700         PERFORM H200-READ-LIST-QUEUE                             05670069
056800         MOVE RV101-RA-REQUEST-RECORD  TO RV104-SAVE-TS-QUEUE     05680069
056900         MOVE 1           TO  RV104-RL-SUB                        05690069
057000         MOVE SPACES      TO  DCLTDFCTOR                          05700069
057100         SET  RV101-INQ(RV104-RL-SUB)  TO TRUE                    05710069
057200                                                                  05720069
057300         MOVE RV101-RA-NUMBER(1)  TO   DFCTOR-DFCT-ORD-ID         05730069
057400         SET  RV104-LIST  TO TRUE                                 05740069
057500     ELSE                                                         05750069
057600         MOVE RV100-RA-NUMBER  TO  RV104-DFCT-ORD-ID              05760069
057700         MOVE RV104-DFCT-ORD-ID  TO  DFCTOR-DFCT-ORD-ID           05770069
057800                                                                  05780069
057900         SET  RV104-NO-LIST    TO  TRUE                           05790069
058000*                                                                 05800069
058100     END-IF.                                                      05810069
058200     IF CONTINUE-PROCESSING                                       05820069
058300          PERFORM D100-RETRIEVE-DATA-FOR-PANEL                    05830069
058400     END-IF.                                                      05840069
058500     IF CONTINUE-PROCESSING                                       05850069
058600          PERFORM F300-DISPLAY-PANEL                              05860069
058700     END-IF.                                                      05870069
058800 EJECT                                                            05880069
058900******************************************************************05890069
059000 C300-PROCESS-MAP.                                                05900069
059100                                                                  05910069
059200     SET PS-SEND-DATA-ONLY-FRSET TO TRUE.                         05920069
059300                                                                  05930069
059400     PERFORM DP007-0000-GET-PANEL.                                05940069
059500                                                                  05950069
059600                                                                  05960069
059700     IF (DP020-SRC-AID NOT = DP016-PF5)   AND                     05970069
059800        (DP020-SRC-AID NOT = DP016-CLEAR)                         05980069
059900         PERFORM F400-MOVE-SCREEN-TO-COMMAREA                     05990069
060000     END-IF.                                                      06000069
060100                                                                  06010069
060200     PERFORM D200-CHECK-LOCAL-FKEYS.                              06020069
060300 EJECT                                                            06030069
060400******************************************************************06040069
060500 D100-RETRIEVE-DATA-FOR-PANEL.                                    06050069
060600*                                                                 06060069
060700     PERFORM E100-READ-TABLE-TDFCTOR.                             06070069
060800     IF SQLCODE EQUAL ZERO                                        06080069
060900        SET CONTINUE-PROCESSING  TO TRUE                          06090069
061000        PERFORM E150-GET-ORDER-STATUS                             06100069
061100     ELSE                                                         06110069
061200        MOVE PC-TSYMSG-00148   TO DP020-MSG-NUMBER                06120069
061300        SET STOP-PROCESSING    TO TRUE                            06130069
061400        SET DP020-MSG-FATAL    TO TRUE                            06140069
061500     END-IF.                                                      06150069
061600     IF CONTINUE-PROCESSING                                       06160069
061700     MOVE ZERO                    TO PV-VEND-ZIP-CODE-SFX         06170069
061800     MOVE DFCTOR-DFCT-ORD-ID      TO RV104-DFCT-ORD-ID            06180069
061900     MOVE DFCTOR-VENDOR-DUNS-NBR  TO RV104-DUNS-NBR               06190069
062000     MOVE DFCTOR-DFCT-ORD-ID-CDE  TO RV104-ORDER-TYPE-CDE         06200069
062100     MOVE DFCTOR-DFCT-ORD-STAT-CDE                                06210069
062200                                  TO RV104-ORDER-STATUS-CDE       06220069
062300     MOVE DFCTOR-LOC-ID           TO RV104-LOCATION               06230069
062400     MOVE DFCTOR-STATUS-CHG-DTE   TO RV104-STATUS-DATE            06240069
062500     MOVE DFCTOR-VEND-ATTN-NAME   TO RV104-VEND-ATTN-NAME         06250069
062600     MOVE DFCTOR-VEND-NAME        TO RV104-VEND-NAME              06260069
062700     MOVE DFCTOR-VEND-ADDR-DESC   TO RV104-VEND-ADDR              06270069
062800     MOVE DFCTOR-VEND-CITY-NAME   TO RV104-VEND-CITY              06280069
062900     MOVE DFCTOR-VEND-STATE-CDE   TO RV104-VEND-STATE             06290069
063000     MOVE DFCTOR-VEND-ZIP-CDE     TO RV104-VEND-ZIP-CODE-SFX      06300069
063100*                                                                 06310069
063200     MOVE DFCTOR-PHN-AREA-CDE     TO PV-PHN-AREA-CODE             06320069
063300     MOVE DFCTOR-PHN-EXCH-NBR     TO PV-PHN-EXCH-NBR              06330069
063400     MOVE DFCTOR-PHN-NBR          TO PV-PHN-NBR                   06340069
063500                                                                  06350069
063600     MOVE PV-PHONE                TO RV104-PHONE                  06360069
063700*                                                                 06370069
063800     MOVE DFCTOR-FAX-PHN-AREA-CDE TO PV-FAX-PHN-AREA-CODE         06380069
063900     MOVE DFCTOR-FAX-EXCH-NBR     TO PV-FAX-EXCH-NBR              06390069
064000     MOVE DFCTOR-FAX-PHN-NBR      TO PV-FAX-PHN-NBR               06400069
064100                                                                  06410069
064200     MOVE PV-FAX                  TO RV104-FAX                    06420069
064300                                                                  06430069
064400     MOVE PV-DB2-OPER-UNT-ID      TO RV104-OPER-UNT-ID            06440069
064500     IF  RV104-OPER-UNT-ID = PC-OPER-UNT-ID-FINDLAY               06450069
064600         MOVE 'U4777'   TO RV104-PRINTER                          06460069
064700*    ELSE                                                         06470069
064800*        MOVE '     '   TO RV104-PRINTER                          06480069
064900     END-IF                                                       06490069
065000*                                                                 06500069
065100     PERFORM E200-READ-BUYER-NAME                                 06510069
065200                                                                  06520069
065300        IF SQLCODE EQUAL ZERO                                     06530069
065400        OR SQLCODE = -811                                         06540069
065500        OR SQLCODE = +100                                         06550069
065600          SET CONTINUE-PROCESSING  TO TRUE                        06560069
065700        ELSE                                                      06570069
065800           MOVE PC-TSYMSG-00148   TO DP020-MSG-NUMBER             06580069
065900           SET STOP-PROCESSING    TO TRUE                         06590069
066000           SET DP020-MSG-FATAL    TO TRUE                         06600069
066100        END-IF                                                    06610069
066200                                                                  06620069
066300       IF CONTINUE-PROCESSING                                     06630069
066400          IF  RSPBAR-WORKER-LAST-NAME   = SPACES                  06640069
066500          AND RSPBAR-WORKER-FIR-NAME    = SPACES                  06650069
066600              MOVE SPACES   TO RV104-BUYER                        06660069
066700          ELSE                                                    06670069
066800              STRING RSPBAR-WORKER-LAST-NAME DELIMITED BY '  '    06680069
066900                     ','                     DELIMITED BY SIZE    06690069
067000                     RSPBAR-WORKER-FIR-NAME  DELIMITED BY '  '    06700069
067100               INTO RV104-BUYER                                   06710069
067200          END-IF                                                  06720069
067300                                                                  06730069
067400          PERFORM E400-OPEN-CURSOR                                06740069
067500                                                                  06750069
067600          PERFORM UNTIL  PV-NO-ITEMS-LEFT                         06760069
067700             PERFORM E500-FETCH                                   06770069
067800          END-PERFORM                                             06780069
067900                                                                  06790069
068000          PERFORM E600-CLOSE-CURSOR                               06800069
068100                                                                  06810069
068200          MOVE PV-TOT-RETAIL      TO RV104-TOTAL-RETAIL           06820069
068300          MOVE PV-TOT-QTY         TO RV104-TOTAL-QTY              06830069
068400          MOVE PV-TOT-COST        TO RV104-TOTAL-COST             06840069
068500                                                                  06850069
068600                                                                  06860069
068700          PERFORM F100-MOVE-COMMAREA-TO-SCREEN                    06870069
068800       END-IF                                                     06880069
068900           IF RV104-LIST                                          06890069
069000              MOVE RV104-SAVE-TS-QUEUE     TO                     06900069
069100                       RV101-RA-REQUEST-RECORD                    06910069
069200              SET RV101-INQ(RV104-RL-SUB) TO TRUE                 06920069
069300              MOVE RV101-RA-REQUEST-RECORD TO                     06930069
069400                       RV104-SAVE-TS-QUEUE                        06940069
069500           END-IF                                                 06950069
069600     END-IF.                                                      06960069
069700*                                                                 06970069
069800 EJECT                                                            06980069
069900******************************************************************06990069
070000                                                                  07000069
070100 D200-CHECK-LOCAL-FKEYS.                                          07010069
070200                                                                  07020069
070300******************************************************************07030069
070400*  PERFORM THE ACTION DEPENDING ON FUNCTION KEY PRESSED           07040069
070500*                                                                 07050069
070600*                                                                 07060069
070700******************************************************************07070069
070800                                                                  07080069
070900     EVALUATE TRUE                                                07090069
071000                                                                  07100069
071100         WHEN (DP020-FK-GO-TO-TRAN(DP020-SRC-AID) OR              07110069
071200               DP020-FK-RETURN(DP020-SRC-AID))                    07120069
071300             PERFORM X300-SETUP-INTER-APPL-COMM                   07130069
071400             PERFORM X400-NAVIGATE                                07140069
071500                                                                  07150069
071600         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07160069
071700             MOVE SPACES  TO   ANAVCMDO                           07170069
071800                               ANAVKEYO                           07180069
071900             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 07190069
072000             MOVE RV104-DFCT-ORD-ID  TO  DFCTOR-DFCT-ORD-ID       07200069
072100             PERFORM D100-RETRIEVE-DATA-FOR-PANEL                 07210069
072200             PERFORM F300-DISPLAY-PANEL                           07220069
072300                                                                  07230069
072400                                                                  07240069
072500         WHEN DP020-SRC-AID = DP016-ENTER                         07250069
072600             IF DP020-NAV-MNEMONIC GREATER THAN SPACES            07260069
072700                PERFORM  X400-NAVIGATE                            07270069
072800             ELSE                                                 07280069
072900                PERFORM  F200-EDIT-DATA-IN-COMMAREA               07290069
073000                PERFORM  F300-DISPLAY-PANEL                       07300069
073100             END-IF                                               07310069
073200                                                                  07320069
073300         WHEN DP020-SRC-AID = DP016-PA2                           07330069
073400             SET PS-SEND-DATA-ONLY TO TRUE                        07340069
073500                                                                  07350069
073600             MOVE -1 TO ANAVCMDL                                  07360069
073700                                                                  07370069
073800             PERFORM DP017-0000-GET-CURR-DATE-TIME                07380069
073900             PERFORM DP009-0000-LOAD-FK-LINES                     07390069
074000             PERFORM DP008-0000-WRITE-PANEL                       07400069
074100                                                                  07410069
074200         WHEN DP020-SRC-AID = DP016-CLEAR                         07420069
074300             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 07430069
074400                                                                  07440069
074500             PERFORM F100-MOVE-COMMAREA-TO-SCREEN                 07450069
074600             PERFORM F200-EDIT-DATA-IN-COMMAREA                   07460069
074700             PERFORM F300-DISPLAY-PANEL                           07470069
074800                                                                  07480069
074900         WHEN DP020-FK-NEXT-SELECTION(DP020-SRC-AID)              07490069
075000           MOVE ZEROES  TO  PV-TOT-RETAIL                         07500069
075100                            PV-TOT-COST                           07510069
075200                            PV-TOT-QTY                            07520069
075300           IF RV104-LIST                                          07530069
075400             PERFORM F500-GET-NEXT-DFCTOR                         07540069
075500           ELSE                                                   07550069
075600             MOVE PC-TSYMSG-00070                                 07560069
075700                            TO  DP020-MSG-NUMBER                  07570069
075800             SET  DP020-MSG-INFORMATIONAL                         07580069
075900                            TO  TRUE                              07590069
076000             MOVE -1        TO  ANAVCMDL                          07600069
076100           END-IF                                                 07610069
076200             PERFORM F300-DISPLAY-PANEL                           07620069
076300                                                                  07630069
076400         WHEN  DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                 07640069
076500                                                                  07650069
076600             PERFORM F200-EDIT-DATA-IN-COMMAREA                   07660069
076700             IF CONTINUE-PROCESSING                               07670069
076800                 PERFORM X400-NAVIGATE                            07680069
076900             ELSE                                                 07690069
077000                 PERFORM F300-DISPLAY-PANEL                       07700069
077100             END-IF                                               07710069
077200                                                                  07720069
077300*********** F24==> PRINT LISTING                                  07730069
077400         WHEN  DP020-SRC-AID = DP016-PF24                         07740069
077500             PERFORM F200-EDIT-DATA-IN-COMMAREA                   07750069
077600             IF CONTINUE-PROCESSING                               07760069
077700                PERFORM X300-SETUP-INTER-APPL-COMM                07770069
077800                IF RV104-OPEN-LISTING                             07780069
077900                   MOVE 'OPEN LISTING....CANNOT PRINT'            07790069
078000                                        TO DP020-MSG-MESSAGE      07800069
078100                   MOVE -1              TO    ARANAMEL            07810069
078200                   SET  DP020-MSG-FATAL TO  TRUE                  07820069
078300                ELSE                                              07830069
078400                   IF RV104-RTV-LISTING                           07840069
078500                       PERFORM E700-PRINT-RTV-LISTING             07850069
078600                   END-IF                                         07860069
078700                END-IF                                            07870069
078800             END-IF                                               07880069
078900             PERFORM F300-DISPLAY-PANEL                           07890069
079000                                                                  07900069
079100         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               07910069
079200             PERFORM F600-PREPARE-RTVINQ-COMM                     07920069
079300             IF ((RV100-RTV-TYPE OR RV100-D-AND-D-TYPE) AND       07930069
079400                 (RV100-CLOSE-STAT OR                             07940069
079500                  RV100-D-AND-D-STAT OR                           07950069
079600                  RV100-SHIP-STAT OR                              07960069
079700                  RV100-APPROVE-STAT))                            07970069
079800                                                                  07980069
079900                  PERFORM X400-NAVIGATE                           07990069
080000             ELSE                                                 08000069
080100                 MOVE -1       TO ANAVCMDL                        08010069
080200                 MOVE PC-TSYMSG-03224 TO DP020-MSG-NUMBER         08020069
080300                 SET DP020-MSG-FATAL  TO TRUE                     08030069
080400                 PERFORM F300-DISPLAY-PANEL                       08040069
080500             END-IF                                               08050069
080600                                                                  08060069
080700         WHEN OTHER                                               08070069
080800*            -- INVALID FUNCTION KEY --                           08080069
080900             PERFORM F200-EDIT-DATA-IN-COMMAREA                   08090069
081000             MOVE -1  TO  ANAVCMDL                                08100069
081100             MOVE PC-TSYMSG-00045  TO                             08110069
081200                                    DP020-MSG-NUMBER              08120069
081300             SET DP020-MSG-FATAL TO TRUE                          08130069
081400             PERFORM F300-DISPLAY-PANEL                           08140069
081500                                                                  08150069
081600     END-EVALUATE.                                                08160069
081700 EJECT                                                            08170069
081800******************************************************************08180069
081900* GET THE HEADER INFORMATION FROM DEFECT ORDER TABLE             *08190069
082000*                                                                *08200069
082100******************************************************************08210069
082200 E100-READ-TABLE-TDFCTOR.                                         08220069
082300*                                                                 08230069
082400     MOVE RV100-OPER-UNT-ID TO PV-DB2-OPER-UNT-ID.                08240069
082500                                                                  08250069
082600     PERFORM                                                      08260069
082700         WITH TEST AFTER                                          08270069
082800         VARYING PV-SQL-SUB                                       08280069
082900         FROM 1 BY 1                                              08290069
083000         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             08300069
083100            OR SQLCODE = 0                                        08310069
083200            OR SQLCODE = +100                                     08320069
083300*                                                                 08330069
083400         EXEC SQL                                                 08340069
083500              SELECT                                              08350069
083600                     DFCT_ORD_ID,                                 08360069
083700                     VENDOR_DUNS_NBR,                             08370069
083800                     LOC_ID,                                      08380069
083900                     DFCT_ORD_ID_CDE,                             08390069
084000                     DFCT_ORD_STAT_CDE,                           08400069
084100                     STATUS_CHG_DTE,                              08410069
084200                     VEND_ATTN_NAME,                              08420069
084300                     VEND_NAME,                                   08430069
084400                     VEND_ADDR_DESC,                              08440069
084500                     VEND_CITY_NAME,                              08450069
084600                     VEND_STATE_CDE,                              08460069
084700                     VEND_ZIP_CDE,                                08470069
084800                     PHN_AREA_CDE,                                08480069
084900                     PHN_EXCH_NBR,                                08490069
085000                     PHN_NBR,                                     08500069
085100                     FAX_PHN_AREA_CDE,                            08510069
085200                     FAX_EXCH_NBR,                                08520069
085300                     FAX_PHN_NBR                                  08530069
085400              INTO                                                08540069
085500                     :DFCTOR-DFCT-ORD-ID,                         08550069
085600                     :DFCTOR-VENDOR-DUNS-NBR,                     08560069
085700                     :DFCTOR-LOC-ID,                              08570069
085800                     :DFCTOR-DFCT-ORD-ID-CDE,                     08580069
085900                     :DFCTOR-DFCT-ORD-STAT-CDE,                   08590069
086000                     :DFCTOR-STATUS-CHG-DTE,                      08600069
086100                     :DFCTOR-VEND-ATTN-NAME,                      08610069
086200                     :DFCTOR-VEND-NAME,                           08620069
086300                     :DFCTOR-VEND-ADDR-DESC,                      08630069
086400                     :DFCTOR-VEND-CITY-NAME,                      08640069
086500                     :DFCTOR-VEND-STATE-CDE,                      08650069
086600                     :DFCTOR-VEND-ZIP-CDE,                        08660069
086700                     :DFCTOR-PHN-AREA-CDE,                        08670069
086800                     :DFCTOR-PHN-EXCH-NBR,                        08680069
086900                     :DFCTOR-PHN-NBR,                             08690069
087000                     :DFCTOR-FAX-PHN-AREA-CDE,                    08700069
087100                     :DFCTOR-FAX-EXCH-NBR,                        08710069
087200                     :DFCTOR-FAX-PHN-NBR                          08720069
087300              FROM                                                08730069
087400                     TDFCTOR                                      08740069
087500              WHERE                                               08750069
087600                     DFCT_ORD_ID  = :DFCTOR-DFCT-ORD-ID           08760069
087700                AND  OPER_UNT_ID  = :PV-DB2-OPER-UNT-ID           08770069
087800         END-EXEC                                                 08780069
087900*                                                                 08790069
088000         EVALUATE TRUE                                            08800069
088100             WHEN SQLCODE = -904                                  08810069
088200             WHEN SQLCODE = -913                                  08820069
088300             WHEN SQLCODE = ZERO                                  08830069
088400             WHEN SQLCODE = +100                                  08840069
088500                  CONTINUE                                        08850069
088600             WHEN SQLWARN0 NOT EQUAL SPACE                        08860069
088700             WHEN SQLCODE NOT EQUAL ZERO                          08870069
088800                  MOVE 'E100-READ-DFCTOR'                         08880069
088900                               TO  DP013-PARAGRAPH                08890069
089000                  MOVE 'READ DFCTOR'                              08900069
089100                               TO  DP013-MESSAGE-TEXT (1)         08910069
089200                  MOVE SQLCA   TO  DP013-SQLCA                    08920069
089300                  SET DP013-DB2-ABEND                             08930069
089400                               TO  TRUE                           08940069
089500                  PERFORM DP013-0000-PROCESS-ABEND                08950069
089600         END-EVALUATE                                             08960069
089700     END-PERFORM.                                                 08970069
089800*                                                                 08980069
089900     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   08990069
090000         MOVE 'E100-READ-TABLE-TDFCTOR'                           09000069
090100                               TO  DP013-PARAGRAPH                09010069
090200         MOVE 'MAX RETRIES EXCEEDED FOR READ DFCTOR'              09020069
090300                               TO  DP013-MESSAGE-TEXT (1)         09030069
090400         MOVE SQLCA            TO  DP013-SQLCA                    09040069
090500         SET DP013-DB2-ABEND   TO  TRUE                           09050069
090600         PERFORM DP013-0000-PROCESS-ABEND                         09060069
090700     END-IF.                                                      09070069
090800*                                                                 09080069
090900 EJECT                                                            09090069
091000******************************************************************09100069
091100*  READ THE DEFECT ORDER STATUS CONTROL TABLE TO GET THE ORDER   *09110069
091200*  STATUS DESCRIPTION.                                           *09120069
091300*                                                                *09130069
091400******************************************************************09140069
091500 E150-GET-ORDER-STATUS.                                           09150069
091600*                                                                 09160069
091700     EVALUATE DFCTOR-DFCT-ORD-ID-CDE                              09170069
091800         WHEN 'M'                                                 09180069
091900             MOVE 'MARKOUT '           TO RV104-TYPE-CDE          09190069
092000                                                                  09200069
092100         WHEN 'R'                                                 09210069
092200             MOVE 'RTV     '           TO RV104-TYPE-CDE          09220069
092300                                                                  09230069
092400         WHEN 'D'                                                 09240069
092500             MOVE 'DEBT/DIS'           TO RV104-TYPE-CDE          09250069
092600                                                                  09260069
092700         WHEN 'C'                                                 09270069
092800             MOVE 'CALLBACK'           TO RV104-TYPE-CDE          09280069
092900     END-EVALUATE.                                                09290069
093000                                                                  09300069
093100     EVALUATE DFCTOR-DFCT-ORD-STAT-CDE                            09310069
093200         WHEN 'N'                                                 09320069
093300             MOVE 'NEW     '           TO RV104-STATUS-CDE        09330069
093400                                                                  09340069
093500         WHEN 'O'                                                 09350069
093600             MOVE 'OPEN    '           TO RV104-STATUS-CDE        09360069
093700                                                                  09370069
093800         WHEN 'C'                                                 09380069
093900             MOVE 'CLOSED  '           TO RV104-STATUS-CDE        09390069
094000                                                                  09400069
094100         WHEN 'S'                                                 09410069
094200             MOVE 'SHIPPED '           TO RV104-STATUS-CDE        09420069
094300                                                                  09430069
094400         WHEN 'P'                                                 09440069
094500             MOVE 'PENDING '           TO RV104-STATUS-CDE        09450069
094600                                                                  09460069
094700         WHEN 'A'                                                 09470069
094800             MOVE 'APPROVED'           TO RV104-STATUS-CDE        09480069
094900                                                                  09490069
095000         WHEN 'D'                                                 09500069
095100             MOVE 'DEBT/DIS'           TO RV104-STATUS-CDE        09510069
095200     END-EVALUATE.                                                09520069
095300                                                                  09530069
095400*                                                                 09540069
095500 EJECT                                                            09550069
095600******************************************************************09560069
095700*  JOIN THE MERCHANDISE AREA, RESPONSIBILITY, DEFECT ITEM, AND SKU09570069
095800*  TABLES TO GET THE BUYER'S FIRST AND LAST NAME.                 09580069
095900*                                                                 09590069
096000******************************************************************09600069
096100 E200-READ-BUYER-NAME.                                            09610069
096200*                                                                 09620069
096300     PERFORM                                                      09630069
096400         WITH TEST AFTER                                          09640069
096500         VARYING PV-SQL-SUB                                       09650069
096600         FROM 1 BY 1                                              09660069
096700         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             09670069
096800            OR SQLCODE = 0                                        09680069
096900            OR SQLCODE = +100                                     09690069
097000            OR SQLCODE = -811                                     09700069
097100*                                                                 09710069
097200         EXEC SQL                                                 09720069
097300            SELECT DISTINCT                                       09730069
097400               V.DEPT_NBR                                         09740069
097500             , A.OPER_UNT_ID                                      09750069
097600            INTO                                                  09760069
097700               :XLT00004-DEPT-NBR                                 09770069
097800             , :DFCTOR-OPER-UNT-ID                                09780069
097900            FROM                                                  09790069
098000               TDFCTOR A,                                         09800069
098100               TDFMEIT I,                                         09810069
098200               XLT_SKU S,                                         09820069
098300               XLT_VND_STYL V                                     09830069
098400            WHERE I.DFCT_ORD_ID   =  :DFCTOR-DFCT-ORD-ID          09840069
098500               AND I.DFCT_ORD_ID  =  A.DFCT_ORD_ID                09850069
098600               AND S.ITM_NBR      =  I.DFCT_ITEM_NBR              09860069
098700               AND V.STYL_ID      =  S.STYL_ID                    09870069
098800         END-EXEC                                                 09880069
098900*                                                                 09890069
099000         EVALUATE TRUE                                            09900069
099100             WHEN SQLCODE = -904                                  09910069
099200             WHEN SQLCODE = -913                                  09920069
099300             WHEN SQLCODE = ZERO                                  09930069
099400                  CONTINUE                                        09940069
099500             WHEN SQLCODE = +100                                  09950069
099600                  MOVE SPACES  TO RSPBAR-WORKER-LAST-NAME         09960069
099700                                  RSPBAR-WORKER-FIR-NAME          09970069
099800             WHEN SQLCODE = -811                                  09980069
099900                  MOVE 'MULTIPLE BUYERS   '                       09990069
100000                               TO RSPBAR-WORKER-LAST-NAME         10000069
100100                  MOVE 'MARKOUT LIST'                             10010069
100200                               TO RSPBAR-WORKER-FIR-NAME          10020069
100300             WHEN SQLWARN0 NOT EQUAL SPACE                        10030069
100400             WHEN SQLCODE NOT EQUAL ZERO                          10040069
100500                  MOVE 'E200-READ-BUYER-NAME'                     10050069
100600                               TO  DP013-PARAGRAPH                10060069
100700                  MOVE 'READ DEPARTMENT'                          10070069
100800                               TO  DP013-MESSAGE-TEXT (1)         10080069
100900                  MOVE SQLCA   TO  DP013-SQLCA                    10090069
101000                  SET DP013-DB2-ABEND                             10100069
101100                               TO  TRUE                           10110069
101200                  PERFORM DP013-0000-PROCESS-ABEND                10120069
101300         END-EVALUATE                                             10130069
101400     END-PERFORM.                                                 10140069
101500*                                                                 10150069
101600     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   10160069
101700         MOVE 'E200-READ-BUYER-NAME'                              10170069
101800                               TO  DP013-PARAGRAPH                10180069
101900         MOVE 'MAX RETRIES EXCEEDED FOR READ DEPT'                10190069
102000                               TO  DP013-MESSAGE-TEXT (1)         10200069
102100         MOVE SQLCA            TO  DP013-SQLCA                    10210069
102200         SET DP013-DB2-ABEND   TO  TRUE                           10220069
102300         PERFORM DP013-0000-PROCESS-ABEND                         10230069
102400     END-IF.                                                      10240069
102500*                                                                 10250069
102600*                                                                 10260069
102700     IF SQLCODE = +100 OR SQLCODE = -811                          10270069
102800         CONTINUE                                                 10280069
102900     ELSE                                                         10290069
103000         MOVE XLT00004-DEPT-NBR  TO  PV-DEPT                      10300069
103100         MOVE PV-DEPT(2:3)       TO  MDSEAR-DEPT-NBR              10310069
103200         PERFORM                                                  10320069
103300             WITH TEST AFTER                                      10330069
103400             VARYING PV-SQL-SUB                                   10340069
103500             FROM 1 BY 1                                          10350069
103600             UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES         10360069
103700                OR SQLCODE = 0                                    10370069
103800                OR SQLCODE = +100                                 10380069
103900*                                                                 10390069
104000             EXEC SQL                                             10400069
104100                SELECT DISTINCT                                   10410069
104200                   R.WORKER_FIR_NAME,                             10420069
104300                   R.WORKER_LAST_NAME                             10430069
104400                INTO                                              10440069
104500                   :RSPBAR-WORKER-FIR-NAME,                       10450069
104600                   :RSPBAR-WORKER-LAST-NAME                       10460069
104700                FROM TMDSEAR A,                                   10470069
104800                   TRSPBAR R                                      10480069
104900                WHERE                                             10490069
105000                       A.DEPT_NBR       = :MDSEAR-DEPT-NBR        10500069
105100                   AND A.OPERCO_NBR     =  '03'                   10510069
105200                   AND A.MDSELV_CDE     =  'DPT'                  10520069
105300                   AND A.MDSEAR_DKEY    =  R.MDSEAR_DKEY          10530069
105400                   AND R.RSPLVL_CDE     =  'BYR'                  10540069
105500                   AND R.WORKER_STRT_DTE <= CURRENT DATE          10550069
105600                   AND R.WORKER_END_DTE  >= CURRENT DATE          10560069
105700             END-EXEC                                             10570069
105800*                                                                 10580069
105900             EVALUATE TRUE                                        10590069
106000                 WHEN SQLCODE = -904                              10600069
106100                 WHEN SQLCODE = -913                              10610069
106200                 WHEN SQLCODE = ZERO                              10620069
106300                 WHEN SQLCODE = +100                              10630069
106400                      CONTINUE                                    10640069
106500                 WHEN SQLWARN0 NOT EQUAL SPACE                    10650069
106600                 WHEN SQLCODE NOT EQUAL ZERO                      10660069
106700                      MOVE 'E200-READ-BUYER-NAME'                 10670069
106800                                   TO  DP013-PARAGRAPH            10680069
106900                      MOVE 'READ BUYER'                           10690069
107000                                   TO  DP013-MESSAGE-TEXT (1)     10700069
107100                      MOVE SQLCA   TO  DP013-SQLCA                10710069
107200                      SET DP013-DB2-ABEND                         10720069
107300                                   TO  TRUE                       10730069
107400                      PERFORM DP013-0000-PROCESS-ABEND            10740069
107500             END-EVALUATE                                         10750069
107600         END-PERFORM                                              10760069
107700*                                                                 10770069
107800         IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES               10780069
107900             MOVE 'E200-READ-BUYER-NAME'                          10790069
108000                                   TO  DP013-PARAGRAPH            10800069
108100             MOVE 'MAX RETRIES EXCEEDED FOR READ BUYER'           10810069
108200                                   TO  DP013-MESSAGE-TEXT (1)     10820069
108300             MOVE SQLCA            TO  DP013-SQLCA                10830069
108400             SET DP013-DB2-ABEND   TO  TRUE                       10840069
108500             PERFORM DP013-0000-PROCESS-ABEND                     10850069
108600         END-IF                                                   10860069
108700     END-IF.                                                      10870069
108800*                                                                 10880069
108900 EJECT                                                            10890069
109000*                                                                 10900069
109100 E400-OPEN-CURSOR.                                                10910069
109200*                                                                 10920069
109300     PERFORM                                                      10930069
109400         WITH TEST AFTER                                          10940069
109500         VARYING PV-SQL-SUB                                       10950069
109600         FROM 1 BY 1                                              10960069
109700         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             10970069
109800            OR SQLCODE = 0                                        10980069
109900            OR SQLCODE = +100                                     10990069
110000*                                                                 11000069
110100         EXEC SQL                                                 11010069
110200              OPEN DFCT-ITEM                                      11020069
110300         END-EXEC                                                 11030069
110400*                                                                 11040069
110500         EVALUATE TRUE                                            11050069
110600             WHEN SQLCODE = -904                                  11060069
110700             WHEN SQLCODE = -913                                  11070069
110800             WHEN SQLCODE = ZERO                                  11080069
110900             WHEN SQLCODE = +100                                  11090069
111000                  CONTINUE                                        11100069
111100             WHEN SQLWARN0 NOT EQUAL SPACE                        11110069
111200             WHEN SQLCODE NOT EQUAL ZERO                          11120069
111300                  MOVE 'E400-OPEN-CURSOR'                         11130069
111400                               TO  DP013-PARAGRAPH                11140069
111500                  MOVE 'OPEN DFCT-ITEM CURSOR'                    11150069
111600                               TO  DP013-MESSAGE-TEXT (1)         11160069
111700                  MOVE SQLCA   TO  DP013-SQLCA                    11170069
111800                  SET DP013-DB2-ABEND                             11180069
111900                               TO  TRUE                           11190069
112000                  PERFORM DP013-0000-PROCESS-ABEND                11200069
112100         END-EVALUATE                                             11210069
112200     END-PERFORM.                                                 11220069
112300*                                                                 11230069
112400     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   11240069
112500         MOVE 'E400-OPEN-CURSOR'                                  11250069
112600                               TO  DP013-PARAGRAPH                11260069
112700         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              11270069
112800                               TO  DP013-MESSAGE-TEXT (1)         11280069
112900         MOVE SQLCA            TO  DP013-SQLCA                    11290069
113000         SET DP013-DB2-ABEND   TO  TRUE                           11300069
113100         PERFORM DP013-0000-PROCESS-ABEND                         11310069
113200     END-IF.                                                      11320069
113300*                                                                 11330069
113400 EJECT                                                            11340069
113500******************************************************************11350069
113600* GET THE COST, RETAIL, AND QUANTITY TOTALS.                     *11360069
113700*                                                                *11370069
113800******************************************************************11380069
113900*                                                                 11390069
114000 E500-FETCH.                                                      11400069
114100*                                                                 11410069
114200     EXEC SQL                                                     11420069
114300          FETCH DFCT-ITEM                                         11430069
114400          INTO                                                    11440069
114500                :PV-RETAIL,                                       11450069
114600                :PV-COST,                                         11460069
114700                :PV-QTY                                           11470069
114800     END-EXEC                                                     11480069
114900                                                                  11490069
115000     EVALUATE TRUE                                                11500069
115100         WHEN SQLCODE = ZERO                                      11510069
115200             ADD PV-RETAIL   TO  PV-TOT-RETAIL                    11520069
115300             ADD PV-COST     TO  PV-TOT-COST                      11530069
115400             ADD PV-QTY      TO  PV-TOT-QTY                       11540069
115500         WHEN SQLCODE = +100                                      11550069
115600             SET PV-NO-ITEMS-LEFT   TO TRUE                       11560069
115700         WHEN SQLCODE = -305                                      11570069
115800             SET PV-NO-ITEMS-LEFT   TO TRUE                       11580069
115900             MOVE ZERO       TO  PV-RETAIL                        11590069
116000                                 PV-COST                          11600069
116100                                 PV-QTY                           11610069
116200         WHEN SQLWARN0 NOT EQUAL SPACE                            11620069
116300         WHEN SQLCODE NOT EQUAL ZERO                              11630069
116400              MOVE 'E500-FETCH'                                   11640069
116500                           TO  DP013-PARAGRAPH                    11650069
116600              MOVE 'FETCH DFCT-ITEM CURSOR'                       11660069
116700                           TO  DP013-MESSAGE-TEXT (1)             11670069
116800              MOVE SQLCA   TO  DP013-SQLCA                        11680069
116900              SET DP013-DB2-ABEND                                 11690069
117000                           TO  TRUE                               11700069
117100              PERFORM DP013-0000-PROCESS-ABEND                    11710069
117200     END-EVALUATE.                                                11720069
117300*                                                                 11730069
117400                                                                  11740069
117500******************************************************************11750069
117600*                                                                 11760069
117700 E600-CLOSE-CURSOR.                                               11770069
117800*                                                                 11780069
117900     PERFORM                                                      11790069
118000         WITH TEST AFTER                                          11800069
118100         VARYING PV-SQL-SUB                                       11810069
118200         FROM 1 BY 1                                              11820069
118300         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             11830069
118400            OR SQLCODE = 0                                        11840069
118500            OR SQLCODE = +100                                     11850069
118600*                                                                 11860069
118700         EXEC SQL                                                 11870069
118800             CLOSE DFCT-ITEM                                      11880069
118900         END-EXEC                                                 11890069
119000*                                                                 11900069
119100         EVALUATE TRUE                                            11910069
119200             WHEN SQLCODE = -904                                  11920069
119300             WHEN SQLCODE = -913                                  11930069
119400             WHEN SQLCODE = ZERO                                  11940069
119500             WHEN SQLCODE = +100                                  11950069
119600                  CONTINUE                                        11960069
119700             WHEN SQLWARN0 NOT EQUAL SPACE                        11970069
119800             WHEN SQLCODE NOT EQUAL ZERO                          11980069
119900                  MOVE 'E600-CLOSE-CURSOR'                        11990069
120000                               TO  DP013-PARAGRAPH                12000069
120100                  MOVE 'CLOSE DFCT-ITEM CURSOR'                   12010069
120200                               TO  DP013-MESSAGE-TEXT (1)         12020069
120300                  MOVE SQLCA   TO  DP013-SQLCA                    12030069
120400                  SET DP013-DB2-ABEND                             12040069
120500                               TO  TRUE                           12050069
120600                  PERFORM DP013-0000-PROCESS-ABEND                12060069
120700         END-EVALUATE                                             12070069
120800     END-PERFORM.                                                 12080069
120900*                                                                 12090069
121000     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   12100069
121100         MOVE 'E600-CLOSE-CURSOR'                                 12110069
121200                               TO  DP013-PARAGRAPH                12120069
121300         MOVE 'MAX RETRIES EXCEEDED FOR CLOSE CURSOR'             12130069
121400                               TO  DP013-MESSAGE-TEXT (1)         12140069
121500         MOVE SQLCA            TO  DP013-SQLCA                    12150069
121600         SET DP013-DB2-ABEND   TO  TRUE                           12160069
121700         PERFORM DP013-0000-PROCESS-ABEND                         12170069
121800     END-IF.                                                      12180069
121900*                                                                 12190069
122000 EJECT                                                            12200069
122100******************************************************************12210069
122200*  PRINT THE LISTING REPORT FOR RETURN TO VENDOR LISTINGS        *12220069
122300******************************************************************12230069
122400 E700-PRINT-RTV-LISTING.                                          12240069
122500                                                                  12250069
122600     MOVE RV100-INTER-APPL-COMMAREA TO  RV104-SAVE-INTER-APPL-COMM12260069
122700                                                                  12270069
122800     MOVE RV100-UK-RA-NUMBER        TO  RV102-DEFECT-ORDER-NBR.   12280069
122900     MOVE RV104-PRINTER             TO  RV102-PRINTER-DEST.       12290069
123000     MOVE RV104-BUYER               TO  RV102-BUYER-NAME.         12300069
123100     MOVE PC-CURRENT-PROGRAM-NAME   TO  RV102-PROGRAM-NAME.       12310069
123200     MOVE RV104-OPER-UNT-ID         TO  RV102-OPER-UNT-ID.        12320069
123300     MOVE 1                         TO  RV102-DFCTOR-ITEM-STATUS. 12330069
123400                                                                  12340069
123500     MOVE PC-PRT-RTV-TRANID         TO  PV-PRT-LIST-TRANID.       12350069
123600                                                                  12360069
123700     PERFORM E500-START-TRAN.                                     12370069
123800                                                                  12380069
123900 EJECT                                                            12390069
124000******************************************************************12400069
124100*  START THE PRINT TRANSACTION.                                  *12410069
124200*                                                                *12420069
124300*  PERFORMED  BY D200-CHECK-LOCAL-FKEYS.                         *12430069
124400******************************************************************12440069
124500 E500-START-TRAN.                                                 12450069
124600     MOVE   LENGTH OF RV102-SPECIFIC-COMMAREA                     12460069
124700                                 TO  PV-COMMAREA-LENGTH.          12470069
124800     EXEC CICS                                                    12480069
124900         START                                                    12490069
125000             TRANSID  (PV-PRT-LIST-TRANID)                        12500069
125100             FROM     (RV102-SPECIFIC-COMMAREA)                   12510069
125200             LENGTH   (PV-COMMAREA-LENGTH)                        12520069
125300             RESP     (PV-CICS-RESPONSE)                          12530069
125400     END-EXEC.                                                    12540069
125500                                                                  12550069
125600     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      12560069
125700         CONTINUE                                                 12570069
125800     ELSE                                                         12580069
125900         SET DP013-CICS-ABEND  TO TRUE                            12590069
126000         MOVE 'UNABLE TO START TRANSACTION'                       12600069
126100                        TO DP013-MESSAGE-TEXT (1)                 12610069
126200         MOVE PV-PRT-LIST-TRANID                                  12620069
126300                        TO DP013-MESSAGE-TEXT (2)                 12630069
126400         PERFORM DP013-0000-PROCESS-ABEND                         12640069
126500     END-IF.                                                      12650069
126600                                                                  12660069
126700     MOVE 'PRINT STARTED'      TO  DP020-MSG-MESSAGE.             12670069
126800     SET  DP020-MSG-INFORMATIONAL  TO TRUE.                       12680069
126900                                                                  12690069
127000******************************************************************12700069
127100*    MOVE DATA FROM THE COMMAREA TO THE SCREEN.                   12710069
127200*                                                                 12720069
127300******************************************************************12730069
127400 F100-MOVE-COMMAREA-TO-SCREEN.                                    12740069
127500     MOVE  RV104-DFCT-ORD-ID  TO ARRANBRO.                        12750069
127600     MOVE  RV104-TYPE-CDE     TO ATYPEO.                          12760069
127700     MOVE  RV104-STATUS-CDE   TO ASTATUSO.                        12770069
127800     MOVE  RV104-LOCATION     TO ARLOCTNO                         12780069
127900     MOVE  RV104-STATUS-DATE  TO ASTDATEO                         12790069
128000     MOVE  RV104-BUYER        TO ARBUYERO.                        12800069
128100     MOVE  RV104-DUNS-NBR     TO ARIVNRNO.                        12810069
128200     MOVE  RV104-VEND-NAME    TO ARIVNRDO.                        12820069
128300     MOVE  RV104-VEND-ATTN-NAME    TO ARANAMEO.                   12830069
128400     MOVE  RV104-TOTAL-QTY    TO  ARTOTQTO.                       12840069
128500     MOVE  RV104-TOTAL-RETAIL TO ARTOTRTO.                        12850069
128600     MOVE  RV104-TOTAL-COST   TO ARTOTCTO.                        12860069
128700     MOVE  RV104-VEND-ADDR    TO ARVADDRO.                        12870069
128800     MOVE  RV104-VEND-CITY    TO ARVCITYO.                        12880069
128900     MOVE  RV104-VEND-STATE   TO ARSTATEO                         12890069
129000     MOVE  RV104-VEND-ZIP-CODE-SFX                                12900069
129100                              TO PV-VEND-ZIP-CODE-SFX.            12910069
129200     MOVE PV-VEND-ZIP-CODE    TO PV-VEND-ZIP-CODE-PRINT.          12920069
129300     MOVE PV-VEND-ZIP-SFX     TO PV-VEND-ZIP-SFX-PRINT.           12930069
129400     IF PV-VEND-ZIP-CODE-SFX(1:4) = (ZEROES OR LOW-VALUES)        12940069
129500         MOVE ZEROES          TO PV-VEND-ZIP-SFX-PRINT            12950069
129600         MOVE PV-VEND-ZIP-CODE-SFX(5:5)                           12960069
129700                              TO PV-VEND-ZIP-CODE-PRINT           12970069
129800     END-IF.                                                      12980069
129900     MOVE  PV-VEND-ZIP-CODE-SFX-PRINT                             12990069
130000                              TO ARZIPCDO.                        13000069
130100     MOVE  RV104-PHONE        TO ARPHONEO.                        13010069
130200     MOVE  RV104-FAX          TO ARFAXPHO.                        13020069
130300     MOVE  RV104-PRINTER      TO ARPRNTRO.                        13030069
130400                                                                  13040069
130500 EJECT                                                            13050069
130600******************************************************************13060069
130700*    ALL SCREEN FIELDS ARE STORED IN THE APPL SPECIFIC COMMAREA   13070069
130800*    PRIOR TO EDITTING. THEREFORE ALL EDITS SHOULD REFERENCE      13080069
130900*    THE FIELDS IN THE APPLICATION SPECIFIC COMMAREA RATHER THAN  13090069
131000*    THE MAP FIELDS.                                              13100069
131100*                                                                 13110069
131200*                                                                 13120069
131300******************************************************************13130069
131400 F200-EDIT-DATA-IN-COMMAREA.                                      13140069
131500                                                                  13150069
131600     SET PS-NO-ERROR TO TRUE.                                     13160069
131700     SET CONTINUE-PROCESSING  TO TRUE.                            13170069
131800                                                                  13180069
131900     IF  RV104-PRINTER         GREATER  THAN SPACES               13190069
132000         PERFORM F210-VALIDATE-PRINTER                            13200069
132100         IF  DP072-PRTR-PRTR-TRK-STAT-CDE = 'A'                   13210069
132200             CONTINUE                                             13220069
132300         ELSE                                                     13230069
132400             SET PS-ERROR                                         13240069
132500                 STOP-PROCESSING                                  13250069
132600                 DP020-MSG-FATAL      TO TRUE                     13260069
132700             MOVE PC-TSYMSG-00746     TO DP020-MSG-NUMBER         13270069
132800             MOVE DP015-UNP-ALP-BRT-OFF                           13280069
132900                                      TO ARPRNTRA                 13290069
133000             MOVE DP015-RED           TO ARPRNTRC                 13300069
133100             MOVE DP015-REVERSE       TO ARPRNTRH                 13310069
133200             MOVE -1                  TO ARPRNTRL                 13320069
133300         END-IF                                                   13330069
133400     ELSE                                                         13340069
133500         IF DP020-SRC-AID = DP016-PF24 AND                        13350069
133600            RV104-PRINTER = SPACES                                13360069
133700                MOVE PC-TSYMSG-00007                              13370069
133800                                      TO   DP020-MSG-NUMBER       13380069
133900                MOVE DP015-RED        TO    ARPRNTRC              13390069
134000                MOVE DP015-REVERSE    TO    ARPRNTRH              13400069
134100                MOVE -1               TO    ARPRNTRL              13410069
134200                                                                  13420069
134300                SET DP020-MSG-FATAL   TO   TRUE                   13430069
134400                SET STOP-PROCESSING   TO   TRUE                   13440069
134500         END-IF                                                   13450069
134600     END-IF.                                                      13460069
134700                                                                  13470069
134800******************************************************************13480069
134900 EJECT                                                            13490069
135000*----------------------------------------------------------------*13500069
135100*   F210-VALIDATE-PRINTER                                        *13510069
135200* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *13520069
135300*----------------------------------------------------------------*13530069
135400 F210-VALIDATE-PRINTER.                                           13540069
135500                                                                  13550069
135600     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 13560069
135700     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        13570069
135800     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     13580069
135900                                        DP072-FCLTY-ID.           13590069
136000     MOVE RV104-PRINTER              TO DP072-PRINTER-ID          13600069
136100     MOVE PC-RTV-REPORT-PGM          TO DP072-RPT-PGM-NME         13610069
136200     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     13620069
136300     SET DP072-VALIDATE              TO TRUE.                     13630069
136400                                                                  13640069
136500     EXEC CICS                                                    13650069
136600          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  13660069
136700               COMMAREA (DP072-COMM-AREA)                         13670069
136800               RESP     (PV-CICS-RESPONSE)                        13680069
136900     END-EXEC                                                     13690069
137000                                                                  13700069
137100     EVALUATE TRUE                                                13710069
137200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13720069
137300             MOVE DP015-GREEN            TO ARPRNTRC              13730069
137400             MOVE DP015-UNDERLINE        TO ARPRNTRH              13740069
137500         WHEN OTHER                                               13750069
137600             SET PS-ERROR                                         13760069
137700                 STOP-PROCESSING                                  13770069
137800                 DP020-MSG-FATAL         TO TRUE                  13780069
137900             MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER      13790069
138000             MOVE DP015-UNP-ALP-BRT-OFF  TO ARPRNTRA              13800069
138100             MOVE DP015-RED              TO ARPRNTRC              13810069
138200             MOVE DP015-REVERSE          TO ARPRNTRH              13820069
138300             MOVE -1                     TO ARPRNTRL              13830069
138400     END-EVALUATE.                                                13840069
138500                                                                  13850069
138600                                                                  13860069
138700 F300-DISPLAY-PANEL.                                              13870069
138800                                                                  13880069
138900******************************************************************13890069
139000*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.       13900069
139100*                                                                 13910069
139200******************************************************************13920069
139300                                                                  13930069
139400     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       13940069
139500     MOVE DP017-EDITED-TIME-HMS                                   13950069
139600                      TO  ATIMEO.                                 13960069
139700*                                                                 13970069
139800     IF  NOT DP020-MSG-FATAL                                      13980069
139900         MOVE -1      TO  ANAVCMDL                                13990069
140000     END-IF.                                                      14000069
140100                                                                  14010069
140200     IF PS-SEND-MAP-N-DATA-FRSET                                  14020069
140300         PERFORM DP002-0000-FORMAT-TITLE-LINES                    14030069
140400         PERFORM DP009-0000-LOAD-FK-LINES                         14040069
140500     END-IF.                                                      14050069
140600                                                                  14060069
140700     PERFORM DP005-0000-FORMAT-MSG-LINES.                         14070069
140800                                                                  14080069
140900     PERFORM DP008-0000-WRITE-PANEL.                              14090069
141000                                                                  14100069
141100 EJECT                                                            14110069
141200 F400-MOVE-SCREEN-TO-COMMAREA.                                    14120069
141300                                                                  14130069
141400******************************************************************14140069
141500*   MOVES SCREEN FIELDS TO THIS TRANSACTION SPECIFIC              14150069
141600*   COMMAREA.                                                     14160069
141700*                                                                 14170069
141800******************************************************************14180069
141900                                                                  14190069
142000                                                                  14200069
142100     IF (ARANAMEL   GREATER  THAN ZERO                            14210069
142200      OR ARANAMEA   EQUAL  PC-ERASE-EOF)                          14220069
142300        MOVE  ARANAMEI   TO   RV104-VEND-ATTN-NAME                14230069
142400     END-IF.                                                      14240069
142500                                                                  14250069
142600     IF (ARVADDRL   GREATER  THAN ZERO                            14260069
142700      OR ARVADDRA   EQUAL  PC-ERASE-EOF)                          14270069
142800        MOVE  ARVADDRI   TO   RV104-VEND-ADDR                     14280069
142900     END-IF.                                                      14290069
143000                                                                  14300069
143100     IF (ARVCITYL   GREATER  THAN ZERO                            14310069
143200      OR ARVCITYA   EQUAL  PC-ERASE-EOF)                          14320069
143300        MOVE  ARVCITYI   TO   RV104-VEND-CITY                     14330069
143400     END-IF.                                                      14340069
143500                                                                  14350069
143600     IF (ARSTATEL   GREATER  THAN ZERO                            14360069
143700      OR ARSTATEA   EQUAL  PC-ERASE-EOF)                          14370069
143800        MOVE  ARSTATEI   TO   RV104-VEND-STATE                    14380069
143900     END-IF.                                                      14390069
144000                                                                  14400069
144100     IF (ARZIPCDL   GREATER  THAN ZERO                            14410069
144200      OR ARZIPCDA   EQUAL  PC-ERASE-EOF)                          14420069
144300        MOVE  ARZIPCDI               TO PV-VEND-ZIP-CODE-SFX-PRINT14430069
144400        MOVE  PV-VEND-ZIP-CODE-PRINT TO PV-VEND-ZIP-CODE          14440069
144500        MOVE  PV-VEND-ZIP-SFX-PRINT  TO PV-VEND-ZIP-SFX           14450069
144600        MOVE  PV-VEND-ZIP-CODE-SFX   TO RV104-VEND-ZIP-CODE-SFX   14460069
144700     END-IF.                                                      14470069
144800                                                                  14480069
144900     IF  ARPRNTRL   GREATER  THAN ZERO                            14490069
145000        MOVE  ARPRNTRI   TO   RV104-PRINTER                       14500069
145100     ELSE                                                         14510069
145200        IF  ARPRNTRA   EQUAL  PC-ERASE-EOF                        14520069
145300            MOVE SPACES  TO   RV104-PRINTER                       14530069
145400        END-IF                                                    14540069
145500     END-IF.                                                      14550069
145600                                                                  14560069
145700                                                                  14570069
145800 EJECT                                                            14580069
145900******************************************************************14590069
146000*    POSITION TO THE NEXT DEFECT ORDER                            14600069
146100*    IF AT END, ISSUE MESSAGE, OTHERWISE CONTINUE PROCESSING.     14610069
146200*                                                                 14620069
146300*    PERFORMED BY C300                                            14630069
146400******************************************************************14640069
146500*                                                                 14650069
146600 F500-GET-NEXT-DFCTOR.                                            14660069
146700*                                                                 14670069
146800     ADD 1                     TO  RV104-RL-SUB.                  14680069
146900     IF  RV104-RL-SUB GREATER THAN RV101-RA-MAX-ITEMS             14690069
147000         PERFORM H100-WRITE-QUEUE                                 14700069
147100         ADD 1                 TO  RV104-RL-ITEM                  14710069
147200         MOVE 1                TO  RV104-RL-SUB                   14720069
147300         PERFORM H200-READ-LIST-QUEUE                             14730069
147400         MOVE  RV101-RA-REQUEST-RECORD                            14740069
147500                               TO  RV104-SAVE-TS-QUEUE            14750069
147600     ELSE                                                         14760069
147700         MOVE RV104-SAVE-TS-QUEUE                                 14770069
147800                               TO  RV101-RA-REQUEST-RECORD        14780069
147900     END-IF.                                                      14790069
148000*                                                                 14800069
148100     IF  RV101-RA-NUMBER(RV104-RL-SUB) GREATER THAN ZEROES        14810069
148200         MOVE SPACES           TO  DCLTDFCTOR                     14820069
148300         MOVE RV101-RA-NUMBER(RV104-RL-SUB)                       14830069
148400                               TO  DFCTOR-DFCT-ORD-ID             14840069
148500         SET RV101-INQ(RV104-RL-SUB) TO TRUE                      14850069
148600         PERFORM D100-RETRIEVE-DATA-FOR-PANEL                     14860069
148700     ELSE                                                         14870069
148800         SUBTRACT 1          FROM  RV104-RL-SUB                   14880069
148900         MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER               14890069
149000         SET DP020-MSG-INFORMATIONAL                              14900069
149100                               TO  TRUE                           14910069
149200     END-IF.                                                      14920069
149300*                                                                 14930069
149400 EJECT                                                            14940069
149500******************************************************************14950069
149600*  BUILD THE COMMAREA FOR THE RTV INQUIRY FUNCTION F17            14960069
149700******************************************************************14970069
149800 F600-PREPARE-RTVINQ-COMM.                                        14980069
149900     MOVE RV104-DFCT-ORD-ID    TO RV100-RA-NUMBER.                14990069
150000     MOVE RV104-TYPE-CDE       TO RV100-TYPE-CDE.                 15000069
150100     MOVE RV104-LOCATION       TO RV100-LOCATION.                 15010069
150200     MOVE RV104-VEND-NAME      TO RV100-VENDOR-NAME.              15020069
150300     MOVE RV104-STATUS-CDE     TO RV100-STATUS-CDE.               15030069
150400     MOVE RV104-TOTAL-COST     TO RV100-TOTAL-COST.               15040069
150500     MOVE RV104-TOTAL-RETAIL   TO RV100-TOTAL-RETAIL.             15050069
150600                                                                  15060069
150700******************************************************************15070069
150800*    READ THE TEMPORARY STORAGE QUEUE THAT CONTAINS THE SELECTED  15080069
150900*    HEADERS FROM RVKCS100.                                       15090069
151000*                                                                 15100069
151100*    PERFORMED BY C200, F500                                      15110069
151200******************************************************************15120069
151300*                                                                 15130069
151400 H200-READ-LIST-QUEUE.                                            15140069
151500*                                                                 15150069
151600     EXEC CICS                                                    15160069
151700         READQ TS                                                 15170069
151800         QUEUE(RV100-TSQB-QUEUE-NAME)                             15180069
151900         INTO(RV101-RA-REQUEST-RECORD)                            15190069
152000         LENGTH(RV100-TSQB-QUEUE-LENGTH)                          15200069
152100         ITEM(RV104-RL-ITEM)                                      15210069
152200         RESP(PV-RESP)                                            15220069
152300     END-EXEC.                                                    15230069
152400*                                                                 15240069
152500     IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                        15250069
152600         MOVE PV-RESP          TO  PM-RESP-22                     15260069
152700         SET DP013-LOGIC-ABEND TO  TRUE                           15270069
152800         SET DP013-NO-ROLLBACK TO  TRUE                           15280069
152900         MOVE 'H200-READ-LIST-QUEUE'                              15290069
153000                               TO  DP013-PARAGRAPH                15300069
153100         MOVE PM-PROGRAM-MESSAGE-22                               15310069
153200                               TO  DP013-MESSAGE-TEXT (1)         15320069
153300         PERFORM DP013-0000-PROCESS-ABEND                         15330069
153400     END-IF.                                                      15340069
153500*                                                                 15350069
153600 EJECT                                                            15360069
153700 H100-WRITE-QUEUE.                                                15370069
153800*                                                                 15380069
153900     EXEC CICS                                                    15390069
154000         WRITEQ TS                                                15400069
154100         REWRITE                                                  15410069
154200         QUEUE(RV100-TSQB-QUEUE-NAME)                             15420069
154300         FROM(RV104-SAVE-TS-QUEUE)                                15430069
154400         LENGTH(RV100-TSQB-QUEUE-LENGTH)                          15440069
154500         ITEM(RV104-RL-ITEM)                                      15450069
154600         RESP(PV-RESP)                                            15460069
154700     END-EXEC.                                                    15470069
154800*                                                                 15480069
154900     IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                        15490069
155000         MOVE PV-RESP          TO  PM-RESP-22                     15500069
155100         SET DP013-LOGIC-ABEND TO  TRUE                           15510069
155200         SET DP013-NO-ROLLBACK TO  TRUE                           15520069
155300         MOVE 'H100-WRITE-QUEUE'                                  15530069
155400                               TO  DP013-PARAGRAPH                15540069
155500         MOVE PM-PROGRAM-MESSAGE-22                               15550069
155600                               TO  DP013-MESSAGE-TEXT (1)         15560069
155700         PERFORM DP013-0000-PROCESS-ABEND                         15570069
155800     END-IF.                                                      15580069
155900*                                                                 15590069
156000 EJECT                                                            15600069
156100******************************************************************15610069
156200 X400-NAVIGATE.                                                   15620069
156300******************************************************************15630069
156400     COMPUTE  RV100-NUMBER-PROCESSED-ITEMS =                      15640069
156500         ((RV104-RL-ITEM - 1) * RV101-RA-MAX-ITEMS) +             15650069
156600                             RV104-RL-SUB.                        15660069
156700     MOVE RV104-DFCT-ORD-ID  TO    RV100-UK-RA-NUMBER             15670069
156800                                   RV100-UK-DEBIT-NUMBER.         15680069
156900                                                                  15690069
157000     MOVE RV100-INTER-APPL-COMMAREA TO                            15700069
157100                          RV104-SAVE-INTER-APPL-COMM.             15710069
157200                                                                  15720069
157300     PERFORM DP015-1000-START-NAVIGATOR.                          15730069
157400                                                                  15740069
157500 EJECT                                                            15750069
157600*                                                                 15760069
157700******************************************************************15770069
157800 X300-SETUP-INTER-APPL-COMM.                                      15780069
157900******************************************************************15790069
158000                                                                  15800069
158100     IF DP020-FK-RETURN(DP020-SRC-AID)                            15810069
158200                                                                  15820069
158300          IF RV104-LIST                                           15830069
158400             PERFORM  H100-WRITE-QUEUE                            15840069
158500          END-IF                                                  15850069
158600                                                                  15860069
158700         MOVE RV104-SAVE-INTER-APPL-COMM                          15870069
158800                              TO  RV100-INTER-APPL-COMMAREA       15880069
158900         MOVE DP020-INTER-APPL-FORMAT-CODE                        15890069
159000                              TO  DP020-INTER-APPL-ACKNLG-CODE    15900069
159100          PERFORM X500-RESET-INITIAL-INTER-APPL                   15910069
159200     ELSE                                                         15920069
159300                                                                  15930069
159400         MOVE RV104-DFCT-ORD-ID  TO    RV100-UK-RA-NUMBER         15940069
159500                                       RV100-UK-DEBIT-NUMBER      15950069
159600                                                                  15960069
159700     END-IF.                                                      15970069
159800                                                                  15980069
159900 EJECT                                                            15990069
160000******************************************************************16000069
160100 X500-RESET-INITIAL-INTER-APPL.                                   16010069
160200******************************************************************16020069
160300                                                                  16030069
160400         MOVE RV104-SAVE-INTER-APPL-COMM                          16040069
160500                              TO  RV100-INTER-APPL-COMMAREA.      16050069
160600         IF RV104-LIST                                            16060069
160700            IF DP020-NEXT-ACT-APPL-ERROR                          16070069
160800              MOVE RV104-SAVE-TS-QUEUE     TO                     16080069
160900                       RV101-RA-REQUEST-RECORD                    16090069
161000              SET RV101-ERR(RV104-RL-SUB) TO TRUE                 16100069
161100              MOVE RV101-RA-REQUEST-RECORD TO                     16110069
161200                       RV104-SAVE-TS-QUEUE                        16120069
161300                                                                  16130069
161400              PERFORM  H100-WRITE-QUEUE                           16140069
161500            END-IF                                                16150069
161600         END-IF.                                                  16160069
161700                                                                  16170069
161800 EJECT                                                            16180069
161900******************************************************************16190069
162000******************************************************************16200069
162100*    FILL IN SCREEN HEADER MODULE                                 16210069
162200******************************************************************16220069
162300                                                                  16230069
162400     COPY DPPD022.                                                16240069
162500 EJECT                                                            16250069
162600******************************************************************16260069
162700*    RETURN TO CICS MODULE                                        16270069
162800******************************************************************16280069
162900                                                                  16290069
163000     COPY DPPD003.                                                16300069
163100 EJECT                                                            16310069
163200******************************************************************16320069
163300*    FORMAT MESSAGE LINES MODULE                                  16330069
163400******************************************************************16340069
163500                                                                  16350069
163600     COPY DPPD005.                                                16360069
163700 EJECT                                                            16370069
163800******************************************************************16380069
163900*    GET PANEL MODULE                                             16390069
164000******************************************************************16400069
164100                                                                  16410069
164200     COPY DPPD007.                                                16420069
164300 EJECT                                                            16430069
164400******************************************************************16440069
164500*    WRITE PANEL MODULE                                           16450069
164600******************************************************************16460069
164700                                                                  16470069
164800     COPY DPPD008.                                                16480069
164900 EJECT                                                            16490069
165000******************************************************************16500069
165100*    TOGGLE THE FUNCTION KEY LINE MODULE                          16510069
165200******************************************************************16520069
165300                                                                  16530069
165400     COPY DPPD009.                                                16540069
165500 EJECT                                                            16550069
165600******************************************************************16560069
165700*    ABEND PROCESSOR MODULE                                       16570069
165800******************************************************************16580069
165900                                                                  16590069
166000     COPY DPPD013.                                                16600069
166100 EJECT                                                            16610069
166200******************************************************************16620069
166300*    CHECK COMMUNICATION AREA MODULE                              16630069
166400******************************************************************16640069
166500                                                                  16650069
166600     COPY DPPD015.                                                16660069
166700 EJECT                                                            16670069
166800******************************************************************16680069
166900*    UPDATE TIME AND DATE MODULE                                  16690069
167000******************************************************************16700069
167100                                                                  16710069
167200     COPY DPPD017.                                                16720069
167300 EJECT                                                            16730069
