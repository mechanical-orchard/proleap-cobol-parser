000700******************************************************************00010000
000800 IDENTIFICATION DIVISION.                                         00020000
000900******************************************************************00030000
001000*  *  *  *IF ANY CHANGES ARE MADE TO SAKUT023 THEY SHOULD ALSO BE 00040000
001100*         MADE TO THIS PROGRAM                                    00050000
001200                                                                  00060000
001200***************************************************************   00070000
001200                                                                  00080000
001300*  FIND 'NOTE'                                                    00090000
001400*    UPDATE CURSORS FOR TRAN TO PROCESS                           00100000
001600                                                                  00110000
001700                                                                  00120000
001800 PROGRAM-ID.             SAKUT801.                                00130000
001900 AUTHOR.                 KOHLS DEPARTMENT STORES.                 00140000
002000 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00150000
002100 DATE-WRITTEN            MAY 2002.                                00160000
002200 DATE-COMPILED.                                                   00170000
002300                                                                  00180000
ZX    ******************************************************************00190000
ZX    ****** THIS PROGRAM IS A MODIFIED COPY OF SAKUT023 FOR THE *******00200000
ZX    ****** PURPOSE OF GENERATING SPECIAL 'BULK SKU-LEVEL'      *******00210000
ZX    ****** MARKUP/MARKDOWN REPORTS IN QA.                      *******00220000
ZX    ******                                                     *******00230000
ZX    ****** IN PRODUCTION SAKUT023 RUNS AT THE COMPANY LEVEL AND ******00231000
ZX    ****** GENERATES ONE KOHL'S WIDE MARKUP/MARKDOWN REPORT.   *******00232000
ZX    ****** THIS VERSION OF THE PROGRAM ALLOWS THIS REPORT TO   *******00233000
ZX    ****** BE GENERATED AT A MORE GRANULAR LEVEL WHILE ALSO    *******00234000
ZX    ****** PRODUCING SOME ADDITIONAL FILES THAT CAN ASSIST     *******00235000
ZX    ****** WITH VALIDATIONS. THIS PROGRAM WILL ALSO GENERATE   *******00236000
ZX    ****** THE ML AND DOWNSTREAM MARK FILES AT THE LEVEL       *******00237000
ZX    ****** REQUESTED IN THE INPUT FILE.                        *******00238000
ZX    ******                                                     *******00239000
ZX    ****** THIS PROGRAM WORKS IN CONJUNCTION WITH SAKUT800     *******00239100
ZX    ****** IN ORDER TO GENERATE ONE SKU LEVEL REPORT           *******00239200
ZX    ****** FOR EACH TRANSACTION THAT GETS PICKED UP BY THIS    *******00239300
ZX    ****** PROGRAM.  WHICH TRANACTIONS ARE PICKED UP IS        *******00239400
ZX    ****** CONTROLLED VIA THE INPUT CRITERIA FILE WHICH        *******00239500
ZX    ****** WAS GENERATED BY SAKUT800 (OR MANUALLY EDITED).     *******00239600
ZX    ****** THIS PROGRAM CREATES A REPORT FOR EACH SKU PER      *******00239700
ZX    ****** TRANSACTION KEY FOUND ON THE INPUT CRITERIA FILE.   *******00239800
ZX    ****** ADDITIONALLY, IT CREATES A CSV FILE DOCUMENTING     *******00239900
ZX    ****** EACH AND EVERY MARK BEING RECORDED IN THE ML FILE.  *******00240000
ZX    ******                                                     *******00241000
ZX    ****** 1) TRANSACTION CSV FILE - THIS IS A CSV FILE THAT   *******00242000
ZX    ****** CONTAINS ALL OF THE RELEVANT ATTRIBUTES FOR EACH    *******00243000
ZX    ****** AND EVERY MARK THAT THE PROGRAM RECORDED. THIS      *******00243100
ZX    ****** FILE CAN BE FTP'D TO A PC AND OPENED IN EXCEL AND   *******00243200
ZX    ****** USED TO DETERMINE ALL OF THE MARKS THAT WENT INTO   *******00243300
ZX    ****** A GIVEN CATEGORY'S TOTALS.                          *******00243400
ZX    ******                                                     *******00243500
ZX    ****** EXAMPLE: THE MARKUP/MARKDOWN REPORT GENERATED FOR   *******00243600
ZX    ****** STORE 9911 REGISTER 3 SHOWS A TOTAL OF $150 OF      *******00243700
ZX    ****** PROMOTIONAL MARKDOWNS. THE SPREADSHEET WILL SHOW    *******00243800
ZX    ****** THE STORE/REG/TRANS/SKU/MARKDOWN TO PROMOTIONAL     *******00243900
ZX    ****** BROKEN DOWN INTO 3 DIFFERENT ROWS FOR $20, $90, AND *******00244000
ZX    ****** $40.                                                *******00244100
ZX    ******                                                     *******00244200
ZX    ****** IN PRODUCTION SAKUT023 RUNS AT THE COMPANY LEVEL AND ******00244300
ZX    ****** GENERATES ONE KOHL'S WIDE MARKUP/MARKDOWN REPORT.   *******00244400
ZX    ****** THIS VERSION OF THE PROGRAM ALLOWS THIS REPORT TO   *******00244500
ZX    ****** BE GENERATED AT A MORE GRANULAR LEVEL WHILE ALSO    *******00244600
ZX    ****** PRODUCING SOME ADDITIONAL FILES THAT CAN ASSIST     *******00244700
ZX    ****** WITH VALIDATIONS. THIS PROGRAM WILL ALSO GENERATE   *******00244800
ZX    ****** THE ML AND DOWNSTREAM MARK FILES AT THE LEVEL       *******00244900
ZX    ****** REQUESTED IN THE INPUT FILE.                        *******00245000
ZX    ******************************************************************00245100
ZX    ****** PT-710-NORCPT-MDC-QTY   ***********************************00245200
ZX    ****** PT-710-NORCPT-MKDN-QTY  ***********************************00245300
ZX    ****** PT-PROMOTIONAL-MDC-QTY  ***********************************00245400
ZX    ****** PT-TIERED-MDC-QTY       ***********************************00245500
ZX    ****** PT-GOLDSTAR-MDC-QTY     ***********************************00245600
ZX    ****** PT-MANUAL-LID-MDC-QTY   ***********************************00245700
ZX    ****** PT-OWNERSHIP-ADJ-MDC-QTY **********************************00245800
ZX    ****** PT-OWN-RETRN-ADJ-MDC-QTY **********************************00245900
ZX    ****** PT-SENIOR-CITIZEN-MDC-QTY *********************************00246000
ZX    ****** PT-KOHLS-COUPON-MDC-QTY ***********************************00246100
ZX    ****** PT-760-OFFER-MDC-QTY    ***********************************00246200
ZX    ****** PT-761-TLDTIER-MDC-QTY  ***********************************00246300
ZX    ****** PT-762-LIDTIER-MDC-QTY  ***********************************00246400
ZX    ****** PT-763-GWPPWP-MDC-QTY   ***********************************00246500
ZX    ****** PT-BOGO-MDC-QTY         ***********************************00246600
ZX    ****** PT-UNEARNED-RWDS-MDC-QTY **********************************00246700
ZX    ****** PT-EMPLY-DISC-MDC-QTY   ***********************************00246800
ZX    ****** PT-765-GIFT-MKDN-AMT    ***********************************00246900
002400******************************************************************00247000
002500*  THIS PROGRAM CREATES EIGHT MARKDOWN/MARKUP FILES AND ONE       00248000
002600*  MERCHANDISE LEDGER MARKDOWN/MARKUP TRANSACTION REPORT. THIS    00249000
002700*  PROGRAM SOURCE FROM THE COSA DATABASE.                         00250000
002800******************************************************************00260000
000100******************************************************************00270000
000200*   12/17/2015 -BARB ERTL - COPY OF PROD VERSION OF SAKUT023      00280000
000300*              TO BE USED FOR SEVA TESTING                        00281000
000400*            - MULTIPLE TRANSACTIONS ALLOWED FOR INPUT            00282000
000500*            - CORRECTIONS/LATES/CUTOFF WILL NOT BE ON REPORT     00283000
000600******************************************************************00284000
MKTPLC*  CHANGES MADE:                                                  00285000
MKTPLC*     BY JIM HUNTER     06/02/2020           CHG0246098           00286000
MKTPLC*     REPLACE WAYFAIR DEPT 070 CHECK WITH MARKETPLACE DEPT 985    00286100
MKTPLC*     CHECK TO PREVENT MARKETPLACE ITEMS FROM GOING TO ML.        00286200
MKTPLC******************************************************************00286300
BOSSCL*   09/21/2020 - JIM HUNTER  BOSS CLEARANCE   CHG0249017          00286400
BOSSCL* THIS CHANGE WILL CONTAIN A FIX FOR EXISTING PRODUCTION ORDERS,  00286500
BOSSCL* AS WELL AS BOSS CLEARANCE ORDERS WHEN THEY ARE ENABLED:         00286600
BOSSCL*   IF THE STORE PRICE CHANGED AFTER THE ECOM ORDER DATE          00286700
BOSSCL*     GET THE STORE'S ACTIVE PRICE ON THE ECOM ORDER DATE         00286800
BOSSCL*     AND THE STORE SALE DATE.   IF THERE IS A DIFFERENCE,        00286900
BOSSCL*     CALCULATE AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE.       00287000
BOSSCL*     NEED TSKXREF AND TPPCPRC TABLES.                            00288000
BOSSCL*   IF THE STORE PRICE DIDN'T CHANGE,                             00288100
BOSSCL*     DO NOT CREATE AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE    00288200
BOSSCL*     BETWEEN THE ECOM AND STORE PRICES.  THE TRANSFER PRICE      00288300
BOSSCL*     FROM ECOM TO THE STORE WILL BE OFFSET BY THE PRICE THE      00288400
BOSSCL*     CUSTOMER PAYS TO THE STORE.                                 00288500
BOSSCL******************************************************************00288600
BOSSC2*   10/30/2020 - JIM HUNTER  BOSS CLEARANCE   CHG0246551          00288700
BOSSC2* THIS CHANGE IS FIX 2 OF 3 FOR CALCULATING OWNERSHIP ADJUSTMENTS 00288800
BOSSC2* FOR BOSS, SFS AND BOPUS ORDERS.  THIS SHOULD BE THE FINAL CHANGE00288900
BOSSC2* FOR SFS AND BOPUS ORDERS.  IT ALSO CONTAINS CHANGES FOR BOSS    00289000
BOSSC2* ORDERS WHICH WILL REQUIRE A FUTURE CHANGE TO GET TRANSFER       00289100
BOSSC2* INFORMATION.                                                    00289200
BOSSC2******************************************************************00289300
BOSSC3*   11/04/2020 - JIM HUNTER  BOSS CLEARANCE   CHG0252661          00289424
BOSSC3* THIS CHANGE IS FIX 3 OF 3 FOR CALCULATING OWNERSHIP ADJUSTMENTS 00289502
BOSSC3* FOR BOSS ORDERS.  IT WILL READ THE NEW SAT_BOSS_TRANSFERS TABLE 00289602
BOSSC3* TO GET THE TRANSFER DATE AND PRICE, WHICH IS REQUIRED WHEN      00289702
BOSSC3* CALCULATING BOSS OWNERSHIP ADJUSTMENTS.                         00289802
BOSSC3******************************************************************00290002
MUCFIX*   12/18/2020 - JIM HUNTER  MARKUP CANCEL FIX   CHG0252661       00290124
MUCFIX* THIS IS A FIX TO MAKE SURE THAT MARKDOWN CANCEL AMOUNTS ARE     00290223
MUCFIX* POSITIVE.                                                       00290323
MUCFIX******************************************************************00290423
262807*   05/26/2021 - JIM HUNTER  SEPHORA DISCOUNTS   CHG0262807       00290534
262807* THIS CHANGE ADDS SEPHORA DISCOUNTS TO THE MU / MD REPORT.       00290634
262807* ALSO, THE 4 OBSOLETE MW FILES HAVE BEEN REMOVED:                00290734
262807* DATAWHSE-MARKDOWN-FILE                                          00290834
262807* DATAWHSE-MARKUP-FILE                                            00290934
262807* HOLD-DATAWHSE-MARKDOWN-FILE                                     00291034
262807* HOLD-DATAWHSE-MARKUP-FILE                                       00291134
262807******************************************************************00291234
SEPHOR*   03/16/2022 - JIM HUNTER  SEPHORA GIFT CARDS  CHG0??????       00291335
SEPHOR* THIS CHANGE PREVENTS SEPHORA GIFT CARDS FROM GOING TO THE       00291435
SEPHOR* MU / MD REPORT OR ML OUTPUT FILES.                              00291535
SEPHOR******************************************************************00291635
003000                                                                  00291702
003100******************************************************************00291802
003200 ENVIRONMENT DIVISION.                                            00291902
003300******************************************************************00292002
003400                                                                  00292102
003500 CONFIGURATION SECTION.                                           00292202
003600                                                                  00293002
003700 SOURCE-COMPUTER.        IBM-3090.                                00300000
003800 OBJECT-COMPUTER.        IBM-3090.                                00310000
003900                                                                  00320000
004000 INPUT-OUTPUT SECTION.                                            00330000
004100                                                                  00340000
004200 FILE-CONTROL.                                                    00350000
004300                                                                  00360000
004400     SELECT POS-DATE-FILE                                         00370000
004500         ASSIGN TO INP01.                                         00380000
004600                                                                  00390000
004700     SELECT CRITERIA-FILE                                         00400000
004800         ASSIGN TO INP02.                                         00410000
004900                                                                  00420000
005000     SELECT LEDGER-MARKDOWN-FILE                                  00430000
005100         ASSIGN TO OUT01.                                         00440000
005200                                                                  00450000
005300     SELECT LEDGER-MARKUP-FILE                                    00460000
005400         ASSIGN TO OUT02.                                         00470000
005500                                                                  00480000
006200     SELECT HOLD-LEDGER-MARKDOWN-FILE                             00550000
006300         ASSIGN TO OUT05.                                         00560000
006400                                                                  00570000
006500     SELECT HOLD-LEDGER-MARKUP-FILE                               00580000
006600         ASSIGN TO OUT06.                                         00590000
006700                                                                  00600000
007400     SELECT DATAWHSE-FILE                                         00670000
007500         ASSIGN TO OUT09.                                         00680000
007600                                                                  00690000
007700     SELECT MERCH-LEDGER-REPORT                                   00700000
007800         ASSIGN TO RPT01.                                         00710000
007900                                                                  00720000
ZX         SELECT DAY02-TRANS-REPORT                                    00730000
ZX             ASSIGN TO OUT10.                                         00740000
ZX                                                                      00750000
008000******************************************************************00760000
008100 DATA DIVISION.                                                   00770000
008200******************************************************************00780000
008300                                                                  00790000
008400 FILE SECTION.                                                    00791000
008500                                                                  00792000
008600 FD POS-DATE-FILE                                                 00793000
008700     RECORDING MODE IS F                                          00794000
008800     LABEL RECORDS ARE STANDARD                                   00795000
008900     RECORD CONTAINS 80 CHARACTERS                                00796000
009000     BLOCK CONTAINS 0 RECORDS                                     00797000
009100     DATA RECORD IS POS-DATE-RECORD.                              00798000
009200                                                                  00799000
009300 01 POS-DATE-RECORD              PIC  X(80).                      00800000
009400                                                                  00810000
009500 FD CRITERIA-FILE                                                 00820000
009600     RECORDING MODE IS F                                          00830000
009700     LABEL RECORDS ARE STANDARD                                   00840000
009800     RECORD CONTAINS 80 CHARACTERS                                00850000
009900     BLOCK CONTAINS 0 RECORDS                                     00860000
010000     DATA RECORD IS CRITERIA-RECORD.                              00870000
010100                                                                  00880000
010200 01 CRITERIA-RECORD              PIC  X(80).                      00890000
010300                                                                  00900000
010400 FD  LEDGER-MARKDOWN-FILE                                         00910000
010500     RECORDING MODE IS F                                          00920000
010600     LABEL RECORDS ARE STANDARD                                   00930000
010700     BLOCK CONTAINS 0 RECORDS                                     00940000
010800     RECORD CONTAINS 200 CHARACTERS                               00950000
010900     DATA RECORD IS LM-LEDGER-MARKDOWN-RECORD.                    00960000
011000                                                                  00970000
011100 01  LM-LEDGER-MARKDOWN-RECORD   PIC  X(200).                     00980000
011200                                                                  00990000
011300 FD  LEDGER-MARKUP-FILE                                           01000000
011400     RECORDING MODE IS F                                          01010000
011500     LABEL RECORDS ARE STANDARD                                   01020000
011600     BLOCK CONTAINS 0 RECORDS                                     01030000
011700     RECORD CONTAINS 200 CHARACTERS                               01040000
011800     DATA RECORD IS LM-LEDGER-MARKUP-RECORD.                      01050000
011900                                                                  01060000
012000 01  LM-LEDGER-MARKUP-RECORD     PIC  X(200).                     01070000
012100                                                                  01080000
014000 FD  HOLD-LEDGER-MARKDOWN-FILE                                    01270000
014100     RECORDING MODE IS F                                          01280000
014200     LABEL RECORDS ARE STANDARD                                   01290000
014300     BLOCK CONTAINS 0 RECORDS                                     01300000
014400     RECORD CONTAINS 200 CHARACTERS                               01310000
014500     DATA RECORD IS HOLD-LEDGER-MARKDOWN-RECORD.                  01320000
014600                                                                  01330000
014700 01  HOLD-LEDGER-MARKDOWN-RECORD PIC  X(200).                     01340000
014800                                                                  01350000
014900 FD  HOLD-LEDGER-MARKUP-FILE                                      01360000
015000     RECORDING MODE IS F                                          01370000
015100     LABEL RECORDS ARE STANDARD                                   01380000
015200     BLOCK CONTAINS 0 RECORDS                                     01390000
015300     RECORD CONTAINS 200 CHARACTERS                               01400000
015400     DATA RECORD IS HOLD-LEDGER-MARKUP-RECORD.                    01410000
015500                                                                  01420000
015600 01  HOLD-LEDGER-MARKUP-RECORD     PIC  X(200).                   01430000
015700                                                                  01440000
017600 FD  DATAWHSE-FILE                                                01630000
017700     RECORDING MODE IS F                                          01640000
017800     LABEL RECORDS ARE STANDARD                                   01650000
017900     BLOCK CONTAINS 0 RECORDS                                     01660000
018000     RECORD CONTAINS 200 CHARACTERS                               01670000
018100     DATA RECORD IS DATAWHSE-RECORD.                              01680000
018200                                                                  01690000
018300 01  DATAWHSE-RECORD             PIC  X(200).                     01700000
018400                                                                  01710000
ZX     FD  DAY02-TRANS-REPORT                                           01720000
ZX         RECORDING MODE IS F                                          01730000
ZX         LABEL RECORDS ARE STANDARD                                   01740000
ZX         BLOCK CONTAINS 0 RECORDS                                     01750000
ZX         RECORD CONTAINS 300 CHARACTERS                               01760000
ZX         DATA RECORD IS DAY02-TRANS-RECORD.                           01770000
ZX                                                                      01780000
ZX     01  DAY02-TRANS-RECORD          PIC  X(300).                     01790000
                                                                        01800000
018500 FD  MERCH-LEDGER-REPORT                                          01810000
018600     RECORDING MODE IS F                                          01820000
018700     LABEL RECORDS ARE STANDARD                                   01830000
018800     BLOCK CONTAINS 0 RECORDS                                     01840000
018900     RECORD CONTAINS 132 CHARACTERS.                              01841000
019000                                                                  01842000
019100 01  REPORT-LINE-OUT             PIC  X(132).                     01843000
019200                                                                  01844000
019300 WORKING-STORAGE SECTION.                                         01845000
019400                                                                  01846000
019500*  PARAMETER LIST FOR THE CALENDAR ROUTINE                        01847000
019600                                                                  01848000
019700     COPY DPWS500.                                                01849000
019800                                                                  01850000
019900*  REPORT HEADER FOR A 132 COLUMN REPORT                          01860000
020000                                                                  01870000
020100     COPY DPWS132O.                                               01880000
020200                                                                  01890000
020300*  MERCHANDISE LEDGER PRICE CHANGE RECORD LAYOUT                  01900000
020400                                                                  01910000
020500     COPY MLRD017.                                                01920000
020600                                                                  01930000
020700* MERCHANDISE LEDGER PRICE CHANGE RECORD LAYOUT FOR DATA WAREHOUSE01940000
020800                                                                  01950000
020900     COPY MLRD044.                                                01960000
021000                                                                  01970000
021100 01  AC-ABEND-CODE               PIC S9(04) VALUE ZEROS.          01980000
021200     88  AC-CONTROL-CARD-ERROR              VALUE +4003.          01990000
021300     88  AC-INVALID-DATA-ERROR              VALUE +4008.          02000000
021400     88  AC-CALENDAR-ERROR                  VALUE +4010.          02010000
023900     88  AC-DB2-ERROR                       VALUE +4013.          02020000
021500                                                                  02030000
021600 01  PV-SUBSCRIPTS.                                               02040000
021700     05  PV-TOT-SUB              PIC S9(04) VALUE ZERO.           02050000
021800                                                                  02060000
021900 01  PV-NULL-INDICATORS.                                          02070000
022000     05 PV-ORIG-OWND-UNT-AMT-NULL-IND PIC S9(4) COMP VALUE +0.    02080000
BOSSCL     05 PV-OMNI-CHNL-TYP-CDE-NULL-IND PIC S9(4) COMP VALUE +0.    02090000
021800                                                                  02100000
022200 01  PS-PROGRAM-SWITCHES.                                         02110000
022300     05  PS-END-OF-TRAN-IND      PIC  X(01) VALUE 'N'.            02120000
022400         88  PS-END-OF-TRAN-YES             VALUE 'Y'.            02130000
022500         88  PS-END-OF-TRAN-NO              VALUE 'N'.            02140000
022600     05  PS-END-OF-DKEY-IND      PIC  X(01) VALUE 'N'.            02150000
022700         88  PS-END-OF-DKEY-YES             VALUE 'Y'.            02160000
022800     05  PS-END-OF-ITEM-IND      PIC  X(01) VALUE 'N'.            02170000
022900         88  PS-END-OF-ITEM-YES             VALUE 'Y'.            02180000
023000         88  PS-END-OF-ITEM-NO              VALUE 'N'.            02190000
023100     05  PS-END-OF-LID-IND       PIC  X(01) VALUE 'N'.            02200000
023200         88  PS-END-OF-LID-YES              VALUE 'Y'.            02210000
023300         88  PS-END-OF-LID-NO               VALUE 'N'.            02220000
023700     05  PS-TIERED-ITEM-IND      PIC  X(01) VALUE 'N'.            02230000
023800         88  PS-TIERED-ITEM-YES             VALUE 'Y'.            02240000
023900         88  PS-TIERED-ITEM-NO              VALUE 'N'.            02250000
ZX         05  PS-SKU-SPECIFIC-RUN-IND PIC  X(01) VALUE 'N'.            02260000
ZX             88  PS-SKU-SPECIFIC-RUN-Y          VALUE 'Y'.            02270000
ZX             88  PS-SKU-SPECIFIC-RUN-N          VALUE 'N'.            02280000
ZX         05  PS-ORDER-NUMBER-IND     PIC  X(01) VALUE 'N'.            02290000
ZX             88  PS-ORDER-NUMBER-FOUND-Y        VALUE 'Y'.            02300000
ZX             88  PS-ORDER-NUMBER-FOUND-N        VALUE 'N'.            02310000
ZX         05  PV-DISC-TYPE            PIC  X(01) VALUE 'L'.            02320000
ZX             88  PV-DISC-TYPE-GROUP             VALUE 'G'.            02330000
ZX             88  PV-DISC-TYPE-ASSOC             VALUE 'A'.            02340000
ZX             88  PV-DISC-TYPE-LID               VALUE 'L'.            02350000
024000     05  PS-END-OF-CARD-FILE-SW  PIC  X(01) VALUE 'N'.            02360000
024100         88  PS-END-OF-CARD-FILE            VALUE 'Y'.            02370000
024200     05  PS-END-OF-CRIT-FILE-SW  PIC  X(01) VALUE 'N'.            02380000
024300         88  PS-END-OF-CRIT-FILE            VALUE 'Y'.            02390000
024400                                                                  02391000
024500     05  PS-END-OF-ORIG-ITM-SW   PIC  X(01) VALUE 'N'.            02392000
024600         88  PS-END-OF-ORIG-ITM-YES         VALUE 'Y'.            02393000
024700         88  PS-END-OF-ORIG-ITM-NO          VALUE 'N'.            02394000
024800     05  PS-FIRST-READ-SW        PIC  X(01) VALUE 'N'.            02395000
024900         88  PS-FIRST-READ-YES              VALUE 'Y'.            02396000
025000         88  PS-FIRST-READ-NO               VALUE 'N'.            02397000
025100     05  PS-UNMTCHD-AMT-SW       PIC  X(01) VALUE 'N'.            02398000
025200         88  PS-UNMTCHD-AMT-YES             VALUE 'Y'.            02399000
025300         88  PS-UNMTCHD-AMT-NO              VALUE 'N'.            02400000
BOSSC2     05  PS-ECOM-PRICE-CHG-SW    PIC  X(01) VALUE 'N'.            02410000
BOSSC2         88  PS-ECOM-PRICE-CHANGE-YES       VALUE 'Y'.            02420000
BOSSC2         88  PS-ECOM-PRICE-CHANGE-NO        VALUE 'N'.            02430000
BOSSC2     05  PS-ECOM-PRICE-FOUND-SW  PIC  X(01) VALUE 'N'.            02440000
BOSSC2         88  PS-ECOM-PRICE-FOUND            VALUE 'Y'.            02450000
BOSSC2         88  PS-ECOM-PRICE-NOT-FOUND        VALUE 'N'.            02460000
025400                                                                  02470000
025500 01  PC-PROGRAM-CONSTANTS.                                        02480000
025600     05  PC-CURRENT-PROGRAM-NAME PIC  X(08) VALUE 'SAKUT801'.     02490000
025700     05  PC-YES                  PIC  X(01) VALUE 'Y'.            02500000
025800     05  PC-11                   PIC  9(02) VALUE 11.             02510000
025900     05  PC-ONE                  PIC  9(01) VALUE 1.              02520000
026000     05  PC-LINE-LIMIT           PIC  9(02) VALUE 60.             02530000
026100     05  PC-ROW-NOT-FOUND        PIC S9(03) VALUE +100.           02540000
ZX         05  PC-POC                  PIC S9(04) VALUE +200.           02550000
ZX         05  PC-MPOC                 PIC S9(04) VALUE +300.           02560000
026300     05  PC-NON-OWNED            PIC  X(01) VALUE 'N'.            02570000
026400     05  PC-NON-OWNED-TRACKED    PIC  X(01) VALUE 'T'.            02580000
026500     05  PC-GOLDSTAR-G           PIC  X(01) VALUE 'G'.            02590000
214615     05  PC-REGULAR-R            PIC  X(01) VALUE 'R'.            02600000
214615     05  PC-PROMO-P              PIC  X(01) VALUE 'P'.            02610000
214615     05  PC-CLEARANCE-C          PIC  X(01) VALUE 'C'.            02620000
214615     05  PC-UNKNOWN-N            PIC  X(01) VALUE 'N'.            02630000
026600     05  PC-RSLV-ORIGINAL        PIC  X(01) VALUE 'R'.            02640000
026700     05  PC-REVERSAL             PIC  X(01) VALUE 'R'.            02650000
026800     05  PC-RSLV-VOID            PIC  X(01) VALUE 'V'.            02651000
026900     05  PC-LATE                 PIC  X(01) VALUE 'L'.            02652000
027000     05  PC-CORRECTION           PIC  X(01) VALUE 'V'.            02653000
262807     05  PC-SEPHORA-720          PIC  X(03) VALUE '720'.          02653134
027100     05  PC-SENIOR-CIT-728       PIC  X(03) VALUE '728'.          02654000
027200     05  PC-KOHLS-CPON-733       PIC  X(03) VALUE '733'.          02655000
027300     05  PC-TRAN-LEVEL-734       PIC  X(03) VALUE '734'.          02656000
027400     05  PC-GOLDSTAR-753         PIC  X(03) VALUE '753'.          02657000
027500     05  PC-760-OFFER-COUPON     PIC  X(03) VALUE '760'.          02658000
027600     05  PC-761-OFFER-TLD-TIERED PIC  X(03) VALUE '761'.          02659000
027700     05  PC-762-OFFER-LID-TIERED PIC  X(03) VALUE '762'.          02660000
027800     05  PC-763-OFFER-GWP-PWP-PRORATED PIC  X(03) VALUE '763'.    02670000
027900     05  PC-ADDTL-PROMO-OFF-774  PIC  X(03) VALUE '774'.          02680000
028000     05  PC-BOGO-775             PIC  X(03) VALUE '775'.          02690000
028100     05  PC-BOGO-777             PIC  X(03) VALUE '777'.          02700000
028200     05  PC-UNEARNED-REWARDS-780 PIC  X(03) VALUE '780'.          02710000
028300     05  PC-OWN-RTN-ADJ-792      PIC  X(03) VALUE '792'.          02720000
028400     05  PC-OWN-ADJ-796          PIC  X(03) VALUE '796'.          02730000
028500     05  PC-GIFT-CARD            PIC  X(03) VALUE '983'.          02740000
SEPHOR     05  PC-SEPHORA-GIFT-CARD-712 PIC X(03) VALUE '712'.          02741035
028600     05  PC-THIRD-PARTY-CARD-833 PIC  X(03) VALUE '833'.          02750000
028700     05  PC-THIRD-PARTY-CARD-834 PIC  X(03) VALUE '834'.          02760000
MKTPLC     05  PC-MKTPLACE-DEPT-985    PIC  X(03) VALUE '985'.          02770000
028800     05  PC-WAYFAIR-DEPT-070     PIC  X(03) VALUE '070'.          02780000
028900     05  PC-701-SIGNING-ERROR    PIC  X(03) VALUE '701'.          02790000
029000     05  PC-702-PLU-ERROR        PIC  X(03) VALUE '702'.          02800000
029100     05  PC-703-DAMAGED-MDSE     PIC  X(03) VALUE '703'.          02810000
029200     05  PC-704-KEYED-GWP        PIC  X(03) VALUE '704'.          02820000
029300     05  PC-705-INVALID-UPC-MKDN PIC  X(03) VALUE '705'.          02830000
029400     05  PC-706-RAINCHECK        PIC  X(03) VALUE '706'.          02840000
029500     05  PC-707-MEET-COMPETITION PIC  X(03) VALUE '707'.          02850000
029600     05  PC-708-SPECIAL-PRMTN    PIC  X(03) VALUE '708'.          02860000
029700     05  PC-709-YES-WE-CAN       PIC  X(03) VALUE '709'.          02870000
205464     05  PC-710-NON-RCPT-RTRN    PIC  X(03) VALUE '710'.          02880000
029800     05  PC-746-PLU-TIER         PIC  X(03) VALUE '746'.          02890000
029900     05  PC-790-EMPLY-DISCOUNT   PIC  X(03) VALUE '790'.          02900000
030000     05  PC-765-GFT-RCPT-RTRN    PIC  X(03) VALUE '765'.          02910000
030100     05  PC-NULL                 PIC S9(4) COMP VALUE -1.         02920000
030200                                                                  02930000
030300**>> DETAIL LINE CONSTANTS FOR REPORT                             02940000
030400     05  PC-PROMOTIONAL          PIC X(14) VALUE 'PROMOTIONAL   '.02950000
030500     05  PC-TIERED               PIC X(14) VALUE 'ADDTL PROMOTNS'.02960000
030600     05  PC-GOLDSTAR             PIC X(14) VALUE 'GOLDSTAR      '.02970000
030700     05  PC-MANUAL-LID           PIC X(14) VALUE 'MANUAL LID    '.02980000
030800     05  PC-OWNERSHIP-ADJ        PIC X(14) VALUE 'OWNERSHIP ADJ '.02990000
030900     05  PC-OWN-RETRN-ADJ        PIC X(14) VALUE 'OWN RETURN ADJ'.03000000
031000     05  PC-SENIOR-CITIZEN       PIC X(14) VALUE 'SENIOR CITIZEN'.03010000
031100     05  PC-KOHLS-COUPON         PIC X(14) VALUE 'KOHLS COUPON  '.03020000
031200     05  PC-OFFER-COUPON         PIC X(14) VALUE 'OFFER COUPON  '.03030000
031300     05  PC-OFFER-TLD-TIERED     PIC X(14) VALUE 'OFFER TLD TIER'.03040000
031400     05  PC-OFFER-LID-TIERED     PIC X(14) VALUE 'OFFER LID TIER'.03050000
031500     05  PC-OFFER-GWP-PWP        PIC X(14) VALUE 'OFFER GWP/PWP '.03060000
205464     05  PC-NON-REC-RETURN       PIC X(14) VALUE 'NON RCPT RTRN '.03070000
031600     05  PC-GIFT-RCPT-RETURN     PIC X(14) VALUE 'GIFT RCPT RTRN'.03080000
031700     05  PC-BOGO                 PIC X(14) VALUE 'EBOGO         '.03090000
031800     05  PC-UNEARNED-REWARDS     PIC X(14) VALUE 'UNEARNED RWDS'. 03100000
031900     05  PC-EMPLY-DISCOUNT       PIC X(14) VALUE 'EMPLY DISCOUNT'.03110000
262807     05  PC-SEPHORA-DISCOUNT     PIC X(14) VALUE 'SEPHORA DISCNT'.03111034
032000     05  PC-TOTAL                PIC X(14) VALUE 'TOTAL         '.03120000
032100                                                                  03130000
032200*USED FOR DISPLAY PURPOSES                                        03140000
032300 01  WS-DIFFER-AMT               PIC  9(07)V99 VALUE ZEROS.       03150000
032400                                                                  03160000
032500 01  PV-RUN-DATE-CCYY-MM-DD      PIC  X(10).                      03170000
032600                                                                  03180000
032700 01  PV-CUT-OFF-CCYY-MM-DD       PIC  X(10).                      03190000
032600                                                                  03200000
BOSSC2 01  PV-TRANSFER-DATE            PIC  X(10)   VALUE SPACES.       03210000
032800                                                                  03220000
ZX     01  WS-DAY02-HEADR-RECORD.                                       03230000
ZX         05  WS-HEADER-TEXT1             PIC X(52)                    03240000
ZX         VALUE 'TRN TYP,SLS DTE,DB2 PARTN,STORE,REG,TRAN#,ST TIME,SC'.03250000
ZX         05  WS-HEADER-TEXT2             PIC X(52)                    03260000
ZX         VALUE ' SEQNO,LI SEQNO,DEPT,SKU,LID RSN CDE,DISC AMT,MU/MD,'.03270000
ZX         05  WS-HEADER-TEXT3             PIC X(52)                    03280000
ZX         VALUE 'DISC TYPE,ORRA,RRA,STA,STC,OSTC,CCA,NCA,OURA,OOURA,L'.03281000
ZX         05  WS-HEADER-TEXT4             PIC X(52)                    03282000
ZX         VALUE 'ID AMT,TRN DTE,ORD NBR,PRB,OLD PRC,NEW PRC,DIFF,OMNI'.03283000
ZX     01  WS-DAY02-TRANS-RECORD.                                       03284000
ZX         05  WS-TRAN-TYPE                PIC X(15).                   03285000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03286000
ZX         05  WS-EPTRN-SLS-DTE            PIC X(10).                   03287000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03288000
ZX         05  WS-EPITM-PARTN-NBR          PIC 9(4).                    03289000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03290000
ZX         05  WS-EPITM-STR-NBR            PIC 9(4).                    03291000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03291100
ZX         05  WS-EPITM-RGST-ID            PIC 9(2).                    03291200
ZX         05  FILLER                      PIC X(1) VALUE ','.          03291300
ZX         05  WS-EPITM-TRN-NBR            PIC 9(4).                    03291400
ZX         05  FILLER                      PIC X(1) VALUE ','.          03291500
ZX         05  WS-EPITM-STRT-TM            PIC X(8).                    03291600
ZX         05  FILLER                      PIC X(1) VALUE ','.          03291700
ZX         05  WS-EPITM-SLS-CORR-SEQ-NBR   PIC -9(4).                   03291800
ZX         05  FILLER                      PIC X(1) VALUE ','.          03291900
ZX         05  WS-EPITM-LNE-ITM-SEQ-NBR    PIC 9(4).                    03292000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03292100
ZX         05  WS-DEPT-NBR                 PIC X(3).                    03292200
ZX         05  FILLER                      PIC X(1) VALUE ','.          03292300
ZX         05  WS-EPITM-SKU-NBR            PIC 9(8).                    03292400
ZX         05  FILLER                      PIC X(1) VALUE ','.          03292500
ZX         05  WS-EPLID-LID-RSN-CDE        PIC X(3).                    03292600
ZX         05  FILLER                      PIC X(1) VALUE ','.          03292700
ZX         05  WS-DISC-AMT-FILE            PIC -(6)9.99.                03292800
ZX         05  FILLER                      PIC X(1) VALUE ','.          03292900
ZX         05  WS-MDWN-TYPE-FILE           PIC X(3).                    03293000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03293100
ZX         05  WS-DISC-TYPE-FILE           PIC X(30).                   03293200
ZX         05  FILLER                      PIC X(1) VALUE ','.          03293300
ZX         05  WS-ORIG-REG-RTL-AMT         PIC -(6)9.99.                03293400
ZX         05  FILLER                      PIC X(1) VALUE ','.          03293500
ZX         05  WS-REG-RTL-AMT              PIC -(6)9.99.                03293600
ZX         05  FILLER                      PIC X(1) VALUE ','.          03293700
ZX         05  WS-ITM-STAT-CDE             PIC X(2).                    03293800
ZX         05  FILLER                      PIC X(1) VALUE ','.          03293900
ZX         05  WS-SAL-TYP-CDE              PIC X(1).                    03294000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03294100
ZX         05  WS-ORIG-SAL-TYP-CDE         PIC X(1).                    03294200
ZX         05  FILLER                      PIC X(1) VALUE ','.          03294300
ZX         05  WS-CUST-CHRGD-AMT           PIC -(6)9.99.                03294400
ZX         05  FILLER                      PIC X(1) VALUE ','.          03294500
ZX         05  WS-NET-CHRGD-AMT            PIC -(6)9.99.                03294600
ZX         05  FILLER                      PIC X(1) VALUE ','.          03294700
ZX         05  WS-OURA-AMT                 PIC -(6)9.99.                03294800
ZX         05  FILLER                      PIC X(1) VALUE ','.          03294900
ZX         05  WS-ORIG-OURA-AMT            PIC -(6)9.99.                03295000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03295100
ZX         05  WS-EPLID-LID-AMT            PIC -(6)9.99.                03295200
ZX         05  FILLER                      PIC X(1) VALUE ','.          03295300
ZX         05  WS-EPTRN-TRN-DTE            PIC X(10).                   03295400
ZX         05  FILLER                      PIC X(1) VALUE ','.          03295500
ZX         05  WS-EPORD-ORD-NBR            PIC X(23).                   03295600
ZX         05  FILLER                      PIC X(1) VALUE ','.          03295700
ZX         05  WS-PROBLEM-IND              PIC X(1).                    03295800
ZX         05  FILLER                      PIC X(1) VALUE ','.          03295900
ZX         05  WS-OLD-PRICE-AMT            PIC -(6)9.99.                03296000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03296100
ZX         05  WS-NEW-PRICE-AMT            PIC -(6)9.99.                03296200
ZX         05  FILLER                      PIC X(1) VALUE ','.          03296300
ZX         05  WS-DIFF-PRICE-AMT           PIC -(6)9.99.                03296400
ZX         05  FILLER                      PIC X(1) VALUE ','.          03296500
ZX         05  WS-OMNI-CHNL-FFLMT-TYP-CDE  PIC X(3).                    03296600
ZX         05  FILLER                      PIC X(04).                   03296700
ZX                                                                      03296800
032900 01  PV-PROGRAM-VARIABLES.                                        03296900
ZX         05  WS-DISC-TYPE            PIC X(30).                       03297000
ZX         05  WS-MDWN-TYPE            PIC X(3).                        03298000
ZX         05  WS-ISSUE-IND            PIC X(1).                        03298100
ZX         05  WS-DISC-AMT             PIC -(6)9.99.                    03298200
ZX         05  WS-EPIGP-GP-AMT         PIC S9(7)V99 VALUE ZERO.         03298300
ZX         05  PV-DIFF                 PIC S9(5)V99 VALUE ZEROES.       03298400
033000     05  PV-LID-SEQ-NBR          PIC S9(04) COMP VALUE ZERO.      03298500
033100     05  PV-ORIG-CPBL-LVL-NBR    PIC S9(04) COMP.                 03298600
033200     05  PV-ORIG-CUST-CHRGD-AMT  PIC S9(7)V9(2) COMP-3 VALUE ZERO.03298700
033300     05  PV-TOTAL-MKDN-AMT       PIC  9(9)V9(2) VALUE ZEROS.      03298800
033400     05  PV-TOTAL-MKDNCAN-AMT    PIC  9(9)V9(2) VALUE ZEROS.      03298900
033500     05  PV-SPACE-CONTROL        PIC  9(02) VALUE 1.              03299000
033600     05  PV-PARAGRAPH-NAME       PIC  X(30) VALUE SPACES.         03300000
033700     05  PV-OPERATION-MSG-1      PIC  X(40) VALUE SPACES.         03310000
033800     05  PV-OPERATION-MSG-2      PIC  X(40) VALUE SPACES.         03320000
033900     05  PV-FISC-PERIOD-NBR-HOLD PIC  9(02) VALUE 0.              03330000
034000     05  PV-PAGE-COUNT           PIC  9(02) VALUE 1.              03340000
034100     05  PV-LINE-COUNT           PIC  9(02) VALUE ZERO.           03350000
034200     05  PV-POS-DATE-CYMD        PIC  9(08) VALUE ZEROS.          03360000
034300     05  PV-PRICE-CHANGE-AMOUNT  PIC S9(7)V99 VALUE ZERO.         03370000
034400     05  PV-CUST-CHRGD-AMT       PIC  9(07)V9(02) VALUE ZERO.     03380000
034500     05  PV-EXTENDED-AMT         PIC S9(07)V9(02) VALUE ZERO.     03390000
034600     05  PV-NET-CHRGD-AMT        PIC  9(07)V9(02) VALUE ZERO.     03400000
034700     05  PV-EXCLUDE-LID-AMT      PIC  9(07)V9(02) VALUE ZERO.     03410000
040220     05  PV-NEW-PR-AMT           PIC S9(07)V9(02) VALUE ZERO.     03420000
034800     05  PV-LID-AMT              PIC  9(07)V9(02) VALUE ZERO.     03430000
034900     05  PV-ORIG-SL-ITM-LID-AMT  PIC S9(07)V9(02) VALUE ZERO.     03440000
035000     05  PV-NET-CHRGD-AMT-TMP    PIC  9(07)V9(02) VALUE ZERO.     03450000
BOSSCL     05  PV-OMNI-CHNL-FFLMT-TYP-CDE  PIC X(3)     VALUE SPACES.   03460000
032800                                                                  03470000
BOSSCL     05  PV-PRICE-CHG-STRT-DATE  PIC  X(10)       VALUE SPACES.   03480000
BOSSCL     05  PV-PRICE-CHG-END-DATE   PIC  X(10)       VALUE SPACES.   03490000
BOSSCL     05  PV-NEW-OMNI-PRICE       PIC S9(7)V9(2)   VALUE ZERO.     03500000
BOSSCL     05  PV-OLD-OMNI-PRICE       PIC S9(7)V9(2)   VALUE ZERO.     03501000
035100                                                                  03502000
BOSSCL     05  PV-OWND-UNT-RTL-ORIG-AMT PIC S9(7)V9(2)      VALUE ZERO. 03503000
035600     05  PV-PC-OLD-PR-AMT         PIC S9(7)V9(2)      VALUE ZERO. 03504000
035700     05  PV-PC-NEW-PR-AMT         PIC S9(7)V9(2)      VALUE ZERO. 03505000
035800     05  PV-PC-DIFFER-AMT         PIC S9(7)V9(2)      VALUE ZERO. 03506000
BOSSC2     05  PV-DISPLAY-AMT           PIC ---,--9.99      VALUE ZERO. 03507000
035900                                                                  03508000
036000     05  PV-ITM-CUST-CHRGD-AMT  PIC  9(7)V9(2)        VALUE ZERO. 03509000
036100     05  PV-ITM-REG-RTL-AMT     PIC  9(5)V9(2)        VALUE ZERO. 03510000
036200                                                                  03520000
036300     05  PV-ISO-DB2-DATE.                                         03530000
036400         10  PV-ISO-DB2-CC       PIC  X(02).                      03540000
036500         10  PV-ISO-DB2-YY       PIC  X(02).                      03550000
036600         10  FILLER              PIC  X(01).                      03560000
036700         10  PV-ISO-DB2-MM       PIC  X(02).                      03570000
036800         10  FILLER              PIC  X(01).                      03580000
036900         10  PV-ISO-DB2-DD       PIC  X(02).                      03590000
037000                                                                  03600000
037100     05  PV-CURRENT-TIME.                                         03610000
037200         10  PV-CURRENT-HOUR     PIC  9(02) VALUE ZERO.           03620000
037300         10  PV-CURRENT-MINUTE   PIC  9(02) VALUE ZERO.           03630000
037400         10  FILLER              PIC  9(04) VALUE ZERO.           03640000
037500                                                                  03650000
037600     05  PV-CURRENT-DATE.                                         03660000
037700         10  PV-CURRENT-YEAR     PIC  9(02) VALUE ZERO.           03670000
037800         10  PV-CURRENT-MONTH    PIC  9(02) VALUE ZERO.           03680000
037900         10  PV-CURRENT-DAY      PIC  9(02) VALUE ZERO.           03690000
038000                                                                  03700000
BOSSCL     05  PV-TIMESTAMP                     PIC X(26) VALUE SPACES. 03710000
BOSSCL     05  PV-TIMESTAMP-DB2.                                        03720000
BOSSCL         10  PV-TS-DATE.                                          03730000
BOSSCL             15  PV-TS-CENTURY            PIC  X(02) VALUE ZERO.  03740000
BOSSCL             15  PV-TS-YEAR               PIC  9(02) VALUE ZERO.  03750000
BOSSCL             15  FILLER                   PIC  X(01) VALUE '-'.   03760000
BOSSCL             15  PV-TS-MONTH              PIC  9(02) VALUE ZERO.  03770000
BOSSCL             15  FILLER                   PIC  X(01) VALUE '-'.   03780000
BOSSCL             15  PV-TS-DAY                PIC  9(02) VALUE ZERO.  03790000
BOSSCL         10  FILLER                       PIC  X(01) VALUE '-'.   03800000
BOSSCL         10  PV-TS-HOUR                   PIC  9(02) VALUE 02.    03800100
BOSSCL         10  FILLER                       PIC  X(01) VALUE '.'.   03800200
BOSSCL         10  PV-TS-MINUTE                 PIC  9(02) VALUE ZERO.  03800300
BOSSCL         10  FILLER                       PIC  X(01) VALUE '.'.   03800400
BOSSCL         10  PV-TS-SECONDS                PIC  9(02) VALUE ZERO.  03800500
BOSSCL         10  FILLER                       PIC  X(01) VALUE '.'.   03800600
BOSSCL         10  PV-TS-MILLISEC               PIC  9(06) VALUE ZERO.  03800700
038000                                                                  03800800
BOSSCL     05  PV-STR-NBR-DB2          PIC  S9(4) COMP  VALUE ZERO.     03800900
038400                                                                  03801000
038100     05  PV-RFMT-STR-NBR.                                         03801100
038200         10  FILLER              PIC  9 VALUE ZERO.               03801200
038300         10  PV-STR-NBR-4        PIC  9(04).                      03801300
038400                                                                  03801400
038600     05  PV-SKU-NBR              PIC  9(08) VALUE ZERO.           03801500
038700                                                                  03801600
038800     05  PV-SKU-NBR-RDFN         REDEFINES PV-SKU-NBR.            03801700
038900         10  FILLER              PIC  9(05).                      03801800
039000         10  PV-SKU-LST-3-DGT    PIC  9(03).                      03801900
ZX         05  PV-ORIG-REG-RTL-AMT     PIC S9(7)V9(2) USAGE COMP-3      03802000
ZX                                         VALUE ZERO.                  03803000
ZX         05  PV-ORIG-SAL-TYP-CDE     PIC  X(01) VALUE SPACES.         03804000
ZX         05  PV-SAL-TYP-CDE          PIC  X(01) VALUE SPACES.         03805000
ZX         05  PV-REG-RTL-AMT          PIC S9(7)V9(2) USAGE COMP-3      03806000
ZX                                         VALUE ZERO.                  03807000
ZX         05  PV-CUST-CHRGD-AMTS      PIC S9(7)V9(2) USAGE COMP-3      03808000
ZX                                         VALUE ZERO.                  03809000
ZX         05  PV-ORIG-OURA-AMTS       PIC S9(7)V9(2) USAGE COMP-3      03810000
ZX                                         VALUE ZERO.                  03820000
ZX         05  PV-OURA-AMTS            PIC S9(7)V9(2) USAGE COMP-3      03830000
ZX                                         VALUE ZERO.                  03840000
ZX         05  PV-NET-CHRGD-AMTS       PIC S9(7)V9(2) USAGE COMP-3      03850000
ZX                                         VALUE ZERO.                  03860000
ZX         05  PV-ITM-STAT-CDE         PIC  X(02) VALUE SPACES.         03870000
ZX         05  PV-DEPT-NBR             PIC  X(03) VALUE SPACES.         03880000
ZX                                                                      03890000
039100                                                                  03900000
039200     05  PV-DB2-KEY-FIELDS.                                       03901000
039300         10  PV-PARTN-NBR        PIC S9(04) COMP SYNC             03902000
039400                                            VALUE ZERO.           03903000
039500         10  PV-STR-NBR          PIC S9(04) COMP SYNC             03904000
039600                                            VALUE ZERO.           03905000
039700         10  PV-RGST-ID          PIC S9(04) COMP SYNC             03906000
039800                                            VALUE ZERO.           03907000
039900         10  PV-TRN-NBR          PIC S9(04) COMP SYNC             03908000
040000                                            VALUE ZERO.           03909000
040100         10  PV-STRT-TM          PIC  X(08) VALUE SPACE.          03910000
040200         10  PV-SLS-CORR-SEQ-NBR PIC S9(04) COMP SYNC             03920000
040300                                            VALUE ZERO.           03930000
040400         10  PV-LNE-ITM-SEQ-NBR  PIC S9(04) COMP SYNC             03940000
040500                                            VALUE ZERO.           03950000
ZX         05  CNTL-CARD.                                               03960000
ZX             10  FILLER                  PIC  X(05)                   03970000
ZX                                              VALUE 'PRT: '.          03980000
ZX             10  WS-CNTL-PRT             PIC  9(04)  VALUE ZEROS.     03990000
ZX             10  FILLER                  PIC  X(02)  VALUE SPACES.    04000000
ZX             10  FILLER                  PIC  X(05)                   04010000
ZX                                              VALUE 'STR: '.          04020000
ZX             10  WS-CNTL-STR             PIC  9(04)  VALUE ZEROS.     04030000
ZX             10  FILLER                  PIC  X(02)  VALUE SPACES.    04040000
ZX             10  FILLER                  PIC  X(05)                   04050000
ZX                                              VALUE 'REG: '.          04060000
ZX             10  WS-CNTL-REG             PIC  9(04)  VALUE ZEROS.     04070000
ZX             10  FILLER                  PIC  X(02)  VALUE SPACES.    04080000
ZX             10  FILLER                  PIC  X(05)                   04090000
ZX                                              VALUE 'TRN: '.          04100000
ZX             10  WS-CNTL-TRN             PIC  9(04)  VALUE ZEROS.     04110000
ZX             10  FILLER                  PIC  X(02)  VALUE SPACES.    04120000
ZX             10  FILLER                  PIC  X(05)                   04130000
ZX                                              VALUE 'SKU: '.          04140000
ZX             10  WS-CNTL-SKU             PIC  9(08)  VALUE ZEROS.     04150000
ZX             10  FILLER                  PIC  X(32)  VALUE SPACES.    04160000
ZX                                                                      04170000
ZX         05  WS-PRT                      PIC S9(4) COMP.              04180000
042000     05  WS-STR                      PIC S9(4) COMP.              04181000
ZX         05  WS-REG                      PIC S9(4) COMP.              04182000
042100     05  WS-TRN                      PIC S9(4) COMP.              04183000
042200     05  WS-SKU                      PIC S9(8)V COMP-3.           04184000
042400     05  WS-TRN-CNT                  PIC  9(04)  VALUE ZEROS.     04185000
042500                                                                  04186000
ZX     01  WS-DISPLAY-VARS.                                             04187000
ZX         05  WS-DISPLAY-NUM              PIC -(7)9.99.                04188000
042500                                                                  04189000
042600 01  DH-DISPLAY-HEADER.                                           04190000
042700     05  FILLER                  PIC  X(18) VALUE                 04200000
042800         'PRICE CHG TYPE'.                                        04210000
042900     05  FILLER                  PIC  X(15) VALUE                 04220000
043000         'MKDN QTY'.                                              04230000
043100     05  FILLER                  PIC  X(14) VALUE                 04240000
043200         'MKDN AMT'.                                              04241000
043300     05  FILLER                  PIC  X(15) VALUE                 04242000
043400         'MDC QTY'.                                               04243000
043500     05  FILLER                  PIC  X(10) VALUE                 04244000
043600         'MDC AMT'.                                               04245000
043700     05  FILLER                  PIC  X(13) VALUE                 04246000
043800         'MKUP QTY'.                                              04247000
043900     05  FILLER                  PIC  X(12) VALUE                 04248000
044000         'MKUP AMT'.                                              04249000
044100     05  FILLER                  PIC  X(13) VALUE                 04250000
044200         'MUC QTY'.                                               04260000
044300     05  FILLER                  PIC  X(08) VALUE                 04270000
044400         'MUC AMT'.                                               04280000
044500                                                                  04290000
044600 01  HL-HEADER-LINE1.                                             04300000
044700     05  FILLER                  PIC  X(39) VALUE SPACES.         04310000
044800     05                          PIC  X(55) VALUE                 04320000
044900        'MERCHANDISE LEDGER MARKDOWN/MARKUP TRANSACTION CREATION'.04330000
045000     05  FILLER                  PIC  X(38) VALUE SPACES.         04340000
045100                                                                  04350000
045200 01  HL-HEADER-LINE1-1.                                           04360000
ZX         05  FILLER                  PIC  X(19) VALUE SPACES.         04370000
ZX         05  HL-ORDERNO-TITLE        PIC  X(09) VALUE                 04380000
ZX             'ORDER_NO:'.                                             04390000
ZX         05  FILLER                  PIC  X(01) VALUE SPACES.         04400000
ZX         05  HL-ORDERNO              PIC  X(30) VALUE SPACES.         04410000
045400     05                          PIC  X(04) VALUE                 04420000
045500         'FOR '.                                                  04430000
045600     05  HL-REPORT-MONTH         PIC  X(02) VALUE SPACES.         04440000
045700     05  FILLER                  PIC  X(01) VALUE '/'.            04450000
045800     05  HL-REPORT-DAY           PIC  X(02) VALUE SPACES.         04460000
045900     05  FILLER                  PIC  X(01) VALUE '/'.            04470000
046000     05  HL-REPORT-YEAR          PIC  X(02) VALUE SPACES.         04480000
046100     05  FILLER                  PIC  X(01) VALUE SPACES.         04490000
046200     05  HL-CRITERIA             PIC  X(58) VALUE SPACES.         04500000
046300                                                                  04510000
046400 01  HL-HEADER-LINE2.                                             04520000
046500     05  FILLER                  PIC  X(04) VALUE SPACES.         04530000
046600     05  FILLER                  PIC  X(14) VALUE                 04540000
046700         'PRICE CHG TYPE'.                                        04550000
046800     05  FILLER                  PIC  X(02) VALUE SPACES.         04560000
046900     05  FILLER                  PIC  X(11) VALUE                 04570000
047000         'MKDN QTY'.                                              04580000
047100     05  FILLER                  PIC  X(02) VALUE SPACES.         04590000
047200     05  FILLER                  PIC  X(15) VALUE                 04600000
047300         'MKDN AMT'.                                              04610000
047400     05  FILLER                  PIC  X(02) VALUE SPACES.         04620000
047500     05  FILLER                  PIC  X(11) VALUE                 04630000
047600         'MDC QTY'.                                               04640000
047700     05  FILLER                  PIC  X(02) VALUE SPACES.         04650000
047800     05  FILLER                  PIC  X(15) VALUE                 04660000
047900         'MDC AMT'.                                               04670000
048000     05  FILLER                  PIC  X(02) VALUE SPACES.         04680000
048100     05  FILLER                  PIC  X(09) VALUE                 04690000
048200         'MKUP QTY'.                                              04700000
048300     05  FILLER                  PIC  X(02) VALUE SPACES.         04710000
048400     05  FILLER                  PIC  X(13) VALUE                 04720000
048500         'MKUP AMT'.                                              04730000
048600     05  FILLER                  PIC  X(02) VALUE SPACES.         04740000
048700     05  FILLER                  PIC  X(09) VALUE                 04750000
048800         'MUC QTY'.                                               04760000
048900     05  FILLER                  PIC  X(02) VALUE SPACES.         04770000
049000     05  FILLER                  PIC  X(13) VALUE                 04780000
049100         'MUC AMT'.                                               04790000
049200     05  FILLER                  PIC  X(04) VALUE SPACES.         04800000
049300                                                                  04810000
049400 01  HL-HEADER-LINE3.                                             04820000
049500     05  FILLER                  PIC  X(04) VALUE SPACES.         04830000
049600     05  FILLER                  PIC  X(14) VALUE ALL '-'.        04840000
049700     05  FILLER                  PIC  X(02) VALUE SPACES.         04850000
049800     05  FILLER                  PIC  X(11) VALUE ALL '-'.        04860000
049900     05  FILLER                  PIC  X(02) VALUE SPACES.         04870000
050000     05  FILLER                  PIC  X(15) VALUE ALL '-'.        04880000
050100     05  FILLER                  PIC  X(02) VALUE SPACES.         04890000
050200     05  FILLER                  PIC  X(11) VALUE ALL '-'.        04900000
050300     05  FILLER                  PIC  X(02) VALUE SPACES.         04910000
050400     05  FILLER                  PIC  X(15) VALUE ALL '-'.        04920000
050500     05  FILLER                  PIC  X(02) VALUE SPACES.         04930000
050600     05  FILLER                  PIC  X(09) VALUE ALL '-'.        04940000
050700     05  FILLER                  PIC  X(02) VALUE SPACES.         04950000
050800     05  FILLER                  PIC  X(13) VALUE ALL '-'.        04960000
050900     05  FILLER                  PIC  X(02) VALUE SPACES.         04970000
051000     05  FILLER                  PIC  X(09) VALUE ALL '-'.        04980000
051100     05  FILLER                  PIC  X(02) VALUE SPACES.         04990000
051200     05  FILLER                  PIC  X(13) VALUE ALL '-'.        05000000
051300     05  FILLER                  PIC  X(04) VALUE SPACES.         05010000
051400                                                                  05020000
051500 01  HL-HEADER-LINE4.                                             05030000
051600     05  FILLER                  PIC  X(53) VALUE SPACES.         05040000
051700     05  FILLER                  PIC  X(26) VALUE SPACES.         05050000
051800         88  HD-ORIGINAL-SALES              VALUE                 05060000
051900             '    ORIGINAL POS SALES    '.                        05070000
052000         88  HD-SALES-CORR                  VALUE                 05080000
052100             '    SALES CORRECTIONS     '.                        05090000
052200         88  HD-LATE-TRANSACTIONS           VALUE                 05100000
052300             '    LATE TRANSACTIONS     '.                        05110000
052400         88  HD-CUTOFF-SALES-CORR           VALUE                 05120000
052500             ' CUTOFF SALES CORRECTIONS '.                        05130000
052600         88  HD-CUTOFF-LATE-TRANSACTIONS    VALUE                 05140000
052700             ' CUTOFF LATE TRANSACTIONS '.                        05150000
052800     05  FILLER                  PIC  X(53) VALUE SPACES.         05160000
052900                                                                  05170000
053000 01  DD-DISPLAY-DETAIL.                                           05180000
053100     05  DD-PRICE-CHANGE-TYPE    PIC  X(14) VALUE SPACES.         05190000
053200         88  DD-PC-PROMOTIONAL              VALUE                 05200000
053300             'PROMOTIONAL   '.                                    05210000
053400         88  DD-PC-TIERED                   VALUE                 05220000
053500             'ADDTL PROMOTNS'.                                    05230000
053600         88  DD-PC-GOLDSTAR                 VALUE                 05240000
053700             'GOLDSTAR      '.                                    05250000
053800         88  DD-PC-MANUAL-LID               VALUE                 05260000
053900             'MANUAL LID    '.                                    05270000
054000         88  DD-PC-OWNERSHIP-ADJUSTMENT     VALUE                 05280000
054100             'OWNERSHIP ADJ '.                                    05290000
054200         88  DD-PC-OWN-RETRN-ADJUSTMENT     VALUE                 05300000
054300             'OWN.RETURN ADJ'.                                    05310000
054400         88  DD-PC-SENIOR-CITIZEN           VALUE                 05320000
054500             'SENIOR CITIZEN'.                                    05330000
054600         88  DD-PC-KOHLS-COUPON             VALUE                 05340000
054700             'KOHLS COUPON  '.                                    05350000
054800         88  DD-PC-OFFER-COUPON             VALUE                 05360000
054900             'OFFER COUPON  '.                                    05370000
055000         88  DD-PC-OFFER-TLD-TIERED         VALUE                 05380000
055100             'OFFER TLD TIER'.                                    05390000
055200         88  DD-PC-OFFER-LID-TIERED         VALUE                 05400000
055300             'OFFER LID TIER'.                                    05410000
055400         88  DD-PC-OFFER-GWP-PWP            VALUE                 05420000
055500             'OFFER GWP/PWP '.                                    05430000
054200         88  DD-PC-GFT-RCPT-RTRN            VALUE                 05440000
054300             'GIFT RCPT RTRN'.                                    05450000
205464         88  DD-NON-RCPT-RTRN               VALUE                 05460000
205464             'NON RCPT RTRN '.                                    05470000
055600         88  DD-PC-BOGO                     VALUE                 05480000
055700             'EBOGO         '.                                    05490000
056000         88  DD-PC-UNEARNED-REWARDS         VALUE                 05500000
056100             'UNEARNED RWDS '.                                    05510000
056200         88  DD-PC-EMPLY-DISCOUNT           VALUE                 05520000
056300             'EMPLY DISCOUNT'.                                    05530000
262807         88  DD-PC-SEPHORA-DISCOUNT         VALUE                 05531034
262807             'SEPHORA DISCNT'.                                    05532034
056400         88  DD-PC-TOTAL                    VALUE                 05540000
056500             'TOTAL         '.                                    05550000
056600                                                                  05560000
056700     05  FILLER                  PIC  X(01) VALUE SPACES.         05570000
056800     05  DD-MARKDOWN-QTY         PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      05580000
056900     05  FILLER                  PIC  X(01) VALUE SPACES.         05590000
057000     05  DD-MARKDOWN-AMT         PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05600000
057100     05  FILLER                  PIC  X(01) VALUE SPACES.         05610000
057200     05  DD-MARKDOWN-CANCEL-QTY  PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      05620000
057300     05  FILLER                  PIC  X(01) VALUE SPACES.         05630000
057400     05  DD-MARKDOWN-CANCEL-AMT  PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05640000
057500     05  FILLER                  PIC  X(01) VALUE SPACES.         05650000
057600     05  DD-MARKUP-QTY           PIC Z,ZZZ,ZZ9 VALUE ZERO.        05660000
057700     05  FILLER                  PIC  X(01) VALUE SPACES.         05670000
057800     05  DD-MARKUP-AMT           PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    05680000
057900     05  FILLER                  PIC  X(01) VALUE SPACES.         05690000
058000     05  DD-MARKUP-CANCEL-QTY    PIC Z,ZZZ,ZZ9 VALUE ZERO.        05700000
058100     05  FILLER                  PIC  X(01) VALUE SPACES.         05710000
058200     05  DD-MARKUP-CANCEL-AMT    PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    05720000
058300                                                                  05730000
058400 01  DL-DETAIL-LINE.                                              05740000
058500     05  FILLER                  PIC  X(04) VALUE SPACES.         05750000
058600     05  DL-PRICE-CHANGE-TYPE    PIC  X(14) VALUE SPACES.         05760000
058700     05  FILLER                  PIC  X(02) VALUE SPACES.         05770000
058800     05  DL-MARKDOWN-QTY         PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      05780000
058900     05  FILLER                  PIC  X(02) VALUE SPACES.         05790000
059000     05  DL-MARKDOWN-AMT         PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05800000
059100     05  FILLER                  PIC  X(02) VALUE SPACES.         05810000
059200     05  DL-MARKDOWN-CANCEL-QTY  PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      05820000
059300     05  FILLER                  PIC  X(02) VALUE SPACES.         05830000
059400     05  DL-MARKDOWN-CANCEL-AMT  PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05840000
059500     05  FILLER                  PIC  X(02) VALUE SPACES.         05850000
059600     05  DL-MARKUP-QTY           PIC Z,ZZZ,ZZ9 VALUE ZERO.        05860000
059700     05  FILLER                  PIC  X(02) VALUE SPACES.         05870000
059800     05  DL-MARKUP-AMT           PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    05880000
059900     05  FILLER                  PIC  X(02) VALUE SPACES.         05890000
060000     05  DL-MARKUP-CANCEL-QTY    PIC Z,ZZZ,ZZ9 VALUE ZERO.        05900000
060100     05  FILLER                  PIC  X(02) VALUE SPACES.         05910000
060200     05  DL-MARKUP-CANCEL-AMT    PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    05920000
060300     05  FILLER                  PIC  X(04) VALUE SPACES.         05930000
060400                                                                  05940000
060500 01  PT-PROGRAM-TOTALS.                                           05950000
060600     05  PT-PROGRAM-TOTAL-ELEMENT    OCCURS 5 TIMES.              05960000
060700         10  PT-PROMOTIONAL-MKDN-QTY PIC S9(09) VALUE ZERO        05970000
060800                                                COMP-3.           05980000
060900         10  PT-PROMOTIONAL-MKDN-AMT PIC S9(9)V99 VALUE ZERO      05990000
061000                                                COMP-3.           06000000
061100         10  PT-PROMOTIONAL-MDC-QTY  PIC S9(09) VALUE ZERO        06010000
061200                                                COMP-3.           06020000
061300         10  PT-PROMOTIONAL-MDC-AMT  PIC S9(9)V99 VALUE ZERO      06030000
061400                                                COMP-3.           06040000
061500         10  PT-TIERED-MKDN-QTY      PIC S9(07) VALUE ZERO        06050000
061600                                                COMP-3.           06060000
061700         10  PT-TIERED-MKDN-AMT      PIC S9(9)V99 VALUE ZERO      06070000
061800                                                COMP-3.           06080000
061900         10  PT-TIERED-MDC-QTY       PIC S9(09) VALUE ZERO        06090000
062000                                                COMP-3.           06100000
062100         10  PT-TIERED-MDC-AMT       PIC S9(9)V99 VALUE ZERO      06110000
062200                                                COMP-3.           06120000
062300         10  PT-GOLDSTAR-MKDN-QTY    PIC S9(09) VALUE ZERO        06130000
062400                                                COMP-3.           06140000
062500         10  PT-GOLDSTAR-MKDN-AMT    PIC S9(9)V99 VALUE ZERO      06150000
062600                                                COMP-3.           06160000
062700         10  PT-GOLDSTAR-MDC-QTY     PIC S9(09) VALUE ZERO        06170000
062800                                                COMP-3.           06180000
062900         10  PT-GOLDSTAR-MDC-AMT     PIC S9(9)V99 VALUE ZERO      06190000
063000                                                COMP-3.           06200000
063100         10  PT-MANUAL-LID-MKDN-QTY  PIC S9(09) VALUE ZERO        06210000
063200                                                COMP-3.           06220000
063300         10  PT-MANUAL-LID-MKDN-AMT  PIC S9(9)V99 VALUE ZERO      06230000
063400                                                COMP-3.           06240000
063500         10  PT-MANUAL-LID-MDC-QTY   PIC S9(09) VALUE ZERO        06250000
063600                                                COMP-3.           06260000
063700         10  PT-MANUAL-LID-MDC-AMT   PIC S9(9)V99 VALUE ZERO      06270000
063800                                                COMP-3.           06280000
063900         10  PT-OWNERSHIP-ADJ-MKDN-QTY                            06290000
064000                                     PIC S9(09) VALUE ZERO        06300000
064100                                                COMP-3.           06310000
064200         10  PT-OWNERSHIP-ADJ-MKDN-AMT                            06320000
064300                                     PIC S9(9)V99 VALUE ZERO      06330000
064400                                                COMP-3.           06340000
064500         10  PT-OWNERSHIP-ADJ-MDC-QTY                             06350000
064600                                     PIC S9(09) VALUE ZERO        06360000
064700                                                COMP-3.           06370000
064800         10  PT-OWNERSHIP-ADJ-MDC-AMT                             06380000
064900                                     PIC S9(9)V99 VALUE ZERO      06390000
065000                                                COMP-3.           06400000
065100         10  PT-OWNERSHIP-ADJ-MKUP-QTY                            06410000
065200                                     PIC S9(07) VALUE ZERO        06420000
065300                                                COMP-3.           06430000
065400         10  PT-OWNERSHIP-ADJ-MKUP-AMT                            06440000
065500                                     PIC S9(7)V99 VALUE ZERO      06450000
065600                                                COMP-3.           06460000
065700         10  PT-OWNERSHIP-ADJ-MUC-QTY                             06470000
065800                                     PIC S9(07) VALUE ZERO        06480000
065900                                                COMP-3.           06490000
066000         10  PT-OWNERSHIP-ADJ-MUC-AMT                             06500000
066100                                     PIC S9(7)V99 VALUE ZERO      06510000
066200                                                COMP-3.           06520000
066300         10  PT-OWN-RETRN-ADJ-MKDN-QTY                            06530000
066400                                     PIC S9(09) VALUE ZERO        06540000
066500                                                COMP-3.           06550000
066600         10  PT-OWN-RETRN-ADJ-MKDN-AMT                            06560000
066700                                     PIC S9(9)V99 VALUE ZERO      06570000
066800                                                COMP-3.           06580000
066900         10  PT-OWN-RETRN-ADJ-MDC-QTY                             06590000
067000                                     PIC S9(09) VALUE ZERO        06600000
067100                                                COMP-3.           06610000
067200         10  PT-OWN-RETRN-ADJ-MDC-AMT                             06620000
067300                                     PIC S9(09)V99 VALUE ZERO     06630000
067400                                                COMP-3.           06640000
067500         10  PT-OWN-RETRN-ADJ-MKUP-QTY                            06650000
067600                                     PIC S9(07) VALUE ZERO        06660000
067700                                                COMP-3.           06670000
067800         10  PT-OWN-RETRN-ADJ-MKUP-AMT                            06680000
067900                                     PIC S9(7)V99 VALUE ZERO      06690000
068000                                                COMP-3.           06700000
068100         10  PT-OWN-RETRN-ADJ-MUC-QTY                             06710000
068200                                     PIC S9(07) VALUE ZERO        06720000
068300                                                COMP-3.           06730000
068400         10  PT-OWN-RETRN-ADJ-MUC-AMT                             06740000
068500                                     PIC S9(7)V99 VALUE ZERO      06750000
068600                                                COMP-3.           06760000
068700         10  PT-SENIOR-CITIZEN-MKDN-QTY                           06770000
068800                                     PIC S9(09) VALUE ZERO        06780000
068900                                                COMP-3.           06790000
069000         10  PT-SENIOR-CITIZEN-MKDN-AMT                           06800000
069100                                     PIC S9(9)V99 VALUE ZERO      06810000
069200                                                  COMP-3.         06820000
069300         10  PT-SENIOR-CITIZEN-MDC-QTY                            06830000
069400                                     PIC S9(9)    VALUE ZERO      06840000
069500                                                  COMP-3.         06850000
069600         10  PT-SENIOR-CITIZEN-MDC-AMT                            06860000
069700                                     PIC S9(9)V99 VALUE ZERO      06870000
069800                                                  COMP-3.         06880000
069900         10  PT-KOHLS-COUPON-MKDN-QTY                             06890000
070000                                     PIC S9(9)    VALUE ZERO      06900000
070100                                                  COMP-3.         06910000
070200         10  PT-KOHLS-COUPON-MKDN-AMT                             06920000
070300                                     PIC S9(9)V99 VALUE ZERO      06930000
070400                                                  COMP-3.         06940000
070500         10  PT-KOHLS-COUPON-MDC-QTY PIC S9(9)    VALUE ZERO      06950000
070600                                                  COMP-3.         06960000
070700         10  PT-KOHLS-COUPON-MDC-AMT PIC S9(9)V99 VALUE ZERO      06970000
069400                                                  COMP-3.         06980000
205464         10  PT-710-NORCPT-MKDN-QTY  PIC S9(9)    VALUE ZERO      06990000
205464                                                  COMP-3.         07000000
205464         10  PT-710-NORCPT-MKDN-AMT  PIC S9(9)V99 VALUE ZERO      07010000
205464                                                  COMP-3.         07020000
205464         10  PT-710-NORCPT-MDC-QTY   PIC S9(9)    VALUE ZERO      07030000
205464                                                  COMP-3.         07040000
205464         10  PT-710-NORCPT-MDC-AMT   PIC S9(9)V99 VALUE ZERO      07050000
205464                                                  COMP-3.         07060000
262807         10  PT-720-SEPHORA-MKDN-QTY                              07061034
262807                                     PIC S9(9)    VALUE ZERO      07062034
262807                                                  COMP-3.         07063034
262807         10  PT-720-SEPHORA-MKDN-AMT                              07064034
262807                                     PIC S9(9)V99 VALUE ZERO      07065034
262807                                                  COMP-3.         07066034
262807         10  PT-720-SEPHORA-MDC-QTY    PIC S9(9)    VALUE ZERO    07067034
262807                                                  COMP-3.         07068034
262807         10  PT-720-SEPHORA-MDC-AMT    PIC S9(9)V99 VALUE ZERO    07069034
262807                                                  COMP-3.         07069134
070900         10  PT-760-OFFER-MKDN-QTY                                07070000
071000                                     PIC S9(9)    VALUE ZERO      07071000
071100                                                  COMP-3.         07072000
071200         10  PT-760-OFFER-MKDN-AMT                                07073000
071300                                     PIC S9(9)V99 VALUE ZERO      07074000
071400                                                  COMP-3.         07075000
071500         10  PT-760-OFFER-MDC-QTY    PIC S9(9)    VALUE ZERO      07076000
071600                                                  COMP-3.         07077000
071700         10  PT-760-OFFER-MDC-AMT    PIC S9(9)V99 VALUE ZERO      07078000
071800                                                  COMP-3.         07079000
071900         10  PT-761-TLDTIER-MKDN-QTY                              07080000
072000                                     PIC S9(9)    VALUE ZERO      07090000
072100                                                  COMP-3.         07100000
072200         10  PT-761-TLDTIER-MKDN-AMT                              07110000
072300                                     PIC S9(9)V99 VALUE ZERO      07120000
072400                                                  COMP-3.         07130000
072500         10  PT-761-TLDTIER-MDC-QTY  PIC S9(9)    VALUE ZERO      07140000
072600                                                  COMP-3.         07150000
072700         10  PT-761-TLDTIER-MDC-AMT  PIC S9(9)V99 VALUE ZERO      07160000
072800                                                  COMP-3.         07170000
072900         10  PT-762-LIDTIER-MKDN-QTY                              07180000
073000                                     PIC S9(9)    VALUE ZERO      07190000
073100                                                  COMP-3.         07200000
073200         10  PT-762-LIDTIER-MKDN-AMT                              07210000
073300                                     PIC S9(9)V99 VALUE ZERO      07220000
073400                                                  COMP-3.         07230000
073500         10  PT-762-LIDTIER-MDC-QTY  PIC S9(9)    VALUE ZERO      07240000
073600                                                  COMP-3.         07250000
073700         10  PT-762-LIDTIER-MDC-AMT  PIC S9(9)V99 VALUE ZERO      07260000
073800                                                  COMP-3.         07270000
073900         10  PT-763-GWPPWP-MKDN-QTY                               07280000
074000                                     PIC S9(9)    VALUE ZERO      07290000
074100                                                  COMP-3.         07300000
074200         10  PT-763-GWPPWP-MKDN-AMT                               07310000
074300                                     PIC S9(9)V99 VALUE ZERO      07320000
074400                                                  COMP-3.         07330000
074500         10  PT-763-GWPPWP-MDC-QTY   PIC S9(9)    VALUE ZERO      07340000
074600                                                  COMP-3.         07350000
074700         10  PT-763-GWPPWP-MDC-AMT   PIC S9(9)V99 VALUE ZERO      07360000
074800                                                  COMP-3.         07370000
074900         10  PT-765-GIFT-MKDN-QTY    PIC S9(9)    VALUE ZERO      07380000
075000                                                  COMP-3.         07390000
075100         10  PT-765-GIFT-MKDN-AMT    PIC S9(9)V99 VALUE ZERO      07400000
075200                                                  COMP-3.         07410000
075300         10  PT-765-GIFT-MDC-QTY     PIC S9(9)    VALUE ZERO      07420000
075400                                                  COMP-3.         07430000
075500         10  PT-765-GIFT-MDC-AMT     PIC S9(9)V99 VALUE ZERO      07440000
075600                                                  COMP-3.         07450000
075700         10  PT-BOGO-MKDN-QTY        PIC S9(9)    VALUE ZERO      07460000
075800                                                  COMP-3.         07470000
075900         10  PT-BOGO-MKDN-AMT        PIC S9(9)V99 VALUE ZERO      07480000
076000                                                  COMP-3.         07490000
076100         10  PT-BOGO-MDC-QTY         PIC S9(9)    VALUE ZERO      07500000
076200                                                  COMP-3.         07510000
076300         10  PT-BOGO-MDC-AMT         PIC S9(9)V99 VALUE ZERO      07520000
076400                                                  COMP-3.         07530000
076500                                                                  07540000
076600         10  PT-UNEARNED-RWDS-MKDN-QTY                            07550000
076700                                     PIC S9(9)    VALUE ZERO      07560000
076800                                                  COMP-3.         07570000
076900         10  PT-UNEARNED-RWDS-MKDN-AMT                            07580000
077000                                     PIC S9(9)V99 VALUE ZERO      07590000
077100                                                  COMP-3.         07600000
077200         10  PT-UNEARNED-RWDS-MDC-QTY                             07610000
077300                                     PIC S9(9)    VALUE ZERO      07620000
077400                                                  COMP-3.         07630000
077500         10  PT-UNEARNED-RWDS-MDC-AMT                             07640000
077600                                     PIC S9(9)V99 VALUE ZERO      07650000
077700                                                  COMP-3.         07660000
077800                                                                  07670000
077900         10  PT-EMPLY-DISC-MKDN-QTY  PIC S9(9)    VALUE ZERO      07680000
078000                                                  COMP-3.         07690000
078100         10  PT-EMPLY-DISC-MKDN-AMT  PIC S9(9)V99 VALUE ZERO      07700000
078200                                                  COMP-3.         07710000
078300         10  PT-EMPLY-DISC-MDC-QTY   PIC S9(9)    VALUE ZERO      07720000
078400                                                  COMP-3.         07730000
078500         10  PT-EMPLY-DISC-MDC-AMT   PIC S9(9)V99 VALUE ZERO      07740000
078600                                                  COMP-3.         07750000
078700                                                                  07760000
078800         10  PT-TOTAL-MARKDOWN-QTY   PIC S9(9)    VALUE ZERO      07770000
078900                                                  COMP-3.         07780000
079000         10  PT-TOTAL-MARKDOWN-AMT   PIC S9(9)V99 VALUE ZERO      07790000
079100                                                  COMP-3.         07800000
079200         10  PT-TOTAL-MARKDOWN-CANCEL-QTY                         07810000
079300                                     PIC S9(9)    VALUE ZERO      07820000
079400                                                  COMP-3.         07830000
079500         10  PT-TOTAL-MARKDOWN-CANCEL-AMT                         07840000
079600                                     PIC S9(9)V99 VALUE ZERO      07850000
079700                                                  COMP-3.         07860000
079800         10  PT-TOTAL-MARKUP-QTY     PIC S9(7)    VALUE ZERO      07870000
079900                                                  COMP-3.         07880000
080000         10  PT-TOTAL-MARKUP-AMT     PIC S9(7)V99 VALUE ZERO      07890000
080100                                                  COMP-3.         07900000
080200         10  PT-TOTAL-MARKUP-CANCEL-QTY                           07910000
080300                                     PIC S9(7)    VALUE ZERO      07920000
080400                                                  COMP-3.         07930000
080500         10  PT-TOTAL-MARKUP-CANCEL-AMT                           07940000
080600                                     PIC S9(7)V99 VALUE ZERO      07950000
080700                                                  COMP-3.         07960000
080800         10  PT-NON-OWNED-DROPPED    PIC S9(11)   VALUE ZEROS     07970000
080900                                                  COMP-3.         07980000
081000                                                                  07990000
081100******************************************************************08000000
081200* RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                    08010000
081300******************************************************************08020000
081400 01  CC-CONTROL-CARD.                                             08030000
081500     05  CC-CONTROL-CARD-DISPLAY.                                 08040000
081600         10  CC-CONTROL-NAME     PIC  X(14) VALUE SPACE.          08050000
081700         10  CC-POS-DATE-MMDDYY  PIC  9(06) VALUE ZERO.           08060000
081800         10  FILLER REDEFINES CC-POS-DATE-MMDDYY.                 08070000
081900             15  CC-POS-DATE-MM  PIC  99.                         08080000
082000             15  CC-POS-DATE-DD  PIC  99.                         08090000
082100             15  CC-POS-DATE-YY  PIC  99.                         08100000
082200     05 FILLER                   PIC  X(60) VALUE SPACE.          08110000
082300                                                                  08120000
082400 01  TD-TOTAL-DISPLAY-MESSAGE.                                    08130000
082500     05  FILLER                  PIC  X(04) VALUE SPACE.          08140000
082600     05  TD-TOTAL-ID             PIC  X(51) VALUE SPACE.          08150000
082700         88  TD-NON-OWNED-DROPPED-ID        VALUE                 08160000
082800             'NON OWNED MDSE MARKDOWNS DROPPED . . . . . . . . '. 08170000
082900     05  TD-TOTAL-AMOUNT         PIC ZZ,ZZZ,ZZZ,ZZ9 VALUE ZEROS.  08180000
083000     05  FILLER                  PIC  X(67) VALUE SPACES.         08190000
083100                                                                  08200000
083200 77  WS-CMT-CNT                  PIC 9(4)   VALUE ZEROS.          08210000
083300                                                                  08220000
083400******************************************************************08230000
083500*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            08240000
083600******************************************************************08250000
083700                                                                  08260000
083800     COPY DPWS004.                                                08270000
083900                                                                  08280000
084000******************************************************************08290000
084100*  DB2 COMMUNICATION AREA.                                        08300000
084200******************************************************************08310000
084300                                                                  08320000
084400     EXEC SQL                                                     08330000
084500          INCLUDE SQLCA                                           08340000
084600     END-EXEC.                                                    08350000
084700                                                                  08360000
084800******************************************************************08370000
084900*  DB2 TABLE DB2PDBA.TEPPART - PARTITION CONTROL TABLE            08380000
085000******************************************************************08390000
085100                                                                  08400000
085200     EXEC SQL                                                     08410000
085300          INCLUDE TEPPART                                         08420000
085400     END-EXEC.                                                    08430000
085500                                                                  08440000
085600******************************************************************08450000
085700*  DB2 TABLE DB2PDBA.TEPDKEY - CURRENT PROCESSING DAY KEY TABLE   08460000
085800******************************************************************08470000
085900                                                                  08480000
086000     EXEC SQL                                                     08490000
086100          INCLUDE TEPDKEY                                         08500000
086200     END-EXEC.                                                    08510000
086300                                                                  08520000
086400******************************************************************08530000
086500*  DB2 TABLE DB2PDBA.TEPTRN - TRANSACTION TABLE                   08540000
086600******************************************************************08550000
086700                                                                  08560000
086800     EXEC SQL                                                     08570000
086900          INCLUDE TEPTRN                                          08580000
087000     END-EXEC.                                                    08590000
087100                                                                  08600000
087200******************************************************************08610000
087300*  DB2 TABLE DB2PDBA.TEPITM - ITEM TABLE                          08620000
087400******************************************************************08630000
087500                                                                  08640000
087600     EXEC SQL                                                     08650000
087700          INCLUDE TEPITM                                          08660000
087800     END-EXEC.                                                    08670000
087900                                                                  08680000
ZX    ******************************************************************08690000
ZX    *  DB2 TABLE DB2PDBA.TEPORD - ORDER NUMBER TABLE                  08700000
ZX    ******************************************************************08710000
ZX                                                                      08720000
ZX         EXEC SQL                                                     08730000
ZX              INCLUDE TEPORD                                          08740000
ZX         END-EXEC.                                                    08750000
ZX                                                                      08760000
088000******************************************************************08770000
088100*  DB2 TABLE DB2PDBA.TEPIGP - ITEM GROUP PRICING TABLE            08780000
088200******************************************************************08790000
088300                                                                  08791000
088400     EXEC SQL                                                     08792000
088500          INCLUDE TEPIGP                                          08793000
088600     END-EXEC.                                                    08794000
088700                                                                  08795000
088800******************************************************************08796000
088900*  DB2 TABLE DB2PDBA.TEPLID - LINE ITEM DISCOUNT TABLE            08797000
089000******************************************************************08798000
089100                                                                  08799000
089200     EXEC SQL                                                     08800000
089300          INCLUDE TEPLID                                          08810000
089400     END-EXEC.                                                    08820000
089500                                                                  08830000
089600******************************************************************08840000
089700*  DB2 TABLE DB2PDBA.TEPIRT - ITEM RETURN INFORMATION TABLE.      08850000
089800******************************************************************08860000
089900                                                                  08870000
090000     EXEC SQL                                                     08880000
090100          INCLUDE TEPIRT                                          08890000
090200     END-EXEC.                                                    08900000
090300                                                                  08910000
090400******************************************************************08920000
090500*  DB2 TABLE DB2PDBA.TEPEID - EMPLOYEE ITEM DISCOUNT TABLE.       08930000
090600******************************************************************08940000
090700                                                                  08950000
090800     EXEC SQL                                                     08960000
090900          INCLUDE TEPEID                                          08970000
091000     END-EXEC.                                                    08980000
091100                                                                  08990000
001200                                                                  09000000
BOSSCL******************************************************************09010000
BOSSCL*  DB2 TABLE TSKXREF - SKU XREF                                   09020000
BOSSCL******************************************************************09030000
BOSSCL                                                                  09040000
BOSSCL     EXEC SQL                                                     09050000
BOSSCL          INCLUDE TSKXREF                                         09060000
BOSSCL     END-EXEC.                                                    09070000
BOSSCL                                                                  09080000
BOSSCL                                                                  09090000
BOSSCL******************************************************************09100000
BOSSCL*  DB2 TABLE TPPCPRC - PERM PRICING HISTORY                       09110000
BOSSCL******************************************************************09111000
BOSSCL                                                                  09112000
BOSSCL     EXEC SQL                                                     09113000
BOSSCL          INCLUDE TPPCPRC                                         09114000
BOSSCL     END-EXEC.                                                    09115000
BOSSCL                                                                  09116000
BOSSCL                                                                  09117000
BOSSC3******************************************************************09117102
BOSSC3*  DB2 TABLE SAT_BOSS_TRANSFERS TABLE                             09117202
BOSSC3******************************************************************09117302
BOSSC3                                                                  09117402
BOSSC3     EXEC SQL                                                     09117502
BOSSC3          INCLUDE SAT00016                                        09117602
BOSSC3     END-EXEC.                                                    09119302
BOSSC3                                                                  09119402
BOSSC3                                                                  09119502
091200******************************************************************09119602
091300*  TEPTRN-CURSOR --> VALID CURRENT DAY TRANSACTIONS.              09119700
091400******************************************************************09120000
091500                                                                  09120100
091600     EXEC SQL                                                     09120200
ZX            DECLARE TEPTRN-CURSOR CURSOR FOR                          09120300
091800         SELECT A.PARTN_NBR                                       09120400
091900               ,A.STR_NBR                                         09120500
092000               ,A.RGST_ID                                         09120600
092100               ,A.TRN_NBR                                         09120700
092200               ,A.STRT_TM                                         09120800
092300               ,A.SLS_CORR_SEQ_NBR                                09120900
092400               ,A.TRN_STAT_CDE                                    09121000
092500               ,A.SLS_DTE                                         09122000
ZX                   ,A.TRN_DTE                                         09123000
092600               ,A.POS_CPBL_LVL_NBR                                09124000
092700               ,A.CRE_TMST                                        09125000
BOSSCL               ,A.OMNI_CHNL_FFLMT_TYP_CDE                         09126000
BOSSC2               ,A.SLS_DTE - 2 DAYS                                09127001
092900                                                                  09128000
093000           FROM TEPTRN A                                          09129000
093200                                                                  09130000
093300          WHERE                                                   09140000
ZX                    A.PARTN_NBR        = :WS-PRT                      09150000
094000            AND A.STR_NBR          = :WS-STR                      09160000
ZX                AND A.RGST_ID          = :WS-REG                      09161000
094100            AND A.TRN_NBR          = :WS-TRN                      09162000
093500            AND A.VOID_ABRT_CDE    = 'N'                          09163000
ZX                AND A.TRN_STAT_CDE     IN ('V','R','L','Z')           09164000
094700            AND A.TRN_TYP_CDE     IN                              09165000
094800                ('01', '02', '11', '12', '22', '23', '24', '25')  09166000
094900*           AND A.SLS_CORR_SEQ_NBR = 0                            09167000
095000                                                                  09168000
095100       ORDER BY A.STR_NBR                                         09169000
095200               ,A.RGST_ID                                         09170000
095300               ,A.TRN_NBR                                         09170100
095400               ,A.STRT_TM                                         09170200
095500               ,A.SLS_CORR_SEQ_NBR                                09170300
095600                WITH UR                                           09170400
095700     END-EXEC.                                                    09170500
095800                                                                  09170600
095900******************************************************************09170700
096000*  TEPDKEY CURSOR --> VALID LATE, CORRECTION TRANSACTIONS.        09170800
096100******************************************************************09170900
096200     EXEC SQL                                                     09171000
092800        DECLARE TEPDKEY-CURSOR CURSOR WITH HOLD FOR               09171100
096400         SELECT B.PARTN_NBR                                       09171200
096500               ,B.STR_NBR                                         09171300
096600               ,B.RGST_ID                                         09171400
096700               ,B.TRN_NBR                                         09171500
096800               ,B.STRT_TM                                         09171600
096900               ,B.SLS_CORR_SEQ_NBR                                09171700
097000               ,B.TRN_STAT_CDE                                    09171800
097100               ,B.SLS_DTE                                         09171900
BOSSCL               ,B.TRN_DTE                                         09172000
097200               ,B.POS_CPBL_LVL_NBR                                09173000
097300               ,B.CRE_TMST                                        09174000
BOSSCL               ,B.OMNI_CHNL_FFLMT_TYP_CDE                         09175000
BOSSC2               ,B.SLS_DTE - 2 DAYS                                09176001
097400                                                                  09177000
097500           FROM TEPDKEY A                                         09178000
097600               ,TEPTRN B                                          09179000
097700               ,TEPPART C                                         09180000
097800                                                                  09190000
097900          WHERE A.PRCG_DTE         = :PV-RUN-DATE-CCYY-MM-DD      09200000
098000            AND A.SLS_DTE          = C.SLS_DTE                    09210000
098100            AND B.PARTN_NBR        = C.PARTN_NBR                  09220000
098200                                                                  09230000
098300* NOTE: FOR TESTING                                               09240000
ZX    *           AND A.PARTN_NBR        = :WS-PRT                      09250000
098400            AND A.STR_NBR          = :WS-STR                      09260000
ZX                AND A.RGST_ID          = :WS-REG                      09270000
098500            AND A.TRN_NBR          = :WS-TRN                      09280000
098600                                                                  09290000
098700            AND A.STR_NBR          = B.STR_NBR                    09300000
098800            AND A.RGST_ID          = B.RGST_ID                    09310000
098900            AND A.TRN_NBR          = B.TRN_NBR                    09320000
099000            AND A.STRT_TM          = B.STRT_TM                    09330000
099100            AND A.SLS_CORR_SEQ_NBR = B.SLS_CORR_SEQ_NBR           09340000
099200            AND B.VOID_ABRT_CDE    = 'N'                          09350000
099300            AND B.TRN_STAT_CDE    IN ('V','R','L')                09360000
099400            AND C.STR_GP_CDE       = 'A'                          09370000
099500            AND C.DB_STRUC_CDE     = 'O'                          09380000
099600            AND B.TRN_TYP_CDE     IN                              09390000
099700                ('01', '02', '11', '12', '22', '23', '24', '25')  09400000
099800                                                                  09410000
099900       ORDER BY B.PARTN_NBR                                       09420000
100000               ,B.STR_NBR                                         09430000
100100               ,B.RGST_ID                                         09440000
100200               ,B.TRN_NBR                                         09450000
100300               ,B.STRT_TM                                         09460000
100400               ,B.SLS_CORR_SEQ_NBR                                09470000
100500                WITH UR                                           09480000
100600     END-EXEC.                                                    09490000
100700                                                                  09500000
100800******************************************************************09510000
100900* ITEM CURSOR                                                     09520000
101000******************************************************************09530000
101100     EXEC SQL                                                     09540000
101200        DECLARE TEPITM-CURSOR CURSOR FOR                          09550000
101300         SELECT LNE_ITM_SEQ_NBR                                   09560000
101400               ,LIV_RSLU_CDE                                      09570000
101500               ,DEPT_NBR                                          09580000
101600               ,SUB_CL_NBR                                        09590000
101700               ,SLD_QTY                                           09600000
101800               ,NET_CHRGD_AMT                                     09610000
101900               ,SAL_TYP_CDE                                       09620000
102000               ,SAL_RET_CDE                                       09630000
102100               ,DEPT_CL_ERR_CDE                                   09640000
102200               ,SKU_ERR_CDE                                       09650000
102300               ,PRIC_SRC_CDE                                      09660000
102400               ,CUST_CHRGD_AMT                                    09670000
102500               ,REG_RTL_AMT                                       09680000
102600               ,ADITEM_NBR                                        09690000
102700               ,UNT_COST_AMT                                      09700000
102800               ,OWND_UNT_RTL_AMT                                  09710000
102900               ,OWNSHP_CDE                                        09720000
103000               ,REG_RTL_ORGN_CDE                                  09730000
103100               ,SKU_NBR                                           09740000
103200               ,MAJ_CL_NBR                                        09750000
103300               ,PROMO_INTFC_ID                                    09760000
ZX                   ,PROMO_SCHM_CDE                                    09770000
103400               ,OWND_UNT_RTL_ORIG_AMT                             09780000
103500               ,ITM_STAT_CDE                                      09790000
214615               ,ORIG_SAL_TYP_CDE                                  09800000
214615               ,ORIG_REG_RTL_AMT                                  09810000
103600                                                                  09820000
103700           FROM TEPITM                                            09830000
103800                                                                  09840000
103900          WHERE PARTN_NBR        = :PV-PARTN-NBR                  09850000
104000            AND STR_NBR          = :PV-STR-NBR                    09860000
104100            AND RGST_ID          = :PV-RGST-ID                    09870000
104200            AND TRN_NBR          = :PV-TRN-NBR                    09880000
104300            AND STRT_TM          = :PV-STRT-TM                    09890000
104400            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           09900000
104500            AND LIV_RSLU_CDE    IN ('+', '-')                     09910000
104600                                                                  09920000
104700       ORDER BY LNE_ITM_SEQ_NBR                                   09930000
104800                WITH UR                                           09940000
104900                OPTIMIZE FOR 5 ROWS                               09950000
105000     END-EXEC.                                                    09960000
105100                                                                  09970000
105200******************************************************************09980000
105300* ITEM CURSORX                                                    09990000
105400******************************************************************10000000
105500     EXEC SQL                                                     10010000
105600        DECLARE TEPITM-CURSORX CURSOR FOR                         10020000
105700         SELECT LNE_ITM_SEQ_NBR                                   10030000
105800               ,LIV_RSLU_CDE                                      10040000
105900               ,DEPT_NBR                                          10050000
106000               ,SUB_CL_NBR                                        10060000
106100               ,SLD_QTY                                           10070000
106200               ,NET_CHRGD_AMT                                     10080000
106300               ,SAL_TYP_CDE                                       10090000
106400               ,SAL_RET_CDE                                       10100000
106500               ,DEPT_CL_ERR_CDE                                   10110000
106600               ,SKU_ERR_CDE                                       10120000
106700               ,PRIC_SRC_CDE                                      10130000
106800               ,CUST_CHRGD_AMT                                    10140000
106900               ,REG_RTL_AMT                                       10150000
107000               ,ADITEM_NBR                                        10160000
107100               ,UNT_COST_AMT                                      10170000
107200               ,OWND_UNT_RTL_AMT                                  10180000
107300               ,OWNSHP_CDE                                        10190000
107400               ,REG_RTL_ORGN_CDE                                  10200000
107500               ,SKU_NBR                                           10210000
107600               ,MAJ_CL_NBR                                        10220000
107700               ,PROMO_INTFC_ID                                    10230000
ZX                   ,PROMO_SCHM_CDE                                    10240000
107800               ,OWND_UNT_RTL_ORIG_AMT                             10250000
107900               ,ITM_STAT_CDE                                      10260000
214615               ,ORIG_SAL_TYP_CDE                                  10270000
214615               ,ORIG_REG_RTL_AMT                                  10280000
108000                                                                  10290000
108100           FROM TEPITM                                            10300000
108200                                                                  10310000
108300          WHERE PARTN_NBR        = :PV-PARTN-NBR                  10320000
108400            AND STR_NBR          = :PV-STR-NBR                    10330000
108500            AND RGST_ID          = :PV-RGST-ID                    10340000
108600            AND TRN_NBR          = :PV-TRN-NBR                    10350000
108700            AND STRT_TM          = :PV-STRT-TM                    10360000
108800            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           10370000
108900            AND LIV_RSLU_CDE    IN ('+', '-')                     10380000
109000                                                                  10390000
109100            AND SKU_NBR = :WS-SKU                                 10400000
109200                                                                  10410000
109300       ORDER BY LNE_ITM_SEQ_NBR                                   10420000
109400                WITH UR                                           10430000
109500                OPTIMIZE FOR 5 ROWS                               10440000
109600     END-EXEC.                                                    10450000
109700                                                                  10460000
109800******************************************************************10470000
109900* LINE ITEM DISCOUNT CURSOR                                       10480000
110000******************************************************************10490000
110100     EXEC SQL                                                     10500000
110200        DECLARE TEPLID-CURSOR CURSOR FOR                          10510000
110300         SELECT LID_SEQ_NBR                                       10520000
110400               ,LID_AMT                                           10530000
110500               ,LID_RSN_CDE                                       10540000
110600           FROM TEPLID                                            10550000
110700          WHERE PARTN_NBR        = :PV-PARTN-NBR                  10560000
110800            AND STR_NBR          = :PV-STR-NBR                    10570000
110900            AND RGST_ID          = :PV-RGST-ID                    10580000
111000            AND TRN_NBR          = :PV-TRN-NBR                    10590000
111100            AND STRT_TM          = :PV-STRT-TM                    10600000
111200            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           10610000
111300            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            10620000
111400            AND LID_TYP_CDE     NOT IN ('E', 'G')                 10630000
111500       ORDER BY LID_SEQ_NBR DESC                                  10640000
111600                WITH UR                                           10650000
111700                OPTIMIZE FOR 2 ROWS                               10660000
111800     END-EXEC.                                                    10670000
111900                                                                  10680000
118400                                                                  10690000
118500******************************************************************10700000
118600 PROCEDURE DIVISION.                                              10710000
118700******************************************************************10720000
118800                                                                  10730000
118900******************************************************************10740000
119000 0000-MAINLINE-PARAGRAPH.                                         10750000
119100******************************************************************10760000
119200                                                                  10770000
BOSSC2     DISPLAY 'PROCESSING SAKUT801 FIX 4 VERSION'.                 10780009
119200                                                                  10790000
119300     PERFORM 1000-HOUSEKEEPING.                                   10800000
119400                                                                  10810000
119500     PERFORM 1115-CONVERT-INPUT-DATE.                             10820000
119600                                                                  10830000
119700     PERFORM 1116-CALCULATE-CUTOFF-DATE.                          10840000
119800                                                                  10850000
119900     PERFORM 7500-READ-CRITERIA.                                  10860000
120000                                                                  10870000
120100     IF PS-END-OF-CRIT-FILE                                       10880000
120200         MOVE '7500-READ-CRITERIA'   TO PV-PARAGRAPH-NAME         10890000
120300         MOVE 'NO INPUT TO PROCESS'  TO PV-OPERATION-MSG-1        10900000
TRANNF**       SET AC-INVALID-DATA-ERROR   TO TRUE                      10910018
TRANNF**       PERFORM 9999-ABEND                                       10920018
TRANNF         PERFORM 1200-FORMAT-HEADINGS                             10921018
TRANNF         INITIALIZE DL-DETAIL-LINE                                10923018
TRANNF         MOVE 'TRAN NOT FOUND'  TO DL-PRICE-CHANGE-TYPE           10923118
TRANNF         WRITE REPORT-LINE-OUT                                    10924018
TRANNF             FROM DL-DETAIL-LINE AFTER ADVANCING PV-SPACE-CONTROL 10925018
TRANNF     ELSE                                                         10926018
TRANNF         PERFORM 1200-FORMAT-HEADINGS                             10927018
120600     END-IF.                                                      10930000
120700                                                                  10940000
120900                                                                  10960000
121000     PERFORM 1800-PROCESS-INPUT                                   10970000
121100         UNTIL PS-END-OF-CRIT-FILE.                               10980000
121200                                                                  10990000
121300*  SEVA TEAM DOES NOT WANT THE LATES AND CORRECTIONS SO COMMENTING11000000
121400     PERFORM 6000-OPEN-DKEY-CURSOR.                               11010031
121500                                                                  11020031
121600     MOVE ZEROS TO  WS-CMT-CNT.                                   11030031
121700     PERFORM 6100-FETCH-DKEY-CURSOR                               11040031
121800        UNTIL PS-END-OF-DKEY-YES.                                 11050031
121900                                                                  11060031
122000     PERFORM 6200-CLOSE-DKEY-CURSOR.                              11070031
121300*  SEVA TEAM DOES NOT WANT THE LATES AND CORRECTIONS SO COMMENTING11071031
122100     DISPLAY '**************************************'.            11080000
122200     DISPLAY 'FILE MARKDOWN / MARKDOWN CANCEL TOTALS'.            11090000
122300     DISPLAY 'FOR CURENT DAY PROCEC(NOT INCLUDING LATES/CORRCTS)'.11100000
122400     DISPLAY 'PV-TOTAL-MKDN-AMT= ' PV-TOTAL-MKDN-AMT.             11110000
122500     DISPLAY 'PV-TOTAL-MKDNCAN-AMT= ' PV-TOTAL-MKDNCAN-AMT.       11120000
122600     DISPLAY '**************************************'.            11130000
122700                                                                  11140000
122800     PERFORM 9000-EOJ-ROUTINE.                                    11150000
122900                                                                  11160000
123000     STOP RUN.                                                    11170000
123100                                                                  11180000
123200******************************************************************11190000
123300 1000-HOUSEKEEPING.                                               11200000
123400*     OPEN FILES, READ INPUT FILE, CALL ROUTINES TO VALIDATE,    *11210000
123500*     CALCULATE, AND POPULATE FIELDS.                            *11220000
123600******************************************************************11230000
123700                                                                  11240000
123800     OPEN INPUT POS-DATE-FILE                                     11250000
123900                CRITERIA-FILE                                     11260000
124000         OUTPUT LEDGER-MARKDOWN-FILE                              11270000
124100                LEDGER-MARKUP-FILE                                11280000
124400                HOLD-LEDGER-MARKDOWN-FILE                         11310000
124500                HOLD-LEDGER-MARKUP-FILE                           11320000
124800                DATAWHSE-FILE                                     11350000
ZX                    DAY02-TRANS-REPORT                                11360000
124900                MERCH-LEDGER-REPORT.                              11370000
125000                                                                  11380000
125100     READ POS-DATE-FILE            INTO CC-CONTROL-CARD           11390000
125200        AT END                                                    11400000
125300           SET PS-END-OF-CARD-FILE   TO TRUE.                     11410000
125400                                                                  11420000
125500     CLOSE POS-DATE-FILE.                                         11430000
125600                                                                  11440000
125700     IF PS-END-OF-CARD-FILE                                       11450000
125800         MOVE '1000-HOUSEKEEPING'    TO PV-PARAGRAPH-NAME         11460000
125900         MOVE 'NO INPUT TO PROCESS'  TO PV-OPERATION-MSG-1        11470000
126000         SET AC-CONTROL-CARD-ERROR   TO TRUE                      11480000
126100         PERFORM 9999-ABEND                                       11490000
126200     END-IF.                                                      11500000
126300                                                                  11510000
126400     DISPLAY PC-CURRENT-PROGRAM-NAME                              11520000
126500             ' - CONTROL CARD = (' CC-CONTROL-CARD-DISPLAY ')'.   11530000
126600                                                                  11540000
126700******************************************************************11550000
126800 1115-CONVERT-INPUT-DATE.                                         11560000
126900*     KOHLS CALENDAR ROUTINE. VALIDATES INPUT DATE.               11570000
127000******************************************************************11580000
127100                                                                  11590000
127200     DISPLAY '1115-CONVERT-INPUT-DATE'.                           11600000
127300                                                                  11610000
127400     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11620000
127500                                                                  11630000
127600     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     11640000
127700     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     11650000
127800     SET DPG52-LK-DTE-GREG           TO TRUE.                     11660000
127900                                                                  11670000
128000     MOVE CC-POS-DATE-MMDDYY         TO DPG52-LK-DATE-INPUT.      11680000
128100                                                                  11690000
128200     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    11700000
128300                                             DPG54 DPG55 DPG56.   11710000
128400                                                                  11720000
128500     EVALUATE TRUE                                                11730000
128600        WHEN DPG54-SEVERE-ERROR                                   11740000
128700        WHEN DPG54-DATE-INVALID                                   11750000
128800           MOVE '1115-CONVERT-INPUT-DATE'                         11760000
128900                                     TO PV-PARAGRAPH-NAME         11770000
129000           MOVE 'INPUT DATE ERROR'   TO PV-OPERATION-MSG-1        11780000
129100           SET AC-CALENDAR-ERROR     TO TRUE                      11790000
129200           MOVE DPG54-ERROR-MESSAGE  TO PV-OPERATION-MSG-2        11800000
129300           PERFORM 9999-ABEND                                     11810000
129400     END-EVALUATE.                                                11820000
129500                                                                  11830000
129600     MOVE DPG55-DB2-ISO-DATE-FMT     TO PV-RUN-DATE-CCYY-MM-DD.   11840000
129700                                                                  11850000
129800     DISPLAY '  CC-POS-DATE-MMDDYY     = ' CC-POS-DATE-MMDDYY.    11860000
129900     DISPLAY '  PV-RUN-DATE-CCYY-MM-DD = ' PV-RUN-DATE-CCYY-MM-DD.11870000
130000                                                                  11880000
130100******************************************************************11890000
130200 1116-CALCULATE-CUTOFF-DATE.                                      11900000
130300*     KOHLS CALENDAR ROUTINE. CALCULATE THE CUTOFF DATE.          11910000
130400******************************************************************11920000
130500     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11930000
130600                                                                  11940000
130700     SET DPG51-FISCAL-454-CALENDAR   TO TRUE.                     11950000
130800     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     11960000
130900     SET DPG52-LK-DTE-GREG           TO TRUE.                     11970000
131000                                                                  11980000
131100     MOVE CC-POS-DATE-MMDDYY         TO DPG52-LK-DATE-INPUT.      11990000
131200                                                                  12000000
131300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    12010000
131400                                             DPG54 DPG55 DPG56.   12020000
131500                                                                  12030000
131600     EVALUATE TRUE                                                12040000
131700        WHEN DPG54-SEVERE-ERROR                                   12050000
131800        WHEN DPG54-DATE-INVALID                                   12060000
131900           MOVE '1116-CALCULATE-CUTOFF-DATE'                      12070000
132000                                     TO PV-PARAGRAPH-NAME         12080000
132100           MOVE 'INPUT DATE ERROR'   TO PV-OPERATION-MSG-1        12090000
132200           SET AC-CALENDAR-ERROR     TO TRUE                      12100000
132300           MOVE DPG54-ERROR-MESSAGE  TO PV-OPERATION-MSG-2        12110000
132400           PERFORM 9999-ABEND                                     12120000
132500     END-EVALUATE.                                                12130000
132600                                                                  12140000
132700     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PV-CUT-OFF-CCYY-MM-DD.    12150000
132800                                                                  12160000
132900     DISPLAY 'PV-CUT-OFF-CCYY-MM-DD - ' PV-CUT-OFF-CCYY-MM-DD     12170000
133000                                                                  12180000
133100     DISPLAY 'DPG56-FISCAL-PERIOD-NBR ------- '                   12190000
133200              DPG56-FISCAL-PERIOD-NBR                             12200000
133300     DISPLAY 'DPG56-FIRST-FISCAL-PERIOD-DAY - '                   12210000
133400              DPG56-FIRST-FP-DB2-ISO-FMT.                         12220000
133500     DISPLAY 'DPG56-LAST-FISCAL-PERIOD-DAY -- '                   12230000
133600              DPG56-LAST-FP-DB2-ISO-FMT.                          12240000
133700                                                                  12250000
133800******************************************************************12260000
133900 1117-CALCU-KOHLS-MONTH.                                          12270000
134000*     KOHLS CALENDAR ROUTINE. CALCULATE KOHLS MONTH.              12280000
134100******************************************************************12290000
134200                                                                  12300000
134300     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              12310000
134400                                                                  12320000
134500     SET  DPG51-FISCAL-454-CALENDAR  TO TRUE.                     12330000
134600     SET  DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                    12340000
134700     SET  DPG52-LK-DTE-ISO-FMT       TO TRUE.                     12350000
134800     MOVE EPTRN-SLS-DTE              TO DPG52-LK-DATE-INPUT.      12360000
134900     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    12370000
135000                                             DPG54 DPG55 DPG56.   12380000
135100     EVALUATE TRUE                                                12390000
135200        WHEN DPG54-SEVERE-ERROR                                   12400000
135300        WHEN DPG54-DATE-INVALID                                   12410000
135400           MOVE '1117-CALCU-KOHLS-MONTH'                          12420000
135500                                     TO PV-PARAGRAPH-NAME         12430000
135600           MOVE 'CALENDAR ROUTINE ERROR'                          12440000
135700                                     TO PV-OPERATION-MSG-1        12450000
135800           SET AC-CALENDAR-ERROR     TO TRUE                      12460000
135900           MOVE DPG54-ERROR-MESSAGE  TO PV-OPERATION-MSG-2        12470000
136000           PERFORM 9999-ABEND                                     12480000
136100     END-EVALUATE.                                                12490000
136200                                                                  12500000
136300     MOVE DPG56-FISCAL-PERIOD-NBR TO  PV-FISC-PERIOD-NBR-HOLD.    12510000
136400                                                                  12520000
136500                                                                  12530000
136600******************************************************************12540000
136700 1200-FORMAT-HEADINGS.                                            12550000
136800*     GET CURRENT DATE AND TIME FROM SYSTEM.                      12560000
136900*     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          12570000
137000*     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              12580000
137100******************************************************************12590000
137200                                                                  12600000
137300     ACCEPT PV-CURRENT-DATE        FROM DATE.                     12610000
137400     ACCEPT PV-CURRENT-TIME        FROM TIME.                     12620000
137500                                                                  12630000
137600     MOVE PV-CURRENT-YEAR            TO DP132O-RUN-YEAR.          12640000
137700     MOVE PV-CURRENT-MONTH           TO DP132O-RUN-MONTH.         12650000
137800     MOVE PV-CURRENT-DAY             TO DP132O-RUN-DAY.           12660000
137900                                                                  12670000
138000     MOVE PV-CURRENT-HOUR            TO DP132O-RUN-HOUR.          12680000
138100     MOVE PV-CURRENT-MINUTE          TO DP132O-RUN-MINUTE.        12690000
138200                                                                  12700000
138300     MOVE PC-CURRENT-PROGRAM-NAME    TO DP132O-PROGRAM-NAME.      12710000
138400                                                                  12720000
138500     MOVE '1'                        TO DP132O-REPORT-NUMBER.     12730000
138600                                                                  12740000
138700     INITIALIZE DL-DETAIL-LINE.                                   12750000
138800                                                                  12760000
138900     INITIALIZE ML017-PRICE-CHANGE-RECORD.                        12770000
139000                                                                  12780000
139100     MOVE CC-POS-DATE-MM             TO HL-REPORT-MONTH           12790000
139200     MOVE CC-POS-DATE-DD             TO HL-REPORT-DAY             12800000
139300     MOVE CC-POS-DATE-YY             TO HL-REPORT-YEAR            12810000
139400                                                                  12820000
139500     MOVE CNTL-CARD TO HL-CRITERIA.                               12830000
ZX         PERFORM 2451-SELECT-ORDER-NUMBER.                            12840000
ZX         IF PS-ORDER-NUMBER-FOUND-N                                   12850000
ZX             MOVE SPACES           TO HL-ORDERNO                      12860000
ZX         ELSE                                                         12870000
ZX             MOVE EPORD-ORD-NBR-TEXT                                  12880000
ZX                                   TO HL-ORDERNO                      12890000
ZX         END-IF.                                                      12900000
                                                                        12910000
139600                                                                  12920000
139700     PERFORM 8400-WRITE-HEADERS.                                  12930000
ZX         PERFORM 8196-WRITE-DAY02-HEADR-RECORD.                       12940000
139800                                                                  12950000
139900******************************************************************12960000
140000 1500-PROCESS-PROGRAM-TOTALS.                                     12970000
140100*  DISPLAY PROGRAM TOTALS BY MARKDOWN/MARKUP TYPE AND CATEGORY.  *12980000
140200******************************************************************12990000
140300                                                                  13000000
LATES      EVALUATE PV-TOT-SUB                                          13010031
LATES          WHEN 1                                                   13020031
140600             SET HD-ORIGINAL-SALES            TO TRUE             13030031
LATES          WHEN 2                                                   13040031
LATES              PERFORM 8400-WRITE-HEADERS                           13041031
LATES              SET HD-SALES-CORR                TO TRUE             13050031
LATES          WHEN 3                                                   13060031
LATES              PERFORM 8400-WRITE-HEADERS                           13061031
LATES              SET HD-LATE-TRANSACTIONS         TO TRUE             13070031
LATES          WHEN 4                                                   13090031
LATES              PERFORM 8400-WRITE-HEADERS                           13091031
LATES              SET HD-CUTOFF-SALES-CORR         TO TRUE             13100031
LATES          WHEN 5                                                   13120031
LATES              PERFORM 8400-WRITE-HEADERS                           13121031
LATES              SET HD-CUTOFF-LATE-TRANSACTIONS  TO TRUE             13130031
LATES      END-EVALUATE.                                                13150031
141900                                                                  13160000
142000     MOVE 2 TO PV-SPACE-CONTROL.                                  13170000
142100                                                                  13180000
142200     WRITE REPORT-LINE-OUT                                        13190000
142300         FROM HL-HEADER-LINE4                                     13200000
142400            AFTER ADVANCING PV-SPACE-CONTROL.                     13210000
142500                                                                  13220000
142600     ADD 2 TO PV-LINE-COUNT.                                      13230000
142700                                                                  13240000
142800     DISPLAY ' '.                                                 13250000
142900     DISPLAY '  '  HL-HEADER-LINE4                                13260000
143000     DISPLAY ' '.                                                 13270000
143100                                                                  13280000
143200     DISPLAY ' '.                                                 13290000
143300     DISPLAY '  '  DH-DISPLAY-HEADER.                             13300000
143400     DISPLAY ' '.                                                 13310000
143500                                                                  13320000
143600     MOVE SPACES TO DD-DISPLAY-DETAIL.                            13330000
143700     SET DD-PC-PROMOTIONAL           TO TRUE.                     13340000
143800     MOVE PT-PROMOTIONAL-MKDN-QTY (PV-TOT-SUB)                    13350000
143900                                     TO DD-MARKDOWN-QTY           13360000
144000                                        DL-MARKDOWN-QTY.          13370000
144100     ADD PT-PROMOTIONAL-MKDN-QTY (PV-TOT-SUB)                     13380000
144200                                     TO PT-TOTAL-MARKDOWN-QTY     13390000
144300                                        (PV-TOT-SUB).             13400000
144400     MOVE PT-PROMOTIONAL-MKDN-AMT (PV-TOT-SUB)                    13410000
144500                                     TO DD-MARKDOWN-AMT           13420000
144600                                        DL-MARKDOWN-AMT.          13430000
144700     ADD PT-PROMOTIONAL-MKDN-AMT (PV-TOT-SUB)                     13440000
144800                                     TO PT-TOTAL-MARKDOWN-AMT     13450000
144900                                        (PV-TOT-SUB).             13460000
145000     MOVE PT-PROMOTIONAL-MDC-QTY (PV-TOT-SUB)                     13470000
145100                                     TO DD-MARKDOWN-CANCEL-QTY    13480000
145200                                        DL-MARKDOWN-CANCEL-QTY.   13490000
145300     ADD PT-PROMOTIONAL-MDC-QTY (PV-TOT-SUB)                      13500000
145400                                     TO                           13510000
145500         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               13520000
145600     MOVE PT-PROMOTIONAL-MDC-AMT (PV-TOT-SUB)                     13530000
145700                                     TO DD-MARKDOWN-CANCEL-AMT    13540000
145800                                        DL-MARKDOWN-CANCEL-AMT.   13550000
145900     ADD PT-PROMOTIONAL-MDC-AMT (PV-TOT-SUB)                      13560000
146000                                     TO                           13570000
146100         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               13580000
146200                                                                  13590000
146300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             13600000
146400     MOVE PC-PROMOTIONAL             TO DL-PRICE-CHANGE-TYPE.     13610000
146500     PERFORM 8200-WRITE-DETAIL-LINE.                              13620000
146600                                                                  13630000
146700     MOVE SPACES                     TO DD-DISPLAY-DETAIL.        13640000
146800     SET DD-PC-TIERED                TO TRUE.                     13650000
146900     MOVE PT-TIERED-MKDN-QTY (PV-TOT-SUB)                         13660000
147000                                     TO DD-MARKDOWN-QTY           13670000
147100                                        DL-MARKDOWN-QTY.          13680000
147200     ADD PT-TIERED-MKDN-QTY (PV-TOT-SUB)                          13690000
147300                                     TO PT-TOTAL-MARKDOWN-QTY     13700000
147400                                        (PV-TOT-SUB).             13710000
147500     MOVE PT-TIERED-MKDN-AMT (PV-TOT-SUB)                         13720000
147600                                     TO DD-MARKDOWN-AMT           13730000
147700                                        DL-MARKDOWN-AMT.          13740000
147800     ADD PT-TIERED-MKDN-AMT (PV-TOT-SUB)                          13750000
147900                                     TO PT-TOTAL-MARKDOWN-AMT     13760000
148000                                        (PV-TOT-SUB).             13770000
148100     MOVE PT-TIERED-MDC-QTY (PV-TOT-SUB)                          13780000
148200                                     TO DD-MARKDOWN-CANCEL-QTY    13790000
148300                                        DL-MARKDOWN-CANCEL-QTY.   13800000
148400     ADD PT-TIERED-MDC-QTY (PV-TOT-SUB)                           13810000
148500                                     TO                           13820000
148600         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               13830000
148700     MOVE PT-TIERED-MDC-AMT (PV-TOT-SUB)                          13840000
148800                                     TO DD-MARKDOWN-CANCEL-AMT    13850000
148900                                        DL-MARKDOWN-CANCEL-AMT.   13860000
149000     ADD PT-TIERED-MDC-AMT (PV-TOT-SUB)                           13870000
149100                                     TO                           13880000
149200         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               13890000
149300                                                                  13900000
149400     DISPLAY '  '  DD-DISPLAY-DETAIL.                             13910000
149500     MOVE PC-TIERED                  TO DL-PRICE-CHANGE-TYPE.     13920000
149600     PERFORM 8200-WRITE-DETAIL-LINE.                              13930000
149700                                                                  13940000
149800     MOVE SPACES                     TO DD-DISPLAY-DETAIL.        13950000
149900     SET DD-PC-GOLDSTAR              TO TRUE.                     13960000
150000     MOVE PT-GOLDSTAR-MKDN-QTY (PV-TOT-SUB)                       13970000
150100                                     TO DD-MARKDOWN-QTY           13980000
150200                                        DL-MARKDOWN-QTY.          13990000
150300     ADD PT-GOLDSTAR-MKDN-QTY (PV-TOT-SUB)                        14000000
150400                                     TO PT-TOTAL-MARKDOWN-QTY     14010000
150500                                        (PV-TOT-SUB).             14020000
150600     MOVE PT-GOLDSTAR-MKDN-AMT (PV-TOT-SUB)                       14030000
150700                                     TO DD-MARKDOWN-AMT           14040000
150800                                        DL-MARKDOWN-AMT.          14050000
150900     ADD PT-GOLDSTAR-MKDN-AMT (PV-TOT-SUB)                        14060000
151000                                     TO PT-TOTAL-MARKDOWN-AMT     14070000
151100                                        (PV-TOT-SUB).             14080000
151200     MOVE PT-GOLDSTAR-MDC-QTY (PV-TOT-SUB)                        14090000
151300                                     TO DD-MARKDOWN-CANCEL-QTY    14100000
151400                                        DL-MARKDOWN-CANCEL-QTY.   14110000
151500     ADD PT-GOLDSTAR-MDC-QTY (PV-TOT-SUB)                         14120000
151600                                     TO                           14130000
151700         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               14140000
151800     MOVE PT-GOLDSTAR-MDC-AMT (PV-TOT-SUB)                        14150000
151900                                     TO DD-MARKDOWN-CANCEL-AMT    14160000
152000                                        DL-MARKDOWN-CANCEL-AMT.   14170000
152100     ADD PT-GOLDSTAR-MDC-AMT (PV-TOT-SUB)                         14180000
152200                                     TO                           14190000
152300         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               14200000
152400                                                                  14210000
152500     DISPLAY '  '  DD-DISPLAY-DETAIL.                             14220000
152600     MOVE PC-GOLDSTAR                TO DL-PRICE-CHANGE-TYPE.     14230000
152700     PERFORM 8200-WRITE-DETAIL-LINE.                              14240000
152800                                                                  14250000
152900     MOVE SPACES TO DD-DISPLAY-DETAIL.                            14260000
153000     SET DD-PC-MANUAL-LID            TO TRUE.                     14270000
153100     MOVE PT-MANUAL-LID-MKDN-QTY (PV-TOT-SUB)                     14280000
153200                                     TO DD-MARKDOWN-QTY           14290000
153300                                        DL-MARKDOWN-QTY.          14300000
153400     ADD PT-MANUAL-LID-MKDN-QTY (PV-TOT-SUB)                      14310000
153500                                     TO PT-TOTAL-MARKDOWN-QTY     14320000
153600                                        (PV-TOT-SUB).             14330000
153700     MOVE PT-MANUAL-LID-MKDN-AMT (PV-TOT-SUB)                     14340000
153800                                     TO DD-MARKDOWN-AMT           14350000
153900                                        DL-MARKDOWN-AMT.          14360000
154000     ADD PT-MANUAL-LID-MKDN-AMT (PV-TOT-SUB)                      14370000
154100                                     TO PT-TOTAL-MARKDOWN-AMT     14380000
154200                                        (PV-TOT-SUB).             14390000
154300     MOVE PT-MANUAL-LID-MDC-QTY (PV-TOT-SUB)                      14400000
154400                                     TO DD-MARKDOWN-CANCEL-QTY    14410000
154500                                        DL-MARKDOWN-CANCEL-QTY.   14420000
154600     ADD PT-MANUAL-LID-MDC-QTY (PV-TOT-SUB)                       14430000
154700                                     TO                           14440000
154800         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               14450000
154900     MOVE PT-MANUAL-LID-MDC-AMT (PV-TOT-SUB)                      14460000
155000                                     TO DD-MARKDOWN-CANCEL-AMT    14470000
155100                                        DL-MARKDOWN-CANCEL-AMT.   14480000
155200     ADD PT-MANUAL-LID-MDC-AMT (PV-TOT-SUB)                       14490000
155300                                     TO                           14500000
155400         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               14510000
155500                                                                  14520000
155600     DISPLAY '  '  DD-DISPLAY-DETAIL.                             14530000
155700     MOVE PC-MANUAL-LID              TO DL-PRICE-CHANGE-TYPE.     14540000
155800     PERFORM 8200-WRITE-DETAIL-LINE.                              14550000
155900                                                                  14560000
156000     MOVE SPACES TO DD-DISPLAY-DETAIL.                            14570000
156100     SET DD-PC-OWNERSHIP-ADJUSTMENT  TO TRUE.                     14580000
156200     MOVE PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)                  14590000
156300                                     TO DD-MARKDOWN-QTY           14600000
156400                                        DL-MARKDOWN-QTY.          14610000
156500     ADD PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)                   14620000
156600                                     TO PT-TOTAL-MARKDOWN-QTY     14630000
156700                                        (PV-TOT-SUB).             14640000
156800     MOVE PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)                  14650000
156900                                     TO DD-MARKDOWN-AMT           14660000
157000                                        DL-MARKDOWN-AMT.          14670000
157100     ADD PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)                   14680000
157200                                     TO PT-TOTAL-MARKDOWN-AMT     14690000
157300                                        (PV-TOT-SUB).             14700000
157400     MOVE PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)                   14710000
157500                                 TO DD-MARKDOWN-CANCEL-QTY        14720000
157600                                    DL-MARKDOWN-CANCEL-QTY.       14730000
157700     ADD PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)                    14740000
157800                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  14750000
157900                                                    (PV-TOT-SUB). 14760000
158000     MOVE PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                   14770000
158100                                 TO DD-MARKDOWN-CANCEL-AMT        14780000
158200                                    DL-MARKDOWN-CANCEL-AMT.       14790000
158300     ADD PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                    14800000
158400                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  14810000
158500                                                    (PV-TOT-SUB). 14820000
158600     MOVE PT-OWNERSHIP-ADJ-MKUP-QTY (PV-TOT-SUB)                  14830000
158700                                 TO DD-MARKUP-QTY                 14840000
158800                                    DL-MARKUP-QTY.                14850000
158900     ADD PT-OWNERSHIP-ADJ-MKUP-QTY (PV-TOT-SUB)                   14860000
159000                                 TO PT-TOTAL-MARKUP-QTY           14870000
159100                                                    (PV-TOT-SUB). 14880000
159200     MOVE PT-OWNERSHIP-ADJ-MKUP-AMT (PV-TOT-SUB)                  14890000
159300                                 TO DD-MARKUP-AMT                 14900000
159400                                    DL-MARKUP-AMT.                14910000
159500     ADD PT-OWNERSHIP-ADJ-MKUP-AMT (PV-TOT-SUB)                   14920000
159600                                 TO PT-TOTAL-MARKUP-AMT           14930000
159700                                                    (PV-TOT-SUB). 14940000
159800     MOVE PT-OWNERSHIP-ADJ-MUC-QTY (PV-TOT-SUB)                   14950000
159900                                 TO DD-MARKUP-CANCEL-QTY          14960000
160000                                    DL-MARKUP-CANCEL-QTY.         14970000
160100     ADD PT-OWNERSHIP-ADJ-MUC-QTY (PV-TOT-SUB)                    14980000
160200                                 TO PT-TOTAL-MARKUP-CANCEL-QTY    14990000
160300                                                    (PV-TOT-SUB). 15000000
160400     MOVE PT-OWNERSHIP-ADJ-MUC-AMT (PV-TOT-SUB)                   15010000
160500                                 TO DD-MARKUP-CANCEL-AMT          15020000
160600                                    DL-MARKUP-CANCEL-AMT.         15030000
160700     ADD PT-OWNERSHIP-ADJ-MUC-AMT (PV-TOT-SUB)                    15040000
160800                                 TO PT-TOTAL-MARKUP-CANCEL-AMT    15050000
160900                                                    (PV-TOT-SUB). 15060000
161000                                                                  15070000
161100     DISPLAY '  '  DD-DISPLAY-DETAIL.                             15080000
161200     MOVE PC-OWNERSHIP-ADJ TO DL-PRICE-CHANGE-TYPE.               15090000
161300     PERFORM 8200-WRITE-DETAIL-LINE.                              15100000
161400                                                                  15110000
161500     MOVE SPACES TO DD-DISPLAY-DETAIL.                            15120000
161600     SET DD-PC-OWN-RETRN-ADJUSTMENT TO TRUE.                      15130000
161700     MOVE PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)                  15140000
161800                                 TO DD-MARKDOWN-QTY               15150000
161900                                    DL-MARKDOWN-QTY.              15160000
162000     ADD PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)                   15170000
162100                                 TO PT-TOTAL-MARKDOWN-QTY         15180000
162200                                                    (PV-TOT-SUB). 15190000
162300     MOVE PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)                  15200000
162400                                 TO DD-MARKDOWN-AMT               15210000
162500                                    DL-MARKDOWN-AMT.              15220000
162600     ADD PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)                   15230000
162700                                 TO PT-TOTAL-MARKDOWN-AMT         15240000
162800                                                    (PV-TOT-SUB). 15250000
162900     MOVE PT-OWN-RETRN-ADJ-MDC-QTY (PV-TOT-SUB)                   15260000
163000                                 TO DD-MARKDOWN-CANCEL-QTY        15270000
163100                                    DL-MARKDOWN-CANCEL-QTY.       15280000
163200     ADD PT-OWN-RETRN-ADJ-MDC-QTY (PV-TOT-SUB)                    15290000
163300                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  15300000
163400                                                    (PV-TOT-SUB). 15310000
163500     MOVE PT-OWN-RETRN-ADJ-MDC-AMT (PV-TOT-SUB)                   15320000
163600                                 TO DD-MARKDOWN-CANCEL-AMT        15330000
163700                                    DL-MARKDOWN-CANCEL-AMT.       15340000
163800     ADD PT-OWN-RETRN-ADJ-MDC-AMT (PV-TOT-SUB)                    15350000
163900                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  15360000
164000                                                    (PV-TOT-SUB). 15370000
164100     MOVE PT-OWN-RETRN-ADJ-MKUP-QTY (PV-TOT-SUB)                  15380000
164200                                 TO DD-MARKUP-QTY                 15390000
164300                                    DL-MARKUP-QTY.                15400000
164400     ADD PT-OWN-RETRN-ADJ-MKUP-QTY (PV-TOT-SUB)                   15410000
164500                                 TO PT-TOTAL-MARKUP-QTY           15420000
164600                                                    (PV-TOT-SUB). 15430000
164700     MOVE PT-OWN-RETRN-ADJ-MKUP-AMT (PV-TOT-SUB)                  15440000
164800                                 TO DD-MARKUP-AMT                 15450000
164900                                    DL-MARKUP-AMT.                15460000
165000     ADD PT-OWN-RETRN-ADJ-MKUP-AMT (PV-TOT-SUB)                   15470000
165100                                 TO PT-TOTAL-MARKUP-AMT           15480000
165200                                                    (PV-TOT-SUB). 15490000
165300     MOVE PT-OWN-RETRN-ADJ-MUC-QTY (PV-TOT-SUB)                   15500000
165400                                 TO DD-MARKUP-CANCEL-QTY          15510000
165500                                    DL-MARKUP-CANCEL-QTY.         15520000
165600     ADD PT-OWN-RETRN-ADJ-MUC-QTY (PV-TOT-SUB)                    15530000
165700                                 TO PT-TOTAL-MARKUP-CANCEL-QTY    15540000
165800                                                    (PV-TOT-SUB). 15550000
165900     MOVE PT-OWN-RETRN-ADJ-MUC-AMT (PV-TOT-SUB)                   15560000
166000                                 TO DD-MARKUP-CANCEL-AMT          15570000
166100                                    DL-MARKUP-CANCEL-AMT.         15580000
166200     ADD PT-OWN-RETRN-ADJ-MUC-AMT (PV-TOT-SUB)                    15590000
166300                                 TO PT-TOTAL-MARKUP-CANCEL-AMT    15600000
166400                                                    (PV-TOT-SUB). 15610000
166500                                                                  15620000
166600     DISPLAY '  '  DD-DISPLAY-DETAIL.                             15630000
166700     MOVE PC-OWN-RETRN-ADJ TO DL-PRICE-CHANGE-TYPE.               15640000
166800     PERFORM 8200-WRITE-DETAIL-LINE.                              15650000
166900                                                                  15660000
167000     MOVE SPACES TO DD-DISPLAY-DETAIL.                            15670000
167100     SET DD-PC-SENIOR-CITIZEN TO TRUE.                            15680000
167200     MOVE PT-SENIOR-CITIZEN-MKDN-QTY (PV-TOT-SUB)                 15690000
167300                                 TO DD-MARKDOWN-QTY               15700000
167400                                    DL-MARKDOWN-QTY.              15710000
167500     ADD PT-SENIOR-CITIZEN-MKDN-QTY (PV-TOT-SUB)                  15720000
167600                                 TO PT-TOTAL-MARKDOWN-QTY         15730000
167700                                                    (PV-TOT-SUB). 15740000
167800     MOVE PT-SENIOR-CITIZEN-MKDN-AMT (PV-TOT-SUB)                 15750000
167900                                 TO DD-MARKDOWN-AMT               15760000
168000                                    DL-MARKDOWN-AMT.              15770000
168100     ADD PT-SENIOR-CITIZEN-MKDN-AMT (PV-TOT-SUB)                  15780000
168200                                 TO PT-TOTAL-MARKDOWN-AMT         15790000
168300                                                    (PV-TOT-SUB). 15800000
168400     MOVE PT-SENIOR-CITIZEN-MDC-QTY (PV-TOT-SUB)                  15810000
168500                                 TO DD-MARKDOWN-CANCEL-QTY        15820000
168600                                    DL-MARKDOWN-CANCEL-QTY.       15830000
168700     ADD PT-SENIOR-CITIZEN-MDC-QTY (PV-TOT-SUB)                   15840000
168800                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  15850000
168900                                                    (PV-TOT-SUB). 15860000
169000     MOVE PT-SENIOR-CITIZEN-MDC-AMT (PV-TOT-SUB)                  15870000
169100                                 TO DD-MARKDOWN-CANCEL-AMT        15880000
169200                                    DL-MARKDOWN-CANCEL-AMT.       15890000
169300     ADD PT-SENIOR-CITIZEN-MDC-AMT (PV-TOT-SUB)                   15900000
169400                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  15910000
169500                                                    (PV-TOT-SUB). 15920000
169600                                                                  15930000
169700     DISPLAY '  '  DD-DISPLAY-DETAIL.                             15940000
169800     MOVE PC-SENIOR-CITIZEN TO DL-PRICE-CHANGE-TYPE.              15950000
169900     PERFORM 8200-WRITE-DETAIL-LINE.                              15960000
170000                                                                  15970000
170100     MOVE SPACES TO DD-DISPLAY-DETAIL.                            15980000
170200     SET DD-PC-KOHLS-COUPON TO TRUE.                              15990000
170300     MOVE PT-KOHLS-COUPON-MKDN-QTY (PV-TOT-SUB)                   16000000
170400                                 TO DD-MARKDOWN-QTY               16010000
170500                                    DL-MARKDOWN-QTY.              16020000
170600     ADD PT-KOHLS-COUPON-MKDN-QTY (PV-TOT-SUB)                    16030000
170700                                 TO PT-TOTAL-MARKDOWN-QTY         16040000
170800                                                    (PV-TOT-SUB). 16050000
170900     MOVE PT-KOHLS-COUPON-MKDN-AMT (PV-TOT-SUB)                   16060000
171000                                 TO DD-MARKDOWN-AMT               16070000
171100                                    DL-MARKDOWN-AMT.              16080000
171200     ADD PT-KOHLS-COUPON-MKDN-AMT (PV-TOT-SUB)                    16090000
171300                                 TO PT-TOTAL-MARKDOWN-AMT         16100000
171400                                                    (PV-TOT-SUB). 16110000
171500     MOVE PT-KOHLS-COUPON-MDC-QTY (PV-TOT-SUB)                    16120000
171600                                 TO DD-MARKDOWN-CANCEL-QTY        16130000
171700                                    DL-MARKDOWN-CANCEL-QTY.       16140000
171800     ADD PT-KOHLS-COUPON-MDC-QTY (PV-TOT-SUB)                     16150000
171900                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  16160000
172000                                                    (PV-TOT-SUB). 16170000
172100     MOVE PT-KOHLS-COUPON-MDC-AMT (PV-TOT-SUB)                    16180000
172200                                 TO DD-MARKDOWN-CANCEL-AMT        16190000
172300                                    DL-MARKDOWN-CANCEL-AMT.       16200000
172400     ADD PT-KOHLS-COUPON-MDC-AMT (PV-TOT-SUB)                     16210000
172500                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  16220000
172600                                                    (PV-TOT-SUB). 16230000
172700                                                                  16240000
172800     DISPLAY '  '  DD-DISPLAY-DETAIL.                             16250000
172900     MOVE PC-KOHLS-COUPON TO DL-PRICE-CHANGE-TYPE.                16260000
173000     PERFORM 8200-WRITE-DETAIL-LINE.                              16270000
173100                                                                  16280000
173200                                                                  16290000
173300     MOVE SPACES TO DD-DISPLAY-DETAIL.                            16300000
173400     SET DD-PC-OFFER-COUPON TO TRUE.                              16310000
173500     MOVE PT-760-OFFER-MKDN-QTY (PV-TOT-SUB)                      16320000
173600                                 TO DD-MARKDOWN-QTY               16330000
173700                                    DL-MARKDOWN-QTY.              16340000
173800     ADD PT-760-OFFER-MKDN-QTY (PV-TOT-SUB)                       16350000
173900                                 TO PT-TOTAL-MARKDOWN-QTY         16360000
174000                                                    (PV-TOT-SUB). 16370000
174100     MOVE PT-760-OFFER-MKDN-AMT (PV-TOT-SUB)                      16380000
174200                                 TO DD-MARKDOWN-AMT               16390000
174300                                    DL-MARKDOWN-AMT.              16400000
174400     ADD PT-760-OFFER-MKDN-AMT (PV-TOT-SUB)                       16410000
174500                                 TO PT-TOTAL-MARKDOWN-AMT         16420000
174600                                                    (PV-TOT-SUB). 16430000
174700     MOVE PT-760-OFFER-MDC-QTY (PV-TOT-SUB)                       16440000
174800                                 TO DD-MARKDOWN-CANCEL-QTY        16450000
174900                                    DL-MARKDOWN-CANCEL-QTY.       16460000
175000     ADD PT-760-OFFER-MDC-QTY (PV-TOT-SUB)                        16470000
175100                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  16480000
175200                                                    (PV-TOT-SUB). 16490000
175300     MOVE PT-760-OFFER-MDC-AMT (PV-TOT-SUB)                       16500000
175400                                 TO DD-MARKDOWN-CANCEL-AMT        16510000
175500                                    DL-MARKDOWN-CANCEL-AMT.       16520000
175600     ADD PT-760-OFFER-MDC-AMT (PV-TOT-SUB)                        16530000
175700                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  16540000
175800                                                    (PV-TOT-SUB). 16550000
175900     DISPLAY '  '  DD-DISPLAY-DETAIL.                             16560000
176000     MOVE PC-OFFER-COUPON TO DL-PRICE-CHANGE-TYPE.                16570000
176100     PERFORM 8200-WRITE-DETAIL-LINE.                              16580000
176200                                                                  16590000
176300     MOVE SPACES TO DD-DISPLAY-DETAIL.                            16600000
176400     SET DD-PC-OFFER-TLD-TIERED TO TRUE.                          16610000
176500     MOVE PT-761-TLDTIER-MKDN-QTY (PV-TOT-SUB)                    16620000
176600                                 TO DD-MARKDOWN-QTY               16630000
176700                                    DL-MARKDOWN-QTY.              16640000
176800     ADD PT-761-TLDTIER-MKDN-QTY (PV-TOT-SUB)                     16650000
176900                                 TO PT-TOTAL-MARKDOWN-QTY         16660000
177000                                                    (PV-TOT-SUB). 16670000
177100     MOVE PT-761-TLDTIER-MKDN-AMT (PV-TOT-SUB)                    16680000
177200                                 TO DD-MARKDOWN-AMT               16690000
177300                                    DL-MARKDOWN-AMT.              16700000
177400     ADD PT-761-TLDTIER-MKDN-AMT (PV-TOT-SUB)                     16710000
177500                                 TO PT-TOTAL-MARKDOWN-AMT         16720000
177600                                                    (PV-TOT-SUB). 16730000
177700     MOVE PT-761-TLDTIER-MDC-QTY (PV-TOT-SUB)                     16740000
177800                                 TO DD-MARKDOWN-CANCEL-QTY        16750000
177900                                    DL-MARKDOWN-CANCEL-QTY.       16760000
178000     ADD PT-761-TLDTIER-MDC-QTY (PV-TOT-SUB)                      16770000
178100                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  16780000
178200                                                    (PV-TOT-SUB). 16790000
178300     MOVE PT-761-TLDTIER-MDC-AMT (PV-TOT-SUB)                     16800000
178400                                 TO DD-MARKDOWN-CANCEL-AMT        16810000
178500                                    DL-MARKDOWN-CANCEL-AMT.       16820000
178600     ADD PT-761-TLDTIER-MDC-AMT (PV-TOT-SUB)                      16830000
178700                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  16840000
178800                                                    (PV-TOT-SUB). 16850000
178900     DISPLAY '  '  DD-DISPLAY-DETAIL.                             16860000
179000     MOVE PC-OFFER-TLD-TIERED  TO DL-PRICE-CHANGE-TYPE.           16870000
179100     PERFORM 8200-WRITE-DETAIL-LINE.                              16880000
179200                                                                  16890000
179300                                                                  16900000
179400     MOVE SPACES TO DD-DISPLAY-DETAIL.                            16910000
179500     SET DD-PC-OFFER-LID-TIERED TO TRUE.                          16920000
179600     MOVE PT-762-LIDTIER-MKDN-QTY (PV-TOT-SUB)                    16930000
179700                                 TO DD-MARKDOWN-QTY               16940000
179800                                    DL-MARKDOWN-QTY.              16950000
179900     ADD PT-762-LIDTIER-MKDN-QTY (PV-TOT-SUB)                     16960000
180000                                 TO PT-TOTAL-MARKDOWN-QTY         16970000
180100                                                    (PV-TOT-SUB). 16980000
180200     MOVE PT-762-LIDTIER-MKDN-AMT (PV-TOT-SUB)                    16990000
180300                                 TO DD-MARKDOWN-AMT               17000000
180400                                    DL-MARKDOWN-AMT.              17010000
180500     ADD PT-762-LIDTIER-MKDN-AMT (PV-TOT-SUB)                     17020000
180600                                 TO PT-TOTAL-MARKDOWN-AMT         17030000
180700                                                    (PV-TOT-SUB). 17040000
180800     MOVE PT-762-LIDTIER-MDC-QTY (PV-TOT-SUB)                     17050000
180900                                 TO DD-MARKDOWN-CANCEL-QTY        17060000
181000                                    DL-MARKDOWN-CANCEL-QTY.       17070000
181100     ADD PT-762-LIDTIER-MDC-QTY (PV-TOT-SUB)                      17080000
181200                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  17090000
181300                                                    (PV-TOT-SUB). 17100000
181400     MOVE PT-762-LIDTIER-MDC-AMT (PV-TOT-SUB)                     17110000
181500                                 TO DD-MARKDOWN-CANCEL-AMT        17120000
181600                                    DL-MARKDOWN-CANCEL-AMT.       17130000
181700     ADD PT-762-LIDTIER-MDC-AMT (PV-TOT-SUB)                      17140000
181800                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  17150000
181900                                                    (PV-TOT-SUB). 17160000
182000     DISPLAY '  '  DD-DISPLAY-DETAIL.                             17170000
182100     MOVE PC-OFFER-LID-TIERED  TO DL-PRICE-CHANGE-TYPE.           17180000
182200     PERFORM 8200-WRITE-DETAIL-LINE.                              17190000
182300                                                                  17200000
182400                                                                  17210000
182500     MOVE SPACES TO DD-DISPLAY-DETAIL.                            17220000
182600     SET DD-PC-OFFER-GWP-PWP    TO TRUE.                          17230000
182700     MOVE PT-763-GWPPWP-MKDN-QTY (PV-TOT-SUB)                     17240000
182800                                 TO DD-MARKDOWN-QTY               17250000
182900                                    DL-MARKDOWN-QTY.              17260000
183000     ADD PT-763-GWPPWP-MKDN-QTY (PV-TOT-SUB)                      17270000
183100                                 TO PT-TOTAL-MARKDOWN-QTY         17280000
183200                                                    (PV-TOT-SUB). 17290000
183300     MOVE PT-763-GWPPWP-MKDN-AMT (PV-TOT-SUB)                     17300000
183400                                 TO DD-MARKDOWN-AMT               17310000
183500                                    DL-MARKDOWN-AMT.              17320000
183600     ADD PT-763-GWPPWP-MKDN-AMT (PV-TOT-SUB)                      17330000
183700                                 TO PT-TOTAL-MARKDOWN-AMT         17340000
183800                                                    (PV-TOT-SUB). 17350000
183900     MOVE PT-763-GWPPWP-MDC-QTY (PV-TOT-SUB)                      17360000
184000                                 TO DD-MARKDOWN-CANCEL-QTY        17370000
184100                                    DL-MARKDOWN-CANCEL-QTY.       17380000
184200     ADD PT-763-GWPPWP-MDC-QTY (PV-TOT-SUB)                       17390000
184300                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  17400000
184400                                                    (PV-TOT-SUB). 17410000
184500     MOVE PT-763-GWPPWP-MDC-AMT (PV-TOT-SUB)                      17420000
184600                                 TO DD-MARKDOWN-CANCEL-AMT        17430000
184700                                    DL-MARKDOWN-CANCEL-AMT.       17440000
184800     ADD PT-763-GWPPWP-MDC-AMT (PV-TOT-SUB)                       17450000
184900                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  17460000
185000                                                    (PV-TOT-SUB). 17470000
185100                                                                  17480000
185200     DISPLAY '  '  DD-DISPLAY-DETAIL.                             17490000
185300     MOVE PC-OFFER-GWP-PWP     TO DL-PRICE-CHANGE-TYPE.           17500000
185400     PERFORM 8200-WRITE-DETAIL-LINE.                              17510000
185500                                                                  17520000
205464     MOVE SPACES TO DD-DISPLAY-DETAIL.                            17530000
205464     SET DD-NON-RCPT-RTRN        TO TRUE.                         17540000
205464     MOVE PT-710-NORCPT-MKDN-QTY (PV-TOT-SUB)                     17550000
205464                                 TO DD-MARKDOWN-QTY               17560000
205464                                    DL-MARKDOWN-QTY.              17570000
205464     ADD PT-710-NORCPT-MKDN-QTY (PV-TOT-SUB)                      17580000
205464                                 TO PT-TOTAL-MARKDOWN-QTY         17590000
205464                                                    (PV-TOT-SUB). 17600000
205464     MOVE PT-710-NORCPT-MKDN-AMT (PV-TOT-SUB)                     17610000
205464                                 TO DD-MARKDOWN-AMT               17620000
205464                                    DL-MARKDOWN-AMT.              17630000
205464     ADD PT-710-NORCPT-MKDN-AMT (PV-TOT-SUB)                      17640000
205464                                 TO PT-TOTAL-MARKDOWN-AMT         17650000
205464                                                    (PV-TOT-SUB). 17660000
205464     MOVE PT-710-NORCPT-MDC-QTY (PV-TOT-SUB)                      17670000
205464                                 TO DD-MARKDOWN-CANCEL-QTY        17680000
205464                                    DL-MARKDOWN-CANCEL-QTY.       17690000
205464     ADD PT-710-NORCPT-MDC-QTY (PV-TOT-SUB)                       17700000
205464                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  17710000
205464                                                    (PV-TOT-SUB). 17720000
205464     MOVE PT-710-NORCPT-MDC-AMT (PV-TOT-SUB)                      17730000
205464                                 TO DD-MARKDOWN-CANCEL-AMT        17740000
205464                                    DL-MARKDOWN-CANCEL-AMT.       17750000
205464     ADD PT-710-NORCPT-MDC-AMT (PV-TOT-SUB)                       17760000
205464                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  17770000
205464                                                    (PV-TOT-SUB). 17780000
205464     DISPLAY '  '  DD-DISPLAY-DETAIL.                             17790000
205464     MOVE PC-NON-REC-RETURN    TO DL-PRICE-CHANGE-TYPE.           17800000
205464     PERFORM 8200-WRITE-DETAIL-LINE.                              17810000
185600                                                                  17820000
185700     MOVE SPACES TO DD-DISPLAY-DETAIL.                            17830000
185800     SET DD-PC-GFT-RCPT-RTRN     TO TRUE.                         17840000
185900     MOVE PT-765-GIFT-MKDN-QTY (PV-TOT-SUB)                       17850000
186000                                 TO DD-MARKDOWN-QTY               17860000
186100                                    DL-MARKDOWN-QTY.              17870000
186200     ADD PT-765-GIFT-MKDN-QTY (PV-TOT-SUB)                        17880000
186300                                 TO PT-TOTAL-MARKDOWN-QTY         17890000
186400                                                    (PV-TOT-SUB). 17900000
186500     MOVE PT-765-GIFT-MKDN-AMT (PV-TOT-SUB)                       17910000
186600                                 TO DD-MARKDOWN-AMT               17920000
186700                                    DL-MARKDOWN-AMT.              17930000
186800     ADD PT-765-GIFT-MKDN-AMT (PV-TOT-SUB)                        17940000
186900                                 TO PT-TOTAL-MARKDOWN-AMT         17950000
187000                                                    (PV-TOT-SUB). 17960000
187100     MOVE PT-765-GIFT-MDC-QTY (PV-TOT-SUB)                        17970000
187200                                 TO DD-MARKDOWN-CANCEL-QTY        17980000
187300                                    DL-MARKDOWN-CANCEL-QTY.       17990000
187400     ADD PT-765-GIFT-MDC-QTY (PV-TOT-SUB)                         18000000
187500                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  18010000
187600                                                    (PV-TOT-SUB). 18020000
187700     MOVE PT-765-GIFT-MDC-AMT (PV-TOT-SUB)                        18030000
187800                                 TO DD-MARKDOWN-CANCEL-AMT        18040000
187900                                    DL-MARKDOWN-CANCEL-AMT.       18050000
188000     ADD PT-765-GIFT-MDC-AMT (PV-TOT-SUB)                         18060000
188100                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  18070000
188200                                                    (PV-TOT-SUB). 18080000
188300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             18090000
188400     MOVE PC-GIFT-RCPT-RETURN    TO DL-PRICE-CHANGE-TYPE.         18100000
188500     PERFORM 8200-WRITE-DETAIL-LINE.                              18110000
188600                                                                  18120000
188700     MOVE SPACES TO DD-DISPLAY-DETAIL.                            18130000
188800     SET DD-PC-BOGO              TO TRUE.                         18140000
188900     MOVE PT-BOGO-MKDN-QTY (PV-TOT-SUB)                           18150000
189000                                 TO DD-MARKDOWN-QTY               18160000
189100                                    DL-MARKDOWN-QTY.              18170000
189200     ADD PT-BOGO-MKDN-QTY (PV-TOT-SUB)                            18180000
189300                                 TO PT-TOTAL-MARKDOWN-QTY         18190000
189400                                                    (PV-TOT-SUB). 18200000
189500     MOVE PT-BOGO-MKDN-AMT (PV-TOT-SUB)                           18210000
189600                                 TO DD-MARKDOWN-AMT               18220000
189700                                    DL-MARKDOWN-AMT.              18230000
189800     ADD PT-BOGO-MKDN-AMT (PV-TOT-SUB)                            18240000
189900                                 TO PT-TOTAL-MARKDOWN-AMT         18250000
190000                                                    (PV-TOT-SUB). 18260000
190100     MOVE PT-BOGO-MDC-QTY (PV-TOT-SUB)                            18270000
190200                                 TO DD-MARKDOWN-CANCEL-QTY        18280000
190300                                    DL-MARKDOWN-CANCEL-QTY.       18290000
190400     ADD PT-BOGO-MDC-QTY (PV-TOT-SUB)                             18300000
190500                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  18310000
190600                                                    (PV-TOT-SUB). 18320000
190700     MOVE PT-BOGO-MDC-AMT (PV-TOT-SUB)                            18330000
190800                                 TO DD-MARKDOWN-CANCEL-AMT        18340000
190900                                    DL-MARKDOWN-CANCEL-AMT.       18350000
191000     ADD PT-BOGO-MDC-AMT (PV-TOT-SUB)                             18360000
191100                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  18370000
191200                                                    (PV-TOT-SUB). 18380000
191300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             18390000
191400     MOVE PC-BOGO                TO DL-PRICE-CHANGE-TYPE.         18400000
191500     PERFORM 8200-WRITE-DETAIL-LINE.                              18410000
191600                                                                  18420000
191700     MOVE SPACES TO DD-DISPLAY-DETAIL.                            18430000
191800     SET DD-PC-UNEARNED-REWARDS  TO TRUE.                         18440000
191900     MOVE PT-UNEARNED-RWDS-MKDN-QTY (PV-TOT-SUB)                  18450000
192000                                 TO DD-MARKDOWN-QTY               18460000
192100                                    DL-MARKDOWN-QTY.              18470000
192200     ADD PT-UNEARNED-RWDS-MKDN-QTY (PV-TOT-SUB)                   18480000
192300                                 TO PT-TOTAL-MARKDOWN-QTY         18490000
192400                                                    (PV-TOT-SUB). 18500000
192500     MOVE PT-UNEARNED-RWDS-MKDN-AMT (PV-TOT-SUB)                  18510000
192600                                 TO DD-MARKDOWN-AMT               18520000
192700                                    DL-MARKDOWN-AMT.              18530000
192800     ADD PT-UNEARNED-RWDS-MKDN-AMT (PV-TOT-SUB)                   18540000
192900                                 TO PT-TOTAL-MARKDOWN-AMT         18550000
193000                                                    (PV-TOT-SUB). 18560000
193100     MOVE PT-UNEARNED-RWDS-MDC-QTY (PV-TOT-SUB)                   18570000
193200                                 TO DD-MARKDOWN-CANCEL-QTY        18580000
193300                                    DL-MARKDOWN-CANCEL-QTY.       18590000
193400     ADD PT-UNEARNED-RWDS-MDC-QTY (PV-TOT-SUB)                    18600000
193500                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  18610000
193600                                                    (PV-TOT-SUB). 18620000
193700     MOVE PT-UNEARNED-RWDS-MDC-AMT (PV-TOT-SUB)                   18630000
193800                                 TO DD-MARKDOWN-CANCEL-AMT        18640000
193900                                    DL-MARKDOWN-CANCEL-AMT.       18650000
194000     ADD PT-UNEARNED-RWDS-MDC-AMT (PV-TOT-SUB)                    18660000
194100                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  18670000
194200                                                    (PV-TOT-SUB). 18680000
194300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             18690000
194400     MOVE PC-UNEARNED-REWARDS    TO DL-PRICE-CHANGE-TYPE.         18700000
194500     PERFORM 8200-WRITE-DETAIL-LINE.                              18710000
194600                                                                  18720000
194700                                                                  18730000
194800     MOVE SPACES TO DD-DISPLAY-DETAIL.                            18740000
194900     SET DD-PC-EMPLY-DISCOUNT    TO TRUE.                         18750000
195000     MOVE PT-EMPLY-DISC-MKDN-QTY (PV-TOT-SUB)                     18760000
195100                                 TO DD-MARKDOWN-QTY               18770000
195200                                    DL-MARKDOWN-QTY.              18780000
195300     ADD PT-EMPLY-DISC-MKDN-QTY (PV-TOT-SUB)                      18790000
195400                                 TO PT-TOTAL-MARKDOWN-QTY         18800000
195500                                                    (PV-TOT-SUB). 18810000
195600     MOVE PT-EMPLY-DISC-MKDN-AMT (PV-TOT-SUB)                     18820000
195700                                 TO DD-MARKDOWN-AMT               18830000
195800                                    DL-MARKDOWN-AMT.              18840000
195900     ADD PT-EMPLY-DISC-MKDN-AMT (PV-TOT-SUB)                      18850000
196000                                 TO PT-TOTAL-MARKDOWN-AMT         18860000
196100                                                    (PV-TOT-SUB). 18870000
196200     MOVE PT-EMPLY-DISC-MDC-QTY (PV-TOT-SUB)                      18880000
196300                                 TO DD-MARKDOWN-CANCEL-QTY        18890000
196400                                    DL-MARKDOWN-CANCEL-QTY.       18900000
196500     ADD PT-EMPLY-DISC-MDC-QTY (PV-TOT-SUB)                       18910000
196600                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  18920000
196700                                                    (PV-TOT-SUB). 18930000
196800     MOVE PT-EMPLY-DISC-MDC-AMT (PV-TOT-SUB)                      18940000
196900                                 TO DD-MARKDOWN-CANCEL-AMT        18950000
197000                                    DL-MARKDOWN-CANCEL-AMT.       18960000
197100     ADD PT-EMPLY-DISC-MDC-AMT (PV-TOT-SUB)                       18970000
197200                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  18980000
197300                                                    (PV-TOT-SUB). 18990000
197400     DISPLAY '  '  DD-DISPLAY-DETAIL.                             19000000
197500     MOVE PC-EMPLY-DISCOUNT      TO DL-PRICE-CHANGE-TYPE.         19010000
197600     PERFORM 8200-WRITE-DETAIL-LINE.                              19020000
197700                                                                  19030000
262807     MOVE SPACES TO DD-DISPLAY-DETAIL.                            19031034
262807     SET DD-PC-SEPHORA-DISCOUNT TO TRUE.                          19032034
262807     MOVE PT-720-SEPHORA-MKDN-QTY (PV-TOT-SUB)                    19033034
262807                                 TO DD-MARKDOWN-QTY               19034034
262807                                    DL-MARKDOWN-QTY.              19035034
262807     ADD PT-720-SEPHORA-MKDN-QTY (PV-TOT-SUB)                     19036034
262807                                 TO PT-TOTAL-MARKDOWN-QTY         19037034
262807                                                    (PV-TOT-SUB). 19038034
262807     MOVE PT-720-SEPHORA-MKDN-AMT (PV-TOT-SUB)                    19039034
262807                                 TO DD-MARKDOWN-AMT               19039134
262807                                    DL-MARKDOWN-AMT.              19039234
262807     ADD PT-720-SEPHORA-MKDN-AMT (PV-TOT-SUB)                     19039334
262807                                 TO PT-TOTAL-MARKDOWN-AMT         19039434
262807                                                    (PV-TOT-SUB). 19039534
262807     MOVE PT-720-SEPHORA-MDC-QTY (PV-TOT-SUB)                     19039634
262807                                 TO DD-MARKDOWN-CANCEL-QTY        19039734
262807                                    DL-MARKDOWN-CANCEL-QTY.       19039834
262807     ADD PT-720-SEPHORA-MDC-QTY (PV-TOT-SUB)                      19039934
262807                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  19040034
262807                                                    (PV-TOT-SUB). 19040134
262807     MOVE PT-720-SEPHORA-MDC-AMT (PV-TOT-SUB)                     19040234
262807                                 TO DD-MARKDOWN-CANCEL-AMT        19040334
262807                                    DL-MARKDOWN-CANCEL-AMT.       19040434
262807     ADD PT-720-SEPHORA-MDC-AMT (PV-TOT-SUB)                      19040534
262807                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  19040634
262807                                                    (PV-TOT-SUB). 19040734
262807     DISPLAY '  '  DD-DISPLAY-DETAIL.                             19040834
262807     MOVE PC-SEPHORA-DISCOUNT TO DL-PRICE-CHANGE-TYPE.            19040934
262807     PERFORM 8200-WRITE-DETAIL-LINE.                              19041034
262807                                                                  19041134
197900     DISPLAY ' '.                                                 19050000
198000     MOVE SPACES TO DD-DISPLAY-DETAIL.                            19060000
198100     SET DD-PC-TOTAL TO TRUE.                                     19070000
198200     MOVE PT-TOTAL-MARKDOWN-QTY (PV-TOT-SUB)                      19080000
198300                                 TO DD-MARKDOWN-QTY               19090000
198400                                    DL-MARKDOWN-QTY.              19100000
198500     MOVE PT-TOTAL-MARKDOWN-AMT (PV-TOT-SUB)                      19110000
198600                                 TO DD-MARKDOWN-AMT               19120000
198700                                    DL-MARKDOWN-AMT.              19130000
198800     MOVE PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB)               19140000
198900                                 TO DD-MARKDOWN-CANCEL-QTY        19150000
199000                                    DL-MARKDOWN-CANCEL-QTY.       19160000
199100     MOVE PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB)               19170000
199200                                 TO DD-MARKDOWN-CANCEL-AMT        19180000
199300                                    DL-MARKDOWN-CANCEL-AMT.       19190000
199400     MOVE PT-TOTAL-MARKUP-QTY (PV-TOT-SUB)                        19200000
199500                                 TO DD-MARKUP-QTY                 19210000
199600                                    DL-MARKUP-QTY.                19220000
199700     MOVE PT-TOTAL-MARKUP-AMT (PV-TOT-SUB)                        19230000
199800                                 TO DD-MARKUP-AMT                 19240000
199900                                    DL-MARKUP-AMT.                19250000
200000     MOVE PT-TOTAL-MARKUP-CANCEL-QTY (PV-TOT-SUB)                 19260000
200100                                 TO DD-MARKUP-CANCEL-QTY          19270000
200200                                    DL-MARKUP-CANCEL-QTY.         19280000
200300     MOVE PT-TOTAL-MARKUP-CANCEL-AMT (PV-TOT-SUB)                 19290000
200400                                 TO DD-MARKUP-CANCEL-AMT          19300000
200500                                    DL-MARKUP-CANCEL-AMT.         19310000
200600                                                                  19320000
200700     DISPLAY '  '  DD-DISPLAY-DETAIL.                             19330000
200800     MOVE PC-TOTAL TO DL-PRICE-CHANGE-TYPE.                       19340000
200900     PERFORM 8200-WRITE-DETAIL-LINE.                              19350000
201000                                                                  19360000
201100     DISPLAY '  '.                                                19370000
201200     SET TD-NON-OWNED-DROPPED-ID TO TRUE.                         19380000
201300     MOVE PT-NON-OWNED-DROPPED (PV-TOT-SUB) TO TD-TOTAL-AMOUNT.   19390000
201400     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       19400000
201500               TD-TOTAL-DISPLAY-MESSAGE.                          19410000
201600     PERFORM 8300-WRITE-NON-OWNED.                                19420000
201700                                                                  19430000
201800                                                                  19440000
201900******************************************************************19450000
202000 1800-PROCESS-INPUT.                                              19460000
202100*     PROCESS THE INPUT FILE.                                     19470000
202200******************************************************************19480000
202300                                                                  19490000
ZX         MOVE WS-CNTL-PRT TO WS-PRT.                                  19500000
202400     MOVE WS-CNTL-STR TO WS-STR.                                  19510000
ZX         MOVE WS-CNTL-REG TO WS-REG.                                  19520000
202500     MOVE WS-CNTL-TRN TO WS-TRN.                                  19530000
202600     MOVE WS-CNTL-SKU TO WS-SKU.                                  19540000
ZX    *    MOVE ZEROES      TO WS-CNTL-SKU                              19550000
ZX    *                        WS-SKU.                                  19560000
202700     DISPLAY '                '.                                  19570000
ZX         DISPLAY 'PROCESSING PRT: ' WS-PRT '  '                       19580000
ZX                            'STR: ' WS-STR '  '                       19590000
ZX                            'REG: ' WS-REG '  '                       19600000
202900                        'TRN: ' WS-TRN '  '                       19610000
203000                        'SKU: ' WS-SKU.                           19620000
203100                                                                  19630000
203200     SET PS-END-OF-TRAN-NO TO TRUE.                               19640000
203300                                                                  19650000
203400     PERFORM 2000-OPEN-TRAN-CURSOR.                               19660000
203500                                                                  19670000
203600     PERFORM 2200-FETCH-TRAN-CURSOR                               19680000
203700        UNTIL PS-END-OF-TRAN-YES.                                 19690000
203800                                                                  19700000
203900     PERFORM 2400-CLOSE-TRAN-CURSOR.                              19710000
204000                                                                  19720000
204100     MOVE 1 TO PV-TOT-SUB.                                        19730000
204200                                                                  19740000
204300     PERFORM 1500-PROCESS-PROGRAM-TOTALS                          19750031
LATES          VARYING PV-TOT-SUB FROM 1 BY 1                           19760031
LATES              UNTIL PV-TOT-SUB GREATER THAN 5.                     19770031
LATES *        VARYING PV-TOT-SUB FROM 1 BY 1                           19771031
LATES *            UNTIL PV-TOT-SUB GREATER THAN 5.                     19772031
204600                                                                  19780000
204700     PERFORM 7500-READ-CRITERIA.                                  19790000
204800                                                                  19800000
204900     IF PS-END-OF-CRIT-FILE                                       19810000
205000         CONTINUE                                                 19820000
205100     ELSE                                                         19830000
205200         INITIALIZE PT-PROGRAM-TOTALS                             19840000
205300         MOVE 1 TO PV-TOT-SUB                                     19850000
205400         MOVE CNTL-CARD TO HL-CRITERIA                            19860000
ZX             PERFORM 2451-SELECT-ORDER-NUMBER                         19870000
ZX             IF PS-ORDER-NUMBER-FOUND-N                               19880000
ZX                 MOVE SPACES           TO HL-ORDERNO                  19890000
ZX             ELSE                                                     19900000
ZX                 MOVE EPORD-ORD-NBR-TEXT                              19910000
ZX                                       TO HL-ORDERNO                  19920000
ZX             END-IF                                                   19930000
205500         PERFORM 8400-WRITE-HEADERS                               19940000
205600     END-IF.                                                      19950000
205700                                                                  19960000
205800******************************************************************19970000
205900 2000-OPEN-TRAN-CURSOR.                                           19980000
206000*     OPEN TRANSACTION CURSOR.                                    19990000
206100******************************************************************20000000
206200                                                                  20010000
206300     EXEC SQL                                                     20020000
206400          OPEN TEPTRN-CURSOR                                      20030000
206500     END-EXEC.                                                    20040000
206600                                                                  20050000
206700     EVALUATE TRUE                                                20060000
206800        WHEN SQLCODE = ZERO                                       20070000
206900           CONTINUE                                               20080000
207000        WHEN OTHER                                                20090000
207100           MOVE '2000-OPEN-TRAN-CURSOR'                           20100000
207200                                      TO PV-PARAGRAPH-NAME        20110000
186300           SET AC-DB2-ERROR           TO TRUE                     20120000
207300           PERFORM 9999-ABEND                                     20130000
207400     END-EVALUATE.                                                20140000
207500                                                                  20150000
207600******************************************************************20160000
207700 2200-FETCH-TRAN-CURSOR.                                          20170000
207800*     FETCH TRANSACTION CURSOR.                                   20180000
207900******************************************************************20190000
208000                                                                  20200000
208100     EXEC SQL                                                     20210000
208200         FETCH TEPTRN-CURSOR                                      20220000
208300          INTO :EPTRN-PARTN-NBR                                   20230000
208400              ,:EPTRN-STR-NBR                                     20240000
208500              ,:EPTRN-RGST-ID                                     20250000
208600              ,:EPTRN-TRN-NBR                                     20260000
208700              ,:EPTRN-STRT-TM                                     20270000
208800              ,:EPTRN-SLS-CORR-SEQ-NBR                            20280000
208900              ,:EPTRN-TRN-STAT-CDE                                20290000
209000              ,:EPTRN-SLS-DTE                                     20300000
ZX                  ,:EPTRN-TRN-DTE                                     20310000
209100              ,:EPTRN-POS-CPBL-LVL-NBR                            20320000
209200              ,:EPTRN-CRE-TMST                                    20330000
BOSSCL              ,:EPTRN-OMNI-CHNL-FFLMT-TYP-CDE                     20340000
BOSSCL               :PV-OMNI-CHNL-TYP-CDE-NULL-IND                     20350000
BOSSC2              ,:PV-TRANSFER-DATE                                  20360000
209400     END-EXEC.                                                    20370000
209500                                                                  20380000
209600     EVALUATE TRUE                                                20390000
209700        WHEN SQLCODE = ZERO                                       20400000
210800           ADD 1 TO WS-TRN-CNT                                    20410000
BOSSCL           IF PV-OMNI-CHNL-TYP-CDE-NULL-IND = -1                  20420000
BOSSCL              MOVE SPACES TO EPTRN-OMNI-CHNL-FFLMT-TYP-CDE        20430000
BOSSCL           END-IF                                                 20440000
211000           MOVE EPTRN-PARTN-NBR       TO  PV-PARTN-NBR            20450000
211100           MOVE EPTRN-STR-NBR         TO  PV-STR-NBR              20460000
211200           MOVE EPTRN-RGST-ID         TO  PV-RGST-ID              20470000
211300           MOVE EPTRN-TRN-NBR         TO  PV-TRN-NBR              20480000
211400           MOVE EPTRN-STRT-TM         TO  PV-STRT-TM              20490000
211500           MOVE EPTRN-SLS-CORR-SEQ-NBR                            20500000
211600                                      TO  PV-SLS-CORR-SEQ-NBR     20510000
211700           MOVE ZERO                  TO PV-FISC-PERIOD-NBR-HOLD  20520000
211800           PERFORM 1117-CALCU-KOHLS-MONTH                         20530000
211900                                                                  20540000
ZX               PERFORM 2450-SELECT-ORDER-NUMBER                       20550000
212600           IF  WS-CNTL-SKU = ZEROS                                20560000
212700               PERFORM 2500-OPEN-ITEM-CURSOR                      20570000
212800               PERFORM 2600-FETCH-ITEM-CURSOR                     20580000
212900                  UNTIL PS-END-OF-ITEM-YES                        20590000
213000               PERFORM 2700-CLOSE-ITEM-CURSOR                     20600000
213100           ELSE                                                   20610000
213200               PERFORM 2500-OPEN-ITEM-CURSORX                     20620000
213300               PERFORM 2600-FETCH-ITEM-CURSORX                    20630000
213400                  UNTIL PS-END-OF-ITEM-YES                        20640000
213500               PERFORM 2700-CLOSE-ITEM-CURSORX                    20650000
213600           END-IF                                                 20660000
213700           ADD 1                      TO WS-CMT-CNT               20670000
213800                                                                  20680000
213900        WHEN SQLCODE = PC-ROW-NOT-FOUND                           20690000
214000           SET PS-END-OF-TRAN-YES     TO TRUE                     20700000
214100           DISPLAY '                      '                       20710000
214200           DISPLAY '2200-FETCH-TRAN-CURSOR'                       20720000
214300           DISPLAY '** NOT FOUND **'                              20730000
214400           DISPLAY '   TRAN COUNT = ' WS-TRN-CNT                  20740000
214500           DISPLAY '         DATE = ' PV-RUN-DATE-CCYY-MM-DD      20750000
214600           DISPLAY '          STR = ' WS-STR                      20760000
ZX               DISPLAY '         RGST = ' WS-REG                      20770000
214800           DISPLAY '          TRN = ' WS-TRN                      20780000
ZX               DISPLAY '    CRI PARTN = ' WS-PRT                      20790000
214900           DISPLAY '    TEP PARTN = ' EPTRN-PARTN-NBR             20800000
ZX    *          DISPLAY '    PRT PARTN = ' EPPART-PARTN-NBR            20810000
215100           DISPLAY '    SLS CORR  = ' EPTRN-SLS-CORR-SEQ-NBR      20820000
215200           DISPLAY '                      '                       20830000
215300        WHEN OTHER                                                20840000
215400           MOVE '2200-FETCH-TRAN-CURSOR'                          20850000
215500                                      TO PV-PARAGRAPH-NAME        20860000
190700           SET AC-DB2-ERROR           TO TRUE                     20870000
215600           PERFORM 9999-ABEND                                     20880000
215700     END-EVALUATE.                                                20890000
ZX         IF WS-CMT-CNT > 2000                                         20900000
ZX    *      PERFORM 8999-COMMIT-PARA                                   20910000
ZX           MOVE ZEROS                         TO WS-CMT-CNT           20920000
ZX         END-IF.                                                      20930000
215800                                                                  20940000
215900                                                                  20950000
216000******************************************************************20960000
216100 2400-CLOSE-TRAN-CURSOR.                                          20970000
216200*     CLOSE TRANSACTION CURSOR.                                   20980000
216300******************************************************************20990000
216400                                                                  21000000
216500     EXEC SQL                                                     21010000
216600          CLOSE TEPTRN-CURSOR                                     21020000
216700     END-EXEC.                                                    21030000
216800                                                                  21040000
216900     EVALUATE TRUE                                                21050000
217000        WHEN SQLCODE = ZERO                                       21060000
217100           CONTINUE                                               21070000
217200        WHEN OTHER                                                21080000
217300           MOVE '2400-CLOSE-TRAN-CURSOR'                          21090000
217400                                      TO PV-PARAGRAPH-NAME        21100000
217500           PERFORM 9999-ABEND                                     21110000
217600     END-EVALUATE.                                                21120000
217700                                                                  21130000
ZX    ******************************************************************21140000
ZX     2450-SELECT-ORDER-NUMBER.                                        21150000
ZX    *     CHECK IF ORDER NUMBER FOUND                                 21160000
ZX    ******************************************************************21170000
ZX                                                                      21180000
ZX         SET PS-ORDER-NUMBER-FOUND-N TO TRUE.                         21190000
ZX                                                                      21200000
ZX         EXEC SQL                                                     21210000
ZX            SELECT  ORD_NBR                                           21220000
ZX              INTO :EPORD-ORD-NBR                                     21230000
ZX              FROM  TEPORD                                            21240000
ZX             WHERE  PARTN_NBR        = :PV-PARTN-NBR                  21250000
ZX               AND  STR_NBR          = :PV-STR-NBR                    21260000
ZX               AND  RGST_ID          = :PV-RGST-ID                    21270000
ZX               AND  TRN_NBR          = :PV-TRN-NBR                    21280000
ZX               AND  STRT_TM          = :PV-STRT-TM                    21290000
ZX               AND  SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           21300000
ZX                    WITH UR                                           21310000
ZX         END-EXEC.                                                    21320000
ZX                                                                      21330000
ZX         EVALUATE TRUE                                                21340000
ZX            WHEN SQLCODE = ZERO                                       21350000
ZX               SET PS-ORDER-NUMBER-FOUND-Y TO TRUE                    21360000
BOSSC3           MOVE EPORD-ORD-NBR-TEXT     TO WS-EPORD-ORD-NBR        21361008
BOSSC3           DISPLAY 'ORDER NBR = '         WS-EPORD-ORD-NBR        21370008
ZX            WHEN SQLCODE = PC-ROW-NOT-FOUND                           21380000
ZX               SET PS-ORDER-NUMBER-FOUND-N TO TRUE                    21390000
BOSSC3           DISPLAY 'ORDER NBR NOT FOUND'                          21391008
ZX            WHEN OTHER                                                21400000
ZX               MOVE '2450-SELECT-ORDER-NUMBER '                       21410000
ZX                                            TO PV-PARAGRAPH-NAME      21420000
ZX               SET AC-DB2-ERROR           TO TRUE                     21430000
ZX               PERFORM 9999-ABEND                                     21440000
ZX         END-EVALUATE.                                                21450000
ZX                                                                      21460000
ZX    ******************************************************************21470000
ZX     2451-SELECT-ORDER-NUMBER.                                        21480000
ZX    *     CHECK IF ORDER NUMBER FOUND                                 21490000
ZX    ******************************************************************21500000
ZX                                                                      21510000
ZX         SET PS-ORDER-NUMBER-FOUND-N TO TRUE.                         21520000
ZX                                                                      21530000
ZX         MOVE  WS-CNTL-PRT   TO PV-PARTN-NBR                          21540000
ZX         MOVE  WS-CNTL-STR   TO PV-STR-NBR                            21550000
ZX         MOVE  WS-CNTL-REG   TO PV-RGST-ID                            21560000
ZX         MOVE  WS-CNTL-TRN   TO PV-TRN-NBR                            21570000
ZX         EXEC SQL                                                     21580000
ZX            SELECT  ORD_NBR                                           21590000
ZX              INTO :EPORD-ORD-NBR                                     21600000
ZX              FROM  TEPORD                                            21610000
ZX             WHERE  PARTN_NBR        = :PV-PARTN-NBR                  21620000
ZX               AND  STR_NBR          = :PV-STR-NBR                    21630000
ZX               AND  RGST_ID          = :PV-RGST-ID                    21640000
ZX               AND  TRN_NBR          = :PV-TRN-NBR                    21650000
ZX                    WITH UR                                           21660000
ZX         END-EXEC.                                                    21670000
ZX                                                                      21680000
ZX         EVALUATE TRUE                                                21690000
ZX            WHEN SQLCODE = ZERO                                       21700000
ZX            WHEN SQLCODE = -811                                       21710000
ZX               SET PS-ORDER-NUMBER-FOUND-Y TO TRUE                    21720000
ZX               DISPLAY 'ORDERNO CHECK1'                               21730000
ZX            WHEN SQLCODE = PC-ROW-NOT-FOUND                           21740000
ZX               SET PS-ORDER-NUMBER-FOUND-N TO TRUE                    21750000
ZX            WHEN OTHER                                                21760000
ZX               MOVE '2451-SELECT-ORDER-NUMBER '                       21770000
ZX                                            TO PV-PARAGRAPH-NAME      21780000
ZX               SET AC-DB2-ERROR           TO TRUE                     21781000
ZX               PERFORM 9999-ABEND                                     21782000
ZX         END-EVALUATE.                                                21783000
ZX                                                                      21784000
217800******************************************************************21784100
217900 2500-OPEN-ITEM-CURSOR.                                           21784200
218000*     OPEN ITEM CURSOR.                                           21784300
218100******************************************************************21784400
218200                                                                  21784500
218300     EXEC SQL                                                     21784600
218400          OPEN TEPITM-CURSOR                                      21784700
218500     END-EXEC.                                                    21784800
218600                                                                  21784900
218700     EVALUATE TRUE                                                21785000
218800        WHEN SQLCODE = ZERO                                       21786000
218900           SET PS-END-OF-ITEM-NO      TO TRUE                     21787000
219000        WHEN OTHER                                                21788000
219100           MOVE '2500-OPEN-ITEM-CURSOR' TO PV-PARAGRAPH-NAME      21789000
219200           PERFORM 9999-ABEND                                     21790000
219300     END-EVALUATE.                                                21800000
219400                                                                  21810000
219500******************************************************************21820000
219600 2600-FETCH-ITEM-CURSOR.                                          21830000
219700*     FETCH ITEMS FROM TEPITM TABLE.                              21840000
219800******************************************************************21850000
219900                                                                  21860000
220000     EXEC SQL                                                     21870000
220100          FETCH TEPITM-CURSOR                                     21880000
220200           INTO :EPITM-LNE-ITM-SEQ-NBR                            21890000
220300               ,:EPITM-LIV-RSLU-CDE                               21900000
220400               ,:EPITM-DEPT-NBR                                   21910000
220500               ,:EPITM-SUB-CL-NBR                                 21920000
220600               ,:EPITM-SLD-QTY                                    21930000
220700               ,:EPITM-NET-CHRGD-AMT                              21940000
220800               ,:EPITM-SAL-TYP-CDE                                21950000
220900               ,:EPITM-SAL-RET-CDE                                21960000
221000               ,:EPITM-DEPT-CL-ERR-CDE                            21970000
221100               ,:EPITM-SKU-ERR-CDE                                21980000
221200               ,:EPITM-PRIC-SRC-CDE                               21990000
221300               ,:EPITM-CUST-CHRGD-AMT                             22000000
221400               ,:EPITM-REG-RTL-AMT                                22010000
221500               ,:EPITM-ADITEM-NBR                                 22020000
221600               ,:EPITM-UNT-COST-AMT                               22030000
221700               ,:EPITM-OWND-UNT-RTL-AMT                           22040000
221800               ,:EPITM-OWNSHP-CDE                                 22050000
221900               ,:EPITM-REG-RTL-ORGN-CDE                           22060000
222000               ,:EPITM-SKU-NBR                                    22070000
222100               ,:EPITM-MAJ-CL-NBR                                 22080000
222200               ,:EPITM-PROMO-INTFC-ID                             22090000
214615               ,:EPITM-PROMO-SCHM-CDE                             22100000
222300               ,:EPITM-OWND-UNT-RTL-ORIG-AMT                      22110000
222400                :PV-ORIG-OWND-UNT-AMT-NULL-IND                    22120000
222500               ,:EPITM-ITM-STAT-CDE                               22130000
214615               ,:EPITM-ORIG-SAL-TYP-CDE                           22140000
214615               ,:EPITM-ORIG-REG-RTL-AMT                           22150000
222600     END-EXEC.                                                    22160000
222700                                                                  22170000
222800     EVALUATE TRUE                                                22180000
222900        WHEN SQLCODE = ZERO                                       22190000
224500           PERFORM 2800-SCREEN-ITEM                               22200000
224600                                                                  22210000
224700        WHEN SQLCODE = PC-ROW-NOT-FOUND                           22220000
224800           SET PS-END-OF-ITEM-YES     TO TRUE                     22230000
224900                                                                  22240000
225000        WHEN OTHER                                                22250000
225100           MOVE '2600-FETCH-ITEM-CURSOR'                          22260000
225200                                      TO PV-PARAGRAPH-NAME        22270000
225300           PERFORM 9999-ABEND                                     22280000
225400     END-EVALUATE.                                                22290000
225500                                                                  22300000
225600******************************************************************22310000
225700 2700-CLOSE-ITEM-CURSOR.                                          22320000
225800*     CLOSE ITEM CURSOR.                                          22330000
225900******************************************************************22340000
226000                                                                  22350000
226100     EXEC SQL                                                     22360000
226200          CLOSE TEPITM-CURSOR                                     22370000
226300     END-EXEC.                                                    22380000
226400                                                                  22390000
226500     EVALUATE TRUE                                                22400000
226600        WHEN SQLCODE = ZERO                                       22410000
226700           CONTINUE                                               22420000
226800        WHEN OTHER                                                22430000
226900           MOVE '2700-CLOSE-ITEM-CURSOR'                          22440000
227000                                            TO PV-PARAGRAPH-NAME  22450000
227100           PERFORM 9999-ABEND                                     22460000
227200     END-EVALUATE.                                                22470000
227300                                                                  22480000
227400******************************************************************22490000
227500 2500-OPEN-ITEM-CURSORX.                                          22500000
ZX         DISPLAY 'PV-PARTN-NBR ' PV-PARTN-NBR                         22510000
ZX         DISPLAY 'PV-STR-NBR ' PV-STR-NBR                             22520000
ZX         DISPLAY 'PV-RGST-ID ' PV-RGST-ID                             22530000
ZX         DISPLAY 'PV-TRN-NBR ' PV-TRN-NBR                             22540000
ZX         DISPLAY 'PV-STRT-TM ' PV-STRT-TM                             22550000
ZX         DISPLAY 'WS-SKU ' WS-SKU.                                    22560000
228200                                                                  22570000
228300*     OPEN ITEM CURSOR.                                           22580000
228400******************************************************************22590000
228500                                                                  22600000
228600     EXEC SQL                                                     22610000
228700          OPEN TEPITM-CURSORX                                     22620000
228800     END-EXEC.                                                    22630000
228900                                                                  22640000
229000     EVALUATE TRUE                                                22650000
229100        WHEN SQLCODE = ZERO                                       22660000
229200           SET PS-END-OF-ITEM-NO      TO TRUE                     22670000
229300        WHEN OTHER                                                22680000
229400           MOVE '2500-OPEN-ITEM-CURSOR' TO PV-PARAGRAPH-NAME      22690000
229500           PERFORM 9999-ABEND                                     22700000
229600     END-EVALUATE.                                                22710000
229700                                                                  22720000
229800******************************************************************22730000
229900 2600-FETCH-ITEM-CURSORX.                                         22740000
230000*     FETCH ITEMS FROM TEPITM TABLE.                              22750000
230100******************************************************************22760000
230200                                                                  22770000
230300      DISPLAY '2600-FETCH-ITEM-CURSORX'.                          22780000
230400                                                                  22790000
230500     EXEC SQL                                                     22800000
230600          FETCH TEPITM-CURSORX                                    22810000
230700           INTO :EPITM-LNE-ITM-SEQ-NBR                            22820000
230800               ,:EPITM-LIV-RSLU-CDE                               22830000
230900               ,:EPITM-DEPT-NBR                                   22840000
231000               ,:EPITM-SUB-CL-NBR                                 22850000
231100               ,:EPITM-SLD-QTY                                    22860000
231200               ,:EPITM-NET-CHRGD-AMT                              22870000
231300               ,:EPITM-SAL-TYP-CDE                                22880000
231400               ,:EPITM-SAL-RET-CDE                                22890000
231500               ,:EPITM-DEPT-CL-ERR-CDE                            22900000
231600               ,:EPITM-SKU-ERR-CDE                                22910000
231700               ,:EPITM-PRIC-SRC-CDE                               22920000
231800               ,:EPITM-CUST-CHRGD-AMT                             22930000
231900               ,:EPITM-REG-RTL-AMT                                22940000
232000               ,:EPITM-ADITEM-NBR                                 22950000
232100               ,:EPITM-UNT-COST-AMT                               22960000
232200               ,:EPITM-OWND-UNT-RTL-AMT                           22970000
232300               ,:EPITM-OWNSHP-CDE                                 22980000
232400               ,:EPITM-REG-RTL-ORGN-CDE                           22990000
232500               ,:EPITM-SKU-NBR                                    23000000
232600               ,:EPITM-MAJ-CL-NBR                                 23010000
232700               ,:EPITM-PROMO-INTFC-ID                             23020000
214615               ,:EPITM-PROMO-SCHM-CDE                             23030000
232800               ,:EPITM-OWND-UNT-RTL-ORIG-AMT                      23040000
232900                :PV-ORIG-OWND-UNT-AMT-NULL-IND                    23050000
233000               ,:EPITM-ITM-STAT-CDE                               23060000
214615               ,:EPITM-ORIG-SAL-TYP-CDE                           23070000
214615               ,:EPITM-ORIG-REG-RTL-AMT                           23080000
233100     END-EXEC.                                                    23090000
233200                                                                  23100000
233300      DISPLAY '  SQLCODE       = ' SQLCODE.                       23110000
233400                                                                  23120000
233500     EVALUATE TRUE                                                23130000
233600        WHEN SQLCODE = ZERO                                       23140000
233700           PERFORM 2800-SCREEN-ITEM                               23150000
233800                                                                  23160000
233900        WHEN SQLCODE = PC-ROW-NOT-FOUND                           23170000
234000           SET PS-END-OF-ITEM-YES     TO TRUE                     23180000
234100                                                                  23190000
234200        WHEN OTHER                                                23200000
234300           MOVE '2600-FETCH-ITEM-CURSOR'                          23210000
234400                                      TO PV-PARAGRAPH-NAME        23220000
234500           PERFORM 9999-ABEND                                     23230000
234600     END-EVALUATE.                                                23240000
234700                                                                  23250000
234800******************************************************************23260000
234900 2700-CLOSE-ITEM-CURSORX.                                         23270000
235000*     CLOSE ITEM CURSOR.                                          23280000
235100******************************************************************23290000
235200                                                                  23300000
235300     EXEC SQL                                                     23310000
235400          CLOSE TEPITM-CURSORX                                    23320000
235500     END-EXEC.                                                    23330000
235600                                                                  23340000
235700     EVALUATE TRUE                                                23350000
235800        WHEN SQLCODE = ZERO                                       23360000
235900           CONTINUE                                               23370000
236000        WHEN OTHER                                                23380000
236100           MOVE '2700-CLOSE-ITEM-CURSOR'                          23390000
236200                                            TO PV-PARAGRAPH-NAME  23400000
236300           PERFORM 9999-ABEND                                     23410000
236400     END-EVALUATE.                                                23420000
236500                                                                  23430000
236600******************************************************************23440000
236700 2800-SCREEN-ITEM.                                                23450000
236800*     FILTER ITEMS. EXCLUDE SALES CORRECTIONS, EVEN EXCHANGES,    23460000
236900*     RESOLVED LINE ITEM VOIDS, AND OLDSTAR ITEMS.                23470000
237000******************************************************************23480000
237100                                                                  23490000
237800     INITIALIZE ML017-PRICE-CHANGE-RECORD.                        23500000
237900                                                                  23510000
238000     MOVE EPITM-LNE-ITM-SEQ-NBR TO   PV-LNE-ITM-SEQ-NBR.          23520000
238100                                                                  23530000
238200     EVALUATE TRUE                                                23540000
238300        WHEN EPITM-LIV-RSLU-CDE = PC-RSLV-ORIGINAL                23550000
238400        WHEN EPITM-LIV-RSLU-CDE = PC-RSLV-VOID                    23560000
238500        WHEN EPITM-DEPT-NBR = PC-GIFT-CARD                        23570000
SEPHOR        WHEN EPITM-DEPT-NBR = PC-SEPHORA-GIFT-CARD-712            23571035
238600        WHEN EPITM-DEPT-NBR = PC-THIRD-PARTY-CARD-833             23580000
238700        WHEN EPITM-DEPT-NBR = PC-THIRD-PARTY-CARD-834             23590000
MKTPLC        WHEN EPITM-DEPT-NBR = PC-MKTPLACE-DEPT-985                23600000
238900           CONTINUE                                               23610000
239000        WHEN EPITM-OWNSHP-CDE = PC-NON-OWNED                      23620000
239100        WHEN EPITM-OWNSHP-CDE = PC-NON-OWNED-TRACKED              23630000
ZX               IF EPTRN-TRN-STAT-CDE = PC-CORRECTION                  23640000
ZX                  IF DPG55-DB2-ISO-DATE-FMT LESS THAN                 23650000
ZX                     PV-CUT-OFF-CCYY-MM-DD                            23660000
ZX                     MOVE 4  TO PV-TOT-SUB                            23670000
ZX                  ELSE                                                23680000
ZX                     MOVE 2  TO PV-TOT-SUB                            23690000
ZX                  END-IF                                              23700000
ZX               END-IF                                                 23710000
ZX               IF EPTRN-TRN-STAT-CDE = PC-LATE                        23720000
ZX                  IF DPG55-DB2-ISO-DATE-FMT LESS THAN                 23730000
ZX                     PV-CUT-OFF-CCYY-MM-DD                            23740000
ZX                     MOVE 5  TO PV-TOT-SUB                            23750000
ZX                  ELSE                                                23760000
ZX                     MOVE 3  TO PV-TOT-SUB                            23770000
ZX                  END-IF                                              23780000
ZX               END-IF                                                 23790000
240800           IF DPG55-DB2-ISO-DATE-FMT NOT LESS THAN                23800000
240900              PV-CUT-OFF-CCYY-MM-DD                               23810000
241000              MOVE 1  TO PV-TOT-SUB                               23820000
241100           END-IF                                                 23830000
241200           ADD +1 TO PT-NON-OWNED-DROPPED (PV-TOT-SUB)            23840000
241300        WHEN OTHER                                                23850000
241400           IF (EPITM-NET-CHRGD-AMT > ZERO AND                     23860000
241500               EPITM-CUST-CHRGD-AMT < ZERO) OR                    23870000
241600              (EPITM-NET-CHRGD-AMT < ZERO AND                     23880000
241700               EPITM-CUST-CHRGD-AMT > ZERO)                       23890000
241800               DISPLAY 'TRANSACTION WITH OPPOSING SIGNS DETECTED' 23900000
241900               DISPLAY ' PARTN   ' EPTRN-PARTN-NBR                23910000
242000                       ' STORE   ' EPTRN-STR-NBR                  23920000
242100                       ' RGST    ' EPTRN-RGST-ID                  23930000
242200                       ' TRAN    ' EPTRN-TRN-NBR                  23940000
242300                       ' ITEM #  ' EPITM-LNE-ITM-SEQ-NBR          23950000
242400           ELSE                                                   23960000
242500              PERFORM 2900-PROCESS-ITEM                           23970000
242600           END-IF                                                 23980000
242700     END-EVALUATE.                                                23990000
242800                                                                  24000000
242900******************************************************************24010000
243000 2900-PROCESS-ITEM.                                               24020000
243100*    DIRECT THE FLOW OF AN ITEM.                                  24030000
BOSSC2*                                                                 24040000
BOSSC2*    IF THE ITEM IS FOR A BOSS ORDER AND THERE WAS A PRICE CHANGE 24050000
BOSSC2*    - GET ECOM'S ACTIVE PRICE ON THE ECOM ORDER DATE AND         24060000
BOSSC2*    THE TRANSFER DATE.   IF THERE IS A DIFFERENCE, CALCULATE     24070000
BOSSC2*    AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE.                  24080000
BOSSC2*                                                                 24090000
BOSSC2*    IF THE ITEM IS FOR AN SFS OR BOPUS ORDER THAT WAS NOT ON     24100000
BOSSC2*    CLEARANCE AND THERE WAS A PRICE CHANGE -                     24110000
BOSSC2*    CALCULATE AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE         24120000
BOSSC2*    BETWEEN ECOM'S ACTIVE PRICE ON THE ECOM ORDER DATE AND       24121000
BOSSC2*    THE STORE PRICE ON THE SALES DATE.                           24122000
BOSSCL*                                                                 24123000
BOSSCL*    THEN RESET THE STORE'S OWNED UNIT RTL WITH THE ECOM ORIGINAL 24124000
BOSSCL*    OWNED UNIT RTL AMT SO THAT THE ITEM CAN PROCEED THROUGH THE  24125000
BOSSCL*    REST OF THE LOGIC THAT CALCULATES PROMO MARKDOWNS.           24126000
243200******************************************************************24127000
243300                                                                  24128000
243400     PERFORM 3000-POPULATE-MISC-FIELDS.                           24129000
BOSSC2*    FUTURE CHANGE?                                               24130000
BOSSC2*    BOS WILL EXECUTE A NEW PARA (2960-) THAT WILL LOOK AT THE    24140000
BOSSC2*    SAT_BOSS_TRANSFERS TABLE TO GET THE TRANSFER DATE AND PRICE. 24150000
BOSSC2*    THIS WILL REQUIRE A SELECT OF THE TEPORD TABLE FOR THE ORDER 24160000
BOSSC2*    NUMBER.                                                      24170000
BOSSC2*    IF THE ORIGINAL ORDER PRICE (EPITM-OWND-UNT-RTL-ORIG-AMT)    24180000
BOSSC2*    AND TRANSFER PRICE ARE DIFFERENT, CREATE AN OWNERSHIP        24190000
BOSSC2*    ADJUSTMENT.  MAY HAVE TO USE CUST-CHRGD-AMT INSTEAD OF       24191000
BOSSC2*    EPITM-OWND-UNT-RTL-ORIG-AMT ON CLEARANCE ITEMS?              24192000
BOSSC2*    STORE PRICES NOT NEEDED AS DESCRIBED BELOW?                  24193000
BOSSC2*    THEN EXECUTE A PARAGRAPH SIMILAR TO 2940- (OR 2940?) LOOKING 24194000
BOSSC2*    FOR STORE PRICE CHANGES BETWEEN THE TRANSFER AND SALE DATES  24195000
BOSSC2*    AND CREATING OWNERSHIP ADJUSTMENTS FOR THEM??                24196000
BOSSC2*    THIS MEANS THAT BOS ORDERS COULD RESULT IN 2 OWNERSHIP       24197000
BOSSC2*    ADJUSTMENTS - ONE ON THE ECOM SIDE AND ONE ON THE STORE SIDE.24198000
243300                                                                  24199000
BOSSC3     IF  (PV-ORIG-OWND-UNT-AMT-NULL-IND IS NOT = PC-NULL)         24201015
BOSSC3     AND (EPITM-SAL-RET-CDE = 'S'  OR  EPITM-SAL-RET-CDE = 'A')   24202015
BOSSC2         IF (EPTRN-OMNI-CHNL-FFLMT-TYP-CDE = 'BOS')               24210000
BOSSC2         OR ((EPTRN-OMNI-CHNL-FFLMT-TYP-CDE = 'BPS' OR 'SFS') AND 24211000
BOSSC2              EPITM-ITM-STAT-CDE IS NOT = '30')                   24212000
BOSSC2             PERFORM 2910-OMNI-OWNERSHIP-ADJ                      24213000
BOSSCL                                                                  24214000
BOSSCL* AFTER OWNERSHIP ADJ IS GENERATED, FLIP THE RETAIL AMOUNT AND    24215000
BOSSCL* ORIGINAL RETAIL AMOUNTS FOR THE REST OF THE PROCESSING.         24216000
BOSSCL* ALSO NEED TO SET ML017-PC-DIFFER-AMT TO ZEROES OR IT WILL       24217000
BOSSCL* BE PICKED UP BY PARA 4000- BELOW.                               24218000
BOSSCL* SHOULD NULL IND BE SET?                                         24219000
BOSSCL*            MOVE PC-NULL TO PV-ORIG-OWND-UNT-AMT-NULL-IND        24220000
BOSSCL             MOVE EPITM-OWND-UNT-RTL-ORIG-AMT  TO                 24230000
BOSSCL                  PV-OWND-UNT-RTL-ORIG-AMT                        24240000
BOSSCL             MOVE EPITM-OWND-UNT-RTL-AMT       TO                 24250000
BOSSCL                  EPITM-OWND-UNT-RTL-ORIG-AMT                     24260000
BOSSCL             MOVE PV-OWND-UNT-RTL-ORIG-AMT     TO                 24270000
BOSSCL                  EPITM-OWND-UNT-RTL-AMT                          24280000
BOSSCL             MOVE ZEROES  TO  ML017-PC-DIFFER-AMT                 24290000
BOSSCL                                                                  24300000
BOSSC2         END-IF                                                   24310000
BOSSCL     END-IF.                                                      24320000
BOSSC3                                                                  24321010
BOSSC3**   TEMP OVERRIDE  TO TEST BOS AUTO RETURN - MULTIPLE SKUS       24322020
BOSSC3     IF  PV-PARTN-NBR = 106 AND PV-STR-NBR = 1418 AND             24323020
BOSSC3         PV-RGST-ID = 90    AND PV-TRN-NBR = 8571                 24324020
BOSSC3         AND PV-LNE-ITM-SEQ-NBR = 1                               24325020
BOSSC3*        SKU 61954007                                             24325120
BOSSC3         MOVE 'P'          TO EPITM-ORIG-SAL-TYP-CDE              24325220
BOSSC3         MOVE 3458806444   TO EPITM-PROMO-INTFC-ID                24325320
BOSSC3         MOVE 200          TO EPITM-PROMO-SCHM-CDE                24325420
BOSSC3         MOVE 16.19        TO EPITM-REG-RTL-AMT                   24325520
BOSSC3                              EPITM-OWND-UNT-RTL-AMT              24325620
BOSSC3         MOVE 35.99        TO EPITM-ORIG-REG-RTL-AMT              24325720
BOSSC4*        THIS EXAMPLE WORKS WITH OR WITHOUT THE FOLLOWING LINE    24325826
BOSSC4*                             EPITM-OWND-UNT-RTL-ORIG-AMT         24325926
BOSSC3     END-IF.                                                      24326020
BOSSC3**   TEMP OVERRIDE TO TEST BOS RETURN FROM PROD                   24326116
BOSSC3     IF  PV-PARTN-NBR = 106 AND PV-STR-NBR = 397 AND              24327019
BOSSC3         PV-RGST-ID = 25    AND PV-TRN-NBR = 6277                 24328019
BOSSC3         MOVE 50.00        TO EPITM-ORIG-REG-RTL-AMT              24329019
BOSSC4*        THIS EXAMPLE WORKS WITH OR WITHOUT THE FOLLOWING LINE    24329127
BOSSC4*        MOVE 50.00        TO EPITM-OWND-UNT-RTL-ORIG-AMT         24329326
BOSSC3     END-IF.                                                      24329419
BOSSC3**   TEMP OVERRIDE TO TEST BOS RETURN FROM PROD                   24329519
BOSSC3     IF  PV-PARTN-NBR = 466 AND PV-STR-NBR = 355 AND              24329619
BOSSC3         PV-RGST-ID = 27    AND PV-TRN-NBR = 5965                 24329719
BOSSC3         MOVE 64.00        TO EPITM-ORIG-REG-RTL-AMT              24329819
BOSSC3     END-IF.                                                      24329919
BOSSC3**   TEMP OVERRIDE TO TEST SFS RETURN FROM PROD                   24330019
BOSSC3     IF  PV-PARTN-NBR = 466 AND PV-STR-NBR = 31  AND              24330119
BOSSC3         PV-RGST-ID = 25    AND PV-TRN-NBR = 8663                 24330219
BOSSC3         MOVE 40.00        TO EPITM-ORIG-REG-RTL-AMT              24330319
BOSSC3     END-IF.                                                      24330419
BOSSC3**   TEMP OVERRIDE TO TEST SFS RETURN FROM PROD                   24330532
BOSSC3     IF  PV-PARTN-NBR = 311 AND PV-STR-NBR = 640  AND             24330632
BOSSC3         PV-RGST-ID = 26    AND PV-TRN-NBR = 5509                 24330732
BOSSC3         MOVE 48.00        TO EPITM-ORIG-REG-RTL-AMT              24330832
BOSSC3     END-IF.                                                      24330932
BOSSC3**   TEMP OVERRIDE TO TEST BOS RETURN                             24331032
BOSSC3     IF  PV-PARTN-NBR = 103 AND PV-STR-NBR = 39 AND               24331132
BOSSC3         PV-RGST-ID = 13    AND PV-TRN-NBR = 980                  24331232
BOSSC3         MOVE 45.00        TO EPITM-ORIG-REG-RTL-AMT              24331332
BOSSC3     END-IF.                                                      24331432
BOSSC3**   TEMP OVERRIDE  TO TEST BOS AUTO RETURN                       24331532
BOSSC3     IF  PV-PARTN-NBR = 109 AND PV-STR-NBR = 39 AND               24331632
BOSSC3         PV-RGST-ID = 93    AND PV-TRN-NBR = 1980                 24331732
BOSSC3         MOVE 'P'          TO EPITM-ORIG-SAL-TYP-CDE              24331832
BOSSC3         MOVE 3452456990   TO EPITM-PROMO-INTFC-ID                24331932
BOSSC3         MOVE 200          TO EPITM-PROMO-SCHM-CDE                24332032
BOSSC3     END-IF.                                                      24332132
BOSSC3**   TEMP OVERRIDE  TO TEST BOS AUTO RETURN - MULTIPLE SKUS       24332232
BOSSC3     IF  PV-PARTN-NBR = 109 AND PV-STR-NBR = 39 AND               24332332
BOSSC3         PV-RGST-ID = 93    AND PV-TRN-NBR = 8343                 24332432
BOSSC3         AND PV-LNE-ITM-SEQ-NBR = 1                               24332532
BOSSC3*        SKU 74020254                                             24332632
BOSSC3         MOVE 'P'          TO EPITM-ORIG-SAL-TYP-CDE              24332732
BOSSC3         MOVE 3451748899   TO EPITM-PROMO-INTFC-ID                24332832
BOSSC3         MOVE 100          TO EPITM-PROMO-SCHM-CDE                24332932
BOSSC3         MOVE 23.99        TO EPITM-REG-RTL-AMT                   24333032
BOSSC3                              EPITM-OWND-UNT-RTL-AMT              24333132
BOSSC3         MOVE 59.99        TO EPITM-ORIG-REG-RTL-AMT              24333232
BOSSC3     END-IF.                                                      24333332
BOSSC3     IF  PV-PARTN-NBR = 109 AND PV-STR-NBR = 39 AND               24333432
BOSSC3         PV-RGST-ID = 93 AND PV-TRN-NBR = 8343                    24333532
BOSSC3         AND PV-LNE-ITM-SEQ-NBR = 2                               24333632
BOSSC3*        SKU 48953241                                             24333732
BOSSC3         MOVE 'P'          TO EPITM-ORIG-SAL-TYP-CDE              24333832
BOSSC3         MOVE 3472614090   TO EPITM-PROMO-INTFC-ID                24333932
BOSSC3         MOVE 100          TO EPITM-PROMO-SCHM-CDE                24334032
BOSSC3         MOVE 18.00        TO EPITM-REG-RTL-AMT                   24334132
BOSSC3                              EPITM-OWND-UNT-RTL-AMT              24334232
BOSSC3         MOVE 45.00        TO EPITM-ORIG-REG-RTL-AMT              24334332
BOSSC3     END-IF.                                                      24334432
BOSSC3     IF  PV-PARTN-NBR = 109 AND PV-STR-NBR = 39 AND               24334532
BOSSC3         PV-RGST-ID = 93 AND PV-TRN-NBR = 8343                    24334632
BOSSC3         AND PV-LNE-ITM-SEQ-NBR = 3                               24334732
BOSSC3*        SKU 91354491                                             24334832
BOSSC3         MOVE 'P'          TO EPITM-ORIG-SAL-TYP-CDE              24334932
BOSSC3         MOVE 3452844891   TO EPITM-PROMO-INTFC-ID                24335032
BOSSC3         MOVE 100          TO EPITM-PROMO-SCHM-CDE                24335132
BOSSC3     END-IF.                                                      24335232
243500                                                                  24336032
243600     PERFORM 3001-CHECK-DISCOUNT.                                 24340000
243700                                                                  24341000
243800     MOVE ZERO                        TO PV-CUST-CHRGD-AMT        24342000
243900                                         PV-EXTENDED-AMT          24343000
244000                                         PV-EXCLUDE-LID-AMT       24343100
244100                                         PV-PRICE-CHANGE-AMOUNT.  24343200
244200     MOVE EPITM-CUST-CHRGD-AMT        TO PV-CUST-CHRGD-AMT.       24343300
244300                                                                  24343400
245500     IF EPITM-SAL-TYP-CDE = PC-GOLDSTAR-G OR                      24343500
245600        EPTRN-TRN-STAT-CDE = PC-CORRECTION OR                     24343600
245700        EPTRN-TRN-STAT-CDE = PC-REVERSAL                          24343700
245800                                                                  24343800
246000        PERFORM 4100-OPEN-LID-CURSOR                              24343900
246100        PERFORM 4200-FETCH-LID-CURSOR                             24344000
246200           UNTIL PS-END-OF-LID-YES                                24345000
246300        PERFORM 4300-CLOSE-LID-CURSOR                             24346000
246400                                                                  24347000
246500* PROCESS MARKDOWNS FOR SALE CORRECTIONS BYPASS DUMMY SKUS        24348000
246600        MOVE EPITM-CUST-CHRGD-AMT TO PV-ITM-CUST-CHRGD-AMT        24349000
246700        MOVE EPITM-REG-RTL-AMT    TO PV-ITM-REG-RTL-AMT           24350000
246800                                                                  24360000
246900        IF EPTRN-TRN-STAT-CDE = PC-CORRECTION                     24370000
247000           IF PV-SKU-LST-3-DGT NOT = '000'                        24380000
247100              IF PV-ITM-CUST-CHRGD-AMT NOT = PV-ITM-REG-RTL-AMT   24390000
247200                 IF (EPITM-SAL-RET-CDE = 'S'                      24400000
247300                 OR  EPITM-SAL-RET-CDE = 'A')                     24410000
247400                     PERFORM 3950-SALE-CORRECTION-MARKDOWN        24420000
247500                 ELSE                                             24430000
247600                     PERFORM 3650-MARKDOWN-CORR-CANCEL            24440000
247700                 END-IF                                           24450000
247800              END-IF                                              24460000
247900           END-IF                                                 24470000
248000        END-IF                                                    24480000
248100                                                                  24490000
248200     ELSE                                                         24500000
248300        IF EPITM-SAL-RET-CDE = 'R' OR                             24510000
248400           EPITM-SAL-RET-CDE = 'B'                                24520000
248500                                                                  24530000
248600              PERFORM 3100-RETURN-ITEM-MARKDOWN                   24540000
BOSSCL          DISPLAY 'CALLING PARA 4000- 1 = ' ML017-PC-DIFFER-AMT   24550000
248700              PERFORM 4000-PROCESS-MARKDOWN-MARKUP                24560000
248900              PERFORM 4100-OPEN-LID-CURSOR                        24570000
249000              PERFORM 4200-FETCH-LID-CURSOR                       24580000
249100                 UNTIL PS-END-OF-LID-YES                          24590000
249200              PERFORM 4300-CLOSE-LID-CURSOR                       24600000
249300        END-IF                                                    24610000
249400                                                                  24620000
249500        IF (EPITM-SAL-RET-CDE = 'S' OR                            24630000
249600            EPITM-SAL-RET-CDE = 'A') AND                          24640000
249700            EPITM-LIV-RSLU-CDE = '-'                              24650000
249800                                                                  24660000
250400            PERFORM 3300-CALC-EXTENDED-AMT                        24670000
BOSSCL            DISPLAY 'PV-CUST-CHRGD-AMT = ' PV-CUST-CHRGD-AMT      24680000
BOSSCL            DISPLAY 'PV-EXTENDED-AMT   = ' PV-EXTENDED-AMT        24690000
250500                                                                  24700000
251300            IF PV-CUST-CHRGD-AMT > PV-EXTENDED-AMT                24710000
251400******* THIS IF STATEMENT IS ADDED TO AVOID "ZERO COST" ITEMS     24720000
251500******* BEING PROCESSED AS MARKUPS.                               24730000
251600               IF EPITM-REG-RTL-AMT NOT EQUAL ZERO AND            24740000
251700                  EPITM-OWND-UNT-RTL-AMT NOT EQUAL ZERO           24750000
MUCFIX                  DISPLAY 'PERFORMING 3400- WITH RSLU - '         24751023
251800                  PERFORM 3400-MARKUP-CANCEL                      24760000
251900               END-IF                                             24770000
252000            ELSE                                                  24780000
252100               IF PV-CUST-CHRGD-AMT < PV-EXTENDED-AMT             24790000
252200                  IF EPITM-PROMO-INTFC-ID NOT = ZERO              24800000
ZX                      OR EPITM-PROMO-SCHM-CDE NOT = ZERO              24810000
252300                     PERFORM 3500-PROMO-MARKDOWN-CANCEL           24820000
252400                  ELSE                                            24830000
252500                     PERFORM 3600-MARKDOWN-CANCEL                 24840000
252600                  END-IF                                          24850000
252700               END-IF                                             24860000
252800            END-IF                                                24870000
252900                                                                  24880000
253000            PERFORM 4000-PROCESS-MARKDOWN-MARKUP                  24890000
253100                                                                  24900000
253300            PERFORM 4100-OPEN-LID-CURSOR                          24910000
253400            PERFORM 4200-FETCH-LID-CURSOR                         24920000
253500               UNTIL PS-END-OF-LID-YES                            24930000
253600            PERFORM 4300-CLOSE-LID-CURSOR                         24940000
253700        END-IF                                                    24950000
253800                                                                  24960000
253900        IF (EPITM-SAL-RET-CDE = 'S' OR                            24970000
254000            EPITM-SAL-RET-CDE = 'A') AND                          24980000
254100            EPITM-LIV-RSLU-CDE = '+'                              24990000
254200                                                                  25000000
254800            PERFORM 3300-CALC-EXTENDED-AMT                        25010000
254900                                                                  25020000
255700            IF PV-CUST-CHRGD-AMT > PV-EXTENDED-AMT                25030000
255800******* THIS IF STATEMENT IS ADDED TO AVOID "ZERO COST" ITEMS     25040000
255900******* BEING PROCESSED AS MARKUPS.                               25050000
256000               IF EPITM-REG-RTL-AMT NOT EQUAL ZERO AND            25060000
256100                  EPITM-OWND-UNT-RTL-AMT NOT EQUAL ZERO           25070000
256200                  IF PV-ORIG-OWND-UNT-AMT-NULL-IND = PC-NULL      25080000
256300                      PERFORM 3700-SALE-MARKUP                    25090000
256400                  ELSE                                            25100000
256500                      PERFORM 3600-MARKDOWN-CANCEL                25110000
256600                  END-IF                                          25120000
256700               END-IF                                             25130000
256800            ELSE                                                  25140000
256900               IF PV-CUST-CHRGD-AMT < PV-EXTENDED-AMT             25150000
257000                  IF EPITM-PROMO-INTFC-ID NOT = ZERO              25160000
ZX                      OR EPITM-PROMO-SCHM-CDE NOT = ZERO              25170000
257100                     PERFORM 3800-PROMO-MARKDOWN                  25180000
257200                  ELSE                                            25190000
257300                     IF PV-ORIG-OWND-UNT-AMT-NULL-IND = PC-NULL   25200000
257400                     OR EPITM-ITM-STAT-CDE = '30'                 25210000
257500                        PERFORM 3900-SALE-MARKDOWN                25220000
257600                     ELSE                                         25230000
MUCFIX                        DISPLAY 'PERFORMING 3400- WITH RSLU + '   25231023
257700                        PERFORM 3400-MARKUP-CANCEL                25240000
257800                     END-IF                                       25250000
257900                  END-IF                                          25260000
258000               END-IF                                             25270000
258100            END-IF                                                25280000
258200                                                                  25290000
258300            PERFORM 4000-PROCESS-MARKDOWN-MARKUP                  25300000
258400                                                                  25310000
258600            PERFORM 4100-OPEN-LID-CURSOR                          25320000
258700            PERFORM 4200-FETCH-LID-CURSOR                         25330000
258800               UNTIL PS-END-OF-LID-YES                            25340000
258900            PERFORM 4300-CLOSE-LID-CURSOR                         25350000
259000        END-IF                                                    25360000
259100     END-IF.                                                      25370000
259200                                                                  25380000
BOSSC2******************************************************************25390000
BOSSC2 2910-OMNI-OWNERSHIP-ADJ.                                         25400000
BOSSC2*    REQUIRED WHEN AN OMNI ORDER IS BEING PROCESSED.              25410000
BOSSC2*                                                                 25420000
BOSSC2*    BOSS ORDERS ARE TREATED DIFFERENTLY BECAUSE THEY INVOLVE     25430000
BOSSC2*    INVENTORY TRANSFERS FROM ECOM TO THE STORE.  SINCE THE       25440000
BOSSC2*    CUSTOMER WILL PAY THE STORE THE ECOM PRICE THEY DO NOT       25450000
BOSSC2*    NEED TO ACCOUNT FOR PRICE DIFFERENCES BETWEEN ECOM AND THE   25451000
BOSSC2*    STORE.  THEY ARE CONCERNED ABOUT PRICE CHANGES AT ECOM       25452000
BOSSC2*    BETWEEN THE ORDER DATE AND TRANSFER DATE BECAUSE THE STORE   25453000
BOSSC2*    WILL RECEIVE THE INVENTORY AT THE ECOM PRICE ON THE TRANSFER 25454000
BOSSC2*    DATE.  THESE PRICE CHANGES WILL NEED AN OWNERSHIP ADJUSTMENT 25455000
BOSSC2*    TO BE GENERATED FOR THE STORE.                               25456000
BOSSC2*                                                                 25457000
BOSSC2*    SFS AND BOPUS ORDERS DO NOT INVOLVE INVENTORY TRANSFERS TO   25458000
BOSSC2*    THE STORE.  THEY ARE NOT CONCERNED WITH PRICE CHANGES AT THE 25459000
BOSSC2*    STORE, BUT DO NEED AN OWNERSHIP ADJUSTMENT TO ACCOUNT FOR    25459100
BOSSC2*    PRICE DIFFERENCES BETWEEN ECOM AND THE STORE SINCE THE       25459200
BOSSC2*    CUSTOMER WILL PAY THE STORE THE ECOM PRICE.                  25459300
BOSSC2*                                                                 25459400
BOSSC2*    FOLLOWING TO CHANGE WHEN SAT_BOSS_TRANSFERS TABLE AVAILABLE. 25459500
BOSSC2*    CHECK FOR ECOM PRICE FIRST                                   25459600
BOSSC2*    IF ECOM PRICE NOT FOUND, CHECK FOR CORP PRICE (LOC ZERO)     25459700
BOSSC2******************************************************************25459800
BOSSC2     DISPLAY 'OMNI PRICE CHG LOGIC HIT FOR : ' PV-PARTN-NBR       25459900
BOSSC2             ' ' PV-STR-NBR ' ' PV-RGST-ID ' ' PV-TRN-NBR         25460000
BOSSC2             ' ' EPTRN-OMNI-CHNL-FFLMT-TYP-CDE.                   25460100
BOSSC2                                                                  25460200
BOSSC2     IF EPTRN-OMNI-CHNL-FFLMT-TYP-CDE = 'BOS'                     25460300
BOSSC2         SET PS-ECOM-PRICE-CHANGE-NO TO TRUE                      25460400
BOSSC3**       PERFORM 2940-CHECK-FOR-ECOM-PRICE-CHG                    25460502
BOSSC3**       PARA'S  2940-, 2942- AND 2944- WILL BE OBSOLETE          25460605
BOSSC3**       PARA 2450- PERFORMED IN THIS PROGRAM FOR ALL ORDERS, NOT 25460708
BOSSC3**       NEEDED HERE, BUT THIS IS WHERE SAKUT023 WILL PERFORM IT. 25460808
BOSSC3         PERFORM 2450-SELECT-ORDER-NUMBER                         25460915
BOSSC3         PERFORM 2930-READ-BOSS-TRANSFER                          25461008
BOSSC2         IF  PS-ECOM-PRICE-CHANGE-YES                             25461108
BOSSC2             PERFORM 2950-CREATE-BOSS-OWNERSHIP-ADJ               25461215
BOSSC2             MOVE ML017-PC-DIFFER-AMT  TO PV-DISPLAY-AMT          25461308
BOSSC3             DISPLAY 'BOSS STORE PRICE CHG - CREATING OWNERSHIP'  25461415
BOSSC2                 ' ADJ FOR '  PV-DISPLAY-AMT                      25461508
BOSSC2         END-IF                                                   25461608
BOSSC2     ELSE                                                         25461708
BOSSC2*        SFS AND BOPUS - COMPARE STORE AND ECOM PRICES            25461815
BOSSC2         IF EPITM-OWND-UNT-RTL-AMT = EPITM-OWND-UNT-RTL-ORIG-AMT  25461908
BOSSC2             CONTINUE                                             25462008
BOSSC2         ELSE                                                     25462108
BOSSC2             PERFORM 2920-SFS-BPS-OWN-ADJ                         25462208
BOSSC2         END-IF                                                   25462308
BOSSC2     END-IF.                                                      25462408
BOSSC2                                                                  25462508
BOSSC2******************************************************************25462608
BOSSC2 2920-SFS-BPS-OWN-ADJ.                                            25462708
BOSSC2*    OWNERSHIP ADJUSTMENT PROCESSING FOR SFS AND BOPUS ORDERS.    25462808
BOSSC2*    THESE ORDERS DO NOT INVOLVE INVENTORY TRANSFERS FROM ECOM    25462908
BOSSC2*    AND ARE HANDLED DIFFERENTLY THAN BOSS ORDERS.                25463008
BOSSC2*    OWNERSHIP ADJUSTMENT MUST REFLECT THE DIFFERENCE BETWEEN     25463108
BOSSC2*    THE ECOM ORDER PRICE AND THE STORE OWNED PRICE AT TIME OF    25463208
BOSSC2*    SALE.                                                        25463308
BOSSC2******************************************************************25463408
BOSSC2                                                                  25463508
BOSSC2     SET ML017-MKDOWN                                             25463608
BOSSC2         ML017-BN-OWN-ADJ                                         25463708
BOSSC2         ML017-RC-MISCELLANEOUS                                   25463808
BOSSC2         ML017-REGISTER-MKDN-MKON     TO TRUE.                    25463908
BOSSC2     MOVE PC-OWN-ADJ-796    TO ML017-PC-MKDN-MKUP-RSN-CDE.        25464008
BOSSC2     COMPUTE ML017-PC-OLD-PR-AMT      =                           25464108
BOSSC2             EPITM-OWND-UNT-RTL-AMT       * EPITM-SLD-QTY.        25464208
BOSSC2     COMPUTE ML017-PC-NEW-PR-AMT      =                           25464308
BOSSC2             EPITM-OWND-UNT-RTL-ORIG-AMT  * EPITM-SLD-QTY.        25464408
BOSSC2     MOVE EPITM-SLD-QTY               TO ML017-PC-QTY.            25464508
BOSSC2                                                                  25464608
BOSSC2     COMPUTE ML017-PC-DIFFER-AMT =                                25464708
BOSSC2             ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT.           25464808
BOSSC2                                                                  25464908
BOSSC2     IF ML017-PC-DIFFER-AMT < 0                                   25465008
BOSSC2*        PRICE DECREASE - GENERATE MARKDOWN CANCEL                25465108
BOSSC2*        LOGIC BELOW COPIED FROM 3600-MARKDOWN-CANCEL             25465208
BOSSC2         SET ML017-MARKDOWN-CANCEL TO TRUE                        25465308
BOSSC2         ADD +1     TO PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)      25465408
BOSSC2         ADD ML017-PC-DIFFER-AMT  TO                              25465508
BOSSC2             PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                25465608
BOSSC2     ELSE                                                         25465708
BOSSC2*        PRICE INCREASE - GENERATE MARKDOWN                       25465808
BOSSC2*        BELOW LOGIC COPIED FROM 3120-CONTINUE-PROCESS            25465908
BOSSC2         SET ML017-MARKDOWN          TO TRUE                      25466008
BOSSC2         ADD +1    TO PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)      25466108
BOSSC2         ADD ML017-PC-DIFFER-AMT     TO                           25466208
BOSSC2             PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)               25466308
BOSSC2     END-IF.                                                      25466408
BOSSC2                                                                  25466508
BOSSC2     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        25466608
BOSSC2                                                                  25466708
BOSSC2     MOVE ML017-PC-DIFFER-AMT  TO PV-DISPLAY-AMT.                 25466808
BOSSC2     DISPLAY 'OMNI STORE PRICE CHG - CREATING OWNERSHIP'          25466908
BOSSC2             ' ADJ FOR '  PV-DISPLAY-AMT.                         25467008
BOSSC2                                                                  25467108
BOSSC3******************************************************************25467208
BOSSC3 2930-READ-BOSS-TRANSFER.                                         25467308
BOSSC3*    REQUIRED WHEN A BOSS ORDER IS BEING PROCESSED                25467408
BOSSC3*    IF THE TRANSFER IS FOUND AND THE TRANSFER PRICE DOES NOT     25467508
BOSSC3*    MATCH THE ORIGINAL ECOM ORDER PRICE                          25468002
BOSSC3*    (EPITM-OWND-UNT-RTL-ORIG-AMT) SET THE                        25468102
BOSSC3*    PS-ECOM-PRICE-CHANGE-YES SWITCH TO TRUE SO THAT AN           25468202
BOSSC3*    OWNERSHIP ADJUSTMENT WILL BE CREATED.                        25468302
BOSSC3******************************************************************25469002
BOSSC3**   ADD WS-EPORD-ORD-NBR TO WHERE CLAUSE AFTER OMS STARTS        25469108
BOSSC3**   SENDING IT AND IT IS ADDED TO TRANSFER TABLE.                25469208
BOSSC3                                                                  25469302
BOSSC3      EXEC SQL                                                    25469604
BOSSC3         SELECT XFER_SKU_NBR                                      25469704
BOSSC3              , XFER_SHIPPING_STORE                               25469804
BOSSC3              , XFER_RECEIVING_STORE                              25469904
BOSSC3              , XFER_QUANTITY                                     25470004
BOSSC3              , XFER_BATCH_DATE                                   25470104
BOSSC3              , XFER_RETAIL_VALUE                                 25470204
BOSSC3          INTO :SAT00016-XFER-SKU-NBR                             25471004
BOSSC3              ,:SAT00016-XFER-SHIPPING-STORE                      25471104
BOSSC3              ,:SAT00016-XFER-RECEIVING-STORE                     25471204
BOSSC3              ,:SAT00016-XFER-QUANTITY                            25471304
BOSSC3              ,:SAT00016-XFER-BATCH-DATE                          25471404
BOSSC3              ,:SAT00016-XFER-RETAIL-VALUE                        25471504
BOSSC3          FROM  SAT_BOSS_TRANSFERS                                25471604
BOSSC3         WHERE XFER_SKU_NBR          = :EPITM-SKU-NBR             25471704
BOSSC3           AND XFER_RECEIVING_STORE  = :EPTRN-STR-NBR             25471804
BOSSC3           AND XFER_BATCH_DATE      >= :EPTRN-TRN-DTE             25471904
BOSSC3           AND XFER_BATCH_DATE      <= :EPTRN-SLS-DTE             25472005
BOSSC3      ORDER BY XFER_BATCH_DATE                                    25472104
BOSSC3         FETCH FIRST ROW ONLY                                     25472204
BOSSC3          WITH UR                                                 25472304
BOSSC3      END-EXEC.                                                   25472404
BOSSC3                                                                  25472504
BOSSC3     EVALUATE TRUE                                                25472604
BOSSC3        WHEN SQLCODE = ZERO                                       25472704
BOSSC3           COMPUTE PV-OLD-OMNI-PRICE =                            25473006
BOSSC3                   SAT00016-XFER-RETAIL-VALUE /                   25473105
BOSSC3                   SAT00016-XFER-QUANTITY                         25473205
BOSSC3* EPITM-OWND-UNT-RTL-ORIG-AMT DOESN'T INCLUDE SOLD QTY.           25473305
BOSSC3* EPITM-OWND-UNT-RTL-ORIG-AMT ON SFS AND BOPUS CLEARANCE ITEMS    25473407
BOSSC3* REFLECTS LAST ACTIVE PRICE?  IF THAT HAPPENS ON BOSS CLEARANCE  25473507
BOSSC3* ITEMS, WE MAY BE ABLE TO USE CUST-CHRGD-AMT, ASSUMING THAT      25473607
BOSSC3* THERE WOULD BE NO PROMOS ON CLEARANCE ITEMS?                    25473707
BOSSC3* PARA 2950- WILL MULTIPLY OLD AND NEW OMNI PRICES BY SOLD QTY.   25473807
BOSSC3* PARA 2950- WILL SUBTRACT NEW FROM OLD                           25473908
BOSSC3           IF EPITM-OWND-UNT-RTL-ORIG-AMT = PV-OLD-OMNI-PRICE     25474007
BOSSC3               SET PS-ECOM-PRICE-CHANGE-NO   TO  TRUE             25474107
BOSSC3           ELSE                                                   25474207
BOSSC3               SET PS-ECOM-PRICE-CHANGE-YES  TO  TRUE             25474307
BOSSC3               MOVE EPITM-OWND-UNT-RTL-ORIG-AMT                   25474407
BOSSC3                 TO PV-NEW-OMNI-PRICE                             25474507
BOSSC3           END-IF                                                 25474607
BOSSC3        WHEN SQLCODE = PC-ROW-NOT-FOUND                           25474707
BOSSC3**          THIS CONDITION SHOULD NOT BE HIT?                     25474807
BOSSC3            DISPLAY 'TRANSFER NOT FOUND'                          25474907
BOSSC3            SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE                25475007
BOSSC3        WHEN OTHER                                                25475107
BOSSC3            DISPLAY 'TRANSFER CALL FAILED '                       25475207
BOSSC3            SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE                25475307
BOSSC3     END-EVALUATE.                                                25475407
BOSSC3                                                                  25475507
BOSSCL******************************************************************25475607
BOSSC2 2940-CHECK-FOR-ECOM-PRICE-CHG.                                   25475707
BOSSC2*    REQUIRED WHEN A BOSS ORDER IS BEING PROCESSED                25475807
BOSSC2*    CHECK FOR ECOM PRICE FIRST                                   25475907
BOSSC2*    IF ECOM PRICE NOT FOUND, CHECK FOR CORP PRICE (LOC ZERO)     25476007
BOSSCL******************************************************************25476107
BOSSCL**    GET PRICE WHEN CUSTOMER PLACED ORDER                        25477007
BOSSC2      SET PS-ECOM-PRICE-NOT-FOUND   TO TRUE.                      25480000
BOSSC2***   MOVE EPTRN-STR-NBR            TO PV-STR-NBR-DB2.            25490000
BOSSC2      MOVE 873                      TO PV-STR-NBR-DB2.            25500000
BOSSCL      PERFORM 2942-GET-ORDER-DATE-PRICE.                          25510000
BOSSC2      IF PS-ECOM-PRICE-NOT-FOUND                                  25520000
BOSSCL          MOVE ZEROES               TO PV-STR-NBR-DB2             25530000
BOSSCL          PERFORM 2942-GET-ORDER-DATE-PRICE                       25540000
BOSSCL      END-IF.                                                     25550000
BOSSCL                                                                  25560000
BOSSC2      IF PS-ECOM-PRICE-FOUND                                      25570000
BOSSCL       DISPLAY 'PRICING FOUND FOR ORDER DATE ' PV-NEW-OMNI-PRICE  25580000
BOSSC2**    CHECK IF TRANSFER DATE FELL WITHIN SAME PRICE CHANGE AS     25590000
BOSSC2**    ORDER DATE                                                  25600000
BOSSC2*         IF  EPTRN-SLS-DTE IS >= PV-PRICE-CHG-STRT-DATE          25610000
BOSSC2*         AND EPTRN-SLS-DTE IS <= PV-PRICE-CHG-END-DATE           25620000
BOSSC2          IF  PV-TRANSFER-DATE IS >= PV-PRICE-CHG-STRT-DATE       25630000
BOSSC2          AND PV-TRANSFER-DATE IS <= PV-PRICE-CHG-END-DATE        25640000
BOSSC2              DISPLAY 'PRICING SAME FOR ORDER AND TRANSFER DATES' 25650000
BOSSC2              SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE              25660000
BOSSCL          ELSE                                                    25670000
BOSSC2**            GET PRICE WHEN TRANSFER COMPLETED                   25680000
BOSSC2              SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE              25690000
BOSSC2***           MOVE EPTRN-STR-NBR             TO PV-STR-NBR-DB2    25700000
BOSSC2              MOVE 873                       TO PV-STR-NBR-DB2    25710000
BOSSCL              PERFORM 2944-GET-SALE-DATE-PRICE                    25720000
BOSSC2              IF PS-ECOM-PRICE-NOT-FOUND                          25730000
BOSSCL                  MOVE ZEROES                TO PV-STR-NBR-DB2    25740000
BOSSCL                  PERFORM 2944-GET-SALE-DATE-PRICE                25750000
BOSSCL              END-IF                                              25760000
BOSSC2              IF PS-ECOM-PRICE-FOUND                              25770000
BOSSC2       DISPLAY 'PRICING FOUND FOR XFER DATE ' PV-OLD-OMNI-PRICE   25780000
BOSSCL                  IF PV-OLD-OMNI-PRICE = PV-NEW-OMNI-PRICE        25790000
BOSSC2                      SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE      25800000
BOSSCL                  ELSE                                            25810000
BOSSC2                      SET PS-ECOM-PRICE-CHANGE-YES   TO TRUE      25820000
BOSSCL                  END-IF                                          25830000
BOSSCL              ELSE                                                25840000
BOSSCL***           PRICING NOT FOUND - DO NOT ATTEMPT OWNERSHIP ADJ    25850000
BOSSC2              DISPLAY 'PRICING NOT FOUND FOR TRANSFER DATE'       25860000
BOSSC2                  SET PS-ECOM-PRICE-CHANGE-NO        TO TRUE      25870000
BOSSCL              END-IF                                              25880000
BOSSCL          END-IF                                                  25890000
BOSSCL      ELSE                                                        25900000
BOSSCL***   PRICING NOT FOUND - DO NOT ATTEMPT OWNERSHIP ADJ            25910000
BOSSCL          DISPLAY 'PRICING NOT FOUND FOR ORDER DATE '             25920000
BOSSC2          SET PS-ECOM-PRICE-CHANGE-NO                TO TRUE      25921000
BOSSCL      END-IF.                                                     25922000
BOSSCL                                                                  25923000
BOSSCL******************************************************************25924000
BOSSCL 2942-GET-ORDER-DATE-PRICE.                                       25925000
BOSSCL*    GET THE ACTIVE PRICE FOR THE ORDER DATE.                     25926000
BOSSCL*    IF THE STORE PRICE IS NOT FOUND, THIS PARAGRAPH WILL BE      25926100
BOSSCL*    CALLED AGAIN TO FIND THE CORPORATE LOC ZERO PRICE.           25926200
BOSSCL******************************************************************25926300
BOSSCL*    SET TIMESTAMP TO TRAN DATE AT 2:00 AM.                       25926400
BOSSCL     MOVE EPTRN-TRN-DTE    TO PV-TS-DATE.                         25926500
BOSSCL     MOVE PV-TIMESTAMP-DB2 TO PV-TIMESTAMP.                       25926600
BOSSCL                                                                  25926700
BOSSCL      EXEC SQL                                                    25926800
BOSSCL         SELECT A.SKU                                             25926900
BOSSCL              , B.STR_NBR                                         25927000
BOSSCL              , DATE(B.STRT_TMST)                                 25927100
BOSSCL              , DATE(B.END_TMST)                                  25927200
BOSSCL              , B.STATUS_CDE                                      25927300
BOSSCL              , B.RTL_AMT                                         25927400
BOSSCL              , A.ITM_NBR                                         25927500
BOSSCL          INTO :SKXREF-SKU                                        25927600
BOSSCL              ,:PPCPRC-STR-NBR                                    25927700
BOSSCL              ,:PV-PRICE-CHG-STRT-DATE                            25927800
BOSSCL              ,:PV-PRICE-CHG-END-DATE                             25927900
BOSSCL              ,:PPCPRC-STATUS-CDE                                 25928000
BOSSCL              ,:PPCPRC-RTL-AMT                                    25928100
BOSSCL              ,:SKXREF-ITM-NBR                                    25928200
BOSSCL          FROM TSKXREF A                                          25928300
BOSSCL             , TPPCPRC B                                          25928400
BOSSCL         WHERE B.STR_NBR        = :PV-STR-NBR-DB2                 25928500
BOSSCL           AND A.SKU            = :EPITM-SKU-NBR                  25928600
BOSSCL           AND A.ITM_NBR        = B.TSK_ITM_NBR                   25928700
BOSSCL           AND (:PV-TIMESTAMP BETWEEN B.STRT_TMST AND B.END_TMST) 25928800
BOSSCL          WITH UR                                                 25928900
BOSSCL      END-EXEC.                                                   25929000
BOSSCL                                                                  25929100
BOSSCL     EVALUATE TRUE                                                25929200
BOSSCL        WHEN SQLCODE = ZERO                                       25929300
BOSSC2           SET PS-ECOM-PRICE-FOUND         TO TRUE                25929400
BOSSCL           MOVE PPCPRC-RTL-AMT             TO  PV-NEW-OMNI-PRICE  25929500
BOSSCL        WHEN SQLCODE = PC-ROW-NOT-FOUND                           25929600
BOSSCL**          ECOM SEARCH COULD HIT HERE, BUT NOT CORP SEARCH       25929700
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                25929800
BOSSCL        WHEN OTHER                                                25929900
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                25930000
BOSSCL     END-EVALUATE.                                                25931000
BOSSCL                                                                  25931100
BOSSCL                                                                  25931200
BOSSCL******************************************************************25931300
BOSSCL 2944-GET-SALE-DATE-PRICE.                                        25931400
BOSSCL*    GET THE ACTIVE PRICE FOR THE SALE DATE.                      25931500
BOSSC2*    TRANSFER DATE IS 2 DAYS EARLIER THEN SALES DATE TO MIMIC     25931601
BOSSC2*    ACTUAL TRANSFER DATE.  ECOM PRICE CHANGES AFTER THE TRANSFER 25931700
BOSSC2*    DATE SHOULDN'T RESULT IN AN OWNERSHIP ADJUSTMENT.            25931800
BOSSCL*    IF THE STORE PRICE IS NOT FOUND, THIS PARAGRAPH WILL BE      25931900
BOSSCL*    CALLED AGAIN TO FIND THE CORPORATE LOC ZERO PRICE.           25932000
BOSSCL******************************************************************25932100
BOSSCL                                                                  25932200
BOSSCL*    SET TIMESTAMP TO SALES DATE AT 2:00 AM.                      25932300
BOSSC2*    MOVE EPTRN-SLS-DTE    TO PV-TS-DATE.                         25932400
BOSSC2     MOVE PV-TRANSFER-DATE TO PV-TS-DATE.                         25932500
BOSSCL     MOVE PV-TIMESTAMP-DB2 TO PV-TIMESTAMP.                       25932600
BOSSCL                                                                  25932700
BOSSCL      EXEC SQL                                                    25932800
BOSSCL         SELECT A.SKU                                             25932900
BOSSCL              , B.STR_NBR                                         25933000
BOSSCL              , DATE(B.STRT_TMST)                                 25933100
BOSSCL              , DATE(B.END_TMST)                                  25933200
BOSSCL              , B.STATUS_CDE                                      25933300
BOSSCL              , B.RTL_AMT                                         25933400
BOSSCL              , A.ITM_NBR                                         25933500
BOSSCL          INTO :SKXREF-SKU                                        25933600
BOSSCL              ,:PPCPRC-STR-NBR                                    25933700
BOSSCL              ,:PV-PRICE-CHG-STRT-DATE                            25933800
BOSSCL              ,:PV-PRICE-CHG-END-DATE                             25933900
BOSSCL              ,:PPCPRC-STATUS-CDE                                 25934000
BOSSCL              ,:PPCPRC-RTL-AMT                                    25934100
BOSSCL              ,:SKXREF-ITM-NBR                                    25934200
BOSSCL          FROM TSKXREF A                                          25934300
BOSSCL             , TPPCPRC B                                          25934400
BOSSCL         WHERE B.STR_NBR        = :PV-STR-NBR-DB2                 25934500
BOSSCL           AND A.SKU            = :EPITM-SKU-NBR                  25934600
BOSSCL           AND A.ITM_NBR        = B.TSK_ITM_NBR                   25934700
BOSSCL           AND (:PV-TIMESTAMP BETWEEN B.STRT_TMST AND B.END_TMST) 25934800
BOSSCL          WITH UR                                                 25934900
BOSSCL      END-EXEC.                                                   25935000
BOSSCL                                                                  25935100
BOSSCL     EVALUATE TRUE                                                25935200
BOSSCL        WHEN SQLCODE = ZERO                                       25935300
BOSSC2            SET PS-ECOM-PRICE-FOUND        TO TRUE                25935400
BOSSCL            MOVE PPCPRC-RTL-AMT            TO PV-OLD-OMNI-PRICE   25935500
BOSSCL        WHEN SQLCODE = PC-ROW-NOT-FOUND                           25935600
BOSSCL**          STORE SEARCH COULD HIT HERE, BUT NOT CORP SEARCH      25935700
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                25935800
BOSSCL        WHEN OTHER                                                25935900
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                25936000
BOSSCL     END-EVALUATE.                                                25937000
BOSSCL                                                                  25938000
BOSSCL                                                                  25939000
BOSSCL******************************************************************25940000
BOSSCL 2950-CREATE-BOSS-OWNERSHIP-ADJ.                                  25941015
BOSSCL*    REQUIRED WHEN A BOSS ORDER IS BEING PROCESSED AND THE        25942015
BOSSCL*    ECOM PRICE CHANGED AFTER THE ECOM ORDER WAS PLACED AND       25942115
BOSSCL*    BEFORE THE TRANSFER TO THE STORE HAPPENED.                   25942215
BOSSC3*    PV-OLD-OMNI-PRICE SET TO TRANSFER DATE PRICE FOR PRICE LOOKUP25942315
BOSSC3*    OR TRANSFER PRICE FOR TRANSFER LOOKUP.                       25942415
BOSSC3*    PV-NEW-OMNI-PRICE SET TO ORDER DATE PRICE FOR PRICE LOOKUP   25942515
BOSSC3*    OR EPITM-OWND-UNT-RTL-ORIG-AMT FOR TRANSFER LOOKUP.          25942615
BOSSCL******************************************************************25942715
BOSSCL                                                                  25942815
BOSSCL     SET ML017-MKDOWN                                             25942915
BOSSCL         ML017-BN-OWN-ADJ                                         25943015
BOSSCL         ML017-RC-MISCELLANEOUS                                   25943115
BOSSCL         ML017-REGISTER-MKDN-MKON     TO TRUE.                    25943215
BOSSCL     MOVE PC-OWN-ADJ-796    TO ML017-PC-MKDN-MKUP-RSN-CDE.        25943315
BOSSCL     COMPUTE ML017-PC-OLD-PR-AMT      =                           25943415
BOSSCL             PV-OLD-OMNI-PRICE            * EPITM-SLD-QTY.        25943515
BOSSCL*            EPITM-OWND-UNT-RTL-AMT       * EPITM-SLD-QTY.        25943615
BOSSCL     COMPUTE ML017-PC-NEW-PR-AMT      =                           25943715
BOSSCL             PV-NEW-OMNI-PRICE            * EPITM-SLD-QTY.        25943815
BOSSCL*            EPITM-OWND-UNT-RTL-ORIG-AMT  * EPITM-SLD-QTY.        25943915
BOSSCL*    THE FOLLOWING WILL BE OVERLAID IN PARA 4000- WITH 1          25944015
BOSSCL     MOVE EPITM-SLD-QTY               TO ML017-PC-QTY.            25944115
BOSSCL                                                                  25944215
BOSSCL     COMPUTE ML017-PC-DIFFER-AMT =                                25944315
BOSSCL             ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT.           25944415
BOSSCL* ECOM ORIG = 60, STORE OWNED = 55, DIFF = -5                     25944515
BOSSCL                                                                  25944615
BOSSCL     IF ML017-PC-DIFFER-AMT < 0                                   25944715
BOSSCL*        PRICE DECREASE - GENERATE MARKDOWN CANCEL                25944815
BOSSCL*        LOGIC BELOW COPIED FROM 3600-MARKDOWN-CANCEL             25944915
BOSSCL         SET ML017-MARKDOWN-CANCEL TO TRUE                        25945015
BOSSCL         ADD +1     TO PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)      25945115
BOSSCL         ADD ML017-PC-DIFFER-AMT  TO                              25945215
BOSSCL             PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                25945315
BOSSCL         MOVE 'MDC'               TO WS-MDWN-TYPE                 25945415
BOSSCL     ELSE                                                         25945515
BOSSCL*        PRICE INCREASE - GENERATE MARKDOWN                       25945615
BOSSCL*        BELOW LOGIC COPIED FROM 3120-CONTINUE-PROCESS            25945715
BOSSCL         SET ML017-MARKDOWN          TO TRUE                      25945815
BOSSCL         ADD +1    TO PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)      25945915
BOSSCL         ADD ML017-PC-DIFFER-AMT     TO                           25946015
BOSSCL             PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)               25946115
BOSSCL         MOVE 'MD'                   TO WS-MDWN-TYPE              25946215
BOSSCL     END-IF.                                                      25946315
BOSSCL                                                                  25946415
BOSSCL     MOVE ML017-PC-DIFFER-AMT    TO WS-DISC-AMT.                  25946515
BOSSCL     MOVE PC-OWNERSHIP-ADJ       TO WS-DISC-TYPE.                 25946615
BOSSCL     PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       25946715
BOSSCL     PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       25946815
BOSSCL                                                                  25946915
BOSSCL     DISPLAY 'OMNI CLEARANCE AMOUNT BEFORE P4000- = '             25947015
BOSSCL              ML017-PC-DIFFER-AMT.                                25947115
BOSSCL     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        25947215
BOSSCL                                                                  25947315
259300******************************************************************25947415
259400 3000-POPULATE-MISC-FIELDS.                                       25947515
259500*     POPULATE MISC FIELDS.                                       25947615
259600******************************************************************25947715
259700                                                                  25947815
260200     INITIALIZE ML017-PC-CATEGORY-IND.                            25947915
260300                                                                  25948015
260400     IF EPITM-DEPT-CL-ERR-CDE NOT EQUAL '0' AND                   25948115
260500        EPITM-DEPT-CL-ERR-CDE NOT EQUAL '1' AND                   25948215
260600        EPITM-DEPT-CL-ERR-CDE NOT EQUAL '2' AND                   25948315
260700        EPITM-DEPT-CL-ERR-CDE NOT EQUAL '3' OR                    25949000
260800        EPITM-SKU-ERR-CDE = '2'                                   25950000
260900        MOVE EPITM-SKU-NBR            TO ML017-PC-SKU             25960000
261000        MOVE '099'                    TO ML017-PC-DEPT-NBR        25970000
261100                                         EPITM-DEPT-NBR           25980000
261200                                         ML017-PC-SKU(1:3)        25990000
261300        MOVE '10'                     TO ML017-PC-CLASS-NBR       26000000
261400                                         EPITM-SUB-CL-NBR         26010000
261500                                         ML017-PC-SKU(4:2)        26020000
261600     ELSE                                                         26030000
261700        MOVE EPITM-DEPT-NBR           TO ML017-PC-DEPT-NBR        26040000
261800        MOVE EPITM-SUB-CL-NBR         TO ML017-PC-CLASS-NBR       26050000
261900        MOVE EPITM-SKU-NBR            TO ML017-PC-SKU             26060000
262000     END-IF.                                                      26070000
262100                                                                  26080000
262200     MOVE EPITM-DEPT-NBR              TO ML017-PC-DOC-DEPT.       26090000
262300     MOVE EPTRN-SLS-DTE               TO PV-ISO-DB2-DATE.         26100000
ZX         MOVE EPTRN-OMNI-CHNL-FFLMT-TYP-CDE                           26110000
ZX                                        TO PV-OMNI-CHNL-FFLMT-TYP-CDE.26120000
262400     MOVE PV-ISO-DB2-DD               TO ML017-PC-DOC-DAY.        26130000
262500     MOVE ML017-PC-DOC-NBR            TO ML017-PC-DOC-5-NBR.      26140000
262600     MOVE PV-ISO-DB2-MM               TO ML017-PC-DTE-MM.         26150000
262700     MOVE PV-ISO-DB2-DD               TO ML017-PC-DTE-DD.         26160000
262800     MOVE PV-FISC-PERIOD-NBR-HOLD     TO ML017-PC-KOHLS-MM.       26170000
262900     MOVE EPITM-MAJ-CL-NBR            TO ML017-PC-MAJ-CLASS.      26180000
263000     MOVE +1                          TO ML017-PC-QTY             26190000
263100                                         ML017-PC-TOT-DOC-QTY.    26200000
263200     MOVE EPTRN-STR-NBR               TO PV-STR-NBR-4.            26210000
263300     MOVE PV-RFMT-STR-NBR             TO ML017-PC-STORE-NBR.      26220000
263400     MOVE EPITM-SKU-NBR               TO PV-SKU-NBR.              26230000
263500     MOVE PV-RGST-ID                  TO ML017-RGST-ID.           26240000
263600     MOVE PV-TRN-NBR                  TO ML017-TRN-NBR.           26250000
263700     MOVE PV-LNE-ITM-SEQ-NBR          TO ML017-LNE-ITM-SEQ-NBR.   26260000
ZX         MOVE EPITM-ORIG-SAL-TYP-CDE      TO PV-ORIG-SAL-TYP-CDE.     26270000
ZX         MOVE EPITM-SAL-TYP-CDE           TO PV-SAL-TYP-CDE.          26280000
ZX         MOVE EPITM-ORIG-REG-RTL-AMT      TO PV-ORIG-REG-RTL-AMT.     26290000
ZX         MOVE EPITM-REG-RTL-AMT           TO PV-REG-RTL-AMT.          26300000
ZX         MOVE EPITM-CUST-CHRGD-AMT        TO PV-CUST-CHRGD-AMTS.      26310000
ZX         MOVE EPITM-NET-CHRGD-AMT         TO PV-NET-CHRGD-AMTS.       26320000
ZX         MOVE EPITM-OWND-UNT-RTL-AMT      TO PV-OURA-AMTS.            26330000
ZX         IF PV-ORIG-OWND-UNT-AMT-NULL-IND = PC-NULL                   26340000
ZX             MOVE ZEROES                  TO PV-ORIG-OURA-AMTS        26350000
ZX         ELSE                                                         26360000
ZX             MOVE EPITM-OWND-UNT-RTL-ORIG-AMT                         26370000
ZX                                          TO PV-ORIG-OURA-AMTS        26371000
ZX         END-IF.                                                      26372000
ZX         MOVE EPITM-ITM-STAT-CDE          TO PV-ITM-STAT-CDE.         26373000
ZX         MOVE EPITM-DEPT-NBR              TO PV-DEPT-NBR.             26374000
263800                                                                  26375000
ZX         IF EPTRN-TRN-STAT-CDE = 'V' OR                               26376000
ZX            EPTRN-TRN-STAT-CDE = 'R'                                  26377000
ZX            SET ML017-SALES-AUDIT-CORR    TO TRUE                     26378000
ZX            IF DPG55-DB2-ISO-DATE-FMT LESS THAN PV-CUT-OFF-CCYY-MM-DD 26379000
ZX               MOVE 4              TO PV-TOT-SUB                      26380000
ZX            ELSE                                                      26381000
ZX               MOVE 2              TO PV-TOT-SUB                      26382000
ZX            END-IF                                                    26383000
ZX         ELSE                                                         26384000
ZX            IF EPTRN-TRN-STAT-CDE = 'L'                               26385000
ZX               SET ML017-SYSTEM-LATE-CORR TO TRUE                     26386000
ZX               IF DPG55-DB2-ISO-DATE-FMT LESS THAN                    26387000
ZX                  PV-CUT-OFF-CCYY-MM-DD                               26388000
ZX                  MOVE 5          TO PV-TOT-SUB                       26389000
ZX               ELSE                                                   26389100
ZX                  MOVE 3          TO PV-TOT-SUB                       26389200
ZX               END-IF                                                 26389300
ZX            ELSE                                                      26389400
ZX               MOVE 1              TO PV-TOT-SUB                      26389500
ZX            END-IF                                                    26389600
ZX         END-IF.                                                      26389700
266000                                                                  26389800
266100******************************************************************26389900
266200* CHECK FOR EMPLOYEE DISCOUNT                                     26390000
266300******************************************************************26400000
266400 3001-CHECK-DISCOUNT.                                             26410000
266500                                                                  26420000
267000      EXEC SQL                                                    26430000
267100         SELECT  EMP_DISC_AMT                                     26440000
267200           INTO :EPEID-EMP-DISC-AMT                               26450000
267300                                                                  26460000
267400           FROM TEPEID                                            26470000
267500                                                                  26480000
267600          WHERE PARTN_NBR        = :PV-PARTN-NBR                  26490000
267700            AND STR_NBR          = :PV-STR-NBR                    26500000
267800            AND RGST_ID          = :PV-RGST-ID                    26510000
267900            AND TRN_NBR          = :PV-TRN-NBR                    26520000
268000            AND STRT_TM          = :PV-STRT-TM                    26530000
268100            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           26540000
268200            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            26550000
268300                                                                  26560000
268400          WITH UR                                                 26570000
268500      END-EXEC.                                                   26580000
268600                                                                  26590000
269500     EVALUATE TRUE                                                26600000
269600        WHEN SQLCODE = ZERO                                       26610000
269700           PERFORM 3002-EMPLY-DISCOUNT                            26620000
269800           PERFORM 4000-PROCESS-MARKDOWN-MARKUP                   26630000
269900                                                                  26640000
270000*** NEED TO CLEAR OUT WORKING STORAGE TO WHERE IT WOULD HAVE BEEN 26650000
270100*** WITHOUT THE DISCOUNT.  AS A RESULT, INITIALIZE THE RECORD AS  26660000
270200*** IT WAS PRIOR TO WORKING WITH THE EMPLOYEE DISCOUNT.           26670000
270300           INITIALIZE ML017-PRICE-CHANGE-RECORD                   26680000
270400           PERFORM 3000-POPULATE-MISC-FIELDS                      26690000
270500                                                                  26700000
270600        WHEN OTHER                                                26710000
270700           CONTINUE                                               26720000
270800                                                                  26730000
270900     END-EVALUATE.                                                26740000
271000                                                                  26750000
271100                                                                  26760000
271200******************************************************************26770000
271300* PROCESS EMPLOYEE DISCOUNTS                                      26780000
271400******************************************************************26790000
271500 3002-EMPLY-DISCOUNT.                                             26800000
271600                                                                  26810000
272100     MOVE EPITM-NET-CHRGD-AMT TO PV-NET-CHRGD-AMT-TMP.            26820000
272200                                                                  26830000
272300     COMPUTE EPITM-NET-CHRGD-AMT = EPITM-NET-CHRGD-AMT            26840000
272400                                 - EPEID-EMP-DISC-AMT.            26850000
272500                                                                  26860000
272600     SET ML017-MKDOWN                                             26870000
272700         ML017-RC-MISCELLANEOUS                                   26880000
272800         ML017-BN-EMPLY-DISCOUNT                                  26890000
272900         ML017-REGISTER-MKDN-MKON TO TRUE.                        26900000
273000                                                                  26910000
273100     MOVE PC-790-EMPLY-DISCOUNT TO                                26920000
273200                ML017-PC-MKDN-MKUP-RSN-CDE.                       26930000
273300                                                                  26940000
273400     MOVE EPITM-NET-CHRGD-AMT  TO ML017-PC-OLD-PR-AMT.            26950000
273500     MOVE PV-NET-CHRGD-AMT-TMP TO ML017-PC-NEW-PR-AMT.            26960000
ZX         SET PV-DISC-TYPE-ASSOC TO TRUE.                              26970000
273600                                                                  26980000
273700     IF  EPEID-EMP-DISC-AMT < ZERO                                26990000
273800         SET ML017-MARKDOWN TO TRUE                               27000000
273900                                                                  27010000
274000         COMPUTE EPEID-EMP-DISC-AMT =                             27020000
274100                 EPEID-EMP-DISC-AMT * (-1)                        27030000
274200                                                                  27040000
274300         ADD +1           TO PT-EMPLY-DISC-MKDN-QTY (PV-TOT-SUB)  27050000
274400         ADD EPEID-EMP-DISC-AMT                                   27060000
274500                          TO PT-EMPLY-DISC-MKDN-AMT (PV-TOT-SUB)  27070000
ZX             MOVE EPEID-EMP-DISC-AMT TO WS-DISC-AMT                   27080000
ZX             MOVE PC-EMPLY-DISCOUNT TO WS-DISC-TYPE                   27090000
ZX             MOVE 'MD'              TO WS-MDWN-TYPE                   27100000
ZX             PERFORM 8195-BUILD-DAY02-TRANS-RECORD                    27110000
ZX             PERFORM 8195-WRITE-DAY02-TRANS-RECORD                    27120000
274600     ELSE                                                         27130000
274700         SET ML017-MARKDOWN-CANCEL TO TRUE                        27140000
274800                                                                  27150000
274900         MOVE ZEROS              TO ML017-PC-OLD-PR-AMT           27160000
275000         MOVE EPEID-EMP-DISC-AMT TO ML017-PC-NEW-PR-AMT           27170000
275100         COMPUTE EPEID-EMP-DISC-AMT =                             27180000
275200                 EPEID-EMP-DISC-AMT * (-1)                        27190000
275300                                                                  27200000
276000         ADD +1           TO PT-EMPLY-DISC-MDC-QTY (PV-TOT-SUB)   27210000
276100         ADD EPEID-EMP-DISC-AMT                                   27220000
276200                          TO PT-EMPLY-DISC-MDC-AMT (PV-TOT-SUB)   27230000
ZX             MOVE EPEID-EMP-DISC-AMT TO WS-DISC-AMT                   27240000
ZX             MOVE PC-EMPLY-DISCOUNT  TO WS-DISC-TYPE                  27250000
ZX             MOVE 'MDC'              TO WS-MDWN-TYPE                  27260000
ZX             PERFORM 8195-BUILD-DAY02-TRANS-RECORD                    27270000
ZX             PERFORM 8195-WRITE-DAY02-TRANS-RECORD                    27280000
276300     END-IF.                                                      27290000
276400                                                                  27300000
276500     MOVE EPEID-EMP-DISC-AMT   TO ML017-PC-DIFFER-AMT.            27310000
276600                                                                  27320000
276700******************************************************************27330000
276800 3100-RETURN-ITEM-MARKDOWN.                                       27340000
276900*     PROCESS BACK OFFICE MARKDOWN FOR QUALIFY RETURN ITEMS.      27350000
277000*     FOR RETURN ITEMS, EPITM-CUST-CHRGD-AMT IS NEGATIVE, TO      27360000
277100*     SUBTRACT THAT AMOUNT, HAS TO "ADD" IT TO THE GROUPED PRICE. 27370000
277200******************************************************************27380000
277300                                                                  27390000
277800     PERFORM 3200-SELECT-GROUP-PRICING.                           27400000
277900     IF SQLCODE = ZERO                                            27410000
278000        COMPUTE PV-PRICE-CHANGE-AMOUNT = EPIGP-GP-AMT             27420000
278100                                       / EPIGP-GP-QTY             27430000
278200                                       * EPITM-SLD-QTY            27440000
278300                                       + EPITM-CUST-CHRGD-AMT     27450000
279500     ELSE                                                         27460000
279600        IF PV-SKU-LST-3-DGT        EQUAL ZERO                     27470000
279700           COMPUTE PV-PRICE-CHANGE-AMOUNT = EPITM-REG-RTL-AMT     27480000
279800                                          * EPITM-SLD-QTY         27490000
280900        ELSE                                                      27500000
281000***** CORRECT NET-CHRGD-AMT < 0 AND CUST-CHRGD-AMT > 0            27510000
281100           IF EPITM-NET-CHRGD-AMT < 0 AND                         27520000
281200              EPITM-CUST-CHRGD-AMT > 0 AND                        27530000
281300              EPITM-REG-RTL-AMT    = 0                            27540000
281400              MOVE ZERO           TO PV-PRICE-CHANGE-AMOUNT       27550000
281500           ELSE                                                   27560000
281600              COMPUTE PV-PRICE-CHANGE-AMOUNT                      27570000
281700                    = EPITM-CUST-CHRGD-AMT                        27580000
281800                    + EPITM-REG-RTL-AMT                           27590000
281900                    * EPITM-SLD-QTY                               27600000
282000                                                                  27610000
283200           END-IF                                                 27620000
283300        END-IF                                                    27630000
283400     END-IF.                                                      27640000
283500                                                                  27650000
283600     COMPUTE PV-PRICE-CHANGE-AMOUNT = PV-PRICE-CHANGE-AMOUNT      27660000
283700                                    * (-1).                       27670000
283800                                                                  27680000
214615     IF (EPITM-ORIG-REG-RTL-AMT > 0                               27690000
214615     AND EPITM-ORIG-REG-RTL-AMT NOT = EPITM-REG-RTL-AMT)          27700000
214615        PERFORM 3140-NEW-PROCESS                                  27710000
214615     ELSE                                                         27720000
214615        PERFORM 3120-CONTINUE-PROCESS                             27730000
214615     END-IF.                                                      27740000
214615                                                                  27750000
242000******************************************************************27760000
214615 3120-CONTINUE-PROCESS.                                           27770000
214615                                                                  27780000
283900     SET ML017-MKDOWN                                             27790000
284000         ML017-RC-MISCELLANEOUS                                   27800000
284100         ML017-BN-OWN-ADJ                                         27810000
284200         ML017-REGISTER-MKDN-MKON     TO TRUE.                    27820000
284300     IF EPTRN-POS-CPBL-LVL-NBR = PC-POC AND                       27830000
011618*       EPITM-SAL-RET-CDE = 'R'                                   27840000
ZX            (EPITM-SAL-RET-CDE = 'R' OR                               27850000
ZX             EPITM-SAL-RET-CDE = 'B')                                 27860000
284600         PERFORM 3300-CALC-EXTENDED-AMT                           27870000
284700         IF PV-CUST-CHRGD-AMT > PV-EXTENDED-AMT                   27880000
284800******* THIS IF STATEMENT IS ADDED TO AVOID "ZERO COST" ITEMS     27890000
284900******* BEING PROCESSED AS MARKUPS.                               27900000
285000             IF EPITM-REG-RTL-AMT NOT EQUAL ZERO AND              27910000
285100                EPITM-OWND-UNT-RTL-AMT NOT EQUAL ZERO             27920000
ZX                     IF PV-PRICE-CHANGE-AMOUNT < ZERO                 27930000
ZX                         MOVE PC-OWN-ADJ-796        TO                27940000
ZX                                           ML017-PC-MKDN-MKUP-RSN-CDE 27950000
ZX                         SET ML017-MARKDOWN-CANCEL  TO TRUE           27960000
ZX                         MOVE ZERO            TO ML017-PC-OLD-PR-AMT  27970000
ZX                         MOVE PV-PRICE-CHANGE-AMOUNT                  27980000
ZX                                              TO ML017-PC-NEW-PR-AMT  27990000
ZX                                                 ML017-PC-DIFFER-AMT  28000000
ZX                         ADD +1                     TO                28010000
ZX                                PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB) 28020000
ZX                         ADD ML017-PC-DIFFER-AMT    TO                28030000
ZX                                PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB) 28040000
ZX                         MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT    28050000
ZX                         MOVE PC-OWNERSHIP-ADJ      TO WS-DISC-TYPE   28060000
ZX                         MOVE 'MDC'                 TO WS-MDWN-TYPE   28070000
ZX                         PERFORM 8195-BUILD-DAY02-TRANS-RECORD        28080000
ZX                         PERFORM 8195-WRITE-DAY02-TRANS-RECORD        28090000
ZX                     END-IF                                           28100000
ZX                     IF PV-PRICE-CHANGE-AMOUNT > ZERO                 28110000
ZX                         MOVE PC-OWN-RTN-ADJ-792    TO                28120000
ZX                                           ML017-PC-MKDN-MKUP-RSN-CDE 28130000
ZX                         SET ML017-MARKDOWN         TO TRUE           28140000
072618                     MOVE EPITM-OWND-UNT-RTL-AMT                  28150000
072618                                           TO ML017-PC-NEW-PR-AMT 28160000
072618                     MOVE EPITM-CUST-CHRGD-AMT                    28170000
072618                                           TO ML017-PC-OLD-PR-AMT 28180000
072618                     COMPUTE ML017-PC-DIFFER-AMT =                28190000
072618                       ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT  28200000
ZX                         SET ML017-BN-OWN-RTN-ADJ   TO TRUE           28210000
ZX                         ADD +1                     TO                28220000
ZX                                PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)28230000
ZX                         ADD ML017-PC-DIFFER-AMT TO                   28240000
ZX                                PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)28250000
ZX                         MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT    28260000
ZX                         MOVE PC-OWN-RETRN-ADJ      TO WS-DISC-TYPE   28270000
ZX                         MOVE 'MD'                  TO WS-MDWN-TYPE   28280000
ZX                         PERFORM 8195-BUILD-DAY02-TRANS-RECORD        28290000
ZX                         PERFORM 8195-WRITE-DAY02-TRANS-RECORD        28300000
ZX                     END-IF                                           28310000
ZX                 END-IF                                               28320000
285400         ELSE                                                     28330000
285500              IF PV-CUST-CHRGD-AMT < PV-EXTENDED-AMT              28340000
285600                  IF EPITM-PROMO-INTFC-ID NOT = ZERO              28350000
214615                  OR EPITM-PROMO-SCHM-CDE NOT = ZERO              28360000
285700                     PERFORM 3500-PROMO-MARKDOWN-CANCEL           28370000
285800                  ELSE                                            28380000
285900                     PERFORM 3600-MARKDOWN-CANCEL                 28390000
286000                  END-IF                                          28400000
286100              END-IF                                              28410000
286200         END-IF                                                   28420000
286300     ELSE                                                         28430000
286400     EVALUATE TRUE                                                28440000
286500        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        28450000
286600           MOVE PC-OWN-ADJ-796        TO                          28460000
286700                ML017-PC-MKDN-MKUP-RSN-CDE                        28470000
286800           SET ML017-MARKDOWN-CANCEL  TO TRUE                     28480000
286900           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      28490000
287000           MOVE PV-PRICE-CHANGE-AMOUNT                            28500000
287100                                      TO ML017-PC-NEW-PR-AMT      28510000
287200                                         ML017-PC-DIFFER-AMT      28520000
287300           ADD +1                     TO                          28530000
287400               PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)              28540000
287500           ADD ML017-PC-DIFFER-AMT    TO PT-OWNERSHIP-ADJ-MDC-AMT 28550000
287600                                         (PV-TOT-SUB)             28560000
ZX               MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT              28570000
ZX               MOVE PC-OWNERSHIP-ADJ      TO WS-DISC-TYPE             28580000
ZX               MOVE 'MDC'                 TO WS-MDWN-TYPE             28590000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  28600000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  28610000
287700                                                                  28620000
289100        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO                        28630000
289200           SET ML017-MARKDOWN         TO TRUE                     28640000
289300           MOVE EPITM-OWND-UNT-RTL-AMT                            28650000
289400                                      TO ML017-PC-NEW-PR-AMT      28660000
289500           MOVE EPITM-CUST-CHRGD-AMT TO ML017-PC-OLD-PR-AMT       28670000
289600                                                                  28680000
289700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      28690000
289800                                       - ML017-PC-NEW-PR-AMT      28700000
289900                                                                  28710000
290900           MOVE PC-OWN-RTN-ADJ-792    TO                          28720000
291000                ML017-PC-MKDN-MKUP-RSN-CDE                        28730000
291100           SET ML017-BN-OWN-RTN-ADJ TO TRUE                       28740000
291200           ADD +1                  TO                             28750000
291300               PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)             28760000
291400           ADD ML017-PC-DIFFER-AMT TO                             28770000
291500                  PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)          28780000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                28790000
ZX               MOVE PC-OWN-RETRN-ADJ   TO WS-DISC-TYPE                28800000
ZX               MOVE 'MD'               TO WS-MDWN-TYPE                28810000
ZX    *          DISPLAY 'MD 1'                                         28820000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  28830000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  28840000
291600        WHEN OTHER                                                28850000
291700           MOVE ZERO TO ML017-PC-DIFFER-AMT                       28860000
291800     END-EVALUATE                                                 28870000
291900     END-IF.                                                      28880000
292000                                                                  28890000
214615 3140-NEW-PROCESS.                                                28900000
214615                                                                  28910000
214615     MOVE ZERO TO ML017-PC-DIFFER-AMT.                            28920000
214615                                                                  28930000
214615     IF (EPITM-SAL-TYP-CDE  = PC-REGULAR-R                        28940000
214615     OR  EPITM-SAL-TYP-CDE  = PC-PROMO-P                          28950000
214615     OR  EPITM-SAL-TYP-CDE  = PC-UNKNOWN-N)                       28960000
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-REGULAR-R                   28970000
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                     28980000
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-UNKNOWN-N)                  28990000
214615        IF EPITM-REG-RTL-AMT > EPITM-ORIG-REG-RTL-AMT             29000000
214615***      WT SALE, WT RETURN PM UP                                 29010000
214615           PERFORM 3142-MARKUP-RTN                                29020000
214615        ELSE                                                      29030000
214615***      WT SALE, WT RETURN PM DOWN                               29040000
214615           PERFORM 3146-MARKDOWN-RTN                              29050000
214615        END-IF                                                    29060000
214615     END-IF.                                                      29070000
214615                                                                  29080000
214615     IF (EPITM-SAL-TYP-CDE = PC-GOLDSTAR-G                        29090000
214615     OR  EPITM-SAL-TYP-CDE = PC-CLEARANCE-C)                      29100000
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G                  29110000
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-CLEARANCE-C)                29120000
214615        IF EPITM-REG-RTL-AMT < EPITM-ORIG-REG-RTL-AMT             29130000
214615***      CL SALE, CL RETURN PM DOWN                               29140000
214615           PERFORM 3146-MARKDOWN-RTN                              29150000
214615        ELSE                                                      29160000
214615***      CL SALE, CL RETURN PM UP                                 29170000
214615           PERFORM 3144-MARKDOWN-CANCEL-RTN                       29180000
214615        END-IF                                                    29190000
214615     END-IF.                                                      29200000
214615                                                                  29210000
214615     IF (EPITM-SAL-TYP-CDE = PC-REGULAR-R                         29220000
214615     OR  EPITM-SAL-TYP-CDE = PC-PROMO-P                           29221000
214615     OR  EPITM-SAL-TYP-CDE = PC-UNKNOWN-N)                        29222000
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G                  29223000
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-CLEARANCE-C)                29224000
214615       IF EPITM-REG-RTL-AMT > EPITM-ORIG-REG-RTL-AMT              29225000
214615***     CL SALE, WT RETURN PM UP                                  29226000
214615          PERFORM 3144-MARKDOWN-CANCEL-RTN                        29227000
214615      ELSE                                                        29228000
214615***     CL SALE, WT RETURN PM DOWN                                29229000
214615          PERFORM 3146-MARKDOWN-RTN                               29229100
214615       END-IF                                                     29229200
214615     END-IF.                                                      29229300
214615                                                                  29229400
214615     IF (EPITM-SAL-TYP-CDE = PC-GOLDSTAR-G                        29229500
214615     OR  EPITM-SAL-TYP-CDE = PC-CLEARANCE-C)                      29229600
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-REGULAR-R                   29229700
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                     29229800
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-UNKNOWN-N)                  29229900
214615       IF EPITM-REG-RTL-AMT > EPITM-ORIG-REG-RTL-AMT              29230000
214615***     WT SALE, CL RETURN PM UP                                  29230100
214615          PERFORM 3142-MARKUP-RTN                                 29230200
214615       ELSE                                                       29230300
214615***     WT SALE, CL RETURN PM DOWN                                29230400
214615          PERFORM 3146-MARKDOWN-RTN                               29230500
214615       END-IF                                                     29230600
214615     END-IF.                                                      29230700
214615                                                                  29230800
214615******************************************************************29230900
214615 3142-MARKUP-RTN.                                                 29231000
214615                                                                  29231100
214615     SET ML017-MKUP                                               29231200
214615         ML017-MARKUP                                             29231300
214615         ML017-RC-MISCELLANEOUS                                   29231400
214615         ML017-BN-OWN-RTN-ADJ                                     29231500
214615         ML017-REGISTER-MKDN-MKON     TO TRUE.                    29231600
214615                                                                  29231700
214615     MOVE PC-OWN-RTN-ADJ-792     TO ML017-PC-MKDN-MKUP-RSN-CDE.   29231800
214615     MOVE EPITM-ORIG-REG-RTL-AMT TO ML017-PC-OLD-PR-AMT.          29231900
214615     MOVE EPITM-REG-RTL-AMT      TO ML017-PC-NEW-PR-AMT.          29232000
214615     COMPUTE ML017-PC-DIFFER-AMT  = ML017-PC-OLD-PR-AMT           29232100
214615                                  - ML017-PC-NEW-PR-AMT.          29232200
214615                                                                  29232300
214615     ADD +1                      TO                               29232400
214615                           PT-OWN-RETRN-ADJ-MKUP-QTY (PV-TOT-SUB).29232500
214615     ADD ML017-PC-DIFFER-AMT     TO                               29232600
214615                           PT-OWN-RETRN-ADJ-MKUP-AMT (PV-TOT-SUB).29232700
ZX                                                                      29232800
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             29232900
ZX         MOVE PC-OWN-RETRN-ADJ            TO WS-DISC-TYPE.            29233000
ZX         MOVE 'MU'                        TO WS-MDWN-TYPE.            29233100
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       29233200
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       29233300
214615                                                                  29233400
ZX          COMPUTE PV-DIFF = (EPITM-ORIG-REG-RTL-AMT                   29233500
ZX                          +  EPITM-CUST-CHRGD-AMT) * -1.              29233600
ZX          IF (EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P OR                  29233700
ZX              EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G) AND             29233800
ZX             PV-DIFF NOT = 0                                          29233900
214615        PERFORM 4000-PROCESS-MARKDOWN-MARKUP                      29234000
214615        PERFORM 3850-PROMO-MARKDOWN2                              29234100
214615     END-IF.                                                      29234200
214615                                                                  29234300
214615******************************************************************29234400
214615 3144-MARKDOWN-CANCEL-RTN.                                        29234500
214615                                                                  29234600
214615     SET ML017-MKDOWN                                             29234700
214615         ML017-MARKDOWN-CANCEL                                    29234800
214615         ML017-RC-MISCELLANEOUS                                   29234900
214615         ML017-BN-OWN-RTN-ADJ                                     29235000
214615         ML017-REGISTER-MKDN-MKON TO TRUE.                        29235100
214615                                                                  29235200
214615     MOVE PC-OWN-RTN-ADJ-792     TO ML017-PC-MKDN-MKUP-RSN-CDE.   29235300
214615     MOVE EPITM-ORIG-REG-RTL-AMT TO ML017-PC-OLD-PR-AMT.          29235400
214615     MOVE EPITM-REG-RTL-AMT      TO ML017-PC-NEW-PR-AMT.          29235500
214615     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            29235600
214615                                 - ML017-PC-NEW-PR-AMT.           29235700
214615                                                                  29235800
214615     ADD +1                     TO                                29235900
214615                           PT-OWN-RETRN-ADJ-MDC-QTY (PV-TOT-SUB). 29236000
214615     ADD ML017-PC-DIFFER-AMT    TO                                29236100
214615                           PT-OWN-RETRN-ADJ-MDC-AMT (PV-TOT-SUB). 29236200
ZX                                                                      29236300
ZX    *    MOVE 'Y'                         TO WS-ISSUE-IND.            29236400
ZX    * ADDED THE FOLLOWING TO FIX ML PRODUCTION ISSUE WITH MDC         29236500
ZX    * RELATED TO MLKUP021'S MDC TO MD FLIP LOGIC                      29236600
ZX         MOVE ZERO                   TO ML017-PC-OLD-PR-AMT.          29236700
ZX         MOVE ML017-PC-DIFFER-AMT    TO ML017-PC-NEW-PR-AMT.          29236800
ZX                                                                      29236900
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             29237000
ZX         MOVE PC-OWN-RETRN-ADJ            TO WS-DISC-TYPE.            29237100
ZX         MOVE 'MDC'                       TO WS-MDWN-TYPE.            29237200
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       29237300
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       29237400
214615                                                                  29237500
ZX          COMPUTE PV-DIFF = (EPITM-ORIG-REG-RTL-AMT                   29237600
ZX                          +  EPITM-CUST-CHRGD-AMT) * -1.              29237700
ZX          IF (EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P OR                  29237800
ZX              EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G) AND             29237900
ZX             PV-DIFF NOT = 0                                          29238000
214615        PERFORM 4000-PROCESS-MARKDOWN-MARKUP                      29238100
214615        PERFORM 3850-PROMO-MARKDOWN2                              29238200
214615     END-IF.                                                      29238300
214615                                                                  29238400
214615******************************************************************29238500
214615 3146-MARKDOWN-RTN.                                               29238600
214615                                                                  29238700
214615     SET ML017-MKDOWN                                             29238800
214615         ML017-RC-MISCELLANEOUS                                   29238900
214615         ML017-BN-OWN-RTN-ADJ                                     29239000
ZX             ML017-MARKDOWN                                           29239100
214615         ML017-REGISTER-MKDN-MKON TO TRUE.                        29239200
214615                                                                  29239300
214615     MOVE PC-OWN-RTN-ADJ-792     TO ML017-PC-MKDN-MKUP-RSN-CDE.   29239400
214615     MOVE EPITM-ORIG-REG-RTL-AMT TO ML017-PC-OLD-PR-AMT.          29239500
214615     MOVE EPITM-REG-RTL-AMT      TO ML017-PC-NEW-PR-AMT.          29239600
214615     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            29239700
214615                                 - ML017-PC-NEW-PR-AMT.           29239800
214615                                                                  29239900
214615     ADD +1                      TO                               29240000
214615                           PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB).29240100
214615     ADD ML017-PC-DIFFER-AMT     TO                               29240200
214615                           PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB).29240300
214615                                                                  29240400
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             29240500
ZX         MOVE PC-OWN-RETRN-ADJ            TO WS-DISC-TYPE.            29240600
ZX         MOVE 'MD'                        TO WS-MDWN-TYPE.            29240700
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       29240800
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       29240900
ZX                                                                      29241000
ZX         COMPUTE PV-DIFF = (EPITM-ORIG-REG-RTL-AMT                    29241100
ZX                         +  EPITM-CUST-CHRGD-AMT) * -1.               29241200
ZX         IF (EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P OR                   29241300
ZX             EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G) AND              29241400
ZX            PV-DIFF NOT = 0                                           29241500
214615        PERFORM 4000-PROCESS-MARKDOWN-MARKUP                      29241600
214615        PERFORM 3850-PROMO-MARKDOWN2                              29241700
214615     END-IF.                                                      29241800
214615                                                                  29241900
292100******************************************************************29242000
292200 3200-SELECT-GROUP-PRICING.                                       29242100
292300*     CHECK IF ITEM IS GROUP PRICED.                              29242200
292400******************************************************************29242300
292500                                                                  29242400
293000     EXEC SQL                                                     29242500
293100        SELECT  GP_QTY                                            29242600
293200               ,GP_AMT                                            29242700
293300          INTO :EPIGP-GP-QTY                                      29242800
293400              ,:EPIGP-GP-AMT                                      29242900
293500          FROM  TEPIGP                                            29243000
293600         WHERE  PARTN_NBR        = :PV-PARTN-NBR                  29244000
293700           AND  STR_NBR          = :PV-STR-NBR                    29245000
293800           AND  RGST_ID          = :PV-RGST-ID                    29246000
293900           AND  TRN_NBR          = :PV-TRN-NBR                    29247000
294000           AND  STRT_TM          = :PV-STRT-TM                    29248000
294100           AND  SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           29249000
294200           AND  LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            29250000
294300                WITH UR                                           29260000
294400     END-EXEC.                                                    29270000
294500                                                                  29280000
294600     EVALUATE TRUE                                                29290000
294700        WHEN SQLCODE = ZERO                                       29300000
294800        WHEN SQLCODE = PC-ROW-NOT-FOUND                           29310000
294900*          DISPLAY '  EPIGP-GP-QTY = ' EPIGP-GP-QTY               29320000
295000*          DISPLAY '  EPIGP-GP-AMT = ' EPIGP-GP-AMT               29330000
295100           CONTINUE                                               29340000
295200                                                                  29350000
295300        WHEN OTHER                                                29360000
295400           MOVE '3200-SELECT-GROUP-PRICING'                       29370000
295500                                        TO PV-PARAGRAPH-NAME      29380000
244800           SET AC-DB2-ERROR           TO TRUE                     29390000
295600           PERFORM 9999-ABEND                                     29400000
295700     END-EVALUATE.                                                29410000
295800                                                                  29420000
295900******************************************************************29430000
296000 3300-CALC-EXTENDED-AMT.                                          29440000
296100*     CALCULATE THE EXTENDED AMOUNT.                              29450000
296200******************************************************************29460000
296300                                                                  29470000
296800     EVALUATE TRUE                                                29480000
296900        WHEN EPITM-PRIC-SRC-CDE        = 'I'                      29490000
297000           COMPUTE PV-EXTENDED-AMT     = EPITM-OWND-UNT-RTL-AMT   29500000
297100                                       * EPITM-SLD-QTY            29510000
297200                                                                  29520000
297300        WHEN EPITM-REG-RTL-AMT         < ZERO                     29530000
297400*****   TO CORRECT THE PROBLEM OF NOT CALCULATING MARKDOWN FOR    29540000
297500*****   NET RING OFFLINE SALE ITEMS, THIS IF STATEMENT IS REMOVED.29550000
297600*          IF EPITM-REG-RTL-ORGN-CDE = 'C'                        29560000
297700*             COMPUTE PV-EXTENDED-AMT                             29570000
297800*                   = EPITM-CUST-CHRGD-AMT * (-1)                 29580000
297900*          ELSE                                                   29590000
298000              COMPUTE PV-EXTENDED-AMT = EPITM-REG-RTL-AMT * (-1)  29600000
298100*          END-IF                                                 29610000
298200                                                                  29620000
298300        WHEN EPITM-REG-RTL-AMT         > ZERO                     29630000
298400*****   TO CORRECT THE PROBLEM OF NOT CALCULATING MARKDOWN FOR    29640000
298500*****   DUMMY SKU, NEED TO REMOVE THIS IF STATEMENT.              29650000
298600*          IF PV-SKU-LST-3-DGT     EQUAL ZERO                     29660000
298700*             MOVE EPITM-CUST-CHRGD-AMT TO PV-EXTENDED-AMT        29670000
298800*          ELSE                                                   29680000
298900*****   TO CORRECT THE PROBLEM OF NOT CALCULATING MARKDOWN FOR    29690000
299000*****   NET RING OFFLINE SALE ITEMS, THIS IF STATEMENT IS REMOVED.29700000
299100*             IF EPITM-REG-RTL-ORGN-CDE = 'C'                     29710000
299200*                MOVE EPITM-CUST-CHRGD-AMT TO PV-EXTENDED-AMT     29720000
299300*             ELSE                                                29730000
299400*****   RED-TICKET ITEMS; NO MARKDOWN. GOLDSTAR SHOULD NOT GO     29740000
299500*****   THROUGH THIS LOGIC BUT CODED FOR JUST IN CASE.            29750000
299600                 IF EPITM-REG-RTL-ORGN-CDE = 'P' AND              29760000
299700                    EPITM-PRIC-SRC-CDE = 'K' AND                  29770000
299800                    EPITM-SAL-TYP-CDE EQUAL ('C' OR 'G')          29780000
ZX    *                   EPITM-SAL-TYP-CDE EQUAL ('C' OR 'G') AND      29790000
ZX    *                   EPTRN-POS-CPBL-LVL-NBR NOT = PC-POC           29800000
299900                    MOVE EPITM-CUST-CHRGD-AMT TO PV-EXTENDED-AMT  29810000
300000                 ELSE                                             29820000
300100                    MOVE EPITM-REG-RTL-AMT TO PV-EXTENDED-AMT     29830000
300200                 END-IF                                           29840000
300300*             END-IF                                              29850000
300400*          END-IF                                                 29860000
300500        WHEN OTHER                                                29870000
300600           IF EPITM-CUST-CHRGD-AMT     < ZERO                     29880000
300700              COMPUTE PV-EXTENDED-AMT  = EPITM-CUST-CHRGD-AMT     29890000
300800                                       * (-1)                     29900000
300900           ELSE                                                   29910000
301000              MOVE EPITM-CUST-CHRGD-AMT                           29920000
301100                                      TO PV-EXTENDED-AMT          29930000
301200           END-IF                                                 29940000
301300     END-EVALUATE.                                                29950000
301400                                                                  29960000
302400******************************************************************29970000
302500 3400-MARKUP-CANCEL.                                              29980000
302600*     PROCESS BACK OFFICE MARKUP CANCEL FOR QUALIFY SALE ITEMS.   29990000
302700*     SAL_RET_CDE = 'S' AND 'A'. LIV-RSLU-CDE = '-'.              30000000
302800*     SAL_RET_CDE = 'R' AND POC RETURN                            30010000
302900******************************************************************30020000
303000                                                                  30030000
303500     SET ML017-MKUP                                               30040000
303600         ML017-MARKUP-CANCEL                                      30050000
303700         ML017-RC-MISCELLANEOUS                                   30060000
303800         ML017-BN-OWN-ADJ                                         30070000
303900         ML017-REGISTER-MKDN-MKON     TO TRUE.                    30080000
304000                                                                  30090000
304100     MOVE PC-OWN-ADJ-796           TO ML017-PC-MKDN-MKUP-RSN-CDE. 30100000
304200                                                                  30110000
304300     PERFORM 6300-SELECT-TIERED.                                  30120000
304400                                                                  30130000
304500     IF PS-TIERED-ITEM-NO                                         30140000
MUCFIX        DISPLAY '3400- NOT TIERED '                               30141023
MUCFIX        DISPLAY 'PV-CUST-CHRGD-AMT   = ' PV-CUST-CHRGD-AMT        30142023
MUCFIX        DISPLAY 'PV-EXTENDED-AMT     = ' PV-EXTENDED-AMT          30143023
MUCFIX*       COMPUTE ML017-PC-OLD-PR-AMT = PV-CUST-CHRGD-AMT           30180023
MUCFIX*                                   + PV-CUST-CHRGD-AMT           30190023
MUCFIX*                                   - PV-EXTENDED-AMT             30200023
MUCFIX        MOVE PV-EXTENDED-AMT       TO ML017-PC-OLD-PR-AMT         30201023
305200     ELSE                                                         30210000
305300*    DISPLAY 'EPITM-CUST-CHRGD-AMT ' EPITM-CUST-CHRGD-AMT         30220000
305400*    DISPLAY 'EPLID-LID-AMT ' EPLID-LID-AMT                       30230000
305500        COMPUTE ML017-PC-OLD-PR-AMT = EPITM-CUST-CHRGD-AMT        30240000
305600                                    + EPLID-LID-AMT               30250000
305700     END-IF.                                                      30260000
MUCFIX     DISPLAY 'ML017-PC-OLD-PR-AMT = ' ML017-PC-OLD-PR-AMT         30270023
305900                                                                  30280000
306000     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     30290000
MUCFIX     DISPLAY 'ML017-PC-NEW-PR-AMT = ' ML017-PC-NEW-PR-AMT         30291023
306200                                                                  30310000
306300     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            30320000
306400                                 - ML017-PC-NEW-PR-AMT.           30330000
MUCFIX     DISPLAY 'ML017-PC-DIFFER-AMT = ' ML017-PC-DIFFER-AMT.        30340024
306600                                                                  30350000
306700     ADD +1                           TO PT-OWNERSHIP-ADJ-MUC-QTY 30360000
306800                                         (PV-TOT-SUB).            30370000
306900     ADD ML017-PC-DIFFER-AMT          TO PT-OWNERSHIP-ADJ-MUC-AMT 30380000
307000                                         (PV-TOT-SUB).            30390000
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             30400000
ZX         MOVE PC-OWNERSHIP-ADJ            TO WS-DISC-TYPE.            30410000
ZX         MOVE 'MUC'                       TO WS-MDWN-TYPE.            30420000
ZX    *    IF PV-TOT-SUB NOT EQUAL TO 1                                 30430000
ZX    *        DISPLAY PV-TOT-SUB                                       30440000
ZX    *    END-IF.                                                      30450000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       30460000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       30470000
307100                                                                  30480000
307700******************************************************************30490000
307800 3500-PROMO-MARKDOWN-CANCEL.                                      30500000
307900*     PROCESS BACK OFFICE PROMO MARKDOWN CANCEL FOR QUALIFY SALE  30510000
062118*     ITEMS. SAL_RET_CDE = 'R' OR 'A' AND POC RETURN              30520000
308100******************************************************************30530000
308200                                                                  30540000
308700     SET ML017-MKDOWN                                             30550000
308800         ML017-MARKDOWN-CANCEL                                    30560000
308900         ML017-RC-PROMOTIONAL                                     30570000
309000         ML017-BN-PROMOTIONAL                                     30580000
309100         ML017-PLU-MKDN-MKON          TO TRUE.                    30590000
309200                                                                  30600000
309300     MOVE PC-746-PLU-TIER             TO                          30610000
309400          ML017-PC-MKDN-MKUP-RSN-CDE.                             30620000
309500     MOVE ZERO                        TO ML017-PC-OLD-PR-AMT.     30630000
309600     COMPUTE ML017-PC-NEW-PR-AMT = PV-EXTENDED-AMT                30640000
309700                                 + EPITM-CUST-CHRGD-AMT           30650000
309800                                                                  30660000
309900     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            30670000
310000                                 - ML017-PC-NEW-PR-AMT.           30680000
310100                                                                  30690000
310200     ADD +1                           TO PT-PROMOTIONAL-MDC-QTY   30700000
310300                                         (PV-TOT-SUB).            30710000
310400     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MDC-AMT   30720000
310500                                         (PV-TOT-SUB).            30730000
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             30740000
ZX         MOVE PC-PROMOTIONAL              TO WS-DISC-TYPE.            30750000
ZX         MOVE 'MDC'                       TO WS-MDWN-TYPE.            30760000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       30770000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       30780000
310600                                                                  30790000
310700******************************************************************30800000
310800 3600-MARKDOWN-CANCEL.                                            30810000
310900*     PROCESS BACK OFFICE MARKDOWN CANCEL FOR QUALIFY SALE ITEMS. 30820000
311000*     SAL_RET_CDE = 'S' AND 'A'. LIV-RSLU-CDE = '-'.              30830000
311100*     SAL_RET_CDE = 'R' AND POC RETURN                            30840000
311200******************************************************************30850000
311300                                                                  30860000
311800     SET ML017-MKDOWN                                             30870000
311900         ML017-MARKDOWN-CANCEL                                    30880000
312000         ML017-RC-MISCELLANEOUS                                   30890000
312100         ML017-BN-OWN-ADJ                                         30900000
312200         ML017-REGISTER-MKDN-MKON  TO TRUE.                       30910000
312300                                                                  30920000
312400     MOVE PC-OWN-ADJ-796           TO ML017-PC-MKDN-MKUP-RSN-CDE. 30930000
312500     MOVE ZERO                     TO ML017-PC-OLD-PR-AMT.        30940000
312600                                                                  30950000
312700     COMPUTE ML017-PC-NEW-PR-AMT = PV-EXTENDED-AMT                30960000
312800                                 - PV-CUST-CHRGD-AMT.             30970000
312900                                                                  30980000
313000     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            30990000
313100                                 - ML017-PC-NEW-PR-AMT.           31000000
313200                                                                  31010000
313300     ADD +1                        TO PT-OWNERSHIP-ADJ-MDC-QTY    31020000
313400                                      (PV-TOT-SUB).               31030000
313500     ADD ML017-PC-DIFFER-AMT       TO PT-OWNERSHIP-ADJ-MDC-AMT    31040000
313600                                      (PV-TOT-SUB).               31050000
ZX         MOVE ML017-PC-DIFFER-AMT      TO WS-DISC-AMT.                31060000
ZX         MOVE PC-OWNERSHIP-ADJ         TO WS-DISC-TYPE.               31070000
ZX         MOVE 'MDC'                    TO WS-MDWN-TYPE.               31080000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       31090000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       31100000
313700                                                                  31110000
259100******************************************************************31120000
259200 3650-MARKDOWN-CORR-CANCEL.                                       31130000
259300*     PROCESS BACK OFFICE MARKDOWN CANCEL FOR QUALIFY SALE ITEMS. 31140000
259400******************************************************************31150000
259500                                                                  31160000
259600     SET ML017-MKDOWN                                             31170000
259700         ML017-RC-MISCELLANEOUS                                   31180000
259800         ML017-BN-OWN-ADJ                                         31190000
259900         ML017-REGISTER-MKDN-MKON  TO TRUE.                       31200000
260000                                                                  31210000
260100     COMPUTE PV-PRICE-CHANGE-AMOUNT = (EPITM-CUST-CHRGD-AMT       31220000
260200                                    +  EPITM-REG-RTL-AMT          31230000
260300                                    *  EPITM-SLD-QTY)             31240000
260400                                    *  -1.                        31250000
260500                                                                  31260000
260600     EVALUATE TRUE                                                31270000
260700        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        31280000
260800           MOVE PC-OWN-ADJ-796        TO                          31290000
260900                ML017-PC-MKDN-MKUP-RSN-CDE                        31300000
261000           SET ML017-MARKDOWN-CANCEL  TO TRUE                     31310000
261100           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      31320000
261200           MOVE PV-PRICE-CHANGE-AMOUNT                            31330000
261300                                      TO ML017-PC-NEW-PR-AMT      31340000
261400                                         ML017-PC-DIFFER-AMT      31350000
261500           ADD +1                     TO                          31360000
261600               PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)              31370000
261700           ADD ML017-PC-DIFFER-AMT    TO PT-OWNERSHIP-ADJ-MDC-AMT 31380000
261800                                         (PV-TOT-SUB)             31390000
ZX               MOVE ML017-PC-DIFFER-AMT      TO WS-DISC-AMT           31400000
ZX               MOVE PC-OWNERSHIP-ADJ         TO WS-DISC-TYPE          31410000
ZX               MOVE 'MDC'                    TO WS-MDWN-TYPE          31420000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  31430000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  31431000
261900        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO                        31431100
262000           SET ML017-MARKDOWN         TO TRUE                     31431200
262100           MOVE EPITM-OWND-UNT-RTL-AMT                            31431300
262200                                      TO ML017-PC-NEW-PR-AMT      31431400
262300           MOVE EPITM-CUST-CHRGD-AMT TO ML017-PC-OLD-PR-AMT       31431500
262400                                                                  31431600
262500           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      31431700
262600                                       - ML017-PC-NEW-PR-AMT      31431800
262700           MOVE PC-OWN-RTN-ADJ-792    TO                          31431900
262800                ML017-PC-MKDN-MKUP-RSN-CDE                        31432000
262900           SET ML017-BN-OWN-RTN-ADJ TO TRUE                       31432100
263000           ADD +1                  TO                             31432200
263100               PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)             31432300
263200           ADD ML017-PC-DIFFER-AMT TO                             31432400
263300                  PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)          31432500
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                31432600
ZX               MOVE PC-OWN-RETRN-ADJ   TO WS-DISC-TYPE                31432700
ZX               MOVE 'MD'               TO WS-MDWN-TYPE                31432800
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  31432900
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  31433000
263400        WHEN OTHER                                                31433100
263500           MOVE ZERO TO ML017-PC-DIFFER-AMT                       31433200
263600     END-EVALUATE.                                                31433300
263700                                                                  31433400
263800     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        31433500
263900                                                                  31433600
314300******************************************************************31433700
314400*3650-MARKDOWN-CORR-CANCEL.                                       31433800
314500*     PROCESS BACK OFFICE MARKDOWN CANCEL FOR QUALIFY SALE ITEMS. 31433900
314600******************************************************************31434000
314700                                                                  31435000
315200*    SET ML017-MKDOWN                                             31436000
315300*        ML017-RC-MISCELLANEOUS                                   31437000
315400*        ML017-BN-OWN-ADJ                                         31438000
315500*        ML017-REGISTER-MKDN-MKON  TO TRUE.                       31439000
315600*                                                                 31440000
315700*    MOVE PC-OWN-ADJ-796       TO ML017-PC-MKDN-MKUP-RSN-CDE.     31450000
315800*                                                                 31460000
315900*    MOVE EPITM-REG-RTL-AMT    TO ML017-PC-OLD-PR-AMT.            31470000
316000*    MOVE EPITM-CUST-CHRGD-AMT TO ML017-PC-NEW-PR-AMT.            31480000
316100*                                                                 31490000
316200*    COMPUTE ML017-PC-OLD-PR-AMT =                                31500000
316300*            ML017-PC-OLD-PR-AMT * (-1).                          31510000
316400                                                                  31520000
316500*    COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            31530000
316600*                                - ML017-PC-NEW-PR-AMT.           31540000
316700*                                                                 31550000
316800*    IF ML017-PC-DIFFER-AMT IS POSITIVE                           31560000
316900*       COMPUTE ML017-PC-DIFFER-AMT =                             31570000
317000*               ML017-PC-DIFFER-AMT * (-1)                        31580000
317100*    END-IF.                                                      31590000
317200*                                                                 31600000
317300*    ADD +1                        TO PT-OWNERSHIP-ADJ-MDC-QTY    31610000
317400*                                     (PV-TOT-SUB).               31620000
317500*                                                                 31630000
317600*    ADD ML017-PC-DIFFER-AMT       TO PT-OWNERSHIP-ADJ-MDC-AMT    31640000
317700*                                     (PV-TOT-SUB).               31650000
317800*                                                                 31660000
318400*    PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        31670000
318500                                                                  31680000
318600******************************************************************31690000
318700 3700-SALE-MARKUP.                                                31700000
318800*     PROCESS BACK OFFICE MARKUP FOR QUALIFY SALE ITEMS.          31710000
318900*     SAL_RET_CDE = 'S' AND 'A'. LIV-RSLU-CDE = '+'.              31720000
319000*     SAL_RET_CDE = 'R' AND POC RETURN.                           31730000
319100******************************************************************31740000
319200                                                                  31750000
320200     SET ML017-MKUP                                               31760000
320300         ML017-MARKUP                                             31770000
320400         ML017-RC-MISCELLANEOUS                                   31780000
320500         ML017-BN-OWN-ADJ                                         31790000
320600         ML017-REGISTER-MKDN-MKON     TO TRUE.                    31800000
320700                                                                  31810000
320800     MOVE PC-OWN-ADJ-796              TO                          31820000
320900          ML017-PC-MKDN-MKUP-RSN-CDE.                             31830000
321000     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-OLD-PR-AMT.     31840000
321100                                                                  31850000
321200     COMPUTE ML017-PC-NEW-PR-AMT = EPITM-CUST-CHRGD-AMT           31860000
321300                                 + EPITM-CUST-CHRGD-AMT           31870000
321400                                 - PV-EXTENDED-AMT.               31880000
321500                                                                  31890000
321600     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            31900000
321700                                 - ML017-PC-NEW-PR-AMT.           31910000
321800                                                                  31920000
321900     ADD +1                          TO PT-OWNERSHIP-ADJ-MKUP-QTY 31930000
322000                                        (PV-TOT-SUB).             31940000
322100     ADD ML017-PC-DIFFER-AMT         TO                           31950000
322200                                        PT-OWNERSHIP-ADJ-MKUP-AMT 31960000
322300                                        (PV-TOT-SUB).             31970000
ZX         MOVE ML017-PC-DIFFER-AMT      TO WS-DISC-AMT.                31980000
ZX         MOVE PC-OWNERSHIP-ADJ         TO WS-DISC-TYPE.               31990000
ZX         MOVE 'MU'                     TO WS-MDWN-TYPE.               32000000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       32010000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       32020000
322400                                                                  32030000
323500******************************************************************32040000
323600 3800-PROMO-MARKDOWN.                                             32050000
323700*     PROCESS PROMOTIONAL MARKDOWN ITEMS.                         32060000
323800******************************************************************32070000
323900                                                                  32080000
324900     SET ML017-MKDOWN                                             32090000
325000         ML017-MARKDOWN                                           32100000
325100         ML017-RC-PROMOTIONAL                                     32110000
325200         ML017-BN-PROMOTIONAL                                     32120000
325300         ML017-PLU-MKDN-MKON          TO TRUE.                    32130000
325400                                                                  32140000
325500     MOVE PC-746-PLU-TIER             TO                          32150000
325600          ML017-PC-MKDN-MKUP-RSN-CDE.                             32160000
325700     MOVE PV-EXTENDED-AMT             TO ML017-PC-OLD-PR-AMT.     32170000
325800     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     32180000
325900                                                                  32190000
326000     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            32200000
326100                                 - ML017-PC-NEW-PR-AMT.           32210000
326200                                                                  32220000
326300     ADD +1                           TO PT-PROMOTIONAL-MKDN-QTY  32230000
326400                                         (PV-TOT-SUB).            32240000
326500     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MKDN-AMT  32250000
326600                                         (PV-TOT-SUB).            32260000
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             32270000
ZX         MOVE PC-PROMOTIONAL              TO WS-DISC-TYPE.            32280000
ZX         MOVE 'MD'                        TO WS-MDWN-TYPE.            32290000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       32300000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       32310000
326700                                                                  32320000
328000     DISPLAY 'STR_NBR             = ' PV-STR-NBR.                 32330000
328100     DISPLAY 'RGST_ID             = ' PV-RGST-ID.                 32340000
328200     DISPLAY 'TRN_NBR             = ' PV-TRN-NBR.                 32350000
328300     DISPLAY 'LINE_ITM_SEQ        = ' EPITM-LNE-ITM-SEQ-NBR.      32360000
328400     DISPLAY 'NET_CHRGD_AMT       = ' EPITM-NET-CHRGD-AMT.        32370000
328500     DISPLAY 'CUST_CHRGD_AMT      = ' EPITM-CUST-CHRGD-AMT.       32380000
328600     DISPLAY 'REG_RTL_AMT         = ' EPITM-REG-RTL-AMT.          32390000
328700     DISPLAY 'PV-EXTENDED-AMT     = ' PV-EXTENDED-AMT.            32400000
328800     DISPLAY 'ML017-PC-OLD-PR-AMT = ' ML017-PC-OLD-PR-AMT.        32410000
328900     DISPLAY 'ML017-PC-NEW-PR-AMT = ' ML017-PC-NEW-PR-AMT.        32420000
329000     DISPLAY 'ML017-PC-DIFFER-AMT = ' ML017-PC-DIFFER-AMT.        32430000
329100     DISPLAY 'MKDWN QTY           = ' PT-PROMOTIONAL-MKDN-QTY     32440000
329200                                      (PV-TOT-SUB).               32450000
329300     DISPLAY 'MKDWN AMT           = ' PT-PROMOTIONAL-MKDN-AMT     32460000
329400                                      (PV-TOT-SUB).               32470000
214615******************************************************************32480000
214615 3850-PROMO-MARKDOWN2.                                            32490000
214615*     PROCESS PROMOTIONAL MARKDOWN ITEMS.                         32500000
214615******************************************************************32510000
214615                                                                  32520000
214615     SET ML017-MKDOWN                                             32530000
214615         ML017-MARKDOWN-CANCEL                                    32540000
214615         ML017-RC-PROMOTIONAL                                     32550000
214615         ML017-BN-PROMOTIONAL                                     32560000
214615         ML017-PLU-MKDN-MKON          TO TRUE.                    32570000
214615                                                                  32580000
214615     MOVE PC-746-PLU-TIER             TO                          32590000
214615                                      ML017-PC-MKDN-MKUP-RSN-CDE. 32600000
214615     MOVE EPITM-ORIG-REG-RTL-AMT      TO ML017-PC-OLD-PR-AMT.     32610000
214615     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     32620000
214615                                                                  32630000
214615     COMPUTE ML017-PC-DIFFER-AMT = (ML017-PC-OLD-PR-AMT           32640000
214615                                 -  ML017-PC-NEW-PR-AMT) * -1.    32650000
214615                                                                  32660000
ZX    * ADDED THE FOLLOWING TO FIX ML PRODUCTION ISSUE WITH MDC         32670000
ZX    * RELATED TO MLKUP021'S MDC TO MD FLIP LOGIC                      32680000
ZX         MOVE ZERO                   TO ML017-PC-OLD-PR-AMT.          32690000
ZX         MOVE ML017-PC-DIFFER-AMT    TO ML017-PC-NEW-PR-AMT.          32700000
ZX                                                                      32710000
214615     ADD +1                           TO PT-PROMOTIONAL-MDC-QTY   32720000
214615                                         (PV-TOT-SUB).            32730000
214615     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MDC-AMT   32740000
214615                                         (PV-TOT-SUB).            32750000
ZX                                                                      32760000
ZX    *    MOVE 'Y'                         TO WS-ISSUE-IND.            32770000
ZX                                                                      32780000
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             32790000
ZX         MOVE PC-PROMOTIONAL              TO WS-DISC-TYPE.            32800000
ZX         MOVE 'MDC'                       TO WS-MDWN-TYPE.            32810000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       32820000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       32830000
214615                                                                  32840000
214615******************************************************************32850000
214615 3860-PROMO-MARKUP2.                                              32860000
214615*     PROCESS PROMOTIONAL MARKDOWN ITEMS.                         32870000
214615******************************************************************32880000
214615                                                                  32890000
214615     SET ML017-MKUP                                               32900000
214615         ML017-RC-PROMOTIONAL                                     32910000
214615         ML017-BN-PROMOTIONAL                                     32920000
214615         ML017-PLU-MKDN-MKON          TO TRUE.                    32930000
214615                                                                  32940000
214615     MOVE PC-746-PLU-TIER             TO                          32950000
214615                                      ML017-PC-MKDN-MKUP-RSN-CDE. 32951000
214615     MOVE EPITM-ORIG-REG-RTL-AMT      TO ML017-PC-OLD-PR-AMT.     32952000
214615     MOVE EPITM-REG-RTL-AMT           TO ML017-PC-NEW-PR-AMT.     32953000
214615                                                                  32954000
214615     COMPUTE ML017-PC-DIFFER-AMT = (ML017-PC-OLD-PR-AMT           32955000
214615                                 -  ML017-PC-NEW-PR-AMT) * -1.    32956000
214615                                                                  32957000
214615     ADD +1                           TO PT-PROMOTIONAL-MDC-QTY   32957100
214615                                         (PV-TOT-SUB).            32957200
214615     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MDC-AMT   32957300
214615                                         (PV-TOT-SUB).            32957400
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             32957500
ZX         MOVE PC-PROMOTIONAL              TO WS-DISC-TYPE.            32957600
ZX         MOVE 'MU'                        TO WS-MDWN-TYPE.            32957700
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       32957800
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       32957900
214615                                                                  32958000
329500******************************************************************32958100
329600 3900-SALE-MARKDOWN.                                              32958200
329700*     PROCESS SALE MARKDOWN ITEMS.                                32958300
329800******************************************************************32958400
329900                                                                  32958500
330800     SET ML017-MKDOWN                                             32958600
330900         ML017-MARKDOWN                                           32958700
331000         ML017-RC-MISCELLANEOUS                                   32958800
331100         ML017-BN-OWN-ADJ                                         32958900
331200         ML017-REGISTER-MKDN-MKON     TO TRUE.                    32959000
331300                                                                  32960000
331400     COMPUTE ML017-PC-OLD-PR-AMT = EPITM-CUST-CHRGD-AMT           32970000
331500                                 + (PV-EXTENDED-AMT               32980000
331600                                 -  EPITM-CUST-CHRGD-AMT).        32990000
331700*    DISPLAY 'EPITM-CUST-CHRGD-AMT ' EPITM-CUST-CHRGD-AMT.        33000000
331800*    DISPLAY '(PV-EXTENDED-AMT ' PV-EXTENDED-AMT.                 33010000
331900*    DISPLAY 'EPITM-CUST-CHRGD-AMT) ' EPITM-CUST-CHRGD-AMT.       33020000
332000*    DISPLAY 'ML017-PC-OLD-PR-AMT ' ML017-PC-OLD-PR-AMT.          33030000
332100                                                                  33040000
332200     IF EPITM-CUST-CHRGD-AMT     = ZERO                           33050000
332300        MOVE PC-704-KEYED-GWP      TO                             33060000
332400                                   ML017-PC-MKDN-MKUP-RSN-CDE     33070000
332500     ELSE                                                         33080000
332600        MOVE PC-OWN-ADJ-796        TO                             33090000
332700                                   ML017-PC-MKDN-MKUP-RSN-CDE     33100000
332800     END-IF.                                                      33110000
332900*    DISPLAY 'ML017-PC-MKDN-MKUP-RSN-CDE ',                       33120000
333000*             ML017-PC-MKDN-MKUP-RSN-CDE                          33130000
333100                                                                  33140000
333200     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     33150000
333300*    DISPLAY 'EPITM-CUST-CHRGD-AMT ' EPITM-CUST-CHRGD-AMT.        33160000
333400*    DISPLAY 'ML017-PC-NEW-PR-AMT ' ML017-PC-NEW-PR-AMT.          33170000
333500                                                                  33180000
333600     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            33190000
333700                                 - ML017-PC-NEW-PR-AMT.           33200000
333800                                                                  33210000
333900*    DISPLAY 'ML017-PC-DIFFER-AMT ' ML017-PC-DIFFER-AMT.          33220000
334000     ADD +1                           TO                          33230000
334100         PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB).                  33240000
334200                                                                  33250000
334300     ADD ML017-PC-DIFFER-AMT          TO                          33260000
334400         PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB).                  33270000
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             33280000
ZX         MOVE PC-OWNERSHIP-ADJ            TO WS-DISC-TYPE.            33290000
ZX         MOVE 'MD'                        TO WS-MDWN-TYPE.            33300000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       33310000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       33320000
334500                                                                  33330000
272700******************************************************************33340000
272800 3950-SALE-CORRECTION-MARKDOWN.                                   33350000
272900*     PROCESS SALE CORRECTION MARKDOWN ITEMS.                     33360000
273000******************************************************************33370000
273100                                                                  33380000
273200     SET ML017-MKDOWN                                             33390000
273300         ML017-MARKDOWN                                           33400000
273400         ML017-RC-MISCELLANEOUS                                   33410000
273500         ML017-BN-OWN-ADJ                                         33420000
273600         ML017-REGISTER-MKDN-MKON     TO TRUE.                    33430000
273700                                                                  33440000
273800     IF EPITM-CUST-CHRGD-AMT = ZERO                               33450000
273900        MOVE PC-704-KEYED-GWP TO ML017-PC-MKDN-MKUP-RSN-CDE       33460000
274000     ELSE                                                         33470000
274100        MOVE PC-OWN-ADJ-796   TO ML017-PC-MKDN-MKUP-RSN-CDE       33480000
274200     END-IF.                                                      33490000
274300                                                                  33500000
274400     MOVE EPITM-REG-RTL-AMT    TO ML017-PC-OLD-PR-AMT.            33501000
274500     MOVE EPITM-CUST-CHRGD-AMT TO ML017-PC-NEW-PR-AMT.            33502000
274600                                                                  33503000
274700     IF  ML017-PC-NEW-PR-AMT < ZERO                               33504000
274800         COMPUTE ML017-PC-NEW-PR-AMT =                            33505000
274900                 ML017-PC-NEW-PR-AMT * (-1)                       33506000
275000     END-IF.                                                      33507000
275100                                                                  33508000
275200     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            33509000
275300                                 - ML017-PC-NEW-PR-AMT.           33510000
275400                                                                  33510100
275500     ADD +1                    TO                                 33510200
275600         PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB).                  33510300
275700                                                                  33510400
275800     ADD ML017-PC-DIFFER-AMT   TO                                 33510500
275900         PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB).                  33510600
ZX         MOVE ML017-PC-DIFFER-AMT  TO WS-DISC-AMT.                    33510700
ZX         MOVE PC-OWNERSHIP-ADJ     TO WS-DISC-TYPE.                   33510800
ZX         MOVE 'MD'                 TO WS-MDWN-TYPE.                   33510900
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       33511000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       33511100
276000                                                                  33511200
276100                                                                  33511300
276200     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        33511400
276300                                                                  33511500
335100******************************************************************33511600
335200*3950-SALE-CORRECTION-MARKDOWN.                                   33511700
335300*     PROCESS SALE CORRECTION MARKDOWN ITEMS.                     33511800
335400******************************************************************33511900
335500                                                                  33512000
336000*    SET ML017-MKDOWN                                             33513000
336100*        ML017-MARKDOWN                                           33514000
336200*        ML017-RC-MISCELLANEOUS                                   33515000
336300*        ML017-BN-OWN-ADJ                                         33516000
336400*        ML017-REGISTER-MKDN-MKON     TO TRUE.                    33517000
336500*                                                                 33518000
336600*    IF EPITM-CUST-CHRGD-AMT = ZERO                               33519000
336700*       MOVE PC-704-KEYED-GWP TO ML017-PC-MKDN-MKUP-RSN-CDE       33520000
336800*    ELSE                                                         33530000
336900*       MOVE PC-OWN-ADJ-796   TO ML017-PC-MKDN-MKUP-RSN-CDE       33540000
337000*    END-IF.                                                      33550000
337100*                                                                 33560000
337200*    MOVE EPITM-REG-RTL-AMT    TO ML017-PC-OLD-PR-AMT.            33570000
337300*    MOVE EPITM-CUST-CHRGD-AMT TO ML017-PC-NEW-PR-AMT.            33580000
337400*                                                                 33590000
337500*    IF  ML017-PC-NEW-PR-AMT < ZERO                               33600000
337600*        COMPUTE ML017-PC-NEW-PR-AMT =                            33610000
337700*                ML017-PC-NEW-PR-AMT * (-1)                       33620000
337800*    END-IF.                                                      33630000
337900*                                                                 33640000
338000*    COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            33650000
338100*                                - ML017-PC-NEW-PR-AMT.           33660000
338200*                                                                 33670000
338300*    ADD +1                    TO                                 33680000
338400*        PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB).                  33690000
338500*                                                                 33700000
338600*    ADD ML017-PC-DIFFER-AMT   TO                                 33710000
338700*        PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB).                  33720000
338800*                                                                 33730000
339500*    PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        33740000
339600*                                                                 33750000
339700******************************************************************33760000
339800 4000-PROCESS-MARKDOWN-MARKUP.                                    33770000
339900*     DETERMINE IF A RECORD SHOULD BE WRITTEN.                    33780000
340000******************************************************************33790000
340100                                                                  33800000
340800     MOVE +1                    TO ML017-PC-QTY.                  33810000
340900     EVALUATE TRUE                                                33820000
341000        WHEN ML017-PC-DIFFER-AMT       = ZERO                     33830000
341100           CONTINUE                                               33840000
341200        WHEN ML017-MKDOWN                                         33850000
341300           IF DPG55-DB2-ISO-DATE-FMT LESS THAN                    33860000
341400                                         PV-CUT-OFF-CCYY-MM-DD    33870000
341500              PERFORM 8025-WRITE-HOLD-LEDGR-MKDN-REC              33880000
341600              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  33890000
341800              PERFORM 8180-FORMAT-MW-RECORD                       33910000
341900              PERFORM 8190-WRITE-DATAWHSE-RECORD                  33920000
342000           ELSE                                                   33930000
342100              PERFORM 8000-WRITE-LEDGER-MKDN-RECORD               33940000
342200              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  33950000
342400              PERFORM 8180-FORMAT-MW-RECORD                       33970000
342500              PERFORM 8190-WRITE-DATAWHSE-RECORD                  33980000
342600           END-IF                                                 33990000
342700                                                                  34000000
342800        WHEN OTHER                                                34010000
342900           IF DPG55-DB2-ISO-DATE-FMT LESS THAN                    34020000
343000                                           PV-CUT-OFF-CCYY-MM-DD  34030000
343100              PERFORM 8125-WRITE-HOLD-LEDGR-MKUP-REC              34040000
343200              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  34050000
343400              PERFORM 8180-FORMAT-MW-RECORD                       34070000
343500              PERFORM 8190-WRITE-DATAWHSE-RECORD                  34080000
343600           ELSE                                                   34090000
343700              PERFORM 8100-WRITE-LEDGER-MKUP-RECORD               34100000
343800              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  34110000
344000              PERFORM 8180-FORMAT-MW-RECORD                       34130000
344100              PERFORM 8190-WRITE-DATAWHSE-RECORD                  34140000
344200           END-IF                                                 34150000
344300                                                                  34160000
344400     END-EVALUATE.                                                34170000
344500                                                                  34180000
344600                                                                  34190000
344700******************************************************************34200000
344800 4100-OPEN-LID-CURSOR.                                            34210000
344900*     OPEN TEPLID CURSOR TO PROCESS LINE ITEM DISCOUNTS.          34220000
345000******************************************************************34230000
345100                                                                  34240000
345600     MOVE ZERO TO PV-LID-SEQ-NBR.                                 34250000
345700                                                                  34260000
345800     EXEC SQL                                                     34270000
345900          OPEN TEPLID-CURSOR                                      34280000
346000     END-EXEC.                                                    34290000
346100                                                                  34300000
346200     EVALUATE TRUE                                                34310000
346300        WHEN SQLCODE = ZERO                                       34320000
346400           MOVE EPITM-CUST-CHRGD-AMT TO PV-EXCLUDE-LID-AMT        34330000
346500           SET PS-END-OF-LID-NO       TO TRUE                     34340000
346600        WHEN OTHER                                                34350000
346700           MOVE '4100-OPEN-LID-CURSOR'                            34360000
346800                                      TO PV-PARAGRAPH-NAME        34370000
282900           SET AC-DB2-ERROR           TO TRUE                     34380000
346900           PERFORM 9999-ABEND                                     34390000
347000     END-EVALUATE.                                                34400000
347100                                                                  34410000
347600******************************************************************34420000
347700 4200-FETCH-LID-CURSOR.                                           34430000
347800*     FETCH AND PROCESS LINE ITEM DISCOUNT INFORMATION.           34440000
347900******************************************************************34450000
348000                                                                  34460000
348600     EXEC SQL                                                     34470000
348700          FETCH TEPLID-CURSOR                                     34480000
348800          INTO  :EPLID-LID-SEQ-NBR                                34490000
348900               ,:EPLID-LID-AMT                                    34500000
349000               ,:EPLID-LID-RSN-CDE                                34510000
349100     END-EXEC.                                                    34520000
349200                                                                  34530000
349300                                                                  34540000
349400     EVALUATE TRUE                                                34550000
349500         WHEN SQLCODE = ZERO                                      34560000
349600             ADD +1 TO PV-LID-SEQ-NBR                             34570000
349700                                                                  34580000
349800             PERFORM 4400-PROCESS-LID                             34590000
349900             PERFORM 4000-PROCESS-MARKDOWN-MARKUP                 34600000
350000                                                                  34610000
350100         WHEN SQLCODE = PC-ROW-NOT-FOUND                          34620000
350200             SET PS-END-OF-LID-YES    TO TRUE                     34630000
350300                                                                  34640000
350400         WHEN OTHER                                               34650000
350500             MOVE '4200-FETCH-LID-CURSOR'                         34660000
350600                                      TO PV-PARAGRAPH-NAME        34670000
285500             SET AC-DB2-ERROR           TO TRUE                   34680000
350700             PERFORM 9999-ABEND                                   34690000
350800     END-EVALUATE.                                                34700000
350900                                                                  34710000
351000******************************************************************34720000
351100 4300-CLOSE-LID-CURSOR.                                           34730000
351200******************************************************************34740000
351300                                                                  34750000
351800     EXEC SQL                                                     34760000
351900          CLOSE TEPLID-CURSOR                                     34770000
352000     END-EXEC.                                                    34780000
352100                                                                  34790000
352200     EVALUATE TRUE                                                34800000
352300        WHEN SQLCODE = ZERO                                       34810000
352400           CONTINUE                                               34820000
352500        WHEN OTHER                                                34830000
352600           MOVE '4300-CLOSE-LID-CURSOR'                           34840000
352700                                            TO PV-PARAGRAPH-NAME  34850000
287300           SET AC-DB2-ERROR           TO TRUE                     34860000
352800           PERFORM 9999-ABEND                                     34870000
352900     END-EVALUATE.                                                34880000
353000                                                                  34890000
353100******************************************************************34900000
353200 4400-PROCESS-LID.                                                34910000
353300*     PROCESS LINE ITEM DISCOUNTS. PV-EXCLUDE-LID-AMT HOLDS       34920000
353400*     AMOUNT OF EPITM-CUST-CHRGD-AMT - SUM OF PREVIOUS            34930000
353500*     EPLID-LID-AMT FOR THE ITEM.                                 34940000
353600******************************************************************34950000
353700                                                                  34960000
354600     MOVE EPLID-LID-RSN-CDE        TO ML017-PC-MKDN-MKUP-RSN-CDE. 34970000
354700     MOVE PV-EXCLUDE-LID-AMT       TO PV-CUST-CHRGD-AMT.          34980000
354800*        DISPLAY '  PV-CUST-CHRGD-AMT     = '                     34990000
354900*                             PV-CUST-CHRGD-AMT                   35000000
355000     MOVE EPITM-NET-CHRGD-AMT      TO PV-NET-CHRGD-AMT.           35010000
355100     COMPUTE PV-PRICE-CHANGE-AMOUNT = EPLID-LID-AMT * (-1).       35020000
ZX         SET PV-DISC-TYPE-LID   TO TRUE.                              35030000
355200                                                                  35040000
355300     PERFORM 4450-DETERMINE-LID-TYPE.                             35050000
355400                                                                  35060000
355500     IF EPITM-LIV-RSLU-CDE      = '-'                             35070000
355600        COMPUTE PV-EXCLUDE-LID-AMT = PV-EXCLUDE-LID-AMT           35080000
355700                                   - EPLID-LID-AMT                35090000
355800     ELSE                                                         35100000
355900        COMPUTE PV-EXCLUDE-LID-AMT = PV-EXCLUDE-LID-AMT           35110000
356000                                   + EPLID-LID-AMT                35120000
356100     END-IF.                                                      35130000
356200                                                                  35140000
356300******************************************************************35150000
356400 4450-DETERMINE-LID-TYPE.                                         35160000
356500*    FOR LIDS OUTSIDE OF THOSE PULLED BACK FROM THE ORIGINAL SALE,35170000
356600*    DETERMINE WHAT TYPE IS BEING WORKED WITH TO DETERMINED MARKDO35180000
356700******************************************************************35190000
356800                                                                  35200000
357500     EVALUATE EPLID-LID-RSN-CDE                                   35210000
205464        WHEN PC-710-NON-RCPT-RTRN                                 35220000
205464           MOVE PC-710-NON-RCPT-RTRN  TO                          35230000
205464                ML017-PC-MKDN-MKUP-RSN-CDE                        35240000
205464           PERFORM 4841-PROCESS-NON-RCPT-RTRN                     35250000
357600        WHEN PC-746-PLU-TIER                                      35260000
357700        WHEN PC-ADDTL-PROMO-OFF-774                               35270000
357800           PERFORM 4500-PROCESS-TIERED-LID                        35280000
357900                                                                  35290000
358000        WHEN PC-GOLDSTAR-753                                      35300000
358100           PERFORM 4600-PROCESS-GOLDSTAR-LID                      35310000
358200                                                                  35320000
262807        WHEN PC-SEPHORA-720                                       35321034
262807           PERFORM 4650-PROCESS-SEPHORA-LID                       35322034
262807                                                                  35323034
358300        WHEN PC-SENIOR-CIT-728                                    35330000
358400           PERFORM 4700-SENIOR-CITIZEN-LID                        35340000
358500                                                                  35350000
358600        WHEN PC-KOHLS-CPON-733                                    35360000
358700*          DISPLAY '  PC-KOHLS-CPON-733 - PERFORM 4800'           35370000
358800           PERFORM 4800-PROCESS-TLCD-LID                          35380000
358900                                                                  35390000
359000        WHEN PC-760-OFFER-COUPON                                  35400000
359100           PERFORM 4810-PROCESS-OFFER-COUPON                      35410000
359200        WHEN PC-761-OFFER-TLD-TIERED                              35420000
359300           PERFORM 4820-PROCESS-OFFER-TLD-TIERED                  35430000
359400        WHEN PC-762-OFFER-LID-TIERED                              35440000
359500           PERFORM 4830-PROCESS-OFFER-LID-TIERED                  35450000
359600        WHEN PC-763-OFFER-GWP-PWP-PRORATED                        35460000
359700           PERFORM 4840-PROCESS-OFFER-GWP-PWP                     35470000
359800                                                                  35480000
359900         WHEN PC-765-GFT-RCPT-RTRN                                35490000
360000            MOVE PC-765-GFT-RCPT-RTRN  TO                         35500000
360100                 ML017-PC-MKDN-MKUP-RSN-CDE                       35510000
360200            PERFORM 4842-PROCESS-GFT-RCPT-RTRN                    35520000
360300                                                                  35530000
360400        WHEN PC-BOGO-775                                          35540000
360500*****  REMOVE THIS CODE 3 MONTHS AFTER BOGO III GOES IN. *BEGIN*  35550000
360600        WHEN PC-BOGO-777                                          35560000
360700           MOVE PC-BOGO-775           TO                          35570000
360800                ML017-PC-MKDN-MKUP-RSN-CDE                        35580000
360900*****  REMOVE THIS CODE 3 MONTHS AFTER BOGO III GOES IN. *END*    35590000
361000           PERFORM 4850-PROCESS-BOGO-LID                          35600000
361100                                                                  35610000
361200        WHEN PC-UNEARNED-REWARDS-780                              35620000
361300           MOVE PC-UNEARNED-REWARDS-780    TO                     35630000
361400                ML017-PC-MKDN-MKUP-RSN-CDE                        35640000
361500           PERFORM 4860-PROCESS-UNEARNED-RWDS-LID                 35650000
361600                                                                  35660000
361700        WHEN OTHER                                                35670000
361800           PERFORM 4900-PROCESS-NORMAL-LID                        35680000
361900                                                                  35690000
362000     END-EVALUATE.                                                35700000
362100                                                                  35710000
362200******************************************************************35720000
362300 4500-PROCESS-TIERED-LID.                                         35730000
362400*     PROCESS TIERRED ITEMS.                                      35740000
362500******************************************************************35750000
362600                                                                  35760000
363100     SET ML017-MKDOWN                                             35770000
363200         ML017-RC-PROMOTIONAL                                     35780000
363300         ML017-BN-PROMOTIONAL                                     35790000
363400         ML017-PLU-MKDN-MKON          TO TRUE.                    35800000
363500                                                                  35810000
363600     IF EPITM-LIV-RSLU-CDE          = '+' AND                     35820000
ZX            EPLID-LID-AMT               > 0 AND                       35830000
ZX            (EPITM-SAL-RET-CDE           = 'R' OR                     35840000
ZX             EPITM-SAL-RET-CDE           = 'B')                       35850000
040220        MOVE 0                     TO ML017-PC-OLD-PR-AMT         35860000
040220        MOVE EPLID-LID-AMT         TO ML017-PC-NEW-PR-AMT         35870000
040220* MAKE THIS NEGATIVE FOR THE SPREADSHEET AND REPORT DUE TO        35880000
040220* MLKUP021 FLIPPING FROM MDC TO MD WHENVER OLD > NEW              35890000
040220        COMPUTE PV-PRICE-CHANGE-AMOUNT = EPLID-LID-AMT * (-1)     35900000
364400     ELSE                                                         35910000
364500        COMPUTE PV-PRICE-CHANGE-AMOUNT = EPLID-LID-AMT * (-1)     35920000
364600        COMPUTE ML017-PC-OLD-PR-AMT = PV-EXCLUDE-LID-AMT          35930000
364700                                    - EPLID-LID-AMT               35940000
364800                                                                  35950000
364900        MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-NEW-PR-AMT         35960000
365000     END-IF.                                                      35970000
365100                                                                  35980000
365200     IF PV-PRICE-CHANGE-AMOUNT   < ZERO                           35990000
365300        SET ML017-MARKDOWN-CANCEL      TO TRUE                    36000000
365400     ELSE                                                         36010000
365500        SET ML017-MARKDOWN       TO TRUE                          36020000
365600     END-IF.                                                      36030000
365700                                                                  36040000
365800     MOVE PV-PRICE-CHANGE-AMOUNT      TO ML017-PC-DIFFER-AMT.     36050000
365900                                                                  36060000
366000     IF ML017-MARKDOWN                                            36070000
366100        ADD +1                        TO PT-TIERED-MKDN-QTY       36080000
366200                                         (PV-TOT-SUB)             36090000
366300        ADD ML017-PC-DIFFER-AMT       TO PT-TIERED-MKDN-AMT       36100000
366400                                         (PV-TOT-SUB)             36110000
ZX            MOVE ML017-PC-DIFFER-AMT      TO WS-DISC-AMT              36120000
ZX            MOVE PC-TIERED                TO WS-DISC-TYPE             36130000
ZX            MOVE 'MD'                     TO WS-MDWN-TYPE             36140000
ZX            PERFORM 8195-BUILD-DAY02-TRANS-RECORD                     36150000
ZX            PERFORM 8195-WRITE-DAY02-TRANS-RECORD                     36160000
366500     ELSE                                                         36170000
366600        ADD +1                        TO PT-TIERED-MDC-QTY        36180000
366700                                         (PV-TOT-SUB)             36190000
366800        ADD ML017-PC-DIFFER-AMT       TO PT-TIERED-MDC-AMT        36200000
366900                                         (PV-TOT-SUB)             36210000
ZX            MOVE ML017-PC-DIFFER-AMT      TO WS-DISC-AMT              36220000
ZX            MOVE PC-TIERED                TO WS-DISC-TYPE             36230000
ZX            MOVE 'MDC'                    TO WS-MDWN-TYPE             36240000
ZX            PERFORM 8195-BUILD-DAY02-TRANS-RECORD                     36250000
ZX            PERFORM 8195-WRITE-DAY02-TRANS-RECORD                     36260000
367000     END-IF.                                                      36270000
367100                                                                  36280000
367200******************************************************************36290000
367300 4600-PROCESS-GOLDSTAR-LID.                                       36300000
367400*     PROCESS GOLDSTAR ITEMS.                                     36310000
367500******************************************************************36320000
367600                                                                  36330000
368100     SET ML017-MKDOWN                                             36340000
368200         ML017-RC-MISCELLANEOUS                                   36350000
368300         ML017-BN-GOLDSTAR            TO TRUE.                    36360000
368400                                                                  36370000
368500     SET ML017-REGISTER-MKDN-MKON     TO TRUE.                    36380000
368600                                                                  36390000
368700     EVALUATE TRUE                                                36400000
368800        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO                        36410000
368900           SET ML017-MARKDOWN         TO TRUE                     36420000
369000           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      36430000
369100                                                                  36440000
369200           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       36450000
369300                                       + EPLID-LID-AMT            36460000
369400                                                                  36470000
369500           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      36480000
369600                                       - ML017-PC-NEW-PR-AMT      36490000
369700                                                                  36500000
369800           ADD +1                     TO PT-GOLDSTAR-MKDN-QTY     36510000
369900                                         (PV-TOT-SUB)             36520000
370000           ADD ML017-PC-DIFFER-AMT                                36530000
370100                                      TO PT-GOLDSTAR-MKDN-AMT     36540000
370200                                         (PV-TOT-SUB)             36550000
ZX               MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT              36560000
ZX               MOVE PC-GOLDSTAR           TO WS-DISC-TYPE             36570000
ZX               MOVE 'MD'                  TO WS-MDWN-TYPE             36580000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  36590000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  36600000
370300                                                                  36610000
372000        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        36620000
372100           SET ML017-MARKDOWN-CANCEL  TO TRUE                     36630000
372200           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      36640000
372300           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   36650000
372400                                       * (-1)                     36660000
372500           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      36670000
372600                                       - ML017-PC-NEW-PR-AMT      36680000
372700           ADD +1                     TO PT-GOLDSTAR-MDC-QTY      36690000
372800                                         (PV-TOT-SUB)             36700000
372900           ADD ML017-PC-DIFFER-AMT    TO PT-GOLDSTAR-MDC-AMT      36710000
373000                                         (PV-TOT-SUB)             36720000
ZX               MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT              36730000
ZX               MOVE PC-GOLDSTAR           TO WS-DISC-TYPE             36740000
ZX               MOVE 'MDC'                 TO WS-MDWN-TYPE             36750000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  36760000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  36770000
373100                                                                  36780000
376200        WHEN OTHER                                                36790000
376300           MOVE ZERO                  TO ML017-PC-DIFFER-AMT      36800000
376400     END-EVALUATE.                                                36810000
376500                                                                  36820000
262807******************************************************************36821034
262807 4650-PROCESS-SEPHORA-LID.                                        36822034
262807*     PROCESS SEPHORA DISCOUNTS                                   36823034
262807*     (COPIED PARA 4810-PROCESS-OFFER-COUPON FOR 760 LIDS)        36824034
262807******************************************************************36825034
262807                                                                  36826034
262807     SET ML017-MKDOWN                                             36827034
262807         ML017-RC-MISCELLANEOUS                                   36828034
262807         ML017-BN-SEPHORA-DISCOUNT                                36829034
262807         ML017-REGISTER-MKDN-MKON     TO TRUE.                    36829134
262807                                                                  36829234
262807     EVALUATE TRUE                                                36829334
262807        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     36829434
262807           SET ML017-MARKDOWN         TO TRUE                     36829534
262807           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      36829634
262807           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       36829734
262807                                       + EPLID-LID-AMT            36829834
262807                                                                  36829934
262807           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      36830034
262807                                       - ML017-PC-NEW-PR-AMT      36830134
262807                                                                  36830234
262807           ADD +1 TO PT-720-SEPHORA-MKDN-QTY                      36830334
262807                                                (PV-TOT-SUB)      36830434
262807           ADD ML017-PC-DIFFER-AMT TO                             36830534
262807                               PT-720-SEPHORA-MKDN-AMT            36830634
262807                                                 (PV-TOT-SUB)     36830734
262807        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        36830834
262807           SET ML017-MARKDOWN-CANCEL  TO TRUE                     36830934
262807           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      36831034
262807           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   36831134
262807                                       * (-1)                     36831234
262807           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      36831334
262807                                       - ML017-PC-NEW-PR-AMT      36831434
262807           ADD +1 TO PT-720-SEPHORA-MDC-QTY                       36831534
262807                                                 (PV-TOT-SUB)     36831634
262807           ADD ML017-PC-DIFFER-AMT TO                             36831734
262807                             PT-720-SEPHORA-MDC-AMT               36831834
262807                                                 (PV-TOT-SUB)     36831934
262807        WHEN OTHER                                                36832034
262807           MOVE ZERO TO ML017-PC-DIFFER-AMT                       36832134
262807     END-EVALUATE.                                                36832234
262807                                                                  36832334
262807                                                                  36832434
376600******************************************************************36833000
376700 4700-SENIOR-CITIZEN-LID.                                         36840000
376800*     PROCESS SENIOR CITIZEN DISCOUNT.                            36850000
376900******************************************************************36860000
377000                                                                  36870000
377500     SET ML017-MKDOWN                                             36880000
377600         ML017-RC-MISCELLANEOUS                                   36890000
377700         ML017-BN-SENIOR-CITZ-DISC                                36900000
377800         ML017-REGISTER-MKDN-MKON     TO TRUE.                    36910000
377900                                                                  36920000
378000     EVALUATE TRUE                                                36930000
378100        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     36940000
378200           SET ML017-MARKDOWN         TO TRUE                     36950000
378300           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      36960000
378400                                                                  36970000
378500           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       36980000
378600                                       + EPLID-LID-AMT            36990000
378700                                                                  37000000
378800           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      37010000
378900                                       - ML017-PC-NEW-PR-AMT      37020000
379000                                                                  37030000
379100           ADD +1                     TO                          37040000
379200               PT-SENIOR-CITIZEN-MKDN-QTY (PV-TOT-SUB)            37050000
379300           ADD ML017-PC-DIFFER-AMT    TO                          37060000
379400               PT-SENIOR-CITIZEN-MKDN-AMT (PV-TOT-SUB)            37070000
ZX               MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT              37080000
ZX               MOVE PC-SENIOR-CITIZEN     TO WS-DISC-TYPE             37090000
ZX               MOVE 'MD'                  TO WS-MDWN-TYPE             37100000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  37110000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  37120000
379500        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        37130000
379600           SET ML017-MARKDOWN-CANCEL  TO TRUE                     37140000
379700           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      37150000
379800           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   37160000
379900                                       * (-1)                     37170000
380000           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      37180000
380100                                       - ML017-PC-NEW-PR-AMT      37190000
380200           ADD +1 TO PT-SENIOR-CITIZEN-MDC-QTY                    37200000
380300                                                 (PV-TOT-SUB)     37210000
380400           ADD ML017-PC-DIFFER-AMT TO                             37220000
380500               PT-SENIOR-CITIZEN-MDC-AMT (PV-TOT-SUB)             37230000
ZX               MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT              37240000
ZX               MOVE PC-SENIOR-CITIZEN     TO WS-DISC-TYPE             37250000
ZX               MOVE 'MDC'                 TO WS-MDWN-TYPE             37260000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  37270000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  37280000
380600        WHEN OTHER                                                37290000
380700           MOVE ZERO TO ML017-PC-DIFFER-AMT                       37300000
380800     END-EVALUATE.                                                37310000
380900                                                                  37320000
381000******************************************************************37330000
381100 4800-PROCESS-TLCD-LID.                                           37340000
381200*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        37350000
381300******************************************************************37360000
381400                                                                  37370000
381900     SET ML017-MKDOWN                                             37380000
382000         ML017-RC-MISCELLANEOUS                                   37390000
382100         ML017-BN-KOHLS-COUPON                                    37400000
382200         ML017-REGISTER-MKDN-MKON     TO TRUE.                    37410000
382300                                                                  37420000
382400     EVALUATE TRUE                                                37430000
382500        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     37440000
382600           SET ML017-MARKDOWN         TO TRUE                     37450000
382700           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      37460000
382800           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       37470000
382900                                       + EPLID-LID-AMT            37480000
383000                                                                  37490000
383100           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      37500000
383200                                       - ML017-PC-NEW-PR-AMT      37510000
040220* ADDED THE BELOW CODE TO FIX INCORRECT MARKDOWN AMOUNT FROM      37520000
040220* BEING TAKEN ON SALES ON WHICH THE ITEM PRICE WAS INFLATED VIA   37530000
040220* A MANUAL LID (INCREASING THE PRICE)                             37540000
040220           COMPUTE PV-NEW-PR-AMT  = PV-EXCLUDE-LID-AMT            37550000
040220                                  + EPLID-LID-AMT                 37560000
040220           IF PV-NEW-PR-AMT < 0                                   37570000
040220               COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT  37580000
040220                                           - PV-NEW-PR-AMT        37590000
040220               MOVE ML017-PC-DIFFER-AMT TO ML017-PC-OLD-PR-AMT    37600000
040220               MOVE 0                   TO ML017-PC-NEW-PR-AMT    37610000
040220           END-IF                                                 37620000
383300                                                                  37630000
383400           ADD +1 TO PT-KOHLS-COUPON-MKDN-QTY                     37640000
383500                                                (PV-TOT-SUB)      37650000
383600           ADD ML017-PC-DIFFER-AMT TO                             37660000
383700                               PT-KOHLS-COUPON-MKDN-AMT           37670000
383800                                                 (PV-TOT-SUB)     37680000
ZX                                                                      37690000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                37700000
ZX               MOVE PC-KOHLS-COUPON     TO WS-DISC-TYPE               37710000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               37720000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  37730000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  37740000
383900        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        37750000
384000           SET ML017-MARKDOWN-CANCEL  TO TRUE                     37760000
384100           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      37770000
384200           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   37780000
384300                                       * (-1)                     37790000
384400           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      37800000
384500                                       - ML017-PC-NEW-PR-AMT      37810000
384600           ADD +1 TO PT-KOHLS-COUPON-MDC-QTY                      37820000
384700                                                 (PV-TOT-SUB)     37830000
384800           ADD ML017-PC-DIFFER-AMT TO                             37840000
384900                             PT-KOHLS-COUPON-MDC-AMT              37850000
385000                                                 (PV-TOT-SUB)     37860000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                37870000
ZX               MOVE PC-KOHLS-COUPON     TO WS-DISC-TYPE               37880000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               37890000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  37900000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  37910000
385100                                                                  37920000
388200        WHEN OTHER                                                37930000
388300           MOVE ZERO TO ML017-PC-DIFFER-AMT                       37940000
388400     END-EVALUATE.                                                37950000
388500                                                                  37960000
388600******************************************************************37970000
388700 4810-PROCESS-OFFER-COUPON.                                       37980000
388800*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        37990000
388900******************************************************************38000000
389000                                                                  38010000
389100     SET ML017-MKDOWN                                             38020000
389200         ML017-RC-MISCELLANEOUS                                   38030000
389300         ML017-BN-OFFER-COUPON                                    38040000
389400         ML017-REGISTER-MKDN-MKON     TO TRUE.                    38050000
389500                                                                  38060000
389600     EVALUATE TRUE                                                38070000
389700        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     38080000
389800           SET ML017-MARKDOWN         TO TRUE                     38090000
389900           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      38100000
390000           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       38110000
390100                                       + EPLID-LID-AMT            38120000
390200                                                                  38130000
390300           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      38140000
390400                                       - ML017-PC-NEW-PR-AMT      38150000
390500                                                                  38160000
390600           ADD +1 TO PT-760-OFFER-MKDN-QTY                        38170000
390700                                                (PV-TOT-SUB)      38180000
390800           ADD ML017-PC-DIFFER-AMT TO                             38190000
390900                               PT-760-OFFER-MKDN-AMT              38200000
391000                                                 (PV-TOT-SUB)     38210000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                38220000
ZX               MOVE PC-OFFER-COUPON     TO WS-DISC-TYPE               38230000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               38240000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  38250000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  38260000
391100        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        38270000
391200           SET ML017-MARKDOWN-CANCEL  TO TRUE                     38280000
391300           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      38290000
391400           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   38300000
391500                                       * (-1)                     38310000
391600           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      38320000
391700                                       - ML017-PC-NEW-PR-AMT      38330000
391800           ADD +1 TO PT-760-OFFER-MDC-QTY                         38340000
391900                                                 (PV-TOT-SUB)     38350000
392000           ADD ML017-PC-DIFFER-AMT TO                             38360000
392100                             PT-760-OFFER-MDC-AMT                 38370000
392200                                                 (PV-TOT-SUB)     38380000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                38390000
ZX               MOVE PC-OFFER-COUPON    TO WS-DISC-TYPE                38400000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               38410000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  38420000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  38430000
392300        WHEN OTHER                                                38440000
392400           MOVE ZERO TO ML017-PC-DIFFER-AMT                       38450000
392500     END-EVALUATE.                                                38460000
392600                                                                  38470000
392700******************************************************************38480000
392800 4820-PROCESS-OFFER-TLD-TIERED.                                   38490000
392900*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        38500000
393000******************************************************************38510000
393100                                                                  38520000
393200     SET ML017-MKDOWN                                             38530000
393300         ML017-RC-MISCELLANEOUS                                   38540000
393400         ML017-BN-OFFER-TLD-TIERED                                38550000
393500         ML017-REGISTER-MKDN-MKON     TO TRUE.                    38560000
393600                                                                  38570000
393700     EVALUATE TRUE                                                38580000
393800        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     38590000
393900           SET ML017-MARKDOWN         TO TRUE                     38600000
394000           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      38610000
394100           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       38620000
394200                                       + EPLID-LID-AMT            38630000
394300                                                                  38640000
394400           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      38650000
394500                                       - ML017-PC-NEW-PR-AMT      38660000
394600                                                                  38670000
394700           ADD +1 TO PT-761-TLDTIER-MKDN-QTY                      38680000
394800                                                (PV-TOT-SUB)      38690000
394900           ADD ML017-PC-DIFFER-AMT TO                             38700000
395000                               PT-761-TLDTIER-MKDN-AMT            38710000
395100                                                 (PV-TOT-SUB)     38720000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                38730000
ZX               MOVE PC-OFFER-TLD-TIERED TO WS-DISC-TYPE               38740000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               38750000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  38760000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  38770000
395200        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        38780000
395300           SET ML017-MARKDOWN-CANCEL  TO TRUE                     38790000
395400           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      38800000
395500           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   38810000
395600                                       * (-1)                     38820000
395700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      38830000
395800                                       - ML017-PC-NEW-PR-AMT      38840000
395900           ADD +1 TO PT-761-TLDTIER-MDC-QTY                       38850000
396000                                                 (PV-TOT-SUB)     38860000
396100           ADD ML017-PC-DIFFER-AMT TO                             38870000
396200                             PT-761-TLDTIER-MDC-AMT               38880000
396300                                                 (PV-TOT-SUB)     38890000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                38900000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                38910000
ZX               MOVE PC-OFFER-TLD-TIERED TO WS-DISC-TYPE               38920000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               38930000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  38940000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  38950000
396400        WHEN OTHER                                                38960000
396500           MOVE ZERO TO ML017-PC-DIFFER-AMT                       38970000
396600     END-EVALUATE.                                                38980000
396700                                                                  38990000
396800******************************************************************39000000
396900 4830-PROCESS-OFFER-LID-TIERED.                                   39010000
397000*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        39020000
397100******************************************************************39030000
397200                                                                  39040000
397300     SET ML017-MKDOWN                                             39050000
397400         ML017-RC-MISCELLANEOUS                                   39060000
397500         ML017-BN-OFFER-LID-TIERED                                39070000
397600         ML017-REGISTER-MKDN-MKON     TO TRUE.                    39080000
397700                                                                  39090000
397800     EVALUATE TRUE                                                39100000
397900        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     39110000
398000           SET ML017-MARKDOWN         TO TRUE                     39120000
398100           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      39130000
398200           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       39140000
398300                                       + EPLID-LID-AMT            39150000
398400                                                                  39160000
398500           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      39170000
398600                                       - ML017-PC-NEW-PR-AMT      39180000
398700                                                                  39190000
398800           ADD +1 TO PT-762-LIDTIER-MKDN-QTY                      39200000
398900                                                (PV-TOT-SUB)      39210000
399000           ADD ML017-PC-DIFFER-AMT TO                             39220000
399100                               PT-762-LIDTIER-MKDN-AMT            39230000
399200                                                 (PV-TOT-SUB)     39240000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                39250000
ZX               MOVE PC-OFFER-LID-TIERED TO WS-DISC-TYPE               39260000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               39270000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  39280000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  39290000
399300        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        39300000
399400           SET ML017-MARKDOWN-CANCEL  TO TRUE                     39310000
399500           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      39320000
399600           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   39330000
399700                                       * (-1)                     39340000
399800           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      39350000
399900                                       - ML017-PC-NEW-PR-AMT      39360000
400000           ADD +1 TO PT-762-LIDTIER-MDC-QTY                       39370000
400100                                                 (PV-TOT-SUB)     39380000
400200           ADD ML017-PC-DIFFER-AMT TO                             39390000
400300                             PT-762-LIDTIER-MDC-AMT               39400000
400400                                                 (PV-TOT-SUB)     39410000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                39420000
ZX               MOVE PC-OFFER-LID-TIERED TO WS-DISC-TYPE               39430000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               39440000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  39450000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  39460000
400500        WHEN OTHER                                                39470000
400600           MOVE ZERO TO ML017-PC-DIFFER-AMT                       39480000
400700     END-EVALUATE.                                                39490000
400800                                                                  39500000
400900******************************************************************39510000
401000 4840-PROCESS-OFFER-GWP-PWP.                                      39520000
401100*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        39530000
401200******************************************************************39540000
401300                                                                  39550000
401400     SET ML017-MKDOWN                                             39560000
401500         ML017-RC-MISCELLANEOUS                                   39570000
401600         ML017-BN-OFFER-GWP-PWP                                   39580000
401700         ML017-REGISTER-MKDN-MKON     TO TRUE.                    39590000
401800                                                                  39600000
401900     EVALUATE TRUE                                                39610000
402000        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     39620000
402100           SET ML017-MARKDOWN         TO TRUE                     39630000
402200           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      39640000
402300           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       39650000
402400                                       + EPLID-LID-AMT            39660000
402500                                                                  39670000
402600           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      39680000
402700                                       - ML017-PC-NEW-PR-AMT      39690000
402800                                                                  39700000
402900           ADD +1 TO PT-763-GWPPWP-MKDN-QTY                       39710000
403000                                                (PV-TOT-SUB)      39720000
403100           ADD ML017-PC-DIFFER-AMT TO                             39730000
403200                               PT-763-GWPPWP-MKDN-AMT             39740000
403300                                                 (PV-TOT-SUB)     39750000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                39760000
ZX               MOVE PC-OFFER-GWP-PWP    TO WS-DISC-TYPE               39770000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               39780000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  39790000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  39800000
403400        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        39810000
403500           SET ML017-MARKDOWN-CANCEL  TO TRUE                     39820000
403600           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      39830000
403700           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   39840000
403800                                       * (-1)                     39850000
403900           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      39860000
404000                                       - ML017-PC-NEW-PR-AMT      39870000
404100           ADD +1 TO PT-763-GWPPWP-MDC-QTY                        39880000
404200                                                 (PV-TOT-SUB)     39890000
404300           ADD ML017-PC-DIFFER-AMT TO                             39900000
404400                             PT-763-GWPPWP-MDC-AMT                39910000
404500                                                 (PV-TOT-SUB)     39920000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                39930000
ZX               MOVE PC-OFFER-GWP-PWP    TO WS-DISC-TYPE               39940000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               39950000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  39960000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  39970000
404600        WHEN OTHER                                                39980000
404700           MOVE ZERO TO ML017-PC-DIFFER-AMT                       39990000
404800     END-EVALUATE.                                                40000000
205464******************************************************************40010000
205464 4841-PROCESS-NON-RCPT-RTRN.                                      40020000
205464*     PROCESS NON RECEIPT RETURNS                                 40030000
205464******************************************************************40040000
205464                                                                  40050000
205464     SET ML017-MKDOWN                                             40060000
205464         ML017-RC-MISCELLANEOUS                                   40070000
205464         ML017-BN-NON-RCPT-RETURN                                 40080000
205464         ML017-REGISTER-MKDN-MKON     TO TRUE.                    40090000
205464                                                                  40100000
205464     EVALUATE TRUE                                                40110000
205464        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     40120000
205464           SET ML017-MARKDOWN         TO TRUE                     40130000
205464           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      40140000
205464           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       40150000
205464                                       + EPLID-LID-AMT            40160000
205464                                                                  40170000
205464           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      40180000
205464                                       - ML017-PC-NEW-PR-AMT      40190000
205464                                                                  40200000
205464           ADD +1 TO PT-710-NORCPT-MKDN-QTY (PV-TOT-SUB)          40210000
205464           ADD ML017-PC-DIFFER-AMT    TO                          40220000
205464                               PT-710-NORCPT-MKDN-AMT(PV-TOT-SUB) 40230000
205464        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        40240000
205464           SET ML017-MARKDOWN-CANCEL  TO TRUE                     40250000
205464           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      40260000
205464           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   40270000
205464                                       * (-1)                     40280000
205464           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      40290000
205464                                       - ML017-PC-NEW-PR-AMT      40300000
205464           ADD +1 TO PT-710-NORCPT-MDC-QTY (PV-TOT-SUB)           40310000
205464           ADD ML017-PC-DIFFER-AMT    TO                          40320000
205464                               PT-710-NORCPT-MDC-AMT  (PV-TOT-SUB)40330000
205464        WHEN OTHER                                                40340000
205464           MOVE ZERO TO ML017-PC-DIFFER-AMT                       40350000
205464     END-EVALUATE.                                                40360000
205464                                                                  40370000
404900******************************************************************40380000
405000  4842-PROCESS-GFT-RCPT-RTRN.                                     40390000
405100**     PROCESS GIFT RECEIPT RETURNS                               40400000
405200******************************************************************40410000
405300                                                                  40420000
405400      SET ML017-MKDOWN                                            40430000
405500          ML017-RC-MISCELLANEOUS                                  40440000
405600          ML017-BN-UU-GFT-RCPT-RTRN                               40450000
405700          ML017-REGISTER-MKDN-MKON     TO TRUE.                   40460000
405800                                                                  40470000
405900      EVALUATE TRUE                                               40480000
406000         WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                    40490000
406100            SET ML017-MARKDOWN         TO TRUE                    40500000
406200            MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT     40510000
406300            COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT      40520000
406400                                        + EPLID-LID-AMT           40530000
406500                                                                  40540000
406600            COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT     40550000
406700                                        - ML017-PC-NEW-PR-AMT     40560000
406800                                                                  40570000
406900            ADD +1 TO PT-765-GIFT-MKDN-QTY (PV-TOT-SUB)           40580000
407000           ADD ML017-PC-DIFFER-AMT TO                             40590000
407100                              PT-765-GIFT-MKDN-AMT(PV-TOT-SUB)    40600000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                40610000
ZX               MOVE PC-GIFT-RCPT-RETURN TO WS-DISC-TYPE               40620000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               40630000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  40640000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  40650000
407200        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        40660000
407300           SET ML017-MARKDOWN-CANCEL  TO TRUE                     40670000
407400           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      40680000
407500           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   40690000
407600                                       * (-1)                     40700000
407700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      40710000
407800                                       - ML017-PC-NEW-PR-AMT      40720000
407900           ADD +1 TO PT-765-GIFT-MDC-QTY (PV-TOT-SUB)             40730000
408000           ADD ML017-PC-DIFFER-AMT TO                             40740000
408100                                  PT-765-GIFT-MDC-AMT (PV-TOT-SUB)40750000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                40760000
ZX               MOVE PC-GIFT-RCPT-RETURN TO WS-DISC-TYPE               40770000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               40780000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  40790000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  40800000
408200        WHEN OTHER                                                40810000
408300           MOVE ZERO TO ML017-PC-DIFFER-AMT                       40811000
408400     END-EVALUATE.                                                40812000
408500                                                                  40813000
408600******************************************************************40814000
408700 4850-PROCESS-BOGO-LID.                                           40815000
408800*     PROCESS PRORATED BUY ONE GET ONE FREE PROMOTION.            40816000
408900******************************************************************40817000
409000                                                                  40818000
409500     SET ML017-MKDOWN                                             40819000
409600         ML017-RC-MISCELLANEOUS                                   40820000
409700         ML017-BN-BOGO                                            40830000
409800         ML017-PLU-MKDN-MKON          TO TRUE.                    40840000
409900                                                                  40850000
410000     EVALUATE TRUE                                                40860000
410100        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     40870000
410200*          DISPLAY '4850-PROCESS-BOGO-LID'                        40880000
410300*          DISPLAY 'STR: ' EPTRN-STR-NBR '  '                     40890000
410400*                  'TRN: ' EPTRN-TRN-NBR '  '                     40900000
410500*                  'SEQ: ' EPITM-LNE-ITM-SEQ-NBR '  '             40910000
410600*                  'SKU: ' EPITM-SKU-NBR '  '                     40920000
410700*                  'NET AMT: ' EPITM-NET-CHRGD-AMT '  '           40930000
410800*                  'CUST AMT: ' EPITM-CUST-CHRGD-AMT '  '         40940000
410900*                  'RTL AMT: ' EPITM-REG-RTL-AMT '  '             40950000
411000*                  'OWND AMT: ' EPITM-OWND-UNT-RTL-AMT            40960000
411100                                                                  40970000
411200           SET ML017-MARKDOWN         TO TRUE                     40980000
411300           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      40990000
411400           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       41000000
411500                                       + EPLID-LID-AMT            41010000
411600                                                                  41020000
411700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      41030000
411800                                       - ML017-PC-NEW-PR-AMT      41040000
411900                                                                  41050000
412000           ADD +1 TO PT-BOGO-MKDN-QTY (PV-TOT-SUB)                41060000
412100           ADD ML017-PC-DIFFER-AMT TO PT-BOGO-MKDN-AMT(PV-TOT-SUB)41070000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                41080000
ZX               MOVE PC-BOGO             TO WS-DISC-TYPE               41090000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               41100000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  41110000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  41120000
412200        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        41130000
412300           SET ML017-MARKDOWN-CANCEL  TO TRUE                     41140000
412400           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      41150000
412500           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   41160000
412600                                       * (-1)                     41170000
412700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      41180000
412800                                       - ML017-PC-NEW-PR-AMT      41190000
412900           ADD +1 TO PT-BOGO-MDC-QTY (PV-TOT-SUB)                 41200000
413000           ADD ML017-PC-DIFFER-AMT TO PT-BOGO-MDC-AMT (PV-TOT-SUB)41210000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                41220000
ZX               MOVE PC-BOGO             TO WS-DISC-TYPE               41230000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               41240000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  41250000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  41260000
413100        WHEN OTHER                                                41270000
413200           MOVE ZERO TO ML017-PC-DIFFER-AMT                       41280000
413300     END-EVALUATE.                                                41290000
413400                                                                  41300000
415200******************************************************************41310000
415300 4860-PROCESS-UNEARNED-RWDS-LID.                                  41320000
415400*     PROCESS THE MARKDOWN CANCELS FOR UNEARNED REWARDS.          41330000
415500******************************************************************41340000
415600                                                                  41350000
416100     SET ML017-MKDOWN                                             41360000
416200         ML017-RC-MISCELLANEOUS                                   41370000
416300         ML017-BN-UNEARNED-RWDS                                   41380000
416400         ML017-REGISTER-MKDN-MKON     TO TRUE.                    41390000
416500                                                                  41400000
416600     EVALUATE TRUE                                                41410000
416700        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     41420000
416800           SET ML017-MARKDOWN         TO TRUE                     41430000
416900           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      41440000
417000           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       41450000
417100                                       + EPLID-LID-AMT            41460000
417200                                                                  41470000
417300           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      41480000
417400                                       - ML017-PC-NEW-PR-AMT      41490000
417500                                                                  41500000
417600           ADD +1 TO PT-UNEARNED-RWDS-MKDN-QTY (PV-TOT-SUB)       41510000
417700           ADD ML017-PC-DIFFER-AMT TO                             41520000
417800                       PT-UNEARNED-RWDS-MKDN-AMT(PV-TOT-SUB)      41530000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                41540000
ZX               MOVE PC-UNEARNED-REWARDS TO WS-DISC-TYPE               41550000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               41560000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  41570000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  41580000
417900        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        41590000
418000           SET ML017-MARKDOWN-CANCEL  TO TRUE                     41600000
418100           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      41610000
418200           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   41620000
418300                                       * (-1)                     41630000
418400           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      41640000
418500                                       - ML017-PC-NEW-PR-AMT      41650000
418600           ADD +1 TO PT-UNEARNED-RWDS-MDC-QTY (PV-TOT-SUB)        41660000
418700           ADD ML017-PC-DIFFER-AMT TO                             41670000
418800                       PT-UNEARNED-RWDS-MDC-AMT (PV-TOT-SUB)      41680000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                41690000
ZX               MOVE PC-UNEARNED-REWARDS TO WS-DISC-TYPE               41700000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               41710000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  41720000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  41730000
418900        WHEN OTHER                                                41740000
419000           MOVE ZERO TO ML017-PC-DIFFER-AMT                       41750000
419100     END-EVALUATE.                                                41760000
419200                                                                  41770000
419300******************************************************************41780000
419400 4900-PROCESS-NORMAL-LID.                                         41790000
419500*     PROCESS NORMAL DISCOUNTS.                                   41800000
419600******************************************************************41810000
419700                                                                  41820000
420800     SET ML017-MKDOWN                                             41830000
420900         ML017-RC-MISCELLANEOUS                                   41840000
421000         ML017-BN-MANUAL-LID                                      41850000
421100         ML017-REGISTER-MKDN-MKON     TO TRUE.                    41860000
421200                                                                  41870000
421300** FIX TO WHERE A GOLDSTAR LID IS RETRIEVED FROM THE ORIGIN SALE  41880000
421400** AND WAS PREVOIUSLY REPORTING AS MANUAL LID                     41890000
421500     IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753              41900000
421600        SET ML017-BN-GOLDSTAR TO TRUE                             41910000
421700     END-IF.                                                      41920000
421800                                                                  41930000
421900     EVALUATE TRUE                                                41940000
422000        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    41950000
422100             PV-EXCLUDE-LID-AMT   >= ZERO AND                     41960000
422200             (                                                    41970000
422300               (                                                  41980000
422400                (EPITM-NET-CHRGD-AMT > ZERO  OR                   41990000
422500                (EPITM-NET-CHRGD-AMT = 0                          42000000
422600                    AND (EPITM-SAL-RET-CDE = 'S' OR 'A') ))       42010000
422700                )                                                 42020000
422800             )                            AND                     42030000
422900                                                                  42040000
423000             PV-EXCLUDE-LID-AMT   >= EPITM-NET-CHRGD-AMT          42050000
423100                                                                  42060000
423600           SET ML017-MARKDOWN TO TRUE                             42070000
423700                                                                  42080000
423800** FIX DUE TO SIGN BEING DROPPED CAUSING CALCULATION TO BE WRONG  42090000
423900           MOVE PV-EXCLUDE-LID-AMT TO PV-PC-OLD-PR-AMT            42100000
424000           COMPUTE PV-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT          42110000
424100                                       + EPLID-LID-AMT            42120000
424200           COMPUTE PV-PC-DIFFER-AMT = PV-PC-OLD-PR-AMT            42130000
424300                                       - PV-PC-NEW-PR-AMT         42140000
424400                                                                  42150000
424500           MOVE PV-PC-OLD-PR-AMT TO ML017-PC-OLD-PR-AMT           42160000
424600           MOVE PV-PC-NEW-PR-AMT TO ML017-PC-NEW-PR-AMT           42170000
424700           MOVE PV-PC-DIFFER-AMT TO ML017-PC-DIFFER-AMT           42180000
424800                                                                  42190000
424900                                                                  42200000
425000** FIX TO WHERE A GOLDSTAR LID IS RETRIEVED FROM THE ORIGIN SALE  42210000
425100** AND WAS PREVOIUSLY REPORTING AS MANUAL LID                     42220000
425200           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        42230000
425300               ADD +1                  TO PT-GOLDSTAR-MKDN-QTY    42240000
425400                                            (PV-TOT-SUB)          42250000
425500               ADD ML017-PC-DIFFER-AMT                            42260000
425600                                       TO PT-GOLDSTAR-MKDN-AMT    42270000
425700                                            (PV-TOT-SUB)          42280000
425800                                                                  42290000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            42300000
ZX                   MOVE PC-GOLDSTAR         TO WS-DISC-TYPE           42310000
ZX                   MOVE 'MD'                TO WS-MDWN-TYPE           42320000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              42330000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              42340000
429100           ELSE                                                   42350000
429200               ADD +1                    TO PT-MANUAL-LID-MKDN-QTY42360000
429300                                           (PV-TOT-SUB)           42370000
429400               ADD ML017-PC-DIFFER-AMT   TO PT-MANUAL-LID-MKDN-AMT42380000
429500                                           (PV-TOT-SUB)           42390000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            42400000
ZX                   MOVE PC-MANUAL-LID       TO WS-DISC-TYPE           42410000
ZX                   MOVE 'MD'                TO WS-MDWN-TYPE           42420000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              42430000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              42440000
432900           END-IF                                                 42450000
433000                                                                  42460000
433100        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        42470000
433200           SET ML017-MARKDOWN-CANCEL  TO TRUE                     42480000
433300           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      42490000
433400           MOVE EPLID-LID-AMT         TO ML017-PC-NEW-PR-AMT      42500000
433500           MOVE ML017-PC-NEW-PR-AMT   TO PV-NET-CHRGD-AMT         42510000
433600           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      42520000
433700                                       - ML017-PC-NEW-PR-AMT      42530000
433800                                                                  42540000
434300** FIX TO WHERE A GOLDSTAR LID IS RETRIEVED FROM THE ORIGIN SALE  42550000
434400** AND WAS PREVOIUSLY REPORTING AS MANUAL LID                     42560000
434500           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        42570000
434600               ADD +1                  TO PT-GOLDSTAR-MDC-QTY     42580000
434700                                            (PV-TOT-SUB)          42590000
434800               ADD ML017-PC-DIFFER-AMT                            42600000
434900                                       TO PT-GOLDSTAR-MDC-AMT     42610000
435000                                            (PV-TOT-SUB)          42620000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            42630000
ZX                   MOVE PC-GOLDSTAR       TO WS-DISC-TYPE             42640000
ZX                   MOVE 'MDC'             TO WS-MDWN-TYPE             42650000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              42660000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              42670000
435100                                                                  42680000
438500           ELSE                                                   42690000
438600               ADD +1                  TO PT-MANUAL-LID-MDC-QTY   42700000
438700                                            (PV-TOT-SUB)          42710000
438800               ADD ML017-PC-DIFFER-AMT TO PT-MANUAL-LID-MDC-AMT   42720000
438900                                            (PV-TOT-SUB)          42730000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            42740000
ZX                   MOVE PC-MANUAL-LID     TO WS-DISC-TYPE             42750000
ZX                   MOVE 'MDC'             TO WS-MDWN-TYPE             42760000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              42770000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              42780000
439000                                                                  42790000
442400           END-IF                                                 42800000
442500                                                                  42810000
442600        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    42820000
442700             EPITM-CUST-CHRGD-AMT <= ZERO AND                     42830000
442800              EPITM-NET-CHRGD-AMT   <= ZERO AND                   42840000
442900              EPTRN-POS-CPBL-LVL-NBR = PC-POC AND                 42850000
ZX    *            EPITM-SAL-RET-CDE = 'R'                              42860000
ZX                  (EPITM-SAL-RET-CDE = 'R' OR                         42870000
ZX                   EPITM-SAL-RET-CDE = 'B')                           42880000
443200                                                                  42890000
443700* WHEN IT'S A RETURN ITEM AND THE DISCOUNT WAS NEGATIVE           42900000
443800* WHICH MEANS THAT ON THE SALE, THIS DISCOUNT HAD RAISED THE      42910000
443900* COST OF THE ITEM (PRICE CORRECTION - MAN LID MARKUP) AND        42920000
444000* IT'S A POC TRANSACTION, THEN EXECUTE THE BELOW CODE.            42930000
444100           SET ML017-MARKDOWN TO TRUE                             42940000
040220           COMPUTE ML017-PC-OLD-PR-AMT =                          42950000
011618                              (PV-PRICE-CHANGE-AMOUNT * (-1))     42960000
040220           MOVE ZERO TO ML017-PC-NEW-PR-AMT                       42970000
444500           COMPUTE ML017-PC-DIFFER-AMT =                          42980000
444600                               (ML017-PC-OLD-PR-AMT -             42990000
444700                               ML017-PC-NEW-PR-AMT)               43000000
445000                                                                  43010000
445100           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        43020000
445200               ADD +1                  TO PT-GOLDSTAR-MKDN-QTY    43030000
445300                                            (PV-TOT-SUB)          43040000
445400               ADD ML017-PC-DIFFER-AMT                            43050000
445500                                       TO PT-GOLDSTAR-MKDN-AMT    43060000
445600                                            (PV-TOT-SUB)          43070000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            43080000
ZX                   MOVE PC-GOLDSTAR       TO WS-DISC-TYPE             43090000
ZX                   MOVE 'MD '             TO WS-MDWN-TYPE             43100000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              43110000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              43120000
445700           ELSE                                                   43130000
445800               ADD +1                  TO PT-MANUAL-LID-MKDN-QTY  43140000
445900                                                (PV-TOT-SUB)      43150000
446000               ADD ML017-PC-DIFFER-AMT TO PT-MANUAL-LID-MKDN-AMT  43160000
446100                                                (PV-TOT-SUB)      43170000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            43180000
ZX                   MOVE PC-MANUAL-LID     TO WS-DISC-TYPE             43190000
ZX                   MOVE 'MD '             TO WS-MDWN-TYPE             43200000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              43210000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              43220000
446200           END-IF                                                 43230000
446300                                                                  43240000
446400        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    43250000
446500             EPITM-CUST-CHRGD-AMT <= ZERO AND                     43260000
446600             EPITM-NET-CHRGD-AMT   <= ZERO                        43270000
446700        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    43280000
446800             EPITM-CUST-CHRGD-AMT >= ZERO AND                     43290000
446900             EPITM-NET-CHRGD-AMT >= ZERO AND                      43300000
447000             EPITM-CUST-CHRGD-AMT <= EPITM-NET-CHRGD-AMT          43310000
447100                                                                  43320000
447600           SET ML017-MARKDOWN-CANCEL TO TRUE                      43330000
447700           MOVE ZERO TO ML017-PC-OLD-PR-AMT                       43340000
447800           COMPUTE ML017-PC-NEW-PR-AMT =                          43350000
447900                              (PV-PRICE-CHANGE-AMOUNT * (-1))     43360000
448000           COMPUTE ML017-PC-DIFFER-AMT =                          43370000
448100                               (ML017-PC-OLD-PR-AMT -             43380000
448200                               ML017-PC-NEW-PR-AMT)               43390000
448300                                                                  43400000
448400           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        43410000
448500               ADD +1                  TO PT-GOLDSTAR-MDC-QTY     43420000
448600                                            (PV-TOT-SUB)          43430000
448700               ADD ML017-PC-DIFFER-AMT                            43440000
448800                                       TO PT-GOLDSTAR-MDC-AMT     43450000
448900                                            (PV-TOT-SUB)          43460000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            43470000
ZX                   MOVE PC-GOLDSTAR       TO WS-DISC-TYPE             43480000
ZX                   MOVE 'MDC'             TO WS-MDWN-TYPE             43490000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              43500000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              43510000
450400           ELSE                                                   43520000
450500               ADD +1                  TO PT-MANUAL-LID-MDC-QTY   43530000
450600                                            (PV-TOT-SUB)          43540000
450700               ADD ML017-PC-DIFFER-AMT TO PT-MANUAL-LID-MDC-AMT   43550000
450800                                            (PV-TOT-SUB)          43560000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            43570000
ZX                   MOVE PC-MANUAL-LID     TO WS-DISC-TYPE             43580000
ZX                   MOVE 'MDC'             TO WS-MDWN-TYPE             43590000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              43600000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              43610000
452400           END-IF                                                 43620000
452500                                                                  43630000
452600        WHEN OTHER                                                43640000
452700           MOVE ZERO TO ML017-PC-DIFFER-AMT                       43650000
453200                                                                  43660000
453300     END-EVALUATE.                                                43670000
453400                                                                  43680000
349600******************************************************************43690000
349700 6000-OPEN-DKEY-CURSOR.                                           43700000
349800******************************************************************43710000
349900                                                                  43720000
350000     EXEC SQL                                                     43730000
350100          OPEN TEPDKEY-CURSOR                                     43740000
350200     END-EXEC.                                                    43750000
350300                                                                  43760000
350400     EVALUATE TRUE                                                43770000
350500        WHEN SQLCODE = ZERO                                       43780000
350600           CONTINUE                                               43790000
350700        WHEN OTHER                                                43800000
350800           MOVE '6000-OPEN-DKEY-CURSOR'                           43810000
350900                                      TO PV-PARAGRAPH-NAME        43820000
351000           SET AC-DB2-ERROR           TO TRUE                     43830000
351100           PERFORM 9999-ABEND                                     43840000
351200     END-EVALUATE.                                                43850000
351300                                                                  43860000
351400******************************************************************43870000
351500 6100-FETCH-DKEY-CURSOR.                                          43880000
351600*     FETCH LATE AND SALES CORRECTION TRANSACTIONS.               43890000
351700******************************************************************43900000
351800                                                                  43910000
351900     EXEC SQL                                                     43920000
352000          FETCH TEPDKEY-CURSOR                                    43930000
352100           INTO :EPTRN-PARTN-NBR                                  43940000
352200               ,:EPTRN-STR-NBR                                    43950000
352300               ,:EPTRN-RGST-ID                                    43960000
352400               ,:EPTRN-TRN-NBR                                    43970000
352500               ,:EPTRN-STRT-TM                                    43980000
352600               ,:EPTRN-SLS-CORR-SEQ-NBR                           43990000
352700               ,:EPTRN-TRN-STAT-CDE                               44000000
352800               ,:EPTRN-SLS-DTE                                    44010000
ZX                   ,:EPTRN-TRN-DTE                                    44020000
011618               ,:EPTRN-POS-CPBL-LVL-NBR                           44030000
352900               ,:EPTRN-CRE-TMST                                   44040000
BOSSCL               ,:EPTRN-OMNI-CHNL-FFLMT-TYP-CDE                    44050000
BOSSCL                :PV-OMNI-CHNL-TYP-CDE-NULL-IND                    44060000
BOSSC2               ,:PV-TRANSFER-DATE                                 44070000
353000     END-EXEC.                                                    44080000
353100                                                                  44090000
353200     EVALUATE TRUE                                                44100000
353300        WHEN SQLCODE = ZERO                                       44110000
BOSSCL           IF PV-OMNI-CHNL-TYP-CDE-NULL-IND = -1                  44120000
BOSSCL              MOVE SPACES TO EPTRN-OMNI-CHNL-FFLMT-TYP-CDE        44130000
BOSSCL           END-IF                                                 44140000
353400           MOVE EPTRN-PARTN-NBR       TO  PV-PARTN-NBR            44150000
353500           MOVE EPTRN-STR-NBR         TO  PV-STR-NBR              44160000
353600           MOVE EPTRN-RGST-ID         TO  PV-RGST-ID              44170000
353700           MOVE EPTRN-TRN-NBR         TO  PV-TRN-NBR              44180000
353800           MOVE EPTRN-STRT-TM         TO  PV-STRT-TM              44190000
353900           MOVE EPTRN-SLS-CORR-SEQ-NBR  TO  PV-SLS-CORR-SEQ-NBR   44200000
354000                                                                  44210000
354100           PERFORM 1117-CALCU-KOHLS-MONTH                         44220000
354200           PERFORM 2500-OPEN-ITEM-CURSOR                          44230000
354300           PERFORM 2600-FETCH-ITEM-CURSOR                         44240000
354400              UNTIL PS-END-OF-ITEM-YES                            44250000
354500           PERFORM 2700-CLOSE-ITEM-CURSOR                         44260000
354600           ADD 1                      TO WS-CMT-CNT               44270000
354700                                                                  44280000
354800        WHEN SQLCODE = PC-ROW-NOT-FOUND                           44290000
354900           SET PS-END-OF-DKEY-YES     TO TRUE                     44300000
355000        WHEN SQLWARN0 NOT EQUAL SPACE                             44310000
355100        WHEN SQLCODE NOT EQUAL ZERO                               44320000
355200           MOVE '6100-FETCH-DKEY-CURSOR'                          44330000
355300                                      TO PV-PARAGRAPH-NAME        44340000
355400           SET AC-DB2-ERROR           TO TRUE                     44350000
355500           PERFORM 9999-ABEND                                     44360000
355600     END-EVALUATE.                                                44370000
355700                                                                  44380000
355800     IF WS-CMT-CNT > 2000                                         44390000
355900       PERFORM 8999-COMMIT-PARA                                   44400000
356000       MOVE ZEROS                         TO WS-CMT-CNT           44410000
356100     END-IF.                                                      44420000
356200                                                                  44430000
356300******************************************************************44440000
356400 6200-CLOSE-DKEY-CURSOR.                                          44450000
356500******************************************************************44460000
356600                                                                  44470000
356700     EXEC SQL                                                     44480000
356800          CLOSE TEPDKEY-CURSOR                                    44490000
356900     END-EXEC.                                                    44500000
357000                                                                  44510000
357100     EVALUATE TRUE                                                44520000
357200        WHEN SQLCODE = ZERO                                       44530000
357300           CONTINUE                                               44540000
357400        WHEN OTHER                                                44550000
357500           MOVE '6200-CLOSE-DKEY-CURSOR'    TO PV-PARAGRAPH-NAME  44560000
357600           SET AC-DB2-ERROR           TO TRUE                     44570000
357700           PERFORM 9999-ABEND                                     44580000
357800     END-EVALUATE.                                                44590000
357900                                                                  44600000
453500                                                                  44610000
453600******************************************************************44620000
453700*6000-OPEN-DKEY-CURSOR.                                           44630000
453800******************************************************************44640000
453900*                                                                 44650000
454000*    EXEC SQL                                                     44660000
454100*         OPEN TEPDKEY-CURSOR                                     44670000
454200*    END-EXEC.                                                    44680000
454300*                                                                 44690000
454400*    EVALUATE TRUE                                                44700000
454500*       WHEN SQLCODE = ZERO                                       44710000
454600*          CONTINUE                                               44720000
454700*       WHEN OTHER                                                44730000
454800*          MOVE '6000-OPEN-DKEY-CURSOR'                           44740000
454900*                                     TO PV-PARAGRAPH-NAME        44750000
455000*          PERFORM 9999-ABEND                                     44760000
455100*    END-EVALUATE.                                                44770000
455200*                                                                 44780000
455300******************************************************************44790000
455400*6100-FETCH-DKEY-CURSOR.                                          44800000
455500*     FETCH LATE AND SALES CORRECTION TRANSACTIONS.               44810000
455600******************************************************************44820000
455700*                                                                 44830000
455800*    DISPLAY '6100-FETCH-DKEY-CURSOR'.                            44840000
455900*                                                                 44850000
456000*    EXEC SQL                                                     44860000
456100*         FETCH TEPDKEY-CURSOR                                    44870000
456200*          INTO :EPTRN-PARTN-NBR                                  44880000
456300*              ,:EPTRN-STR-NBR                                    44890000
456400*              ,:EPTRN-RGST-ID                                    44900000
456500*              ,:EPTRN-TRN-NBR                                    44910000
456600*              ,:EPTRN-STRT-TM                                    44920000
456700*              ,:EPTRN-SLS-CORR-SEQ-NBR                           44930000
456800*              ,:EPTRN-TRN-STAT-CDE                               44940000
456900*              ,:EPTRN-SLS-DTE                                    44950000
ZX    *              ,:EPTRN-TRN-DTE                                    44960000
457000*              ,:EPTRN-POS-CPBL-LVL-NBR                           44970000
457100*              ,:EPTRN-CRE-TMST                                   44980000
457200*    END-EXEC.                                                    44990000
457300*                                                                 45000000
457400*    DISPLAY '  SQLCODE = ' SQLCODE.                              45010000
457500*                                                                 45020000
457600*    EVALUATE TRUE                                                45030000
457700*       WHEN SQLCODE = ZERO                                       45040000
457800*          MOVE EPTRN-PARTN-NBR       TO  PV-PARTN-NBR            45050000
457900*          MOVE EPTRN-STR-NBR         TO  PV-STR-NBR              45060000
458000*          MOVE EPTRN-RGST-ID         TO  PV-RGST-ID              45070000
458100*          MOVE EPTRN-TRN-NBR         TO  PV-TRN-NBR              45080000
458200*          MOVE EPTRN-STRT-TM         TO  PV-STRT-TM              45090000
458300*          MOVE EPTRN-SLS-CORR-SEQ-NBR  TO  PV-SLS-CORR-SEQ-NBR   45100000
458400*                                                                 45110000
458500*          PERFORM 1117-CALCU-KOHLS-MONTH                         45120000
458600*                                                                 45130000
458700*          IF  WS-CNTL-SKU = ZEROS                                45140000
458800*              PERFORM 2500-OPEN-ITEM-CURSOR                      45150000
458900*              PERFORM 2600-FETCH-ITEM-CURSOR                     45160000
459000*                 UNTIL PS-END-OF-ITEM-YES                        45170000
459100*              PERFORM 2700-CLOSE-ITEM-CURSOR                     45180000
459200*          ELSE                                                   45190000
459300*              PERFORM 2500-OPEN-ITEM-CURSORX                     45200000
459400*              PERFORM 2600-FETCH-ITEM-CURSORX                    45210000
459500*                 UNTIL PS-END-OF-ITEM-YES                        45220000
459600*              PERFORM 2700-CLOSE-ITEM-CURSORX                    45230000
459700*          END-IF                                                 45240000
459800*                                                                 45250000
459900**         PERFORM 2500-OPEN-ITEM-CURSOR                          45260000
460000**         PERFORM 2600-FETCH-ITEM-CURSOR                         45270000
460100**            UNTIL PS-END-OF-ITEM-YES                            45280000
460200**         PERFORM 2700-CLOSE-ITEM-CURSOR                         45290000
460300*                                                                 45300000
460400*       WHEN SQLCODE = PC-ROW-NOT-FOUND                           45310000
460500*          SET PS-END-OF-DKEY-YES     TO TRUE                     45320000
460600*                                                                 45330000
460700*       WHEN SQLWARN0 NOT EQUAL SPACE                             45340000
460800*       WHEN SQLCODE NOT EQUAL ZERO                               45350000
460900*          MOVE '6100-FETCH-DKEY-CURSOR'                          45360000
461000*                                     TO PV-PARAGRAPH-NAME        45370000
461100*          PERFORM 9999-ABEND                                     45380000
461200*    END-EVALUATE.                                                45390000
461300*                                                                 45400000
461400******************************************************************45410000
461500*6200-CLOSE-DKEY-CURSOR.                                          45420000
461600******************************************************************45430000
461700*                                                                 45440000
461800*    EXEC SQL                                                     45450000
461900*         CLOSE TEPDKEY-CURSOR                                    45460000
462000*    END-EXEC.                                                    45470000
462100*                                                                 45480000
462200*    EVALUATE TRUE                                                45490000
462300*       WHEN SQLCODE = ZERO                                       45500000
462400*          CONTINUE                                               45510000
462500*       WHEN OTHER                                                45520000
462600*          MOVE '6200-CLOSE-DKEY-CURSOR'    TO PV-PARAGRAPH-NAME  45530000
462700*          PERFORM 9999-ABEND                                     45540000
462800*    END-EVALUATE.                                                45550000
462900*                                                                 45560000
463000******************************************************************45570000
463100 6300-SELECT-TIERED.                                              45580000
463200******************************************************************45590000
463300                                                                  45600000
463400      EXEC SQL                                                    45610000
463500         SELECT  LID_AMT                                          45620000
ZX                    ,LID_RSN_CDE                                      45630000
358600           INTO :EPLID-LID-AMT                                    45640000
ZX                   ,:EPLID-LID-RSN-CDE                                45650000
463700           FROM TEPLID                                            45660000
463800          WHERE PARTN_NBR = :PV-PARTN-NBR                         45670000
463900            AND STR_NBR   = :PV-STR-NBR                           45680000
464000            AND RGST_ID   = :PV-RGST-ID                           45690000
464100            AND TRN_NBR   = :PV-TRN-NBR                           45700000
464200            AND STRT_TM   = :PV-STRT-TM                           45710000
464300            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           45720000
464400            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            45730000
464500            AND LID_TYP_CDE      = 'T'                            45740000
464600                WITH UR                                           45750000
464700      END-EXEC.                                                   45760000
464800                                                                  45770000
464900     EVALUATE TRUE                                                45780000
465000        WHEN SQLCODE = ZERO                                       45790000
465100           SET PS-TIERED-ITEM-YES     TO TRUE                     45800000
465200        WHEN SQLCODE = PC-ROW-NOT-FOUND                           45810000
465300           SET PS-TIERED-ITEM-NO      TO TRUE                     45820000
465400        WHEN SQLWARN0 NOT EQUAL SPACE                             45830000
465500        WHEN SQLCODE NOT EQUAL ZERO                               45840000
465600           MOVE '6100-FETCH-DKEY-CURSOR'                          45850000
465700                                      TO PV-PARAGRAPH-NAME        45860000
360800           SET AC-DB2-ERROR           TO TRUE                     45870000
465800           PERFORM 9999-ABEND                                     45880000
465900     END-EVALUATE.                                                45890000
466000                                                                  45900000
466100******************************************************************45910000
466200 7500-READ-CRITERIA.                                              45920000
466300*     READ CRITERIA FILE                                          45930000
466400******************************************************************45940000
466500                                                                  45950000
466600     READ CRITERIA-FILE            INTO CNTL-CARD                 45960000
466700        AT END                                                    45970000
466800           SET PS-END-OF-CRIT-FILE   TO TRUE.                     45980000
466900                                                                  45990000
467000******************************************************************46000000
467100 8000-WRITE-LEDGER-MKDN-RECORD.                                   46010000
467200*     WRITE A LEDGER MARKDOWN TRANSACTION RECORD.                 46020000
467300******************************************************************46030000
467400** ACCUMULATES MARKDOWNS/MARKDOWN CANCELS WRITTEN TO FILE.        46040000
467500     IF ML017-MARKDOWN-CANCEL                                     46050000
467600          COMPUTE PV-TOTAL-MKDNCAN-AMT =                          46060000
467700             (ML017-PC-DIFFER-AMT * -1) + PV-TOTAL-MKDNCAN-AMT    46070000
467800     ELSE                                                         46080000
467900          ADD ML017-PC-DIFFER-AMT TO PV-TOTAL-MKDN-AMT            46090000
468000     END-IF                                                       46100000
468100                                                                  46110000
468200     WRITE LM-LEDGER-MARKDOWN-RECORD                              46120000
468300         FROM ML017-PRICE-CHANGE-RECORD.                          46130000
468400                                                                  46140000
468500******************************************************************46150000
468600 8025-WRITE-HOLD-LEDGR-MKDN-REC.                                  46160000
468700*     WRITE A HOLD LEDGER MARKDOWN TRANSACTION RECORD.            46170000
468800******************************************************************46180000
BOSSCL     IF ML017-MARKDOWN-CANCEL                                     46190000
BOSSCL          COMPUTE PV-TOTAL-MKDNCAN-AMT =                          46200000
BOSSCL             (ML017-PC-DIFFER-AMT * -1) + PV-TOTAL-MKDNCAN-AMT    46210000
BOSSCL     ELSE                                                         46220000
BOSSCL          ADD ML017-PC-DIFFER-AMT TO PV-TOTAL-MKDN-AMT            46230000
BOSSCL     END-IF.                                                      46240000
468100                                                                  46250000
468900     WRITE HOLD-LEDGER-MARKDOWN-RECORD                            46260000
469000         FROM ML017-PRICE-CHANGE-RECORD.                          46270000
469100                                                                  46280000
470800******************************************************************46450000
470900 8100-WRITE-LEDGER-MKUP-RECORD.                                   46460000
471000*     WRITE A LEDGER MARKUP TRANSACTION RECORD.                   46470000
471100******************************************************************46480000
471200                                                                  46490000
471300     WRITE LM-LEDGER-MARKUP-RECORD                                46500000
471400         FROM ML017-PRICE-CHANGE-RECORD.                          46510000
471500                                                                  46520000
471600******************************************************************46530000
471700 8125-WRITE-HOLD-LEDGR-MKUP-REC.                                  46540000
471800*     WRITE A HOLD LEDGER MARKUP TRANSACTION RECORD.              46550000
471900******************************************************************46560000
472000                                                                  46570000
472100     WRITE HOLD-LEDGER-MARKUP-RECORD                              46580000
472200         FROM ML017-PRICE-CHANGE-RECORD.                          46590000
472300                                                                  46600000
474000******************************************************************46770000
474100 8180-FORMAT-MW-RECORD.                                           46780000
474200*     COPY THE MLRD017 TO MLRD044 FOR DATA WAREHOUSE              46790000
474300******************************************************************46800000
474400      INITIALIZE ML044-PRICE-CHANGE-RECORD.                       46810000
474500      MOVE ML017-PC-CDE              TO ML044-PC-CDE.             46820000
474600      MOVE ML017-PC-TYP-CDE          TO ML044-PC-TYP-CDE.         46830000
474700      MOVE ML017-SLS-CORR-CDE        TO ML044-SLS-CORR-CDE.       46840000
474800      MOVE ML017-PC-DOC-5-NBR        TO ML044-PC-DOC-5-NBR.       46850000
474900      MOVE ML017-PC-DTE              TO ML044-PC-DTE.             46860000
475000      MOVE ML017-PC-KOHLS-MM         TO ML044-PC-KOHLS-MM.        46870000
475100      MOVE ML017-PC-SKU              TO ML044-PC-SKU.             46880000
475200      MOVE ML017-PC-RSN-CDE          TO ML044-PC-RSN-CDE.         46890000
475300      MOVE ML017-PC-OLD-PR-AMT       TO ML044-PC-OLD-PR-AMT.      46900000
475400      MOVE ML017-PC-NEW-PR-AMT       TO ML044-PC-NEW-PR-AMT.      46910000
475500      MOVE ML017-PC-QTY              TO ML044-PC-QTY.             46920000
475600      MOVE ML017-PC-BATCH-NBR        TO ML044-PC-BATCH-NBR.       46930000
475700      MOVE ML017-PC-MKDN-MKUP-RSN-CDE TO                          46940000
475800           ML044-PC-MKDN-MKUP-RSN-CDE.                            46950000
475900      MOVE ML017-PC-DIFFER-AMT       TO ML044-PC-DIFFER-AMT       46960000
476000      MOVE ML017-PC-TOT-DOC-QTY      TO ML044-PC-TOT-DOC-QTY.     46970000
476100      MOVE ML017-PC-STORE-NBR        TO ML044-PC-STORE-NBR.       46980000
476200      MOVE ML017-PC-CATEG-CDE        TO ML044-PC-CATEG-CDE.       46990000
476300      MOVE ML017-PC-DOC-7-NBR        TO ML044-PC-DOC-7-NBR.       47000000
476400      MOVE ML017-PC-VENDOR-INHSE-NMBR TO                          47010000
476500           ML044-PC-VENDOR-INHSE-NMBR.                            47020000
476600      MOVE ML017-PC-LINE-NBR         TO ML044-PC-LINE-NBR.        47030000
476700      MOVE ML017-PC-SKU-DTA-ATTRIB   TO ML044-PC-SKU-DTA-ATTRIB.  47040000
476800      MOVE ML017-PC-DEPT-CLASS       TO ML044-PC-DEPT-CLASS.      47050000
476900      MOVE ML017-PC-MAJ-CLASS        TO ML044-PC-MAJ-CLASS.       47060000
477000      MOVE ML017-RGST-ID             TO ML044-RGST-ID.            47070000
477100      MOVE ML017-TRN-NBR             TO ML044-TRN-NBR.            47080000
477200      MOVE PV-STRT-TM                TO ML044-STRT-TM.            47090000
477300      MOVE PV-SLS-CORR-SEQ-NBR       TO ML044-SLS-CORR-SEQ-NBR.   47100000
477400      MOVE ML017-LNE-ITM-SEQ-NBR     TO ML044-LNE-ITM-SEQ-NBR.    47110000
477500      MOVE PV-LID-SEQ-NBR            TO ML044-LID-SEQ-NBR.        47120000
477600      MOVE ML017-GMM                 TO ML044-GMM.                47130000
477700      MOVE ML017-DMM                 TO ML044-DMM.                47140000
477800      MOVE ML017-BUYER               TO ML044-BUYER.              47150000
477900      MOVE ML017-PC-ENT-ID           TO ML044-PC-ENT-ID.          47160000
478000      MOVE ML017-ORIG-CLR-DTE        TO ML044-ORIG-CLR-DTE.       47170000
478100      MOVE ML017-MKDN-CDE            TO ML044-MKDN-CDE.           47180000
478200      MOVE ML017-ORIG-CLR-NONGRP-RTL TO ML044-ORIG-CLR-NONGRP-RTL.47190000
478300      MOVE ML017-PC-DA               TO ML044-PC-DA.              47200000
478400      MOVE PV-ISO-DB2-CC             TO ML044-PC-DTE-YEAR(1:2).   47210000
478500      MOVE PV-ISO-DB2-YY             TO ML044-PC-DTE-YEAR(3:2).   47220000
478600                                                                  47230000
478700******************************************************************47240000
478800 8190-WRITE-DATAWHSE-RECORD.                                      47250000
478900*     WRITE A DATAWHSE TRANSACTION RECORD.                        47260000
479000******************************************************************47270000
479100                                                                  47280000
479200     WRITE DATAWHSE-RECORD                                        47290000
479300         FROM ML044-PRICE-CHANGE-RECORD.                          47300000
ZX         INITIALIZE EPLID-LID-SEQ-NBR.                                47310000
479500                                                                  47320000
ZX    ******************************************************************47330000
ZX     8195-BUILD-DAY02-TRANS-RECORD.                                   47340000
ZX    *     BUILD A DAY 2 TRANSACTION RECORD.                           47350000
ZX    ******************************************************************47360000
ZX         INITIALIZE WS-DAY02-TRANS-RECORD.                            47370000
ZX         IF EPITM-SAL-RET-CDE = 'S'                                   47380000
ZX             MOVE 'SALE'           TO WS-TRAN-TYPE.                   47390000
ZX         IF EPITM-SAL-RET-CDE = 'R'                                   47400000
ZX             MOVE 'RETURN'         TO WS-TRAN-TYPE.                   47410000
ZX         IF EPITM-SAL-RET-CDE = 'A'                                   47420000
ZX             MOVE 'PRICE ADJ SALE' TO WS-TRAN-TYPE.                   47430000
ZX         IF EPITM-SAL-RET-CDE = 'B'                                   47440000
ZX             MOVE 'PRICE ADJ RET ' TO WS-TRAN-TYPE.                   47450000
ZX         MOVE EPTRN-SLS-DTE        TO WS-EPTRN-SLS-DTE.               47460000
ZX         MOVE EPTRN-TRN-DTE        TO WS-EPTRN-TRN-DTE.               47470000
ZX         IF PS-ORDER-NUMBER-FOUND-N                                   47480000
ZX             MOVE SPACES           TO WS-EPORD-ORD-NBR                47490000
ZX         ELSE                                                         47500000
ZX             MOVE EPORD-ORD-NBR-TEXT                                  47510000
ZX                                   TO WS-EPORD-ORD-NBR                47520000
ZX         END-IF.                                                      47530000
ZX         MOVE PV-PARTN-NBR         TO WS-EPITM-PARTN-NBR.             47540000
ZX         MOVE PV-STR-NBR           TO WS-EPITM-STR-NBR.               47550000
ZX         MOVE PV-RGST-ID           TO WS-EPITM-RGST-ID.               47560000
ZX         MOVE PV-TRN-NBR           TO WS-EPITM-TRN-NBR.               47570000
ZX         MOVE PV-STRT-TM           TO WS-EPITM-STRT-TM.               47580000
ZX         MOVE PV-SLS-CORR-SEQ-NBR  TO WS-EPITM-SLS-CORR-SEQ-NBR.      47590000
ZX         MOVE PV-LNE-ITM-SEQ-NBR   TO WS-EPITM-LNE-ITM-SEQ-NBR.       47600000
ZX         MOVE PV-REG-RTL-AMT       TO WS-REG-RTL-AMT.                 47610000
ZX         MOVE PV-ORIG-REG-RTL-AMT  TO WS-ORIG-REG-RTL-AMT.            47620000
ZX         MOVE PV-ORIG-SAL-TYP-CDE  TO WS-ORIG-SAL-TYP-CDE.            47630000
ZX         MOVE PV-SAL-TYP-CDE       TO WS-SAL-TYP-CDE.                 47640000
ZX         MOVE PV-CUST-CHRGD-AMTS   TO WS-CUST-CHRGD-AMT.              47650000
ZX         MOVE PV-NET-CHRGD-AMTS    TO WS-NET-CHRGD-AMT.               47660000
ZX         MOVE PV-ORIG-OURA-AMTS    TO WS-ORIG-OURA-AMT.               47670000
ZX         MOVE PV-OURA-AMTS         TO WS-OURA-AMT.                    47680000
ZX         MOVE PV-ITM-STAT-CDE      TO WS-ITM-STAT-CDE.                47690000
ZX         MOVE PV-DEPT-NBR          TO WS-DEPT-NBR.                    47700000
ZX         MOVE PV-SKU-NBR           TO WS-EPITM-SKU-NBR.               47710000
ZX         MOVE PV-OMNI-CHNL-FFLMT-TYP-CDE                              47720000
ZX                                   TO WS-OMNI-CHNL-FFLMT-TYP-CDE.     47730000
ZX         IF EPLID-LID-AMT NOT NUMERIC                                 47740000
ZX             MOVE ZERO TO EPLID-LID-AMT                               47750000
ZX         END-IF.                                                      47760000
ZX         IF PV-DISC-TYPE-GROUP                                        47770000
ZX             MOVE WS-EPIGP-GP-AMT  TO WS-EPLID-LID-AMT                47780000
ZX             MOVE 'GRP'            TO WS-EPLID-LID-RSN-CDE            47790000
ZX    *                                        EPIGP-GP-QTY             47800000
ZX         ELSE                                                         47810000
ZX             IF PV-DISC-TYPE-ASSOC                                    47820000
ZX                 MOVE EPEID-EMP-DISC-AMT                              47830000
ZX                                   TO WS-EPLID-LID-AMT                47840000
ZX                 MOVE '790'        TO WS-EPLID-LID-RSN-CDE            47850000
ZX             ELSE                                                     47860000
ZX                 MOVE EPLID-LID-AMT                                   47870000
ZX                                   TO WS-EPLID-LID-AMT                47880000
ZX                 MOVE EPLID-LID-RSN-CDE                               47890000
ZX                                   TO WS-EPLID-LID-RSN-CDE            47900000
ZX                 IF EPLID-LID-RSN-CDE = SPACES                        47910000
ZX                     MOVE 'MAN'    TO WS-EPLID-LID-RSN-CDE            47920000
ZX                 END-IF                                               47930000
ZX             END-IF                                                   47940000
ZX         END-IF.                                                      47950000
ZX         IF WS-DISC-TYPE = PC-OWNERSHIP-ADJ OR                        47960000
ZX            WS-DISC-TYPE = PC-OWN-RETRN-ADJ OR                        47961000
ZX            WS-DISC-TYPE = PC-PROMOTIONAL                             47962000
ZX             MOVE SPACES           TO WS-EPLID-LID-RSN-CDE            47963000
ZX             MOVE ZEROES           TO WS-EPLID-LID-AMT                47964000
ZX         END-IF.                                                      47965000
ZX         MOVE WS-DISC-TYPE         TO WS-DISC-TYPE-FILE.              47966000
ZX         MOVE WS-DISC-AMT          TO WS-DISC-AMT-FILE.               47967000
ZX         MOVE WS-MDWN-TYPE         TO WS-MDWN-TYPE-FILE.              47967100
ZX         MOVE WS-ISSUE-IND         TO WS-PROBLEM-IND.                 47967200
ZX         MOVE ML017-PC-OLD-PR-AMT  TO WS-OLD-PRICE-AMT.               47967300
ZX         MOVE ML017-PC-NEW-PR-AMT  TO WS-NEW-PRICE-AMT.               47967400
ZX         MOVE ML017-PC-DIFFER-AMT  TO WS-DIFF-PRICE-AMT.              47967500
                                                                        47967600
ZX    ******************************************************************47967700
ZX     8195-WRITE-DAY02-TRANS-RECORD.                                   47967800
ZX    *     WRITE A DAY 2 TRANSACTION RECORD.                           47967900
ZX    ******************************************************************47968000
ZX                                                                      47968100
ZX    *    DISPLAY WS-DAY02-TRANS-RECORD.                               47968200
ZX         WRITE DAY02-TRANS-RECORD                                     47968300
ZX             FROM WS-DAY02-TRANS-RECORD.                              47968400
ZX         MOVE SPACE TO WS-ISSUE-IND.                                  47968500
ZX                                                                      47968600
ZX    ******************************************************************47968700
ZX     8196-WRITE-DAY02-HEADR-RECORD.                                   47968800
ZX    *     WRITE A DAY 2 HEADER      RECORD.                           47968900
ZX    ******************************************************************47969000
ZX                                                                      47969100
ZX         WRITE DAY02-TRANS-RECORD                                     47969200
ZX             FROM WS-DAY02-HEADR-RECORD.                              47969300
ZX                                                                      47969400
479600******************************************************************47969500
479700 8200-WRITE-DETAIL-LINE.                                          47969600
479800*     WRITE THE DETAIL LINES FOR THE REPORT.                      47969700
479900******************************************************************47969800
480000                                                                  47969900
480100     IF PV-LINE-COUNT GREATER THAN PC-LINE-LIMIT                  47970000
480200         MOVE ZERO TO PV-LINE-COUNT                               47971000
480300         ADD 3     TO PV-LINE-COUNT                               47972000
480400         PERFORM 8400-WRITE-HEADERS                               47973000
480500     END-IF.                                                      47974000
480600                                                                  47975000
480700     MOVE 2 TO PV-SPACE-CONTROL.                                  47976000
480800                                                                  47977000
480900     WRITE REPORT-LINE-OUT                                        47978000
481000         FROM DL-DETAIL-LINE AFTER ADVANCING PV-SPACE-CONTROL.    47979000
481100                                                                  47980000
481200     INITIALIZE DL-DETAIL-LINE.                                   47990000
481300                                                                  48000000
481400     ADD 2 TO PV-LINE-COUNT.                                      48010000
481500                                                                  48020000
481600******************************************************************48030000
481700 8300-WRITE-NON-OWNED.                                            48040000
481800*     WRITE THE NON OWNED MDSE MARKDOWNS DROPPED.                 48050000
481900******************************************************************48060000
482000                                                                  48070000
482100     MOVE 2 TO PV-SPACE-CONTROL.                                  48080000
482200                                                                  48090000
482300     WRITE REPORT-LINE-OUT                                        48100000
482400         FROM TD-TOTAL-DISPLAY-MESSAGE                            48110000
482500            AFTER ADVANCING PV-SPACE-CONTROL.                     48120000
482600                                                                  48130000
262807**   FORCING PAGE BREAKS AT END OF SECTIONS IN THIS PROGRAM       48131034
262807**   CAUSES KELLY TO GET 1 PAGE WITH HEADINGS AT THE BOTTOM.      48132034
262807     ADD 2 TO PV-LINE-COUNT.                                      48134034
482800                                                                  48150000
482900     IF PV-LINE-COUNT GREATER THAN PC-LINE-LIMIT                  48160000
483000         PERFORM 8400-WRITE-HEADERS                               48170000
483100         MOVE ZERO TO PV-LINE-COUNT                               48180000
483200                                                                  48190000
483300         ADD 3     TO PV-LINE-COUNT                               48200000
483400     END-IF.                                                      48210000
483500                                                                  48220000
483600******************************************************************48230000
483700 8400-WRITE-HEADERS.                                              48240000
483800*     WRITE THE REPORT HEADERS.                                   48250000
483900******************************************************************48260000
484000                                                                  48270000
484100     MOVE 1 TO PV-SPACE-CONTROL.                                  48280000
484200     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    48290000
484300                                                                  48300000
484400     WRITE REPORT-LINE-OUT                                        48310000
484500          FROM DP132O-STANDRD-HEADER-132-COLS                     48320000
484600             AFTER ADVANCING PAGE.                                48330000
484700     ADD 1 TO PV-PAGE-COUNT.                                      48340000
484800                                                                  48350000
484900     WRITE REPORT-LINE-OUT                                        48360000
485000         FROM HL-HEADER-LINE1                                     48370000
485100            AFTER ADVANCING PV-SPACE-CONTROL.                     48380000
485200                                                                  48390000
485300     WRITE REPORT-LINE-OUT                                        48400000
485400         FROM HL-HEADER-LINE1-1                                   48410000
485500            AFTER ADVANCING PV-SPACE-CONTROL.                     48420000
485600                                                                  48430000
485700     MOVE 2 TO PV-SPACE-CONTROL.                                  48440000
485800                                                                  48450000
485900     WRITE REPORT-LINE-OUT                                        48460000
486000         FROM HL-HEADER-LINE2                                     48470000
486100            AFTER ADVANCING PV-SPACE-CONTROL.                     48480000
486200                                                                  48490000
486300     MOVE 1 TO PV-SPACE-CONTROL.                                  48500000
486400                                                                  48510000
486500     WRITE REPORT-LINE-OUT                                        48520000
486600         FROM HL-HEADER-LINE3                                     48530000
486700            AFTER ADVANCING PV-SPACE-CONTROL.                     48540000
486800                                                                  48550000
486900     MOVE 7 TO PV-LINE-COUNT.                                     48560000
487000                                                                  48570000
381100******************************************************************48580000
381200* COMMIT DATABASE CHNAGES                                         48590000
381300******************************************************************48600000
381400 8999-COMMIT-PARA.                                                48610000
381500                                                                  48620000
381600     EXEC SQL                                                     48630000
381700         COMMIT                                                   48640000
381800     END-EXEC.                                                    48650000
381900                                                                  48660000
382000     EVALUATE TRUE                                                48670000
382100       WHEN SQLCODE = ZERO                                        48680000
382200         CONTINUE                                                 48690000
382300       WHEN SQLWARN0 NOT EQUAL SPACE                              48700000
382400       WHEN SQLCODE NOT EQUAL ZERO                                48701000
382500         MOVE '8999-COMMIT-PARA'  TO PV-PARAGRAPH-NAME            48702000
382600         SET AC-DB2-ERROR           TO TRUE                       48703000
382700         PERFORM 9999-ABEND                                       48704000
382800     END-EVALUATE.                                                48705000
382900                                                                  48706000
487100******************************************************************48707000
487200 9000-EOJ-ROUTINE.                                                48708000
487300*     CLOSE FILES.                                                48709000
487400******************************************************************48709100
487500                                                                  48709200
487600     CLOSE LEDGER-MARKDOWN-FILE                                   48709300
487700           LEDGER-MARKUP-FILE                                     48709400
488000           HOLD-LEDGER-MARKDOWN-FILE                              48709700
488100           HOLD-LEDGER-MARKUP-FILE                                48709800
488400           DATAWHSE-FILE                                          48720000
ZX               DAY02-TRANS-REPORT                                     48730000
488500           MERCH-LEDGER-REPORT                                    48740000
488600           CRITERIA-FILE.                                         48750000
488700                                                                  48760000
488800******************************************************************48770000
488900 9999-ABEND.                                                      48780000
489000*     DISPLAY ABEND INFO.                                         48790000
489100******************************************************************48800000
489200                                                                  48810000
489300     DISPLAY '************ SAKUT801 ABEND ************'.          48820000
489400     DISPLAY '**  PROGRAM   ** ' PC-CURRENT-PROGRAM-NAME.         48830000
489500     DISPLAY '**  PARAGRAPH ** ' PV-PARAGRAPH-NAME.               48840000
489600     DISPLAY '**  SQLCODE   ** ' SQLCODE.                         48850000
062118     DISPLAY '**  SQLSTATE  ** ' SQLSTATE.                        48860000
489700     DISPLAY '**  SLS DATE  ** ' EPTRN-SLS-DTE.                   48870000
489700     DISPLAY '**  TRN DATE  ** ' EPTRN-TRN-DTE.                   48880000
489800     DISPLAY '**  STORE NBR ** ' EPTRN-STR-NBR.                   48890000
489900     DISPLAY '**  REGISTER  ** ' EPTRN-RGST-ID.                   48900000
490000     DISPLAY '**  TRAN      ** ' EPTRN-TRN-NBR.                   48910000
490100     DISPLAY '************ SAKUT801 ******************'.          48920000
490200                                                                  48930000
490300     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         48940000
490400                                                                  48950000
