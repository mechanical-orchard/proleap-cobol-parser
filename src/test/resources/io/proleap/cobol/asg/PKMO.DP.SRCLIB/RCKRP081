000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID.    RCKRP081.                                         00050099
000600 AUTHOR.        PAUL JORGENSEN.                                   00060099
000700 INSTALLATION.  KOHLS.                                            00070099
000800 DATE-WRITTEN   SEPT 2012.                                        00080099
000900 DATE-COMPILED.                                                   00090099
001000                                                                  00100099
001100******************************************************************00110099
001200* THIS PROGRAM TAKES IN THE OUTPUT OF RCKUT149 AND CREATES A      00120099
001300* SEASONAL SET RECAP REPORT.                                      00130099
001330******************************************************************00141099
001300* CHANGE HISTORY:                                                *00142099
001300*    CHANGES                                                     *00143099
001300*     MADE BY: VENKATSUBBU (COGNIZANT)                           *00144099
001300*     DATE:    11/26/2014                                        *00145099
001300*                                                                *00146099
001300*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#  *00147099
001300*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *TV 11/26/2014     *00148099
001340******************************************************************00149099
001500******************************************************************00150099
001600 ENVIRONMENT DIVISION.                                            00160099
001700******************************************************************00170099
001800 CONFIGURATION SECTION.                                           00180099
001900 SOURCE-COMPUTER.        IBM-3090.                                00190099
002000 OBJECT-COMPUTER.        IBM-3090.                                00200099
002100                                                                  00210099
002200 INPUT-OUTPUT SECTION.                                            00220099
002300 FILE-CONTROL.                                                    00230099
002400                                                                  00240099
002500     SELECT INPUT-FILE                                            00250099
002600         ASSIGN TO INP01.                                         00260099
002700                                                                  00270099
002800     SELECT REPORT-FILE1                                          00280099
002900         ASSIGN TO RPT01.                                         00290099
003000                                                                  00300099
003100******************************************************************00310099
003200 DATA DIVISION.                                                   00320099
003300******************************************************************00330099
003400                                                                  00340099
003500 FILE SECTION.                                                    00350099
003600                                                                  00360099
003700 FD  INPUT-FILE                                                   00370099
003800     RECORDING MODE IS F                                          00380099
003900     LABEL RECORDS ARE STANDARD                                   00390099
004000     RECORD CONTAINS 110                                          00400099
004100     BLOCK CONTAINS 0 RECORDS                                     00410099
004200     DATA RECORD IS INPUT-RECORD.                                 00420099
004300                                                                  00430099
004400 01  INPUT-RECORD              PIC  X(110).                       00440099
004500                                                                  00450099
004600 FD  REPORT-FILE1                                                 00460099
004700     RECORDING MODE IS F                                          00470099
004800     LABEL RECORDS ARE STANDARD                                   00480099
004900*CHG98147 - START                                                 00490099
005000*    RECORD CONTAINS 132                                          00500099
005100     RECORD CONTAINS 200                                          00510099
005200     BLOCK CONTAINS 0 RECORDS                                     00520099
005300     DATA RECORD IS REPORT-RECORD.                                00530099
005400                                                                  00540099
005500*01  REPORT-RECORD             PIC  X(132).                       00550099
005600 01  REPORT-RECORD             PIC  X(200).                       00560099
005700*CHG98147 - END                                                   00570099
005800                                                                  00580099
005900******************************************************************00590099
006000 WORKING-STORAGE SECTION.                                         00600099
006100******************************************************************00610099
006200 01  PS-PROGRAM-SWITCHES.                                         00620099
006300     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00630099
006400         88  PS-EOF-INPUT                        VALUE 'Y'.       00640099
006500         88  PS-NOT-EOF-INPUT                    VALUE 'N'.       00650099
006600     05  PS-FIRST-RECORD-SW           PIC X(01)  VALUE 'Y'.       00660099
006700         88  PS-FIRST-RECORD                     VALUE 'Y'.       00670099
006800         88  PS-FIRST-RECORD-NO                  VALUE 'N'.       00680099
006900     05  PS-NEW-DUPLICATE-SW          PIC X(01)  VALUE 'Y'.       00690099
007000         88  PS-NEW-DUPLICATE                    VALUE 'Y'.       00700099
007100         88  PS-SAVED-DUPLICATE                  VALUE 'D'.       00710099
007200         88  PS-NEW-DUPLICATE-NO                 VALUE 'N'.       00720099
007300                                                                  00730099
007400 01  PC-PROGRAM-CONSTANTS.                                        00740099
007500     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'RCKRP081'. 00750099
007600     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3 COMP.   00760099
007700     05  PC-NO-INPUT-LINE.                                        00770099
007800          10  FILLER                  PIC  X(39)  VALUE SPACE.    00780099
007900          10  FILLER                  PIC  X(55) VALUE            00790099
008000         '        ***  THERE IS NO DATA TO REPORT  ***         '. 00800099
008100          10  FILLER                  PIC  X(38)  VALUE SPACE.    00810099
008200     05  PC-END-OF-REPORT-LINE.                                   00820099
008300          10  FILLER                  PIC  X(39)  VALUE SPACE.    00830099
008400          10  FILLER                  PIC  X(55) VALUE            00840099
008500         '               ***  END OF REPORT  ***               '. 00850099
008600          10  FILLER                  PIC  X(38)  VALUE SPACE.    00860099
008700                                                                  00870099
008800 01  PV-PROGRAM-VARIABLES.                                        00880099
008900     05  PV-RECORDS-READ              PIC 9(09)  VALUE ZERO.      00890099
009000     05  PV-DUPLICATES-WRITTEN        PIC 9(09)  VALUE ZERO.      00900099
009100     05  PV-LINE-CNT                  PIC 9(09)  VALUE 80.        00910099
009200     05  PV-DETAIL-PAGE-COUNT         PIC 9(09)  VALUE ZERO.      00920099
009300     05  PV-RETRY-COUNTER             PIC S9(04) VALUE 0 COMP.    00930099
009400     05  PV-CURR-DATE.                                            00940099
009500         10  PV-CURR-YY               PIC  9(02) VALUE ZERO.      00950099
009600         10  PV-CURR-MM               PIC  9(02) VALUE ZERO.      00960099
009700         10  PV-CURR-DD               PIC  9(02) VALUE ZERO.      00970099
009800                                                                  00980099
009900     05  PV-CURR-TIME.                                            00990099
010000         10  PV-CURR-HH               PIC  9(02) VALUE ZERO.      01000099
010100         10  PV-CURR-MN               PIC  9(02) VALUE ZERO.      01010099
010200         10  PV-CURR-TIME-SSHH        PIC  9(04) VALUE ZERO.      01020099
010300                                                                  01030099
010400     05  PV-SEASONAL-SET.                                         01040099
010500         10  PV-SET-YEAR              PIC  X(04) VALUE SPACES.    01050099
010600         10  FILLER                   PIC  X     VALUE '-'.       01060099
010700         10  PV-SET-SHRT-NAME         PIC  X(05) VALUE SPACES.    01070099
010800                                                                  01080099
010900     05  PV-TOTALS.                                               01090099
011000         10  PV-TOT-PO                PIC S9(07) COMP-3           01100099
011100                                                 VALUE ZERO.      01110099
011200         10  PV-TOT-UNIT-QTY          PIC S9(11) COMP-3           01120099
011300                                                 VALUE ZERO.      01130099
011310*CHG98147 - START                                                 01131099
011311         10  PV-TOT-PO-SPLIT-QTY      PIC S9(11) COMP-3           01131199
011312                                                 VALUE ZERO.      01131299
011313         10  PV-TOT-PO-SPLIT-DIFF     PIC S9(11) COMP-3           01131399
011314                                                 VALUE ZERO.      01131499
011320*CHG98147 - END                                                   01132099
011510         10  PV-TOT-PO-ALLOC-QTY      PIC S9(11) COMP-3           01151099
011520                                                 VALUE ZERO.      01152099
011600         10  PV-TOT-PO-ALLOC-DIFF     PIC S9(11) COMP-3           01160099
011700                                                 VALUE ZERO.      01170099
011800         10  PV-TOT-RCVR-ALLOC-QTY    PIC S9(11) COMP-3           01180099
011900                                                 VALUE ZERO.      01190099
012000         10  PV-TOT-RCVR-ALLOC-DIFF   PIC S9(11) COMP-3           01200099
012100                                                 VALUE ZERO.      01210099
012200         10  PV-TOT-RCVR-VERFYD-QTY   PIC S9(11) COMP-3           01220099
012300                                                 VALUE ZERO.      01230099
012400         10  PV-GTOT-PO               PIC S9(07) COMP-3           01240099
012500                                                 VALUE ZERO.      01250099
012600         10  PV-GTOT-UNIT-QTY         PIC S9(11) COMP-3           01260099
012700                                                 VALUE ZERO.      01270099
012710*CHG98147 - START                                                 01271099
012711         10  PV-GTOT-PO-SPLIT-QTY     PIC S9(11) COMP-3           01271199
012712                                                 VALUE ZERO.      01271299
012713         10  PV-GTOT-PO-SPLIT-DIFF    PIC S9(11) COMP-3           01271399
012714                                                 VALUE ZERO.      01271499
012720*CHG98147 - END                                                   01272099
012910         10  PV-GTOT-PO-ALLOC-QTY     PIC S9(11) COMP-3           01291099
012920                                                 VALUE ZERO.      01292099
013000         10  PV-GTOT-PO-ALLOC-DIFF    PIC S9(11) COMP-3           01300099
013100                                                 VALUE ZERO.      01310099
013200         10  PV-GTOT-RCVR-ALLOC-QTY   PIC S9(11) COMP-3           01320099
013300                                                 VALUE ZERO.      01330099
013400         10  PV-GTOT-RCVR-ALLOC-DIFF  PIC S9(11) COMP-3           01340099
013500                                                 VALUE ZERO.      01350099
013600         10  PV-GTOT-RCVR-VERFYD-QTY  PIC S9(11) COMP-3           01360099
013700                                                 VALUE ZERO.      01370099
013800                                                                  01380099
013900 01  WS-RPT-HEADER1.                                              01390099
014000     05 FILLER                      PIC X(42) VALUE SPACES.       01400099
014100     05 FILLER                      PIC X(50) VALUE               01410099
014200     '      SEASONAL SET RECAP REPORT - BY SET/PO       '.        01420099
014300     05 FILLER                      PIC X(41) VALUE SPACES.       01430099
014400                                                                  01440099
014500 01  WS-RPT-HEADER2.                                              01450099
014600     05 FILLER                      PIC X(07) VALUE '  SET: '.    01460099
014700     05 H2-SEASONAL-SET             PIC X(10).                    01470099
014800     05 FILLER                      PIC X(01) VALUE SPACES.       01480099
014900     05 H2-SEASONAL-SET-NAME        PIC X(25).                    01490099
015000     05 FILLER                      PIC X(90) VALUE SPACES.       01500099
015100                                                                  01510099
015200 01  WS-RPT-HEADER3.                                              01520099
015200*TV 11/26/2014 CHANGE STARTS                                      01521099
015300     05 FILLER                      PIC X(23) VALUE SPACES.       01530099
015200*TV 11/26/2014 CHANGE ENDS                                        01531099
015400     05 FILLER                      PIC X(05) VALUE 'TOTAL'.      01540099
015500     05 FILLER                      PIC X(09) VALUE SPACES.       01550099
015600     05 FILLER                      PIC X(05) VALUE 'TOTAL'.      01560099
015700     05 FILLER                      PIC X(96) VALUE SPACES.       01570099
015800                                                                  01580099
015900 01  WS-RPT-HEADER4.                                              01590099
016000     05 FILLER                       PIC X(01) VALUE SPACES.      01600099
016100     05 FILLER                       PIC X(07) VALUE SPACES.      01610099
016200     05 FILLER                       PIC X(01) VALUE SPACES.      01620099
016300     05 FILLER                       PIC X(04) VALUE SPACES.      01630099
016300*TV 11/26/2014 CHANGE STARTS                                      01631099
016400     05 FILLER                       PIC X(09) VALUE SPACES.      01640099
016300*TV 11/26/2014 CHANGE ENDS                                        01641099
016500     05 FILLER                       PIC X(06) VALUE ' VALUE'.    01650099
016600     05 FILLER                       PIC X(08) VALUE SPACES.      01660099
016700     05 FILLER                       PIC X(06) VALUE ' VALUE'.    01670099
016800     05 FILLER                       PIC X(01) VALUE SPACES.      01680099
016900     05 FILLER                       PIC X(05) VALUE 'TOTAL'.     01690099
017000     05 FILLER                       PIC X(03) VALUE SPACES.      01700099
017100     05 FILLER                       PIC X(02) VALUE ' P'.        01710099
017200     05 FILLER                       PIC X(05) VALUE SPACES.      01720099
017300     05 FILLER                       PIC X(06) VALUE '  SET '.    01730099
017400     05 FILLER                       PIC X(03) VALUE SPACES.      01740099
017500     05 FILLER                       PIC X(08) VALUE '   TOTAL'.  01750099
017600*CHG98147 - START                                                 01760099
017700     05 FILLER                       PIC X(03) VALUE SPACES.      01770099
017800     05 FILLER                       PIC X(08) VALUE '      PO'.  01780099
017900     05 FILLER                       PIC X(08) VALUE SPACES.      01790099
018000     05 FILLER                       PIC X(04) VALUE '  PO'.      01800099
018100*CHG98147 - END                                                   01810099
018200     05 FILLER                       PIC X(03) VALUE SPACES.      01820099
018300     05 FILLER                       PIC X(08) VALUE '      PO'.  01830099
018400     05 FILLER                       PIC X(08) VALUE SPACES.      01840099
018500     05 FILLER                       PIC X(05) VALUE '  PO '.     01850099
018600     05 FILLER                       PIC X(02) VALUE SPACES.      01860099
018700     05 FILLER                       PIC X(08) VALUE 'RECEIVER'.  01870099
018800     05 FILLER                       PIC X(04) VALUE SPACES.      01880099
018900     05 FILLER                       PIC X(08) VALUE 'RECEIVER'.  01890099
019000     05 FILLER                       PIC X(03) VALUE SPACES.      01900099
019100     05 FILLER                       PIC X(08) VALUE 'VERIFIED'.  01910099
019200                                                                  01920099
019300 01  WS-RPT-HEADER5.                                              01930099
019300*TV 11/26/2014 CHANGE STARTS                                      01931099
019400     05 FILLER                       PIC X(02) VALUE SPACES.      01940099
019300*TV 11/26/2014 CHANGE ENDS                                        01941099
019500     05 FILLER                       PIC X(07) VALUE '   PO  '.   01950099
019600     05 FILLER                       PIC X(01) VALUE SPACES.      01960099
019700     05 FILLER                       PIC X(04) VALUE SPACES.      01970099
019800     05 FILLER                       PIC X(08) VALUE SPACES.      01980099
019900     05 FILLER                       PIC X(06) VALUE '  COST'.    01990099
020000     05 FILLER                       PIC X(08) VALUE SPACES.      02000099
020100     05 FILLER                       PIC X(06) VALUE 'RETAIL'.    02010099
020200     05 FILLER                       PIC X(01) VALUE SPACES.      02020099
020300     05 FILLER                       PIC X(05) VALUE ' SKUS'.     02030099
020400     05 FILLER                       PIC X(03) VALUE ' ST'.       02040099
020500     05 FILLER                       PIC X(02) VALUE ' K'.        02050099
020600     05 FILLER                       PIC X(05) VALUE '  SET'.     02060099
020700     05 FILLER                       PIC X(06) VALUE ' SHORT'.    02070099
020800     05 FILLER                       PIC X(03) VALUE SPACES.      02080099
020900     05 FILLER                       PIC X(08) VALUE '    UNIT'.  02090099
021000*CHG98147 - START                                                 02100099
021100     05 FILLER                       PIC X(03) VALUE SPACES.      02110099
021200     05 FILLER                       PIC X(08) VALUE '   SPLIT'.  02120099
021300     05 FILLER                       PIC X(07) VALUE SPACES.      02130099
021400     05 FILLER                       PIC X(05) VALUE 'SPLIT'.     02140099
021500*CHG98147 - END                                                   02150099
021600     05 FILLER                       PIC X(03) VALUE SPACES.      02160099
021700     05 FILLER                       PIC X(08) VALUE '   ALLOC'.  02170099
021800     05 FILLER                       PIC X(07) VALUE SPACES.      02180099
021900     05 FILLER                       PIC X(05) VALUE 'ALLOC'.     02190099
022000     05 FILLER                       PIC X(03) VALUE SPACES.      02200099
022100     05 FILLER                       PIC X(08) VALUE '   ALLOC'.  02210099
022200     05 FILLER                       PIC X(07) VALUE SPACES.      02220099
022300     05 FILLER                       PIC X(05) VALUE 'ALLOC'.     02230099
022400     05 FILLER                       PIC X(03) VALUE SPACES.      02240099
022500     05 FILLER                       PIC X(08) VALUE 'RECEIVER'.  02250099
022600                                                                  02260099
022700 01  WS-RPT-HEADER6.                                              02270099
022800*TV 11/26/2014 CHANGE STARTS                                      02280099
022800     05 FILLER                       PIC X(02) VALUE SPACES.      02281099
022800*TV 11/26/2014 CHANGE ENDS                                        02282099
022900     05 FILLER                       PIC X(07) VALUE ' NUMBER'.   02290099
023000     05 FILLER                       PIC X(01) VALUE SPACES.      02300099
023100     05 FILLER                       PIC X(04) VALUE 'DEPT'.      02310099
023200     05 FILLER                       PIC X(08) VALUE SPACES.      02320099
023300     05 FILLER                       PIC X(06) VALUE 'AMOUNT'.    02330099
023400     05 FILLER                       PIC X(08) VALUE SPACES.      02340099
023500     05 FILLER                       PIC X(06) VALUE 'AMOUNT'.    02350099
023600     05 FILLER                       PIC X(01) VALUE SPACES.      02360099
023700     05 FILLER                       PIC X(05) VALUE '  QTY'.     02370099
023800     05 FILLER                       PIC X(03) VALUE ' CD'.       02380099
023900     05 FILLER                       PIC X(02) VALUE ' G'.        02390099
024000     05 FILLER                       PIC X(05) VALUE ' YEAR'.     02400099
024100     05 FILLER                       PIC X(06) VALUE '  NAME'.    02410099
024200     05 FILLER                       PIC X(03) VALUE SPACES.      02420099
024300     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  02430099
024400*CHG98147 - START                                                 02440099
024500     05 FILLER                       PIC X(03) VALUE SPACES.      02450099
024600     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  02460099
024700     05 FILLER                       PIC X(08) VALUE SPACES.      02470099
024800     05 FILLER                       PIC X(04) VALUE 'DIFF'.      02480099
024900*CHG98147 - END                                                   02490099
025000     05 FILLER                       PIC X(03) VALUE SPACES.      02500099
025100     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  02510099
025200     05 FILLER                       PIC X(08) VALUE SPACES.      02520099
025300     05 FILLER                       PIC X(04) VALUE 'DIFF'.      02530099
025400     05 FILLER                       PIC X(03) VALUE SPACES.      02540099
025500     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  02550099
025600     05 FILLER                       PIC X(08) VALUE SPACES.      02560099
025700     05 FILLER                       PIC X(04) VALUE 'DIFF'.      02570099
025800     05 FILLER                       PIC X(03) VALUE SPACES.      02580099
025900     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  02590099
026000                                                                  02600099
026100 01  WS-RPT-RECORD.                                               02610099
026200     05 FILLER                       PIC X(01) VALUE SPACES.      02620099
026200*TV 11/26/2014 CHANGE STARTS                                      02621099
026300     05 WS-RPT-PO-NBR                PIC ZZZZZZZ9.                02630099
026200*TV 11/26/2014 CHANGE ENDS                                        02631099
026400     05 FILLER                       PIC X(01) VALUE SPACES.      02640099
026500     05 WS-RPT-DEPT                  PIC ZZZ9.                    02650099
026600     05 FILLER                       PIC X(01) VALUE SPACES.      02660099
026700     05 WS-RPT-TOTAL-COST            PIC ZZ,ZZZ,ZZ9.99.           02670099
026800     05 FILLER                       PIC X(01) VALUE SPACES.      02680099
026900     05 WS-RPT-TOTAL-RETAIL          PIC ZZ,ZZZ,ZZ9.99.           02690099
027000     05 FILLER                       PIC X(01) VALUE SPACES.      02700099
027100     05 WS-RPT-TOTAL-SKUS            PIC ZZZZ9.                   02710099
027200     05 FILLER                       PIC X(01) VALUE SPACES.      02720099
027300     05 WS-RPT-STATUS-CDE            PIC XX.                      02730099
027400     05 FILLER                       PIC X(01) VALUE SPACES.      02740099
027500     05 WS-RPT-PKGNG-CDE             PIC X.                       02750099
027600     05 FILLER                       PIC X(01) VALUE SPACES.      02760099
027700     05 WS-RPT-SEASET-YR             PIC X(04).                   02770099
027800     05 FILLER                       PIC X(01) VALUE SPACES.      02780099
027900     05 WS-RPT-SEASET-SHRT-NM        PIC X(05).                   02790099
028000     05 FILLER                       PIC X(01) VALUE SPACES.      02800099
028100     05 WS-RPT-TOTAL-UNITS           PIC ZZ,ZZZ,ZZ9.              02810099
028200*CHG98147 - START                                                 02820099
028300     05 FILLER                       PIC X(01) VALUE SPACES.      02830099
028400     05 WS-RPT-PO-SPLIT-QTY          PIC ZZ,ZZZ,ZZ9.              02840099
028500     05 FILLER                       PIC X(01) VALUE SPACES.      02850099
028600     05 WS-RPT-PO-SPLIT-DIFF         PIC ZZ,ZZZ,ZZ9-.             02860099
028700*CHG98147 - END                                                   02870099
028800     05 FILLER                       PIC X(01) VALUE SPACES.      02880099
028900     05 WS-RPT-PO-ALLOC-QTY          PIC ZZ,ZZZ,ZZ9.              02890099
029000     05 FILLER                       PIC X(01) VALUE SPACES.      02900099
029100     05 WS-RPT-PO-ALLOC-DIFF         PIC ZZ,ZZZ,ZZ9-.             02910099
029200     05 FILLER                       PIC X(01) VALUE SPACES.      02920099
029300     05 WS-RPT-RCVR-ALLOC-QTY        PIC ZZ,ZZZ,ZZ9.              02930099
029400     05 FILLER                       PIC X(01) VALUE SPACES.      02940099
029500     05 WS-RPT-RCVR-ALLOC-DIFF       PIC ZZ,ZZZ,ZZ9-.             02950099
029600     05 FILLER                       PIC X(01) VALUE SPACES.      02960099
029700     05 WS-RPT-RCVR-VERFYD           PIC ZZ,ZZZ,ZZ9.              02970099
029800                                                                  02980099
029900 01  WS-SEASET-TOTAL-LINE1.                                       02990099
029900*TV 11/26/2014 CHANGE STARTS                                      02991099
030000     05 FILLER                       PIC X(02) VALUE SPACES.      03000099
029900*TV 11/26/2014 CHANGE ENDS                                        03001099
030100     05 WS-RPT-TOTAL-PO              PIC ZZZZZ9.                  03010099
030200     05 FILLER                       PIC X(01) VALUE SPACES.      03020099
030300     05 WS-RPT-TOTAL-PO-TEXT         PIC X(15) VALUE 'PO TOTAL '. 03030099
030400     05 FILLER                       PIC X(06) VALUE SPACES.      03040099
030500     05 FILLER                       PIC X(04) VALUE 'SET '.      03050099
030600     05 WS-RPT-TOTAL-LINE-SET        PIC X(10) VALUE SPACES.      03060099
030700     05 FILLER                       PIC X(01) VALUE SPACES.      03070099
030800     05 FILLER                       PIC X(07) VALUE 'TOTALS:'.   03080099
030900     05 FILLER                       PIC X(02) VALUE SPACES.      03090099
031000     05 FILLER                       PIC X(01) VALUE SPACES.      03100099
031100     05 FILLER                       PIC X(02) VALUE SPACES.      03110099
031200     05 FILLER                       PIC X(01) VALUE SPACES.      03120099
031300     05 FILLER                       PIC X(04) VALUE SPACES.      03130099
031400     05 WS-RPT-SET-TOTAL-UNITS       PIC Z,ZZZ,ZZZ,ZZ9.           03140099
031500     05 FILLER                       PIC X(01) VALUE SPACES.      03150099
031600     05 FILLER                       PIC X(08) VALUE SPACES.      03160099
031700*CHG98147 - START                                                 03170099
031810     05 WS-RPT-SET-PO-SPLIT-DIFF     PIC Z,ZZZ,ZZZ,ZZ9-.          03181099
031820     05 FILLER                       PIC X(01) VALUE SPACES.      03182099
031830     05 FILLER                       PIC X(08) VALUE SPACES.      03183099
031900*CHG98147 - END                                                   03190099
032000     05 WS-RPT-SET-PO-ALLOC-DIFF     PIC Z,ZZZ,ZZZ,ZZ9-.          03200099
032100     05 FILLER                       PIC X(01) VALUE SPACES.      03210099
032200     05 FILLER                       PIC X(08) VALUE SPACES.      03220099
032300     05 WS-RPT-SET-RCVR-ALLOC-DIFF   PIC Z,ZZZ,ZZZ,ZZ9-.          03230099
032400     05 FILLER                       PIC X(11) VALUE SPACES.      03240099
032500                                                                  03250099
032600 01  WS-SEASET-TOTAL-LINE2.                                       03260099
032600*TV 11/26/2014 CHANGE STARTS                                      03261099
032700     05 FILLER                       PIC X(02) VALUE SPACES.      03270099
032600*TV 11/26/2014 CHANGE STARTS                                      03271099
032800     05 FILLER                       PIC X(07) VALUE SPACES.      03280099
032900     05 FILLER                       PIC X(01) VALUE SPACES.      03290099
033000     05 FILLER                       PIC X(04) VALUE SPACES.      03300099
033100     05 FILLER                       PIC X(01) VALUE SPACES.      03310099
033200     05 FILLER                       PIC X(13) VALUE SPACES.      03320099
033300     05 FILLER                       PIC X(01) VALUE SPACES.      03330099
033400     05 FILLER                       PIC X(13) VALUE SPACES.      03340099
033500     05 FILLER                       PIC X(01) VALUE SPACES.      03350099
033600     05 FILLER                       PIC X(05) VALUE SPACES.      03360099
033700     05 FILLER                       PIC X(01) VALUE SPACES.      03370099
033800     05 FILLER                       PIC X(02) VALUE SPACES.      03380099
033900     05 FILLER                       PIC X(01) VALUE SPACES.      03390099
034000     05 FILLER                       PIC X(01) VALUE SPACES.      03400099
034100     05 FILLER                       PIC X(01) VALUE SPACES.      03410099
034200     05 FILLER                       PIC X(04) VALUE SPACES.      03420099
034300     05 FILLER                       PIC X(01) VALUE SPACES.      03430099
034400     05 FILLER                       PIC X(05) VALUE SPACES.      03440099
034500     05 FILLER                       PIC X(01) VALUE SPACES.      03450099
034600     05 FILLER                       PIC X(08) VALUE SPACES.      03460099
034700*CHG98147 - START                                                 03470099
034810     05 WS-RPT-SET-PO-SPLIT-QTY      PIC Z,ZZZ,ZZZ,ZZ9.           03481099
034820     05 FILLER                       PIC X(01) VALUE SPACES.      03482099
034830     05 FILLER                       PIC X(09) VALUE SPACES.      03483099
034900*CHG98147 - END                                                   03490099
035000     05 WS-RPT-SET-PO-ALLOC-QTY      PIC Z,ZZZ,ZZZ,ZZ9.           03500099
035100     05 FILLER                       PIC X(01) VALUE SPACES.      03510099
035200     05 FILLER                       PIC X(09) VALUE SPACES.      03520099
035300     05 WS-RPT-SET-RCVR-ALLOC-QTY    PIC Z,ZZZ,ZZZ,ZZ9.           03530099
035400     05 FILLER                       PIC X(01) VALUE SPACES.      03540099
035500     05 FILLER                       PIC X(09) VALUE SPACES.      03550099
035600     05 WS-RPT-SET-RCVR-VERFYD-QTY   PIC Z,ZZZ,ZZZ,ZZ9.           03560099
035700                                                                  03570099
035800*CHG98147 - START                                                 03580099
035900 01  WS-BLANK-LINE.                                               03590099
036000*    05 FILLER                       PIC  X(132) VALUE SPACES.    03600099
036100     05 FILLER                       PIC  X(200) VALUE SPACES.    03610099
036200*CHG98147 - END                                                   03620099
036300                                                                  03630099
036400 01  PV-ABEND-FIELDS.                                             03640099
036500     05  PV-SQLCODE                   PIC  S9(4) VALUE +0.        03650099
036600     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         03660099
036700                                                 COMP SYNC.       03670099
036800     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    03680099
036900     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    03690099
037000     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    03700099
037100     05  PV-ABEND-STRUCTURE-2         PIC  X(08) VALUE SPACES.    03710099
037200                                                                  03720099
037300******************************************************************03730099
037400*  INPUT FILE                                                     03740099
037500******************************************************************03750099
037600     COPY RCRD092.                                                03760099
037700                                                                  03770099
037800*CHG98147 - START                                                 03780099
037900***************************************************************** 03790099
038000*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.              * 03800099
038100***************************************************************** 03810099
038200*                                                                 03820099
038300*    COPY DPWS132O.                                               03830099
038400*                                                                 03840099
038500***************************************************************** 03850099
038600*  STANDARD REPORT HEADER FOR A 200 COLUMN REPORT.              * 03860099
038700***************************************************************** 03870099
038800*                                                                 03880099
038900     COPY DPWS200O.                                               03890099
039000*                                                                 03900099
039100*CHG98147 - END                                                   03910099
039200***********************************************************       03920099
039300*  DB2 SQL COMMUNICATION AREA                                     03930099
039400***********************************************************       03940099
039500     EXEC SQL                                                     03950099
039600         INCLUDE SQLCA                                            03960099
039700     END-EXEC.                                                    03970099
039800                                                                  03980099
039900***********************************************************       03990099
040000*  SEASONAL SET TABLE                                             04000099
040100***********************************************************       04010099
040200     EXEC SQL                                                     04020099
040300         INCLUDE TSEASET                                          04030099
040400     END-EXEC.                                                    04040099
040500                                                                  04050099
040600***********************************************************       04060099
040700*  NUMERIC EDIT LAYOUT                                            04070099
040800***********************************************************       04080099
040900     COPY DPWS010I.                                               04090099
041000                                                                  04100099
041100***********************************************************       04110099
041200*  USED FOR DB2 ERROR MESSAGE BUILDING                    *       04120099
041300***********************************************************       04130099
041400     COPY DPWS004.                                                04140099
041500                                                                  04150099
041600******************************************************************04160099
041700 PROCEDURE DIVISION.                                              04170099
041800******************************************************************04180099
041900 0000-PROGRAM-MAINLINE.                                           04190099
042000                                                                  04200099
042100     OPEN INPUT  INPUT-FILE                                       04210099
042200          OUTPUT REPORT-FILE1.                                    04220099
042300                                                                  04230099
042400*CHG98147 - START                                                 04240099
042500*    MOVE PC-PROGRAM-NAME      TO DP132O-PROGRAM-NAME.            04250099
042600     MOVE PC-PROGRAM-NAME      TO DP200O-PROGRAM-NAME.            04260099
042700*CHG98147 - END                                                   04270099
042800*                                                                 04280099
042900     ACCEPT PV-CURR-DATE       FROM DATE.                         04290099
043000*CHG98147 - START                                                 04300099
043100*    MOVE PV-CURR-YY           TO DP132O-RUN-YEAR                 04310099
043200*    MOVE PV-CURR-MM           TO DP132O-RUN-MONTH                04320099
043300*    MOVE PV-CURR-DD           TO DP132O-RUN-DAY                  04330099
043400     MOVE PV-CURR-YY           TO DP200O-RUN-YEAR                 04340099
043500     MOVE PV-CURR-MM           TO DP200O-RUN-MONTH                04350099
043600     MOVE PV-CURR-DD           TO DP200O-RUN-DAY                  04360099
043700*CHG98147 - END                                                   04370099
043800*                                                                 04380099
043900     ACCEPT PV-CURR-TIME       FROM TIME.                         04390099
044000*CHG98147 - START                                                 04400099
044100*    MOVE PV-CURR-HH           TO DP132O-RUN-HOUR.                04410099
044200*    MOVE PV-CURR-MN           TO DP132O-RUN-MINUTE.              04420099
044300*    MOVE 1                    TO DP132O-REPORT-NUMBER.           04430099
044400*    MOVE 0                    TO DP132O-PAGE-NUMBER.             04440099
044500     MOVE PV-CURR-HH           TO DP200O-RUN-HOUR.                04450099
044600     MOVE PV-CURR-MN           TO DP200O-RUN-MINUTE.              04460099
044700     MOVE 1                    TO DP200O-REPORT-NUMBER.           04470099
044800     MOVE 0                    TO DP200O-PAGE-NUMBER.             04480099
044900*CHG98147 - END                                                   04490099
045000*                                                                 04500099
045100                                                                  04510099
045200     PERFORM 7000-READ-INPUT-FILE.                                04520099
045300                                                                  04530099
045400     IF PS-NOT-EOF-INPUT                                          04540099
045500         PERFORM 3000-FORMAT-SEASET-DATE-NAME                     04550099
045600         PERFORM 2000-PROCESS-INPUT-FILE                          04560099
045700             UNTIL PS-EOF-INPUT                                   04570099
045800         PERFORM 4000-TOTALS                                      04580099
045900         PERFORM 4100-GRAND-TOTALS                                04590099
046000         MOVE PC-END-OF-REPORT-LINE TO WS-RPT-RECORD              04600099
046100         PERFORM 8000-WRITE-REPORT-RECORD                         04610099
046200     ELSE                                                         04620099
046300         MOVE PC-NO-INPUT-LINE      TO WS-RPT-RECORD              04630099
046400         PERFORM 8000-WRITE-REPORT-RECORD                         04640099
046500     END-IF.                                                      04650099
046600                                                                  04660099
046700     PERFORM 9000-EOJ.                                            04670099
046800                                                                  04680099
046900     STOP RUN.                                                    04690099
047000                                                                  04700099
047100******************************************************************04710099
047200* PROCESS INPUT RECORDS                                          *04720099
047300******************************************************************04730099
047400 2000-PROCESS-INPUT-FILE.                                         04740099
047500     MOVE '2000-PROCESS-INPUT-FILE.'    TO PV-ABEND-PARAGRAPH.    04750099
047600     MOVE RC092-PO-NUMBER               TO                        04760099
047700            WS-RPT-PO-NBR                                         04770099
047800     MOVE RC092-DEPT-NBR                TO                        04780099
047900            WS-RPT-DEPT                                           04790099
048000     MOVE RC092-TOT-VAL-COST-AMT        TO                        04800099
048100            WS-RPT-TOTAL-COST                                     04810099
048200     MOVE RC092-TOT-VAL-RTL-AMT         TO                        04820099
048300            WS-RPT-TOTAL-RETAIL                                   04830099
048400     MOVE RC092-TOT-SKUS-QTY            TO                        04840099
048500            WS-RPT-TOTAL-SKUS                                     04850099
048600     MOVE RC092-STATUS-CDE              TO                        04860099
048700            WS-RPT-STATUS-CDE                                     04870099
048800     MOVE RC092-PKGNG-CDE               TO                        04880099
048900            WS-RPT-PKGNG-CDE                                      04890099
049000     MOVE RC092-SEASET-YR               TO                        04900099
049100            WS-RPT-SEASET-YR                                      04910099
049200     MOVE RC092-SEASET-SHRT-NM          TO                        04920099
049300            WS-RPT-SEASET-SHRT-NM                                 04930099
049400     MOVE RC092-TOT-UNT-QTY             TO                        04940099
049500            WS-RPT-TOTAL-UNITS                                    04950099
049600*CHG98147 - START                                                 04960099
049700     MOVE RC092-PO-SPLIT-QTY            TO                        04970099
049800            WS-RPT-PO-SPLIT-QTY                                   04980099
049900     MOVE RC092-PO-SPLIT-DIFF           TO                        04990099
050000            WS-RPT-PO-SPLIT-DIFF                                  05000099
050100*CHG98147 - END                                                   05010099
050200     MOVE RC092-PO-ALLOC-QTY            TO                        05020099
050300            WS-RPT-PO-ALLOC-QTY                                   05030099
050400     MOVE RC092-PO-ALLOC-DIFF           TO                        05040099
050500            WS-RPT-PO-ALLOC-DIFF                                  05050099
050600     MOVE RC092-RCVR-ALLOC-QTY          TO                        05060099
050700            WS-RPT-RCVR-ALLOC-QTY                                 05070099
050800     MOVE RC092-RCVR-ALLOC-DIFF         TO                        05080099
050900            WS-RPT-RCVR-ALLOC-DIFF                                05090099
051000     MOVE RC092-RCVR-VERFYD-QTY         TO                        05100099
051100            WS-RPT-RCVR-VERFYD                                    05110099
051200                                                                  05120099
051300     ADD +1                             TO PV-DUPLICATES-WRITTEN. 05130099
051400                                                                  05140099
051500     PERFORM 8000-WRITE-REPORT-RECORD.                            05150099
051600                                                                  05160099
051700     ADD +1                       TO PV-TOT-PO                    05170099
051800                                     PV-GTOT-PO                   05180099
051900     ADD RC092-TOT-UNT-QTY        TO PV-TOT-UNIT-QTY              05190099
052000                                     PV-GTOT-UNIT-QTY             05200099
052010*CHG98147 - START                                                 05201099
052011     ADD RC092-PO-SPLIT-QTY       TO PV-TOT-PO-SPLIT-QTY          05201199
052012                                     PV-GTOT-PO-SPLIT-QTY         05201299
052013     ADD RC092-PO-SPLIT-DIFF      TO PV-TOT-PO-SPLIT-DIFF         05201399
052014                                     PV-GTOT-PO-SPLIT-DIFF        05201499
052020*CHG98147 - END                                                   05202099
052100     ADD RC092-PO-ALLOC-QTY       TO PV-TOT-PO-ALLOC-QTY          05210099
052200                                     PV-GTOT-PO-ALLOC-QTY         05220099
052300     ADD RC092-PO-ALLOC-DIFF      TO PV-TOT-PO-ALLOC-DIFF         05230099
052400                                     PV-GTOT-PO-ALLOC-DIFF        05240099
052500     ADD RC092-RCVR-ALLOC-QTY     TO PV-TOT-RCVR-ALLOC-QTY        05250099
052600                                     PV-GTOT-RCVR-ALLOC-QTY       05260099
052700     ADD RC092-RCVR-ALLOC-DIFF    TO PV-TOT-RCVR-ALLOC-DIFF       05270099
052800                                     PV-GTOT-RCVR-ALLOC-DIFF      05280099
052900     ADD RC092-RCVR-VERFYD-QTY    TO PV-TOT-RCVR-VERFYD-QTY       05290099
053000                                     PV-GTOT-RCVR-VERFYD-QTY.     05300099
053100                                                                  05310099
053200     PERFORM 7000-READ-INPUT-FILE.                                05320099
053300                                                                  05330099
053400     IF PS-NOT-EOF-INPUT                                          05340099
053500        IF RC092-SEASET-YR      NOT = PV-SET-YEAR                 05350099
053600        OR RC092-SEASET-SHRT-NM NOT = PV-SET-SHRT-NAME            05360099
053700         PERFORM 4000-TOTALS                                      05370099
053800         PERFORM 3000-FORMAT-SEASET-DATE-NAME                     05380099
053900         MOVE 80 TO PV-LINE-CNT                                   05390099
054000         END-IF                                                   05400099
054100     END-IF.                                                      05410099
054200                                                                  05420099
054300 3000-FORMAT-SEASET-DATE-NAME.                                    05430099
054400     PERFORM 6000-GET-SEASET-INFO                                 05440099
054500     MOVE RC092-SEASET-YR      TO PV-SET-YEAR                     05450099
054600     MOVE RC092-SEASET-SHRT-NM TO PV-SET-SHRT-NAME                05460099
054700     MOVE PV-SEASONAL-SET      TO H2-SEASONAL-SET.                05470099
054800                                                                  05480099
054900                                                                  05490099
055000 4000-TOTALS.                                                     05500099
055100     MOVE PV-SEASONAL-SET        TO WS-RPT-TOTAL-LINE-SET         05510099
055200     MOVE PV-TOT-PO              TO WS-RPT-TOTAL-PO               05520099
055300     MOVE PV-TOT-UNIT-QTY        TO WS-RPT-SET-TOTAL-UNITS        05530099
055301*CHG98147 - START                                                 05530199
055302     MOVE PV-TOT-PO-SPLIT-DIFF   TO WS-RPT-SET-PO-SPLIT-DIFF      05530299
055310     MOVE PV-TOT-PO-SPLIT-QTY    TO WS-RPT-SET-PO-SPLIT-QTY       05531099
055320*CHG98147 - END                                                   05532099
055400     MOVE PV-TOT-PO-ALLOC-DIFF   TO WS-RPT-SET-PO-ALLOC-DIFF      05540099
055500     MOVE PV-TOT-RCVR-ALLOC-DIFF TO WS-RPT-SET-RCVR-ALLOC-DIFF    05550099
055610     MOVE PV-TOT-PO-ALLOC-QTY    TO WS-RPT-SET-PO-ALLOC-QTY       05561099
055700     MOVE PV-TOT-RCVR-ALLOC-QTY  TO WS-RPT-SET-RCVR-ALLOC-QTY     05570099
055800     MOVE PV-TOT-RCVR-VERFYD-QTY TO WS-RPT-SET-RCVR-VERFYD-QTY    05580099
055900                                                                  05590099
056000     ADD +3                      TO PV-LINE-CNT.                  05600099
056100     IF PV-LINE-CNT > 60                                          05610099
056200         PERFORM 8100-HEADINGS                                    05620099
056300     END-IF.                                                      05630099
056400     WRITE REPORT-RECORD FROM WS-SEASET-TOTAL-LINE1               05640099
056500         AFTER ADVANCING 2 LINE.                                  05650099
056600     WRITE REPORT-RECORD FROM WS-SEASET-TOTAL-LINE2               05660099
056700         AFTER ADVANCING 1 LINE.                                  05670099
056800                                                                  05680099
056900     MOVE ZERO                   TO PV-TOT-PO                     05690099
057000                                    PV-TOT-UNIT-QTY               05700099
057010*CHG98147 - START                                                 05701099
057011                                    PV-TOT-PO-SPLIT-QTY           05701199
057012                                    PV-TOT-PO-SPLIT-DIFF          05701299
057020*CHG98147 - END                                                   05702099
057110                                    PV-TOT-PO-ALLOC-QTY           05711099
057200                                    PV-TOT-PO-ALLOC-DIFF          05720099
057300                                    PV-TOT-RCVR-ALLOC-QTY         05730099
057400                                    PV-TOT-RCVR-ALLOC-DIFF        05740099
057500                                    PV-TOT-RCVR-VERFYD-QTY.       05750099
057600                                                                  05760099
057700 4100-GRAND-TOTALS.                                               05770099
057800     MOVE 'PO GRAND TOTAL'        TO WS-RPT-TOTAL-PO-TEXT         05780099
057900     MOVE '  GRAND  '             TO WS-RPT-TOTAL-LINE-SET        05790099
058000     MOVE PV-GTOT-PO              TO WS-RPT-TOTAL-PO              05800099
058100     MOVE PV-GTOT-UNIT-QTY        TO WS-RPT-SET-TOTAL-UNITS       05810099
058110*CHG98147 - START                                                 05811099
058111     MOVE PV-GTOT-PO-SPLIT-DIFF   TO WS-RPT-SET-PO-SPLIT-DIFF     05811199
058112     MOVE PV-GTOT-PO-SPLIT-QTY    TO WS-RPT-SET-PO-SPLIT-QTY      05811299
058120*CHG98147 - END                                                   05812099
058200     MOVE PV-GTOT-PO-ALLOC-DIFF   TO WS-RPT-SET-PO-ALLOC-DIFF     05820099
058300     MOVE PV-GTOT-RCVR-ALLOC-DIFF TO WS-RPT-SET-RCVR-ALLOC-DIFF   05830099
058400     MOVE PV-GTOT-PO-ALLOC-QTY    TO WS-RPT-SET-PO-ALLOC-QTY      05840099
058500     MOVE PV-GTOT-RCVR-ALLOC-QTY  TO WS-RPT-SET-RCVR-ALLOC-QTY    05850099
058600     MOVE PV-GTOT-RCVR-VERFYD-QTY TO WS-RPT-SET-RCVR-VERFYD-QTY   05860099
058700                                                                  05870099
058800     ADD +3                       TO PV-LINE-CNT.                 05880099
058900     IF PV-LINE-CNT > 60                                          05890099
059000         PERFORM 8100-HEADINGS                                    05900099
059100     END-IF.                                                      05910099
059200     WRITE REPORT-RECORD FROM WS-SEASET-TOTAL-LINE1               05920099
059300         AFTER ADVANCING 2 LINE.                                  05930099
059400     WRITE REPORT-RECORD FROM WS-SEASET-TOTAL-LINE2               05940099
059500         AFTER ADVANCING 1 LINE.                                  05950099
059600                                                                  05960099
059700 6000-GET-SEASET-INFO.                                            05970099
059800                                                                  05980099
059900     MOVE '6000-GET-SEASET-INFO       ' TO PV-ABEND-PARAGRAPH.    05990099
060000                                                                  06000099
060100     EXEC SQL                                                     06010099
060200          SELECT SEASET_NM                                        06020099
060300            INTO :SEASET-SEASET-NM                                06030099
060400            FROM TSEASET                                          06040099
060500           WHERE SEASET_YR      = :RC092-SEASET-YR                06050099
060600             AND SEASET_SHRT_NM = :RC092-SEASET-SHRT-NM           06060099
060700           WITH UR                                                06070099
060800     END-EXEC.                                                    06080099
060900                                                                  06090099
061000     EVALUATE TRUE                                                06100099
061100        WHEN SQLCODE = 0                                          06110099
061200           MOVE SEASET-SEASET-NM TO H2-SEASONAL-SET-NAME          06120099
061300        WHEN SQLCODE = +100                                       06130099
061400           MOVE 'NAME NOT FOUND' TO H2-SEASONAL-SET-NAME          06140099
061500        WHEN OTHER                                                06150099
061600           DISPLAY '*** RC092-SEASET-YR.....: '                   06160099
061700                        RC092-SEASET-YR                           06170099
061800           DISPLAY '*** RC092-SEASET-SHRT-NM: '                   06180099
061900                        RC092-SEASET-SHRT-NM                      06190099
062000           MOVE '6000-GET-SEASET-INFO'                            06200099
062100                                  TO PV-ABEND-PARAGRAPH           06210099
062200           MOVE 'SELECT TSEASET' TO PV-ABEND-OPERATION            06220099
062300           MOVE ' '              TO PV-ABEND-STRUCTURE-1          06230099
062400           PERFORM 9900-DB2-ABEND                                 06240099
062500     END-EVALUATE.                                                06250099
062600                                                                  06260099
062700******************************************************************06270099
062800* READS RECORD FROM THE INPUT FILE                                06280099
062900******************************************************************06290099
063000 7000-READ-INPUT-FILE.                                            06300099
063100     MOVE '7000-READ-INPUT-FILE.'      TO  PV-ABEND-PARAGRAPH.    06310099
063200                                                                  06320099
063300     READ INPUT-FILE                                              06330099
063400          INTO RCRD092-SEASET-PO-EXTRACT                          06340099
063500            AT END                                                06350099
063600               SET PS-EOF-INPUT     TO TRUE                       06360099
063700                                                                  06370099
063800            NOT AT END                                            06380099
063900               SET PS-NOT-EOF-INPUT TO TRUE                       06390099
064000               ADD +1 TO PV-RECORDS-READ                          06400099
064100     END-READ.                                                    06410099
064200******************************************************************06420099
064300* WRITES THE APPROPRIATE OUTPUT RECORDS                          *06430099
064400******************************************************************06440099
064500 8000-WRITE-REPORT-RECORD.                                        06450099
064600     MOVE '8000-WRITE-REPORT-RECORD.'  TO PV-ABEND-PARAGRAPH.     06460099
064700                                                                  06470099
064800     IF PV-LINE-CNT > 60                                          06480099
064900         PERFORM 8100-HEADINGS                                    06490099
065000     END-IF.                                                      06500099
065100                                                                  06510099
065200     WRITE REPORT-RECORD FROM WS-RPT-RECORD                       06520099
065300         AFTER ADVANCING 1 LINE.                                  06530099
065400     ADD  1  TO  PV-LINE-CNT.                                     06540099
065500                                                                  06550099
065600                                                                  06560099
065700 8100-HEADINGS.                                                   06570099
065800         ADD 1                     TO PV-DETAIL-PAGE-COUNT        06580099
065900*CHG98147 - START                                                 06590099
066000*        MOVE PV-DETAIL-PAGE-COUNT TO DP132O-PAGE-NUMBER          06600099
066100*        WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS  06610099
066200         MOVE PV-DETAIL-PAGE-COUNT TO DP200O-PAGE-NUMBER          06620099
066300         WRITE REPORT-RECORD FROM DP200O-STANDRD-HEADER-200-COLS  06630099
066400            AFTER ADVANCING PAGE                                  06640099
066500*CHG98147 - END                                                   06650099
066600         WRITE REPORT-RECORD FROM WS-RPT-HEADER1                  06660099
066700            AFTER ADVANCING 1 LINES                               06670099
066800         WRITE REPORT-RECORD FROM WS-RPT-HEADER2                  06680099
066900            AFTER ADVANCING 2 LINES                               06690099
067000         WRITE REPORT-RECORD FROM WS-RPT-HEADER3                  06700099
067100            AFTER ADVANCING 2 LINE                                06710099
067200         WRITE REPORT-RECORD FROM WS-RPT-HEADER4                  06720099
067300            AFTER ADVANCING 1 LINE                                06730099
067400         WRITE REPORT-RECORD FROM WS-RPT-HEADER5                  06740099
067500            AFTER ADVANCING 1 LINE                                06750099
067600         WRITE REPORT-RECORD FROM WS-RPT-HEADER6                  06760099
067700            AFTER ADVANCING 1 LINE                                06770099
067800         WRITE REPORT-RECORD FROM WS-BLANK-LINE                   06780099
067900            AFTER ADVANCING 1 LINE                                06790099
068000         MOVE 9 TO PV-LINE-CNT.                                   06800099
068100                                                                  06810099
068200 9000-EOJ.                                                        06820099
068300                                                                  06830099
068400     CLOSE INPUT-FILE                                             06840099
068500           REPORT-FILE1.                                          06850099
068600                                                                  06860099
068700     DISPLAY ' RECORDS READ      = ' PV-RECORDS-READ.             06870099
068800                                                                  06880099
068900******************************************************************06890099
069000* ABEND PROCEDURE                                                *06900099
069100******************************************************************06910099
069200 9900-DB2-ABEND.                                                  06920099
069300     DISPLAY '** PROGRAM ABEND   ** = ' PC-PROGRAM-NAME.          06930099
069400     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARAGRAPH.       06940099
069500     DISPLAY '** OPERATION       ** = ' PV-ABEND-OPERATION.       06950099
069600     MOVE SQLCODE TO PV-ABEND-CODE                                06960099
069700                     PV-SQLCODE.                                  06970099
069800     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               06980099
069900     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       06990099
070000                                                                  07000099
