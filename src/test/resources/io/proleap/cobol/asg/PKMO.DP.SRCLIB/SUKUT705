000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400 PROGRAM-ID.             SUKUT705.                                00040001
000500 AUTHOR.                 GERMAN BANDA.                            00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00060001
000700 DATE-WRITTEN            AUGUST, 2003.                            00070001
000800 DATE-COMPILED.                                                   00080001
000900******************************************************************00090001
001000* CALLED MODULE THAT WILL PROCESS FREE ASTRAYS AND DETERMINE      00100001
001100* WHETHER A NEW RECEIVER OR A NEW PACKSLIP NEEDS TO BE CREATED.   00110001
001200* ALSO IF CARTONS NEED TO BE DETACHED FROM THE PACKSLIP.          00120001
001300******************************************************************00130001
001400* CHANGED 12-01-2011 CHRISTINE TWIEHAUS    WR40574                00140057
001500*         ADDED CARR-AUTH-ID (CAN) TO SUWS044                     00150057
001600* CHANGED 03-28-2012 CHRISTINE TWIEHAUS    WR40574                00160059
001700*         LOOK UP CAN WHEN RECEVIER SEQ # = 000                   00170058
001800******************************************************************00180057
001900 ENVIRONMENT DIVISION.                                            00190001
002000 DATA DIVISION.                                                   00200001
002100******************************************************************00210001
002200 WORKING-STORAGE SECTION.                                         00220001
002300                                                                  00230001
002400 01  DK-DB2-KEYS.                                                 00240001
002500     05  DK-PO-NBR                PIC S9(09)  COMP.               00250001
002600     05  DK-PKSLIP-OPER-UNT-ID    PIC S9(04)  COMP.               00260031
002700     05  DK-CRTN-OPER-UNT-ID      PIC S9(04)  COMP.               00270099
002800     05  DK-OPER-UNT-ID           PIC S9(04)  COMP.               00280031
002900     05  DK-OPER-UNT-ID-2         PIC S9(04)  COMP.               00290001
003000     05  DK-RCVR-SEQ-NBR          PIC S9(09)  COMP.               00300001
003100     05  DK-SHIPT-UNT-ID          PIC S9(18)V COMP-3.             00310001
003200     05  DK-ENT-ID                PIC S9(09)  COMP.               00320001
003300     05  DK-STR-DEST-NBR          PIC S9(4)   COMP.               00330001
003400                                                                  00340001
003500 01  DN-DB2-NULL-INDICATORS.                                      00350001
003600     05  DN-SUM-NULL                PIC S9(04) COMP VALUE ZEROES. 00360001
003700     05  DN-SUM-NULL-UPC            PIC S9(04) COMP VALUE ZEROES. 00370001
003800*                                                                 00380001
003900*----------------------------------------------------------------*00390001
004000* COMMAREA USED WHEN LINKING FROM HANDLER PROGRAM                 00400001
004100*----------------------------------------------------------------*00410001
004200     COPY SUWS044.                                                00420001
004300                                                                  00430001
004400******************************************************************00440001
004500*  RANDOM NUMBER AREA.                                            00450001
004600******************************************************************00460001
004700     COPY DPWS902.                                                00470001
004800                                                                  00480001
004900******************************************************************00490001
005000*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00500001
005100******************************************************************00510001
005200     COPY DPWS013.                                                00520001
005300                                                                  00530001
005400*----------------------------------------------------------------*00540001
005500*  PROGRAM CONSTANTS                                             *00550001
005600*----------------------------------------------------------------*00560001
005700 01  PC-PROGRAM-CONSTANTS.                                        00570001
005800     05  PC-F                     PIC  X(01)  VALUE 'F'.          00580001
005900     05  PC-P                     PIC  X(01)  VALUE 'P'.          00590001
006000     05  PC-I                     PIC  X(01)  VALUE 'I'.          00600001
006100     05  PC-N                     PIC  X(01)  VALUE 'N'.          00610001
006200     05  PC-Y                     PIC  X(01)  VALUE 'Y'.          00620001
006300     05  PC-A                     PIC  X(01)  VALUE 'A'.          00630001
006400     05  PC-D                     PIC  X(01)  VALUE 'D'.          00640001
006500     05  PC-C                     PIC  X(01)  VALUE 'C'.          00650001
006600     05  PC-IP                    PIC  X(02)  VALUE 'IP'.         00660001
006700     05  PC-02                    PIC  X(02)  VALUE '02'.         00670001
006800     05  PC-DEFAULT               PIC  X(06)  VALUE 'DEFALT'.     00680001
006900     05  PC-CHECK-IN              PIC  X(08)  VALUE 'CHECK-IN'.   00690001
007000     05  PC-DEFAULT-DATE          PIC  X(26)  VALUE               00700001
007100                                  '9999-09-09-09.09.09.999999'.   00710001
007200     05  PC-RANDOM-NBR-GENERATOR  PIC  X(08)  VALUE 'DPKUT902'.   00720001
007300     05  PC-RECEIVER-CREATE       PIC  X(08)  VALUE 'SUKUT703'.   00730001
007400     05  PC-PKSLIP-CRE-DETACH     PIC  X(08)  VALUE 'SUKUT704'.   00740001
007500     05  PC-LOG-QUEUE             PIC  X(04)  VALUE 'CSSL'.       00750001
007600     05  PC-MSG-TABLE-SIZE            PIC S9(03) COMP-3 VALUE 200.00760001
007700     05  PC-100                       PIC  9(03)V99     VALUE 100.00770001
007800     05  PC-LOGON-TRAN-ID                PIC  X(04)  VALUE 'Z028'.00780001
007900                                                                  00790001
008000*----------------------------------------------------------------*00800001
008100*  PROGRAM SWITCHES                                              *00810001
008200*----------------------------------------------------------------*00820001
008300 01  PS-PROGRAM-SWITCHES.                                         00830001
008400     05  PS-CARTON-ALREADY-EXISTS-SW     PIC  X(01)  VALUE 'N'.   00840001
008500         88  PS-CARTON-ALREADY-EXISTS                VALUE 'Y'.   00850001
008600         88  PS-CARTON-DOESNT-EXIST                  VALUE 'N'.   00860001
008700     05  PS-SHOW-DEBUG-SW                PIC  X(01)  VALUE 'N'.   00870001
008800         88  PS-DONT-SHOW-DEBUG-INFO                 VALUE 'N'.   00880001
008900         88  PS-SHOW-DEBUG-INFO                      VALUE 'Y'.   00890001
009000     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   00900001
009100         88  PS-ERROR                                VALUE 'Y'.   00910001
009200         88  PS-ERROR-NO                             VALUE 'N'.   00920001
009300     05  PS-DUMP-TO-LOG-SW               PIC X(01)   VALUE 'N'.   00930001
009400         88  PS-DONT-DUMP-TO-LOG                     VALUE 'N'.   00940001
009500         88  PS-DUMP-TO-LOG                          VALUE 'Y'.   00950001
009600     05  PS-FA-PKSL-EXISTS-SW            PIC X(01)   VALUE 'N'.   00960001
009700         88  PS-FA-PKSL-EXISTS                       VALUE 'Y'.   00970001
009800         88  PS-FA-PKSL-NOT-EXISTS                   VALUE 'N'.   00980001
009900     05  PS-PBS-VERIF-CRTN-CSR-SW        PIC X(01)   VALUE 'N'.   00990001
010000         88  PS-END-OF-PBS-VER-CRT-CSR               VALUE 'Y'.   01000001
010100         88  PS-NOT-END-OF-PBS-VER-CRT-CSR           VALUE 'N'.   01010001
010200     05  PS-VERFIF-CARTON-CSR-SW         PIC X(01)   VALUE 'N'.   01020001
010300         88  PS-END-OF-VERF-CARTON-CSR               VALUE 'Y'.   01030001
010400         88  PS-NOT-END-OF-VERF-CARTON-CSR           VALUE 'N'.   01040001
010500     05  PS-PO-RCVR-FA-PKSLIP-SW         PIC X(01)   VALUE 'N'.   01050001
010600         88  PS-PO-RCVR-FA-PKSLIP-YES                VALUE 'Y'.   01060001
010700         88  PS-PO-RCVR-FA-PKSLIP-NO                 VALUE 'N'.   01070001
010800     05  PS-FA-RCVR-EXISTS-ON-TRLR-SW    PIC X(01)   VALUE 'N'.   01080001
010900         88  PS-FA-RCVR-EXISTS-ON-TRLR               VALUE 'Y'.   01090001
011000         88  PS-NO-FA-RCVR-EXISTS-ON-TRLR            VALUE 'N'.   01100001
011100     05  PS-CI-RCVR-EXISTS-ON-TRLR-SW    PIC X(01)   VALUE 'N'.   01110001
011200         88  PS-CI-RCVR-EXISTS-ON-TRLR               VALUE 'Y'.   01120001
011300         88  PS-NO-CI-RCVR-EXISTS-ON-TRLR            VALUE 'N'.   01130001
011400     05  PS-MISDIRECT-RCVR-EXISTS-SW     PIC X(01)   VALUE 'N'.   01140001
011500         88  PS-MISDIRECT-RCVR-EXISTS-YES            VALUE 'Y'.   01150001
011600         88  PS-MISDIRECT-RCVR-EXISTS-NO             VALUE 'N'.   01160001
011700     05  PS-MISDRCT-CRTN-EXISTS-SW       PIC X(01)   VALUE 'N'.   01170041
011800         88  PS-MISDRCT-CRTN-EXISTS-YES              VALUE 'Y'.   01180041
011900         88  PS-MISDRCT-CRTN-EXISTS-NO               VALUE 'N'.   01190041
012000     05  PS-MULTIPLE-LINE-CHECK-SW       PIC X(01)   VALUE 'N'.   01200041
012100         88  PS-MULTIPLE-LINES-YES                   VALUE 'Y'.   01210041
012200         88  PS-MULTIPLE-LINES-NO                    VALUE 'N'.   01220041
012300     05  PS-BLD-INTERNAL-TABLE-SW     PIC  X(01) VALUE 'N'.       01230078
012400         88  PS-BLD-INTERNAL-TABLE-YES           VALUE 'Y'.       01240078
012500         88  PS-BLD-INTERNAL-TABLE-NO            VALUE 'N'.       01250078
012600                                                                  01260099
012700* RPK - 3/13/2019 - START                                         01270099
012800     05  PS-FREE-ASTRAY-OPER-SW          PIC  X(01)  VALUE 'N'.   01280099
012900         88  PS-FREE-ASTRAY-OPER-NEW                 VALUE 'Y'.   01290099
013000         88  PS-FREE-ASTRAY-OPER-OLD                 VALUE 'N'.   01300099
013100* RPK - 3/13/2019 - END                                           01310099
013200                                                                  01320078
013300                                                                  01330001
013400*----------------------------------------------------------------*01340001
013500*  PROGRAM VARIABLES                                             *01350001
013600*----------------------------------------------------------------*01360001
013700 01  PV-PROGRAM-VARIABLES.                                        01370001
013800                                                                  01380001
013900     05  PV-DISPLAY-CARTON               PIC 9(18).               01390001
014000     05  PV-DISPLAY-PO-NBR               PIC 9(09).               01400001
014100     05  PV-DISPLAY-PO-LINE-NBR          PIC 9(09).               01410001
014200     05  PV-DISPLAY-PKSLIP-SEQ           PIC 9(04).               01420001
014300     05  PV-DISPLAY-PREPK-ID             PIC 9(04).               01430001
014400     05  PV-DISPLAY-OPER-UNT-ID          PIC 9(04).               01440001
014500     05  PV-DISPLAY-CRTN-OPER-UNT-ID     PIC 9(04).               01450099
014600     05  PV-DISPLAY-DEST-OPER            PIC 9(04).               01460001
014700     05  PV-DISPLAY-SHIPMT-ID            PIC 9(09).               01470001
014800     05  PV-DISPLAY-INBND-TRIP-ID        PIC 9(09).               01480001
014900     05  PV-DISPLAY-RCVR-SEQ-NBR         PIC 9(04).               01490013
015000     05  PV-DISPLAY-SHIPT-UNT-ID         PIC 9(18).               01500001
015100     05  PV-DISPLAY-ENT-ID               PIC 9(09).               01510001
015200     05  PV-DISPLAY-DEPT-NBR             PIC 9(04).               01520001
015300     05  PV-DISPLAY-CK-AFT-DAY-QTY       PIC 9(04).               01530001
015400     05  PV-DISPLAY-SQLCODE              PIC 9(04).               01540001
015500     05  PV-DISPLAY-SQLCODE-1550         PIC 9(04).               01550099
015600     05  PV-DISPLAY-SQLCODE-1551         PIC 9(04).               01560099
015700     05  PV-DISPLAY-LIMIT-DAYS           PIC 9(09).               01570001
015800     05  PV-DISPLAY-TASK                 PIC 9(07).               01580001
015900     05  PV-DISPLAY-MSG-NBR              PIC 9(03).               01590001
016000     05  PV-DISP-CMT-CNT                 PIC 9(04).               01600047
016100                                                                  01610068
016200     05  PV-DISP-SSCC                    PIC 9(18).               01620070
016300     05  PV-DISP-SEQ                     PIC 9(04).               01630070
016400     05  PV-DISP-STR                     PIC 9(05).               01640070
016500     05  PV-DISP-ORIG-OPER               PIC 9(04).               01650070
016600                                                                  01660001
016700     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACES.01670001
016800                                                                  01680001
016900     05  PV-COMMIT-THRSHLD               PIC S9(4)  COMP.         01690045
017000     05  PV-COMMIT-COUNT                 PIC S9(4)  COMP.         01700045
017100                                                                  01710045
017200     05  PV-PASSED-COUNT                 PIC S9(4)  COMP.         01720045
017300     05  PV-PROMPTED-CNT                 PIC S9(4)  COMP.         01730001
017400     05  PV-DB2-COUNT-EXP-SCN            PIC S9(4)  VALUE +0      01740001
017500                                                    COMP.         01750001
017600     05  PV-DB2-RCVR-COUNT               PIC S9(4)  VALUE +0      01760001
017700                                                    COMP.         01770001
017800     05  PV-DB2-SHUNLO-SCN-CNT           PIC S9(4)  VALUE +0      01780001
017900                                                    COMP.         01790001
018000     05  PV-DB2-CART-COMB-CNT            PIC S9(4)  VALUE +0      01800003
018100                                                    COMP.         01810002
018200     05  PV-CARTONS-TO-AUDIT             PIC S9(9)  VALUE +0      01820001
018300                                                    COMP.         01830001
018400     05  PV-UNITS-TO-AUDIT               PIC S9(9)  VALUE +0      01840001
018500                                                    COMP.         01850001
018600     05  PV-TOTAL-CARTONS                PIC S9(9)  VALUE +0      01860001
018700                                                    COMP.         01870001
018800     05  PV-CHECK-IN-COUNT               PIC S9(9)  VALUE +0      01880001
018900                                                    COMP.         01890001
019000     05  PV-TOTAL-UNITS                  PIC S9(9)  VALUE +0      01900001
019100                                                    COMP.         01910001
019200     05  PV-SUM-EXPTD-ALLOC              PIC S9(9)  VALUE +0      01920001
019300                                                    COMP.         01930001
019400     05  PV-SUM-OF-ALL-LINES             PIC S9(9)  VALUE +0      01940001
019500                                                    COMP.         01950001
019600     05  PV-AUDIT-CNTL-NBR-X             PIC  X(09) VALUE SPACE.  01960001
019700     05  PV-AUDIT-CNTL-NBR  REDEFINES                             01970001
019800         PV-AUDIT-CNTL-NBR-X             PIC  9(09).              01980001
019900     05  PV-LIMIT-DAYS                   PIC S9(09) COMP.         01990001
020000     05  PV-SHPD-QTY-SUM                 PIC S9(09) COMP-3.       02000001
020100     05  PV-CARTON-COUNT                 PIC S9(09) COMP.         02010001
020200     05  PV-CICS-MSG-AREA                PIC  X(80) VALUE SPACE.  02020074
020300     05  PV-CICS-RESPONSE                PIC S9(08) VALUE ZEROS   02030001
020400                                                    COMP SYNC.    02040001
020500     05  PV-EIBTASKN                     PIC Z(06)9.              02050001
020600     05  PV-PREV-SEQUENCE                PIC S9(05) COMP-3        02060001
020700                                                     VALUE ZERO.  02070001
020800     05  PV-NEXT-SEQUENCE                PIC S9(05) COMP-3        02080001
020900                                                     VALUE ZERO.  02090001
021000     05  PV-UNT-QTY                      PIC  9(05)V99.           02100001
021100     05  PV-SYSID                        PIC  X(04)  VALUE SPACE. 02110001
021200     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   02120001
021300                                                     COMP.        02130001
021400     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   02140001
021500                                                     COMP SYNC.   02150001
021600                                                                  02160074
021700     05  PV-CSSL-PARA                    PIC  X(04) VALUE SPACES. 02170074
021800     05  PV-PARM-SECONDS                 PIC S9(09) COMP VALUE 0. 02180074
021900     05  PV-RECEIVE-RQST-TMST            PIC X(26).               02190074
022000     05  PV-RECEIVE-RQST-TMST-R REDEFINES PV-RECEIVE-RQST-TMST.   02200074
022100         10  FILLER                      PIC  X(11).              02210074
022200         10  PV-INIT-HH                  PIC  9(02).              02220074
022300         10  FILLER                      PIC  X(01).              02230074
022400         10  PV-INIT-MM                  PIC  9(02).              02240074
022500         10  FILLER                      PIC  X(01).              02250074
022600         10  PV-INIT-SS                  PIC  9(02).              02260074
022700         10  FILLER                      PIC  X(07).              02270074
022800     05  PV-INIT-TIME-KEY.                                        02280074
022900         10  PV-INIT-KEY-HH              PIC  9(02).              02290074
023000         10  PV-INIT-KEY-MM              PIC  9(02).              02300074
023100         10  PV-INIT-KEY-SS              PIC  9(02).              02310074
023200     05  PV-DURATION-SEC                 PIC S9(09) COMP VALUE 0. 02320074
023300     05  PV-DISP-DURATION                PIC  9(09)   VALUE ZEROS.02330074
023400     05  PV-DISP-PARM-SECONDS            PIC  9(09)   VALUE ZEROS.02340074
023500     05  PV-DURATION-NANO-SEC            PIC S9(10) COMP VALUE 0. 02350074
023600     05  PV-WORK-NANO-SEC                PIC  9(10) VALUE ZEROES. 02360074
023700     05  PV-WORK-NANO-SEC-REDEF REDEFINES PV-WORK-NANO-SEC.       02370074
023800         10  PV-WORK-NANO-MIN-1-2        PIC  9(02).              02380074
023900         10  PV-WORK-NANO-SEC-3-4        PIC  9(02).              02390074
024000         10  PV-WORK-NANO-MICRO-5-10     PIC  9(06).              02400074
024100     05  PV-DISP-NANO-SEC                PIC  X(12).              02410074
024200     05  PV-DISP-NANO-SEC-REDEF REDEFINES PV-DISP-NANO-SEC.       02420074
024300         10  PV-DISP-NANO-MIN-1-2        PIC  9(02).              02430074
024400         10  PV-DISP-NANO-DASH-1         PIC  X(01).              02440074
024500         10  PV-DISP-NANO-SEC-3-4        PIC  9(02).              02450074
024600         10  PV-DISP-NANO-DASH-2         PIC  X(01).              02460074
024700         10  PV-DISP-NANO-MICRO-5-10     PIC  9(06).              02470074
024800     05  PV-CURRENT-PARA-TMST            PIC  X(26).              02480074
024900     05  PV-CICS-MSG-AREA-3              PIC  X(125) VALUE SPACE. 02490088
025000                                                                  02500080
025100     05  PV-DISP-PO                      PIC  9(09) VALUE zeros.  02510080
025200     05  PV-DISP-ORIG-RCVR               PIC  9(04) VALUE zeros.  02520080
025300     05  PV-DISP-NEW-RCVR                PIC  9(04) VALUE zeros.  02530080
025400     05  PV-DISP-OPER                    PIC  9(04) VALUE zeros.  02540080
025500     05  PV-DISP-CRTN-OPER               PIC  9(04) VALUE zeros.  02550080
025600     05  PV-DISP-FCLTY                   PIC  9(04) VALUE zeros.  02560080
025700     05  PV-DISP-TRIP                    PIC  9(09) VALUE zeros.  02570080
025800     05  PV-DISP-DEST-STR                PIC  9(04) VALUE zeros.  02580080
025900     05  PV-DISP-ORIG-SHIP               PIC  9(09) VALUE zeros.  02590080
026000     05  PV-DISP-NEW-SHIP                PIC  9(09) VALUE zeros.  02600080
026100     05  PV-DISP-ORIG-PKSL               PIC  9(04) VALUE zeros.  02610080
026200     05  PV-DISP-NEW-PKSL                PIC  9(04) VALUE zeros.  02620080
026300     05  PV-DISP-SQLCODE                 PIC  -999  VALUE zeros.  02630080
026400                                                                  02640099
026500* RPK - 3/13/2019 - START                                         02650099
026600     05  PV-PARM-TEXT-CORP-FAOPR2        PIC X(01)   VALUE SPACE. 02660099
026700* RPK - 3/13/2019 - END                                           02670099
026800                                                                  02680080
026900 01  PV-TPKSLIP-FIELDS.                                           02690001
027000     05  PV-PKSLIP-PO-NBR                PIC  S9(9) COMP.         02700001
027100     05  PV-PKSLIP-SEQ-NBR               PIC  S9(4) COMP.         02710001
027200     05  PV-PKSLIP-CRE-TMST              PIC   X(26).             02720001
027300     05  PV-PKSLIP-VER-STAT-CDE          PIC   X(1).              02730001
027400     05  PV-PKSLIP-OPER-UNT-ID           PIC  S9(4) COMP.         02740001
027500     05  PV-PKSLIP-FCLTY-ID              PIC  S9(4) COMP.         02750001
027600     05  PV-PKSLIP-PKSL-NBR              PIC   X(10).             02760001
027700     05  PV-PKSLIP-STR-DEST-NBR          PIC  S9(4) COMP.         02770001
027800     05  PV-PKSLIP-REC-SEQ-NBR           PIC  S9(9) COMP.         02780001
027900     05  PV-PKSLIP-SHIPT-ID              PIC  S9(9) COMP.         02790001
028000     05  PV-PKSLIP-BOL-NBR               PIC   X(16).             02800001
028100     05  PV-PKSLIP-PRO-NBR               PIC   X(16).             02810001
028200     05  PV-PKSLIP-PKSL-STAT-CDE         PIC   X(2).              02820001
028300     05  PV-PKSLIP-CRE-UID               PIC   X(8).              02830001
028400     05  PV-PKSLIP-PO-VER-NBR            PIC  S9(9) COMP.         02840001
028500     05  PV-PKSLIP-CRE-SRC-CDE           PIC   X(4).              02850001
028600     05  PV-PKSLIP-EXPTED-PKG-QTY        PIC  S9(9) COMP.         02860001
028700     05  PV-PKSLIP-OWNER-SCAC-ID         PIC   X(4).              02870001
028800     05  PV-PKSLIP-ASN-NBR               PIC   X(30).             02880001
028900     05  PV-PKSLIP-VEND-SHIP-DTE         PIC   X(10).             02890001
029000     05  PV-PKSLIP-PKSL-PG-CNT           PIC  S9(4) COMP.         02900001
029100     05  PV-PKSLIP-CONTNR-ID             PIC   X(12).             02910001
029200     05  PV-PKSLIP-ORIG-PKSL-SEQ-NBR     PIC  S9(4) COMP.         02920001
029300/                                                                 02930001
029400 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  02940001
029500     05  TS-INFO-QUEUE-NAME.                                      02950001
029600         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 02960001
029700         10  FILLER                      PIC  X(04)  VALUE 'INFO'.02970001
029800                                                                  02980001
029900                                                                  02990074
030000*----------------------------------------------------------------*03000074
030100* PARAGRAPH TRACKING TABLE - USED FOR DEBUGGING                  *03010074
030200* WILL TRACK PARAGRAPHS IN THIS TABLE - IF WE SEE TRANSACTION    *03020074
030300* IF TAKING LONGER THEN X SECONDS TO RESPOND, WILL DUMP THE      *03030074
030400* TABLE TO CSSL                                                  *03040074
030500* PARM PATIM4                                                    *03050074
030600*----------------------------------------------------------------*03060074
030700 01  PT-PARA-TRACKING-TABLE.                                      03070074
030800     05  PT-ENTRIES               OCCURS 1500 TIMES               03080074
030900                                  INDEXED BY PT-TRACK-IDX.        03090074
031000         10 FILLER                PIC  X(01) VALUE SPACE.         03100074
031100         10 PT-PROGRAM            PIC  X(08) VALUE 'SUKCS771'.    03110074
031200         10 FILLER                PIC  X(01) VALUE SPACE.         03120074
031300         10 pt-dc                 PIC  9(04) VALUE zeroes.        03130074
031400         10 filler                PIC  X(01) VALUE '-'.           03140074
031500         10 PT-crtn-oper          PIC  9(04) VALUE zeroes.        03150082
031600         10 filler                PIC  X(01) VALUE '-'.           03160074
031700         10 pt-start-hhmmss       PIC  9(06) VALUE zeroes.        03170074
031800         10 FILLER                PIC  X(01) VALUE SPACE.         03180074
031900         10 PT-INDEX-NBR          PIC  9(05) VALUE ZEROES.        03190074
032000         10 FILLER                PIC  X(01) VALUE SPACE.         03200074
032100         10 PT-paragraph          PIC  X(04) VALUE SPACE.         03210074
032200         10 FILLER                PIC  X(01) VALUE SPACE.         03220074
032300         10 PT-TIMESTAMP          PIC  X(26) VALUE SPACE.         03230074
032400         10 FILLER                PIC  X(01) VALUE SPACE.         03240074
032500         10 PT-DURATION           PIC  9(09) VALUE ZEROES.        03250074
032600         10 FILLER                PIC  X(01) VALUE SPACE.         03260074
032700         10 PT-nano-sec           PIC  x(12) VALUE ZEROES.        03270074
032800     05  PT-MAX-PARA-ENTRIES      PIC  9(04) VALUE 1500.          03280074
032900     05  PT-CURR-ENTRIES          PIC  9(04) VALUE ZEROES.        03290074
033000     05  PT-CURR-PARA             PIC  X(04) VALUE SPACES.        03300074
033100                                                                  03310074
033200                                                                  03320074
033300 01  PT-MSG-TABLE.                                                03330001
033400     05  PT-MSG-LINES OCCURS 200 TIMES                            03340001
033500                              INDEXED BY PT-MSG-IDX.              03350001
033600         10  PT-MSG-SEQ                  PIC S9(05) COMP-3.       03360001
033700         10  PT-MSG-LINE                 PIC X(69).               03370001
033800                                                                  03380001
033900     05  PV-COMMAREA-LENGTH              PIC S9(04)  COMP         03390001
034000                                                     VALUE ZERO.  03400001
034100     05  PV-CICS-RESP                    PIC S9(08)  VALUE ZEROS  03410001
034200                                                     COMP SYNC.   03420001
034300                                                                  03430001
034400*---------------------------------------------------------------* 03440001
034500*    DB2 AREA FOR SHIPMENT PO TABLE                             * 03450001
034600*---------------------------------------------------------------* 03460001
034700     EXEC SQL                                                     03470001
034800          INCLUDE TSHPTPO                                         03480001
034900     END-EXEC.                                                    03490001
035000*---------------------------------------------------------------* 03500001
035100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      03510001
035200*  (TSHPUNT)                                                      03520001
035300*---------------------------------------------------------------* 03530001
035400     EXEC SQL                                                     03540001
035500         INCLUDE TSHPUNT                                          03550001
035600     END-EXEC.                                                    03560001
035700                                                                  03570001
035800*---------------------------------------------------------------* 03580001
035900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CARTON LOCATION    03590001
036000*  (TSHUNLO)                                                      03600001
036100*---------------------------------------------------------------* 03610001
036200     EXEC SQL                                                     03620001
036300         INCLUDE TSHUNLO                                          03630001
036400     END-EXEC.                                                    03640001
036500                                                                  03650001
036600*---------------------------------------------------------------* 03660001
036700*    DB2 AREA FOR THE INPKSU TABLE                                03670001
036800*---------------------------------------------------------------* 03680001
036900     EXEC SQL                                                     03690001
037000          INCLUDE TINPKSU                                         03700001
037100     END-EXEC.                                                    03710001
037200*---------------------------------------------------------------* 03720001
037300*    DB2 AREA FOR THE PACKSLIP TABLE                            * 03730001
037400*---------------------------------------------------------------* 03740001
037500     EXEC SQL                                                     03750001
037600          INCLUDE TPKSLIP                                         03760001
037700     END-EXEC.                                                    03770001
037800*---------------------------------------------------------------* 03780001
037900*    DB2 AREA FOR THE DISTRIBUTION HEADER TABLE                 * 03790001
038000*---------------------------------------------------------------* 03800001
038100     EXEC SQL                                                     03810001
038200          INCLUDE TDISTHD                                         03820001
038300     END-EXEC.                                                    03830001
038400*---------------------------------------------------------------* 03840001
038500*    DB2 AREA FOR THE SHIPPING UPC TABLE                        * 03850001
038600*---------------------------------------------------------------* 03860001
038700     EXEC SQL                                                     03870001
038800          INCLUDE TSHUUPC                                         03880001
038900     END-EXEC.                                                    03890001
039000*---------------------------------------------------------------* 03900001
039100*    DB2 AREA FOR THE RECEIVING SYSTEM PARM TABLE               * 03910001
039200*---------------------------------------------------------------* 03920001
039300     EXEC SQL                                                     03930001
039400         INCLUDE TKRPRPM                                          03940001
039500     END-EXEC.                                                    03950001
039600*---------------------------------------------------------------* 03960001
039700*    DB2 AREA FOR THE SHIPMENT TABLE                            * 03970001
039800*---------------------------------------------------------------* 03980001
039900     EXEC SQL                                                     03990001
040000         INCLUDE TSHIPMT                                          04000001
040100     END-EXEC.                                                    04010001
040200*---------------------------------------------------------------* 04020064
040300*    DB2 AREA FOR THE TRIP STATUS TABLE                         * 04030063
040400*---------------------------------------------------------------* 04040063
040500     EXEC SQL                                                     04050063
040600         INCLUDE TTRIPST                                          04060063
040700     END-EXEC.                                                    04070063
040800*---------------------------------------------------------------* 04080001
040900*    DB2 AREA FOR THE RECEIVER TABLE                            * 04090001
041000*---------------------------------------------------------------* 04100001
041100     EXEC SQL                                                     04110001
041200         INCLUDE TRECEIV                                          04120001
041300     END-EXEC.                                                    04130001
041400*---------------------------------------------------------------* 04140003
041500*    DB2 AREA FOR THE CARTON SUMMARY TABLE                      * 04150003
041600*---------------------------------------------------------------* 04160003
041700     EXEC SQL                                                     04170003
041800         INCLUDE TSHPSUM                                          04180003
041900     END-EXEC.                                                    04190003
042000*---------------------------------------------------------------* 04200045
042100*    DB2 AREA FOR THE WST_INTGRTN_TYP                             04210045
042200*---------------------------------------------------------------* 04220045
042300     EXEC SQL                                                     04230045
042400         INCLUDE WST00008                                         04240045
042500     END-EXEC.                                                    04250045
042600*----------------------------------------------------------------*04260001
042700*---------------------------------------------------------------* 04270045
042800*    DB2 AREA FOR THE WST_ATTR_DEFN                             * 04280045
042900*---------------------------------------------------------------* 04290045
043000     EXEC SQL                                                     04300045
043100         INCLUDE WST00009                                         04310045
043200     END-EXEC.                                                    04320045
043300*---------------------------------------------------------------* 04330045
043400*    DB2 AREA FOR THE WST_ATTR_WLWM                             * 04340045
043500*---------------------------------------------------------------* 04350045
043600     EXEC SQL                                                     04360045
043700         INCLUDE WST00010                                         04370045
043800     END-EXEC.                                                    04380045
043900*----------------------------------------------------------------*04390045
044000*  COMMUNICATIONS AREA FOR DB2                                   *04400001
044100*----------------------------------------------------------------*04410001
044200     EXEC SQL                                                     04420001
044300         INCLUDE SQLCA                                            04430001
044400     END-EXEC.                                                    04440001
044500                                                                  04450001
044600                                                                  04460001
044700*-----------------------------------------------------------------04470001
044800*  VERIFICATION PROCESSING                                        04480001
044900*  CURSOR TO DETERMINE CARTONS ATTACHED TO PO/RCVR THAT ARE NOT   04490001
045000*  CHECKED IN (NON PACK-BY-STORE)                                 04500001
045100*-----------------------------------------------------------------04510001
045200     EXEC SQL                                                     04520001
045300       DECLARE VERF-CARTON-CSR CURSOR WITH HOLD FOR               04530052
045400         SELECT DISTINCT                                          04540001
045500                A.SHIPT_UNT_ID                                    04550001
045600              , A.SEQ_NBR                                         04560001
045700              , B.STR_DEST_NBR                                    04570001
045800              , B.OPER_UNT_ID                                     04580001
045900              , B.PKSL_STAT_CDE                                   04590001
046000          FROM  TINPKSU A                                         04600001
046100              , TPKSLIP B                                         04610001
046200              , TSHUUPC C                                         04620001
046300              , TDISTHD D                                         04630001
046400          WHERE  B.PO_NBR             = :SU044-PO                 04640001
046500            AND  A.PO_NBR             =  B.PO_NBR                 04650001
046600            AND  A.SEQ_NBR            = B.SEQ_NBR                 04660001
046700            AND  B.VER_STAT_CDE       = 'A'                       04670001
046800            AND  B.REC_SEQ_NBR        = :SU044-ORIG-REC-SEQ-NBR   04680001
046900            AND  A.SHIPT_UNT_ID       = C.SHIPT_UNT_ID            04690001
047000            AND  B.PO_NBR             = D.ORD_NBR                 04700001
047100            AND  B.REC_SEQ_NBR        = D.RCVR_SEQ_NBR            04710001
047200            AND  C.TRN_LNE_NBR        = D.ORD_LNE_NBR             04720001
047300            AND (D.UCC128_DAT_USG_CDE = 'U'  OR                   04730001
047400                 D.CRE_USR_ID  IN ('TRLRUNLD', 'HOTCMPLT',        04740072
047500                                   'WSKCS310'))                   04750072
047600            AND  A.SHIPT_UNT_ID NOT IN                            04760001
047700                (SELECT  C.SHIPT_UNT_ID                           04770001
047800                 FROM   TSHUNLO C                                 04780001
047900                 WHERE  A.SHIPT_UNT_ID = C.SHIPT_UNT_ID)          04790001
048000     END-EXEC.                                                    04800001
048100                                                                  04810001
048200*-----------------------------------------------------------------04820001
048300*  VERIFICATION PROCESSING                                        04830001
048400*  CURSOR TO DETERMINE CARTONS ATTACHED TO PO/RCVR THAT ARE NOT   04840001
048500*  CHECKED IN (PACK-BY-STORE)                                     04850001
048600*-----------------------------------------------------------------04860001
048700     EXEC SQL                                                     04870001
048800       DECLARE VER-CRTN-PBS-CSR CURSOR WITH HOLD FOR              04880052
048900         SELECT DISTINCT                                          04890001
049000                A.SHIPT_UNT_ID                                    04900001
049100              , A.SEQ_NBR                                         04910001
049200              , B.STR_DEST_NBR                                    04920001
049300              , D.ORGN_OPER_UNT_ID                                04930001
049400              , B.PKSL_STAT_CDE                                   04940001
049500          FROM  TINPKSU A                                         04950001
049600              , TPKSLIP B                                         04960001
049700              , TSHPUNT D                                         04970001
049800              , TSHUUPC E                                         04980001
049900          WHERE  B.PO_NBR        = :SU044-PO                      04990001
050000            AND  A.PO_NBR        = B.PO_NBR                       05000001
050100            AND  A.SEQ_NBR       = B.SEQ_NBR                      05010001
050200            AND  B.VER_STAT_CDE  = 'A'                            05020001
050300            AND  B.REC_SEQ_NBR   = :SU044-ORIG-REC-SEQ-NBR        05030001
050400            AND  A.SHIPT_UNT_ID  = D.SHIPT_UNT_ID                 05040001
050500            AND  D.ACTV_IND      = 'A'                            05050001
050600            AND  D.SHIPT_UNT_ID  =  E.SHIPT_UNT_ID                05060001
050700            AND  E.SHPD_QTY      >  0                             05070001
050800            AND  B.STR_DEST_NBR > 0                               05080012
050900            AND  A.SHIPT_UNT_ID NOT IN                            05090001
051000            (SELECT  C.SHIPT_UNT_ID                               05100001
051100             FROM   TSHUNLO C                                     05110001
051200             WHERE  A.SHIPT_UNT_ID = C.SHIPT_UNT_ID)              05120001
051300     END-EXEC.                                                    05130001
051400                                                                  05140001
051500                                                                  05150001
051600******************************************************************05160001
051700 LINKAGE SECTION.                                                 05170001
051800******************************************************************05180001
051900 01  DFHCOMMAREA.                                                 05190001
052000     05  FILLER                         OCCURS  1 TO 4072 TIMES   05200001
052100                                      DEPENDING ON EIBCALEN.      05210001
052200         10  FILLER                   PIC X.                      05220001
052300                                                                  05230001
052400******************************************************************05240001
052500 PROCEDURE DIVISION.                                              05250095
052600******************************************************************05260001
052700 0000-PROGRAM-MAINLINE.                                           05270001
052800     MOVE EIBTASKN                 TO  PV-EIBTASKN.               05280001
052900     INITIALIZE                        SU044-COMM-AREA.           05290001
053000     MOVE DFHCOMMAREA              TO  SU044-COMM-AREA.           05300001
053100                                                                  05310001
053200     MOVE 999999999                TO  PV-PARM-SECONDS.           05320090
053300     SET PS-BLD-INTERNAL-TABLE-NO  TO  TRUE.                      05330075
053400                                                                  05340098
053500     EXEC SQL                                                     05350098
053600          SET :PV-CURRENT-PARA-TMST = CURRENT TIMESTAMP           05360098
053700     END-EXEC.                                                    05370098
053800                                                                  05380098
053900     move  pv-current-para-tmst  to  PV-RECEIVE-RQST-TMST.        05390098
054000                                                                  05400099
054100     MOVE  PV-INIT-HH            TO  PV-INIT-KEY-HH.              05410099
054200     MOVE  PV-INIT-MM            TO  PV-INIT-KEY-MM.              05420099
054300     MOVE  PV-INIT-SS            TO  PV-INIT-KEY-SS.              05430099
054400                                                                  05440099
054500     MOVE SPACES                   TO PV-CICS-MSG-AREA.           05450001
054600     INITIALIZE PT-MSG-TABLE.                                     05460001
054700     MOVE 1                        TO PT-MSG-SEQ (PT-MSG-IDX).    05470001
054800     MOVE SU044-OPER-UNT-ID        TO DK-OPER-UNT-ID              05480031
054900                                      DK-PKSLIP-OPER-UNT-ID.      05490031
055000     MOVE SU044-CRTN-OPER-UNT-ID   TO DK-CRTN-OPER-UNT-ID.        05500099
055100                                                                  05510001
055200     PERFORM 8000-CHECK-FOR-LOGGING.                              05520001
055300     IF PS-SHOW-DEBUG-INFO                                        05530001
055400         MOVE SU044-PO               TO PV-DISPLAY-PO-NBR         05540001
055500         MOVE SU044-ORIG-REC-SEQ-NBR TO  PV-DISPLAY-RCVR-SEQ-NBR  05550001
055600         MOVE SU044-SHIPT-UNT-ID     TO  PV-DISPLAY-SHIPT-UNT-ID  05560001
055700         MOVE SU044-TRIP-ID          TO  PV-DISPLAY-INBND-TRIP-ID 05570099
055800         STRING   ' SUKUT705 PROGRAM STARTED -'                   05580001
055900                  ' CALLED BY-'                                   05590001
056000                  SU044-PROGRAM-NAME                              05600001
056100                  ' PO='                                          05610001
056200                  PV-DISPLAY-PO-NBR                               05620001
056300                  ' RCVR='                                        05630001
056400                  PV-DISPLAY-RCVR-SEQ-NBR                         05640001
056500                  DELIMITED BY SIZE                               05650001
056600                                  INTO PV-CICS-MSG-AREA           05660001
056700         PERFORM 9990-WRITE-CICS                                  05670001
056800         STRING   ' SUKUT705 PROGRAM STARTED -'                   05680099
056900                  ' CALLED BY-'                                   05690099
057000                  SU044-PROGRAM-NAME                              05700099
057100                  PV-DISPLAY-RCVR-SEQ-NBR                         05710099
057200                  ' CARTON='                                      05720099
057300                  PV-DISPLAY-SHIPT-UNT-ID                         05730099
057400                  DELIMITED BY SIZE                               05740099
057500                                  INTO PV-CICS-MSG-AREA           05750099
057600         PERFORM 9990-WRITE-CICS                                  05760099
057700         STRING   ' SUKUT705 PROGRAM STARTED -'                   05770099
057800                  ' CALLED BY-'                                   05780099
057900                  SU044-PROGRAM-NAME                              05790099
058000                  ' trip='                                        05800099
058100                  PV-DISPLAY-INBND-TRIP-ID                        05810099
058200                  DELIMITED BY SIZE                               05820099
058300                                  INTO PV-CICS-MSG-AREA           05830099
058400         PERFORM 9990-WRITE-CICS                                  05840099
058500         PERFORM 8110-WRITE-SUWS044-TO-CSSL                       05850099
058600     END-IF.                                                      05860099
058700                                                                  05870099
058800     perform 8100-CHECK-PARA-TRACK-SEC.                           05880099
058900                                                                  05890099
059000     MOVE SU044-PO                 TO DK-PO-NBR.                  05900099
059100     MOVE SU044-ORIG-REC-SEQ-NBR   TO DK-RCVR-SEQ-NBR.            05910099
059200     MOVE SU044-DEST-STR-NBR       TO DK-STR-DEST-NBR.            05920099
059300                                                                  05930099
059400     SET SU044-SUCCESSFUL          TO TRUE.                       05940099
059500     IF SU044-ORIG-REC-SEQ-NBR > 0                                05950001
059600        PERFORM 0500-SELECT-SHIPT-ID                              05960001
059700     END-IF                                                       05970001
059800**GB 12/12/07  BEG                                                05980056
059900***  CHECK PO FOR COMMIT LOGIC                                    05990045
060000     IF SU044-SUCCESSFUL                                          06000045
060100        PERFORM 0800-CHK-FOR-COMMIT-PRCSS                         06010045
060200     END-IF                                                       06020045
060300**GB 12/12/07  END                                                06030056
060400                                                                  06040045
060500     IF SU044-SUCCESSFUL                                          06050001
060600                                                                  06060045
060700        IF SU044-SRC-CHECKIN                                      06070001
060800            PERFORM 1000-PROCESS-PKSLIP                           06080001
060900        ELSE                                                      06090001
061000            IF SU044-RCVR-PBS                                     06100001
061100                PERFORM 3000-PROCESS-PBS-VERIF                    06110001
061200            ELSE                                                  06120001
061300                PERFORM 4000-PROCESS-VERIFICATION                 06130001
061400            END-IF                                                06140001
061500        END-IF                                                    06150001
061600     END-IF.                                                      06160001
061700                                                                  06170001
061800     MOVE SU044-COMM-AREA               TO DFHCOMMAREA.           06180001
061900                                                                  06190082
062000* 02/01/15 begin                                                  06200082
062100     IF  PS-BLD-INTERNAL-TABLE-YES  and                           06210082
062200         PV-DURATION-SEC     >=  PV-PARM-SECONDS                  06220082
062300                                                                  06230082
062400         move '0000'  to  PV-CSSL-PARA                            06240099
062500         perform 8110-WRITE-suws044-TO-CSSL                       06250082
062600                                                                  06260082
062700         STRING ' SUKUT705-DID NOT MEET SLA'                      06270082
062800                ' DC:'        PV-DISP-OPER                        06280082
062900                ' CRTN OPER:' PV-DISP-CRTN-OPER                   06290082
063000                ' SSCC:'      PV-DISP-SSCC                        06300082
063100                              DELIMITED BY SIZE                   06310082
063200                         INTO PV-CICS-MSG-AREA-3                  06320099
063300         PERFORM 9997-WRITE-TO-CSSL                               06330082
063400                                                                  06340082
063500         INITIALIZE PV-CICS-MSG-AREA-3                            06350099
063600         STRING ' SUKUT705 '                                      06360099
063700                ' START:'     PV-RECEIVE-RQST-TMST                06370099
063800                ' END:'       PV-CURRENT-PARA-TMST                06380099
063900                ' KEY:'       PV-INIT-TIME-KEY                    06390099
064000                ' DURATION:'  PV-DISP-NANO-SEC                    06400099
064100                              DELIMITED BY SIZE                   06410099
064200                         INTO PV-CICS-MSG-AREA-3                  06420099
064300         PERFORM 9997-WRITE-TO-CSSL                               06430099
064400                                                                  06440099
064500         PERFORM 8140-DUMP-TABLE-TO-CSSL                          06450082
064600         VARYING PT-TRACK-IDX                                     06460082
064700            FROM 1 BY 1                                           06470082
064800           UNTIL PT-TRACK-IDX >   PT-CURR-ENTRIES                 06480099
064900              OR PT-TRACK-IDX >   PT-MAX-PARA-ENTRIES             06490099
065000                                                                  06500082
065100         PERFORM 8150-CLEAR-TABLE                                 06510082
065200         VARYING PT-TRACK-IDX                                     06520082
065300            FROM 1 BY 1                                           06530082
065400            UNTIL PT-TRACK-IDX >   PT-CURR-ENTRIES                06540099
065500               OR PT-TRACK-IDX >   PT-MAX-PARA-ENTRIES            06550099
065600                                                                  06560082
065700         MOVE ZEROES TO PT-CURR-ENTRIES                           06570082
065800         SET  PT-TRACK-IDX  to  PT-CURR-ENTRIES                   06580082
065900                                                                  06590082
066000         INITIALIZE PV-CICS-MSG-AREA-3                            06600099
066100         MOVE PV-DURATION-SEC TO  PV-DISP-DURATION                06610082
066200         STRING ' SUKUT705-DID NOT MEET SLA'                      06620082
066300                ' DC:'        PV-DISP-OPER                        06630082
066400                ' CRTN OPER:' PV-DISP-CRTN-OPER                   06640082
066500                ' SSCC:'      PV-DISP-SSCC                        06650082
066600                ' DONE'                                           06660082
066700                              DELIMITED BY SIZE                   06670082
066800                         INTO PV-CICS-MSG-AREA-3                  06680099
066900         PERFORM 9997-WRITE-TO-CSSL                               06690082
067000                                                                  06700082
067100         move spaces to  pv-ciCS-MSG-AREA-3                       06710099
067200         PERFORM 9997-WRITE-TO-CSSL                               06720082
067300     END-IF.                                                      06730094
067400                                                                  06740082
067500                                                                  06750082
067600* 02/01/15 end                                                    06760082
067700                                                                  06770082
067800     GOBACK.                                                      06780001
067900                                                                  06790001
068000*                                                                 06800001
068100 0500-SELECT-SHIPT-ID.                                            06810001
068200                                                                  06820076
068300     IF  PS-BLD-INTERNAL-TABLE-YES                                06830076
068400         MOVE  '0500'  TO  PT-CURR-PARA                           06840076
068500         PERFORM 8120-INTERNAL-TABLE                              06850083
068600     END-IF.                                                      06860076
068700                                                                  06870076
068800     IF PS-SHOW-DEBUG-INFO                                        06880001
068900         STRING ' SUKUT705-0500-SELECT-SHIPT-ID'                  06890067
069000             DELIMITED BY SIZE                                    06900001
069100             INTO PV-CICS-MSG-AREA                                06910001
069200         PERFORM 9990-WRITE-CICS                                  06920001
069300     END-IF.                                                      06930001
069400                                                                  06940001
069500     INITIALIZE DCLTSHPTPO.                                       06950001
069600                                                                  06960001
069700     EXEC SQL                                                     06970001
069800          SELECT SHIPT_ID                                         06980001
069900          INTO   :SHPTPO-SHIPT-ID                                 06990001
070000          FROM   TSHPTPO                                          07000001
070100          WHERE  PO_NBR         = :DK-PO-NBR                      07010001
070200            AND  REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR                07020001
070300            AND  PRIM_SHIPT_IND = 'Y'                             07030001
070400     END-EXEC.                                                    07040001
070500                                                                  07050001
070600     EVALUATE TRUE                                                07060001
070700         WHEN SQLCODE = ZERO                                      07070001
070800             MOVE SHPTPO-SHIPT-ID  TO SU044-ORIG-SHIP             07080001
070900         WHEN SQLCODE = +100                                      07090001
071000             CONTINUE                                             07100001
071100         WHEN SQLWARN0 NOT = SPACES                               07110001
071200         WHEN SQLCODE NOT EQUAL ZERO                              07120001
071300              move '0500'  to  PV-CSSL-PARA                       07130076
071400              perform 8110-WRITE-suws044-TO-CSSL                  07140079
071500                                                                  07150076
071600             MOVE '0500-SELECT-SHIPT-ID'                          07160001
071700                             TO DP013-PARAGRAPH                   07170001
071800             MOVE 'SUKUT705 - SELECT SHIPT ID  '                  07180001
071900                             TO DP013-MESSAGE-TEXT(1)             07190001
072000             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 07200001
072100             STRING 'PO NBR: '         DELIMITED BY SIZE          07210001
072200                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          07220001
072300                           INTO DP013-MESSAGE-TEXT(2)             07230001
072400             MOVE DK-RCVR-SEQ-NBR                                 07240001
072500                             TO PV-DISPLAY-RCVR-SEQ-NBR           07250001
072600             STRING 'RECV SEQ: '       DELIMITED BY SIZE          07260001
072700                 PV-DISPLAY-RCVR-SEQ-NBR                          07270001
072800                                       DELIMITED BY SIZE          07280001
072900                           INTO DP013-MESSAGE-TEXT(4)             07290001
073000             MOVE SQLCA      TO DP013-SQLCA                       07300001
073100             MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME(1)           07310001
073200             SET DP013-DB2-ABEND                                  07320001
073300                             TO TRUE                              07330001
073400             SET DP013-ROLLBACK                                   07340001
073500                             TO TRUE                              07350001
073600             PERFORM 9999-WRITE-CICS-LOG-MSG                      07360001
073700             SET PS-DUMP-TO-LOG       TO TRUE                     07370001
073800             SET SU044-INVALID-SQL TO TRUE                        07380001
073900     END-EVALUATE.                                                07390001
074000*                                                                 07400001
074100 0600-SELECT-SHIPT-ID-NEW.                                        07410001
074200                                                                  07420076
074300     IF  PS-BLD-INTERNAL-TABLE-YES                                07430076
074400         MOVE  '0600'  TO  PT-CURR-PARA                           07440076
074500         PERFORM 8120-INTERNAL-TABLE                              07450083
074600     END-IF.                                                      07460076
074700                                                                  07470076
074800     IF PS-SHOW-DEBUG-INFO                                        07480001
074900         STRING ' SUKUT705-0600-SELECT-SHIPT-ID-NEW'              07490067
075000         DELIMITED BY SIZE                                        07500001
075100          INTO PV-CICS-MSG-AREA                                   07510001
075200         PERFORM 9990-WRITE-CICS                                  07520001
075300     END-IF.                                                      07530001
075400                                                                  07540001
075500     INITIALIZE DCLTSHPTPO.                                       07550001
075600                                                                  07560001
075700     EXEC SQL                                                     07570001
075800          SELECT SHIPT_ID                                         07580001
075900          INTO   :SHPTPO-SHIPT-ID                                 07590001
076000          FROM   TSHPTPO                                          07600001
076100          WHERE  PO_NBR         = :DK-PO-NBR                      07610001
076200            AND  REC_SEQ_NBR    = :SU044-NEW-REC-SEQ-NBR          07620001
076300            AND  PRIM_SHIPT_IND = 'Y'                             07630001
076400     END-EXEC.                                                    07640001
076500                                                                  07650001
076600     EVALUATE TRUE                                                07660001
076700         WHEN SQLCODE = ZERO                                      07670001
076800             MOVE SHPTPO-SHIPT-ID  TO SU044-NEW-SHIP              07680001
076900         WHEN SQLCODE = +100                                      07690001
077000             CONTINUE                                             07700001
077100         WHEN SQLCODE = -904                                      07710001
077200         WHEN SQLCODE = -911                                      07720001
077300              move '0600'  to  PV-CSSL-PARA                       07730090
077400              perform 8110-WRITE-suws044-TO-CSSL                  07740079
077500                                                                  07750076
077600             MOVE '0600-SELECT-SHIPT-ID-NEW'                      07760001
077700                             TO DP013-PARAGRAPH                   07770001
077800             MOVE 'SUKUT705 - SELECT SHIPT ID  '                  07780001
077900                             TO DP013-MESSAGE-TEXT(1)             07790001
078000             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 07800001
078100             STRING 'PO NBR: '         DELIMITED BY SIZE          07810001
078200                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          07820001
078300                           INTO DP013-MESSAGE-TEXT(2)             07830001
078400             MOVE SU044-NEW-REC-SEQ-NBR                           07840001
078500                             TO PV-DISPLAY-RCVR-SEQ-NBR           07850001
078600             STRING 'RECV SEQ: '       DELIMITED BY SIZE          07860001
078700                 PV-DISPLAY-RCVR-SEQ-NBR                          07870001
078800                                       DELIMITED BY SIZE          07880001
078900                           INTO DP013-MESSAGE-TEXT(4)             07890001
079000             MOVE SQLCA      TO DP013-SQLCA                       07900001
079100             MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME(1)           07910001
079200             SET DP013-DB2-ABEND                                  07920001
079300                             TO TRUE                              07930001
079400             SET DP013-ROLLBACK                                   07940001
079500                             TO TRUE                              07950001
079600             PERFORM 9999-WRITE-CICS-LOG-MSG                      07960001
079700             SET PS-DUMP-TO-LOG       TO TRUE                     07970001
079800             SET SU044-DATABASE-BUSY TO TRUE                      07980001
079900         WHEN SQLWARN0 NOT = SPACES                               07990001
080000         WHEN SQLCODE NOT EQUAL ZERO                              08000001
080100              move '0600'  to  PV-CSSL-PARA                       08010076
080200              perform 8110-WRITE-suws044-TO-CSSL                  08020079
080300                                                                  08030076
080400             MOVE '0600-SELECT-SHIPT-ID-NEW'                      08040001
080500                             TO DP013-PARAGRAPH                   08050001
080600             MOVE 'SUKUT705 - SELECT SHIPT ID  '                  08060001
080700                             TO DP013-MESSAGE-TEXT(1)             08070001
080800             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 08080001
080900             STRING 'PO NBR: '         DELIMITED BY SIZE          08090001
081000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          08100001
081100                           INTO DP013-MESSAGE-TEXT(2)             08110001
081200             MOVE SU044-NEW-REC-SEQ-NBR                           08120001
081300                             TO PV-DISPLAY-RCVR-SEQ-NBR           08130001
081400             STRING 'RECV SEQ: '       DELIMITED BY SIZE          08140001
081500                 PV-DISPLAY-RCVR-SEQ-NBR                          08150001
081600                                       DELIMITED BY SIZE          08160001
081700                           INTO DP013-MESSAGE-TEXT(4)             08170001
081800             MOVE SQLCA      TO DP013-SQLCA                       08180001
081900             MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME(1)           08190001
082000             SET DP013-DB2-ABEND                                  08200001
082100                             TO TRUE                              08210001
082200             SET DP013-ROLLBACK                                   08220001
082300                             TO TRUE                              08230001
082400             PERFORM 9999-WRITE-CICS-LOG-MSG                      08240001
082500             SET PS-DUMP-TO-LOG       TO TRUE                     08250001
082600             SET SU044-INVALID-SQL TO TRUE                        08260001
082700     END-EVALUATE.                                                08270001
082800*                                                                 08280001
082900 0700-SELECT-NEW-SHIP-TRIP.                                       08290001
083000                                                                  08300076
083100     IF  PS-BLD-INTERNAL-TABLE-YES                                08310076
083200         MOVE  '0700'  TO  PT-CURR-PARA                           08320076
083300         PERFORM 8120-INTERNAL-TABLE                              08330085
083400     END-IF.                                                      08340076
083500                                                                  08350076
083600     IF PS-SHOW-DEBUG-INFO                                        08360001
083700         STRING ' SUKUT705-0700-SELECT-NEW-SHIP-TRIP'             08370067
083800         DELIMITED BY SIZE                                        08380001
083900         INTO PV-CICS-MSG-AREA                                    08390001
084000         PERFORM 9990-WRITE-CICS                                  08400001
084100     END-IF.                                                      08410001
084200                                                                  08420001
084300     EXEC SQL                                                     08430001
084400          SELECT TRIP_ID                                          08440001
084500          INTO   :SHIPMT-TRIP-ID                                  08450001
084600          FROM   TSHIPMT                                          08460001
084700          WHERE  SHIPT_ID       = :SU044-NEW-SHIP                 08470001
084800     END-EXEC.                                                    08480001
084900                                                                  08490001
085000     EVALUATE TRUE                                                08500001
085100         WHEN SQLCODE = ZERO                                      08510001
085200              CONTINUE                                            08520001
085300         WHEN SQLCODE = +100                                      08530001
085400             CONTINUE                                             08540001
085500         WHEN SQLCODE = -904                                      08550001
085600         WHEN SQLCODE = -911                                      08560001
085700              move '0700'  to  PV-CSSL-PARA                       08570076
085800              perform 8110-WRITE-suws044-TO-CSSL                  08580079
085900                                                                  08590076
086000             MOVE SU044-NEW-SHIP TO PV-DISPLAY-SHIPMT-ID          08600001
086100             MOVE '0700-SELECT-NEW-SHIP-TRIP'                     08610001
086200                             TO DP013-PARAGRAPH                   08620001
086300             MOVE 'SUKUT705 - SELECT SHIPT ID  '                  08630001
086400                             TO DP013-MESSAGE-TEXT(1)             08640001
086500             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 08650001
086600             STRING 'PO NBR: '         DELIMITED BY SIZE          08660001
086700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          08670001
086800                           INTO DP013-MESSAGE-TEXT(2)             08680001
086900             MOVE DK-RCVR-SEQ-NBR                                 08690001
087000                             TO PV-DISPLAY-RCVR-SEQ-NBR           08700001
087100             STRING 'RECV SEQ: '       DELIMITED BY SIZE          08710001
087200                 PV-DISPLAY-RCVR-SEQ-NBR                          08720001
087300                                       DELIMITED BY SIZE          08730001
087400                'NEW SHIPMT ID'    DELIMITED BY SIZE              08740001
087500                 PV-DISPLAY-SHIPMT-ID                             08750001
087600                                       DELIMITED BY SIZE          08760001
087700                           INTO DP013-MESSAGE-TEXT(3)             08770001
087800             MOVE SQLCA      TO DP013-SQLCA                       08780001
087900             MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME(1)           08790001
088000             SET DP013-DB2-ABEND                                  08800001
088100                             TO TRUE                              08810001
088200             SET DP013-ROLLBACK                                   08820001
088300                             TO TRUE                              08830001
088400             PERFORM 9999-WRITE-CICS-LOG-MSG                      08840001
088500             SET PS-DUMP-TO-LOG       TO TRUE                     08850001
088600             SET SU044-DATABASE-BUSY TO TRUE                      08860001
088700         WHEN SQLWARN0 NOT = SPACES                               08870001
088800         WHEN SQLCODE NOT EQUAL ZERO                              08880001
088900              move '0700'  to  PV-CSSL-PARA                       08890076
089000              perform 8110-WRITE-suws044-TO-CSSL                  08900079
089100                                                                  08910076
089200             MOVE '0700-SELECT-NEW-SHIP-TRIP'                     08920001
089300                             TO DP013-PARAGRAPH                   08930001
089400             MOVE 'SUKUT705 - SELECT SHIPT ID  '                  08940001
089500                             TO DP013-MESSAGE-TEXT(1)             08950001
089600             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 08960001
089700             STRING 'PO NBR: '         DELIMITED BY SIZE          08970001
089800                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          08980001
089900                           INTO DP013-MESSAGE-TEXT(2)             08990001
090000             MOVE DK-RCVR-SEQ-NBR                                 09000001
090100                             TO PV-DISPLAY-RCVR-SEQ-NBR           09010001
090200             STRING 'RECV SEQ: '       DELIMITED BY SIZE          09020001
090300                 PV-DISPLAY-RCVR-SEQ-NBR                          09030001
090400                                       DELIMITED BY SIZE          09040001
090500              'NEW SHIPMT ID'    DELIMITED BY SIZE                09050001
090600                 PV-DISPLAY-SHIPMT-ID                             09060001
090700                                       DELIMITED BY SIZE          09070001
090800                           INTO DP013-MESSAGE-TEXT(4)             09080001
090900             MOVE SQLCA      TO DP013-SQLCA                       09090001
091000             MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME(1)           09100001
091100             SET DP013-DB2-ABEND                                  09110001
091200                             TO TRUE                              09120001
091300             SET DP013-ROLLBACK                                   09130001
091400                             TO TRUE                              09140001
091500             PERFORM 9999-WRITE-CICS-LOG-MSG                      09150001
091600             SET PS-DUMP-TO-LOG       TO TRUE                     09160001
091700             SET SU044-INVALID-SQL TO TRUE                        09170001
091800     END-EVALUATE.                                                09180001
091900*-----------------------------------------------------------------09190001
092000 0800-CHK-FOR-COMMIT-PRCSS.                                       09200045
092100                                                                  09210076
092200     IF  PS-BLD-INTERNAL-TABLE-YES                                09220076
092300         MOVE  '0800'  TO  PT-CURR-PARA                           09230076
092400         PERFORM 8120-INTERNAL-TABLE                              09240083
092500     END-IF.                                                      09250076
092600                                                                  09260076
092700     MOVE +0  TO PV-COMMIT-THRSHLD.                               09270045
092800                                                                  09280045
092900     IF PS-SHOW-DEBUG-INFO                                        09290045
093000         STRING ' SUKUT705-0800-CHK-FOR-COMMIT-PRCSS '            09300067
093100         DELIMITED BY SIZE                                        09310045
093200         INTO PV-CICS-MSG-AREA                                    09320045
093300         PERFORM 9990-WRITE-CICS                                  09330045
093400     END-IF.                                                      09340045
093500                                                                  09350045
093600     EXEC SQL                                                     09360045
093700         SELECT                                                   09370045
093800                INT(D.ATTR_ELEM_NBR)  AS COMMIT_COUNT             09380046
093900         INTO :PV-COMMIT-THRSHLD                                  09390045
094000         FROM WST_INTGRTN_TYP   A                                 09400045
094100            , WST_ATTR_DEFN   B                                   09410045
094200            , WST_ATTR_ELEM   C                                   09420045
094300            , WST_ATTR_ELEM   D                                   09430045
094400         WHERE A.INTGRTN_TYP_CDE    =  'DETACHCOMT'               09440045
094500           AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE          09450045
094600           AND B.ATTR_DEFN_SEQ_NBR  =  1                          09460045
094700           AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE          09470045
094800           AND C.ATTR_DEFN_SEQ_NBR  =  1                          09480045
094900           AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE          09490045
095000           AND D.ATTR_DEFN_SEQ_NBR  =  2                          09500045
095100           AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR        09510045
095200           AND INT(C.ATTR_ELEM_NBR)  = :DK-PO-NBR                 09520045
095300           AND INT(C.ATTR_ELEM_NBR)  >  0                         09530045
095400          with ur                                                 09540086
095500     END-EXEC.                                                    09550045
095600                                                                  09560045
095700     EVALUATE TRUE                                                09570045
095800         WHEN SQLCODE = ZERO                                      09580045
095900            IF PS-SHOW-DEBUG-INFO                                 09590047
096000                MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR              09600047
096100                MOVE PV-COMMIT-THRSHLD TO PV-DISP-CMT-CNT         09610047
096200                STRING ' SUKUT705-COMMIT PO NBR : '               09620047
096300                            DELIMITED BY SIZE                     09630047
096400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          09640047
096500                 ' COMMIT COUNT ' PV-DISP-CMT-CNT                 09650049
096600                            DELIMITED BY SIZE                     09660047
096700                           INTO PV-CICS-MSG-AREA                  09670047
096800                PERFORM 9990-WRITE-CICS                           09680047
096900            END-IF                                                09690050
097000         WHEN SQLCODE = +100                                      09700047
097100              MOVE +0  TO PV-COMMIT-THRSHLD                       09710051
097200         WHEN SQLCODE = -904                                      09720047
097300         WHEN SQLCODE = -911                                      09730047
097400              move '0800'  to  PV-CSSL-PARA                       09740076
097500              perform 8110-WRITE-suws044-TO-CSSL                  09750079
097600                                                                  09760076
097700             MOVE '0800-CHK-FOR-COMMIT-PRCSS'                     09770047
097800                             TO DP013-PARAGRAPH                   09780047
097900             MOVE 'SUKUT705 - SELECT COMMIT PARM '                09790047
098000                             TO DP013-MESSAGE-TEXT(1)             09800047
098100             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 09810047
098200             STRING 'PO NBR: '         DELIMITED BY SIZE          09820047
098300                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          09830047
098400                           INTO DP013-MESSAGE-TEXT(2)             09840047
098500             MOVE DK-RCVR-SEQ-NBR                                 09850047
098600                             TO PV-DISPLAY-RCVR-SEQ-NBR           09860047
098700             STRING 'RECV SEQ: '       DELIMITED BY SIZE          09870047
098800                 PV-DISPLAY-RCVR-SEQ-NBR                          09880047
098900                                       DELIMITED BY SIZE          09890047
099000                           INTO DP013-MESSAGE-TEXT(3)             09900047
099100             MOVE SQLCA      TO DP013-SQLCA                       09910047
099200             MOVE 'WST_ATTR_ELEM'                                 09920047
099300                             TO DP013-DB2-TABLE-NAME(1)           09930047
099400             SET DP013-DB2-ABEND                                  09940047
099500                             TO TRUE                              09950047
099600             SET DP013-ROLLBACK                                   09960047
099700                             TO TRUE                              09970047
099800             PERFORM 9999-WRITE-CICS-LOG-MSG                      09980047
099900             SET PS-DUMP-TO-LOG       TO TRUE                     09990047
100000             SET SU044-DATABASE-BUSY TO TRUE                      10000047
100100         WHEN SQLWARN0 NOT = SPACES                               10010047
100200         WHEN SQLCODE NOT EQUAL ZERO                              10020047
100300              move '0800'  to  PV-CSSL-PARA                       10030076
100400              perform 8110-WRITE-suws044-TO-CSSL                  10040079
100500                                                                  10050076
100600             MOVE '0800-CHK-FOR-COMMIT-PRCSS'                     10060076
100700                             TO DP013-PARAGRAPH                   10070047
100800             MOVE 'SUKUT705 - SELECT SHIPT ID  '                  10080047
100900                             TO DP013-MESSAGE-TEXT(1)             10090047
101000             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 10100047
101100             STRING 'PO NBR: '         DELIMITED BY SIZE          10110047
101200                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          10120047
101300                           INTO DP013-MESSAGE-TEXT(2)             10130047
101400             MOVE DK-RCVR-SEQ-NBR                                 10140047
101500                             TO PV-DISPLAY-RCVR-SEQ-NBR           10150047
101600             STRING 'RECV SEQ: '       DELIMITED BY SIZE          10160047
101700                 PV-DISPLAY-RCVR-SEQ-NBR                          10170047
101800                                       DELIMITED BY SIZE          10180047
101900                           INTO DP013-MESSAGE-TEXT(4)             10190047
102000             MOVE SQLCA      TO DP013-SQLCA                       10200047
102100             MOVE 'WST_ATTR_ELEM'                                 10210047
102200                             TO DP013-DB2-TABLE-NAME(1)           10220047
102300             SET DP013-DB2-ABEND                                  10230047
102400                             TO TRUE                              10240047
102500             SET DP013-ROLLBACK                                   10250047
102600                             TO TRUE                              10260047
102700             PERFORM 9999-WRITE-CICS-LOG-MSG                      10270047
102800             SET PS-DUMP-TO-LOG       TO TRUE                     10280047
102900             SET SU044-INVALID-SQL TO TRUE                        10290047
103000     END-EVALUATE.                                                10300047
103100*-----------------------------------------------------------------10310047
103200*----------------------------------------------------------------*10320047
103300*-----------------------------------------------------------------10330047
103400 1000-PROCESS-PKSLIP.                                             10340047
103500                                                                  10350076
103600     IF  PS-BLD-INTERNAL-TABLE-YES                                10360076
103700         MOVE  '1000'  TO  PT-CURR-PARA                           10370076
103800         PERFORM 8120-INTERNAL-TABLE                              10380083
103900     END-IF.                                                      10390076
104000                                                                  10400076
104100     IF PS-SHOW-DEBUG-INFO                                        10410047
104200         STRING ' SUKUT705-1000-PROCESS-PKSLIP   '                10420067
104300         DELIMITED BY SIZE                                        10430047
104400         INTO PV-CICS-MSG-AREA                                    10440047
104500         PERFORM 9990-WRITE-CICS                                  10450047
104600         MOVE SU044-COMM-AREA                                     10460047
104700           TO PV-CICS-MSG-AREA                                    10470047
104800         PERFORM 9990-WRITE-CICS                                  10480047
104900     END-IF.                                                      10490047
105000     SET SU044-CREATE-FA-RCVR TO TRUE                             10500045
105100                                                                  10510001
105200      IF PS-SHOW-DEBUG-INFO                                       10520050
105300          MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                    10530050
105400          MOVE PV-COMMIT-COUNT   TO PV-DISP-CMT-CNT               10540050
105500          STRING ' SUKUT705-COMMIT PO NBR : '                     10550050
105600                      DELIMITED BY SIZE                           10560050
105700           PV-DISPLAY-PO-NBR     DELIMITED BY SIZE                10570050
105800           ' COMMIT COUNT ' PV-DISP-CMT-CNT                       10580050
105900                      DELIMITED BY SIZE                           10590050
106000                     INTO PV-CICS-MSG-AREA                        10600050
106100          PERFORM 9990-WRITE-CICS                                 10610050
106200     END-IF.                                                      10620050
106300                                                                  10630050
106400**GB 12/12/07  BEG                                                10640056
106500     IF PV-COMMIT-THRSHLD   > +0                                  10650045
106600        IF PV-COMMIT-COUNT  > PV-COMMIT-THRSHLD                   10660045
106700           PERFORM 9995-SYNCPOINT                                 10670045
106800           MOVE +0  TO PV-COMMIT-COUNT                            10680045
106900        END-IF                                                    10690055
107000     END-IF                                                       10700045
107100**GB 12/12/07  END                                                10710056
107200                                                                  10720045
107300     IF SU044-SRC-VERIFICATION                                    10730001
107400        PERFORM 1100-SELECT-PKSLIP-REC-SEQ                        10740001
107500     ELSE                                                         10750001
107600        PERFORM 8200-CHECK-OPER-HANDLING                          10760099
107700        PERFORM 1550-CHCK-FA-PKSLP-FOR-TRLR                       10770001
107800        IF PS-FA-PKSL-NOT-EXISTS                                  10780001
107900           PERFORM 1100-SELECT-PKSLIP-REC-SEQ                     10790001
108000           IF PS-FA-PKSL-NOT-EXISTS                               10800016
108100              PERFORM 1561-CHCK-CI-RCVR-FOR-TRLR                  10810017
108200           END-IF                                                 10820017
108300           IF PS-FA-PKSL-NOT-EXISTS                               10830038
108400              IF SU044-OPER-UNT-ID = SU044-CRTN-OPER-UNT-ID       10840038
108500                 SET PS-MISDRCT-CRTN-EXISTS-NO TO TRUE            10850041
108600              ELSE                                                10860038
108700                 IF SU044-RCVR-PBS                                10870043
108800                    SET PS-MISDRCT-CRTN-EXISTS-YES   TO TRUE      10880043
108900                    PERFORM 1575-MISDIRECT-RCVR-ON-TRLR           10890043
109000                 ELSE                                             10900044
109100                    SET PS-MISDRCT-CRTN-EXISTS-NO TO TRUE         10910044
109200                 END-IF                                           10920043
109300              END-IF                                              10930038
109400           END-IF                                                 10940042
109500        END-IF                                                    10950001
109600     END-IF                                                       10960001
109700                                                                  10970001
109800     IF SU044-ORIG-REC-SEQ-NBR > 0                                10980001
109900        PERFORM 1400-SEL-SHIPMT-BOL                               10990001
110000        IF SHIPMT-PRO-NBR > SPACE                                 11000001
110100           PERFORM 1410-SEL-INPKSU-SEQ                            11010001
110200        ELSE                                                      11020001
110300           PERFORM 1500-SEL-PKSLIP-BOL-SEQ                        11030001
110400        END-IF                                                    11040001
110500     ELSE                                                         11050001
110600        PERFORM 1500-SEL-PKSLIP-BOL-SEQ                           11060001
110700     END-IF                                                       11070001
110800                                                                  11080001
110900     IF SU044-ORIG-REC-SEQ-NBR = 0                                11090001
111000       IF SU044-FA-PKSLIP-CREATE AND PS-MISDRCT-CRTN-EXISTS-NO    11100041
111100          SET PS-NO-FA-RCVR-EXISTS-ON-TRLR TO TRUE                11110001
111200          PERFORM 1555-CHCK-FA-RCVR-FOR-TRLR                      11120001
111300          IF PS-FA-RCVR-EXISTS-ON-TRLR                            11130001
111400             PERFORM 1600-UPDATE-AUTO-FA-PKSLIP                   11140001
111500          ELSE                                                    11150001
111600             PERFORM 7000-LINK-RCVR-CRE-SUKUT703                  11160001
111700             PERFORM 1600-UPDATE-AUTO-FA-PKSLIP                   11170001
111800          END-IF                                                  11180001
111900       ELSE                                                       11190001
112000          IF PS-MISDRCT-CRTN-EXISTS-NO                            11200041
112100             PERFORM 1560-CHCK-CI-RCVR-FOR-TRLR                   11210041
112200          END-IF                                                  11220041
112300          IF PS-CI-RCVR-EXISTS-ON-TRLR                            11230001
112400             PERFORM 1600-UPDATE-AUTO-FA-PKSLIP                   11240001
112500          ELSE                                                    11250001
112600             IF PS-MISDRCT-CRTN-EXISTS-NO                         11260041
112700                SET SU044-CREATE-CHECK-IN-RCVR TO TRUE            11270021
112800                PERFORM 7000-LINK-RCVR-CRE-SUKUT703               11280021
112900                PERFORM 1600-UPDATE-AUTO-FA-PKSLIP                11290021
113000             ELSE                                                 11300021
113100                IF PS-FA-PKSL-EXISTS                              11310029
113200                   SET SU044-DETACH-ONLY TO TRUE                  11320029
113300                ELSE                                              11330029
113400                   MOVE SU044-CRTN-OPER-UNT-ID TO                 11340040
113500                                            DK-OPER-UNT-ID        11350040
113600                   PERFORM 1200-SEL-PKSLIP-REC-SEQ                11360040
113700                   IF PS-PO-RCVR-FA-PKSLIP-NO                     11370040
113800                      PERFORM 7000-LINK-RCVR-CRE-SUKUT703         11380040
113900                   END-IF                                         11390040
114000                   SET SU044-CREATE-PKSLIP TO  TRUE               11400029
114100                END-IF                                            11410029
114200                PERFORM 7100-LINK-SUKUT704                        11420024
114300             END-IF                                               11430024
114400          END-IF                                                  11440024
114500       END-IF                                                     11450024
114600     ELSE                                                         11460024
114700       IF PS-FA-PKSL-EXISTS                                       11470024
114800          PERFORM 1150-SELECT-PKSLIP-ORG-OPER                     11480024
114900          IF PKSLIP-OPER-UNT-ID   = SU044-CRTN-OPER-UNT-ID        11490024
115000            IF SU044-NEW-REC-SEQ-NBR = 0                          11500024
115100               IF SU044-SRC-VERIFICATION                          11510024
115200                  SET SU044-DETACH-ONLY TO TRUE                   11520024
115300                  PERFORM 7100-LINK-SUKUT704                      11530024
115400               ELSE                                               11540024
115500                  PERFORM 7000-LINK-RCVR-CRE-SUKUT703             11550024
115600                  PERFORM 1601-UPDATE-OPEN-PKSLIP                 11560024
115700                  SET SU044-DETACH-ONLY TO TRUE                   11570024
115800                  PERFORM 7100-LINK-SUKUT704                      11580024
115900               END-IF                                             11590024
116000            ELSE                                                  11600024
116100               SET SU044-DETACH-ONLY TO TRUE                      11610035
116200               PERFORM 7100-LINK-SUKUT704                         11620035
116300            END-IF                                                11630001
116400          ELSE                                                    11640001
116500*CRTN OPER ID DOES NOT MATCH PKSLIP OPER FOUND                    11650001
116600            IF SU044-NEW-REC-SEQ-NBR = 0                          11660001
116700               IF SU044-SRC-VERIFICATION                          11670001
116800                  SET SU044-DETACH-ONLY TO TRUE                   11680001
116900                  PERFORM 7100-LINK-SUKUT704                      11690001
117000               ELSE                                               11700001
117100                  PERFORM 7000-LINK-RCVR-CRE-SUKUT703             11710001
117200                  PERFORM 1601-UPDATE-OPEN-PKSLIP                 11720012
117300                  SET SU044-CREATE-PKSLIP TO TRUE                 11730001
117400                  PERFORM 7100-LINK-SUKUT704                      11740001
117500               END-IF                                             11750001
117600            ELSE                                                  11760001
117700               PERFORM 1570-CK-RCVR-ON-CURR-TRLR                  11770001
117800               IF PS-MISDIRECT-RCVR-EXISTS-YES                    11780001
117900                  SET SU044-DETACH-ONLY TO TRUE                   11790001
118000                  PERFORM 7100-LINK-SUKUT704                      11800001
118100               ELSE                                               11810001
118200                  SET SU044-CREATE-PKSLIP TO TRUE                 11820001
118300                  PERFORM 7100-LINK-SUKUT704                      11830001
118400               END-IF                                             11840001
118500            END-IF                                                11850001
118600          END-IF                                                  11860001
118700       ELSE                                                       11870001
118800*NO NON-TRANSC F/A PKSLIP EXIST                                   11880001
118900          IF SU044-SRC-VERIFICATION                               11890001
119000             SET SU044-CREATE-PKSLIP TO TRUE                      11900001
119100             PERFORM 7100-LINK-SUKUT704                           11910001
119200          ELSE                                                    11920001
119300             IF PS-MISDRCT-CRTN-EXISTS-YES                        11930041
119400                 MOVE SU044-CRTN-OPER-UNT-ID TO DK-OPER-UNT-ID    11940041
119500             END-IF                                               11950037
119600             PERFORM 1200-SEL-PKSLIP-REC-SEQ                      11960001
119700             IF PS-PO-RCVR-FA-PKSLIP-NO                           11970001
119800                PERFORM 7000-LINK-RCVR-CRE-SUKUT703               11980001
119900             END-IF                                               11990001
120000             SET SU044-CREATE-PKSLIP TO TRUE                      12000001
120100             PERFORM 7100-LINK-SUKUT704                           12010001
120200          END-IF                                                  12020001
120300       END-IF                                                     12030001
120400     END-IF.                                                      12040001
120500                                                                  12050001
120600*************************************************************     12060005
120700* 1100-SELECT-PKSLIP-REC-SEQ.                               *     12070001
120800*  IS THERE A LEFT OVER PACKSLIP THAT CAN BE USED           *     12080012
120900*                                                           *     12090012
121000*************************************************************     12100005
121100 1100-SELECT-PKSLIP-REC-SEQ.                                      12110001
121200                                                                  12120076
121300     IF  PS-BLD-INTERNAL-TABLE-YES                                12130076
121400         MOVE  '1100'  TO  PT-CURR-PARA                           12140076
121500         PERFORM 8120-INTERNAL-TABLE                              12150083
121600     END-IF.                                                      12160076
121700                                                                  12170076
121800     IF PS-SHOW-DEBUG-INFO                                        12180001
121900         STRING ' SUKUT705-1100-SELECT-PKSLIP-REC-SEQ'            12190067
122000         DELIMITED BY SIZE                                        12200001
122100         INTO PV-CICS-MSG-AREA                                    12210001
122200         PERFORM 9990-WRITE-CICS                                  12220001
122300     END-IF.                                                      12230001
122400                                                                  12240001
122500     EXEC SQL                                                     12250001
122600         SELECT REC_SEQ_NBR                                       12260001
122700               ,SEQ_NBR                                           12270001
122800          INTO :PKSLIP-REC-SEQ-NBR                                12280001
122900             , :PKSLIP-SEQ-NBR                                    12290001
123000           FROM TPKSLIP                                           12300001
123100          WHERE PO_NBR             =  :DK-PO-NBR                  12310001
123200            AND OPER_UNT_ID        =  :DK-OPER-UNT-ID             12320001
123300            AND STR_DEST_NBR       =  :DK-STR-DEST-NBR            12330001
123400            AND REC_SEQ_NBR        =  0                           12340001
123500            AND CRE_SRC_CDE        = 'FA'                         12350001
123600            AND VER_STAT_CDE       = 'A'                          12360001
123700            AND PKSL_STAT_CDE      = 'IN'                         12370001
123800     END-EXEC.                                                    12380001
123900                                                                  12390001
124000     EVALUATE TRUE                                                12400001
124100         WHEN SQLCODE = ZERO                                      12410001
124200         WHEN SQLCODE = -811                                      12420004
124300             SET PS-FA-PKSL-EXISTS TO TRUE                        12430001
124400             MOVE PKSLIP-REC-SEQ-NBR TO SU044-NEW-REC-SEQ-NBR     12440001
124500             MOVE PKSLIP-SEQ-NBR     TO SU044-NEW-PKSL-SEQ-NBR    12450001
124600             IF SU044-SRC-CHECKIN                                 12460001
124700                PERFORM 1110-SEL-SCAN-DIFF-TRIP                   12470001
124800             END-IF                                               12480001
124900         WHEN SQLCODE = +100                                      12490001
125000             SET PS-FA-PKSL-NOT-EXISTS      TO TRUE               12500001
125100* DMH 6/4/13 BEGIN                                                12510068
125200             IF  SU044-SRC-VERIFICATION                           12520068
125300                 PERFORM 1130-SELECT-FA-PKSL-ORIG-OPER            12530071
125400             END-IF                                               12540068
125500* DMH 6/4/13 END                                                  12550068
125600         WHEN SQLWARN0 NOT = SPACES                               12560001
125700         WHEN SQLCODE NOT EQUAL ZERO                              12570001
125800              move '1100'  to  PV-CSSL-PARA                       12580076
125900              perform 8110-WRITE-suws044-TO-CSSL                  12590079
126000                                                                  12600076
126100             MOVE '1100-SELECT-PKSLIP-REC-SEQ'                    12610001
126200                             TO DP013-PARAGRAPH                   12620001
126300             MOVE 'SUKUT705 - GET PKSLIP REC SEQ'                 12630001
126400                             TO DP013-MESSAGE-TEXT(1)             12640001
126500             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 12650001
126600             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        12660001
126700             MOVE DK-STR-DEST-NBR TO PV-DISPLAY-DEST-OPER         12670001
126800             STRING 'PO NBR: '         DELIMITED BY SIZE          12680001
126900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          12690001
127000                    'OPER: '           DELIMITED BY SIZE          12700001
127100               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          12710001
127200                    'STORE: '          DELIMITED BY SIZE          12720001
127300               PV-DISPLAY-DEST-OPER    DELIMITED BY SIZE          12730001
127400                           INTO DP013-MESSAGE-TEXT(2)             12740001
127500             MOVE SQLCA      TO DP013-SQLCA                       12750001
127600             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           12760001
127700             SET DP013-DB2-ABEND                                  12770001
127800                             TO TRUE                              12780001
127900             SET DP013-ROLLBACK                                   12790001
128000                             TO TRUE                              12800001
128100             PERFORM 9999-WRITE-CICS-LOG-MSG                      12810001
128200             SET PS-DUMP-TO-LOG       TO TRUE                     12820001
128300             SET SU044-INVALID-SQL TO TRUE                        12830001
128400     END-EVALUATE.                                                12840001
128500                                                                  12850066
128600     IF PS-SHOW-DEBUG-INFO                                        12860066
128700         MOVE DK-PO-NBR              TO  PV-DISPLAY-PO-NBR        12870066
128800         MOVE DK-OPER-UNT-ID         TO  PV-DISPLAY-OPER-UNT-ID   12880066
128900         MOVE DK-STR-DEST-NBR        TO  PV-DISPLAY-DEST-OPER     12890066
129000         MOVE SQLCODE                TO  PV-DISPLAY-SQLCODE       12900066
129100         STRING   ' SUKUT705-1100-'                               12910066
129200                  ' PO:'                                          12920066
129300                  PV-DISPLAY-PO-NBR                               12930066
129400                  ' OPER:'                                        12940066
129500                  PV-DISPLAY-OPER-UNT-ID                          12950066
129600                  ' DEST-OPER:'                                   12960066
129700                  PV-DISPLAY-DEST-OPER                            12970066
129800                  ' SQL:'                                         12980066
129900                  PV-DISPLAY-SQLCODE                              12990066
130000                  DELIMITED BY SIZE                               13000066
130100                                  INTO PV-CICS-MSG-AREA           13010066
130200         PERFORM 9990-WRITE-CICS                                  13020066
130300     END-IF.                                                      13030066
130400                                                                  13040001
130500*************************************************************     13050005
130600* 1110-SEL-SCAN-DIFF-TRIP                                   *     13060001
130700*  ARE THERE ANY CARTONS SCANNED AGAINST THE PACKSLIP TO A  *     13070012
130800*  DIFFERENT TRAILER THAT WE ARE CURRENTLY WORKING WITH?    *     13080012
130900*************************************************************     13090005
131000 1110-SEL-SCAN-DIFF-TRIP.                                         13100001
131100                                                                  13110076
131200     IF  PS-BLD-INTERNAL-TABLE-YES                                13120076
131300         MOVE  '1110'  TO  PT-CURR-PARA                           13130076
131400         PERFORM 8120-INTERNAL-TABLE                              13140083
131500     END-IF.                                                      13150076
131600                                                                  13160001
131700     IF PS-SHOW-DEBUG-INFO                                        13170001
131800         STRING ' SUKUT705-1110-SEL-SCAN-DIFF-TRIP '              13180067
131900         DELIMITED BY SIZE                                        13190001
132000         INTO PV-CICS-MSG-AREA                                    13200001
132100         PERFORM 9990-WRITE-CICS                                  13210001
132200     END-IF.                                                      13220001
132300                                                                  13230001
132400     MOVE ZEROES TO PV-DB2-SHUNLO-SCN-CNT.                        13240001
132500                                                                  13250001
132600     EXEC SQL                                                     13260001
132700         SELECT COUNT(*)                                          13270001
132800          INTO :PV-DB2-SHUNLO-SCN-CNT                             13280001
132900           FROM TINPKSU A                                         13290001
133000              , TSHUNLO B                                         13300001
133100          WHERE PO_NBR             =  :DK-PO-NBR                  13310001
133200            AND A.SEQ_NBR          =  :PKSLIP-SEQ-NBR             13320001
133300            AND A.SHIPT_UNT_ID     =   B.SHIPT_UNT_ID             13330001
133400            AND B.SCN_LOC_ID       =  'RECV'                      13340001
133500            AND B.TRIP_ID          ^= :SU044-TRIP-ID              13350001
133600     END-EXEC.                                                    13360001
133700                                                                  13370001
133800     EVALUATE TRUE                                                13380001
133900         WHEN SQLCODE = ZERO                                      13390001
134000             IF PV-DB2-SHUNLO-SCN-CNT > 0                         13400001
134100                SET PS-FA-PKSL-NOT-EXISTS      TO TRUE            13410001
134200             ELSE                                                 13420012
134300                SET SU044-CREATE-CHECK-IN-RCVR TO TRUE            13430001
134400             END-IF                                               13440001
134500         WHEN SQLWARN0 NOT = SPACES                               13450001
134600         WHEN SQLCODE NOT EQUAL ZERO                              13460001
134700              move '1110'  to  PV-CSSL-PARA                       13470076
134800              perform 8110-WRITE-suws044-TO-CSSL                  13480079
134900                                                                  13490076
135000             MOVE '1110-SEL-SCAN-DIFF-TRIP '                      13500001
135100                             TO DP013-PARAGRAPH                   13510001
135200             MOVE 'SUKUT705 - CHECK CRTN ON DIFF TRIP '           13520001
135300                             TO DP013-MESSAGE-TEXT(1)             13530001
135400             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 13540001
135500             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        13550001
135600             MOVE DK-STR-DEST-NBR TO PV-DISPLAY-DEST-OPER         13560001
135700             STRING 'PO NBR: '         DELIMITED BY SIZE          13570001
135800                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          13580001
135900                    'OPER: '           DELIMITED BY SIZE          13590001
136000                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          13600001
136100                    'STORE:  '         DELIMITED BY SIZE          13610001
136200                PV-DISPLAY-DEST-OPER   DELIMITED BY SIZE          13620001
136300                           INTO DP013-MESSAGE-TEXT(2)             13630001
136400             MOVE SQLCA      TO DP013-SQLCA                       13640001
136500             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           13650001
136600             SET DP013-DB2-ABEND                                  13660001
136700                             TO TRUE                              13670001
136800             SET DP013-ROLLBACK                                   13680001
136900                             TO TRUE                              13690001
137000             PERFORM 9999-WRITE-CICS-LOG-MSG                      13700001
137100             SET PS-DUMP-TO-LOG       TO TRUE                     13710001
137200             SET SU044-INVALID-SQL TO TRUE                        13720001
137300     END-EVALUATE.                                                13730001
137400                                                                  13740001
137500                                                                  13750068
137600*************************************************************     13760068
137700* 1130-SELECT-FA-PKSL-ORIG-OPER                             *     13770068
137800*                                                           *     13780068
137900* THIS PARAGRAPH IS ONLY TO BE PERFORMED WHEN CALLED BY     *     13790068
138000* VERIFICATION AND THE CARTONS ARE BEING DETACHED.          *     13800068
138100* IF THE CARTONS ARE FA - THE CARTONS BEING DETACHED SHOULD *     13810068
138200* BE ATTACHED TO A PACKSLIP USING THE OPER_UNT_ID ON THE    *     13820068
138300* ORIGINAL PACKSLIP                                         *     13830068
138400* EX: CARTONS ARE ON RECEIVER FOR 826          (CRE OPER)   *     13840068
138500*     CARTONS ARE ACTUALLY BEING PROCESSED 860 (CURR OPER)  *     13850068
138600*     WHEN CARTONS THAT ARE NOT CHECKED IN ARE DETACHED     *     13860068
138700*     FROM THE RECEIVER - THE NEW PACKSLIP SHOULD HAVE THE  *     13870068
138800*     826 OPER NOT 860 OPER                                 *     13880068
138900*                                                           *     13890068
139000* DMH - 6/4/13 ADDED                                        *     13900068
139100*************************************************************     13910068
139200 1130-SELECT-FA-PKSL-ORIG-OPER.                                   13920071
139300                                                                  13930076
139400     IF  PS-BLD-INTERNAL-TABLE-YES                                13940076
139500         MOVE  '1130'  TO  PT-CURR-PARA                           13950076
139600         PERFORM 8120-INTERNAL-TABLE                              13960083
139700     END-IF.                                                      13970076
139800                                                                  13980076
139900     IF PS-SHOW-DEBUG-INFO                                        13990068
140000         STRING ' SUKUT705-1130-SELECT-FA-PKSL-ORIG-OPER'         14000071
140100         DELIMITED BY SIZE                                        14010068
140200         INTO PV-CICS-MSG-AREA                                    14020068
140300         PERFORM 9990-WRITE-CICS                                  14030068
140400     END-IF.                                                      14040068
140500                                                                  14050068
140600     EXEC SQL                                                     14060068
140700         SELECT REC_SEQ_NBR                                       14070068
140800               ,SEQ_NBR                                           14080068
140900          INTO :PKSLIP-REC-SEQ-NBR                                14090068
141000             , :PKSLIP-SEQ-NBR                                    14100068
141100           FROM TPKSLIP                                           14110068
141200          WHERE PO_NBR             =  :DK-PO-NBR                  14120068
141300            AND OPER_UNT_ID        =  :PKSLIP-OPER-UNT-ID         14130068
141400            AND STR_DEST_NBR       =  :DK-STR-DEST-NBR            14140068
141500            AND REC_SEQ_NBR        =  0                           14150068
141600            AND CRE_SRC_CDE        = 'FA'                         14160068
141700            AND VER_STAT_CDE       = 'A'                          14170068
141800            AND PKSL_STAT_CDE      = 'IN'                         14180068
141900     END-EXEC.                                                    14190068
142000                                                                  14200068
142100     EVALUATE TRUE                                                14210068
142200         WHEN SQLCODE = ZERO                                      14220068
142300         WHEN SQLCODE = -811                                      14230068
142400             SET PS-FA-PKSL-EXISTS TO TRUE                        14240068
142500             MOVE PKSLIP-REC-SEQ-NBR TO SU044-NEW-REC-SEQ-NBR     14250068
142600             MOVE PKSLIP-SEQ-NBR     TO SU044-NEW-PKSL-SEQ-NBR    14260068
142700         WHEN SQLCODE = +100                                      14270068
142800             SET PS-FA-PKSL-NOT-EXISTS      TO TRUE               14280068
142900         WHEN SQLWARN0 NOT = SPACES                               14290068
143000         WHEN SQLCODE NOT EQUAL ZERO                              14300068
143100              move '1130'  to  PV-CSSL-PARA                       14310076
143200              perform 8110-WRITE-suws044-TO-CSSL                  14320079
143300                                                                  14330076
143400             MOVE '1130-SELECT-FA-PKSL-ORIG-OPER'                 14340071
143500                             TO DP013-PARAGRAPH                   14350068
143600             MOVE 'SUKUT705 - GET FA PACKSLIP ORIG OPER'          14360068
143700                             TO DP013-MESSAGE-TEXT(1)             14370068
143800             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 14380068
143900             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        14390068
144000             MOVE PKSLIP-OPER-UNT-ID TO PV-DISP-ORIG-OPER         14400068
144100             MOVE DK-STR-DEST-NBR TO PV-DISPLAY-DEST-OPER         14410068
144200             STRING 'PO NBR:'                                     14420068
144300                 PV-DISPLAY-PO-NBR                                14430068
144400                    ' OPER: '                                     14440068
144500               PV-DISPLAY-OPER-UNT-ID                             14450068
144600                    ' ORIG OPER:'                                 14460069
144700               PV-DISP-ORIG-OPER                                  14470068
144800                    ' STORE:'                                     14480068
144900               PV-DISPLAY-DEST-OPER    DELIMITED BY SIZE          14490068
145000                           INTO DP013-MESSAGE-TEXT(2)             14500068
145100             MOVE SQLCA      TO DP013-SQLCA                       14510068
145200             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           14520068
145300             SET DP013-DB2-ABEND                                  14530068
145400                             TO TRUE                              14540068
145500             SET DP013-ROLLBACK                                   14550068
145600                             TO TRUE                              14560068
145700             PERFORM 9999-WRITE-CICS-LOG-MSG                      14570068
145800             SET PS-DUMP-TO-LOG       TO TRUE                     14580068
145900             SET SU044-INVALID-SQL TO TRUE                        14590068
146000     END-EVALUATE.                                                14600068
146100                                                                  14610068
146200     IF PS-SHOW-DEBUG-INFO                                        14620068
146300         MOVE DK-PO-NBR              TO  PV-DISPLAY-PO-NBR        14630068
146400         MOVE DK-OPER-UNT-ID         TO  PV-DISPLAY-OPER-UNT-ID   14640068
146500         MOVE DK-STR-DEST-NBR        TO  PV-DISPLAY-DEST-OPER     14650068
146600         MOVE SQLCODE                TO  PV-DISPLAY-SQLCODE       14660068
146700         STRING   ' SUKUT705-1130-'                               14670068
146800                  ' PO:'          PV-DISPLAY-PO-NBR               14680069
146900                  ' OPER:'        PV-DISPLAY-OPER-UNT-ID          14690069
147000                  ' DEST-OPER:'   PV-DISPLAY-DEST-OPER            14700069
147100                  ' SQL:'         PV-DISPLAY-SQLCODE              14710069
147200                                  DELIMITED BY SIZE               14720069
147300                             INTO PV-CICS-MSG-AREA                14730069
147400         PERFORM 9990-WRITE-CICS                                  14740068
147500     END-IF.                                                      14750068
147600                                                                  14760068
147700                                                                  14770068
147800*************************************************************     14780068
147900*                                                           *     14790068
148000*                                                           *     14800068
148100*************************************************************     14810068
148200 1150-SELECT-PKSLIP-ORG-OPER.                                     14820068
148300                                                                  14830076
148400     IF  PS-BLD-INTERNAL-TABLE-YES                                14840076
148500         MOVE  '1150'  TO  PT-CURR-PARA                           14850076
148600         PERFORM 8120-INTERNAL-TABLE                              14860083
148700     END-IF.                                                      14870076
148800                                                                  14880076
148900     IF PS-SHOW-DEBUG-INFO                                        14890001
149000         STRING ' SUKUT705-1150-SELECT-PKSLIP-ORG-OPER'           14900067
149100         DELIMITED BY SIZE                                        14910001
149200         INTO PV-CICS-MSG-AREA                                    14920001
149300         PERFORM 9990-WRITE-CICS                                  14930001
149400     END-IF.                                                      14940001
149500                                                                  14950001
149600     EXEC SQL                                                     14960001
149700         SELECT OPER_UNT_ID                                       14970001
149800         INTO :PKSLIP-OPER-UNT-ID                                 14980001
149900           FROM TPKSLIP A                                         14990001
150000          WHERE A.PO_NBR         =  :DK-PO-NBR                    15000001
150100            AND A.SEQ_NBR        =  :SU044-NEW-PKSL-SEQ-NBR       15010001
150200            AND A.VER_STAT_CDE   =  'A'                           15020001
150300     END-EXEC.                                                    15030001
150400                                                                  15040001
150500     EVALUATE TRUE                                                15050001
150600         WHEN SQLCODE = ZERO                                      15060001
150700             CONTINUE                                             15070001
150800         WHEN SQLWARN0 NOT = SPACES                               15080001
150900         WHEN SQLCODE NOT EQUAL ZERO                              15090001
151000              move '1150'  to  PV-CSSL-PARA                       15100076
151100              perform 8110-WRITE-suws044-TO-CSSL                  15110079
151200                                                                  15120076
151300             MOVE '1150-SELECT-PKSLIP-ORG-OPER'                   15130001
151400                             TO DP013-PARAGRAPH                   15140001
151500             MOVE 'SUKUT705 - GET ORGN OPER UNT '                 15150001
151600                             TO DP013-MESSAGE-TEXT(1)             15160001
151700             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 15170001
151800             MOVE SU044-NEW-PKSL-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ 15180001
151900             STRING 'PO NBR: '         DELIMITED BY SIZE          15190001
152000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          15200001
152100                    'PKSL SEQ'         DELIMITED BY SIZE          15210001
152200             PV-DISPLAY-PKSLIP-SEQ     DELIMITED BY SIZE          15220001
152300                           INTO DP013-MESSAGE-TEXT(2)             15230001
152400             MOVE SQLCA      TO DP013-SQLCA                       15240001
152500             MOVE 'TINPKSU'  TO DP013-DB2-TABLE-NAME(1)           15250001
152600             SET DP013-DB2-ABEND                                  15260001
152700                             TO TRUE                              15270001
152800             SET DP013-ROLLBACK                                   15280001
152900                             TO TRUE                              15290001
153000             PERFORM 9999-WRITE-CICS-LOG-MSG                      15300001
153100             SET PS-DUMP-TO-LOG       TO TRUE                     15310001
153200             SET SU044-INVALID-SQL TO TRUE                        15320001
153300     END-EVALUATE.                                                15330001
153400                                                                  15340001
153500                                                                  15350001
153600 1200-SEL-PKSLIP-REC-SEQ.                                         15360001
153700                                                                  15370076
153800     IF  PS-BLD-INTERNAL-TABLE-YES                                15380076
153900         MOVE  '1200'  TO  PT-CURR-PARA                           15390090
154000         PERFORM 8120-INTERNAL-TABLE                              15400083
154100     END-IF.                                                      15410076
154200                                                                  15420076
154300     IF PS-SHOW-DEBUG-INFO                                        15430001
154400         STRING ' SUKUT705-1200-SEL-PKSLIP-REC-SEQ'               15440067
154500         DELIMITED BY SIZE                                        15450001
154600         INTO PV-CICS-MSG-AREA                                    15460001
154700         PERFORM 9990-WRITE-CICS                                  15470001
154800     END-IF.                                                      15480001
154900                                                                  15490001
155000     EXEC SQL                                                     15500001
155100         SELECT DISTINCT                                          15510001
155200                A.REC_SEQ_NBR                                     15520001
155300          INTO :PKSLIP-REC-SEQ-NBR                                15530001
155400           FROM TPKSLIP A                                         15540001
155500              , TSHPTPO B                                         15550001
155600              , TSHIPMT C                                         15560001
155700          WHERE A.PO_NBR             =  :DK-PO-NBR                15570001
155800            AND A.PO_NBR             =  B.PO_NBR                  15580001
155900            AND A.REC_SEQ_NBR        =  B.REC_SEQ_NBR             15590001
156000            AND A.OPER_UNT_ID        =  :DK-OPER-UNT-ID           15600001
156100            AND B.PRIM_SHIPT_IND      =  'Y'                      15610001
156200            AND B.SHIPT_ID           =  C.SHIPT_ID                15620001
156300            AND A.CRE_SRC_CDE        = 'FA'                       15630001
156400            AND A.VER_STAT_CDE       = 'A'                        15640001
156500            AND A.PKSL_STAT_CDE      = 'IN'                       15650001
156600            AND A.REC_SEQ_NBR        >  0                         15660001
156700            AND C.TRIP_ID            = :SU044-TRIP-ID             15670001
156800     END-EXEC.                                                    15680086
156900                                                                  15690001
157000     EVALUATE TRUE                                                15700001
157100         WHEN SQLCODE = ZERO                                      15710001
157200         WHEN SQLCODE = -811                                      15720001
157300             MOVE PKSLIP-REC-SEQ-NBR    TO SU044-NEW-REC-SEQ-NBR  15730001
157400             SET PS-PO-RCVR-FA-PKSLIP-YES TO TRUE                 15740001
157500         WHEN SQLCODE = +100                                      15750001
157600             SET PS-PO-RCVR-FA-PKSLIP-NO  TO TRUE                 15760001
157700         WHEN SQLCODE = -904                                      15770001
157800         WHEN SQLCODE = -911                                      15780001
157900              move '1200'  to  PV-CSSL-PARA                       15790076
158000              perform 8110-WRITE-suws044-TO-CSSL                  15800079
158100                                                                  15810076
158200             MOVE '1200-SEL-PKSLIP-REC-SEQ'                       15820001
158300                             TO DP013-PARAGRAPH                   15830001
158400             MOVE 'SUKUT705 - GET PBS PKSLIP REC SEQ'             15840001
158500                             TO DP013-MESSAGE-TEXT(1)             15850001
158600             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 15860001
158700             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        15870001
158800             MOVE SU044-TRIP-ID  TO PV-DISPLAY-INBND-TRIP-ID      15880001
158900             STRING 'PO NBR: '         DELIMITED BY SIZE          15890001
159000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          15900001
159100                    'OPER:'            DELIMITED BY SIZE          15910001
159200              PV-DISPLAY-OPER-UNT-ID   DELIMITED BY SIZE          15920001
159300                    'TRIP: '           DELIMITED BY SIZE          15930001
159400              PV-DISPLAY-INBND-TRIP-ID DELIMITED BY SIZE          15940001
159500                           INTO DP013-MESSAGE-TEXT(2)             15950001
159600             MOVE SQLCA      TO DP013-SQLCA                       15960001
159700             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           15970001
159800             SET DP013-DB2-ABEND                                  15980001
159900                             TO TRUE                              15990001
160000             SET DP013-ROLLBACK                                   16000001
160100                             TO TRUE                              16010001
160200             PERFORM 9999-WRITE-CICS-LOG-MSG                      16020001
160300             SET PS-DUMP-TO-LOG       TO TRUE                     16030001
160400             SET SU044-DATABASE-BUSY TO TRUE                      16040001
160500         WHEN SQLWARN0 NOT = SPACES                               16050001
160600         WHEN SQLCODE NOT EQUAL ZERO                              16060001
160700              move '1200'  to  PV-CSSL-PARA                       16070076
160800              perform 8110-WRITE-suws044-TO-CSSL                  16080079
160900                                                                  16090076
161000             MOVE '1200-SEL-PKSLIP-REC-SEQ'                       16100001
161100                             TO DP013-PARAGRAPH                   16110001
161200             MOVE 'SUKUT705 - GET PBS PKSLIP REC SEQ'             16120001
161300                             TO DP013-MESSAGE-TEXT(1)             16130001
161400             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 16140001
161500             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        16150001
161600             MOVE SU044-TRIP-ID  TO PV-DISPLAY-INBND-TRIP-ID      16160001
161700             STRING 'PO NBR: '         DELIMITED BY SIZE          16170001
161800                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          16180001
161900                    'OPER:'            DELIMITED BY SIZE          16190001
162000              PV-DISPLAY-OPER-UNT-ID   DELIMITED BY SIZE          16200001
162100                    'TRIP: '           DELIMITED BY SIZE          16210001
162200              PV-DISPLAY-INBND-TRIP-ID DELIMITED BY SIZE          16220001
162300                           INTO DP013-MESSAGE-TEXT(2)             16230001
162400             MOVE SQLCA      TO DP013-SQLCA                       16240001
162500             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           16250001
162600             SET DP013-DB2-ABEND                                  16260001
162700                             TO TRUE                              16270001
162800             SET DP013-ROLLBACK                                   16280001
162900                             TO TRUE                              16290001
163000             PERFORM 9999-WRITE-CICS-LOG-MSG                      16300001
163100             SET PS-DUMP-TO-LOG       TO TRUE                     16310001
163200             SET SU044-INVALID-SQL TO TRUE                        16320001
163300     END-EVALUATE.                                                16330001
163400                                                                  16340001
163500                                                                  16350001
163600*************************************************************     16360012
163700* 1400-SEL-SHIPMT-BOL.                                      *     16370001
163800*  SELECT THE PRO AND BOL FROM THE ORIGINAL RECEIVERS       *     16380012
163900*  SHIPMENT.   THIS IS USED TO CREATE A NEW PACKSLIP.       *     16390012
164000*************************************************************     16400005
164100 1400-SEL-SHIPMT-BOL.                                             16410001
164200                                                                  16420076
164300     IF  PS-BLD-INTERNAL-TABLE-YES                                16430076
164400         MOVE  '1400'  TO  PT-CURR-PARA                           16440076
164500         PERFORM 8120-INTERNAL-TABLE                              16450083
164600     END-IF.                                                      16460076
164700                                                                  16470001
164800     IF PS-SHOW-DEBUG-INFO                                        16480001
164900         STRING ' SUKUT705-1400-SEL-SHIPMT-BOL   '                16490067
165000         DELIMITED BY SIZE                                        16500001
165100         INTO PV-CICS-MSG-AREA                                    16510001
165200         PERFORM 9990-WRITE-CICS                                  16520001
165300     END-IF.                                                      16530001
165400                                                                  16540001
165500* 12-01-2011 CHRISTINE TWIEHAUS WR40574 ADDED CAN BELOW           16550057
165600     EXEC SQL                                                     16560001
165700       SELECT  B.PRO_NBR                                          16570001
165800             , B.BOL_NBR                                          16580001
165900             , B.CARR_AUTH_ID                                     16590057
166000       INTO   :SHIPMT-PRO-NBR                                     16600001
166100            , :SHIPMT-BOL-NBR                                     16610001
166200            , :SHIPMT-CARR-AUTH-ID                                16620057
166300       FROM    TSHPTPO A                                          16630001
166400              ,TSHIPMT B                                          16640001
166500       WHERE A.PO_NBR         = :DK-PO-NBR                        16650001
166600         AND A.REC_SEQ_NBR    = :SU044-ORIG-REC-SEQ-NBR           16660001
166700         AND A.PRIM_SHIPT_IND = 'Y'                               16670001
166800         AND A.SHIPT_ID       = B.SHIPT_ID                        16680001
166900     END-EXEC.                                                    16690001
167000                                                                  16700001
167100     EVALUATE TRUE                                                16710001
167200         WHEN SQLCODE = ZERO                                      16720064
167300            MOVE SHIPMT-BOL-NBR  TO SU044-ORIG-BOL-NBR            16730001
167400            MOVE SHIPMT-PRO-NBR  TO SU044-ORIG-PRO-NBR            16740001
167500            MOVE SHIPMT-CARR-AUTH-ID TO SU044-CARR-AUTH-ID        16750057
167600         WHEN SQLCODE = +100                                      16760001
167700              CONTINUE                                            16770001
167800         WHEN SQLCODE = -904                                      16780001
167900         WHEN SQLCODE = -911                                      16790001
168000              move '1400'  to  PV-CSSL-PARA                       16800076
168100              perform 8110-WRITE-suws044-TO-CSSL                  16810079
168200                                                                  16820076
168300             MOVE '1400-SEL-SHIPMT-BOL  '                         16830001
168400                             TO DP013-PARAGRAPH                   16840001
168500             MOVE 'SUKUT705 - GET SHIPMT PRO BOL '                16850001
168600                             TO DP013-MESSAGE-TEXT(1)             16860001
168700             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 16870001
168800             MOVE SU044-ORIG-REC-SEQ-NBR                          16880001
168900                        TO PV-DISPLAY-RCVR-SEQ-NBR                16890001
169000             STRING 'PO NBR: '         DELIMITED BY SIZE          16900001
169100                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          16910001
169200                    'REC SEQ '         DELIMITED BY SIZE          16920001
169300               PV-DISPLAY-RCVR-SEQ-NBR DELIMITED BY SIZE          16930001
169400                           INTO DP013-MESSAGE-TEXT(2)             16940001
169500             MOVE SQLCA      TO DP013-SQLCA                       16950001
169600             MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME(1)           16960001
169700             SET DP013-DB2-ABEND                                  16970001
169800                             TO TRUE                              16980001
169900             SET DP013-ROLLBACK                                   16990001
170000                             TO TRUE                              17000001
170100             PERFORM 9999-WRITE-CICS-LOG-MSG                      17010001
170200             SET PS-DUMP-TO-LOG       TO TRUE                     17020001
170300             SET SU044-DATABASE-BUSY TO TRUE                      17030001
170400         WHEN SQLWARN0 NOT = SPACES                               17040001
170500         WHEN SQLCODE NOT EQUAL ZERO                              17050001
170600              move '1400'  to  PV-CSSL-PARA                       17060090
170700              perform 8110-WRITE-suws044-TO-CSSL                  17070079
170800                                                                  17080076
170900              move '1400'  to  PV-CSSL-PARA                       17090090
171000                               DP013-PARAGRAPH                    17100082
171100             MOVE 'SUKUT705 - GET SHIPMT BOL  '                   17110001
171200                             TO DP013-MESSAGE-TEXT(1)             17120001
171300             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 17130001
171400             MOVE SU044-ORIG-REC-SEQ-NBR                          17140001
171500                        TO PV-DISPLAY-RCVR-SEQ-NBR                17150001
171600             STRING 'PO NBR: '         DELIMITED BY SIZE          17160001
171700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          17170001
171800                    'REC SEQ:'         DELIMITED BY SIZE          17180001
171900              PV-DISPLAY-RCVR-SEQ-NBR  DELIMITED BY SIZE          17190001
172000                           INTO DP013-MESSAGE-TEXT(2)             17200001
172100             MOVE SQLCA      TO DP013-SQLCA                       17210001
172200             MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME(1)           17220001
172300             SET DP013-DB2-ABEND                                  17230001
172400                             TO TRUE                              17240001
172500             SET DP013-ROLLBACK                                   17250001
172600                             TO TRUE                              17260001
172700             PERFORM 9999-WRITE-CICS-LOG-MSG                      17270001
172800             SET PS-DUMP-TO-LOG       TO TRUE                     17280001
172900             SET SU044-INVALID-SQL TO TRUE                        17290001
173000     END-EVALUATE.                                                17300001
173100                                                                  17310001
173200                                                                  17320001
173300*************************************************************     17330012
173400* 1410-SEL-INPKSU-SEQ.                                      *     17340001
173500*  SELECT THE PACKSLIP SEQ NUMBER THE CARTON IS CURRENTLY   *     17350012
173600*  ATTACHED TO.                                             *     17360012
173700*************************************************************     17370005
173800 1410-SEL-INPKSU-SEQ.                                             17380001
173900                                                                  17390076
174000     IF  PS-BLD-INTERNAL-TABLE-YES                                17400076
174100         MOVE  '1410'  TO  PT-CURR-PARA                           17410076
174200         PERFORM 8120-INTERNAL-TABLE                              17420083
174300     END-IF.                                                      17430076
174400                                                                  17440001
174500     IF PS-SHOW-DEBUG-INFO                                        17450001
174600         STRING ' SUKUT705-1410-SEL-PKSLIP-SEQ '                  17460067
174700         DELIMITED BY SIZE                                        17470001
174800         INTO PV-CICS-MSG-AREA                                    17480001
174900         PERFORM 9990-WRITE-CICS                                  17490001
175000     END-IF.                                                      17500001
175100                                                                  17510001
175200     EXEC SQL                                                     17520001
175300         SELECT A.SEQ_NBR                                         17530001
175400          INTO :PKSLIP-SEQ-NBR                                    17540001
175500          FROM TINPKSU A                                          17550001
175600          WHERE A.PO_NBR          = :DK-PO-NBR                    17560001
175700            AND A.SHIPT_UNT_ID    = :SU044-SHIPT-UNT-ID           17570001
175800     END-EXEC.                                                    17580001
175900                                                                  17590001
176000     EVALUATE TRUE                                                17600001
176100         WHEN SQLCODE = ZERO                                      17610001
176200            MOVE PKSLIP-SEQ-NBR  TO SU044-ORIG-PKSL-SEQ-NBR       17620001
176300         WHEN SQLCODE = +100                                      17630001
176400              CONTINUE                                            17640001
176500         WHEN SQLCODE = -904                                      17650001
176600         WHEN SQLCODE = -911                                      17660001
176700              move '1410'  to  PV-CSSL-PARA                       17670076
176800              perform 8110-WRITE-suws044-TO-CSSL                  17680079
176900                                                                  17690076
177000             MOVE '1410-SEL-INPKSU-SEQ'                           17700001
177100                             TO DP013-PARAGRAPH                   17710001
177200             MOVE 'SUKUT705 - GET PBS INPKSU SEQ NBR'             17720001
177300                             TO DP013-MESSAGE-TEXT(1)             17730001
177400             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 17740001
177500             MOVE SU044-SHIPT-UNT-ID TO PV-DISPLAY-CARTON         17750001
177600             STRING 'PO NBR: '         DELIMITED BY SIZE          17760001
177700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          17770001
177800                    'CARTON: '         DELIMITED BY SIZE          17780001
177900                 PV-DISPLAY-CARTON     DELIMITED BY SIZE          17790001
178000                           INTO DP013-MESSAGE-TEXT(2)             17800001
178100             MOVE SQLCA      TO DP013-SQLCA                       17810001
178200             MOVE 'TINPKSU'  TO DP013-DB2-TABLE-NAME(1)           17820001
178300             SET DP013-DB2-ABEND                                  17830001
178400                             TO TRUE                              17840001
178500             SET DP013-ROLLBACK                                   17850001
178600                             TO TRUE                              17860001
178700             PERFORM 9999-WRITE-CICS-LOG-MSG                      17870001
178800             SET PS-DUMP-TO-LOG       TO TRUE                     17880001
178900             SET SU044-DATABASE-BUSY TO TRUE                      17890001
179000         WHEN SQLWARN0 NOT = SPACES                               17900001
179100         WHEN SQLCODE NOT EQUAL ZERO                              17910001
179200              move '1410'  to  PV-CSSL-PARA                       17920076
179300              perform 8110-WRITE-suws044-TO-CSSL                  17930079
179400                                                                  17940076
179500             MOVE '1410-SEL-INPKSU-SEQ '                          17950001
179600                             TO DP013-PARAGRAPH                   17960001
179700             MOVE 'SUKUT705 - GET INPKSU SEQ NBR '                17970001
179800                             TO DP013-MESSAGE-TEXT(1)             17980001
179900             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 17990001
180000             MOVE SU044-SHIPT-UNT-ID TO PV-DISPLAY-CARTON         18000001
180100             STRING 'PO NBR: '         DELIMITED BY SIZE          18010001
180200                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          18020001
180300                    'CARTON: '         DELIMITED BY SIZE          18030001
180400                 PV-DISPLAY-CARTON     DELIMITED BY SIZE          18040001
180500                           INTO DP013-MESSAGE-TEXT(2)             18050001
180600             MOVE SQLCA      TO DP013-SQLCA                       18060001
180700             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           18070001
180800             SET DP013-DB2-ABEND                                  18080001
180900                             TO TRUE                              18090001
181000             SET DP013-ROLLBACK                                   18100001
181100                             TO TRUE                              18110001
181200             PERFORM 9999-WRITE-CICS-LOG-MSG                      18120001
181300             SET PS-DUMP-TO-LOG       TO TRUE                     18130001
181400             SET SU044-INVALID-SQL TO TRUE                        18140001
181500     END-EVALUATE.                                                18150001
181600                                                                  18160001
181700 1500-SEL-PKSLIP-BOL-SEQ.                                         18170001
181800                                                                  18180076
181900     IF  PS-BLD-INTERNAL-TABLE-YES                                18190076
182000         MOVE  '1500'  TO  PT-CURR-PARA                           18200076
182100         PERFORM 8120-INTERNAL-TABLE                              18210083
182200     END-IF.                                                      18220076
182300                                                                  18230001
182400     IF PS-SHOW-DEBUG-INFO                                        18240001
182500         STRING ' SUKUT705-1500-SEL-PKSLIP-BOL-SEQ '              18250067
182600         DELIMITED BY SIZE                                        18260001
182700         INTO PV-CICS-MSG-AREA                                    18270001
182800         PERFORM 9990-WRITE-CICS                                  18280001
182900     END-IF.                                                      18290001
183000                                                                  18300001
183100     EXEC SQL                                                     18310001
183200         SELECT A.SEQ_NBR                                         18320001
183300              , A.BOL_NBR                                         18330001
183400              , A.PRO_NBR                                         18340001
183500          INTO :PKSLIP-SEQ-NBR                                    18350001
183600             , :PKSLIP-BOL-NBR                                    18360001
183700             , :PKSLIP-PRO-NBR                                    18370001
183800          FROM TPKSLIP A                                          18380001
183900             , TINPKSU B                                          18390001
184000          WHERE A.PO_NBR          = :DK-PO-NBR                    18400001
184100            AND A.PO_NBR          =  B.PO_NBR                     18410001
184200            AND A.SEQ_NBR         =  B.SEQ_NBR                    18420001
184300            AND B.SHIPT_UNT_ID    = :SU044-SHIPT-UNT-ID           18430001
184400            AND A.VER_STAT_CDE    =  'A'                          18440001
184500     END-EXEC.                                                    18450001
184600                                                                  18460001
184700     EVALUATE TRUE                                                18470001
184800         WHEN SQLCODE = ZERO                                      18480001
184900            MOVE PKSLIP-SEQ-NBR  TO SU044-ORIG-PKSL-SEQ-NBR       18490001
185000            MOVE PKSLIP-BOL-NBR  TO SU044-ORIG-BOL-NBR            18500001
185100            MOVE PKSLIP-PRO-NBR  TO SU044-ORIG-PRO-NBR            18510001
185200         WHEN SQLCODE = +100                                      18520001
185300              CONTINUE                                            18530001
185400         WHEN SQLCODE = -904                                      18540001
185500         WHEN SQLCODE = -911                                      18550001
185600              move '1500'  to  PV-CSSL-PARA                       18560076
185700              perform 8110-WRITE-suws044-TO-CSSL                  18570079
185800                                                                  18580076
185900             MOVE '1500-SEL-PKSLIP-BOL-SEQ   '                    18590001
186000                             TO DP013-PARAGRAPH                   18600001
186100             MOVE 'SUKUT705 - GET PBS PKSLIP BOL SEQ'             18610001
186200                             TO DP013-MESSAGE-TEXT(1)             18620001
186300             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 18630001
186400             MOVE SU044-SHIPT-UNT-ID TO PV-DISPLAY-CARTON         18640001
186500             STRING 'PO NBR: '         DELIMITED BY SIZE          18650001
186600                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          18660001
186700                    'CARTON: '         DELIMITED BY SIZE          18670001
186800                 PV-DISPLAY-CARTON     DELIMITED BY SIZE          18680001
186900                           INTO DP013-MESSAGE-TEXT(2)             18690001
187000             MOVE SQLCA      TO DP013-SQLCA                       18700001
187100             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           18710001
187200             SET DP013-DB2-ABEND                                  18720001
187300                             TO TRUE                              18730001
187400             SET DP013-ROLLBACK                                   18740001
187500                             TO TRUE                              18750001
187600             PERFORM 9999-WRITE-CICS-LOG-MSG                      18760001
187700             SET PS-DUMP-TO-LOG       TO TRUE                     18770001
187800             SET SU044-DATABASE-BUSY TO TRUE                      18780001
187900         WHEN SQLWARN0 NOT = SPACES                               18790001
188000         WHEN SQLCODE NOT EQUAL ZERO                              18800001
188100              move '1500'  to  PV-CSSL-PARA                       18810076
188200              perform 8110-WRITE-suws044-TO-CSSL                  18820079
188300                                                                  18830076
188400             MOVE '1500-SEL-PKSLIP-BOL-SEQ   '                    18840001
188500                             TO DP013-PARAGRAPH                   18850001
188600             MOVE 'SUKUT705 - GET PBS PKSLIP BOL SEQ'             18860001
188700                             TO DP013-MESSAGE-TEXT(1)             18870001
188800             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 18880001
188900             MOVE SU044-SHIPT-UNT-ID TO PV-DISPLAY-CARTON         18890001
189000             STRING 'PO NBR: '         DELIMITED BY SIZE          18900001
189100                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          18910001
189200                    'CARTON: '         DELIMITED BY SIZE          18920001
189300                 PV-DISPLAY-CARTON     DELIMITED BY SIZE          18930001
189400                           INTO DP013-MESSAGE-TEXT(2)             18940001
189500             MOVE SQLCA      TO DP013-SQLCA                       18950001
189600             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           18960001
189700             SET DP013-DB2-ABEND                                  18970001
189800                             TO TRUE                              18980001
189900             SET DP013-ROLLBACK                                   18990001
190000                             TO TRUE                              19000001
190100             PERFORM 9999-WRITE-CICS-LOG-MSG                      19010001
190200             SET PS-DUMP-TO-LOG       TO TRUE                     19020001
190300             SET SU044-INVALID-SQL TO TRUE                        19030001
190400     END-EVALUATE.                                                19040001
190500                                                                  19050066
190600                                                                  19060001
190700                                                                  19070001
190800*************************************************************     19080099
190900* 1550-CHCK-FA-PKSLP-FOR-TRLR                               *     19090099
191000* CHANGE BY RPK ON 3/13/2019                                *     19100099
191100*  ADDED LOGIC IN THIS PARAGRAPH TO DEAL WITH ISSUE THAT    *     19110099
191200*  WAS KEEPING CARTONS FROM BEING ATTACHED TO AN EXISTING   *     19120099
191300*  FREE ASTRAY RECEIVER BASED ON THE OPER UNIT ID VALUES    *     19130099
191400*  USED IN THE SQL.  CHANGES MADE TO THE +100 SQL CODE      *     19140099
191500*  LOGIC TO EITHER USE NEW LOGIC TO CHECK PARAGRAPH 1551-   *     19150099
191600*  OR HAVE THE PROGRAM USE THE OLD LOGIC - THIS WAS BASED   *     19160099
191700*  ON THE VALUE OF THE 'FAOPR2' TKRPRPM PARM.               *     19170099
191800*************************************************************     19180099
191900 1550-CHCK-FA-PKSLP-FOR-TRLR.                                     19190099
192000                                                                  19200099
192100     IF  PS-BLD-INTERNAL-TABLE-YES                                19210099
192200         MOVE  '1550'  TO  PT-CURR-PARA                           19220099
192300         PERFORM 8120-INTERNAL-TABLE                              19230099
192400     END-IF.                                                      19240099
192500                                                                  19250099
192600     IF PS-SHOW-DEBUG-INFO                                        19260099
192700         STRING ' SUKUT705-1550-CHCK-FA-PKSLP-FOR-TRLR'           19270099
192800         DELIMITED BY SIZE                                        19280099
192900         INTO PV-CICS-MSG-AREA                                    19290099
193000         PERFORM 9990-WRITE-CICS                                  19300099
193100     END-IF.                                                      19310099
193200                                                                  19320099
193300     EXEC SQL                                                     19330099
193400         SELECT C.REC_SEQ_NBR                                     19340099
193500              , E.SEQ_NBR                                         19350099
193600         INTO   :SHPTPO-REC-SEQ-NBR                               19360099
193700              , :PKSLIP-SEQ-NBR                                   19370099
193800          FROM                                                    19380099
193900                TSHIPMT B                                         19390099
194000              , TSHPTPO C                                         19400099
194100              , TRECEIV D                                         19410099
194200              , TPKSLIP E                                         19420099
194300          WHERE B.TRIP_ID           = :SU044-TRIP-ID              19430099
194400            AND C.PO_NBR            = :SU044-PO                   19440099
194500            AND B.SHIPT_ID          = C.SHIPT_ID                  19450099
194600            AND C.PO_NBR            = D.ORD_NBR                   19460099
194700            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               19470099
194800            AND C.PO_NBR            = E.PO_NBR                    19480099
194900            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               19490099
195000            AND D.VER_STATUS_CDE    = 'A'                         19500099
195100            AND E.VER_STAT_CDE      = 'A'                         19510099
195200            AND E.PKSL_STAT_CDE     = 'IN'                        19520099
195300            AND D.FRE_ASTRA_IND     = 'Y'                         19530099
195400            AND C.PRIM_SHIPT_IND    = 'Y'                         19540099
195500            AND E.OPER_UNT_ID       =  :DK-PKSLIP-OPER-UNT-ID     19550099
195600            AND E.STR_DEST_NBR      =  :DK-STR-DEST-NBR           19560099
195700     END-EXEC.                                                    19570099
195800                                                                  19580099
195900     MOVE SQLCODE TO PV-DISPLAY-SQLCODE-1550.                     19590099
196000                                                                  19600099
196100     EVALUATE TRUE                                                19610099
196200         WHEN SQLCODE = ZERO                                      19620099
196300          MOVE SHPTPO-REC-SEQ-NBR TO SU044-NEW-REC-SEQ-NBR        19630099
196400          MOVE PKSLIP-SEQ-NBR     TO SU044-NEW-PKSL-SEQ-NBR       19640099
196500          SET PS-FA-RCVR-EXISTS-ON-TRLR TO TRUE                   19650099
196600          SET PS-FA-PKSL-EXISTS TO TRUE                           19660099
196700         WHEN SQLCODE = +100                                      19670099
196800            IF  PS-FREE-ASTRAY-OPER-NEW                           19680099
196900                PERFORM 1551-CHCK-FA-PKSLP-FOR-TRLR2              19690099
197000            ELSE                                                  19700099
197100                SET PS-NO-FA-RCVR-EXISTS-ON-TRLR TO TRUE          19710099
197200                SET PS-FA-PKSL-NOT-EXISTS      TO TRUE            19720099
197300            END-IF                                                19730099
197400         WHEN SQLCODE = -811                                      19740099
197500            PERFORM 1570-CK-RCVR-ON-CURR-TRLR                     19750099
197600         WHEN SQLCODE = -904                                      19760099
197700         WHEN SQLCODE = -911                                      19770099
197800              MOVE '1550'  TO  PV-CSSL-PARA                       19780099
197900              PERFORM 8110-WRITE-SUWS044-TO-CSSL                  19790099
198000                                                                  19800099
198100             MOVE '1550-CHCK-FA-PKSLP-FOR-TRLR'                   19810099
198200                             TO DP013-PARAGRAPH                   19820099
198300             MOVE 'SUKUT705 - FA RCVR ON TRAILER  '               19830099
198400                             TO DP013-MESSAGE-TEXT(1)             19840099
198500             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 19850099
198600             MOVE DK-PKSLIP-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID 19860099
198700             MOVE DK-STR-DEST-NBR TO PV-DISPLAY-DEST-OPER         19870099
198800             MOVE SU044-TRIP-ID  TO PV-DISPLAY-INBND-TRIP-ID      19880099
198900             STRING 'PO NBR: '         DELIMITED BY SIZE          19890099
199000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          19900099
199100                    'OPER: '           DELIMITED BY SIZE          19910099
199200               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          19920099
199300                           INTO DP013-MESSAGE-TEXT(2)             19930099
199400             STRING 'STORE: '          DELIMITED BY SIZE          19940099
199500               PV-DISPLAY-DEST-OPER    DELIMITED BY SIZE          19950099
199600                    'TRIP: '           DELIMITED BY SIZE          19960099
199700             PV-DISPLAY-INBND-TRIP-ID  DELIMITED BY SIZE          19970099
199800                           INTO DP013-MESSAGE-TEXT(3)             19980099
199900             MOVE SQLCA      TO DP013-SQLCA                       19990099
200000             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           20000099
200100             SET DP013-DB2-ABEND                                  20010099
200200                             TO TRUE                              20020099
200300             SET DP013-ROLLBACK                                   20030099
200400                             TO TRUE                              20040099
200500             PERFORM 9999-WRITE-CICS-LOG-MSG                      20050099
200600             SET PS-DUMP-TO-LOG       TO TRUE                     20060099
200700             SET SU044-DATABASE-BUSY TO TRUE                      20070099
200800         WHEN SQLWARN0 NOT = SPACES                               20080099
200900         WHEN SQLCODE NOT EQUAL ZERO                              20090099
201000              MOVE '1550'  TO  PV-CSSL-PARA                       20100099
201100              PERFORM 8110-WRITE-SUWS044-TO-CSSL                  20110099
201200                                                                  20120099
201300             MOVE '1550-CHCK-FA-PKSLP-FOR-TRLR'                   20130099
201400                             TO DP013-PARAGRAPH                   20140099
201500             MOVE 'SUKUT705 - FA RCVR ON TRAILER    '             20150099
201600                             TO DP013-MESSAGE-TEXT(1)             20160099
201700             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 20170099
201800             MOVE DK-PKSLIP-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID 20180099
201900             MOVE DK-STR-DEST-NBR TO PV-DISPLAY-DEST-OPER         20190099
202000             MOVE SU044-TRIP-ID  TO PV-DISPLAY-INBND-TRIP-ID      20200099
202100             STRING 'PO NBR: '         DELIMITED BY SIZE          20210099
202200                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          20220099
202300                    'OPER: '           DELIMITED BY SIZE          20230099
202400               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          20240099
202500                           INTO DP013-MESSAGE-TEXT(2)             20250099
202600             STRING 'STORE: '          DELIMITED BY SIZE          20260099
202700               PV-DISPLAY-DEST-OPER    DELIMITED BY SIZE          20270099
202800                    'TRIP: '           DELIMITED BY SIZE          20280099
202900             PV-DISPLAY-INBND-TRIP-ID  DELIMITED BY SIZE          20290099
203000                           INTO DP013-MESSAGE-TEXT(3)             20300099
203100             MOVE SQLCA      TO DP013-SQLCA                       20310099
203200             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           20320099
203300             SET DP013-DB2-ABEND                                  20330099
203400                             TO TRUE                              20340099
203500             SET DP013-ROLLBACK                                   20350099
203600                             TO TRUE                              20360099
203700             PERFORM 9999-WRITE-CICS-LOG-MSG                      20370099
203800             SET PS-DUMP-TO-LOG       TO TRUE                     20380099
203900             SET SU044-INVALID-SQL TO TRUE                        20390099
204000     END-EVALUATE.                                                20400099
204100                                                                  20410099
204200     IF PS-SHOW-DEBUG-INFO                                        20420099
204300         MOVE SU044-PO               TO  PV-DISPLAY-PO-NBR        20430099
204400         MOVE SU044-TRIP-ID          TO  PV-DISPLAY-INBND-TRIP-ID 20440099
204500         MOVE DK-PKSLIP-OPER-UNT-ID  TO  PV-DISPLAY-OPER-UNT-ID   20450099
204600         MOVE DK-STR-DEST-NBR        TO  PV-DISPLAY-DEST-OPER     20460099
204700         MOVE SQLCODE                TO  PV-DISPLAY-SQLCODE       20470099
204800         STRING   ' SUKUT705-1550-'                               20480099
204900                  ' PO:'                                          20490099
205000                  PV-DISPLAY-PO-NBR                               20500099
205100                  ' TRIP:'                                        20510099
205200                  PV-DISPLAY-INBND-TRIP-ID                        20520099
205300                  ' PKSL-OPER:'                                   20530099
205400                  PV-DISPLAY-OPER-UNT-ID                          20540099
205500                  DELIMITED BY SIZE                               20550099
205600                                  INTO PV-CICS-MSG-AREA           20560099
205700         PERFORM 9990-WRITE-CICS                                  20570099
205800         STRING   ' SUKUT705-1550-'                               20580099
205900                  ' DEST-OPER:'                                   20590099
206000                  PV-DISPLAY-DEST-OPER                            20600099
206100                  ' SQL:'                                         20610099
206200                  PV-DISPLAY-SQLCODE-1550                         20620099
206300                  DELIMITED BY SIZE                               20630099
206400                                  INTO PV-CICS-MSG-AREA           20640099
206500         PERFORM 9990-WRITE-CICS                                  20650099
206600     END-IF.                                                      20660099
206700                                                                  20670099
206800 1551-CHCK-FA-PKSLP-FOR-TRLR2.                                    20680099
206900                                                                  20690099
207000     IF  PS-BLD-INTERNAL-TABLE-YES                                20700099
207100         MOVE  '1551'  TO  PT-CURR-PARA                           20710099
207200         PERFORM 8120-INTERNAL-TABLE                              20720099
207300     END-IF.                                                      20730099
207400                                                                  20740099
207500     IF PS-SHOW-DEBUG-INFO                                        20750099
207600         STRING ' SUKUT705-1551-CHCK-FA-PKSLP-FOR-TRLR2'          20760099
207700         DELIMITED BY SIZE                                        20770099
207800         INTO PV-CICS-MSG-AREA                                    20780099
207900         PERFORM 9990-WRITE-CICS                                  20790099
208000     END-IF.                                                      20800099
208100                                                                  20810099
208200     EXEC SQL                                                     20820099
208300         SELECT C.REC_SEQ_NBR                                     20830099
208400              , E.SEQ_NBR                                         20840099
208500         INTO   :SHPTPO-REC-SEQ-NBR                               20850099
208600              , :PKSLIP-SEQ-NBR                                   20860099
208700          FROM                                                    20870099
208800                TSHIPMT B                                         20880099
208900              , TSHPTPO C                                         20890099
209000              , TRECEIV D                                         20900099
209100              , TPKSLIP E                                         20910099
209200          WHERE B.TRIP_ID           = :SU044-TRIP-ID              20920099
209300            AND C.PO_NBR            = :SU044-PO                   20930099
209400            AND B.SHIPT_ID          = C.SHIPT_ID                  20940099
209500            AND C.PO_NBR            = D.ORD_NBR                   20950099
209600            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               20960099
209700            AND D.CURR_OPER_UNT_ID  = :DK-PKSLIP-OPER-UNT-ID      20970099
209800            AND C.PO_NBR            = E.PO_NBR                    20980099
209900            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               20990099
210000            AND D.VER_STATUS_CDE    = 'A'                         21000099
210100            AND E.VER_STAT_CDE      = 'A'                         21010099
210200            AND E.PKSL_STAT_CDE     = 'IN'                        21020099
210300            AND D.FRE_ASTRA_IND     = 'Y'                         21030099
210400            AND C.PRIM_SHIPT_IND    = 'Y'                         21040099
210500            AND E.OPER_UNT_ID       = :DK-CRTN-OPER-UNT-ID        21050099
210600            AND E.STR_DEST_NBR      = :DK-STR-DEST-NBR            21060099
210700     END-EXEC.                                                    21070099
210800                                                                  21080099
210900     MOVE SQLCODE                TO  PV-DISPLAY-SQLCODE-1551.     21090099
211000                                                                  21100099
211100     EVALUATE TRUE                                                21110099
211200         WHEN SQLCODE = ZERO                                      21120099
211300          MOVE SHPTPO-REC-SEQ-NBR TO SU044-NEW-REC-SEQ-NBR        21130099
211400          MOVE PKSLIP-SEQ-NBR     TO SU044-NEW-PKSL-SEQ-NBR       21140099
211500          SET PS-FA-RCVR-EXISTS-ON-TRLR TO TRUE                   21150099
211600          SET PS-FA-PKSL-EXISTS TO TRUE                           21160099
211700         WHEN SQLCODE = +100                                      21170099
211800            SET PS-NO-FA-RCVR-EXISTS-ON-TRLR TO TRUE              21180099
211900            SET PS-FA-PKSL-NOT-EXISTS      TO TRUE                21190099
212000         WHEN SQLCODE = -811                                      21200099
212100            PERFORM 1571-CK-RCVR-ON-CURR-TRLR2                    21210099
212200         WHEN SQLCODE = -904                                      21220099
212300         WHEN SQLCODE = -911                                      21230099
212400              move '1551'  to  PV-CSSL-PARA                       21240099
212500              perform 8110-WRITE-suws044-TO-CSSL                  21250099
212600                                                                  21260099
212700             MOVE '1551-CHCK-FA-PKSLP-FOR-TRLR2'                  21270099
212800                             TO DP013-PARAGRAPH                   21280099
212900             MOVE 'SUKUT705 - FA RCVR ON TRAILER2 '               21290099
213000                             TO DP013-MESSAGE-TEXT(1)             21300099
213100             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 21310099
213200             MOVE DK-PKSLIP-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID 21320099
213300             MOVE DK-CRTN-OPER-UNT-ID TO                          21330099
213400                  PV-DISPLAY-CRTN-OPER-UNT-ID                     21340099
213500             MOVE DK-STR-DEST-NBR TO PV-DISPLAY-DEST-OPER         21350099
213600             MOVE SU044-TRIP-ID  TO PV-DISPLAY-INBND-TRIP-ID      21360099
213700             STRING 'PO NBR: '         DELIMITED BY SIZE          21370099
213800                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          21380099
213900                    'PKSLIP OPER: '    DELIMITED BY SIZE          21390099
214000               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          21400099
214100                           INTO DP013-MESSAGE-TEXT(2)             21410099
214200             STRING 'STORE: '          DELIMITED BY SIZE          21420099
214300               PV-DISPLAY-DEST-OPER    DELIMITED BY SIZE          21430099
214400                    'TRIP: '           DELIMITED BY SIZE          21440099
214500             PV-DISPLAY-INBND-TRIP-ID  DELIMITED BY SIZE          21450099
214600                    'CRTN OPER: '      DELIMITED BY SIZE          21460099
214700             PV-DISPLAY-CRTN-OPER-UNT-ID DELIMITED BY SIZE        21470099
214800                           INTO DP013-MESSAGE-TEXT(3)             21480099
214900             MOVE SQLCA      TO DP013-SQLCA                       21490099
215000             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           21500099
215100             SET DP013-DB2-ABEND                                  21510099
215200                             TO TRUE                              21520099
215300             SET DP013-ROLLBACK                                   21530099
215400                             TO TRUE                              21540099
215500             PERFORM 9999-WRITE-CICS-LOG-MSG                      21550099
215600             SET PS-DUMP-TO-LOG       TO TRUE                     21560099
215700             SET SU044-DATABASE-BUSY TO TRUE                      21570099
215800         WHEN SQLWARN0 NOT = SPACES                               21580099
215900         WHEN SQLCODE NOT EQUAL ZERO                              21590099
216000              move '1551'  to  PV-CSSL-PARA                       21600099
216100              perform 8110-WRITE-suws044-TO-CSSL                  21610099
216200                                                                  21620099
216300             MOVE '1551-CHCK-FA-PKSLP-FOR-TRLR2'                  21630099
216400                             TO DP013-PARAGRAPH                   21640099
216500             MOVE 'SUKUT705 - FA RCVR ON TRAILER2   '             21650099
216600                             TO DP013-MESSAGE-TEXT(1)             21660099
216700             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 21670099
216800             MOVE DK-PKSLIP-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID 21680099
216900             MOVE DK-CRTN-OPER-UNT-ID TO                          21690099
217000                  PV-DISPLAY-CRTN-OPER-UNT-ID                     21700099
217100             MOVE DK-STR-DEST-NBR TO PV-DISPLAY-DEST-OPER         21710099
217200             MOVE SU044-TRIP-ID  TO PV-DISPLAY-INBND-TRIP-ID      21720099
217300             STRING 'PO NBR: '         DELIMITED BY SIZE          21730099
217400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          21740099
217500                    'PKSLIP OPER: '    DELIMITED BY SIZE          21750099
217600               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          21760099
217700                           INTO DP013-MESSAGE-TEXT(2)             21770099
217800             STRING 'STORE: '          DELIMITED BY SIZE          21780099
217900               PV-DISPLAY-DEST-OPER    DELIMITED BY SIZE          21790099
218000                    'TRIP: '           DELIMITED BY SIZE          21800099
218100             PV-DISPLAY-INBND-TRIP-ID  DELIMITED BY SIZE          21810099
218200                    'CRTN OPER: '      DELIMITED BY SIZE          21820099
218300             PV-DISPLAY-CRTN-OPER-UNT-ID DELIMITED BY SIZE        21830099
218400                           INTO DP013-MESSAGE-TEXT(3)             21840099
218500             MOVE SQLCA      TO DP013-SQLCA                       21850099
218600             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           21860099
218700             SET DP013-DB2-ABEND                                  21870099
218800                             TO TRUE                              21880099
218900             SET DP013-ROLLBACK                                   21890099
219000                             TO TRUE                              21900099
219100             PERFORM 9999-WRITE-CICS-LOG-MSG                      21910099
219200             SET PS-DUMP-TO-LOG       TO TRUE                     21920099
219300             SET SU044-INVALID-SQL TO TRUE                        21930099
219400     END-EVALUATE.                                                21940099
219500                                                                  21950099
219600     IF PS-SHOW-DEBUG-INFO                                        21960099
219700         MOVE SU044-PO               TO  PV-DISPLAY-PO-NBR        21970099
219800         MOVE SU044-TRIP-ID          TO  PV-DISPLAY-INBND-TRIP-ID 21980099
219900         MOVE DK-PKSLIP-OPER-UNT-ID  TO  PV-DISPLAY-OPER-UNT-ID   21990099
220000         MOVE DK-CRTN-OPER-UNT-ID    TO                           22000099
220100              PV-DISPLAY-CRTN-OPER-UNT-ID                         22010099
220200         MOVE DK-STR-DEST-NBR        TO  PV-DISPLAY-DEST-OPER     22020099
220300         STRING   ' SUKUT705-1551-'                               22030099
220400                  ' PO:'                                          22040099
220500                  PV-DISPLAY-PO-NBR                               22050099
220600                  ' TRIP:'                                        22060099
220700                  PV-DISPLAY-INBND-TRIP-ID                        22070099
220800                  ' PKSL-OPER:'                                   22080099
220900                  PV-DISPLAY-OPER-UNT-ID                          22090099
221000                  ' DEST-OPER:'                                   22100099
221100                  PV-DISPLAY-DEST-OPER                            22110099
221200                  DELIMITED BY SIZE                               22120099
221300                                  INTO PV-CICS-MSG-AREA           22130099
221400         PERFORM 9990-WRITE-CICS                                  22140099
221500         STRING   ' SUKUT705-1551-'                               22150099
221600                  ' CRTN-OPER:'                                   22160099
221700                  PV-DISPLAY-CRTN-OPER-UNT-ID                     22170099
221800                  ' SQL:'                                         22180099
221900                  PV-DISPLAY-SQLCODE-1551                         22190099
222000                  DELIMITED BY SIZE                               22200099
222100                                  INTO PV-CICS-MSG-AREA           22210099
222200         PERFORM 9990-WRITE-CICS                                  22220099
222300     END-IF.                                                      22230099
222400                                                                  22240099
222500 1555-CHCK-FA-RCVR-FOR-TRLR.                                      22250099
222600                                                                  22260099
222700     IF  PS-BLD-INTERNAL-TABLE-YES                                22270099
222800         MOVE  '1555'  TO  PT-CURR-PARA                           22280099
222900         PERFORM 8120-INTERNAL-TABLE                              22290099
223000     END-IF.                                                      22300099
223100                                                                  22310099
223200     IF PS-SHOW-DEBUG-INFO                                        22320099
223300         STRING ' SUKUT705-1555-CHCK-FA-RCVR-FOR-TRLR'            22330099
223400         DELIMITED BY SIZE                                        22340099
223500         INTO PV-CICS-MSG-AREA                                    22350099
223600         PERFORM 9990-WRITE-CICS                                  22360099
223700     END-IF.                                                      22370099
223800                                                                  22380099
223900     EXEC SQL                                                     22390099
224000         SELECT C.REC_SEQ_NBR                                     22400099
224100              , E.SEQ_NBR                                         22410099
224200         INTO   :SHPTPO-REC-SEQ-NBR                               22420099
224300              , :PKSLIP-SEQ-NBR                                   22430099
224400          FROM                                                    22440099
224500                TSHIPMT B                                         22450099
224600              , TSHPTPO C                                         22460099
224700              , TRECEIV D                                         22470099
224800              , TPKSLIP E                                         22480099
224900          WHERE B.TRIP_ID           = :SU044-TRIP-ID              22490099
225000            AND C.PO_NBR            = :SU044-PO                   22500099
225100            AND B.SHIPT_ID          = C.SHIPT_ID                  22510099
225200            AND C.PO_NBR            = D.ORD_NBR                   22520099
225300            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               22530099
225400            AND C.PO_NBR            = E.PO_NBR                    22540099
225500            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               22550099
225600            AND D.VER_STATUS_CDE    = 'A'                         22560099
225700            AND E.VER_STAT_CDE      = 'A'                         22570099
225800            AND E.PKSL_STAT_CDE     = 'IN'                        22580099
225900            AND D.FRE_ASTRA_IND     = 'Y'                         22590099
226000            AND C.PRIM_SHIPT_IND    = 'Y'                         22600099
226100     END-EXEC.                                                    22610099
226200                                                                  22620099
226300     EVALUATE TRUE                                                22630099
226400         WHEN SQLCODE = ZERO                                      22640099
226500         WHEN SQLCODE = -811                                      22650099
226600          MOVE SHPTPO-REC-SEQ-NBR TO SU044-NEW-REC-SEQ-NBR        22660099
226700          MOVE PKSLIP-SEQ-NBR     TO SU044-NEW-PKSL-SEQ-NBR       22670099
226800          SET PS-FA-RCVR-EXISTS-ON-TRLR TO TRUE                   22680099
226900          SET PS-FA-PKSL-EXISTS TO TRUE                           22690099
227000         WHEN SQLCODE = +100                                      22700099
227100            SET PS-NO-FA-RCVR-EXISTS-ON-TRLR TO TRUE              22710099
227200            SET PS-FA-PKSL-NOT-EXISTS      TO TRUE                22720099
227300         WHEN SQLCODE = -904                                      22730099
227400         WHEN SQLCODE = -911                                      22740099
227500              move '1555'  to  PV-CSSL-PARA                       22750099
227600              perform 8110-WRITE-suws044-TO-CSSL                  22760099
227700                                                                  22770099
227800             MOVE '1555-CHCK-FA-RCVR-FOR-TRLR'                    22780099
227900                             TO DP013-PARAGRAPH                   22790099
228000             MOVE 'SUKUT705 - FA RCVR ON TRAILER  '               22800099
228100                             TO DP013-MESSAGE-TEXT(1)             22810099
228200             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 22820099
228300             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        22830099
228400             MOVE DK-STR-DEST-NBR TO PV-DISPLAY-DEST-OPER         22840099
228500             MOVE SU044-TRIP-ID  TO PV-DISPLAY-INBND-TRIP-ID      22850099
228600             STRING 'PO NBR: '         DELIMITED BY SIZE          22860099
228700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          22870099
228800                    'OPER: '           DELIMITED BY SIZE          22880099
228900               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          22890099
229000                           INTO DP013-MESSAGE-TEXT(2)             22900099
229100             STRING 'STORE: '          DELIMITED BY SIZE          22910099
229200               PV-DISPLAY-DEST-OPER    DELIMITED BY SIZE          22920099
229300                    'TRIP: '           DELIMITED BY SIZE          22930099
229400             PV-DISPLAY-INBND-TRIP-ID  DELIMITED BY SIZE          22940099
229500                           INTO DP013-MESSAGE-TEXT(3)             22950099
229600             MOVE SQLCA      TO DP013-SQLCA                       22960099
229700             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           22970099
229800             SET DP013-DB2-ABEND                                  22980099
229900                             TO TRUE                              22990099
230000             SET DP013-ROLLBACK                                   23000099
230100                             TO TRUE                              23010099
230200             PERFORM 9999-WRITE-CICS-LOG-MSG                      23020099
230300             SET PS-DUMP-TO-LOG       TO TRUE                     23030099
230400             SET SU044-DATABASE-BUSY TO TRUE                      23040099
230500         WHEN SQLWARN0 NOT = SPACES                               23050099
230600         WHEN SQLCODE NOT EQUAL ZERO                              23060099
230700              move '1555'  to  PV-CSSL-PARA                       23070099
230800              perform 8110-WRITE-suws044-TO-CSSL                  23080099
230900                                                                  23090099
231000             MOVE '1555-CHCK-FA-RCVR-FOR-TRLR'                    23100099
231100                             TO DP013-PARAGRAPH                   23110099
231200             MOVE 'SUKUT705 - FA RCVR ON TRAILER    '             23120099
231300                             TO DP013-MESSAGE-TEXT(1)             23130099
231400             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 23140099
231500             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        23150099
231600             MOVE DK-STR-DEST-NBR TO PV-DISPLAY-DEST-OPER         23160099
231700             MOVE SU044-TRIP-ID  TO PV-DISPLAY-INBND-TRIP-ID      23170099
231800             STRING 'PO NBR: '         DELIMITED BY SIZE          23180099
231900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          23190099
232000                    'OPER: '           DELIMITED BY SIZE          23200099
232100               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          23210099
232200                           INTO DP013-MESSAGE-TEXT(2)             23220099
232300             STRING 'STORE: '          DELIMITED BY SIZE          23230099
232400               PV-DISPLAY-DEST-OPER    DELIMITED BY SIZE          23240099
232500                    'TRIP: '           DELIMITED BY SIZE          23250099
232600             PV-DISPLAY-INBND-TRIP-ID  DELIMITED BY SIZE          23260099
232700                           INTO DP013-MESSAGE-TEXT(3)             23270099
232800             MOVE SQLCA      TO DP013-SQLCA                       23280099
232900             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           23290099
233000             SET DP013-DB2-ABEND                                  23300099
233100                             TO TRUE                              23310099
233200             SET DP013-ROLLBACK                                   23320099
233300                             TO TRUE                              23330099
233400             PERFORM 9999-WRITE-CICS-LOG-MSG                      23340099
233500             SET PS-DUMP-TO-LOG       TO TRUE                     23350099
233600             SET SU044-INVALID-SQL TO TRUE                        23360099
233700     END-EVALUATE.                                                23370099
233800                                                                  23380099
233900                                                                  23390099
234000 1560-CHCK-CI-RCVR-FOR-TRLR.                                      23400099
234100                                                                  23410099
234200     IF  PS-BLD-INTERNAL-TABLE-YES                                23420099
234300         MOVE  '1560'  TO  PT-CURR-PARA                           23430099
234400         PERFORM 8120-INTERNAL-TABLE                              23440099
234500     END-IF.                                                      23450099
234600                                                                  23460099
234700     IF PS-SHOW-DEBUG-INFO                                        23470099
234800         STRING ' SUKUT705-1560-CHCK-CI-RCVR-FOR-TRLR'            23480099
234900         DELIMITED BY SIZE                                        23490099
235000         INTO PV-CICS-MSG-AREA                                    23500099
235100         PERFORM 9990-WRITE-CICS                                  23510099
235200     END-IF.                                                      23520099
235300* 03-28-2012 CHRISTINE TWIEHAUS WR40574 ADDED CAN BELOW           23530099
235400                                                                  23540099
235500     EXEC SQL                                                     23550099
235600         SELECT C.REC_SEQ_NBR                                     23560099
235700              , E.SEQ_NBR                                         23570099
235800              , B.CARR_AUTH_ID                                    23580099
235900         INTO   :SHPTPO-REC-SEQ-NBR                               23590099
236000              , :PKSLIP-SEQ-NBR                                   23600099
236100              , :SHIPMT-CARR-AUTH-ID                              23610099
236200          FROM                                                    23620099
236300                TSHIPMT B                                         23630099
236400              , TSHPTPO C                                         23640099
236500              , TRECEIV D                                         23650099
236600              , TPKSLIP E                                         23660099
236700          WHERE B.TRIP_ID           = :SU044-TRIP-ID              23670099
236800            AND C.PO_NBR            = :SU044-PO                   23680099
236900            AND B.SHIPT_ID          = C.SHIPT_ID                  23690099
237000            AND C.PO_NBR            = D.ORD_NBR                   23700099
237100            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               23710099
237200            AND C.PO_NBR            = E.PO_NBR                    23720099
237300            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               23730099
237400            AND D.VER_STATUS_CDE    = 'A'                         23740099
237500            AND E.VER_STAT_CDE      = 'A'                         23750099
237600            AND E.PKSL_STAT_CDE     = 'IN'                        23760099
237700            AND D.CRE_UID           = 'CHECK-IN'                  23770099
237800            AND C.PRIM_SHIPT_IND    = 'Y'                         23780099
237900     END-EXEC.                                                    23790099
238000                                                                  23800099
238100     EVALUATE TRUE                                                23810099
238200         WHEN SQLCODE = ZERO                                      23820099
238300         WHEN SQLCODE = -811                                      23830099
238400          MOVE SHPTPO-REC-SEQ-NBR  TO SU044-NEW-REC-SEQ-NBR       23840099
238500          MOVE PKSLIP-SEQ-NBR      TO SU044-NEW-PKSL-SEQ-NBR      23850099
238600          MOVE SHIPMT-CARR-AUTH-ID TO SU044-CARR-AUTH-ID          23860099
238700          SET PS-CI-RCVR-EXISTS-ON-TRLR                           23870099
238800              PS-FA-PKSL-EXISTS   TO TRUE                         23880099
238900         WHEN SQLCODE = +100                                      23890099
239000            SET PS-NO-CI-RCVR-EXISTS-ON-TRLR TO TRUE              23900099
239100         WHEN SQLCODE = -904                                      23910099
239200         WHEN SQLCODE = -911                                      23920099
239300              move '1560'  to  PV-CSSL-PARA                       23930099
239400              perform 8110-WRITE-suws044-TO-CSSL                  23940099
239500                                                                  23950099
239600             MOVE '1560-CHCK-CI-RCVR-FOR-TRLR'                    23960099
239700                             TO DP013-PARAGRAPH                   23970099
239800             MOVE 'SUKUT705 - CHECKIN RCVR ON TRLR'               23980099
239900                             TO DP013-MESSAGE-TEXT(1)             23990099
240000             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 24000099
240100             MOVE SU044-TRIP-ID TO PV-DISPLAY-INBND-TRIP-ID       24010099
240200             STRING 'PO NBR: '         DELIMITED BY SIZE          24020099
240300                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          24030099
240400                    'TRIP: '           DELIMITED BY SIZE          24040099
240500              PV-DISPLAY-INBND-TRIP-ID DELIMITED BY SIZE          24050099
240600                           INTO DP013-MESSAGE-TEXT(2)             24060099
240700             MOVE SQLCA      TO DP013-SQLCA                       24070099
240800             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           24080099
240900             SET DP013-DB2-ABEND                                  24090099
241000                             TO TRUE                              24100099
241100             SET DP013-ROLLBACK                                   24110099
241200                             TO TRUE                              24120099
241300             PERFORM 9999-WRITE-CICS-LOG-MSG                      24130099
241400             SET PS-DUMP-TO-LOG       TO TRUE                     24140099
241500             SET SU044-DATABASE-BUSY TO TRUE                      24150099
241600         WHEN SQLWARN0 NOT = SPACES                               24160099
241700         WHEN SQLCODE NOT EQUAL ZERO                              24170099
241800              move '1560'  to  PV-CSSL-PARA                       24180099
241900              perform 8110-WRITE-suws044-TO-CSSL                  24190099
242000                                                                  24200099
242100             MOVE '1560-CHCK-CI-RCVR-FOR-TRLR'                    24210099
242200                             TO DP013-PARAGRAPH                   24220099
242300             MOVE 'SUKUT705 - CHECKIN RCVR ON TRLR  '             24230099
242400                             TO DP013-MESSAGE-TEXT(1)             24240099
242500             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 24250099
242600             MOVE SU044-TRIP-ID TO PV-DISPLAY-INBND-TRIP-ID       24260099
242700             STRING 'PO NBR: '         DELIMITED BY SIZE          24270099
242800                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          24280099
242900                    'TRIP: '           DELIMITED BY SIZE          24290099
243000            PV-DISPLAY-INBND-TRIP-ID   DELIMITED BY SIZE          24300099
243100                           INTO DP013-MESSAGE-TEXT(2)             24310099
243200             MOVE SQLCA      TO DP013-SQLCA                       24320099
243300             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           24330099
243400             SET DP013-DB2-ABEND                                  24340099
243500                             TO TRUE                              24350099
243600             SET DP013-ROLLBACK                                   24360099
243700                             TO TRUE                              24370099
243800             PERFORM 9999-WRITE-CICS-LOG-MSG                      24380099
243900             SET PS-DUMP-TO-LOG       TO TRUE                     24390099
244000             SET SU044-INVALID-SQL TO TRUE                        24400099
244100     END-EVALUATE.                                                24410099
244200                                                                  24420099
244300 1561-CHCK-CI-RCVR-FOR-TRLR.                                      24430099
244400                                                                  24440099
244500     IF  PS-BLD-INTERNAL-TABLE-YES                                24450099
244600         MOVE  '1561'  TO  PT-CURR-PARA                           24460099
244700         PERFORM 8120-INTERNAL-TABLE                              24470099
244800     END-IF.                                                      24480099
244900                                                                  24490099
245000     IF PS-SHOW-DEBUG-INFO                                        24500099
245100         STRING ' SUKUT705-1561-CHCK-CI-RCVR-FOR-TRLR'            24510099
245200         DELIMITED BY SIZE                                        24520099
245300         INTO PV-CICS-MSG-AREA                                    24530099
245400         PERFORM 9990-WRITE-CICS                                  24540099
245500     END-IF.                                                      24550099
245600                                                                  24560099
245700     EXEC SQL                                                     24570099
245800         SELECT C.REC_SEQ_NBR                                     24580099
245900              , E.SEQ_NBR                                         24590099
246000         INTO   :SHPTPO-REC-SEQ-NBR                               24600099
246100              , :PKSLIP-SEQ-NBR                                   24610099
246200          FROM                                                    24620099
246300                TSHIPMT B                                         24630099
246400              , TSHPTPO C                                         24640099
246500              , TRECEIV D                                         24650099
246600              , TPKSLIP E                                         24660099
246700          WHERE B.TRIP_ID           = :SU044-TRIP-ID              24670099
246800            AND C.PO_NBR            = :SU044-PO                   24680099
246900            AND B.SHIPT_ID          = C.SHIPT_ID                  24690099
247000            AND C.PO_NBR            = D.ORD_NBR                   24700099
247100            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               24710099
247200            AND C.PO_NBR            = E.PO_NBR                    24720099
247300            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               24730099
247400            AND D.VER_STATUS_CDE    = 'A'                         24740099
247500            AND E.VER_STAT_CDE      = 'A'                         24750099
247600            AND E.PKSL_STAT_CDE     = 'IN'                        24760099
247700            AND D.CRE_UID           = 'CHECK-IN'                  24770099
247800            AND C.PRIM_SHIPT_IND    = 'Y'                         24780099
247900            AND E.OPER_UNT_ID       =  :DK-OPER-UNT-ID            24790099
248000            AND E.STR_DEST_NBR      =  :DK-STR-DEST-NBR           24800099
248100     END-EXEC.                                                    24810099
248200                                                                  24820099
248300     EVALUATE TRUE                                                24830099
248400         WHEN SQLCODE = ZERO                                      24840099
248500         WHEN SQLCODE = -811                                      24850099
248600          MOVE SHPTPO-REC-SEQ-NBR TO SU044-NEW-REC-SEQ-NBR        24860099
248700          MOVE PKSLIP-SEQ-NBR     TO SU044-NEW-PKSL-SEQ-NBR       24870099
248800          SET PS-CI-RCVR-EXISTS-ON-TRLR                           24880099
248900              PS-FA-PKSL-EXISTS   TO TRUE                         24890099
249000         WHEN SQLCODE = +100                                      24900099
249100            SET PS-NO-CI-RCVR-EXISTS-ON-TRLR TO TRUE              24910099
249200         WHEN SQLCODE = -904                                      24920099
249300         WHEN SQLCODE = -911                                      24930099
249400              move '1561'  to  PV-CSSL-PARA                       24940099
249500              perform 8110-WRITE-suws044-TO-CSSL                  24950099
249600                                                                  24960099
249700             MOVE '1561-CHCK-CI-RCVR-FOR-TRLR'                    24970099
249800                             TO DP013-PARAGRAPH                   24980099
249900             MOVE 'SUKUT705 - CHECKIN RCVR ON TRLR'               24990099
250000                             TO DP013-MESSAGE-TEXT(1)             25000099
250100             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 25010099
250200             MOVE SU044-TRIP-ID TO PV-DISPLAY-INBND-TRIP-ID       25020099
250300             STRING 'PO NBR: '         DELIMITED BY SIZE          25030099
250400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          25040099
250500                    'TRIP: '           DELIMITED BY SIZE          25050099
250600              PV-DISPLAY-INBND-TRIP-ID DELIMITED BY SIZE          25060099
250700                           INTO DP013-MESSAGE-TEXT(2)             25070099
250800             MOVE SQLCA      TO DP013-SQLCA                       25080099
250900             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           25090099
251000             SET DP013-DB2-ABEND                                  25100099
251100                             TO TRUE                              25110099
251200             SET DP013-ROLLBACK                                   25120099
251300                             TO TRUE                              25130099
251400             PERFORM 9999-WRITE-CICS-LOG-MSG                      25140099
251500             SET PS-DUMP-TO-LOG       TO TRUE                     25150099
251600             SET SU044-DATABASE-BUSY TO TRUE                      25160099
251700         WHEN SQLWARN0 NOT = SPACES                               25170099
251800         WHEN SQLCODE NOT EQUAL ZERO                              25180099
251900              move '1561'  to  PV-CSSL-PARA                       25190099
252000              perform 8110-WRITE-suws044-TO-CSSL                  25200099
252100                                                                  25210099
252200             MOVE '1561-CHCK-CI-RCVR-FOR-TRLR'                    25220099
252300                             TO DP013-PARAGRAPH                   25230099
252400             MOVE 'SUKUT705 - CHECKIN RCVR ON TRLR  '             25240099
252500                             TO DP013-MESSAGE-TEXT(1)             25250099
252600             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 25260099
252700             MOVE SU044-TRIP-ID TO PV-DISPLAY-INBND-TRIP-ID       25270099
252800             STRING 'PO NBR: '         DELIMITED BY SIZE          25280099
252900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          25290099
253000                    'TRIP: '           DELIMITED BY SIZE          25300099
253100            PV-DISPLAY-INBND-TRIP-ID   DELIMITED BY SIZE          25310099
253200                           INTO DP013-MESSAGE-TEXT(2)             25320099
253300             MOVE SQLCA      TO DP013-SQLCA                       25330099
253400             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           25340099
253500             SET DP013-DB2-ABEND                                  25350099
253600                             TO TRUE                              25360099
253700             SET DP013-ROLLBACK                                   25370099
253800                             TO TRUE                              25380099
253900             PERFORM 9999-WRITE-CICS-LOG-MSG                      25390099
254000             SET PS-DUMP-TO-LOG       TO TRUE                     25400099
254100             SET SU044-INVALID-SQL TO TRUE                        25410099
254200     END-EVALUATE.                                                25420099
254300                                                                  25430099
254400                                                                  25440099
254500 1570-CK-RCVR-ON-CURR-TRLR.                                       25450099
254600                                                                  25460099
254700     IF  PS-BLD-INTERNAL-TABLE-YES                                25470099
254800         MOVE  '1570'  TO  PT-CURR-PARA                           25480099
254900         PERFORM 8120-INTERNAL-TABLE                              25490099
255000     END-IF.                                                      25500099
255100                                                                  25510099
255200     IF PS-SHOW-DEBUG-INFO                                        25520099
255300         STRING ' SUKUT705-1570-CK-RCVR-ON-CURR-TRLR '            25530099
255400         DELIMITED BY SIZE                                        25540099
255500         INTO PV-CICS-MSG-AREA                                    25550099
255600         PERFORM 9990-WRITE-CICS                                  25560099
255700     END-IF.                                                      25570099
255800                                                                  25580099
255900     MOVE ZEROES                TO PV-DB2-RCVR-COUNT.             25590099
256000                                                                  25600099
256100     EXEC SQL                                                     25610099
256200       SELECT DISTINCT                                            25620099
256300              A.REC_SEQ_NBR                                       25630099
256400             ,A.SEQ_NBR                                           25640099
256500        INTO :PKSLIP-REC-SEQ-NBR                                  25650099
256600            ,:PKSLIP-SEQ-NBR                                      25660099
256700         FROM TPKSLIP A                                           25670099
256800            , TINPKSU B                                           25680099
256900            , TSHPUNT C                                           25690099
257000            , TSHPTPO D                                           25700099
257100            , TSHIPMT E                                           25710099
257200        WHERE A.PO_NBR             =  :SU044-PO                   25720099
257300          AND A.OPER_UNT_ID        =  :SU044-OPER-UNT-ID          25730099
257400          AND A.STR_DEST_NBR       =  :SU044-DEST-STR-NBR         25740099
257500          AND A.CRE_SRC_CDE        = 'FA'                         25750099
257600          AND A.VER_STAT_CDE       = 'A'                          25760099
257700          AND A.PKSL_STAT_CDE      = 'IN'                         25770099
257800          AND A.PO_NBR             = B.PO_NBR                     25780099
257900          AND A.SEQ_NBR            = B.SEQ_NBR                    25790099
258000          AND B.SHIPT_UNT_ID       = C.SHIPT_UNT_ID               25800099
258100          AND C.ORGN_OPER_UNT_ID   = :SU044-CRTN-OPER-UNT-ID      25810099
258200          AND A.PO_NBR             = D.PO_NBR                     25820099
258300          AND A.REC_SEQ_NBR        = D.REC_SEQ_NBR                25830099
258400          AND D.SHIPT_ID           = E.SHIPT_ID                   25840099
258500          AND D.PRIM_SHIPT_IND     = 'Y'                          25850099
258600          AND E.TRIP_ID            = :SU044-TRIP-ID               25860099
258700     END-EXEC.                                                    25870099
258800                                                                  25880099
258900     EVALUATE TRUE                                                25890099
259000         WHEN SQLCODE = ZERO                                      25900099
259100             SET PS-MISDIRECT-RCVR-EXISTS-YES TO TRUE             25910099
259200             MOVE PKSLIP-REC-SEQ-NBR TO SU044-NEW-REC-SEQ-NBR     25920099
259300             MOVE PKSLIP-SEQ-NBR     TO SU044-NEW-PKSL-SEQ-NBR    25930099
259400             SET PS-FA-RCVR-EXISTS-ON-TRLR TO TRUE                25940099
259500             SET PS-FA-PKSL-EXISTS TO TRUE                        25950099
259600         WHEN SQLCODE = +100                                      25960099
259700             SET PS-MISDIRECT-RCVR-EXISTS-NO  TO TRUE             25970099
259800             SET PS-NO-FA-RCVR-EXISTS-ON-TRLR TO TRUE             25980099
259900             SET PS-FA-PKSL-NOT-EXISTS      TO TRUE               25990099
260000         WHEN SQLCODE = -904                                      26000099
260100         WHEN SQLCODE = -911                                      26010099
260200              move '1570'  to  PV-CSSL-PARA                       26020099
260300              perform 8110-WRITE-suws044-TO-CSSL                  26030099
260400                                                                  26040099
260500             MOVE '1570-CK-RCVR-ON-CURR-TRLR '                    26050099
260600                             TO DP013-PARAGRAPH                   26060099
260700             MOVE 'SUKUT705 - CHECK NEW RCVR ATTACH TO TRLR'      26070099
260800                             TO DP013-MESSAGE-TEXT(1)             26080099
260900             MOVE SU044-PO TO PV-DISPLAY-PO-NBR                   26090099
261000             MOVE SU044-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID     26100099
261100             MOVE SU044-DEST-STR-NBR TO PV-DISPLAY-DEST-OPER      26110099
261200             MOVE SU044-TRIP-ID   TO PV-DISPLAY-INBND-TRIP-ID     26120099
261300             STRING 'PO NBR: '         DELIMITED BY SIZE          26130099
261400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          26140099
261500                    'OPER: '           DELIMITED BY SIZE          26150099
261600               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          26160099
261700                           INTO DP013-MESSAGE-TEXT(2)             26170099
261800              STRING 'STORE: '         DELIMITED BY SIZE          26180099
261900              PV-DISPLAY-DEST-OPER     DELIMITED BY SIZE          26190099
262000                    'TRIP: '           DELIMITED BY SIZE          26200099
262100              PV-DISPLAY-INBND-TRIP-ID DELIMITED BY SIZE          26210099
262200                           INTO DP013-MESSAGE-TEXT(3)             26220099
262300             MOVE SQLCA      TO DP013-SQLCA                       26230099
262400             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)           26240099
262500             SET DP013-DB2-ABEND                                  26250099
262600                             TO TRUE                              26260099
262700             SET DP013-ROLLBACK                                   26270099
262800                             TO TRUE                              26280099
262900             PERFORM 9999-WRITE-CICS-LOG-MSG                      26290099
263000             SET PS-DUMP-TO-LOG       TO TRUE                     26300099
263100             SET SU044-DATABASE-BUSY TO TRUE                      26310099
263200         WHEN SQLWARN0 NOT = SPACES                               26320099
263300         WHEN SQLCODE NOT EQUAL ZERO                              26330099
263400              move '1570'  to  PV-CSSL-PARA                       26340099
263500              perform 8110-WRITE-suws044-TO-CSSL                  26350099
263600                                                                  26360099
263700             MOVE '1570-CK-RCVR-ON-CURR-TRLR '                    26370099
263800                             TO DP013-PARAGRAPH                   26380099
263900             MOVE 'SUKUT705 - CHECK NEW RCVR ATTACH TO TRLR'      26390099
264000                             TO DP013-MESSAGE-TEXT(1)             26400099
264100             MOVE SU044-PO TO PV-DISPLAY-PO-NBR                   26410099
264200             MOVE SU044-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID     26420099
264300             MOVE SU044-DEST-STR-NBR TO PV-DISPLAY-DEST-OPER      26430099
264400             MOVE SU044-TRIP-ID   TO PV-DISPLAY-INBND-TRIP-ID     26440099
264500             STRING 'PO NBR: '         DELIMITED BY SIZE          26450099
264600                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          26460099
264700                    'OPER: '           DELIMITED BY SIZE          26470099
264800               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          26480099
264900                           INTO DP013-MESSAGE-TEXT(2)             26490099
265000              STRING  'STORE: '        DELIMITED BY SIZE          26500099
265100              PV-DISPLAY-DEST-OPER     DELIMITED BY SIZE          26510099
265200                    'TRIP: '           DELIMITED BY SIZE          26520099
265300              PV-DISPLAY-INBND-TRIP-ID DELIMITED BY SIZE          26530099
265400                           INTO DP013-MESSAGE-TEXT(3)             26540099
265500             MOVE SQLCA      TO DP013-SQLCA                       26550099
265600             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)           26560099
265700             SET DP013-DB2-ABEND                                  26570099
265800                             TO TRUE                              26580099
265900             SET DP013-ROLLBACK                                   26590099
266000                             TO TRUE                              26600099
266100             PERFORM 9999-WRITE-CICS-LOG-MSG                      26610099
266200             SET PS-DUMP-TO-LOG       TO TRUE                     26620099
266300             SET SU044-INVALID-SQL TO TRUE                        26630099
266400     END-EVALUATE.                                                26640099
266500                                                                  26650099
266600 1571-CK-RCVR-ON-CURR-TRLR2.                                      26660099
266700                                                                  26670099
266800     IF  PS-BLD-INTERNAL-TABLE-YES                                26680099
266900         MOVE  '1571'  TO  PT-CURR-PARA                           26690099
267000         PERFORM 8120-INTERNAL-TABLE                              26700099
267100     END-IF.                                                      26710099
267200                                                                  26720099
267300     IF PS-SHOW-DEBUG-INFO                                        26730099
267400         STRING ' SUKUT705-1571-CK-RCVR-ON-CURR-TRLR2'            26740099
267500         DELIMITED BY SIZE                                        26750099
267600         INTO PV-CICS-MSG-AREA                                    26760099
267700         PERFORM 9990-WRITE-CICS                                  26770099
267800     END-IF.                                                      26780099
267900                                                                  26790099
268000     MOVE ZEROES                TO PV-DB2-RCVR-COUNT.             26800099
268100                                                                  26810099
268200     EXEC SQL                                                     26820099
268300       SELECT DISTINCT                                            26830099
268400              A.REC_SEQ_NBR                                       26840099
268500             ,A.SEQ_NBR                                           26850099
268600        INTO :PKSLIP-REC-SEQ-NBR                                  26860099
268700            ,:PKSLIP-SEQ-NBR                                      26870099
268800         FROM TPKSLIP A                                           26880099
268900            , TINPKSU B                                           26890099
269000            , TSHPUNT C                                           26900099
269100            , TSHPTPO D                                           26910099
269200            , TSHIPMT E                                           26920099
269300            , TRECEIV F                                           26930099
269400        WHERE A.PO_NBR             = :SU044-PO                    26940099
269500          AND A.OPER_UNT_ID        = :SU044-CRTN-OPER-UNT-ID      26950099
269600          AND A.STR_DEST_NBR       = :SU044-DEST-STR-NBR          26960099
269700          AND A.CRE_SRC_CDE        = 'FA'                         26970099
269800          AND A.VER_STAT_CDE       = 'A'                          26980099
269900          AND A.PKSL_STAT_CDE      = 'IN'                         26990099
270000          AND A.PO_NBR             = B.PO_NBR                     27000099
270100          AND A.SEQ_NBR            = B.SEQ_NBR                    27010099
270200          AND B.SHIPT_UNT_ID       = C.SHIPT_UNT_ID               27020099
270300          AND C.ORGN_OPER_UNT_ID   = :SU044-CRTN-OPER-UNT-ID      27030099
270400          AND A.PO_NBR             = D.PO_NBR                     27040099
270500          AND A.REC_SEQ_NBR        = D.REC_SEQ_NBR                27050099
270600          AND D.SHIPT_ID           = E.SHIPT_ID                   27060099
270700          AND D.PRIM_SHIPT_IND     = 'Y'                          27070099
270800          AND E.TRIP_ID            = :SU044-TRIP-ID               27080099
270900          AND F.ORD_NBR            = A.PO_NBR                     27090099
271000          AND F.REC_SEQ_NBR        = A.REC_SEQ_NBR                27100099
271100          AND F.VER_STATUS_CDE     = 'A'                          27110099
271200          AND F.FRE_ASTRA_IND      = 'Y'                          27120099
271300          AND F.CURR_OPER_UNT_ID   = :SU044-OPER-UNT-ID           27130099
271400          AND F.OPER_UNT_ID        = A.OPER_UNT_ID                27140099
271500       ORDER BY A.REC_SEQ_NBR                                     27150099
271600       FETCH FIRST 1 ROW ONLY                                     27160099
271700     END-EXEC.                                                    27170099
271800                                                                  27180099
271900     EVALUATE TRUE                                                27190099
272000         WHEN SQLCODE = ZERO                                      27200099
272100         WHEN SQLCODE = -811                                      27210099
272200             SET PS-MISDIRECT-RCVR-EXISTS-YES TO TRUE             27220099
272300             MOVE PKSLIP-REC-SEQ-NBR TO SU044-NEW-REC-SEQ-NBR     27230099
272400             MOVE PKSLIP-SEQ-NBR     TO SU044-NEW-PKSL-SEQ-NBR    27240099
272500             SET PS-FA-RCVR-EXISTS-ON-TRLR TO TRUE                27250099
272600             SET PS-FA-PKSL-EXISTS TO TRUE                        27260099
272700         WHEN SQLCODE = +100                                      27270099
272800             SET PS-MISDIRECT-RCVR-EXISTS-NO  TO TRUE             27280099
272900             SET PS-NO-FA-RCVR-EXISTS-ON-TRLR TO TRUE             27290099
273000             SET PS-FA-PKSL-NOT-EXISTS      TO TRUE               27300099
273100         WHEN SQLCODE = -904                                      27310099
273200         WHEN SQLCODE = -911                                      27320099
273300              MOVE '1571'  TO  PV-CSSL-PARA                       27330099
273400              PERFORM 8110-WRITE-SUWS044-TO-CSSL                  27340099
273500                                                                  27350099
273600             MOVE '1571-CK-RCVR-ON-CURR-TRLR2'                    27360099
273700                             TO DP013-PARAGRAPH                   27370099
273800             MOVE 'SUKUT705 - CHECK NEW RCVR ATTACH TO TRLR'      27380099
273900                             TO DP013-MESSAGE-TEXT(1)             27390099
274000             MOVE SU044-PO TO PV-DISPLAY-PO-NBR                   27400099
274100             MOVE SU044-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID     27410099
274200             MOVE SU044-DEST-STR-NBR TO PV-DISPLAY-DEST-OPER      27420099
274300             MOVE SU044-TRIP-ID   TO PV-DISPLAY-INBND-TRIP-ID     27430099
274400             MOVE SU044-CRTN-OPER-UNT-ID TO                       27440099
274500                  PV-DISPLAY-CRTN-OPER-UNT-ID                     27450099
274600             STRING 'PO NBR: '         DELIMITED BY SIZE          27460099
274700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          27470099
274800                    'OPER: '           DELIMITED BY SIZE          27480099
274900               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          27490099
275000                           INTO DP013-MESSAGE-TEXT(2)             27500099
275100              STRING 'STORE: '         DELIMITED BY SIZE          27510099
275200              PV-DISPLAY-DEST-OPER     DELIMITED BY SIZE          27520099
275300                    'TRIP: '           DELIMITED BY SIZE          27530099
275400              PV-DISPLAY-INBND-TRIP-ID DELIMITED BY SIZE          27540099
275500                    'CRTN OPER: '      DELIMITED BY SIZE          27550099
275600              PV-DISPLAY-CRTN-OPER-UNT-ID DELIMITED BY SIZE       27560099
275700                           INTO DP013-MESSAGE-TEXT(3)             27570099
275800             MOVE SQLCA      TO DP013-SQLCA                       27580099
275900             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)           27590099
276000             SET DP013-DB2-ABEND                                  27600099
276100                             TO TRUE                              27610099
276200             SET DP013-ROLLBACK                                   27620099
276300                             TO TRUE                              27630099
276400             PERFORM 9999-WRITE-CICS-LOG-MSG                      27640099
276500             SET PS-DUMP-TO-LOG       TO TRUE                     27650099
276600             SET SU044-DATABASE-BUSY TO TRUE                      27660099
276700         WHEN SQLWARN0 NOT = SPACES                               27670099
276800         WHEN SQLCODE NOT EQUAL ZERO                              27680099
276900              MOVE '1571'  TO  PV-CSSL-PARA                       27690099
277000              PERFORM 8110-WRITE-SUWS044-TO-CSSL                  27700099
277100                                                                  27710099
277200             MOVE '1571-CK-RCVR-ON-CURR-TRLR2'                    27720099
277300                             TO DP013-PARAGRAPH                   27730099
277400             MOVE 'SUKUT705 - CHECK NEW RCVR ATTACH TO TRLR'      27740099
277500                             TO DP013-MESSAGE-TEXT(1)             27750099
277600             MOVE SU044-PO TO PV-DISPLAY-PO-NBR                   27760099
277700             MOVE SU044-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID     27770099
277800             MOVE SU044-DEST-STR-NBR TO PV-DISPLAY-DEST-OPER      27780099
277900             MOVE SU044-TRIP-ID   TO PV-DISPLAY-INBND-TRIP-ID     27790099
278000             MOVE SU044-CRTN-OPER-UNT-ID TO                       27800099
278100                  PV-DISPLAY-CRTN-OPER-UNT-ID                     27810099
278200             STRING 'PO NBR: '         DELIMITED BY SIZE          27820099
278300                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          27830099
278400                    'OPER: '           DELIMITED BY SIZE          27840099
278500               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          27850099
278600                           INTO DP013-MESSAGE-TEXT(2)             27860099
278700              STRING  'STORE: '        DELIMITED BY SIZE          27870099
278800              PV-DISPLAY-DEST-OPER     DELIMITED BY SIZE          27880099
278900                    'TRIP: '           DELIMITED BY SIZE          27890099
279000              PV-DISPLAY-INBND-TRIP-ID DELIMITED BY SIZE          27900099
279100                    'CRTN OPER: '      DELIMITED BY SIZE          27910099
279200              PV-DISPLAY-CRTN-OPER-UNT-ID DELIMITED BY SIZE       27920099
279300                           INTO DP013-MESSAGE-TEXT(3)             27930099
279400             MOVE SQLCA      TO DP013-SQLCA                       27940099
279500             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)           27950099
279600             SET DP013-DB2-ABEND                                  27960099
279700                             TO TRUE                              27970099
279800             SET DP013-ROLLBACK                                   27980099
279900                             TO TRUE                              27990099
280000             PERFORM 9999-WRITE-CICS-LOG-MSG                      28000099
280100             SET PS-DUMP-TO-LOG       TO TRUE                     28010099
280200             SET SU044-INVALID-SQL TO TRUE                        28020099
280300     END-EVALUATE.                                                28030099
280400                                                                  28040099
280500 1575-MISDIRECT-RCVR-ON-TRLR.                                     28050099
280600                                                                  28060099
280700     IF  PS-BLD-INTERNAL-TABLE-YES                                28070099
280800         MOVE  '1575'  TO  PT-CURR-PARA                           28080099
280900         PERFORM 8120-INTERNAL-TABLE                              28090099
281000     END-IF.                                                      28100099
281100                                                                  28110099
281200     IF PS-SHOW-DEBUG-INFO                                        28120099
281300         STRING ' SUKUT705-1575-MISDIRECT-RCVR-ON-TRLR'           28130099
281400         DELIMITED BY SIZE                                        28140099
281500         INTO PV-CICS-MSG-AREA                                    28150099
281600         PERFORM 9990-WRITE-CICS                                  28160099
281700     END-IF.                                                      28170099
281800                                                                  28180099
281900     MOVE ZEROES                TO PV-DB2-RCVR-COUNT.             28190099
282000                                                                  28200099
282100     EXEC SQL                                                     28210099
282200       SELECT DISTINCT                                            28220099
282300              A.REC_SEQ_NBR                                       28230099
282400             ,A.SEQ_NBR                                           28240099
282500        INTO :PKSLIP-REC-SEQ-NBR                                  28250099
282600            ,:PKSLIP-SEQ-NBR                                      28260099
282700         FROM TPKSLIP A                                           28270099
282800            , TINPKSU B                                           28280099
282900            , TSHPUNT C                                           28290099
283000            , TSHPTPO D                                           28300099
283100            , TSHIPMT E                                           28310099
283200        WHERE A.PO_NBR             =  :SU044-PO                   28320099
283300          AND A.OPER_UNT_ID        =  :SU044-CRTN-OPER-UNT-ID     28330099
283400          AND A.STR_DEST_NBR       =  :SU044-DEST-STR-NBR         28340099
283500          AND A.CRE_SRC_CDE        = 'FA'                         28350099
283600          AND A.VER_STAT_CDE       = 'A'                          28360099
283700          AND A.PKSL_STAT_CDE      = 'IN'                         28370099
283800          AND A.PO_NBR             = B.PO_NBR                     28380099
283900          AND A.SEQ_NBR            = B.SEQ_NBR                    28390099
284000          AND B.SHIPT_UNT_ID       = C.SHIPT_UNT_ID               28400099
284100          AND C.ORGN_OPER_UNT_ID   = :SU044-CRTN-OPER-UNT-ID      28410099
284200          AND A.PO_NBR             = D.PO_NBR                     28420099
284300          AND A.REC_SEQ_NBR        = D.REC_SEQ_NBR                28430099
284400          AND D.SHIPT_ID           = E.SHIPT_ID                   28440099
284500          AND D.PRIM_SHIPT_IND     = 'Y'                          28450099
284600          AND E.TRIP_ID            = :SU044-TRIP-ID               28460099
284700     END-EXEC.                                                    28470099
284800                                                                  28480099
284900     EVALUATE TRUE                                                28490099
285000         WHEN SQLCODE = ZERO                                      28500099
285100             SET PS-MISDIRECT-RCVR-EXISTS-YES TO TRUE             28510099
285200             MOVE PKSLIP-REC-SEQ-NBR TO SU044-NEW-REC-SEQ-NBR     28520099
285300             MOVE PKSLIP-SEQ-NBR     TO SU044-NEW-PKSL-SEQ-NBR    28530099
285400             SET PS-FA-RCVR-EXISTS-ON-TRLR TO TRUE                28540099
285500             SET PS-FA-PKSL-EXISTS TO TRUE                        28550099
285600         WHEN SQLCODE = +100                                      28560099
285700             SET PS-MISDIRECT-RCVR-EXISTS-NO  TO TRUE             28570099
285800             SET PS-NO-FA-RCVR-EXISTS-ON-TRLR TO TRUE             28580099
285900             SET PS-FA-PKSL-NOT-EXISTS      TO TRUE               28590099
286000         WHEN SQLCODE = -904                                      28600099
286100         WHEN SQLCODE = -911                                      28610099
286200              move '1575'  to  PV-CSSL-PARA                       28620099
286300              perform 8110-WRITE-suws044-TO-CSSL                  28630099
286400                                                                  28640099
286500             MOVE '1575-MISDIRECT-RCVR-ON-TRLR'                   28650099
286600                             TO DP013-PARAGRAPH                   28660099
286700             MOVE 'SUKUT705 - CHECK NEW MISD RCVR ON TRLR'        28670099
286800                             TO DP013-MESSAGE-TEXT(1)             28680099
286900             MOVE SU044-PO TO PV-DISPLAY-PO-NBR                   28690099
287000             MOVE SU044-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID     28700099
287100             MOVE SU044-DEST-STR-NBR TO PV-DISPLAY-DEST-OPER      28710099
287200             MOVE SU044-TRIP-ID   TO PV-DISPLAY-INBND-TRIP-ID     28720099
287300             STRING 'PO NBR: '         DELIMITED BY SIZE          28730099
287400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          28740099
287500                    'OPER: '           DELIMITED BY SIZE          28750099
287600               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          28760099
287700                           INTO DP013-MESSAGE-TEXT(2)             28770099
287800              STRING 'STORE: '         DELIMITED BY SIZE          28780099
287900              PV-DISPLAY-DEST-OPER     DELIMITED BY SIZE          28790099
288000                    'TRIP: '           DELIMITED BY SIZE          28800099
288100              PV-DISPLAY-INBND-TRIP-ID DELIMITED BY SIZE          28810099
288200                           INTO DP013-MESSAGE-TEXT(3)             28820099
288300             MOVE SQLCA      TO DP013-SQLCA                       28830099
288400             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           28840099
288500             SET DP013-DB2-ABEND                                  28850099
288600                             TO TRUE                              28860099
288700             SET DP013-ROLLBACK                                   28870099
288800                             TO TRUE                              28880099
288900             PERFORM 9999-WRITE-CICS-LOG-MSG                      28890099
289000             SET PS-DUMP-TO-LOG       TO TRUE                     28900099
289100             SET SU044-DATABASE-BUSY TO TRUE                      28910099
289200         WHEN SQLWARN0 NOT = SPACES                               28920099
289300         WHEN SQLCODE NOT EQUAL ZERO                              28930099
289400              move '1575'  to  PV-CSSL-PARA                       28940099
289500              perform 8110-WRITE-suws044-TO-CSSL                  28950099
289600                                                                  28960099
289700             MOVE '1575-MISDIRECT-RCVR-ON-TRLR'                   28970099
289800                             TO DP013-PARAGRAPH                   28980099
289900             MOVE 'SUKUT705 - CHECK NEW RCVR ATTACH TO TRLR'      28990099
290000                             TO DP013-MESSAGE-TEXT(1)             29000099
290100             MOVE SU044-PO TO PV-DISPLAY-PO-NBR                   29010099
290200             MOVE SU044-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID     29020099
290300             MOVE SU044-DEST-STR-NBR TO PV-DISPLAY-DEST-OPER      29030099
290400             MOVE SU044-TRIP-ID   TO PV-DISPLAY-INBND-TRIP-ID     29040099
290500             STRING 'PO NBR: '         DELIMITED BY SIZE          29050099
290600                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          29060099
290700                    'OPER: '           DELIMITED BY SIZE          29070099
290800               PV-DISPLAY-OPER-UNT-ID  DELIMITED BY SIZE          29080099
290900                           INTO DP013-MESSAGE-TEXT(2)             29090099
291000              STRING  'STORE: '        DELIMITED BY SIZE          29100099
291100              PV-DISPLAY-DEST-OPER     DELIMITED BY SIZE          29110099
291200                    'TRIP: '           DELIMITED BY SIZE          29120099
291300              PV-DISPLAY-INBND-TRIP-ID DELIMITED BY SIZE          29130099
291400                           INTO DP013-MESSAGE-TEXT(3)             29140099
291500             MOVE SQLCA      TO DP013-SQLCA                       29150099
291600             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)           29160099
291700             SET DP013-DB2-ABEND                                  29170099
291800                             TO TRUE                              29180099
291900             SET DP013-ROLLBACK                                   29190099
292000                             TO TRUE                              29200099
292100             PERFORM 9999-WRITE-CICS-LOG-MSG                      29210099
292200             SET PS-DUMP-TO-LOG       TO TRUE                     29220099
292300             SET SU044-INVALID-SQL TO TRUE                        29230099
292400     END-EVALUATE.                                                29240099
292500                                                                  29250099
292600* 03-28-2012 CHRISTINE TWIEHAUS WR40574 ADDED CAN BELOW           29260099
292700*************************************************************     29270099
292800*  LOOK UP CAN WITH OPER, TRAILER AND SCAC IF ALL OTHER     *     29280099
292900*  ATTEMPTS FAILED                                          *     29290099
293000*************************************************************     29300099
293100 1580-SEL-SHIPMT-VEH.                                             29310099
293200                                                                  29320099
293300     IF  PS-BLD-INTERNAL-TABLE-YES                                29330099
293400         MOVE  '1580'  TO  PT-CURR-PARA                           29340099
293500         PERFORM 8120-INTERNAL-TABLE                              29350099
293600     END-IF.                                                      29360099
293700                                                                  29370099
293800     IF PS-SHOW-DEBUG-INFO                                        29380099
293900         STRING ' SUKUT705-1580-SEL-SHIPMT-VEH   '                29390099
294000         DELIMITED BY SIZE                                        29400099
294100         INTO PV-CICS-MSG-AREA                                    29410099
294200         PERFORM 9990-WRITE-CICS                                  29420099
294300     END-IF.                                                      29430099
294400                                                                  29440099
294500         EXEC SQL                                                 29450099
294600            SELECT DISTINCT CARR_AUTH_ID                          29460099
294700              INTO :SHIPMT-CARR-AUTH-ID                           29470099
294800              FROM TSHIPMT A                                      29480099
294900                  ,TTRIPST B                                      29490099
295000             WHERE A.VEH_NBR      = :SU044-VEH-NBR                29500099
295100               AND B.TRIP_ID      = A.TRIP_ID                     29510099
295200               AND A.PRO_SCAC_ID  = :SU044-SCAC-ID                29520099
295300               AND A.CARR_AUTH_ID > ' '                           29530099
295400               AND B.OPER_UNT_ID  = :SU044-OPER-UNT-ID            29540099
295500         END-EXEC.                                                29550099
295600                                                                  29560099
295700         EVALUATE TRUE                                            29570099
295800             WHEN SQLCODE = +0                                    29580099
295900                 MOVE SHIPMT-CARR-AUTH-ID   TO SU044-CARR-AUTH-ID 29590099
296000             WHEN SQLCODE = -811                                  29600099
296100                 PERFORM 1581-SEL-SHIPMT-VEH-LATEST               29610099
296200             WHEN SQLCODE = +100                                  29620099
296300                 MOVE SPACES                TO SU044-CARR-AUTH-ID 29630099
296400                                                                  29640099
296500             WHEN SQLCODE = -904                                  29650099
296600             WHEN SQLCODE = -913                                  29660099
296700                 CONTINUE                                         29670099
296800                                                                  29680099
296900             WHEN SQLWARN0 NOT = SPACES                           29690099
297000             WHEN SQLCODE < +0                                    29700099
297100             WHEN SQLCODE > +0                                    29710099
297200                  move '1580'  to  PV-CSSL-PARA                   29720099
297300                  perform 8110-WRITE-suws044-TO-CSSL              29730099
297400                                                                  29740099
297500                 MOVE '1580-SEL-SHIPMT-VEH  '                     29750099
297600                                 TO DP013-PARAGRAPH               29760099
297700                 MOVE 'SUKUT705 - GET SHIPMT CAN  '               29770099
297800                             TO DP013-MESSAGE-TEXT(1)             29780099
297900                 MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR             29790099
298000                 MOVE SU044-ORIG-REC-SEQ-NBR                      29800099
298100                            TO PV-DISPLAY-RCVR-SEQ-NBR            29810099
298200                 STRING 'PO NBR: '         DELIMITED BY SIZE      29820099
298300                     PV-DISPLAY-PO-NBR     DELIMITED BY SIZE      29830099
298400                        'REC SEQ:'         DELIMITED BY SIZE      29840099
298500                  PV-DISPLAY-RCVR-SEQ-NBR  DELIMITED BY SIZE      29850099
298600                               INTO DP013-MESSAGE-TEXT(2)         29860099
298700                 MOVE SQLCA      TO DP013-SQLCA                   29870099
298800                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME(1)       29880099
298900                 SET DP013-DB2-ABEND                              29890099
299000                                 TO TRUE                          29900099
299100                 SET DP013-ROLLBACK                               29910099
299200                                 TO TRUE                          29920099
299300                 PERFORM 9999-WRITE-CICS-LOG-MSG                  29930099
299400                 SET PS-DUMP-TO-LOG       TO TRUE                 29940099
299500                 SET SU044-INVALID-SQL TO TRUE                    29950099
299600         END-EVALUATE.                                            29960099
299700                                                                  29970099
299800*----------------------------------------------------------------*29980099
299900*  DUE TO MULTIPLES - GET LATEST CARR AUTH                        29990099
300000*----------------------------------------------------------------*30000099
300100 1581-SEL-SHIPMT-VEH-LATEST.                                      30010099
300200                                                                  30020099
300300     IF  PS-BLD-INTERNAL-TABLE-YES                                30030099
300400         MOVE  '1581'  TO  PT-CURR-PARA                           30040099
300500         PERFORM 8120-INTERNAL-TABLE                              30050099
300600     END-IF.                                                      30060099
300700                                                                  30070099
300800         EXEC SQL                                                 30080099
300900            SELECT DISTINCT CARR_AUTH_ID                          30090099
301000                           ,LAST_UPD_DTE                          30100099
301100                           ,LAST_UPD_TME                          30110099
301200              INTO :SHIPMT-CARR-AUTH-ID                           30120099
301300                  ,:SHIPMT-LAST-UPD-DTE                           30130099
301400                  ,:SHIPMT-LAST-UPD-TME                           30140099
301500              FROM TSHIPMT A                                      30150099
301600                  ,TTRIPST B                                      30160099
301700             WHERE A.VEH_NBR      = :SU044-VEH-NBR                30170099
301800               AND A.PRO_SCAC_ID  = :SU044-SCAC-ID                30180099
301900               AND A.CARR_AUTH_ID > ' '                           30190099
302000               AND B.TRIP_ID       = A.TRIP_ID                    30200099
302100               AND B.OPER_UNT_ID   = :SU044-OPER-UNT-ID           30210099
302200             ORDER BY  LAST_UPD_DTE                               30220099
302300                      ,LAST_UPD_TME DESC                          30230099
302400         END-EXEC                                                 30240099
302500                                                                  30250099
302600         EVALUATE TRUE                                            30260099
302700             WHEN SQLCODE = +0                                    30270099
302800             WHEN SQLCODE = -811                                  30280099
302900                 MOVE SHIPMT-CARR-AUTH-ID   TO SU044-CARR-AUTH-ID 30290099
303000             WHEN SQLCODE = +100                                  30300099
303100                 MOVE SPACES                TO SU044-CARR-AUTH-ID 30310099
303200             WHEN SQLCODE = -904                                  30320099
303300             WHEN SQLCODE = -913                                  30330099
303400                 CONTINUE                                         30340099
303500             WHEN SQLWARN0 NOT = SPACES                           30350099
303600             WHEN SQLCODE < +0                                    30360099
303700             WHEN SQLCODE > +0                                    30370099
303800                  move '1581'  to  PV-CSSL-PARA                   30380099
303900                  perform 8110-WRITE-suws044-TO-CSSL              30390099
304000                                                                  30400099
304100                 MOVE '1581-SEL-SHIPMT-VEH-LATEST'                30410099
304200                                 TO DP013-PARAGRAPH               30420099
304300                 MOVE 'SUKUT705 - GET SHIPMT CAN  '               30430099
304400                             TO DP013-MESSAGE-TEXT(1)             30440099
304500                 MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR             30450099
304600                 MOVE SU044-ORIG-REC-SEQ-NBR                      30460099
304700                            TO PV-DISPLAY-RCVR-SEQ-NBR            30470099
304800                 STRING 'PO NBR: '         DELIMITED BY SIZE      30480099
304900                     PV-DISPLAY-PO-NBR     DELIMITED BY SIZE      30490099
305000                        'REC SEQ:'         DELIMITED BY SIZE      30500099
305100                  PV-DISPLAY-RCVR-SEQ-NBR  DELIMITED BY SIZE      30510099
305200                               INTO DP013-MESSAGE-TEXT(2)         30520099
305300                 MOVE SQLCA      TO DP013-SQLCA                   30530099
305400                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME(1)       30540099
305500                 SET DP013-DB2-ABEND                              30550099
305600                                 TO TRUE                          30560099
305700                 SET DP013-ROLLBACK                               30570099
305800                                 TO TRUE                          30580099
305900                 PERFORM 9999-WRITE-CICS-LOG-MSG                  30590099
306000                 SET PS-DUMP-TO-LOG       TO TRUE                 30600099
306100                 SET SU044-INVALID-SQL TO TRUE                    30610099
306200         END-EVALUATE.                                            30620099
306300                                                                  30630099
306400 1600-UPDATE-AUTO-FA-PKSLIP.                                      30640099
306500                                                                  30650099
306600     IF  PS-BLD-INTERNAL-TABLE-YES                                30660099
306700         MOVE  '1600'  TO  PT-CURR-PARA                           30670099
306800         PERFORM 8120-INTERNAL-TABLE                              30680099
306900     END-IF.                                                      30690099
307000                                                                  30700099
307100      PERFORM 1650-SELECT-ORIGINAL-PKSLIP.                        30710099
307200      IF SU044-SUCCESSFUL                                         30720099
307300         PERFORM 1700-INACTV-ORIGINAL-PKSLIP                      30730099
307400      END-IF.                                                     30740099
307500      IF SU044-SUCCESSFUL                                         30750099
307600         PERFORM 1750-UPDATE-ORIGINAL-PKSLIP                      30760099
307700      END-IF.                                                     30770099
307800                                                                  30780099
307900      IF SU044-SUCCESSFUL AND SU044-CREATE-CHECK-IN-RCVR          30790099
308000         AND SU044-RCVR-PBS                                       30800099
308100            PERFORM 1800-UPD-PKSLIP-PBS-CKIN-RCVR                 30810099
308200      END-IF.                                                     30820099
308300                                                                  30830099
308400 1601-UPDATE-OPEN-PKSLIP.                                         30840099
308500                                                                  30850099
308600     IF  PS-BLD-INTERNAL-TABLE-YES                                30860099
308700         MOVE  '1601'  TO  PT-CURR-PARA                           30870099
308800         PERFORM 8120-INTERNAL-TABLE                              30880099
308900     END-IF.                                                      30890099
309000                                                                  30900099
309100      PERFORM 1651-SELECT-OPEN-PKSLIP.                            30910099
309200      IF SU044-SUCCESSFUL                                         30920099
309300         PERFORM 1701-INACTV-OPEN-PKSLIP                          30930099
309400      END-IF.                                                     30940099
309500      IF SU044-SUCCESSFUL                                         30950099
309600         PERFORM 1751-UPDATE-OPEN-PKSLIP                          30960099
309700      END-IF.                                                     30970099
309800                                                                  30980099
309900      IF SU044-SUCCESSFUL AND SU044-CREATE-CHECK-IN-RCVR          30990099
310000         AND SU044-RCVR-PBS                                       31000099
310100            PERFORM 1800-UPD-PKSLIP-PBS-CKIN-RCVR                 31010099
310200      END-IF.                                                     31020099
310300                                                                  31030099
310400 1650-SELECT-ORIGINAL-PKSLIP.                                     31040099
310500                                                                  31050099
310600     IF  PS-BLD-INTERNAL-TABLE-YES                                31060099
310700         MOVE  '1650'  TO  PT-CURR-PARA                           31070099
310800         PERFORM 8120-INTERNAL-TABLE                              31080099
310900     end-IF.                                                      31090099
311000                                                                  31100099
311100     EXEC SQL                                                     31110099
311200         SELECT                                                   31120099
311300              PO_NBR                                              31130001
311400             ,SEQ_NBR                                             31140001
311500             ,CRE_TMST                                            31150001
311600             ,VER_STAT_CDE                                        31160001
311700             ,OPER_UNT_ID                                         31170001
311800             ,FCLTY_ID                                            31180001
311900             ,PKSL_NBR                                            31190001
312000             ,STR_DEST_NBR                                        31200001
312100             ,REC_SEQ_NBR                                         31210001
312200             ,SHIPT_ID                                            31220001
312300             ,BOL_NBR                                             31230001
312400             ,PRO_NBR                                             31240001
312500             ,PKSL_STAT_CDE                                       31250001
312600             ,CRE_UID                                             31260001
312700             ,PO_VER_NBR                                          31270001
312800             ,CRE_SRC_CDE                                         31280001
312900             ,EXPTED_PKG_QTY                                      31290001
313000             ,OWNER_SCAC_ID                                       31300001
313100             ,ASN_NBR                                             31310001
313200             ,VEND_SHIP_DTE                                       31320001
313300             ,PKSL_PG_CNT                                         31330001
313400             ,CONTNR_ID                                           31340001
313500             ,ORIG_PKSL_SEQ_NBR                                   31350001
313600          INTO :PV-PKSLIP-PO-NBR                                  31360001
313700             , :PV-PKSLIP-SEQ-NBR                                 31370001
313800             , :PV-PKSLIP-CRE-TMST                                31380001
313900             , :PV-PKSLIP-VER-STAT-CDE                            31390001
314000             , :PV-PKSLIP-OPER-UNT-ID                             31400001
314100             , :PV-PKSLIP-FCLTY-ID                                31410001
314200             , :PV-PKSLIP-PKSL-NBR                                31420001
314300             , :PV-PKSLIP-STR-DEST-NBR                            31430001
314400             , :PV-PKSLIP-REC-SEQ-NBR                             31440001
314500             , :PV-PKSLIP-SHIPT-ID                                31450001
314600             , :PV-PKSLIP-BOL-NBR                                 31460001
314700             , :PV-PKSLIP-PRO-NBR                                 31470001
314800             , :PV-PKSLIP-PKSL-STAT-CDE                           31480001
314900             , :PV-PKSLIP-CRE-UID                                 31490001
315000             , :PV-PKSLIP-PO-VER-NBR                              31500001
315100             , :PV-PKSLIP-CRE-SRC-CDE                             31510001
315200             , :PV-PKSLIP-EXPTED-PKG-QTY                          31520001
315300             , :PV-PKSLIP-OWNER-SCAC-ID                           31530001
315400             , :PV-PKSLIP-ASN-NBR                                 31540001
315500             , :PV-PKSLIP-VEND-SHIP-DTE                           31550001
315600             , :PV-PKSLIP-PKSL-PG-CNT                             31560001
315700             , :PV-PKSLIP-CONTNR-ID                               31570001
315800             , :PV-PKSLIP-ORIG-PKSL-SEQ-NBR                       31580001
315900          FROM TPKSLIP A                                          31590001
316000          WHERE A.PO_NBR          = :DK-PO-NBR                    31600001
316100            AND A.REC_SEQ_NBR     = :SU044-ORIG-REC-SEQ-NBR       31610001
316200            AND A.SEQ_NBR         = :SU044-ORIG-PKSL-SEQ-NBR      31620001
316300            AND A.VER_STAT_CDE    =  'A'                          31630001
316400     END-EXEC.                                                    31640001
316500                                                                  31650001
316600     EVALUATE TRUE                                                31660001
316700         WHEN SQLCODE = ZERO                                      31670001
316800             CONTINUE                                             31680001
316900         WHEN SQLCODE = -904                                      31690001
317000         WHEN SQLCODE = -911                                      31700001
317100              move '1650'  to  PV-CSSL-PARA                       31710076
317200              perform 8110-WRITE-suws044-TO-CSSL                  31720079
317300                                                                  31730076
317400             MOVE '1650-SELECT-ORIGINAL-PKSLIP'                   31740001
317500                             TO DP013-PARAGRAPH                   31750001
317600             MOVE 'SUKUT705 - GET ORIGINAL PKSLIP DATA'           31760001
317700                             TO DP013-MESSAGE-TEXT(1)             31770001
317800             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 31780001
317900             MOVE SU044-ORIG-PKSL-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ31790001
318000             STRING 'PO:'       PV-DISPLAY-PO-NBR                 31800090
318100                    ' ORIG:'    PV-DISPLAY-PKSLIP-SEQ             31810090
318200                                DELIMITED BY SIZE                 31820090
318300                           INTO DP013-MESSAGE-TEXT(2)             31830001
318400             MOVE SQLCA      TO DP013-SQLCA                       31840001
318500             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           31850001
318600             SET DP013-DB2-ABEND                                  31860001
318700                             TO TRUE                              31870001
318800             SET DP013-ROLLBACK                                   31880001
318900                             TO TRUE                              31890001
319000             PERFORM 9999-WRITE-CICS-LOG-MSG                      31900001
319100             SET PS-DUMP-TO-LOG       TO TRUE                     31910001
319200             SET SU044-DATABASE-BUSY TO TRUE                      31920001
319300         WHEN SQLWARN0 NOT = SPACES                               31930001
319400         WHEN SQLCODE NOT EQUAL ZERO                              31940001
319500              move '1650'  to  PV-CSSL-PARA                       31950076
319600              perform 8110-WRITE-suws044-TO-CSSL                  31960079
319700                                                                  31970076
319800             MOVE '1650-SELECT-ORIGINAL-PKSLIP'                   31980001
319900                             TO DP013-PARAGRAPH                   31990001
320000             MOVE 'SUKUT705 - GET AUTO FA PKSLIP DATA'            32000001
320100                             TO DP013-MESSAGE-TEXT(1)             32010001
320200             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 32020001
320300             MOVE SU044-ORIG-PKSL-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ32030001
320400             STRING 'PO:'       PV-DISPLAY-PO-NBR                 32040090
320500                    ' ORIG:'    PV-DISPLAY-PKSLIP-SEQ             32050090
320600          DELIMITED BY SIZE                                       32060090
320700                           INTO DP013-MESSAGE-TEXT(2)             32070001
320800             MOVE SQLCA      TO DP013-SQLCA                       32080001
320900             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           32090001
321000             SET DP013-DB2-ABEND                                  32100001
321100                             TO TRUE                              32110001
321200             SET DP013-ROLLBACK                                   32120001
321300                             TO TRUE                              32130001
321400             PERFORM 9999-WRITE-CICS-LOG-MSG                      32140001
321500             SET PS-DUMP-TO-LOG       TO TRUE                     32150001
321600             SET SU044-INVALID-SQL TO TRUE                        32160001
321700     END-EVALUATE.                                                32170001
321800                                                                  32180001
321900 1651-SELECT-OPEN-PKSLIP.                                         32190012
322000                                                                  32200076
322100     IF  PS-BLD-INTERNAL-TABLE-YES                                32210076
322200         MOVE  '1651'  TO  PT-CURR-PARA                           32220076
322300         PERFORM 8120-INTERNAL-TABLE                              32230083
322400     END-IF.                                                      32240076
322500                                                                  32250076
322600     EXEC SQL                                                     32260001
322700         SELECT                                                   32270001
322800              PO_NBR                                              32280001
322900             ,SEQ_NBR                                             32290001
323000             ,CRE_TMST                                            32300001
323100             ,VER_STAT_CDE                                        32310001
323200             ,OPER_UNT_ID                                         32320001
323300             ,FCLTY_ID                                            32330001
323400             ,PKSL_NBR                                            32340001
323500             ,STR_DEST_NBR                                        32350001
323600             ,REC_SEQ_NBR                                         32360001
323700             ,SHIPT_ID                                            32370001
323800             ,BOL_NBR                                             32380001
323900             ,PRO_NBR                                             32390001
324000             ,PKSL_STAT_CDE                                       32400001
324100             ,CRE_UID                                             32410001
324200             ,PO_VER_NBR                                          32420001
324300             ,CRE_SRC_CDE                                         32430001
324400             ,EXPTED_PKG_QTY                                      32440001
324500             ,OWNER_SCAC_ID                                       32450001
324600             ,ASN_NBR                                             32460001
324700             ,VEND_SHIP_DTE                                       32470001
324800             ,PKSL_PG_CNT                                         32480001
324900             ,CONTNR_ID                                           32490001
325000             ,ORIG_PKSL_SEQ_NBR                                   32500001
325100          INTO :PV-PKSLIP-PO-NBR                                  32510001
325200             , :PV-PKSLIP-SEQ-NBR                                 32520001
325300             , :PV-PKSLIP-CRE-TMST                                32530001
325400             , :PV-PKSLIP-VER-STAT-CDE                            32540001
325500             , :PV-PKSLIP-OPER-UNT-ID                             32550001
325600             , :PV-PKSLIP-FCLTY-ID                                32560001
325700             , :PV-PKSLIP-PKSL-NBR                                32570001
325800             , :PV-PKSLIP-STR-DEST-NBR                            32580001
325900             , :PV-PKSLIP-REC-SEQ-NBR                             32590001
326000             , :PV-PKSLIP-SHIPT-ID                                32600001
326100             , :PV-PKSLIP-BOL-NBR                                 32610001
326200             , :PV-PKSLIP-PRO-NBR                                 32620001
326300             , :PV-PKSLIP-PKSL-STAT-CDE                           32630001
326400             , :PV-PKSLIP-CRE-UID                                 32640001
326500             , :PV-PKSLIP-PO-VER-NBR                              32650001
326600             , :PV-PKSLIP-CRE-SRC-CDE                             32660001
326700             , :PV-PKSLIP-EXPTED-PKG-QTY                          32670001
326800             , :PV-PKSLIP-OWNER-SCAC-ID                           32680001
326900             , :PV-PKSLIP-ASN-NBR                                 32690001
327000             , :PV-PKSLIP-VEND-SHIP-DTE                           32700001
327100             , :PV-PKSLIP-PKSL-PG-CNT                             32710001
327200             , :PV-PKSLIP-CONTNR-ID                               32720001
327300             , :PV-PKSLIP-ORIG-PKSL-SEQ-NBR                       32730001
327400          FROM TPKSLIP A                                          32740001
327500          WHERE A.PO_NBR          = :DK-PO-NBR                    32750001
327600            AND A.REC_SEQ_NBR     = 0                             32760001
327700            AND A.SEQ_NBR         = :SU044-NEW-PKSL-SEQ-NBR       32770001
327800            AND A.VER_STAT_CDE    =  'A'                          32780001
327900     END-EXEC.                                                    32790001
328000                                                                  32800001
328100     EVALUATE TRUE                                                32810001
328200         WHEN SQLCODE = ZERO                                      32820001
328300             CONTINUE                                             32830001
328400         WHEN SQLCODE = -904                                      32840001
328500         WHEN SQLCODE = -911                                      32850001
328600              move '1651'  to  PV-CSSL-PARA                       32860076
328700              perform 8110-WRITE-suws044-TO-CSSL                  32870079
328800                                                                  32880076
328900             MOVE '1651-SELECT-OPEN-PKSLIP'                       32890001
329000                             TO DP013-PARAGRAPH                   32900001
329100             MOVE 'SUKUT705 - GET OPEN PKSLIP DATA'               32910001
329200                             TO DP013-MESSAGE-TEXT(1)             32920001
329300             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 32930001
329400             MOVE SU044-NEW-PKSL-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ 32940001
329500             STRING 'PO:'       PV-DISPLAY-PO-NBR                 32950090
329600                    ' NEW:'     PV-DISPLAY-PKSLIP-SEQ             32960090
329700                                DELIMITED BY SIZE                 32970090
329800                           INTO DP013-MESSAGE-TEXT(2)             32980001
329900             MOVE SQLCA      TO DP013-SQLCA                       32990001
330000             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           33000001
330100             SET DP013-DB2-ABEND                                  33010001
330200                             TO TRUE                              33020001
330300             SET DP013-ROLLBACK                                   33030001
330400                             TO TRUE                              33040001
330500             PERFORM 9999-WRITE-CICS-LOG-MSG                      33050001
330600             SET PS-DUMP-TO-LOG       TO TRUE                     33060001
330700             SET SU044-DATABASE-BUSY TO TRUE                      33070001
330800         WHEN SQLWARN0 NOT = SPACES                               33080001
330900         WHEN SQLCODE NOT EQUAL ZERO                              33090001
331000              move '1651'  to  PV-CSSL-PARA                       33100076
331100              perform 8110-WRITE-suws044-TO-CSSL                  33110079
331200                                                                  33120076
331300             MOVE '1651-SELECT-OPEN-PKSLIP'                       33130001
331400                             TO DP013-PARAGRAPH                   33140001
331500             MOVE 'SUKUT705 - GET OPEN FA PKSLIP DATA'            33150001
331600                             TO DP013-MESSAGE-TEXT(1)             33160001
331700             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 33170001
331800             MOVE SU044-NEW-PKSL-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ 33180001
331900             STRING 'PO:'       PV-DISPLAY-PO-NBR                 33190090
332000                    ' NEW:'     PV-DISPLAY-PKSLIP-SEQ             33200090
332100                                DELIMITED BY SIZE                 33210090
332200                           INTO DP013-MESSAGE-TEXT(2)             33220001
332300             MOVE SQLCA      TO DP013-SQLCA                       33230001
332400             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           33240001
332500             SET DP013-DB2-ABEND                                  33250001
332600                             TO TRUE                              33260001
332700             SET DP013-ROLLBACK                                   33270001
332800                             TO TRUE                              33280001
332900             PERFORM 9999-WRITE-CICS-LOG-MSG                      33290001
333000             SET PS-DUMP-TO-LOG       TO TRUE                     33300001
333100             SET SU044-INVALID-SQL TO TRUE                        33310001
333200     END-EVALUATE.                                                33320001
333300                                                                  33330001
333400 1700-INACTV-ORIGINAL-PKSLIP.                                     33340001
333500                                                                  33350076
333600     IF  PS-BLD-INTERNAL-TABLE-YES                                33360076
333700         MOVE  '1700'  TO  PT-CURR-PARA                           33370076
333800         PERFORM 8120-INTERNAL-TABLE                              33380083
333900     END-IF.                                                      33390076
334000                                                                  33400076
334100     EXEC SQL                                                     33410001
334200          UPDATE TPKSLIP                                          33420001
334300          SET   VER_STAT_CDE    = 'I'                             33430001
334400          WHERE PO_NBR          = :DK-PO-NBR                      33440001
334500            AND REC_SEQ_NBR     = :SU044-ORIG-REC-SEQ-NBR         33450001
334600            AND SEQ_NBR         = :SU044-ORIG-PKSL-SEQ-NBR        33460001
334700            AND VER_STAT_CDE    =  'A'                            33470001
334800     END-EXEC.                                                    33480001
334900                                                                  33490001
335000     EVALUATE TRUE                                                33500001
335100         WHEN SQLCODE = ZERO                                      33510001
335200             CONTINUE                                             33520001
335300         WHEN SQLCODE = -904                                      33530001
335400         WHEN SQLCODE = -911                                      33540001
335500              move '1700'  to  PV-CSSL-PARA                       33550076
335600              perform 8110-WRITE-suws044-TO-CSSL                  33560079
335700                                                                  33570076
335800             MOVE '1700-INACTV-ORIGINAL-PKSLIP'                   33580001
335900                             TO DP013-PARAGRAPH                   33590001
336000             MOVE 'SUKUT705 - UPD PKSLIP TO INACTV '              33600001
336100                             TO DP013-MESSAGE-TEXT(1)             33610001
336200             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 33620001
336300             MOVE SU044-ORIG-PKSL-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ33630001
336400             STRING 'PO NBR: '         DELIMITED BY SIZE          33640001
336500                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          33650001
336600                    'ORIG SEQ'         DELIMITED BY SIZE          33660001
336700              PV-DISPLAY-PKSLIP-SEQ    DELIMITED BY SIZE          33670001
336800                           INTO DP013-MESSAGE-TEXT(2)             33680001
336900             MOVE SQLCA      TO DP013-SQLCA                       33690001
337000             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           33700001
337100             SET DP013-DB2-ABEND                                  33710001
337200                             TO TRUE                              33720001
337300             SET DP013-ROLLBACK                                   33730001
337400                             TO TRUE                              33740001
337500             PERFORM 9999-WRITE-CICS-LOG-MSG                      33750001
337600             SET PS-DUMP-TO-LOG       TO TRUE                     33760001
337700             SET SU044-DATABASE-BUSY TO TRUE                      33770001
337800         WHEN SQLWARN0 NOT = SPACES                               33780001
337900         WHEN SQLCODE NOT EQUAL ZERO                              33790001
338000              move '1700'  to  PV-CSSL-PARA                       33800076
338100              perform 8110-WRITE-suws044-TO-CSSL                  33810079
338200                                                                  33820076
338300             MOVE '1700-INACTV-ORIGINAL-PKSLIP'                   33830001
338400                             TO DP013-PARAGRAPH                   33840001
338500             MOVE 'SUKUT705 - UPD PKSLIP TO INACTV'               33850001
338600                             TO DP013-MESSAGE-TEXT(1)             33860001
338700             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 33870001
338800             MOVE SU044-ORIG-PKSL-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ33880001
338900             STRING 'PO NBR: '         DELIMITED BY SIZE          33890001
339000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          33900001
339100                    'ORIG SEQ: '       DELIMITED BY SIZE          33910001
339200               PV-DISPLAY-PKSLIP-SEQ   DELIMITED BY SIZE          33920001
339300                           INTO DP013-MESSAGE-TEXT(2)             33930001
339400             MOVE SQLCA      TO DP013-SQLCA                       33940001
339500             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           33950001
339600             SET DP013-DB2-ABEND                                  33960001
339700                             TO TRUE                              33970001
339800             SET DP013-ROLLBACK                                   33980001
339900                             TO TRUE                              33990001
340000             PERFORM 9999-WRITE-CICS-LOG-MSG                      34000001
340100             SET PS-DUMP-TO-LOG       TO TRUE                     34010001
340200             SET SU044-INVALID-SQL TO TRUE                        34020001
340300     END-EVALUATE.                                                34030001
340400                                                                  34040001
340500 1701-INACTV-OPEN-PKSLIP.                                         34050012
340600                                                                  34060076
340700     IF  PS-BLD-INTERNAL-TABLE-YES                                34070076
340800         MOVE  '1701'  TO  PT-CURR-PARA                           34080076
340900         PERFORM 8120-INTERNAL-TABLE                              34090083
341000     END-IF.                                                      34100076
341100                                                                  34110001
341200     EXEC SQL                                                     34120001
341300          UPDATE TPKSLIP                                          34130001
341400          SET   VER_STAT_CDE    = 'I'                             34140001
341500          WHERE PO_NBR          = :DK-PO-NBR                      34150001
341600            AND REC_SEQ_NBR     = 0                               34160001
341700            AND SEQ_NBR         = :SU044-NEW-PKSL-SEQ-NBR         34170001
341800            AND VER_STAT_CDE    =  'A'                            34180001
341900     END-EXEC.                                                    34190001
342000                                                                  34200001
342100     EVALUATE TRUE                                                34210001
342200         WHEN SQLCODE = ZERO                                      34220001
342300             CONTINUE                                             34230001
342400         WHEN SQLCODE = -904                                      34240001
342500         WHEN SQLCODE = -911                                      34250001
342600              move '1701'  to  PV-CSSL-PARA                       34260076
342700              perform 8110-WRITE-suws044-TO-CSSL                  34270079
342800                                                                  34280076
342900             MOVE '1701-INACTV-OPEN-PKSLIP'                       34290001
343000                             TO DP013-PARAGRAPH                   34300001
343100             MOVE 'SUKUT705 - UPD OPEN PKSLIP TO INACTV '         34310001
343200                             TO DP013-MESSAGE-TEXT(1)             34320001
343300             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 34330001
343400             MOVE SU044-NEW-PKSL-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ 34340001
343500             STRING 'PO NBR: '         DELIMITED BY SIZE          34350001
343600                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          34360001
343700                    'NEW SEQ'         DELIMITED BY SIZE           34370001
343800              PV-DISPLAY-PKSLIP-SEQ    DELIMITED BY SIZE          34380001
343900                           INTO DP013-MESSAGE-TEXT(2)             34390001
344000             MOVE SQLCA      TO DP013-SQLCA                       34400001
344100             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           34410001
344200             SET DP013-DB2-ABEND                                  34420001
344300                             TO TRUE                              34430001
344400             SET DP013-ROLLBACK                                   34440001
344500                             TO TRUE                              34450001
344600             PERFORM 9999-WRITE-CICS-LOG-MSG                      34460001
344700             SET PS-DUMP-TO-LOG       TO TRUE                     34470001
344800             SET SU044-DATABASE-BUSY TO TRUE                      34480001
344900         WHEN SQLWARN0 NOT = SPACES                               34490001
345000         WHEN SQLCODE NOT EQUAL ZERO                              34500001
345100              move '1701'  to  PV-CSSL-PARA                       34510076
345200              perform 8110-WRITE-suws044-TO-CSSL                  34520079
345300                                                                  34530076
345400             MOVE '1701-INACTV-OPEN-PKSLIP'                       34540001
345500                             TO DP013-PARAGRAPH                   34550001
345600             MOVE 'SUKUT705 - UPD OPEN PKSLIP TO INACTV'          34560001
345700                             TO DP013-MESSAGE-TEXT(1)             34570001
345800             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 34580001
345900             MOVE SU044-NEW-PKSL-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ 34590001
346000             STRING 'PO NBR: '         DELIMITED BY SIZE          34600001
346100                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          34610001
346200                    'NEW SEQ: '       DELIMITED BY SIZE           34620001
346300               PV-DISPLAY-PKSLIP-SEQ   DELIMITED BY SIZE          34630001
346400                           INTO DP013-MESSAGE-TEXT(2)             34640001
346500             MOVE SQLCA      TO DP013-SQLCA                       34650001
346600             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           34660001
346700             SET DP013-DB2-ABEND                                  34670001
346800                             TO TRUE                              34680001
346900             SET DP013-ROLLBACK                                   34690001
347000                             TO TRUE                              34700001
347100             PERFORM 9999-WRITE-CICS-LOG-MSG                      34710001
347200             SET PS-DUMP-TO-LOG       TO TRUE                     34720001
347300             SET SU044-INVALID-SQL TO TRUE                        34730001
347400     END-EVALUATE.                                                34740001
347500                                                                  34750001
347600 1750-UPDATE-ORIGINAL-PKSLIP.                                     34760001
347700                                                                  34770076
347800     IF  PS-BLD-INTERNAL-TABLE-YES                                34780076
347900         MOVE  '1750'  TO  PT-CURR-PARA                           34790076
348000         PERFORM 8120-INTERNAL-TABLE                              34800084
348100     END-IF.                                                      34810076
348200                                                                  34820001
348300     EXEC SQL                                                     34830001
348400        INSERT INTO TPKSLIP                                       34840001
348500            ( PO_NBR                                              34850001
348600             ,SEQ_NBR                                             34860001
348700             ,CRE_TMST                                            34870001
348800             ,VER_STAT_CDE                                        34880001
348900             ,OPER_UNT_ID                                         34890001
349000             ,FCLTY_ID                                            34900001
349100             ,PKSL_NBR                                            34910001
349200             ,STR_DEST_NBR                                        34920001
349300             ,REC_SEQ_NBR                                         34930001
349400             ,SHIPT_ID                                            34940001
349500             ,BOL_NBR                                             34950001
349600             ,PRO_NBR                                             34960001
349700             ,PKSL_STAT_CDE                                       34970001
349800             ,CRE_UID                                             34980001
349900             ,PO_VER_NBR                                          34990001
350000             ,CRE_SRC_CDE                                         35000001
350100             ,EXPTED_PKG_QTY                                      35010001
350200             ,OWNER_SCAC_ID                                       35020001
350300             ,ASN_NBR                                             35030001
350400             ,VEND_SHIP_DTE                                       35040001
350500             ,PKSL_PG_CNT                                         35050001
350600             ,CONTNR_ID                                           35060001
350700             ,ORIG_PKSL_SEQ_NBR                                   35070001
350800           )                                                      35080001
350900          VALUES                                                  35090001
351000             ( :PV-PKSLIP-PO-NBR                                  35100001
351100             , :PV-PKSLIP-SEQ-NBR                                 35110001
351200             ,  CURRENT TIMESTAMP                                 35120001
351300             , :PC-A                                              35130001
351400             , :SU044-OPER-UNT-ID                                 35140001
351500             , :PV-PKSLIP-FCLTY-ID                                35150001
351600             , :PV-PKSLIP-PKSL-NBR                                35160001
351700             , :PV-PKSLIP-STR-DEST-NBR                            35170001
351800             , :SU044-NEW-REC-SEQ-NBR                             35180001
351900             , :PV-PKSLIP-SHIPT-ID                                35190001
352000             , :PV-PKSLIP-BOL-NBR                                 35200001
352100             , :PV-PKSLIP-PRO-NBR                                 35210001
352200             , :PV-PKSLIP-PKSL-STAT-CDE                           35220001
352300             , :PV-PKSLIP-CRE-UID                                 35230001
352400             , :PV-PKSLIP-PO-VER-NBR                              35240001
352500             , :PV-PKSLIP-CRE-SRC-CDE                             35250001
352600             , :PV-PKSLIP-EXPTED-PKG-QTY                          35260001
352700             , :PV-PKSLIP-OWNER-SCAC-ID                           35270001
352800             , :PV-PKSLIP-ASN-NBR                                 35280001
352900             , :PV-PKSLIP-VEND-SHIP-DTE                           35290001
353000             , :PV-PKSLIP-PKSL-PG-CNT                             35300001
353100             , :PV-PKSLIP-CONTNR-ID                               35310001
353200             , :PKSLIP-ORIG-PKSL-SEQ-NBR )                        35320001
353300     END-EXEC.                                                    35330001
353400                                                                  35340001
353500     EVALUATE TRUE                                                35350001
353600         WHEN SQLCODE = ZERO                                      35360001
353700             CONTINUE                                             35370001
353800         WHEN SQLCODE = -904                                      35380001
353900         WHEN SQLCODE = -911                                      35390001
354000              move '1750'  to  PV-CSSL-PARA                       35400076
354100              perform 8110-WRITE-suws044-TO-CSSL                  35410079
354200                                                                  35420076
354300             MOVE '1750-UPDATE-ORIGINAL-PKSLIP'                   35430001
354400                             TO DP013-PARAGRAPH                   35440001
354500             MOVE 'SUKUT705 - UPD FA PKSLIP RECVR NBR'            35450001
354600                             TO DP013-MESSAGE-TEXT(1)             35460001
354700             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 35470001
354800             STRING 'PO NBR: '         DELIMITED BY SIZE          35480001
354900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          35490001
355000                           INTO DP013-MESSAGE-TEXT(2)             35500001
355100             MOVE SQLCA      TO DP013-SQLCA                       35510001
355200             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           35520001
355300             SET DP013-DB2-ABEND                                  35530001
355400                             TO TRUE                              35540001
355500             SET DP013-ROLLBACK                                   35550001
355600                             TO TRUE                              35560001
355700             PERFORM 9999-WRITE-CICS-LOG-MSG                      35570001
355800             SET PS-DUMP-TO-LOG       TO TRUE                     35580001
355900             SET SU044-DATABASE-BUSY TO TRUE                      35590001
356000         WHEN SQLWARN0 NOT = SPACES                               35600001
356100         WHEN SQLCODE NOT EQUAL ZERO                              35610001
356200              move '1750'  to  PV-CSSL-PARA                       35620076
356300              perform 8110-WRITE-suws044-TO-CSSL                  35630079
356400                                                                  35640076
356500             MOVE '1750-UPDATE-ORIGINAL-PKSLIP'                   35650001
356600                             TO DP013-PARAGRAPH                   35660001
356700             MOVE 'SUKUT705 - UPD FA PKSLIP RECVR NBR'            35670001
356800                             TO DP013-MESSAGE-TEXT(1)             35680001
356900             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 35690001
357000             MOVE PV-PKSLIP-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ      35700001
357100             STRING 'PO NBR: '         DELIMITED BY SIZE          35710001
357200                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          35720001
357300                    'PKSL SEQ'         DELIMITED BY SIZE          35730001
357400                PV-DISPLAY-PKSLIP-SEQ  DELIMITED BY SIZE          35740001
357500                           INTO DP013-MESSAGE-TEXT(2)             35750001
357600             MOVE SQLCA      TO DP013-SQLCA                       35760001
357700             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           35770001
357800             SET DP013-DB2-ABEND                                  35780001
357900                             TO TRUE                              35790001
358000             SET DP013-ROLLBACK                                   35800001
358100                             TO TRUE                              35810001
358200             PERFORM 9999-WRITE-CICS-LOG-MSG                      35820001
358300             SET PS-DUMP-TO-LOG       TO TRUE                     35830001
358400             SET SU044-INVALID-SQL TO TRUE                        35840001
358500     END-EVALUATE.                                                35850001
358600                                                                  35860001
358700 1751-UPDATE-OPEN-PKSLIP.                                         35870012
358800                                                                  35880076
358900     IF  PS-BLD-INTERNAL-TABLE-YES                                35890076
359000         MOVE  '1751'  TO  PT-CURR-PARA                           35900076
359100         PERFORM 8120-INTERNAL-TABLE                              35910083
359200     END-IF.                                                      35920076
359300                                                                  35930001
359400     EXEC SQL                                                     35940001
359500        INSERT INTO TPKSLIP                                       35950001
359600            ( PO_NBR                                              35960001
359700             ,SEQ_NBR                                             35970001
359800             ,CRE_TMST                                            35980001
359900             ,VER_STAT_CDE                                        35990001
360000             ,OPER_UNT_ID                                         36000001
360100             ,FCLTY_ID                                            36010001
360200             ,PKSL_NBR                                            36020001
360300             ,STR_DEST_NBR                                        36030001
360400             ,REC_SEQ_NBR                                         36040001
360500             ,SHIPT_ID                                            36050001
360600             ,BOL_NBR                                             36060001
360700             ,PRO_NBR                                             36070001
360800             ,PKSL_STAT_CDE                                       36080001
360900             ,CRE_UID                                             36090001
361000             ,PO_VER_NBR                                          36100001
361100             ,CRE_SRC_CDE                                         36110001
361200             ,EXPTED_PKG_QTY                                      36120001
361300             ,OWNER_SCAC_ID                                       36130001
361400             ,ASN_NBR                                             36140001
361500             ,VEND_SHIP_DTE                                       36150001
361600             ,PKSL_PG_CNT                                         36160001
361700             ,CONTNR_ID                                           36170001
361800             ,ORIG_PKSL_SEQ_NBR                                   36180001
361900           )                                                      36190001
362000          VALUES                                                  36200001
362100             ( :PV-PKSLIP-PO-NBR                                  36210001
362200             , :PV-PKSLIP-SEQ-NBR                                 36220001
362300             ,  CURRENT TIMESTAMP                                 36230001
362400             , :PC-A                                              36240001
362500             , :SU044-OPER-UNT-ID                                 36250001
362600             , :PV-PKSLIP-FCLTY-ID                                36260001
362700             , :PV-PKSLIP-PKSL-NBR                                36270001
362800             , :PV-PKSLIP-STR-DEST-NBR                            36280001
362900             , :SU044-NEW-REC-SEQ-NBR                             36290001
363000             , :PV-PKSLIP-SHIPT-ID                                36300001
363100             , :PV-PKSLIP-BOL-NBR                                 36310001
363200             , :PV-PKSLIP-PRO-NBR                                 36320001
363300             , :PV-PKSLIP-PKSL-STAT-CDE                           36330001
363400             , :PV-PKSLIP-CRE-UID                                 36340001
363500             , :PV-PKSLIP-PO-VER-NBR                              36350001
363600             , :PV-PKSLIP-CRE-SRC-CDE                             36360001
363700             , :PV-PKSLIP-EXPTED-PKG-QTY                          36370001
363800             , :PV-PKSLIP-OWNER-SCAC-ID                           36380001
363900             , :PV-PKSLIP-ASN-NBR                                 36390001
364000             , :PV-PKSLIP-VEND-SHIP-DTE                           36400001
364100             , :PV-PKSLIP-PKSL-PG-CNT                             36410001
364200             , :PV-PKSLIP-CONTNR-ID                               36420001
364300             , :PKSLIP-ORIG-PKSL-SEQ-NBR )                        36430001
364400     END-EXEC.                                                    36440001
364500                                                                  36450001
364600     EVALUATE TRUE                                                36460001
364700         WHEN SQLCODE = ZERO                                      36470001
364800             CONTINUE                                             36480001
364900         WHEN SQLCODE = -904                                      36490001
365000         WHEN SQLCODE = -911                                      36500001
365100              move '1751'  to  PV-CSSL-PARA                       36510076
365200              perform 8110-WRITE-suws044-TO-CSSL                  36520079
365300                                                                  36530076
365400             MOVE '1751-UPDATE-OPEN-PKSLIP'                       36540001
365500                             TO DP013-PARAGRAPH                   36550001
365600             MOVE 'SUKUT705 - UPD OPEN PKSLIP RECVR NBR'          36560001
365700                             TO DP013-MESSAGE-TEXT(1)             36570001
365800             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 36580001
365900             MOVE PV-PKSLIP-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ      36590001
366000             STRING 'PO NBR: '         DELIMITED BY SIZE          36600001
366100                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          36610001
366200                    'PKSL SEQ'         DELIMITED BY SIZE          36620001
366300                PV-DISPLAY-PKSLIP-SEQ  DELIMITED BY SIZE          36630001
366400                           INTO DP013-MESSAGE-TEXT(2)             36640001
366500             MOVE SQLCA      TO DP013-SQLCA                       36650001
366600             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           36660001
366700             SET DP013-DB2-ABEND                                  36670001
366800                             TO TRUE                              36680001
366900             SET DP013-ROLLBACK                                   36690001
367000                             TO TRUE                              36700001
367100             PERFORM 9999-WRITE-CICS-LOG-MSG                      36710001
367200             SET PS-DUMP-TO-LOG       TO TRUE                     36720001
367300             SET SU044-DATABASE-BUSY TO TRUE                      36730001
367400         WHEN SQLWARN0 NOT = SPACES                               36740001
367500         WHEN SQLCODE NOT EQUAL ZERO                              36750001
367600              move '1751'  to  PV-CSSL-PARA                       36760076
367700              perform 8110-WRITE-suws044-TO-CSSL                  36770079
367800                                                                  36780076
367900             MOVE '1751-UPDATE-OPEN-PKSLIP'                       36790001
368000                             TO DP013-PARAGRAPH                   36800001
368100             MOVE 'SUKUT705 - UPD OPEN PKSLIP RECVR NBR'          36810001
368200                             TO DP013-MESSAGE-TEXT(1)             36820001
368300             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 36830001
368400             MOVE PV-PKSLIP-SEQ-NBR TO PV-DISPLAY-PKSLIP-SEQ      36840001
368500             STRING 'PO NBR: '         DELIMITED BY SIZE          36850001
368600                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          36860001
368700                    'PKSL SEQ'         DELIMITED BY SIZE          36870001
368800                PV-DISPLAY-PKSLIP-SEQ  DELIMITED BY SIZE          36880001
368900                           INTO DP013-MESSAGE-TEXT(2)             36890001
369000             MOVE SQLCA      TO DP013-SQLCA                       36900001
369100             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           36910001
369200             SET DP013-DB2-ABEND                                  36920001
369300                             TO TRUE                              36930001
369400             SET DP013-ROLLBACK                                   36940001
369500                             TO TRUE                              36950001
369600             PERFORM 9999-WRITE-CICS-LOG-MSG                      36960001
369700             SET PS-DUMP-TO-LOG       TO TRUE                     36970001
369800             SET SU044-INVALID-SQL TO TRUE                        36980001
369900     END-EVALUATE.                                                36990001
370000                                                                  37000001
370100                                                                  37010001
370200 1800-UPD-PKSLIP-PBS-CKIN-RCVR.                                   37020001
370300                                                                  37030076
370400     IF  PS-BLD-INTERNAL-TABLE-YES                                37040076
370500         MOVE  '1800'  TO  PT-CURR-PARA                           37050076
370600         PERFORM 8120-INTERNAL-TABLE                              37060083
370700     END-IF.                                                      37070076
370800                                                                  37080001
370900     EXEC SQL                                                     37090001
371000          UPDATE TPKSLIP                                          37100001
371100          SET   REC_SEQ_NBR     = :SU044-NEW-REC-SEQ-NBR          37110001
371200          WHERE PO_NBR          = :DK-PO-NBR                      37120001
371300            AND BOL_NBR         = :PV-PKSLIP-BOL-NBR              37130001
371400            AND VER_STAT_CDE    =  'A'                            37140001
371500            AND REC_SEQ_NBR     =  0                              37150001
371600            AND OPER_UNT_ID     =  :SU044-OPER-UNT-ID             37160001
371700     END-EXEC.                                                    37170001
371800                                                                  37180001
371900     EVALUATE TRUE                                                37190001
372000         WHEN SQLCODE = ZERO                                      37200001
372100         WHEN SQLCODE = +100                                      37210001
372200             CONTINUE                                             37220001
372300         WHEN SQLCODE = -904                                      37230001
372400         WHEN SQLCODE = -911                                      37240001
372500              move '1800'  to  PV-CSSL-PARA                       37250076
372600              perform 8110-WRITE-suws044-TO-CSSL                  37260079
372700                                                                  37270076
372800             MOVE '1800-UPD-PKSLIP-PBS-CKIN-RCVR'                 37280001
372900                             TO DP013-PARAGRAPH                   37290001
373000             MOVE 'SUKUT705 - UPD PKSLIP RECV SEQ  '              37300001
373100                             TO DP013-MESSAGE-TEXT(1)             37310001
373200             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 37320001
373300             STRING 'PO NBR: '         DELIMITED BY SIZE          37330001
373400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          37340001
373500                    'BOL NBR '         DELIMITED BY SIZE          37350001
373600              PV-PKSLIP-BOL-NBR        DELIMITED BY SIZE          37360001
373700                           INTO DP013-MESSAGE-TEXT(2)             37370001
373800             MOVE SQLCA      TO DP013-SQLCA                       37380001
373900             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           37390001
374000             SET DP013-DB2-ABEND                                  37400001
374100                             TO TRUE                              37410001
374200             SET DP013-ROLLBACK                                   37420001
374300                             TO TRUE                              37430001
374400             PERFORM 9999-WRITE-CICS-LOG-MSG                      37440001
374500             SET PS-DUMP-TO-LOG       TO TRUE                     37450001
374600             SET SU044-DATABASE-BUSY TO TRUE                      37460001
374700         WHEN SQLWARN0 NOT = SPACES                               37470001
374800         WHEN SQLCODE NOT EQUAL ZERO                              37480001
374900              move '1800'  to  PV-CSSL-PARA                       37490076
375000              perform 8110-WRITE-suws044-TO-CSSL                  37500079
375100                                                                  37510076
375200             MOVE '1800-UPD-PKSLIP-PBS-CKIN-RCVR'                 37520001
375300                             TO DP013-PARAGRAPH                   37530001
375400             MOVE 'SUKUT705 - UPD PKSLIP REC SEQ  '               37540001
375500                             TO DP013-MESSAGE-TEXT(1)             37550001
375600             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 37560001
375700             STRING 'PO NBR: '         DELIMITED BY SIZE          37570001
375800                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          37580001
375900                    'BOL NBR:  '       DELIMITED BY SIZE          37590001
376000               PV-PKSLIP-BOL-NBR       DELIMITED BY SIZE          37600001
376100                           INTO DP013-MESSAGE-TEXT(2)             37610001
376200             MOVE SQLCA      TO DP013-SQLCA                       37620001
376300             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           37630001
376400             SET DP013-DB2-ABEND                                  37640001
376500                             TO TRUE                              37650001
376600             SET DP013-ROLLBACK                                   37660001
376700                             TO TRUE                              37670001
376800             PERFORM 9999-WRITE-CICS-LOG-MSG                      37680001
376900             SET PS-DUMP-TO-LOG       TO TRUE                     37690001
377000             SET SU044-INVALID-SQL TO TRUE                        37700001
377100     END-EVALUATE.                                                37710001
377200                                                                  37720001
377300 3000-PROCESS-PBS-VERIF.                                          37730001
377400                                                                  37740076
377500     IF  PS-BLD-INTERNAL-TABLE-YES                                37750076
377600         MOVE  '3000'  TO  PT-CURR-PARA                           37760076
377700         PERFORM 8120-INTERNAL-TABLE                              37770083
377800     END-IF.                                                      37780076
377900                                                                  37790076
378000     IF PS-SHOW-DEBUG-INFO                                        37800001
378100         STRING ' SUKUT705-3000-PROCESS-PBS-VERIF'                37810067
378200         DELIMITED BY SIZE                                        37820001
378300         INTO PV-CICS-MSG-AREA                                    37830001
378400         PERFORM 9990-WRITE-CICS                                  37840001
378500     END-IF.                                                      37850001
378600     SET SU044-SUCCESSFUL     TO TRUE.                            37860001
378700                                                                  37870001
378800     SET PS-NOT-END-OF-PBS-VER-CRT-CSR TO TRUE.                   37880001
378900     MOVE +0  TO  PV-COMMIT-COUNT                                 37890050
379000     PERFORM 3100-OPEN-PBS-VERF-CRTN-CSR                          37900001
379100     PERFORM 3200-FETCH-PBS-VERF-CRTN-CSR                         37910001
379200             UNTIL PS-END-OF-PBS-VER-CRT-CSR OR                   37920001
379300                   NOT SU044-SUCCESSFUL                           37930001
379400     PERFORM 3300-CLOSE-PBS-VERF-CRTN-CSR.                        37940001
379500                                                                  37950001
379600                                                                  37960001
379700                                                                  37970001
379800 3100-OPEN-PBS-VERF-CRTN-CSR.                                     37980001
379900                                                                  37990076
380000     IF  PS-BLD-INTERNAL-TABLE-YES                                38000076
380100         MOVE  '3100'  TO  PT-CURR-PARA                           38010076
380200         PERFORM 8120-INTERNAL-TABLE                              38020083
380300     END-IF.                                                      38030076
380400                                                                  38040076
380500     IF PS-SHOW-DEBUG-INFO                                        38050001
380600         STRING ' SUKUT705-3100-OPEN-PBS-VERF-CRTN-CSR'           38060067
380700         DELIMITED BY SIZE                                        38070001
380800         INTO PV-CICS-MSG-AREA                                    38080001
380900         PERFORM 9990-WRITE-CICS                                  38090001
381000     END-IF.                                                      38100001
381100                                                                  38110001
381200     EXEC SQL                                                     38120001
381300          OPEN VER-CRTN-PBS-CSR                                   38130001
381400     END-EXEC.                                                    38140001
381500                                                                  38150001
381600     EVALUATE TRUE                                                38160001
381700         WHEN SQLCODE = ZERO                                      38170001
381800              CONTINUE                                            38180001
381900         WHEN SQLWARN0 NOT = SPACES                               38190001
382000         WHEN SQLCODE  < ZERO                                     38200001
382100         WHEN SQLCODE  > ZERO                                     38210001
382200              move '3100'  to  PV-CSSL-PARA                       38220076
382300              perform 8110-WRITE-suws044-TO-CSSL                  38230079
382400                                                                  38240076
382500             MOVE '3100-OPEN-PBS-VERF-CRTN-CSR'                   38250001
382600                             TO DP013-PARAGRAPH                   38260001
382700             MOVE 'SUKUT705 - OPEN-PBS-VERF-CRTN-CSR'             38270001
382800                             TO DP013-MESSAGE-TEXT(1)             38280001
382900             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 38290001
383000             STRING 'PO NBR: '         DELIMITED BY SIZE          38300001
383100                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          38310001
383200                           INTO DP013-MESSAGE-TEXT(2)             38320001
383300             MOVE SQLCA      TO DP013-SQLCA                       38330001
383400             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           38340001
383500             SET DP013-DB2-ABEND                                  38350001
383600                             TO TRUE                              38360001
383700             SET DP013-ROLLBACK                                   38370001
383800                             TO TRUE                              38380001
383900             PERFORM 9999-WRITE-CICS-LOG-MSG                      38390001
384000             SET PS-DUMP-TO-LOG       TO TRUE                     38400001
384100             SET SU044-INVALID-SQL TO TRUE                        38410001
384200     END-EVALUATE.                                                38420001
384300                                                                  38430001
384400 EJECT                                                            38440001
384500                                                                  38450001
384600                                                                  38460001
384700 3200-FETCH-PBS-VERF-CRTN-CSR.                                    38470001
384800                                                                  38480076
384900     IF  PS-BLD-INTERNAL-TABLE-YES                                38490076
385000         MOVE  '3200'  TO  PT-CURR-PARA                           38500076
385100         PERFORM 8120-INTERNAL-TABLE                              38510083
385200     END-IF.                                                      38520076
385300                                                                  38530076
385400     IF PS-SHOW-DEBUG-INFO                                        38540001
385500         STRING ' SUKUT705-3200-FETCH-PBS-VERF-CRTN-CSR'          38550067
385600         DELIMITED BY SIZE                                        38560001
385700         INTO PV-CICS-MSG-AREA                                    38570001
385800         PERFORM 9990-WRITE-CICS                                  38580001
385900     END-IF.                                                      38590001
386000                                                                  38600001
386100     EXEC SQL                                                     38610001
386200          FETCH VER-CRTN-PBS-CSR                                  38620001
386300           INTO :INPKSU-SHIPT-UNT-ID                              38630001
386400             ,  :INPKSU-SEQ-NBR                                   38640001
386500             ,  :PKSLIP-STR-DEST-NBR                              38650001
386600             ,  :SHPUNT-ORGN-OPER-UNT-ID                          38660001
386700             ,  :PKSLIP-PKSL-STAT-CDE                             38670001
386800     END-EXEC.                                                    38680001
386900                                                                  38690001
387000     EVALUATE TRUE                                                38700001
387100         WHEN SQLCODE = ZERO                                      38710001
387200              ADD +1 TO PV-COMMIT-COUNT                           38720050
387300              MOVE INPKSU-SHIPT-UNT-ID TO SU044-SHIPT-UNT-ID      38730001
387400              MOVE INPKSU-SEQ-NBR      TO SU044-ORIG-PKSL-SEQ-NBR 38740001
387500              MOVE PKSLIP-STR-DEST-NBR TO SU044-DEST-STR-NBR      38750001
387600                                          DK-STR-DEST-NBR         38760001
387700              MOVE SHPUNT-ORGN-OPER-UNT-ID TO                     38770001
387800                                   SU044-CRTN-OPER-UNT-ID         38780001
387900              IF PKSLIP-PKSL-STAT-CDE = 'IN'                      38790001
388000                 PERFORM 4400-UPDATE-INACTV-PKSLIP                38800001
388100              ELSE                                                38810001
388200                 PERFORM 1000-PROCESS-PKSLIP                      38820001
388300              END-IF                                              38830001
388400         WHEN SQLCODE = +100                                      38840001
388500              SET PS-END-OF-PBS-VER-CRT-CSR TO TRUE               38850001
388600         WHEN SQLCODE = -903                                      38860001
388700         WHEN SQLCODE = -911                                      38870001
388800              move '3200'  to  PV-CSSL-PARA                       38880076
388900              perform 8110-WRITE-suws044-TO-CSSL                  38890079
389000                                                                  38900076
389100             MOVE '3200-FETCH-PBS-VERF-CRTN-CSR'                  38910001
389200                             TO DP013-PARAGRAPH                   38920001
389300             MOVE 'SUKUT705 -FETCH-PBS-VERF-CRTN-CSR'             38930001
389400                             TO DP013-MESSAGE-TEXT(1)             38940001
389500             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 38950001
389600             MOVE SU044-ORIG-REC-SEQ-NBR                          38960001
389700                                   TO PV-DISPLAY-RCVR-SEQ-NBR     38970001
389800             STRING 'PO NBR: '         DELIMITED BY SIZE          38980001
389900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          38990001
390000                    'REC SEQ '         DELIMITED BY SIZE          39000001
390100              PV-DISPLAY-RCVR-SEQ-NBR  DELIMITED BY SIZE          39010001
390200                           INTO DP013-MESSAGE-TEXT(2)             39020001
390300             MOVE SQLCA      TO DP013-SQLCA                       39030001
390400             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           39040001
390500             SET DP013-DB2-ABEND                                  39050001
390600                             TO TRUE                              39060001
390700             SET DP013-ROLLBACK                                   39070001
390800                             TO TRUE                              39080001
390900             PERFORM 9999-WRITE-CICS-LOG-MSG                      39090001
391000             SET PS-DUMP-TO-LOG       TO TRUE                     39100001
391100             SET SU044-DATABASE-BUSY TO TRUE                      39110001
391200         WHEN SQLWARN0 NOT = SPACES                               39120001
391300         WHEN SQLCODE NOT EQUAL ZERO                              39130001
391400              move '3200'  to  PV-CSSL-PARA                       39140076
391500              perform 8110-WRITE-suws044-TO-CSSL                  39150079
391600                                                                  39160076
391700             MOVE '3200-FETCH-PBS-VERF-CRTN-CSR'                  39170001
391800                             TO DP013-PARAGRAPH                   39180001
391900             MOVE 'SUKUT705 -FETCH-PBS-VERF-CRTN-CSR'             39190001
392000                             TO DP013-MESSAGE-TEXT(1)             39200001
392100             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 39210001
392200             MOVE SU044-ORIG-REC-SEQ-NBR                          39220001
392300                                   TO PV-DISPLAY-RCVR-SEQ-NBR     39230001
392400             STRING 'PO NBR: '         DELIMITED BY SIZE          39240001
392500                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          39250001
392600                    'REC SEQ: '        DELIMITED BY SIZE          39260001
392700               PV-DISPLAY-RCVR-SEQ-NBR DELIMITED BY SIZE          39270001
392800                           INTO DP013-MESSAGE-TEXT(2)             39280001
392900             MOVE SQLCA      TO DP013-SQLCA                       39290001
393000             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           39300001
393100             SET DP013-DB2-ABEND                                  39310001
393200                             TO TRUE                              39320001
393300             SET DP013-ROLLBACK                                   39330001
393400                             TO TRUE                              39340001
393500             PERFORM 9999-WRITE-CICS-LOG-MSG                      39350001
393600             SET PS-DUMP-TO-LOG       TO TRUE                     39360001
393700             SET SU044-INVALID-SQL    TO TRUE                     39370001
393800     END-EVALUATE.                                                39380001
393900                                                                  39390001
394000*----------------------------------------------------------------*39400001
394100* CLOSE THE LINE STORE CURSOR                                  *  39410001
394200*----------------------------------------------------------------*39420001
394300 3300-CLOSE-PBS-VERF-CRTN-CSR.                                    39430001
394400                                                                  39440076
394500     IF  PS-BLD-INTERNAL-TABLE-YES                                39450076
394600         MOVE  '3300'  TO  PT-CURR-PARA                           39460076
394700         PERFORM 8120-INTERNAL-TABLE                              39470083
394800     END-IF.                                                      39480076
394900                                                                  39490076
395000     IF PS-SHOW-DEBUG-INFO                                        39500001
395100         STRING ' SUKUT705-3300-CLOSE-PBS-VERF-CRTN-CSR'          39510067
395200         DELIMITED BY SIZE                                        39520001
395300         INTO PV-CICS-MSG-AREA                                    39530001
395400         PERFORM 9990-WRITE-CICS                                  39540001
395500     END-IF.                                                      39550001
395600                                                                  39560001
395700     EXEC SQL                                                     39570001
395800          CLOSE VER-CRTN-PBS-CSR                                  39580001
395900     END-EXEC.                                                    39590001
396000                                                                  39600001
396100     EVALUATE TRUE                                                39610001
396200         WHEN SQLCODE = ZERO                                      39620001
396300              CONTINUE                                            39630001
396400         WHEN SQLWARN0 NOT = SPACES                               39640001
396500         WHEN SQLCODE  < ZERO                                     39650001
396600         WHEN SQLCODE  > ZERO                                     39660001
396700              move '3300'  to  PV-CSSL-PARA                       39670076
396800              perform 8110-WRITE-suws044-TO-CSSL                  39680079
396900                                                                  39690076
397000             MOVE '3300-CLOSE-PBS-VERF-CRTN-CSR'                  39700001
397100                             TO DP013-PARAGRAPH                   39710001
397200             MOVE 'SUKUT705 -CLOSE-PBS-VERF-CRTN-CSR'             39720001
397300                             TO DP013-MESSAGE-TEXT(1)             39730001
397400             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 39740001
397500             STRING 'PO NBR: '         DELIMITED BY SIZE          39750001
397600                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          39760001
397700                           INTO DP013-MESSAGE-TEXT(2)             39770001
397800             MOVE SQLCA      TO DP013-SQLCA                       39780001
397900             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           39790001
398000             SET DP013-DB2-ABEND                                  39800001
398100                             TO TRUE                              39810001
398200             SET DP013-ROLLBACK                                   39820001
398300                             TO TRUE                              39830001
398400             PERFORM 9999-WRITE-CICS-LOG-MSG                      39840001
398500             SET PS-DUMP-TO-LOG       TO TRUE                     39850001
398600             SET SU044-INVALID-SQL TO TRUE                        39860001
398700     END-EVALUATE.                                                39870001
398800                                                                  39880001
398900                                                                  39890001
399000 4000-PROCESS-VERIFICATION.                                       39900001
399100                                                                  39910076
399200     IF  PS-BLD-INTERNAL-TABLE-YES                                39920076
399300         MOVE  '4000'  TO  PT-CURR-PARA                           39930076
399400         PERFORM 8120-INTERNAL-TABLE                              39940083
399500     END-IF.                                                      39950076
399600                                                                  39960076
399700     IF PS-SHOW-DEBUG-INFO                                        39970001
399800         STRING ' SUKUT705-4000-PROCESS-VERIFICATION'             39980067
399900         DELIMITED BY SIZE                                        39990001
400000         INTO PV-CICS-MSG-AREA                                    40000001
400100         PERFORM 9990-WRITE-CICS                                  40010001
400200     END-IF.                                                      40020001
400300     SET SU044-SUCCESSFUL     TO TRUE.                            40030001
400400                                                                  40040001
400500     SET PS-NOT-END-OF-VERF-CARTON-CSR TO TRUE.                   40050001
400600     MOVE +0  TO  PV-COMMIT-COUNT                                 40060045
400700     PERFORM 4100-OPEN-VERF-CARTON-CSR                            40070001
400800     PERFORM 4200-FETCH-VERF-CARTON-CSR                           40080001
400900             UNTIL PS-END-OF-VERF-CARTON-CSR OR                   40090001
401000                   NOT SU044-SUCCESSFUL                           40100001
401100     PERFORM 4300-CLOSE-VERF-CARTON-CSR.                          40110001
401200                                                                  40120001
401300                                                                  40130001
401400                                                                  40140001
401500 4100-OPEN-VERF-CARTON-CSR.                                       40150001
401600                                                                  40160076
401700     IF  PS-BLD-INTERNAL-TABLE-YES                                40170076
401800         MOVE  '4100'  TO  PT-CURR-PARA                           40180076
401900         PERFORM 8120-INTERNAL-TABLE                              40190083
402000     END-IF.                                                      40200076
402100                                                                  40210076
402200     STRING ' 4100-OPEN-VERF-CARTON-CSR'                          40220001
402300         DELIMITED BY SIZE                                        40230001
402400         INTO PV-CICS-MSG-AREA.                                   40240001
402500     PERFORM 9990-WRITE-CICS.                                     40250001
402600                                                                  40260001
402700     EXEC SQL                                                     40270001
402800          OPEN VERF-CARTON-CSR                                    40280001
402900     END-EXEC.                                                    40290001
403000                                                                  40300001
403100     EVALUATE TRUE                                                40310001
403200         WHEN SQLCODE = ZERO                                      40320001
403300              CONTINUE                                            40330001
403400         WHEN SQLWARN0 NOT = SPACES                               40340001
403500         WHEN SQLCODE  < ZERO                                     40350001
403600         WHEN SQLCODE  > ZERO                                     40360001
403700              move '4100'  to  PV-CSSL-PARA                       40370076
403800              perform 8110-WRITE-suws044-TO-CSSL                  40380079
403900                                                                  40390076
404000             MOVE '4100-OPEN-VERF-CARTON-CSR'                     40400001
404100                             TO DP013-PARAGRAPH                   40410001
404200             MOVE 'SUKUT705 - OPEN-VERF-CARTON-CSR'               40420001
404300                             TO DP013-MESSAGE-TEXT(1)             40430001
404400             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 40440001
404500             STRING 'PO NBR: '         DELIMITED BY SIZE          40450001
404600                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          40460001
404700                           INTO DP013-MESSAGE-TEXT(2)             40470001
404800             MOVE SQLCA      TO DP013-SQLCA                       40480001
404900             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           40490001
405000             SET DP013-DB2-ABEND                                  40500001
405100                             TO TRUE                              40510001
405200             SET DP013-ROLLBACK                                   40520001
405300                             TO TRUE                              40530001
405400             PERFORM 9999-WRITE-CICS-LOG-MSG                      40540001
405500             SET PS-DUMP-TO-LOG       TO TRUE                     40550001
405600             SET SU044-INVALID-SQL TO TRUE                        40560001
405700     END-EVALUATE.                                                40570001
405800                                                                  40580001
405900 EJECT                                                            40590001
406000                                                                  40600001
406100                                                                  40610001
406200 4200-FETCH-VERF-CARTON-CSR.                                      40620001
406300                                                                  40630076
406400     IF  PS-BLD-INTERNAL-TABLE-YES                                40640076
406500         MOVE  '4200'  TO  PT-CURR-PARA                           40650076
406600         PERFORM 8120-INTERNAL-TABLE                              40660083
406700     END-IF.                                                      40670076
406800                                                                  40680076
406900     IF PS-SHOW-DEBUG-INFO                                        40690001
407000         STRING ' SUKUT705-4200-FETCH-VERF-CARTON-CSR'            40700067
407100         DELIMITED BY SIZE                                        40710001
407200         INTO PV-CICS-MSG-AREA                                    40720001
407300         PERFORM 9990-WRITE-CICS                                  40730001
407400     END-IF.                                                      40740001
407500                                                                  40750001
407600     EXEC SQL                                                     40760001
407700          FETCH VERF-CARTON-CSR                                   40770001
407800           INTO :INPKSU-SHIPT-UNT-ID                              40780001
407900             ,  :INPKSU-SEQ-NBR                                   40790001
408000             ,  :PKSLIP-STR-DEST-NBR                              40800001
408100             ,  :PKSLIP-OPER-UNT-ID                               40810001
408200             ,  :PKSLIP-PKSL-STAT-CDE                             40820001
408300     END-EXEC.                                                    40830001
408400                                                                  40840001
408500     EVALUATE TRUE                                                40850001
408600         WHEN SQLCODE = ZERO                                      40860001
408700              IF  PS-SHOW-DEBUG-INFO                              40870068
408800                  MOVE INPKSU-SHIPT-UNT-ID TO PV-DISP-SSCC        40880068
408900                  MOVE INPKSU-SEQ-NBR      TO PV-DISP-SEQ         40890068
409000                  MOVE PKSLIP-STR-DEST-NBR TO PV-DISP-STR         40900068
409100                  MOVE PKSLIP-OPER-UNT-ID  TO PV-DISP-ORIG-OPER   40910068
409200                  PKSLIP-PKSL-STAT-CDE                            40920068
409300                  STRING ' SUKUT705-4200-'                        40930068
409400                           PV-DISP-SSCC '-'                       40940068
409500                           'PKSL SEQ:'  PV-DISP-SEQ               40950068
409600                           ' STR:'      PV-DISP-STR               40960068
409700                           'ORIG OPER:' PV-DISP-ORIG-OPER         40970068
409800                           'STAT:'      PKSLIP-PKSL-STAT-CDE      40980071
409900                  DELIMITED BY SIZE                               40990068
410000                       INTO PV-CICS-MSG-AREA                      41000068
410100                  PERFORM 9990-WRITE-CICS                         41010068
410200             END-IF                                               41020068
410300                                                                  41030068
410400            ADD +1   TO PV-COMMIT-COUNT                           41040045
410500            SET  PS-MULTIPLE-LINES-NO TO TRUE                     41050002
410600            IF SU044-RCVR-BULK                                    41060002
410700               PERFORM 4350-CHECK-FOR-MULT-LINES                  41070002
410800            END-IF                                                41080002
410900            IF PS-MULTIPLE-LINES-NO                               41090002
411000              MOVE INPKSU-SHIPT-UNT-ID TO SU044-SHIPT-UNT-ID      41100002
411100              MOVE INPKSU-SEQ-NBR      TO SU044-ORIG-PKSL-SEQ-NBR 41110002
411200              MOVE PKSLIP-STR-DEST-NBR TO SU044-DEST-STR-NBR      41120002
411300                                          DK-STR-DEST-NBR         41130002
411400              MOVE PKSLIP-OPER-UNT-ID  TO DK-OPER-UNT-ID-2        41140002
411500                                          SU044-CRTN-OPER-UNT-ID  41150002
411600              IF PKSLIP-PKSL-STAT-CDE = 'IN'                      41160002
411700                 PERFORM 4400-UPDATE-INACTV-PKSLIP                41170002
411800              ELSE                                                41180002
411900                 PERFORM 1000-PROCESS-PKSLIP                      41190002
412000              END-IF                                              41200002
412100            END-IF                                                41210002
412200         WHEN SQLCODE = +100                                      41220001
412300              SET PS-END-OF-VERF-CARTON-CSR TO TRUE               41230001
412400         WHEN SQLCODE = -904                                      41240001
412500         WHEN SQLCODE = -911                                      41250001
412600              move '4200'  to  PV-CSSL-PARA                       41260076
412700              perform 8110-WRITE-suws044-TO-CSSL                  41270079
412800                                                                  41280076
412900             MOVE '4200-FETCH-VERF-CARTON-CSR'                    41290001
413000                             TO DP013-PARAGRAPH                   41300001
413100             MOVE 'SUKUT705 -FETCH-VERF-CARTON-CSR'               41310001
413200                             TO DP013-MESSAGE-TEXT(1)             41320001
413300             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 41330001
413400             MOVE SU044-ORIG-REC-SEQ-NBR                          41340001
413500                                   TO PV-DISPLAY-RCVR-SEQ-NBR     41350001
413600             STRING 'PO NBR: '         DELIMITED BY SIZE          41360001
413700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          41370001
413800                    'REC SEQ:'         DELIMITED BY SIZE          41380001
413900               PV-DISPLAY-RCVR-SEQ-NBR DELIMITED BY SIZE          41390001
414000                           INTO DP013-MESSAGE-TEXT(2)             41400001
414100             MOVE SQLCA      TO DP013-SQLCA                       41410001
414200             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           41420001
414300             SET DP013-DB2-ABEND                                  41430001
414400                             TO TRUE                              41440001
414500             SET DP013-ROLLBACK                                   41450001
414600                             TO TRUE                              41460001
414700             PERFORM 9999-WRITE-CICS-LOG-MSG                      41470001
414800             SET PS-DUMP-TO-LOG       TO TRUE                     41480001
414900             SET SU044-DATABASE-BUSY TO TRUE                      41490001
415000         WHEN SQLWARN0 NOT = SPACES                               41500001
415100         WHEN SQLCODE NOT EQUAL ZERO                              41510001
415200              move '4200'  to  PV-CSSL-PARA                       41520076
415300              perform 8110-WRITE-suws044-TO-CSSL                  41530079
415400                                                                  41540076
415500             MOVE '4200-FETCH-VERF-CARTON-CSR'                    41550001
415600                             TO DP013-PARAGRAPH                   41560001
415700             MOVE 'SUKUT705 -FETCH-VERF-CARTON-CSR'               41570001
415800                             TO DP013-MESSAGE-TEXT(1)             41580001
415900             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 41590001
416000             MOVE SU044-ORIG-REC-SEQ-NBR                          41600001
416100                                   TO PV-DISPLAY-RCVR-SEQ-NBR     41610001
416200             STRING 'PO NBR: '         DELIMITED BY SIZE          41620001
416300                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          41630001
416400                    'REC SEQ:'         DELIMITED BY SIZE          41640001
416500               PV-DISPLAY-RCVR-SEQ-NBR DELIMITED BY SIZE          41650001
416600                           INTO DP013-MESSAGE-TEXT(2)             41660001
416700             MOVE SQLCA      TO DP013-SQLCA                       41670001
416800             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           41680001
416900             SET DP013-DB2-ABEND                                  41690001
417000                             TO TRUE                              41700001
417100             SET DP013-ROLLBACK                                   41710001
417200                             TO TRUE                              41720001
417300             PERFORM 9999-WRITE-CICS-LOG-MSG                      41730001
417400             SET PS-DUMP-TO-LOG       TO TRUE                     41740001
417500             SET SU044-INVALID-SQL    TO TRUE                     41750001
417600     END-EVALUATE.                                                41760001
417700                                                                  41770001
417800*----------------------------------------------------------------*41780001
417900* CLOSE THE LINE STORE CURSOR                                  *  41790001
418000*----------------------------------------------------------------*41800001
418100 4300-CLOSE-VERF-CARTON-CSR.                                      41810001
418200                                                                  41820076
418300     IF  PS-BLD-INTERNAL-TABLE-YES                                41830076
418400         MOVE  '4300'  TO  PT-CURR-PARA                           41840076
418500         PERFORM 8120-INTERNAL-TABLE                              41850083
418600     END-IF.                                                      41860076
418700                                                                  41870076
418800     IF PS-SHOW-DEBUG-INFO                                        41880001
418900         STRING ' SUKUT705-4300-CLOSE-VERF-CARTON-CSR'            41890067
419000         DELIMITED BY SIZE                                        41900001
419100         INTO PV-CICS-MSG-AREA                                    41910001
419200         PERFORM 9990-WRITE-CICS                                  41920001
419300     END-IF.                                                      41930001
419400                                                                  41940001
419500     EXEC SQL                                                     41950001
419600          CLOSE VERF-CARTON-CSR                                   41960001
419700     END-EXEC.                                                    41970001
419800                                                                  41980001
419900     EVALUATE TRUE                                                41990001
420000         WHEN SQLCODE = ZERO                                      42000001
420100              CONTINUE                                            42010001
420200         WHEN SQLWARN0 NOT = SPACES                               42020001
420300         WHEN SQLCODE  < ZERO                                     42030001
420400         WHEN SQLCODE  > ZERO                                     42040001
420500              move '4300'  to  PV-CSSL-PARA                       42050076
420600              perform 8110-WRITE-suws044-TO-CSSL                  42060079
420700                                                                  42070076
420800             MOVE '4300-CLOSE-VERF-CARTON-CSR'                    42080001
420900                             TO DP013-PARAGRAPH                   42090001
421000             MOVE 'SUKUT705 -CLOSE-VERF-CARTON-CSR'               42100001
421100                             TO DP013-MESSAGE-TEXT(1)             42110001
421200             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 42120001
421300             STRING 'PO NBR: '         DELIMITED BY SIZE          42130001
421400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          42140001
421500                           INTO DP013-MESSAGE-TEXT(2)             42150001
421600             MOVE SQLCA      TO DP013-SQLCA                       42160001
421700             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           42170001
421800             SET DP013-DB2-ABEND                                  42180001
421900                             TO TRUE                              42190001
422000             SET DP013-ROLLBACK                                   42200001
422100                             TO TRUE                              42210001
422200             PERFORM 9999-WRITE-CICS-LOG-MSG                      42220001
422300             SET PS-DUMP-TO-LOG       TO TRUE                     42230001
422400             SET SU044-INVALID-SQL TO TRUE                        42240001
422500     END-EVALUATE.                                                42250001
422600                                                                  42260001
422700 4350-CHECK-FOR-MULT-LINES.                                       42270002
422800                                                                  42280076
422900     IF  PS-BLD-INTERNAL-TABLE-YES                                42290076
423000         MOVE  '4350'  TO  PT-CURR-PARA                           42300076
423100         PERFORM 8120-INTERNAL-TABLE                              42310083
423200     END-IF.                                                      42320076
423300                                                                  42330076
423400     IF PS-SHOW-DEBUG-INFO                                        42340002
423500         STRING ' SUKUT705-4350-CHECK-FOR-MULT-LINES'             42350067
423600             DELIMITED BY SIZE                                    42360002
423700             INTO PV-CICS-MSG-AREA                                42370002
423800         PERFORM 9990-WRITE-CICS                                  42380002
423900     END-IF.                                                      42390002
424000     MOVE ZEROES       TO PV-DB2-CART-COMB-CNT.                   42400003
424100                                                                  42410002
424200     EXEC SQL                                                     42420002
424300        SELECT COUNT(*)                                           42430003
424400          INTO   :PV-DB2-CART-COMB-CNT                            42440003
424500        FROM  TSHPSUM C                                           42450003
424600        WHERE C.PO_NBR        = :SU044-PO                         42460003
424700          AND C.PKSL_SEQ_NBR  = :INPKSU-SEQ-NBR                   42470003
424800          AND C.CART_COMB_NBR  IN                                 42480003
424900             (SELECT DISTINCT (B.CART_COMB_NBR)                   42490003
425000                 FROM  TSHUUPC A                                  42500003
425100                     , TSHPSUM B                                  42510003
425200                 WHERE  A.SHIPT_UNT_ID = :INPKSU-SHIPT-UNT-ID     42520003
425300                   AND  A.TRN_NBR      = :SU044-PO                42530003
425400                   AND  A.TRN_NBR      =  B.PO_NBR                42540003
425500                   AND  B.PKSL_SEQ_NBR = :INPKSU-SEQ-NBR          42550003
425600                   AND  A.SHPD_QTY     = B.OTPK_UNT_QTY           42560003
425700                   AND  A.TRN_LNE_NBR  = B.PO_LNE_NBR)            42570003
425800     END-EXEC.                                                    42580002
425900                                                                  42590002
426000     EVALUATE TRUE                                                42600002
426100         WHEN SQLCODE = ZERO                                      42610002
426200             IF PV-DB2-CART-COMB-CNT > 1                          42620003
426300                SET PS-MULTIPLE-LINES-YES   TO TRUE               42630002
426400             END-IF                                               42640002
426500         WHEN SQLWARN0 NOT = SPACES                               42650002
426600         WHEN SQLCODE NOT EQUAL ZERO                              42660002
426700              move '4350'  to  PV-CSSL-PARA                       42670076
426800              perform 8110-WRITE-suws044-TO-CSSL                  42680079
426900                                                                  42690076
427000             MOVE '4350-CHECK-FOR-MULT-LINES'                     42700002
427100                             TO DP013-PARAGRAPH                   42710002
427200             MOVE 'SUKUT705 - CHECK MULT LINES '                  42720002
427300                             TO DP013-MESSAGE-TEXT(1)             42730002
427400             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 42740002
427500             STRING 'PO NBR: '         DELIMITED BY SIZE          42750002
427600                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          42760002
427700                           INTO DP013-MESSAGE-TEXT(2)             42770002
427800             MOVE DK-RCVR-SEQ-NBR                                 42780002
427900                             TO PV-DISPLAY-RCVR-SEQ-NBR           42790002
428000             STRING 'RECV SEQ: '       DELIMITED BY SIZE          42800002
428100                 PV-DISPLAY-RCVR-SEQ-NBR                          42810002
428200                                       DELIMITED BY SIZE          42820002
428300                           INTO DP013-MESSAGE-TEXT(4)             42830002
428400             MOVE SQLCA      TO DP013-SQLCA                       42840002
428500             MOVE 'TSHUUPC ' TO DP013-DB2-TABLE-NAME(1)           42850002
428600             SET DP013-DB2-ABEND                                  42860002
428700                             TO TRUE                              42870002
428800             SET DP013-ROLLBACK                                   42880002
428900                             TO TRUE                              42890002
429000             PERFORM 9999-WRITE-CICS-LOG-MSG                      42900002
429100             SET PS-DUMP-TO-LOG       TO TRUE                     42910002
429200             SET SU044-INVALID-SQL TO TRUE                        42920002
429300     END-EVALUATE.                                                42930002
429400*                                                                 42940002
429500 4400-UPDATE-INACTV-PKSLIP.                                       42950001
429600                                                                  42960076
429700     IF  PS-BLD-INTERNAL-TABLE-YES                                42970076
429800         MOVE  '4400'  TO  PT-CURR-PARA                           42980076
429900         PERFORM 8120-INTERNAL-TABLE                              42990083
430000     END-IF.                                                      43000076
430100                                                                  43010001
430200     EXEC SQL                                                     43020001
430300          UPDATE TPKSLIP                                          43030001
430400          SET   REC_SEQ_NBR     = 0                               43040001
430500          WHERE PO_NBR          = :DK-PO-NBR                      43050001
430600            AND SEQ_NBR         = :INPKSU-SEQ-NBR                 43060001
430700            AND VER_STAT_CDE    =  'A'                            43070001
430800     END-EXEC.                                                    43080001
430900                                                                  43090001
431000     EVALUATE TRUE                                                43100001
431100         WHEN SQLCODE = ZERO                                      43110001
431200             CONTINUE                                             43120001
431300         WHEN SQLCODE = -904                                      43130001
431400         WHEN SQLCODE = -911                                      43140001
431500              move '4400'  to  PV-CSSL-PARA                       43150076
431600              perform 8110-WRITE-suws044-TO-CSSL                  43160079
431700                                                                  43170076
431800             MOVE '4400-UPDATE-INACTV-PKSLIP '                    43180001
431900                             TO DP013-PARAGRAPH                   43190001
432000             MOVE 'SUKUT705 - UPD PKSLIP RECV SEQ  '              43200001
432100                             TO DP013-MESSAGE-TEXT(1)             43210001
432200             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 43220001
432300             MOVE INPKSU-SEQ-NBR     TO PV-DISPLAY-PKSLIP-SEQ     43230001
432400             STRING 'PO NBR: '         DELIMITED BY SIZE          43240001
432500                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          43250001
432600                    'ORIG SEQ'         DELIMITED BY SIZE          43260001
432700              PV-DISPLAY-PKSLIP-SEQ    DELIMITED BY SIZE          43270001
432800                           INTO DP013-MESSAGE-TEXT(2)             43280001
432900             MOVE SQLCA      TO DP013-SQLCA                       43290001
433000             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           43300001
433100             SET DP013-DB2-ABEND                                  43310001
433200                             TO TRUE                              43320001
433300             SET DP013-ROLLBACK                                   43330001
433400                             TO TRUE                              43340001
433500             PERFORM 9999-WRITE-CICS-LOG-MSG                      43350001
433600             SET PS-DUMP-TO-LOG       TO TRUE                     43360001
433700             SET SU044-DATABASE-BUSY TO TRUE                      43370001
433800         WHEN SQLWARN0 NOT = SPACES                               43380001
433900         WHEN SQLCODE NOT EQUAL ZERO                              43390001
434000              move '4400'  to  PV-CSSL-PARA                       43400076
434100              perform 8110-WRITE-suws044-TO-CSSL                  43410079
434200                                                                  43420076
434300             MOVE '4400-UPDATE-INACTV-PKSLIP '                    43430001
434400                             TO DP013-PARAGRAPH                   43440001
434500             MOVE 'SUKUT705 - UPD PKSLIP REC SEQ  '               43450001
434600                             TO DP013-MESSAGE-TEXT(1)             43460001
434700             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 43470001
434800             MOVE INPKSU-SEQ-NBR   TO PV-DISPLAY-PKSLIP-SEQ       43480001
434900             STRING 'PO NBR: '         DELIMITED BY SIZE          43490001
435000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          43500001
435100                    'ORIG SEQ: '       DELIMITED BY SIZE          43510001
435200               PV-DISPLAY-PKSLIP-SEQ   DELIMITED BY SIZE          43520001
435300                           INTO DP013-MESSAGE-TEXT(2)             43530001
435400             MOVE SQLCA      TO DP013-SQLCA                       43540001
435500             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(1)           43550001
435600             SET DP013-DB2-ABEND                                  43560001
435700                             TO TRUE                              43570001
435800             SET DP013-ROLLBACK                                   43580001
435900                             TO TRUE                              43590001
436000             PERFORM 9999-WRITE-CICS-LOG-MSG                      43600001
436100             SET PS-DUMP-TO-LOG       TO TRUE                     43610001
436200             SET SU044-INVALID-SQL TO TRUE                        43620001
436300     END-EVALUATE.                                                43630001
436400*----------------------------------------------------------------*43640001
436500*  LINK TO SUKUT703 TO CREATE A NEW RECEIVER                      43650001
436600*----------------------------------------------------------------*43660001
436700 7000-LINK-RCVR-CRE-SUKUT703.                                     43670001
436800                                                                  43680076
436900     IF  PS-BLD-INTERNAL-TABLE-YES                                43690076
437000         MOVE  '7000'  TO  PT-CURR-PARA                           43700076
437100         PERFORM 8120-INTERNAL-TABLE                              43710083
437200     END-IF.                                                      43720076
437300                                                                  43730062
437400* 03-28-2012 CHRISTINE TWIEHAUS WR40574 START                     43740062
437500     IF SU044-CARR-AUTH-ID = SPACES                               43750062
437600         PERFORM 1580-SEL-SHIPMT-VEH.                             43760062
437700* 03-28-2012 CHRISTINE TWIEHAUS WR40574 END                       43770062
437800                                                                  43780001
437900     MOVE LENGTH OF SU044-COMM-AREA                               43790001
438000                                         TO PV-COMMAREA-LENGTH.   43800001
438100                                                                  43810001
438200     EXEC CICS                                                    43820001
438300         LINK PROGRAM  (PC-RECEIVER-CREATE)                       43830001
438400              COMMAREA (SU044-COMM-AREA)                          43840001
438500              LENGTH   (PV-COMMAREA-LENGTH)                       43850001
438600              RESP     (PV-CICS-RESPONSE)                         43860001
438700     END-EXEC.                                                    43870001
438800                                                                  43880001
438900     EVALUATE TRUE                                                43890001
439000         WHEN SU044-SUCCESSFUL                                    43900001
439100             CONTINUE                                             43910001
439200         WHEN OTHER                                               43920001
439300             MOVE '7000-LINK-RCVR-CRE-SUKUT703'                   43930001
439400                             TO DP013-PARAGRAPH                   43940001
439500             MOVE 'SUKUT705 - LINK TO SUKUT703 '                  43950001
439600                             TO DP013-MESSAGE-TEXT(1)             43960001
439700             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 43970001
439800             STRING 'PO NBR: '         DELIMITED BY SIZE          43980001
439900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          43990001
440000                           INTO DP013-MESSAGE-TEXT(2)             44000001
440100             MOVE DK-RCVR-SEQ-NBR                                 44010001
440200                             TO PV-DISPLAY-RCVR-SEQ-NBR           44020001
440300             STRING 'RECV SEQ: '       DELIMITED BY SIZE          44030001
440400                 PV-DISPLAY-RCVR-SEQ-NBR                          44040001
440500                                       DELIMITED BY SIZE          44050001
440600                           INTO DP013-MESSAGE-TEXT(4)             44060001
440700             MOVE SQLCA      TO DP013-SQLCA                       44070001
440800             MOVE 'SUKUT703' TO DP013-DB2-TABLE-NAME(1)           44080001
440900             SET DP013-DB2-ABEND                                  44090001
441000                             TO TRUE                              44100001
441100             SET DP013-ROLLBACK                                   44110001
441200                             TO TRUE                              44120001
441300             PERFORM 9999-WRITE-CICS-LOG-MSG                      44130001
441400             SET PS-DUMP-TO-LOG       TO TRUE                     44140001
441500             SET SU044-INVALID-SQL TO TRUE                        44150001
441600     END-EVALUATE.                                                44160001
441700                                                                  44170001
441800*----------------------------------------------------------------*44180001
441900*  LINK TO SUKUT704 TO CREATE A NEW PACKSLIP AND DETACH A CARTON  44190001
442000*  AND ATTACH IT TO A NEW PACKSLIP                                44200001
442100*----------------------------------------------------------------*44210001
442200 7100-LINK-SUKUT704.                                              44220001
442300                                                                  44230076
442400     IF  PS-BLD-INTERNAL-TABLE-YES                                44240076
442500         MOVE  '7100'  TO  PT-CURR-PARA                           44250076
442600         PERFORM 8120-INTERNAL-TABLE                              44260083
442700     END-IF.                                                      44270076
442800                                                                  44280066
442900     IF PS-SHOW-DEBUG-INFO                                        44290066
443000         MOVE DK-PO-NBR              TO  PV-DISPLAY-PO-NBR        44300066
443100         MOVE DK-OPER-UNT-ID         TO  PV-DISPLAY-OPER-UNT-ID   44310066
443200         MOVE DK-STR-DEST-NBR        TO  PV-DISPLAY-DEST-OPER     44320066
443300         MOVE SQLCODE                TO  PV-DISPLAY-SQLCODE       44330066
443400         STRING   ' SUKUT705-7100-'                               44340066
443500                  ' TYPE:'                                        44350066
443600                  SU044-RCVR-TYPE-CDE                             44360066
443700                  ' FUNC:'                                        44370066
443800                  SU044-FUNCTION-SWITCH                           44380066
443900                  ' SRC:'                                         44390067
444000                  SU044-CALL-SOURCE-SWITCH                        44400066
444100                  ' UPD PKSL:'                                    44410066
444200                  SU044-UPDATE-PKSLIP-SW                          44420066
444300                  ' PKSL CRE:'                                    44430066
444400                  SU044-PKSLIP-CRE-SRCE                           44440066
444500                  ' RCVR CRE:'                                    44450066
444600                  SU044-RECEIVER-CREATE-SRC                       44460066
444700                  DELIMITED BY SIZE                               44470066
444800                                  INTO PV-CICS-MSG-AREA           44480066
444900         PERFORM 9990-WRITE-CICS                                  44490066
445000     END-IF.                                                      44500066
445100                                                                  44510066
445200     MOVE LENGTH OF SU044-COMM-AREA                               44520001
445300                                         TO PV-COMMAREA-LENGTH.   44530001
445400                                                                  44540001
445500     EXEC CICS                                                    44550001
445600         LINK PROGRAM  (PC-PKSLIP-CRE-DETACH)                     44560001
445700              COMMAREA (SU044-COMM-AREA)                          44570001
445800              LENGTH   (PV-COMMAREA-LENGTH)                       44580001
445900              RESP     (PV-CICS-RESPONSE)                         44590001
446000     END-EXEC.                                                    44600001
446100                                                                  44610001
446200     EVALUATE TRUE                                                44620001
446300         WHEN SU044-SUCCESSFUL                                    44630001
446400             CONTINUE                                             44640001
446500         WHEN OTHER                                               44650001
446600             MOVE '7100-LINK-SUKUT704 '                           44660001
446700                                TO DP013-PARAGRAPH                44670013
446800                                                                  44680013
446900             STRING 'SUKUT705 -LINK-SUKUT704 '                    44690013
447000                    ' - SUCCESS-IND=' SU044-SUCCESS-IND           44700013
447100                                DELIMITED BY SIZE                 44710013
447200                              INTO DP013-MESSAGE-TEXT(1)          44720013
447300                                                                  44730013
447400             MOVE DK-PO-NBR     TO PV-DISPLAY-PO-NBR              44740013
447500             MOVE SU044-ORIG-REC-SEQ-NBR                          44750013
447600                                TO PV-DISPLAY-RCVR-SEQ-NBR        44760013
447700                                                                  44770013
447800             STRING 'PO NBR: '     PV-DISPLAY-PO-NBR              44780013
447900                    '-'            PV-DISPLAY-RCVR-SEQ-NBR        44790013
448000                                   DELIMITED BY SIZE              44800013
448100                              INTO DP013-MESSAGE-TEXT(2)          44810013
448200                                                                  44820013
448300             MOVE SU044-CRA-RET-MSG                               44830013
448400                                TO DP013-MESSAGE-TEXT(3)          44840013
448500                                                                  44850013
448600             MOVE SU044-SQLCA   TO DP013-SQLCA                    44860013
448700                                                                  44870001
448800             SET DP013-DB2-ABEND                                  44880001
448900                             TO TRUE                              44890001
449000             SET DP013-ROLLBACK                                   44900001
449100                             TO TRUE                              44910001
449200             PERFORM 9999-WRITE-CICS-LOG-MSG                      44920001
449300             SET PS-DUMP-TO-LOG       TO TRUE                     44930001
449400             SET SU044-INVALID-SQL TO TRUE                        44940001
449500     END-EVALUATE.                                                44950001
449600                                                                  44960001
449700                                                                  44970001
449800 8000-CHECK-FOR-LOGGING.                                          44980001
449900                                                                  44990076
450000     IF  PS-BLD-INTERNAL-TABLE-YES                                45000076
450100         MOVE  '8000'  TO  PT-CURR-PARA                           45010076
450200         PERFORM 8120-INTERNAL-TABLE                              45020083
450300     END-IF.                                                      45030076
450400                                                                  45040001
450500     EXEC SQL                                                     45050001
450600          SELECT FUNC_TXT                                         45060001
450700            INTO :KRPRPM-FUNC-TXT                                 45070001
450800            FROM TKRPRPM                                          45080001
450900           WHERE LOC_ID            = :DK-OPER-UNT-ID              45090001
451000             AND INTFC_SYS_CDE    = 'KHL'                         45100001
451100             AND SYS_PRC_FUNC_CDE = 'SU705D'                      45110001
451200             AND FUNC_PRC_STAT_CDE = 'AC'                         45120001
451300            WITH UR                                               45130086
451400     END-EXEC.                                                    45140001
451500                                                                  45150001
451600     EVALUATE TRUE                                                45160001
451700         WHEN SQLCODE = ZERO                                      45170001
451800             IF KRPRPM-FUNC-TXT = 'Y'                             45180001
451900                 SET PS-SHOW-DEBUG-INFO  TO TRUE                  45190001
452000             ELSE                                                 45200001
452100                 SET PS-DONT-SHOW-DEBUG-INFO TO TRUE              45210001
452200             END-IF                                               45220001
452300         WHEN SQLCODE = +100                                      45230001
452400             SET PS-DONT-SHOW-DEBUG-INFO TO TRUE                  45240001
452500         WHEN SQLWARN0 NOT = SPACES                               45250001
452600         WHEN SQLCODE NOT EQUAL ZERO                              45260001
452700              move '8000'  to  PV-CSSL-PARA                       45270076
452800              perform 8110-WRITE-suws044-TO-CSSL                  45280079
452900                                                                  45290076
453000             SET PS-ERROR                                         45300001
453100                 SU044-INVALID-SQL    TO TRUE                     45310001
453200             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       45320001
453300             STRING   ' SUKUT705-8000-'                           45330001
453400                      ' CALLED BY-'                               45340001
453500                      SU044-PROGRAM-NAME                          45350001
453600                      '  SQLCODE='                                45360001
453700                      PV-DISPLAY-SQLCODE                          45370001
453800                      ' '                                         45380001
453900                      DELIMITED BY SIZE                           45390001
454000                                      INTO PV-CICS-MSG-AREA       45400001
454100             PERFORM 9999-WRITE-TO-CSSL                           45410001
454200             MOVE '8000-'                TO SU044-CRA-REQ-ID      45420001
454300             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      45430001
454400             SET SU044-INVALID-SQL TO TRUE                        45440001
454500             PERFORM 9998-RETURN                                  45450001
454600     END-EVALUATE.                                                45460001
454700                                                                  45470001
454800                                                                  45480001
454900*---------------------------------------------------------------* 45490073
455000* check parm table (TKRPRPM) to check for logging to CSSL       * 45500073
455100* IF PROGRAM IS TAKING TOO LONG TO RESPOND.  THE VALUE WILL     * 45510073
455200* BE seconds AND WILL BE USED TO DETERMINE IF WE SHOULD WRITE   * 45520073
455300* pt-pARA-tRACKING TABLE TO CSSL                                * 45530073
455400* check parm table (TKRPRPM) to check if will be building the   * 45540073
455500* internal table during processing.  this will be used when     * 45550073
455600* dc's report long resonse times                                * 45560073
455700*  2015-01-29 - DMH                                             * 45570073
455800*---------------------------------------------------------------* 45580073
455900 8100-CHECK-PARA-TRACK-SEC.                                       45590073
456000                                                                  45600076
456100     EXEC SQL                                                     45610073
456200          SELECT  FUNC_QTY                                        45620073
456300               ,  FUNC_txt                                        45630073
456400            INTO :PV-PARM-seconds                                 45640073
456500               , :PS-BLD-INTERNAL-TABLE-SW                        45650073
456600            FROM  TKRPRPM                                         45660073
456700           WHERE  LOC_ID            = :DK-OPER-UNT-ID             45670073
456800             AND  INTFC_SYS_CDE     = 'ACM'                       45680073
456900             AND  SYS_PRC_FUNC_CDE  = 'PATIM4'                    45690073
457000             AND  FUNC_PRC_STAT_CDE = 'AC'                        45700073
457100             AND  fUNC_BEG_TMST    <=  current timestamp          45710073
457200             AND  fUNC_END_TMST    >=  current timestamp          45720073
457300            WITH UR                                               45730073
457400     END-EXEC.                                                    45740073
457500                                                                  45750073
457600     EVALUATE TRUE                                                45760073
457700         WHEN SQLCODE = ZERO                                      45770073
457800              CONTINUE                                            45780073
457900                                                                  45790073
458000         WHEN SQLCODE = +100                                      45800073
458100              MOVE 999999999  TO  PV-PARM-SECONDS                 45810073
458200              SET  PS-BLD-INTERNAL-TABLE-NO   TO TRUE             45820073
458300                                                                  45830073
458400         WHEN SQLWARN0 NOT = SPACES                               45840073
458500         WHEN SQLCODE NOT EQUAL ZERO                              45850073
458600              move '8100'  to  PV-CSSL-PARA                       45860076
458700              perform 8110-WRITE-suws044-TO-CSSL                  45870079
458800                                                                  45880076
458900              MOVE '8100'  TO  PV-CSSL-PARA                       45890073
459000              PERFORM 8110-WRITE-suws044-TO-CSSL                  45900079
459100                                                                  45910073
459200              MOVE 999999999  TO  PV-PARM-SECONDS                 45920090
459300              SET PS-BLD-INTERNAL-TABLE-NO   TO  TRUE             45930073
459400              MOVE  SQLCODE           TO PV-DISPLAY-SQLCODE       45940073
459500              SET PS-ERROR                                        45950073
459600                  SU044-INVALID-SQL   TO TRUE                     45960073
459700              MOVE  SQLCODE           TO PV-DISPLAY-SQLCODE       45970073
459800              STRING   ' SUKUT705-8100-'                          45980073
459900                       ' CALLED BY:'     SU044-PROGRAM-NAME       45990073
460000                       ' SQL:'           PV-DISPLAY-SQLCODE       46000073
460100                       ' '                                        46010073
460200                       DELIMITED BY SIZE                          46020073
460300                                    INTO PV-CICS-MSG-AREA-3       46030074
460400             PERFORM 9997-WRITE-TO-CSSL                           46040074
460500             MOVE '8100-'             TO SU044-CRA-REQ-ID         46050073
460600             MOVE PV-CICS-MSG-AREA    TO SU044-CRA-RET-MSG        46060073
460700             SET SU044-INVALID-SQL    TO TRUE                     46070073
460800             PERFORM 9998-RETURN                                  46080073
460900                                                                  46090073
461000     END-EVALUATE.                                                46100073
461100                                                                  46110073
461200                                                                  46120073
461300*---------------------------------------------------------------* 46130073
461400* WRITE COMMAREA TO CSSL                                        * 46140073
461500* DMH - 01/29/15                                                * 46150073
461600*---------------------------------------------------------------* 46160073
461700 8110-WRITE-SUWS044-TO-CSSL.                                      46170095
461800                                                                  46180097
461900     IF  PS-BLD-INTERNAL-TABLE-YES                                46190097
462000         MOVE  '8110'  TO  PT-CURR-PARA                           46200097
462100         PERFORM 8120-INTERNAL-TABLE                              46210097
462200     END-IF.                                                      46220097
462300                                                                  46230097
462400                                                                  46240073
462500     INITIALIZE PV-CICS-MSG-AREA-3                                46250074
462600     MOVE SU044-SHIPT-UNT-ID       TO PV-DISP-SSCC                46260079
462700     MOVE SU044-PO                 TO PV-DISP-PO                  46270079
462800     MOVE SU044-ORIG-REC-SEQ-NBR   TO PV-DISP-ORIG-RCVR           46280079
462900     MOVE SU044-NEW-REC-SEQ-NBR    TO PV-DISP-NEW-RCVR            46290079
463000     MOVE SU044-OPER-UNT-ID        TO PV-DISP-OPER                46300079
463100     MOVE SU044-CRTN-OPER-UNT-ID   TO PV-DISP-CRTN-OPER           46310079
463200     MOVE SU044-FCLTY-ID           TO PV-DISP-FCLTY               46320079
463300     MOVE SU044-TRIP-ID            TO PV-DISP-TRIP                46330079
463400     MOVE SU044-DEST-STR-NBR       TO PV-DISP-DEST-STR            46340079
463500     MOVE SU044-ORIG-SHIP          TO PV-DISP-ORIG-SHIP           46350079
463600     MOVE SU044-NEW-SHIP           TO PV-DISP-NEW-SHIP            46360079
463700     MOVE SU044-ORIG-PKSL-SEQ-NBR  TO PV-DISP-ORIG-PKSL           46370079
463800     MOVE SU044-NEW-PKSL-SEQ-NBR   TO PV-DISP-NEW-PKSL            46380079
463900     MOVE SQLCODE                  TO PV-DISP-SQLCODE             46390079
464000                                                                  46400079
464100     INITIALIZE PV-CICS-MSG-AREA-3                                46410091
464200     PERFORM 9997-WRITE-TO-CSSL.                                  46420091
464300                                                                  46430091
464400     STRING  ' SUKUT705 '  PV-CSSL-PARA                           46440079
464500             ' SSCC:'      PV-DISP-SSCC                           46450079
464600             ' PO:'        PV-DISP-PO                             46460079
464700             ' ORIG RCVR:' PV-DISP-ORIG-RCVR                      46470079
464800             ' NEW RCVR:'  PV-DISP-NEW-RCVR                       46480079
464900             ' TYPE:'      SU044-RCVR-TYPE-CDE                    46490079
465000             ' OPER:'      PV-DISP-OPER                           46500080
465100             ' CRTN OPER:' PV-DISP-CRTN-OPER                      46510079
465200             ' FCLTY:'     PV-DISP-FCLTY                          46520079
465300                           DELIMITED BY SIZE                      46530079
465400                      INTO PV-CICS-MSG-AREA-3                     46540079
465500                                                                  46550079
465600     PERFORM 9997-WRITE-TO-CSSL                                   46560079
465700                                                                  46570079
465800     INITIALIZE PV-CICS-MSG-AREA-3                                46580079
465900     STRING  ' SUKUT705 '                                         46590079
466000             ' SCAC:'      SU044-SCAC-ID                          46600079
466100             ' TRLR:'      SU044-VEH-NBR                          46610079
466200             ' DEST:'      PV-DISP-DEST-STR                       46620079
466300             ' ORIG SHIP:' PV-DISP-ORIG-SHIP                      46630079
466400             ' NEW SHIP:'  PV-DISP-NEW-SHIP                       46640079
466500             ' ORIG BOL:'  SU044-ORIG-BOL-NBR                     46650079
466600                           DELIMITED BY SIZE                      46660079
466700                      INTO PV-CICS-MSG-AREA-3                     46670079
466800                                                                  46680079
466900     PERFORM 9997-WRITE-TO-CSSL                                   46690079
467000                                                                  46700079
467100     INITIALIZE PV-CICS-MSG-AREA-3                                46710079
467200     STRING  ' SUKUT705 '                                         46720079
467300             ' ORIG PKSL:' PV-DISP-ORIG-PKSL                      46730079
467400             ' NEW PKSL:'  PV-DISP-NEW-PKSL                       46740079
467500             ' FUNC:'      SU044-FUNCTION-SWITCH                  46750079
467600             ' SRC:'       SU044-CALL-SOURCE-SWITCH               46760079
467700             ' PKSL:'      SU044-UPDATE-PKSLIP-SW                 46770079
467800             ' PGRM:'      SU044-PROGRAM-NAME                     46780079
467900             ' SUCC:'      SU044-SUCCESS-IND                      46790079
468000             ' PKSL CRE:'  SU044-PKSLIP-CRE-SRCE                  46800079
468100             ' RCVR CRE:'  SU044-RECEIVER-CREATE-SRC              46810082
468200                           DELIMITED BY SIZE                      46820079
468300                      INTO PV-CICS-MSG-AREA-3                     46830079
468400                                                                  46840079
468500     PERFORM 9997-WRITE-TO-CSSL.                                  46850079
468600                                                                  46860079
468700     INITIALIZE PV-CICS-MSG-AREA-3                                46870079
468800     STRING  ' SUKUT705 '                                         46880079
468900             ' ORIG PRO:'  SU044-ORIG-PRO-NBR                     46890095
469000             ' NEW PRO:'   SU044-NEW-PRO-NBR                      46900095
469100             ' USRID:'     SU044-SIGNON-USER-ID                   46910095
469200             ' SQL:'       PV-DISP-SQLCODE                        46920079
469300                           DELIMITED BY SIZE                      46930079
469400                      INTO PV-CICS-MSG-AREA-3                     46940079
469500                                                                  46950079
469600     PERFORM 9997-WRITE-TO-CSSL.                                  46960079
469700                                                                  46970079
469800     INITIALIZE PV-CICS-MSG-AREA-3                                46980091
469900     PERFORM 9997-WRITE-TO-CSSL.                                  46990091
470000                                                                  47000091
470100                                                                  47010079
470200*---------------------------------------------------------------* 47020079
470300* BUILD INTERNAL TABLE WITN PARAGRAPH TRACKING                  * 47030079
470400* DMH - 01/29/15                                                * 47040079
470500*---------------------------------------------------------------* 47050079
470600 8120-INTERNAL-TABLE.                                             47060079
470700                                                                  47070079
470800     PERFORM 8130-GET-CURRENT-TMST.                               47080079
470900     ADD  +1  TO  PT-CURR-ENTRIES.                                47090079
471000     SET  PT-TRACK-IDX to PT-CURR-ENTRIES                         47100079
471100                                                                  47110079
471200     MOVE 'SUKUT705'           TO PT-PROGRAM(PT-TRACK-IDX).       47120087
471300     MOVE PT-CURR-ENTRIES      TO PT-INDEX-NBR(PT-TRACK-IDX).     47130079
471400     MOVE PT-CURR-PARA         TO PT-PARAGRAPH(PT-TRACK-IDX).     47140079
471500     MOVE PV-CURRENT-PARA-TMST TO PT-TIMESTAMP(PT-TRACK-IDX).     47150079
471600     MOVE PV-DURATION-SEC      TO PT-DURATION(PT-TRACK-IDX).      47160079
471700                                                                  47170079
471800     MOVE PV-DURATION-NANO-SEC    TO PV-WORK-NANO-SEC.            47180079
471900     MOVE PV-WORK-NANO-MIN-1-2    TO PV-DISP-NANO-MIN-1-2.        47190079
472000     MOVE '-'                     TO PV-DISP-NANO-DASH-1.         47200079
472100     MOVE PV-WORK-NANO-SEC-3-4    TO PV-DISP-NANO-SEC-3-4.        47210079
472200     MOVE '-'                     TO PV-DISP-NANO-DASH-2.         47220079
472300     MOVE PV-WORK-NANO-MICRO-5-10 TO PV-DISP-NANO-MICRO-5-10.     47230079
472400     MOVE PV-DISP-NANO-SEC     TO PT-NANO-SEC(PT-TRACK-IDX).      47240079
472500                                                                  47250079
472600     MOVE SU044-OPER-UNT-ID      tO PT-DC(PT-TRACK-IDX).          47260082
472700     MOVE SU044-CRTN-OPER-UNT-ID tO PT-crtn-oper(PT-TRACK-IDX).   47270082
472800     MOVE PV-INIT-TIME-KEY      TO PT-START-HHMMSS(PT-TRACK-IDX). 47280079
472900                                                                  47290079
473000     IF  PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES                     47300079
473100         MOVE ZEROES TO PT-CURR-ENTRIES                           47310079
473200         SET  PT-TRACK-IDX  TO PT-CURR-ENTRIES                    47320079
473300     END-IF.                                                      47330079
473400                                                                  47340079
473500                                                                  47350079
473600*---------------------------------------------------------------* 47360079
473700*                                                               * 47370079
473800* DMH - 01/29/15                                                * 47380079
473900*---------------------------------------------------------------* 47390079
474000 8130-GET-CURRENT-TMST.                                           47400079
474100     EXEC SQL                                                     47410079
474200          SET :PV-CURRENT-PARA-TMST = CURRENT TIMESTAMP           47420079
474300     END-EXEC.                                                    47430079
474400                                                                  47440079
474500     EXEC SQL                                                     47450079
474600          SELECT                                                  47460079
474700                 TIMESTAMPDIFF( 2 ,CHAR(:PV-CURRENT-PARA-TMST     47470079
474800                   - TIMESTAMP(:PV-RECEIVE-RQST-TMST)))           47480079
474900               , TIMESTAMPDIFF( 1 ,CHAR(:PV-CURRENT-PARA-TMST     47490079
475000                   - TIMESTAMP(:PV-RECEIVE-RQST-TMST)))           47500079
475100            INTO :PV-DURATION-SEC                                 47510079
475200               , :PV-DURATION-nano-sec                            47520079
475300            FROM  SYSIBM.SYSDUMMY1                                47530079
475400     END-EXEC.                                                    47540079
475500                                                                  47550079
475600                                                                  47560079
475700*---------------------------------------------------------------* 47570079
475800*                                                               * 47580079
475900* DMH - 01/29/15                                                * 47590079
476000*---------------------------------------------------------------* 47600079
476100 8140-DUMP-TABLE-TO-CSSL.                                         47610079
476200                                                                  47620079
476300     INITIALIZE PV-CICS-MSG-AREA                                  47630079
476400                                                                  47640079
476500     MOVE PT-ENTRIES(PT-TRACK-IDX)  TO PV-CICS-MSG-AREA-3         47650089
476600                                                                  47660079
476700     PERFORM 9997-WRITE-TO-CSSL.                                  47670079
476800                                                                  47680079
476900                                                                  47690079
477000*---------------------------------------------------------------* 47700079
477100*                                                               * 47710079
477200* DMH - 01/29/15                                                * 47720079
477300*---------------------------------------------------------------* 47730079
477400 8150-CLEAR-TABLE.                                                47740079
477500                                                                  47750079
477600     MOVE  SPACES  TO  PT-PROGRAM(PT-TRACK-IDX).                  47760079
477700     MOVE  ZEROES  TO  PT-INDEX-NBR(PT-TRACK-IDX).                47770079
477800     MOVE  SPACES  TO  PT-PARAGRAPH(PT-TRACK-IDX).                47780079
477900     MOVE  SPACES  TO  PT-TIMESTAMP(PT-TRACK-IDX).                47790079
478000     MOVE  ZEROES  TO  PT-DURATION(PT-TRACK-IDX).                 47800079
478100                                                                  47810079
478200* RPK - 3/13/2019 - START                                         47820099
478300*---------------------------------------------------------------* 47830099
478400* THIS PARAGRAPH WILL READ THE TKRPRPM TABLE TO CHECK PARM      * 47840099
478500* FAOPR2 TO DETERMINE WHAT LOGIC IN THE 1550 PARAGRAPH SHOULD   * 47850099
478600* BE USED TO CHECK FOR AN EXISTING FREE ASTRAY RECEIVER.        * 47860099
478700* THIS PARAGRAPH WILL READ THE 090 ENTRY FOR THE PARM, IF THE   * 47870099
478800* TEXT VALUE IS Y, THEN 1550 WOULD USE THE NEW CODE, IF TEXT    * 47880099
478900* VALUE IS N, THEN 1550 WOULD USE THE OLD CODE.                 * 47890099
479000*---------------------------------------------------------------* 47900099
479100 8200-CHECK-OPER-HANDLING.                                        47910099
479200                                                                  47920099
479300     MOVE SPACES TO PV-PARM-TEXT-CORP-FAOPR2.                     47930099
479400     SET PS-FREE-ASTRAY-OPER-OLD TO TRUE.                         47940099
479500                                                                  47950099
479600     IF  PS-BLD-INTERNAL-TABLE-YES                                47960099
479700         MOVE  '8200'  TO  PT-CURR-PARA                           47970099
479800         PERFORM 8120-INTERNAL-TABLE                              47980099
479900     END-IF.                                                      47990099
480000                                                                  48000099
480100     EXEC SQL                                                     48010099
480200          SELECT FUNC_TXT                                         48020099
480300            INTO :PV-PARM-TEXT-CORP-FAOPR2                        48030099
480400            FROM TKRPRPM                                          48040099
480500           WHERE LOC_ID            = 090                          48050099
480600             AND INTFC_SYS_CDE     = 'KHL'                        48060099
480700             AND SYS_PRC_FUNC_CDE  = 'FAOPR2'                     48070099
480800             AND FUNC_PRC_STAT_CDE = 'AC'                         48080099
480900            WITH UR                                               48090099
481000     END-EXEC.                                                    48100099
481100                                                                  48110099
481200     EVALUATE TRUE                                                48120099
481300         WHEN SQLCODE = ZERO                                      48130099
481400             IF  PV-PARM-TEXT-CORP-FAOPR2 = 'Y'                   48140099
481500                 SET PS-FREE-ASTRAY-OPER-NEW TO TRUE              48150099
481600             ELSE                                                 48160099
481700                 IF  PV-PARM-TEXT-CORP-FAOPR2 = 'N'               48170099
481800                     SET PS-FREE-ASTRAY-OPER-OLD TO TRUE          48180099
481900                 ELSE                                             48190099
482000                     SET PS-FREE-ASTRAY-OPER-OLD TO TRUE          48200099
482100                 END-IF                                           48210099
482200             END-IF                                               48220099
482300         WHEN SQLCODE = +100                                      48230099
482400             SET PS-FREE-ASTRAY-OPER-OLD TO TRUE                  48240099
482500         WHEN SQLWARN0 NOT = SPACES                               48250099
482600         WHEN SQLCODE NOT EQUAL ZERO                              48260099
482700                                                                  48270099
482800              MOVE '8200'  TO  PV-CSSL-PARA                       48280099
482900              PERFORM 8110-WRITE-SUWS044-TO-CSSL                  48290099
483000                                                                  48300099
483100             SET PS-ERROR                                         48310099
483200                 SU044-INVALID-SQL    TO TRUE                     48320099
483300             MOVE  SQLCODE            TO PV-DISP-SQLCODE          48330099
483400             MOVE  DK-OPER-UNT-ID     TO PV-DISP-OPER             48340099
483500             STRING   ' SUKUT705 - 8200- '                        48350099
483600                      ' CALLED BY:'      SU044-PROGRAM-NAME       48360099
483700                      ' SQL:'            PV-DISP-SQLCODE          48370099
483800                      ' OPER:'           PV-DISP-OPER             48380099
483900                                         DELIMITED BY SIZE        48390099
484000                                    INTO PV-CICS-MSG-AREA         48400099
484100             PERFORM 9999-WRITE-TO-CSSL                           48410099
484200             MOVE PV-CICS-MSG-AREA    TO SU044-CRA-RET-MSG        48420099
484300             MOVE SQLCA               TO SU044-SQLCA              48430099
484400             SET SU044-INVALID-SQL TO TRUE                        48440099
484500     END-EVALUATE.                                                48450099
484600                                                                  48460099
484700* RPK - 3/13/2019 - END                                           48470099
484800                                                                  48480079
484900 9990-WRITE-CICS.                                                 48490079
485000                                                                  48500079
485100* IF YOU'RE AT THE LAST OCCURRENCE OF THE TABLE,                  48510001
485200* THE NEXT MESSAGE WILL GO INTO THE FIRST OCCURRENCE.  KEEP       48520001
485300* INCREMENTING THE SEQUENCE SO THAT IF THE TABLE IS DUMPED TO THE 48530001
485400* LOG YOU WILL BE ABLE TO SEE THE LAST 200 LINES AND HOW THEY     48540001
485500* WRAPPED AROUND.                                                 48550001
485600                                                                  48560001
485700     EVALUATE TRUE                                                48570001
485800     WHEN PT-MSG-IDX < PC-MSG-TABLE-SIZE                          48580001
485900         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 48590001
486000         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         48600001
486100         SET PT-MSG-IDX UP BY 1                                   48610001
486200     WHEN PT-MSG-IDX = PC-MSG-TABLE-SIZE                          48620001
486300         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 48630001
486400         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         48640001
486500         SET PT-MSG-IDX               TO 1                        48650001
486600     END-EVALUATE                                                 48660001
486700                                                                  48670001
486800     COMPUTE PV-NEXT-SEQUENCE = PV-PREV-SEQUENCE + 1              48680001
486900     MOVE PV-NEXT-SEQUENCE            TO PT-MSG-SEQ (PT-MSG-IDX)  48690001
487000                                                                  48700001
487100                                                                  48710001
487200*  IF THE DC HAS TRACE PROCESSING TURNED ON, ALL MESSAGES WILL    48720001
487300*  BE DISPLAYED AS THEY OCCUR.  DUMPING THE MESSAGE TABLE WILL    48730001
487400*  BE UNNECESSARY BECAUSE OF THE REAL-TIME DISPLAYS.              48740001
487500*                                                                 48750001
487600     IF PS-SHOW-DEBUG-INFO                                        48760001
487700         PERFORM 9991-WRITEQ                                      48770001
487800     END-IF                                                       48780001
487900     MOVE SPACES                      TO PV-CICS-MSG-AREA.        48790001
488000                                                                  48800001
488100                                                                  48810001
488200 9991-WRITEQ.                                                     48820001
488300     EXEC CICS                                                    48830001
488400         WRITEQ TD                                                48840001
488500         QUEUE(PC-LOG-QUEUE)                                      48850001
488600         FROM(PV-CICS-MSG-AREA)                                   48860001
488700         RESP(PV-CICS-RESPONSE)                                   48870001
488800     END-EXEC.                                                    48880001
488900                                                                  48890001
489000 9995-SYNCPOINT.                                                  48900045
489100                                                                  48910054
489200     EXEC CICS                                                    48920045
489300          SYNCPOINT                                               48930045
489400     END-EXEC.                                                    48940045
489500                                                                  48950053
489600      MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                        48960054
489700      MOVE PV-COMMIT-COUNT   TO PV-DISP-CMT-CNT                   48970054
489800      STRING ' SUKUT705-SYNCPOINT PO NBR : '                      48980054
489900              PV-DISPLAY-PO-NBR                                   48990054
490000             ' COMMIT COUNT ' PV-DISP-CMT-CNT                     49000054
490100                              DELIMITED BY SIZE                   49010054
490200                         INTO PV-CICS-MSG-AREA                    49020054
490300                                                                  49030054
490400     EXEC CICS                                                    49040054
490500         WRITEQ TD                                                49050054
490600         QUEUE('CSSL')                                            49060054
490700         FROM(PV-CICS-MSG-AREA)                                   49070054
490800         RESP(PV-CICS-RESPONSE)                                   49080054
490900     END-EXEC.                                                    49090054
491000                                                                  49100053
491100                                                                  49110073
491200*-----------------------------------------------------------------49120073
491300 9997-WRITE-TO-CSSL.                                              49130073
491400*-----------------------------------------------------------------49140073
491500     MOVE LENGTH OF PV-CICS-MSG-AREA-3  TO PV-COMMAREA-LENGTH.    49150074
491600                                                                  49160073
491700     EXEC CICS                                                    49170073
491800          WRITEQ TD                                               49180073
491900           QUEUE   ('CSSL')                                       49190073
492000            FROM   (PV-CICS-MSG-AREA-3)                           49200074
492100          LENGTH   (PV-COMMAREA-LENGTH)                           49210073
492200            RESP   (PV-CICS-RESPONSE)                             49220073
492300     END-EXEC.                                                    49230073
492400                                                                  49240073
492500                                                                  49250073
492600                                                                  49260073
492700*-----------------------------------------------------------------49270001
492800*  RETURN TO CALLING PROGRAM                                      49280001
492900*-----------------------------------------------------------------49290001
493000 9998-RETURN.                                                     49300001
493100                                                                  49310001
493200     STRING ' 9998-RETURN'                                        49320001
493300         DELIMITED BY SIZE                                        49330001
493400         INTO PV-CICS-MSG-AREA.                                   49340001
493500     PERFORM 9990-WRITE-CICS.                                     49350001
493600     MOVE SU044-COMM-AREA               TO DFHCOMMAREA.           49360001
493700                                                                  49370001
493800     EXEC CICS                                                    49380001
493900          RETURN                                                  49390001
494000     END-EXEC.                                                    49400001
494100                                                                  49410001
494200                                                                  49420001
494300 9999-WRITE-TO-CSSL.                                              49430001
494400     STRING ' 9999-WRITE-TO-CSSL'                                 49440001
494500                                   DELIMITED BY SIZE              49450073
494600                              INTO PV-CICS-MSG-AREA.              49460073
494700     PERFORM 9990-WRITE-CICS.                                     49470001
494800     MOVE LENGTH OF PV-CICS-MSG-AREA2                             49480001
494900       TO PV-COMMAREA-LENGTH                                      49490001
495000     EXEC CICS                                                    49500001
495100          WRITEQ TD                                               49510001
495200           QUEUE   ('CSSL')                                       49520001
495300            FROM   (PV-CICS-MSG-AREA2)                            49530001
495400          LENGTH   (PV-COMMAREA-LENGTH)                           49540001
495500            RESP   (PV-CICS-RESP)                                 49550001
495600     END-EXEC.                                                    49560001
495700                                                                  49570001
495800*                                                                 49580001
495900 9999-WRITE-CICS-LOG-MSG.                                         49590001
496000     STRING ' 9999-WRITE-CICS-LOG-MSG'                            49600001
496100         DELIMITED BY SIZE                                        49610001
496200         INTO PV-CICS-MSG-AREA.                                   49620001
496300     PERFORM 9990-WRITE-CICS.                                     49630001
496400     MOVE 'SUKUT705'                 TO DP013-PROGRAM.            49640001
496500     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           49650001
496600     INITIALIZE DP013-SRC-TASK-NUMBER                             49660001
496700                DP013-STACK.                                      49670001
496800     SET DP013-LINK-RETURN           TO TRUE.                     49680001
496900                                                                  49690001
497000     EXEC CICS                                                    49700001
497100         LINK                                                     49710001
497200             PROGRAM   (DP013-NAME)                               49720001
497300             COMMAREA  (DP013-PARAMETERS)                         49730001
497400             LENGTH    (DP013-LENGTH)                             49740001
497500     END-EXEC.                                                    49750001
497600                                                                  49760001
497700                                                                  49770001
497800 9999-FINAL-DUMP.                                                 49780001
497900*  IF AN ERROR HAS OCCURRED, DUMP THE MESSAGE TABLE WHICH WILL    49790001
498000*  CONTAIN THE LAST 200 TRACE DISPLAYS.  IF THE TABLE EVER        49800001
498100*  OVERFLOW, YOU WILL SEE THE SEQUENCE NUMBERS WRAP.  UNUSED      49810001
498200*  OCCRENCES ARE NOT DISPLAYED.                                   49820001
498300*                                                                 49830001
498400                                                                  49840001
498500     STRING ' 9999-FINAL-DUMP'                                    49850001
498600         DELIMITED BY SIZE                                        49860001
498700         INTO PV-CICS-MSG-AREA                                    49870001
498800     PERFORM 9990-WRITE-CICS.                                     49880001
498900                                                                  49890001
499000     EXEC CICS ENQ                                                49900001
499100         RESOURCE(PC-LOG-QUEUE)                                   49910001
499200     END-EXEC                                                     49920001
499300                                                                  49930001
499400     MOVE PV-EIBTASKN             TO PV-DISPLAY-TASK.             49940001
499500     PERFORM VARYING PT-MSG-IDX FROM 1 BY 1 UNTIL                 49950001
499600                     PT-MSG-IDX > PC-MSG-TABLE-SIZE               49960001
499700         IF PT-MSG-SEQ (PT-MSG-IDX) > ZERO                        49970001
499800             MOVE PT-MSG-SEQ (PT-MSG-IDX)                         49980001
499900                                  TO PV-DISPLAY-MSG-NBR           49990001
500000             STRING ' ' PV-DISPLAY-TASK ' '                       50000001
500100                  PV-DISPLAY-MSG-NBR ' '                          50010001
500200                  PT-MSG-LINE (PT-MSG-IDX)                        50020001
500300                  DELIMITED BY SIZE                               50030001
500400                                INTO PV-CICS-MSG-AREA             50040001
500500             PERFORM 9991-WRITEQ                                  50050001
500600         END-IF                                                   50060001
500700     END-PERFORM.                                                 50070001
500800                                                                  50080001
500900     SET PT-MSG-IDX               TO 1.                           50090001
501000     SET PS-DONT-DUMP-TO-LOG      TO TRUE.                        50100001
501100                                                                  50110001
501200     EXEC CICS DEQ                                                50120001
501300         RESOURCE(PC-LOG-QUEUE)                                   50130001
501400     END-EXEC.                                                    50140001
501500                                                                  50150001
