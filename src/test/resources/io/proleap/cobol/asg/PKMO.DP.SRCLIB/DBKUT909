00001  IDENTIFICATION     DIVISION.                                     00010005
00002                                                                   00020005
00003  PROGRAM-ID.             DBKUT909.                                00030005
00004  AUTHOR.                 COLLEEN VOIGT.                           00040005
00005  INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050005
00006  DATE-WRITTEN.           NOVEMBER 2003.                           00060005
00007  DATE-COMPILED.                                                   00070005
00008                                                                   00080005
00009 ***************************************************************** 00090005
00012 ***  THIS PROGRAM WILL FILTER THE IDCAMS DATASET TO PRODUCE   *** 00100005
00012 ***  A FILE WITH DATASET NAMES AND EXTENTS.  THIS FILE WILL BE*** 00110005
00012 ***  USED TO PRODUCE A DATASET EXTENT REPORT.                 *** 00120005
00027 ***************************************************************** 00130005
00028  ENVIRONMENT DIVISION.                                            00140005
00029                                                                   00150005
00030  CONFIGURATION SECTION.                                           00160005
00031                                                                   00170005
00032  SOURCE-COMPUTER.    IBM.                                         00180005
00033  OBJECT-COMPUTER.    IBM.                                         00190005
00034                                                                   00200005
00035  INPUT-OUTPUT SECTION.                                            00210005
00036                                                                   00220005
00037  FILE-CONTROL.                                                    00230005
00038                                                                   00240005
00039      SELECT IN-FILE                                               00250005
00040          ASSIGN TO INP01.                                         00260005
00041                                                                   00270005
00045      SELECT OUT-FILE                                              00280005
00046          ASSIGN TO OUTP01.                                        00290005
00047                                                                   00300005
00051  DATA DIVISION.                                                   00310005
00052                                                                   00320005
00053  FILE SECTION.                                                    00330005
00054                                                                   00340005
00055  FD  IN-FILE                                                      00350005
00056      RECORDING MODE IS V                                          00360005
00057      BLOCK CONTAINS 0 RECORDS.                                    00370005
00058                                                                   00380005
00059  01  IN-RECORD         PIC X(129).                                00390005
00060                                                                   00400005
00067  FD  OUT-FILE                                                     00410005
00068      RECORDING MODE IS F                                          00420005
00069      BLOCK CONTAINS 0 RECORDS.                                    00430005
00070                                                                   00440005
00071  01  OUT-RECORD        PIC X(080).                                00450005
00072                                                                   00460005
00072                                                                   00470005
00079  WORKING-STORAGE SECTION.                                         00480005
00080                                                                   00490005
00083  01  WS-DSN                        PIC X(42)  VALUE SPACES.       00510005
00083  01  LAST-DSN                      PIC X(42)  VALUE SPACES.       00510005
00083  01  LAST-HI-RBA                   PIC X(12)  VALUE SPACES.       00530005
00083  01  LAST-HI-RBA-NU                PIC S9(11) VALUE ZERO COMP.    00540005
00083  01  NBR-VOL                       PIC S9(04) VALUE ZERO COMP.    00550005
00083  01  TOT-TRK                       PIC S9(08) VALUE ZERO COMP.    00560005
00083  01  EXT-NBR                       PIC X(04)  VALUE SPACES.       00570005
00083  01  EXT-NBR-BI                    PIC S9(04) VALUE ZERO COMP.    00580005
00083  01  TOT-XT                        PIC S9(04) VALUE ZERO COMP.    00590005
00090  01  IN-EOF                        PIC X(01)  VALUE 'N'.          00600005
00105                                                                   00610005
00106 ***************************************************************** 00620005
00107 *** LISTCAT INPUT FILE                                        *** 00630005
00108 ***************************************************************** 00640005
00109                                                                   00650005
00110  01  WS-INREC.                                                    00660005
00112      05  FILLER                    PIC X(01).                     00670005
00111      05  IN-DATA-KEYWORD           PIC X(05).                     00680005
00112      05  FILLER                    PIC X(11).                     00690005
00112      05  IN-DSN                    PIC X(42).                     00700005
00112      05  FILLER                    PIC X(74).                     00710005
00113                                                                   00720005
00114  01  WS-VOLSER-LINE  REDEFINES WS-INREC.                          00730005
00115      05  FILLER                    PIC X(24).                     00740005
00116      05  IN-VOL                    PIC X(08).                     00750005
00117      05  FILLER                    PIC X(46).                     00760005
00117      05  IN-HI-RBA                 PIC X(12).                     00770005
00117      05  FILLER                    PIC X(05).                     00780005
00117      05  IN-EXTENT-KEYWORD         PIC X(13).                     00790005
00117      05  FILLER                    PIC X(07).                     00800005
00117      05  IN-NBR-EXTS               PIC X(04).                     00810005
00117      05  FILLER                    PIC X(14).                     00820005
40118                                                                   00830005
00156  01  WS-OUTREC.                                                   00840005
00112      05  OUT-DSN                   PIC X(42).                     00850005
00111      05  OUT-VOL                   PIC X(04).                     00860005
00112      05  OUT-TRK                   PIC X(08).                     00870005
00112      05  OUT-XT                    PIC X(04).                     00880005
00112      05  FILLER                    PIC X(22).                     00890005
00113                                                                   00900005
00328                                                                   00910005
00353  PROCEDURE DIVISION.                                              00920005
00354                                                                   00930005
00360      OPEN INPUT  IN-FILE.                                         00940005
00362      OPEN OUTPUT OUT-FILE.                                        00950005
00364                                                                   00960005
00367      MOVE SPACES TO LAST-DSN.                                     00970005
00367      MOVE 'N'  TO  IN-EOF.                                        00980005
00374                                                                   00990005
00393      PERFORM 1000-READ-INPUT  THRU  1000-EXIT                     01000005
00394          UNTIL IN-EOF = 'Y'.                                      01010005
00395                                                                   01020005
00393      PERFORM 2000-DSN-LINE    THRU  2000-EXIT.                    01000005
00395                                                                   01020005
00407      CLOSE IN-FILE.                                               01030005
00409      CLOSE OUT-FILE.                                              01040005
00411                                                                   01050005
00412      GOBACK.                                                      01060005
00413                                                                   01070005
00437  1000-READ-INPUT.                                                 01080005
00438                                                                   01090005
00468      READ IN-FILE INTO WS-INREC                                   01100005
00469          AT END                                                   01110005
00470              MOVE 'Y'  TO  IN-EOF                                 01120005
00471              GO TO 1000-EXIT.                                     01130005
00472                                                                   01140005
00477      IF IN-DATA-KEYWORD = 'DATA '                                 01150005
00480          MOVE SPACES       TO  WS-DSN                             01160005
00480          MOVE IN-DSN       TO  WS-DSN                             01170005
               PERFORM 2000-DSN-LINE THRU 2000-EXIT.                    01180005
00472                                                                   01190005
00477      IF IN-EXTENT-KEYWORD = 'EXTENT-NUMBER'                       01200005
                   AND IN-VOL NOT EQUAL '-------*'                      01210005
00480          MOVE IN-HI-RBA TO LAST-HI-RBA                            01220005
00480          MOVE IN-NBR-EXTS TO EXT-NBR                              01220005
               PERFORM 3000-EXT-LINE THRU 3000-EXIT.                    01230005
                                                                        01240005
00486                                                                   01250005
00509  1000-EXIT.                                                       01260005
            EXIT.                                                       01270005
00486                                                                   01280005
00486                                                                   01290005
00509  2000-DSN-LINE.                                                   01300005
00511 ***************************************************************** 01310005
00512 *** PROCESS DATASET NAME                                      *** 01320005
00514 ***************************************************************** 01330005
00515                                                                   01340005
           IF LAST-DSN NOT EQUAL TO SPACES                              01350005
               COMPUTE TOT-TRK = (LAST-HI-RBA-NU / 1024) / 48           01360005
               MOVE LAST-DSN TO OUT-DSN                                 01370005
               MOVE NBR-VOL  TO OUT-VOL                                 01380005
               MOVE TOT-TRK  TO OUT-TRK                                 01390005
               MOVE TOT-XT   TO OUT-XT                                  01400005
               WRITE OUT-RECORD FROM WS-OUTREC.                         01410005
                                                                        01430005
           MOVE WS-DSN TO LAST-DSN.                                     01440005
           MOVE 0 TO NBR-VOL.                                           01450005
           MOVE 0 TO TOT-XT.                                            01460005
00540                                                                   01470005
00541  2000-EXIT.                                                       01480005
00542      EXIT.                                                        01490005
00543                                                                   01500005
00544  3000-EXT-LINE.                                                   01510005
00545                                                                   01520005
00546 ***************************************************************** 01530005
00547 *** PROCESS EXTENT LINE                                       *** 01540005
00548 ***************************************************************** 01550005
00549                                                                   01560005
           ADD +1 TO NBR-VOL.                                           01570005
           INSPECT EXT-NBR                                              01580005
                   REPLACING ALL '-' BY ' '.                            01590005
                                                                        01600005
           INSPECT LAST-HI-RBA                                          01610005
                   REPLACING ALL '-' BY ' '.                            01620005
                                                                        01630005
           MOVE EXT-NBR TO EXT-NBR-BI.                                  01640005
           MOVE LAST-HI-RBA TO LAST-HI-RBA-NU.                          01650005
           COMPUTE TOT-XT = TOT-XT + EXT-NBR-BI.                        01660005
                                                                        01670005
                                                                        01680005
00568                                                                   01690005
00569  3000-EXIT.                                                       01700005
00570      EXIT.                                                        01710005
