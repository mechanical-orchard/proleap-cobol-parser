000100*------------------------*                                        00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*------------------------*                                        00030001
000400 PROGRAM-ID.     APKUT128.                                        00040001
000500 AUTHOR.         KEVIN CATLIN.                                    00050001
000600 DATE-WRITTEN.   NOVEMBER, 2002.                                  00060001
000700*---------------------------------------------------------------* 00070001
000800*    FORMAT COLLECT PROGRAM CHARGEBACKS TO TEXT FILE FOR FTP    * 00080001
000900*---------------------------------------------------------------* 00090001
001000*                           COBOL 2                             * 00100001
001100*---------------------------------------------------------------* 00110001
001200*                                                               * 00120001
001300*    THIS PROGRAM REFORMATS THE COLLECT PROGRAM ADJUSTMENTS     * 00130001
001400*  INTO A TEXT FILE SO THAT IT CAN BE FTP'D TO A CORPORATE      * 00140001
001500*  SERVER.                                                      * 00150001
001600*                                                               * 00160001
001700*---------------------------------------------------------------* 00170001
001800*                                                               * 00180001
001900*  INPUT:                                   COPYBOOK:   LRECL:  * 00190010
002000*  1. COLLECT-ADJ-IN-FILE.                  APRD045     500     * 00200010
002100*                                                               * 00210001
002200*  OUTPUT:                                                      * 00220010
002300*  1. COLLECT-PGM-OUT-FILE.                 APRD065     207     * 00230010
002400*                                                               * 00240001
002500*---------------------------------------------------------------* 00250001
002600* CHANGE LOG:                                                   * 00260001
002700*   DATE  03/27/2003                                            * 00270011
002800*       CHANGE MADE: INITIAL VERSION.                           * 00280001
002900*       MADE BY: KEVIN CATLIN              WR/IR #: WR24278     * 00290001
003000*                                                               * 00300001
003100*   DATE  09/17/2003                                            * 00310012
003200*       CHANGE MADE: RECOMPILE FROM PRODUCTION TO PICK UP       * 00320012
003300*       CHANGE TO COPYBOOK APRD045.                             * 00330012
003400*       MADE BY: MIKE BESKE              WR/IR #: WR21316       * 00340012
003500*                                                               * 00350012
003600*---------------------------------------------------------------* 00360001
003700                                                                  00370001
003800*---------------------*                                           00380001
003900 ENVIRONMENT DIVISION.                                            00390001
004000*---------------------*                                           00400001
004100 CONFIGURATION SECTION.                                           00410001
004200 SOURCE-COMPUTER.    IBM-3090.                                    00420001
004300 OBJECT-COMPUTER.    IBM-3090.                                    00430001
004400                                                                  00440001
004500 INPUT-OUTPUT SECTION.                                            00450001
004600 FILE-CONTROL.                                                    00460001
004700                                                                  00470001
004800     SELECT COLLECT-ADJ-IN-FILE     ASSIGN TO INP01.              00480001
004900     SELECT COLLECT-PGM-OUT-FILE    ASSIGN TO OUT01.              00490001
005000                                                                  00500001
005100*--------------*                                                  00510001
005200 DATA DIVISION.                                                   00520001
005300*--------------*                                                  00530001
005400 FILE SECTION.                                                    00540001
005500                                                                  00550001
005600 FD  COLLECT-ADJ-IN-FILE                                          00560001
005700     RECORDING MODE IS F                                          00570001
005800     LABEL RECORDS ARE STANDARD                                   00580001
005900     BLOCK CONTAINS 0 RECORDS                                     00590001
006000     DATA RECORD IS COLLECT-ADJ-IN-REC.                           00600001
006100 01  COLLECT-ADJ-IN-REC        PIC  X(500).                       00610001
006200                                                                  00620001
006300 FD  COLLECT-PGM-OUT-FILE                                         00630001
006400     RECORDING MODE IS F                                          00640001
006500     LABEL RECORDS ARE STANDARD                                   00650001
006600     BLOCK CONTAINS 0 RECORDS                                     00660001
006700     DATA RECORD IS COLLECT-PGM-OUT-REC.                          00670001
006800 01  COLLECT-PGM-OUT-REC       PIC  X(207).                       00680001
006900                                                                  00690001
007000 EJECT                                                            00700001
007100                                                                  00710001
007200 WORKING-STORAGE SECTION.                                         00720001
007300                                                                  00730001
007400 01  FILLER                      PIC  X(27)     VALUE             00740001
007500     '** START OF APKUT128 W/S **'.                               00750001
007600                                                                  00760001
007700 01  PROGRAM-CONSTANTS.                                           00770001
007800     05  PC-PROGRAM-NAME         PIC  X(08)    VALUE 'APKUT128'.  00780001
007900                                                                  00790001
008000 01  PV-PROCESS-COUNTERS.                                         00800001
008100     05  PV-RECS-READ-CNT        PIC  9(08)     VALUE ZEROS.      00810002
008200     05  PV-RECS-WRITTEN-CNT     PIC  9(08)     VALUE ZEROS.      00820001
008300                                                                  00830001
008400 01  PROGRAM-SWITCHES.                                            00840001
008500     05  PS-FILE-SW                 PIC  X(01)   VALUE 'N'.       00850002
008600         88  MORE-FILE                           VALUE 'N'.       00860002
008700         88  END-OF-FILE                         VALUE 'Y'.       00870002
008800                                                                  00880001
008900 01  PROGRAM-VARIABLES.                                           00890001
009000     05  PV-VENDOR-NAME      PIC  X(22)             VALUE SPACES. 00900001
009100     05  PV-NET-AMT          PIC S9(13)V9(2) COMP-3 VALUE ZEROS.  00910001
009200                                                                  00920001
009300                                                                  00930001
009400 EJECT                                                            00940001
009500                                                                  00950001
009600*----------------------------------------------------------------*00960001
009700*  RECORD LAYOUT FOR THE COLLECT PROGRAM ADJUSTMENT HEADER FILE   00970002
009800*----------------------------------------------------------------*00980001
009900     COPY APRD045.                                                00990002
010000                                                                  01000001
010100*----------------------------------------------------------------*01010002
010200*  RECORD LAYOUT FOR THE COLLECT PROGRAM TEXT FILE                01020002
010300*----------------------------------------------------------------*01030002
010400     COPY APRD065.                                                01040002
010500                                                                  01050002
010600 01  FILLER                      PIC  X(25)     VALUE             01060001
010700     '** END OF APKUT128 W/S **'.                                 01070001
010800                                                                  01080001
010900*-------------------*                                             01090001
011000 PROCEDURE DIVISION.                                              01100001
011100*-------------------*                                             01110001
011200 A100-MAINLINE.                                                   01120001
011300                                                                  01130001
011400     PERFORM B100-INITIALIZE.                                     01140001
011500                                                                  01150001
011600     PERFORM B200-PROCESS-FILE                                    01160002
011700       UNTIL END-OF-FILE.                                         01170002
011800                                                                  01180001
011900     PERFORM B300-END-OF-PROGRAM.                                 01190001
012000                                                                  01200001
012100     GOBACK.                                                      01210001
012200                                                                  01220001
012300                                                                  01230001
012400*----------------------------------------------------------------*01240001
012500*    INITIALIZATION PROCESSING                                    01250001
012600*    - OPEN FILES                                                 01260002
012700*    - INITIALIZE SWITCH                                          01270002
012800*    - PERFORM FIRST READ                                         01280002
012900*----------------------------------------------------------------*01290001
013000 B100-INITIALIZE.                                                 01300001
013100                                                                  01310001
013200     DISPLAY '**------  APKUT128  (PROCESSING MSGS)  ------**'.   01320001
013300                                                                  01330001
013400     OPEN  INPUT   COLLECT-ADJ-IN-FILE.                           01340002
013500     OPEN  OUTPUT  COLLECT-PGM-OUT-FILE.                          01350002
013600                                                                  01360001
013700     INITIALIZE  PROGRAM-SWITCHES.                                01370002
013800                                                                  01380001
013900     PERFORM R100-READ-COLL-ADJ-FILE.                             01390002
014000                                                                  01400001
014100     IF END-OF-FILE                                               01410002
014200        DISPLAY '** NO INPUT RECORDS FOUND!! **'                  01420002
014300     END-IF.                                                      01430001
014400                                                                  01440001
014500                                                                  01450001
014600*----------------------------------------------------------------*01460001
014700*    PROCESS FILE                                                 01470002
014800*    - MOVE IN FILE FIELDS TO OUT FILE FIELDS                     01480002
014900*    - WRITE OUT RECORD                                           01490001
015000*    - READ NEXT RECORD                                           01500002
015100*----------------------------------------------------------------*01510001
015200 B200-PROCESS-FILE.                                               01520002
015300                                                                  01530001
015400     INITIALIZE  AP065-CHARGEBACK-RECORD.                         01540002
015500                                                                  01550001
015600     MOVE AP045-VND-NBR          TO AP065-VENDOR-NBR.             01560002
015700     MOVE AP045-ENT-NME-DESC     TO AP065-VENDOR-NAME.            01570002
015800     MOVE AP045-DOC-NBR          TO AP065-DOCUMENT-NBR.           01580002
015900     MOVE AP045-DOC-DTE          TO AP065-DOCUMENT-DTE.           01590002
016000     MOVE AP045-AP-TRN-CDE       TO AP065-AP-TRAN-CDE.            01600002
016100     MOVE AP045-PO-NBR           TO AP065-PO-NBR.                 01610002
016200     MOVE AP045-DEPT-NBR         TO AP065-DEPT-NBR.               01620002
016300     MOVE AP045-CL-NBR           TO AP065-CLASS-NBR.              01630002
016400     MOVE AP045-RSN-TXT          TO AP065-REASON-DESC.            01640002
016500     MOVE AP045-STR-NBR          TO AP065-STORE-NBR.              01650004
016600                                                                  01660005
016700** CREDIT NEEDS TO BE REVERSED FOR FTP REPORTING PURPOSES         01670006
016800     COMPUTE AP045-FRGT-AMT = AP045-FRGT-AMT * -1.                01680006
016900     MOVE AP045-FRGT-AMT         TO AP065-FREIGHT-AMT.            01690004
017000                                                                  01700001
017100     PERFORM W100-WRITE-COLL-PGM-OUT.                             01710002
017200                                                                  01720001
017300     INITIALIZE AP045-TRANSACTION-FILE.                           01730006
017400                                                                  01740006
017500     PERFORM R100-READ-COLL-ADJ-FILE.                             01750002
017600                                                                  01760001
017700                                                                  01770001
017800*----------------------------------------------------------------*01780001
017900*    END OF PROGRAM                                               01790001
018000*    - CLOSE FILES                                                01800002
018100*    - DISPLAY COUNTS                                             01810001
018200*----------------------------------------------------------------*01820001
018300 B300-END-OF-PROGRAM.                                             01830001
018400                                                                  01840001
018500     CLOSE COLLECT-ADJ-IN-FILE                                    01850002
018600           COLLECT-PGM-OUT-FILE.                                  01860002
018700                                                                  01870002
018800     DISPLAY '*************************************************'. 01880001
018900     DISPLAY '*************************************************'. 01890001
019000     DISPLAY '** TOTAL RECORDS READ = ' PV-RECS-READ-CNT.         01900002
019100     DISPLAY '** TOTAL RECORDS WRITTEN = ' PV-RECS-WRITTEN-CNT.   01910002
019200     DISPLAY '*************************************************'. 01920001
019300     DISPLAY '**         END OF APKUT128 PROCESSING          **'. 01930001
019400     DISPLAY '*************************************************'. 01940001
019500     DISPLAY ' '.                                                 01950001
019600                                                                  01960001
019700                                                                  01970001
019800*----------------------------------------------------------------*01980002
019900*    READ COLLECT PROGRAM ADJUSTMENT HEADER FILE                  01990002
020000*----------------------------------------------------------------*02000002
020100 R100-READ-COLL-ADJ-FILE.                                         02010002
020200                                                                  02020002
020300     READ COLLECT-ADJ-IN-FILE INTO AP045-TRANSACTION-FILE         02030002
020400        AT END                                                    02040002
020500            SET END-OF-FILE TO TRUE                               02050002
020600        NOT AT END                                                02060002
020700            ADD +1 TO PV-RECS-READ-CNT                            02070002
020800     END-READ.                                                    02080002
020900                                                                  02090002
021000                                                                  02100002
021100*----------------------------------------------------------------*02110001
021200*    WRITE RECORD TO COLLECT PROGRAM TEXT OUT FILE                02120002
021300*----------------------------------------------------------------*02130001
021400 W100-WRITE-COLL-PGM-OUT.                                         02140002
021500                                                                  02150001
021600     WRITE COLLECT-PGM-OUT-REC  FROM  AP065-CHARGEBACK-RECORD.    02160002
021700                                                                  02170001
021800     ADD 1 TO PV-RECS-WRITTEN-CNT.                                02180001
021900                                                                  02190001
022000                                                                  02200001
