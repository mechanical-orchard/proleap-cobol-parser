000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             TCKUP099.                                00050000
000600 AUTHOR.                 DAN PAYNTER.                             00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            11/2021.                                 00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*  PURPOSE:                                                       00120000
001300*  UPDATE TRANSACTIONS THAT WERE INCORRECTLY LOADED TO COSA DB2   00130000
001400*  WITH A PROCESSING DATE OF A HOLIDAY SUCH THAT THESE            00140000
001400*  TRANSACTIONS WILL BE PICKED UP IN THE NEXT BATCH CYCLE BY      00150000
001400*  ALL DOWNSTREAM BATCH PROCESSES.                                00160000
001400*  WRITE OUT ALL UPDATED RECORDS TO A CSV FILE FOR AUDIT PURPOSE. 00161000
001100***************************************************************** 00162000
      *  DATE: 12/17/2021                                               00170000
      *    CHANGE MADE:                                                 00180000
      *    NEW PROGRAM                                                  00190000
      *    MADE BY: DAN PAYNTER              WR/IR #: CHG0265086        00200000
122721***************************************************************** 00210000
122721*  DATE: 12/27/2021                                               00211000
122721*    CHANGE MADE:                                                 00212000
122721*    AVOID UPDATING OOB TRANSACTIONS TO BE VALID LATES THAT       00213000
122721*    WOULD GET PROCESSED BY BATCH.                                00213100
122721*    MADE BY: DAN PAYNTER              WR/IR #: CHG0264910        00214000
001500***************************************************************** 00214101
001500*  DATE: 03/15/2022                                               00214201
001500*    CHANGE MADE:                                                 00214301
001500*    REMOVE DCLGEN FOR EPT_RET_TNDR_ASSN (EPT00025)  THE TABLE    00214401
001500*    IS NOT USED AND WILL BE DECOMMISSIONED                       00214501
001500*    MADE BY: JEAN KURK                WR/IR #: CHG0267085        00214601
001500***************************************************************** 00215000
001600 ENVIRONMENT DIVISION.                                            00220000
001700***************************************************************** 00230000
001800                                                                  00240000
001900 CONFIGURATION SECTION.                                           00250000
002000                                                                  00260000
002100 SOURCE-COMPUTER.        IBM-3090.                                00270000
002200                                                                  00280000
002300 OBJECT-COMPUTER.        IBM-3090.                                00290000
002400                                                                  00300000
002500 INPUT-OUTPUT SECTION.                                            00310000
002600                                                                  00320000
002700 FILE-CONTROL.                                                    00330000
002800                                                                  00340000
002900     SELECT DATE-CARD-FILE                                        00350000
003000         ASSIGN TO INP01.                                         00360000
003100                                                                  00370000
121621     SELECT UPDT-CARD-FILE                                        00371000
121621         ASSIGN TO INP02.                                         00372000
003100                                                                  00373000
003200     SELECT COSA-UPDATE-FILE                                      00380000
003300         ASSIGN TO OUT01.                                         00390000
003400                                                                  00400000
003500                                                                  00410000
003600******************************************************************00420000
003700 DATA DIVISION.                                                   00430000
003800******************************************************************00440000
003900                                                                  00450000
004000 FILE SECTION.                                                    00460000
004100                                                                  00470000
004200 FD  DATE-CARD-FILE                                               00480000
004300     RECORDING MODE IS F                                          00490000
004400     BLOCK CONTAINS 0 RECORDS                                     00500000
004500     LABEL RECORDS ARE STANDARD.                                  00510000
004600                                                                  00520000
004700 01  DATE-CARD-RECORD            PIC X(80).                       00530000
004800                                                                  00540000
004200 FD  UPDT-CARD-FILE                                               00541000
004300     RECORDING MODE IS F                                          00542000
004400     BLOCK CONTAINS 0 RECORDS                                     00543000
004500     LABEL RECORDS ARE STANDARD.                                  00544000
004600                                                                  00545000
004700 01  UPDT-CARD-RECORD            PIC X(80).                       00546000
004800                                                                  00547000
004900 FD  COSA-UPDATE-FILE                                             00550000
005000     RECORDING MODE IS F                                          00560000
005100     LABEL RECORDS ARE STANDARD                                   00570000
005200     BLOCK CONTAINS 0 RECORDS.                                    00580000
005400                                                                  00590000
121621 01  COSA-UPDATE-RECORD          PIC X(250).                      00600000
005600                                                                  00610000
005700                                                                  00620000
005800******************************************************************00630000
005900 WORKING-STORAGE SECTION.                                         00640000
006000******************************************************************00650000
006100 01  FILLER                            PIC X(50)  VALUE           00660000
006200     ' *** WORKING STORAGE STARTS HERE FOR TCKUP099 *** '.        00670000
006300                                                                  00680000
006400******************************************************************00690000
006500* RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                   *00700000
006600******************************************************************00710000
006700 01  CC-CONTROL-CARD.                                             00720000
006800     05  CC-CONTROL-CARD-DISPLAY.                                 00730000
006900         10  CC-CONTROL-NAME     PIC X(14)    VALUE SPACE.        00740000
007000             88  CC-VALID-CONTROL-NAME        VALUE               00750000
007100                 'P.O.S. DATE = '.                                00760000
007200         10  CC-POS-DATE-MMDDYY  PIC 9(6)     VALUE ZERO.         00770000
007300     05  FILLER                  PIC X(60)    VALUE SPACE.        00780000
007400                                                                  00790000
006400******************************************************************00791000
006500* RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                   *00792000
006600******************************************************************00793000
006700 01  C2-CONTROL-CARD.                                             00794000
006800     05  C2-CONTROL-CARD-DISPLAY.                                 00795000
006900         10  C2-CONTROL-NAME     PIC X(14)    VALUE SPACE.        00796000
007000             88  C2-VALID-CONTROL-NAME        VALUE               00797000
007100                 'UPDATE DATE = '.                                00798000
007200         10  C2-POS-DATE-MMDDYY  PIC 9(6)     VALUE ZERO.         00799000
007300     05  FILLER                  PIC X(60)    VALUE SPACE.        00799100
007400                                                                  00799200
007500******************************************************************00800000
007600*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)            *00810000
007700******************************************************************00820000
007800     COPY DPWS500.                                                00830000
007900                                                                  00840000
008000 01  AC-ABEND-CODE                      PIC S9(04) VALUE ZERO     00850000
008100                                                  COMP SYNC.      00860000
008200     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    00870000
008300     88  AC-DB2-ERROR                             VALUE +4013.    00880000
008400     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    00890000
008500                                                                  00900000
121621  01  PV-NULL-INDICATORS.                                         00910000
121621      05  PV-OMNI-NULL-IND             PIC S9(4) COMP VALUE +0.   00920000
                                                                        00920100
008600  01  PS-PROGRAM-SWITCHES.                                        00921000
008700     05  PS-END-OF-EXTRACT-SW          PIC X(01)  VALUE 'N'.      00922000
008800         88  PS-NOT-END-OF-EXTRACT                VALUE 'N'.      00930000
008900         88  PS-END-OF-EXTRACT                    VALUE 'Y'.      00940000
008910     05  PS-END-OF-LATE-SW             PIC X(01)  VALUE 'N'.      00950000
008920         88  PS-NOT-END-OF-LATE                   VALUE 'N'.      00960000
008930         88  PS-END-OF-LATE                       VALUE 'Y'.      00970000
009000     05  PS-END-OF-DATE-FILE-SW        PIC X(01)  VALUE 'N'.      00980000
009100         88  PS-END-OF-DATE-FILE                  VALUE 'Y'.      00990000
009200                                                                  01000000
009300 01  PC-CONSTANTS.                                                01010000
121621     05  PC-NULL                       PIC S9(4) COMP VALUE -1.   01011000
121621     05  PC-LATE-VALUE                 PIC S9(04) COMP            01020000
121621                                       VALUE -1.                  01020100
121621     05  PC-NOT-LATE-VALUE             PIC S9(04) COMP            01020200
121621                                       VALUE 0.                   01020300
009400     05  PC-ROW-NOT-FOUND              PIC S9(04) VALUE +100      01021000
009500                                                  COMP SYNC.      01030000
009600     05  PC-CURRENT-PROGRAM-NAME       PIC  X(08) VALUE           01040000
009700                                                 'TCKUP099'.      01050000
009800 01  PV-PROGRAM-VARIABLES.                                        01060000
009900     05  PV-PARAGRAPH-NAME             PIC  X(30) VALUE SPACE.    01070000
010000     05  PV-OPERATION-MSG-1            PIC  X(40) VALUE SPACE.    01080000
010100     05  PV-OPERATION-MSG-2            PIC  X(40) VALUE SPACE.    01090000
010200     05  PV-DB2-OPERATION              PIC  X(30) VALUE SPACE.    01100000
010300     05  PV-POS-CCYY-MM-DD             PIC  X(10).                01110000
121621     05  PV-UPD-CCYY-MM-DD             PIC  X(10).                01111000
121621     05  PV-UPDT-TYPE                  PIC X(04).                 01111100
121621     05  PV-UPDT-VALUE                 PIC S9(4) USAGE COMP.      01112000
121621     05  PV-UPDT-STAT-CDE              PIC X(2) VALUE SPACE.      01112100
121621     05  PV-COMMIT-COUNTER             PIC  9(4)     VALUE ZERO.  01113000
010310     05  PV-TNDR-AMT                   PIC S9(7)V99 VALUE ZERO.   01120000
010320     05  PV-TAX-AMT                    PIC S9(7)V99 VALUE ZERO.   01130000
010400                                                                  01140000
010410     05  PV-CRD-LVL-RSLT-CDE.                                     01150000
010420         10  PV-CRD-LVL-RSLT-CDE-1     PIC X(01)  VALUE SPACES.   01160000
010421         10  PV-CRD-LVL-RSLT-CDE-2     PIC X(01)  VALUE SPACES.   01170000
010422                                                                  01180000
SHIP   05  PV-VISA-MULT-CLR-SEQ-NBR      PIC 9(04)  VALUE ZEROES.       01190000
SHIP   05  PV-VISA-TOT-SHP-NBR           PIC 9(04)  VALUE ZEROES.       01200000
121621                                                                  01200100
121621 01  TC-TRANS-RECORD.                                             01201000
070121     05  TC-UPDT-TYPE              PIC X(4).                      01202000
070121     05  FILLER                    PIC X(1) VALUE ','.            01202100
070121     05  TC-ORIG-DKEY-DATE         PIC X(10).                     01202200
070121     05  FILLER                    PIC X(1) VALUE ','.            01202300
070121     05  TC-UPDT-DKEY-DATE         PIC X(10).                     01203000
070121     05  FILLER                    PIC X(1) VALUE ','.            01203100
070121     05  TC-PARTN-NBR              PIC 9(4).                      01203200
070121     05  FILLER                    PIC X(1) VALUE ','.            01203300
070121     05  TC-STR-NBR                PIC 9(4).                      01203400
070121     05  FILLER                    PIC X(1) VALUE ','.            01203500
070121     05  TC-RGST-ID                PIC 9(4).                      01204000
070121     05  FILLER                    PIC X(1) VALUE ','.            01204100
070121     05  TC-TRN-NBR                PIC 9(4).                      01205000
070121     05  FILLER                    PIC X(1) VALUE ','.            01205100
070121     05  TC-STRT-TM                PIC X(8).                      01206000
070121     05  FILLER                    PIC X(1) VALUE ','.            01206100
070121     05  TC-SLS-CORR-SEQ-NBR       PIC -9(4).                     01207000
070121     05  FILLER                    PIC X(1) VALUE ','.            01208000
070121     05  TC-TRN-TOT-AMT            PIC -9(9).9(2) VALUE ZEROES.   01209100
070121     05  FILLER                    PIC X(1) VALUE ','.            01209200
070121     05  TC-SLS-TX-AMT             PIC -9(7).9(2) VALUE ZEROES.   01209300
070121     05  FILLER                    PIC X(1) VALUE ','.            01209400
070121     05  TC-VOID-ABRT-CDE          PIC X.                         01209500
070121     05  FILLER                    PIC X(1) VALUE ','.            01209600
070121     05  TC-TRN-STAT-CDE           PIC X.                         01209700
070121     05  FILLER                    PIC X(1) VALUE ','.            01209800
070121     05  TC-TRN-TYP-CDE            PIC X(02).                     01209900
070121     05  FILLER                    PIC X(1) VALUE ','.            01210000
070121     05  TC-SLS-DTE                PIC X(10).                     01210100
070121     05  FILLER                    PIC X(1) VALUE ','.            01210200
070121     05  TC-PRCG-DTE               PIC X(10).                     01210300
070121     05  FILLER                    PIC X(1) VALUE ','.            01210400
070121     05  TC-TRN-DTE                PIC X(10).                     01210500
070121     05  FILLER                    PIC X(1) VALUE ','.            01210600
070121     05  TC-OMNI-CHNL-FFLMT-TYP-CDE PIC X(03).                    01210700
070121     05  FILLER                    PIC X(1) VALUE ','.            01210800
070121     05  FILLER                    PIC X(118).                    01210900
121621                                                                  01211000
070121 01  TC-DISPLAY-VARIABLES.                                        01211100
070121     05  TC-DISP-PARTN-NBR         PIC 9(3).                      01211200
070121     05  FILLER                    PIC X(1) VALUE SPACE.          01211300
070121     05  TC-DISP-STR-NBR           PIC 9(4).                      01211400
070121     05  FILLER                    PIC X(1) VALUE SPACE.          01211500
070121     05  TC-DISP-RGST-ID           PIC 9(2).                      01211600
070121     05  FILLER                    PIC X(1) VALUE SPACE.          01211700
070121     05  TC-DISP-TRN-NBR           PIC 9(4).                      01211800
070121     05  FILLER                    PIC X(1) VALUE SPACE.          01211900
070121     05  TC-DISP-STRT-TM           PIC X(8).                      01212000
070121     05  FILLER                    PIC X(1) VALUE SPACE.          01212100
070121     05  TC-DISP-SLS-CORR-SEQ-NBR  PIC 9(2).                      01212200
070121     05  FILLER                    PIC X(1) VALUE SPACE.          01212300
070121     05  TC-DISP-TNDR-AMT          PIC -(9).99.                   01212400
070121     05  FILLER                    PIC X(1) VALUE SPACE.          01212500
070121     05  TC-DISP-TRANSACTION-AMT   PIC -(9).99.                   01212600
070121     05  FILLER                    PIC X(1) VALUE SPACE.          01212700
070121     05  TC-DISP-VAR-AMT           PIC -(9).99.                   01213000
010422                                                                  01230000
010500***************************************************************** 01240000
010600*  COSA EXTRACT FLAT FILE LAYOUT                                  01250000
010700******************************************************************01260000
010800     COPY TCRD004.                                                01270000
010900                                                                  01280000
011000***************************************************************** 01290000
011100*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            01300000
011200******************************************************************01310000
011300     COPY DPWS004.                                                01320000
011400                                                                  01330000
011500******************************************************************01340000
011600*  DB2 COMMUNICATION AREA.                                        01350000
011700******************************************************************01360000
011800     EXEC SQL                                                     01370000
011900          INCLUDE SQLCA                                           01380000
012000     END-EXEC.                                                    01390000
012100                                                                  01400000
012200******************************************************************01410000
012300*  DB2 TABLE DB2PDBA.TEPPART - PARTITION CONTROL TABLE            01420000
012400******************************************************************01430000
012500     EXEC SQL                                                     01440000
012600          INCLUDE TEPPART                                         01450000
012700     END-EXEC.                                                    01460000
012800                                                                  01470000
012900******************************************************************01480000
013000*  DB2 TABLE DB2PDBA.TEPDKEY         PROCESING DAY KEY TABLE      01490000
013100******************************************************************01500000
013200     EXEC SQL                                                     01510000
013300          INCLUDE TEPDKEY                                         01520000
013400     END-EXEC.                                                    01530000
013900     EXEC SQL                                                     01580000
014000          INCLUDE TEPTRN                                          01590000
014100     END-EXEC.                                                    01600000
013900     EXEC SQL                                                     01606400
014000          INCLUDE TEPITM                                          01606500
014100     END-EXEC.                                                    01606600
013900     EXEC SQL                                                     01606700
014000          INCLUDE TEPTRT                                          01606800
014100     END-EXEC.                                                    01606900
013900     EXEC SQL                                                     01607000
014000          INCLUDE TEPIRT                                          01608000
014100     END-EXEC.                                                    01609000
013900     EXEC SQL                                                     01609100
014000          INCLUDE TEPCRD                                          01609200
014100     END-EXEC.                                                    01609300
013900     EXEC SQL                                                     01609400
014000          INCLUDE TEPTND                                          01609500
014100     END-EXEC.                                                    01609600
013900     EXEC SQL                                                     01609700
014000          INCLUDE TEPPAY                                          01609800
014100     END-EXEC.                                                    01609900
013900     EXEC SQL                                                     01610000
014000          INCLUDE TEPSVC                                          01610100
014100     END-EXEC.                                                    01610200
013900     EXEC SQL                                                     01610300
014000          INCLUDE TEPIPS                                          01610400
014100     END-EXEC.                                                    01610500
013900     EXEC SQL                                                     01610600
014000          INCLUDE TEPSHP                                          01610700
014100     END-EXEC.                                                    01610800
013900     EXEC SQL                                                     01610900
014000          INCLUDE TEPSAT                                          01611000
014100     END-EXEC.                                                    01611100
013900     EXEC SQL                                                     01611200
014000          INCLUDE TEPATR                                          01611300
014100     END-EXEC.                                                    01611400
013900     EXEC SQL                                                     01611500
014000          INCLUDE TEPLID                                          01611600
014100     END-EXEC.                                                    01611700
013900     EXEC SQL                                                     01611800
014000          INCLUDE TEPTLD                                          01611900
014100     END-EXEC.                                                    01612000
013900     EXEC SQL                                                     01612100
014000          INCLUDE TEPCMD                                          01612200
014100     END-EXEC.                                                    01612300
013900     EXEC SQL                                                     01612400
014000          INCLUDE TEPLIS                                          01612500
014100     END-EXEC.                                                    01612600
013900     EXEC SQL                                                     01612700
014000          INCLUDE TEPCHK                                          01612800
014100     END-EXEC.                                                    01612900
013900     EXEC SQL                                                     01613000
014000          INCLUDE TEPCRR                                          01613100
014100     END-EXEC.                                                    01613200
013900     EXEC SQL                                                     01613300
014000          INCLUDE TEPECX                                          01613400
014100     END-EXEC.                                                    01613500
013900     EXEC SQL                                                     01613600
014000          INCLUDE TEPERR                                          01613700
014100     END-EXEC.                                                    01613800
013900     EXEC SQL                                                     01613900
014000          INCLUDE TEPEID                                          01614000
014100     END-EXEC.                                                    01614100
013900     EXEC SQL                                                     01614200
014000          INCLUDE TEPGCA                                          01614300
014100     END-EXEC.                                                    01614400
013900     EXEC SQL                                                     01614500
014000          INCLUDE TEPGFT                                          01614600
014100     END-EXEC.                                                    01614700
013900     EXEC SQL                                                     01614800
014000          INCLUDE TEPIGP                                          01614900
014100     END-EXEC.                                                    01615000
013900     EXEC SQL                                                     01615100
014000          INCLUDE TEPNSF                                          01615200
014100     END-EXEC.                                                    01615300
013900     EXEC SQL                                                     01615400
014000          INCLUDE TEPORD                                          01615500
014100     END-EXEC.                                                    01615600
013900     EXEC SQL                                                     01615700
014000          INCLUDE TEPRFN                                          01615800
014100     END-EXEC.                                                    01615900
013900     EXEC SQL                                                     01616000
014000          INCLUDE TEPRKY                                          01616100
014100     END-EXEC.                                                    01616200
013900     EXEC SQL                                                     01616300
014000          INCLUDE TEPRTX                                          01616400
014100     END-EXEC.                                                    01616500
013900     EXEC SQL                                                     01616600
014000          INCLUDE TEPTAX                                          01616700
014100     END-EXEC.                                                    01616800
014600     EXEC SQL                                                     01650000
014700          INCLUDE EPT00053                                        01660000
014800     END-EXEC.                                                    01670000
014600     EXEC SQL                                                     01671000
014700          INCLUDE EPT00054                                        01672000
014800     END-EXEC.                                                    01673000
014600     EXEC SQL                                                     01674000
014700          INCLUDE EPT00056                                        01675000
014800     END-EXEC.                                                    01676000
014600     EXEC SQL                                                     01677000
014700          INCLUDE EPT00000                                        01678000
014800     END-EXEC.                                                    01679000
014600     EXEC SQL                                                     01679100
014700          INCLUDE EPT00050                                        01679200
014800     END-EXEC.                                                    01679300
014600     EXEC SQL                                                     01679400
014700          INCLUDE EPT00019                                        01679500
014800     END-EXEC.                                                    01679600
014600     EXEC SQL                                                     01679700
014700          INCLUDE EPT00002                                        01679800
014800     END-EXEC.                                                    01679900
014600     EXEC SQL                                                     01683000
014700          INCLUDE EPT00006                                        01684000
014800     END-EXEC.                                                    01685000
014600     EXEC SQL                                                     01686000
014700          INCLUDE EPT00008                                        01687000
014800     END-EXEC.                                                    01688000
014600     EXEC SQL                                                     01689000
014700          INCLUDE EPT00026                                        01689100
014800     END-EXEC.                                                    01689200
014600     EXEC SQL                                                     01689300
014700          INCLUDE EPT00063                                        01689400
014800     END-EXEC.                                                    01689500
014600     EXEC SQL                                                     01689600
014700          INCLUDE EPT00039                                        01689700
014800     END-EXEC.                                                    01689800
014600     EXEC SQL                                                     01689900
014700          INCLUDE EPT00065                                        01690000
014800     END-EXEC.                                                    01691000
014600     EXEC SQL                                                     01695000
014700          INCLUDE EPT00029                                        01696000
014800     END-EXEC.                                                    01697000
014600     EXEC SQL                                                     01698000
014700          INCLUDE EPT00022                                        01699000
014800     END-EXEC.                                                    01699100
014600     EXEC SQL                                                     01699200
014700          INCLUDE EPT00038                                        01699300
014800     END-EXEC.                                                    01699400
014600     EXEC SQL                                                     01699500
014700          INCLUDE EPT00033                                        01699600
014800     END-EXEC.                                                    01699700
014940     EXEC SQL                                                     01720000
014950          INCLUDE TEPTTD                                          01730000
014960     END-EXEC.                                                    01740000
015300     EXEC SQL                                                     01790000
015400          INCLUDE TEPRFA                                          01800000
015500     END-EXEC.                                                    01810000
016340     EXEC SQL                                                     01860000
016350          INCLUDE TEPVDA                                          01870000
016360     END-EXEC.                                                    01880000
121621*    THIS MUST BE COMMENTED OUT AS A VARIABLE EXCEEDS THE         01881000
121621*    COBOL LENGTH LIMIT                                           01881100
121621*    EXEC SQL                                                     01881200
121621*         INCLUDE EPT00072                                        01882000
121621*    END-EXEC.                                                    01883000
      ******************************************************************01884000
      * TKMD.DB2.DCLGEN(EPT00072)                                      *01885000
      ******************************************************************01886000
      ******************************************************************01887000
      * DCLGEN TABLE(EPT_EMV_CRD_TNDR)                                 *01888000
      *        LIBRARY(TKMD.DB2.DCLGEN(EPT00072))                      *01889000
      *        ACTION(REPLACE)                                         *01889100
      *        LANGUAGE(COBOL)                                         *01889200
      *        NAMES(EPT00072-)                                        *01889300
      *        STRUCTURE(DCLEPT00072)                                  *01889400
      *        APOST                                                   *01889500
      *        COLSUFFIX(YES)                                          *01889600
      * ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *01889700
      ******************************************************************01889800
           EXEC SQL DECLARE EPT_EMV_CRD_TNDR TABLE                      01889900
           ( PARTN_NBR                      SMALLINT NOT NULL,          01890000
             STR_NBR                        SMALLINT NOT NULL,          01890100
             RGST_ID                        SMALLINT NOT NULL,          01890200
             TRN_NBR                        SMALLINT NOT NULL,          01890300
             STRT_TM                        TIME NOT NULL,              01890400
             SLS_CORR_SEQ_NBR               SMALLINT NOT NULL,          01890500
             TNDR_SEQ_NBR                   SMALLINT NOT NULL,          01890600
             CRD_TYP_CDE                    CHAR(2) NOT NULL,           01890700
             APPL_IDCN_NBR                  VARCHAR(32) NOT NULL,       01890800
             APPL_LBL_NM                    VARCHAR(32) NOT NULL,       01890900
             TRMNL_VRFN_RSLT_NBR            CHAR(10) NOT NULL,          01891000
             TRN_STAT_CDE                   CHAR(4) NOT NULL,           01891100
             ISUR_APPL_DAT_TXT              VARCHAR(64) NOT NULL,       01891200
             APPL_RSPN_CDE                  CHAR(4) NOT NULL,           01891300
             CRD_VRFN_MTHD_CDE              CHAR(2) NOT NULL,           01891400
             ENTR_MODE_CDE                  CHAR(2) NOT NULL,           01891500
             APPL_SEQ_NBR                   CHAR(2) NOT NULL            01891600
           ) END-EXEC.                                                  01891700
      ******************************************************************01891800
      * COBOL DECLARATION FOR TABLE DB2TDBA.EPT_EMV_CRD_TNDR           *01891900
      ******************************************************************01892000
       01  DCLEPT00072.                                                 01892100
      *                       PARTN_NBR                                 01892200
           10 EPT00072-PARTN-NBR   PIC S9(4) USAGE COMP.                01892300
      *                       STR_NBR                                   01892400
           10 EPT00072-STR-NBR     PIC S9(4) USAGE COMP.                01892500
      *                       RGST_ID                                   01892600
           10 EPT00072-RGST-ID     PIC S9(4) USAGE COMP.                01892700
      *                       TRN_NBR                                   01892800
           10 EPT00072-TRN-NBR     PIC S9(4) USAGE COMP.                01892900
      *                       STRT_TM                                   01893000
           10 EPT00072-STRT-TM     PIC X(8).                            01893100
      *                       SLS_CORR_SEQ_NBR                          01893200
           10 EPT00072-SLS-CORR-SEQ-NBR                                 01893300
              PIC S9(4) USAGE COMP.                                     01893400
      *                       TNDR_SEQ_NBR                              01893500
           10 EPT00072-TNDR-SEQ-NBR                                     01893600
              PIC S9(4) USAGE COMP.                                     01893700
      *                       CRD_TYP_CDE                               01893800
           10 EPT00072-CRD-TYP-CDE                                      01893900
              PIC X(2).                                                 01894000
           10 EPT00072-APPL-IDCN-NBR.                                   01894100
      *                       APPL_IDCN_NBR LENGTH                      01894200
              49 EPT00072-APPL-IDCN-NBR-LEN                             01894300
                 PIC S9(4) USAGE COMP.                                  01894400
      *                       APPL_IDCN_NBR                             01894500
              49 EPT00072-APPL-IDCN-NBR-TEXT                            01894600
                 PIC X(32).                                             01894700
           10 EPT00072-APPL-LBL-NM.                                     01894800
      *                       APPL_LBL_NM LENGTH                        01894900
              49 EPT00072-APPL-LBL-NM-LEN                               01895000
                 PIC S9(4) USAGE COMP.                                  01895100
      *                       APPL_LBL_NM                               01895200
              49 EPT00072-APPL-LBL-NM-TEXT                              01895300
                 PIC X(32).                                             01895400
      *                       TRMNL_VRFN_RSLT_NBR                       01895500
           10 EPT00072-TRMNL-VRFN-RSLT-NBR                              01895600
              PIC X(10).                                                01895700
      *                       TRN_STAT_CDE                              01895800
           10 EPT00072-TRN-STAT-CDE                                     01895900
              PIC X(4).                                                 01896000
           10 EPT00072-ISUR-APPL-DAT-TXT.                               01896100
      *                       ISUR_APPL_DAT_TXT LENGTH                  01896200
              49 EPT00072-ISUR-APPL-DAT-TXT-LEN                         01896300
                 PIC S9(4) USAGE COMP.                                  01896400
      *                       ISUR_APPL_DAT_TXT                         01896500
              49 EPT00072-ISUR-APPL-DAT-TXT-TXT                         01896600
                 PIC X(64).                                             01896700
      *                       APPL_RSPN_CDE                             01896800
           10 EPT00072-APPL-RSPN-CDE                                    01896900
              PIC X(4).                                                 01897000
      *                       CRD_VRFN_MTHD_CDE                         01897100
           10 EPT00072-CRD-VRFN-MTHD-CDE                                01897200
              PIC X(2).                                                 01897300
      *                       ENTR_MODE_CDE                             01897400
           10 EPT00072-ENTR-MODE-CDE                                    01897500
              PIC X(2).                                                 01897600
      *                       APPL_SEQ_NBR                              01897700
           10 EPT00072-APPL-SEQ-NBR                                     01897800
              PIC X(2).                                                 01897900
      ******************************************************************01898000
      * THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 17      *01898100
      ******************************************************************01898200
016370                                                                  01899000
016400******************************************************************01900000
016500*  CREATE CURSOR FOR EXTRACT                                      01910000
016600******************************************************************01920000
016700     EXEC SQL                                                     01930000
121621         DECLARE EXTRACT-CURSOR CURSOR WITH HOLD                  01940000
016900         FOR SELECT                                               01950000
016900                    PRT.PARTN_NBR                                 01951000
017000                  , TRN.STR_NBR                                   01960000
017100                  , TRN.RGST_ID                                   01970000
017200                  , TRN.TRN_NBR                                   01980000
017300                  , TRN.STRT_TM                                   01990000
017400                  , TRN.SLS_CORR_SEQ_NBR                          02000000
017500                  , TRN.VOID_ABRT_CDE                             02010000
017600                  , TRN.TRN_STAT_CDE                              02020000
017700                  , TRN.TRN_TYP_CDE                               02030000
017700                  , TRN.SLS_DTE                                   02040000
017700                  , TRN.PRCG_DTE                                  02050000
017700                  , TRN.TRN_DTE                                   02060000
017700                  , TRN.TRN_TOT_AMT                               02070000
017700                  , TRN.SLS_TX_AMT                                02080000
017700                  , TRN.OMNI_CHNL_FFLMT_TYP_CDE                   02090000
019300                FROM                                              02280000
019400                     TEPPART PRT                                  02290000
019700                   , TEPTRN  TRN                                  02310000
019900                WHERE                                             02421000
121621                      PRT.SLS_DTE          = :PV-POS-CCYY-MM-DD   02431000
                        AND PRT.DB_STRUC_CDE  = 'O'                     02440000
                        AND PRT.STR_GP_CDE    = 'A'                     02450000
                        AND TRN.PARTN_NBR     = PRT.PARTN_NBR           02460000
                        AND TRN.TRN_STAT_CDE NOT IN ('R','V','L')       02470000
022700     END-EXEC.                                                    03590000
022800                                                                  03600000
022810******************************************************************03610000
022820*  THIS CURSOR CHECKS FOR LATE AND SALES CORRECTIONS        *     03620000
022820*  TRANSACTIONS.                                            *     03621000
022830******************************************************************03630000
022840     EXEC SQL                                                     03640000
121621         DECLARE LATE-CURSOR CURSOR WITH HOLD                     03650000
022860         FOR SELECT                                               03660000
016900                    PRT.PARTN_NBR                                 03670000
017000                  , TRN.STR_NBR                                   03680000
017100                  , TRN.RGST_ID                                   03690000
017200                  , TRN.TRN_NBR                                   03700000
017300                  , TRN.STRT_TM                                   03710000
017400                  , TRN.SLS_CORR_SEQ_NBR                          03720000
017500                  , TRN.VOID_ABRT_CDE                             03730000
017600                  , TRN.TRN_STAT_CDE                              03740000
017700                  , TRN.TRN_TYP_CDE                               03750000
017700                  , TRN.SLS_DTE                                   03760000
017700                  , TRN.PRCG_DTE                                  03770000
017700                  , TRN.TRN_DTE                                   03780000
017700                  , TRN.TRN_TOT_AMT                               03790000
017700                  , TRN.SLS_TX_AMT                                03800000
017700                  , TRN.OMNI_CHNL_FFLMT_TYP_CDE                   03810000
022917                FROM TEPDKEY DKY                                  03990000
022918                   , TEPPART PRT                                  04000000
022920                   , TEPTRN  TRN                                  04020000
022932                WHERE                                             04140000
022932                      DKY.PRCG_DTE      = :PV-POS-CCYY-MM-DD      04141000
022933                  AND PRT.SLS_DTE       = DKY.SLS_DTE             04150000
022934                  AND TRN.PARTN_NBR     = PRT.PARTN_NBR           04160000
022935                  AND TRN.STR_NBR       = DKY.STR_NBR             04170000
022936                  AND TRN.TRN_NBR       = DKY.TRN_NBR             04180000
022937                  AND TRN.STRT_TM       = DKY.STRT_TM             04190000
022938                  AND TRN.SLS_CORR_SEQ_NBR =                      04200000
022939                                        DKY.SLS_CORR_SEQ_NBR      04210000
022961     END-EXEC.                                                    04430000
022962                                                                  04440000
022970 PROCEDURE DIVISION.                                              04450000
023000                                                                  04460000
023100 0000-MAINLINE-PARAGRAPH.                                         04470000
023200                                                                  04480000
023300     PERFORM 1000-INITIALIZE-PROGRAM.                             04490000
023500                                                                  04500000
023510***** GET COSA TRANSACTIONS FROM INPUT DATE                       04510000
023520                                                                  04520000
023530     PERFORM 3000-OPEN-EXTRACT-CURSOR.                            04530000
023600     PERFORM 3100-FETCH-EXTRACT-CURSOR.                           04540000
023700                                                                  04550000
023800     PERFORM 2000-PROCESS                                         04560000
023900           UNTIL PS-END-OF-EXTRACT.                               04570000
024000                                                                  04580000
024100     PERFORM 3300-CLOSE-EXTRACT-CURSOR.                           04590000
024200                                                                  04600000
023510***** GET LATE TRANSACTIONS AND SALES CORRECTIONS FOR INPUT DATE  04611000
024202                                                                  04620000
121621     PERFORM 5000-OPEN-LATE-CSR.                                  04630000
121621     PERFORM 5100-FETCH-LATE-CSR.                                 04640000
121621                                                                  04650000
121621     PERFORM 6000-PROCESS-LATE                                    04660000
121621         UNTIL PS-END-OF-LATE.                                    04670000
121621                                                                  04680000
121621     PERFORM 5200-CLOSE-LATE-CSR.                                 04690000
024280                                                                  04700000
024300     CLOSE DATE-CARD-FILE                                         04710000
121621           UPDT-CARD-FILE                                         04711000
024400           COSA-UPDATE-FILE.                                      04720000
024500                                                                  04730000
024600     GOBACK.                                                      04740000
024700                                                                  04750000
024800******************************************************************04760000
024900* 1000-INITIALIZE-PROGRAM                                         04770000
025000*     OPEN FILES, PROCESS CONTROL CARD                            04780000
025100******************************************************************04790000
025200 1000-INITIALIZE-PROGRAM.                                         04800000
025300                                                                  04810000
121621     MOVE 0           TO PV-COMMIT-COUNTER.                       04811000
025400     OPEN INPUT  DATE-CARD-FILE                                   04820000
121621                 UPDT-CARD-FILE                                   04821000
025500          OUTPUT COSA-UPDATE-FILE.                                04830000
025600                                                                  04840000
025700     PERFORM 1300-PROCESS-DATE-CARD.                              04850000
121621     PERFORM 1301-PROCESS-UPDT-CARD.                              04851000
025800                                                                  04860000
025900     SET PS-NOT-END-OF-EXTRACT              TO TRUE.              04870000
026000                                                                  04880000
026100******************************************************************04890000
026200* 1300-PROCESS-DATE-CARD                                          04900000
026300******************************************************************04910000
026400 1300-PROCESS-DATE-CARD.                                          04920000
026500                                                                  04930000
026600     READ DATE-CARD-FILE INTO CC-CONTROL-CARD                     04940000
026700         AT END                                                   04950000
026800             SET PS-END-OF-DATE-FILE TO TRUE.                     04960000
026900                                                                  04970000
027000     IF PS-END-OF-DATE-FILE                                       04980000
027100         MOVE '1300-PROCESS-DATE-CARD'  TO PV-PARAGRAPH-NAME      04990000
027200         MOVE 'DATE CARD MISSING      ' TO PV-OPERATION-MSG-1     05000000
027300         SET AC-CONTROL-CARD-ERROR TO TRUE                        05010000
027400         PERFORM 9999-ABEND                                       05020000
027500     END-IF.                                                      05030000
027600                                                                  05040000
027700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05050000
027800                                                                  05060000
027900     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   05070000
028000     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   05080000
028100     SET  DPG52-LK-DTE-GREG            TO TRUE.                   05090000
028200     MOVE CC-POS-DATE-MMDDYY           TO DPG52-LK-DATE-INPUT.    05100000
028300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    05110000
028400                                             DPG54 DPG55 DPG56.   05120000
028500     EVALUATE TRUE                                                05130000
028600         WHEN DPG54-SEVERE-ERROR                                  05140000
028700         WHEN DPG54-DATE-INVALID                                  05150000
028800             MOVE '1300-PROCESS-DATE-CARD'                        05160000
028900                                           TO PV-PARAGRAPH-NAME   05170000
029000             MOVE 'ERROR CONVERTING INPUT CARD DATE'              05180000
029100                                           TO PV-OPERATION-MSG-1  05190000
029200             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                05200000
029300             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  05210000
029400             PERFORM 9999-ABEND                                   05220000
029500     END-EVALUATE.                                                05230000
029600                                                                  05240000
029700     MOVE DPG55-DB2-ISO-DATE-FMT       TO PV-POS-CCYY-MM-DD.      05250000
           DISPLAY 'PV-POS-CCYY-MM-DD ' PV-POS-CCYY-MM-DD.              05250100
029800                                                                  05260000
026100******************************************************************05261000
026200* 1301-PROCESS-UPDT-CARD                                          05262000
026300******************************************************************05263000
026400 1301-PROCESS-UPDT-CARD.                                          05264000
026500                                                                  05265000
026600     READ UPDT-CARD-FILE INTO C2-CONTROL-CARD                     05266000
026700         AT END                                                   05267000
026800             SET PS-END-OF-DATE-FILE TO TRUE.                     05268000
026900                                                                  05269000
027000     IF PS-END-OF-DATE-FILE                                       05269100
027100         MOVE '1301-PROCESS-UPDT-CARD'  TO PV-PARAGRAPH-NAME      05269200
027200         MOVE 'DATE CARD MISSING      ' TO PV-OPERATION-MSG-1     05269300
027300         SET AC-CONTROL-CARD-ERROR TO TRUE                        05269400
027400         PERFORM 9999-ABEND                                       05269500
027500     END-IF.                                                      05269600
027600                                                                  05269700
027700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05269800
027800                                                                  05269900
027900     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   05270000
028000     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   05270100
028100     SET  DPG52-LK-DTE-GREG            TO TRUE.                   05270200
028200     MOVE C2-POS-DATE-MMDDYY           TO DPG52-LK-DATE-INPUT.    05270300
028300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    05270400
028400                                             DPG54 DPG55 DPG56.   05270500
028500     EVALUATE TRUE                                                05270600
028600         WHEN DPG54-SEVERE-ERROR                                  05270700
028700         WHEN DPG54-DATE-INVALID                                  05270800
028800             MOVE '1301-PROCESS-UPDT-CARD'                        05270900
028900                                           TO PV-PARAGRAPH-NAME   05271000
029000             MOVE 'ERROR CONVERTING INPUT CARD DATE'              05271100
029100                                           TO PV-OPERATION-MSG-1  05271200
029200             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                05271300
029300             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  05271400
029400             PERFORM 9999-ABEND                                   05271500
029500     END-EVALUATE.                                                05271600
029600                                                                  05271700
029700     MOVE DPG55-DB2-ISO-DATE-FMT       TO PV-UPD-CCYY-MM-DD.      05271800
           DISPLAY 'PV-UPD-CCYY-MM-DD ' PV-UPD-CCYY-MM-DD.              05271900
029800                                                                  05272000
029900***************************************************************** 05273000
030000* 2000-PROCESS                                                    05280000
030100*      PROCESS THE CURSOR TO BUILD THE EXTRACT RECORD             05290000
030200***************************************************************** 05300000
030300  2000-PROCESS.                                                   05310000
030400                                                                  05320000
121621     PERFORM 7000-INSERT-TEPDKEY-RECORD.                          05330000
121621     PERFORM 7001-UPDATE-TEPTRN-RECORD.                           05340000
121621     ADD   +1                     TO PV-COMMIT-COUNTER.           05341000
121621     IF PV-COMMIT-COUNTER > 0                                     05342000
121621        PERFORM 8000-COMMIT                                       05343000
121621        MOVE 0        TO PV-COMMIT-COUNTER                        05344000
121621     END-IF.                                                      05345000
121621     MOVE 'NRML' TO PV-UPDT-TYPE.                                 05350000
121621     PERFORM 4000-WRITE-UPDATE-FILE.                              05380000
034600     PERFORM 3100-FETCH-EXTRACT-CURSOR.                           05410000
034700                                                                  05420000
034800******************************************************************05430000
034900* 3000-OPEN-EXTRACT-CURSOR.                                       05440000
035000*     OPEN EXTRACT CURSOR                                         05450000
035100******************************************************************05460000
035200 3000-OPEN-EXTRACT-CURSOR.                                        05470000
035300                                                                  05480000
035400     EXEC SQL                                                     05490000
035500          OPEN EXTRACT-CURSOR                                     05500000
035600     END-EXEC.                                                    05510000
035700                                                                  05520000
035800     EVALUATE TRUE                                                05530000
035900         WHEN SQLCODE = ZERO                                      05540000
036000              CONTINUE                                            05550000
036100         WHEN SQLWARN0 NOT EQUAL SPACE                            05560000
036200         WHEN SQLCODE NOT EQUAL ZERO                              05570000
036300             MOVE '3000-OPEN-EXTRACT-CURSOR'                      05580000
036400                                            TO PV-PARAGRAPH-NAME  05590000
036500             MOVE 'ERROR ON OPEN OF EXTRACT-CURSOR'               05600000
036600                                            TO PV-DB2-OPERATION   05610000
036700             PERFORM 9100-SQL-ABEND                               05620000
036800     END-EVALUATE.                                                05630000
036900                                                                  05640000
037000******************************************************************05650000
037100* 3100-FETCH-EXTRACT-CURSOR                                       05660000
037200******************************************************************05670000
037300 3100-FETCH-EXTRACT-CURSOR.                                       05680000
037400                                                                  05690000
037500     EXEC SQL                                                     05700000
037600          FETCH EXTRACT-CURSOR                                    05710000
037700           INTO :EPTRN-PARTN-NBR                                  05720000
037800               ,:EPTRN-STR-NBR                                    05730000
037900               ,:EPTRN-RGST-ID                                    05740000
038000               ,:EPTRN-TRN-NBR                                    05750000
038100               ,:EPTRN-STRT-TM                                    05760000
038200               ,:EPTRN-SLS-CORR-SEQ-NBR                           05770000
038300               ,:EPTRN-VOID-ABRT-CDE                              05780000
038400               ,:EPTRN-TRN-STAT-CDE                               05790000
038500               ,:EPTRN-TRN-TYP-CDE                                05800000
038600               ,:EPTRN-SLS-DTE                                    05810000
038700               ,:EPTRN-PRCG-DTE                                   05820000
038800               ,:EPTRN-TRN-DTE                                    05830000
038900               ,:EPTRN-TRN-TOT-AMT                                05840000
039000               ,:EPTRN-SLS-TX-AMT                                 05850000
039100               ,:EPTRN-OMNI-CHNL-FFLMT-TYP-CDE :PV-OMNI-NULL-IND  05860000
040100     END-EXEC.                                                    06040000
040200                                                                  06050000
040300     EVALUATE TRUE                                                06060000
040400         WHEN SQLCODE = ZERO                                      06070000
040610         WHEN SQLCODE = -305                                      06100000
040620*             CONTINUE                                            06110000
121621             DISPLAY 'SLS-DTE   = ' EPTRN-SLS-DTE                 06111000
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               06112000
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 06113000
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 06114000
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 06115000
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 06116000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 06117000
040630                                                                  06120000
040700         WHEN SQLCODE = PC-ROW-NOT-FOUND                          06130000
040800             SET PS-END-OF-EXTRACT          TO TRUE               06140000
040900         WHEN SQLWARN0 NOT EQUAL SPACE                            06150000
041000         WHEN SQLCODE NOT EQUAL ZERO                              06160000
041100             MOVE '3100-FETCH-EXTRACT-CURSOR'                     06170000
041200                                            TO PV-PARAGRAPH-NAME  06180000
041300             MOVE 'ERROR ON FETCH OF EXTRACT-CURSOR'              06190000
041400                                            TO PV-DB2-OPERATION   06200000
041500             PERFORM 9100-SQL-ABEND                               06210000
041600     END-EVALUATE.                                                06220000
041700                                                                  06230000
041800***************************************************************** 06240000
041900* 3300-CLOSE-EXTRACT-CURSOR                                       06250000
042000*      CLOSE CURSOR                                               06260000
042100***************************************************************** 06270000
042200 3300-CLOSE-EXTRACT-CURSOR.                                       06280000
042300                                                                  06290000
042400     EXEC SQL                                                     06300000
042500          CLOSE EXTRACT-CURSOR                                    06310000
042600     END-EXEC.                                                    06320000
042700                                                                  06330000
042800     EVALUATE TRUE                                                06340000
042900         WHEN SQLCODE = ZERO                                      06350000
043000              CONTINUE                                            06360000
043100         WHEN SQLWARN0 NOT EQUAL SPACE                            06370000
043200         WHEN SQLCODE NOT EQUAL ZERO                              06380000
043300             MOVE '3300-CLOSE-EXTRACT-CURSOR'                     06390000
043400                                            TO PV-PARAGRAPH-NAME  06400000
043500             MOVE 'ERROR ON CLOSE OF EXTRACT-CURSOR'              06410000
043600                                            TO PV-DB2-OPERATION   06420000
043700             PERFORM 9100-SQL-ABEND                               06430000
043800     END-EVALUATE.                                                06440000
043900                                                                  06450000
044000******************************************************************06460000
044100* 4000-WRITE-UPDATE-FILE                                          06470000
044110*     FORMAT THE OUTPUT RECORD AND WRITE IT OUT.                  06480000
044300******************************************************************06500000
044400 4000-WRITE-UPDATE-FILE.                                          06510000
044500                                                                  06520000
121621     INITIALIZE TC-TRANS-RECORD.                                  06530000
044502******************************************************************06540000
044503*  THIS COPYBOOK IS THE LAYOUT FOR THE EXTRACT FILE TO BE USED   *06550000
044504*  FOR THE LATE EXTRACT OF CREDIT TRANSACTIONS FOR SETTLEMENT    *06560000
044505*  WITH FIFTH THIRD BANK.                                        *06570000
044506******************************************************************06580000
121621     MOVE PV-UPDT-TYPE           TO TC-UPDT-TYPE.                 06590000
121621     MOVE PV-POS-CCYY-MM-DD      TO TC-ORIG-DKEY-DATE.            06590100
121621     MOVE PV-UPD-CCYY-MM-DD      TO TC-UPDT-DKEY-DATE.            06590200
121621     MOVE EPTRN-PARTN-NBR        TO TC-PARTN-NBR.                 06591000
121621     MOVE EPTRN-STR-NBR          TO TC-STR-NBR.                   06600000
121621     MOVE EPTRN-RGST-ID          TO TC-RGST-ID.                   06610000
121621     MOVE EPTRN-TRN-NBR          TO TC-TRN-NBR.                   06620000
121621     MOVE EPTRN-STRT-TM          TO TC-STRT-TM.                   06630000
121621     MOVE EPTRN-SLS-CORR-SEQ-NBR TO TC-SLS-CORR-SEQ-NBR.          06640000
121621     MOVE EPTRN-VOID-ABRT-CDE    TO TC-VOID-ABRT-CDE.             06650000
121621     MOVE EPTRN-TRN-STAT-CDE     TO TC-TRN-STAT-CDE.              06660000
121621     MOVE EPTRN-TRN-TYP-CDE      TO TC-TRN-TYP-CDE.               06670000
121621     MOVE EPTRN-SLS-DTE          TO TC-SLS-DTE.                   06680000
121621     MOVE EPTRN-PRCG-DTE         TO TC-PRCG-DTE.                  06690000
121621     MOVE EPTRN-TRN-DTE          TO TC-TRN-DTE.                   06700000
121621     MOVE EPTRN-TRN-TOT-AMT      TO TC-TRN-TOT-AMT.               06710000
121621     MOVE EPTRN-SLS-TX-AMT       TO TC-SLS-TX-AMT.                06720000
121621     IF PV-OMNI-NULL-IND = PC-NULL                                06720100
121621         MOVE SPACES             TO TC-OMNI-CHNL-FFLMT-TYP-CDE    06720300
121621     ELSE                                                         06720400
121621         MOVE EPTRN-OMNI-CHNL-FFLMT-TYP-CDE                       06721000
121621                                 TO TC-OMNI-CHNL-FFLMT-TYP-CDE    06730000
121621     END-IF.                                                      06740000
121621     WRITE COSA-UPDATE-RECORD   FROM TC-TRANS-RECORD.             07070000
121621                                                                  07080000
044710******************************************************************07090000
044720* 5000-OPEN-LATE-CSR.                                             07100000
044730*     OPEN LATE VOID CURSOR.                                      07110000
044740******************************************************************07120000
044750 5000-OPEN-LATE-CSR.                                              07130000
044760                                                                  07140000
044770     EXEC SQL                                                     07150000
044780          OPEN LATE-CURSOR                                        07160000
044790     END-EXEC.                                                    07170000
044791                                                                  07180000
044792     EVALUATE TRUE                                                07190000
044793         WHEN SQLCODE = ZERO                                      07200000
044794              CONTINUE                                            07210000
044795         WHEN SQLWARN0 NOT EQUAL SPACE                            07220000
044796         WHEN SQLCODE NOT EQUAL ZERO                              07230000
044797             MOVE '5000-OPEN-LATE-CSR'                            07240000
044798                                            TO PV-PARAGRAPH-NAME  07250000
044799             MOVE 'ERROR ON OPEN OF LATE-CURSOR'                  07260000
044800                                            TO PV-DB2-OPERATION   07270000
044801             PERFORM 9100-SQL-ABEND                               07280000
044802     END-EVALUATE.                                                07290000
044803                                                                  07300000
044804******************************************************************07310000
044805* 5100-FETCH-LATE-CSR                                             07320000
044806******************************************************************07330000
044807 5100-FETCH-LATE-CSR.                                             07340000
044808                                                                  07350000
044809     EXEC SQL                                                     07360000
044810          FETCH LATE-CURSOR                                       07370000
044811           INTO :EPTRN-PARTN-NBR                                  07380000
044812               ,:EPTRN-STR-NBR                                    07390000
044813               ,:EPTRN-RGST-ID                                    07400000
044814               ,:EPTRN-TRN-NBR                                    07410000
044815               ,:EPTRN-STRT-TM                                    07420000
044816               ,:EPTRN-SLS-CORR-SEQ-NBR                           07430000
044817               ,:EPTRN-VOID-ABRT-CDE                              07440000
044818               ,:EPTRN-TRN-STAT-CDE                               07450000
044819               ,:EPTRN-TRN-TYP-CDE                                07460000
044820               ,:EPTRN-SLS-DTE                                    07470000
044821               ,:EPTRN-PRCG-DTE                                   07480000
044822               ,:EPTRN-TRN-DTE                                    07490000
044823               ,:EPTRN-TRN-TOT-AMT                                07500000
044824               ,:EPTRN-SLS-TX-AMT                                 07510000
039100               ,:EPTRN-OMNI-CHNL-FFLMT-TYP-CDE :PV-OMNI-NULL-IND  07511000
044842     END-EXEC.                                                    07700000
044843                                                                  07710000
044844     EVALUATE TRUE                                                07720000
044845         WHEN SQLCODE = ZERO                                      07730000
121621*            CONTINUE                                             07770000
121621             DISPLAY 'SLS-DTE   = ' EPTRN-SLS-DTE                 07780000
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               07781000
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 07782000
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 07783000
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 07784000
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 07785000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 07786000
044851         WHEN SQLCODE = PC-ROW-NOT-FOUND                          07790000
044852             SET PS-END-OF-LATE             TO TRUE               07800000
044853         WHEN SQLWARN0 NOT EQUAL SPACE                            07810000
044854         WHEN SQLCODE NOT EQUAL ZERO                              07820000
044855             MOVE '5100-FETCH-LATE-CSR'                           07830000
044856                                            TO PV-PARAGRAPH-NAME  07840000
044857             MOVE 'ERROR ON FETCH OF LATE-CURSOR'                 07850000
044858                                            TO PV-DB2-OPERATION   07860000
044859             PERFORM 9100-SQL-ABEND                               07870000
044860     END-EVALUATE.                                                07880000
044861                                                                  07890000
044862***************************************************************** 07900000
044863* 5200-CLOSE-LATE-CSR                                             07910000
044864*      CLOSE CURSOR                                               07920000
044865***************************************************************** 07930000
044866 5200-CLOSE-LATE-CSR.                                             07940000
044867                                                                  07950000
044868     EXEC SQL                                                     07960000
044869          CLOSE LATE-CURSOR                                       07970000
044870     END-EXEC.                                                    07980000
044871                                                                  07990000
044872     EVALUATE TRUE                                                08000000
044873         WHEN SQLCODE = ZERO                                      08010000
044874              CONTINUE                                            08020000
044875         WHEN SQLWARN0 NOT EQUAL SPACE                            08030000
044876         WHEN SQLCODE NOT EQUAL ZERO                              08040000
044877             MOVE '5200-CLOSE-LATE-CSR'                           08050000
044878                                            TO PV-PARAGRAPH-NAME  08060000
044879             MOVE 'ERROR ON CLOSE OF LATE-CURSOR'                 08070000
044880                                            TO PV-DB2-OPERATION   08080000
044881             PERFORM 9100-SQL-ABEND                               08090000
044882     END-EVALUATE.                                                08100000
044883                                                                  08110000
044884***************************************************************** 08120000
044885* 6000-PROCESS-LATE                                               08130000
044886*      PROCESS THE CURSOR TO UPDATE THE LATES TO HAVE TOMORROW'S  08140000
044887*      DATE SO THAT THE NIGHTLY BATCH WILL PICK UP THESE          08150000
044888*      TRANSACTIONS.                                              08160000
044890***************************************************************** 08180000
044891  6000-PROCESS-LATE.                                              08190000
044892                                                                  08200000
121621     PERFORM 7033-UPDATE-TEPDKEY-RECORD.                          08310000
121621     PERFORM 7052-UPDATE-TEPTRN-RECORD.                           08311000
121621     ADD   +1                     TO PV-COMMIT-COUNTER.           08312000
121621     IF PV-COMMIT-COUNTER > 0                                     08313000
121621        PERFORM 8000-COMMIT                                       08314000
121621        MOVE 0        TO PV-COMMIT-COUNTER                        08315000
121621     END-IF.                                                      08316000
121621     MOVE 'LATE' TO PV-UPDT-TYPE.                                 08320000
121621     PERFORM 4000-WRITE-UPDATE-FILE.                              08321000
044905     PERFORM 5100-FETCH-LATE-CSR.                                 08330000
044906                                                                  08340000
044000******************************************************************08341000
044100* 7000-INSERT-TEPDKEY-RECORD                                      08342000
044110*     INSERT A TEPDKEY ENTRY FOR THIS TRANSACTION SO THAT         08343000
044200*     IT GETS PICKED UP AND PROCESSED BY THE NIGHTLY BATCH.       08344000
044300******************************************************************08345000
121621 7000-INSERT-TEPDKEY-RECORD.                                      08346000
121621                                                                  08347000
122721     IF EPTRN-SLS-CORR-SEQ-NBR = 0                                08347200
122721         MOVE PC-LATE-VALUE          TO PV-UPDT-VALUE             08347300
122721     ELSE                                                         08347400
122721         MOVE EPTRN-SLS-CORR-SEQ-NBR TO PV-UPDT-VALUE             08347500
122721     END-IF.                                                      08347700
122721                                                                  08347800
121621     EXEC SQL                                                     08348000
121621         INSERT INTO TEPDKEY  (  PRCG_DTE                         08349000
121621                                ,SLS_DTE                          08349100
121621                                ,STR_NBR                          08349200
121621                                ,RGST_ID                          08349300
121621                                ,TRN_NBR                          08349400
121621                                ,STRT_TM                          08349500
121621                                ,SLS_CORR_SEQ_NBR  )              08349600
121621         VALUES                                                   08349700
121621            (:PV-UPD-CCYY-MM-DD,                                  08349900
121621             :EPTRN-SLS-DTE,                                      08350000
121621             :EPTRN-STR-NBR,                                      08350100
121621             :EPTRN-RGST-ID,                                      08350200
121621             :EPTRN-TRN-NBR,                                      08350300
121621             :EPTRN-STRT-TM,                                      08350400
122721             :PV-UPDT-VALUE                                       08350600
121621            )                                                     08350700
121621     END-EXEC.                                                    08350800
121621                                                                  08350900
121621     EVALUATE TRUE                                                08351000
121621         WHEN SQLCODE = ZERO                                      08351100
121621             DISPLAY 'DKY ROW INSERTED FOR '                      08351200
121621             DISPLAY 'PRCG-DTE  = ' PV-UPD-CCYY-MM-DD             08351300
121621             DISPLAY 'SLS-DTE   = ' EPTRN-SLS-DTE                 08351400
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08351500
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08351600
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08351700
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08351800
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08351900
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08352000
121621         WHEN SQLCODE = -803                                      08352100
121621             DISPLAY 'DKY ROW ALREADY EXISTS FOR '                08352200
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08352300
121621             DISPLAY 'PRCG-DTE  = ' EPDKEY-PRCG-DTE               08352400
121621             DISPLAY 'SLS-DTE   = ' EPDKEY-SLS-DTE                08352500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08352600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08352700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08352800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08352900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08353000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08353100
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08353300
121621         WHEN SQLCODE NOT EQUAL ZERO                              08353400
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08353500
121621             DISPLAY 'PRCG-DTE  = ' EPDKEY-PRCG-DTE               08353600
121621             DISPLAY 'SLS-DTE   = ' EPDKEY-SLS-DTE                08353700
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08353800
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08353900
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08354000
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08354100
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08354200
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08354300
121621             MOVE '7000-INSERT-TEPDKEY-REC'                       08354400
121621                                            TO PV-PARAGRAPH-NAME  08354500
121621             MOVE 'ERROR ON INSERT OF TEPKEY '                    08354600
121621                                            TO PV-DB2-OPERATION   08354700
121621             PERFORM 9100-SQL-ABEND                               08354800
121621     END-EVALUATE.                                                08355000
121621                                                                  08356000
121621******************************************************************08356100
121621* 7001-UPDATE-TEPTRN-RECORD                                       08356200
121621*     UPDATE THE CURRENT TEPTRN ROW SO THAT THE PROCESSING DATE   08356300
121621*     AND TRANSACTION STATUS CODE ALIGN WITH A LATE TRANSACTION.  08356400
121621******************************************************************08356500
121621 7001-UPDATE-TEPTRN-RECORD.                                       08356600
121621                                                                  08357100
121621     IF EPTRN-SLS-CORR-SEQ-NBR > 0                                08357200
121621         MOVE EPTRN-SLS-CORR-SEQ-NBR TO PV-UPDT-VALUE             08357300
121621     ELSE                                                         08357400
121621         MOVE PC-LATE-VALUE          TO PV-UPDT-VALUE             08357500
121621     END-IF.                                                      08357600
122721     IF EPTRN-TRN-STAT-CDE = 'Z'                                  08357700
122721         MOVE 'L'                    TO PV-UPDT-STAT-CDE          08357800
122721     ELSE                                                         08357900
122721         MOVE EPTRN-TRN-STAT-CDE     TO PV-UPDT-STAT-CDE          08358000
122721     END-IF.                                                      08358100
121621                                                                  08358200
121621     EXEC SQL                                                     08358300
121621        UPDATE TEPTRN                                             08358400
121621           SET PRCG_DTE         = :PV-UPD-CCYY-MM-DD              08358500
122721              ,TRN_STAT_CDE     = :PV-UPDT-STAT-CDE               08358600
121621              ,SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08358700
121621           WHERE                                                  08358800
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08358900
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08359000
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08359100
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08359200
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08359300
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08359400
121621     END-EXEC.                                                    08359500
121621                                                                  08359700
121621     EVALUATE TRUE                                                08359800
121621         WHEN SQLCODE = ZERO                                      08359900
121621              PERFORM 7090-UPDATE-COSA-TABLES                     08360000
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08361000
121621             DISPLAY '7001-UPDATE-TEPTRN-REC'                     08361100
121621             DISPLAY 'TRANSACTION NOT FOUND '                     08362000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08362100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08362200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08362300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08362400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08362500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08362600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08362700
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08362800
121621         WHEN SQLCODE NOT EQUAL ZERO                              08362900
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08363000
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08363100
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08363200
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08363300
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08363400
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08363500
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08363600
121621             MOVE '7001-UPDATE-TEPTRN-REC'                        08363700
121621                                            TO PV-PARAGRAPH-NAME  08363800
121621             MOVE 'ERROR ON UPDATE OF TEPTRN '                    08363900
121621                                            TO PV-DB2-OPERATION   08364000
121621             PERFORM 9100-SQL-ABEND                               08364100
121621     END-EVALUATE.                                                08364200
121621                                                                  08364300
121621******************************************************************08364400
121621* 7002-UPDATE-TEPTND-RECORD                                       08364500
121621******************************************************************08364600
121621 7002-UPDATE-TEPTND-RECORD.                                       08364700
121621                                                                  08365200
121621     EXEC SQL                                                     08365300
121621        UPDATE TEPTND                                             08365400
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08365500
121621           WHERE                                                  08365600
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08365700
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08365800
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08365900
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08366000
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08366100
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08366200
121621     END-EXEC.                                                    08366300
121621                                                                  08366400
121621     EVALUATE TRUE                                                08366500
121621         WHEN SQLCODE = ZERO                                      08366600
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08366700
121621              CONTINUE                                            08366800
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08366900
121621         WHEN SQLCODE NOT EQUAL ZERO                              08367000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08367100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08367200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08367300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08367400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08367500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08367600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08367700
121621             MOVE '7002-UPDATE-TEPTND-REC'                        08367800
121621                                            TO PV-PARAGRAPH-NAME  08367900
121621             MOVE 'ERROR ON UPDATE OF TEPTND '                    08368000
121621                                            TO PV-DB2-OPERATION   08368100
121621             PERFORM 9100-SQL-ABEND                               08368200
121621     END-EVALUATE.                                                08368300
121621                                                                  08368400
121621******************************************************************08368500
121621* 7003-UPDATE-TEPCRD-RECORD                                       08368600
121621******************************************************************08368700
121621 7003-UPDATE-TEPCRD-RECORD.                                       08368800
121621                                                                  08369300
121621     EXEC SQL                                                     08369400
121621        UPDATE TEPCRD                                             08369500
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08369600
121621           WHERE                                                  08369700
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08369800
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08369900
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08370000
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08370100
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08370200
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08370300
121621     END-EXEC.                                                    08370400
121621                                                                  08370500
121621     EVALUATE TRUE                                                08370600
121621         WHEN SQLCODE = ZERO                                      08370700
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08370800
121621              CONTINUE                                            08370900
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08371000
121621         WHEN SQLCODE NOT EQUAL ZERO                              08371100
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08371200
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08371300
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08371400
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08371500
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08371600
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08371700
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08371800
121621             MOVE '7003-UPDATE-TEPCRD-REC'                        08371900
121621                                            TO PV-PARAGRAPH-NAME  08372000
121621             MOVE 'ERROR ON UPDATE OF TEPCRD '                    08372100
121621                                            TO PV-DB2-OPERATION   08372200
121621             PERFORM 9100-SQL-ABEND                               08372300
121621     END-EVALUATE.                                                08372400
121621                                                                  08372500
121621******************************************************************08372600
121621* 7004-UPDATE-TEPITM-RECORD                                       08372700
121621******************************************************************08372800
121621 7004-UPDATE-TEPITM-RECORD.                                       08372900
121621                                                                  08373400
121621     EXEC SQL                                                     08373500
121621        UPDATE TEPITM                                             08373600
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08373700
121621           WHERE                                                  08373800
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08373900
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08374000
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08374100
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08374200
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08374300
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08374400
121621     END-EXEC.                                                    08374500
121621                                                                  08374600
121621     EVALUATE TRUE                                                08374700
121621         WHEN SQLCODE = ZERO                                      08374800
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08374900
121621              CONTINUE                                            08375000
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08375100
121621         WHEN SQLCODE NOT EQUAL ZERO                              08375200
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08375300
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08375400
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08375500
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08375600
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08375700
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08375800
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08375900
121621             MOVE '7004-UPDATE-TEPITM-REC'                        08376000
121621                                            TO PV-PARAGRAPH-NAME  08376100
121621             MOVE 'ERROR ON UPDATE OF TEPITM '                    08376200
121621                                            TO PV-DB2-OPERATION   08376300
121621             PERFORM 9100-SQL-ABEND                               08376400
121621     END-EVALUATE.                                                08376500
121621                                                                  08376600
121621 7005-UPDATE-TEPIPS-RECORD.                                       08376700
121621                                                                  08377200
121621     EXEC SQL                                                     08377300
121621        UPDATE TEPIPS                                             08377400
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08377500
121621           WHERE                                                  08377600
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08377700
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08377800
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08377900
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08378000
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08378100
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08378200
121621     END-EXEC.                                                    08378300
121621                                                                  08378400
121621     EVALUATE TRUE                                                08378500
121621         WHEN SQLCODE = ZERO                                      08378600
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08378700
121621              CONTINUE                                            08378800
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08378900
121621         WHEN SQLCODE NOT EQUAL ZERO                              08379000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08379100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08379200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08379300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08379400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08379500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08379600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08379700
121621             MOVE 'UPDATE-TEPIPS-REC'                             08379800
121621                                            TO PV-PARAGRAPH-NAME  08379900
121621             MOVE 'ERROR ON UPDATE OF TEPIPS '                    08380000
121621                                            TO PV-DB2-OPERATION   08380100
121621             PERFORM 9100-SQL-ABEND                               08380200
121621     END-EVALUATE.                                                08380300
121621                                                                  08380400
121621 7006-UPDATE-TEPCRR-RECORD.                                       08380500
121621                                                                  08381000
121621     EXEC SQL                                                     08381100
121621        UPDATE TEPCRR                                             08381200
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08381300
121621           WHERE                                                  08381400
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08381500
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08381600
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08381700
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08381800
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08381900
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08382000
121621     END-EXEC.                                                    08382100
121621                                                                  08382200
121621     EVALUATE TRUE                                                08382300
121621         WHEN SQLCODE = ZERO                                      08382400
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08382500
121621              CONTINUE                                            08382600
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08382700
121621         WHEN SQLCODE NOT EQUAL ZERO                              08382800
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08382900
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08383000
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08383100
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08383200
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08383300
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08383400
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08383500
121621             MOVE 'UPDATE-TEPCRR-REC'                             08383600
121621                                            TO PV-PARAGRAPH-NAME  08383700
121621             MOVE 'ERROR ON UPDATE OF TEPCRR '                    08383800
121621                                            TO PV-DB2-OPERATION   08383900
121621             PERFORM 9100-SQL-ABEND                               08384000
121621     END-EVALUATE.                                                08384100
121621                                                                  08384200
121621 7007-UPDATE-TEPIGP-RECORD.                                       08384300
121621                                                                  08384800
121621     EXEC SQL                                                     08384900
121621        UPDATE TEPIGP                                             08385000
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08385100
121621           WHERE                                                  08385200
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08385300
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08385400
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08385500
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08385600
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08385700
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08385800
121621     END-EXEC.                                                    08385900
121621                                                                  08386000
121621     EVALUATE TRUE                                                08386100
121621         WHEN SQLCODE = ZERO                                      08386200
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08386300
121621              CONTINUE                                            08386400
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08386500
121621         WHEN SQLCODE NOT EQUAL ZERO                              08386600
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08386700
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08386800
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08386900
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08387000
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08387100
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08387200
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08387300
121621             MOVE 'UPDATE-TEPIGP-REC'                             08387400
121621                                            TO PV-PARAGRAPH-NAME  08387500
121621             MOVE 'ERROR ON UPDATE OF TEPIGP '                    08387600
121621                                            TO PV-DB2-OPERATION   08387700
121621             PERFORM 9100-SQL-ABEND                               08387800
121621     END-EVALUATE.                                                08387900
121621                                                                  08388000
121621 7008-UPDATE-TEPGFT-RECORD.                                       08388100
121621                                                                  08388600
121621     EXEC SQL                                                     08388700
121621        UPDATE TEPGFT                                             08388800
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08388900
121621           WHERE                                                  08389000
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08389100
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08389200
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08389300
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08389400
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08389500
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08389600
121621     END-EXEC.                                                    08389700
121621                                                                  08389800
121621     EVALUATE TRUE                                                08389900
121621         WHEN SQLCODE = ZERO                                      08390000
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08390100
121621              CONTINUE                                            08390200
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08390300
121621         WHEN SQLCODE NOT EQUAL ZERO                              08390400
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08390500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08390600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08390700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08390800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08390900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08391000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08391100
121621             MOVE 'UPDATE-TEPGFT-REC'                             08391200
121621                                            TO PV-PARAGRAPH-NAME  08391300
121621             MOVE 'ERROR ON UPDATE OF TEPGFT '                    08391400
121621                                            TO PV-DB2-OPERATION   08391500
121621             PERFORM 9100-SQL-ABEND                               08391600
121621     END-EVALUATE.                                                08391700
121621                                                                  08391800
121621 7009-UPDATE-TEPIRT-RECORD.                                       08391900
121621                                                                  08392400
121621     EXEC SQL                                                     08392500
121621        UPDATE TEPIRT                                             08392600
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08392700
121621           WHERE                                                  08392800
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08392900
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08393000
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08393100
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08393200
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08393300
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08393400
121621     END-EXEC.                                                    08393500
121621                                                                  08393600
121621     EVALUATE TRUE                                                08393700
121621         WHEN SQLCODE = ZERO                                      08393800
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08393900
121621              CONTINUE                                            08394000
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08394100
121621         WHEN SQLCODE NOT EQUAL ZERO                              08394200
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08394300
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08394400
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08394500
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08394600
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08394700
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08394800
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08394900
121621             MOVE 'UPDATE-TEPIRT-REC'                             08395000
121621                                            TO PV-PARAGRAPH-NAME  08395100
121621             MOVE 'ERROR ON UPDATE OF TEPIRT '                    08395200
121621                                            TO PV-DB2-OPERATION   08395300
121621             PERFORM 9100-SQL-ABEND                               08395400
121621     END-EVALUATE.                                                08395500
121621                                                                  08395600
121621 7010-UPDATE-TEPEID-RECORD.                                       08395700
121621                                                                  08396200
121621     EXEC SQL                                                     08396300
121621        UPDATE TEPEID                                             08396400
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08396500
121621           WHERE                                                  08396600
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08396700
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08396800
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08396900
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08397000
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08397100
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08397200
121621     END-EXEC.                                                    08397300
121621                                                                  08397400
121621     EVALUATE TRUE                                                08397500
121621         WHEN SQLCODE = ZERO                                      08397600
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08397700
121621              CONTINUE                                            08397800
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08397900
121621         WHEN SQLCODE NOT EQUAL ZERO                              08398000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08398100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08398200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08398300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08398400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08398500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08398600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08398700
121621             MOVE 'UPDATE-TEPEID-REC'                             08398800
121621                                            TO PV-PARAGRAPH-NAME  08398900
121621             MOVE 'ERROR ON UPDATE OF TEPEID '                    08399000
121621                                            TO PV-DB2-OPERATION   08399100
121621             PERFORM 9100-SQL-ABEND                               08399200
121621     END-EVALUATE.                                                08399300
121621                                                                  08399400
121621 7011-UPDATE-TEPGCA-RECORD.                                       08399500
121621                                                                  08400000
121621     EXEC SQL                                                     08400100
121621        UPDATE TEPGCA                                             08400200
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08400300
121621           WHERE                                                  08400400
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08400500
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08400600
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08400700
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08400800
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08400900
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08401000
121621     END-EXEC.                                                    08401100
121621                                                                  08401200
121621     EVALUATE TRUE                                                08401300
121621         WHEN SQLCODE = ZERO                                      08401400
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08401500
121621              CONTINUE                                            08401600
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08401700
121621         WHEN SQLCODE NOT EQUAL ZERO                              08401800
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08401900
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08402000
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08402100
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08402200
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08402300
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08402400
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08402500
121621             MOVE 'UPDATE-TEPGCA-REC'                             08402600
121621                                            TO PV-PARAGRAPH-NAME  08402700
121621             MOVE 'ERROR ON UPDATE OF TEPGCA '                    08402800
121621                                            TO PV-DB2-OPERATION   08402900
121621             PERFORM 9100-SQL-ABEND                               08403000
121621     END-EVALUATE.                                                08403100
121621                                                                  08403200
121621 7012-UPDATE-TEPLID-RECORD.                                       08403300
121621                                                                  08403800
121621     EXEC SQL                                                     08403900
121621        UPDATE TEPLID                                             08404000
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08404100
121621           WHERE                                                  08404200
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08404300
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08404400
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08404500
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08404600
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08404700
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08404800
121621     END-EXEC.                                                    08404900
121621                                                                  08405000
121621     EVALUATE TRUE                                                08405100
121621         WHEN SQLCODE = ZERO                                      08405200
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08405300
121621              CONTINUE                                            08405400
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08405500
121621         WHEN SQLCODE NOT EQUAL ZERO                              08405600
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08405700
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08405800
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08405900
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08406000
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08406100
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08406200
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08406300
121621             MOVE 'UPDATE-TEPLID-REC'                             08406400
121621                                            TO PV-PARAGRAPH-NAME  08406500
121621             MOVE 'ERROR ON UPDATE OF TEPLID '                    08406600
121621                                            TO PV-DB2-OPERATION   08406700
121621             PERFORM 9100-SQL-ABEND                               08406800
121621     END-EVALUATE.                                                08406900
121621                                                                  08407000
121621 7013-UPDATE-TEPTLD-RECORD.                                       08407100
121621                                                                  08407600
121621     EXEC SQL                                                     08407700
121621        UPDATE TEPTLD                                             08407800
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08407900
121621           WHERE                                                  08408000
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08408100
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08408200
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08408300
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08408400
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08408500
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08408600
121621     END-EXEC.                                                    08408700
121621                                                                  08408800
121621     EVALUATE TRUE                                                08408900
121621         WHEN SQLCODE = ZERO                                      08409000
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08409100
121621              CONTINUE                                            08409200
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08409300
121621         WHEN SQLCODE NOT EQUAL ZERO                              08409400
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08409500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08409600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08409700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08409800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08409900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08410000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08410100
121621             MOVE 'UPDATE-TEPTLD-REC'                             08410200
121621                                            TO PV-PARAGRAPH-NAME  08410300
121621             MOVE 'ERROR ON UPDATE OF TEPTLD '                    08410400
121621                                            TO PV-DB2-OPERATION   08410500
121621             PERFORM 9100-SQL-ABEND                               08410600
121621     END-EVALUATE.                                                08410700
121621                                                                  08410800
121621 7014-UPDATE-TEPLIS-RECORD.                                       08410900
121621                                                                  08411400
121621     EXEC SQL                                                     08411500
121621        UPDATE TEPLIS                                             08411600
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08411700
121621           WHERE                                                  08411800
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08411900
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08412000
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08412100
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08412200
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08412300
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08412400
121621     END-EXEC.                                                    08412500
121621                                                                  08412600
121621     EVALUATE TRUE                                                08412700
121621         WHEN SQLCODE = ZERO                                      08412800
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08412900
121621              CONTINUE                                            08413000
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08413100
121621         WHEN SQLCODE NOT EQUAL ZERO                              08413200
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08413300
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08413400
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08413500
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08413600
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08413700
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08413800
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08413900
121621             MOVE 'UPDATE-TEPLIS-REC'                             08414000
121621                                            TO PV-PARAGRAPH-NAME  08414100
121621             MOVE 'ERROR ON UPDATE OF TEPLIS '                    08414200
121621                                            TO PV-DB2-OPERATION   08414300
121621             PERFORM 9100-SQL-ABEND                               08414400
121621     END-EVALUATE.                                                08414500
121621                                                                  08414600
121621 7015-UPDATE-TEPCMD-RECORD.                                       08414700
121621                                                                  08415200
121621     EXEC SQL                                                     08415300
121621        UPDATE TEPCMD                                             08415400
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08415500
121621           WHERE                                                  08415600
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08415700
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08415800
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08415900
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08416000
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08416100
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08416200
121621     END-EXEC.                                                    08416300
121621                                                                  08416400
121621     EVALUATE TRUE                                                08416500
121621         WHEN SQLCODE = ZERO                                      08416600
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08416700
121621              CONTINUE                                            08416800
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08416900
121621         WHEN SQLCODE NOT EQUAL ZERO                              08417000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08417100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08417200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08417300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08417400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08417500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08417600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08417700
121621             MOVE 'UPDATE-TEPCMD-REC'                             08417800
121621                                            TO PV-PARAGRAPH-NAME  08417900
121621             MOVE 'ERROR ON UPDATE OF TEPCMD '                    08418000
121621                                            TO PV-DB2-OPERATION   08418100
121621             PERFORM 9100-SQL-ABEND                               08418200
121621     END-EVALUATE.                                                08418300
121621                                                                  08418400
121621 7016-UPDATE-TEPTAX-RECORD.                                       08418500
121621                                                                  08419000
121621     EXEC SQL                                                     08419100
121621        UPDATE TEPTAX                                             08419200
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08419300
121621           WHERE                                                  08419400
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08419500
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08419600
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08419700
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08419800
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08419900
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08420000
121621     END-EXEC.                                                    08420100
121621                                                                  08420200
121621     EVALUATE TRUE                                                08420300
121621         WHEN SQLCODE = ZERO                                      08420400
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08420500
121621              CONTINUE                                            08420600
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08420700
121621         WHEN SQLCODE NOT EQUAL ZERO                              08420800
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08420900
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08421000
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08421100
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08421200
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08421300
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08421400
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08421500
121621             MOVE 'UPDATE-TEPLID-REC'                             08421600
121621                                            TO PV-PARAGRAPH-NAME  08421700
121621             MOVE 'ERROR ON UPDATE OF TEPLID '                    08421800
121621                                            TO PV-DB2-OPERATION   08421900
121621             PERFORM 9100-SQL-ABEND                               08422000
121621     END-EVALUATE.                                                08422100
121621                                                                  08422200
121621 7017-UPDATE-TEPRTX-RECORD.                                       08422300
121621                                                                  08422800
121621     EXEC SQL                                                     08422900
121621        UPDATE TEPRTX                                             08423000
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08423100
121621           WHERE                                                  08423200
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08423300
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08423400
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08423500
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08423600
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08423700
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08423800
121621     END-EXEC.                                                    08423900
121621                                                                  08424000
121621     EVALUATE TRUE                                                08424100
121621         WHEN SQLCODE = ZERO                                      08424200
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08424300
121621              CONTINUE                                            08424400
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08424500
121621         WHEN SQLCODE NOT EQUAL ZERO                              08424600
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08424700
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08424800
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08424900
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08425000
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08425100
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08425200
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08425300
121621             MOVE 'UPDATE-TEPRTX-REC'                             08425400
121621                                            TO PV-PARAGRAPH-NAME  08425500
121621             MOVE 'ERROR ON UPDATE OF TEPRTX '                    08425600
121621                                            TO PV-DB2-OPERATION   08425700
121621             PERFORM 9100-SQL-ABEND                               08425800
121621     END-EVALUATE.                                                08425900
121621                                                                  08426000
121621 7018-UPDATE-TEPTRT-RECORD.                                       08426100
121621                                                                  08426600
121621     EXEC SQL                                                     08426700
121621        UPDATE TEPTRT                                             08426800
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08426900
121621           WHERE                                                  08427000
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08427100
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08427200
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08427300
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08427400
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08427500
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08427600
121621     END-EXEC.                                                    08427700
121621                                                                  08427800
121621     EVALUATE TRUE                                                08427900
121621         WHEN SQLCODE = ZERO                                      08428000
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08428100
121621              CONTINUE                                            08428200
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08428300
121621         WHEN SQLCODE NOT EQUAL ZERO                              08428400
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08428500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08428600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08428700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08428800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08428900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08429000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08429100
121621             MOVE 'UPDATE-TEPTRT-REC'                             08429200
121621                                            TO PV-PARAGRAPH-NAME  08429300
121621             MOVE 'ERROR ON UPDATE OF TEPTRT '                    08429400
121621                                            TO PV-DB2-OPERATION   08429500
121621             PERFORM 9100-SQL-ABEND                               08429600
121621     END-EVALUATE.                                                08429700
121621                                                                  08429800
121621 7019-UPDATE-TEPORD-RECORD.                                       08429900
121621                                                                  08430400
121621     EXEC SQL                                                     08430500
121621        UPDATE TEPORD                                             08430600
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08430700
121621           WHERE                                                  08430800
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08430900
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08431000
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08431100
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08431200
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08431300
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08431400
121621     END-EXEC.                                                    08431500
121621                                                                  08431600
121621     EVALUATE TRUE                                                08431700
121621         WHEN SQLCODE = ZERO                                      08431800
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08431900
121621              CONTINUE                                            08432000
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08432100
121621         WHEN SQLCODE NOT EQUAL ZERO                              08432200
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08432300
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08432400
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08432500
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08432600
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08432700
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08432800
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08432900
121621             MOVE 'UPDATE-TEPORD-REC'                             08433000
121621                                            TO PV-PARAGRAPH-NAME  08433100
121621             MOVE 'ERROR ON UPDATE OF TEPORD '                    08433200
121621                                            TO PV-DB2-OPERATION   08433300
121621             PERFORM 9100-SQL-ABEND                               08433400
121621     END-EVALUATE.                                                08433500
121621                                                                  08433600
121621 7020-UPDATE-TEPSVC-RECORD.                                       08433700
121621                                                                  08434200
121621     EXEC SQL                                                     08434300
121621        UPDATE TEPSVC                                             08434400
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08434500
121621           WHERE                                                  08434600
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08434700
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08434800
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08434900
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08435000
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08435100
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08435200
121621     END-EXEC.                                                    08435300
121621                                                                  08435400
121621     EVALUATE TRUE                                                08435500
121621         WHEN SQLCODE = ZERO                                      08435600
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08435700
121621              CONTINUE                                            08435800
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08435900
121621         WHEN SQLCODE NOT EQUAL ZERO                              08436000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08436100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08436200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08436300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08436400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08436500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08436600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08436700
121621             MOVE 'UPDATE-TEPSVC-REC'                             08436800
121621                                            TO PV-PARAGRAPH-NAME  08436900
121621             MOVE 'ERROR ON UPDATE OF TEPSVC '                    08437000
121621                                            TO PV-DB2-OPERATION   08437100
121621             PERFORM 9100-SQL-ABEND                               08437200
121621     END-EVALUATE.                                                08437300
121621                                                                  08437400
121621 7021-UPDATE-TEPATR-RECORD.                                       08437500
121621                                                                  08438000
121621     EXEC SQL                                                     08438100
121621        UPDATE TEPATR                                             08438200
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08438300
121621           WHERE                                                  08438400
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08438500
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08438600
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08438700
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08438800
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08438900
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08439000
121621     END-EXEC.                                                    08439100
121621                                                                  08439200
121621     EVALUATE TRUE                                                08439300
121621         WHEN SQLCODE = ZERO                                      08439400
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08439500
121621              CONTINUE                                            08439600
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08439700
121621         WHEN SQLCODE NOT EQUAL ZERO                              08439800
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08439900
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08440000
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08440100
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08440200
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08440300
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08440400
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08440500
121621             MOVE 'UPDATE-TEPATR-REC'                             08440600
121621                                            TO PV-PARAGRAPH-NAME  08440700
121621             MOVE 'ERROR ON UPDATE OF TEPATR '                    08440800
121621                                            TO PV-DB2-OPERATION   08440900
121621             PERFORM 9100-SQL-ABEND                               08441000
121621     END-EVALUATE.                                                08441100
121621                                                                  08441200
121621 7022-UPDATE-TEPSAT-RECORD.                                       08441300
121621                                                                  08441800
121621     EXEC SQL                                                     08441900
121621        UPDATE TEPSAT                                             08442000
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08442100
121621           WHERE                                                  08442200
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08442300
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08442400
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08442500
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08442600
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08442700
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08442800
121621     END-EXEC.                                                    08442900
121621                                                                  08443000
121621     EVALUATE TRUE                                                08443100
121621         WHEN SQLCODE = ZERO                                      08443200
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08443300
121621              CONTINUE                                            08443400
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08443500
121621         WHEN SQLCODE NOT EQUAL ZERO                              08443600
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08443700
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08443800
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08443900
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08444000
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08444100
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08444200
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08444300
121621             MOVE 'UPDATE-TEPSAT-REC'                             08444400
121621                                            TO PV-PARAGRAPH-NAME  08444500
121621             MOVE 'ERROR ON UPDATE OF TEPSAT '                    08444600
121621                                            TO PV-DB2-OPERATION   08444700
121621             PERFORM 9100-SQL-ABEND                               08444800
121621     END-EVALUATE.                                                08444900
121621                                                                  08445000
121621 7023-UPDATE-TEPPAY-RECORD.                                       08445100
121621                                                                  08445600
121621     EXEC SQL                                                     08445700
121621        UPDATE TEPPAY                                             08445800
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08445900
121621           WHERE                                                  08446000
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08446100
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08446200
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08446300
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08446400
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08446500
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08446600
121621     END-EXEC.                                                    08446700
121621                                                                  08446800
121621     EVALUATE TRUE                                                08446900
121621         WHEN SQLCODE = ZERO                                      08447000
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08447100
121621              CONTINUE                                            08447200
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08447300
121621         WHEN SQLCODE NOT EQUAL ZERO                              08447400
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08447500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08447600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08447700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08447800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08447900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08448000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08448100
121621             MOVE 'UPDATE-TEPPAY-REC'                             08448200
121621                                            TO PV-PARAGRAPH-NAME  08448300
121621             MOVE 'ERROR ON UPDATE OF TEPPAY '                    08448400
121621                                            TO PV-DB2-OPERATION   08448500
121621             PERFORM 9100-SQL-ABEND                               08448600
121621     END-EVALUATE.                                                08448700
121621                                                                  08448800
121621 7024-UPDATE-TEPRFN-RECORD.                                       08448900
121621                                                                  08449400
121621     EXEC SQL                                                     08449500
121621        UPDATE TEPRFN                                             08449600
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08449700
121621           WHERE                                                  08449800
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08449900
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08450000
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08450100
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08450200
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08450300
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08450400
121621     END-EXEC.                                                    08450500
121621                                                                  08450600
121621     EVALUATE TRUE                                                08450700
121621         WHEN SQLCODE = ZERO                                      08450800
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08450900
121621              CONTINUE                                            08451000
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08451100
121621         WHEN SQLCODE NOT EQUAL ZERO                              08451200
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08451300
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08451400
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08451500
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08451600
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08451700
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08451800
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08451900
121621             MOVE 'UPDATE-TEPRFN-REC'                             08452000
121621                                            TO PV-PARAGRAPH-NAME  08452100
121621             MOVE 'ERROR ON UPDATE OF TEPRFN '                    08452200
121621                                            TO PV-DB2-OPERATION   08452300
121621             PERFORM 9100-SQL-ABEND                               08452400
121621     END-EVALUATE.                                                08452500
121621                                                                  08452600
121621 7025-UPDATE-TEPRFA-RECORD.                                       08452700
121621                                                                  08453200
121621     EXEC SQL                                                     08453300
121621        UPDATE TEPRFA                                             08453400
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08453500
121621           WHERE                                                  08453600
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08453700
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08453800
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08453900
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08454000
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08454100
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08454200
121621     END-EXEC.                                                    08454300
121621                                                                  08454400
121621     EVALUATE TRUE                                                08454500
121621         WHEN SQLCODE = ZERO                                      08454600
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08454700
121621              CONTINUE                                            08454800
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08454900
121621         WHEN SQLCODE NOT EQUAL ZERO                              08455000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08455100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08455200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08455300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08455400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08455500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08455600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08455700
121621             MOVE 'UPDATE-TEPRFA-REC'                             08455800
121621                                            TO PV-PARAGRAPH-NAME  08455900
121621             MOVE 'ERROR ON UPDATE OF TEPRFA '                    08456000
121621                                            TO PV-DB2-OPERATION   08456100
121621             PERFORM 9100-SQL-ABEND                               08456200
121621     END-EVALUATE.                                                08456300
121621                                                                  08456400
121621 7026-UPDATE-TEPSHP-RECORD.                                       08456500
121621                                                                  08457000
121621     EXEC SQL                                                     08457100
121621        UPDATE TEPSHP                                             08457200
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08457300
121621           WHERE                                                  08457400
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08457500
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08457600
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08457700
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08457800
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08457900
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08458000
121621     END-EXEC.                                                    08458100
121621                                                                  08458200
121621     EVALUATE TRUE                                                08458300
121621         WHEN SQLCODE = ZERO                                      08458400
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08458500
121621              CONTINUE                                            08458600
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08458700
121621         WHEN SQLCODE NOT EQUAL ZERO                              08458800
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08458900
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08459000
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08459100
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08459200
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08459300
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08459400
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08459500
121621             MOVE 'UPDATE-TEPSHP-REC'                             08459600
121621                                            TO PV-PARAGRAPH-NAME  08459700
121621             MOVE 'ERROR ON UPDATE OF TEPSHP '                    08459800
121621                                            TO PV-DB2-OPERATION   08459900
121621             PERFORM 9100-SQL-ABEND                               08460000
121621     END-EVALUATE.                                                08460100
121621                                                                  08460200
121621 7027-UPDATE-TEPVDA-RECORD.                                       08460300
121621                                                                  08460800
121621     EXEC SQL                                                     08460900
121621        UPDATE TEPVDA                                             08461000
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08461100
121621           WHERE                                                  08461200
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08461300
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08461400
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08461500
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08461600
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08461700
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08461800
121621     END-EXEC.                                                    08461900
121621                                                                  08462000
121621     EVALUATE TRUE                                                08462100
121621         WHEN SQLCODE = ZERO                                      08462200
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08462300
121621              CONTINUE                                            08462400
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08462500
121621         WHEN SQLCODE NOT EQUAL ZERO                              08462600
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08462700
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08462800
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08462900
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08463000
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08463100
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08463200
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08463300
121621             MOVE 'UPDATE-TEPVDA-REC'                             08463400
121621                                            TO PV-PARAGRAPH-NAME  08463500
121621             MOVE 'ERROR ON UPDATE OF TEPVDA '                    08463600
121621                                            TO PV-DB2-OPERATION   08463700
121621             PERFORM 9100-SQL-ABEND                               08463800
121621     END-EVALUATE.                                                08463900
121621                                                                  08464000
121621 7028-UPDATE-TEPIRT-RECORD.                                       08464100
121621                                                                  08464600
121621     EXEC SQL                                                     08464700
121621        UPDATE TEPIRT                                             08464800
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08464900
121621           WHERE                                                  08465000
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08465100
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08465200
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08465300
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08465400
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08465500
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08465600
121621     END-EXEC.                                                    08465700
121621                                                                  08465800
121621     EVALUATE TRUE                                                08465900
121621         WHEN SQLCODE = ZERO                                      08466000
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08466100
121621              CONTINUE                                            08466200
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08466300
121621         WHEN SQLCODE NOT EQUAL ZERO                              08466400
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08466500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08466600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08466700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08466800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08466900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08467000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08467100
121621             MOVE 'UPDATE-TEPIRT-REC'                             08467200
121621                                            TO PV-PARAGRAPH-NAME  08467300
121621             MOVE 'ERROR ON UPDATE OF TEPIRT '                    08467400
121621                                            TO PV-DB2-OPERATION   08467500
121621             PERFORM 9100-SQL-ABEND                               08467600
121621     END-EVALUATE.                                                08467700
121621                                                                  08467800
121621 7029-UPDATE-TEPCHK-RECORD.                                       08467900
121621                                                                  08468400
121621     EXEC SQL                                                     08468500
121621        UPDATE TEPCHK                                             08468600
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08468700
121621           WHERE                                                  08468800
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08468900
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08469000
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08469100
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08469200
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08469300
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08469400
121621     END-EXEC.                                                    08469500
121621                                                                  08469600
121621     EVALUATE TRUE                                                08469700
121621         WHEN SQLCODE = ZERO                                      08469800
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08469900
121621              CONTINUE                                            08470000
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08470100
121621         WHEN SQLCODE NOT EQUAL ZERO                              08470200
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08470300
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08470400
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08470500
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08470600
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08470700
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08470800
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08470900
121621             MOVE 'UPDATE-TEPCHK-REC'                             08471000
121621                                            TO PV-PARAGRAPH-NAME  08471100
121621             MOVE 'ERROR ON UPDATE OF TEPCHK '                    08471200
121621                                            TO PV-DB2-OPERATION   08471300
121621             PERFORM 9100-SQL-ABEND                               08471400
121621     END-EVALUATE.                                                08471500
121621                                                                  08471600
121621 7030-UPDATE-TEPERR-RECORD.                                       08471700
121621                                                                  08472200
121621     EXEC SQL                                                     08472300
121621        UPDATE TEPERR                                             08472400
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08472500
121621           WHERE                                                  08472600
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08472700
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08472800
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08472900
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08473000
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08473100
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08473200
121621     END-EXEC.                                                    08473300
121621                                                                  08473400
121621     EVALUATE TRUE                                                08473500
121621         WHEN SQLCODE = ZERO                                      08473600
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08473700
121621              CONTINUE                                            08473800
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08473900
121621         WHEN SQLCODE NOT EQUAL ZERO                              08474000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08474100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08474200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08474300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08474400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08474500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08474600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08474700
121621             MOVE 'UPDATE-TEPERR-REC'                             08474800
121621                                            TO PV-PARAGRAPH-NAME  08474900
121621             MOVE 'ERROR ON UPDATE OF TEPERR '                    08475000
121621                                            TO PV-DB2-OPERATION   08475100
121621             PERFORM 9100-SQL-ABEND                               08475200
121621     END-EVALUATE.                                                08475300
121621                                                                  08475400
121621 7031-UPDATE-TEPECX-RECORD.                                       08475500
121621* NO NEED TO UPDATE TEPECX AS THE ORDER DATE ISN'T IMPACTED       08476000
121621     EXEC SQL                                                     08476100
121621        UPDATE TEPECX                                             08476200
121621           SET ORD_PARTN_NBR    = :EPTRN-PARTN-NBR                08476300
121621           WHERE                                                  08476400
121621               ORD_PARTN_NBR    = :EPTRN-PARTN-NBR                08476500
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08476600
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08476700
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08476800
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08476900
121621     END-EXEC.                                                    08477200
121621                                                                  08477300
121621     EVALUATE TRUE                                                08477400
121621         WHEN SQLCODE = ZERO                                      08477500
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08477600
121621              CONTINUE                                            08477700
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08477800
121621         WHEN SQLCODE NOT EQUAL ZERO                              08477900
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08478000
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08478100
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08478200
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08478300
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08478400
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08478500
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08478600
121621             MOVE 'UPDATE-TEPECX-REC'                             08478700
121621                                            TO PV-PARAGRAPH-NAME  08478800
121621             MOVE 'ERROR ON UPDATE OF TEPECX '                    08478900
121621                                            TO PV-DB2-OPERATION   08479000
121621             PERFORM 9100-SQL-ABEND                               08479100
121621     END-EVALUATE.                                                08479200
121621                                                                  08479300
121621 7032-UPDATE-TEPRKY-RECORD.                                       08479400
121621                                                                  08479900
121621     EXEC SQL                                                     08480000
121621        UPDATE TEPRKY                                             08480100
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08480200
121621           WHERE                                                  08480300
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08480400
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08480500
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08480600
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08480700
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08480800
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08480900
121621     END-EXEC.                                                    08481000
121621                                                                  08481100
121621     EVALUATE TRUE                                                08481200
121621         WHEN SQLCODE = ZERO                                      08481300
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08481400
121621              CONTINUE                                            08481500
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08481600
121621         WHEN SQLCODE NOT EQUAL ZERO                              08481700
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08481800
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08481900
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08482000
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08482100
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08482200
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08482300
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08482400
121621             MOVE 'UPDATE-TEPRKY-REC'                             08482500
121621                                            TO PV-PARAGRAPH-NAME  08482600
121621             MOVE 'ERROR ON UPDATE OF TEPRKY '                    08482700
121621                                            TO PV-DB2-OPERATION   08482800
121621             PERFORM 9100-SQL-ABEND                               08482900
121621     END-EVALUATE.                                                08483000
121621                                                                  08483100
121621 7033-UPDATE-TEPDKEY-RECORD.                                      08483200
121621                                                                  08483700
121621     EXEC SQL                                                     08483800
121621        UPDATE TEPDKEY                                            08483900
121621           SET PRCG_DTE         = :PV-UPD-CCYY-MM-DD              08484000
121621           WHERE                                                  08484100
121621               PRCG_DTE         = :PV-POS-CCYY-MM-DD              08484200
121621           AND SLS_DTE          = :EPTRN-SLS-DTE                  08484300
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08484400
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08484500
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08484600
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08484700
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08484800
121621     END-EXEC.                                                    08484900
121621                                                                  08485000
121621     EVALUATE TRUE                                                08485100
121621         WHEN SQLCODE = ZERO                                      08485200
121621             DISPLAY 'DKY ROW UPDATED FOR '                       08485300
121621             DISPLAY 'PRCG-DTE  = ' PV-UPD-CCYY-MM-DD             08485400
121621             DISPLAY 'SLS-DTE   = ' EPTRN-SLS-DTE                 08485500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08485600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08485700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08485800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08485900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08486000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08486100
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08486200
121621             DISPLAY 'DKY ROW NOW FOUND FOR '                     08486300
121621             DISPLAY 'PRCG-DTE  = ' PV-UPD-CCYY-MM-DD             08486400
121621             DISPLAY 'SLS-DTE   = ' EPTRN-SLS-DTE                 08486500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08486600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08486700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08486800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08486900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08487000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08487100
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08487200
121621         WHEN SQLCODE NOT EQUAL ZERO                              08487300
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08487400
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08487500
121621             DISPLAY 'POS-DATE  = ' PV-POS-CCYY-MM-DD             08487600
121621             DISPLAY 'SLS-DATE  = ' EPTRN-SLS-DTE                 08487700
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08487800
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08487900
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08488000
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08488100
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08488200
121621             DISPLAY 'UPD-DATE  = ' PV-UPD-CCYY-MM-DD             08488300
121621             MOVE 'UPDATE-TEPDKEY-REC'                            08488400
121621                                            TO PV-PARAGRAPH-NAME  08488500
121621             MOVE 'ERROR ON UPDATE OF TEPDKEY'                    08488600
121621                                            TO PV-DB2-OPERATION   08488700
121621             PERFORM 9100-SQL-ABEND                               08488800
121621     END-EVALUATE.                                                08488900
121621                                                                  08489000
121621 7034-UPDATE-3RDPTY-RECORD.                                       08489100
121621                                                                  08489600
121621     EXEC SQL                                                     08489700
121621        UPDATE EPT_3RDPTY_GFTCRD                                  08489800
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08489900
121621           WHERE                                                  08490000
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08490100
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08490200
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08490300
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08490400
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08490500
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08490600
121621     END-EXEC.                                                    08490700
121621                                                                  08490800
121621     EVALUATE TRUE                                                08490900
121621         WHEN SQLCODE = ZERO                                      08491000
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08491100
121621              CONTINUE                                            08491200
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08491300
121621         WHEN SQLCODE NOT EQUAL ZERO                              08491400
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08491500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08491600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08491700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08491800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08491900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08492000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08492100
121621             MOVE 'UPDATE-3RDPTY-REC'                             08492200
121621                                            TO PV-PARAGRAPH-NAME  08492300
121621             MOVE 'ERROR ON UPDATE OF 3RDPTY '                    08492400
121621                                            TO PV-DB2-OPERATION   08492500
121621             PERFORM 9100-SQL-ABEND                               08492600
121621     END-EVALUATE.                                                08492700
121621                                                                  08492800
121621 7035-UPDATE-ASSOCA-RECORD.                                       08492900
121621                                                                  08493400
121621     EXEC SQL                                                     08493500
121621        UPDATE EPT_ASSOC_AUTHCN                                   08493600
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08493700
121621           WHERE                                                  08493800
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08493900
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08494000
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08494100
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08494200
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08494300
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08494400
121621     END-EXEC.                                                    08494500
121621                                                                  08494600
121621     EVALUATE TRUE                                                08494700
121621         WHEN SQLCODE = ZERO                                      08494800
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08494900
121621              CONTINUE                                            08495000
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08495100
121621         WHEN SQLCODE NOT EQUAL ZERO                              08495200
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08495300
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08495400
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08495500
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08495600
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08495700
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08495800
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08495900
121621             MOVE 'UPDATE-ASSOC-AUTH '                            08496000
121621                                            TO PV-PARAGRAPH-NAME  08496100
121621             MOVE 'ERROR ON UPDATE OF ASSOC-A'                    08496200
121621                                            TO PV-DB2-OPERATION   08496300
121621             PERFORM 9100-SQL-ABEND                               08496400
121621     END-EVALUATE.                                                08496500
121621                                                                  08496600
121621 7036-UPDATE-CRDVRFN-RECORD.                                      08496700
121621                                                                  08497200
121621     EXEC SQL                                                     08497300
121621        UPDATE EPT_CR_CRD_VRFN                                    08497400
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08497500
121621           WHERE                                                  08497600
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08497700
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08497800
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08497900
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08498000
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08498100
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08498200
121621     END-EXEC.                                                    08498300
121621                                                                  08498400
121621     EVALUATE TRUE                                                08498500
121621         WHEN SQLCODE = ZERO                                      08498600
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08498700
121621              CONTINUE                                            08498800
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08498900
121621         WHEN SQLCODE NOT EQUAL ZERO                              08499000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08499100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08499200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08499300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08499400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08499500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08499600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08499700
121621             MOVE 'UPDATE-CRD-VRFN   '                            08499800
121621                                            TO PV-PARAGRAPH-NAME  08499900
121621             MOVE 'ERROR ON UPDATE OF CRDVRFN'                    08500000
121621                                            TO PV-DB2-OPERATION   08500100
121621             PERFORM 9100-SQL-ABEND                               08500200
121621     END-EVALUATE.                                                08500300
121621                                                                  08500400
121621 7037-UPDATE-CR-MKTG-RECORD.                                      08500500
121621                                                                  08501000
121621     EXEC SQL                                                     08501100
121621        UPDATE EPT_CR_MKTG_LID                                    08501200
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08501300
121621           WHERE                                                  08501400
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08501500
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08501600
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08501700
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08501800
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08501900
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08502000
121621     END-EXEC.                                                    08502100
121621                                                                  08502200
121621     EVALUATE TRUE                                                08502300
121621         WHEN SQLCODE = ZERO                                      08502400
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08502500
121621              CONTINUE                                            08502600
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08502700
121621         WHEN SQLCODE NOT EQUAL ZERO                              08502800
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08502900
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08503000
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08503100
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08503200
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08503300
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08503400
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08503500
121621             MOVE 'UPDATE-CR-MKTG    '                            08503600
121621                                            TO PV-PARAGRAPH-NAME  08503700
121621             MOVE 'ERROR ON UPDATE OF CR-MKTG'                    08503800
121621                                            TO PV-DB2-OPERATION   08503900
121621             PERFORM 9100-SQL-ABEND                               08504000
121621     END-EVALUATE.                                                08504100
121621                                                                  08504200
121621 7038-UPDATE-CUST-PO-RECORD.                                      08504300
121621                                                                  08504800
121621     EXEC SQL                                                     08504900
121621        UPDATE EPT_CUST_PO_TNDR                                   08505000
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08505100
121621           WHERE                                                  08505200
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08505300
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08505400
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08505500
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08505600
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08505700
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08505800
121621     END-EXEC.                                                    08505900
121621                                                                  08506000
121621     EVALUATE TRUE                                                08506100
121621         WHEN SQLCODE = ZERO                                      08506200
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08506300
121621              CONTINUE                                            08506400
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08506500
121621         WHEN SQLCODE NOT EQUAL ZERO                              08506600
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08506700
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08506800
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08506900
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08507000
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08507100
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08507200
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08507300
121621             MOVE 'UPDATE-CUST-PO    '                            08507400
121621                                            TO PV-PARAGRAPH-NAME  08507500
121621             MOVE 'ERROR ON UPDATE OF CUST-PO'                    08507600
121621                                            TO PV-DB2-OPERATION   08507700
121621             PERFORM 9100-SQL-ABEND                               08507800
121621     END-EVALUATE.                                                08507900
121621                                                                  08508000
121621 7039-UPDATE-DR-CRDT-RECORD.                                      08508100
121621                                                                  08508600
121621     EXEC SQL                                                     08508700
121621        UPDATE EPT_DR_CRD_TNDR                                    08508800
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08508900
121621           WHERE                                                  08509000
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08509100
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08509200
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08509300
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08509400
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08509500
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08509600
121621     END-EXEC.                                                    08509700
121621                                                                  08509800
121621     EVALUATE TRUE                                                08509900
121621         WHEN SQLCODE = ZERO                                      08510000
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08510100
121621              CONTINUE                                            08510200
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08510300
121621         WHEN SQLCODE NOT EQUAL ZERO                              08510400
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08510500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08510600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08510700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08510800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08510900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08511000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08511100
121621             MOVE 'UPDATE-DR-CRDT    '                            08511200
121621                                            TO PV-PARAGRAPH-NAME  08511300
121621             MOVE 'ERROR ON UPDATE OF DR-CRDT'                    08511400
121621                                            TO PV-DB2-OPERATION   08511500
121621             PERFORM 9100-SQL-ABEND                               08511600
121621     END-EVALUATE.                                                08511700
121621                                                                  08511800
121621 7040-UPDATE-CR-FUNC-RECORD.                                      08511900
121621                                                                  08512400
121621     EXEC SQL                                                     08512500
121621        UPDATE EPT_CR_FUNC                                        08512600
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08512700
121621           WHERE                                                  08512800
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08512900
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08513000
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08513100
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08513200
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08513300
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08513400
121621     END-EXEC.                                                    08513500
121621                                                                  08513600
121621     EVALUATE TRUE                                                08513700
121621         WHEN SQLCODE = ZERO                                      08513800
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08513900
121621              CONTINUE                                            08514000
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08514100
121621         WHEN SQLCODE NOT EQUAL ZERO                              08514200
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08514300
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08514400
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08514500
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08514600
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08514700
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08514800
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08514900
121621             MOVE 'UPDATE-CR-FUNC    '                            08515000
121621                                            TO PV-PARAGRAPH-NAME  08515100
121621             MOVE 'ERROR ON UPDATE OF CR-FUNC'                    08515200
121621                                            TO PV-DB2-OPERATION   08515300
121621             PERFORM 9100-SQL-ABEND                               08515400
121621     END-EVALUATE.                                                08515500
121621                                                                  08515600
121621 7041-UPDATE-EMV-CRD-RECORD.                                      08515700
121621                                                                  08516200
121621     EXEC SQL                                                     08516300
121621        UPDATE EPT_EMV_CRD_TNDR                                   08516400
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08516500
121621           WHERE                                                  08516600
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08516700
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08516800
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08516900
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08517000
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08517100
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08517200
121621     END-EXEC.                                                    08517300
121621                                                                  08517400
121621     EVALUATE TRUE                                                08517500
121621         WHEN SQLCODE = ZERO                                      08517600
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08517700
121621              CONTINUE                                            08517800
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08517900
121621         WHEN SQLCODE NOT EQUAL ZERO                              08518000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08518100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08518200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08518300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08518400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08518500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08518600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08518700
121621             MOVE 'UPDATE-EMV-CRD    '                            08518800
121621                                            TO PV-PARAGRAPH-NAME  08518900
121621             MOVE 'ERROR ON UPDATE OF EMV-CRD'                    08519000
121621                                            TO PV-DB2-OPERATION   08519100
121621             PERFORM 9100-SQL-ABEND                               08519200
121621     END-EVALUATE.                                                08519300
121621                                                                  08519400
121621 7042-UPDATE-GFT-RCP-RECORD.                                      08519500
121621                                                                  08520000
121621     EXEC SQL                                                     08520100
121621        UPDATE EPT_GFT_RCPT_KY                                    08520200
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08520300
121621           WHERE                                                  08520400
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08520500
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08520600
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08520700
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08520800
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08520900
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08521000
121621     END-EXEC.                                                    08521100
121621                                                                  08521200
121621     EVALUATE TRUE                                                08521300
121621         WHEN SQLCODE = ZERO                                      08521400
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08521500
121621              CONTINUE                                            08521600
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08521700
121621         WHEN SQLCODE NOT EQUAL ZERO                              08521800
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08521900
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08522000
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08522100
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08522200
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08522300
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08522400
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08522500
121621             MOVE 'UPDATE-GFT-KEY    '                            08522600
121621                                            TO PV-PARAGRAPH-NAME  08522700
121621             MOVE 'ERROR ON UPDATE OF GFT-KEY'                    08522800
121621                                            TO PV-DB2-OPERATION   08522900
121621             PERFORM 9100-SQL-ABEND                               08523000
121621     END-EVALUATE.                                                08523100
121621                                                                  08523200
121621 7043-UPDATE-GFT-TRN-RECORD.                                      08523300
121621                                                                  08523800
121621     EXEC SQL                                                     08523900
121621        UPDATE EPT_GFT_RCPT_TRN                                   08524000
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08524100
121621           WHERE                                                  08524200
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08524300
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08524400
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08524500
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08524600
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08524700
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08524800
121621     END-EXEC.                                                    08524900
121621                                                                  08525000
121621     EVALUATE TRUE                                                08525100
121621         WHEN SQLCODE = ZERO                                      08525200
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08525300
121621              CONTINUE                                            08525400
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08525500
121621         WHEN SQLCODE NOT EQUAL ZERO                              08525600
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08525700
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08525800
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08525900
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08526000
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08526100
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08526200
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08526300
121621             MOVE 'UPDATE-GFT-TRN    '                            08526400
121621                                            TO PV-PARAGRAPH-NAME  08526500
121621             MOVE 'ERROR ON UPDATE OF GFT-TRN'                    08526600
121621                                            TO PV-DB2-OPERATION   08526700
121621             PERFORM 9100-SQL-ABEND                               08526800
121621     END-EVALUATE.                                                08526900
121621                                                                  08527000
121621 7044-UPDATE-ITM-CBK-RECORD.                                      08527100
121621                                                                  08527600
121621     EXEC SQL                                                     08527700
121621        UPDATE EPT_ITM_CLBK                                       08527800
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08527900
121621           WHERE                                                  08528000
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08528100
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08528200
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08528300
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08528400
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08528500
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08528600
121621     END-EXEC.                                                    08528700
121621                                                                  08528800
121621     EVALUATE TRUE                                                08528900
121621         WHEN SQLCODE = ZERO                                      08529000
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08529100
121621              CONTINUE                                            08529200
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08529300
121621         WHEN SQLCODE NOT EQUAL ZERO                              08529400
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08529500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08529600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08529700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08529800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08529900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08530000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08530100
121621             MOVE 'UPDATE-ITM-CLBK   '                            08530200
121621                                            TO PV-PARAGRAPH-NAME  08530300
121621             MOVE 'ERROR ON UPDATE OF ITMCLBK'                    08530400
121621                                            TO PV-DB2-OPERATION   08530500
121621             PERFORM 9100-SQL-ABEND                               08530600
121621     END-EVALUATE.                                                08530700
121621                                                                  08530800
121621 7045-UPDATE-POST-SL-RECORD.                                      08530900
121621                                                                  08531400
121621     EXEC SQL                                                     08531500
121621        UPDATE EPT_POST_SLS_TRN                                   08531600
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08531700
121621           WHERE                                                  08531800
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08531900
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08532000
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08532100
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08532200
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08532300
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08532400
121621     END-EXEC.                                                    08532500
121621                                                                  08532600
121621     EVALUATE TRUE                                                08532700
121621         WHEN SQLCODE = ZERO                                      08532800
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08532900
121621              CONTINUE                                            08533000
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08533100
121621         WHEN SQLCODE NOT EQUAL ZERO                              08533200
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08533300
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08533400
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08533500
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08533600
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08533700
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08533800
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08533900
121621             MOVE 'UPDATE-POST-SL    '                            08534000
121621                                            TO PV-PARAGRAPH-NAME  08534100
121621             MOVE 'ERROR ON UPDATE OF POST-SL'                    08534200
121621                                            TO PV-DB2-OPERATION   08534300
121621             PERFORM 9100-SQL-ABEND                               08534400
121621     END-EVALUATE.                                                08534500
121621                                                                  08534600
121621 7046-UPDATE-RCPT-RP-RECORD.                                      08534700
121621                                                                  08535200
121621     EXEC SQL                                                     08535300
121621        UPDATE EPT_RCPT_RPRT                                      08535400
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08535500
121621           WHERE                                                  08535600
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08535700
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08535800
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08535900
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08536000
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08536100
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08536200
121621     END-EXEC.                                                    08536300
121621                                                                  08536400
121621     EVALUATE TRUE                                                08536500
121621         WHEN SQLCODE = ZERO                                      08536600
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08536700
121621              CONTINUE                                            08536800
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08536900
121621         WHEN SQLCODE NOT EQUAL ZERO                              08537000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08537100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08537200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08537300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08537400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08537500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08537600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08537700
121621             MOVE 'UPDATE-RCPTRPRT   '                            08537800
121621                                            TO PV-PARAGRAPH-NAME  08537900
121621             MOVE 'ERROR ON UPDATE OF RCPTRPR'                    08538000
121621                                            TO PV-DB2-OPERATION   08538100
121621             PERFORM 9100-SQL-ABEND                               08538200
121621     END-EVALUATE.                                                08538300
121621                                                                  08538400
121621 7047-UPDATE-REBATED-RECORD.                                      08538500
121621                                                                  08539000
121621     EXEC SQL                                                     08539100
121621        UPDATE EPT_REBT                                           08539200
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08539300
121621           WHERE                                                  08539400
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08539500
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08539600
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08539700
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08539800
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08539900
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08540000
121621     END-EXEC.                                                    08540100
121621                                                                  08540200
121621     EVALUATE TRUE                                                08540300
121621         WHEN SQLCODE = ZERO                                      08540400
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08540500
121621              CONTINUE                                            08540600
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08540700
121621         WHEN SQLCODE NOT EQUAL ZERO                              08540800
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08540900
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08541000
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08541100
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08541200
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08541300
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08541400
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08541500
121621             MOVE 'UPDATE-REBATE     '                            08541600
121621                                            TO PV-PARAGRAPH-NAME  08541700
121621             MOVE 'ERROR ON UPDATE OF REBATE '                    08541800
121621                                            TO PV-DB2-OPERATION   08541900
121621             PERFORM 9100-SQL-ABEND                               08542000
121621     END-EVALUATE.                                                08542100
121621                                                                  08542200
121621 7048-UPDATE-RET-TND-RECORD.                                      08542300
121621                                                                  08542800
121621     EXEC SQL                                                     08542900
121621        UPDATE EPT_RET_TRN_TNDR                                   08543000
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08543100
121621           WHERE                                                  08543200
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08543300
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08543400
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08543500
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08543600
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08543700
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08543800
121621     END-EXEC.                                                    08543900
121621                                                                  08544000
121621     EVALUATE TRUE                                                08544100
121621         WHEN SQLCODE = ZERO                                      08544200
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08544300
121621              CONTINUE                                            08544400
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08544500
121621         WHEN SQLCODE NOT EQUAL ZERO                              08544600
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08544700
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08544800
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08544900
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08545000
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08545100
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08545200
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08545300
121621             MOVE 'UPDATE-RET-TNDR   '                            08545400
121621                                            TO PV-PARAGRAPH-NAME  08545500
121621             MOVE 'ERROR ON UPDATE OF RETTNDR'                    08545600
121621                                            TO PV-DB2-OPERATION   08545700
121621             PERFORM 9100-SQL-ABEND                               08545800
121621     END-EVALUATE.                                                08545900
121621                                                                  08546000
121621 7049-UPDATE-RWD-AUT-RECORD.                                      08546100
121621                                                                  08546600
121621     EXEC SQL                                                     08546700
121621        UPDATE EPT_RWD_AUTH                                       08546800
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08546900
121621           WHERE                                                  08547000
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08547100
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08547200
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08547300
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08547400
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08547500
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08547600
121621     END-EXEC.                                                    08547700
121621                                                                  08547800
121621     EVALUATE TRUE                                                08547900
121621         WHEN SQLCODE = ZERO                                      08548000
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08548100
121621              CONTINUE                                            08548200
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08548300
121621         WHEN SQLCODE NOT EQUAL ZERO                              08548400
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08548500
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08548600
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08548700
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08548800
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08548900
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08549000
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08549100
121621             MOVE 'UPDATE-RWD-AUTH   '                            08549200
121621                                            TO PV-PARAGRAPH-NAME  08549300
121621             MOVE 'ERROR ON UPDATE OF RWDAUTH'                    08549400
121621                                            TO PV-DB2-OPERATION   08549500
121621             PERFORM 9100-SQL-ABEND                               08549600
121621     END-EVALUATE.                                                08549700
121621                                                                  08549800
121621 7050-UPDATE-SSPNDRS-RECORD.                                      08549900
121621                                                                  08550400
121621     EXEC SQL                                                     08550500
121621        UPDATE EPT_SSPND_RSM_TRN                                  08550600
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08550700
121621           WHERE                                                  08550800
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08550900
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08551000
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08551100
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08551200
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08551300
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08551400
121621     END-EXEC.                                                    08551500
121621                                                                  08551600
121621     EVALUATE TRUE                                                08551700
121621         WHEN SQLCODE = ZERO                                      08551800
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08551900
121621              CONTINUE                                            08552000
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08552100
121621         WHEN SQLCODE NOT EQUAL ZERO                              08552200
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08552300
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08552400
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08552500
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08552600
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08552700
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08552800
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08552900
121621             MOVE 'UPDATE-SSPNDRSM   '                            08553000
121621                                            TO PV-PARAGRAPH-NAME  08553100
121621             MOVE 'ERROR ON UPDATE OF SSPNDRS'                    08553200
121621                                            TO PV-DB2-OPERATION   08553300
121621             PERFORM 9100-SQL-ABEND                               08553400
121621     END-EVALUATE.                                                08553500
121621                                                                  08553600
121621 7051-UPDATE-TNDR-SG-RECORD.                                      08553700
121621                                                                  08554200
121621     EXEC SQL                                                     08554300
121621        UPDATE EPT_TNDR_SIG                                       08554400
121621           SET SLS_CORR_SEQ_NBR = :PV-UPDT-VALUE                  08554500
121621           WHERE                                                  08554600
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08554700
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08554800
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08554900
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08555000
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08555100
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08555200
121621     END-EXEC.                                                    08555300
121621                                                                  08555400
121621     EVALUATE TRUE                                                08555500
121621         WHEN SQLCODE = ZERO                                      08555600
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08555700
121621              CONTINUE                                            08555800
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08555900
121621         WHEN SQLCODE NOT EQUAL ZERO                              08556000
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08556100
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08556200
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08556300
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08556400
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08556500
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08556600
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08556700
121621             MOVE 'UPDATE-TNDR-SIG   '                            08556800
121621                                            TO PV-PARAGRAPH-NAME  08556900
121621             MOVE 'ERROR ON UPDATE OF TNDR-SG'                    08557000
121621                                            TO PV-DB2-OPERATION   08557100
121621             PERFORM 9100-SQL-ABEND                               08557200
121621     END-EVALUATE.                                                08557300
121621                                                                  08557400
121621 7052-UPDATE-TEPTRN-RECORD.                                       08557500
121621                                                                  08558000
121621     EXEC SQL                                                     08558100
121621        UPDATE TEPTRN                                             08558200
121621           SET PRCG_DTE         = :PV-UPD-CCYY-MM-DD              08558300
121621           WHERE                                                  08558400
121621               PARTN_NBR        = :EPTRN-PARTN-NBR                08558500
121621           AND STR_NBR          = :EPTRN-STR-NBR                  08558600
121621           AND RGST_ID          = :EPTRN-RGST-ID                  08558700
121621           AND TRN_NBR          = :EPTRN-TRN-NBR                  08558800
121621           AND STRT_TM          = :EPTRN-STRT-TM                  08558900
121621           AND SLS_CORR_SEQ_NBR = :EPTRN-SLS-CORR-SEQ-NBR         08559000
121621     END-EXEC.                                                    08559100
121621                                                                  08559200
121621     EVALUATE TRUE                                                08559300
121621         WHEN SQLCODE = ZERO                                      08559400
121621              CONTINUE                                            08559500
121621         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08559600
121621             DISPLAY '7052-UPDATE-TEPTRN-REC'                     08559700
121621             DISPLAY 'TRANSACTION NOT FOUND '                     08559800
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08559900
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08560000
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08560100
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08560200
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08560300
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08560400
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08560500
121621         WHEN SQLWARN0 NOT EQUAL SPACE                            08560600
121621         WHEN SQLCODE NOT EQUAL ZERO                              08560700
121621             DISPLAY 'SQLCODE   = ' SQLCODE                       08560800
121621             DISPLAY 'PARTN-NBR = ' EPTRN-PARTN-NBR               08560900
121621             DISPLAY 'STR-NBR   = ' EPTRN-STR-NBR                 08561000
121621             DISPLAY 'RGST-ID   = ' EPTRN-RGST-ID                 08561100
121621             DISPLAY 'TRN-NBR   = ' EPTRN-TRN-NBR                 08561200
121621             DISPLAY 'STRT-TM   = ' EPTRN-STRT-TM                 08561300
121621             DISPLAY 'SLS-CORR-SEQ-NBR = ' EPTRN-SLS-CORR-SEQ-NBR 08561400
121621             MOVE '7052-UPDATE-TEPTRN-REC'                        08561500
121621                                            TO PV-PARAGRAPH-NAME  08561600
121621             MOVE 'ERROR ON UPDATE OF TEPTRN '                    08561700
121621                                            TO PV-DB2-OPERATION   08561800
121621             PERFORM 9100-SQL-ABEND                               08561900
121621     END-EVALUATE.                                                08562000
121621                                                                  08562100
121621******************************************************************08562200
121621* 9100-SQL-ABEND                                                  08562300
121621*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.08562400
121621******************************************************************08562500
121621 7090-UPDATE-COSA-TABLES.                                         08562600
121621* COULD ALSO POPULATE AND UPDATE FROM -1 TO 0 IF CHOOSE TO        08563100
121621     IF EPTRN-SLS-CORR-SEQ-NBR = 0                                08563200
               PERFORM 7001-UPDATE-TEPTRN-RECORD                        08563300
               PERFORM 7002-UPDATE-TEPTND-RECORD                        08563400
               PERFORM 7003-UPDATE-TEPCRD-RECORD                        08563500
               PERFORM 7004-UPDATE-TEPITM-RECORD                        08563600
               PERFORM 7005-UPDATE-TEPIPS-RECORD                        08563700
               PERFORM 7006-UPDATE-TEPCRR-RECORD                        08563800
               PERFORM 7007-UPDATE-TEPIGP-RECORD                        08563900
               PERFORM 7008-UPDATE-TEPGFT-RECORD                        08564000
               PERFORM 7009-UPDATE-TEPIRT-RECORD                        08564100
               PERFORM 7010-UPDATE-TEPEID-RECORD                        08564200
               PERFORM 7011-UPDATE-TEPGCA-RECORD                        08564300
               PERFORM 7012-UPDATE-TEPLID-RECORD                        08564400
               PERFORM 7013-UPDATE-TEPTLD-RECORD                        08564500
               PERFORM 7014-UPDATE-TEPLIS-RECORD                        08564600
               PERFORM 7015-UPDATE-TEPCMD-RECORD                        08564700
               PERFORM 7016-UPDATE-TEPTAX-RECORD                        08564800
               PERFORM 7017-UPDATE-TEPRTX-RECORD                        08564900
               PERFORM 7018-UPDATE-TEPTRT-RECORD                        08565000
               PERFORM 7019-UPDATE-TEPORD-RECORD                        08565100
               PERFORM 7020-UPDATE-TEPSVC-RECORD                        08565200
               PERFORM 7021-UPDATE-TEPATR-RECORD                        08565300
               PERFORM 7022-UPDATE-TEPSAT-RECORD                        08565400
               PERFORM 7023-UPDATE-TEPPAY-RECORD                        08565500
               PERFORM 7024-UPDATE-TEPRFN-RECORD                        08565600
               PERFORM 7025-UPDATE-TEPRFA-RECORD                        08565700
               PERFORM 7026-UPDATE-TEPSHP-RECORD                        08565800
               PERFORM 7027-UPDATE-TEPVDA-RECORD                        08565900
               PERFORM 7028-UPDATE-TEPIRT-RECORD                        08566000
               PERFORM 7029-UPDATE-TEPCHK-RECORD                        08566100
               PERFORM 7030-UPDATE-TEPERR-RECORD                        08566200
121621*   TEPECX DOESN'T REQUIRE ANY UPDATE FOR THIS PROCESS            08566400
121621*        PERFORM 7031-UPDATE-TEPECX-RECORD                        08566500
               PERFORM 7032-UPDATE-TEPRKY-RECORD                        08566700
               PERFORM 7033-UPDATE-TEPDKEY-RECORD                       08567100
               PERFORM 7034-UPDATE-3RDPTY-RECORD                        08567200
               PERFORM 7035-UPDATE-ASSOCA-RECORD                        08567300
               PERFORM 7036-UPDATE-CRDVRFN-RECORD                       08567400
               PERFORM 7037-UPDATE-CR-MKTG-RECORD                       08567500
               PERFORM 7038-UPDATE-CUST-PO-RECORD                       08567600
               PERFORM 7039-UPDATE-DR-CRDT-RECORD                       08567700
               PERFORM 7040-UPDATE-CR-FUNC-RECORD                       08567800
               PERFORM 7041-UPDATE-EMV-CRD-RECORD                       08567900
               PERFORM 7042-UPDATE-GFT-RCP-RECORD                       08568000
               PERFORM 7043-UPDATE-GFT-TRN-RECORD                       08568100
               PERFORM 7044-UPDATE-ITM-CBK-RECORD                       08568200
               PERFORM 7045-UPDATE-POST-SL-RECORD                       08568300
               PERFORM 7046-UPDATE-RCPT-RP-RECORD                       08568400
               PERFORM 7047-UPDATE-REBATED-RECORD                       08568500
               PERFORM 7048-UPDATE-RET-TND-RECORD                       08568600
               PERFORM 7049-UPDATE-RWD-AUT-RECORD                       08568700
               PERFORM 7050-UPDATE-SSPNDRS-RECORD                       08568800
               PERFORM 7051-UPDATE-TNDR-SG-RECORD                       08568900
           END-IF.                                                      08569000
                                                                        08569100
      ***************************************************************** 08569200
      * COMMIT DB2 CHANGES                                            * 08569300
      ***************************************************************** 08569400
       8000-COMMIT.                                                     08569500
                                                                        08570000
           EXEC SQL                                                     08570100
               COMMIT                                                   08570200
           END-EXEC.                                                    08570300
                                                                        08570400
           EVALUATE TRUE                                                08570500
               WHEN SQLCODE = ZERO                                      08570600
                   CONTINUE                                             08570700
               WHEN SQLWARN0 NOT EQUAL SPACE                            08570800
               WHEN SQLCODE NOT EQUAL ZERO                              08570900
                   MOVE '8000-COMMIT'    TO PV-PARAGRAPH-NAME           08571000
                   MOVE 'TO COMMIT '     TO PV-DB2-OPERATION            08571100
                   PERFORM 9100-SQL-ABEND                               08571200
           END-EVALUATE.                                                08571300
                                                                        08571400
044907******************************************************************08571500
044910* 9100-SQL-ABEND                                                  08571600
045000*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.08571700
045100******************************************************************08571800
045200 9100-SQL-ABEND.                                                  08571900
045300     DISPLAY '** ABEND     **'.                                   08572400
045400     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        08572500
045500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              08572600
045600     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               08572700
045700                                                                  08572800
045800******************************************************************08572900
045900* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     08573000
046000* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      08573100
046100******************************************************************08573200
046200     COPY DPPD004.                                                08573300
046300                                                                  08573400
046400     SET AC-DB2-ERROR TO TRUE.                                    08573500
046500     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         08573600
046600                                                                  08573700
046700******************************************************************08573800
046800* 9999-ABEND                                                      08573900
046900*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  08574000
047000******************************************************************08575000
047100 9999-ABEND.                                                      08580000
047200                                                                  08590000
047300     DISPLAY '** ABEND           **'.                             08600000
047400     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  08610000
047500     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        08620000
047600     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       08630000
047700     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       08640000
047800     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         08650000
